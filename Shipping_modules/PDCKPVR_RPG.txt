     H/TITLE PRT B.O.L. Prompt      PV Prompt & validate record
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     W* Warning: This program does not set on the LR indicator
      *
     H* SYNOPSIS :
     H* - Prompts fields, allowing user changes
     H* - Validates fields
     H* - If valid, performs an action
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Prompt & validate record
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 06/30/21  Time  : 10:57:36
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDCKPVR#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: PRT B.O.L. Prompt      PV Prompt & validate record
      *
     FOMFLCPL2IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop/Order
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPDLGCPL2IF  E           K        DISK
      * RSQ : Legal Run Mileage Hours   Rtv Index w/ Desc Miles
      *
     FOMFLCPL1IF  E           K        DISK
      * RTV : Load Detail               Retrieval index
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FPPAQREL1IF  E           K        DISK
      * RTV : Company Document Defaults Retrieval index
      *
     FOMFLCPL4IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop(Desc)/Order
      *
     FPMAMREL1IF  E           K        DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FCAEOREL5IF  E           K        DISK
      * RSQ : Company Customer          Customer
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FPMDLREL1IF  E           K        DISK
      * RTV : COA Transloading Station  Retrieval index
      *
     FCAABREL4IF  E           K        DISK
      * RTV : Company Name and Address  Active records
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FOMFFREL0IF  E           K        DISK
      * RTV : Carrier                   Retrieval index
      *
     FOMFKREL0IF  E           K        DISK
      * RTV : Truck Size                Retrieval index
      *
     FCAACREL1IF  E           K        DISK
      * RTV : State                     Retrieval index       NV
      *
     FPDLCREL0IF  E           K        DISK
      * RTV : Shipping Line/Port        Retrieval index
      *
     FOPBFCPLLIF  E           K        DISK
      * RSQ : Order Header TRG          Ld(d)/Ord
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FPDJYREL2IF  E           K        DISK
      * RTV : Company Defaults Internal Active Records
      *
     FOMFJCPL1UF  E           K        DISK
      * UPD : Load Header               Update index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     FOMFLCPL0UF  E           K        DISK
      * UPD : Load Detail               Update index
      *
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * DETAIL Screen: Field position and name array
     E                    W0BEG   7 024  5 0A
     E                    W0END   7 024  5 0A
     E                    W0NAM   7 024 10
      * Long constants
     E                    @CN#    1  06  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@FLCPEB
      * Load Detail               Load/Stop/Order
      * Renamed input format fields
     I              FLRMNB                          WARMNB
     I              FLRUNB                          WARUNB
     I              FLRVNB                          WARVNB
     I              FLDQTX                          WADQTX
     I              FLRWNB                          WARWNB
     I              FLRXNB                          WARXNB
     I              FLSQNB                          WASQNB
     I              FLT0NB                          WAT0NB
     I              FLT1NB                          WAT1NB
     I              FLR1NB                          WAR1NB
     I              FLAIC3                          WAAIC3
     I              FLC4NB                          WAC4NB
     I              FLVCST                          WAVCST
     I              FLKEDT                          WAKEDT
     I              FLSXNB                          WASXNB
     I              FLKFDT                          WAKFDT
     I              FLACTM                          WAACTM
     I              FLK5TX                          WAK5TX
     I              FLW5CD                          WAW5CD
     I              FLEJDT                          WAEJDT
     I              FLAGTM                          WAAGTM
     I              FLKJDT                          WAKJDT
     I              FLATTM                          WAATTM
     I              FLHDDT                          WAHDDT
     I              FLAUTM                          WAAUTM
     I              FLKKDT                          WAKKDT
     I              FLAVTM                          WAAVTM
     I              FLZ4NB                          WAZ4NB
     I              FLY7ST                          WAY7ST
     I              FLY2ST                          WAY2ST
     I              FLWHTX                          WAWHTX
     I              FLWITX                          WAWITX
     I              FLWJTX                          WAWJTX
     I              FLWKTX                          WAWKTX
     I              FLWLTX                          WAWLTX
     I              FLN7DT                          WAN7DT
     I              FLN8DT                          WAN8DT
     I              FLN9DT                          WAN9DT
     I              FLB3TM                          WAB3TM
     I              FLB4TM                          WAB4TM
     I              FLB5TM                          WAB5TM
     I              FLIASX                          WAIASX
     I              FLIBSX                          WAIBSX
     I              FLICSX                          WAICSX
     I              FLWVTX                          WAWVTX
     I              FLWWTX                          WAWWTX
     I              FLWXTX                          WAWXTX
     I              FLUVST                          WAUVST
     I              FLUWST                          WAUWST
     I              FLUXST                          WAUXST
     I              FLAATM                          WAAATM
     I              FLAYNA                          WAAYNA
     I              FLA0NA                          WAA0NA
     I              FLAXDT                          WAAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     I@LGCPNM
      * Legal Run Mileage Hours   Rtv Index w/ Desc Miles
      * Renamed input format fields
     I              LGMILE                          WCMILE
     I              LGHRRQ                          WCHRRQ
     I              LGAATM                          WCAATM
     I              LGAYNA                          WCAYNA
     I              LGA0NA                          WCA0NA
     I              LGAXDT                          WCAXDT
      *
     I@FJCPBO
      * Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WDRMNB
     I              FJAIC3                          WDAIC3
     I              FJAODT                          WDAODT
     I              FJPJST                          WDPJST
     I              FJPKST                          WDPKST
     I              FJRNNB                          WDRNNB
     I              FJDMTX                          WDDMTX
     I              FJDNTX                          WDDNTX
     I              FJDOTX                          WDDOTX
     I              FJWTTX                          WDWTTX
     I              FJWUTX                          WDWUTX
     I              FJRPNB                          WDRPNB
     I              FJFLAM                          WDFLAM
     I              FJXQST                          WDXQST
     I              FJRRNB                          WDRRNB
     I              FJDXTX                          WDDXTX
     I              FJDYTX                          WDDYTX
     I              FJSBNB                          WDSBNB
     I              FJBZNA                          WDBZNA
     I              FJRONB                          WDRONB
     I              FJSQNB                          WDSQNB
     I              FJR1NB                          WDR1NB
     I              FJVCST                          WDVCST
     I              FJVDST                          WDVDST
     I              FJSDNB                          WDSDNB
     I              FJPAOU                          WDPAOU
     I              FJDGWG                          WDDGWG
     I              FJSXNB                          WDSXNB
     I              FJHADT                          WDHADT
     I              FJAART                          WDAART
     I              FJDHWG                          WDDHWG
     I              FJDIWG                          WDDIWG
     I              FJAQDT                          WDAQDT
     I              FJS6NB                          WDS6NB
     I              FJT4NB                          WDT4NB
     I              FJPRTM                          WDPRTM
     I              FJNPSV                          WDNPSV
     I              FJJ8TX                          WDJ8TX
     I              FJTLMI                          WDTLMI
     I              FJJ9TX                          WDJ9TX
     I              FJQ2CD                          WDQ2CD
     I              FJVPCD                          WDVPCD
     I              FJDBCD                          WDDBCD
     I              FJGRWE                          WDGRWE
     I              FJXCCD                          WDXCCD
     I              FJU2ST                          WDU2ST
     I              FJF9DT                          WDF9DT
     I              FJONTM                          WDONTM
     I              FJJ4DT                          WDJ4DT
     I              FJTRTM                          WDTRTM
     I              FJJ5DT                          WDJ5DT
     I              FJSPTM                          WDSPTM
     I              FJJ6DT                          WDJ6DT
     I              FJLFTM                          WDLFTM
     I              FJJ7DT                          WDJ7DT
     I              FJBOTM                          WDBOTM
     I              FJJ8DT                          WDJ8DT
     I              FJBLTM                          WDBLTM
     I              FJKIDT                          WDKIDT
     I              FJASTM                          WDASTM
     I              FJKADT                          WDKADT
     I              FJAJCM                          WDAJCM
     I              FJXACD                          WDXACD
     I              FJOANA                          WDOANA
     I              FJK4TX                          WDK4TX
     I              FJVOAG                          WDVOAG
     I              FJKBDT                          WDKBDT
     I              FJNBBO                          WDNBBO
     I              FJW4CD                          WDW4CD
     I              FJEFDT                          WDEFDT
     I              FJCNTN                          WDCNTN
     I              FJKCDT                          WDKCDT
     I              FJTMIN                          WDTMIN
     I              FJKDDT                          WDKDDT
     I              FJVMNB                          WDVMNB
     I              FJOCFR                          WDOCFR
     I              FJKJDT                          WDKJDT
     I              FJATTM                          WDATTM
     I              FJOTRS                          WDOTRS
     I              FJRNST                          WDRNST
     I              FJBRBK                          WDBRBK
     I              FJEIDT                          WDEIDT
     I              FJRMST                          WDRMST
     I              FJAJCD                          WDAJCD
     I              FJKKDT                          WDKKDT
     I              FJAVTM                          WDAVTM
     I              FJKZDT                          WDKZDT
     I              FJAXTM                          WDAXTM
     I              FJLHOS                          WDLHOS
     I              FJLHOR                          WDLHOR
     I              FJWNTX                          WDWNTX
     I              FJOITX                          WDOITX
     I              FJOJTX                          WDOJTX
     I              FJLLDT                          WDLLDT
     I              FJLSHG                          WDLSHG
     I              FJYPST                          WDYPST
     I              FJK0DT                          WDK0DT
     I              FJAYTM                          WDAYTM
     I              FJKNNX                          WDKNNX
     I              FJICWG                          WDICWG
     I              FJIDWG                          WDIDWG
     I              FJH9SX                          WDH9SX
     I              FJWOTX                          WDWOTX
     I              FJK1DT                          WDK1DT
     I              FJAZTM                          WDAZTM
     I              FJK2DT                          WDK2DT
     I              FJA0TM                          WDA0TM
     I              FJROST                          WDROST
     I              FJRPST                          WDRPST
     I              FJRQST                          WDRQST
     I              FJRRST                          WDRRST
     I              FJZBVA                          WDZBVA
     I              FJWPTX                          WDWPTX
     I              FJWQTX                          WDWQTX
     I              FJWRTX                          WDWRTX
     I              FJWSTX                          WDWSTX
     I              FJRVSX                          WDRVSX
     I              FJRUSX                          WDRUSX
     I              FJRWSX                          WDRWSX
     I              FJRXSX                          WDRXSX
     I              FJRYSX                          WDRYSX
     I              FJRZSX                          WDRZSX
     I              FJR0SX                          WDR0SX
     I              FJR1SX                          WDR1SX
     I              FJR2SX                          WDR2SX
     I              FJR3SX                          WDR3SX
     I              FJR4SX                          WDR4SX
     I              FJPYDT                          WDPYDT
     I              FJCKTM                          WDCKTM
     I              FJPZDT                          WDPZDT
     I              FJCLTM                          WDCLTM
     I              FJP0DT                          WDP0DT
     I              FJCMTM                          WDCMTM
     I              FJP1DT                          WDP1DT
     I              FJCNTM                          WDCNTM
     I              FJP2DT                          WDP2DT
     I              FJCOTM                          WDCOTM
     I              FJP3DT                          WDP3DT
     I              FJCQTM                          WDCQTM
     I              FJUVST                          WDUVST
     I              FJUWST                          WDUWST
     I              FJUXST                          WDUXST
     I              FJAATM                          WDAATM
     I              FJAYNA                          WDAYNA
     I              FJA0NA                          WDA0NA
     I              FJAXDT                          WDAXDT
      *
     I@FLCPBW
      * Load Detail               Retrieval index
      * Renamed input format fields
     I              FLRMNB                          WERMNB
     I              FLRUNB                          WERUNB
     I              FLRVNB                          WERVNB
     I              FLDQTX                          WEDQTX
     I              FLRWNB                          WERWNB
     I              FLRXNB                          WERXNB
     I              FLSQNB                          WESQNB
     I              FLT0NB                          WET0NB
     I              FLT1NB                          WET1NB
     I              FLR1NB                          WER1NB
     I              FLAIC3                          WEAIC3
     I              FLC4NB                          WEC4NB
     I              FLVCST                          WEVCST
     I              FLKEDT                          WEKEDT
     I              FLSXNB                          WESXNB
     I              FLKFDT                          WEKFDT
     I              FLACTM                          WEACTM
     I              FLK5TX                          WEK5TX
     I              FLW5CD                          WEW5CD
     I              FLEJDT                          WEEJDT
     I              FLAGTM                          WEAGTM
     I              FLKJDT                          WEKJDT
     I              FLATTM                          WEATTM
     I              FLHDDT                          WEHDDT
     I              FLAUTM                          WEAUTM
     I              FLKKDT                          WEKKDT
     I              FLAVTM                          WEAVTM
     I              FLZ4NB                          WEZ4NB
     I              FLY7ST                          WEY7ST
     I              FLY2ST                          WEY2ST
     I              FLWHTX                          WEWHTX
     I              FLWITX                          WEWITX
     I              FLWJTX                          WEWJTX
     I              FLWKTX                          WEWKTX
     I              FLWLTX                          WEWLTX
     I              FLN7DT                          WEN7DT
     I              FLN8DT                          WEN8DT
     I              FLN9DT                          WEN9DT
     I              FLB3TM                          WEB3TM
     I              FLB4TM                          WEB4TM
     I              FLB5TM                          WEB5TM
     I              FLIASX                          WEIASX
     I              FLIBSX                          WEIBSX
     I              FLICSX                          WEICSX
     I              FLWVTX                          WEWVTX
     I              FLWWTX                          WEWWTX
     I              FLWXTX                          WEWXTX
     I              FLUVST                          WEUVST
     I              FLUWST                          WEUWST
     I              FLUXST                          WEUXST
     I              FLAATM                          WEAATM
     I              FLAYNA                          WEAYNA
     I              FLA0NA                          WEA0NA
     I              FLAXDT                          WEAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WFAIC3
     I              OMC4NB                          WFC4NB
     I              OMDPNB                          WFDPNB
     I              OMUENB                          WFUENB
     I              OMHGCD                          WFHGCD
     I              OMAJCD                          WFAJCD
     I              OMBKC7                          WFBKC7
     I              OMCFC7                          WFCFC7
     I              OMGMST                          WFGMST
     I              OMGNST                          WFGNST
     I              OMMAVA                          WFMAVA
     I              OMKDVA                          WFKDVA
     I              OML8VA                          WFL8VA
     I              OML9VA                          WFL9VA
     I              OMGTST                          WFGTST
     I              OMGVST                          WFGVST
     I              OMGUST                          WFGUST
     I              OMQFST                          WFQFST
     I              OMAYVA                          WFAYVA
     I              OMEXDT                          WFEXDT
     I              OMLQCD                          WFLQCD
     I              OMRDCD                          WFRDCD
     I              OMQ7CD                          WFQ7CD
     I              OMBZPR                          WFBZPR
     I              OML6NB                          WFL6NB
     I              OMU1ST                          WFU1ST
     I              OMGIDT                          WFGIDT
     I              OMCRCD                          WFCRCD
     I              OMAGCD                          WFAGCD
     I              OMRZST                          WFRZST
     I              OMR0ST                          WFR0ST
     I              OMR1ST                          WFR1ST
     I              OMG7NA                          WFG7NA
     I              OMG8NA                          WFG8NA
     I              OMRPCD                          WFRPCD
     I              OMVEST                          WFVEST
     I              OMVGST                          WFVGST
     I              OMAVST                          WFAVST
     I              OMU0ST                          WFU0ST
     I              OMRFCD                          WFRFCD
     I              OMFZST                          WFFZST
     I              OMR1NB                          WFR1NB
     I              OMAVQT                          WFAVQT
     I              OMD0WG                          WFD0WG
     I              OMCCQT                          WFCCQT
     I              OMAUWG                          WFAUWG
     I              OMCBQT                          WFCBQT
     I              OMATWG                          WFATWG
     I              OMAQCS                          WFAQCS
     I              OMAGCS                          WFAGCS
     I              OMAKPR                          WFAKPR
     I              OMALPR                          WFALPR
     I              OMAUPR                          WFAUPR
     I              OMAVWG                          WFAVWG
     I              OMA4WG                          WFA4WG
     I              OMA5DT                          WFA5DT
     I              OMAODT                          WFAODT
     I              OMGNDT                          WFGNDT
     I              OMAMST                          WFAMST
     I              OMANST                          WFANST
     I              OMVAST                          WFVAST
     I              OMRGNB                          WFRGNB
     I              OMRHNB                          WFRHNB
     I              OMRINB                          WFRINB
     I              OMRBCD                          WFRBCD
     I              OMHICD                          WFHICD
     I              OMRNCD                          WFRNCD
     I              OMROCD                          WFROCD
     I              OMCXDT                          WFCXDT
     I              OMAJVN                          WFAJVN
     I              OMKXCD                          WFKXCD
     I              OMJPCD                          WFJPCD
     I              OMCQCD                          WFCQCD
     I              OMR4CD                          WFR4CD
     I              OMZ1ST                          WFZ1ST
     I              OMZ3ST                          WFZ3ST
     I              OMZ4ST                          WFZ4ST
     I              OMDUPR                          WFDUPR
     I              OMB6VL                          WFB6VL
     I              OMA1AA                          WFA1AA
     I              OMFZSX                          WFFZSX
     I              OMF0SX                          WFF0SX
     I              OMF1SX                          WFF1SX
     I              OMF2SX                          WFF2SX
     I              OMF3SX                          WFF3SX
     I              OMF4SX                          WFF4SX
     I              OMF5SX                          WFF5SX
     I              OMF6SX                          WFF6SX
     I              OMF7SX                          WFF7SX
     I              OMNTDT                          WFNTDT
     I              OMNUDT                          WFNUDT
     I              OMNVDT                          WFNVDT
     I              OMNWDT                          WFNWDT
     I              OMNXDT                          WFNXDT
     I              OMBUTM                          WFBUTM
     I              OMBVTM                          WFBVTM
     I              OMBWTM                          WFBWTM
     I              OMBXTM                          WFBXTM
     I              OMBYTM                          WFBYTM
     I              OMH5NX                          WFH5NX
     I              OMH6NX                          WFH6NX
     I              OMH7NX                          WFH7NX
     I              OMH8NX                          WFH8NX
     I              OMH9NX                          WFH9NX
     I              OMDVPR                          WFDVPR
     I              OMDWPR                          WFDWPR
     I              OMDXPR                          WFDXPR
     I              OMDYPR                          WFDYPR
     I              OMDZPR                          WFDZPR
     I              OMGSPR                          WFGSPR
     I              OMGTPR                          WFGTPR
     I              OMGUPR                          WFGUPR
     I              OMHOST                          WFHOST
     I              OMHPST                          WFHPST
     I              OMIOST                          WFIOST
     I              OMPEWG                          WFPEWG
     I              OMRINY                          WFRINY
     I              OMTIDT                          WFTIDT
     I              OMTJDT                          WFTJDT
     I              OMH2ST                          WFH2ST
     I              OMH0ST                          WFH0ST
     I              OMH1ST                          WFH1ST
     I              OMTKDT                          WFTKDT
     I              OMTLDT                          WFTLDT
     I              OMTMDT                          WFTMDT
     I              OMUVST                          WFUVST
     I              OMUWST                          WFUWST
     I              OMUXST                          WFUXST
     I              OMAATM                          WFAATM
     I              OMAYNA                          WFAYNA
     I              OMA0NA                          WFA0NA
     I              OMAXDT                          WFAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WGAIC3
     I              OMC4NB                          WGC4NB
     I              OMDPNB                          WGDPNB
     I              OMUENB                          WGUENB
     I              OMHGCD                          WGHGCD
     I              OMAJCD                          WGAJCD
     I              OMBKC7                          WGBKC7
     I              OMCFC7                          WGCFC7
     I              OMGMST                          WGGMST
     I              OMGNST                          WGGNST
     I              OMMAVA                          WGMAVA
     I              OMKDVA                          WGKDVA
     I              OML8VA                          WGL8VA
     I              OML9VA                          WGL9VA
     I              OMGTST                          WGGTST
     I              OMGVST                          WGGVST
     I              OMGUST                          WGGUST
     I              OMQFST                          WGQFST
     I              OMAYVA                          WGAYVA
     I              OMEXDT                          WGEXDT
     I              OMLQCD                          WGLQCD
     I              OMRDCD                          WGRDCD
     I              OMQ7CD                          WGQ7CD
     I              OMBZPR                          WGBZPR
     I              OML6NB                          WGL6NB
     I              OMU1ST                          WGU1ST
     I              OMGIDT                          WGGIDT
     I              OMCRCD                          WGCRCD
     I              OMAGCD                          WGAGCD
     I              OMRZST                          WGRZST
     I              OMR0ST                          WGR0ST
     I              OMR1ST                          WGR1ST
     I              OMG7NA                          WGG7NA
     I              OMG8NA                          WGG8NA
     I              OMRPCD                          WGRPCD
     I              OMVEST                          WGVEST
     I              OMVGST                          WGVGST
     I              OMAVST                          WGAVST
     I              OMU0ST                          WGU0ST
     I              OMRFCD                          WGRFCD
     I              OMFZST                          WGFZST
     I              OMR1NB                          WGR1NB
     I              OMAVQT                          WGAVQT
     I              OMD0WG                          WGD0WG
     I              OMCCQT                          WGCCQT
     I              OMAUWG                          WGAUWG
     I              OMCBQT                          WGCBQT
     I              OMATWG                          WGATWG
     I              OMAQCS                          WGAQCS
     I              OMAGCS                          WGAGCS
     I              OMAKPR                          WGAKPR
     I              OMALPR                          WGALPR
     I              OMAUPR                          WGAUPR
     I              OMAVWG                          WGAVWG
     I              OMA4WG                          WGA4WG
     I              OMA5DT                          WGA5DT
     I              OMAODT                          WGAODT
     I              OMGNDT                          WGGNDT
     I              OMAMST                          WGAMST
     I              OMANST                          WGANST
     I              OMVAST                          WGVAST
     I              OMRGNB                          WGRGNB
     I              OMRHNB                          WGRHNB
     I              OMRINB                          WGRINB
     I              OMRBCD                          WGRBCD
     I              OMHICD                          WGHICD
     I              OMRNCD                          WGRNCD
     I              OMROCD                          WGROCD
     I              OMCXDT                          WGCXDT
     I              OMAJVN                          WGAJVN
     I              OMKXCD                          WGKXCD
     I              OMJPCD                          WGJPCD
     I              OMCQCD                          WGCQCD
     I              OMR4CD                          WGR4CD
     I              OMZ1ST                          WGZ1ST
     I              OMZ3ST                          WGZ3ST
     I              OMZ4ST                          WGZ4ST
     I              OMDUPR                          WGDUPR
     I              OMB6VL                          WGB6VL
     I              OMA1AA                          WGA1AA
     I              OMFZSX                          WGFZSX
     I              OMF0SX                          WGF0SX
     I              OMF1SX                          WGF1SX
     I              OMF2SX                          WGF2SX
     I              OMF3SX                          WGF3SX
     I              OMF4SX                          WGF4SX
     I              OMF5SX                          WGF5SX
     I              OMF6SX                          WGF6SX
     I              OMF7SX                          WGF7SX
     I              OMNTDT                          WGNTDT
     I              OMNUDT                          WGNUDT
     I              OMNVDT                          WGNVDT
     I              OMNWDT                          WGNWDT
     I              OMNXDT                          WGNXDT
     I              OMBUTM                          WGBUTM
     I              OMBVTM                          WGBVTM
     I              OMBWTM                          WGBWTM
     I              OMBXTM                          WGBXTM
     I              OMBYTM                          WGBYTM
     I              OMH5NX                          WGH5NX
     I              OMH6NX                          WGH6NX
     I              OMH7NX                          WGH7NX
     I              OMH8NX                          WGH8NX
     I              OMH9NX                          WGH9NX
     I              OMDVPR                          WGDVPR
     I              OMDWPR                          WGDWPR
     I              OMDXPR                          WGDXPR
     I              OMDYPR                          WGDYPR
     I              OMDZPR                          WGDZPR
     I              OMGSPR                          WGGSPR
     I              OMGTPR                          WGGTPR
     I              OMGUPR                          WGGUPR
     I              OMHOST                          WGHOST
     I              OMHPST                          WGHPST
     I              OMIOST                          WGIOST
     I              OMPEWG                          WGPEWG
     I              OMRINY                          WGRINY
     I              OMTIDT                          WGTIDT
     I              OMTJDT                          WGTJDT
     I              OMH2ST                          WGH2ST
     I              OMH0ST                          WGH0ST
     I              OMH1ST                          WGH1ST
     I              OMTKDT                          WGTKDT
     I              OMTLDT                          WGTLDT
     I              OMTMDT                          WGTMDT
     I              OMUVST                          WGUVST
     I              OMUWST                          WGUWST
     I              OMUXST                          WGUXST
     I              OMAATM                          WGAATM
     I              OMAYNA                          WGAYNA
     I              OMA0NA                          WGA0NA
     I              OMAXDT                          WGAXDT
      *
     I@FLCPBM
      * Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WHRMNB
     I              FLRUNB                          WHRUNB
     I              FLRVNB                          WHRVNB
     I              FLDQTX                          WHDQTX
     I              FLRWNB                          WHRWNB
     I              FLRXNB                          WHRXNB
     I              FLSQNB                          WHSQNB
     I              FLT0NB                          WHT0NB
     I              FLT1NB                          WHT1NB
     I              FLR1NB                          WHR1NB
     I              FLAIC3                          WHAIC3
     I              FLC4NB                          WHC4NB
     I              FLVCST                          WHVCST
     I              FLKEDT                          WHKEDT
     I              FLSXNB                          WHSXNB
     I              FLKFDT                          WHKFDT
     I              FLACTM                          WHACTM
     I              FLK5TX                          WHK5TX
     I              FLW5CD                          WHW5CD
     I              FLEJDT                          WHEJDT
     I              FLAGTM                          WHAGTM
     I              FLKJDT                          WHKJDT
     I              FLATTM                          WHATTM
     I              FLHDDT                          WHHDDT
     I              FLAUTM                          WHAUTM
     I              FLKKDT                          WHKKDT
     I              FLAVTM                          WHAVTM
     I              FLZ4NB                          WHZ4NB
     I              FLY7ST                          WHY7ST
     I              FLY2ST                          WHY2ST
     I              FLWHTX                          WHWHTX
     I              FLWITX                          WHWITX
     I              FLWJTX                          WHWJTX
     I              FLWKTX                          WHWKTX
     I              FLWLTX                          WHWLTX
     I              FLN7DT                          WHN7DT
     I              FLN8DT                          WHN8DT
     I              FLN9DT                          WHN9DT
     I              FLB3TM                          WHB3TM
     I              FLB4TM                          WHB4TM
     I              FLB5TM                          WHB5TM
     I              FLIASX                          WHIASX
     I              FLIBSX                          WHIBSX
     I              FLICSX                          WHICSX
     I              FLWVTX                          WHWVTX
     I              FLWWTX                          WHWWTX
     I              FLWXTX                          WHWXTX
     I              FLUVST                          WHUVST
     I              FLUWST                          WHUWST
     I              FLUXST                          WHUXST
     I              FLAATM                          WHAATM
     I              FLAYNA                          WHAYNA
     I              FLA0NA                          WHA0NA
     I              FLAXDT                          WHAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WIAJCD
     I              ADF8NA                          WIF8NA
     I              ADACNA                          WIACNA
     I              ADADNA                          WIADNA
     I              ADAENA                          WIAENA
     I              ADAJNA                          WIAJNA
     I              ADBTTX                          WIBTTX
     I              ADAOCD                          WIAOCD
     I              ADBGCD                          WIBGCD
     I              ADVHST                          WIVHST
     I              ADMPNA                          WIMPNA
     I              ADWPST                          WIWPST
     I              ADXUST                          WIXUST
     I              ADT0ST                          WIT0ST
     I              ADT1ST                          WIT1ST
     I              ADDBNB                          WIDBNB
     I              ADT2ST                          WIT2ST
     I              ADT3ST                          WIT3ST
     I              ADT4ST                          WIT4ST
     I              ADT6ST                          WIT6ST
     I              ADBWC3                          WIBWC3
     I              ADBTC3                          WIBTC3
     I              ADBUC3                          WIBUC3
     I              ADBVC3                          WIBVC3
     I              ADFCAA                          WIFCAA
     I              ADRQSX                          WIRQSX
     I              ADRRSX                          WIRRSX
     I              ADRSSX                          WIRSSX
     I              ADRTSX                          WIRTSX
     I              ADT7ST                          WIT7ST
     I              ADT8ST                          WIT8ST
     I              ADRNSX                          WIRNSX
     I              ADROSX                          WIROSX
     I              ADRPSX                          WIRPSX
     I              ADUVST                          WIUVST
     I              ADUWST                          WIUWST
     I              ADUXST                          WIUXST
     I              ADVSST                          WIVSST
     I              ADAATM                          WIAATM
     I              ADAYNA                          WIAYNA
     I              ADA0NA                          WIA0NA
     I              ADAXDT                          WIAXDT
      *
     I@AQREWG
      * Company Document Defaults Retrieval index
      * Renamed input format fields
     I              AQAIC3                          WJAIC3
     I              AQESTX                          WJESTX
     I              AQFPAA                          WJFPAA
     I              AQRPNA                          WJRPNA
     I              AQDTVN                          WJDTVN
     I              AQDUVN                          WJDUVN
     I              AQDVVN                          WJDVVN
     I              AQEWT1                          WJEWT1
     I              AQEXT1                          WJEXT1
     I              AQDXVN                          WJDXVN
     I              AQKMT1                          WJKMT1
     I              AQKNT1                          WJKNT1
     I              AQGXNY                          WJGXNY
     I              AQDWVN                          WJDWVN
     I              AQGZNY                          WJGZNY
     I              AQG0NY                          WJG0NY
     I              AQG1NY                          WJG1NY
     I              AQG2NY                          WJG2NY
     I              AQGYNY                          WJGYNY
     I              AQKOT1                          WJKOT1
     I              AQDYVN                          WJDYVN
     I              AQDZVN                          WJDZVN
     I              AQD0VN                          WJD0VN
     I              AQG3NY                          WJG3NY
     I              AQG4NY                          WJG4NY
     I              AQG5NY                          WJG5NY
     I              AQG6NY                          WJG6NY
     I              AQG7NY                          WJG7NY
     I              AQEYT1                          WJEYT1
     I              AQEZT1                          WJEZT1
     I              AQKBT1                          WJKBT1
     I              AQKCT1                          WJKCT1
     I              AQKDT1                          WJKDT1
     I              AQETTX                          WJETTX
     I              AQEXTX                          WJEXTX
     I              AQE0TX                          WJE0TX
     I              AQE3TX                          WJE3TX
     I              AQE0T1                          WJE0T1
     I              AQE1T1                          WJE1T1
     I              AQKET1                          WJKET1
     I              AQKFT1                          WJKFT1
     I              AQKGT1                          WJKGT1
     I              AQQ4DT                          WJQ4DT
     I              AQQ5DT                          WJQ5DT
     I              AQQ7DT                          WJQ7DT
     I              AQCYTM                          WJCYTM
     I              AQCWTM                          WJCWTM
     I              AQCXTM                          WJCXTM
     I              AQVSST                          WJVSST
     I              AQMJDT                          WJMJDT
     I              AQBETM                          WJBETM
     I              AQCCVN                          WJCCVN
     I              AQCDVN                          WJCDVN
     I              AQMKDT                          WJMKDT
     I              AQBFTM                          WJBFTM
     I              AQCEVN                          WJCEVN
     I              AQCFVN                          WJCFVN
      *
     I@FLCPE8
      * Load Detail               Load/Stop(Desc)/Order
      * Renamed input format fields
     I              FLRMNB                          WKRMNB
     I              FLRUNB                          WKRUNB
     I              FLRVNB                          WKRVNB
     I              FLDQTX                          WKDQTX
     I              FLRWNB                          WKRWNB
     I              FLRXNB                          WKRXNB
     I              FLSQNB                          WKSQNB
     I              FLT0NB                          WKT0NB
     I              FLT1NB                          WKT1NB
     I              FLR1NB                          WKR1NB
     I              FLAIC3                          WKAIC3
     I              FLC4NB                          WKC4NB
     I              FLVCST                          WKVCST
     I              FLKEDT                          WKKEDT
     I              FLSXNB                          WKSXNB
     I              FLKFDT                          WKKFDT
     I              FLACTM                          WKACTM
     I              FLK5TX                          WKK5TX
     I              FLW5CD                          WKW5CD
     I              FLEJDT                          WKEJDT
     I              FLAGTM                          WKAGTM
     I              FLKJDT                          WKKJDT
     I              FLATTM                          WKATTM
     I              FLHDDT                          WKHDDT
     I              FLAUTM                          WKAUTM
     I              FLKKDT                          WKKKDT
     I              FLAVTM                          WKAVTM
     I              FLZ4NB                          WKZ4NB
     I              FLY7ST                          WKY7ST
     I              FLY2ST                          WKY2ST
     I              FLWHTX                          WKWHTX
     I              FLWITX                          WKWITX
     I              FLWJTX                          WKWJTX
     I              FLWKTX                          WKWKTX
     I              FLWLTX                          WKWLTX
     I              FLN7DT                          WKN7DT
     I              FLN8DT                          WKN8DT
     I              FLN9DT                          WKN9DT
     I              FLB3TM                          WKB3TM
     I              FLB4TM                          WKB4TM
     I              FLB5TM                          WKB5TM
     I              FLIASX                          WKIASX
     I              FLIBSX                          WKIBSX
     I              FLICSX                          WKICSX
     I              FLWVTX                          WKWVTX
     I              FLWWTX                          WKWWTX
     I              FLWXTX                          WKWXTX
     I              FLUVST                          WKUVST
     I              FLUWST                          WKUWST
     I              FLUXST                          WKUXST
     I              FLAATM                          WKAATM
     I              FLAYNA                          WKAYNA
     I              FLA0NA                          WKA0NA
     I              FLAXDT                          WKAXDT
      *
     I@AMREJF
      * Order Header Extension    Retrieval index
      * Renamed input format fields
     I              AMAIC3                          WLAIC3
     I              AMC4NB                          WLC4NB
     I              AMRMNB                          WLRMNB
     I              AMRUNB                          WLRUNB
     I              AMXACD                          WLXACD
     I              AMOANA                          WLOANA
     I              AMHBAA                          WLHBAA
     I              AMJ0T1                          WLJ0T1
     I              AMGENY                          WLGENY
     I              AMJ1T1                          WLJ1T1
     I              AMHCAA                          WLHCAA
     I              AMQWDT                          WLQWDT
     I              AMQXDT                          WLQXDT
     I              AMQYDT                          WLQYDT
     I              AMHDAA                          WLHDAA
     I              AMCCTX                          WLCCTX
     I              AMJ2T1                          WLJ2T1
     I              AMRLNA                          WLRLNA
     I              AMRMNA                          WLRMNA
     I              AMGINY                          WLGINY
     I              AMGFNY                          WLGFNY
     I              AMGGNY                          WLGGNY
     I              AMGHNY                          WLGHNY
     I              AMHEVL                          WLHEVL
     I              AMHFVL                          WLHFVL
     I              AMHGVL                          WLHGVL
     I              AMQZDT                          WLQZDT
     I              AMQ0DT                          WLQ0DT
     I              AMQ1DT                          WLQ1DT
     I              AMQ2DT                          WLQ2DT
     I              AMC2TX                          WLC2TX
     I              AMC3TX                          WLC3TX
     I              AMC6TX                          WLC6TX
     I              AMCHTX                          WLCHTX
     I              AMCITX                          WLCITX
     I              AMCLTX                          WLCLTX
     I              AMB4TX                          WLB4TX
     I              AMCUTX                          WLCUTX
     I              AMCVTX                          WLCVTX
     I              AMB9TX                          WLB9TX
     I              AMJWSC                          WLJWSC
     I              AMITNY                          WLITNY
     I              AMLMT1                          WLLMT1
     I              AMLWAA                          WLLWAA
     I              AMFVST                          WLFVST
     I              AMF0ST                          WLF0ST
     I              AMF2ST                          WLF2ST
     I              AMF3ST                          WLF3ST
     I              AMJUSC                          WLJUSC
     I              AMJVSC                          WLJVSC
     I              AMV3T1                          WLV3T1
     I              AMV4T1                          WLV4T1
     I              AMV5T1                          WLV5T1
     I              AMV6T1                          WLV6T1
     I              AMV7T1                          WLV7T1
     I              AMV8T1                          WLV8T1
     I              AMV9T1                          WLV9T1
     I              AMWAT1                          WLWAT1
     I              AMWBT1                          WLWBT1
     I              AMWCT1                          WLWCT1
     I              AMWDT1                          WLWDT1
     I              AMQJNY                          WLQJNY
     I              AMQKNY                          WLQKNY
     I              AMQLNY                          WLQLNY
     I              AMP8NY                          WLP8NY
     I              AMP9NY                          WLP9NY
     I              AMQANY                          WLQANY
     I              AMQCNY                          WLQCNY
     I              AMQDNY                          WLQDNY
     I              AMQENY                          WLQENY
     I              AMQFNY                          WLQFNY
     I              AMQGNY                          WLQGNY
     I              AMQHNY                          WLQHNY
     I              AMQINY                          WLQINY
     I              AMQMNY                          WLQMNY
     I              AMMYU1                          WLMYU1
     I              AMJXSC                          WLJXSC
     I              AMJYSC                          WLJYSC
     I              AMJZSC                          WLJZSC
     I              AMJ0SC                          WLJ0SC
     I              AMMZU1                          WLMZU1
     I              AMM0U1                          WLM0U1
     I              AMM1U1                          WLM1U1
     I              AMM2U1                          WLM2U1
     I              AMM3U1                          WLM3U1
     I              AMW5DT                          WLW5DT
     I              AMW6DT                          WLW6DT
     I              AMUVST                          WLUVST
     I              AMUWST                          WLUWST
     I              AMUXST                          WLUXST
     I              AMVSST                          WLVSST
     I              AMAATM                          WLAATM
     I              AMAYNA                          WLAYNA
     I              AMA0NA                          WLA0NA
     I              AMAXDT                          WLAXDT
      *
     I@EOREIQ
      * Company Customer          Customer
      * Renamed input format fields
     I              EOAIC3                          WMAIC3
     I              EOBKC7                          WMBKC7
     I              EOAQCD                          WMAQCD
     I              EOR4CD                          WMR4CD
     I              EOBYNA                          WMBYNA
     I              EOB6NA                          WMB6NA
     I              EOBZNA                          WMBZNA
     I              EOLLST                          WMLLST
     I              EOPPST                          WMPPST
     I              EOR5NB                          WMR5NB
     I              EOR6NB                          WMR6NB
     I              EOQGST                          WMQGST
     I              EOBOCD                          WMBOCD
     I              EOTBNB                          WMTBNB
     I              EOMTCU                          WMMTCU
     I              EOW2NB                          WMW2NB
     I              EORPCD                          WMRPCD
     I              EOAJCD                          WMAJCD
     I              EOX9ST                          WMX9ST
     I              EOT9CD                          WMT9CD
     I              EOUBCD                          WMUBCD
     I              EOISTX                          WMISTX
     I              EOLQCD                          WMLQCD
     I              EONJNA                          WMNJNA
     I              EOI0TX                          WMI0TX
     I              EONKNA                          WMNKNA
     I              EOI1TX                          WMI1TX
     I              EOVLST                          WMVLST
     I              EORLST                          WMRLST
     I              EOMMTX                          WMMMTX
     I              EOOHNA                          WMOHNA
     I              EOQ6ST                          WMQ6ST
     I              EOQ8ST                          WMQ8ST
     I              EORBST                          WMRBST
     I              EOREST                          WMREST
     I              EOUVST                          WMUVST
     I              EOUWST                          WMUWST
     I              EOUXST                          WMUXST
     I              EOVSST                          WMVSST
     I              EOAATM                          WMAATM
     I              EOAYNA                          WMAYNA
     I              EOA0NA                          WMA0NA
     I              EOAXDT                          WMAXDT
      *
     I@KMREHC
      * Company Values            Retrieval index
      * Renamed input format fields
     I              KMAIC3                          WOAIC3
     I              KMV8CD                          WOV8CD
     I              KMAUNA                          WOAUNA
     I              KMI5ST                          WOI5ST
     I              KMBXTX                          WOBXTX
     I              KMM8NB                          WOM8NB
     I              KMUVST                          WOUVST
     I              KMUWST                          WOUWST
     I              KMUXST                          WOUXST
     I              KMVSST                          WOVSST
     I              KMAATM                          WOAATM
     I              KMAYNA                          WOAYNA
     I              KMA0NA                          WOA0NA
     I              KMAXDT                          WOAXDT
      *
     I@DLRERJ
      * COA Transloading Station  Retrieval index
      * Renamed input format fields
     I              DLIZAA                          WRIZAA
     I              DLNIT1                          WRNIT1
     I              DLACNA                          WRACNA
     I              DLADNA                          WRADNA
     I              DLAENA                          WRAENA
     I              DLAJNA                          WRAJNA
     I              DLBGCD                          WRBGCD
     I              DLBTTX                          WRBTTX
     I              DLBVTX                          WRBVTX
     I              DLBWTX                          WRBWTX
     I              DLL6T1                          WRL6T1
     I              DLL7T1                          WRL7T1
     I              DLL2T1                          WRL2T1
     I              DLL3T1                          WRL3T1
     I              DLTRXT                          WRTRXT
     I              DLKLTX                          WRKLTX
     I              DLKMTX                          WRKMTX
     I              DLNJT1                          WRNJT1
     I              DLVSST                          WRVSST
     I              DLMJDT                          WRMJDT
     I              DLBETM                          WRBETM
     I              DLCCVN                          WRCCVN
     I              DLCDVN                          WRCDVN
     I              DLMKDT                          WRMKDT
     I              DLBFTM                          WRBFTM
     I              DLCEVN                          WRCEVN
     I              DLCFVN                          WRCFVN
      *
     I@ABREUA
      * Company Name and Address  Active records
      * Renamed input format fields
     I              ABAIC3                          WSAIC3
     I              ABADTX                          WSADTX
     I              ABACNA                          WSACNA
     I              ABADNA                          WSADNA
     I              ABAENA                          WSAENA
     I              ABAJNA                          WSAJNA
     I              ABBTTX                          WSBTTX
     I              ABBVTX                          WSBVTX
     I              ABBWTX                          WSBWTX
     I              ABA2NA                          WSA2NA
     I              ABABTX                          WSABTX
     I              ABBGCD                          WSBGCD
     I              ABKXCD                          WSKXCD
     I              ABUVST                          WSUVST
     I              ABUWST                          WSUWST
     I              ABUXST                          WSUXST
     I              ABVSST                          WSVSST
     I              ABAATM                          WSAATM
     I              ABAYNA                          WSAYNA
     I              ABA0NA                          WSA0NA
     I              ABAXDT                          WSAXDT
      *
     I@AFREBE
      * Calendar                  Retrieval index       NV
      * Renamed input format fields
     I              AFAIC3                          WTAIC3
     I              AFBCDT                          WTBCDT
     I              AFCQNB                          WTCQNB
     I              AFESNB                          WTESNB
     I              AFETNB                          WTETNB
     I              AFBZNB                          WTBZNB
     I              AFA9ST                          WTA9ST
     I              AFEINB                          WTEINB
     I              AFC5ST                          WTC5ST
     I              AFAQNB                          WTAQNB
     I              AFCMST                          WTCMST
     I              AFV9ST                          WTV9ST
     I              AFWAST                          WTWAST
     I              AFX2ST                          WTX2ST
     I              AFOJDT                          WTOJDT
     I              AFNQNX                          WTNQNX
     I              AFNRNX                          WTNRNX
     I              AFI9SX                          WTI9SX
     I              AFJASX                          WTJASX
     I              AFOKDT                          WTOKDT
     I              AFOLDT                          WTOLDT
     I              AFUVST                          WTUVST
     I              AFUWST                          WTUWST
     I              AFUXST                          WTUXST
     I              AFAATM                          WTAATM
     I              AFAYNA                          WTAYNA
     I              AFA0NA                          WTA0NA
     I              AFAXDT                          WTAXDT
      *
     I@FFREBF
      * Carrier                   Retrieval index
      * Renamed input format fields
     I              FFBZNA                          WVBZNA
     I              FFADTX                          WVADTX
     I              FFACNA                          WVACNA
     I              FFADNA                          WVADNA
     I              FFAENA                          WVAENA
     I              FFAJNA                          WVAJNA
     I              FFBTTX                          WVBTTX
     I              FFEZNB                          WVEZNB
     I              FFBGCD                          WVBGCD
     I              FFEEDT                          WVEEDT
     I              FFDUTX                          WVDUTX
     I              FFNRVA                          WVNRVA
     I              FFNSVA                          WVNSVA
     I              FFNTVA                          WVNTVA
     I              FFNUVA                          WVNUVA
     I              FFP1ST                          WVP1ST
     I              FFDVTX                          WVDVTX
     I              FFDWTX                          WVDWTX
     I              FFLVCD                          WVLVCD
     I              FFS8NB                          WVS8NB
     I              FFS9NB                          WVS9NB
     I              FFNMVA                          WVNMVA
     I              FFNOVA                          WVNOVA
     I              FFNPVA                          WVNPVA
     I              FFNQVA                          WVNQVA
     I              FFMFCD                          WVMFCD
     I              FFQXNB                          WVQXNB
     I              FFQ1NB                          WVQ1NB
     I              FFMRNG                          WVMRNG
     I              FFMRNE                          WVMRNE
     I              FFRFNB                          WVRFNB
     I              FFMREG                          WVMREG
     I              FFBQPR                          WVBQPR
     I              FFBRPR                          WVBRPR
     I              FFBSPR                          WVBSPR
     I              FFBTPR                          WVBTPR
     I              FFBUPR                          WVBUPR
     I              FFBVPR                          WVBVPR
     I              FFDJWG                          WVDJWG
     I              FFDKWG                          WVDKWG
     I              FFDLWG                          WVDLWG
     I              FFDMWG                          WVDMWG
     I              FFDNWG                          WVDNWG
     I              FFDOWG                          WVDOWG
     I              FFB2PR                          WVB2PR
     I              FFB3PR                          WVB3PR
     I              FFB4PR                          WVB4PR
     I              FFB5PR                          WVB5PR
     I              FFB6PR                          WVB6PR
     I              FFB7PR                          WVB7PR
     I              FFAAC7                          WVAAC7
     I              FFCOFI                          WVCOFI
     I              FFK6TX                          WVK6TX
     I              FFOCNA                          WVOCNA
     I              FFODNA                          WVODNA
     I              FFW7CD                          WVW7CD
     I              FFK7TX                          WVK7TX
     I              FFTENO                          WVTENO
     I              FFK8TX                          WVK8TX
     I              FFAOFC                          WVAOFC
     I              FFAOLI                          WVAOLI
     I              FFKHDT                          WVKHDT
     I              FFUNUS                          WVUNUS
     I              FFUNU2                          WVUNU2
     I              FFUNU3                          WVUNU3
     I              FFUVST                          WVUVST
     I              FFUWST                          WVUWST
     I              FFUXST                          WVUXST
     I              FFVSST                          WVVSST
     I              FFAATM                          WVAATM
     I              FFAYNA                          WVAYNA
     I              FFA0NA                          WVA0NA
     I              FFAXDT                          WVAXDT
      *
     I@FKREBT
      * Truck Size                Retrieval index
      * Renamed input format fields
     I              FKRONB                          WWRONB
     I              FKDPTX                          WWDPTX
     I              FKRSNB                          WWRSNB
     I              FKRTNB                          WWRTNB
     I              FKTANB                          WWTANB
     I              FKUVST                          WWUVST
     I              FKUWST                          WWUWST
     I              FKUXST                          WWUXST
     I              FKVSST                          WWVSST
     I              FKAATM                          WWAATM
     I              FKAYNA                          WWAYNA
     I              FKA0NA                          WWA0NA
     I              FKAXDT                          WWAXDT
      *
     I@ACREAH
      * State                     Retrieval index       NV
      * Renamed input format fields
     I              ACBGCD                          WXBGCD
     I              ACAUNA                          WXAUNA
     I              ACUVST                          WXUVST
     I              ACUWST                          WXUWST
     I              ACUXST                          WXUXST
     I              ACVSST                          WXVSST
     I              ACAATM                          WXAATM
     I              ACAYNA                          WXAYNA
     I              ACA0NA                          WXA0NA
     I              ACAXDT                          WXAXDT
      *
     I@LCREL2
      * Shipping Line/Port        Retrieval index
      * Renamed input format fields
     I              LCXACD                          WYXACD
     I              LCOANA                          WYOANA
     I              LCOKTX                          WYOKTX
     I              LCLBTX                          WYLBTX
     I              LCLATX                          WYLATX
     I              LCXBCD                          WYXBCD
     I              LCLCTX                          WYLCTX
     I              LCSPPN                          WYSPPN
     I              LCLDTX                          WYLDTX
     I              LCPYAA                          WYPYAA
     I              LCUVST                          WYUVST
     I              LCUWST                          WYUWST
     I              LCUXST                          WYUXST
     I              LCVSST                          WYVSST
     I              LCAATM                          WYAATM
     I              LCAYNA                          WYAYNA
     I              LCA0NA                          WYA0NA
     I              LCAXDT                          WYAXDT
      *
     I@BFCPR0
      * Order Header TRG          Ld(d)/Ord
      * Renamed input format fields
     I              BEAIC3                          TAAIC3
     I              BEC4NB                          TAC4NB
     I              BEJNCD                          TAJNCD
     I              BEANC7                          TAANC7
     I              BEBKC7                          TABKC7
     I              BEBRTX                          TABRTX
     I              BEHMNA                          TAHMNA
     I              BEHONA                          TAHONA
     I              BEHPNA                          TAHPNA
     I              BEHNNA                          TAHNNA
     I              BEDBCD                          TADBCD
     I              BECKTX                          TACKTX
     I              BEB0C7                          TAB0C7
     I              BEAETX                          TAAETX
     I              BEB1NA                          TAB1NA
     I              BEB3NA                          TAB3NA
     I              BEB4NA                          TAB4NA
     I              BEB2NA                          TAB2NA
     I              BEBHCD                          TABHCD
     I              BEC8TX                          TAC8TX
     I              BEBCNA                          TABCNA
     I              BEA0DT                          TAA0DT
     I              BEA5DT                          TAA5DT
     I              BEGNDT                          TAGNDT
     I              BEACDT                          TAACDT
     I              BEAQCD                          TAAQCD
     I              BEB6NA                          TAB6NA
     I              BEBYNA                          TABYNA
     I              BEBZNA                          TABZNA
     I              BEGTST                          TAGTST
     I              BEGVST                          TAGVST
     I              BEGUST                          TAGUST
     I              BEQFST                          TAQFST
     I              BECQCD                          TACQCD
     I              BEGJST                          TAGJST
     I              BEGWST                          TAGWST
     I              BEGXST                          TAGXST
     I              BEGYST                          TAGYST
     I              BEAODT                          TAAODT
     I              BEAIVN                          TAAIVN
     I              BECXDT                          TACXDT
     I              BEJZVA                          TAJZVA
     I              BEA1WG                          TAA1WG
     I              BEXIST                          TAXIST
     I              BEXJST                          TAXJST
     I              BEXKST                          TAXKST
     I              BEEIDT                          TAEIDT
     I              BEAFTM                          TAAFTM
     I              BEE8CD                          TAE8CD
     I              BEE9CD                          TAE9CD
     I              BERMNB                          TARMNB
     I              BETBNB                          TATBNB
     I              BER1NB                          TAR1NB
     I              BEPJST                          TAPJST
     I              BEU0ST                          TAU0ST
     I              BEU1ST                          TAU1ST
     I              BEQ2CD                          TAQ2CD
     I              BEU2ST                          TAU2ST
     I              BEVEST                          TAVEST
     I              BEVFST                          TAVFST
     I              BEVGST                          TAVGST
     I              BERPCD                          TARPCD
     I              BERNNB                          TARNNB
     I              BEVDST                          TAVDST
     I              BEATIN                          TAATIN
     I              BEU4ST                          TAU4ST
     I              BEU5ST                          TAU5ST
     I              BERSRN                          TARSRN
     I              BEMHNA                          TAMHNA
     I              BEMINA                          TAMINA
     I              BEWBST                          TAWBST
     I              BER4CD                          TAR4CD
     I              BEBFCD                          TABFCD
     I              BEQ4CD                          TAQ4CD
     I              BET3NB                          TAT3NB
     I              BESICD                          TASICD
     I              BECONB                          TACONB
     I              BECEST                          TACEST
     I              BEAWDT                          TAAWDT
     I              BEJPCD                          TAJPCD
     I              BEXUST                          TAXUST
     I              BEZ1ST                          TAZ1ST
     I              BEVRVA                          TAVRVA
     I              BEOBST                          TAOBST
     I              BEBCST                          TABCST
     I              BEBDST                          TABDST
     I              BEB7VL                          TAB7VL
     I              BEGASX                          TAGASX
     I              BEGBSX                          TAGBSX
     I              BEGCSX                          TAGCSX
     I              BEGDSX                          TAGDSX
     I              BEFNSX                          TAFNSX
     I              BEFOSX                          TAFOSX
     I              BEFPSX                          TAFPSX
     I              BEFQSX                          TAFQSX
     I              BEFRSX                          TAFRSX
     I              BEFSSX                          TAFSSX
     I              BEFTSX                          TAFTSX
     I              BEFUSX                          TAFUSX
     I              BEFVSX                          TAFVSX
     I              BEFWSX                          TAFWSX
     I              BEFXSX                          TAFXSX
     I              BEFYSX                          TAFYSX
     I              BENODT                          TANODT
     I              BENPDT                          TANPDT
     I              BENQDT                          TANQDT
     I              BENRDT                          TANRDT
     I              BENSDT                          TANSDT
     I              BEBPTM                          TABPTM
     I              BEBQTM                          TABQTM
     I              BEBRTM                          TABRTM
     I              BEBSTM                          TABSTM
     I              BEBTTM                          TABTTM
     I              BEH0NX                          TAH0NX
     I              BEH1NX                          TAH1NX
     I              BEH2NX                          TAH2NX
     I              BEH3NX                          TAH3NX
     I              BEH4NX                          TAH4NX
     I              BEC0C7                          TAC0C7
     I              BEUVST                          TAUVST
     I              BEUWST                          TAUWST
     I              BEUXST                          TAUXST
     I              BEAATM                          TAAATM
     I              BEAYNA                          TAAYNA
     I              BEA0NA                          TAA0NA
     I              BEAXDT                          TAAXDT
      *
     I@ABREG3
      * Company Name and Address  Retrieval index       NV
      * Renamed input format fields
     I              ABAIC3                          TBAIC3
     I              ABADTX                          TBADTX
     I              ABACNA                          TBACNA
     I              ABADNA                          TBADNA
     I              ABAENA                          TBAENA
     I              ABAJNA                          TBAJNA
     I              ABBTTX                          TBBTTX
     I              ABBVTX                          TBBVTX
     I              ABBWTX                          TBBWTX
     I              ABA2NA                          TBA2NA
     I              ABABTX                          TBABTX
     I              ABBGCD                          TBBGCD
     I              ABKXCD                          TBKXCD
     I              ABUVST                          TBUVST
     I              ABUWST                          TBUWST
     I              ABUXST                          TBUXST
     I              ABVSST                          TBVSST
     I              ABAATM                          TBAATM
     I              ABAYNA                          TBAYNA
     I              ABA0NA                          TBA0NA
     I              ABAXDT                          TBAXDT
      *
     I@DRRETH
      * User Profile Control      Retrieval index       NV
      * Renamed input format fields
     I              DRAJVN                          TCAJVN
     I              DRAUNA                          TCAUNA
     I              DRB8NA                          TCB8NA
     I              DRAHVN                          TCAHVN
     I              DRI6ST                          TCI6ST
     I              DRI7ST                          TCI7ST
     I              DRXMST                          TCXMST
     I              DRXNST                          TCXNST
     I              DRI8ST                          TCI8ST
     I              DRNLNB                          TCNLNB
     I              DRMPNA                          TCMPNA
     I              DRBCCD                          TCBCCD
     I              DRAIC3                          TCAIC3
     I              DRDQCD                          TCDQCD
     I              DRDRCD                          TCDRCD
     I              DRAJCD                          TCAJCD
     I              DRBUVN                          TCBUVN
     I              DRUVST                          TCUVST
     I              DRUWST                          TCUWST
     I              DRUXST                          TCUXST
     I              DRAATM                          TCAATM
     I              DRAYNA                          TCAYNA
     I              DRA0NA                          TCA0NA
     I              DRAXDT                          TCAXDT
      *
     I@DTRETE
      * User Application Profile  Retrieval index       NV
      * Renamed input format fields
     I              DTAJVN                          TDAJVN
     I              DTDNCD                          TDDNCD
     I              DTAIC3                          TDAIC3
     I              DTDQCD                          TDDQCD
     I              DTDRCD                          TDDRCD
     I              DTAJCD                          TDAJCD
     I              DTJFST                          TDJFST
     I              DTUVST                          TDUVST
     I              DTUWST                          TDUWST
     I              DTUXST                          TDUXST
     I              DTAATM                          TDAATM
     I              DTAYNA                          TDAYNA
     I              DTA0NA                          TDA0NA
     I              DTAXDT                          TDAXDT
      *
     I@DNRESF
      * Application               RSQ Application Code
      * Renamed input format fields
     I              DNDNCD                          TEDNCD
     I              DNAUNA                          TEAUNA
     I              DNVKST                          TEVKST
     I              DNRSCD                          TERSCD
     I              DNUVST                          TEUVST
     I              DNUWST                          TEUWST
     I              DNUXST                          TEUXST
     I              DNAATM                          TEAATM
     I              DNAYNA                          TEAYNA
     I              DNA0NA                          TEA0NA
     I              DNAXDT                          TEAXDT
      *
     I@JYRECE
      * Company Defaults Internal Active Records
      * Renamed input format fields
     I              JYAIC3                          TFAIC3
     I              JYZ9ST                          TFZ9ST
     I              JYCSST                          TFCSST
     I              JYZ8ST                          TFZ8ST
     I              JYCXST                          TFCXST
     I              JYSWST                          TFSWST
     I              JYXXTM                          TFXXTM
     I              JYUECD                          TFUECD
     I              JYHSST                          TFHSST
     I              JYAMEO                          TFAMEO
     I              JYSSDF                          TFSSDF
     I              JYPDFT                          TFPDFT
     I              JYYISX                          TFYISX
     I              JYYJSX                          TFYJSX
     I              JYYKSX                          TFYKSX
     I              JYYLSX                          TFYLSX
     I              JYYMSX                          TFYMSX
     I              JYYNSX                          TFYNSX
     I              JYUVST                          TFUVST
     I              JYUWST                          TFUWST
     I              JYUXST                          TFUXST
     I              JYVSST                          TFVSST
     I              JYAATM                          TFAATM
     I              JYAYNA                          TFAYNA
     I              JYA0NA                          TFA0NA
     I              JYAXDT                          TFAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXTCK2       DS
      * Time: hours, minutes, seconds (2)
     I                                        1   60XTTIM2
     I                                        1   20XTHH2
     I                                        3   40XTNN2
     I                                        5   60XTSS2
     IQOMFJ1    E DSOMFJCPL1
      * UPD : Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WDRMNB
     I              FJAIC3                          WDAIC3
     I              FJAODT                          WDAODT
     I              FJPJST                          WDPJST
     I              FJPKST                          WDPKST
     I              FJRNNB                          WDRNNB
     I              FJDMTX                          WDDMTX
     I              FJDNTX                          WDDNTX
     I              FJDOTX                          WDDOTX
     I              FJWTTX                          WDWTTX
     I              FJWUTX                          WDWUTX
     I              FJRPNB                          WDRPNB
     I              FJFLAM                          WDFLAM
     I              FJXQST                          WDXQST
     I              FJRRNB                          WDRRNB
     I              FJDXTX                          WDDXTX
     I              FJDYTX                          WDDYTX
     I              FJSBNB                          WDSBNB
     I              FJBZNA                          WDBZNA
     I              FJRONB                          WDRONB
     I              FJSQNB                          WDSQNB
     I              FJR1NB                          WDR1NB
     I              FJVCST                          WDVCST
     I              FJVDST                          WDVDST
     I              FJSDNB                          WDSDNB
     I              FJPAOU                          WDPAOU
     I              FJDGWG                          WDDGWG
     I              FJSXNB                          WDSXNB
     I              FJHADT                          WDHADT
     I              FJAART                          WDAART
     I              FJDHWG                          WDDHWG
     I              FJDIWG                          WDDIWG
     I              FJAQDT                          WDAQDT
     I              FJS6NB                          WDS6NB
     I              FJT4NB                          WDT4NB
     I              FJPRTM                          WDPRTM
     I              FJNPSV                          WDNPSV
     I              FJJ8TX                          WDJ8TX
     I              FJTLMI                          WDTLMI
     I              FJJ9TX                          WDJ9TX
     I              FJQ2CD                          WDQ2CD
     I              FJVPCD                          WDVPCD
     I              FJDBCD                          WDDBCD
     I              FJGRWE                          WDGRWE
     I              FJXCCD                          WDXCCD
     I              FJU2ST                          WDU2ST
     I              FJF9DT                          WDF9DT
     I              FJONTM                          WDONTM
     I              FJJ4DT                          WDJ4DT
     I              FJTRTM                          WDTRTM
     I              FJJ5DT                          WDJ5DT
     I              FJSPTM                          WDSPTM
     I              FJJ6DT                          WDJ6DT
     I              FJLFTM                          WDLFTM
     I              FJJ7DT                          WDJ7DT
     I              FJBOTM                          WDBOTM
     I              FJJ8DT                          WDJ8DT
     I              FJBLTM                          WDBLTM
     I              FJKIDT                          WDKIDT
     I              FJASTM                          WDASTM
     I              FJKADT                          WDKADT
     I              FJAJCM                          WDAJCM
     I              FJXACD                          WDXACD
     I              FJOANA                          WDOANA
     I              FJK4TX                          WDK4TX
     I              FJVOAG                          WDVOAG
     I              FJKBDT                          WDKBDT
     I              FJNBBO                          WDNBBO
     I              FJW4CD                          WDW4CD
     I              FJEFDT                          WDEFDT
     I              FJCNTN                          WDCNTN
     I              FJKCDT                          WDKCDT
     I              FJTMIN                          WDTMIN
     I              FJKDDT                          WDKDDT
     I              FJVMNB                          WDVMNB
     I              FJOCFR                          WDOCFR
     I              FJKJDT                          WDKJDT
     I              FJATTM                          WDATTM
     I              FJOTRS                          WDOTRS
     I              FJRNST                          WDRNST
     I              FJBRBK                          WDBRBK
     I              FJEIDT                          WDEIDT
     I              FJRMST                          WDRMST
     I              FJAJCD                          WDAJCD
     I              FJKKDT                          WDKKDT
     I              FJAVTM                          WDAVTM
     I              FJKZDT                          WDKZDT
     I              FJAXTM                          WDAXTM
     I              FJLHOS                          WDLHOS
     I              FJLHOR                          WDLHOR
     I              FJWNTX                          WDWNTX
     I              FJOITX                          WDOITX
     I              FJOJTX                          WDOJTX
     I              FJLLDT                          WDLLDT
     I              FJLSHG                          WDLSHG
     I              FJYPST                          WDYPST
     I              FJK0DT                          WDK0DT
     I              FJAYTM                          WDAYTM
     I              FJKNNX                          WDKNNX
     I              FJICWG                          WDICWG
     I              FJIDWG                          WDIDWG
     I              FJH9SX                          WDH9SX
     I              FJWOTX                          WDWOTX
     I              FJK1DT                          WDK1DT
     I              FJAZTM                          WDAZTM
     I              FJK2DT                          WDK2DT
     I              FJA0TM                          WDA0TM
     I              FJROST                          WDROST
     I              FJRPST                          WDRPST
     I              FJRQST                          WDRQST
     I              FJRRST                          WDRRST
     I              FJZBVA                          WDZBVA
     I              FJWPTX                          WDWPTX
     I              FJWQTX                          WDWQTX
     I              FJWRTX                          WDWRTX
     I              FJWSTX                          WDWSTX
     I              FJRVSX                          WDRVSX
     I              FJRUSX                          WDRUSX
     I              FJRWSX                          WDRWSX
     I              FJRXSX                          WDRXSX
     I              FJRYSX                          WDRYSX
     I              FJRZSX                          WDRZSX
     I              FJR0SX                          WDR0SX
     I              FJR1SX                          WDR1SX
     I              FJR2SX                          WDR2SX
     I              FJR3SX                          WDR3SX
     I              FJR4SX                          WDR4SX
     I              FJPYDT                          WDPYDT
     I              FJCKTM                          WDCKTM
     I              FJPZDT                          WDPZDT
     I              FJCLTM                          WDCLTM
     I              FJP0DT                          WDP0DT
     I              FJCMTM                          WDCMTM
     I              FJP1DT                          WDP1DT
     I              FJCNTM                          WDCNTM
     I              FJP2DT                          WDP2DT
     I              FJCOTM                          WDCOTM
     I              FJP3DT                          WDP3DT
     I              FJCQTM                          WDCQTM
     I              FJUVST                          WDUVST
     I              FJUWST                          WDUWST
     I              FJUXST                          WDUXST
     I              FJAATM                          WDAATM
     I              FJAYNA                          WDAYNA
     I              FJA0NA                          WDA0NA
     I              FJAXDT                          WDAXDT
      *
     IYARDCS      DS                            793
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WGAIC3
     I              OMC4NB                          WGC4NB
     I              OMDPNB                          WGDPNB
     I              OMUENB                          WGUENB
     I              OMHGCD                          WGHGCD
     I              OMAJCD                          WGAJCD
     I              OMBKC7                          WGBKC7
     I              OMCFC7                          WGCFC7
     I              OMGMST                          WGGMST
     I              OMGNST                          WGGNST
     I              OMMAVA                          WGMAVA
     I              OMKDVA                          WGKDVA
     I              OML8VA                          WGL8VA
     I              OML9VA                          WGL9VA
     I              OMGTST                          WGGTST
     I              OMGVST                          WGGVST
     I              OMGUST                          WGGUST
     I              OMQFST                          WGQFST
     I              OMAYVA                          WGAYVA
     I              OMEXDT                          WGEXDT
     I              OMLQCD                          WGLQCD
     I              OMRDCD                          WGRDCD
     I              OMQ7CD                          WGQ7CD
     I              OMBZPR                          WGBZPR
     I              OML6NB                          WGL6NB
     I              OMU1ST                          WGU1ST
     I              OMGIDT                          WGGIDT
     I              OMCRCD                          WGCRCD
     I              OMAGCD                          WGAGCD
     I              OMRZST                          WGRZST
     I              OMR0ST                          WGR0ST
     I              OMR1ST                          WGR1ST
     I              OMG7NA                          WGG7NA
     I              OMG8NA                          WGG8NA
     I              OMRPCD                          WGRPCD
     I              OMVEST                          WGVEST
     I              OMVGST                          WGVGST
     I              OMAVST                          WGAVST
     I              OMU0ST                          WGU0ST
     I              OMRFCD                          WGRFCD
     I              OMFZST                          WGFZST
     I              OMR1NB                          WGR1NB
     I              OMAVQT                          WGAVQT
     I              OMD0WG                          WGD0WG
     I              OMCCQT                          WGCCQT
     I              OMAUWG                          WGAUWG
     I              OMCBQT                          WGCBQT
     I              OMATWG                          WGATWG
     I              OMAQCS                          WGAQCS
     I              OMAGCS                          WGAGCS
     I              OMAKPR                          WGAKPR
     I              OMALPR                          WGALPR
     I              OMAUPR                          WGAUPR
     I              OMAVWG                          WGAVWG
     I              OMA4WG                          WGA4WG
     I              OMA5DT                          WGA5DT
     I              OMAODT                          WGAODT
     I              OMGNDT                          WGGNDT
     I              OMAMST                          WGAMST
     I              OMANST                          WGANST
     I              OMVAST                          WGVAST
     I              OMRGNB                          WGRGNB
     I              OMRHNB                          WGRHNB
     I              OMRINB                          WGRINB
     I              OMRBCD                          WGRBCD
     I              OMHICD                          WGHICD
     I              OMRNCD                          WGRNCD
     I              OMROCD                          WGROCD
     I              OMCXDT                          WGCXDT
     I              OMAJVN                          WGAJVN
     I              OMKXCD                          WGKXCD
     I              OMJPCD                          WGJPCD
     I              OMCQCD                          WGCQCD
     I              OMR4CD                          WGR4CD
     I              OMZ1ST                          WGZ1ST
     I              OMZ3ST                          WGZ3ST
     I              OMZ4ST                          WGZ4ST
     I              OMDUPR                          WGDUPR
     I              OMB6VL                          WGB6VL
     I              OMA1AA                          WGA1AA
     I              OMFZSX                          WGFZSX
     I              OMF0SX                          WGF0SX
     I              OMF1SX                          WGF1SX
     I              OMF2SX                          WGF2SX
     I              OMF3SX                          WGF3SX
     I              OMF4SX                          WGF4SX
     I              OMF5SX                          WGF5SX
     I              OMF6SX                          WGF6SX
     I              OMF7SX                          WGF7SX
     I              OMNTDT                          WGNTDT
     I              OMNUDT                          WGNUDT
     I              OMNVDT                          WGNVDT
     I              OMNWDT                          WGNWDT
     I              OMNXDT                          WGNXDT
     I              OMBUTM                          WGBUTM
     I              OMBVTM                          WGBVTM
     I              OMBWTM                          WGBWTM
     I              OMBXTM                          WGBXTM
     I              OMBYTM                          WGBYTM
     I              OMH5NX                          WGH5NX
     I              OMH6NX                          WGH6NX
     I              OMH7NX                          WGH7NX
     I              OMH8NX                          WGH8NX
     I              OMH9NX                          WGH9NX
     I              OMDVPR                          WGDVPR
     I              OMDWPR                          WGDWPR
     I              OMDXPR                          WGDXPR
     I              OMDYPR                          WGDYPR
     I              OMDZPR                          WGDZPR
     I              OMGSPR                          WGGSPR
     I              OMGTPR                          WGGTPR
     I              OMGUPR                          WGGUPR
     I              OMHOST                          WGHOST
     I              OMHPST                          WGHPST
     I              OMIOST                          WGIOST
     I              OMPEWG                          WGPEWG
     I              OMRINY                          WGRINY
     I              OMTIDT                          WGTIDT
     I              OMTJDT                          WGTJDT
     I              OMH2ST                          WGH2ST
     I              OMH0ST                          WGH0ST
     I              OMH1ST                          WGH1ST
     I              OMTKDT                          WGTKDT
     I              OMTLDT                          WGTLDT
     I              OMTMDT                          WGTMDT
     I              OMUVST                          WGUVST
     I              OMUWST                          WGUWST
     I              OMUXST                          WGUXST
     I              OMAATM                          WGAATM
     I              OMAYNA                          WGAYNA
     I              OMA0NA                          WGA0NA
     I              OMAXDT                          WGAXDT
      *
     IYBRDCS      DS                            525
     IQOMFL1    E DSOMFLCPL0
      * UPD : Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WHRMNB
     I              FLRUNB                          WHRUNB
     I              FLRVNB                          WHRVNB
     I              FLDQTX                          WHDQTX
     I              FLRWNB                          WHRWNB
     I              FLRXNB                          WHRXNB
     I              FLSQNB                          WHSQNB
     I              FLT0NB                          WHT0NB
     I              FLT1NB                          WHT1NB
     I              FLR1NB                          WHR1NB
     I              FLAIC3                          WHAIC3
     I              FLC4NB                          WHC4NB
     I              FLVCST                          WHVCST
     I              FLKEDT                          WHKEDT
     I              FLSXNB                          WHSXNB
     I              FLKFDT                          WHKFDT
     I              FLACTM                          WHACTM
     I              FLK5TX                          WHK5TX
     I              FLW5CD                          WHW5CD
     I              FLEJDT                          WHEJDT
     I              FLAGTM                          WHAGTM
     I              FLKJDT                          WHKJDT
     I              FLATTM                          WHATTM
     I              FLHDDT                          WHHDDT
     I              FLAUTM                          WHAUTM
     I              FLKKDT                          WHKKDT
     I              FLAVTM                          WHAVTM
     I              FLZ4NB                          WHZ4NB
     I              FLY7ST                          WHY7ST
     I              FLY2ST                          WHY2ST
     I              FLWHTX                          WHWHTX
     I              FLWITX                          WHWITX
     I              FLWJTX                          WHWJTX
     I              FLWKTX                          WHWKTX
     I              FLWLTX                          WHWLTX
     I              FLN7DT                          WHN7DT
     I              FLN8DT                          WHN8DT
     I              FLN9DT                          WHN9DT
     I              FLB3TM                          WHB3TM
     I              FLB4TM                          WHB4TM
     I              FLB5TM                          WHB5TM
     I              FLIASX                          WHIASX
     I              FLIBSX                          WHIBSX
     I              FLICSX                          WHICSX
     I              FLWVTX                          WHWVTX
     I              FLWWTX                          WHWWTX
     I              FLWXTX                          WHWXTX
     I              FLUVST                          WHUVST
     I              FLUWST                          WHUWST
     I              FLUXST                          WHUXST
     I              FLAATM                          WHAATM
     I              FLAYNA                          WHAYNA
     I              FLA0NA                          WHA0NA
     I              FLAXDT                          WHAXDT
      *
     IYCRDCS      DS                            367
     IYDRDCS      DS                            793
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Load Header
      * I :  Load ID
     I                                    P   1   40P1RMNB
      * I :  Company Number
     I                                    P   5   60P1AIC3
      * I :  Scheduled Ship Date
     I                                    P   7  100P1AODT
      * I :  Load Status
     I                                       11  11 P1PKST
      * I :  Reefer Temperature
     I                                    P  12  142P1RNNB
      * I :  Seal 1
     I                                       15  29 P1DMTX
      * I :  Seal 2
     I                                       30  44 P1DNTX
      * I :  Seal 3
     I                                       45  59 P1DOTX
      * I :  Total Load Order Weight
     I                                    P  60  630P1RPNB
      * N :  Flat Amount
     I                                    P  64  692P1FLAM
      * N :  Allocate Pounds/Miles
     I                                       70  70 P1XQST
      * N :  Total Stops
     I                                    P  71  730P1RRNB
      * I :  Trailer Id
     I                                       74  93 P1DXTX
      * I :  Load Type
     I                                       94  94 P1VDST
      * I :  Number Pallets Received
     I                                    P  95  970P1SDNB
      * I :  Number Pallets Loaded
     I                                    P  98 1000P1PAOU
      * I :  Product Temperature
     I                                    P 101 1032P1PRTM
      * I :  Number Spacers Loaded
     I                                    P 104 1060P1NPSV
      * I :  Car/Veh. Initials
     I                                      107 118 P1J8TX
      * I :  Total Load Miles
     I                                    P 119 1220P1TLMI
      * I :  Recorder ID
     I                                      123 134 P1J9TX
      * I :  Shipping Method
     I                                      135 136 P1Q2CD
      * I :  Ship From Warehouse
     I                                      137 139 P1VPCD
      * I :  Ship To State Code
     I                                      140 141 P1DBCD
      * I :  Export Status
     I                                      142 142 P1U2ST
      * I :  BOL Complete Date
     I                                    P 143 1460P1J7DT
      * I :  BOL Complete Time
     I                                    P 147 1500P1BOTM
      * I :  Scheduled Delivery Date
     I                                    P 151 1540P1KJDT
      * I :  Scheduled Delivery Time
     I                                    P 155 1580P1ATTM
      * I :  Avg Pallet Tare
     I                                    P 159 1632P1ICWG
      * I :  Tot Pallet Tare
     I                                    P 164 1682P1IDWG
      * I :  Export Load USDA-OK
     I                                      169 169 P1RQST
      * I :  Shipping Temp C/F txt
     I                                      170 194 P1WRTX
      * B :  EDI Status 1
     I                                      195 195 P1UVST
      * N :  Job Time
     I                                    P 196 1990P1AATM
      * N :  Job Date
     I                                    P 200 2030P1AXDT
     IP2PARM      DS
      * FLD: Print Options
      * B :  PRT Description
     I                                        1  25 P2G3TX
      * B :  PRT Printer Device
     I                                       26  35 P2WRST
      * B :  PRT Hold Output Sts
     I                                       36  39 P2WSST
      * B :  PRT Save Output Sts
     I                                       40  43 P2WTST
      * B :  PRT Number of Copies
     I                                       44  450P2DYNB
     IP3PARM      DS
      * I :  USR Flag 1
     I                                        1   1 P3D4ST
     IP4PARM      DS
      * I :  Unused Status USR
     I                                        1   1 P4AZSX
     IP5PARM      DS
      * FLD: *Arrays
      * N :  *Elapsed time (result)
     I                                    P   1   30P5TRE
     IP6PARM      DS
      * I :  USR Warehouse Code
     I                                        1   3 P6CPCD
     IP7PARM      DS
      * N :  HPB Transload Station
     I                                        1   2 P7ICSX
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Enter Fahrenheit or Cels'
      * Message data for 'Trailer id is required'
      * Trailer ID USR
     I                                        1  12 ZA0001
      * Message data for 'COA Transloading Stati NF'
      * COA Station Code
     I                                        1   2 ZA0002
      * Message data for 'Both Total Pallet ...'
      * Number Pallets Loaded
     I                                    P   1   30ZA0003
      * Tot Pallet Tare
     I                                    P   4   82ZA0004
      * Message data for 'Pallet Tare Info Req ...'
      * Number Pallets Loaded
     I                                    P   1   30ZA0005
      * Tot Pallet Tare
     I                                    P   4   82ZA0006
      * Message data for 'Pallet Tare Info Not ...'
      * Number Pallets Loaded
     I                                    P   1   30ZA0007
      * Tot Pallet Tare
     I                                    P   4   82ZA0008
      * Message data for 'Pallet Tare Info Not...'
      * Number Pallets Loaded
     I                                    P   1   30ZA0009
      * Tot Pallet Tare
     I                                    P   4   82ZA0010
      * Message data for 'Load needs USDA Approval'
      * Export Load USDA-OK
     I                                        1   1 ZA0011
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0012
      * Application Code
     I                                       11  16 ZA0013
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0014
      * Application Code
     I                                       11  16 ZA0015
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1RMNB    PARM           WP0001  70       Load ID
     C           P1AIC3    PARM           WP0002  30       Company Number
     C           P1AODT    PARM           WP0003  70       Scheduled Ship
     C           P1PKST    PARM           WP0004  1        Load Status
     C           P1RNNB    PARM           WP0005  52       Reefer Temperat
     C           P1DMTX    PARM           WP0006 15        Seal 1
     C           P1DNTX    PARM           WP0007 15        Seal 2
     C           P1DOTX    PARM           WP0008 15        Seal 3
     C           P1RPNB    PARM           WP0009  70       Total Load Orde
     C           P1DXTX    PARM           WP0010 20        Trailer Id
     C           P1VDST    PARM           WP0011  1        Load Type
     C           P1SDNB    PARM           WP0012  50       Number Pallets
     C           P1PAOU    PARM           WP0013  50       Number Pallets
     C           P1PRTM    PARM           WP0014  52       Product Tempera
     C           P1NPSV    PARM           WP0015  50       Number Spacers
     C           P1J8TX    PARM           WP0016 12        Car/Veh. Initia
     C           P1TLMI    PARM           WP0017  70       Total Load Mile
     C           P1J9TX    PARM           WP0018 12        Recorder ID
     C           P1Q2CD    PARM           WP0019  2        Shipping Method
     C           P1VPCD    PARM           WP0020  3        Ship From Wareh
     C           P1DBCD    PARM           WP0021  2        Ship To State C
     C           P1U2ST    PARM           WP0022  1        Export Status
     C           P1J7DT    PARM           WP0023  70       BOL Complete Da
     C           P1BOTM    PARM           WP0024  60       BOL Complete Ti
     C           P1KJDT    PARM           WP0025  70       Scheduled Deliv
     C           P1ATTM    PARM           WP0026  60       Scheduled Deliv
     C           P1ICWG    PARM           WP0027  92       Avg Pallet Tare
     C           P1IDWG    PARM           WP0028  92       Tot Pallet Tare
     C           P1RQST    PARM           WP0029  1        Export Load USD
     C           P1WRTX    PARM           WP0030 25        Shipping Temp C
     C           P1UVST    PARM P1UVST    WP0031  1        EDI Status 1
     C           P2G3TX    PARM P2G3TX    WP0032 25        PRT Description
     C           P2WRST    PARM P2WRST    WP0033 10        PRT Printer Dev
     C           P2WSST    PARM P2WSST    WP0034  4        PRT Hold Output
     C           P2WTST    PARM P2WTST    WP0035  4        PRT Save Output
     C           P2DYNB    PARM P2DYNB    WP0036  20       PRT Number of C
     C           P3D4ST    PARM           WP0037  1        USR Flag 1
     C           P4AZSX    PARM           WP0038  1        Unused Status U
     C           P6CPCD    PARM           WP0039  3        USR Warehouse C
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Conduct screen conversation
     C                     DO   *HIVAL
      * Start new transaction
     C                     MOVEL'Y'       W0TRN   1
      * Process current transaction
     C           W0TRN     DOWEQ'Y'
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            MALDSC
      * Process screen input
     C                     CAS            DAPRSC
     C                     END
      *
     C                     END
      *
     C                     END
      *****************************************************************
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPRSC    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process command keys
      * CASE: DTL.*CMD key is *Exit
     C           *IN03     IFEQ '1'                        *IF
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     END
      * Validate screen input
     C                     EXSR DBVLSC
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * USER: User defined action
      * CASE: PAR.Load Status is Not Invoiced
     C           P1PKST    IFEQ 'C'                        *IF
     C           P1PKST    OREQ 'E'
     C           P1PKST    OREQ 'L'
     C           P1PKST    OREQ 'S'
     C           P1PKST    OREQ 'U'
      * Option 7 was taken to Recalc Scheduled Ship Date
      * CASE: PAR.USR Flag 1 is Yes
     C           P3D4ST    IFEQ 'Y'                        *IF
      * Calculate Scheduled Delivery Date
      * CASE: PAR.Total Load Miles EQ WRK.ZERO
     C           P1TLMI    IFEQ WUW0NB                     *IF
      * update scheduled delivery date/time to be NOW
     C                     Z-ADD##JDT     #1KJDT           Scheduled Deliv
     C                     Z-ADD##JTM     #1ATTM           Scheduled Deliv
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     Z-ADD*ZERO     WN0001  51       Hours Required
     C                     Z-ADD*ZERO     WN0002  50       Miles to next s
     C                     Z-ADD*ZERO     WN0003  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0004  51       USR Hours Remai
     C                     Z-ADD*ZERO     WN0005  51       USR Hours to Mi
     C                     Z-ADD*ZERO     WN0006  50       @Days 5
     C                     Z-ADD*ZERO     WN0007  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0008  20       USR Period
     C                     Z-ADD*ZERO     WN0009  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0010  40       Requested Deliv
      *
      * CLC Sched Delivery D/T IF
     C                     Z-ADD##JDT     #1KJDT           Scheduled Deliv
     C                     Z-ADD##JTM     #1ATTM           Scheduled Deliv
      * RTV 1st Stop Mile,Dlv  RT - Load Detail  * 
     C                     EXSR SARVGN
      * requested delivery time is hh:mm, needs to be hh:mm:ss
     C           WN0010    MULT 100       WN0003           Deadline Depart
      * RTV Legal Run Mileage  RT - Legal Run Mileage/Hours  * 
     C                     EXSR SCRVGN
      * get number of whole days + remaining hours
      * Calculate # whole days + hours left
      * CASE: PAR.Hours Required is Less than 1 day
     C           WN0001    IFLT 24                         *IF
     C                     Z-ADD*ZERO     WN0006           @Days 5
     C                     Z-ADDWN0001    WN0004           USR Hours Remai
     C                     ELSE
      * CASE: *OTHERWISE
     C           WN0001    DIV  24        WN0006           @Days 5
     C                     MVR            WN0004           USR Hours Remai
     C                     END                             *FI
      * Add # whole days to current date
      * CASE: PAR.@Days 5 EQ WRK.ZERO
     C           WN0006    IFEQ WUW0NB                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR.Scheduled Delivery Date = PAR.Scheduled Delivery Date + PAR.@
     C           #1KJDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN0006    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     #1KJDT
     C                     ELSE
     C           XDINDT    SUB  1000000   #1KJDT
     C                     END
     C                     END                             *FI
      * WRK.Scheduled Delivery Time = CON.*ZERO + PAR.USR Hours Remaining
     C                     Z-ADD*ZERO     XTTIM
     C                     Z-ADD*ZERO     XASC    80
     C                     EXSR XTAD1
     C           3600      MULT WN0004    XDWK1   80
     C                     ADD  XDWK1     XASC    80
     C                     EXSR XTCT1
     C                     Z-ADDXTTIM     WUATTM
      * PAR.USR Hours Remaining = WRK.Scheduled Delivery Time *HOURS
     C                     Z-ADDWUATTM    XTTIM
     C                     Z-ADDXTHH      WN0004
      * Calculate scheduled delivery time; recalc date if past midnight
      * CASE: PAR.USR Hours Remaining is Not Zero
     C           WN0004    IFNE 0                          *IF
      * PAR.Estimated Arrival Time = CON.240000 - PAR.Scheduled Delivery
     C                     Z-ADD#1ATTM    XTTIM2
     C                     Z-ADD240000    XTTIM
     C                     EXSR XTCEL
     C           XTHH      MULT 100       WN0007
     C                     ADD  XTNN      WN0007
     C                     MULT 100       WN0007
     C                     ADD  XTSS      WN0007
     C                     MULT XSGN      WN0007
      * PAR.USR Hours to Midnight = PAR.Estimated Arrival Time *HOURS
     C                     Z-ADDWN0007    XTTIM
     C                     Z-ADDXTHH      WN0005
      * WRK.USR Period = PAR.Estimated Arrival Time *MINUTES
     C                     Z-ADDWN0007    XTTIM
     C                     Z-ADDXTNN      WUB1NB
      * calc minutes % hour
      * PGM.*Synon (15,2) work field =
      *    *COMPUTE ((x1 - x2) / x1)
      * x1    : CON.60
      * -     : PGM.*Synon (17,7) work field
      * x2    : WRK.USR Period
      * /     : PGM.*Synon (17,7) work field *
      * x1    : CON.60
     C           60        SUB  WUB1NB    W0WD01           *Synon (17,7) w
     C           W0WD01    DIV  60        W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    W0WA             *Synon (15,2) w
      * calc hours to midnight
      * PAR.USR Hours to Midnight =
      *    *COMPUTE (x1 + x3)
      * x1    : PAR.USR Hours to Midnight
      * +     : PGM.*Synon (17,7) work field
      * x3    : PGM.*Synon (15,2) work field
     C           WN0005    ADD  W0WA      W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0005           USR Hours to Mi
      * Add to date if going past midnight
      * CASE: PAR.USR Hours to Midnight LT PAR.USR Hours Remaining
     C           WN0005    IFLT WN0004                     *IF
      * PAR.Scheduled Delivery Date = PAR.Scheduled Delivery Date + CON.1
     C           #1KJDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     #1KJDT
     C                     ELSE
     C           XDINDT    SUB  1000000   #1KJDT
     C                     END
     C                     SUB  WN0005    WN0004           USR Hours Remai
      * PAR.Scheduled Delivery Time = CON.*ZERO + PAR.USR Hours Remaining
     C                     Z-ADD*ZERO     XTTIM
     C                     Z-ADD*ZERO     XASC    80
     C                     EXSR XTAD1
     C           3600      MULT WN0004    XDWK1   80
     C                     ADD  XDWK1     XASC    80
     C                     EXSR XTCT1
     C                     Z-ADDXTTIM     #1ATTM
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR.Scheduled Delivery Time = PAR.Scheduled Delivery Time + PAR.U
     C                     Z-ADD#1ATTM    XTTIM
     C                     Z-ADD*ZERO     XASC    80
     C                     EXSR XTAD1
     C           3600      MULT WN0004    XDWK1   80
     C                     ADD  XDWK1     XASC    80
     C                     EXSR XTCT1
     C                     Z-ADDXTTIM     #1ATTM
     C                     END                             *FI
     C                     END                             *FI
      * If sched delivery Date/Time < rqs. delivery date/time, use rqs.
      * CASE: PAR.Scheduled Delivery Date LT PAR.Requested Delivery Date
     C           #1KJDT    IFLT WN0009                     *IF
     C                     Z-ADDWN0009    #1KJDT           Scheduled Deliv
     C                     Z-ADDWN0003    #1ATTM           Scheduled Deliv
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Scheduled Delivery Date EQ PAR.Requested Deliver
      *   |- c2    : PAR.Scheduled Delivery Time LT PAR.Unused Time 2
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1KJDT    IFEQ WN0009                     *IF
     C           #1ATTM    IFLT WN0003                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWN0009    #1KJDT           Scheduled Deliv
     C                     Z-ADDWN0003    #1ATTM           Scheduled Deliv
     C                     ELSE
      * CASE: *OTHERWISE
      *    use calculated scheduled delivery date/time
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Load OM Load Header file fields prior to update
     C                     EXSR UASUBR                     Load OM Load He
      * *OMS336* Calculate Average Pallet Weight
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.Number Pallets Loaded is Greater than zero
      *   |- c2    : DTL.Tot Pallet Tare is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1PAOU    IFGT *ZERO                      *IF
     C           #1IDWG    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           #1IDWG    DIV  #1PAOU    #1ICWG    H      Avg Pallet Tare
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     #1ICWG           Avg Pallet Tare
     C                     END                             *FI
     C                     MOVEL*BLANK    #1WRTX           Shipping Temp C
     C                     MOVEL#DFRSX    #1WRTX           Shipping Temp C
      * CHG Loads for B.O.L.   CH - Load Header  * 
     C                     EXSR SDCHRC
      * FP1100 RMC 02/29/08 If Transload Stn changed, update load dtls
      * CASE: DTL.HPB Transload Station NE PAR.HPB Transload Station
     C           #DICSX    IFNE P7ICSX                     *IF
      * RTV Chg HPB Trans Stn RT - Load Detail  * 
     C                     EXSR SJRVGN
     C                     END                             *FI
     C                     END                             *FI
      * ** Retrieve CDD Type, Dept, and overlay name from Company
      * ** Document Defaults file       06/05/2007 LJB DLY029
     C                     MOVEL@CN,001   P2G3TX           PRT Description
     C                     MOVEL'BL'      YL0008           CDD Type
     C                     MOVEL*BLANK    YL0009           CDD Department
     C                     MOVEL'TRAFF'   YL0009           CDD Department
     C                     MOVELP4AZSX    WUAZSX           Unused Status U
     C                     MOVEL*BLANK    YL0010           CDD Name of Ove
      * FT1110 - If Company Org is "H"igh Plains, get BOL type from whse
      * CASE: LCL.Company Organization is High Plains Biodiesel
     C           YL0011    IFEQ 'H'                        *IF
      * Rtv HPB fields        RT - Warehouse  * 
     C                     EXSR SLRVGN
      * RMC 4/27/2011 E      HPB Only - use acctng co when rtv overlay nm
      * Rtv Acct Co          RT - Warehouse  * 
     C                     EXSR SMRVGN
      * CASE: LCL.WHS Req Meter Reading Shp is Yes
     C           YL0014    IFEQ 'Y'                        *IF
     C                     MOVEL'BL'      YL0008           CDD Type
     C                     MOVEL'N'       WUAZSX           Unused Status U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'BY'      YL0008           CDD Type
     C                     END                             *FI
      * RTV Co Document Dflts  RT - Company Document Defaults  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0015    WL0001           Company Number
     C                     MOVELYL0008    WL0002    P      CDD Type
     C                     MOVEL'TRAFF'   WL0003    P      CDD Department
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    YL0016    P      CDD Name of Ove
     C                     MOVELWL0005    YL0017    P      CDD Program Nam
     C                     MOVELWL0006    YL0018    P      CDD Printer Fil
     C                     MOVELWL0007    YN0001    P      CDD Sender Phon
     C                     MOVELWL0008    YN0002    P      CDD Sender Fax
     C                     MOVELWL0009    YL0019    P      Output Queue
     C                     MOVELWL0010    YL0020    P      Hold File
     C                     MOVELWL0011    YL0021    P      Save File
     C                     Z-ADDWL0012    YL0022           Source Drawer
     C                     MOVELWL0013    YL0023    P      Printer Device
     C                     Z-ADDWL0014    YL0024           Page Length 2
     C                     Z-ADDWL0015    YL0025           Page Width 2
     C                     Z-ADDWL0016    YL0026           Page LPI
     C                     Z-ADDWL0017    YL0027           Page CPI
     C                     Z-ADDWL0018    YL0028           Page Overflow
     C                     MOVELWL0019    YL0029    P      Page Rotation
     C                     MOVELWL0020    YN0003    P      CDD Comment 1
     C                     MOVELWL0021    YN0004    P      CDD Comment 2
     C                     MOVELWL0022    YN0005    P      CDD Comment 3
     C                     MOVELWL0023    YN0006    P      CDD Comment 4
     C                     MOVELWL0024    YN0007    P      CDD Comment 5
      * T15460 RMC 9.18.19 rtv back overlay for HPB only
      * RTV Co Document Dflts  RT - Company Document Defaults  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0015    WL0001           Company Number
     C                     MOVEL'BK'      WL0002    P      CDD Type
     C                     MOVEL'TRAFF'   WL0003    P      CDD Department
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    YL0010    P      CDD Name of Ove
     C                     MOVELWL0005    YN0008    P      CDD Program Nam
     C                     MOVELWL0006    YN0009    P      CDD Printer Fil
     C                     MOVELWL0007    YN0001    P      CDD Sender Phon
     C                     MOVELWL0008    YN0002    P      CDD Sender Fax
     C                     MOVELWL0009    YN0010    P      Output Queue
     C                     MOVELWL0010    YN0011    P      Hold File
     C                     MOVELWL0011    YN0012    P      Save File
     C                     Z-ADDWL0012    YN0013           Source Drawer
     C                     MOVELWL0013    YN0014    P      Printer Device
     C                     Z-ADDWL0014    YN0015           Page Length 2
     C                     Z-ADDWL0015    YN0016           Page Width 2
     C                     Z-ADDWL0016    YN0017           Page LPI
     C                     Z-ADDWL0017    YN0018           Page CPI
     C                     Z-ADDWL0018    YN0019           Page Overflow
     C                     MOVELWL0019    YN0020    P      Page Rotation
     C                     MOVELWL0020    YN0003    P      CDD Comment 1
     C                     MOVELWL0021    YN0004    P      CDD Comment 2
     C                     MOVELWL0022    YN0005    P      CDD Comment 3
     C                     MOVELWL0023    YN0006    P      CDD Comment 4
     C                     MOVELWL0024    YN0007    P      CDD Comment 5
      * PRT Bill of Lading CL  UP - /UT User Programs  * 
     C                     CALL 'PDA3PCL'              90  PRT Bill of Lad
     C           WUH3TX    PARM *BLANK    WQ0016  7        Return Code Usr
     C                     PARM 'OMS'     WQ0017  6        Application Cod
     C                     PARM P2G3TX    WQ0018 30        Description
     C                     PARM #1RMNB    WQ0019  70       Load ID
     C                     PARM YL0015    WQ0020  30       Company Number
     C                     PARM WUAZSX    WQ0021  1        Unused Status U
     C                     PARM YL0008    WQ0022  2        CDD Type
     C                     PARM YL0009    WQ0023  6        CDD Department
     C                     PARM YL0016    WQ0024  8        CDD Name of Ove
     C                     PARM YL0010    WQ0025  8        CDD Name of Ove
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDA3PCL' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Co Document Dflts  RT - Company Document Defaults  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0001           Company Number
     C                     MOVELYL0008    WL0002    P      CDD Type
     C                     MOVEL'TRAFF'   WL0003    P      CDD Department
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    YL0016    P      CDD Name of Ove
     C                     MOVELWL0005    YL0017    P      CDD Program Nam
     C                     MOVELWL0006    YL0018    P      CDD Printer Fil
     C                     MOVELWL0007    YN0001    P      CDD Sender Phon
     C                     MOVELWL0008    YN0002    P      CDD Sender Fax
     C                     MOVELWL0009    YL0019    P      Output Queue
     C                     MOVELWL0010    YL0020    P      Hold File
     C                     MOVELWL0011    YL0021    P      Save File
     C                     Z-ADDWL0012    YL0022           Source Drawer
     C                     MOVELWL0013    YL0023    P      Printer Device
     C                     Z-ADDWL0014    YL0024           Page Length 2
     C                     Z-ADDWL0015    YL0025           Page Width 2
     C                     Z-ADDWL0016    YL0026           Page LPI
     C                     Z-ADDWL0017    YL0027           Page CPI
     C                     Z-ADDWL0018    YL0028           Page Overflow
     C                     MOVELWL0019    YL0029    P      Page Rotation
     C                     MOVELWL0020    YN0003    P      CDD Comment 1
     C                     MOVELWL0021    YN0004    P      CDD Comment 2
     C                     MOVELWL0022    YN0005    P      CDD Comment 3
     C                     MOVELWL0023    YN0006    P      CDD Comment 4
     C                     MOVELWL0024    YN0007    P      CDD Comment 5
      * PRT Bill of Lading CL  UP - /UT User Programs  * 
     C                     CALL 'PDA3PCL'              90  PRT Bill of Lad
     C           WUH3TX    PARM *BLANK    WQ0026  7        Return Code Usr
     C                     PARM 'OMS'     WQ0027  6        Application Cod
     C                     PARM P2G3TX    WQ0028 30        Description
     C                     PARM #1RMNB    WQ0029  70       Load ID
     C                     PARM #1AIC3    WQ0030  30       Company Number
     C                     PARM WUAZSX    WQ0031  1        Unused Status U
     C                     PARM YL0008    WQ0032  2        CDD Type
     C                     PARM YL0009    WQ0033  6        CDD Department
     C                     PARM YL0016    WQ0034  8        CDD Name of Ove
     C                     PARM *BLANK    WQ0035  8        CDD Name of Ove
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDA3PCL' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * CASE: WRK.Return Code Usr is *User Quit Requested
     C           WUH3TX    IFEQ @CN,002                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Load Status is Not Invoiced
     C           P1PKST    IFEQ 'C'                        *IF
     C           P1PKST    OREQ 'E'
     C           P1PKST    OREQ 'L'
     C           P1PKST    OREQ 'S'
     C           P1PKST    OREQ 'U'
     C                     MOVEL'M'       P1UVST           EDI Status 1
      * Only update BOL Complete Date/Time if the Load has been shipped
      * CASE: PAR.Load Status is Shipped
     C           P1PKST    IFEQ 'S'                        *IF
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           #1J7DT    PARM *ZERO     WQ0036 155       Current System
     C           #1BOTM    PARM *ZERO     WQ0037 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * CHG BOL Printed        CH - Load Header  * 
     C                     EXSR SOCHRC
     C                     END                             *FI
      * Send message 'BOL has been submited'
     C                     MOVEL'USR1972' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
      *  FT1110 - If Company Org is "H"igh Plains, print 2nd bol IF:
      * CASE: LCL.Company Organization is High Plains Biodiesel
     C           YL0011    IFEQ 'H'                        *IF
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.CDD Type is Bill of Lading
      *   |- c2    : DTL.HPB Transload Station GT WRK.Blank for 4
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0008    IFEQ 'BL'                       *IF
     C           #DICSX    IFGT WUOTTX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV First Order on LoadRT - Load Detail  * 
     C                     EXSR SPRVGN
      * RTV HPB Override typeRT - Order Header Extension  * 
     C                     EXSR SQRVGN
      * CASE: LCL.OHE Override Type Code is No
     C           YL0031    IFEQ *BLANK                     *IF
      * RTV Ship Cust,Ordr Typ RT - Order Header TRG  * 
     C                     EXSR SRRVGN
      * RTV Type Code by Cust  RT - Company Customer  * 
     C                     EXSR SSRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELYL0031    YL0033           Type Code
     C                     END                             *FI
      * E2079 6/22/12 RMC  Print 2nd bol for MK custs only
      * CASE: LCL.Type Code is Marketing
     C           YL0033    IFEQ 'MK'                       *IF
      * Move "Y" to export sts and pass to BOL print to print the
      * HPB Transloading BOL
     C                     MOVEL@CN,003   P2G3TX           PRT Description
      * PRT Bill of Lading CL  UP - /UT User Programs  * 
     C                     CALL 'PDA3PCL'              90  PRT Bill of Lad
     C           WUH3TX    PARM *BLANK    WQ0039  7        Return Code Usr
     C                     PARM 'OMS'     WQ0040  6        Application Cod
     C                     PARM P2G3TX    WQ0041 30        Description
     C                     PARM #1RMNB    WQ0042  70       Load ID
     C                     PARM #1AIC3    WQ0043  30       Company Number
     C                     PARM 'Y'       WQ0044  1        Unused Status U
     C                     PARM YL0008    WQ0045  2        CDD Type
     C                     PARM YL0009    WQ0046  6        CDD Department
     C                     PARM YL0016    WQ0047  8        CDD Name of Ove
     C                     PARM YL0010    WQ0048  8        CDD Name of Ove
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDA3PCL' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Return Code Usr is *User Quit Requested
     C           WUH3TX    IFEQ @CN,002                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'BOL has been submited'
     C                     MOVEL'USR1972' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Exit program
     C                     EXSR ZXEXPG
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBVLSC    BEGSR
      *================================================================
      * Validate screen input
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Validate Export Load USDA-OK
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1RQST'  IFEQ YPMTFD
      * Export Load USDA-OK
     C                     MOVEL#1RQST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHRQST
     C                     SELEC
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD1         ZHRQST
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD2         ZHRQST
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD3         ZHRQST
     C                     ENDSL
     C                     EXFMTZGRQST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHRQST    WHEQ 1
     C                     MOVEL'Y'       W0INVL           Y
     C           ZHRQST    WHEQ 2
     C                     MOVEL'N'       W0INVL           N
     C           ZHRQST    WHEQ 3
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1RQST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate fields
      * DTL.Condition Desc. 10 USR = Condition name of DTL.Shipping Metho
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1252129   Y2LSNO  70       List number
     C                     PARM #1Q2CD    W0INVL 25        Shipping Method
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHUTX    PARM           W0CNNM 25        Condition Desc.
      *
      * C=Celsius and F=Fahrenheit
      * CASE: LCL.Display Flag is Yes
     C           YL0034    IFEQ 'Y'                        *IF
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DTL.Reefer Temperature is Entered
      *   |- c2    : DTL.Shipping Temp Code C/F EQ WRK.Blank for 4
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1RNNB    IFNE *ZERO                      *IF
     C           #DFRSX    IFEQ WUOTTX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Send message 'Enter Fahrenheit or Cels'
     C                     MOVEL'USR3139' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * RTV Alpha Value        RT - Company Values  * 
     C                     EXSR STRVGN
      * DLY029 RMC 09/05/07
      * CASE: WRK.Status Flag 1  Y/N is Yes
     C           WUQ1ST    IFEQ 'Y'                        *IF
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.Trailer ID USR is Not Entered
      *   |- c2    : LCL.Company Organization is Seaboard
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DS2TX    IFEQ *BLANK                     *IF
     C           YL0011    IFEQ 'S'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#DS2TX    ZA0001           Trailer ID USR
      * Send message 'Trailer id is required'
     C                     MOVEL'USR3795' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * FP1110 RMC 02/29/08
      * CASE: LCL.Company Organization is High Plains Biodiesel
     C           YL0011    IFEQ 'H'                        *IF
      * Sel Transload Station
      * CASE: DTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * CASE: PGM.*Cursor field <IS> DTL.HPB Transload Station
     C           W0CFL     IFEQ '#DICSX'                   *IF
      * Sel COA Transload Stn SL - COA Transloading Station  * 
     C                     CALL 'PMSHSRR'              90  Sel COA Translo
     C                     PARM *BLANK    W0RTN   7
     C           #DICSX    PARM #DICSX    WQ0049  2        COA Station Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMSHSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9942  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Val Transload Station
      * CASE: DTL.HPB Transload Station GT WRK.Blank for 4           USR
     C           #DICSX    IFGT WUOTTX                     *IF
      * Rtv Transload Stn Nm  RT - COA Transloading Station  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DICSX    WL0025    P      COA Station Cod
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0026    #DNIT1    P      COA Station Nam
      * CASE: DTL.COA Station Name is blanks
     C           #DNIT1    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DICSX    ZA0002           HPB Transload S
      * Send message 'COA Transloading Stati NF'
     C                     MOVEL'USR3897' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9942  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * Bypass ref file checks if error already detected
     C   99                GOTO DBEXIT
      * Select existing record
     C                     EXSR VACKRL
      * Check reference to Company Name and Address
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Calendar
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Carrier
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Truck Size
     C                     EXSR VECKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Calendar
     C                     EXSR VFCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Calendar
     C                     EXSR VGCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Warehouse
     C                     EXSR VHCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to State
     C                     EXSR VICKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Carrier
     C                     EXSR VJCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Shipping Line/Port
     C                     EXSR VKCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Warehouse
     C                     EXSR VLCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate relations
      * CASE: PAR.Load Status is Not Invoiced
     C           P1PKST    IFEQ 'C'                        *IF
     C           P1PKST    OREQ 'E'
     C           P1PKST    OREQ 'L'
     C           P1PKST    OREQ 'S'
     C           P1PKST    OREQ 'U'
      * *OMS336* Verify Pallets Loaded and Total Pallet Tare are entered.
     C                     EXSR UBSUBR                     *OMS336* Verify
      * *OMS336* Verify Pallet/Tare Info entered for Combos
     C                     EXSR UCSUBR                     *OMS336* Verify
     C                     END                             *FI
      * E2117 5/21/12 RMC need to be able to maintain this for dailys exp
      * CASE:
      *  - c1AND(c2ORc3)
      *   |- c1    : DTL.Export Status is yes
      *   |- c2    : DTL.Export Load USDA-OK is No
      *   |- c3    : DTL.Export Load USDA-OK is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1U2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           #1RQST    IFEQ 'N'                        *IF
     C           #1RQST    OREQ *BLANK                     *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#1RQST    ZA0011           Export Load USD
      * Send message 'Load needs USDA Approval'
     C                     MOVEL'USR3014' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9941  *
      *
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for screen
      *================================================================
     C                     MOVEL'0'       *IN79
     C           YL0034    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           YL0011    IFEQ 'D'                        *IF
     C           YL0011    OREQ 'S'
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         MALDSC    BEGSR
      *================================================================
      * Load screen from passed parameters
      *================================================================
     C                     MOVEL*BLANK    #1PJST           LTL Flag
     C                     MOVEL*BLANK    #1PKST           Load Status
     C                     Z-ADD*ZERO     #DSEA1           Seal 1 USR
     C                     Z-ADD*ZERO     #DSEA2           Seal 2 USR
     C                     Z-ADD*ZERO     #DSEA3           Seal 3 USR
     C                     Z-ADD*ZERO     #DPLUS           Pallets Loaded
     C                     Z-ADD*ZERO     #1KNNX           Pallets Loaded
     C                     Z-ADD*ZERO     #DPRUS           Pallets Receive
     C                     Z-ADD*ZERO     #DPUUS           Pallets Unservi
     C                     MOVEL*BLANK    #1DMTX           Seal 1
     C                     MOVEL*BLANK    #1DNTX           Seal 2
     C                     MOVEL*BLANK    #1DOTX           Seal 3
     C                     MOVEL*BLANK    #1WTTX           Seal 4
     C                     MOVEL*BLANK    #1WUTX           Seal 2 Unused
     C                     Z-ADD*ZERO     #1RPNB           Total Load Orde
     C                     Z-ADD*ZERO     #1FLAM           Flat Amount
     C                     MOVEL*BLANK    #1XQST           Allocate Pounds
     C                     Z-ADD*ZERO     #1RRNB           Total Stops
     C                     MOVEL*BLANK    #1DXTX           Trailer Id
     C                     MOVEL*BLANK    #1DYTX           Transloader Car
     C                     Z-ADD*ZERO     #1SBNB           BOL Time
     C                     MOVEL*BLANK    #1BZNA           Carrier Code
     C                     MOVEL*BLANK    #1RONB           Truck Size
     C                     Z-ADD*ZERO     #1SQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     #1R1NB           Rated Freight
     C                     MOVEL*BLANK    #1VCST           Ship Status
     C                     Z-ADD*ZERO     #1SDNB           Number Pallets
     C                     Z-ADD*ZERO     #1SXNB           Estimated Arriv
     C                     Z-ADD*ZERO     #1HADT           Actual Arrival
     C                     Z-ADD*ZERO     #1AART           Actual Arrival
     C                     Z-ADD*ZERO     #1DHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     #1DIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     #1AQDT           Actual Departur
     C                     Z-ADD*ZERO     #1S6NB           Departure Time
     C                     Z-ADD*ZERO     #1T4NB           Schedule Sequen
     C                     Z-ADD*ZERO     #1NPSV           Number Spacers
     C                     Z-ADD*ZERO     #1TLMI           Total Load Mile
     C                     MOVEL*BLANK    #1Q2CD           Shipping Method
     C                     Z-ADD*ZERO     #1DGWG           Load Carrier Pa
     C                     MOVEL*BLANK    #1VPCD           Ship From Wareh
     C                     MOVEL*BLANK    #1DBCD           Ship To State C
     C                     Z-ADD*ZERO     #1GRWE           Gross Weight
     C                     MOVEL*BLANK    #1XCCD           Carrier Broker
     C                     MOVEL*BLANK    #1U2ST           Export Status
     C                     Z-ADD*ZERO     #1F9DT           Actual Ship Dat
     C                     MOVEL*BLANK    #1ONTM           On Time - (Y/N)
     C                     Z-ADD*ZERO     #1J4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     #1TRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     #1J5DT           Spotted Date
     C                     Z-ADD*ZERO     #1SPTM           Spotted Time
     C                     Z-ADD*ZERO     #1J6DT           Load Finished D
     C                     Z-ADD*ZERO     #1LFTM           Load Finished T
     C                     Z-ADD*ZERO     #1J7DT           BOL Complete Da
     C                     Z-ADD*ZERO     #1BOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     #1J8DT           BOL Received Da
     C                     Z-ADD*ZERO     #1BLTM           BOL Received Ti
     C                     Z-ADD*ZERO     #1KIDT           Truck Departure
     C                     Z-ADD*ZERO     #1ASTM           Truck Departure
     C                     Z-ADD*ZERO     #1KADT           Adjusted Depart
     C                     Z-ADD*ZERO     #1AJCM           Adjusted Depart
     C                     MOVEL*BLANK    #1XACD           Shipping Line
     C                     MOVEL*BLANK    #1OANA           Port Delv Termi
     C                     MOVEL*BLANK    #1K4TX           Vessel Name
     C                     Z-ADD*ZERO     #1VOAG           Voyage
     C                     Z-ADD*ZERO     #1KBDT           Sail Date
     C                     MOVEL*BLANK    #1NBBO           Booking Number
     C                     MOVEL*BLANK    #1W4CD           Discharge Port
     C                     Z-ADD*ZERO     #1EFDT           Arrival Date
     C                     MOVEL*BLANK    #1CNTN           Container Numbe
     C                     Z-ADD*ZERO     #1KCDT           Date In
     C                     Z-ADD*ZERO     #1TMIN           Time In
     C                     Z-ADD*ZERO     #1KDDT           Date Out
     C                     Z-ADD*ZERO     #1VMNB           Time Out
     C                     Z-ADD*ZERO     #1OCFR           Load Total Frei
     C                     Z-ADD*ZERO     #1KJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     #1ATTM           Scheduled Deliv
     C                     MOVEL*BLANK    #1OTRS           LH Unused Sts
     C                     MOVEL*BLANK    #1RNST           LH Carrier Paym
     C                     Z-ADD*ZERO     #1BRBK           Bring Back Mile
     C                     Z-ADD*ZERO     #1EIDT           Requested Deliv
     C                     MOVEL*BLANK    #1RMST           Load Acceptance
     C                     MOVEL*BLANK    #1AJCD           Warehouse Code
     C                     Z-ADD*ZERO     #1KKDT           On Yard Date
     C                     Z-ADD*ZERO     #1AVTM           On Yard Time
     C                     Z-ADD*ZERO     #1KZDT           Deadline Depart
     C                     Z-ADD*ZERO     #1AXTM           Deadline Depart
     C                     MOVEL*BLANK    #1LHOS           Load Held Over
     C                     MOVEL*BLANK    #1LHOR           Load Held Over
     C                     MOVEL*BLANK    #1WNTX           Load Held Over
     C                     MOVEL*BLANK    #1OITX           Ocean BOL Numbe
     C                     MOVEL*BLANK    #1OJTX           Express Mail Nu
     C                     Z-ADD*ZERO     #1LLDT           Express Mail Da
     C                     MOVEL*BLANK    #1LSHG           Load Shag Flag
     C                     MOVEL*BLANK    #1YPST           Load Wash Flag
     C                     Z-ADD*ZERO     #1K0DT           Product Complet
     C                     Z-ADD*ZERO     #1AYTM           Product Complet
     C                     MOVEL*BLANK    #1H9SX           Load Confirmed
     C                     MOVEL*BLANK    #1WOTX           Load Confirmed
     C                     Z-ADD*ZERO     #1K1DT           Load Confirmati
     C                     Z-ADD*ZERO     #1AZTM           Load Door 1
     C                     Z-ADD*ZERO     #1K2DT           Override Total
     C                     Z-ADD*ZERO     #1A0TM           Load Door 2
     C                     MOVEL*BLANK    #1ROST           Partial Load
     C                     MOVEL*BLANK    #1RPST           Load Confirmati
     C                     MOVEL*BLANK    #1RRST           Late Delivery E
     C                     Z-ADD*ZERO     #1ZBVA           Load Actual Fre
     C                     MOVEL*BLANK    #1WPTX           Hide on WW Load
     C                     MOVEL*BLANK    #1WQTX           Late Billing Em
     C                     MOVEL*BLANK    #1WRTX           Shipping Temp C
     C                     MOVEL*BLANK    #1WSTX           LH Held Over Rs
     C                     MOVEL*BLANK    #1RVSX           Multi Company L
     C                     MOVEL*BLANK    #1RUSX           Fax Sent to SSI
     C                     MOVEL*BLANK    #1RWSX           Schedule Pos Lo
     C                     MOVEL*BLANK    #1RXSX           LH Power Only L
     C                     MOVEL*BLANK    #1RYSX           MG Created Load
     C                     MOVEL*BLANK    #1RZSX           LH Unused Sts 5
     C                     MOVEL*BLANK    #1R0SX           Load U/M
     C                     MOVEL*BLANK    #1R1SX           TPM Shipment St
     C                     MOVEL*BLANK    #1R2SX           LH Unused Sts 8
     C                     MOVEL*BLANK    #1R3SX           LH On-Time Reas
     C                     MOVEL*BLANK    #1R4SX           LH Held Over Re
     C                     Z-ADD*ZERO     #1PYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     #1CKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     #1PZDT           LH Last Combo P
     C                     Z-ADD*ZERO     #1CLTM           LH Last Combo P
     C                     Z-ADD*ZERO     #1P0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     #1CMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     #1P1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     #1CNTM           LH Unused Time
     C                     Z-ADD*ZERO     #1P2DT           LH Unused Date
     C                     Z-ADD*ZERO     #1COTM           LH Unused Time
     C                     Z-ADD*ZERO     #1P3DT           LH Unused Date
     C                     Z-ADD*ZERO     #1CQTM           LH Unused Time
     C                     MOVEL*BLANK    #1UVST           EDI Status 1
     C                     MOVEL*BLANK    #1UWST           EDI Status 2
     C                     MOVEL*BLANK    #1UXST           EDI Status 3
     C                     Z-ADD*ZERO     #1AATM           Job Time
     C                     MOVEL*BLANK    #1AYNA           User Id
     C                     MOVEL*BLANK    #1A0NA           Job Name
     C                     Z-ADD*ZERO     #1AXDT           Job Date
     C                     MOVEL*BLANK    #DHLTX           Condition Desc.
     C                     MOVEL*BLANK    #1VDST           Load Type
     C                     MOVEL*BLANK    #DNONA           Load Type Desc
     C                     Z-ADD*ZERO     #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     MOVEL*BLANK    #DAGTX           USR Company Nam
     C                     Z-ADD*ZERO     #1RMNB           Load ID
     C                     Z-ADD*ZERO     #1AODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V1AODT
     C                     Z-ADD*ZERO     #1RNNB           Reefer Temperat
     C                     MOVEL*BLANK    #DFRSX           Shipping Temp C
     C                     Z-ADD*ZERO     #1PRTM           Product Tempera
     C                     MOVEL*BLANK    #DZ4TX           Seal 1 USR Alph
     C                     MOVEL*BLANK    #DZ5TX           Seal 2 USR Alph
     C                     MOVEL*BLANK    #DZ6TX           Seal 3 USR Alph
     C                     Z-ADD*ZERO     #1PAOU           Number Pallets
     C                     Z-ADD*ZERO     #1ICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     #1IDWG           Tot Pallet Tare
     C                     MOVEL*BLANK    #DS2TX           Trailer ID USR
     C                     MOVEL*BLANK    #1J8TX           Car/Veh. Initia
     C                     MOVEL*BLANK    #1J9TX           Recorder ID
     C                     MOVEL*BLANK    #DCRST           Collect/Prepaid
     C                     MOVEL*BLANK    #DHUTX           Condition Desc.
     C                     MOVEL*BLANK    #1RQST           Export Load USD
     C                     MOVEL*BLANK    #DICSX           HPB Transload S
     C                     MOVEL*BLANK    #DNIT1           COA Station Nam
      * USER: Load screen
      * Load Screen Fields
     C                     EXSR UDSUBR                     Load Screen Fie
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.Load Status is Invoiced
      *   |- c2    : LCL.Company Organization is High Plains Biodiesel
      *   '-
     C           P1PKST    IFEQ 'I'                        *IF
     C           YL0011    OREQ 'H'                        *OR
     C                     MOVEL'N'       YL0034           Display Flag
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       YL0034           Display Flag
     C                     END                             *FI
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #1AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1AODT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV 1st Stop Mile,Dlv  RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WARMNB    WQSA02           Load ID
      * Define keylist
     C           KPSSA     KLIST
     C                     KFLD           WQSA02           Load ID
     C                     KFLD           WARVNB           Stop/Drop
     C                     KFLD           WAC4NB           Order Number
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSA02           Load ID
     C                     Z-ADD*ZERO     WARVNB           Stop/Drop
     C                     Z-ADD*ZERO     WAC4NB           Order Number
      * Establish starting position
     C           KPSSA     SETLL@FLCPEB                    *
     C           KRSSA     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWARWNB    WN0002           Miles to next s
      * Rtv Delivery Date/Time RT - PD Order Header  * 
     C                     EXSR SBRVGN
     C                     GOTO SAEXIT                     *QUIT
     C           KRSSA     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Delivery Date/Time RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
      * Setup key
     C                     Z-ADDWAAIC3    WBAIC3           Company Number
     C                     Z-ADDWAC4NB    WBC4NB           Order Number
      * Establish starting position
     C           KRSSB     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUG0TX           Ship To Name
     C                     MOVEL*BLANK    WUG0TX           Ship To City
     C                     MOVEL*BLANK    WUG0TX           Ship To State C
     C                     Z-ADD*ZERO     WN0009           Requested Deliv
     C                     Z-ADD*ZERO     WN0010           Requested Deliv
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBBRTX    WUG0TX           Ship To Name
     C                     MOVELWBHNNA    WUG0TX           Ship To City
     C                     MOVELWBDBCD    WUG0TX           Ship To State C
     C                     Z-ADDWBEIDT    WN0009           Requested Deliv
     C                     Z-ADDWBAFTM    WN0010           Requested Deliv
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Legal Run Mileage  RT - Legal Run Mileage/Hours  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KPSSC     KLIST
     C                     KFLD           WCMILE           Miles to First
      * Setup key
     C                     Z-ADDWN0002    WCMILE           Miles to First
      * Establish starting position
     C           KPSSC     SETLL@LGCPNM                    *
     C                     READ @LGCPNM                  90*
      * Data record not found
     C   90                MOVEL'USR2462' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCHRRQ    WN0001           Hours Required
     C                     GOTO SCEXIT                     *QUIT
     C                     READ @LGCPNM                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCHRC    BEGSR
      *================================================================
      * CHG Loads for B.O.L.   CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0011  30       Company Number
     C                     Z-ADD*ZERO     WN0012  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0013  1        LTL Flag
     C                     MOVEL*BLANK    WN0014  1        Load Status
     C                     MOVEL*BLANK    WN0015 15        Seal 4
     C                     MOVEL*BLANK    WN0016 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0017  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0018 112       Flat Amount
     C                     MOVEL*BLANK    WN0019  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0020  50       Total Stops
     C                     MOVEL*BLANK    WN0021  3        Transloader Car
     C                     Z-ADD*ZERO     WN0022  40       BOL Time
     C                     MOVEL*BLANK    WN0023  3        Carrier Code
     C                     MOVEL*BLANK    WN0024  7        Truck Size
     C                     Z-ADD*ZERO     WN0025  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0026 112       Rated Freight
     C                     MOVEL*BLANK    WN0027  1        Ship Status
     C                     MOVEL*BLANK    WN0028  1        Load Type
     C                     Z-ADD*ZERO     WN0029 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0030  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0031  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0032  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0033 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0034 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0035  70       Actual Departur
     C                     Z-ADD*ZERO     WN0036  40       Departure Time
     C                     Z-ADD*ZERO     WN0037  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0038  70       Total Load Mile
     C                     MOVEL*BLANK    WN0039  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0040  2        Ship To State C
     C                     Z-ADD*ZERO     WN0041  70       Gross Weight
     C                     MOVEL*BLANK    WN0042  3        Carrier Broker
     C                     MOVEL*BLANK    WN0043  1        Export Status
     C                     Z-ADD*ZERO     WN0044  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0045  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0046  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0047  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0048  70       Spotted Date
     C                     Z-ADD*ZERO     WN0049  60       Spotted Time
     C                     Z-ADD*ZERO     WN0050  70       Load Finished D
     C                     Z-ADD*ZERO     WN0051  60       Load Finished T
     C                     Z-ADD*ZERO     WN0052  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0053  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0054  70       Truck Departure
     C                     Z-ADD*ZERO     WN0055  60       Truck Departure
     C                     Z-ADD*ZERO     WN0056  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0057  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0058  3        Shipping Line
     C                     MOVEL*BLANK    WN0059 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0060 30        Vessel Name
     C                     Z-ADD*ZERO     WN0061  50       Voyage
     C                     Z-ADD*ZERO     WN0062  70       Sail Date
     C                     MOVEL*BLANK    WN0063 12        Booking Number
     C                     MOVEL*BLANK    WN0064 20        Discharge Port
     C                     Z-ADD*ZERO     WN0065  70       Arrival Date
     C                     MOVEL*BLANK    WN0066 12        Container Numbe
     C                     Z-ADD*ZERO     WN0067  70       Date In
     C                     Z-ADD*ZERO     WN0068  60       Time In
     C                     Z-ADD*ZERO     WN0069  70       Date Out
     C                     Z-ADD*ZERO     WN0070  60       Time Out
     C                     Z-ADD*ZERO     WN0071 112       Load Total Frei
     C                     MOVEL*BLANK    WN0072  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0073  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0074  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0075  70       Requested Deliv
     C                     MOVEL*BLANK    WN0076  1        Load Acceptance
     C                     MOVEL*BLANK    WN0077  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0078  70       On Yard Date
     C                     Z-ADD*ZERO     WN0079  60       On Yard Time
     C                     Z-ADD*ZERO     WN0080  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0081  60       Deadline Depart
     C                     MOVEL*BLANK    WN0082  1        Load Held Over
     C                     MOVEL*BLANK    WN0083  1        Load Held Over
     C                     MOVEL*BLANK    WN0084 15        Load Held Over
     C                     MOVEL*BLANK    WN0085 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0086 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0087  70       Express Mail Da
     C                     MOVEL*BLANK    WN0088  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0089  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0090  70       Product Complet
     C                     Z-ADD*ZERO     WN0091  60       Product Complet
     C                     Z-ADD*ZERO     WN0092  50       Pallets Loaded
     C                     MOVEL*BLANK    WN0093  1        Load Confirmed
     C                     MOVEL*BLANK    WN0094 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0095  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0096  60       Load Door 1
     C                     Z-ADD*ZERO     WN0097  70       Override Total
     C                     Z-ADD*ZERO     WN0098  60       Load Door 2
     C                     MOVEL*BLANK    WN0099  1        Partial Load
     C                     MOVEL*BLANK    WN0100  1        Load Confirmati
     C                     MOVEL*BLANK    WN0101  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0102 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0103 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0104 15        Late Billing Em
     C                     MOVEL*BLANK    WN0105 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0106  1        Multi Company L
     C                     MOVEL*BLANK    WN0107  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0108  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0109  1        LH Power Only L
     C                     MOVEL*BLANK    WN0110  1        MG Created Load
     C                     MOVEL*BLANK    WN0111  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0112  2        Load U/M
     C                     MOVEL*BLANK    WN0113  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0114  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0115  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0116  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0117  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0118  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0119  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0120  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0121  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0122  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0123  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0124  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0125  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0126  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0127  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0128  60       LH Unused Time
     C                     MOVEL*BLANK    WN0129  1        EDI Status 2
     C                     MOVEL*BLANK    WN0130  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0131  60       Job Time
     C                     MOVEL*BLANK    WN0132 10        User Id
     C                     MOVEL*BLANK    WN0133 10        Job Name
     C                     Z-ADD*ZERO     WN0134  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADD#1RMNB    WDRMNB           Load ID
      *
     C           KLCHSD    KLIST
     C                     KFLD           WDRMNB           Load ID
     C           KLCHSD    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YARDCS
      * USER: Processing after Data read
      * CASE: DB1.MG Created Load is Yes
     C           WDRYSX    IFEQ 'Y'                        *IF
      * If Seal 1,2,3, changes: Write TMS load trigger
      * CASE:
      *  - c1ORc2ORc3ORc4
      *   |- c1    : PAR.Seal 1 NE DB1.Seal 1
      *   |- c2    : PAR.Seal 2 NE DB1.Seal 2
      *   |- c3    : PAR.Seal 3 NE DB1.Seal 3
      *   |- c4    : PAR.Trailer Id NE DB1.Trailer Id
      *   '-
     C           #1DMTX    IFNE WDDMTX                     *IF
     C           #1DNTX    ORNE WDDNTX                     *OR
     C           #1DOTX    ORNE WDDOTX                     *OR
     C           #DS2TX    ORNE WDDXTX                     *OR
     C                     MOVELWUS3TX    YL0001           Load Change Typ
     C                     MOVELWUS3TX    YL0002           Load Change Typ
     C                     MOVELWUS3TX    YL0003           Load Change Typ
     C                     MOVELWUS3TX    YL0004           Load Change Typ
     C                     MOVELWUS3TX    YL0005           Load Change Typ
      * CASE: PAR.Trailer Id NE DB1.Trailer Id
     C           #DS2TX    IFNE WDDXTX                     *IF
     C                     MOVEL'TRAILR'  YL0001           Load Change Typ
     C                     END                             *FI
      * CASE:
      *  - c1ORc2ORc3
      *   |- c1    : PAR.Seal 1 NE DB1.Seal 1
      *   |- c2    : PAR.Seal 2 NE DB1.Seal 2
      *   |- c3    : PAR.Seal 3 NE DB1.Seal 3
      *   '-
     C           #1DMTX    IFNE WDDMTX                     *IF
     C           #1DNTX    ORNE WDDNTX                     *OR
     C           #1DOTX    ORNE WDDOTX                     *OR
      * CASE: LCL.Load Change Type EQ WRK.Blank 6 USR
     C           YL0001    IFEQ WUXKTX                     *IF
     C                     MOVEL'EXSEAL'  YL0001           Load Change Typ
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'EXSEAL'  YL0002           Load Change Typ
     C                     END                             *FI
     C                     END                             *FI
      * Exc Crt TMS Load Trg  XF - TMS Load Trigger  * 
     C                     CALL 'PBXOXFR'              90  Exc Crt TMS Loa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM ##JDT     WQ0001  70       Job Date
     C                     PARM ##JTM     WQ0002  60       Job Time
     C                     PARM WDRMNB    WQ0003  70       Load ID
     C                     PARM WDAIC3    WQ0004  30       TMS LH Load Str
     C                     PARM YL0006    WQ0005 35        TMS LH Field Ch
     C                     PARM 'A'       WQ0006  1        TMS Record Stat
     C                     PARM *ZERO     WQ0007  30       TMS Process Sta
     C                     PARM *BLANK    WQ0008  6        TMS Error Reaso
     C                     PARM *ZERO     WQ0009  80       TMS Change Date
     C                     PARM *ZERO     WQ0010  60       TMS Change time
     C                     PARM YL0001    WQ0011  6        Load Change Typ
     C                     PARM YL0002    WQ0012  6        Load Change Typ
     C                     PARM YL0003    WQ0013  6        Load Change Typ
     C                     PARM YL0004    WQ0014  6        Load Change Typ
     C                     PARM YL0005    WQ0015  6        Load Change Typ
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBXOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Move non-key fields to @FJCPBO
     C                     Z-ADD#1RNNB    WDRNNB           Reefer Temperat
     C                     MOVEL#1DMTX    WDDMTX    P      Seal 1
     C                     MOVEL#1DNTX    WDDNTX    P      Seal 2
     C                     MOVEL#1DOTX    WDDOTX    P      Seal 3
     C                     MOVEL#DS2TX    WDDXTX    P      Trailer Id
     C                     Z-ADD#1SDNB    WDSDNB           Number Pallets
     C                     Z-ADD#1PAOU    WDPAOU           Number Pallets
     C                     Z-ADD#1PRTM    WDPRTM           Product Tempera
     C                     Z-ADD#1NPSV    WDNPSV           Number Spacers
     C                     MOVEL#1J8TX    WDJ8TX    P      Car/Veh. Initia
     C                     MOVEL#1J9TX    WDJ9TX    P      Recorder ID
     C                     MOVEL#1Q2CD    WDQ2CD    P      Shipping Method
     C                     Z-ADD#1J7DT    WDJ7DT           BOL Complete Da
     C                     Z-ADD#1BOTM    WDBOTM           BOL Complete Ti
     C                     Z-ADD#1KJDT    WDKJDT           Scheduled Deliv
     C                     Z-ADD#1ATTM    WDATTM           Scheduled Deliv
     C                     Z-ADD#1ICWG    WDICWG           Avg Pallet Tare
     C                     Z-ADD#1IDWG    WDIDWG           Tot Pallet Tare
     C                     MOVEL#1RQST    WDRQST    P      Export Load USD
     C                     MOVEL#1WRTX    WDWRTX    P      Shipping Temp C
     C                     MOVELP1UVST    WDUVST    P      EDI Status 1
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Upd Whs Pallet Tare   RT - Load Detail          TRG  * 
     C                     EXSR SERVGN
      * Rtv Accum Pallet Info RT - Load Detail          TRG  * 
     C                     EXSR SHRVGN
      * CASE: DB1.Number Pallets Loaded is Greater than zero
     C           WDPAOU    IFGT 0                          *IF
     C           WDIDWG    DIV  WDPAOU    WDICWG    H      Avg Pallet Tare
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WDICWG           Avg Pallet Tare
     C                     END                             *FI
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##PGM     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Upd Whs Pallet Tare   RT - Load Detail          TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    YL0007           Order Changed Y
     C                     MOVEL'*NO'     YL0007           Order Changed Y
      * Declare restrictor key work fields
     C           *LIKE     DEFN WERMNB    WQSE01           Load ID
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Load ID
      * Setup key
     C                     Z-ADDWDRMNB    WQSE01           Load ID
      * Establish starting position
     C           KRSSE     SETLL@FLCPBW                    *
     C           KRSSE     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Upd Whs Pallet Tare   RT - PD Order Detail  * 
     C                     EXSR SFRVGN
      * CASE: LCL.Order Changed Y/N is *YES
     C           YL0007    IFEQ '*YES'                     *IF
     C                     GOTO SEEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSE     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Upd Whs Pallet Tare   RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSF01           Company Number
     C           *LIKE     DEFN WFC4NB    WQSF02           Order Number
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Order Number
      * Setup key
     C                     Z-ADDWEAIC3    WQSF01           Company Number
     C                     Z-ADDWEC4NB    WQSF02           Order Number
      * Establish starting position
     C           KRSSF     SETLL@BGWKL1                    *
     C           KRSSF     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Warehouse Code NE PAR.USR Warehouse Code
     C           WFAJCD    IFNE P6CPCD                     *IF
     C                     GOTO SFEXIT                     *QUIT
     C                     END                             *FI
      * CASE: DB1.Detail Line Status is Not cancelled
     C           WFGMST    IFEQ 'L'                        *IF
     C           WFGMST    OREQ 'A'
     C           WFGMST    OREQ 'C'
     C           WFGMST    OREQ 'R'
     C           WFGMST    OREQ 'E'
     C           WFGMST    OREQ 'H'
     C           WFGMST    OREQ 'I'
      * Chg Whs Pallet Tare   CH - PD Order Detail  * 
     C                     EXSR SGCHRC
     C                     MOVEL'*YES'    YL0007           Order Changed Y
     C                     GOTO SFEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSF     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCHRC    BEGSR
      *================================================================
      * Chg Whs Pallet Tare   CH - PD Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0135  70       Item Code
     C                     MOVEL*BLANK    WN0136  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0137  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0138  70       Order Group Cod
     C                     MOVEL*BLANK    WN0139  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0140  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0141 112       Billing Detail
     C                     Z-ADD*ZERO     WN0142 112       Billing Detail
     C                     Z-ADD*ZERO     WN0143 112       Billing Detail
     C                     Z-ADD*ZERO     WN0144 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0145  1        Comment Print A
     C                     MOVEL*BLANK    WN0146  1        Comment Print I
     C                     MOVEL*BLANK    WN0147  1        Comment Print P
     C                     MOVEL*BLANK    WN0148  1        Comment Print S
     C                     Z-ADD*ZERO     WN0149 112       Extended Amount
     C                     Z-ADD*ZERO     WN0150  70       Market Pricing
     C                     MOVEL*BLANK    WN0151  3        Commodity Marke
     C                     MOVEL*BLANK    WN0152  3        Date Method Cod
     C                     MOVEL*BLANK    WN0153  3        Price Method Co
     C                     Z-ADD*ZERO     WN0154 114       Price Overage O
     C                     Z-ADD*ZERO     WN0155  70       Contract Number
     C                     MOVEL*BLANK    WN0156  1        Price Status
     C                     Z-ADD*ZERO     WN0157  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0158  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0159  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0160  1        Work Confirm St
     C                     MOVEL*BLANK    WN0161  1        Work Over/Short
     C                     MOVEL*BLANK    WN0162  1        OD Production P
     C                     MOVEL*BLANK    WN0163 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0164 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0165  1        Age Code
     C                     MOVEL*BLANK    WN0166  1        Palletize
     C                     MOVEL*BLANK    WN0167  1        Slip Sheet
     C                     MOVEL*BLANK    WN0168  1        Catch Weight St
     C                     MOVEL*BLANK    WN0169  1        Price Audit
     C                     MOVEL*BLANK    WN0170  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0171  1        Production Date
     C                     Z-ADD*ZERO     WN0172 112       Rated Freight
     C                     Z-ADD*ZERO     WN0173 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0174 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0175 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0176 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0177 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0178 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0179 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0180 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0181 114       Unit Price
     C                     Z-ADD*ZERO     WN0182 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0183 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0184 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0185 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0186  70       Requested Ship
     C                     Z-ADD*ZERO     WN0187  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0188  70       Actual Shipped
     C                     MOVEL*BLANK    WN0189  1        Affect Inventor
     C                     MOVEL*BLANK    WN0190  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0191  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0192  30       Item Structure
     C                     Z-ADD*ZERO     WN0193  30       Item Structure
     C                     Z-ADD*ZERO     WN0194  30       Item Structure
     C                     MOVEL*BLANK    WN0195  2        Item Level
     C                     MOVEL*BLANK    WN0196  2        Quality Level
     C                     MOVEL*BLANK    WN0197  2        Pricing Product
     C                     MOVEL*BLANK    WN0198  2        Season Product
     C                     Z-ADD*ZERO     WN0199  70       Date of Origina
     C                     MOVEL*BLANK    WN0200 10        User Profile Na
     C                     MOVEL*BLANK    WN0201  6        Country Code
     C                     MOVEL*BLANK    WN0202  2        Event Code
     C                     MOVEL*BLANK    WN0203  3        Reason Code
     C                     MOVEL*BLANK    WN0204  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0205  1        Modified Flag
     C                     MOVEL*BLANK    WN0206  1        Substituted Fla
     C                     MOVEL*BLANK    WN0207  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0208 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0209 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0210  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0211  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0212  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0213  1        Affect Commissi
     C                     MOVEL*BLANK    WN0214  1        Affect Pricing
     C                     MOVEL*BLANK    WN0215  1        Released by Use
     C                     MOVEL*BLANK    WN0216  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0217  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0218  3        Production Ware
     C                     MOVEL*BLANK    WN0219  3        OD Price Type
     C                     Z-ADD*ZERO     WN0220  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0221  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0222  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0223  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0224  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0225  60       Price Code
     C                     Z-ADD*ZERO     WN0226  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0227  60       Substitution Li
     C                     Z-ADD*ZERO     WN0228  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0229 112       OD Item Target
     C                     Z-ADD*ZERO     WN0230 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0231 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0232 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0233 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0234 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0235 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0236 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0237 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0238 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0239 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0240  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0241  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0242  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0243 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0244  40       Item Age Days
     C                     Z-ADD*ZERO     WN0245  70       Production Ovr
     C                     Z-ADD*ZERO     WN0246  70       Production Ovr
     C                     MOVEL*BLANK    WN0247  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0248  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0249  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0250  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0251  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0252  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0253  1        EDI Status 1
     C                     MOVEL*BLANK    WN0254  1        EDI Status 2
     C                     MOVEL*BLANK    WN0255  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0256  60       Job Time
     C                     MOVEL*BLANK    WN0257 10        User Id
     C                     MOVEL*BLANK    WN0258 10        Job Name
     C                     Z-ADD*ZERO     WN0259  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWFAIC3    WGAIC3           Company Number
     C                     Z-ADDWFC4NB    WGC4NB           Order Number
     C                     Z-ADDWFDPNB    WGDPNB           Order Sequence
     C                     Z-ADDWFUENB    WGUENB           Order Secondary
      *
     C           KLCHSG    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
     C                     KFLD           WGDPNB           Order Sequence
     C                     KFLD           WGUENB           Order Secondary
     C           KLCHSG    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YBRDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADD#1PAOU    WGNTDT           Warehouse Palle
     C                     Z-ADD#1IDWG    WGH5NX           Warehouse Palle
     C                     Z-ADD#1ICWG    WGH6NX           Warehouse Avg P
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Accum Pallet Info RT - Load Detail          TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WDIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WDPAOU           Number Pallets
      * Declare restrictor key work fields
     C           *LIKE     DEFN WERMNB    WQSH01           Load ID
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Load ID
      * Setup key
     C                     Z-ADDWDRMNB    WQSH01           Load ID
      * Establish starting position
     C           KRSSH     SETLL@FLCPBW                    *
     C           KRSSH     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Accum Pallet Info RT - PD Order Detail  * 
     C                     EXSR SIRVGN
     C           KRSSH     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Accum Pallet Info RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSI01           Company Number
     C           *LIKE     DEFN WFC4NB    WQSI02           Order Number
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Company Number
     C                     KFLD           WQSI02           Order Number
      * Setup key
     C                     Z-ADDWEAIC3    WQSI01           Company Number
     C                     Z-ADDWEC4NB    WQSI02           Order Number
      * Establish starting position
     C           KRSSI     SETLL@BGWKL1                    *
     C           KRSSI     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WDPAOU           Warehouse Palle
     C                     Z-ADD*ZERO     WDIDWG           Warehouse Palle
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WFNTDT    WDPAOU           Warehouse Palle
     C                     ADD  WFH5NX    WDIDWG           Warehouse Palle
     C           KRSSI     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Chg HPB Trans Stn RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WERMNB    WQSJ01           Load ID
      * Define keylist
     C           KPSSJ     KLIST
     C                     KFLD           WQSJ01           Load ID
     C                     KFLD           WERUNB           Stop/Drop Seque
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSJ01           Load ID
     C                     Z-ADD0         WERUNB           Stop/Drop Seque
      * Establish starting position
     C           KPSSJ     SETLL@FLCPBW                    *
     C           KRSSJ     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG HPB Transload Stn CH - Load Detail  * 
     C                     EXSR SKCHRC
     C           KRSSJ     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCHRC    BEGSR
      *================================================================
      * CHG HPB Transload Stn CH - Load Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0260 30        Comments for Pi
     C                     Z-ADD*ZERO     WN0261  50       Miles to next s
     C                     Z-ADD*ZERO     WN0262  72       Freight Charge
     C                     Z-ADD*ZERO     WN0263  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0264 112       Freight Misc. C
     C                     Z-ADD*ZERO     WN0265  72       Freight Stop Ch
     C                     Z-ADD*ZERO     WN0266 112       Rated Freight
     C                     Z-ADD*ZERO     WN0267  30       Company Number
     C                     Z-ADD*ZERO     WN0268  70       Order Number
     C                     MOVEL*BLANK    WN0269  1        Ship Status
     C                     Z-ADD*ZERO     WN0270  70       Estimated Arriv
     C                     Z-ADD*ZERO     WN0271  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0272  70       Appointment Con
     C                     Z-ADD*ZERO     WN0273  60       Appointment Con
     C                     MOVEL*BLANK    WN0274 30        Confirmation Ma
     C                     MOVEL*BLANK    WN0275 10        Confirmation Nu
     C                     Z-ADD*ZERO     WN0276  70       Actual Delivery
     C                     Z-ADD*ZERO     WN0277  60       Actual Delivery
     C                     Z-ADD*ZERO     WN0278  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0279  60       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0280  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0281  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0282  70       On Yard Date
     C                     Z-ADD*ZERO     WN0283  60       On Yard Time
     C                     Z-ADD*ZERO     WN0284  70       MPC Number
     C                     MOVEL*BLANK    WN0285  1        Load Dtl On Tim
     C                     MOVEL*BLANK    WN0286  1        On Time Add'l R
     C                     MOVEL*BLANK    WN0287 15        Seal Nbr 1
     C                     MOVEL*BLANK    WN0288 15        Seal Nbr 2
     C                     MOVEL*BLANK    WN0289 15        Seal Nbr 3
     C                     MOVEL*BLANK    WN0290 15        Seal Nbr 4
     C                     MOVEL*BLANK    WN0291 15        Seal Nbr 5
     C                     Z-ADD*ZERO     WN0292  70       LD Carrier Appt
     C                     Z-ADD*ZERO     WN0293  70       LD Unused Date
     C                     Z-ADD*ZERO     WN0294  70       LD Unused Date
     C                     Z-ADD*ZERO     WN0295  60       LD Carrier Appt
     C                     Z-ADD*ZERO     WN0296  60       LD Unused Time
     C                     Z-ADD*ZERO     WN0297  60       LD Unused Time
     C                     MOVEL*BLANK    WN0298  1        Miles Error Sts
     C                     MOVEL*BLANK    WN0299  1        LD Unused Sts 2
     C                     MOVEL*BLANK    WN0300 15        LD Cst Svc Trac
     C                     MOVEL*BLANK    WN0301 25        Carrier Ref PRO
     C                     MOVEL*BLANK    WN0302 25        Cust Assigned A
     C                     MOVEL*BLANK    WN0303  1        EDI Status 1
     C                     MOVEL*BLANK    WN0304  1        EDI Status 2
     C                     MOVEL*BLANK    WN0305  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0306  60       Job Time
     C                     MOVEL*BLANK    WN0307 10        User Id
     C                     MOVEL*BLANK    WN0308 10        Job Name
     C                     Z-ADD*ZERO     WN0309  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @FLCPBM
     C                     Z-ADDWERMNB    WHRMNB           Load ID
     C                     Z-ADDWERUNB    WHRUNB           Stop/Drop Seque
      *
     C           KLCHSK    KLIST
     C                     KFLD           WHRMNB           Load ID
     C                     KFLD           WHRUNB           Stop/Drop Seque
     C           KLCHSK    CHAIN@FLCPBM              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFLCPL0'MDACP
     C                     MOVEL'@FLCPBM' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFL1    YCRDCS
      * Move non-key fields to @FLCPBM
     C                     Z-ADDWERVNB    WHRVNB           Stop/Drop
     C                     MOVEL#DICSX    WHICSX    P      HPB Transload S
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##PGM     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@FLCPBM                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFLCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv HPB fields        RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WIAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#1VPCD    WIAJCD           Warehouse Code
      * Establish starting position
     C           KRSSL     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0012           Production Ware
     C                     MOVEL*BLANK    YL0013           Warehouse Locat
     C                     MOVEL*BLANK    YL0014           WHS Req Meter R
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWIAOCD    YL0012           Production Ware
     C                     MOVELWIT0ST    YL0013           Warehouse Locat
     C                     MOVELWIRTSX    YL0014           WHS Req Meter R
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Acct Co          RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WIAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#1VPCD    WIAJCD           Warehouse Code
      * Establish starting position
     C           KRSSM     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0015           Accounting Comp
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWIBTC3    YL0015           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Co Document Dflts  RT - Company Document Defaults  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ** Used by HPE in STR Hog Prcr & Eval Sys-HPE System
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJESTX           CDD Type
     C                     KFLD           WJFPAA           CDD Department
      * Setup key
     C                     Z-ADDWL0001    WJAIC3           Company Number
     C                     MOVELWL0002    WJESTX           CDD Type
     C                     MOVELWL0003    WJFPAA           CDD Department
      * Establish starting position
     C           KRSSN     CHAIN@AQREWG              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3410' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0004           CDD Name of Ove
     C                     MOVEL*BLANK    WL0005           CDD Program Nam
     C                     MOVEL*BLANK    WL0006           CDD Printer Fil
     C                     MOVEL*BLANK    WL0007           CDD Sender Phon
     C                     MOVEL*BLANK    WL0008           CDD Sender Fax
     C                     MOVEL*BLANK    WL0009           Output Queue
     C                     MOVEL*BLANK    WL0010           Hold File
     C                     MOVEL*BLANK    WL0011           Save File
     C                     Z-ADD*ZERO     WL0012           Source Drawer
     C                     MOVEL*BLANK    WL0013           Printer Device
     C                     Z-ADD*ZERO     WL0014           Page Length 2
     C                     Z-ADD*ZERO     WL0015           Page Width 2
     C                     Z-ADD*ZERO     WL0016           Page LPI
     C                     Z-ADD*ZERO     WL0017           Page CPI
     C                     Z-ADD*ZERO     WL0018           Page Overflow
     C                     MOVEL*BLANK    WL0019           Page Rotation
     C                     MOVEL*BLANK    WL0020           CDD Comment 1
     C                     MOVEL*BLANK    WL0021           CDD Comment 2
     C                     MOVEL*BLANK    WL0022           CDD Comment 3
     C                     MOVEL*BLANK    WL0023           CDD Comment 4
     C                     MOVEL*BLANK    WL0024           CDD Comment 5
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWJRPNA    WL0004           CDD Name of Ove
     C                     MOVELWJDTVN    WL0005           CDD Program Nam
     C                     MOVELWJDUVN    WL0006           CDD Printer Fil
     C                     MOVELWJEWT1    WL0007           CDD Sender Phon
     C                     MOVELWJEXT1    WL0008           CDD Sender Fax
     C                     MOVELWJDXVN    WL0009           Output Queue
     C                     MOVELWJKMT1    WL0010           Hold File
     C                     MOVELWJKNT1    WL0011           Save File
     C                     Z-ADDWJGXNY    WL0012           Source Drawer
     C                     MOVELWJDWVN    WL0013           Printer Device
     C                     Z-ADDWJGZNY    WL0014           Page Length 2
     C                     Z-ADDWJG0NY    WL0015           Page Width 2
     C                     Z-ADDWJG1NY    WL0016           Page LPI
     C                     Z-ADDWJG2NY    WL0017           Page CPI
     C                     Z-ADDWJGYNY    WL0018           Page Overflow
     C                     MOVELWJKOT1    WL0019           Page Rotation
     C                     MOVELWJEYT1    WL0020           CDD Comment 1
     C                     MOVELWJEZT1    WL0021           CDD Comment 2
     C                     MOVELWJKBT1    WL0022           CDD Comment 3
     C                     MOVELWJKCT1    WL0023           CDD Comment 4
     C                     MOVELWJKDT1    WL0024           CDD Comment 5
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCHRC    BEGSR
      *================================================================
      * CHG BOL Printed        CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0310  30       Company Number
     C                     Z-ADD*ZERO     WN0311  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0312  1        LTL Flag
     C                     MOVEL*BLANK    WN0313  1        Load Status
     C                     Z-ADD*ZERO     WN0314  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0315 15        Seal 1
     C                     MOVEL*BLANK    WN0316 15        Seal 2
     C                     MOVEL*BLANK    WN0317 15        Seal 3
     C                     MOVEL*BLANK    WN0318 15        Seal 4
     C                     MOVEL*BLANK    WN0319 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0320  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0321 112       Flat Amount
     C                     MOVEL*BLANK    WN0322  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0323  50       Total Stops
     C                     MOVEL*BLANK    WN0324 20        Trailer Id
     C                     MOVEL*BLANK    WN0325  3        Transloader Car
     C                     Z-ADD*ZERO     WN0326  40       BOL Time
     C                     MOVEL*BLANK    WN0327  3        Carrier Code
     C                     MOVEL*BLANK    WN0328  7        Truck Size
     C                     Z-ADD*ZERO     WN0329  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0330 112       Rated Freight
     C                     MOVEL*BLANK    WN0331  1        Ship Status
     C                     MOVEL*BLANK    WN0332  1        Load Type
     C                     Z-ADD*ZERO     WN0333  50       Number Pallets
     C                     Z-ADD*ZERO     WN0334  50       Number Pallets
     C                     Z-ADD*ZERO     WN0335 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0336  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0337  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0338  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0339 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0340 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0341  70       Actual Departur
     C                     Z-ADD*ZERO     WN0342  40       Departure Time
     C                     Z-ADD*ZERO     WN0343  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0344  52       Product Tempera
     C                     Z-ADD*ZERO     WN0345  50       Number Spacers
     C                     MOVEL*BLANK    WN0346 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0347  70       Total Load Mile
     C                     MOVEL*BLANK    WN0348 12        Recorder ID
     C                     MOVEL*BLANK    WN0349  2        Shipping Method
     C                     MOVEL*BLANK    WN0350  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0351  2        Ship To State C
     C                     Z-ADD*ZERO     WN0352  70       Gross Weight
     C                     MOVEL*BLANK    WN0353  3        Carrier Broker
     C                     MOVEL*BLANK    WN0354  1        Export Status
     C                     Z-ADD*ZERO     WN0355  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0356  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0357  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0358  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0359  70       Spotted Date
     C                     Z-ADD*ZERO     WN0360  60       Spotted Time
     C                     Z-ADD*ZERO     WN0361  70       Load Finished D
     C                     Z-ADD*ZERO     WN0362  60       Load Finished T
     C                     Z-ADD*ZERO     WN0363  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0364  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0365  70       Truck Departure
     C                     Z-ADD*ZERO     WN0366  60       Truck Departure
     C                     Z-ADD*ZERO     WN0367  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0368  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0369  3        Shipping Line
     C                     MOVEL*BLANK    WN0370 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0371 30        Vessel Name
     C                     Z-ADD*ZERO     WN0372  50       Voyage
     C                     Z-ADD*ZERO     WN0373  70       Sail Date
     C                     MOVEL*BLANK    WN0374 12        Booking Number
     C                     MOVEL*BLANK    WN0375 20        Discharge Port
     C                     Z-ADD*ZERO     WN0376  70       Arrival Date
     C                     MOVEL*BLANK    WN0377 12        Container Numbe
     C                     Z-ADD*ZERO     WN0378  70       Date In
     C                     Z-ADD*ZERO     WN0379  60       Time In
     C                     Z-ADD*ZERO     WN0380  70       Date Out
     C                     Z-ADD*ZERO     WN0381  60       Time Out
     C                     Z-ADD*ZERO     WN0382 112       Load Total Frei
     C                     MOVEL*BLANK    WN0383  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0384  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0385  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0386  70       Requested Deliv
     C                     MOVEL*BLANK    WN0387  1        Load Acceptance
     C                     MOVEL*BLANK    WN0388  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0389  70       On Yard Date
     C                     Z-ADD*ZERO     WN0390  60       On Yard Time
     C                     Z-ADD*ZERO     WN0391  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0392  60       Deadline Depart
     C                     MOVEL*BLANK    WN0393  1        Load Held Over
     C                     MOVEL*BLANK    WN0394  1        Load Held Over
     C                     MOVEL*BLANK    WN0395 15        Load Held Over
     C                     MOVEL*BLANK    WN0396 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0397 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0398  70       Express Mail Da
     C                     MOVEL*BLANK    WN0399  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0400  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0401  70       Product Complet
     C                     Z-ADD*ZERO     WN0402  60       Product Complet
     C                     Z-ADD*ZERO     WN0403  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0404  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0405  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0406  1        Load Confirmed
     C                     MOVEL*BLANK    WN0407 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0408  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0409  60       Load Door 1
     C                     Z-ADD*ZERO     WN0410  70       Override Total
     C                     Z-ADD*ZERO     WN0411  60       Load Door 2
     C                     MOVEL*BLANK    WN0412  1        Partial Load
     C                     MOVEL*BLANK    WN0413  1        Load Confirmati
     C                     MOVEL*BLANK    WN0414  1        Export Load USD
     C                     MOVEL*BLANK    WN0415  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0416 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0417 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0418 15        Late Billing Em
     C                     MOVEL*BLANK    WN0419 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0420 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0421  1        Multi Company L
     C                     MOVEL*BLANK    WN0422  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0423  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0424  1        LH Power Only L
     C                     MOVEL*BLANK    WN0425  1        MG Created Load
     C                     MOVEL*BLANK    WN0426  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0427  2        Load U/M
     C                     MOVEL*BLANK    WN0428  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0429  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0430  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0431  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0432  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0433  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0434  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0435  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0436  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0437  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0438  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0439  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0440  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0441  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0442  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0443  60       LH Unused Time
     C                     MOVEL*BLANK    WN0444  1        EDI Status 2
     C                     MOVEL*BLANK    WN0445  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0446  60       Job Time
     C                     MOVEL*BLANK    WN0447 10        User Id
     C                     MOVEL*BLANK    WN0448 10        Job Name
     C                     Z-ADD*ZERO     WN0449  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADD#1RMNB    WDRMNB           Load ID
      *
     C           KLCHSO    KLIST
     C                     KFLD           WDRMNB           Load ID
     C           KLCHSO    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YDRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADD#1J7DT    WDJ7DT           BOL Complete Da
     C                     Z-ADD#1BOTM    WDBOTM           BOL Complete Ti
     C                     Z-ADD#1KJDT    WDKJDT           Scheduled Deliv
     C                     Z-ADD#1ATTM    WDATTM           Scheduled Deliv
     C                     MOVELP1UVST    WDUVST    P      EDI Status 1
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##PGM     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
      * CASE: DB1.MG Created Load is Yes
     C           WDRYSX    IFEQ 'Y'                        *IF
      * MG Crt Trgr per Load  XF - Order Header TRG  * 
     C                     CALL 'PBXJXFR'              90  MG Crt Trgr per
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WDRMNB    WQ0038  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBXJXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV First Order on LoadRT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKRMNB    WQSP02           Load ID
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSP02           Load ID
      * Establish starting position
     C           KRSSP     SETLL@FLCPE8                    *
     C           KRSSP     READE@FLCPE8                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0030           Order Number
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWKC4NB    YL0030           Order Number
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SPEXIT                     *QUIT
     C           KRSSP     READE@FLCPE8                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV HPB Override typeRT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WLAIC3           Company Number
     C                     Z-ADDYL0030    WLC4NB           Order Number
      * Establish starting position
     C           KRSSQ     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0031           OHE Override Ty
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWLCHTX    YL0031           OHE Override Ty
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Ship Cust,Ordr Typ RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WBAIC3           Company Number
     C                     Z-ADDYL0030    WBC4NB           Order Number
      * Establish starting position
     C           KRSSR     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0032           Ship To Custome
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBBKC7    YL0032           Ship To Custome
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * RTV Type Code by Cust  RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMBKC7    WQSS01           Ship To Custome
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           Ship To Custome
      * Setup key
     C                     Z-ADDYL0032    WQSS01           Ship To Custome
      * Establish starting position
     C           KRSSS     SETLL@EOREIQ                    *
     C           KRSSS     READE@EOREIQ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0033           Type Code
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWMBOCD    YL0033           Type Code
     C           KRSSS     READE@EOREIQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * RTV Alpha Value        RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WOAIC3           Company Number
     C                     KFLD           WOV8CD           Company Value C
      * Setup key
     C                     Z-ADD#1AIC3    WOAIC3           Company Number
     C                     MOVEL@CN,004   WOV8CD           Company Value C
      * Establish starting position
     C           KRSST     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWOBXTX    WUQ1ST           System Value Al
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Rtv Transload Stn Nm  RT - COA Transloading Station  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WRIZAA           COA Station Cod
      * Setup key
     C                     MOVELWL0025    WRIZAA           COA Station Cod
      * Establish starting position
     C           KRSSU     CHAIN@DLRERJ              90    *
      * Data record not found
     C   90                MOVEL'USR3897' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWRNIT1    WL0026           COA Station Nam
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * RTV Combo for P & T    RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/11/04 SLM PKTR01 Multi-Company Order Header TFG
      *                     Remove Co from Parms
     C                     MOVEL*BLANK    YL0047           U/M - Ordered
      * RMC added 6-30-21
     C                     MOVEL*BLANK    YL0048           Palletize
      * Declare restrictor key work fields
     C           *LIKE     DEFN TARMNB    WQSV01           Load ID
     C           *LIKE     DEFN TAC4NB    WQSV02           Order Number
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV01           Load ID
     C                     KFLD           WQSV02           Order Number
      * Setup key
     C                     Z-ADD#1RMNB    WQSV01           Load ID
     C                     Z-ADD1         WQSV02           Order Number
      * Establish starting position
     C           KRSSV     SETLL@BFCPR0                    *
     C           KRSSV     READE@BFCPR0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     GOTO SVEXIT                     *QUIT
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RMC change par.palletize to BOTH .. was output - 6/30/21
      * CASE: PAR.U/M - Ordered is Mixed
     C           YL0047    IFEQ 'MX'                       *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELTAVEST    YL0046           Palletize
      * RTV Combo for P & T    RT - Order Detail  * 
     C                     EXSR SWRVGN
     C                     END                             *FI
      * RMC after 6-30-21   check par.palletize
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Palletize is no
      *   |- c2    : PAR.U/M - Ordered is Combos
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0046    IFEQ 'N'                        *IF
     C           YL0047    IFEQ 'CB'                       *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       YL0048           Palletize
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Pallet Flag/Combo  RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTAAIC3    WL0027           Company Number
     C                     Z-ADDTAC4NB    WL0028           Order Number
     C                     Z-ADD1         WL0029           Order Sequence
     C                     Z-ADD1         WL0030           Order Secondary
     C                     EXSR SXRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0031    YL0048    P      Palletize
     C                     END                             *FI
     C           KRSSV     READE@BFCPR0                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * RTV Combo for P & T    RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WUTAST           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSW01           Company Number
     C           *LIKE     DEFN WFC4NB    WQSW02           Order Number
      * Define keylist
     C           KPSSW     KLIST
     C                     KFLD           WQSW01           Company Number
     C                     KFLD           WQSW02           Order Number
     C                     KFLD           WFDPNB           Order Sequence
     C                     KFLD           WFUENB           Order Secondary
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WQSW01           Company Number
     C                     KFLD           WQSW02           Order Number
      * Setup key
     C                     Z-ADDTAAIC3    WQSW01           Company Number
     C                     Z-ADDTAC4NB    WQSW02           Order Number
     C                     Z-ADD1         WFDPNB           Order Sequence
     C                     Z-ADD1         WFUENB           Order Secondary
      * Establish starting position
     C           KPSSW     SETLL@BGWKL1                    *
     C           KRSSW     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0047           U/M - Ordered
     C                     GOTO SWEXIT                     *QUIT
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Cancelled
     C           WFGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.U/M - Ordered is Not Entered
     C           YL0047    IFEQ *BLANK                     *IF
     C                     MOVELWFAGCD    YL0047           U/M - Ordered
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.U/M - Ordered EQ PAR.U/M - Ordered
     C           WFAGCD    IFEQ YL0047                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'MX'      YL0047           U/M - Ordered
     C                     GOTO SWEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSW     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV Pallet Flag/Combo  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    WL0031           Palletize
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSX01           Company Number
     C           *LIKE     DEFN WFC4NB    WQSX02           Order Number
      * Define keylist
     C           KPSSX     KLIST
     C                     KFLD           WQSX01           Company Number
     C                     KFLD           WQSX02           Order Number
     C                     KFLD           WFDPNB           Order Sequence
     C                     KFLD           WFUENB           Order Secondary
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WQSX01           Company Number
     C                     KFLD           WQSX02           Order Number
      * Setup key
     C                     Z-ADDWL0027    WQSX01           Company Number
     C                     Z-ADDWL0028    WQSX02           Order Number
     C                     Z-ADDWL0029    WFDPNB           Order Sequence
     C                     Z-ADDWL0030    WFUENB           Order Secondary
      * Establish starting position
     C           KPSSX     SETLL@BGWKL1                    *
     C           KRSSX     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RMC added not Cancelled check 6-30-21
      * CASE: DB1.Detail Line Status is Not cancelled
     C           WFGMST    IFEQ 'L'                        *IF
     C           WFGMST    OREQ 'A'
     C           WFGMST    OREQ 'C'
     C           WFGMST    OREQ 'R'
     C           WFGMST    OREQ 'E'
     C           WFGMST    OREQ 'H'
     C           WFGMST    OREQ 'I'
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.U/M - Ordered is Combos
      *   |- c2    : DB1.Palletize is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WFAGCD    IFEQ 'CB'                       *IF
     C           WFVEST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVELWFVEST    WL0031           Palletize
     C                     GOTO SXEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSX     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           TBAIC3           Company Number
      * Setup key
     C                     Z-ADD#1AIC3    TBAIC3           Company Number
      * Establish starting position
     C           KRSSY     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DAGTX           Name
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELTBADTX    #DAGTX           Name
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * Rtv Whs Pallet Tare   RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WERMNB    WQSZ01           Load ID
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WQSZ01           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSZ01           Load ID
      * Establish starting position
     C           KRSSZ     SETLL@FLCPBW                    *
     C           KRSSZ     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Record Found USR is Record Not Found
     C           YL0049    IFEQ 'N'                        *IF
      * Rtv Whs Pallet Tare   RT - PD Order Detail  * 
     C                     EXSR TARVGN
     C                     MOVELWEICSX    #DICSX           HPB Transload S
     C                     ELSE
      * CASE: *OTHERWISE
     C                     GOTO SZEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSZ     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * Rtv Whs Pallet Tare   RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQTA01           Company Number
     C           *LIKE     DEFN WFC4NB    WQTA02           Order Number
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA01           Company Number
     C                     KFLD           WQTA02           Order Number
      * Setup key
     C                     Z-ADDWEAIC3    WQTA01           Company Number
     C                     Z-ADDWEC4NB    WQTA02           Order Number
      * Establish starting position
     C           KRSTA     SETLL@BGWKL1                    *
     C           KRSTA     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #1PAOU           Warehouse Palle
     C                     Z-ADD*ZERO     #1IDWG           Warehouse Palle
     C                     Z-ADD*ZERO     #1ICWG           Warehouse Avg P
     C                     MOVEL*BLANK    YL0049           Record Found US
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Warehouse Code NE PAR.USR Warehouse Code
     C           WFAJCD    IFNE P6CPCD                     *IF
     C                     GOTO TAEXIT                     *QUIT
     C                     END                             *FI
      * CASE: DB1.Detail Line Status is Not cancelled
     C           WFGMST    IFEQ 'L'                        *IF
     C           WFGMST    OREQ 'A'
     C           WFGMST    OREQ 'C'
     C           WFGMST    OREQ 'R'
     C           WFGMST    OREQ 'E'
     C           WFGMST    OREQ 'H'
     C           WFGMST    OREQ 'I'
      * PAR = DB1 By name
     C                     Z-ADDWFNTDT    #1PAOU           Warehouse Palle
     C                     Z-ADDWFH5NX    #1IDWG           Warehouse Palle
     C                     Z-ADDWFH6NX    #1ICWG           Warehouse Avg P
     C                     MOVEL'Y'       YL0049           Record Found US
     C                     GOTO TAEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTA     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           TCAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0450    TCAJVN           User Profile Na
      * Establish starting position
     C           KRSTB     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELTCI6ST    WUI6ST           Allow Multi-Com
     C                     MOVELTCMPNA    WUMPNA           Default Printer
     C                     MOVELTCBCCD    WUBCCD           Salesperson Cod
     C                     Z-ADDTCAIC3    YL0050           Company Number
     C                     MOVELTCBUVN    WN0451           User Code Model
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - User Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           TDAJVN           User Profile Na
     C                     KFLD           TDDNCD           Application Cod
      * Setup key
     C                     MOVELWL0032    TDAJVN           User Profile Na
     C                     MOVELWL0033    TDDNCD           Application Cod
      * Establish starting position
     C           KRSTC     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDTDAIC3    WL0034           Company Number
     C                     MOVELTDAJCD    WL0035           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TEDNCD    WQTD01           Application Cod
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WQTD01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQTD01           Application Cod
     C                     MOVEL'OMS'     WQTD01           Application Cod
      * Establish starting position
     C           KRSTD     SETLL@DNRESF                    *
     C           KRSTD     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           TERSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELTEAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR TERVGN
     C                     END                             *FI
     C           KRSTD     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TEDNCD    WQTE01           Application Cod
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           WQTE01           Application Cod
      * Setup key
     C                     MOVELTERSCD    WQTE01           Application Cod
      * Establish starting position
     C           KRSTE     SETLL@DNRESF                    *
     C           KRSTE     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELTEAUNA    WUAUNA           Description
     C           KRSTE     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           TFAIC3           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    TFAIC3           Company Number
      * Establish starting position
     C           KRSTF     CHAIN@JYRECE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2025' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0011           Company Organiz
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELTFYJSX    YL0011           Company Organiz
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Load OM Load Header file fields prior to update
      *================================================================
      * ** Screen Seal fields were changed to 8 bytes.        E000752
     C                     MOVEL*BLANK    #1DMTX           Seal 1
     C                     MOVEL#DZ4TX    #1DMTX           Seal 1
     C                     MOVEL*BLANK    #1DNTX           Seal 2
     C                     MOVEL#DZ5TX    #1DNTX           Seal 2
     C                     MOVEL*BLANK    #1DOTX           Seal 3
     C                     MOVEL#DZ6TX    #1DOTX           Seal 3
     C                     Z-ADD#DPRUS    #1SDNB           Number Pallets
     C                     Z-ADD#DPUUS    #1NPSV           Number Spacers
      * ** If Shipping Method is changed, update the Load Header  S00299
      * ** If Shipping Method is changed to Collect
      * CASE: DTL.Collect/Prepaid USR is Collect
     C           #DCRST    IFEQ 'C'                        *IF
      * ** if shipping method was prepaid truck, change to collect truck
      * CASE: DTL.Shipping Method is Prepaid Truck
     C           #1Q2CD    IFEQ 'PT'                       *IF
     C                     MOVEL'CT'      #1Q2CD           Shipping Method
     C                     END                             *FI
      * ** if shipping method was prepaid rail, change to collect rail
      * CASE: DTL.Shipping Method is Prepaid Rail
     C           #1Q2CD    IFEQ 'PR'                       *IF
     C                     MOVEL'CR'      #1Q2CD           Shipping Method
     C                     END                             *FI
     C                     END                             *FI
      * ** If Shipping Method is changed to Prepaid
      * CASE: DTL.Collect/Prepaid USR is Prepaid
     C           #DCRST    IFEQ 'P'                        *IF
      * ** if shipping method was collect truck, change to prepaid truck
      * CASE: DTL.Shipping Method is Collect Truck
     C           #1Q2CD    IFEQ 'CT'                       *IF
     C                     MOVEL'PT'      #1Q2CD           Shipping Method
     C                     END                             *FI
      * ** if shipping method was collect rail, change to prepaid rail
      * CASE: DTL.Shipping Method is Collect Rail
     C           #1Q2CD    IFEQ 'CR'                       *IF
     C                     MOVEL'PR'      #1Q2CD           Shipping Method
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * *OMS336* Verify Pallets Loaded and Total Pallet Tare are entered
      *================================================================
      * Validate only for Seaboard
      * CASE: LCL.Company Organization is Seaboard
     C           YL0011    IFEQ 'S'                        *IF
     C                     MOVEL'N'       YL0045           Yes/No Selectio
      * CASE: DTL.Number Pallets Loaded is Greater than zero
     C           #1PAOU    IFGT *ZERO                      *IF
      * CASE: DTL.Tot Pallet Tare is Not Entered
     C           #1IDWG    IFEQ *ZERO                      *IF
     C                     MOVEL'Y'       YL0045           Yes/No Selectio
     C                     END                             *FI
     C                     END                             *FI
      * CASE: LCL.Yes/No Selection      USR is Yes
     C           YL0045    IFEQ 'Y'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Number Pallets Loaded is Equal zero
     C           #1PAOU    IFEQ *ZERO                      *IF
      * CASE: DTL.Tot Pallet Tare is GT Zero
     C           #1IDWG    IFGT *ZERO                      *IF
     C                     MOVEL'Y'       YL0045           Yes/No Selectio
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * error msg
      * CASE: LCL.Yes/No Selection      USR is Yes
     C           YL0045    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     Z-ADD#1PAOU    ZA0003           Number Pallets
     C                     Z-ADD#1IDWG    ZA0004           Tot Pallet Tare
      * Send message 'Both Total Pallet ...'
     C                     MOVEL'USR2942' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993536*
      *
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * *OMS336* Verify Pallet/Tare Info entered for Combos
      *================================================================
      * 05/11/04 SLM PKTR01 Multi-Company - Function was changed
      *    to remove Company RST or Pos
      * RTV Combo for P & T    RT - Order Header TRG  * 
     C                     EXSR SVRVGN
      * ***  Verifying that Combos are palletized.
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : DTL.Number Pallets Loaded is Zero
      *   |- c2    : DTL.Tot Pallet Tare is Not Entered
      *   |- c3    : LCL.Company Organization is Seaboard
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1PAOU    IFEQ *ZERO                      *IF
     C           #1IDWG    IFEQ *ZERO                      *IF
     C           YL0011    IFEQ 'S'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * U/M - Ordered is Combos or Mixed
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.U/M - Ordered is Combos
      *   |- c2    : LCL.U/M - Ordered is Mixed
      *   '-
     C           YL0047    IFEQ 'CB'                       *IF
     C           YL0047    OREQ 'MX'                       *OR
      * CASE: LCL.Palletize             USR is no
     C           YL0048    IFEQ 'N'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     Z-ADD#1PAOU    ZA0005           Number Pallets
     C                     Z-ADD#1IDWG    ZA0006           Tot Pallet Tare
      * Send message 'Pallet Tare Info Req ...'
     C                     MOVEL'USR2943' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993536*
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * U/M - Ordered is Boxes
      * CASE: LCL.U/M - Ordered is EQ Boxes
     C           YL0047    IFEQ 'BX'                       *IF
      * CASE: LCL.Palletize is no
     C           YL0046    IFEQ 'N'                        *IF
      * Setup message data for message
     C                     Z-ADD#1PAOU    ZA0007           Number Pallets
     C                     Z-ADD#1IDWG    ZA0008           Tot Pallet Tare
      * Send message 'Pallet Tare Info Not ...'
     C                     MOVEL'USR2944' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.U/M - Ordered is Combos
      *   |- c2    : LCL.Palletize             USR is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0047    IFEQ 'CB'                       *IF
     C           YL0048    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     Z-ADD#1PAOU    ZA0009           Number Pallets
     C                     Z-ADD#1IDWG    ZA0010           Tot Pallet Tare
      * Send message 'Pallet Tare Info Not...'
     C                     MOVEL'USR2947' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Load Screen Fields
      *================================================================
      * DTL = PAR By name
     C                     MOVELP1VDST    #1VDST           Load Type
     C                     Z-ADDP1AIC3    #1AIC3           Company Number
     C                     Z-ADDP1RMNB    #1RMNB           Load ID
     C                     Z-ADDP1AODT    #1AODT           Scheduled Ship
     C                     MOVELP1PKST    #1PKST           Load Status
     C                     Z-ADDP1RNNB    #1RNNB           Reefer Temperat
     C                     Z-ADDP1PRTM    #1PRTM           Product Tempera
     C                     Z-ADDP1PAOU    #1PAOU           Number Pallets
     C                     Z-ADDP1ICWG    #1ICWG           Avg Pallet Tare
     C                     Z-ADDP1IDWG    #1IDWG           Tot Pallet Tare
     C                     MOVELP1DMTX    #1DMTX           Seal 1
     C                     MOVELP1DNTX    #1DNTX           Seal 2
     C                     MOVELP1DOTX    #1DOTX           Seal 3
     C                     Z-ADDP1RPNB    #1RPNB           Total Load Orde
     C                     Z-ADDP1FLAM    #1FLAM           Flat Amount
     C                     MOVELP1XQST    #1XQST           Allocate Pounds
     C                     Z-ADDP1RRNB    #1RRNB           Total Stops
     C                     MOVELP1DXTX    #1DXTX           Trailer Id
     C                     Z-ADDP1SDNB    #1SDNB           Number Pallets
     C                     Z-ADDP1NPSV    #1NPSV           Number Spacers
     C                     MOVELP1J8TX    #1J8TX           Car/Veh. Initia
     C                     Z-ADDP1TLMI    #1TLMI           Total Load Mile
     C                     MOVELP1J9TX    #1J9TX           Recorder ID
     C                     MOVELP1Q2CD    #1Q2CD           Shipping Method
     C                     MOVELP1RQST    #1RQST           Export Load USD
     C                     MOVELP7ICSX    #DICSX           HPB Transload S
     C                     MOVELP1VPCD    #1VPCD           Ship From Wareh
     C                     MOVELP1DBCD    #1DBCD           Ship To State C
     C                     MOVELP1U2ST    #1U2ST           Export Status
     C                     Z-ADDP1J7DT    #1J7DT           BOL Complete Da
     C                     Z-ADDP1BOTM    #1BOTM           BOL Complete Ti
     C                     Z-ADDP1KJDT    #1KJDT           Scheduled Deliv
     C                     Z-ADDP1ATTM    #1ATTM           Scheduled Deliv
     C                     MOVELP1WRTX    #1WRTX           Shipping Temp C
     C                     MOVELP1UVST    #1UVST           EDI Status 1
     C                     Z-ADDP1AATM    #1AATM           Job Time
     C                     Z-ADDP1AXDT    #1AXDT           Job Date
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SYRVGN
     C                     MOVELP1DXTX    #DS2TX           Trailer ID USR
      * ** Truncate Seal#s to 8 characters                    E000752
     C                     MOVELP1DMTX    #DZ4TX           Seal 1 USR Alph
      * ** default zeros to blanks
      * CASE: DTL.Seal 1 USR Alpha is ALL ZEROS
     C           #DZ4TX    IFEQ @CN,005                    *IF
     C                     MOVEL*BLANK    #DZ4TX           Seal 1 USR Alph
     C                     END                             *FI
     C                     MOVELP1DNTX    #DZ5TX           Seal 2 USR Alph
      * ** default zeros to blanks
      * CASE: DTL.Seal 2 USR Alpha is ALL ZEROS
     C           #DZ5TX    IFEQ @CN,005                    *IF
     C                     MOVEL*BLANK    #DZ5TX           Seal 2 USR Alph
     C                     END                             *FI
     C                     MOVELP1DOTX    #DZ6TX           Seal 3 USR Alph
      * ** default zeros to blanks
      * CASE: DTL.Seal 3 USR Alpha is ALL ZEROS
     C           #DZ6TX    IFEQ @CN,005                    *IF
     C                     MOVEL*BLANK    #DZ6TX           Seal 3 USR Alph
     C                     END                             *FI
     C                     MOVELP1U2ST    #1U2ST           Export Status
     C                     MOVELP1RQST    #1RQST           Export Load USD
     C                     Z-ADD#1PAOU    #DPLUS           Pallets Loaded
     C                     Z-ADD#1SDNB    #DPRUS           Pallets Receive
     C                     Z-ADD#1NPSV    #DPUUS           Pallets Unservi
     C                     MOVEL#1Q2CD    #DCRST           Collect/Prepaid
      * DTL.Condition Desc. 10 USR = Condition name of DTL.Shipping Metho
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1252129   Y2LSNO  70       List number
     C                     PARM #1Q2CD    W0INVL 25        Shipping Method
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHUTX    PARM           W0CNNM 25        Condition Desc.
      *
      * DTL.Load Type Desc = Condition name of DTL.Load Type
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1250409   Y2LSNO  70       List number
     C                     PARM #1VDST    W0INVL 25        Load Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DNONA    PARM           W0CNNM 25        Load Type Desc
      *
      * ** BOL Print Type is no longer used, don't populate the field E75
      * OMS336
      * FP1110 HPB Get transload stn       02/29/08 RMC
      * Rtv Whs Pallet Tare   RT - Load Detail  * 
     C                     EXSR SZRVGN
     C                     MOVEL#DICSX    P7ICSX           HPB Transload S
      * Rtv Transload Stn Nm  RT - COA Transloading Station  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DICSX    WL0025    P      COA Station Cod
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0026    #DNIT1    P      COA Station Nam
     C                     MOVELP1WRTX    #DFRSX           Shipping Temp C
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * *****
      * RMC 9/18/19 T15460 HPB - get back overlay from CDD doc dft, pass
      *  PDA3PCL to use on override for pmo7pf$
      * *****
      * DN  08/06/2019 R15161 - Export Load AS400 Updates
      * - DBF Change on Order Header Extsn (PMAMREP) File. Changed:
      *   OHE Voyage/Flight from 5.0 to 15A.
      *   OHE Booking Number from 12A to 15A.
      *   Added: OHE Genset Number 15A.
      * - Recompiled only.
      * *****
      * RMC 7/21/2016 E4119 TMS - write load trigger for chg in seals, tr
      *  write order trigger for all orders in load in LH chgobj  8.09.16
      * *****
      * RMC 6/22/2012 E2079  HPB Print 2nd bol if MK cust only, not for 3
      * *****
      * RMC 5/21/2012 E2117  Added EXport USDA Approved sts for update
      * *****
      * RMC 4/27/2011 E01515 HPB Only - use acctng co when rtv overlay nm
      * *****
      * ** 05/11/2010 LJB E000752
      * ** Seal Numbers are now 8 bytes and can contain characters.
      * ** Change to stop converting them to numeric prior to displaying.
      * ** Change the Display length to 8. Comment out text for unused fi
      * *****
      * ** S00299 LJB 06/18/2008
      * ** This program is replacing the Shipping Method on the Load
      * ** Header. Commented the code in the Validation routine, changed
      * ** it to only replace the 1st letter in the Update section.
      * *****
      * ** FP1110 RMC 04/11/2008
      * ** If Company Org is "H"igh Plains,  output prod temp which is te
      * ** loadout. they have to unship and reship if this isnt right
      * *****
      * ** FP1110 RMC 02/29/2008
      * ** If Company Org is "H"igh Plains,  display "Transloading Statio
      * ** entry field. if fuel is taken to a transloading stn then
      * ** loaded on a rail car, enter the station location -store in Loa
      * *****
      * ** FP1110 RMC 12/19/2007
      * ** If Company Org is "H"igh Plains,  determine which BOL type to
      * ** use based on the Warehouse.
      * **  If the Warehouse requires meter readings use "BL" else
      * **  use "BY" which is the BOL for By Products
      * *****
      * ** DLY029 TCJ 09/26/2007
      * ** Make Pallets Loaded, Tot Pallet Tare, and Trailer Number
      * ** optional for Dailys
      * *****
      * ** DLY029 RMC 09/05/2007
      * ** Retrieve Company Value TRFYRDMGT to determine if Trailer Id is
      * *****
      * ** DLY029 LJB 06/05/2007
      * ** Retrieve CDD Type, Dept, and overlay name from Company
      * ** Document Defaults file and pass to the submit CL program.
      * *****
      * ** FP11014 LJB 04/25/2007
      * ** Prompt of status fields was required in several places to get
      * ** Synon to recognize the field due to a definition change at som
      * ** time in the past.
      * *****
      * 05/11/04 SLM PKTR01 Multi-Company - Order Header TRG Remove Co
      *                                     from Logical View
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Select existing record
      *================================================================
      * Name search required?
     C           YPMTFD    IFEQ '#1RMNB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1RMNB' defaulted for 'Load ID'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
     C                     CALL 'OMCPSRR'              90  SEL Load ID
     C                     PARM *BLANK    W0RTN   7
     C           #1RMNB    PARM #1RMNB    WQ0050  70       Load ID
     C           #1AIC3    PARM #1AIC3    WQ0051  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMCPSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1RMNB    IFNE *ZERO                      Load ID
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Company Name and Address
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
     C                     CALL 'CAAJSRR'              90  SEL Company by
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0052  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAAJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AIC3    IFEQ *ZERO                      Company Number
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBWS    KLIST
     C                     KFLD           WSAIC3           Company Number
      * Setup key
     C                     Z-ADD#1AIC3    WSAIC3
     C           KLVBWS    CHAIN@ABREUA              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Company Name and Addre NF'
     C                     MOVEL'USR0003' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0003' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Calendar
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1AODT    IFEQ *ZERO                      Post to G/L Dat
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCWT    KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADD#1AIC3    WTAIC3
     C                     Z-ADD#1AODT    WTBCDT
     C           KLVCWT    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Calendar not found'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to Carrier
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1BZNA    WK1X01  1
     C           WK1X01    IFEQ '?'                        Carrier Code
     C           YPMTFD    OREQ '#1BZNA'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1BZNA' defaulted for 'Carrier Code'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(LCL) YL0035' defaulted for 'Name'.
     C                     CALL 'PDWHSRR'              90  SEL Carrier Nam
     C                     PARM *BLANK    W0RTN   7
     C           #1BZNA    PARM #1BZNA    WQ0053  3        Carrier Code
     C           YL0035    PARM *BLANK    WQ0054 30        Name
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDWHSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1BZNA    IFNE *BLANK                     Carrier Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VDEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1BZNA    IFEQ *BLANK                     Carrier Code
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDWV    KLIST
     C                     KFLD           WVBZNA           Carrier Code
      * Setup key
     C                     MOVEL#1BZNA    WVBZNA
     C           KLVDWV    CHAIN@FFREBF              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VDEXIT
     C                     END
      * Send message 'Carrier                NF'
     C                     MOVEL'USR1180' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1180' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         VECKRL    BEGSR
      *================================================================
      * Check reference to Truck Size
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1RONB    WK1X01  1
     C           WK1X01    IFEQ '?'                        Truck Size
     C           YPMTFD    OREQ '#1RONB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1RONB' defaulted for 'Truck Size'.
     C                     CALL 'PDEPSRR'              90  SEL Truck Size
     C                     PARM *BLANK    W0RTN   7
     C           #1RONB    PARM #1RONB    WQ0055  7        Truck Size
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEPSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1RONB    IFNE *BLANK                     Truck Size
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VEEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RONB    IFEQ *BLANK                     Truck Size
     C                     GOTO VEEXIT
     C                     END
      *
     C           KLVEWW    KLIST
     C                     KFLD           WWRONB           Truck Size
      * Setup key
     C                     MOVEL#1RONB    WWRONB
     C           KLVEWW    CHAIN@FKREBT              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VEEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VEEXIT
     C                     END
      * Send message 'Truck Size             NF'
     C                     MOVEL'USR1190' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1190' W0RTN
      *================================================================
     CSR         VEEXIT    ENDSR
      /EJECT
     CSR         VFCKRL    BEGSR
      *================================================================
      * Check reference to Calendar
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1HADT    IFEQ *ZERO                      Post to G/L Dat
     C                     GOTO VFEXIT
     C                     END
      *
     C           KLVFWT    KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADD#1AIC3    WTAIC3
     C                     Z-ADD#1HADT    WTBCDT
     C           KLVFWT    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VFEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VFEXIT
     C                     END
      * Send message 'Calendar not found'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VFEXIT    ENDSR
      /EJECT
     CSR         VGCKRL    BEGSR
      *================================================================
      * Check reference to Calendar
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1AQDT    IFEQ *ZERO                      Post to G/L Dat
     C                     GOTO VGEXIT
     C                     END
      *
     C           KLVGWT    KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADD#1AIC3    WTAIC3
     C                     Z-ADD#1AQDT    WTBCDT
     C           KLVGWT    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VGEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VGEXIT
     C                     END
      * Send message 'Calendar not found'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VGEXIT    ENDSR
      /EJECT
     CSR         VHCKRL    BEGSR
      *================================================================
      * Check reference to Warehouse
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1VPCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Warehouse Code
     C           YPMTFD    OREQ '#1VPCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1VPCD' defaulted for 'Ship From Warehouse'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(CON) *ZERO' defaulted for 'Accounting Company'.
     C                     CALL 'PMCQSRR'              90  SEL AcctCo/Ware
     C                     PARM *BLANK    W0RTN   7
     C           #1VPCD    PARM #1VPCD    WQ0056  3        Warehouse Code
     C                     PARM *ZERO     WQ0057  30       Accounting Comp
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCQSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1VPCD    IFNE *BLANK                     Warehouse Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VHEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1VPCD    IFEQ *BLANK                     Warehouse Code
     C                     GOTO VHEXIT
     C                     END
      *
     C           KLVHWI    KLIST
     C                     KFLD           WIAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#1VPCD    WIAJCD
     C           KLVHWI    CHAIN@ADREAO              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VHEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VHEXIT
     C                     END
      * Send message 'Warehouse              NF'
     C                     MOVEL'USR0007' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0007' W0RTN
      *================================================================
     CSR         VHEXIT    ENDSR
      /EJECT
     CSR         VICKRL    BEGSR
      *================================================================
      * Check reference to State
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DBCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        State Code
     C           YPMTFD    OREQ '#1DBCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1DBCD' defaulted for 'Ship To State Code'.
     C                     CALL 'CAAHSRR'              90  SEL State
     C                     PARM *BLANK    W0RTN   7
     C           #1DBCD    PARM #1DBCD    WQ0058  2        State Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAAHSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1DBCD    IFNE *BLANK                     State Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VIEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DBCD    IFEQ *BLANK                     State Code
     C                     GOTO VIEXIT
     C                     END
      *
     C           KLVIWX    KLIST
     C                     KFLD           WXBGCD           State Code
      * Setup key
     C                     MOVEL#1DBCD    WXBGCD
     C           KLVIWX    CHAIN@ACREAH              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VIEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VIEXIT
     C                     END
      * Send message 'State                  NF'
     C                     MOVEL'USR0005' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0005' W0RTN
      *================================================================
     CSR         VIEXIT    ENDSR
      /EJECT
     CSR         VJCKRL    BEGSR
      *================================================================
      * Check reference to Carrier
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1XCCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Carrier Code
     C           YPMTFD    OREQ '#1XCCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1XCCD' defaulted for 'Carrier Broker'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(LCL) YL0035' defaulted for 'Name'.
     C                     CALL 'PDWHSRR'              90  SEL Carrier Nam
     C                     PARM *BLANK    W0RTN   7
     C           #1XCCD    PARM #1XCCD    WQ0059  3        Carrier Code
     C           YL0035    PARM *BLANK    WQ0060 30        Name
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDWHSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1XCCD    IFNE *BLANK                     Carrier Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VJEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1XCCD    IFEQ *BLANK                     Carrier Code
     C                     GOTO VJEXIT
     C                     END
      *
     C           KLVJWV    KLIST
     C                     KFLD           WVBZNA           Carrier Code
      * Setup key
     C                     MOVEL#1XCCD    WVBZNA
     C           KLVJWV    CHAIN@FFREBF              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VJEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VJEXIT
     C                     END
      * Send message 'Carrier                NF'
     C                     MOVEL'USR1180' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1180' W0RTN
      *================================================================
     CSR         VJEXIT    ENDSR
      /EJECT
     CSR         VKCKRL    BEGSR
      *================================================================
      * Check reference to Shipping Line/Port
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1XACD    WK1X01  1
     C                     MOVEL#1OANA    WK1X02  1
     C           WK1X01    IFEQ '?'                        Shipping Line
     C           YPMTFD    OREQ '#1XACD'
     C           WK1X02    OREQ '?'                        Port Delv Termi
     C           YPMTFD    OREQ '#1OANA'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1XACD' defaulted for 'Shipping Line'.
      * Field '(DTL) #1OANA' defaulted for 'Port Delv Terminal'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(LCL) YL0036' defaulted for 'Port City'.
      * Field '(LCL) YL0037' defaulted for 'Port Address Line 1'.
      * Field '(LCL) YL0038' defaulted for 'Port Address Line 2'.
      * Field '(LCL) YL0039' defaulted for 'Sail Port State'.
      * Field '(LCL) YL0040' defaulted for 'Port Zip/Postal Code'.
      * Field '(LCL) YL0041' defaulted for 'Port Phone Number'.
      * Field '(LCL) YL0042' defaulted for 'Port Fax Number'.
      * Field '(LCL) YL0043' defaulted for 'TPM Location Code'.
      * Field '(LCL) YL0044' defaulted for 'Record Status'.
     C                     CALL 'PBGISRR'              90  SEL ShipLine Al
     C                     PARM *BLANK    W0RTN   7
     C           #1XACD    PARM #1XACD    WQ0061  3        Shipping Line
     C           #1OANA    PARM #1OANA    WQ0062 20        Port Delv Termi
     C           YL0036    PARM *BLANK    WQ0063 25        Port City
     C           YL0037    PARM *BLANK    WQ0064 25        Port Address Li
     C           YL0038    PARM *BLANK    WQ0065 25        Port Address Li
     C           YL0039    PARM *BLANK    WQ0066  2        Sail Port State
     C           YL0040    PARM *BLANK    WQ0067 11        Port Zip/Postal
     C           YL0041    PARM *ZERO     WQ0068 110       Port Phone Numb
     C           YL0042    PARM *BLANK    WQ0069 25        Port Fax Number
     C           YL0043    PARM *BLANK    WQ0070 10        TPM Location Co
     C           YL0044    PARM *BLANK    WQ0071  1        Record Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBGISRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1XACD    IFNE *BLANK                     Shipping Line
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1OANA    IFNE *BLANK                     Port Delv Termi
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VKEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1XACD    IFEQ *BLANK                     Shipping Line
     C           #1OANA    ANDEQ*BLANK                     Port Delv Termi
     C                     GOTO VKEXIT
     C                     END
      *
     C           KLVKWY    KLIST
     C                     KFLD           WYXACD           Shipping Line
     C                     KFLD           WYOANA           Port Delv Termi
      * Setup key
     C                     MOVEL#1XACD    WYXACD
     C                     MOVEL#1OANA    WYOANA
     C           KLVKWY    CHAIN@LCREL2              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VKEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VKEXIT
     C                     END
      * Send message 'Shipping Line/Port     NF'
     C                     MOVEL'USR2419' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR2419' W0RTN
      *================================================================
     CSR         VKEXIT    ENDSR
      /EJECT
     CSR         VLCKRL    BEGSR
      *================================================================
      * Check reference to Warehouse
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1AJCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Warehouse Code
     C           YPMTFD    OREQ '#1AJCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AJCD' defaulted for 'Warehouse Code'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(CON) *ZERO' defaulted for 'Accounting Company'.
     C                     CALL 'PMCQSRR'              90  SEL AcctCo/Ware
     C                     PARM *BLANK    W0RTN   7
     C           #1AJCD    PARM #1AJCD    WQ0072  3        Warehouse Code
     C                     PARM *ZERO     WQ0073  30       Accounting Comp
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCQSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AJCD    IFNE *BLANK                     Warehouse Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VLEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AJCD    IFEQ *BLANK                     Warehouse Code
     C                     GOTO VLEXIT
     C                     END
      *
     C           KLVLWI    KLIST
     C                     KFLD           WIAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#1AJCD    WIAJCD
     C           KLVLWI    CHAIN@ADREAO              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VLEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VLEXIT
     C                     END
      * Send message 'Warehouse              NF'
     C                     MOVEL'USR0007' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0007' W0RTN
      *================================================================
     CSR         VLEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         XTAD1     BEGSR
      *================================================================
      * Add TME to absolute time (seconds)
      *================================================================
     C           XTHH      MULT 3600      XDWK1   80
     C                     ADD  XDWK1     XASC
     C           XTNN      MULT 60        XDWK1
     C                     ADD  XDWK1     XASC
     C                     ADD  XTSS      XASC
      *================================================================
     CSR         XTAD1E    ENDSR
      /EJECT
     CSR         XTCEL     BEGSR
      *================================================================
      * Calculate elapsed time from TME2 to TME1
      *================================================================
     C           XTTIM     IFGE XTTIM2
     C                     Z-ADD1         XSGN    10
     C                     Z-ADDXTNN      XTNNL   30
     C                     Z-ADDXTSS      XTSSL   30
     C           XTSSL     IFLT XTSS2
     C                     ADD  60        XTSSL
     C                     SUB  1         XTNNL
     C                     END
     C           XTSSL     SUB  XTSS2     XTSS
     C           XTNNL     IFLT XTNN2
     C                     ADD  60        XTNNL
     C                     SUB  1         XTHH
     C                     END
     C           XTNNL     SUB  XTNN2     XTNN
     C                     SUB  XTHH2     XTHH
     C                     ELSE
     C                     Z-ADD-1        XSGN
     C                     Z-ADDXTNN2     XTNNL
     C                     Z-ADDXTSS2     XTSSL
     C           XTSSL     IFLT XTSS
     C                     ADD  60        XTSSL
     C                     SUB  1         XTNNL
     C                     END
     C           XTSSL     SUB  XTSS      XTSS
     C           XTNNL     IFLT XTNN
     C                     ADD  60        XTNNL
     C                     SUB  1         XTHH2
     C                     END
     C           XTNNL     SUB  XTNN      XTNN
     C           XTHH2     SUB  XTHH      XTHH
     C                     END
      *================================================================
     CSR         XTCELE    ENDSR
      /EJECT
     CSR         XTCT1     BEGSR
      *================================================================
      * Convert absolute time (seconds) to TME
      *================================================================
     C                     EXSR XTFCT
     C           XASC      DIV  60        XASC
     C                     MVR            XTSS
     C           XASC      DIV  60        XASC
     C                     MVR            XTNN
     C                     Z-ADDXASC      XTHH
      *================================================================
     CSR         XTCT1E    ENDSR
      /EJECT
     CSR         XTFCT     BEGSR
      *================================================================
      * Factorize absolute date (seconds) by 24 hours
      *================================================================
     C           XASC      IFGE 86400
     C                     DIV  86400     XASC    80
     C                     MVR            XASC
     C                     ELSE
     C           XASC      IFLE *ZERO
     C                     DIV  86400     XASC
     C                     MVR            XASC
     C           XASC      IFNE *ZERO
     C                     ADD  86400     XASC
     C                     END
     C                     END
     C                     END
      *================================================================
     CSR         XTFCTE    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           ZHCSRW    IFEQ 020
     C           ZHCSCL    ANDEQ046
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN79     ANDEQ'0'
     C                     MOVEL'#1RQST'  YPMTFD           Export Load USD
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1FLAM           Flat Amount
     C                     MOVEL*BLANK    P1XQST           Allocate Pounds
     C                     Z-ADD*ZERO     P1RRNB           Total Stops
     C                     Z-ADD*ZERO     P1AATM           Job Time
     C                     Z-ADD*ZERO     P1AXDT           Job Date
     C                     Z-ADD*ZERO     P5TRE            *Elapsed time (
     C                     MOVEL*BLANK    P7ICSX           HPB Transload S
      *
      * Initialise indicators for re-entry
     C                     MOVE '0'       *IN
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WARUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WARVNB           Stop/Drop
     C                     Z-ADD*ZERO     WARWNB           Miles to next s
     C                     Z-ADD*ZERO     WARXNB           Freight Charge
     C                     Z-ADD*ZERO     WASQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WAT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WAT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WASXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WAKFDT           Appointment Con
     C                     Z-ADD*ZERO     WAACTM           Appointment Con
     C                     Z-ADD*ZERO     WAEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WAAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WAKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WAATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WAHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WAAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WAKKDT           On Yard Date
     C                     Z-ADD*ZERO     WAAVTM           On Yard Time
     C                     Z-ADD*ZERO     WAZ4NB           MPC Number
     C                     Z-ADD*ZERO     WAN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WAN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WAN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WAB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WAB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WAB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WBA0DT           Order Date
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBACDT           Cancel Date
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WBA1WG           Order Weight To
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WBRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WBT3NB           Attach to Order
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBAWDT           Invoice Date
     C                     Z-ADD*ZERO     WBVRVA           A/R order Value
     C                     Z-ADD*ZERO     WBB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WBNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WBNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WBNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WBNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WBNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WBBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WBBQTM           Time of Origina
     C                     Z-ADD*ZERO     WBBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WBBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WBBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WBH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WBH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WBH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WBH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WBH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WBC0C7           Claim Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCMILE           Miles to First
     C                     Z-ADD*ZERO     WCHRRQ           Hours Required
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field Scheduled Delivery Time
     C                     Z-ADD*ZERO     WUATTM  60
      * Define work field USR Period
     C                     Z-ADD*ZERO     WUB1NB  20
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WDRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WDFLAM           Flat Amount
     C                     Z-ADD*ZERO     WDRRNB           Total Stops
     C                     Z-ADD*ZERO     WDSBNB           BOL Time
     C                     Z-ADD*ZERO     WDSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDSDNB           Number Pallets
     C                     Z-ADD*ZERO     WDPAOU           Number Pallets
     C                     Z-ADD*ZERO     WDDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WDSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WDHADT           Actual Arrival
     C                     Z-ADD*ZERO     WDAART           Actual Arrival
     C                     Z-ADD*ZERO     WDDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WDDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WDAQDT           Actual Departur
     C                     Z-ADD*ZERO     WDS6NB           Departure Time
     C                     Z-ADD*ZERO     WDT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WDPRTM           Product Tempera
     C                     Z-ADD*ZERO     WDNPSV           Number Spacers
     C                     Z-ADD*ZERO     WDTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WDGRWE           Gross Weight
     C                     Z-ADD*ZERO     WDF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WDJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WDTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WDJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WDSPTM           Spotted Time
     C                     Z-ADD*ZERO     WDJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WDLFTM           Load Finished T
     C                     Z-ADD*ZERO     WDJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WDBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WDJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WDBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WDKIDT           Truck Departure
     C                     Z-ADD*ZERO     WDASTM           Truck Departure
     C                     Z-ADD*ZERO     WDKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WDAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WDVOAG           Voyage
     C                     Z-ADD*ZERO     WDKBDT           Sail Date
     C                     Z-ADD*ZERO     WDEFDT           Arrival Date
     C                     Z-ADD*ZERO     WDKCDT           Date In
     C                     Z-ADD*ZERO     WDTMIN           Time In
     C                     Z-ADD*ZERO     WDKDDT           Date Out
     C                     Z-ADD*ZERO     WDVMNB           Time Out
     C                     Z-ADD*ZERO     WDOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WDKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WDATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WDBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WDEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WDKKDT           On Yard Date
     C                     Z-ADD*ZERO     WDAVTM           On Yard Time
     C                     Z-ADD*ZERO     WDKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WDAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WDLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WDK0DT           Product Complet
     C                     Z-ADD*ZERO     WDAYTM           Product Complet
     C                     Z-ADD*ZERO     WDKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WDICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WDIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WDK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WDAZTM           Load Door 1
     C                     Z-ADD*ZERO     WDK2DT           Override Total
     C                     Z-ADD*ZERO     WDA0TM           Load Door 2
     C                     Z-ADD*ZERO     WDZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WDPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WDCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WDPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WDCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WDP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WDCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WDP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WDCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WDP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WDCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WDP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WDCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field Blank for 12          USR
     C                     MOVEL*BLANK    WUS3TX 12
      * Define work field Blank 6 USR
     C                     MOVEL*BLANK    WUXKTX  6
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFC4NB           Order Number
     C                     Z-ADD*ZERO     WFDPNB           Order Sequence
     C                     Z-ADD*ZERO     WFUENB           Order Secondary
     C                     Z-ADD*ZERO     WFHGCD           Item Code
     C                     Z-ADD*ZERO     WFBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WFCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WFMAVA           Billing Detail
     C                     Z-ADD*ZERO     WFKDVA           Billing Detail
     C                     Z-ADD*ZERO     WFL8VA           Billing Detail
     C                     Z-ADD*ZERO     WFL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WFAYVA           Extended Amount
     C                     Z-ADD*ZERO     WFEXDT           Market Pricing
     C                     Z-ADD*ZERO     WFBZPR           Price Overage O
     C                     Z-ADD*ZERO     WFL6NB           Contract Number
     C                     Z-ADD*ZERO     WFGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WFR1NB           Rated Freight
     C                     Z-ADD*ZERO     WFAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WFD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WFCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WFAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WFCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WFATWG           Weight Shipped
     C                     Z-ADD*ZERO     WFAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WFAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WFAKPR           Unit Price
     C                     Z-ADD*ZERO     WFALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WFAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WFAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WFA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WFA5DT           Requested Ship
     C                     Z-ADD*ZERO     WFAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WFGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WFRGNB           Item Structure
     C                     Z-ADD*ZERO     WFRHNB           Item Structure
     C                     Z-ADD*ZERO     WFRINB           Item Structure
     C                     Z-ADD*ZERO     WFCXDT           Date of Origina
     C                     Z-ADD*ZERO     WFDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WFB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WFA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WFNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WFNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WFNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WFNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WFNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WFBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WFBVTM           Price Code
     C                     Z-ADD*ZERO     WFBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WFBXTM           Substitution Li
     C                     Z-ADD*ZERO     WFBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WFH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WFH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WFH7NX           OD Item Target
     C                     Z-ADD*ZERO     WFH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WFH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WFDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WFDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WFDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WFDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WFDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WFGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WFGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WFGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WFPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WFRINY           Item Age Days
     C                     Z-ADD*ZERO     WFTIDT           Production Ovr
     C                     Z-ADD*ZERO     WFTJDT           Production Ovr
     C                     Z-ADD*ZERO     WFTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WFTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WFTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Define work field Unused Status USR
     C                     MOVEL*BLANK    WUAZSX  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WIBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WIBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WIBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WIBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJGXNY           Source Drawer
     C                     Z-ADD*ZERO     WJGZNY           Page Length 2
     C                     Z-ADD*ZERO     WJG0NY           Page Width 2
     C                     Z-ADD*ZERO     WJG1NY           Page LPI
     C                     Z-ADD*ZERO     WJG2NY           Page CPI
     C                     Z-ADD*ZERO     WJGYNY           Page Overflow
     C                     Z-ADD*ZERO     WJG3NY           CDD Copies
     C                     Z-ADD*ZERO     WJG4NY           CDD Number 2 Un
     C                     Z-ADD*ZERO     WJG5NY           CDD Number 3 Un
     C                     Z-ADD*ZERO     WJG6NY           CDD Number 4 Un
     C                     Z-ADD*ZERO     WJG7NY           CDD Number 5 Un
     C                     Z-ADD*ZERO     WJQ4DT           CDD Unused Date
     C                     Z-ADD*ZERO     WJQ5DT           CDD Unused Date
     C                     Z-ADD*ZERO     WJQ7DT           CDD Unused Date
     C                     Z-ADD*ZERO     WJCYTM           CDD Unused Time
     C                     Z-ADD*ZERO     WJCWTM           CDD Unused Time
     C                     Z-ADD*ZERO     WJCXTM           CDD Unused Time
     C                     Z-ADD*ZERO     WJMJDT           Create Date
     C                     Z-ADD*ZERO     WJBETM           Create Time
     C                     Z-ADD*ZERO     WJMKDT           Change Date
     C                     Z-ADD*ZERO     WJBFTM           Change Time
      * Define work field Return Code Usr
     C                     MOVEL*BLANK    WUH3TX  7
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Blank for 4           USR
     C                     MOVEL*BLANK    WUOTTX  4
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLAIC3           Company Number
     C                     Z-ADD*ZERO     WLC4NB           Order Number
     C                     Z-ADD*ZERO     WLRMNB           Load ID
     C                     Z-ADD*ZERO     WLRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WLQWDT           OHE Sail/Flight
     C                     Z-ADD*ZERO     WLQXDT           OHE Port Cut Da
     C                     Z-ADD*ZERO     WLQYDT           OHE Arrival Dat
     C                     Z-ADD*ZERO     WLGINY           OHE Unused Numb
     C                     Z-ADD*ZERO     WLGFNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WLGGNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WLGHNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WLHEVL           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WLHFVL           OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WLHGVL           Transload Termi
     C                     Z-ADD*ZERO     WLQZDT           OHE Est Arrv at
     C                     Z-ADD*ZERO     WLQ0DT           OHE Backhaul ET
     C                     Z-ADD*ZERO     WLQ1DT           OHE Port/Pier P
     C                     Z-ADD*ZERO     WLQ2DT           OHE Actual Ship
     C                     Z-ADD*ZERO     WLITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WLQJNY           OHE Backhaul Re
     C                     Z-ADD*ZERO     WLQKNY           LD Stop/Drop
     C                     Z-ADD*ZERO     WLQLNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WLP8NY           OHE Pier Pass F
     C                     Z-ADD*ZERO     WLP9NY           OHE Port Check
     C                     Z-ADD*ZERO     WLQANY           OHE Port Cut Ti
     C                     Z-ADD*ZERO     WLQCNY           OHE Backhaul Tr
     C                     Z-ADD*ZERO     WLQDNY           OHE Load Sched
     C                     Z-ADD*ZERO     WLQENY           Original Appoin
     C                     Z-ADD*ZERO     WLQFNY           Original Appoin
     C                     Z-ADD*ZERO     WLQGNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WLQHNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WLQINY           OHE Unused Nume
     C                     Z-ADD*ZERO     WLQMNY           OHE Orig ABS Fr
     C                     Z-ADD*ZERO     WLW5DT           OHE Unused Date
     C                     Z-ADD*ZERO     WLW6DT           OHE Unused Date
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMAIC3           Company Number
     C                     Z-ADD*ZERO     WMBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WMR5NB           Deliver after t
     C                     Z-ADD*ZERO     WMR6NB           Deliver before
     C                     Z-ADD*ZERO     WMTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WMMTCU           Mileage To Cust
     C                     Z-ADD*ZERO     WMW2NB           Co/Cust Overage
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Define work field Status Flag 1  Y/N
     C                     MOVEL*BLANK    WUQ1ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOAIC3           Company Number
     C                     Z-ADD*ZERO     WOM8NB           System Value Nu
     C                     Z-ADD*ZERO     WOAATM           Job Time
     C                     Z-ADD*ZERO     WOAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WRMJDT           Create Date
     C                     Z-ADD*ZERO     WRBETM           Create Time
     C                     Z-ADD*ZERO     WRMKDT           Change Date
     C                     Z-ADD*ZERO     WRBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WSAIC3           Company Number
     C                     Z-ADD*ZERO     WSAATM           Job Time
     C                     Z-ADD*ZERO     WSAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WTAIC3           Company Number
     C                     Z-ADD*ZERO     WTBCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WTCQNB           Julian Date
     C                     Z-ADD*ZERO     WTESNB           Accounting Year
     C                     Z-ADD*ZERO     WTETNB           Accounting Peri
     C                     Z-ADD*ZERO     WTBZNB           OM Week
     C                     Z-ADD*ZERO     WTEINB           Week Number
     C                     Z-ADD*ZERO     WTAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WTOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WTNQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WTNRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WTOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WTOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WTAATM           Job Time
     C                     Z-ADD*ZERO     WTAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WVEZNB           Telephone Numbe
     C                     Z-ADD*ZERO     WVEEDT           Carrier Last Us
     C                     Z-ADD*ZERO     WVNRVA           Pallet Balance
     C                     Z-ADD*ZERO     WVNSVA           Long hook balan
     C                     Z-ADD*ZERO     WVNTVA           Short hook bala
     C                     Z-ADD*ZERO     WVNUVA           Tub Balance
     C                     Z-ADD*ZERO     WVS8NB           Home Phone
     C                     Z-ADD*ZERO     WVS9NB           Other Phone
     C                     Z-ADD*ZERO     WVNMVA           Flat Rate
     C                     Z-ADD*ZERO     WVNOVA           Rate Per Pound
     C                     Z-ADD*ZERO     WVNPVA           Unused Rate Per
     C                     Z-ADD*ZERO     WVNQVA           Miscellaneous C
     C                     Z-ADD*ZERO     WVQXNB           Unused Mile Ran
     C                     Z-ADD*ZERO     WVQ1NB           Unused Mile Ran
     C                     Z-ADD*ZERO     WVMRNG           Unused Mile Ran
     C                     Z-ADD*ZERO     WVMRNE           Unused Mile Ran
     C                     Z-ADD*ZERO     WVRFNB           Unused Mile Ran
     C                     Z-ADD*ZERO     WVMREG           Unused Mile Ran
     C                     Z-ADD*ZERO     WVBQPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WVBRPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WVBSPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WVBTPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WVBUPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WVBVPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WVDJWG           Unused Weight R
     C                     Z-ADD*ZERO     WVDKWG           Unused Weight R
     C                     Z-ADD*ZERO     WVDLWG           Unused Weight R
     C                     Z-ADD*ZERO     WVDMWG           Unused Weight R
     C                     Z-ADD*ZERO     WVDNWG           Unused Weight R
     C                     Z-ADD*ZERO     WVDOWG           Unused Weight R
     C                     Z-ADD*ZERO     WVB2PR           Unused Weight R
     C                     Z-ADD*ZERO     WVB3PR           Unused Weight R
     C                     Z-ADD*ZERO     WVB4PR           Unused Weight R
     C                     Z-ADD*ZERO     WVB5PR           Unused Weight R
     C                     Z-ADD*ZERO     WVB6PR           Unused Weight R
     C                     Z-ADD*ZERO     WVB7PR           Unused Weight R
     C                     Z-ADD*ZERO     WVAAC7           Contact Number
     C                     Z-ADD*ZERO     WVTENO           Carrier Unused
     C                     Z-ADD*ZERO     WVAOFC           Amount of Cargo
     C                     Z-ADD*ZERO     WVAOLI           Amount of Liabi
     C                     Z-ADD*ZERO     WVKHDT           Date of Expirat
     C                     Z-ADD*ZERO     WVAATM           Job Time
     C                     Z-ADD*ZERO     WVAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WWRSNB           Maximum pounds
     C                     Z-ADD*ZERO     WWRTNB           Maximum Units
     C                     Z-ADD*ZERO     WWTANB           Minimum pounds
     C                     Z-ADD*ZERO     WWAATM           Job Time
     C                     Z-ADD*ZERO     WWAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WXAATM           Job Time
     C                     Z-ADD*ZERO     WXAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WYSPPN           Port Phone Numb
     C                     Z-ADD*ZERO     WYAATM           Job Time
     C                     Z-ADD*ZERO     WYAXDT           Job Date
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field Warehouse Code
     C                     MOVEL*BLANK    WUAJCD  3
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Define work field Salesperson Code
     C                     MOVEL*BLANK    WUBCCD  3
      * Define work field Allow Multi-Company
     C                     MOVEL*BLANK    WUI6ST  1
      * Define work field Default Printer
     C                     MOVEL*BLANK    WUMPNA 10
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TCNLNB           Entity Number
     C                     Z-ADD*ZERO     TCAIC3           Company Number
     C                     Z-ADD*ZERO     TCAATM           Job Time
     C                     Z-ADD*ZERO     TCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TDAIC3           Company Number
     C                     Z-ADD*ZERO     TDAATM           Job Time
     C                     Z-ADD*ZERO     TDAXDT           Job Date
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TEAATM           Job Time
     C                     Z-ADD*ZERO     TEAXDT           Job Date
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TFAIC3           Company Number
     C                     Z-ADD*ZERO     TFXXTM           Departure Time
     C                     Z-ADD*ZERO     TFAATM           Job Time
     C                     Z-ADD*ZERO     TFAXDT           Job Date
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WA   152       *Synon (15,2) w
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SNRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     MOVEL*BLANK    WL0002  2
     C                     MOVEL*BLANK    WL0003  6
     C                     MOVEL*BLANK    WL0004  8
     C                     MOVEL*BLANK    WL0005 10
     C                     MOVEL*BLANK    WL0006 10
     C                     MOVEL*BLANK    WL0007 25
     C                     MOVEL*BLANK    WL0008 25
     C                     MOVEL*BLANK    WL0009 10
     C                     MOVEL*BLANK    WL0010  4
     C                     MOVEL*BLANK    WL0011  4
     C                     Z-ADD*ZERO     WL0012  30
     C                     MOVEL*BLANK    WL0013 10
     C                     Z-ADD*ZERO     WL0014  30
     C                     Z-ADD*ZERO     WL0015  30
     C                     Z-ADD*ZERO     WL0016  30
     C                     Z-ADD*ZERO     WL0017  31
     C                     Z-ADD*ZERO     WL0018  30
     C                     MOVEL*BLANK    WL0019  5
     C                     MOVEL*BLANK    WL0020 50
     C                     MOVEL*BLANK    WL0021 50
     C                     MOVEL*BLANK    WL0022 50
     C                     MOVEL*BLANK    WL0023 50
     C                     MOVEL*BLANK    WL0024 50
      * Define local variables for subroutine SURVGN.
     C                     MOVEL*BLANK    WL0025  2
     C                     MOVEL*BLANK    WL0026 30
      * Define local variables for subroutine SXRVGN.
     C                     Z-ADD*ZERO     WL0027  30
     C                     Z-ADD*ZERO     WL0028  70
     C                     Z-ADD*ZERO     WL0029  30
     C                     Z-ADD*ZERO     WL0030  30
     C                     MOVEL*BLANK    WL0031  1
      * Define local variables for subroutine TCRVGN.
     C                     MOVEL*BLANK    WL0032 10
     C                     MOVEL*BLANK    WL0033  6
     C                     Z-ADD*ZERO     WL0034  30
     C                     MOVEL*BLANK    WL0035  3
      * Define local work field Load Change Type
     C                     MOVEL*BLANK    YL0001  6
      * Define local work field Load Change Type 2
     C                     MOVEL*BLANK    YL0002  6
      * Define local work field Load Change Type 3
     C                     MOVEL*BLANK    YL0003  6
      * Define local work field Load Change Type 4
     C                     MOVEL*BLANK    YL0004  6
      * Define local work field Load Change Type 5
     C                     MOVEL*BLANK    YL0005  6
      * Define local work field TMS LH Field Chg Text
     C                     MOVEL*BLANK    YL0006 35
      * Define local work field Order Changed Y/N
     C                     MOVEL*BLANK    YL0007  4
      * Define local work field CDD Type
     C                     MOVEL*BLANK    YL0008  2
      * Define local work field CDD Department Code
     C                     MOVEL*BLANK    YL0009  6
      * Define local work field CDD Name of Overlay Back
     C                     MOVEL*BLANK    YL0010  8
      * Define local work field Company Organization
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field Production Warehouse Code
     C                     MOVEL*BLANK    YL0012  3
      * Define local work field Warehouse Location
     C                     MOVEL*BLANK    YL0013  1
      * Define local work field WHS Req Meter Reading Shp
     C                     MOVEL*BLANK    YL0014  1
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0015  30
      * Define local work field CDD Name of Overlay
     C                     MOVEL*BLANK    YL0016  8
      * Define local work field CDD Program Name
     C                     MOVEL*BLANK    YL0017 10
      * Define local work field CDD Printer File Name
     C                     MOVEL*BLANK    YL0018 10
      * Define null work field CDD Sender Phone
     C                     MOVEL*BLANK    YN0001 25
      * Define null work field CDD Sender Fax
     C                     MOVEL*BLANK    YN0002 25
      * Define local work field Output Queue
     C                     MOVEL*BLANK    YL0019 10
      * Define local work field Hold File
     C                     MOVEL*BLANK    YL0020  4
      * Define local work field Save File
     C                     MOVEL*BLANK    YL0021  4
      * Define local work field Source Drawer
     C                     Z-ADD*ZERO     YL0022  30
      * Define local work field Printer Device Type
     C                     MOVEL*BLANK    YL0023 10
      * Define local work field Page Length 2
     C                     Z-ADD*ZERO     YL0024  30
      * Define local work field Page Width 2
     C                     Z-ADD*ZERO     YL0025  30
      * Define local work field Page LPI
     C                     Z-ADD*ZERO     YL0026  30
      * Define local work field Page CPI
     C                     Z-ADD*ZERO     YL0027  31
      * Define local work field Page Overflow
     C                     Z-ADD*ZERO     YL0028  30
      * Define local work field Page Rotation
     C                     MOVEL*BLANK    YL0029  5
      * Define null work field CDD Comment 1
     C                     MOVEL*BLANK    YN0003 50
      * Define null work field CDD Comment 2
     C                     MOVEL*BLANK    YN0004 50
      * Define null work field CDD Comment 3
     C                     MOVEL*BLANK    YN0005 50
      * Define null work field CDD Comment 4
     C                     MOVEL*BLANK    YN0006 50
      * Define null work field CDD Comment 5
     C                     MOVEL*BLANK    YN0007 50
      * Define null work field CDD Program Name
     C                     MOVEL*BLANK    YN0008 10
      * Define null work field CDD Printer File Name
     C                     MOVEL*BLANK    YN0009 10
      * Define null work field Output Queue
     C                     MOVEL*BLANK    YN0010 10
      * Define null work field Hold File
     C                     MOVEL*BLANK    YN0011  4
      * Define null work field Save File
     C                     MOVEL*BLANK    YN0012  4
      * Define null work field Source Drawer
     C                     Z-ADD*ZERO     YN0013  30
      * Define null work field Printer Device Type
     C                     MOVEL*BLANK    YN0014 10
      * Define null work field Page Length 2
     C                     Z-ADD*ZERO     YN0015  30
      * Define null work field Page Width 2
     C                     Z-ADD*ZERO     YN0016  30
      * Define null work field Page LPI
     C                     Z-ADD*ZERO     YN0017  30
      * Define null work field Page CPI
     C                     Z-ADD*ZERO     YN0018  31
      * Define null work field Page Overflow
     C                     Z-ADD*ZERO     YN0019  30
      * Define null work field Page Rotation
     C                     MOVEL*BLANK    YN0020  5
      * Define local work field Order Number
     C                     Z-ADD*ZERO     YL0030  70
      * Define local work field OHE Override Type Code
     C                     MOVEL*BLANK    YL0031  2
      * Define null work field Order Type - Sales
     C                     MOVEL*BLANK    YN0021  2
      * Define local work field Ship To Customer
     C                     Z-ADD*ZERO     YL0032  70
      * Define local work field Type Code
     C                     MOVEL*BLANK    YL0033  2
      * Define local work field Display Flag
     C                     MOVEL*BLANK    YL0034  1
      * Define local work field Name
     C                     MOVEL*BLANK    YL0035 30
      * Define local work field Port City
     C                     MOVEL*BLANK    YL0036 25
      * Define local work field Port Address Line 1
     C                     MOVEL*BLANK    YL0037 25
      * Define local work field Port Address Line 2
     C                     MOVEL*BLANK    YL0038 25
      * Define local work field Sail Port State
     C                     MOVEL*BLANK    YL0039  2
      * Define local work field Port Zip/Postal Code
     C                     MOVEL*BLANK    YL0040 11
      * Define local work field Port Phone Number
     C                     Z-ADD*ZERO     YL0041 110
      * Define local work field Port Fax Number
     C                     MOVEL*BLANK    YL0042 25
      * Define local work field TPM Location Code
     C                     MOVEL*BLANK    YL0043 10
      * Define local work field Record Status
     C                     MOVEL*BLANK    YL0044  1
      * Define local work field Yes/No Selection      USR
     C                     MOVEL*BLANK    YL0045  1
      * Define local work field Palletize
     C                     MOVEL*BLANK    YL0046  1
      * Define local work field U/M - Ordered
     C                     MOVEL*BLANK    YL0047  2
      * Define local work field Palletize             USR
     C                     MOVEL*BLANK    YL0048  1
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0049  1
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0050  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0051  3
      * Define null work field Plant Company Sts
     C                     MOVEL*BLANK    YN0022  1
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * ***** Change Log and Comments
     C                     EXSR UESUBR                     ***** Change Lo
      *
     C                     MOVEL*BLANK    WN0450 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0450           User Profile Na
      *
     C                     MOVEL*BLANK    WN0451 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR TBRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,006                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0450    ZA0012           User Profile Na
     C                     MOVEL'OMS'     ZA0013           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0451    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0450    WL0032    P      User Profile Na
     C                     MOVEL'OMS'     WL0033    P      Application Cod
     C                     EXSR TCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0034    WUAIC3           Company Number
     C                     MOVELWL0035    YL0051    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0451    WL0032    P      User Profile Na
     C                     MOVEL'OMS'     WL0033    P      Application Cod
     C                     EXSR TCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0034    WUAIC3           Company Number
     C                     MOVELWL0035    YL0051    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0051    WUAJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0450    ZA0014           User Profile Na
     C                     MOVEL'OMS'     ZA0015           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0050    IFNE 0                          *IF
     C                     Z-ADDYL0050    WUAIC3           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0051    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           WUAJCD    PARM *BLANK    WQ0074  3        Warehouse Code
     C                     PARM YL0050    WQ0075  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR TDRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
     C                     MOVEL'N'       YL0049           Record Found US
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
     C                     EXSR TFRVGN
      * Load screen
     C                     EXSR MALDSC
      *================================================================
     CSR         ZZEXIT    ENDSR
** W0BEG
01027010940109601305013090158201838
02094021030235002606028620311803374
03630038860414204398046540491004912
051660542205428
** W0END
01051010940110201307013380158801845
02100021030235502613028690312503378
03640038950415304409046650491004918
051660542305442
** W0NAM
#DHLTX    #1VDST    #DNONA    V1AIC3    #DAGTX    #1RMNB    V1AODT
#1RNNB    #DFRSX    #1PRTM    #DZ4TX    #DZ5TX    #DZ6TX    #1PAOU
#1ICWG    #1IDWG    #DS2TX    #1J8TX    #1J9TX    #DCRST    #DHUTX
#1RQST    #DICSX    #DNIT1
** @CN
00001 Bill of Lading
00002 Y2U9999
00003 Bill of Lading-Transload
00004 TRFYRDMGT
00005 0000000
00006 Y2U0005
