     H/TITLE WW Prod Order Hold    DF Display file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Displays the records from DBF as a subfile
     H* - Loads the SFL from the DBF a page at a time
     H* - The DBF record at which the SFL display starts may be
     H*   controlled by positioning fields on the SFL header
     H* - Any key fields on the SFL header will be used as
     H*   positioning values
     H* - Any non-key fields on the SFL header will be used as
     H*   selection values: a maximum of W0SLM records will be
     H*   read from the DBF before giving up
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Display file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISABANS
     H* Date          : 05/08/25  Time  : 07:03:13
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPDVLDFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: WW Prod Order Hold    DF Display file
      *
     FOPBFCPLKIF  E           K        DISK
     F                                              KINFDS INFDS1
      * RSQ : Order Header TRG         SSD/LdId/Ord -Open Ord
      *
     FOPBFCPLOIF  E           K        DISK
      * RSQ : Order Header TRG          Ord-D/Co
      *
     FOPBFCPLLIF  E           K        DISK
      * RSQ : Order Header TRG          Ld(d)/Ord
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FPMAMREL1IF  E           K        DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer Master           Retrieval index       NV
      *
     FOMFJCPLLIF  E           K        DISK
      * RSQ : Load Header               Load Only
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOPBFCPLGIF  E           K        DISK
      * RSQ : Order Header TRG          Load Id/Order Num
      *
     FOPBFCPL8IF  E           K        DISK
      * RSQ : Order Header TRG          Load #/All orders
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCAADREL9IF  E           K        DISK
      * RSQ : Warehouse Codes           ShipCo/Warehouse
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FOMFLCPL2IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop/Order
      *
     FOMFKREL0IF  E           K        DISK
      * RTV : Truck Size new            Retrieval index
      *
     FOPC0REL1IF  E           K        DISK
      * RTV : User Entry Control        Retrieval index       NV
      *
     FPPBKCPL3IF  E           K        DISK
      * RSQ : PFS Ship Load/Order Sts   Load/Order Picked
      *
     FPDLGCPL2IF  E           K        DISK
      * RSQ : Legal Run Mileage Hours   Rtv Index w/ Desc Miles
      *
     FOMFLCPL4IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop(Desc)/Order
      *
     FPDLECPL1IF  E           K        DISK
      * RTV : Carrier Destination Rate  Retrieval index
      *
     FOMFLCPL5IF  E           K        DISK
      * RSQ : Load Detail               Co/Load/Order
      *
     FOMFLCPL1IF  E           K        DISK
      * RTV : Load Detail               Retrieval index
      *
     FPPBUREL1IF  E           K        DISK
      * RTV : PFS Interface             Retrieval index
      *
     FCADPREL1IF  E           K        DISK
      * RTV : System Values             Retrieval index       NV
      *
     FOPBFCPLJIF  E           K        DISK
      * RSQ : Order Header TRG          Load(Desc) not bl
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FOMFJCPL1UF  E           K        DISK
      * UPD : Load Header               Update index
      *
     FOMFLCPL0UF  E           K        DISK
      * UPD : Load Detail               Update index
      *
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    J7          7  1
     E                    K7          7  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    J3          3  1
     E                    K3          3  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    #L7         7  1
     E                    AR1        30  1               ARRAY 1
     E                    AR2        30  1               ARRAY 2
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * Screen: Field position and name array
     E                    W0BEG   7 033  5 0A
     E                    W0END   7 033  5 0A
     E                    W0NAM   7 033 10
      * Long constants
     E                    @CN#    1  19  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@BFCPY2
      * Order Header TRG          Ord-D/Co
      * Renamed input format fields
     I              BEAIC3                          WAAIC3
     I              BEC4NB                          WAC4NB
     I              BEJNCD                          WAJNCD
     I              BEANC7                          WAANC7
     I              BEBKC7                          WABKC7
     I              BEBRTX                          WABRTX
     I              BEHMNA                          WAHMNA
     I              BEHONA                          WAHONA
     I              BEHPNA                          WAHPNA
     I              BEHNNA                          WAHNNA
     I              BEDBCD                          WADBCD
     I              BECKTX                          WACKTX
     I              BEB0C7                          WAB0C7
     I              BEAETX                          WAAETX
     I              BEB1NA                          WAB1NA
     I              BEB3NA                          WAB3NA
     I              BEB4NA                          WAB4NA
     I              BEB2NA                          WAB2NA
     I              BEBHCD                          WABHCD
     I              BEC8TX                          WAC8TX
     I              BEBCNA                          WABCNA
     I              BEA0DT                          WAA0DT
     I              BEA5DT                          WAA5DT
     I              BEGNDT                          WAGNDT
     I              BEACDT                          WAACDT
     I              BEAQCD                          WAAQCD
     I              BEB6NA                          WAB6NA
     I              BEBYNA                          WABYNA
     I              BEBZNA                          WABZNA
     I              BEGTST                          WAGTST
     I              BEGVST                          WAGVST
     I              BEGUST                          WAGUST
     I              BEQFST                          WAQFST
     I              BECQCD                          WACQCD
     I              BEGJST                          WAGJST
     I              BEGWST                          WAGWST
     I              BEGXST                          WAGXST
     I              BEGYST                          WAGYST
     I              BEAODT                          WAAODT
     I              BEAIVN                          WAAIVN
     I              BECXDT                          WACXDT
     I              BEJZVA                          WAJZVA
     I              BEA1WG                          WAA1WG
     I              BEXIST                          WAXIST
     I              BEXJST                          WAXJST
     I              BEXKST                          WAXKST
     I              BEEIDT                          WAEIDT
     I              BEAFTM                          WAAFTM
     I              BEE8CD                          WAE8CD
     I              BEE9CD                          WAE9CD
     I              BERMNB                          WARMNB
     I              BETBNB                          WATBNB
     I              BER1NB                          WAR1NB
     I              BEPJST                          WAPJST
     I              BEU0ST                          WAU0ST
     I              BEU1ST                          WAU1ST
     I              BEQ2CD                          WAQ2CD
     I              BEU2ST                          WAU2ST
     I              BEVEST                          WAVEST
     I              BEVFST                          WAVFST
     I              BEVGST                          WAVGST
     I              BERPCD                          WARPCD
     I              BERNNB                          WARNNB
     I              BEVDST                          WAVDST
     I              BEATIN                          WAATIN
     I              BEU4ST                          WAU4ST
     I              BEU5ST                          WAU5ST
     I              BERSRN                          WARSRN
     I              BEMHNA                          WAMHNA
     I              BEMINA                          WAMINA
     I              BEWBST                          WAWBST
     I              BER4CD                          WAR4CD
     I              BEBFCD                          WABFCD
     I              BEQ4CD                          WAQ4CD
     I              BET3NB                          WAT3NB
     I              BESICD                          WASICD
     I              BECONB                          WACONB
     I              BECEST                          WACEST
     I              BEAWDT                          WAAWDT
     I              BEJPCD                          WAJPCD
     I              BEXUST                          WAXUST
     I              BEZ1ST                          WAZ1ST
     I              BEVRVA                          WAVRVA
     I              BEOBST                          WAOBST
     I              BEBCST                          WABCST
     I              BEBDST                          WABDST
     I              BEB7VL                          WAB7VL
     I              BEGASX                          WAGASX
     I              BEGBSX                          WAGBSX
     I              BEGCSX                          WAGCSX
     I              BEGDSX                          WAGDSX
     I              BEFNSX                          WAFNSX
     I              BEFOSX                          WAFOSX
     I              BEFPSX                          WAFPSX
     I              BEFQSX                          WAFQSX
     I              BEFRSX                          WAFRSX
     I              BEFSSX                          WAFSSX
     I              BEFTSX                          WAFTSX
     I              BEFUSX                          WAFUSX
     I              BEFVSX                          WAFVSX
     I              BEFWSX                          WAFWSX
     I              BEFXSX                          WAFXSX
     I              BEFYSX                          WAFYSX
     I              BENODT                          WANODT
     I              BENPDT                          WANPDT
     I              BENQDT                          WANQDT
     I              BENRDT                          WANRDT
     I              BENSDT                          WANSDT
     I              BEBPTM                          WABPTM
     I              BEBQTM                          WABQTM
     I              BEBRTM                          WABRTM
     I              BEBSTM                          WABSTM
     I              BEBTTM                          WABTTM
     I              BEH0NX                          WAH0NX
     I              BEH1NX                          WAH1NX
     I              BEH2NX                          WAH2NX
     I              BEH3NX                          WAH3NX
     I              BEH4NX                          WAH4NX
     I              BEC0C7                          WAC0C7
     I              BEUVST                          WAUVST
     I              BEUWST                          WAUWST
     I              BEUXST                          WAUXST
     I              BEAATM                          WAAATM
     I              BEAYNA                          WAAYNA
     I              BEA0NA                          WAA0NA
     I              BEAXDT                          WAAXDT
      *
     I@BFCPR0
      * Order Header TRG          Ld(d)/Ord
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                          WCAIC3
     I              OMC4NB                          WCC4NB
     I              OMDPNB                          WCDPNB
     I              OMUENB                          WCUENB
     I              OMHGCD                          WCHGCD
     I              OMAJCD                          WCAJCD
     I              OMBKC7                          WCBKC7
     I              OMCFC7                          WCCFC7
     I              OMGMST                          WCGMST
     I              OMGNST                          WCGNST
     I              OMMAVA                          WCMAVA
     I              OMKDVA                          WCKDVA
     I              OML8VA                          WCL8VA
     I              OML9VA                          WCL9VA
     I              OMGTST                          WCGTST
     I              OMGVST                          WCGVST
     I              OMGUST                          WCGUST
     I              OMQFST                          WCQFST
     I              OMAYVA                          WCAYVA
     I              OMEXDT                          WCEXDT
     I              OMLQCD                          WCLQCD
     I              OMRDCD                          WCRDCD
     I              OMQ7CD                          WCQ7CD
     I              OMBZPR                          WCBZPR
     I              OML6NB                          WCL6NB
     I              OMU1ST                          WCU1ST
     I              OMGIDT                          WCGIDT
     I              OMCRCD                          WCCRCD
     I              OMAGCD                          WCAGCD
     I              OMRZST                          WCRZST
     I              OMR0ST                          WCR0ST
     I              OMR1ST                          WCR1ST
     I              OMG7NA                          WCG7NA
     I              OMG8NA                          WCG8NA
     I              OMRPCD                          WCRPCD
     I              OMVEST                          WCVEST
     I              OMVGST                          WCVGST
     I              OMAVST                          WCAVST
     I              OMU0ST                          WCU0ST
     I              OMRFCD                          WCRFCD
     I              OMFZST                          WCFZST
     I              OMR1NB                          WCR1NB
     I              OMAVQT                          WCAVQT
     I              OMD0WG                          WCD0WG
     I              OMCCQT                          WCCCQT
     I              OMAUWG                          WCAUWG
     I              OMCBQT                          WCCBQT
     I              OMATWG                          WCATWG
     I              OMAQCS                          WCAQCS
     I              OMAGCS                          WCAGCS
     I              OMAKPR                          WCAKPR
     I              OMALPR                          WCALPR
     I              OMAUPR                          WCAUPR
     I              OMAVWG                          WCAVWG
     I              OMA4WG                          WCA4WG
     I              OMA5DT                          WCA5DT
     I              OMAODT                          WCAODT
     I              OMGNDT                          WCGNDT
     I              OMAMST                          WCAMST
     I              OMANST                          WCANST
     I              OMVAST                          WCVAST
     I              OMRGNB                          WCRGNB
     I              OMRHNB                          WCRHNB
     I              OMRINB                          WCRINB
     I              OMRBCD                          WCRBCD
     I              OMHICD                          WCHICD
     I              OMRNCD                          WCRNCD
     I              OMROCD                          WCROCD
     I              OMCXDT                          WCCXDT
     I              OMAJVN                          WCAJVN
     I              OMKXCD                          WCKXCD
     I              OMJPCD                          WCJPCD
     I              OMCQCD                          WCCQCD
     I              OMR4CD                          WCR4CD
     I              OMZ1ST                          WCZ1ST
     I              OMZ3ST                          WCZ3ST
     I              OMZ4ST                          WCZ4ST
     I              OMDUPR                          WCDUPR
     I              OMB6VL                          WCB6VL
     I              OMA1AA                          WCA1AA
     I              OMFZSX                          WCFZSX
     I              OMF0SX                          WCF0SX
     I              OMF1SX                          WCF1SX
     I              OMF2SX                          WCF2SX
     I              OMF3SX                          WCF3SX
     I              OMF4SX                          WCF4SX
     I              OMF5SX                          WCF5SX
     I              OMF6SX                          WCF6SX
     I              OMF7SX                          WCF7SX
     I              OMNTDT                          WCNTDT
     I              OMNUDT                          WCNUDT
     I              OMNVDT                          WCNVDT
     I              OMNWDT                          WCNWDT
     I              OMNXDT                          WCNXDT
     I              OMBUTM                          WCBUTM
     I              OMBVTM                          WCBVTM
     I              OMBWTM                          WCBWTM
     I              OMBXTM                          WCBXTM
     I              OMBYTM                          WCBYTM
     I              OMH5NX                          WCH5NX
     I              OMH6NX                          WCH6NX
     I              OMH7NX                          WCH7NX
     I              OMH8NX                          WCH8NX
     I              OMH9NX                          WCH9NX
     I              OMDVPR                          WCDVPR
     I              OMDWPR                          WCDWPR
     I              OMDXPR                          WCDXPR
     I              OMDYPR                          WCDYPR
     I              OMDZPR                          WCDZPR
     I              OMGSPR                          WCGSPR
     I              OMGTPR                          WCGTPR
     I              OMGUPR                          WCGUPR
     I              OMHOST                          WCHOST
     I              OMHPST                          WCHPST
     I              OMIOST                          WCIOST
     I              OMPEWG                          WCPEWG
     I              OMRINY                          WCRINY
     I              OMTIDT                          WCTIDT
     I              OMTJDT                          WCTJDT
     I              OMH2ST                          WCH2ST
     I              OMH0ST                          WCH0ST
     I              OMH1ST                          WCH1ST
     I              OMTKDT                          WCTKDT
     I              OMTLDT                          WCTLDT
     I              OMTMDT                          WCTMDT
     I              OMUVST                          WCUVST
     I              OMUWST                          WCUWST
     I              OMUXST                          WCUXST
     I              OMAATM                          WCAATM
     I              OMAYNA                          WCAYNA
     I              OMA0NA                          WCA0NA
     I              OMAXDT                          WCAXDT
      *
     I@FJCPSB
      * Load Header               Load Only
      * Renamed input format fields
     I              FJRMNB                          WDRMNB
     I              FJAIC3                          WDAIC3
     I              FJAODT                          WDAODT
     I              FJPJST                          WDPJST
     I              FJPKST                          WDPKST
     I              FJRNNB                          WDRNNB
     I              FJDMTX                          WDDMTX
     I              FJDNTX                          WDDNTX
     I              FJDOTX                          WDDOTX
     I              FJWTTX                          WDWTTX
     I              FJWUTX                          WDWUTX
     I              FJRPNB                          WDRPNB
     I              FJFLAM                          WDFLAM
     I              FJXQST                          WDXQST
     I              FJRRNB                          WDRRNB
     I              FJDXTX                          WDDXTX
     I              FJDYTX                          WDDYTX
     I              FJSBNB                          WDSBNB
     I              FJBZNA                          WDBZNA
     I              FJRONB                          WDRONB
     I              FJSQNB                          WDSQNB
     I              FJR1NB                          WDR1NB
     I              FJVCST                          WDVCST
     I              FJVDST                          WDVDST
     I              FJSDNB                          WDSDNB
     I              FJPAOU                          WDPAOU
     I              FJDGWG                          WDDGWG
     I              FJSXNB                          WDSXNB
     I              FJHADT                          WDHADT
     I              FJAART                          WDAART
     I              FJDHWG                          WDDHWG
     I              FJDIWG                          WDDIWG
     I              FJAQDT                          WDAQDT
     I              FJS6NB                          WDS6NB
     I              FJT4NB                          WDT4NB
     I              FJPRTM                          WDPRTM
     I              FJNPSV                          WDNPSV
     I              FJJ8TX                          WDJ8TX
     I              FJTLMI                          WDTLMI
     I              FJJ9TX                          WDJ9TX
     I              FJQ2CD                          WDQ2CD
     I              FJVPCD                          WDVPCD
     I              FJDBCD                          WDDBCD
     I              FJGRWE                          WDGRWE
     I              FJXCCD                          WDXCCD
     I              FJU2ST                          WDU2ST
     I              FJF9DT                          WDF9DT
     I              FJONTM                          WDONTM
     I              FJJ4DT                          WDJ4DT
     I              FJTRTM                          WDTRTM
     I              FJJ5DT                          WDJ5DT
     I              FJSPTM                          WDSPTM
     I              FJJ6DT                          WDJ6DT
     I              FJLFTM                          WDLFTM
     I              FJJ7DT                          WDJ7DT
     I              FJBOTM                          WDBOTM
     I              FJJ8DT                          WDJ8DT
     I              FJBLTM                          WDBLTM
     I              FJKIDT                          WDKIDT
     I              FJASTM                          WDASTM
     I              FJKADT                          WDKADT
     I              FJAJCM                          WDAJCM
     I              FJXACD                          WDXACD
     I              FJOANA                          WDOANA
     I              FJK4TX                          WDK4TX
     I              FJVOAG                          WDVOAG
     I              FJKBDT                          WDKBDT
     I              FJNBBO                          WDNBBO
     I              FJW4CD                          WDW4CD
     I              FJEFDT                          WDEFDT
     I              FJCNTN                          WDCNTN
     I              FJKCDT                          WDKCDT
     I              FJTMIN                          WDTMIN
     I              FJKDDT                          WDKDDT
     I              FJVMNB                          WDVMNB
     I              FJOCFR                          WDOCFR
     I              FJKJDT                          WDKJDT
     I              FJATTM                          WDATTM
     I              FJOTRS                          WDOTRS
     I              FJRNST                          WDRNST
     I              FJBRBK                          WDBRBK
     I              FJEIDT                          WDEIDT
     I              FJRMST                          WDRMST
     I              FJAJCD                          WDAJCD
     I              FJKKDT                          WDKKDT
     I              FJAVTM                          WDAVTM
     I              FJKZDT                          WDKZDT
     I              FJAXTM                          WDAXTM
     I              FJLHOS                          WDLHOS
     I              FJLHOR                          WDLHOR
     I              FJWNTX                          WDWNTX
     I              FJOITX                          WDOITX
     I              FJOJTX                          WDOJTX
     I              FJLLDT                          WDLLDT
     I              FJLSHG                          WDLSHG
     I              FJYPST                          WDYPST
     I              FJK0DT                          WDK0DT
     I              FJAYTM                          WDAYTM
     I              FJKNNX                          WDKNNX
     I              FJICWG                          WDICWG
     I              FJIDWG                          WDIDWG
     I              FJH9SX                          WDH9SX
     I              FJWOTX                          WDWOTX
     I              FJK1DT                          WDK1DT
     I              FJAZTM                          WDAZTM
     I              FJK2DT                          WDK2DT
     I              FJA0TM                          WDA0TM
     I              FJROST                          WDROST
     I              FJRPST                          WDRPST
     I              FJRQST                          WDRQST
     I              FJRRST                          WDRRST
     I              FJZBVA                          WDZBVA
     I              FJWPTX                          WDWPTX
     I              FJWQTX                          WDWQTX
     I              FJWRTX                          WDWRTX
     I              FJWSTX                          WDWSTX
     I              FJRVSX                          WDRVSX
     I              FJRUSX                          WDRUSX
     I              FJRWSX                          WDRWSX
     I              FJRXSX                          WDRXSX
     I              FJRYSX                          WDRYSX
     I              FJRZSX                          WDRZSX
     I              FJR0SX                          WDR0SX
     I              FJR1SX                          WDR1SX
     I              FJR2SX                          WDR2SX
     I              FJR3SX                          WDR3SX
     I              FJR4SX                          WDR4SX
     I              FJPYDT                          WDPYDT
     I              FJCKTM                          WDCKTM
     I              FJPZDT                          WDPZDT
     I              FJCLTM                          WDCLTM
     I              FJP0DT                          WDP0DT
     I              FJCMTM                          WDCMTM
     I              FJP1DT                          WDP1DT
     I              FJCNTM                          WDCNTM
     I              FJP2DT                          WDP2DT
     I              FJCOTM                          WDCOTM
     I              FJP3DT                          WDP3DT
     I              FJCQTM                          WDCQTM
     I              FJUVST                          WDUVST
     I              FJUWST                          WDUWST
     I              FJUXST                          WDUXST
     I              FJAATM                          WDAATM
     I              FJAYNA                          WDAYNA
     I              FJA0NA                          WDA0NA
     I              FJAXDT                          WDAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WEAIC3
     I              BEC4NB                          WEC4NB
     I              BEJNCD                          WEJNCD
     I              BEANC7                          WEANC7
     I              BEBKC7                          WEBKC7
     I              BEBRTX                          WEBRTX
     I              BEHMNA                          WEHMNA
     I              BEHONA                          WEHONA
     I              BEHPNA                          WEHPNA
     I              BEHNNA                          WEHNNA
     I              BEDBCD                          WEDBCD
     I              BECKTX                          WECKTX
     I              BEB0C7                          WEB0C7
     I              BEAETX                          WEAETX
     I              BEB1NA                          WEB1NA
     I              BEB3NA                          WEB3NA
     I              BEB4NA                          WEB4NA
     I              BEB2NA                          WEB2NA
     I              BEBHCD                          WEBHCD
     I              BEC8TX                          WEC8TX
     I              BEBCNA                          WEBCNA
     I              BEA0DT                          WEA0DT
     I              BEA5DT                          WEA5DT
     I              BEGNDT                          WEGNDT
     I              BEACDT                          WEACDT
     I              BEAQCD                          WEAQCD
     I              BEB6NA                          WEB6NA
     I              BEBYNA                          WEBYNA
     I              BEBZNA                          WEBZNA
     I              BEGTST                          WEGTST
     I              BEGVST                          WEGVST
     I              BEGUST                          WEGUST
     I              BEQFST                          WEQFST
     I              BECQCD                          WECQCD
     I              BEGJST                          WEGJST
     I              BEGWST                          WEGWST
     I              BEGXST                          WEGXST
     I              BEGYST                          WEGYST
     I              BEAODT                          WEAODT
     I              BEAIVN                          WEAIVN
     I              BECXDT                          WECXDT
     I              BEJZVA                          WEJZVA
     I              BEA1WG                          WEA1WG
     I              BEXIST                          WEXIST
     I              BEXJST                          WEXJST
     I              BEXKST                          WEXKST
     I              BEEIDT                          WEEIDT
     I              BEAFTM                          WEAFTM
     I              BEE8CD                          WEE8CD
     I              BEE9CD                          WEE9CD
     I              BERMNB                          WERMNB
     I              BETBNB                          WETBNB
     I              BER1NB                          WER1NB
     I              BEPJST                          WEPJST
     I              BEU0ST                          WEU0ST
     I              BEU1ST                          WEU1ST
     I              BEQ2CD                          WEQ2CD
     I              BEU2ST                          WEU2ST
     I              BEVEST                          WEVEST
     I              BEVFST                          WEVFST
     I              BEVGST                          WEVGST
     I              BERPCD                          WERPCD
     I              BERNNB                          WERNNB
     I              BEVDST                          WEVDST
     I              BEATIN                          WEATIN
     I              BEU4ST                          WEU4ST
     I              BEU5ST                          WEU5ST
     I              BERSRN                          WERSRN
     I              BEMHNA                          WEMHNA
     I              BEMINA                          WEMINA
     I              BEWBST                          WEWBST
     I              BER4CD                          WER4CD
     I              BEBFCD                          WEBFCD
     I              BEQ4CD                          WEQ4CD
     I              BET3NB                          WET3NB
     I              BESICD                          WESICD
     I              BECONB                          WECONB
     I              BECEST                          WECEST
     I              BEAWDT                          WEAWDT
     I              BEJPCD                          WEJPCD
     I              BEXUST                          WEXUST
     I              BEZ1ST                          WEZ1ST
     I              BEVRVA                          WEVRVA
     I              BEOBST                          WEOBST
     I              BEBCST                          WEBCST
     I              BEBDST                          WEBDST
     I              BEB7VL                          WEB7VL
     I              BEGASX                          WEGASX
     I              BEGBSX                          WEGBSX
     I              BEGCSX                          WEGCSX
     I              BEGDSX                          WEGDSX
     I              BEFNSX                          WEFNSX
     I              BEFOSX                          WEFOSX
     I              BEFPSX                          WEFPSX
     I              BEFQSX                          WEFQSX
     I              BEFRSX                          WEFRSX
     I              BEFSSX                          WEFSSX
     I              BEFTSX                          WEFTSX
     I              BEFUSX                          WEFUSX
     I              BEFVSX                          WEFVSX
     I              BEFWSX                          WEFWSX
     I              BEFXSX                          WEFXSX
     I              BEFYSX                          WEFYSX
     I              BENODT                          WENODT
     I              BENPDT                          WENPDT
     I              BENQDT                          WENQDT
     I              BENRDT                          WENRDT
     I              BENSDT                          WENSDT
     I              BEBPTM                          WEBPTM
     I              BEBQTM                          WEBQTM
     I              BEBRTM                          WEBRTM
     I              BEBSTM                          WEBSTM
     I              BEBTTM                          WEBTTM
     I              BEH0NX                          WEH0NX
     I              BEH1NX                          WEH1NX
     I              BEH2NX                          WEH2NX
     I              BEH3NX                          WEH3NX
     I              BEH4NX                          WEH4NX
     I              BEC0C7                          WEC0C7
     I              BEUVST                          WEUVST
     I              BEUWST                          WEUWST
     I              BEUXST                          WEUXST
     I              BEAATM                          WEAATM
     I              BEAYNA                          WEAYNA
     I              BEA0NA                          WEA0NA
     I              BEAXDT                          WEAXDT
      *
     I@BFCPRQ
      * Order Header TRG          Load Id/Order Num
      * Renamed input format fields
     I              BEAIC3                          WFAIC3
     I              BEC4NB                          WFC4NB
     I              BEJNCD                          WFJNCD
     I              BEANC7                          WFANC7
     I              BEBKC7                          WFBKC7
     I              BEBRTX                          WFBRTX
     I              BEHMNA                          WFHMNA
     I              BEHONA                          WFHONA
     I              BEHPNA                          WFHPNA
     I              BEHNNA                          WFHNNA
     I              BEDBCD                          WFDBCD
     I              BECKTX                          WFCKTX
     I              BEB0C7                          WFB0C7
     I              BEAETX                          WFAETX
     I              BEB1NA                          WFB1NA
     I              BEB3NA                          WFB3NA
     I              BEB4NA                          WFB4NA
     I              BEB2NA                          WFB2NA
     I              BEBHCD                          WFBHCD
     I              BEC8TX                          WFC8TX
     I              BEBCNA                          WFBCNA
     I              BEA0DT                          WFA0DT
     I              BEA5DT                          WFA5DT
     I              BEGNDT                          WFGNDT
     I              BEACDT                          WFACDT
     I              BEAQCD                          WFAQCD
     I              BEB6NA                          WFB6NA
     I              BEBYNA                          WFBYNA
     I              BEBZNA                          WFBZNA
     I              BEGTST                          WFGTST
     I              BEGVST                          WFGVST
     I              BEGUST                          WFGUST
     I              BEQFST                          WFQFST
     I              BECQCD                          WFCQCD
     I              BEGJST                          WFGJST
     I              BEGWST                          WFGWST
     I              BEGXST                          WFGXST
     I              BEGYST                          WFGYST
     I              BEAODT                          WFAODT
     I              BEAIVN                          WFAIVN
     I              BECXDT                          WFCXDT
     I              BEJZVA                          WFJZVA
     I              BEA1WG                          WFA1WG
     I              BEXIST                          WFXIST
     I              BEXJST                          WFXJST
     I              BEXKST                          WFXKST
     I              BEEIDT                          WFEIDT
     I              BEAFTM                          WFAFTM
     I              BEE8CD                          WFE8CD
     I              BEE9CD                          WFE9CD
     I              BERMNB                          WFRMNB
     I              BETBNB                          WFTBNB
     I              BER1NB                          WFR1NB
     I              BEPJST                          WFPJST
     I              BEU0ST                          WFU0ST
     I              BEU1ST                          WFU1ST
     I              BEQ2CD                          WFQ2CD
     I              BEU2ST                          WFU2ST
     I              BEVEST                          WFVEST
     I              BEVFST                          WFVFST
     I              BEVGST                          WFVGST
     I              BERPCD                          WFRPCD
     I              BERNNB                          WFRNNB
     I              BEVDST                          WFVDST
     I              BEATIN                          WFATIN
     I              BEU4ST                          WFU4ST
     I              BEU5ST                          WFU5ST
     I              BERSRN                          WFRSRN
     I              BEMHNA                          WFMHNA
     I              BEMINA                          WFMINA
     I              BEWBST                          WFWBST
     I              BER4CD                          WFR4CD
     I              BEBFCD                          WFBFCD
     I              BEQ4CD                          WFQ4CD
     I              BET3NB                          WFT3NB
     I              BESICD                          WFSICD
     I              BECONB                          WFCONB
     I              BECEST                          WFCEST
     I              BEAWDT                          WFAWDT
     I              BEJPCD                          WFJPCD
     I              BEXUST                          WFXUST
     I              BEZ1ST                          WFZ1ST
     I              BEVRVA                          WFVRVA
     I              BEOBST                          WFOBST
     I              BEBCST                          WFBCST
     I              BEBDST                          WFBDST
     I              BEB7VL                          WFB7VL
     I              BEGASX                          WFGASX
     I              BEGBSX                          WFGBSX
     I              BEGCSX                          WFGCSX
     I              BEGDSX                          WFGDSX
     I              BEFNSX                          WFFNSX
     I              BEFOSX                          WFFOSX
     I              BEFPSX                          WFFPSX
     I              BEFQSX                          WFFQSX
     I              BEFRSX                          WFFRSX
     I              BEFSSX                          WFFSSX
     I              BEFTSX                          WFFTSX
     I              BEFUSX                          WFFUSX
     I              BEFVSX                          WFFVSX
     I              BEFWSX                          WFFWSX
     I              BEFXSX                          WFFXSX
     I              BEFYSX                          WFFYSX
     I              BENODT                          WFNODT
     I              BENPDT                          WFNPDT
     I              BENQDT                          WFNQDT
     I              BENRDT                          WFNRDT
     I              BENSDT                          WFNSDT
     I              BEBPTM                          WFBPTM
     I              BEBQTM                          WFBQTM
     I              BEBRTM                          WFBRTM
     I              BEBSTM                          WFBSTM
     I              BEBTTM                          WFBTTM
     I              BEH0NX                          WFH0NX
     I              BEH1NX                          WFH1NX
     I              BEH2NX                          WFH2NX
     I              BEH3NX                          WFH3NX
     I              BEH4NX                          WFH4NX
     I              BEC0C7                          WFC0C7
     I              BEUVST                          WFUVST
     I              BEUWST                          WFUWST
     I              BEUXST                          WFUXST
     I              BEAATM                          WFAATM
     I              BEAYNA                          WFAYNA
     I              BEA0NA                          WFA0NA
     I              BEAXDT                          WFAXDT
      *
     I@BFCPD9
      * Order Header TRG          Load #/All orders
      * Renamed input format fields
     I              BEAIC3                          WGAIC3
     I              BEC4NB                          WGC4NB
     I              BEJNCD                          WGJNCD
     I              BEANC7                          WGANC7
     I              BEBKC7                          WGBKC7
     I              BEBRTX                          WGBRTX
     I              BEHMNA                          WGHMNA
     I              BEHONA                          WGHONA
     I              BEHPNA                          WGHPNA
     I              BEHNNA                          WGHNNA
     I              BEDBCD                          WGDBCD
     I              BECKTX                          WGCKTX
     I              BEB0C7                          WGB0C7
     I              BEAETX                          WGAETX
     I              BEB1NA                          WGB1NA
     I              BEB3NA                          WGB3NA
     I              BEB4NA                          WGB4NA
     I              BEB2NA                          WGB2NA
     I              BEBHCD                          WGBHCD
     I              BEC8TX                          WGC8TX
     I              BEBCNA                          WGBCNA
     I              BEA0DT                          WGA0DT
     I              BEA5DT                          WGA5DT
     I              BEGNDT                          WGGNDT
     I              BEACDT                          WGACDT
     I              BEAQCD                          WGAQCD
     I              BEB6NA                          WGB6NA
     I              BEBYNA                          WGBYNA
     I              BEBZNA                          WGBZNA
     I              BEGTST                          WGGTST
     I              BEGVST                          WGGVST
     I              BEGUST                          WGGUST
     I              BEQFST                          WGQFST
     I              BECQCD                          WGCQCD
     I              BEGJST                          WGGJST
     I              BEGWST                          WGGWST
     I              BEGXST                          WGGXST
     I              BEGYST                          WGGYST
     I              BEAODT                          WGAODT
     I              BEAIVN                          WGAIVN
     I              BECXDT                          WGCXDT
     I              BEJZVA                          WGJZVA
     I              BEA1WG                          WGA1WG
     I              BEXIST                          WGXIST
     I              BEXJST                          WGXJST
     I              BEXKST                          WGXKST
     I              BEEIDT                          WGEIDT
     I              BEAFTM                          WGAFTM
     I              BEE8CD                          WGE8CD
     I              BEE9CD                          WGE9CD
     I              BERMNB                          WGRMNB
     I              BETBNB                          WGTBNB
     I              BER1NB                          WGR1NB
     I              BEPJST                          WGPJST
     I              BEU0ST                          WGU0ST
     I              BEU1ST                          WGU1ST
     I              BEQ2CD                          WGQ2CD
     I              BEU2ST                          WGU2ST
     I              BEVEST                          WGVEST
     I              BEVFST                          WGVFST
     I              BEVGST                          WGVGST
     I              BERPCD                          WGRPCD
     I              BERNNB                          WGRNNB
     I              BEVDST                          WGVDST
     I              BEATIN                          WGATIN
     I              BEU4ST                          WGU4ST
     I              BEU5ST                          WGU5ST
     I              BERSRN                          WGRSRN
     I              BEMHNA                          WGMHNA
     I              BEMINA                          WGMINA
     I              BEWBST                          WGWBST
     I              BER4CD                          WGR4CD
     I              BEBFCD                          WGBFCD
     I              BEQ4CD                          WGQ4CD
     I              BET3NB                          WGT3NB
     I              BESICD                          WGSICD
     I              BECONB                          WGCONB
     I              BECEST                          WGCEST
     I              BEAWDT                          WGAWDT
     I              BEJPCD                          WGJPCD
     I              BEXUST                          WGXUST
     I              BEZ1ST                          WGZ1ST
     I              BEVRVA                          WGVRVA
     I              BEOBST                          WGOBST
     I              BEBCST                          WGBCST
     I              BEBDST                          WGBDST
     I              BEB7VL                          WGB7VL
     I              BEGASX                          WGGASX
     I              BEGBSX                          WGGBSX
     I              BEGCSX                          WGGCSX
     I              BEGDSX                          WGGDSX
     I              BEFNSX                          WGFNSX
     I              BEFOSX                          WGFOSX
     I              BEFPSX                          WGFPSX
     I              BEFQSX                          WGFQSX
     I              BEFRSX                          WGFRSX
     I              BEFSSX                          WGFSSX
     I              BEFTSX                          WGFTSX
     I              BEFUSX                          WGFUSX
     I              BEFVSX                          WGFVSX
     I              BEFWSX                          WGFWSX
     I              BEFXSX                          WGFXSX
     I              BEFYSX                          WGFYSX
     I              BENODT                          WGNODT
     I              BENPDT                          WGNPDT
     I              BENQDT                          WGNQDT
     I              BENRDT                          WGNRDT
     I              BENSDT                          WGNSDT
     I              BEBPTM                          WGBPTM
     I              BEBQTM                          WGBQTM
     I              BEBRTM                          WGBRTM
     I              BEBSTM                          WGBSTM
     I              BEBTTM                          WGBTTM
     I              BEH0NX                          WGH0NX
     I              BEH1NX                          WGH1NX
     I              BEH2NX                          WGH2NX
     I              BEH3NX                          WGH3NX
     I              BEH4NX                          WGH4NX
     I              BEC0C7                          WGC0C7
     I              BEUVST                          WGUVST
     I              BEUWST                          WGUWST
     I              BEUXST                          WGUXST
     I              BEAATM                          WGAATM
     I              BEAYNA                          WGAYNA
     I              BEA0NA                          WGA0NA
     I              BEAXDT                          WGAXDT
      *
     I@ADREWA
      * Warehouse Codes           ShipCo/Warehouse
      * Renamed input format fields
     I              ADAJCD                          WHAJCD
     I              ADF8NA                          WHF8NA
     I              ADACNA                          WHACNA
     I              ADADNA                          WHADNA
     I              ADAENA                          WHAENA
     I              ADAJNA                          WHAJNA
     I              ADBTTX                          WHBTTX
     I              ADAOCD                          WHAOCD
     I              ADBGCD                          WHBGCD
     I              ADVHST                          WHVHST
     I              ADMPNA                          WHMPNA
     I              ADWPST                          WHWPST
     I              ADXUST                          WHXUST
     I              ADT0ST                          WHT0ST
     I              ADT1ST                          WHT1ST
     I              ADDBNB                          WHDBNB
     I              ADT2ST                          WHT2ST
     I              ADT3ST                          WHT3ST
     I              ADT4ST                          WHT4ST
     I              ADT6ST                          WHT6ST
     I              ADBWC3                          WHBWC3
     I              ADBTC3                          WHBTC3
     I              ADBUC3                          WHBUC3
     I              ADBVC3                          WHBVC3
     I              ADFCAA                          WHFCAA
     I              ADRQSX                          WHRQSX
     I              ADRRSX                          WHRRSX
     I              ADRSSX                          WHRSSX
     I              ADRTSX                          WHRTSX
     I              ADT7ST                          WHT7ST
     I              ADT8ST                          WHT8ST
     I              ADRNSX                          WHRNSX
     I              ADROSX                          WHROSX
     I              ADRPSX                          WHRPSX
     I              ADUVST                          WHUVST
     I              ADUWST                          WHUWST
     I              ADUXST                          WHUXST
     I              ADVSST                          WHVSST
     I              ADAATM                          WHAATM
     I              ADAYNA                          WHAYNA
     I              ADA0NA                          WHA0NA
     I              ADAXDT                          WHAXDT
     I              ADQDSC                          WHQDSC
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WIAIC3
     I              OMC4NB                          WIC4NB
     I              OMDPNB                          WIDPNB
     I              OMUENB                          WIUENB
     I              OMHGCD                          WIHGCD
     I              OMAJCD                          WIAJCD
     I              OMBKC7                          WIBKC7
     I              OMCFC7                          WICFC7
     I              OMGMST                          WIGMST
     I              OMGNST                          WIGNST
     I              OMMAVA                          WIMAVA
     I              OMKDVA                          WIKDVA
     I              OML8VA                          WIL8VA
     I              OML9VA                          WIL9VA
     I              OMGTST                          WIGTST
     I              OMGVST                          WIGVST
     I              OMGUST                          WIGUST
     I              OMQFST                          WIQFST
     I              OMAYVA                          WIAYVA
     I              OMEXDT                          WIEXDT
     I              OMLQCD                          WILQCD
     I              OMRDCD                          WIRDCD
     I              OMQ7CD                          WIQ7CD
     I              OMBZPR                          WIBZPR
     I              OML6NB                          WIL6NB
     I              OMU1ST                          WIU1ST
     I              OMGIDT                          WIGIDT
     I              OMCRCD                          WICRCD
     I              OMAGCD                          WIAGCD
     I              OMRZST                          WIRZST
     I              OMR0ST                          WIR0ST
     I              OMR1ST                          WIR1ST
     I              OMG7NA                          WIG7NA
     I              OMG8NA                          WIG8NA
     I              OMRPCD                          WIRPCD
     I              OMVEST                          WIVEST
     I              OMVGST                          WIVGST
     I              OMAVST                          WIAVST
     I              OMU0ST                          WIU0ST
     I              OMRFCD                          WIRFCD
     I              OMFZST                          WIFZST
     I              OMR1NB                          WIR1NB
     I              OMAVQT                          WIAVQT
     I              OMD0WG                          WID0WG
     I              OMCCQT                          WICCQT
     I              OMAUWG                          WIAUWG
     I              OMCBQT                          WICBQT
     I              OMATWG                          WIATWG
     I              OMAQCS                          WIAQCS
     I              OMAGCS                          WIAGCS
     I              OMAKPR                          WIAKPR
     I              OMALPR                          WIALPR
     I              OMAUPR                          WIAUPR
     I              OMAVWG                          WIAVWG
     I              OMA4WG                          WIA4WG
     I              OMA5DT                          WIA5DT
     I              OMAODT                          WIAODT
     I              OMGNDT                          WIGNDT
     I              OMAMST                          WIAMST
     I              OMANST                          WIANST
     I              OMVAST                          WIVAST
     I              OMRGNB                          WIRGNB
     I              OMRHNB                          WIRHNB
     I              OMRINB                          WIRINB
     I              OMRBCD                          WIRBCD
     I              OMHICD                          WIHICD
     I              OMRNCD                          WIRNCD
     I              OMROCD                          WIROCD
     I              OMCXDT                          WICXDT
     I              OMAJVN                          WIAJVN
     I              OMKXCD                          WIKXCD
     I              OMJPCD                          WIJPCD
     I              OMCQCD                          WICQCD
     I              OMR4CD                          WIR4CD
     I              OMZ1ST                          WIZ1ST
     I              OMZ3ST                          WIZ3ST
     I              OMZ4ST                          WIZ4ST
     I              OMDUPR                          WIDUPR
     I              OMB6VL                          WIB6VL
     I              OMA1AA                          WIA1AA
     I              OMFZSX                          WIFZSX
     I              OMF0SX                          WIF0SX
     I              OMF1SX                          WIF1SX
     I              OMF2SX                          WIF2SX
     I              OMF3SX                          WIF3SX
     I              OMF4SX                          WIF4SX
     I              OMF5SX                          WIF5SX
     I              OMF6SX                          WIF6SX
     I              OMF7SX                          WIF7SX
     I              OMNTDT                          WINTDT
     I              OMNUDT                          WINUDT
     I              OMNVDT                          WINVDT
     I              OMNWDT                          WINWDT
     I              OMNXDT                          WINXDT
     I              OMBUTM                          WIBUTM
     I              OMBVTM                          WIBVTM
     I              OMBWTM                          WIBWTM
     I              OMBXTM                          WIBXTM
     I              OMBYTM                          WIBYTM
     I              OMH5NX                          WIH5NX
     I              OMH6NX                          WIH6NX
     I              OMH7NX                          WIH7NX
     I              OMH8NX                          WIH8NX
     I              OMH9NX                          WIH9NX
     I              OMDVPR                          WIDVPR
     I              OMDWPR                          WIDWPR
     I              OMDXPR                          WIDXPR
     I              OMDYPR                          WIDYPR
     I              OMDZPR                          WIDZPR
     I              OMGSPR                          WIGSPR
     I              OMGTPR                          WIGTPR
     I              OMGUPR                          WIGUPR
     I              OMHOST                          WIHOST
     I              OMHPST                          WIHPST
     I              OMIOST                          WIIOST
     I              OMPEWG                          WIPEWG
     I              OMRINY                          WIRINY
     I              OMTIDT                          WITIDT
     I              OMTJDT                          WITJDT
     I              OMH2ST                          WIH2ST
     I              OMH0ST                          WIH0ST
     I              OMH1ST                          WIH1ST
     I              OMTKDT                          WITKDT
     I              OMTLDT                          WITLDT
     I              OMTMDT                          WITMDT
     I              OMUVST                          WIUVST
     I              OMUWST                          WIUWST
     I              OMUXST                          WIUXST
     I              OMAATM                          WIAATM
     I              OMAYNA                          WIAYNA
     I              OMA0NA                          WIA0NA
     I              OMAXDT                          WIAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WJAIC3
     I              BEC4NB                          WJC4NB
     I              BEJNCD                          WJJNCD
     I              BEANC7                          WJANC7
     I              BEBKC7                          WJBKC7
     I              BEBRTX                          WJBRTX
     I              BEHMNA                          WJHMNA
     I              BEHONA                          WJHONA
     I              BEHPNA                          WJHPNA
     I              BEHNNA                          WJHNNA
     I              BEDBCD                          WJDBCD
     I              BECKTX                          WJCKTX
     I              BEB0C7                          WJB0C7
     I              BEAETX                          WJAETX
     I              BEB1NA                          WJB1NA
     I              BEB3NA                          WJB3NA
     I              BEB4NA                          WJB4NA
     I              BEB2NA                          WJB2NA
     I              BEBHCD                          WJBHCD
     I              BEC8TX                          WJC8TX
     I              BEBCNA                          WJBCNA
     I              BEA0DT                          WJA0DT
     I              BEA5DT                          WJA5DT
     I              BEGNDT                          WJGNDT
     I              BEACDT                          WJACDT
     I              BEAQCD                          WJAQCD
     I              BEB6NA                          WJB6NA
     I              BEBYNA                          WJBYNA
     I              BEBZNA                          WJBZNA
     I              BEGTST                          WJGTST
     I              BEGVST                          WJGVST
     I              BEGUST                          WJGUST
     I              BEQFST                          WJQFST
     I              BECQCD                          WJCQCD
     I              BEGJST                          WJGJST
     I              BEGWST                          WJGWST
     I              BEGXST                          WJGXST
     I              BEGYST                          WJGYST
     I              BEAODT                          WJAODT
     I              BEAIVN                          WJAIVN
     I              BECXDT                          WJCXDT
     I              BEJZVA                          WJJZVA
     I              BEA1WG                          WJA1WG
     I              BEXIST                          WJXIST
     I              BEXJST                          WJXJST
     I              BEXKST                          WJXKST
     I              BEEIDT                          WJEIDT
     I              BEAFTM                          WJAFTM
     I              BEE8CD                          WJE8CD
     I              BEE9CD                          WJE9CD
     I              BERMNB                          WJRMNB
     I              BETBNB                          WJTBNB
     I              BER1NB                          WJR1NB
     I              BEPJST                          WJPJST
     I              BEU0ST                          WJU0ST
     I              BEU1ST                          WJU1ST
     I              BEQ2CD                          WJQ2CD
     I              BEU2ST                          WJU2ST
     I              BEVEST                          WJVEST
     I              BEVFST                          WJVFST
     I              BEVGST                          WJVGST
     I              BERPCD                          WJRPCD
     I              BERNNB                          WJRNNB
     I              BEVDST                          WJVDST
     I              BEATIN                          WJATIN
     I              BEU4ST                          WJU4ST
     I              BEU5ST                          WJU5ST
     I              BERSRN                          WJRSRN
     I              BEMHNA                          WJMHNA
     I              BEMINA                          WJMINA
     I              BEWBST                          WJWBST
     I              BER4CD                          WJR4CD
     I              BEBFCD                          WJBFCD
     I              BEQ4CD                          WJQ4CD
     I              BET3NB                          WJT3NB
     I              BESICD                          WJSICD
     I              BECONB                          WJCONB
     I              BECEST                          WJCEST
     I              BEAWDT                          WJAWDT
     I              BEJPCD                          WJJPCD
     I              BEXUST                          WJXUST
     I              BEZ1ST                          WJZ1ST
     I              BEVRVA                          WJVRVA
     I              BEOBST                          WJOBST
     I              BEBCST                          WJBCST
     I              BEBDST                          WJBDST
     I              BEB7VL                          WJB7VL
     I              BEGASX                          WJGASX
     I              BEGBSX                          WJGBSX
     I              BEGCSX                          WJGCSX
     I              BEGDSX                          WJGDSX
     I              BEFNSX                          WJFNSX
     I              BEFOSX                          WJFOSX
     I              BEFPSX                          WJFPSX
     I              BEFQSX                          WJFQSX
     I              BEFRSX                          WJFRSX
     I              BEFSSX                          WJFSSX
     I              BEFTSX                          WJFTSX
     I              BEFUSX                          WJFUSX
     I              BEFVSX                          WJFVSX
     I              BEFWSX                          WJFWSX
     I              BEFXSX                          WJFXSX
     I              BEFYSX                          WJFYSX
     I              BENODT                          WJNODT
     I              BENPDT                          WJNPDT
     I              BENQDT                          WJNQDT
     I              BENRDT                          WJNRDT
     I              BENSDT                          WJNSDT
     I              BEBPTM                          WJBPTM
     I              BEBQTM                          WJBQTM
     I              BEBRTM                          WJBRTM
     I              BEBSTM                          WJBSTM
     I              BEBTTM                          WJBTTM
     I              BEH0NX                          WJH0NX
     I              BEH1NX                          WJH1NX
     I              BEH2NX                          WJH2NX
     I              BEH3NX                          WJH3NX
     I              BEH4NX                          WJH4NX
     I              BEC0C7                          WJC0C7
     I              BEUVST                          WJUVST
     I              BEUWST                          WJUWST
     I              BEUXST                          WJUXST
     I              BEAATM                          WJAATM
     I              BEAYNA                          WJAYNA
     I              BEA0NA                          WJA0NA
     I              BEAXDT                          WJAXDT
      *
     I@FJCPBO
      * Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WKRMNB
     I              FJAIC3                          WKAIC3
     I              FJAODT                          WKAODT
     I              FJPJST                          WKPJST
     I              FJPKST                          WKPKST
     I              FJRNNB                          WKRNNB
     I              FJDMTX                          WKDMTX
     I              FJDNTX                          WKDNTX
     I              FJDOTX                          WKDOTX
     I              FJWTTX                          WKWTTX
     I              FJWUTX                          WKWUTX
     I              FJRPNB                          WKRPNB
     I              FJFLAM                          WKFLAM
     I              FJXQST                          WKXQST
     I              FJRRNB                          WKRRNB
     I              FJDXTX                          WKDXTX
     I              FJDYTX                          WKDYTX
     I              FJSBNB                          WKSBNB
     I              FJBZNA                          WKBZNA
     I              FJRONB                          WKRONB
     I              FJSQNB                          WKSQNB
     I              FJR1NB                          WKR1NB
     I              FJVCST                          WKVCST
     I              FJVDST                          WKVDST
     I              FJSDNB                          WKSDNB
     I              FJPAOU                          WKPAOU
     I              FJDGWG                          WKDGWG
     I              FJSXNB                          WKSXNB
     I              FJHADT                          WKHADT
     I              FJAART                          WKAART
     I              FJDHWG                          WKDHWG
     I              FJDIWG                          WKDIWG
     I              FJAQDT                          WKAQDT
     I              FJS6NB                          WKS6NB
     I              FJT4NB                          WKT4NB
     I              FJPRTM                          WKPRTM
     I              FJNPSV                          WKNPSV
     I              FJJ8TX                          WKJ8TX
     I              FJTLMI                          WKTLMI
     I              FJJ9TX                          WKJ9TX
     I              FJQ2CD                          WKQ2CD
     I              FJVPCD                          WKVPCD
     I              FJDBCD                          WKDBCD
     I              FJGRWE                          WKGRWE
     I              FJXCCD                          WKXCCD
     I              FJU2ST                          WKU2ST
     I              FJF9DT                          WKF9DT
     I              FJONTM                          WKONTM
     I              FJJ4DT                          WKJ4DT
     I              FJTRTM                          WKTRTM
     I              FJJ5DT                          WKJ5DT
     I              FJSPTM                          WKSPTM
     I              FJJ6DT                          WKJ6DT
     I              FJLFTM                          WKLFTM
     I              FJJ7DT                          WKJ7DT
     I              FJBOTM                          WKBOTM
     I              FJJ8DT                          WKJ8DT
     I              FJBLTM                          WKBLTM
     I              FJKIDT                          WKKIDT
     I              FJASTM                          WKASTM
     I              FJKADT                          WKKADT
     I              FJAJCM                          WKAJCM
     I              FJXACD                          WKXACD
     I              FJOANA                          WKOANA
     I              FJK4TX                          WKK4TX
     I              FJVOAG                          WKVOAG
     I              FJKBDT                          WKKBDT
     I              FJNBBO                          WKNBBO
     I              FJW4CD                          WKW4CD
     I              FJEFDT                          WKEFDT
     I              FJCNTN                          WKCNTN
     I              FJKCDT                          WKKCDT
     I              FJTMIN                          WKTMIN
     I              FJKDDT                          WKKDDT
     I              FJVMNB                          WKVMNB
     I              FJOCFR                          WKOCFR
     I              FJKJDT                          WKKJDT
     I              FJATTM                          WKATTM
     I              FJOTRS                          WKOTRS
     I              FJRNST                          WKRNST
     I              FJBRBK                          WKBRBK
     I              FJEIDT                          WKEIDT
     I              FJRMST                          WKRMST
     I              FJAJCD                          WKAJCD
     I              FJKKDT                          WKKKDT
     I              FJAVTM                          WKAVTM
     I              FJKZDT                          WKKZDT
     I              FJAXTM                          WKAXTM
     I              FJLHOS                          WKLHOS
     I              FJLHOR                          WKLHOR
     I              FJWNTX                          WKWNTX
     I              FJOITX                          WKOITX
     I              FJOJTX                          WKOJTX
     I              FJLLDT                          WKLLDT
     I              FJLSHG                          WKLSHG
     I              FJYPST                          WKYPST
     I              FJK0DT                          WKK0DT
     I              FJAYTM                          WKAYTM
     I              FJKNNX                          WKKNNX
     I              FJICWG                          WKICWG
     I              FJIDWG                          WKIDWG
     I              FJH9SX                          WKH9SX
     I              FJWOTX                          WKWOTX
     I              FJK1DT                          WKK1DT
     I              FJAZTM                          WKAZTM
     I              FJK2DT                          WKK2DT
     I              FJA0TM                          WKA0TM
     I              FJROST                          WKROST
     I              FJRPST                          WKRPST
     I              FJRQST                          WKRQST
     I              FJRRST                          WKRRST
     I              FJZBVA                          WKZBVA
     I              FJWPTX                          WKWPTX
     I              FJWQTX                          WKWQTX
     I              FJWRTX                          WKWRTX
     I              FJWSTX                          WKWSTX
     I              FJRVSX                          WKRVSX
     I              FJRUSX                          WKRUSX
     I              FJRWSX                          WKRWSX
     I              FJRXSX                          WKRXSX
     I              FJRYSX                          WKRYSX
     I              FJRZSX                          WKRZSX
     I              FJR0SX                          WKR0SX
     I              FJR1SX                          WKR1SX
     I              FJR2SX                          WKR2SX
     I              FJR3SX                          WKR3SX
     I              FJR4SX                          WKR4SX
     I              FJPYDT                          WKPYDT
     I              FJCKTM                          WKCKTM
     I              FJPZDT                          WKPZDT
     I              FJCLTM                          WKCLTM
     I              FJP0DT                          WKP0DT
     I              FJCMTM                          WKCMTM
     I              FJP1DT                          WKP1DT
     I              FJCNTM                          WKCNTM
     I              FJP2DT                          WKP2DT
     I              FJCOTM                          WKCOTM
     I              FJP3DT                          WKP3DT
     I              FJCQTM                          WKCQTM
     I              FJUVST                          WKUVST
     I              FJUWST                          WKUWST
     I              FJUXST                          WKUXST
     I              FJAATM                          WKAATM
     I              FJAYNA                          WKAYNA
     I              FJA0NA                          WKA0NA
     I              FJAXDT                          WKAXDT
      *
     I@FLCPE8
      * Load Detail               Load/Stop(Desc)/Order
      * Renamed input format fields
     I              FLRMNB                          WLRMNB
     I              FLRUNB                          WLRUNB
     I              FLRVNB                          WLRVNB
     I              FLDQTX                          WLDQTX
     I              FLRWNB                          WLRWNB
     I              FLRXNB                          WLRXNB
     I              FLSQNB                          WLSQNB
     I              FLT0NB                          WLT0NB
     I              FLT1NB                          WLT1NB
     I              FLR1NB                          WLR1NB
     I              FLAIC3                          WLAIC3
     I              FLC4NB                          WLC4NB
     I              FLVCST                          WLVCST
     I              FLKEDT                          WLKEDT
     I              FLSXNB                          WLSXNB
     I              FLKFDT                          WLKFDT
     I              FLACTM                          WLACTM
     I              FLK5TX                          WLK5TX
     I              FLW5CD                          WLW5CD
     I              FLEJDT                          WLEJDT
     I              FLAGTM                          WLAGTM
     I              FLKJDT                          WLKJDT
     I              FLATTM                          WLATTM
     I              FLHDDT                          WLHDDT
     I              FLAUTM                          WLAUTM
     I              FLKKDT                          WLKKDT
     I              FLAVTM                          WLAVTM
     I              FLZ4NB                          WLZ4NB
     I              FLY7ST                          WLY7ST
     I              FLY2ST                          WLY2ST
     I              FLWHTX                          WLWHTX
     I              FLWITX                          WLWITX
     I              FLWJTX                          WLWJTX
     I              FLWKTX                          WLWKTX
     I              FLWLTX                          WLWLTX
     I              FLN7DT                          WLN7DT
     I              FLN8DT                          WLN8DT
     I              FLN9DT                          WLN9DT
     I              FLB3TM                          WLB3TM
     I              FLB4TM                          WLB4TM
     I              FLB5TM                          WLB5TM
     I              FLIASX                          WLIASX
     I              FLIBSX                          WLIBSX
     I              FLICSX                          WLICSX
     I              FLWVTX                          WLWVTX
     I              FLWWTX                          WLWWTX
     I              FLWXTX                          WLWXTX
     I              FLUVST                          WLUVST
     I              FLUWST                          WLUWST
     I              FLUXST                          WLUXST
     I              FLAATM                          WLAATM
     I              FLAYNA                          WLAYNA
     I              FLA0NA                          WLA0NA
     I              FLAXDT                          WLAXDT
      *
     I@FLCPKF
      * Load Detail               Co/Load/Order
      * Renamed input format fields
     I              FLRMNB                          WMRMNB
     I              FLRUNB                          WMRUNB
     I              FLRVNB                          WMRVNB
     I              FLDQTX                          WMDQTX
     I              FLRWNB                          WMRWNB
     I              FLRXNB                          WMRXNB
     I              FLSQNB                          WMSQNB
     I              FLT0NB                          WMT0NB
     I              FLT1NB                          WMT1NB
     I              FLR1NB                          WMR1NB
     I              FLAIC3                          WMAIC3
     I              FLC4NB                          WMC4NB
     I              FLVCST                          WMVCST
     I              FLKEDT                          WMKEDT
     I              FLSXNB                          WMSXNB
     I              FLKFDT                          WMKFDT
     I              FLACTM                          WMACTM
     I              FLK5TX                          WMK5TX
     I              FLW5CD                          WMW5CD
     I              FLEJDT                          WMEJDT
     I              FLAGTM                          WMAGTM
     I              FLKJDT                          WMKJDT
     I              FLATTM                          WMATTM
     I              FLHDDT                          WMHDDT
     I              FLAUTM                          WMAUTM
     I              FLKKDT                          WMKKDT
     I              FLAVTM                          WMAVTM
     I              FLZ4NB                          WMZ4NB
     I              FLY7ST                          WMY7ST
     I              FLY2ST                          WMY2ST
     I              FLWHTX                          WMWHTX
     I              FLWITX                          WMWITX
     I              FLWJTX                          WMWJTX
     I              FLWKTX                          WMWKTX
     I              FLWLTX                          WMWLTX
     I              FLN7DT                          WMN7DT
     I              FLN8DT                          WMN8DT
     I              FLN9DT                          WMN9DT
     I              FLB3TM                          WMB3TM
     I              FLB4TM                          WMB4TM
     I              FLB5TM                          WMB5TM
     I              FLIASX                          WMIASX
     I              FLIBSX                          WMIBSX
     I              FLICSX                          WMICSX
     I              FLWVTX                          WMWVTX
     I              FLWWTX                          WMWWTX
     I              FLWXTX                          WMWXTX
     I              FLUVST                          WMUVST
     I              FLUWST                          WMUWST
     I              FLUXST                          WMUXST
     I              FLAATM                          WMAATM
     I              FLAYNA                          WMAYNA
     I              FLA0NA                          WMA0NA
     I              FLAXDT                          WMAXDT
      *
     I@FLCPBW
      * Load Detail               Retrieval index
      * Renamed input format fields
     I              FLRMNB                          WORMNB
     I              FLRUNB                          WORUNB
     I              FLRVNB                          WORVNB
     I              FLDQTX                          WODQTX
     I              FLRWNB                          WORWNB
     I              FLRXNB                          WORXNB
     I              FLSQNB                          WOSQNB
     I              FLT0NB                          WOT0NB
     I              FLT1NB                          WOT1NB
     I              FLR1NB                          WOR1NB
     I              FLAIC3                          WOAIC3
     I              FLC4NB                          WOC4NB
     I              FLVCST                          WOVCST
     I              FLKEDT                          WOKEDT
     I              FLSXNB                          WOSXNB
     I              FLKFDT                          WOKFDT
     I              FLACTM                          WOACTM
     I              FLK5TX                          WOK5TX
     I              FLW5CD                          WOW5CD
     I              FLEJDT                          WOEJDT
     I              FLAGTM                          WOAGTM
     I              FLKJDT                          WOKJDT
     I              FLATTM                          WOATTM
     I              FLHDDT                          WOHDDT
     I              FLAUTM                          WOAUTM
     I              FLKKDT                          WOKKDT
     I              FLAVTM                          WOAVTM
     I              FLZ4NB                          WOZ4NB
     I              FLY7ST                          WOY7ST
     I              FLY2ST                          WOY2ST
     I              FLWHTX                          WOWHTX
     I              FLWITX                          WOWITX
     I              FLWJTX                          WOWJTX
     I              FLWKTX                          WOWKTX
     I              FLWLTX                          WOWLTX
     I              FLN7DT                          WON7DT
     I              FLN8DT                          WON8DT
     I              FLN9DT                          WON9DT
     I              FLB3TM                          WOB3TM
     I              FLB4TM                          WOB4TM
     I              FLB5TM                          WOB5TM
     I              FLIASX                          WOIASX
     I              FLIBSX                          WOIBSX
     I              FLICSX                          WOICSX
     I              FLWVTX                          WOWVTX
     I              FLWWTX                          WOWWTX
     I              FLWXTX                          WOWXTX
     I              FLUVST                          WOUVST
     I              FLUWST                          WOUWST
     I              FLUXST                          WOUXST
     I              FLAATM                          WOAATM
     I              FLAYNA                          WOAYNA
     I              FLA0NA                          WOA0NA
     I              FLAXDT                          WOAXDT
      *
     I@FLCPBM
      * Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WRRMNB
     I              FLRUNB                          WRRUNB
     I              FLRVNB                          WRRVNB
     I              FLDQTX                          WRDQTX
     I              FLRWNB                          WRRWNB
     I              FLRXNB                          WRRXNB
     I              FLSQNB                          WRSQNB
     I              FLT0NB                          WRT0NB
     I              FLT1NB                          WRT1NB
     I              FLR1NB                          WRR1NB
     I              FLAIC3                          WRAIC3
     I              FLC4NB                          WRC4NB
     I              FLVCST                          WRVCST
     I              FLKEDT                          WRKEDT
     I              FLSXNB                          WRSXNB
     I              FLKFDT                          WRKFDT
     I              FLACTM                          WRACTM
     I              FLK5TX                          WRK5TX
     I              FLW5CD                          WRW5CD
     I              FLEJDT                          WREJDT
     I              FLAGTM                          WRAGTM
     I              FLKJDT                          WRKJDT
     I              FLATTM                          WRATTM
     I              FLHDDT                          WRHDDT
     I              FLAUTM                          WRAUTM
     I              FLKKDT                          WRKKDT
     I              FLAVTM                          WRAVTM
     I              FLZ4NB                          WRZ4NB
     I              FLY7ST                          WRY7ST
     I              FLY2ST                          WRY2ST
     I              FLWHTX                          WRWHTX
     I              FLWITX                          WRWITX
     I              FLWJTX                          WRWJTX
     I              FLWKTX                          WRWKTX
     I              FLWLTX                          WRWLTX
     I              FLN7DT                          WRN7DT
     I              FLN8DT                          WRN8DT
     I              FLN9DT                          WRN9DT
     I              FLB3TM                          WRB3TM
     I              FLB4TM                          WRB4TM
     I              FLB5TM                          WRB5TM
     I              FLIASX                          WRIASX
     I              FLIBSX                          WRIBSX
     I              FLICSX                          WRICSX
     I              FLWVTX                          WRWVTX
     I              FLWWTX                          WRWWTX
     I              FLWXTX                          WRWXTX
     I              FLUVST                          WRUVST
     I              FLUWST                          WRUWST
     I              FLUXST                          WRUXST
     I              FLAATM                          WRAATM
     I              FLAYNA                          WRAYNA
     I              FLA0NA                          WRA0NA
     I              FLAXDT                          WRAXDT
      *
     I@BFCPNQ
      * Order Header TRG          Load(Desc) not bl
      * Renamed input format fields
     I              BEAIC3                          WSAIC3
     I              BEC4NB                          WSC4NB
     I              BEJNCD                          WSJNCD
     I              BEANC7                          WSANC7
     I              BEBKC7                          WSBKC7
     I              BEBRTX                          WSBRTX
     I              BEHMNA                          WSHMNA
     I              BEHONA                          WSHONA
     I              BEHPNA                          WSHPNA
     I              BEHNNA                          WSHNNA
     I              BEDBCD                          WSDBCD
     I              BECKTX                          WSCKTX
     I              BEB0C7                          WSB0C7
     I              BEAETX                          WSAETX
     I              BEB1NA                          WSB1NA
     I              BEB3NA                          WSB3NA
     I              BEB4NA                          WSB4NA
     I              BEB2NA                          WSB2NA
     I              BEBHCD                          WSBHCD
     I              BEC8TX                          WSC8TX
     I              BEBCNA                          WSBCNA
     I              BEA0DT                          WSA0DT
     I              BEA5DT                          WSA5DT
     I              BEGNDT                          WSGNDT
     I              BEACDT                          WSACDT
     I              BEAQCD                          WSAQCD
     I              BEB6NA                          WSB6NA
     I              BEBYNA                          WSBYNA
     I              BEBZNA                          WSBZNA
     I              BEGTST                          WSGTST
     I              BEGVST                          WSGVST
     I              BEGUST                          WSGUST
     I              BEQFST                          WSQFST
     I              BECQCD                          WSCQCD
     I              BEGJST                          WSGJST
     I              BEGWST                          WSGWST
     I              BEGXST                          WSGXST
     I              BEGYST                          WSGYST
     I              BEAODT                          WSAODT
     I              BEAIVN                          WSAIVN
     I              BECXDT                          WSCXDT
     I              BEJZVA                          WSJZVA
     I              BEA1WG                          WSA1WG
     I              BEXIST                          WSXIST
     I              BEXJST                          WSXJST
     I              BEXKST                          WSXKST
     I              BEEIDT                          WSEIDT
     I              BEAFTM                          WSAFTM
     I              BEE8CD                          WSE8CD
     I              BEE9CD                          WSE9CD
     I              BERMNB                          WSRMNB
     I              BETBNB                          WSTBNB
     I              BER1NB                          WSR1NB
     I              BEPJST                          WSPJST
     I              BEU0ST                          WSU0ST
     I              BEU1ST                          WSU1ST
     I              BEQ2CD                          WSQ2CD
     I              BEU2ST                          WSU2ST
     I              BEVEST                          WSVEST
     I              BEVFST                          WSVFST
     I              BEVGST                          WSVGST
     I              BERPCD                          WSRPCD
     I              BERNNB                          WSRNNB
     I              BEVDST                          WSVDST
     I              BEATIN                          WSATIN
     I              BEU4ST                          WSU4ST
     I              BEU5ST                          WSU5ST
     I              BERSRN                          WSRSRN
     I              BEMHNA                          WSMHNA
     I              BEMINA                          WSMINA
     I              BEWBST                          WSWBST
     I              BER4CD                          WSR4CD
     I              BEBFCD                          WSBFCD
     I              BEQ4CD                          WSQ4CD
     I              BET3NB                          WST3NB
     I              BESICD                          WSSICD
     I              BECONB                          WSCONB
     I              BECEST                          WSCEST
     I              BEAWDT                          WSAWDT
     I              BEJPCD                          WSJPCD
     I              BEXUST                          WSXUST
     I              BEZ1ST                          WSZ1ST
     I              BEVRVA                          WSVRVA
     I              BEOBST                          WSOBST
     I              BEBCST                          WSBCST
     I              BEBDST                          WSBDST
     I              BEB7VL                          WSB7VL
     I              BEGASX                          WSGASX
     I              BEGBSX                          WSGBSX
     I              BEGCSX                          WSGCSX
     I              BEGDSX                          WSGDSX
     I              BEFNSX                          WSFNSX
     I              BEFOSX                          WSFOSX
     I              BEFPSX                          WSFPSX
     I              BEFQSX                          WSFQSX
     I              BEFRSX                          WSFRSX
     I              BEFSSX                          WSFSSX
     I              BEFTSX                          WSFTSX
     I              BEFUSX                          WSFUSX
     I              BEFVSX                          WSFVSX
     I              BEFWSX                          WSFWSX
     I              BEFXSX                          WSFXSX
     I              BEFYSX                          WSFYSX
     I              BENODT                          WSNODT
     I              BENPDT                          WSNPDT
     I              BENQDT                          WSNQDT
     I              BENRDT                          WSNRDT
     I              BENSDT                          WSNSDT
     I              BEBPTM                          WSBPTM
     I              BEBQTM                          WSBQTM
     I              BEBRTM                          WSBRTM
     I              BEBSTM                          WSBSTM
     I              BEBTTM                          WSBTTM
     I              BEH0NX                          WSH0NX
     I              BEH1NX                          WSH1NX
     I              BEH2NX                          WSH2NX
     I              BEH3NX                          WSH3NX
     I              BEH4NX                          WSH4NX
     I              BEC0C7                          WSC0C7
     I              BEUVST                          WSUVST
     I              BEUWST                          WSUWST
     I              BEUXST                          WSUXST
     I              BEAATM                          WSAATM
     I              BEAYNA                          WSAYNA
     I              BEA0NA                          WSA0NA
     I              BEAXDT                          WSAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WIAIC3
     I              OMC4NB                          WIC4NB
     I              OMDPNB                          WIDPNB
     I              OMUENB                          WIUENB
     I              OMHGCD                          WIHGCD
     I              OMAJCD                          WIAJCD
     I              OMBKC7                          WIBKC7
     I              OMCFC7                          WICFC7
     I              OMGMST                          WIGMST
     I              OMGNST                          WIGNST
     I              OMMAVA                          WIMAVA
     I              OMKDVA                          WIKDVA
     I              OML8VA                          WIL8VA
     I              OML9VA                          WIL9VA
     I              OMGTST                          WIGTST
     I              OMGVST                          WIGVST
     I              OMGUST                          WIGUST
     I              OMQFST                          WIQFST
     I              OMAYVA                          WIAYVA
     I              OMEXDT                          WIEXDT
     I              OMLQCD                          WILQCD
     I              OMRDCD                          WIRDCD
     I              OMQ7CD                          WIQ7CD
     I              OMBZPR                          WIBZPR
     I              OML6NB                          WIL6NB
     I              OMU1ST                          WIU1ST
     I              OMGIDT                          WIGIDT
     I              OMCRCD                          WICRCD
     I              OMAGCD                          WIAGCD
     I              OMRZST                          WIRZST
     I              OMR0ST                          WIR0ST
     I              OMR1ST                          WIR1ST
     I              OMG7NA                          WIG7NA
     I              OMG8NA                          WIG8NA
     I              OMRPCD                          WIRPCD
     I              OMVEST                          WIVEST
     I              OMVGST                          WIVGST
     I              OMAVST                          WIAVST
     I              OMU0ST                          WIU0ST
     I              OMRFCD                          WIRFCD
     I              OMFZST                          WIFZST
     I              OMR1NB                          WIR1NB
     I              OMAVQT                          WIAVQT
     I              OMD0WG                          WID0WG
     I              OMCCQT                          WICCQT
     I              OMAUWG                          WIAUWG
     I              OMCBQT                          WICBQT
     I              OMATWG                          WIATWG
     I              OMAQCS                          WIAQCS
     I              OMAGCS                          WIAGCS
     I              OMAKPR                          WIAKPR
     I              OMALPR                          WIALPR
     I              OMAUPR                          WIAUPR
     I              OMAVWG                          WIAVWG
     I              OMA4WG                          WIA4WG
     I              OMA5DT                          WIA5DT
     I              OMAODT                          WIAODT
     I              OMGNDT                          WIGNDT
     I              OMAMST                          WIAMST
     I              OMANST                          WIANST
     I              OMVAST                          WIVAST
     I              OMRGNB                          WIRGNB
     I              OMRHNB                          WIRHNB
     I              OMRINB                          WIRINB
     I              OMRBCD                          WIRBCD
     I              OMHICD                          WIHICD
     I              OMRNCD                          WIRNCD
     I              OMROCD                          WIROCD
     I              OMCXDT                          WICXDT
     I              OMAJVN                          WIAJVN
     I              OMKXCD                          WIKXCD
     I              OMJPCD                          WIJPCD
     I              OMCQCD                          WICQCD
     I              OMR4CD                          WIR4CD
     I              OMZ1ST                          WIZ1ST
     I              OMZ3ST                          WIZ3ST
     I              OMZ4ST                          WIZ4ST
     I              OMDUPR                          WIDUPR
     I              OMB6VL                          WIB6VL
     I              OMA1AA                          WIA1AA
     I              OMFZSX                          WIFZSX
     I              OMF0SX                          WIF0SX
     I              OMF1SX                          WIF1SX
     I              OMF2SX                          WIF2SX
     I              OMF3SX                          WIF3SX
     I              OMF4SX                          WIF4SX
     I              OMF5SX                          WIF5SX
     I              OMF6SX                          WIF6SX
     I              OMF7SX                          WIF7SX
     I              OMNTDT                          WINTDT
     I              OMNUDT                          WINUDT
     I              OMNVDT                          WINVDT
     I              OMNWDT                          WINWDT
     I              OMNXDT                          WINXDT
     I              OMBUTM                          WIBUTM
     I              OMBVTM                          WIBVTM
     I              OMBWTM                          WIBWTM
     I              OMBXTM                          WIBXTM
     I              OMBYTM                          WIBYTM
     I              OMH5NX                          WIH5NX
     I              OMH6NX                          WIH6NX
     I              OMH7NX                          WIH7NX
     I              OMH8NX                          WIH8NX
     I              OMH9NX                          WIH9NX
     I              OMDVPR                          WIDVPR
     I              OMDWPR                          WIDWPR
     I              OMDXPR                          WIDXPR
     I              OMDYPR                          WIDYPR
     I              OMDZPR                          WIDZPR
     I              OMGSPR                          WIGSPR
     I              OMGTPR                          WIGTPR
     I              OMGUPR                          WIGUPR
     I              OMHOST                          WIHOST
     I              OMHPST                          WIHPST
     I              OMIOST                          WIIOST
     I              OMPEWG                          WIPEWG
     I              OMRINY                          WIRINY
     I              OMTIDT                          WITIDT
     I              OMTJDT                          WITJDT
     I              OMH2ST                          WIH2ST
     I              OMH0ST                          WIH0ST
     I              OMH1ST                          WIH1ST
     I              OMTKDT                          WITKDT
     I              OMTLDT                          WITLDT
     I              OMTMDT                          WITMDT
     I              OMUVST                          WIUVST
     I              OMUWST                          WIUWST
     I              OMUXST                          WIUXST
     I              OMAATM                          WIAATM
     I              OMAYNA                          WIAYNA
     I              OMA0NA                          WIA0NA
     I              OMAXDT                          WIAXDT
      *
     IYARDCS      DS                            525
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IYBRDCS      DS                            525
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WJAIC3
     I              BEC4NB                          WJC4NB
     I              BEJNCD                          WJJNCD
     I              BEANC7                          WJANC7
     I              BEBKC7                          WJBKC7
     I              BEBRTX                          WJBRTX
     I              BEHMNA                          WJHMNA
     I              BEHONA                          WJHONA
     I              BEHPNA                          WJHPNA
     I              BEHNNA                          WJHNNA
     I              BEDBCD                          WJDBCD
     I              BECKTX                          WJCKTX
     I              BEB0C7                          WJB0C7
     I              BEAETX                          WJAETX
     I              BEB1NA                          WJB1NA
     I              BEB3NA                          WJB3NA
     I              BEB4NA                          WJB4NA
     I              BEB2NA                          WJB2NA
     I              BEBHCD                          WJBHCD
     I              BEC8TX                          WJC8TX
     I              BEBCNA                          WJBCNA
     I              BEA0DT                          WJA0DT
     I              BEA5DT                          WJA5DT
     I              BEGNDT                          WJGNDT
     I              BEACDT                          WJACDT
     I              BEAQCD                          WJAQCD
     I              BEB6NA                          WJB6NA
     I              BEBYNA                          WJBYNA
     I              BEBZNA                          WJBZNA
     I              BEGTST                          WJGTST
     I              BEGVST                          WJGVST
     I              BEGUST                          WJGUST
     I              BEQFST                          WJQFST
     I              BECQCD                          WJCQCD
     I              BEGJST                          WJGJST
     I              BEGWST                          WJGWST
     I              BEGXST                          WJGXST
     I              BEGYST                          WJGYST
     I              BEAODT                          WJAODT
     I              BEAIVN                          WJAIVN
     I              BECXDT                          WJCXDT
     I              BEJZVA                          WJJZVA
     I              BEA1WG                          WJA1WG
     I              BEXIST                          WJXIST
     I              BEXJST                          WJXJST
     I              BEXKST                          WJXKST
     I              BEEIDT                          WJEIDT
     I              BEAFTM                          WJAFTM
     I              BEE8CD                          WJE8CD
     I              BEE9CD                          WJE9CD
     I              BERMNB                          WJRMNB
     I              BETBNB                          WJTBNB
     I              BER1NB                          WJR1NB
     I              BEPJST                          WJPJST
     I              BEU0ST                          WJU0ST
     I              BEU1ST                          WJU1ST
     I              BEQ2CD                          WJQ2CD
     I              BEU2ST                          WJU2ST
     I              BEVEST                          WJVEST
     I              BEVFST                          WJVFST
     I              BEVGST                          WJVGST
     I              BERPCD                          WJRPCD
     I              BERNNB                          WJRNNB
     I              BEVDST                          WJVDST
     I              BEATIN                          WJATIN
     I              BEU4ST                          WJU4ST
     I              BEU5ST                          WJU5ST
     I              BERSRN                          WJRSRN
     I              BEMHNA                          WJMHNA
     I              BEMINA                          WJMINA
     I              BEWBST                          WJWBST
     I              BER4CD                          WJR4CD
     I              BEBFCD                          WJBFCD
     I              BEQ4CD                          WJQ4CD
     I              BET3NB                          WJT3NB
     I              BESICD                          WJSICD
     I              BECONB                          WJCONB
     I              BECEST                          WJCEST
     I              BEAWDT                          WJAWDT
     I              BEJPCD                          WJJPCD
     I              BEXUST                          WJXUST
     I              BEZ1ST                          WJZ1ST
     I              BEVRVA                          WJVRVA
     I              BEOBST                          WJOBST
     I              BEBCST                          WJBCST
     I              BEBDST                          WJBDST
     I              BEB7VL                          WJB7VL
     I              BEGASX                          WJGASX
     I              BEGBSX                          WJGBSX
     I              BEGCSX                          WJGCSX
     I              BEGDSX                          WJGDSX
     I              BEFNSX                          WJFNSX
     I              BEFOSX                          WJFOSX
     I              BEFPSX                          WJFPSX
     I              BEFQSX                          WJFQSX
     I              BEFRSX                          WJFRSX
     I              BEFSSX                          WJFSSX
     I              BEFTSX                          WJFTSX
     I              BEFUSX                          WJFUSX
     I              BEFVSX                          WJFVSX
     I              BEFWSX                          WJFWSX
     I              BEFXSX                          WJFXSX
     I              BEFYSX                          WJFYSX
     I              BENODT                          WJNODT
     I              BENPDT                          WJNPDT
     I              BENQDT                          WJNQDT
     I              BENRDT                          WJNRDT
     I              BENSDT                          WJNSDT
     I              BEBPTM                          WJBPTM
     I              BEBQTM                          WJBQTM
     I              BEBRTM                          WJBRTM
     I              BEBSTM                          WJBSTM
     I              BEBTTM                          WJBTTM
     I              BEH0NX                          WJH0NX
     I              BEH1NX                          WJH1NX
     I              BEH2NX                          WJH2NX
     I              BEH3NX                          WJH3NX
     I              BEH4NX                          WJH4NX
     I              BEC0C7                          WJC0C7
     I              BEUVST                          WJUVST
     I              BEUWST                          WJUWST
     I              BEUXST                          WJUXST
     I              BEAATM                          WJAATM
     I              BEAYNA                          WJAYNA
     I              BEA0NA                          WJA0NA
     I              BEAXDT                          WJAXDT
      *
     IYCRDCS      DS                            779
     IYDRDCS      DS                            525
      * Outward parameters
     IPARC        DS                             82
      * RCD : Load Order Change Log     Retrieval index
      * N :  Sequence Number
     I                                    P   9  100PADXNB
      * I :  Load ID
     I                                    P  11  140PARMNB
      * I :  Stop_Drop
     I                                    P  15  170PARVNB
      * I :  Load Change Type
     I                                       18  23 PARVST
      * I :  Department Control Code
     I                                       24  26 PAUJST
      * I :  Change Log Prior Value
     I                                       27  38 PAMNTX
      * I :  Change Log New Value
     I                                       39  50 PAMOTX
      * I :  User Id
     I                                       51  60 PAAYNA
      * I :  Job Name
     I                                       61  70 PAA0NA
      * I :  Carrier Code
     I                                       71  73 PABZNA
      * N :  Carrier Broker Carrier Co
     I                                       74  76 PAXMCD
      * I :  Company Number
     I                                    P  77  780PAAIC3
      * I :  Order Number
     I                                    P  79  820PAC4NB
      *
     IYERDCS      DS                            779
      * Outward parameters
     IPBRC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PBAIC3
      * I :  Order Number
     I                                    P   3   60PBC4NB
      * I :  Order Type_Sales
     I                                        7   8 PBJNCD
      * I :  AR Customer Number
     I                                    P   9  120PBANC7
      * I :  Ship To Customer
     I                                    P  13  160PBBKC7
      * I :  Ship To Name
     I                                       17  46 PBBRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PBHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PBHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PBHPNA
      * I :  Ship To City
     I                                      137 156 PBHNNA
      * I :  Ship To State Code
     I                                      157 158 PBDBCD
      * I :  Ship To Zip_Postal Code
     I                                      159 169 PBCKTX
      * I :  Bill to Customer
     I                                    P 170 1730PBB0C7
      * I :  Bill to Name
     I                                      174 203 PBAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PBB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PBB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PBB4NA
      * I :  Bill to City
     I                                      294 313 PBB2NA
      * I :  Bill to State Code
     I                                      314 315 PBBHCD
      * I :  Bill to Zip_Postal Code
     I                                      316 326 PBC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PBBCNA
      * I :  Order Date
     I                                    P 342 3450PBA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PBA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PBGNDT
      * I :  Cancel Date
     I                                    P 354 3570PBACDT
      * I :  Terms Code
     I                                      358 359 PBAQCD
      * I :  Special Instructions
     I                                      360 399 PBB6NA
      * I :  Special Instructions 2
     I                                      400 439 PBBYNA
      * I :  Carrier Code
     I                                      440 442 PBBZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PBGTST
      * I :  Comment Print Inv_Cr_Memo
     I                                      444 444 PBGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PBGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PBQFST
      * I :  Reason Code
     I                                      447 449 PBCQCD
      * I :  Order in Use
     I                                      450 450 PBGJST
      * I :  Header Status
     I                                      451 451 PBGWST
      * I :  Header Status Last
     I                                      452 452 PBGXST
      * I :  Order Type Print Status
     I                                      453 453 PBGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PBAODT
      * I :  User Original Entry
     I                                      458 467 PBAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PBCXDT
      * I :  Order Value Total
     I                                    P 472 4772PBJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PBA1WG
      * I :  Credit Hold
     I                                      484 484 PBXIST
      * I :  Production Hold
     I                                      485 485 PBXJST
      * I :  New Customer Hold
     I                                      486 486 PBXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PBEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PBAFTM
      * I :  Accounts Receiv_Ent 1
     I                                      494 497 PBE8CD
      * I :  Accounts Receiv_Ent 2
     I                                      498 509 PBE9CD
      * I :  Load ID
     I                                    P 510 5130PBRMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PBTBNB
      * I :  Rated Freight
     I                                    P 517 5222PBR1NB
      * I :  LTL Flag
     I                                      523 523 PBPJST
      * I :  Price Audit
     I                                      524 524 PBU0ST
      * I :  Price Status
     I                                      525 525 PBU1ST
      * I :  Shipping Method
     I                                      526 527 PBQ2CD
      * I :  Export Status
     I                                      528 528 PBU2ST
      * I :  Palletize
     I                                      529 529 PBVEST
      * I :  Shrink Wrap
     I                                      530 530 PBVFST
      * I :  Slip Sheet
     I                                      531 531 PBVGST
      * I :  Age Code
     I                                      532 532 PBRPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PBRNNB
      * I :  Load Type
     I                                      536 536 PBVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PBATIN
      * I :  Load Plan Order
     I                                      541 541 PBU4ST
      * I :  Print Pick Slip
     I                                      542 542 PBU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PBRSRN
      * I :  Special Comment 1
     I                                      547 576 PBMHNA
      * I :  Special Comment 2
     I                                      577 606 PBMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PBWBST
      * I :  Sales Route Code
     I                                      608 610 PBR4CD
      * I :  Manager Level Code
     I                                      611 612 PBBFCD
      * I :  VP Level Code
     I                                      613 615 PBQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PBT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PBSICD
      * I :  Invoice Number
     I                                    P 623 6260PBCONB
      * I :  Invoice Suffix
     I                                      627 628 PBCEST
      * I :  Invoice Date
     I                                    P 629 6320PBAWDT
      * I :  Event Code
     I                                      633 634 PBJPCD
      * I :  Trans Contol AS400_Plant
     I                                      635 635 PBXUST
      * I :  Modified Flag
     I                                      636 636 PBZ1ST
      * I :  A_R order Value Total
     I                                    P 637 6422PBVRVA
      * I :  Billing Activity Type
     I                                      643 643 PBOBST
      * I :  Block Order Flag
     I                                      644 644 PBBCST
      * I :  Order Certification Flag
     I                                      645 645 PBBDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PBB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PBGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PBGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PBGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PBGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PBFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PBFOSX
      * I :  Order Emailed
     I                                      658 658 PBFPSX
      * I :  Export Docs Go w_Driver
     I                                      659 659 PBFQSX
      * I :  Shipping Temp Code C_F
     I                                      660 660 PBFRSX
      * I :  Broker Order Status
     I                                      661 661 PBFSSX
      * I :  Air Freight Order
     I                                      662 662 PBFTSX
      * I :  Order Requires Review
     I                                      663 664 PBFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PBFVSX
      * I :  Export USDA Approved
     I                                      667 668 PBFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PBFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PBFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PBNODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PBNPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PBNQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PBNRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PBNSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PBBPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PBBQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PBBRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PBBSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PBBTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PBH0NX
      * I :  Act Non_Ref Frt Amount
     I                                    P 721 7262PBH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PBH2NX
      * I :  OH Total Non_Ref Frt Amt
     I                                    P 733 7382PBH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PBH4NX
      * I :  Claim Number
     I                                    P 745 7480PBC0C7
      * I :  EDI Status 1
     I                                      749 749 PBUVST
      * I :  EDI Status 2
     I                                      750 750 PBUWST
      * I :  EDI Status 3
     I                                      751 751 PBUXST
      * I :  Job Time
     I                                    P 752 7550PBAATM
      * I :  User Id
     I                                      756 765 PBAYNA
      * I :  Job Name
     I                                      766 775 PBA0NA
      * I :  Job Date
     I                                    P 776 7790PBAXDT
      *
      * Outward parameters
     IPCRC        DS                             11
      * KEY : Load Detail               Load/Stop/Order
      * I :  Load ID
     I                                    P   1   40PCRMNB
      *
     IQOMFJ1    E DSOMFJCPL1
      * UPD : Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WKRMNB
     I              FJAIC3                          WKAIC3
     I              FJAODT                          WKAODT
     I              FJPJST                          WKPJST
     I              FJPKST                          WKPKST
     I              FJRNNB                          WKRNNB
     I              FJDMTX                          WKDMTX
     I              FJDNTX                          WKDNTX
     I              FJDOTX                          WKDOTX
     I              FJWTTX                          WKWTTX
     I              FJWUTX                          WKWUTX
     I              FJRPNB                          WKRPNB
     I              FJFLAM                          WKFLAM
     I              FJXQST                          WKXQST
     I              FJRRNB                          WKRRNB
     I              FJDXTX                          WKDXTX
     I              FJDYTX                          WKDYTX
     I              FJSBNB                          WKSBNB
     I              FJBZNA                          WKBZNA
     I              FJRONB                          WKRONB
     I              FJSQNB                          WKSQNB
     I              FJR1NB                          WKR1NB
     I              FJVCST                          WKVCST
     I              FJVDST                          WKVDST
     I              FJSDNB                          WKSDNB
     I              FJPAOU                          WKPAOU
     I              FJDGWG                          WKDGWG
     I              FJSXNB                          WKSXNB
     I              FJHADT                          WKHADT
     I              FJAART                          WKAART
     I              FJDHWG                          WKDHWG
     I              FJDIWG                          WKDIWG
     I              FJAQDT                          WKAQDT
     I              FJS6NB                          WKS6NB
     I              FJT4NB                          WKT4NB
     I              FJPRTM                          WKPRTM
     I              FJNPSV                          WKNPSV
     I              FJJ8TX                          WKJ8TX
     I              FJTLMI                          WKTLMI
     I              FJJ9TX                          WKJ9TX
     I              FJQ2CD                          WKQ2CD
     I              FJVPCD                          WKVPCD
     I              FJDBCD                          WKDBCD
     I              FJGRWE                          WKGRWE
     I              FJXCCD                          WKXCCD
     I              FJU2ST                          WKU2ST
     I              FJF9DT                          WKF9DT
     I              FJONTM                          WKONTM
     I              FJJ4DT                          WKJ4DT
     I              FJTRTM                          WKTRTM
     I              FJJ5DT                          WKJ5DT
     I              FJSPTM                          WKSPTM
     I              FJJ6DT                          WKJ6DT
     I              FJLFTM                          WKLFTM
     I              FJJ7DT                          WKJ7DT
     I              FJBOTM                          WKBOTM
     I              FJJ8DT                          WKJ8DT
     I              FJBLTM                          WKBLTM
     I              FJKIDT                          WKKIDT
     I              FJASTM                          WKASTM
     I              FJKADT                          WKKADT
     I              FJAJCM                          WKAJCM
     I              FJXACD                          WKXACD
     I              FJOANA                          WKOANA
     I              FJK4TX                          WKK4TX
     I              FJVOAG                          WKVOAG
     I              FJKBDT                          WKKBDT
     I              FJNBBO                          WKNBBO
     I              FJW4CD                          WKW4CD
     I              FJEFDT                          WKEFDT
     I              FJCNTN                          WKCNTN
     I              FJKCDT                          WKKCDT
     I              FJTMIN                          WKTMIN
     I              FJKDDT                          WKKDDT
     I              FJVMNB                          WKVMNB
     I              FJOCFR                          WKOCFR
     I              FJKJDT                          WKKJDT
     I              FJATTM                          WKATTM
     I              FJOTRS                          WKOTRS
     I              FJRNST                          WKRNST
     I              FJBRBK                          WKBRBK
     I              FJEIDT                          WKEIDT
     I              FJRMST                          WKRMST
     I              FJAJCD                          WKAJCD
     I              FJKKDT                          WKKKDT
     I              FJAVTM                          WKAVTM
     I              FJKZDT                          WKKZDT
     I              FJAXTM                          WKAXTM
     I              FJLHOS                          WKLHOS
     I              FJLHOR                          WKLHOR
     I              FJWNTX                          WKWNTX
     I              FJOITX                          WKOITX
     I              FJOJTX                          WKOJTX
     I              FJLLDT                          WKLLDT
     I              FJLSHG                          WKLSHG
     I              FJYPST                          WKYPST
     I              FJK0DT                          WKK0DT
     I              FJAYTM                          WKAYTM
     I              FJKNNX                          WKKNNX
     I              FJICWG                          WKICWG
     I              FJIDWG                          WKIDWG
     I              FJH9SX                          WKH9SX
     I              FJWOTX                          WKWOTX
     I              FJK1DT                          WKK1DT
     I              FJAZTM                          WKAZTM
     I              FJK2DT                          WKK2DT
     I              FJA0TM                          WKA0TM
     I              FJROST                          WKROST
     I              FJRPST                          WKRPST
     I              FJRQST                          WKRQST
     I              FJRRST                          WKRRST
     I              FJZBVA                          WKZBVA
     I              FJWPTX                          WKWPTX
     I              FJWQTX                          WKWQTX
     I              FJWRTX                          WKWRTX
     I              FJWSTX                          WKWSTX
     I              FJRVSX                          WKRVSX
     I              FJRUSX                          WKRUSX
     I              FJRWSX                          WKRWSX
     I              FJRXSX                          WKRXSX
     I              FJRYSX                          WKRYSX
     I              FJRZSX                          WKRZSX
     I              FJR0SX                          WKR0SX
     I              FJR1SX                          WKR1SX
     I              FJR2SX                          WKR2SX
     I              FJR3SX                          WKR3SX
     I              FJR4SX                          WKR4SX
     I              FJPYDT                          WKPYDT
     I              FJCKTM                          WKCKTM
     I              FJPZDT                          WKPZDT
     I              FJCLTM                          WKCLTM
     I              FJP0DT                          WKP0DT
     I              FJCMTM                          WKCMTM
     I              FJP1DT                          WKP1DT
     I              FJCNTM                          WKCNTM
     I              FJP2DT                          WKP2DT
     I              FJCOTM                          WKCOTM
     I              FJP3DT                          WKP3DT
     I              FJCQTM                          WKCQTM
     I              FJUVST                          WKUVST
     I              FJUWST                          WKUWST
     I              FJUXST                          WKUXST
     I              FJAATM                          WKAATM
     I              FJAYNA                          WKAYNA
     I              FJA0NA                          WKA0NA
     I              FJAXDT                          WKAXDT
      *
     IYFRDCS      DS                            793
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IYGRDCS      DS                            793
     IYHRDCS      DS                            793
     IQOMFL1    E DSOMFLCPL0
      * UPD : Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WRRMNB
     I              FLRUNB                          WRRUNB
     I              FLRVNB                          WRRVNB
     I              FLDQTX                          WRDQTX
     I              FLRWNB                          WRRWNB
     I              FLRXNB                          WRRXNB
     I              FLSQNB                          WRSQNB
     I              FLT0NB                          WRT0NB
     I              FLT1NB                          WRT1NB
     I              FLR1NB                          WRR1NB
     I              FLAIC3                          WRAIC3
     I              FLC4NB                          WRC4NB
     I              FLVCST                          WRVCST
     I              FLKEDT                          WRKEDT
     I              FLSXNB                          WRSXNB
     I              FLKFDT                          WRKFDT
     I              FLACTM                          WRACTM
     I              FLK5TX                          WRK5TX
     I              FLW5CD                          WRW5CD
     I              FLEJDT                          WREJDT
     I              FLAGTM                          WRAGTM
     I              FLKJDT                          WRKJDT
     I              FLATTM                          WRATTM
     I              FLHDDT                          WRHDDT
     I              FLAUTM                          WRAUTM
     I              FLKKDT                          WRKKDT
     I              FLAVTM                          WRAVTM
     I              FLZ4NB                          WRZ4NB
     I              FLY7ST                          WRY7ST
     I              FLY2ST                          WRY2ST
     I              FLWHTX                          WRWHTX
     I              FLWITX                          WRWITX
     I              FLWJTX                          WRWJTX
     I              FLWKTX                          WRWKTX
     I              FLWLTX                          WRWLTX
     I              FLN7DT                          WRN7DT
     I              FLN8DT                          WRN8DT
     I              FLN9DT                          WRN9DT
     I              FLB3TM                          WRB3TM
     I              FLB4TM                          WRB4TM
     I              FLB5TM                          WRB5TM
     I              FLIASX                          WRIASX
     I              FLIBSX                          WRIBSX
     I              FLICSX                          WRICSX
     I              FLWVTX                          WRWVTX
     I              FLWWTX                          WRWWTX
     I              FLWXTX                          WRWXTX
     I              FLUVST                          WRUVST
     I              FLUWST                          WRUWST
     I              FLUXST                          WRUXST
     I              FLAATM                          WRAATM
     I              FLAYNA                          WRAYNA
     I              FLA0NA                          WRA0NA
     I              FLAXDT                          WRAXDT
      *
     IYIRDCS      DS                            367
     IYJRDCS      DS                            779
     IYKRDCS      DS                            525
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * N :  Error Status
     I                                        1   1 P1ECST
     IP2PARM      DS
      * FLD: *Arrays
      * N :  Warehouse Code
     I                                        1   3 P2AJCD
      * N :  Company Number
     I                                    P   4   50P2AIC3
      * N :  Application Code
     I                                        6  11 P2DNCD
      * N :  Salesperson Code
     I                                       12  14 P2BCCD
      * N :  User Profile Name
     I                                       15  24 P2AJVN
      * N :  Allow Multi_Company
     I                                       25  25 P2I6ST
      * N :  Default Printer
     I                                       26  35 P2MPNA
      * N :  First Time Flag
     I                                       36  36 P2TAST
      * N :  Access Limited Sts USR
     I                                       37  37 P2HHST
     IP3PARM      DS
      * FLD: User Profile Control
      * N :  Production Hold Authority
     I                                        1   1 P3XNST
     IP4PARM      DS
      * N :  Load Status
     I                                        1   1 P4PKST
     IP5PARM      DS
      * FLD: Order Header TRG
      * N :  Order Type_Sales
     I                                        1   2 P5JNCD
      * N :  Ship To Customer
     I                                    P   3   60P5BKC7
      * N :  Ship To City
     I                                        7  26 P5HNNA
      * N :  Ship To State Code
     I                                       27  28 P5DBCD
      * N :  Customer Purchase Order #
     I                                       29  43 P5BCNA
      * N :  Order Date
     I                                    P  44  470P5A0DT
      * N :  Requested Ship Date
     I                                    P  48  510P5A5DT
      * N :  Header Status
     I                                       52  52 P5GWST
      * N :  Scheduled Ship Date
     I                                    P  53  560P5AODT
      * N :  Credit Hold
     I                                       57  57 P5XIST
      * N :  Production Hold
     I                                       58  58 P5XJST
      * N :  Requested Delivery Date
     I                                    P  59  620P5EIDT
      * N :  Load ID
     I                                    P  63  660P5RMNB
     IP6PARM      DS
      * FLD: *Arrays
      * N :  PRT Printer Device
     I                                        1  10 P6WRST
      * N :  PRT Hold Output Sts
     I                                       11  14 P6WSST
      * N :  PRT Save Output Sts
     I                                       15  18 P6WTST
      * N :  PRT Number of Copies
     I                                       19  200P6DYNB
      * N :  PRT Night Queue Run Sts
     I                                       21  21 P6WUST
      * N :  PRT Night Queue
     I                                       22  31 P6BVVN
      * N :  Program name USR
     I                                       32  41 P6BMVN
      * N :  Program Name$ USR
     I                                       42  51 P6BWVN
      * N :  Display Prt Opt Pmt USR
     I                                       52  55 P6XFST
     IP7PARM      DS
      * N :  USR Process status
     I                                        1   1 P7FLST
     IP8PARM      DS
      * N :  MG Created Load
     I                                        1   1 P8RYSX
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'CD7 Non numeric data'
      * Message data for 'CD3 Non numeric data'
      * Message data for 'CD7 Non numeric data'
      * Message data for 'Order Number must be ente'
      * Order Number
     I                                        1   7 ZA0001
      * Message data for 'Order in use detail'
      * *SFLSEL
     I                                        1   1 ZA0002
      * Order Number
     I                                        2   8 ZA0003
      * Message data for 'Order has been Cancelled'
      * *SFLSEL
     I                                        1   1 ZA0004
      * Message data for 'Order On Load Opt Invald'
      * Order Number
     I                                        1   7 ZA0005
      * Message data for 'Order in use detail'
      * *SFLSEL
     I                                        1   1 ZA0006
      * Order Number
     I                                        2   8 ZA0007
      * Message data for 'Order has been Cancelled'
      * *SFLSEL
     I                                        1   1 ZA0008
      * Message data for 'Prt Ord Acknowledgenemt'
      * Company Number Pass   USR
     I                                    P   1   85ZA0009
      * Order Number 1  PASS  USR
     I                                    P   9  165ZA0010
      * Order Number 2  PASS  USR
     I                                    P  17  245ZA0011
      * Date 1          PASS  USR
     I                                    P  25  325ZA0012
      * Date 2          PASS  USR
     I                                    P  33  405ZA0013
      * Thru Date Pass        USR
     I                                    P  41  485ZA0014
      * Order Type_Sales
     I                                       49  50 ZA0015
      * Shipping Method
     I                                       51  52 ZA0016
      * Billing Activity Type
     I                                       53  53 ZA0017
      * Export Sales
     I                                       54  54 ZA0018
      * USR Warehouse Code
     I                                       55  57 ZA0019
      * USR CDE Parm 1
     I                                       58  60 ZA0020
      * USR CDE Parm 2
     I                                       61  63 ZA0021
      * USR CDE Parm 3
     I                                       64  66 ZA0022
      * USR CDE Parm 4
     I                                       67  69 ZA0023
      * USR CDE Parm 5
     I                                       70  72 ZA0024
      * USR CDE Parm 6
     I                                       73  75 ZA0025
      * USR CDE Parm 7
     I                                       76  78 ZA0026
      * USR CDE Parm 8
     I                                       79  81 ZA0027
      * USR CDE Parm 9
     I                                       82  84 ZA0028
      * USR Select/Omit Flag
     I                                       85  85 ZA0029
      * PRT Printer Device
     I                                       86  95 ZA0030
      * PRT Hold Output Sts
     I                                       96  99 ZA0031
      * PRT Save Output Sts
     I                                      100 103 ZA0032
      * System Value Numeric
     I                                    P 104 1115ZA0033
      * PRT Night Queue
     I                                      112 121 ZA0034
      * Date 3          PASS  USR
     I                                    P 122 1295ZA0035
      * Email To Whs
     I                                      130 130 ZA0036
      * Email to Warehouse Code
     I                                      131 133 ZA0037
      * Email to Salesperson Usr
     I                                      134 134 ZA0038
      * Message data for 'Order in use detail'
      * *SFLSEL
     I                                        1   1 ZA0039
      * Order Number
     I                                        2   8 ZA0040
      * Message data for 'Order has been Cancelled'
      * *SFLSEL
     I                                        1   1 ZA0041
      * Message data for 'Load Locked Opt Invalid'
      * *SFLSEL
     I                                        1   1 ZA0042
      * Message data for 'Order has been unpicked'
      * Order Number
     I                                        1   7 ZA0043
      * Message data for 'Order not picked.opt n/a'
      * Order Number
     I                                        1   7 ZA0044
      * Message data for 'Order Canc/Conf/Complete'
      * *SFLSEL
     I                                        1   1 ZA0045
      * Message data for 'Not Authorized to Option'
      * *SFLSEL
     I                                        1   1 ZA0046
      * Message data for 'Block Orders on Ld-no UPD'
      * *SFLSEL
     I                                        1   1 ZA0047
      * Load ID
     I                                    P   2   50ZA0048
      * Message data for 'Load Status inv for Chg'
      * *SFLSEL
     I                                        1   1 ZA0049
      * Load ID
     I                                    P   2   50ZA0050
      * Message data for 'Load Status inv for Chg'
      * *SFLSEL
     I                                        1   1 ZA0051
      * Load ID
     I                                    P   2   50ZA0052
      * Message data for 'Live TMS Option Invalid'
      * SH Order Sales Channel
     I                                        1   2 ZA0053
      * Message data for 'Live TMS Option Invalid'
      * SH Order Sales Channel
     I                                        1   2 ZA0054
      * Message data for 'Order in use detail'
      * *SFLSEL
     I                                        1   1 ZA0055
      * Order Number
     I                                        2   8 ZA0056
      * Message data for 'Order shipped; opt inv.'
      * *SFLSEL
     I                                        1   1 ZA0057
      * Order Number
     I                                        2   8 ZA0058
      * Message data for 'Order has been Cancelled'
      * *SFLSEL
     I                                        1   1 ZA0059
      * Message data for 'Order Not on Prod Hold'
      * Order Number
     I                                        1   7 ZA0060
      * *SFLSEL
     I                                        8   8 ZA0061
      * Message data for 'Order in use detail'
      * *SFLSEL
     I                                        1   1 ZA0062
      * Order Number
     I                                        2   8 ZA0063
      * Message data for 'Order shipped; opt inv.'
      * *SFLSEL
     I                                        1   1 ZA0064
      * Order Number
     I                                        2   8 ZA0065
      * Message data for 'Order has been Cancelled'
      * *SFLSEL
     I                                        1   1 ZA0066
      * Message data for 'Order already on prd hold'
      * Order Number
     I                                        1   7 ZA0067
      * *SFLSEL
     I                                        8   8 ZA0068
      * Message data for 'Load Locked Opt Invalid'
      * *SFLSEL
     I                                        1   1 ZA0069
      * Message data for 'Order Not Assigned a load'
      * *SFLSEL
     I                                        1   1 ZA0070
      * Order Number
     I                                        2   8 ZA0071
      * Message data for 'Load Locked Opt Invalid'
      * *SFLSEL
     I                                        1   1 ZA0072
      * Message data for 'No Orders Assigned'
      * Load ID
     I                                    P   1   40ZA0073
      * *SFLSEL
     I                                        5   5 ZA0074
      * Message data for 'Block Orders on Ld-no UPD'
      * *SFLSEL
     I                                        1   1 ZA0075
      * Load ID
     I                                    P   2   50ZA0076
      * Message data for 'Load Cant be Locked'
      * *SFLSEL
     I                                        1   1 ZA0077
      * Load ID
     I                                    P   2   50ZA0078
      * Message data for 'Carrier must be entered'
      * Carrier Code
     I                                        1   3 ZA0079
      * Load ID
     I                                    P   4   70ZA0080
      * Message data for 'Truck size must be enter'
      * Truck Size
     I                                        1   7 ZA0081
      * Load ID
     I                                    P   8  110ZA0082
      * Message data for 'Shipping Method required'
      * Shipping Method
     I                                        1   2 ZA0083
      * Message data for 'Load has orders w/o stop'
      * Load ID
     I                                    P   1   40ZA0084
      * Message data for 'Load is not accepted'
      * Load ID
     I                                    P   1   40ZA0085
      * Message data for 'Load has Orders on Hold'
      * Load ID
     I                                    P   1   40ZA0086
      * *SFLSEL
     I                                        5   5 ZA0087
      * Message data for 'Load has Cancelled Orders'
      * Load ID
     I                                    P   1   40ZA0088
      * *SFLSEL
     I                                        5   5 ZA0089
      * Message data for 'Load has Orders in Use'
      * *SFLSEL
     I                                        1   1 ZA0090
      * Load ID
     I                                    P   2   50ZA0091
      * Message data for 'Order detail needs review'
      * *SFLSEL
     I                                        1   1 ZA0092
      * Load ID
     I                                    P   2   50ZA0093
      * Message data for 'Load Weight LT Minimum'
      * Load ID
     I                                    P   1   40ZA0094
      * Message data for 'Block Orders on Ld-no UPD'
      * *SFLSEL
     I                                        1   1 ZA0095
      * Load ID
     I                                    P   2   50ZA0096
      * Message data for 'Load Shipped Can't Unlock'
      * Load Status
     I                                        1   1 ZA0097
      * Message data for 'Load Picked, Unlock Inval'
      * Load Status
     I                                        1   1 ZA0098
      * Message data for 'Unlock Inval, close exist'
      * *SFLSEL
     I                                        1   1 ZA0099
      * Message data for 'Order Not Assigned a load'
      * *SFLSEL
     I                                        1   1 ZA0100
      * Order Number
     I                                        2   8 ZA0101
      * Message data for 'Generic Message 80 ERR 2'
      * Generic Message 80 USR
     I                                        1  80 ZA0102
      * USR Status (Y/N)
     I                                       81  81 ZA0103
      * Message data for 'Generic Message 80 ERR 2'
      * Generic Message 80 USR
     I                                        1  80 ZA0104
      * USR Status (Y/N)
     I                                       81  81 ZA0105
      * Message data for 'Generic Message 80 ERR 2'
      * Generic Message 80 USR
     I                                        1  80 ZA0106
      * USR Status (Y/N)
     I                                       81  81 ZA0107
      * Message data for 'Ship Date after Deliv Dt'
      * Scheduled Ship Date
     I                                    P   1   40ZA0108
      * Message data for 'No Orders Assinged - INF'
      * Load ID
     I                                    P   1   40ZA0109
      * *SFLSEL
     I                                        5   5 ZA0110
      * Message data for 'Blck Ord on Ld-no UPD-INF'
      * *SFLSEL
     I                                        1   1 ZA0111
      * Load ID
     I                                    P   2   50ZA0112
      * Message data for 'Load Cant be Locked - INF'
      * *SFLSEL
     I                                        1   1 ZA0113
      * Load ID
     I                                    P   2   50ZA0114
      * Message data for 'Carrier must be ent.- INF'
      * Carrier Code
     I                                        1   3 ZA0115
      * Load ID
     I                                    P   4   70ZA0116
      * Message data for 'Truck size needed - INF'
      * Truck Size
     I                                        1   7 ZA0117
      * Load ID
     I                                    P   8  110ZA0118
      * Message data for 'Shipping Mthd req - INF'
      * Shipping Method
     I                                        1   2 ZA0119
      * Message data for 'Load has ords w/o stp-INF'
      * Load ID
     I                                    P   1   40ZA0120
      * Message data for 'Load is not accepted- INF'
      * Load ID
     I                                    P   1   40ZA0121
      * Message data for 'Load has Ords on Hold-INF'
      * Load ID
     I                                    P   1   40ZA0122
      * *SFLSEL
     I                                        5   5 ZA0123
      * Message data for 'Load has Cncld Ords - INF'
      * Load ID
     I                                    P   1   40ZA0124
      * *SFLSEL
     I                                        5   5 ZA0125
      * Message data for 'Load has Ords in Use-INF'
      * *SFLSEL
     I                                        1   1 ZA0126
      * Load ID
     I                                    P   2   50ZA0127
      * Message data for 'Order detail needs review'
      * *SFLSEL
     I                                        1   1 ZA0128
      * Load ID
     I                                    P   2   50ZA0129
      * Message data for 'Load Weight LT Minimum'
      * Load ID
     I                                    P   1   40ZA0130
      * Message data for 'Preliminary Pick Printing'
      * USR Warehouse Code
     I                                        1   3 ZA0131
      * USR CDE Parm 1
     I                                        4   6 ZA0132
      * USR CDE Parm 2
     I                                        7   9 ZA0133
      * USR CDE Parm 3
     I                                       10  12 ZA0134
      * USR CDE Parm 4
     I                                       13  15 ZA0135
      * USR CDE Parm 5
     I                                       16  18 ZA0136
      * USR CDE Parm 6
     I                                       19  21 ZA0137
      * USR CDE Parm 7
     I                                       22  24 ZA0138
      * USR CDE Parm 8
     I                                       25  27 ZA0139
      * USR CDE Parm 9
     I                                       28  30 ZA0140
      * Message data for 'Load Locked'
      * Load ID
     I                                    P   1   40ZA0141
      * Message data for 'Load is not accepted'
      * Load ID
     I                                    P   1   40ZA0142
      * Message data for 'Preliminary Pick Printing'
      * USR Warehouse Code
     I                                        1   3 ZA0143
      * USR CDE Parm 1
     I                                        4   6 ZA0144
      * USR CDE Parm 2
     I                                        7   9 ZA0145
      * USR CDE Parm 3
     I                                       10  12 ZA0146
      * USR CDE Parm 4
     I                                       13  15 ZA0147
      * USR CDE Parm 5
     I                                       16  18 ZA0148
      * USR CDE Parm 6
     I                                       19  21 ZA0149
      * USR CDE Parm 7
     I                                       22  24 ZA0150
      * USR CDE Parm 8
     I                                       25  27 ZA0151
      * USR CDE Parm 9
     I                                       28  30 ZA0152
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0153
      * Application Code
     I                                       11  16 ZA0154
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0155
      * Application Code
     I                                       11  16 ZA0156
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise & load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END                             OD W0RSF
     C                     END                             OD *HIVAL
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise and load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
      * USER: Initialize subfile control
      * First time processing
      * CASE: PAR.First Time Flag is Yes
     C           P2TAST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       P2TAST           First Time Flag
     C                     MOVEL'Y'       #2XJST           Production Hold
     C                     END                             *FI
      * CASE: CTL.Order Number is Not equal to zeros
     C           #2C4NB    IFNE *ZERO                      *IF
      * Rtv SchShpDte/Cust    RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2C4NB    WL0002           Order Number
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0001    #2AIC3           Company Number
     C                     MOVELWL0003    P5JNCD    P      Order Type_Sale
     C                     Z-ADDWL0004    P5BKC7           Ship To Custome
     C                     MOVELWL0005    P5HNNA    P      Ship To City
     C                     MOVELWL0006    P5DBCD    P      Ship To State C
     C                     MOVELWL0007    P5BCNA    P      Customer Purcha
     C                     Z-ADDWL0008    P5A0DT           Order Date
     C                     Z-ADDWL0009    P5A5DT           Requested Ship
     C                     MOVELWL0010    P5GWST    P      Header Status
     C                     Z-ADDWL0011    P5AODT           Scheduled Ship
     C                     MOVELWL0012    P5XIST    P      Credit Hold
     C                     MOVELWL0013    P5XJST    P      Production Hold
     C                     Z-ADDWL0014    P5EIDT           Requested Deliv
     C                     Z-ADDWL0015    P5RMNB           Load ID
     C                     Z-ADDP5AODT    #2AODT           Scheduled Ship
     C                     Z-ADDP5RMNB    #2RMNB           Load ID
     C                     END                             *FI
      * Position DBF file
     C           KPOS      KLIST
     C                     KFLD           BEAODT           Scheduled Ship
     C                     KFLD           BERMNB           Load ID
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD#2AODT    BEAODT
     C                     Z-ADD#2RMNB    BERMNB
     C                     Z-ADD#2C4NB    BEC4NB
     C           KPOS      SETLL@BFCPNR
     C                     READ @BFCPNR                8782*82=EOF
      * Save previous selector values
     C           *LIKE     DEFN #2XKST    WZXKST
     C                     MOVEL#2XKST    WZXKST           New Customer Ho
     C           *LIKE     DEFN #2AODT    WZAODT
     C                     MOVEL#2AODT    WZAODT           Scheduled Ship
     C           *LIKE     DEFN #2EIDT    WZEIDT
     C                     MOVEL#2EIDT    WZEIDT           Requested Deliv
     C           *LIKE     DEFN #2XJST    WZXJST
     C                     MOVEL#2XJST    WZXJST           Production Hold
     C           *LIKE     DEFN #2XIST    WZXIST
     C                     MOVEL#2XIST    WZXIST           Credit Hold
     C           *LIKE     DEFN #2BCST    WZBCST
     C                     MOVEL#2BCST    WZBCST           Block Order Fla
     C           *LIKE     DEFN #2RMNB    WZRMNB
     C                     MOVEL#2RMNB    WZRMNB           Load ID
     C           *LIKE     DEFN #2C4NB    WZC4NB
     C                     MOVEL#2C4NB    WZC4NB           Order Number
     C           *LIKE     DEFN #2AIC3    WZAIC3
     C                     MOVEL#2AIC3    WZAIC3           Company Number
     C           *LIKE     DEFN #2BKC7    WZBKC7
     C                     MOVEL#2BKC7    WZBKC7           Ship To Custome
      * Load subfile page
     C                     Z-ADD0         ##RROK  50
     C                     EXSR BBLDSF
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@BFCPNR                  90*
     C  N82                READ @BFCPNR                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVEL*ALL'0'   WKIND0  1
     C                     MOVEAWKIND0    *IN,42
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
      * Reset count of DBF records read
     C                     Z-ADD0         ##RRRD  90
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next SFL page until SFL page full, or
      * Scan limit reached
     C           *IN82     DOWEQ'0'                        DO
     C           ##RROK    ANDLT##SFLN
     C           ##RRRD    ANDLTW0SLM
      * Check selection fields - if fail, read next record
     C           #2XKST    IFNE *BLANK                     New Customer Ho
     C           BEXKST    CABNE#2XKST    BB020            New Customer Ho
     C                     END
     C           #2EIDT    IFNE *ZERO                      Requested Deliv
     C           BEEIDT    CABLT#2EIDT    BB020            Requested Deliv
     C                     END
     C           #2XJST    IFNE *BLANK                     Production Hold
     C           BEXJST    CABNE#2XJST    BB020            Production Hold
     C                     END
     C           #2XIST    IFNE *BLANK                     Credit Hold
     C           BEXIST    CABNE#2XIST    BB020            Credit Hold
     C                     END
     C           #2BCST    IFNE *BLANK                     Block Order Fla
     C           BEBCST    CABNE#2BCST    BB020            Block Order Fla
     C                     END
     C           #2AODT    IFEQ *ZERO                      Scheduled Ship
     C           #2RMNB    IFNE *ZERO                      Load ID
     C           BERMNB    CABLT#2RMNB    BB020            Load ID
     C                     END
     C                     END
     C           #2AODT    IFEQ *ZERO                      Scheduled Ship
     C           #2RMNB    OREQ *ZERO                      Load ID
     C           #2C4NB    IFNE *ZERO                      Order Number
     C           BEC4NB    CABLT#2C4NB    BB020            Order Number
     C                     END
     C                     END
     C           #2AIC3    IFNE *ZERO                      Company Number
     C           BEAIC3    CABNE#2AIC3    BB020            Company Number
     C                     END
     C           #2BKC7    IFNE *ZERO                      Ship To Custome
     C           BEBKC7    CABNE#2BKC7    BB020            Ship To Custome
     C                     END
      * Load SFL fields
     C                     EXSR MBFL#1
     C                     MOVEL'Y'       W0RSL   1
      * Allow for possible *Set Cursor processing
     C                     ADD  1         ##RR
      * USER: Initialize subfile record from DBF record
      * RST:  Company
      * CASE: CTL.Company Number NE WRK.ZERO
     C           #2AIC3    IFNE WUW0NB                     *IF
      * CASE: DB1.Company Number NE CTL.Company Number
     C           BEAIC3    IFNE #2AIC3                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * RTV UM/Whs Code        RT - Order Header TRG  * 
     C                     EXSR SBRVGN
      * RTV Type              RT - Order Header Extension  * 
     C                     EXSR SERVGN
      * RTV 1st Warehouse/Ctl  RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0019           Company Number
     C                     Z-ADD#1C4NB    WL0020           Order Number
     C                     Z-ADD*ZERO     WL0021           Order Sequence
     C                     Z-ADD*ZERO     WL0022           Order Secondary
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0023    #RAJCD    P      Warehouse Code
     C                     MOVELWL0024    #1XUST    P      Trans Contol AS
      * RST:  Warehouse
      * CASE: CTL.USR Warehouse Code is Warehouse Code not Blank
     C           #CCPCD    IFNE *BLANK                     *IF
      * CASE: RCD.Warehouse Code NE CTL.USR Warehouse Code
     C           #RAJCD    IFNE #CCPCD                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * RST:  Scheduled Ship Date/Load Id
      * CASE: CTL.Scheduled Ship Date NE WRK.ZERO
     C           #2AODT    IFNE WUW0NB                     *IF
      * CASE: DB1.Scheduled Ship Date NE CTL.Scheduled Ship Date
     C           BEAODT    IFNE #2AODT                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * RST:  Load ID
      * CASE: CTL.Load ID NE WRK.ZERO
     C           #2RMNB    IFNE WUW0NB                     *IF
      * CASE: DB1.Load ID NE CTL.Load ID
     C           BERMNB    IFNE #2RMNB                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Exclude Credit/Debit memos
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * exclude credit/debit memos
      * CASE: DB1.Billing Activity Type is Credit or Debit Memo
     C           BEOBST    IFEQ '2'                        *IF
     C           BEOBST    OREQ '3'
     C                     MOVEL'N'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVELBEXJST    #RAEST           USR Production
      * Init screen Credit hold to blank if No.
      * CASE: DB1.Credit Hold is No
     C           BEXIST    IFEQ 'N'                        *IF
     C                     MOVELWUGSTX    #1XIST           Credit Hold
     C                     END                             *FI
      * Init Prod hold to blank if No.
      * CASE: DB1.Production Hold is No
     C           BEXJST    IFEQ 'N'                        *IF
     C                     MOVELWUGSTX    #RAEST           USR Production
     C                     END                             *FI
      * RTV Ld Acc Fg/Sch seq no - Load Header  * 
     C                     EXSR SHRVGN
      * RTV Warehouse Type     RT - Warehouse  * 
     C                     EXSR SIRVGN
      * RTV Customer Name      RT - Customer  * 
     C                     EXSR SJRVGN
      * RTV Load Status        RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0025           Load ID
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0026    #RPKST    P      Load Status
      * RST:  Load Status
      * CASE: CTL.Load Status NE WRK.BLANK
     C           #CPKST    IFNE WUGSTX                     *IF
      * CASE: RCD.Load Status NE CTL.Load Status
     C           #RPKST    IFNE #CPKST                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * SFL Fold/Drop  RPG 2  US - /UT User Source  * 
     C           MODE      IFEQ '0'
     C                     SETON                     89
     C                     ELSE
     C                     SETOF                     89
     C                     ENDIF
      * RTV Ddln DprtDT/TM/Seq RT - Load Header  * 
     C                     EXSR SLRVGN
     C           WUAXTM    DIV  100       #RYBNB           Deadline Depart
     C                     SUB  1         ##RR
      * DBF record not selected
     C           W0RSL     CABNE'Y'       BB020
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Output to subfile
     C                     ADD  1         ##RR
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * Increment scan check count
     C                     ADD  1         ##RRRD
     C                     READ @BFCPNR                  82*82=EOF
     C                     END                             OD 1 - ##SFPG
      *................................................................
     C           BB900     TAG
      *................................................................
      * If no DBF records found, display error message
     C           ##RR      IFEQ *ZERO
     C           *IN82     ANDEQ'1'
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI ##RR = *ZERO
      *
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      * If scan limit reached, display error message
     C           ##RRRD    IFGE W0SLM
      * Send message '*Scan limit reached'
     C                     MOVEL'Y2U0017' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     ELSE
     C                     Z-ADD0         ##RROK
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     SETOF                       8392*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate Scheduled Ship Date
      * External date
     C                     Z-ADDV2AODT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     Z-ADDXDINDT    #2AODT
      * Validate Requested Delivery Date
      * External date
     C                     Z-ADDV2EIDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9933  *
     C                     END
     C                     Z-ADDXDINDT    #2EIDT
      * Validate Production Hold
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#2XJST'  IFEQ YPMTFD
      * Production Hold
     C                     MOVEL#2XJST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFXJST
     C                     SELEC
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD1         ZFXJST
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD2         ZFXJST
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD3         ZFXJST
     C                     ENDSL
     C                     EXFMTZEXJST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFXJST    WHEQ 1
     C                     MOVEL'Y'       W0INVL           Y
     C           ZFXJST    WHEQ 2
     C                     MOVEL'N'       W0INVL           N
     C           ZFXJST    WHEQ 3
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #2XJST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Credit Hold
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#2XIST'  IFEQ YPMTFD
      * Credit Hold
     C                     MOVEL#2XIST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFXIST
     C                     SELEC
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD1         ZFXIST
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD2         ZFXIST
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD3         ZFXIST
     C                     ENDSL
     C                     EXFMTZEXIST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFXIST    WHEQ 1
     C                     MOVEL'Y'       W0INVL           Y
     C           ZFXIST    WHEQ 2
     C                     MOVEL'N'       W0INVL           N
     C           ZFXIST    WHEQ 3
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #2XIST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Block Order Flag
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#2BCST    W0NSRQ  1        Block Order Fla
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#2BCST'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1447877   Y2LSNO  70
     C           #2BCST    PARM #2BCST    W0EXVL 25        Block Order Fla
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * Validate Load Status
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#CPKST    W0NSRQ  1        Load Status
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#CPKST'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1195931   Y2LSNO  70
     C           #CPKST    PARM #CPKST    W0EXVL 25        Load Status
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * Validate Order Number and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV2C4NB    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #2C4NB           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #2C4NB           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Company Number and convert to internal.
      * CD3 Ext/Int
     C                     MOVELV2AIC3    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC3  3
     C                     MOVEA*BLANKS   K3
     C                     Z-ADD3         C       30
     C                     Z-ADD3         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUDMCD    J3
     C                     MOVE *BLANKS   W0RTN
     C                     DO   3
     C           J3,C      IFNE ' '
     C                     MOVEAJ3,C      K3,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK3        JUSTC3
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC3    TESTC   1
     C           TESTC     IFGT '?'
     C           TESTC     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC3     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC3    WUDMCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Send message 'CD3 Non numeric data'
     C                     MOVEL'USR0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #2AIC3           CD3 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUDMCD    #2AIC3           CD3 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Ship To Customer and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV2BKC7    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #2BKC7           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #2BKC7           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      *................................................................
     C           YPMTFD    IFNE *BLANKS
     C           YPMRRN    ANDEQ*ZERO
     C                     GOTO DAEXIT
     C                     END
     C           YPMTFD    CABNE*BLANKS   DATAG1
      * Change of position specified
     C           WZAODT    CASNE#2AODT    FBRQRL
     C           WZEIDT    CASNE#2EIDT    FBRQRL
     C           WZXJST    CASNE#2XJST    FBRQRL
     C           WZXIST    CASNE#2XIST    FBRQRL
     C           WZBCST    CASNE#2BCST    FBRQRL
     C           WZRMNB    CASNE#2RMNB    FBRQRL
     C           WZC4NB    CASNE#2C4NB    FBRQRL
     C           WZAIC3    CASNE#2AIC3    FBRQRL
     C           WZBKC7    CASNE#2BKC7    FBRQRL
     C                     END
     C           DATAG1    TAG
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process subfile control (Pre-confirm)
     C                     MOVEL'N'       P1ECST           Error Status
     C                     MOVEL'Y'       W0DCF            *Defer confirm
      * F5=Refresh
      * CASE: CTL.*CMD key is *Refresh
     C           *IN05     IFEQ '1'                        *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * F8=Clear Selectors/Positioners
      * CASE: CTL.*CMD key is CF08
     C           *IN08     IFEQ '1'                        *IF
     C                     Z-ADD*ZERO     #2AODT           Scheduled Ship
     C                     MOVEL*BLANK    #CCPCD           USR Warehouse C
     C                     Z-ADD*ZERO     #2EIDT           Requested Deliv
     C                     MOVELWUGSTX    #2XJST           Production Hold
     C                     MOVELWUGSTX    #2XIST           Credit Hold
     C                     Z-ADD*ZERO     #2RMNB           Load ID
     C                     MOVELWUGSTX    #CPKST           Load Status
     C                     Z-ADD*ZERO     #2C4NB           Order Number
     C                     Z-ADD*ZERO     #2BKC7           Ship To Custome
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * F16=Product Availability (Only if not Live w/TPM)     E004119
      * CASE: CTL.*CMD key is CF16
     C           *IN16     IFEQ '1'                        *IF
      * WW Product Availablty DF - Company Item Avail Group  * 
     C                     CALL 'PDFPDFR'              90  WW Product Avai
     C                     PARM *BLANK    W0RTN   7
     C           #2AIC3    PARM #2AIC3    WQ0001  30       Company Number
     C                     PARM #CCPCD    WQ0002  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDFPDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     994032*
     C                     END
     C                     END                             *FI
      * F17=WW Load Plans        (Only if not Live w/TPM)     E004119
      * CASE: CTL.*CMD key is CF17
     C           *IN17     IFEQ '1'                        *IF
      * 10/97 pll OMS296:  changed to call a CL so can use QTEMP PDLNCPP
      * PRC Load Plans w/QTEMP UP - /UT User Programs  * 
     C                     CALL 'PDDNUPC'              90  PRC Load Plans
     C                     PARM 'OMPVDFR' WQ0003 10        USR Which Progr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDDNUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * F18=Print Order Acknowledgement
      * CASE: CTL.*CMD key is CF18
     C           *IN18     IFEQ '1'                        *IF
      * ** Pass blanks to Print Acknowledgements, it will check for acces
     C                     MOVEL*BLANK    WUCPCD           USR Warehouse C
      * PRT Acknowledgements   PV - Order Header TRG  * 
     C                     CALL 'PDJ4PVR'              90  PRT Acknowledge
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUCPCD    WQ0004  3        Warehouse Code
     C                     PARM '1'       WQ0005  1        Billing Activit
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDJ4PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * F19=Order Entry
      * CASE: CTL.*CMD key is CF19
     C           *IN19     IFEQ '1'                        *IF
      * CASE: CTL.Company Number is Equal to zero
     C           #2AIC3    IFEQ *ZERO                      *IF
      * Rtv SchShpDte/Cust    RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2C4NB    WL0002           Order Number
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0001    #2AIC3           Company Number
     C                     MOVELWL0003    P5JNCD    P      Order Type_Sale
     C                     Z-ADDWL0004    #2BKC7           Ship To Custome
     C                     MOVELWL0005    P5HNNA    P      Ship To City
     C                     MOVELWL0006    P5DBCD    P      Ship To State C
     C                     MOVELWL0007    P5BCNA    P      Customer Purcha
     C                     Z-ADDWL0008    P5A0DT           Order Date
     C                     Z-ADDWL0009    P5A5DT           Requested Ship
     C                     MOVELWL0010    P5GWST    P      Header Status
     C                     Z-ADDWL0011    #2AODT           Scheduled Ship
     C                     MOVELWL0012    #2XIST    P      Credit Hold
     C                     MOVELWL0013    #2XJST    P      Production Hold
     C                     Z-ADDWL0014    #2EIDT           Requested Deliv
     C                     Z-ADDWL0015    #2RMNB           Load ID
     C                     END                             *FI
      * WW Cust/Order Inq O.E. DF - Order Header TRG  * 
     C                     CALL 'PDSJDFR'              90  WW Cust/Order I
     C                     PARM *BLANK    W0RTN   7
     C           #2AIC3    PARM #2AIC3    WQ0006  30       Company Number
     C           #2BKC7    PARM #2BKC7    WQ0007  70       Ship To Custome
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDSJDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     994041*
     C                     END
     C                     END                             *FI
      * F10=Work With Detail
      * CASE: CTL.*CMD key is CF10
     C           *IN10     IFEQ '1'                        *IF
      * CASE: CTL.Order Number is Equal to zeros
     C           #2C4NB    IFEQ *ZERO                      *IF
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0001           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0001           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order Number must be ente'
     C                     MOVEL'USR1936' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: CTL.Company Number is Equal to zero
     C           #2AIC3    IFEQ *ZERO                      *IF
      * Rtv SchShpDte/Cust    RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2C4NB    WL0002           Order Number
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0001    #2AIC3           Company Number
     C                     MOVELWL0003    P5JNCD    P      Order Type_Sale
     C                     Z-ADDWL0004    #2BKC7           Ship To Custome
     C                     MOVELWL0005    P5HNNA    P      Ship To City
     C                     MOVELWL0006    P5DBCD    P      Ship To State C
     C                     MOVELWL0007    P5BCNA    P      Customer Purcha
     C                     Z-ADDWL0008    P5A0DT           Order Date
     C                     Z-ADDWL0009    P5A5DT           Requested Ship
     C                     MOVELWL0010    P5GWST    P      Header Status
     C                     Z-ADDWL0011    #2AODT           Scheduled Ship
     C                     MOVELWL0012    #2XIST    P      Credit Hold
     C                     MOVELWL0013    #2XJST    P      Production Hold
     C                     Z-ADDWL0014    #2EIDT           Requested Deliv
     C                     Z-ADDWL0015    #2RMNB           Load ID
     C                     END                             *FI
      * WW Prod Order Hold Dtl DF - Order Detail  * 
     C                     CALL 'PDO2DFR'              90  WW Prod Order H
     C                     PARM *BLANK    W0RTN   7
     C           #2AIC3    PARM #2AIC3    WQ0008  30       Company Number
     C           #2C4NB    PARM #2C4NB    WQ0009  70       Order Number
     C           P5JNCD    PARM P5JNCD    WQ0010  2        Order Type_Sale
     C                     PARM P5HNNA    WQ0011 20        Ship To City
     C                     PARM P5DBCD    WQ0012  2        Ship To State C
     C                     PARM P5BCNA    WQ0013 15        Customer Purcha
     C                     PARM P5A0DT    WQ0014  70       Order Date
     C           P5A5DT    PARM P5A5DT    WQ0015  70       Requested Ship
     C           P5GWST    PARM P5GWST    WQ0016  1        Header Status
     C           P5AODT    PARM P5AODT    WQ0017  70       Scheduled Ship
     C           P5XIST    PARM P5XIST    WQ0018  1        Credit Hold
     C           P5XJST    PARM P5XJST    WQ0019  1        Production Hold
     C           P5EIDT    PARM P5EIDT    WQ0020  70       Requested Deliv
     C                     PARM P5RMNB    WQ0021  70       Load ID
     C           P2DNCD    PARM P2DNCD    WQ0022  6        Application Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDO2DFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     994039*
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END                             *FI
      * F20=Print Inventory Journal
      * CASE: CTL.*CMD key is CF20
     C           *IN20     IFEQ '1'                        *IF
     C                     MOVEL@CN,002   WUBNVN           USR Program nam
     C                     MOVEL@CN,003   WUBQVN           USR Program Nam
      * PRT Inventory Trans Jr PV - Calendar  * 
     C                     CALL 'ICQGPVR'              90  PRT Inventory T
     C                     PARM *BLANK    W0RTN   7
     C           WUBNVN    PARM WUBNVN    WQ0023 10        USR Program nam
     C           WUBQVN    PARM WUBQVN    WQ0024 10        USR Program Nam
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ICQGPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * F4 Prompt Select Ship to Customer
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> CTL.Ship To Customer
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ 'V2BKC7'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Cust/ShpTo Flag 'Y'SR - Customer  * 
     C                     CALL 'PDYSSRR'              90  SEL Cust/ShpTo
     C                     PARM *BLANK    W0RTN   7
     C           #2BKC7    PARM #2BKC7    WQ0025  70       Ship To Custome
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYSSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9941  *
     C                     END
     C                     END                             *FI
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * Reload subfile requested
     C           W0RSF     CABEQ'Y'       DAEXIT
     C                     END
     C           *IN81     IFEQ '1'
      * Process subfile records
     C                     EXSR DBPRSF
     C                     END
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * USER: Final processing (Pre-confirm)
      * CASE: PAR.Error Status is yes
     C           P1ECST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
     C                     MOVEL'*YES'    P6XFST           Display Prt Opt
      * If error, quit processing
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPRCF
      * Exit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO DAEXIT
     C                     END
      * Process subfile (pass 2)
     C                     EXSR EAPRSF
      * If error during 2nd pass exit:
     C           *IN99     CABEQ'1'       DAEXIT
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
      * Process subfile record
     C                     EXSR DCPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Setof error indicators and SFLNXTCHG
     C                     MOVEAWKIND0    *IN,42
     C                     SETOF                     98    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C           YPMTFD    CABNE*BLANKS   DCEXIT
      * SFLNXTCHG
     C                     SETON                     84
      * USER: Process subfile record (Pre-confirm)
      * Ensure that we're using fresh data
     C                     EXSR UASUBR                     Ensure that we'
      * 2=Edit Order Scheduled Ship Date and Warehouse
      * CASE: RCD.*SFLSEL is *Edit
     C           #1SEL     IFEQ '2'                        *IF
     C           #1SEL     OREQ ' 2'
      * Validate Option
      * CASE: RCD.Order in Use is yes
     C           #1GJST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0002           *SFLSEL
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0003           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0003           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order in use detail'
     C                     MOVEL'USR0664' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     MOVEL'Y'       P1ECST           Error Status
     C                     ELSE
      * CASE: RCD.Header Status is Cancelled
     C           #1GWST    IFEQ 'X'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0004           *SFLSEL
      * Send message 'Order has been Cancelled'
     C                     MOVEL'USR2341' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     MOVEL'Y'       P1ECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * Validate Load Status
      * CASE: RCD.Load ID is NE Blank
     C           #1RMNB    IFNE *ZERO                      *IF
      * 08/19/08 PKD We shouldn't be changing ship date if on a load.
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0005           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0005           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order On Load Opt Invald'
     C                     MOVEL'USR2331' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Access Limited parm is No so dates will not be edited  W288
      * EDT Schd Shp Dte/Whse  E1 - Order Header TRG  * 
     C                     CALL 'PDLQE1R'              90  EDT Schd Shp Dt
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0026  30       Company Number
     C                     PARM #1C4NB    WQ0027  70       Order Number
     C                     PARM P2HHST    WQ0028  1        Access Limited
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDLQE1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     Z-ADD#1C4NB    #2C4NB           Order Number
     C                     Z-ADD#1AIC3    #2AIC3           Company Number
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 5=WW Prod Order Hold Detail
      * CASE: RCD.*SFLSEL is *Order Inquiry
     C           #1SEL     IFEQ '5'                        *IF
     C           #1SEL     OREQ ' 5'
      * CASE: RCD.Order in Use is yes
     C           #1GJST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0006           *SFLSEL
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0007           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0007           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order in use detail'
     C                     MOVEL'USR0664' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     MOVEL'Y'       P1ECST           Error Status
     C                     ELSE
      * CASE: RCD.Header Status is Cancelled
     C           #1GWST    IFEQ 'X'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0008           *SFLSEL
      * Send message 'Order has been Cancelled'
     C                     MOVEL'USR2341' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     MOVEL'Y'       P1ECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    P2DNCD           Application Cod
     C                     MOVEL'P/S'     P2DNCD           Application Cod
      * WW Prod Order Hold Dtl DF - Order Detail  * 
     C                     CALL 'PDO2DFR'              90  WW Prod Order H
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0029  30       Company Number
     C           #1C4NB    PARM #1C4NB    WQ0030  70       Order Number
     C           #1JNCD    PARM #1JNCD    WQ0031  2        Order Type_Sale
     C                     PARM #1HNNA    WQ0032 20        Ship To City
     C                     PARM #1DBCD    WQ0033  2        Ship To State C
     C                     PARM #1BCNA    WQ0034 15        Customer Purcha
     C                     PARM #1A0DT    WQ0035  70       Order Date
     C           #1A5DT    PARM #1A5DT    WQ0036  70       Requested Ship
     C           #1GWST    PARM #1GWST    WQ0037  1        Header Status
     C           #1AODT    PARM #1AODT    WQ0038  70       Scheduled Ship
     C           #1XIST    PARM #1XIST    WQ0039  1        Credit Hold
     C           #1XJST    PARM #1XJST    WQ0040  1        Production Hold
     C           #1EIDT    PARM #1EIDT    WQ0041  70       Requested Deliv
     C                     PARM #1RMNB    WQ0042  70       Load ID
     C           P2DNCD    PARM P2DNCD    WQ0043  6        Application Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDO2DFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL##USR     P2AJVN           User Profile Na
      * CASE: PGM.*Return code is No Update Occurred
     C           W0RTN     IFEQ 'NOUPD'                    *IF
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 6=Print Acknowledgment
      * CASE: RCD.*SFLSEL is Option 6
     C           #1SEL     IFEQ '6'                        *IF
     C           #1SEL     OREQ ' 6'
      * Print Prompt
      * CASE: PAR.Display Prt Opt Pmt USR is *YES
     C           P6XFST    IFEQ '*YES'                     *IF
      * PMT Prt Opt w/PSz SHR  PV - Print Options  * 
     C                     CALL 'PDV8PVR'              90  PMT Prt Opt w/P
     C                     PARM *BLANK    W0RTN   7
     C                     PARM @CN,004   WQ0044 25        PRT Description
     C           P6WRST    PARM P6WRST    WQ0045 10        PRT Printer Dev
     C           P6WSST    PARM P6WSST    WQ0046  4        PRT Hold Output
     C           P6WTST    PARM P6WTST    WQ0047  4        PRT Save Output
     C           P6DYNB    PARM P6DYNB    WQ0048  20       PRT Number of C
     C           P6WUST    PARM P6WUST    WQ0049  1        PRT Night Queue
     C           P6BVVN    PARM P6BVVN    WQ0050 10        PRT Night Queue
     C                     PARM P2DNCD    WQ0051  6        Application Cod
     C                     PARM '1'       WQ0052  1        Paper Type USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDV8PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ @CN,005                    *IF
     C                     MOVEL'N'       P7FLST           USR Process sta
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       P7FLST           USR Process sta
     C                     END                             *FI
     C                     MOVEL*BLANK    P6XFST           Display Prt Opt
     C                     MOVEL'*NO'     P6XFST           Display Prt Opt
     C                     END                             *FI
      * Submit Print
      * CASE: PAR.USR Process status is yes
     C           P7FLST    IFEQ 'Y'                        *IF
     C                     Z-ADD#1AIC3    WUATNB           Company Number
     C                     Z-ADDWUATNB    WUAJAA           Company Number
     C                     Z-ADD#1C4NB    WUAJAE           Order Number 1
     C                     Z-ADD#1C4NB    WUAJAF           Order Number 2
     C                     Z-ADD0         WUAJAB           Date 1
     C                     Z-ADD*ZERO     WUAJAC           Date 2
     C                     Z-ADD0         WULVNX           Date 3
     C                     Z-ADD0         WUAJAG           Thru Date Pass
      * 0412/2013 prt ack was promoted these parms at this time
      * on the warehouse will go with nothing in them
      * Setup message data for message
     C                     Z-ADDWUAJAA    ZA0009           Company Number
     C                     Z-ADDWUAJAE    ZA0010           Order Number 1
     C                     Z-ADDWUAJAF    ZA0011           Order Number 2
     C                     Z-ADDWUAJAB    ZA0012           Date 1
     C                     Z-ADDWUAJAC    ZA0013           Date 2
     C                     Z-ADDWUAJAG    ZA0014           Thru Date Pass
     C                     MOVEL#1JNCD    ZA0015           Order Type_Sale
     C                     MOVELWUOTTX    ZA0016           Blank for 4
     C                     MOVEL#1OBST    ZA0017           Billing Activit
     C                     MOVEL'A'       ZA0018           Export Sales
     C                     MOVEL#CCPCD    ZA0019           USR Warehouse C
     C                     MOVEL*BLANK    ZA0020           USR CDE Parm 1
     C                     MOVEL*BLANK    ZA0021           USR CDE Parm 2
     C                     MOVEL*BLANK    ZA0022           USR CDE Parm 3
     C                     MOVEL*BLANK    ZA0023           USR CDE Parm 4
     C                     MOVEL*BLANK    ZA0024           USR CDE Parm 5
     C                     MOVEL*BLANK    ZA0025           USR CDE Parm 6
     C                     MOVEL*BLANK    ZA0026           USR CDE Parm 7
     C                     MOVEL*BLANK    ZA0027           USR CDE Parm 8
     C                     MOVEL*BLANK    ZA0028           USR CDE Parm 9
     C                     MOVEL'S'       ZA0029           USR Select/Omit
     C                     MOVELP6WRST    ZA0030           PRT Printer Dev
     C                     MOVELP6WSST    ZA0031           PRT Hold Output
     C                     MOVELP6WTST    ZA0032           PRT Save Output
     C                     Z-ADDP6DYNB    ZA0033           PRT Number of C
     C                     MOVELP6BVVN    ZA0034           PRT Night Queue
     C                     Z-ADDWULVNX    ZA0035           Date 3
     C                     MOVELWUTCTX    ZA0036           Byte
     C                     MOVEL*BLANK    ZA0037           Email to Wareho
     C                     MOVEL'N'       ZA0038           Email to Salesp
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR2360' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     9832  *
     C                     END
      *
     C                     END                             *FI
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     END                             *FI
      * 7=Reallocate Order
      * CASE: RCD.*SFLSEL is Option 7
     C           #1SEL     IFEQ '7'                        *IF
     C           #1SEL     OREQ ' 7'
      * Validate Option
      * CASE: RCD.Order in Use is yes
     C           #1GJST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0039           *SFLSEL
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0040           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0040           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order in use detail'
     C                     MOVEL'USR0664' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     MOVEL'Y'       P1ECST           Error Status
     C                     ELSE
      * CASE: RCD.Header Status is Cancelled
     C           #1GWST    IFEQ 'X'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0041           *SFLSEL
      * Send message 'Order has been Cancelled'
     C                     MOVEL'USR2341' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     MOVEL'Y'       P1ECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * Validate Load Status
      * CASE: RCD.Load ID is NE Blank
     C           #1RMNB    IFNE *ZERO                      *IF
      * CASE: RCD.Load Status is Locked thru Invoiced
     C           #RPKST    IFEQ 'I'                        *IF
     C           #RPKST    OREQ 'L'
     C           #RPKST    OREQ 'S'
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0042           *SFLSEL
      * Send message 'Load Locked Opt Invalid'
     C                     MOVEL'USR2308' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     MOVEL'Y'       P1ECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 8=Unpick Order           * 10/04/07 RMC
      * CASE: RCD.*SFLSEL is Option 8
     C           #1SEL     IFEQ '8'                        *IF
     C           #1SEL     OREQ ' 8'
      * CASE:
      *  - c1 AND c2
      *   |- c1    : RCD.Header Status is Avail/Alloc/Enter/Hold
      *   |- c2    : RCD.Event Code is 03 Picked
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1GWST    IFEQ 'L'                        *IF
     C           #1GWST    OREQ 'A'
     C           #1GWST    OREQ 'E'
     C           #1GWST    OREQ 'H'
     C           #1JPCD    IFEQ '03'                       *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PMT Unpick Order      PV - Order Header TRG  * 
     C                     CALL 'PMOHPVR'              90  PMT Unpick Orde
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0053  30       Company Number
     C                     PARM #1C4NB    WQ0054  70       Order Number
     C                     PARM #1RMNB    WQ0055  70       Load ID
     C           YL0004    PARM *BLANK    WQ0056  1        Status Flag 2
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMOHPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE: LCL.Status Flag 2  Y/N is Yes
     C           YL0004    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0043           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0043           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order has been unpicked'
     C                     MOVEL'USR3817' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: RCD.Event Code is Entered Thru 02 Load Plan
     C           #1JPCD    IFGE '01'                       *IF
     C           #1JPCD    ANDLE'02'
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0044           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0044           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order not picked.opt n/a'
     C                     MOVEL'USR3816' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     MOVEL'Y'       P1ECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0045           *SFLSEL
      * Send message 'Order Canc/Conf/Complete'
     C                     MOVEL'USR2324' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     MOVEL'Y'       P1ECST           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 9=Edit Load Plan           08/24/16 E4119 RMC
      * CASE: RCD.*SFLSEL is Option 9
     C           #1SEL     IFEQ '9'                        *IF
     C           #1SEL     OREQ ' 9'
     C                     MOVEL'N'       YL0005           Status Flag 14
      * Live with TMSLDP check  -- cant do for any orders
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.PFS Carlisle Active is Yes
      *   |- c2    : LCL.PFS AccuSort Active is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0006    IFEQ 'Y'                        *IF
     C           YL0007    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0005           Status Flag 14
     C                     END                             *FI
      * Live with TMSLDP, DOM/EX only.
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.PFS Carlisle Active is Yes
      *   |- c2    : LCL.PFS AccuSort Active is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0006    IFEQ 'Y'                        *IF
     C           YL0007    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: RCD.OHE Override Type Code is ES
     C           #RCHTX    IFEQ 'ES'                       *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       YL0005           Status Flag 14
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Access Limited Sts USR is yes
     C           P2HHST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0046           *SFLSEL
      * Send message 'Not Authorized to Option'
     C                     MOVEL'USR3412' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     ELSE
      * CASE: RCD.Block Order Flag is Block Order
     C           #1BCST    IFEQ 'B'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0047           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0048           Load ID
      * Send message 'Block Orders on Ld-no UPD'
     C                     MOVEL'USR2441' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     ELSE
      * CASE: RCD.Load Status is Shipped or Invoiced
     C           #RPKST    IFEQ 'I'                        *IF
     C           #RPKST    OREQ 'S'
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0049           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0050           Load ID
      * Send message 'Load Status inv for Chg'
     C                     MOVEL'USR2278' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     ELSE
      * CASE: RCD.Load Status is Lock
     C           #RPKST    IFEQ 'L'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0051           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0052           Load ID
      * Send message 'Load Status inv for Chg'
     C                     MOVEL'USR2278' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     ELSE
      * CASE: RCD.MG Created Load is Yes
     C           #RRYSX    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0053           *SFLSEL
      * Send message 'Live TMS Option Invalid'
     C                     MOVEL'USR4601' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     ELSE
      * CASE: LCL.Status Flag 14 Y/N is Yes
     C           YL0005    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0054           *SFLSEL
      * Send message 'Live TMS Option Invalid'
     C                     MOVEL'USR4601' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Unrestricted access - allows any editing of dates   W288
      * Edt Load Plan          DF - Order Header TRG  * 
     C                     CALL 'OMQ6DFR'              90  Edt Load Plan
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0057  30       Company Number
     C           #1RMNB    PARM #1RMNB    WQ0058  70       Load ID
     C                     PARM #RPKST    WQ0059  1        Load Status
     C           WUD4ST    PARM WUD4ST    WQ0060  1        USR Update Flag
     C                     PARM P2HHST    WQ0061  1        Access Limited
     C           WUB2VN    PARM WUB2VN    WQ0062 10        Job Name CDE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMQ6DFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
      * *Set Cursor: RCD.*SFLSEL  (*Override=*NO)
     C                     Z-ADD##RR      W0RR0
     C           ##RR      DIV  ##SFPG    W0ROW0
     C                     MVR            W0ROW0
     C           W0ROW0    IFEQ 0
     C           ##SFPG    SUB  1         W0ROW0
     C                     ELSE
     C                     SUB  1         W0ROW0
     C                     END
     C                     MULT 002       W0ROW0
     C                     ADD  011       W0ROW0
     C                     Z-ADD002       W0COL0
     C                     MOVEL'0'       W0OVR0           *NO
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 10=Release Order
      * CASE: RCD.*SFLSEL is Option 10
     C           #1SEL     IFEQ '10'                       *IF
      * Rtv Sts/InUse/Evt/etc RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0027           Company Number
     C                     Z-ADD#1C4NB    WL0028           Order Number
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0029    #1GJST    P      Order in Use
     C                     MOVELWL0030    #1GWST    P      Header Status
     C                     MOVELWL0031    #1XIST    P      Credit Hold
     C                     MOVELWL0032    #1XJST    P      Production Hold
     C                     MOVELWL0033    #1JPCD    P      Event Code
      * CASE: RCD.Order in Use is yes
     C           #1GJST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0055           *SFLSEL
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0056           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0056           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order in use detail'
     C                     MOVEL'USR0664' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     MOVEL'Y'       P1ECST           Error Status
     C                     ELSE
      * CASE: RCD.Header Status is Confirmed
     C           #1GWST    IFEQ 'R'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0057           *SFLSEL
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0058           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0058           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order shipped; opt inv.'
     C                     MOVEL'USR2481' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     MOVEL'Y'       P1ECST           Error Status
     C                     ELSE
      * CASE: RCD.Header Status is Cancelled
     C           #1GWST    IFEQ 'X'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0059           *SFLSEL
      * Send message 'Order has been Cancelled'
     C                     MOVEL'USR2341' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     MOVEL'Y'       P1ECST           Error Status
     C                     ELSE
      * CASE: RCD.Production Hold is No
     C           #1XJST    IFEQ 'N'                        *IF
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0060           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0060           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVEL#1SEL     ZA0061           *SFLSEL
      * Send message 'Order Not on Prod Hold'
     C                     MOVEL'USR1922' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     MOVEL'Y'       P1ECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #1XJST           Production Hold
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 11=Hold Order
      * CASE: RCD.*SFLSEL is Option 11
     C           #1SEL     IFEQ '11'                       *IF
      * Rtv Sts/InUse/Evt/etc RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0027           Company Number
     C                     Z-ADD#1C4NB    WL0028           Order Number
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0029    #1GJST    P      Order in Use
     C                     MOVELWL0030    #1GWST    P      Header Status
     C                     MOVELWL0031    #1XIST    P      Credit Hold
     C                     MOVELWL0032    #1XJST    P      Production Hold
     C                     MOVELWL0033    #1JPCD    P      Event Code
      * CASE: RCD.Order in Use is yes
     C           #1GJST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0062           *SFLSEL
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0063           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0063           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order in use detail'
     C                     MOVEL'USR0664' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     MOVEL'Y'       P1ECST           Error Status
     C                     ELSE
      * CASE: RCD.Header Status is Confirmed
     C           #1GWST    IFEQ 'R'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0064           *SFLSEL
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0065           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0065           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order shipped; opt inv.'
     C                     MOVEL'USR2481' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     MOVEL'Y'       P1ECST           Error Status
     C                     ELSE
      * CASE: RCD.Header Status is Cancelled
     C           #1GWST    IFEQ 'X'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0066           *SFLSEL
      * Send message 'Order has been Cancelled'
     C                     MOVEL'USR2341' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     MOVEL'Y'       P1ECST           Error Status
     C                     ELSE
      * CASE: RCD.Production Hold is Yes
     C           #1XJST    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0067           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0067           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVEL#1SEL     ZA0068           *SFLSEL
      * Send message 'Order already on prd hold'
     C                     MOVEL'USR2086' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     MOVEL'Y'       P1ECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * Validate Load Status
      * CASE: RCD.Load ID is NE Blank
     C           #1RMNB    IFNE *ZERO                      *IF
      * CASE: PAR.Load Status is Locked thru Invoiced
     C           P4PKST    IFEQ 'I'                        *IF
     C           P4PKST    OREQ 'L'
     C           P4PKST    OREQ 'S'
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0069           *SFLSEL
      * Send message 'Load Locked Opt Invalid'
     C                     MOVEL'USR2308' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     MOVEL'Y'       P1ECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       #1XJST           Production Hold
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       #1XJST           Production Hold
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     MOVEL'Y'       #1XJST           Production Hold
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 12=Edit Load/Orders
      * CASE: RCD.*SFLSEL is Option 12
     C           #1SEL     IFEQ '12'                       *IF
      * 08/18/08 PKD S00408 Validate the entire Load instead of just the
      *              order being processed.
      * Validate
      * CASE: RCD.Load ID is Blank
     C           #1RMNB    IFEQ *ZERO                      *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0070           *SFLSEL
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0071           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0071           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order Not Assigned a load'
     C                     MOVEL'USR1874' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     MOVEL'Y'       P1ECST           Error Status
     C                     ELSE
      * CASE: RCD.Load Status is Locked thru Invoiced
     C           #RPKST    IFEQ 'I'                        *IF
     C           #RPKST    OREQ 'L'
     C           #RPKST    OREQ 'S'
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0072           *SFLSEL
      * Send message 'Load Locked Opt Invalid'
     C                     MOVEL'USR2308' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     MOVEL'Y'       P1ECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv InUse/Sts for Ld  RT - Order Header TRG  * 
     C                     EXSR SORVGN
      * CASE: LCL.Access Denied (Y/N) is yes
     C           YL0008    IFEQ 'Y'                        *IF
      * Send message 'Load InUse/Conf ERR'
     C                     MOVEL'USR3997' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     MOVEL'Y'       P1ECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Pass order number to Edit Load/Orders        E00438
      * ** Access Limited parm is No so dates will not be edited    W288
      * Edt Load/Orders        DF - Order Header TRG  * 
     C                     CALL 'PDLTDFR'              90  Edt Load/Orders
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1C4NB    WQ0063  70       Order Number
     C                     PARM #1RMNB    WQ0064  70       Load ID
     C                     PARM #1AODT    WQ0065  70       Scheduled Ship
     C                     PARM WUADTX    WQ0066 30        Name
     C                     PARM P2HHST    WQ0067  1        Access Limited
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDLTDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     Z-ADD#1RMNB    #2RMNB           Load ID
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 13=Lock Load
      * CASE: RCD.*SFLSEL is Option 13
     C           #1SEL     IFEQ '13'                       *IF
      * RTV Load Status        RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0025           Load ID
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0026    YL0009    P      Load Status
      * CASE: LCL.Load Status is Lock
     C           YL0009    IFEQ 'L'                        *IF
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Don't allow lock if errors pending in Order Detail  P001251
      *
     C                     MOVEL*BLANK    WN0001  1        Load Status
     C                     Z-ADD*ZERO     WN0002  70       Total Load Orde
     C                     MOVEL*BLANK    WN0003  3        Carrier Code
     C                     MOVEL*BLANK    WN0004  7        Truck Size
     C                     MOVEL*BLANK    WN0005  2        Shipping Method
     C                     MOVEL*BLANK    WN0006  1        Load Acceptance
     C                     MOVEL*BLANK    WN0007  1        Block Order Fla
      *
      * EDT Lock Load Edit     IF
      * RTV Load for Load Plan RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0034           Load ID
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0035    WUAODT           Scheduled Ship
     C                     MOVELWL0036    WN0001    P      Load Status
     C                     Z-ADDWL0037    WURNNB           Reefer Temperat
     C                     Z-ADDWL0038    WN0002           Total Load Orde
     C                     Z-ADDWL0039    WUFLAM           Flat Amount
     C                     MOVELWL0040    WUXQST    P      Allocate Pounds
     C                     MOVELWL0041    WN0003    P      Carrier Code
     C                     MOVELWL0042    WN0004    P      Truck Size
     C                     Z-ADDWL0043    WUR1NB           Rated Freight
     C                     MOVELWL0044    WUVDST    P      Load Type
     C                     Z-ADDWL0045    WUT4NB           Schedule Sequen
     C                     Z-ADDWL0046    WUTLMI           Total Load Mile
     C                     MOVELWL0047    WN0005    P      Shipping Method
     C                     MOVELWL0048    WUVPCD    P      Ship From Wareh
     C                     MOVELWL0049    WUDBCD    P      Ship To State C
     C                     MOVELWL0050    WUXCCD    P      Carrier Broker
     C                     MOVELWL0051    WN0006    P      Load Acceptance
     C                     Z-ADDWL0052    WUK2DT           Override Total
     C                     MOVELWL0053    WUWRTX    P      Shipping Temp C
      * RTV Any Ord/Blk  on Ld RT - PD Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0054           Load ID
     C                     MOVELWN0007    WL0056    P      Block Order Fla
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0055    WUJDST    P      USR Check Y/N S
     C                     MOVELWL0056    WN0007    P      Block Order Fla
      * ** Don't allow lock if errors pending in Order Detail  P001251
      *
     C                     Z-ADD*ZERO     WN0008  70       Maximum pounds
     C                     Z-ADD*ZERO     WN0009  70       Minimum pounds
     C                     MOVEL*BLANK    WN0010  1        USR Orders on L
     C                     MOVEL*BLANK    WN0011  1        Order in Use
     C                     MOVEL*BLANK    WN0012  1        Header Status
     C                     MOVEL*BLANK    WN0013  1        Access Denied (
      *
      * EDT Lock Load Edits    IF
      * assume will have error
     C                     MOVEL'Y'       P1ECST           Error Status
      *
     C                     MOVEL*BLANK    WN0014 10        User Profile Na
      *
      * VAL Set Int.Acc No Hdg IF
     C                     MOVEL##USR     WN0014           User Profile Na
      *
     C                     MOVEL*BLANK    WN0015 10        User Code Model
      *
      * VAL User/Appl No Exit  IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0014    WL0057    P      User Profile Na
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0058    WUG0TX    P      Allow Multi_Com
     C                     MOVELWL0059    WUG0TX    P      Default Printer
     C                     MOVELWL0060    WUG0TX    P      Salesperson Cod
     C                     Z-ADDWL0061    YL0010           Company Number
     C                     MOVELWL0062    WN0015    P      User Code Model
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,006                    *IF
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0015    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0014    WL0063    P      User Profile Na
     C                     MOVEL'LOCKLD'  WL0064    P      Application Cod
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0065    WUAIC3           Company Number
     C                     MOVELWL0066    YL0011    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0015    WL0063    P      User Profile Na
     C                     MOVEL'LOCKLD'  WL0064    P      Application Cod
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0065    WUAIC3           Company Number
     C                     MOVELWL0066    YL0011    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0011    WUG0TX           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: LCL.Company Number is greater than zero
     C           YL0010    IFGT 0                          *IF
     C                     Z-ADDYL0010    WUAIC3           Company Number
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0011    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0012    WL0068           Shipping Compan
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0067    WUG0TX    P      Warehouse Code
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWUAIC3    WUNFNN           Company Number
     C                     MOVELWUWVST    WN0013           Access Denied (
      * If access denied is no, rtv co. name
      * CASE: WRK.Access Denied (Y/N) is no
     C           WUWVST    IFEQ 'N'                        *IF
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0069           Company Number
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0070    WUG0TX    P      Name
     C                     END                             *FI
      * CASE: PAR.Access Denied (Y/N) is yes
     C           WN0013    IFEQ 'Y'                        *IF
      * Send message 'User Cant Lock/Unlock Ld'
     C                     MOVEL'USR2468' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * VAL no Stop Entered    RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0071           Load ID
     C                     EXSR SVRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0072    WN0010    P      Status - Y or N
      * Validate lock request
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,006                    *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0073           Load ID
     C                     MOVEL#1SEL     ZA0074           *SFLSEL
      * Send message 'No Orders Assigned'
     C                     MOVEL'USR1276' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     ELSE
      * CASE: PAR.Block Order Flag is Block Order
     C           WN0007    IFEQ 'B'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0075           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0076           Load ID
      * Send message 'Block Orders on Ld-no UPD'
     C                     MOVEL'USR2441' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     ELSE
      * CASE: PAR.Load Status is Locked thru Invoiced
     C           WN0001    IFEQ 'I'                        *IF
     C           WN0001    OREQ 'L'
     C           WN0001    OREQ 'S'
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0077           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0078           Load ID
      * Send message 'Load Cant be Locked'
     C                     MOVEL'USR2189' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     ELSE
      * CASE: PAR.Carrier Code EQ WRK.BLANK
     C           WN0003    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVELWN0003    ZA0079           Carrier Code
     C                     Z-ADD#1RMNB    ZA0080           Load ID
      * Send message 'Carrier must be entered'
     C                     MOVEL'USR1253' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: PAR.Truck Size EQ WRK.BLANK
     C           WN0004    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVELWN0004    ZA0081           Truck Size
     C                     Z-ADD#1RMNB    ZA0082           Load ID
      * Send message 'Truck size must be enter'
     C                     MOVEL'USR1255' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: PAR.Shipping Method EQ WRK.BLANK
     C           WN0005    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVELWN0005    ZA0083           Shipping Method
      * Send message 'Shipping Method required'
     C                     MOVEL'USR2197' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: PAR.USR Orders on Load is yes
     C           WN0010    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0084           Load ID
      * Send message 'Load has orders w/o stop'
     C                     MOVEL'USR2196' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: PAR.Load Acceptance Flag is Load not Accepted
     C           WN0006    IFEQ 'U'                        *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0085           Load ID
      * Send message 'Load is not accepted'
     C                     MOVEL'USR2514' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Hold, Use-by load  RT - OP Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0075           Load ID
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0073    WN0011    P      Order in Use
     C                     MOVELWL0074    WN0012    P      Header Status
      * Error if held/cancelled/in use order(s) on load
      * CASE: PAR.Header Status is Hold
     C           WN0012    IFEQ 'H'                        *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0086           Load ID
     C                     MOVEL#1SEL     ZA0087           *SFLSEL
      * Send message 'Load has Orders on Hold'
     C                     MOVEL'USR1921' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     ELSE
      * CASE: PAR.Header Status is Cancelled
     C           WN0012    IFEQ 'X'                        *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0088           Load ID
     C                     MOVEL#1SEL     ZA0089           *SFLSEL
      * Send message 'Load has Cancelled Orders'
     C                     MOVEL'USR2236' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     ELSE
      * CASE: PAR.Order in Use is yes
     C           WN0011    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0090           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0091           Load ID
      * Send message 'Load has Orders in Use'
     C                     MOVEL'USR2280' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Check if Export Order Automation Upload had errors  P001251
      * RTV Ord Requires Revw RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0076           Load ID
     C                     EXSR SXRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0077    YL0013    P      Order Requires
      * ** Cannot lock if Upload had errors                  P001251
      * CASE: LCL.Order Requires Review is Yes
     C           YL0013    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0092           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0093           Load ID
      * Send message 'Order detail needs review'
     C                     MOVEL'USR4464' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Min & Max Pounds  RT - OM Truck Size  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0004    WL0078    P      Truck Size
     C                     EXSR SYRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0079    WN0008           Maximum pounds
     C                     Z-ADDWL0080    WN0009           Minimum pounds
      * Check minimum and maximum pounds
      * CASE: PAR.Total Weight LT PAR.Minimum pounds
     C           WN0002    IFLT WN0009                     *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0094           Load ID
      * Send message 'Load Weight LT Minimum'
     C                     MOVEL'USR1262' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       P1ECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Total Weight GT PAR.Maximum pounds
     C           WN0002    IFGT WN0008                     *IF
      * Send message 'Load weight exceeds Truck'
     C                     MOVEL'USR2231' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       P1ECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Locking load pending'
     C                     MOVEL'USR1273' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       P1ECST           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ***** Change Log and Comments
     C                     EXSR UBSUBR                     ***** Change Lo
      * Set confirm if error
      * CASE: PAR.Error Status is yes
     C           P1ECST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 14=Unlock Load
      * CASE: RCD.*SFLSEL is Option 14
     C           #1SEL     IFEQ '14'                       *IF
      *
     C                     MOVEL*BLANK    WN0016  1        Load Status
     C                     MOVEL*BLANK    WN0017  1        Block Order Fla
      *
      * EDT Unlock Load Edit   IF
      * RTV Load Status        RT - OM Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0025           Load ID
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0026    WN0016    P      Load Status
      * RTV Any Ord/Blk  on Ld RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0054           Load ID
     C                     MOVELWN0017    WL0056    P      Block Order Fla
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0055    WUJDST    P      USR Check Y/N S
     C                     MOVELWL0056    WN0017    P      Block Order Fla
      * RMC PFS017 6/5/6 new par.allow unlock if picked = N
      *
     C                     MOVEL*BLANK    WN0018  1        Access Denied (
      *
      * EDT Unlock Load Edits  IF
      * assume will have error
     C                     MOVEL'Y'       P1ECST           Error Status
      *
     C                     MOVEL*BLANK    WN0019 10        User Profile Na
      *
      * VAL Set Int.Acc No Hdg IF
     C                     MOVEL##USR     WN0019           User Profile Na
      *
     C                     MOVEL*BLANK    WN0020 10        User Code Model
      *
      * VAL User/Appl No Exit  IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0019    WL0057    P      User Profile Na
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0058    WUG0TX    P      Allow Multi_Com
     C                     MOVELWL0059    WUG0TX    P      Default Printer
     C                     MOVELWL0060    WUG0TX    P      Salesperson Cod
     C                     Z-ADDWL0061    YL0010           Company Number
     C                     MOVELWL0062    WN0020    P      User Code Model
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,006                    *IF
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0020    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0019    WL0063    P      User Profile Na
     C                     MOVEL'LOCKLD'  WL0064    P      Application Cod
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0065    WUAIC3           Company Number
     C                     MOVELWL0066    YL0011    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0020    WL0063    P      User Profile Na
     C                     MOVEL'LOCKLD'  WL0064    P      Application Cod
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0065    WUAIC3           Company Number
     C                     MOVELWL0066    YL0011    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0011    WUG0TX           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: LCL.Company Number is greater than zero
     C           YL0010    IFGT 0                          *IF
     C                     Z-ADDYL0010    WUAIC3           Company Number
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0011    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0012    WL0068           Shipping Compan
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0067    WUG0TX    P      Warehouse Code
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWUAIC3    WUNFNN           Company Number
     C                     MOVELWUWVST    WN0018           Access Denied (
      * If access denied is no, rtv co. name
      * CASE: WRK.Access Denied (Y/N) is no
     C           WUWVST    IFEQ 'N'                        *IF
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0069           Company Number
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0070    WUG0TX    P      Name
     C                     END                             *FI
      * check the entry control field too.  4/28/05 so christa can do.
      * Rtv Unlock Load Authr RT - Entry Control  * 
     C                     EXSR SZRVGN
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Access Denied (Y/N) is yes
      *   |- c2    : WRK.Unlock Load Authority is Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0018    IFEQ 'Y'                        *IF
     C           WUHTST    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Send message 'User Cant Lock/Unlock Ld'
     C                     MOVEL'USR2468' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * If load has been shipped, can't unlock. RMC Chg for picked 5/31/0
      * CASE: PAR.Block Order Flag is Block Order
     C           WN0017    IFEQ 'B'                        *IF
      *   (load contains a block order)
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0095           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0096           Load ID
      * Send message 'Block Orders on Ld-no UPD'
     C                     MOVEL'USR2441' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     ELSE
      * CASE: PAR.Load Status is Shipped or Invoiced
     C           WN0016    IFEQ 'I'                        *IF
     C           WN0016    OREQ 'S'
      * Setup message data for message
     C                     MOVELWN0016    ZA0097           Load Status
      * Send message 'Load Shipped Can't Unlock'
     C                     MOVEL'USR1272' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * **** Determine if Load has been picked, if yes do not allow unloc
      * **** This function checks OP Order Events & AS Picked Acknowledgm
      * CASE: PAR.Allow Unlock if Picked St is No
     C           'N'       IFEQ 'N'                        *IF
      * Do this one if par is NO. We dont want an UNLOCK if there are XOx
      *   and it isnt shipping doing it.
      * RTV Load Order Picked  XF - AS Order Header  * 
     C                     CALL 'PDQVXFR'              90  RTV Load Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0068  70       Load ID
     C                     PARM #1AIC3    WQ0069  30       Company Number
     C           WUZMST    PARM WUZMST    WQ0070  1        Pick Status USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * PFS Val Order Picked  RT - PFS Ship Load/Order Sts  * 
     C                     EXSR TARVGN
     C                     END                             *FI
      * Allow if picked but not Close Order or Close Truck  5/31/06
      * CASE: WRK.Pick Status USR is Picked
     C           WUZMST    IFEQ 'Y'                        *IF
      * CASE: PAR.Allow Unlock if Picked St is No
     C           'N'       IFEQ 'N'                        *IF
      * Setup message data for message
     C                     MOVELWN0016    ZA0098           Load Status
      * Send message 'Load Picked, Unlock Inval'
     C                     MOVEL'USR1999' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * PFS Val Close Ord/Trk XF - PFS Ship Load/Order Sts  * 
     C                     CALL 'PPYIXFR'              90  PFS Val Close O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0071  70       Load ID
     C           WUB8ST    PARM *BLANK    WQ0072  1        Status - Y or N
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPYIXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE: WRK.Status - Y or N is yes
     C           WUB8ST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0099           *SFLSEL
      * Send message 'Unlock Inval, close exist'
     C                     MOVEL'USR3629' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Unlock Load Pending'
     C                     MOVEL'USR1274' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       P1ECST           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Unlock Load Pending'
     C                     MOVEL'USR1274' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       P1ECST           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Set confirm if error
      * CASE: PAR.Error Status is yes
     C           P1ECST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
      * 15=Remove Ord f/Load                          W98652 DN 01/30/23
      * CASE: RCD.*SFLSEL is Option 15
     C           #1SEL     IFEQ '15'                       *IF
      * CASE: RCD.Load ID is Blank
     C           #1RMNB    IFEQ *ZERO                      *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0100           *SFLSEL
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0101           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0101           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order Not Assigned a load'
     C                     MOVEL'USR1874' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     MOVEL'Y'       P1ECST           Error Status
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: *OTHERWISE
      * Val Allow to Rmv Order RT - Order Header TRG  * 
     C                     EXSR TBRVGN
      * Validations.
      * CASE: *OTHERWISE
      * Only single Order exist, do NOT allow update.
      * CASE: LCL.Count USR is One
     C           YL0016    IFEQ 1                          *IF
     C                     MOVEL*BLANK    YL0017           Generic Message
     C                     Z-ADD1         ZQ      50
     C           @CN,007   CAT  @CN,008:ZQYL0017    P      Generic Message
      * Setup message data for message
     C                     MOVELYL0017    ZA0102           Generic Message
     C                     MOVEL#1SEL     ZA0103           *SFLSEL
      * Send message 'Generic Message 80 ERR 2'
     C                     MOVEL'USR5085' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
      * All Orders have been Shipped, do NOT allow update.
      * CASE: LCL.Header Status is Confirmed
     C           YL0014    IFEQ 'R'                        *IF
     C                     MOVEL*BLANK    YL0017           Generic Message
     C                     Z-ADD*ZERO     ZQ      50
     C           @CN,009   CAT  @CN,010:ZQYL0017    P      Generic Message
      * Setup message data for message
     C                     MOVELYL0017    ZA0104           Generic Message
     C                     MOVEL#1SEL     ZA0105           *SFLSEL
      * Send message 'Generic Message 80 ERR 2'
     C                     MOVEL'USR5085' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
      * Proceed if Order is in A/E/H Status & Allow to Remove Order=Y.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Header Status is Avail/Entered/Held
      *   |- c2    : LCL.Allow to Remove Order USR is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0014    IFEQ 'A'                        *IF
     C           YL0014    OREQ 'E'
     C           YL0014    OREQ 'H'
     C           YL0015    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0017           Generic Message
     C                     Z-ADD*ZERO     ZQ      50
     C           @CN,011   CAT  @CN,012:ZQYL0017    P      Generic Message
      * Setup message data for message
     C                     MOVELYL0017    ZA0106           Generic Message
     C                     MOVEL#1SEL     ZA0107           *SFLSEL
      * Send message 'Generic Message 80 ERR 2'
     C                     MOVEL'USR5085' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ** Ship date cannot be after delivery date    FP1251 LJB 01/16/20
      * CASE: RCD.Scheduled Ship Date GT RCD.Requested Delivery Date
     C           #1AODT    IFGT #1EIDT                     *IF
      * Setup message data for message
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #1AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0108
      * Send message 'Ship Date after Deliv Dt'
     C                     MOVEL'USR3881' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     END                             FI *IN98
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         DHPRCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#SFLCTL
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         EAPRSF    BEGSR
      *================================================================
      * Update DBF from subfile
      *================================================================
     C           *IN81     IFEQ '1'
      * Process all modified subfile records
     C                     READC#SFLRCD                  92*
     C           *IN92     DOWEQ'0'
      * Process modified subfile record
     C                     EXSR EBPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END                             WOD *92
     C                     END                             FI *81
      * If any errors, cancel reload
     C           *IN99     IFEQ '1'
     C                     MOVEL'N'       W0RSF   1
     C                     END
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPRSR    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,42
     C                     SETOF                     98
      * USER: Process subfile record (Post-confirm)
      * Send message 'Processing'
     C                     MOVEL'USR2303' ZAMSID
     C                     MOVEL'*EXT '   ZAPGRL           Rel queue
     C                     MOVEL'*STATUS' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
      * 7=Reallocate Order
      * CASE: RCD.*SFLSEL is Option 7
     C           #1SEL     IFEQ '7'                        *IF
     C           #1SEL     OREQ ' 7'
      * Rtv ReAlc/AlcAsOrd ATS RT - Order Detail  * 
     C                     EXSR TCRVGN
      * ** If there are upload errors still pending, clear them   C001956
      * CHG Ord Req Revw- flg CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0086           Company Number
     C                     Z-ADD#1C4NB    WL0087           Order Number
     C                     MOVEL*BLANK    WL0088           Order Requires
     C                     EXSR TFCHRC
      * CHG Ord Line Error Typ RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0089           Company Number
     C                     Z-ADD#1C4NB    WL0090           Order Number
     C                     Z-ADD1         WL0091           Order Sequence
     C                     Z-ADD1         WL0092           Order Secondary
     C                     EXSR TGRVGN
      * FP1054 Create RLCORD
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPARC
     C                     Z-ADD#1RMNB    PARMNB           Load ID
     C                     Z-ADD*ZERO     PARVNB           Stop_Drop
     C                     MOVEL'RLCORD'  PARVST    P      Load Change Typ
     C                     MOVEL'SLS'     PAUJST    P      Department Cont
     C                     MOVEL*BLANK    PAMNTX    P      Change Log Prio
     C                     MOVEL*BLANK    PAMOTX    P      Change Log New
     C                     MOVEL##USR     PAAYNA    P      User Id
     C                     MOVEL##PGM     PAA0NA    P      Job Name
     C                     MOVEL#1BZNA    PABZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PAAIC3           Company Number
     C                     Z-ADD#1C4NB    PAC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * 10=Release Production hold -- RMC 02/26/07 this is RELEASE only
      * CASE: RCD.*SFLSEL is Option 10
     C           #1SEL     IFEQ '10'                       *IF
      * hdr sts
      * CASE: RCD.Credit Hold is Yes
     C           #1XIST    IFEQ 'Y'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#1GWST    #1GXST           Header Status L
     C                     MOVEL'A'       #1GWST           Header Status
     C                     END                             *FI
     C                     MOVEL#1XJST    #RAEST           USR Production
      * FP1054 Create RLSORD
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPARC
     C                     Z-ADD#1RMNB    PARMNB           Load ID
     C                     Z-ADD*ZERO     PARVNB           Stop_Drop
     C                     MOVEL'RLSORD'  PARVST    P      Load Change Typ
     C                     MOVEL'SLS'     PAUJST    P      Department Cont
     C                     MOVEL'Y'       PAMNTX    P      Change Log Prio
     C                     MOVEL'N'       PAMOTX    P      Change Log New
     C                     MOVEL##USR     PAAYNA    P      User Id
     C                     MOVEL##PGM     PAA0NA    P      Job Name
     C                     MOVEL#1BZNA    PABZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PAAIC3           Company Number
     C                     Z-ADD#1C4NB    PAC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * FP1054 Create RLSLIN and chg details
      * RTV Check Sch to Rlsd RT - Order Detail  * 
     C                     EXSR TIRVGN
      * *
      * CHG Prd Hld, Sts,Rsn   CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0093           Company Number
     C                     Z-ADD#1C4NB    WL0094           Order Number
     C                     MOVEL#1CQCD    WL0095    P      Reason Code
     C                     MOVEL#1GWST    WL0096    P      Header Status
     C                     MOVEL#1GXST    WL0097    P      Header Status L
     C                     MOVEL'N'       WL0098    P      Production Hold
     C                     EXSR TJCHRC
      * ** If possible Lock Load when Prod Hold is released - RMC 02/26/0
      * ** Don't lock if errors pending in Order Detail   LJB 9/20/11 P00
     C                     MOVEL'N'       WUATUS           STATUS
      * CHG Ord Req Revw- flg CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0086           Company Number
     C                     Z-ADD#1C4NB    WL0087           Order Number
     C                     MOVEL*BLANK    WL0088           Order Requires
     C                     EXSR TFCHRC
      * CHG Ord Line Error Typ RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0089           Company Number
     C                     Z-ADD#1C4NB    WL0090           Order Number
     C                     Z-ADD1         WL0091           Order Sequence
     C                     Z-ADD1         WL0092           Order Secondary
     C                     EXSR TGRVGN
      *
     C                     MOVEL*BLANK    WN0647  1        Load Status
     C                     Z-ADD*ZERO     WN0648  70       Total Load Orde
     C                     MOVEL*BLANK    WN0649  3        Carrier Code
     C                     MOVEL*BLANK    WN0650  7        Truck Size
     C                     MOVEL*BLANK    WN0651  2        Shipping Method
     C                     MOVEL*BLANK    WN0652  1        Load Acceptance
     C                     MOVEL*BLANK    WN0653  1        Block Order Fla
      *
      * EDT Lock Load Edit/INF IF
      * ** Chk for ord detail errors still pending  9.20.2011 P001251 LJB
      * ** Chg lock option override sts to *job date chk   8.23.09 E00495
      * ** Add lock option override sts for sched ship date chk  7.24.09
      * ** Add Override Total Load Miles - WRK context     E00207 8/13/08
      * RTV Load for Load Plan RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0034           Load ID
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0035    WUAODT           Scheduled Ship
     C                     MOVELWL0036    WN0647    P      Load Status
     C                     Z-ADDWL0037    WURNNB           Reefer Temperat
     C                     Z-ADDWL0038    WN0648           Total Load Orde
     C                     Z-ADDWL0039    WUFLAM           Flat Amount
     C                     MOVELWL0040    WUXQST    P      Allocate Pounds
     C                     MOVELWL0041    WN0649    P      Carrier Code
     C                     MOVELWL0042    WN0650    P      Truck Size
     C                     Z-ADDWL0043    WUR1NB           Rated Freight
     C                     MOVELWL0044    WUVDST    P      Load Type
     C                     Z-ADDWL0045    WUT4NB           Schedule Sequen
     C                     Z-ADDWL0046    WUTLMI           Total Load Mile
     C                     MOVELWL0047    WN0651    P      Shipping Method
     C                     MOVELWL0048    WUVPCD    P      Ship From Wareh
     C                     MOVELWL0049    WUDBCD    P      Ship To State C
     C                     MOVELWL0050    WUXCCD    P      Carrier Broker
     C                     MOVELWL0051    WN0652    P      Load Acceptance
     C                     Z-ADDWL0052    WUK2DT           Override Total
     C                     MOVELWL0053    WUWRTX    P      Shipping Temp C
      * RTV Any Ord/Blk  on Ld RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0054           Load ID
     C                     MOVELWN0653    WL0056    P      Block Order Fla
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0055    WUJDST    P      USR Check Y/N S
     C                     MOVELWL0056    WN0653    P      Block Order Fla
      *
     C                     Z-ADD*ZERO     WN0654  70       Maximum pounds
     C                     Z-ADD*ZERO     WN0655  70       Minimum pounds
     C                     MOVEL*BLANK    WN0656  1        USR Orders on L
     C                     MOVEL*BLANK    WN0657  1        Order in Use
     C                     MOVEL*BLANK    WN0658  1        Header Status
     C                     MOVEL*BLANK    WN0659  1        Access Denied (
      *
      * EDT Lock Load Edits-INFIF
      * assume will have error
     C                     MOVEL'Y'       P1ECST           Error Status
      *
     C                     MOVEL*BLANK    WN0660 10        User Profile Na
      *
      * VAL Set Int.Acc No Hdg IF
     C                     MOVEL##USR     WN0660           User Profile Na
      *
     C                     MOVEL*BLANK    WN0661 10        User Code Model
      *
      * VAL User/Appl No Exit  IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0660    WL0057    P      User Profile Na
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0058    WUG0TX    P      Allow Multi_Com
     C                     MOVELWL0059    WUG0TX    P      Default Printer
     C                     MOVELWL0060    WUG0TX    P      Salesperson Cod
     C                     Z-ADDWL0061    YL0010           Company Number
     C                     MOVELWL0062    WN0661    P      User Code Model
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,006                    *IF
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0661    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0660    WL0063    P      User Profile Na
     C                     MOVEL'LOCKLD'  WL0064    P      Application Cod
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0065    WUAIC3           Company Number
     C                     MOVELWL0066    YL0011    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0661    WL0063    P      User Profile Na
     C                     MOVEL'LOCKLD'  WL0064    P      Application Cod
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0065    WUAIC3           Company Number
     C                     MOVELWL0066    YL0011    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0011    WUG0TX           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: LCL.Company Number is greater than zero
     C           YL0010    IFGT 0                          *IF
     C                     Z-ADDYL0010    WUAIC3           Company Number
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0011    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0012    WL0068           Shipping Compan
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0067    WUG0TX    P      Warehouse Code
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWUAIC3    WUNFNN           Company Number
     C                     MOVELWUWVST    WN0659           Access Denied (
      * If access denied is no, rtv co. name
      * CASE: WRK.Access Denied (Y/N) is no
     C           WUWVST    IFEQ 'N'                        *IF
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0069           Company Number
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0070    WUG0TX    P      Name
     C                     END                             *FI
      * CASE: PAR.Access Denied (Y/N) is yes
     C           WN0659    IFEQ 'Y'                        *IF
      * Send message 'Usr Cant Lock/Unlk Ld-INF'
     C                     MOVEL'USR2543' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * VAL no Stop Entered    RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0071           Load ID
     C                     EXSR SVRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0072    WN0656    P      Status - Y or N
      * Validate lock request
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,006                    *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0109           Load ID
     C                     MOVEL#1SEL     ZA0110           *SFLSEL
      * Send message 'No Orders Assinged - INF'
     C                     MOVEL'USR2544' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.Block Order Flag is Block Order
     C           WN0653    IFEQ 'B'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0111           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0112           Load ID
      * Send message 'Blck Ord on Ld-no UPD-INF'
     C                     MOVEL'USR2545' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.Load Status is Locked thru Invoiced
     C           WN0647    IFEQ 'I'                        *IF
     C           WN0647    OREQ 'L'
     C           WN0647    OREQ 'S'
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0113           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0114           Load ID
      * Send message 'Load Cant be Locked - INF'
     C                     MOVEL'USR2546' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Carrier Code EQ WRK.BLANK
      *   |- c2    : PAR.STATUS is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0649    IFEQ WUGSTX                     *IF
     C           WUATUS    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVELWN0649    ZA0115           Carrier Code
     C                     Z-ADD#1RMNB    ZA0116           Load ID
      * Send message 'Carrier must be ent.- INF'
     C                     MOVEL'USR2547' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.Truck Size EQ WRK.BLANK
     C           WN0650    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVELWN0650    ZA0117           Truck Size
     C                     Z-ADD#1RMNB    ZA0118           Load ID
      * Send message 'Truck size needed - INF'
     C                     MOVEL'USR2548' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.Shipping Method EQ WRK.BLANK
     C           WN0651    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVELWN0651    ZA0119           Shipping Method
      * Send message 'Shipping Mthd req - INF'
     C                     MOVEL'USR2549' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.USR Orders on Load is yes
     C           WN0656    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0120           Load ID
      * Send message 'Load has ords w/o stp-INF'
     C                     MOVEL'USR2550' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.Load Acceptance Flag is Load not Accepted
     C           WN0652    IFEQ 'U'                        *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0121           Load ID
      * Send message 'Load is not accepted- INF'
     C                     MOVEL'USR2551' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Hold, Use-by load  RT - PD Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0075           Load ID
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0073    WN0657    P      Order in Use
     C                     MOVELWL0074    WN0658    P      Header Status
      * Error if held/cancelled/in use order(s) on load
      * CASE: PAR.Header Status is Hold
     C           WN0658    IFEQ 'H'                        *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0122           Load ID
     C                     MOVEL#1SEL     ZA0123           *SFLSEL
      * Send message 'Load has Ords on Hold-INF'
     C                     MOVEL'USR2552' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.Header Status is Cancelled
     C           WN0658    IFEQ 'X'                        *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0124           Load ID
     C                     MOVEL#1SEL     ZA0125           *SFLSEL
      * Send message 'Load has Cncld Ords - INF'
     C                     MOVEL'USR2553' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.Order in Use is yes
     C           WN0657    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0126           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0127           Load ID
      * Send message 'Load has Ords in Use-INF'
     C                     MOVEL'USR2554' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Ord Requires Revw RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0076           Load ID
     C                     EXSR SXRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0077    YL0018    P      Order Requires
      * ** Check for errors in Export Order Automation Upload   P001251
      * CASE: LCL.Order Requires Review is Yes
     C           YL0018    IFEQ 'Y'                        *IF
      * ** Cannot lock load if errors in Order Detail         P001251
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0128           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0129           Load ID
      * Send message 'Order detail needs review'
     C                     MOVEL'USR4464' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Min & Max Pounds  RT - OM Truck Size  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0650    WL0078    P      Truck Size
     C                     EXSR SYRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0079    WN0654           Maximum pounds
     C                     Z-ADDWL0080    WN0655           Minimum pounds
      * Do not want to lock the load if the Load Weight is not
      * within range.  -Purva 5/5/99 C0007042
      * Check minimum and maximum pounds
      * CASE: PAR.Total Weight LT PAR.Minimum pounds
     C           WN0648    IFLT WN0655                     *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0130           Load ID
      * Send message 'Load Weight LT Minimum'
     C                     MOVEL'USR1262' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       P1ECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Total Weight GT PAR.Maximum pounds
     C           WN0648    IFGT WN0654                     *IF
      * Send message 'Load weight exceeds Truck'
     C                     MOVEL'USR2231' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       P1ECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * Check Sched ship date if not called from a LOCK option  FP1054 7/
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Lock option override sts is No
      *   |- c2    : PAR.Scheduled Ship Date GT JOB.*Job date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           'N'       IFEQ 'N'                        *IF
     C           WUAODT    IFGT ##JDT                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       P1ECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Locking load pending'
     C                     MOVEL'USR1273' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       P1ECST           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ***** Change Log and Comments
     C                     EXSR UCSUBR                     ***** Change Lo
      *  Lock Load if no errors
      * CASE: PAR.Error Status is no
     C           P1ECST    IFEQ 'N'                        *IF
      * RTV Load Status        RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0025           Load ID
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0026    WUPKST    P      Load Status
      *
     C                     Z-ADD*ZERO     WN0662  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0663 112       Flat Amount
     C                     Z-ADD*ZERO     WN0664  50       Total Stops
     C                     Z-ADD*ZERO     WN0665  70       Total Load Mile
     C                     MOVEL*BLANK    WN0666  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0667  2        Ship To State C
     C                     MOVEL*BLANK    WN0668  3        Carrier Broker
     C                     MOVEL*BLANK    WN0669  1        Export Status
     C                     MOVEL*BLANK    WN0670  3        Shipping Line
     C                     MOVEL*BLANK    WN0671 20        Port Delv Termi
     C                     Z-ADD*ZERO     WN0672  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0673  60       Deadline Depart
     C                     MOVEL*BLANK    WN0674  1        MG Created Load
     C                     MOVEL*BLANK    WN0675  2        Load U_M
     C                     MOVEL*BLANK    WN0676  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0677 20        Destination Cit
     C                     MOVEL*BLANK    WN0678  2        State Code
     C                     MOVEL*BLANK    WN0679  3        USR Warehouse C
     C                     MOVEL*BLANK    WN0680  3        USR CDE Parm 1
     C                     MOVEL*BLANK    WN0681  3        USR CDE Parm 2
     C                     MOVEL*BLANK    WN0682  3        USR CDE Parm 3
     C                     MOVEL*BLANK    WN0683  3        USR CDE Parm 4
     C                     MOVEL*BLANK    WN0684  3        USR CDE Parm 5
     C                     MOVEL*BLANK    WN0685  3        USR CDE Parm 6
     C                     MOVEL*BLANK    WN0686  3        USR CDE Parm 7
     C                     MOVEL*BLANK    WN0687  3        USR CDE Parm 8
     C                     MOVEL*BLANK    WN0688  3        USR CDE Parm 9
     C                     Z-ADD*ZERO     WN0689 155       Company Number
     C                     Z-ADD*ZERO     WN0690 155       Date 1
     C                     Z-ADD*ZERO     WN0691 155       Order Number 1
     C                     Z-ADD*ZERO     WN0692  40       Requested Deliv
     C                     MOVEL*BLANK    WN0693  7        Return Code Usr
      *
      * UPD Lock Load Update   IF
      * RTV Load Header All,Mg RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0099           Load ID
     C                     EXSR TKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0100    WN0662           Scheduled Ship
     C                     MOVELWL0101    WUG0TX    P      LTL Flag
     C                     MOVELWL0102    WUG0TX    P      Load Status
     C                     Z-ADDWL0103    WUNFNN           Reefer Temperat
     C                     MOVELWL0104    WUG0TX    P      Seal 1
     C                     MOVELWL0105    WUG0TX    P      Seal 2
     C                     MOVELWL0106    WUG0TX    P      Seal 3
     C                     Z-ADDWL0107    WUNFNN           Total Load Orde
     C                     Z-ADDWL0108    WN0663           Flat Amount
     C                     MOVELWL0109    WUG0TX    P      Allocate Pounds
     C                     Z-ADDWL0110    WN0664           Total Stops
     C                     MOVELWL0111    WUG0TX    P      Trailer Id
     C                     MOVELWL0112    WUG0TX    P      Transloader Car
     C                     Z-ADDWL0113    WUNFNN           BOL Time
     C                     MOVELWL0114    WUG0TX    P      Carrier Code
     C                     MOVELWL0115    WUG0TX    P      Truck Size
     C                     Z-ADDWL0116    WUNFNN           Ld Hdr_Ld Dtl U
     C                     Z-ADDWL0117    WUNFNN           Rated Freight
     C                     MOVELWL0118    WUG0TX    P      Ship Status
     C                     MOVELWL0119    WUG0TX    P      Load Type
     C                     Z-ADDWL0120    WUNFNN           Number Pallets
     C                     Z-ADDWL0121    WUNFNN           Number Pallets
     C                     Z-ADDWL0122    WUNFNN           Load Carrier Pa
     C                     Z-ADDWL0123    WUNFNN           Estimated Arriv
     C                     Z-ADDWL0124    WUNFNN           Actual Arrival
     C                     Z-ADDWL0125    WUNFNN           Actual Arrival
     C                     Z-ADDWL0126    WUNFNN           Trailer IN Weig
     C                     Z-ADDWL0127    WUNFNN           Trailer OUT Wei
     C                     Z-ADDWL0128    WUNFNN           Actual Departur
     C                     Z-ADDWL0129    WUNFNN           Departure Time
     C                     Z-ADDWL0130    WUNFNN           Schedule Sequen
     C                     Z-ADDWL0131    WUNFNN           Product Tempera
     C                     Z-ADDWL0132    WUNFNN           Number Spacers
     C                     MOVELWL0133    WUG0TX    P      Car_Veh_Initial
     C                     Z-ADDWL0134    WN0665           Total Load Mile
     C                     MOVELWL0135    WUG0TX    P      Recorder ID
     C                     MOVELWL0136    WUG0TX    P      Shipping Method
     C                     MOVELWL0137    WN0666    P      Ship From Wareh
     C                     MOVELWL0138    WN0667    P      Ship To State C
     C                     Z-ADDWL0139    WUNFNN           Gross Weight
     C                     MOVELWL0140    WN0668    P      Carrier Broker
     C                     MOVELWL0141    WN0669    P      Export Status
     C                     Z-ADDWL0142    WUNFNN           Actual Ship Dat
     C                     MOVELWL0143    WUG0TX    P      On Time_Y_N
     C                     Z-ADDWL0144    WUNFNN           Truck Ready Dat
     C                     Z-ADDWL0145    WUNFNN           Truck Ready Tim
     C                     Z-ADDWL0146    WUNFNN           Spotted Date
     C                     Z-ADDWL0147    WUNFNN           Spotted Time
     C                     Z-ADDWL0148    WUNFNN           Load Finished D
     C                     Z-ADDWL0149    WUNFNN           Load Finished T
     C                     Z-ADDWL0150    WUNFNN           BOL Complete Da
     C                     Z-ADDWL0151    WUNFNN           BOL Complete Ti
     C                     Z-ADDWL0152    WUNFNN           BOL Received Da
     C                     Z-ADDWL0153    WUNFNN           BOL Received Ti
     C                     Z-ADDWL0154    WUNFNN           Truck Departure
     C                     Z-ADDWL0155    WUNFNN           Truck Departure
     C                     Z-ADDWL0156    WUNFNN           Adjusted Depart
     C                     Z-ADDWL0157    WUNFNN           Adjusted Depart
     C                     MOVELWL0158    WUG0TX    P      Shipping Line
     C                     MOVELWL0159    WUG0TX    P      Port Delv Termi
     C                     MOVELWL0160    WUG0TX    P      Vessel Name
     C                     Z-ADDWL0161    WUNFNN           Voyage
     C                     Z-ADDWL0162    WUNFNN           Sail Date
     C                     MOVELWL0163    WUG0TX    P      Booking Number
     C                     MOVELWL0164    WUG0TX    P      Discharge Port
     C                     Z-ADDWL0165    WUNFNN           Arrival Date
     C                     MOVELWL0166    WUG0TX    P      Container Numbe
     C                     Z-ADDWL0167    WUNFNN           Date In
     C                     Z-ADDWL0168    WUNFNN           Time In
     C                     Z-ADDWL0169    WUNFNN           Date Out
     C                     Z-ADDWL0170    WUNFNN           Time Out
     C                     Z-ADDWL0171    WUNFNN           Load Total Frei
     C                     Z-ADDWL0172    WUNFNN           Scheduled Deliv
     C                     Z-ADDWL0173    WUNFNN           Scheduled Deliv
     C                     MOVELWL0174    WUG0TX    P      LH Unused Sts
     C                     Z-ADDWL0175    WUNFNN           On Yard Date
     C                     Z-ADDWL0176    WUNFNN           On Yard Time
     C                     Z-ADDWL0177    WN0672           Deadline Depart
     C                     Z-ADDWL0178    WN0673           Deadline Depart
     C                     MOVELWL0179    WN0674    P      MG Created Load
      * .** Use carr appt dt/tm, if entered, for DDD/T calcs   E00495
      * Fill in ship from whse deadline depart, if locking load and none
      * CASE: PAR.Ship From Warehouse EQ WRK.BLANK
     C           WN0666    IFEQ WUGSTX                     *IF
      * Rtv/Chg Whs,ld miles  RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0180           Load ID
     C                     EXSR TLRVGN
      * CASE: PAR.MG Created Load is Not MG Created Load
     C           WN0674    IFEQ *BLANK                     *IF
      * ** RTV carrier appt date/time                         E00495
      * RTV 1st Carr Apt Dt/Tm RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0181           Load ID
     C                     Z-ADD*ZERO     WL0182           Stop_Drop
     C                     EXSR TORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0183    WUN7DT           LD Carrier Appt
     C                     Z-ADDWL0184    WN0673           LD Carrier Appt
      * ** Use carr appt dt/tm, if entered, for DDD/T calcs   E00495
      * CASE: WRK.LD Carrier Appt Date is Entered
     C           WUN7DT    IFGT 0                          *IF
     C                     Z-ADDWUN7DT    WN0672           Deadline Depart
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv 1st Ord Delv Dt/Tm RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0185           Load ID
     C                     Z-ADD*ZERO     WL0186           Stop_Drop
     C                     EXSR TPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0187    WN0672           Requested Deliv
     C                     Z-ADDWL0188    WN0692           Requested Deliv
     C           WN0692    MULT 100       WN0673           Deadline Depart
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0839  51       Hours Required
     C                     Z-ADD*ZERO     WN0840  50       Miles to next s
     C                     Z-ADD*ZERO     WN0841  50       USR Hours 5.0
     C                     Z-ADD*ZERO     WN0842  51       USR Hours to Mi
     C                     Z-ADD*ZERO     WN0843  50       @Days 5
     C                     Z-ADD*ZERO     WN0844  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0845  20       USR Period
     C                     Z-ADD*ZERO     WN0846  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0847  40       Requested Deliv
      *
      * CLC Departure Date/TimeIF
      * ***** Change Log and Comments
     C                     EXSR UDSUBR                     ***** Change Lo
      * RTV Shipping Method    RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0189           Load ID
     C                     EXSR TRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0190    YL0019    P      Shipping Method
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.Shipping Method is Collect Truck
      *   |- c2    : LCL.Shipping Method is Collect Rail
      *   '-
     C           YL0019    IFEQ 'CT'                       *IF
     C           YL0019    OREQ 'CR'                       *OR
      * ** Treat CT & CR the same           FP1251 LJB 12/26/2007
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV 1st Stop Mileage   RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0191           Load ID
     C                     Z-ADD*ZERO     WL0192           Stop_Drop
     C                     Z-ADD*ZERO     WL0193           Order Number
     C                     EXSR TSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0194    WN0840           Miles to next s
      * ** Calc miles between all stops then retrieve 1st stop miles
      * CASE: PAR.Miles to next stop is Not Entered
     C           WN0840    IFEQ 0                          *IF
      * ** Override miles will be returned, if entered
      * CLC Total Load Miles   XF - Load Detail  * 
     C                     CLEARPCRC
     C                     Z-ADD#1RMNB    PCRMNB           Load ID
      *
     C                     CALL 'PDW3XFR'              90  CLC Total Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             KEY: Load Detai
     C           WUTLMI    PARM WUTLMI    WQ0129  70       Total Load Mile
     C           WUK2DT    PARM WUK2DT    WQ0130  70       Override Total
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * RTV 1st Stop Mileage   RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0191           Load ID
     C                     Z-ADD*ZERO     WL0192           Stop_Drop
     C                     Z-ADD*ZERO     WL0193           Order Number
     C                     EXSR TSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0194    WN0840           Miles to next s
     C                     END                             *FI
      * ** 11/16/2007 LJB FP1251 Error if no miles, set SDD/SDT to zeros
      * CASE: PAR.Miles to next stop is Not Entered
     C           WN0840    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WN0672           Scheduled Deliv
     C                     Z-ADD*ZERO     WN0673           Scheduled Deliv
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0839           Hours Required
     C                     Z-ADD*ZERO     YL0020           Hours Required
      * RTV Legal Run Miles DscRT - Legal Run Mileage Hours  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0840    WL0195           Miles to First
     C                     EXSR TTRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0196    YL0020           Hours Required
      * 09/09/11 PKD E1659 Additional Route Hours
      * Rtv Addtnl Route Hrs  XF - Order Header TRG  * 
     C                     CALL 'PMACXFR'              90  Rtv Addtnl Rout
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0131  70       Load ID
     C           YL0021    PARM YL0021    WQ0132  50       Additional Rout
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMACXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C           YL0020    ADD  YL0021    WN0839           Hours Required
      * get number of whole days + remaining hours
      * CASE: PAR.Hours Required is Zero
     C           WN0839    IFEQ 0                          *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C           WN0839    DIV  24        WN0843           @Days 5
     C           WN0843    MULT 24        WU               USR Hours 5.0
     C           WN0839    SUB  WU        WN0841           USR Hours 5.0
     C           WN0841    MULT 10000     WUPINB           @Numeric 6,0
      * Subtract whole days
      * CASE: PAR.@Days 5 is greater than zero
     C           WN0843    IFGT 0                          *IF
     C                     MULT -1        WN0843           @Days 5
      * PAR.Scheduled Delivery Date = PAR.Scheduled Delivery Date + PAR.@
     C           WN0672    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN0843    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0672
     C                     ELSE
     C           XDINDT    SUB  1000000   WN0672
     C                     END
     C                     END                             *FI
      * Calculate # whole days + hours left
      * CASE: WRK.@Numeric 6,0 GE PAR.Scheduled Delivery Time
     C           WUPINB    IFGE WN0673                     *IF
     C                     SUB  WN0673    WUPINB           @Numeric 6,0
     C                     Z-ADD-1        WN0843           @Days 5
      * PAR.Scheduled Delivery Date = PAR.Scheduled Delivery Date + PAR.@
     C           WN0672    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN0843    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0672
     C                     ELSE
     C           XDINDT    SUB  1000000   WN0672
     C                     END
     C           240000    SUB  WUPINB    WN0673           Scheduled Deliv
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  WUPINB    WN0673           Scheduled Deliv
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * RTV Total Ld Mi/Sts    RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0197           Load ID
     C                     EXSR TURVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0198    WUG0TX    P      Load Status
     C                     Z-ADDWL0199    WUTLMI           Total Load Mile
     C                     Z-ADDWL0200    WUK2DT           Override Total
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ---------------------------------------------------------------
      * RTV Last Stop Consign  RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0201           Load ID
     C                     EXSR TVRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0202    WUBKC7           Ship To Custome
     C                     MOVELWL0203    WUBRTX    P      Ship To Name
     C                     MOVELWL0204    WUHMNA    P      Ship To Address
     C                     MOVELWL0205    WUHONA    P      Ship To Address
     C                     MOVELWL0206    WUHPNA    P      Ship To Address
     C                     MOVELWL0207    WUHNNA    P      Ship To City
     C                     MOVELWL0208    WN0667    P      Ship To State C
     C                     MOVELWL0209    WUCKTX    P      Ship To Zip_Pos
      * ---------------------------------------------------------------
      * OMS132:  Fill in Flat Amount as required
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Total Stops is One Stop
      *   |- c2    : PAR.Flat Amount EQ WRK.ZERO
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0664    IFEQ 1                          *IF
     C           WN0663    IFEQ WUW0NB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * get flat amount for destination city
      * RTV Ship To City/St-Ld RT - PD Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0210           Load ID
     C                     EXSR TXRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0211    WN0677    P      Ship To City
     C                     MOVELWL0212    WN0678    P      Ship To State C
      * CVT Str to Upper Alpha US - /UT User Source  * 
     C                     MOVEAWN0677    AR1              LOAD ARRAY
     C                     MOVEA*BLANK    AR2              LOAD ARRAY
     C                     Z-ADD1         X1      20       SET COUNTER
     C                     Z-ADD1         Y1      20       SET COUNTER
      * * * * * * * CHECK FOR ALPHABETIC CHARACTERS * * * * * * *
     C           X1        DOWLT31
     C           AR1,X1    IFEQ ' '
     C           AR1,X1    ORGE 'a'
     C           AR1,X1    ANDLE'Z'
     C           AR1,X1    ANDNE'~'
     C           AR1,X1    ANDNE'{'
     C           AR1,X1    ANDNE'}'
     C           AR1,X1    ANDNE'\'
     C                     MOVE AR1,X1    AR2,Y1
     C                     ADD  1         Y1
     C                     ADD  1         X1
     C                     ELSE
     C                     ADD  1         X1
     C                     END
     C                     END
     C                     Z-ADD1         Y1
     C           Y1        DOWLT31
     C           AR2,Y1    IFEQ 'a'
     C                     MOVEL'A'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'b'
     C                     MOVEL'B'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'c'
     C                     MOVEL'C'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'd'
     C                     MOVEL'D'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'e'
     C                     MOVEL'E'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'f'
     C                     MOVEL'F'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'g'
     C                     MOVEL'G'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'h'
     C                     MOVEL'H'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'i'
     C                     MOVEL'I'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'j'
     C                     MOVEL'J'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'k'
     C                     MOVEL'K'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'l'
     C                     MOVEL'L'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'm'
     C                     MOVEL'M'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'n'
     C                     MOVEL'N'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'o'
     C                     MOVEL'O'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'p'
     C                     MOVEL'P'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'q'
     C                     MOVEL'Q'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'r'
     C                     MOVEL'R'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 's'
     C                     MOVEL'S'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 't'
     C                     MOVEL'T'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'u'
     C                     MOVEL'U'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'v'
     C                     MOVEL'V'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'w'
     C                     MOVEL'W'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'x'
     C                     MOVEL'X'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'y'
     C                     MOVEL'Y'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'z'
     C                     MOVEL'Z'       AR2,Y1
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     ADD  1         Y1
     C                     END
     C                     MOVEAAR2       WUXECD           LOAD OUTPUT
     C                     MOVELWUXECD    WN0677           Destination Cit
      * RTV Destination Amount RT - Carrier Destination Rate  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0668    WL0213    P      Carrier Code
     C                     MOVELWN0666    WL0214    P      Warehouse Code
     C                     MOVELWN0677    WL0215    P      Destination Cit
     C                     MOVELWN0678    WL0216    P      State Code
     C                     EXSR TYRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0217    WN0663           Flat Rate
     C                     END                             *FI
      * Calc Load U/M           -- RMC 6/16/06
     C                     EXSR UESUBR                     Calc Load U/M
      * CHG Lock Load Update   CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0218           Load ID
     C                     Z-ADDWN0662    WL0219           Scheduled Ship
     C                     MOVEL'L'       WL0220    P      Load Status
     C                     Z-ADDWN0663    WL0221           Flat Amount
     C                     MOVELWN0666    WL0222    P      Ship From Wareh
     C                     MOVELWN0667    WL0223    P      Ship To State C
     C                     Z-ADDWN0672    WL0224           Deadline Depart
     C                     Z-ADDWN0673    WL0225           Deadline Depart
     C                     MOVELWN0675    WL0226    P      Load U_M
     C                     EXSR TZCHRC
      * OMS261:  if sched to ship today, print prelim pick at all whses
      * Sched to ship today
      * CASE: PAR.Scheduled Ship Date EQ JOB.*Job date
     C           WN0662    IFEQ ##JDT                      *IF
      * RTV All Whses on Load  RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0227           Load ID
     C                     MOVELWN0679    WL0228    P      USR Warehouse C
     C                     MOVELWN0680    WL0229    P      USR CDE Parm 1
     C                     MOVELWN0681    WL0230    P      USR CDE Parm 2
     C                     MOVELWN0682    WL0231    P      USR CDE Parm 3
     C                     MOVELWN0683    WL0232    P      USR CDE Parm 4
     C                     MOVELWN0684    WL0233    P      USR CDE Parm 5
     C                     MOVELWN0685    WL0234    P      USR CDE Parm 6
     C                     MOVELWN0686    WL0235    P      USR CDE Parm 7
     C                     MOVELWN0687    WL0236    P      USR CDE Parm 8
     C                     MOVELWN0688    WL0237    P      USR CDE Parm 9
     C                     EXSR NARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0228    WN0679    P      USR Warehouse C
     C                     MOVELWL0229    WN0680    P      USR CDE Parm 1
     C                     MOVELWL0230    WN0681    P      USR CDE Parm 2
     C                     MOVELWL0231    WN0682    P      USR CDE Parm 3
     C                     MOVELWL0232    WN0683    P      USR CDE Parm 4
     C                     MOVELWL0233    WN0684    P      USR CDE Parm 5
     C                     MOVELWL0234    WN0685    P      USR CDE Parm 6
     C                     MOVELWL0235    WN0686    P      USR CDE Parm 7
     C                     MOVELWL0236    WN0687    P      USR CDE Parm 8
     C                     MOVELWL0237    WN0688    P      USR CDE Parm 9
     C                     Z-ADD#1AIC3    WN0689           Company Number
     C                     Z-ADD#1RMNB    WN0691           Order Number 1
      * PAR.Date 1          PASS  USR = PAR.Scheduled Ship Date
     C                     Z-ADDWN0662    WN0690           Date 1
     C                     MOVEL'S'       WUCYST           USR Select/Omit
     C                     MOVEL'D'       WUSTST           USR Detail or S
     C                     MOVEL'Y'       WUCLST           AUTO PRINT PREL
      * letting all the other parms default in the CL
      * If warehouse exists for load then print.
      * CASE: PAR.USR Warehouse Code is Warehouse Code not Blank
     C           WN0679    IFNE *BLANK                     *IF
      * Pass Pre Pick @LoadLockUP - /UT User Programs  * 
     C                     CALL 'PDBDUPC'              90  Pass Pre Pick @
     C           WN0693    PARM *BLANK    WQ0135  7        Return Code Usr
     C                     PARM 'OMS'     WQ0136  6        Application Cod
     C                     PARM @CN,016   WQ0137 10        Program name US
     C           WUSTST    PARM WUSTST    WQ0138  1        USR Detail or S
     C                     PARM @CN,017   WQ0139 25        PRT Description
     C           WUWRST    PARM WUWRST    WQ0140 10        PRT Printer Dev
     C           WUWSST    PARM WUWSST    WQ0141  4        PRT Hold Output
     C           WUWTST    PARM WUWTST    WQ0142  4        PRT Save Output
     C           WUWUST    PARM WUWUST    WQ0143  1        PRT Night Queue
     C           WUBVVN    PARM WUBVVN    WQ0144 10        PRT Night Queue
     C           WN0689    PARM WN0689    WQ0145 155       Company Number
     C           WN0690    PARM WN0690    WQ0146 155       Date 1
     C           WN0691    PARM WN0691    WQ0147 155       Order Number 1
     C           WUM8NB    PARM WUM8NB    WQ0148 155       System Value Nu
     C           WN0679    PARM WN0679    WQ0149  3        USR Warehouse C
     C           WN0680    PARM WN0680    WQ0150  3        USR CDE Parm 1
     C           WN0681    PARM WN0681    WQ0151  3        USR CDE Parm 2
     C           WN0682    PARM WN0682    WQ0152  3        USR CDE Parm 3
     C           WN0683    PARM WN0683    WQ0153  3        USR CDE Parm 4
     C           WN0684    PARM WN0684    WQ0154  3        USR CDE Parm 5
     C           WN0685    PARM WN0685    WQ0155  3        USR CDE Parm 6
     C           WN0686    PARM WN0686    WQ0156  3        USR CDE Parm 7
     C           WN0687    PARM WN0687    WQ0157  3        USR CDE Parm 8
     C           WN0688    PARM WN0688    WQ0158  3        USR CDE Parm 9
     C           WUCYST    PARM WUCYST    WQ0159  1        USR Select/Omit
     C           WUCLST    PARM WUCLST    WQ0160  1        AUTO PRINT PREL
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDBDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      *
     C                     MOVEL*BLANK    WN0985  1        Trans Contol AS
      *
      * EDT Lock Load          IF
      * *** Return Plant Code from first Order Header
      * zzV for Accusort Load  RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0238           Load ID
     C                     EXSR NCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0239    WN0985    P      Trans Contol AS
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0240           PFS Company Num
     C                     MOVEL'LDORDD'  WL0241    P      PFS Interface C
     C                     EXSR NGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0242    YL0022    P      PFS AccuSort Ac
     C                     MOVELWL0243    YL0023    P      PFS Carlisle Ac
      * UPD:  AccuSort
      * CASE: LCL.PFS AccuSort Active is Yes
     C           YL0022    IFEQ 'Y'                        *IF
      * AccuSort:  Create Order Header and Order Detail
      * CASE: PAR.Trans Contol AS400/Plant is Plant
     C           WN0985    IFEQ 'P'                        *IF
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  Zzz Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'L'       WQ0161  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CRT AS Order Hdr/Dtl   XF - AS Order Header  * 
     C                     CALL 'PDQPXFR'              90  Zzz AS Order Hd
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0162  70       Load ID
     C                     PARM #1AIC3    WQ0163  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  Zzz Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'U'       WQ0164  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * UPD:  Carlisle
      * CASE: LCL.PFS Carlisle Active is Yes
     C           YL0023    IFEQ 'Y'                        *IF
      * PFS Lock Load/Order   XF - PFS Load Header  * 
     C                     CALL 'PPNLXFR'              90  PFS Lock Load/O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0165  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * ** 07/28/2017 RMC R131331 if load had a whs with edi wso intercha
      * Exc Create EDI f/Lock XF - EDI WHS Shipping Ord HDR  * 
     C                     CALL 'PUDNXFR'              90  Exc Create EDI
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0166  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUDNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE: JOB.*PROGRAM is PRT Audit Report
     C           ##PGM     IFEQ @CN,018                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Clr Program Message Q  US - /UT User Source  * 
      * CLEAR MESSAGES FROM PROGRAM MESSAGE QUEUE.
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ           ALREADY DEFINED
     C                     PARM '*SAME'   ZAPGRL           ALREADY DEFINED
      * RESET FIRST MESSAGE ONLY FLAG.
     C                     MOVEL'Y'       ZAFSMS  1        ALREADY DEFINED
      * Sched to ship today
      * CASE: PAR.Scheduled Ship Date EQ JOB.*Job date
     C           WN0662    IFEQ ##JDT                      *IF
      * CASE: PAR.USR Warehouse Code is Warehouse Code not Blank
     C           WN0679    IFNE *BLANK                     *IF
      * RTV Warehouse Dflt PrtrXF - Warehouse  * 
     C                     CALL 'PDCHXFR'              90  RTV Warehouse D
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0679    WQ0167  3        Warehouse Code
     C                     PARM *BLANK    WQ0168 10        Default Printer
     C           YL0024    PARM *BLANK    WQ0169  1        Include in Auto
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCHXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * RMC DLY029 10/30/07 - sndmsg only if Warehouse is set up for auto
      * CASE: LCL.Include in Auto Pre Pick is Incl in Auto Prelim Pick
     C           YL0024    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVELWN0679    ZA0131           USR Warehouse C
     C                     MOVELWN0680    ZA0132           USR CDE Parm 1
     C                     MOVELWN0681    ZA0133           USR CDE Parm 2
     C                     MOVELWN0682    ZA0134           USR CDE Parm 3
     C                     MOVELWN0683    ZA0135           USR CDE Parm 4
     C                     MOVELWN0684    ZA0136           USR CDE Parm 5
     C                     MOVELWN0685    ZA0137           USR CDE Parm 6
     C                     MOVELWN0686    ZA0138           USR CDE Parm 7
     C                     MOVELWN0687    ZA0139           USR CDE Parm 8
     C                     MOVELWN0688    ZA0140           USR CDE Parm 9
      * Send message 'Preliminary Pick Printing'
     C                     MOVEL'USR2565' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Prelim Pick Not Printed'
     C                     MOVEL'USR2715' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ***** Change Log and comments
     C                     EXSR UFSUBR                     ***** Change Lo
     C                     MOVEL*BLANK    WURVST           Load Change Typ
     C                     MOVEL'LOCK'    WURVST           Load Change Typ
     C                     MOVEL'TRF'     WUUJST           Department Cont
      * CRT Load/Order Chg Log XF - Load/Order Change Log  * 
     C                     CLEARPARC
     C                     Z-ADD#1RMNB    PARMNB           Load ID
     C                     Z-ADD*ZERO     PARVNB           Stop_Drop
     C                     MOVELWURVST    PARVST    P      Load Change Typ
     C                     MOVELWUUJST    PAUJST    P      Department Cont
     C                     MOVELWUPKST    PAMNTX    P      Change Log Prio
     C                     MOVEL'L'       PAMOTX    P      Change Log New
     C                     MOVEL##USR     PAAYNA    P      User Id
     C                     MOVEL##PGM     PAA0NA    P      Job Name
     C                     MOVEL#1BZNA    PABZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PAAIC3           Company Number
     C                     Z-ADD*ZERO     PAC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0141           Load ID
      * Send message 'Load Locked'
     C                     MOVEL'USR2559' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
      * *Set Cursor: RCD.*SFLSEL  (*Override=*NO)
     C                     Z-ADD##RR      W0RR0
     C           ##RR      DIV  ##SFPG    W0ROW0
     C                     MVR            W0ROW0
     C           W0ROW0    IFEQ 0
     C           ##SFPG    SUB  1         W0ROW0
     C                     ELSE
     C                     SUB  1         W0ROW0
     C                     END
     C                     MULT 002       W0ROW0
     C                     ADD  011       W0ROW0
     C                     Z-ADD002       W0COL0
     C                     MOVEL'0'       W0OVR0           *NO
     C                     END                             *FI
      * ** end Lock      02/26/07
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * 11=Add Production hold     -- RMC 02/26/07 moved into its own CAS
      * CASE: RCD.*SFLSEL is Option 11
     C           #1SEL     IFEQ '11'                       *IF
     C                     MOVEL#1GWST    #1GXST           Header Status L
     C                     MOVEL'H'       #1GWST           Header Status
     C                     MOVEL#1XJST    #RAEST           USR Production
      * CHG Prd Hld, Sts,Rsn   CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0093           Company Number
     C                     Z-ADD#1C4NB    WL0094           Order Number
     C                     MOVEL#1CQCD    WL0095    P      Reason Code
     C                     MOVEL#1GWST    WL0096    P      Header Status
     C                     MOVEL#1GXST    WL0097    P      Header Status L
     C                     MOVEL'Y'       WL0098    P      Production Hold
     C                     EXSR TJCHRC
      * FP1054 Chg details released by user to  " "
      * RTV Check/Chg Releasd RT - Order Detail  * 
     C                     EXSR NHRVGN
      * FP1054 Create HLDORD
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPARC
     C                     Z-ADD#1RMNB    PARMNB           Load ID
     C                     Z-ADD*ZERO     PARVNB           Stop_Drop
     C                     MOVEL'HLDORD'  PARVST    P      Load Change Typ
     C                     MOVEL'SLS'     PAUJST    P      Department Cont
     C                     MOVEL'N'       PAMNTX    P      Change Log Prio
     C                     MOVEL'Y'       PAMOTX    P      Change Log New
     C                     MOVEL##USR     PAAYNA    P      User Id
     C                     MOVEL##PGM     PAA0NA    P      Job Name
     C                     MOVEL#1BZNA    PABZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PAAIC3           Company Number
     C                     Z-ADD#1C4NB    PAC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * *
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * 13=Lock Load
      * CASE: RCD.*SFLSEL is Option 13
     C           #1SEL     IFEQ '13'                       *IF
      *    changed function being called for OMS132  PLL 2/97
      * RTV Load Status        RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0025           Load ID
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0026    YL0009    P      Load Status
      * CASE: LCL.Load Status is Lock
     C           YL0009    IFEQ 'L'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Load Acceptance Sw RT - Load Header  * 
     C                     EXSR NIRVGN
      * CASE:
      *  - c1ANDc2
      *   |- c1    : WRK.Load Acceptance Flag is Load not Accepted
      *   |- c2    : RCD.MG Created Load is Not MG Created Load
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WURMST    IFEQ 'U'                        *IF
     C           #RRYSX    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0142           Load ID
      * Send message 'Load is not accepted'
     C                     MOVEL'USR2514' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     Z-ADD*ZERO     WN0986  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0987 112       Flat Amount
     C                     Z-ADD*ZERO     WN0988  50       Total Stops
     C                     Z-ADD*ZERO     WN0989  70       Total Load Mile
     C                     MOVEL*BLANK    WN0990  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0991  2        Ship To State C
     C                     MOVEL*BLANK    WN0992  3        Carrier Broker
     C                     MOVEL*BLANK    WN0993  1        Export Status
     C                     MOVEL*BLANK    WN0994  3        Shipping Line
     C                     MOVEL*BLANK    WN0995 20        Port Delv Termi
     C                     Z-ADD*ZERO     WN0996  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0997  60       Deadline Depart
     C                     MOVEL*BLANK    WN0998  1        MG Created Load
     C                     MOVEL*BLANK    WN0999  2        Load U_M
     C                     MOVEL*BLANK    WN1000  1        Trans Contol AS
     C                     MOVEL*BLANK    WN1001 20        Destination Cit
     C                     MOVEL*BLANK    WN1002  2        State Code
     C                     MOVEL*BLANK    WN1003  3        USR Warehouse C
     C                     MOVEL*BLANK    WN1004  3        USR CDE Parm 1
     C                     MOVEL*BLANK    WN1005  3        USR CDE Parm 2
     C                     MOVEL*BLANK    WN1006  3        USR CDE Parm 3
     C                     MOVEL*BLANK    WN1007  3        USR CDE Parm 4
     C                     MOVEL*BLANK    WN1008  3        USR CDE Parm 5
     C                     MOVEL*BLANK    WN1009  3        USR CDE Parm 6
     C                     MOVEL*BLANK    WN1010  3        USR CDE Parm 7
     C                     MOVEL*BLANK    WN1011  3        USR CDE Parm 8
     C                     MOVEL*BLANK    WN1012  3        USR CDE Parm 9
     C                     Z-ADD*ZERO     WN1013 155       Company Number
     C                     Z-ADD*ZERO     WN1014 155       Date 1
     C                     Z-ADD*ZERO     WN1015 155       Order Number 1
     C                     Z-ADD*ZERO     WN1016  40       Requested Deliv
     C                     MOVEL*BLANK    WN1017  7        Return Code Usr
      *
      * UPD Lock Load Update   IF
      * RTV Load Header All,Mg RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0099           Load ID
     C                     EXSR TKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0100    WN0986           Scheduled Ship
     C                     MOVELWL0101    WUG0TX    P      LTL Flag
     C                     MOVELWL0102    WUG0TX    P      Load Status
     C                     Z-ADDWL0103    WUNFNN           Reefer Temperat
     C                     MOVELWL0104    WUG0TX    P      Seal 1
     C                     MOVELWL0105    WUG0TX    P      Seal 2
     C                     MOVELWL0106    WUG0TX    P      Seal 3
     C                     Z-ADDWL0107    WUNFNN           Total Load Orde
     C                     Z-ADDWL0108    WN0987           Flat Amount
     C                     MOVELWL0109    WUG0TX    P      Allocate Pounds
     C                     Z-ADDWL0110    WN0988           Total Stops
     C                     MOVELWL0111    WUG0TX    P      Trailer Id
     C                     MOVELWL0112    WUG0TX    P      Transloader Car
     C                     Z-ADDWL0113    WUNFNN           BOL Time
     C                     MOVELWL0114    WUG0TX    P      Carrier Code
     C                     MOVELWL0115    WUG0TX    P      Truck Size
     C                     Z-ADDWL0116    WUNFNN           Ld Hdr_Ld Dtl U
     C                     Z-ADDWL0117    WUNFNN           Rated Freight
     C                     MOVELWL0118    WUG0TX    P      Ship Status
     C                     MOVELWL0119    WUG0TX    P      Load Type
     C                     Z-ADDWL0120    WUNFNN           Number Pallets
     C                     Z-ADDWL0121    WUNFNN           Number Pallets
     C                     Z-ADDWL0122    WUNFNN           Load Carrier Pa
     C                     Z-ADDWL0123    WUNFNN           Estimated Arriv
     C                     Z-ADDWL0124    WUNFNN           Actual Arrival
     C                     Z-ADDWL0125    WUNFNN           Actual Arrival
     C                     Z-ADDWL0126    WUNFNN           Trailer IN Weig
     C                     Z-ADDWL0127    WUNFNN           Trailer OUT Wei
     C                     Z-ADDWL0128    WUNFNN           Actual Departur
     C                     Z-ADDWL0129    WUNFNN           Departure Time
     C                     Z-ADDWL0130    WUNFNN           Schedule Sequen
     C                     Z-ADDWL0131    WUNFNN           Product Tempera
     C                     Z-ADDWL0132    WUNFNN           Number Spacers
     C                     MOVELWL0133    WUG0TX    P      Car_Veh_Initial
     C                     Z-ADDWL0134    WN0989           Total Load Mile
     C                     MOVELWL0135    WUG0TX    P      Recorder ID
     C                     MOVELWL0136    WUG0TX    P      Shipping Method
     C                     MOVELWL0137    WN0990    P      Ship From Wareh
     C                     MOVELWL0138    WN0991    P      Ship To State C
     C                     Z-ADDWL0139    WUNFNN           Gross Weight
     C                     MOVELWL0140    WN0992    P      Carrier Broker
     C                     MOVELWL0141    WN0993    P      Export Status
     C                     Z-ADDWL0142    WUNFNN           Actual Ship Dat
     C                     MOVELWL0143    WUG0TX    P      On Time_Y_N
     C                     Z-ADDWL0144    WUNFNN           Truck Ready Dat
     C                     Z-ADDWL0145    WUNFNN           Truck Ready Tim
     C                     Z-ADDWL0146    WUNFNN           Spotted Date
     C                     Z-ADDWL0147    WUNFNN           Spotted Time
     C                     Z-ADDWL0148    WUNFNN           Load Finished D
     C                     Z-ADDWL0149    WUNFNN           Load Finished T
     C                     Z-ADDWL0150    WUNFNN           BOL Complete Da
     C                     Z-ADDWL0151    WUNFNN           BOL Complete Ti
     C                     Z-ADDWL0152    WUNFNN           BOL Received Da
     C                     Z-ADDWL0153    WUNFNN           BOL Received Ti
     C                     Z-ADDWL0154    WUNFNN           Truck Departure
     C                     Z-ADDWL0155    WUNFNN           Truck Departure
     C                     Z-ADDWL0156    WUNFNN           Adjusted Depart
     C                     Z-ADDWL0157    WUNFNN           Adjusted Depart
     C                     MOVELWL0158    WUG0TX    P      Shipping Line
     C                     MOVELWL0159    WUG0TX    P      Port Delv Termi
     C                     MOVELWL0160    WUG0TX    P      Vessel Name
     C                     Z-ADDWL0161    WUNFNN           Voyage
     C                     Z-ADDWL0162    WUNFNN           Sail Date
     C                     MOVELWL0163    WUG0TX    P      Booking Number
     C                     MOVELWL0164    WUG0TX    P      Discharge Port
     C                     Z-ADDWL0165    WUNFNN           Arrival Date
     C                     MOVELWL0166    WUG0TX    P      Container Numbe
     C                     Z-ADDWL0167    WUNFNN           Date In
     C                     Z-ADDWL0168    WUNFNN           Time In
     C                     Z-ADDWL0169    WUNFNN           Date Out
     C                     Z-ADDWL0170    WUNFNN           Time Out
     C                     Z-ADDWL0171    WUNFNN           Load Total Frei
     C                     Z-ADDWL0172    WUNFNN           Scheduled Deliv
     C                     Z-ADDWL0173    WUNFNN           Scheduled Deliv
     C                     MOVELWL0174    WUG0TX    P      LH Unused Sts
     C                     Z-ADDWL0175    WUNFNN           On Yard Date
     C                     Z-ADDWL0176    WUNFNN           On Yard Time
     C                     Z-ADDWL0177    WN0996           Deadline Depart
     C                     Z-ADDWL0178    WN0997           Deadline Depart
     C                     MOVELWL0179    WN0998    P      MG Created Load
      * .** Use carr appt dt/tm, if entered, for DDD/T calcs   E00495
      * Fill in ship from whse deadline depart, if locking load and none
      * CASE: PAR.Ship From Warehouse EQ WRK.BLANK
     C           WN0990    IFEQ WUGSTX                     *IF
      * Rtv/Chg Whs,ld miles  RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0180           Load ID
     C                     EXSR TLRVGN
      * CASE: PAR.MG Created Load is Not MG Created Load
     C           WN0998    IFEQ *BLANK                     *IF
      * ** RTV carrier appt date/time                         E00495
      * RTV 1st Carr Apt Dt/Tm RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0181           Load ID
     C                     Z-ADD*ZERO     WL0182           Stop_Drop
     C                     EXSR TORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0183    WUN7DT           LD Carrier Appt
     C                     Z-ADDWL0184    WN0997           LD Carrier Appt
      * ** Use carr appt dt/tm, if entered, for DDD/T calcs   E00495
      * CASE: WRK.LD Carrier Appt Date is Entered
     C           WUN7DT    IFGT 0                          *IF
     C                     Z-ADDWUN7DT    WN0996           Deadline Depart
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv 1st Ord Delv Dt/Tm RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0185           Load ID
     C                     Z-ADD*ZERO     WL0186           Stop_Drop
     C                     EXSR TPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0187    WN0996           Requested Deliv
     C                     Z-ADDWL0188    WN1016           Requested Deliv
     C           WN1016    MULT 100       WN0997           Deadline Depart
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN1018  51       Hours Required
     C                     Z-ADD*ZERO     WN1019  50       Miles to next s
     C                     Z-ADD*ZERO     WN1020  50       USR Hours 5.0
     C                     Z-ADD*ZERO     WN1021  51       USR Hours to Mi
     C                     Z-ADD*ZERO     WN1022  50       @Days 5
     C                     Z-ADD*ZERO     WN1023  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN1024  20       USR Period
     C                     Z-ADD*ZERO     WN1025  70       Requested Deliv
     C                     Z-ADD*ZERO     WN1026  40       Requested Deliv
      *
      * CLC Departure Date/TimeIF
      * ***** Change Log and Comments
     C                     EXSR UGSUBR                     ***** Change Lo
      * RTV Shipping Method    RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0189           Load ID
     C                     EXSR TRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0190    YL0019    P      Shipping Method
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.Shipping Method is Collect Truck
      *   |- c2    : LCL.Shipping Method is Collect Rail
      *   '-
     C           YL0019    IFEQ 'CT'                       *IF
     C           YL0019    OREQ 'CR'                       *OR
      * ** Treat CT & CR the same           FP1251 LJB 12/26/2007
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV 1st Stop Mileage   RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0191           Load ID
     C                     Z-ADD*ZERO     WL0192           Stop_Drop
     C                     Z-ADD*ZERO     WL0193           Order Number
     C                     EXSR TSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0194    WN1019           Miles to next s
      * ** Calc miles between all stops then retrieve 1st stop miles
      * CASE: PAR.Miles to next stop is Not Entered
     C           WN1019    IFEQ 0                          *IF
      * ** Override miles will be returned, if entered
      * CLC Total Load Miles   XF - Load Detail  * 
     C                     CLEARPCRC
     C                     Z-ADD#1RMNB    PCRMNB           Load ID
      *
     C                     CALL 'PDW3XFR'              90  CLC Total Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             KEY: Load Detai
     C           WUTLMI    PARM WUTLMI    WQ0170  70       Total Load Mile
     C           WUK2DT    PARM WUK2DT    WQ0171  70       Override Total
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * RTV 1st Stop Mileage   RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0191           Load ID
     C                     Z-ADD*ZERO     WL0192           Stop_Drop
     C                     Z-ADD*ZERO     WL0193           Order Number
     C                     EXSR TSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0194    WN1019           Miles to next s
     C                     END                             *FI
      * ** 11/16/2007 LJB FP1251 Error if no miles, set SDD/SDT to zeros
      * CASE: PAR.Miles to next stop is Not Entered
     C           WN1019    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WN0996           Scheduled Deliv
     C                     Z-ADD*ZERO     WN0997           Scheduled Deliv
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN1018           Hours Required
     C                     Z-ADD*ZERO     YL0020           Hours Required
      * RTV Legal Run Miles DscRT - Legal Run Mileage Hours  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN1019    WL0195           Miles to First
     C                     EXSR TTRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0196    YL0020           Hours Required
      * 09/09/11 PKD E1659 Additional Route Hours
      * Rtv Addtnl Route Hrs  XF - Order Header TRG  * 
     C                     CALL 'PMACXFR'              90  Rtv Addtnl Rout
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0172  70       Load ID
     C           YL0021    PARM YL0021    WQ0173  50       Additional Rout
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMACXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C           YL0020    ADD  YL0021    WN1018           Hours Required
      * get number of whole days + remaining hours
      * CASE: PAR.Hours Required is Zero
     C           WN1018    IFEQ 0                          *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C           WN1018    DIV  24        WN1022           @Days 5
     C           WN1022    MULT 24        WU               USR Hours 5.0
     C           WN1018    SUB  WU        WN1020           USR Hours 5.0
     C           WN1020    MULT 10000     WUPINB           @Numeric 6,0
      * Subtract whole days
      * CASE: PAR.@Days 5 is greater than zero
     C           WN1022    IFGT 0                          *IF
     C                     MULT -1        WN1022           @Days 5
      * PAR.Scheduled Delivery Date = PAR.Scheduled Delivery Date + PAR.@
     C           WN0996    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN1022    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0996
     C                     ELSE
     C           XDINDT    SUB  1000000   WN0996
     C                     END
     C                     END                             *FI
      * Calculate # whole days + hours left
      * CASE: WRK.@Numeric 6,0 GE PAR.Scheduled Delivery Time
     C           WUPINB    IFGE WN0997                     *IF
     C                     SUB  WN0997    WUPINB           @Numeric 6,0
     C                     Z-ADD-1        WN1022           @Days 5
      * PAR.Scheduled Delivery Date = PAR.Scheduled Delivery Date + PAR.@
     C           WN0996    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN1022    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0996
     C                     ELSE
     C           XDINDT    SUB  1000000   WN0996
     C                     END
     C           240000    SUB  WUPINB    WN0997           Scheduled Deliv
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  WUPINB    WN0997           Scheduled Deliv
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * RTV Total Ld Mi/Sts    RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0197           Load ID
     C                     EXSR TURVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0198    WUG0TX    P      Load Status
     C                     Z-ADDWL0199    WUTLMI           Total Load Mile
     C                     Z-ADDWL0200    WUK2DT           Override Total
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ---------------------------------------------------------------
      * RTV Last Stop Consign  RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0201           Load ID
     C                     EXSR TVRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0202    WUBKC7           Ship To Custome
     C                     MOVELWL0203    WUBRTX    P      Ship To Name
     C                     MOVELWL0204    WUHMNA    P      Ship To Address
     C                     MOVELWL0205    WUHONA    P      Ship To Address
     C                     MOVELWL0206    WUHPNA    P      Ship To Address
     C                     MOVELWL0207    WUHNNA    P      Ship To City
     C                     MOVELWL0208    WN0991    P      Ship To State C
     C                     MOVELWL0209    WUCKTX    P      Ship To Zip_Pos
      * ---------------------------------------------------------------
      * OMS132:  Fill in Flat Amount as required
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Total Stops is One Stop
      *   |- c2    : PAR.Flat Amount EQ WRK.ZERO
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0988    IFEQ 1                          *IF
     C           WN0987    IFEQ WUW0NB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * get flat amount for destination city
      * RTV Ship To City/St-Ld RT - PD Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0210           Load ID
     C                     EXSR TXRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0211    WN1001    P      Ship To City
     C                     MOVELWL0212    WN1002    P      Ship To State C
      * CVT Str to Upper Alpha US - /UT User Source  * 
     C                     MOVEAWN1001    AR1              LOAD ARRAY
     C                     MOVEA*BLANK    AR2              LOAD ARRAY
     C                     Z-ADD1         X1      20       SET COUNTER
     C                     Z-ADD1         Y1      20       SET COUNTER
     C           X1        DOWLT31
     C           AR1,X1    IFEQ ' '
     C           AR1,X1    ORGE 'a'
     C           AR1,X1    ANDLE'Z'
     C           AR1,X1    ANDNE'~'
     C           AR1,X1    ANDNE'{'
     C           AR1,X1    ANDNE'}'
     C           AR1,X1    ANDNE'\'
     C                     MOVE AR1,X1    AR2,Y1
     C                     ADD  1         Y1
     C                     ADD  1         X1
     C                     ELSE
     C                     ADD  1         X1
     C                     END
     C                     END
     C                     Z-ADD1         Y1
     C           Y1        DOWLT31
     C           AR2,Y1    IFEQ 'a'
     C                     MOVEL'A'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'b'
     C                     MOVEL'B'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'c'
     C                     MOVEL'C'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'd'
     C                     MOVEL'D'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'e'
     C                     MOVEL'E'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'f'
     C                     MOVEL'F'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'g'
     C                     MOVEL'G'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'h'
     C                     MOVEL'H'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'i'
     C                     MOVEL'I'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'j'
     C                     MOVEL'J'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'k'
     C                     MOVEL'K'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'l'
     C                     MOVEL'L'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'm'
     C                     MOVEL'M'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'n'
     C                     MOVEL'N'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'o'
     C                     MOVEL'O'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'p'
     C                     MOVEL'P'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'q'
     C                     MOVEL'Q'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'r'
     C                     MOVEL'R'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 's'
     C                     MOVEL'S'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 't'
     C                     MOVEL'T'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'u'
     C                     MOVEL'U'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'v'
     C                     MOVEL'V'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'w'
     C                     MOVEL'W'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'x'
     C                     MOVEL'X'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'y'
     C                     MOVEL'Y'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'z'
     C                     MOVEL'Z'       AR2,Y1
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     ADD  1         Y1
     C                     END
     C                     MOVEAAR2       WUXECD           LOAD OUTPUT
     C                     MOVELWUXECD    WN1001           Destination Cit
      * RTV Destination Amount RT - Carrier Destination Rate  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0992    WL0213    P      Carrier Code
     C                     MOVELWN0990    WL0214    P      Warehouse Code
     C                     MOVELWN1001    WL0215    P      Destination Cit
     C                     MOVELWN1002    WL0216    P      State Code
     C                     EXSR TYRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0217    WN0987           Flat Rate
     C                     END                             *FI
      * Calc Load U/M           -- RMC 6/16/06
     C                     EXSR UHSUBR                     Calc Load U/M
      * CHG Lock Load Update   CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0218           Load ID
     C                     Z-ADDWN0986    WL0219           Scheduled Ship
     C                     MOVEL'L'       WL0220    P      Load Status
     C                     Z-ADDWN0987    WL0221           Flat Amount
     C                     MOVELWN0990    WL0222    P      Ship From Wareh
     C                     MOVELWN0991    WL0223    P      Ship To State C
     C                     Z-ADDWN0996    WL0224           Deadline Depart
     C                     Z-ADDWN0997    WL0225           Deadline Depart
     C                     MOVELWN0999    WL0226    P      Load U_M
     C                     EXSR TZCHRC
      * OMS261:  if sched to ship today, print prelim pick at all whses
      * Sched to ship today
      * CASE: PAR.Scheduled Ship Date EQ JOB.*Job date
     C           WN0986    IFEQ ##JDT                      *IF
      * RTV All Whses on Load  RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0227           Load ID
     C                     MOVELWN1003    WL0228    P      USR Warehouse C
     C                     MOVELWN1004    WL0229    P      USR CDE Parm 1
     C                     MOVELWN1005    WL0230    P      USR CDE Parm 2
     C                     MOVELWN1006    WL0231    P      USR CDE Parm 3
     C                     MOVELWN1007    WL0232    P      USR CDE Parm 4
     C                     MOVELWN1008    WL0233    P      USR CDE Parm 5
     C                     MOVELWN1009    WL0234    P      USR CDE Parm 6
     C                     MOVELWN1010    WL0235    P      USR CDE Parm 7
     C                     MOVELWN1011    WL0236    P      USR CDE Parm 8
     C                     MOVELWN1012    WL0237    P      USR CDE Parm 9
     C                     EXSR NARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0228    WN1003    P      USR Warehouse C
     C                     MOVELWL0229    WN1004    P      USR CDE Parm 1
     C                     MOVELWL0230    WN1005    P      USR CDE Parm 2
     C                     MOVELWL0231    WN1006    P      USR CDE Parm 3
     C                     MOVELWL0232    WN1007    P      USR CDE Parm 4
     C                     MOVELWL0233    WN1008    P      USR CDE Parm 5
     C                     MOVELWL0234    WN1009    P      USR CDE Parm 6
     C                     MOVELWL0235    WN1010    P      USR CDE Parm 7
     C                     MOVELWL0236    WN1011    P      USR CDE Parm 8
     C                     MOVELWL0237    WN1012    P      USR CDE Parm 9
     C                     Z-ADD#1AIC3    WN1013           Company Number
     C                     Z-ADD#1RMNB    WN1015           Order Number 1
      * PAR.Date 1          PASS  USR = PAR.Scheduled Ship Date
     C                     Z-ADDWN0986    WN1014           Date 1
     C                     MOVEL'S'       WUCYST           USR Select/Omit
     C                     MOVEL'D'       WUSTST           USR Detail or S
     C                     MOVEL'Y'       WUCLST           AUTO PRINT PREL
      * letting all the other parms default in the CL
      * If warehouse exists for load then print.
      * CASE: PAR.USR Warehouse Code is Warehouse Code not Blank
     C           WN1003    IFNE *BLANK                     *IF
      * Pass Pre Pick @LoadLockUP - /UT User Programs  * 
     C                     CALL 'PDBDUPC'              90  Pass Pre Pick @
     C           WN1017    PARM *BLANK    WQ0176  7        Return Code Usr
     C                     PARM 'OMS'     WQ0177  6        Application Cod
     C                     PARM @CN,016   WQ0178 10        Program name US
     C           WUSTST    PARM WUSTST    WQ0179  1        USR Detail or S
     C                     PARM @CN,017   WQ0180 25        PRT Description
     C           WUWRST    PARM WUWRST    WQ0181 10        PRT Printer Dev
     C           WUWSST    PARM WUWSST    WQ0182  4        PRT Hold Output
     C           WUWTST    PARM WUWTST    WQ0183  4        PRT Save Output
     C           WUWUST    PARM WUWUST    WQ0184  1        PRT Night Queue
     C           WUBVVN    PARM WUBVVN    WQ0185 10        PRT Night Queue
     C           WN1013    PARM WN1013    WQ0186 155       Company Number
     C           WN1014    PARM WN1014    WQ0187 155       Date 1
     C           WN1015    PARM WN1015    WQ0188 155       Order Number 1
     C           WUM8NB    PARM WUM8NB    WQ0189 155       System Value Nu
     C           WN1003    PARM WN1003    WQ0190  3        USR Warehouse C
     C           WN1004    PARM WN1004    WQ0191  3        USR CDE Parm 1
     C           WN1005    PARM WN1005    WQ0192  3        USR CDE Parm 2
     C           WN1006    PARM WN1006    WQ0193  3        USR CDE Parm 3
     C           WN1007    PARM WN1007    WQ0194  3        USR CDE Parm 4
     C           WN1008    PARM WN1008    WQ0195  3        USR CDE Parm 5
     C           WN1009    PARM WN1009    WQ0196  3        USR CDE Parm 6
     C           WN1010    PARM WN1010    WQ0197  3        USR CDE Parm 7
     C           WN1011    PARM WN1011    WQ0198  3        USR CDE Parm 8
     C           WN1012    PARM WN1012    WQ0199  3        USR CDE Parm 9
     C           WUCYST    PARM WUCYST    WQ0200  1        USR Select/Omit
     C           WUCLST    PARM WUCLST    WQ0201  1        AUTO PRINT PREL
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDBDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      *
     C                     MOVEL*BLANK    WN1027  1        Trans Contol AS
      *
      * EDT Lock Load          IF
      * *** Return Plant Code from first Order Header
      * zzV for Accusort Load  RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0238           Load ID
     C                     EXSR NCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0239    WN1027    P      Trans Contol AS
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0240           PFS Company Num
     C                     MOVEL'LDORDD'  WL0241    P      PFS Interface C
     C                     EXSR NGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0242    YL0022    P      PFS AccuSort Ac
     C                     MOVELWL0243    YL0023    P      PFS Carlisle Ac
      * UPD:  AccuSort
      * CASE: LCL.PFS AccuSort Active is Yes
     C           YL0022    IFEQ 'Y'                        *IF
      * AccuSort:  Create Order Header and Order Detail
      * CASE: PAR.Trans Contol AS400/Plant is Plant
     C           WN1027    IFEQ 'P'                        *IF
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  Zzz Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'L'       WQ0202  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CRT AS Order Hdr/Dtl   XF - AS Order Header  * 
     C                     CALL 'PDQPXFR'              90  Zzz AS Order Hd
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0203  70       Load ID
     C                     PARM #1AIC3    WQ0204  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  Zzz Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'U'       WQ0205  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * UPD:  Carlisle
      * CASE: LCL.PFS Carlisle Active is Yes
     C           YL0023    IFEQ 'Y'                        *IF
      * PFS Lock Load/Order   XF - PFS Load Header  * 
     C                     CALL 'PPNLXFR'              90  PFS Lock Load/O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0206  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * ** 07/28/2017 RMC R131331 if load had a whs with edi wso intercha
      * Exc Create EDI f/Lock XF - EDI WHS Shipping Ord HDR  * 
     C                     CALL 'PUDNXFR'              90  Exc Create EDI
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0207  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUDNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE: JOB.*PROGRAM is PRT Audit Report
     C           ##PGM     IFEQ @CN,018                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Clr Program Message Q  US - /UT User Source  * 
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ           ALREADY DEFINED
     C                     PARM '*SAME'   ZAPGRL           ALREADY DEFINED
     C                     MOVEL'Y'       ZAFSMS  1        ALREADY DEFINED
      * Sched to ship today
      * CASE: PAR.Scheduled Ship Date EQ JOB.*Job date
     C           WN0986    IFEQ ##JDT                      *IF
      * CASE: PAR.USR Warehouse Code is Warehouse Code not Blank
     C           WN1003    IFNE *BLANK                     *IF
      * RTV Warehouse Dflt PrtrXF - Warehouse  * 
     C                     CALL 'PDCHXFR'              90  RTV Warehouse D
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN1003    WQ0208  3        Warehouse Code
     C                     PARM *BLANK    WQ0209 10        Default Printer
     C           YL0024    PARM *BLANK    WQ0210  1        Include in Auto
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCHXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * RMC DLY029 10/30/07 - sndmsg only if Warehouse is set up for auto
      * CASE: LCL.Include in Auto Pre Pick is Incl in Auto Prelim Pick
     C           YL0024    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVELWN1003    ZA0143           USR Warehouse C
     C                     MOVELWN1004    ZA0144           USR CDE Parm 1
     C                     MOVELWN1005    ZA0145           USR CDE Parm 2
     C                     MOVELWN1006    ZA0146           USR CDE Parm 3
     C                     MOVELWN1007    ZA0147           USR CDE Parm 4
     C                     MOVELWN1008    ZA0148           USR CDE Parm 5
     C                     MOVELWN1009    ZA0149           USR CDE Parm 6
     C                     MOVELWN1010    ZA0150           USR CDE Parm 7
     C                     MOVELWN1011    ZA0151           USR CDE Parm 8
     C                     MOVELWN1012    ZA0152           USR CDE Parm 9
      * Send message 'Preliminary Pick Printing'
     C                     MOVEL'USR2565' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Prelim Pick Not Printed'
     C                     MOVEL'USR2715' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ***** Change Log and comments
     C                     EXSR UISUBR                     ***** Change Lo
     C                     MOVEL*BLANK    WURVST           Load Change Typ
     C                     MOVEL'LOCK'    WURVST           Load Change Typ
     C                     MOVEL'TRF'     WUUJST           Department Cont
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPARC
     C                     Z-ADD#1RMNB    PARMNB           Load ID
     C                     Z-ADD*ZERO     PARVNB           Stop_Drop
     C                     MOVELWURVST    PARVST    P      Load Change Typ
     C                     MOVELWUUJST    PAUJST    P      Department Cont
     C                     MOVEL#RPKST    PAMNTX    P      Change Log Prio
     C                     MOVEL'L'       PAMOTX    P      Change Log New
     C                     MOVEL##USR     PAAYNA    P      User Id
     C                     MOVEL##PGM     PAA0NA    P      Job Name
     C                     MOVEL#1BZNA    PABZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PAAIC3           Company Number
     C                     Z-ADD*ZERO     PAC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 14=Unlock Load
      * CASE: RCD.*SFLSEL is Option 14
     C           #1SEL     IFEQ '14'                       *IF
      *
     C                     MOVEL*BLANK    WN1028  3        Shipping Line
     C                     MOVEL*BLANK    WN1029 20        Port Delv Termi
     C                     MOVEL*BLANK    WN1030  1        Trans Contol AS
     C                     MOVEL*BLANK    WN1031  1        USR Status (Y/N
      *
      * UPD Unlock Load Update IF
      * CHG Ld Sts,Rated Frts  CH - Load Header  * 
     C                     EXSR NJCHRC
      *
     C                     MOVEL*BLANK    WN1175  1        Trans Contol AS
     C                     MOVEL*BLANK    WN1176  1        USR Status (Y/N
     C                     Z-ADD*ZERO     WN1177  90       GAF Customer Nu
     C                     MOVEL*BLANK    WN1178  3        GAF Function
      *
      * EDT Unlock Load        IF
      * *** Return Plant Code from first Order Header
      * zzV for Accusort Load  RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0238           Load ID
     C                     EXSR NCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0239    WN1175    P      Trans Contol AS
      * RTV System Value Alpha RT - System Values  * 
     C                     EXSR NKRVGN
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0240           PFS Company Num
     C                     MOVEL'LDORDD'  WL0241    P      PFS Interface C
     C                     EXSR NGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0242    YL0026    P      PFS AccuSort Ac
     C                     MOVELWL0243    YL0027    P      PFS Carlisle Ac
      * UPD:  AccuSort
      * CASE: LCL.PFS AccuSort Active is Yes
     C           YL0026    IFEQ 'Y'                        *IF
      * Notify Accusort if locked load
      * CASE: PAR.Trans Contol AS400/Plant is Plant
     C           WN1175    IFEQ 'P'                        *IF
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  Zzz Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'L'       WQ0211  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * DEL AS Order Hdr/Dtl   XF - AS Order Header  * 
     C                     CALL 'PDQ0XFR'              90  DEL AS Order Hd
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0212  70       Load ID
     C                     PARM #1AIC3    WQ0213  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQ0XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  Zzz Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'U'       WQ0214  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * UPD:  Carlisle
      * CASE: LCL.PFS Carlisle Active is Yes
     C           YL0027    IFEQ 'Y'                        *IF
      * PFS Unlock Load/Order XF - PFS Load Header  * 
     C                     CALL 'PPNQXFR'              90  PFS Unlock Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0215  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * PFS Lock Load/Order   XF - PFS Load Header  * 
     C                     CALL 'PPNLXFR'              90  PFS Lock Load/O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0216  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * ** 09/23/2011 RMC E1607  if load had a whs with edi wso interchan
      *    delete it if Unproc, else change it to "D"elete/and reprocess
      * Exc ChgDel EDI f/UnlckXF - EDI WHS Shipping Ord HDR  * 
     C                     CALL 'PBAEXFR'              90  Exc ChgDel EDI
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0217  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBAEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CHG Clear Rated Frt    RT - Load Detail  * 
     C                     EXSR NLRVGN
      * Clr Program Message Q  US - /UT User Source  * 
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ           ALREADY DEFINED
     C                     PARM '*SAME'   ZAPGRL           ALREADY DEFINED
     C                     MOVEL'Y'       ZAFSMS  1        ALREADY DEFINED
     C                     MOVEL'UNLOCK'  WURVST           Load Change Typ
     C                     MOVEL'TRF'     WUUJST           Department Cont
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPARC
     C                     Z-ADD#1RMNB    PARMNB           Load ID
     C                     Z-ADD*ZERO     PARVNB           Stop_Drop
     C                     MOVELWURVST    PARVST    P      Load Change Typ
     C                     MOVELWUUJST    PAUJST    P      Department Cont
     C                     MOVEL#RPKST    PAMNTX    P      Change Log Prio
     C                     MOVEL'U'       PAMOTX    P      Change Log New
     C                     MOVEL##USR     PAAYNA    P      User Id
     C                     MOVEL##PGM     PAA0NA    P      Job Name
     C                     MOVEL#1BZNA    PABZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PAAIC3           Company Number
     C                     Z-ADD*ZERO     PAC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * 15=Remove Ord f/Load                          W98652 DN 01/30/23
      * CASE: RCD.*SFLSEL is Option 15
     C           #1SEL     IFEQ '15'                       *IF
      * Exc Remove order f/Ld XF - Order Header TRG  * 
     C                     CALL 'PURZXFR'              90  Exc Remove orde
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0218  30       Company Number
     C                     PARM #1C4NB    WQ0219  70       Order Number
     C                     PARM #1RMNB    WQ0220  70       Load ID
     C           YL0028    PARM YL0028    WQ0221  1        Status - Y or N
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PURZXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C                     SETON                     84    SFLNXTCHG
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     GOTO EBEXIT
     C                     ELSE
      * SFLRCD valid
     C                     SETOF                     84    SFLNXTCHG
     C                     MOVEL*BLANK    #1SEL
     C                     END                             FI *IN98
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for Subfile record
      *================================================================
     C                     MOVEL'0'       *IN78
     C           #RWPST    IFEQ 'FZ'                       *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSA2    BEGSR
      *================================================================
      * Set display attributes for Subfile control
      *================================================================
     C                     MOVEL'0'       *IN79
     C           YL0029    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @BFCPNR fields to subfile
      *================================================================
     C                     MOVEL*BLANK    #1SEL
     C                     MOVELBEJNCD    #1JNCD           Order Type_Sale
     C                     Z-ADDBEANC7    #1ANC7           AR Customer Num
     C                     MOVELBEBRTX    #1BRTX           Ship To Name
     C                     MOVELBEHMNA    #1HMNA           Ship To Address
     C                     MOVELBEHONA    #1HONA           Ship To Address
     C                     MOVELBEHPNA    #1HPNA           Ship To Address
     C                     MOVELBEHNNA    #1HNNA           Ship To City
     C                     MOVELBEDBCD    #1DBCD           Ship To State C
     C                     MOVELBECKTX    #1CKTX           Ship To Zip_Pos
     C                     Z-ADDBEB0C7    #1B0C7           Bill to Custome
     C                     MOVELBEAETX    #1AETX           Bill to Name
     C                     MOVELBEB1NA    #1B1NA           Bill to Address
     C                     MOVELBEB3NA    #1B3NA           Bill to Address
     C                     MOVELBEB4NA    #1B4NA           Bill to Address
     C                     MOVELBEB2NA    #1B2NA           Bill to City
     C                     MOVELBEBHCD    #1BHCD           Bill to State C
     C                     MOVELBEC8TX    #1C8TX           Bill to Zip_Pos
     C                     MOVELBEBCNA    #1BCNA           Customer Purcha
     C                     Z-ADDBEA0DT    #1A0DT           Order Date
     C                     Z-ADDBEA5DT    #1A5DT           Requested Ship
     C                     Z-ADDBEGNDT    #1GNDT           Actual Shipped
     C                     Z-ADDBEACDT    #1ACDT           Cancel Date
     C                     MOVELBEAQCD    #1AQCD           Terms Code
     C                     MOVELBEB6NA    #1B6NA           Special Instruc
     C                     MOVELBEBYNA    #1BYNA           Special Instruc
     C                     MOVELBEGTST    #1GTST           Comment Print A
     C                     MOVELBEGVST    #1GVST           Comment Print I
     C                     MOVELBEGUST    #1GUST           Comment Print P
     C                     MOVELBEQFST    #1QFST           Comment Print S
     C                     MOVELBECQCD    #1CQCD           Reason Code
     C                     MOVELBEGJST    #1GJST           Order in Use
     C                     MOVELBEGWST    #1GWST           Header Status
     C                     MOVELBEGXST    #1GXST           Header Status L
     C                     MOVELBEGYST    #1GYST           Order Type Prin
     C                     MOVELBEAIVN    #1AIVN           User Original E
     C                     Z-ADDBECXDT    #1CXDT           Date of Origina
     C                     Z-ADDBEJZVA    #1JZVA           Order Value Tot
     C                     MOVELBEBZNA    #1BZNA           Carrier Code
     C                     MOVELBEXJST    #1XJST           Production Hold
     C                     MOVELBEXKST    #1XKST           New Customer Ho
     C                     Z-ADDBEAFTM    #1AFTM           Requested Deliv
     C                     MOVELBEE8CD    #1E8CD           Accounts Receiv
     C                     MOVELBEE9CD    #1E9CD           Accounts Receiv
     C                     Z-ADDBETBNB    #1TBNB           Absorbed Freigh
     C                     Z-ADDBER1NB    #1R1NB           Rated Freight
     C                     MOVELBEPJST    #1PJST           LTL Flag
     C                     MOVELBEU0ST    #1U0ST           Price Audit
     C                     MOVELBEU1ST    #1U1ST           Price Status
     C                     MOVELBEQ2CD    #1Q2CD           Shipping Method
     C                     MOVELBEU2ST    #1U2ST           Export Status
     C                     MOVELBEVEST    #1VEST           Palletize
     C                     MOVELBEVFST    #1VFST           Shrink Wrap
     C                     MOVELBEVGST    #1VGST           Slip Sheet
     C                     MOVELBERPCD    #1RPCD           Age Code
     C                     Z-ADDBERNNB    #1RNNB           Reefer Temperat
     C                     MOVELBEVDST    #1VDST           Load Type
     C                     Z-ADDBEATIN    #1ATIN           Attach to Invoi
     C                     MOVELBEU4ST    #1U4ST           Load Plan Order
     C                     MOVELBEU5ST    #1U5ST           Print Pick Slip
     C                     Z-ADDBERSRN    #1RSRN           Resell Referenc
     C                     MOVELBEMHNA    #1MHNA           Special Comment
     C                     MOVELBEMINA    #1MINA           Special Comment
     C                     MOVELBEWBST    #1WBST           Affect Auto Acc
     C                     MOVELBER4CD    #1R4CD           Sales Route Cod
     C                     MOVELBEBFCD    #1BFCD           Manager Level C
     C                     MOVELBEQ4CD    #1Q4CD           VP Level Code
     C                     Z-ADDBET3NB    #1T3NB           Attach to Order
     C                     MOVELBESICD    #1SICD           Reason for Pric
     C                     Z-ADDBECONB    #1CONB           Invoice Number
     C                     MOVELBECEST    #1CEST           Invoice Suffix
     C                     Z-ADDBEAWDT    #1AWDT           Invoice Date
     C                     MOVELBEJPCD    #1JPCD           Event Code
     C                     MOVELBEXUST    #1XUST           Trans Contol AS
     C                     MOVELBEZ1ST    #1Z1ST           Modified Flag
     C                     Z-ADDBEVRVA    #1VRVA           A_R order Value
     C                     MOVELBEOBST    #1OBST           Billing Activit
     C                     MOVELBEBDST    #1BDST           Order Certifica
     C                     Z-ADDBEB7VL    #1B7VL           Invoice Order V
     C                     MOVELBEGASX    #1GASX           Process Sts for
     C                     MOVELBEGBSX    #1GBSX           Order Conf Fax
     C                     MOVELBEGCSX    #1GCSX           Manifest Fax St
     C                     MOVELBEGDSX    #1GDSX           Invoice Fax Sts
     C                     MOVELBEFNSX    #1FNSX           Transfer in Sto
     C                     MOVELBEFOSX    #1FOSX           Email Cust On O
     C                     MOVELBEFPSX    #1FPSX           Order Emailed
     C                     MOVELBEFQSX    #1FQSX           Export Docs Go
     C                     MOVELBEFRSX    #1FRSX           Shipping Temp C
     C                     MOVELBEFSSX    #1FSSX           Broker Order St
     C                     MOVELBEFTSX    #1FTSX           Air Freight Ord
     C                     MOVELBEFUSX    #1FUSX           Order Requires
     C                     MOVELBEFVSX    #1FVSX           OH Load Plan Re
     C                     MOVELBEFWSX    #1FWSX           Export USDA App
     C                     MOVELBEFXSX    #1FXSX           HPB Ship to War
     C                     MOVELBEFYSX    #1FYSX           OH TF Exempt Co
     C                     Z-ADDBENODT    #1NODT           OH Appt Confirm
     C                     Z-ADDBENPDT    #1NPDT           JPN Invoice Iss
     C                     Z-ADDBENQDT    #1NQDT           Load Actual Shi
     C                     Z-ADDBENRDT    #1NRDT           Load BOL Comple
     C                     Z-ADDBENSDT    #1NSDT           Load Truck Depa
     C                     Z-ADDBEBPTM    #1BPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    #1BQTM           Time of Origina
     C                     Z-ADDBEBRTM    #1BRTM           OH Appt Confirm
     C                     Z-ADDBEBSTM    #1BSTM           Load BOL Comple
     C                     Z-ADDBEBTTM    #1BTTM           Load Truck Depa
     C                     Z-ADDBEH0NX    #1H0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    #1H1NX           Act Non_Ref Frt
     C                     Z-ADDBEH2NX    #1H2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    #1H3NX           OH Total Non_Re
     C                     Z-ADDBEH4NX    #1H4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    #1C0C7           Claim Number
     C                     MOVELBEUVST    #1UVST           EDI Status 1
     C                     MOVELBEUWST    #1UWST           EDI Status 2
     C                     MOVELBEUXST    #1UXST           EDI Status 3
     C                     Z-ADDBEAATM    #1AATM           Job Time
     C                     MOVELBEAYNA    #1AYNA           User Id
     C                     MOVELBEA0NA    #1A0NA           Job Name
     C                     Z-ADDBEAXDT    #1AXDT           Job Date
     C                     Z-ADDBEAODT    #1AODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V1AODT
     C                     Z-ADDBEEIDT    #1EIDT           Requested Deliv
      * Clear external version also
     C                     Z-ADD*ZERO     V1EIDT
     C                     MOVELBEXIST    #1XIST           Credit Hold
     C                     MOVELBEBCST    #1BCST           Block Order Fla
     C                     Z-ADDBERMNB    #1RMNB           Load ID
     C                     Z-ADDBEC4NB    #1C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V1C4NB
     C                     Z-ADDBEAIC3    #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     Z-ADDBEBKC7    #1BKC7           Ship To Custome
      * Clear external version also
     C                     MOVEL*BLANK    V1BKC7
     C                     Z-ADDBEA1WG    #1A1WG           Order Weight To
     C                     MOVEL*BLANK    #RCHTX           OHE Override Ty
     C                     MOVEL*BLANK    #RRYSX           MG Created Load
     C                     MOVEL*BLANK    #RWPST           Warehouse Type
     C                     MOVEL*BLANK    #RO9CD           USR Reason Code
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL*BLANK    #RAJCD           Warehouse Code
     C                     MOVEL*BLANK    #RAEST           USR Production
     C                     MOVEL*BLANK    #RPKST           Load Status
     C                     MOVEL*BLANK    #RODCD           USR Unit of Mea
     C                     MOVEL*BLANK    #RAYTX           Customer Name
     C                     Z-ADD*ZERO     #RT4NB           Schedule Sequen
     C                     MOVEL*BLANK    #RRMST           Load Acceptance
     C                     Z-ADD*ZERO     #RYANB           Deadline Depart
     C                     Z-ADD*ZERO     #RYBNB           Deadline Depart
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     MOVEL*BLANK    #CAJCD           Warehouse Code
     C                     MOVEL*BLANK    #CO9CD           USR Reason Code
     C                     MOVEL*BLANK    #2XKST           New Customer Ho
     C                     Z-ADD*ZERO     #2AODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V2AODT
     C                     MOVEL*BLANK    #CCPCD           USR Warehouse C
     C                     Z-ADD*ZERO     #2EIDT           Requested Deliv
      * Clear external version also
     C                     Z-ADD*ZERO     V2EIDT
     C                     MOVEL*BLANK    #2XJST           Production Hold
     C                     MOVEL*BLANK    #2XIST           Credit Hold
     C                     MOVEL*BLANK    #2BCST           Block Order Fla
     C                     Z-ADD*ZERO     #2RMNB           Load ID
     C                     MOVEL*BLANK    #CPKST           Load Status
     C                     MOVEL*BLANK    #CODCD           USR Unit of Mea
     C                     Z-ADD*ZERO     #2C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V2C4NB
     C                     Z-ADD*ZERO     #2AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V2AIC3
     C                     Z-ADD*ZERO     #2BKC7           Ship To Custome
      * Clear external version also
     C                     MOVEL*BLANK    V2BKC7
     C                     MOVEL*BLANK    #CAYTX           Customer Name
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #1AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1AODT
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  #1EIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1EIDT
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1BKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1BKC7           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #2AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2AODT
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  #2EIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2EIDT
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V2AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2BKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2BKC7           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         NARVGN    BEGSR
      *================================================================
      * RTV All Whses on Load  RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0228           USR Warehouse C
     C                     MOVEL*BLANK    WL0229           USR CDE Parm 1
     C                     MOVEL*BLANK    WL0230           USR CDE Parm 2
     C                     MOVEL*BLANK    WL0231           USR CDE Parm 3
     C                     MOVEL*BLANK    WL0232           USR CDE Parm 4
     C                     MOVEL*BLANK    WL0233           USR CDE Parm 5
     C                     MOVEL*BLANK    WL0234           USR CDE Parm 6
     C                     MOVEL*BLANK    WL0235           USR CDE Parm 7
     C                     MOVEL*BLANK    WL0236           USR CDE Parm 8
     C                     MOVEL*BLANK    WL0237           USR CDE Parm 9
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMRMNB    WQNA02           Load ID
      * Define keylist
     C           KRSNA     KLIST
     C                     KFLD           WQNA02           Load ID
      * Setup key
     C                     Z-ADDWL0227    WQNA02           Load ID
      * Establish starting position
     C           KRSNA     SETLL@FLCPKF                    *
     C           KRSNA     READE@FLCPKF                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV All Whses on Order RT - Order Detail  * 
     C                     EXSR NBRVGN
     C           KRSNA     READE@FLCPKF                  90*
     C                     ENDDO
      *================================================================
     CSR         NAEXIT    ENDSR
      /EJECT
     CSR         NBRVGN    BEGSR
      *================================================================
      * RTV All Whses on Order RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQNB01           Company Number
     C           *LIKE     DEFN WCC4NB    WQNB02           Order Number
      * Define keylist
     C           KPSNB     KLIST
     C                     KFLD           WQNB01           Company Number
     C                     KFLD           WQNB02           Order Number
     C                     KFLD           WCDPNB           Order Sequence
     C                     KFLD           WCUENB           Order Secondary
      * Define keylist
     C           KRSNB     KLIST
     C                     KFLD           WQNB01           Company Number
     C                     KFLD           WQNB02           Order Number
      * Setup key
     C                     Z-ADDWMAIC3    WQNB01           Company Number
     C                     Z-ADDWMC4NB    WQNB02           Order Number
     C                     Z-ADD*ZERO     WCDPNB           Order Sequence
     C                     Z-ADD*ZERO     WCUENB           Order Secondary
      * Establish starting position
     C           KPSNB     SETLL@BGWKAE                    *
     C           KRSNB     READE@BGWKAE                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Warehouse Code EQ PAR.USR Warehouse Code
     C           WCAJCD    IFEQ WL0228                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 1
     C           WCAJCD    IFEQ WL0229                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 2
     C           WCAJCD    IFEQ WL0230                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 3
     C           WCAJCD    IFEQ WL0231                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 4
     C           WCAJCD    IFEQ WL0232                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 5
     C           WCAJCD    IFEQ WL0233                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 6
     C           WCAJCD    IFEQ WL0234                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 7
     C           WCAJCD    IFEQ WL0235                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 8
     C           WCAJCD    IFEQ WL0236                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 9
     C           WCAJCD    IFEQ WL0237                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * current warehouse not already being used
      * Fill in first blank warehouse
      * CASE: PAR.USR Warehouse Code EQ WRK.BLANK
     C           WL0228    IFEQ WUGSTX                     *IF
     C                     MOVELWCAJCD    WL0228           USR Warehouse C
     C                     ELSE
      * CASE: PAR.USR CDE Parm 1 EQ WRK.BLANK
     C           WL0229    IFEQ WUGSTX                     *IF
     C                     MOVELWCAJCD    WL0229           USR CDE Parm 1
     C                     ELSE
      * CASE: PAR.USR CDE Parm 2 EQ WRK.BLANK
     C           WL0230    IFEQ WUGSTX                     *IF
     C                     MOVELWCAJCD    WL0230           USR CDE Parm 2
     C                     ELSE
      * CASE: PAR.USR CDE Parm 3 EQ WRK.BLANK
     C           WL0231    IFEQ WUGSTX                     *IF
     C                     MOVELWCAJCD    WL0231           USR CDE Parm 3
     C                     ELSE
      * CASE: PAR.USR CDE Parm 4 EQ WRK.BLANK
     C           WL0232    IFEQ WUGSTX                     *IF
     C                     MOVELWCAJCD    WL0232           USR CDE Parm 4
     C                     ELSE
      * CASE: PAR.USR CDE Parm 5 EQ WRK.BLANK
     C           WL0233    IFEQ WUGSTX                     *IF
     C                     MOVELWCAJCD    WL0233           USR CDE Parm 5
     C                     ELSE
      * CASE: PAR.USR CDE Parm 6 EQ WRK.BLANK
     C           WL0234    IFEQ WUGSTX                     *IF
     C                     MOVELWCAJCD    WL0234           USR CDE Parm 6
     C                     ELSE
      * CASE: PAR.USR CDE Parm 7 EQ WRK.BLANK
     C           WL0235    IFEQ WUGSTX                     *IF
     C                     MOVELWCAJCD    WL0235           USR CDE Parm 7
     C                     ELSE
      * CASE: PAR.USR CDE Parm 8 EQ WRK.BLANK
     C           WL0236    IFEQ WUGSTX                     *IF
     C                     MOVELWCAJCD    WL0236           USR CDE Parm 8
     C                     ELSE
      * CASE: PAR.USR CDE Parm 9 EQ WRK.BLANK
     C           WL0237    IFEQ WUGSTX                     *IF
     C                     MOVELWCAJCD    WL0237           USR CDE Parm 9
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSNB     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         NBEXIT    ENDSR
      /EJECT
     CSR         NCRVGN    BEGSR
      *================================================================
      * zzV for Accusort Load  RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WORMNB    WQNC01           Load ID
      * Define keylist
     C           KRSNC     KLIST
     C                     KFLD           WQNC01           Load ID
      * Setup key
     C                     Z-ADDWL0238    WQNC01           Load ID
      * Establish starting position
     C           KRSNC     SETLL@FLCPBW                    *
     C           KRSNC     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Trans Control      RT - PD Order Header      TRG  * 
     C                     EXSR NDRVGN
      * CASE: WRK.Trans Contol AS400/Plant is Plant
     C           WUXUST    IFEQ 'P'                        *IF
     C                     MOVELWUXUST    WL0239           Trans Contol AS
     C                     GOTO NCEXIT                     *QUIT
     C                     END                             *FI
     C           KRSNC     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         NCEXIT    ENDSR
      /EJECT
     CSR         NDRVGN    BEGSR
      *================================================================
      * RTV Trans Control      RT - PD Order Header      TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSND     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
      * Setup key
     C                     Z-ADDWOAIC3    WEAIC3           Company Number
     C                     Z-ADDWOC4NB    WEC4NB           Order Number
      * Establish starting position
     C           KRSND     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUXUST           Trans Contol AS
     C                     GOTO NDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * RTV Trans Control      RT - PD Order Detail  * 
     C                     EXSR NERVGN
      * CASE: WRK.Trans Contol AS400/Plant is Plant
     C           WUXUST    IFEQ 'P'                        *IF
     C                     MOVELWUXUST    WUXUST           Trans Contol AS
     C                     GOTO NDEXIT                     *QUIT
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         NDEXIT    ENDSR
      /EJECT
     CSR         NERVGN    BEGSR
      *================================================================
      * RTV Trans Control      RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQNE01           Company Number
     C           *LIKE     DEFN OMC4NB    WQNE02           Order Number
      * Define keylist
     C           KRSNE     KLIST
     C                     KFLD           WQNE01           Company Number
     C                     KFLD           WQNE02           Order Number
      * Setup key
     C                     Z-ADDWEAIC3    WQNE01           Company Number
     C                     Z-ADDWEC4NB    WQNE02           Order Number
      * Establish starting position
     C           KRSNE     SETLL@BGWKL1                    *
     C           KRSNE     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           OMGMST    IFEQ 'L'                        *IF
     C           OMGMST    OREQ 'A'
     C           OMGMST    OREQ 'C'
     C           OMGMST    OREQ 'R'
     C           OMGMST    OREQ 'E'
     C           OMGMST    OREQ 'H'
     C           OMGMST    OREQ 'I'
      * Rtv Desc/Trans Control RT - Warehouse  * 
     C                     EXSR NFRVGN
     C                     GOTO NEEXIT                     *QUIT
     C                     END                             *FI
     C           KRSNE     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         NEEXIT    ENDSR
      /EJECT
     CSR         NFRVGN    BEGSR
      *================================================================
      * Rtv Desc/Trans Control RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNF     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELOMAJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSNF     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUF8NA           Warehouse Descr
     C                     MOVEL*BLANK    WUXUST           Trans Contol AS
     C                     GOTO NFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADF8NA    WUF8NA           Warehouse Descr
     C                     MOVELADXUST    WUXUST           Trans Contol AS
     C                     ENDIF
      *================================================================
     CSR         NFEXIT    ENDSR
      /EJECT
     CSR         NGRVGN    BEGSR
      *================================================================
      * Rtv Active Status     RT - PFS Interface  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNG     KLIST
     C                     KFLD           BUY1NX           PFS Company Num
     C                     KFLD           BUGYAA           PFS Interface C
      * Setup key
     C                     Z-ADDWL0240    BUY1NX           PFS Company Num
     C                     MOVELWL0241    BUGYAA           PFS Interface C
      * Establish starting position
     C           KRSNG     CHAIN@BUREBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3541' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0242           PFS AccuSort Ac
     C                     MOVEL*BLANK    WL0243           PFS Carlisle Ac
     C                     GOTO NGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBUWSSX    WL0242           PFS AccuSort Ac
     C                     MOVELBUWUSX    WL0243           PFS Carlisle Ac
     C                     ENDIF
      *================================================================
     CSR         NGEXIT    ENDSR
      /EJECT
     CSR         NHRVGN    BEGSR
      *================================================================
      * RTV Check/Chg Releasd RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQNH01           Company Number
     C           *LIKE     DEFN OMC4NB    WQNH02           Order Number
      * Define keylist
     C           KPSNH     KLIST
     C                     KFLD           WQNH01           Company Number
     C                     KFLD           WQNH02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSNH     KLIST
     C                     KFLD           WQNH01           Company Number
     C                     KFLD           WQNH02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQNH01           Company Number
     C                     Z-ADD#1C4NB    WQNH02           Order Number
     C                     Z-ADD*ZERO     OMDPNB           Order Sequence
     C                     Z-ADD*ZERO     OMUENB           Order Secondary
      * Establish starting position
     C           KPSNH     SETLL@BGWKL1                    *
     C           KRSNH     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Cancelled
     C           OMGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Released by User Sts Y/N is yes
     C           OMF3SX    IFEQ 'Y'                        *IF
      * CHG Released by User  CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDOMAIC3    WL0081           Company Number
     C                     Z-ADDOMC4NB    WL0082           Order Number
     C                     Z-ADDOMDPNB    WL0083           Order Sequence
     C                     Z-ADDOMUENB    WL0084           Order Secondary
     C                     MOVEL'N'       WL0085    P      Released by Use
     C                     EXSR TDCHRC
     C                     END                             *FI
     C                     END                             *FI
     C           KRSNH     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         NHEXIT    ENDSR
      /EJECT
     CSR         NIRVGN    BEGSR
      *================================================================
      * RTV Load Acceptance Sw RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNI     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSNI     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WURMST           Load Acceptance
     C                     MOVEL*BLANK    P8RYSX           MG Created Load
     C                     GOTO NIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFJRMST    WURMST           Load Acceptance
     C                     MOVELFJRYSX    P8RYSX           MG Created Load
     C                     ENDIF
      *================================================================
     CSR         NIEXIT    ENDSR
      /EJECT
     CSR         NJCHRC    BEGSR
      *================================================================
      * CHG Ld Sts,Rated Frts  CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1032  30       Company Number
     C                     Z-ADD*ZERO     WN1033  70       Scheduled Ship
     C                     MOVEL*BLANK    WN1034  1        LTL Flag
     C                     Z-ADD*ZERO     WN1035  52       Reefer Temperat
     C                     MOVEL*BLANK    WN1036 15        Seal 1
     C                     MOVEL*BLANK    WN1037 15        Seal 2
     C                     MOVEL*BLANK    WN1038 15        Seal 3
     C                     MOVEL*BLANK    WN1039 15        Seal 4
     C                     MOVEL*BLANK    WN1040 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN1041  70       Total Load Orde
     C                     Z-ADD*ZERO     WN1042 112       Flat Amount
     C                     MOVEL*BLANK    WN1043  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN1044  50       Total Stops
     C                     MOVEL*BLANK    WN1045 20        Trailer Id
     C                     MOVEL*BLANK    WN1046  3        Transloader Car
     C                     Z-ADD*ZERO     WN1047  40       BOL Time
     C                     MOVEL*BLANK    WN1048  3        Carrier Code
     C                     MOVEL*BLANK    WN1049  7        Truck Size
     C                     Z-ADD*ZERO     WN1050  70       Ld Hdr_Ld Dtl U
     C                     MOVEL*BLANK    WN1051  1        Ship Status
     C                     MOVEL*BLANK    WN1052  1        Load Type
     C                     Z-ADD*ZERO     WN1053  50       Number Pallets
     C                     Z-ADD*ZERO     WN1054  50       Number Pallets
     C                     Z-ADD*ZERO     WN1055 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN1056  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN1057  70       Actual Arrival
     C                     Z-ADD*ZERO     WN1058  40       Actual Arrival
     C                     Z-ADD*ZERO     WN1059 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN1060 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN1061  70       Actual Departur
     C                     Z-ADD*ZERO     WN1062  40       Departure Time
     C                     Z-ADD*ZERO     WN1063  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN1064  52       Product Tempera
     C                     Z-ADD*ZERO     WN1065  50       Number Spacers
     C                     MOVEL*BLANK    WN1066 12        Car_Veh_Initial
     C                     Z-ADD*ZERO     WN1067  70       Total Load Mile
     C                     MOVEL*BLANK    WN1068 12        Recorder ID
     C                     MOVEL*BLANK    WN1069  2        Shipping Method
     C                     MOVEL*BLANK    WN1070  3        Ship From Wareh
     C                     MOVEL*BLANK    WN1071  2        Ship To State C
     C                     Z-ADD*ZERO     WN1072  70       Gross Weight
     C                     MOVEL*BLANK    WN1073  3        Carrier Broker
     C                     MOVEL*BLANK    WN1074  1        Export Status
     C                     Z-ADD*ZERO     WN1075  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN1076  1        On Time_Y_N
     C                     Z-ADD*ZERO     WN1077  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN1078  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN1079  70       Spotted Date
     C                     Z-ADD*ZERO     WN1080  60       Spotted Time
     C                     Z-ADD*ZERO     WN1081  70       Load Finished D
     C                     Z-ADD*ZERO     WN1082  60       Load Finished T
     C                     Z-ADD*ZERO     WN1083  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN1084  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN1085  70       BOL Received Da
     C                     Z-ADD*ZERO     WN1086  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN1087  70       Truck Departure
     C                     Z-ADD*ZERO     WN1088  60       Truck Departure
     C                     Z-ADD*ZERO     WN1089  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN1090  60       Adjusted Depart
     C                     MOVEL*BLANK    WN1091  3        Shipping Line
     C                     MOVEL*BLANK    WN1092 20        Port Delv Termi
     C                     MOVEL*BLANK    WN1093 30        Vessel Name
     C                     Z-ADD*ZERO     WN1094  50       Voyage
     C                     Z-ADD*ZERO     WN1095  70       Sail Date
     C                     MOVEL*BLANK    WN1096 12        Booking Number
     C                     MOVEL*BLANK    WN1097 20        Discharge Port
     C                     Z-ADD*ZERO     WN1098  70       Arrival Date
     C                     MOVEL*BLANK    WN1099 12        Container Numbe
     C                     Z-ADD*ZERO     WN1100  70       Date In
     C                     Z-ADD*ZERO     WN1101  60       Time In
     C                     Z-ADD*ZERO     WN1102  70       Date Out
     C                     Z-ADD*ZERO     WN1103  60       Time Out
     C                     Z-ADD*ZERO     WN1104 112       Load Total Frei
     C                     Z-ADD*ZERO     WN1105  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN1106  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN1107  1        LH Unused Sts
     C                     MOVEL*BLANK    WN1108  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN1109  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN1110  70       Requested Deliv
     C                     MOVEL*BLANK    WN1111  1        Load Acceptance
     C                     MOVEL*BLANK    WN1112  3        Warehouse Code
     C                     Z-ADD*ZERO     WN1113  70       On Yard Date
     C                     Z-ADD*ZERO     WN1114  60       On Yard Time
     C                     Z-ADD*ZERO     WN1115  70       Deadline Depart
     C                     Z-ADD*ZERO     WN1116  60       Deadline Depart
     C                     MOVEL*BLANK    WN1117  1        Load Held Over
     C                     MOVEL*BLANK    WN1118  1        Load Held Over
     C                     MOVEL*BLANK    WN1119 15        Load Held Over
     C                     MOVEL*BLANK    WN1120 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN1121 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN1122  70       Express Mail Da
     C                     MOVEL*BLANK    WN1123  1        Load Shag Flag
     C                     MOVEL*BLANK    WN1124  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN1125  70       Product Complet
     C                     Z-ADD*ZERO     WN1126  60       Product Complet
     C                     Z-ADD*ZERO     WN1127  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN1128  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN1129  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN1130  1        Load Confirmed
     C                     MOVEL*BLANK    WN1131 25        Load Confirmed
     C                     Z-ADD*ZERO     WN1132  70       Load Confirmati
     C                     Z-ADD*ZERO     WN1133  60       Load Door 1
     C                     Z-ADD*ZERO     WN1134  70       Override Total
     C                     Z-ADD*ZERO     WN1135  60       Load Door 2
     C                     MOVEL*BLANK    WN1136  1        Partial Load
     C                     MOVEL*BLANK    WN1137  1        Load Confirmati
     C                     MOVEL*BLANK    WN1138  1        Export Load USD
     C                     MOVEL*BLANK    WN1139  1        Late Delivery E
     C                     Z-ADD*ZERO     WN1140 112       Load Actual Fre
     C                     MOVEL*BLANK    WN1141 15        Hide on WW Load
     C                     MOVEL*BLANK    WN1142 15        Late Billing Em
     C                     MOVEL*BLANK    WN1143 25        Shipping Temp C
     C                     MOVEL*BLANK    WN1144 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN1145  1        Multi Company L
     C                     MOVEL*BLANK    WN1146  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN1147  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN1148  1        LH Power Only L
     C                     MOVEL*BLANK    WN1149  1        MG Created Load
     C                     MOVEL*BLANK    WN1150  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN1151  2        Load U_M
     C                     MOVEL*BLANK    WN1152  2        TPM Shipment St
     C                     MOVEL*BLANK    WN1153  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN1154  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN1155  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN1156  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN1157  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN1158  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN1159  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN1160  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN1161  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN1162  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN1163  60       LH Unused Time
     C                     Z-ADD*ZERO     WN1164  70       LH Unused Date
     C                     Z-ADD*ZERO     WN1165  60       LH Unused Time
     C                     Z-ADD*ZERO     WN1166  70       LH Unused Date
     C                     Z-ADD*ZERO     WN1167  60       LH Unused Time
     C                     MOVEL*BLANK    WN1168  1        EDI Status 1
     C                     MOVEL*BLANK    WN1169  1        EDI Status 2
     C                     MOVEL*BLANK    WN1170  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1171  60       Job Time
     C                     MOVEL*BLANK    WN1172 10        User Id
     C                     MOVEL*BLANK    WN1173 10        Job Name
     C                     Z-ADD*ZERO     WN1174  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YHRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADD#1RMNB    WKRMNB           Load ID
      *
     C           KLCHNJ    KLIST
     C                     KFLD           WKRMNB           Load ID
     C           KLCHNJ    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YHRDCS
      * Move non-key fields to @FJCPBO
     C                     MOVEL'U'       WKPKST    P      Load Status
     C                     Z-ADD*ZERO     WKR1NB           Rated Freight
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WKAATM           Job Time
     C                     MOVEL##USR     WKAYNA           User Id
     C                     MOVEL##PGM     WKA0NA           Job Name
     C                     Z-ADD##JDT     WKAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YHRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NJEXIT    ENDSR
      /EJECT
     CSR         NKRVGN    BEGSR
      *================================================================
      * RTV System Value Alpha RT - System Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNK     KLIST
     C                     KFLD           DPDOCD           System Value Co
      * Setup key
     C                     MOVEL@CN,019   DPDOCD           System Value Co
      * Establish starting position
     C           KRSNK     CHAIN@DPRETD              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0759' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0025           System Value Al
     C                     GOTO NKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDPBXTX    YL0025           System Value Al
     C                     ENDIF
      *================================================================
     CSR         NKEXIT    ENDSR
      /EJECT
     CSR         NLRVGN    BEGSR
      *================================================================
      * CHG Clear Rated Frt    RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQNL02           Load ID
      * Define keylist
     C           KRSNL     KLIST
     C                     KFLD           WQNL02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQNL02           Load ID
      * Establish starting position
     C           KRSNL     SETLL@FLCPEB                    *
     C           KRSNL     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Recovery Freight   CH - Load Detail  * 
     C                     EXSR NMCHRC
      * CHG Clear Rated Frt    RT - PD Order Header  * 
     C                     EXSR NNRVGN
     C           KRSNL     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         NLEXIT    ENDSR
      /EJECT
     CSR         NMCHRC    BEGSR
      *================================================================
      * CHG Recovery Freight   CH - Load Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1179  50       Stop_Drop
     C                     MOVEL*BLANK    WN1180 30        Comments for Pi
     C                     Z-ADD*ZERO     WN1181  72       Freight Charge
     C                     Z-ADD*ZERO     WN1182  70       Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WN1183  30       Company Number
     C                     Z-ADD*ZERO     WN1184  70       Order Number
     C                     MOVEL*BLANK    WN1185  1        Ship Status
     C                     Z-ADD*ZERO     WN1186  70       Estimated Arriv
     C                     Z-ADD*ZERO     WN1187  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN1188  70       Appointment Con
     C                     Z-ADD*ZERO     WN1189  60       Appointment Con
     C                     MOVEL*BLANK    WN1190 30        Confirmation Ma
     C                     MOVEL*BLANK    WN1191 10        Confirmation Nu
     C                     Z-ADD*ZERO     WN1192  70       Actual Delivery
     C                     Z-ADD*ZERO     WN1193  60       Actual Delivery
     C                     Z-ADD*ZERO     WN1194  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN1195  60       Scheduled Deliv
     C                     Z-ADD*ZERO     WN1196  70       Deadline Depart
     C                     Z-ADD*ZERO     WN1197  60       Deadline Depart
     C                     Z-ADD*ZERO     WN1198  70       On Yard Date
     C                     Z-ADD*ZERO     WN1199  60       On Yard Time
     C                     Z-ADD*ZERO     WN1200  70       MPC Number
     C                     MOVEL*BLANK    WN1201  1        Load Dtl On Tim
     C                     MOVEL*BLANK    WN1202  1        On Time Addl Rs
     C                     MOVEL*BLANK    WN1203 15        Seal Nbr 1
     C                     MOVEL*BLANK    WN1204 15        Seal Nbr 2
     C                     MOVEL*BLANK    WN1205 15        Seal Nbr 3
     C                     MOVEL*BLANK    WN1206 15        Seal Nbr 4
     C                     MOVEL*BLANK    WN1207 15        Seal Nbr 5
     C                     Z-ADD*ZERO     WN1208  70       LD Carrier Appt
     C                     Z-ADD*ZERO     WN1209  70       LD Unused Date
     C                     Z-ADD*ZERO     WN1210  70       LD Unused Date
     C                     Z-ADD*ZERO     WN1211  60       LD Carrier Appt
     C                     Z-ADD*ZERO     WN1212  60       LD Unused Time
     C                     Z-ADD*ZERO     WN1213  60       LD Unused Time
     C                     MOVEL*BLANK    WN1214  1        Miles Error Sts
     C                     MOVEL*BLANK    WN1215  1        LD Unused Sts 2
     C                     MOVEL*BLANK    WN1216  2        HPB Transload S
     C                     MOVEL*BLANK    WN1217 15        LD Cst Svc Trac
     C                     MOVEL*BLANK    WN1218 25        Carrier Ref PRO
     C                     MOVEL*BLANK    WN1219 25        Cust Assigned A
     C                     MOVEL*BLANK    WN1220  1        EDI Status 1
     C                     MOVEL*BLANK    WN1221  1        EDI Status 2
     C                     MOVEL*BLANK    WN1222  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1223  60       Job Time
     C                     MOVEL*BLANK    WN1224 10        User Id
     C                     MOVEL*BLANK    WN1225 10        Job Name
     C                     Z-ADD*ZERO     WN1226  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YIRDC   1
      *
      * Move key fields to @FLCPBM
     C                     Z-ADDFLRMNB    WRRMNB           Load ID
     C                     Z-ADDFLRUNB    WRRUNB           Stop_Drop Seque
      *
     C           KLCHNM    KLIST
     C                     KFLD           WRRMNB           Load ID
     C                     KFLD           WRRUNB           Stop_Drop Seque
     C           KLCHNM    CHAIN@FLCPBM              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFLCPL0'MDACP
     C                     MOVEL'@FLCPBM' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL009.
     C                     MOVEL'LBL009'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NMEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NMEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFL1    YIRDCS
      * Move non-key fields to @FLCPBM
     C                     Z-ADDFLRWNB    WRRWNB           Miles to next s
     C                     Z-ADD*ZERO     WRT0NB           Freight Misc_Ch
     C                     Z-ADD*ZERO     WRT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WRR1NB           Rated Freight
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WRAATM' defaulted for 'Job Time'.
      * Field '(DB1) WRAYNA' defaulted for 'User Id'.
      * Field '(DB1) WRA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WRAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WRAATM           Job Time
     C                     MOVEL##USR     WRAYNA           User Id
     C                     MOVEL##JOB     WRA0NA           Job Name
     C                     Z-ADD##JDT     WRAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YIRDC     IFEQ 'Y'
     C                     UPDAT@FLCPBM                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFLCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NMEXIT    ENDSR
      /EJECT
     CSR         NNRVGN    BEGSR
      *================================================================
      * CHG Clear Rated Frt    RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/12/04 SLM PKTR01 Multi-Company - Function was changed
      *                                     to remove Company RST or Pos
      * Declare restrictor key work fields
     C           *LIKE     DEFN WSRMNB    WQNN02           Load ID
     C           *LIKE     DEFN WSC4NB    WQNN03           Order Number
      * Define keylist
     C           KRSNN     KLIST
     C                     KFLD           WQNN02           Load ID
     C                     KFLD           WQNN03           Order Number
      * Setup key
     C                     Z-ADDFLRMNB    WQNN02           Load ID
     C                     Z-ADDFLC4NB    WQNN03           Order Number
      * Establish starting position
     C           KRSNN     SETLL@BFCPNQ                    *
     C           KRSNN     READE@BFCPNQ                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Rated Freight      CH - PD Order Header  * 
     C                     EXSR NOCHRC
      * 05/13/04 slm Multi-Company - Order Header lv remove co must use d
      *                               was using the par replace with db1
      * UPD Rated Freight      RT - Order Detail  * 
     C                     EXSR NPRVGN
     C           KRSNN     READE@BFCPNQ                  90*
     C                     ENDDO
      *================================================================
     CSR         NNEXIT    ENDSR
      /EJECT
     CSR         NOCHRC    BEGSR
      *================================================================
      * CHG Rated Freight      CH - PD Order Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN1227  2        Order Type_Sale
     C                     Z-ADD*ZERO     WN1228  70       AR Customer Num
     C                     Z-ADD*ZERO     WN1229  70       Ship To Custome
     C                     MOVEL*BLANK    WN1230 30        Ship To Name
     C                     MOVEL*BLANK    WN1231 30        Ship To Address
     C                     MOVEL*BLANK    WN1232 30        Ship To Address
     C                     MOVEL*BLANK    WN1233 30        Ship To Address
     C                     MOVEL*BLANK    WN1234 20        Ship To City
     C                     MOVEL*BLANK    WN1235  2        Ship To State C
     C                     MOVEL*BLANK    WN1236 11        Ship To Zip_Pos
     C                     Z-ADD*ZERO     WN1237  70       Bill to Custome
     C                     MOVEL*BLANK    WN1238 30        Bill to Name
     C                     MOVEL*BLANK    WN1239 30        Bill to Address
     C                     MOVEL*BLANK    WN1240 30        Bill to Address
     C                     MOVEL*BLANK    WN1241 30        Bill to Address
     C                     MOVEL*BLANK    WN1242 20        Bill to City
     C                     MOVEL*BLANK    WN1243  2        Bill to State C
     C                     MOVEL*BLANK    WN1244 11        Bill to Zip_Pos
     C                     MOVEL*BLANK    WN1245 15        Customer Purcha
     C                     Z-ADD*ZERO     WN1246  70       Order Date
     C                     Z-ADD*ZERO     WN1247  70       Requested Ship
     C                     Z-ADD*ZERO     WN1248  70       Actual Shipped
     C                     Z-ADD*ZERO     WN1249  70       Cancel Date
     C                     MOVEL*BLANK    WN1250  2        Terms Code
     C                     MOVEL*BLANK    WN1251 40        Special Instruc
     C                     MOVEL*BLANK    WN1252 40        Special Instruc
     C                     MOVEL*BLANK    WN1253  3        Carrier Code
     C                     MOVEL*BLANK    WN1254  1        Comment Print A
     C                     MOVEL*BLANK    WN1255  1        Comment Print I
     C                     MOVEL*BLANK    WN1256  1        Comment Print P
     C                     MOVEL*BLANK    WN1257  1        Comment Print S
     C                     MOVEL*BLANK    WN1258  3        Reason Code
     C                     MOVEL*BLANK    WN1259  1        Order in Use
     C                     MOVEL*BLANK    WN1260  1        Header Status
     C                     MOVEL*BLANK    WN1261  1        Header Status L
     C                     MOVEL*BLANK    WN1262  1        Order Type Prin
     C                     Z-ADD*ZERO     WN1263  70       Scheduled Ship
     C                     MOVEL*BLANK    WN1264 10        User Original E
     C                     Z-ADD*ZERO     WN1265  70       Date of Origina
     C                     Z-ADD*ZERO     WN1266 112       Order Value Tot
     C                     Z-ADD*ZERO     WN1267 112       Order Weight To
     C                     MOVEL*BLANK    WN1268  1        Credit Hold
     C                     MOVEL*BLANK    WN1269  1        Production Hold
     C                     MOVEL*BLANK    WN1270  1        New Customer Ho
     C                     Z-ADD*ZERO     WN1271  70       Requested Deliv
     C                     Z-ADD*ZERO     WN1272  40       Requested Deliv
     C                     MOVEL*BLANK    WN1273  4        Accounts Receiv
     C                     MOVEL*BLANK    WN1274 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN1275  70       Load ID
     C                     Z-ADD*ZERO     WN1276  52       Absorbed Freigh
     C                     MOVEL*BLANK    WN1277  1        LTL Flag
     C                     MOVEL*BLANK    WN1278  1        Price Audit
     C                     MOVEL*BLANK    WN1279  1        Price Status
     C                     MOVEL*BLANK    WN1280  2        Shipping Method
     C                     MOVEL*BLANK    WN1281  1        Export Status
     C                     MOVEL*BLANK    WN1282  1        Palletize
     C                     MOVEL*BLANK    WN1283  1        Shrink Wrap
     C                     MOVEL*BLANK    WN1284  1        Slip Sheet
     C                     MOVEL*BLANK    WN1285  1        Age Code
     C                     Z-ADD*ZERO     WN1286  52       Reefer Temperat
     C                     MOVEL*BLANK    WN1287  1        Load Type
     C                     Z-ADD*ZERO     WN1288  70       Attach to Invoi
     C                     MOVEL*BLANK    WN1289  1        Load Plan Order
     C                     MOVEL*BLANK    WN1290  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN1291  70       Resell Referenc
     C                     MOVEL*BLANK    WN1292 30        Special Comment
     C                     MOVEL*BLANK    WN1293 30        Special Comment
     C                     MOVEL*BLANK    WN1294  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN1295  3        Sales Route Cod
     C                     MOVEL*BLANK    WN1296  2        Manager Level C
     C                     MOVEL*BLANK    WN1297  3        VP Level Code
     C                     Z-ADD*ZERO     WN1298  70       Attach to Order
     C                     MOVEL*BLANK    WN1299  3        Reason for Pric
     C                     Z-ADD*ZERO     WN1300  70       Invoice Number
     C                     MOVEL*BLANK    WN1301  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN1302  70       Invoice Date
     C                     MOVEL*BLANK    WN1303  2        Event Code
     C                     MOVEL*BLANK    WN1304  1        Trans Contol AS
     C                     MOVEL*BLANK    WN1305  1        Modified Flag
     C                     Z-ADD*ZERO     WN1306 112       A_R order Value
     C                     MOVEL*BLANK    WN1307  1        Billing Activit
     C                     MOVEL*BLANK    WN1308  1        Block Order Fla
     C                     MOVEL*BLANK    WN1309  1        Order Certifica
     C                     Z-ADD*ZERO     WN1310 112       Invoice Order V
     C                     MOVEL*BLANK    WN1311  1        Process Sts for
     C                     MOVEL*BLANK    WN1312  1        Order Conf Fax
     C                     MOVEL*BLANK    WN1313  1        Manifest Fax St
     C                     MOVEL*BLANK    WN1314  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN1315  1        Transfer in Sto
     C                     MOVEL*BLANK    WN1316  1        Email Cust On O
     C                     MOVEL*BLANK    WN1317  1        Order Emailed
     C                     MOVEL*BLANK    WN1318  1        Export Docs Go
     C                     MOVEL*BLANK    WN1319  1        Shipping Temp C
     C                     MOVEL*BLANK    WN1320  1        Broker Order St
     C                     MOVEL*BLANK    WN1321  1        Air Freight Ord
     C                     MOVEL*BLANK    WN1322  2        Order Requires
     C                     MOVEL*BLANK    WN1323  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN1324  2        Export USDA App
     C                     MOVEL*BLANK    WN1325  3        HPB Ship to War
     C                     MOVEL*BLANK    WN1326  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN1327  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN1328  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN1329  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN1330  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN1331  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN1332  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN1333  60       Time of Origina
     C                     Z-ADD*ZERO     WN1334  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN1335  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN1336  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN1337 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN1338 112       Act Non_Ref Frt
     C                     Z-ADD*ZERO     WN1339 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN1340 112       OH Total Non_Re
     C                     Z-ADD*ZERO     WN1341 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN1342  70       Claim Number
     C                     MOVEL*BLANK    WN1343  1        EDI Status 1
     C                     MOVEL*BLANK    WN1344  1        EDI Status 2
     C                     MOVEL*BLANK    WN1345  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1346  60       Job Time
     C                     MOVEL*BLANK    WN1347 10        User Id
     C                     MOVEL*BLANK    WN1348 10        Job Name
     C                     Z-ADD*ZERO     WN1349  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YJRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWSAIC3    WJAIC3           Company Number
     C                     Z-ADDWSC4NB    WJC4NB           Order Number
      *
     C           KLCHNO    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJC4NB           Order Number
     C           KLCHNO    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL010.
     C                     MOVEL'LBL010'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NOEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NOEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YJRDCS
      * Move non-key fields to @BECPFJ
     C                     Z-ADD*ZERO     WJR1NB           Rated Freight
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##PGM     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPBRC
     C                     Z-ADDWJAIC3    PBAIC3           Company Number
     C                     Z-ADDWJC4NB    PBC4NB           Order Number
     C                     MOVELWJJNCD    PBJNCD    P      Order Type_Sale
     C                     Z-ADDWJANC7    PBANC7           AR Customer Num
     C                     Z-ADDWJBKC7    PBBKC7           Ship To Custome
     C                     MOVELWJBRTX    PBBRTX    P      Ship To Name
     C                     MOVELWJHMNA    PBHMNA    P      Ship To Address
     C                     MOVELWJHONA    PBHONA    P      Ship To Address
     C                     MOVELWJHPNA    PBHPNA    P      Ship To Address
     C                     MOVELWJHNNA    PBHNNA    P      Ship To City
     C                     MOVELWJDBCD    PBDBCD    P      Ship To State C
     C                     MOVELWJCKTX    PBCKTX    P      Ship To Zip_Pos
     C                     Z-ADDWJB0C7    PBB0C7           Bill to Custome
     C                     MOVELWJAETX    PBAETX    P      Bill to Name
     C                     MOVELWJB1NA    PBB1NA    P      Bill to Address
     C                     MOVELWJB3NA    PBB3NA    P      Bill to Address
     C                     MOVELWJB4NA    PBB4NA    P      Bill to Address
     C                     MOVELWJB2NA    PBB2NA    P      Bill to City
     C                     MOVELWJBHCD    PBBHCD    P      Bill to State C
     C                     MOVELWJC8TX    PBC8TX    P      Bill to Zip_Pos
     C                     MOVELWJBCNA    PBBCNA    P      Customer Purcha
     C                     Z-ADDWJA0DT    PBA0DT           Order Date
     C                     Z-ADDWJA5DT    PBA5DT           Requested Ship
     C                     Z-ADDWJGNDT    PBGNDT           Actual Shipped
     C                     Z-ADDWJACDT    PBACDT           Cancel Date
     C                     MOVELWJAQCD    PBAQCD    P      Terms Code
     C                     MOVELWJB6NA    PBB6NA    P      Special Instruc
     C                     MOVELWJBYNA    PBBYNA    P      Special Instruc
     C                     MOVELWJBZNA    PBBZNA    P      Carrier Code
     C                     MOVELWJGTST    PBGTST    P      Comment Print A
     C                     MOVELWJGVST    PBGVST    P      Comment Print I
     C                     MOVELWJGUST    PBGUST    P      Comment Print P
     C                     MOVELWJQFST    PBQFST    P      Comment Print S
     C                     MOVELWJCQCD    PBCQCD    P      Reason Code
     C                     MOVELWJGJST    PBGJST    P      Order in Use
     C                     MOVELWJGWST    PBGWST    P      Header Status
     C                     MOVELWJGXST    PBGXST    P      Header Status L
     C                     MOVELWJGYST    PBGYST    P      Order Type Prin
     C                     Z-ADDWJAODT    PBAODT           Scheduled Ship
     C                     MOVELWJAIVN    PBAIVN    P      User Original E
     C                     Z-ADDWJCXDT    PBCXDT           Date of Origina
     C                     Z-ADDWJJZVA    PBJZVA           Order Value Tot
     C                     Z-ADDWJA1WG    PBA1WG           Order Weight To
     C                     MOVELWJXIST    PBXIST    P      Credit Hold
     C                     MOVELWJXJST    PBXJST    P      Production Hold
     C                     MOVELWJXKST    PBXKST    P      New Customer Ho
     C                     Z-ADDWJEIDT    PBEIDT           Requested Deliv
     C                     Z-ADDWJAFTM    PBAFTM           Requested Deliv
     C                     MOVELWJE8CD    PBE8CD    P      Accounts Receiv
     C                     MOVELWJE9CD    PBE9CD    P      Accounts Receiv
     C                     Z-ADDWJRMNB    PBRMNB           Load ID
     C                     Z-ADDWJTBNB    PBTBNB           Absorbed Freigh
     C                     Z-ADDWJR1NB    PBR1NB           Rated Freight
     C                     MOVELWJPJST    PBPJST    P      LTL Flag
     C                     MOVELWJU0ST    PBU0ST    P      Price Audit
     C                     MOVELWJU1ST    PBU1ST    P      Price Status
     C                     MOVELWJQ2CD    PBQ2CD    P      Shipping Method
     C                     MOVELWJU2ST    PBU2ST    P      Export Status
     C                     MOVELWJVEST    PBVEST    P      Palletize
     C                     MOVELWJVFST    PBVFST    P      Shrink Wrap
     C                     MOVELWJVGST    PBVGST    P      Slip Sheet
     C                     MOVELWJRPCD    PBRPCD    P      Age Code
     C                     Z-ADDWJRNNB    PBRNNB           Reefer Temperat
     C                     MOVELWJVDST    PBVDST    P      Load Type
     C                     Z-ADDWJATIN    PBATIN           Attach to Invoi
     C                     MOVELWJU4ST    PBU4ST    P      Load Plan Order
     C                     MOVELWJU5ST    PBU5ST    P      Print Pick Slip
     C                     Z-ADDWJRSRN    PBRSRN           Resell Referenc
     C                     MOVELWJMHNA    PBMHNA    P      Special Comment
     C                     MOVELWJMINA    PBMINA    P      Special Comment
     C                     MOVELWJWBST    PBWBST    P      Affect Auto Acc
     C                     MOVELWJR4CD    PBR4CD    P      Sales Route Cod
     C                     MOVELWJBFCD    PBBFCD    P      Manager Level C
     C                     MOVELWJQ4CD    PBQ4CD    P      VP Level Code
     C                     Z-ADDWJT3NB    PBT3NB           Attach to Order
     C                     MOVELWJSICD    PBSICD    P      Reason for Pric
     C                     Z-ADDWJCONB    PBCONB           Invoice Number
     C                     MOVELWJCEST    PBCEST    P      Invoice Suffix
     C                     Z-ADDWJAWDT    PBAWDT           Invoice Date
     C                     MOVELWJJPCD    PBJPCD    P      Event Code
     C                     MOVELWJXUST    PBXUST    P      Trans Contol AS
     C                     MOVELWJZ1ST    PBZ1ST    P      Modified Flag
     C                     Z-ADDWJVRVA    PBVRVA           A_R order Value
     C                     MOVELWJOBST    PBOBST    P      Billing Activit
     C                     MOVELWJBCST    PBBCST    P      Block Order Fla
     C                     MOVELWJBDST    PBBDST    P      Order Certifica
     C                     Z-ADDWJB7VL    PBB7VL           Invoice Order V
     C                     MOVELWJGASX    PBGASX    P      Process Sts for
     C                     MOVELWJGBSX    PBGBSX    P      Order Conf Fax
     C                     MOVELWJGCSX    PBGCSX    P      Manifest Fax St
     C                     MOVELWJGDSX    PBGDSX    P      Invoice Fax Sts
     C                     MOVELWJFNSX    PBFNSX    P      Transfer in Sto
     C                     MOVELWJFOSX    PBFOSX    P      Email Cust On O
     C                     MOVELWJFPSX    PBFPSX    P      Order Emailed
     C                     MOVELWJFQSX    PBFQSX    P      Export Docs Go
     C                     MOVELWJFRSX    PBFRSX    P      Shipping Temp C
     C                     MOVELWJFSSX    PBFSSX    P      Broker Order St
     C                     MOVELWJFTSX    PBFTSX    P      Air Freight Ord
     C                     MOVELWJFUSX    PBFUSX    P      Order Requires
     C                     MOVELWJFVSX    PBFVSX    P      OH Load Plan Re
     C                     MOVELWJFWSX    PBFWSX    P      Export USDA App
     C                     MOVELWJFXSX    PBFXSX    P      HPB Ship to War
     C                     MOVELWJFYSX    PBFYSX    P      OH TF Exempt Co
     C                     Z-ADDWJNODT    PBNODT           OH Appt Confirm
     C                     Z-ADDWJNPDT    PBNPDT           JPN Invoice Iss
     C                     Z-ADDWJNQDT    PBNQDT           Load Actual Shi
     C                     Z-ADDWJNRDT    PBNRDT           Load BOL Comple
     C                     Z-ADDWJNSDT    PBNSDT           Load Truck Depa
     C                     Z-ADDWJBPTM    PBBPTM           Maximum Gross W
     C                     Z-ADDWJBQTM    PBBQTM           Time of Origina
     C                     Z-ADDWJBRTM    PBBRTM           OH Appt Confirm
     C                     Z-ADDWJBSTM    PBBSTM           Load BOL Comple
     C                     Z-ADDWJBTTM    PBBTTM           Load Truck Depa
     C                     Z-ADDWJH0NX    PBH0NX           Act Frt Referen
     C                     Z-ADDWJH1NX    PBH1NX           Act Non_Ref Frt
     C                     Z-ADDWJH2NX    PBH2NX           OH Fuel Surchar
     C                     Z-ADDWJH3NX    PBH3NX           OH Total Non_Re
     C                     Z-ADDWJH4NX    PBH4NX           OH Total Ref Fr
     C                     Z-ADDWJC0C7    PBC0C7           Claim Number
     C                     MOVELWJUVST    PBUVST    P      EDI Status 1
     C                     MOVELWJUWST    PBUWST    P      EDI Status 2
     C                     MOVELWJUXST    PBUXST    P      EDI Status 3
     C                     Z-ADDWJAATM    PBAATM           Job Time
     C                     MOVELWJAYNA    PBAYNA    P      User Id
     C                     MOVELWJA0NA    PBA0NA    P      Job Name
     C                     Z-ADDWJAXDT    PBAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YJRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NOEXIT    ENDSR
      /EJECT
     CSR         NPRVGN    BEGSR
      *================================================================
      * UPD Rated Freight      RT - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1350  30       Order Sequence
     C                     Z-ADD*ZERO     WN1351  30       Order Secondary
     C                     Z-ADD*ZERO     WN1352 112       Rated Freight
     C                     Z-ADD*ZERO     WN1353 112       @Rated Freight
     C                     MOVEL*BLANK    WN1354  1        USR Process sta
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * par.@rated freight is the sum of all the detail rated frt, for ad
     C                     Z-ADD*ZERO     WN1353           @Rated Freight
      * par.usr process status is used to indicate if there are detail pr
     C                     MOVEL'N'       WN1354           USR Process sta
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQNP01           Company Number
     C           *LIKE     DEFN OMC4NB    WQNP02           Order Number
      * Define keylist
     C           KRSNP     KLIST
     C                     KFLD           WQNP01           Company Number
     C                     KFLD           WQNP02           Order Number
      * Setup key
     C                     Z-ADDWSAIC3    WQNP01           Company Number
     C                     Z-ADDWSC4NB    WQNP02           Order Number
      * Establish starting position
     C           KRSNP     SETLL@BGWKL1                    *
     C           KRSNP     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Cancelled
     C           OMGMST    IFEQ 'X'                        *IF
      * CHG Rated Freight      CH - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDOMAIC3    WL0244           Company Number
     C                     Z-ADDOMC4NB    WL0245           Order Number
     C                     Z-ADDOMDPNB    WL0246           Order Sequence
     C                     Z-ADDOMUENB    WL0247           Order Secondary
     C                     Z-ADD*ZERO     WL0248           Rated Freight
     C                     EXSR NQCHRC
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WN1354           USR Process sta
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Order Weight Total is Equal to zero
      *   |- c2    : PAR.Total Rated Freight is Zero
      *   '-
     C           WSA1WG    IFEQ 0                          *IF
     C           *ZERO     OREQ 0                          *OR
     C                     Z-ADD*ZERO     WN1352           Rated Freight
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Detail Line Status is Confirmed & Complete
     C           OMGMST    IFEQ 'C'                        *IF
     C           OMGMST    OREQ 'R'
      * Compute Dtl Rated Freight
      * PGM.*Synon (17,9) work field =
      *    *COMPUTE (x1 / x3 * x4)
      * x1    : DB1.Weight Shipped Total
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Order Weight Total
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x4    : PAR.Total Rated Freight
     C           OMATWG    DIV  WSA1WG    W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT *ZERO     W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    W0WE             *Synon (17,9) w
     C                     ELSE
      * CASE: *OTHERWISE
      * Compute Dtl Rated Freight
      * PGM.*Synon (17,9) work field =
      *    *COMPUTE ((x1 * x2) / x3 * x4)
      * x1    : DB1.Quantity Ordered
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x2    : DB1.Unit Weight Ordered U_M
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Order Weight Total
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x4    : PAR.Total Rated Freight
     C           OMAVQT    MULT OMAVWG    W0WD02           *Synon (17,7) w
     C           W0WD02    DIV  WSA1WG    W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT *ZERO     W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    W0WE             *Synon (17,9) w
     C                     END                             *FI
     C           W0WE      MULT 1         WN1352    H      Rated Freight
     C                     END                             *FI
      * CHG Rated Freight      CH - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDOMAIC3    WL0244           Company Number
     C                     Z-ADDOMC4NB    WL0245           Order Number
     C                     Z-ADDOMDPNB    WL0246           Order Sequence
     C                     Z-ADDOMUENB    WL0247           Order Secondary
     C                     Z-ADDWN1352    WL0248           Rated Freight
     C                     EXSR NQCHRC
     C                     ADD  WN1352    WN1353           @Rated Freight
     C                     Z-ADDOMDPNB    WN1350           Order Sequence
     C                     Z-ADDOMUENB    WN1351           Order Secondary
     C                     END                             *FI
     C           KRSNP     READE@BGWKL1                  90*
     C                     ENDDO
      * USER: Exit processing
      * Adjust totals
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.@Rated Freight NE PAR.Total Rated Freight
      *   |- c2    : PAR.USR Process status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN1353    IFNE *ZERO                      *IF
     C           WN1354    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           *ZERO     SUB  WN1353    WUICVA           USR Adjustment
     C                     ADD  WUICVA    WN1352           Rated Freight
      * Update last detail line processed
      * CHG Rated Freight      CH - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWSAIC3    WL0244           Company Number
     C                     Z-ADDWSC4NB    WL0245           Order Number
     C                     Z-ADDWN1350    WL0246           Order Sequence
     C                     Z-ADDWN1351    WL0247           Order Secondary
     C                     Z-ADDWN1352    WL0248           Rated Freight
     C                     EXSR NQCHRC
     C                     END                             *FI
      *================================================================
     CSR         NPEXIT    ENDSR
      /EJECT
     CSR         NQCHRC    BEGSR
      *================================================================
      * CHG Rated Freight      CH - PD Order Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1355  70       Item Code
     C                     MOVEL*BLANK    WN1356  3        Warehouse Code
     C                     Z-ADD*ZERO     WN1357  70       Ship To Custome
     C                     Z-ADD*ZERO     WN1358  70       Order Group Cod
     C                     MOVEL*BLANK    WN1359  1        Detail Line Sta
     C                     MOVEL*BLANK    WN1360  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN1361 112       Billing Detail
     C                     Z-ADD*ZERO     WN1362 112       Billing Detail
     C                     Z-ADD*ZERO     WN1363 112       Billing Detail
     C                     Z-ADD*ZERO     WN1364 112       Quantity to Sub
     C                     MOVEL*BLANK    WN1365  1        Comment Print A
     C                     MOVEL*BLANK    WN1366  1        Comment Print I
     C                     MOVEL*BLANK    WN1367  1        Comment Print P
     C                     MOVEL*BLANK    WN1368  1        Comment Print S
     C                     Z-ADD*ZERO     WN1369 112       Extended Amount
     C                     Z-ADD*ZERO     WN1370  70       Market Pricing
     C                     MOVEL*BLANK    WN1371  3        Commodity Marke
     C                     MOVEL*BLANK    WN1372  3        Date Method Cod
     C                     MOVEL*BLANK    WN1373  3        Price Method Co
     C                     Z-ADD*ZERO     WN1374 114       Price Overage O
     C                     Z-ADD*ZERO     WN1375  70       Contract Number
     C                     MOVEL*BLANK    WN1376  1        Price Status
     C                     Z-ADD*ZERO     WN1377  70       Pricing Date Us
     C                     MOVEL*BLANK    WN1378  2        U_M_Base Price
     C                     MOVEL*BLANK    WN1379  2        U_M_Ordered
     C                     MOVEL*BLANK    WN1380  1        Work Confirm St
     C                     MOVEL*BLANK    WN1381  1        Work Over_Short
     C                     MOVEL*BLANK    WN1382  1        OD Production P
     C                     MOVEL*BLANK    WN1383 30        Order Desc_Line
     C                     MOVEL*BLANK    WN1384 30        Order Desc_Line
     C                     MOVEL*BLANK    WN1385  1        Age Code
     C                     MOVEL*BLANK    WN1386  1        Palletize
     C                     MOVEL*BLANK    WN1387  1        Slip Sheet
     C                     MOVEL*BLANK    WN1388  1        Catch Weight St
     C                     MOVEL*BLANK    WN1389  1        Price Audit
     C                     MOVEL*BLANK    WN1390  3        Price Audit Rea
     C                     MOVEL*BLANK    WN1391  1        Production Date
     C                     Z-ADD*ZERO     WN1392 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN1393 112       Weight Ordered
     C                     Z-ADD*ZERO     WN1394 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN1395 112       Weight Schedule
     C                     Z-ADD*ZERO     WN1396 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN1397 112       Weight Shipped
     C                     Z-ADD*ZERO     WN1398 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN1399 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN1400 114       Unit Price
     C                     Z-ADD*ZERO     WN1401 114       Unit Price_Cred
     C                     Z-ADD*ZERO     WN1402 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN1403 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN1404 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN1405  70       Requested Ship
     C                     Z-ADD*ZERO     WN1406  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN1407  70       Actual Shipped
     C                     MOVEL*BLANK    WN1408  1        Affect Inventor
     C                     MOVEL*BLANK    WN1409  1        Affect Sales Do
     C                     MOVEL*BLANK    WN1410  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN1411  30       Item Structure
     C                     Z-ADD*ZERO     WN1412  30       Item Structure
     C                     Z-ADD*ZERO     WN1413  30       Item Structure
     C                     MOVEL*BLANK    WN1414  2        Item Level
     C                     MOVEL*BLANK    WN1415  2        Quality Level
     C                     MOVEL*BLANK    WN1416  2        Pricing Product
     C                     MOVEL*BLANK    WN1417  2        Season Product
     C                     Z-ADD*ZERO     WN1418  70       Date of Origina
     C                     MOVEL*BLANK    WN1419 10        User Profile Na
     C                     MOVEL*BLANK    WN1420  6        Country Code
     C                     MOVEL*BLANK    WN1421  2        Event Code
     C                     MOVEL*BLANK    WN1422  3        Reason Code
     C                     MOVEL*BLANK    WN1423  3        Sales Route Cod
     C                     MOVEL*BLANK    WN1424  1        Modified Flag
     C                     MOVEL*BLANK    WN1425  1        Substituted Fla
     C                     MOVEL*BLANK    WN1426  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN1427 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN1428 112       Invoice Extende
     C                     Z-ADD*ZERO     WN1429  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN1430  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN1431  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN1432  1        Affect Commissi
     C                     MOVEL*BLANK    WN1433  1        Affect Pricing
     C                     MOVEL*BLANK    WN1434  1        Released by Use
     C                     MOVEL*BLANK    WN1435  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN1436  2        OD Pallet Type
     C                     MOVEL*BLANK    WN1437  3        Production Ware
     C                     MOVEL*BLANK    WN1438  3        OD Price Type
     C                     Z-ADD*ZERO     WN1439  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN1440  70       Consumed Item C
     C                     Z-ADD*ZERO     WN1441  70       Deadline Depart
     C                     Z-ADD*ZERO     WN1442  70       OD Price Type R
     C                     Z-ADD*ZERO     WN1443  70       OD Firm Date
     C                     Z-ADD*ZERO     WN1444  60       Deadline Depart
     C                     Z-ADD*ZERO     WN1445  60       Price Code
     C                     Z-ADD*ZERO     WN1446  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN1447  60       Substitution Li
     C                     Z-ADD*ZERO     WN1448  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN1449 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN1450 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN1451 112       OD Item Target
     C                     Z-ADD*ZERO     WN1452 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN1453 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN1454 114       Order Gate_Fina
     C                     Z-ADD*ZERO     WN1455 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN1456 114       OD Gate_Final P
     C                     Z-ADD*ZERO     WN1457 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN1458 114       OD Original Ord
     C                     Z-ADD*ZERO     WN1459 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN1460 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN1461 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN1462  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN1463  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN1464  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN1465 112       Weight Amount E
     C                     Z-ADD*ZERO     WN1466  40       Item Age Days
     C                     Z-ADD*ZERO     WN1467  70       Production Ovr
     C                     Z-ADD*ZERO     WN1468  70       Production Ovr
     C                     MOVEL*BLANK    WN1469  1        OD Spot Buy
     C                     MOVEL*BLANK    WN1470  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN1471  3        Order Line Erro
     C                     Z-ADD*ZERO     WN1472  70       OD Market Begin
     C                     Z-ADD*ZERO     WN1473  70       OD Market Endin
     C                     Z-ADD*ZERO     WN1474  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN1475  1        EDI Status 1
     C                     MOVEL*BLANK    WN1476  1        EDI Status 2
     C                     MOVEL*BLANK    WN1477  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1478  60       Job Time
     C                     MOVEL*BLANK    WN1479 10        User Id
     C                     MOVEL*BLANK    WN1480 10        Job Name
     C                     Z-ADD*ZERO     WN1481  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YKRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWL0244    WIAIC3           Company Number
     C                     Z-ADDWL0245    WIC4NB           Order Number
     C                     Z-ADDWL0246    WIDPNB           Order Sequence
     C                     Z-ADDWL0247    WIUENB           Order Secondary
      *
     C           KLCHNQ    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIC4NB           Order Number
     C                     KFLD           WIDPNB           Order Sequence
     C                     KFLD           WIUENB           Order Secondary
     C           KLCHNQ    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL011.
     C                     MOVEL'LBL011'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NQEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YKRDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDWL0248    WIR1NB           Rated Freight
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WIAATM           Job Time
     C                     MOVEL##USR     WIAYNA           User Id
     C                     MOVEL##JOB     WIA0NA           Job Name
     C                     Z-ADD##JDT     WIAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YKRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NQEXIT    ENDSR
      /EJECT
     CSR         NRRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQNR01           Application Cod
      * Define keylist
     C           KRSNR     KLIST
     C                     KFLD           WQNR01           Application Cod
      * Setup key
     C                     MOVELP2DNCD    WQNR01           Application Cod
      * Establish starting position
     C           KRSNR     SETLL@DNRESF                    *
     C           KRSNR     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR NSRVGN
     C                     END                             *FI
     C           KRSNR     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         NREXIT    ENDSR
      /EJECT
     CSR         NSRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQNS01           Application Cod
      * Define keylist
     C           KRSNS     KLIST
     C                     KFLD           WQNS01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQNS01           Application Cod
      * Establish starting position
     C           KRSNS     SETLL@DNRESF                    *
     C           KRSNS     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO NSEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSNS     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         NSEXIT    ENDSR
      /EJECT
     CSR         NTRVGN    BEGSR
      *================================================================
      * RTV Hold Authorities   RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNT     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVEL##USR     DRAJVN           User Profile Na
      * Establish starting position
     C           KRSNT     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUG0TX           Credit Hold Aut
     C                     MOVEL*BLANK    P3XNST           Production Hold
     C                     GOTO NTEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRXMST    WUG0TX           Credit Hold Aut
     C                     MOVELDRXNST    P3XNST           Production Hold
     C                     ENDIF
      *================================================================
     CSR         NTEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv SchShpDte/Cust    RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAC4NB    WQSA01           Order Number
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Order Number
      * Setup key
     C                     Z-ADDWL0002    WQSA01           Order Number
      * Establish starting position
     C           KRSSA     SETLL@BFCPY2                    *
     C           KRSSA     READE@BFCPY2                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0001           Company Number
     C                     MOVEL*BLANK    WL0003           Order Type_Sale
     C                     Z-ADD*ZERO     WL0004           Ship To Custome
     C                     MOVEL*BLANK    WL0005           Ship To City
     C                     MOVEL*BLANK    WL0006           Ship To State C
     C                     MOVEL*BLANK    WL0007           Customer Purcha
     C                     Z-ADD*ZERO     WL0008           Order Date
     C                     Z-ADD*ZERO     WL0009           Requested Ship
     C                     MOVEL*BLANK    WL0010           Header Status
     C                     Z-ADD*ZERO     WL0011           Scheduled Ship
     C                     MOVEL*BLANK    WL0012           Credit Hold
     C                     MOVEL*BLANK    WL0013           Production Hold
     C                     Z-ADD*ZERO     WL0014           Requested Deliv
     C                     Z-ADD*ZERO     WL0015           Load ID
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWAAIC3    WL0001           Company Number
     C                     MOVELWAJNCD    WL0003           Order Type_Sale
     C                     Z-ADDWABKC7    WL0004           Ship To Custome
     C                     MOVELWAHNNA    WL0005           Ship To City
     C                     MOVELWADBCD    WL0006           Ship To State C
     C                     MOVELWABCNA    WL0007           Customer Purcha
     C                     Z-ADDWAA0DT    WL0008           Order Date
     C                     Z-ADDWAA5DT    WL0009           Requested Ship
     C                     MOVELWAGWST    WL0010           Header Status
     C                     Z-ADDWAAODT    WL0011           Scheduled Ship
     C                     MOVELWAXIST    WL0012           Credit Hold
     C                     MOVELWAXJST    WL0013           Production Hold
     C                     Z-ADDWAEIDT    WL0014           Requested Deliv
     C                     Z-ADDWARMNB    WL0015           Load ID
     C           KRSSA     READE@BFCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV UM/Whs Code        RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    #RODCD           USR Unit of Mea
     C                     Z-ADD*ZERO     YL0001           Boxes Total Qua
     C                     MOVEL'Y'       WUTAST           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBRMNB    WQSB01           Load ID
      * Define keylist
     C           KPSSB     KLIST
     C                     KFLD           WQSB01           Load ID
     C                     KFLD           WBC4NB           Order Number
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSB01           Load ID
     C                     Z-ADD#1C4NB    WBC4NB           Order Number
      * Establish starting position
     C           KPSSB     SETLL@BFCPR0                    *
     C           KRSSB     READE@BFCPR0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     GOTO SBEXIT                     *QUIT
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV UM/Whs Code,BX Qty RT - Order Detail  * 
     C                     EXSR SCRVGN
      * If doing for one Order, because it isnt tied to a load yet
      * CASE: DB1.Load ID is Blank
     C           WBRMNB    IFEQ 0                          *IF
      * CASE: PAR.USR Unit of Measure is Mixed
     C           #RODCD    IFEQ 'MX'                       *IF
      * RTV Numeric Value      RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0016           Company Number
     C                     MOVEL'BOXLOAD' WL0017    P      Company Value C
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0018    YL0003           System Value Nu
      * CASE: LCL.Boxes Total Quantity LT LCL.Box Load Min Box Qty USR
     C           YL0001    IFLT YL0003                     *IF
     C                     MOVEL'CB'      #RODCD           USR Unit of Mea
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'BX'      #RODCD           USR Unit of Mea
     C                     END                             *FI
     C                     END                             *FI
     C                     GOTO SBEXIT                     *QUIT
     C                     END                             *FI
      * orig code
     C           KRSSB     READE@BFCPR0                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: PAR.USR Unit of Measure is Mixed
     C           #RODCD    IFEQ 'MX'                       *IF
      * RTV Numeric Value      RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0016           Company Number
     C                     MOVEL'BOXLOAD' WL0017    P      Company Value C
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0018    YL0003           System Value Nu
      * CASE: LCL.Boxes Total Quantity LT LCL.Box Load Min Box Qty USR
     C           YL0001    IFLT YL0003                     *IF
     C                     MOVEL'CB'      #RODCD           USR Unit of Mea
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'BX'      #RODCD           USR Unit of Mea
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV UM/Whs Code,BX Qty RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WUTAST           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSC01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSC02           Order Number
      * Define keylist
     C           KPSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Order Number
      * Setup key
     C                     Z-ADDWBAIC3    WQSC01           Company Number
     C                     Z-ADDWBC4NB    WQSC02           Order Number
     C                     Z-ADD1         OMDPNB           Order Sequence
      * Establish starting position
     C           KPSSC     SETLL@BGWKL1                    *
     C           KRSSC     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #RODCD           USR Unit of Mea
     C                     Z-ADD*ZERO     YL0001           Boxes Total Qua
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SCEXIT                     *QUIT
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Cancelled
     C           OMGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * S17054 DN 04/08/21-Beyond this point, changed all 'U/M - Ordered'
      *   to reference LCL Context instead of DB1.
      * S17054 DN 04/08/21-Count Type 'Cases' (CS) as 'Boxes' (BX).
      * CASE: *OTHERWISE
     C                     MOVELOMAGCD    YL0002           U_M_Ordered
      * CASE: LCL.U/M - Ordered is Cases
     C           YL0002    IFEQ 'CS'                       *IF
     C                     MOVEL'BX'      YL0002           U_M_Ordered
     C                     END                             *FI
      * Accumulate the Box Quantity for slotting consideration  6/12/01
      * CASE: LCL.U/M - Ordered is EQ Boxes
     C           YL0002    IFEQ 'BX'                       *IF
     C                     ADD  OMAVQT    YL0001           Boxes Total Qua
     C                     END                             *FI
      * CASE: PAR.USR Unit of Measure is *Blank
     C           #RODCD    IFEQ *BLANK                     *IF
     C                     MOVELYL0002    #RODCD           USR Unit of Mea
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.U/M - Ordered EQ PAR.USR Unit of Measure
     C           YL0002    IFEQ #RODCD                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'MX'      #RODCD           USR Unit of Mea
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSC     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Numeric Value      RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           KMAIC3           Company Number
     C                     KFLD           KMV8CD           Company Value C
      * Setup key
     C                     Z-ADDWL0016    KMAIC3           Company Number
     C                     MOVELWL0017    KMV8CD           Company Value C
      * Establish starting position
     C           KRSSD     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDKMM8NB    WL0018           System Value Nu
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Type              RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           AMAIC3           Company Number
     C                     KFLD           AMC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    AMAIC3           Company Number
     C                     Z-ADD#1C4NB    AMC4NB           Order Number
      * Establish starting position
     C           KRSSE     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #RCHTX           OHE Override Ty
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAMCHTX    #RCHTX           OHE Override Ty
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV 1st Warehouse/Ctl  RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSF01           Company Number
     C           *LIKE     DEFN WCC4NB    WQSF02           Order Number
      * Define keylist
     C           KPSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Order Number
     C                     KFLD           WCDPNB           Order Sequence
     C                     KFLD           WCUENB           Order Secondary
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Order Number
      * Setup key
     C                     Z-ADDWL0019    WQSF01           Company Number
     C                     Z-ADDWL0020    WQSF02           Order Number
     C                     Z-ADDWL0021    WCDPNB           Order Sequence
     C                     Z-ADDWL0022    WCUENB           Order Secondary
      * Establish starting position
     C           KPSSF     SETLL@BGWKAE                    *
     C           KRSSF     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0023           Warehouse Code
     C                     MOVEL*BLANK    WL0024           Trans Contol AS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Warehouse Control  RT - Warehouse  * 
     C                     EXSR SGRVGN
      * PAR = DB1 By name
     C                     MOVELWCAJCD    WL0023           Warehouse Code
     C                     GOTO SFEXIT                     *QUIT
     C           KRSSF     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Warehouse Control  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWCAJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSG     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0024           Trans Contol AS
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADXUST    WL0024           Trans Contol AS
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Ld Acc Fg/Sch seq no - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     #RT4NB           Schedule Sequen
     C                     MOVEL*BLANK    #RRMST           Load Acceptance
     C                     MOVEL*BLANK    #RRYSX           MG Created Load
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSH     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFJT4NB    #RT4NB           Schedule Sequen
     C                     MOVELFJRMST    #RRMST           Load Acceptance
     C                     MOVELFJRYSX    #RRYSX           MG Created Load
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Warehouse Type     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#RAJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSI     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #RWPST           Warehouse Type
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADWPST    #RWPST           Warehouse Type
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Customer Name      RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1BKC7    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSJ     CHAIN@BBREE9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #RAYTX           Customer Name
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBAYTX    #RAYTX           Customer Name
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Load Status        RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDWL0025    FJRMNB           Load ID
      * Establish starting position
     C           KRSSK     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0026           Load Status
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELFJPKST    WL0026           Load Status
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Ddln DprtDT/TM/Seq RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDRMNB    WQSL02           Load ID
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSL02           Load ID
      * Establish starting position
     C           KRSSL     SETLL@FJCPSB                    *
     C           KRSSL     READE@FJCPSB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #RT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     #RYANB           Deadline Depart
     C                     Z-ADD*ZERO     WUAXTM           Deadline Depart
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWDT4NB    #RT4NB           Schedule Sequen
     C                     Z-ADDWDKZDT    #RYANB           Deadline Depart
     C                     Z-ADDWDAXTM    WUAXTM           Deadline Depart
     C           KRSSL     READE@FJCPSB                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV All Header Fields  RT - OP Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WEAIC3           Company Number
     C                     Z-ADD#1C4NB    WEC4NB           Order Number
      * Establish starting position
     C           KRSSM     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEJNCD    #1JNCD           Order Type_Sale
     C                     Z-ADDWEANC7    #1ANC7           AR Customer Num
     C                     Z-ADDWEBKC7    #1BKC7           Ship To Custome
     C                     MOVELWEBRTX    #1BRTX           Ship To Name
     C                     MOVELWEHMNA    #1HMNA           Ship To Address
     C                     MOVELWEHONA    #1HONA           Ship To Address
     C                     MOVELWEHPNA    #1HPNA           Ship To Address
     C                     MOVELWEHNNA    #1HNNA           Ship To City
     C                     MOVELWEDBCD    #1DBCD           Ship To State C
     C                     MOVELWECKTX    #1CKTX           Ship To Zip_Pos
     C                     Z-ADDWEB0C7    #1B0C7           Bill to Custome
     C                     MOVELWEAETX    #1AETX           Bill to Name
     C                     MOVELWEB1NA    #1B1NA           Bill to Address
     C                     MOVELWEB3NA    #1B3NA           Bill to Address
     C                     MOVELWEB4NA    #1B4NA           Bill to Address
     C                     MOVELWEB2NA    #1B2NA           Bill to City
     C                     MOVELWEBHCD    #1BHCD           Bill to State C
     C                     MOVELWEC8TX    #1C8TX           Bill to Zip_Pos
     C                     MOVELWEBCNA    #1BCNA           Customer Purcha
     C                     Z-ADDWEA0DT    #1A0DT           Order Date
     C                     Z-ADDWEA5DT    #1A5DT           Requested Ship
     C                     Z-ADDWEGNDT    #1GNDT           Actual Shipped
     C                     Z-ADDWEACDT    #1ACDT           Cancel Date
     C                     MOVELWEAQCD    #1AQCD           Terms Code
     C                     MOVELWEB6NA    #1B6NA           Special Instruc
     C                     MOVELWEBYNA    #1BYNA           Special Instruc
     C                     MOVELWEBZNA    #1BZNA           Carrier Code
     C                     MOVELWEGTST    #1GTST           Comment Print A
     C                     MOVELWEGVST    #1GVST           Comment Print I
     C                     MOVELWEGUST    #1GUST           Comment Print P
     C                     MOVELWEQFST    #1QFST           Comment Print S
     C                     MOVELWECQCD    #1CQCD           Reason Code
     C                     MOVELWEGJST    #1GJST           Order in Use
     C                     MOVELWEGWST    #1GWST           Header Status
     C                     MOVELWEGXST    #1GXST           Header Status L
     C                     MOVELWEGYST    #1GYST           Order Type Prin
     C                     Z-ADDWEAODT    #1AODT           Scheduled Ship
     C                     MOVELWEAIVN    #1AIVN           User Original E
     C                     Z-ADDWECXDT    #1CXDT           Date of Origina
     C                     Z-ADDWEJZVA    #1JZVA           Order Value Tot
     C                     Z-ADDWEA1WG    #1A1WG           Order Weight To
     C                     MOVELWEXIST    #1XIST           Credit Hold
     C                     MOVELWEXJST    #1XJST           Production Hold
     C                     MOVELWEXKST    #1XKST           New Customer Ho
     C                     Z-ADDWEEIDT    #1EIDT           Requested Deliv
     C                     Z-ADDWEAFTM    #1AFTM           Requested Deliv
     C                     MOVELWEE8CD    #1E8CD           Accounts Receiv
     C                     MOVELWEE9CD    #1E9CD           Accounts Receiv
     C                     Z-ADDWERMNB    #1RMNB           Load ID
     C                     Z-ADDWETBNB    #1TBNB           Absorbed Freigh
     C                     Z-ADDWER1NB    #1R1NB           Rated Freight
     C                     MOVELWEPJST    #1PJST           LTL Flag
     C                     MOVELWEU0ST    #1U0ST           Price Audit
     C                     MOVELWEU1ST    #1U1ST           Price Status
     C                     MOVELWEQ2CD    #1Q2CD           Shipping Method
     C                     MOVELWEU2ST    #1U2ST           Export Status
     C                     MOVELWEVEST    #1VEST           Palletize
     C                     MOVELWEVFST    #1VFST           Shrink Wrap
     C                     MOVELWEVGST    #1VGST           Slip Sheet
     C                     MOVELWERPCD    #1RPCD           Age Code
     C                     Z-ADDWERNNB    #1RNNB           Reefer Temperat
     C                     MOVELWEVDST    #1VDST           Load Type
     C                     Z-ADDWEATIN    #1ATIN           Attach to Invoi
     C                     MOVELWEU4ST    #1U4ST           Load Plan Order
     C                     MOVELWEU5ST    #1U5ST           Print Pick Slip
     C                     Z-ADDWERSRN    #1RSRN           Resell Referenc
     C                     MOVELWEMHNA    #1MHNA           Special Comment
     C                     MOVELWEMINA    #1MINA           Special Comment
     C                     MOVELWEWBST    #1WBST           Affect Auto Acc
     C                     MOVELWER4CD    #1R4CD           Sales Route Cod
     C                     MOVELWEBFCD    #1BFCD           Manager Level C
     C                     MOVELWEQ4CD    #1Q4CD           VP Level Code
     C                     Z-ADDWET3NB    #1T3NB           Attach to Order
     C                     MOVELWESICD    #1SICD           Reason for Pric
     C                     Z-ADDWECONB    #1CONB           Invoice Number
     C                     MOVELWECEST    #1CEST           Invoice Suffix
     C                     Z-ADDWEAWDT    #1AWDT           Invoice Date
     C                     MOVELWEJPCD    #1JPCD           Event Code
     C                     MOVELWEXUST    #1XUST           Trans Contol AS
     C                     MOVELWEZ1ST    #1Z1ST           Modified Flag
     C                     Z-ADDWEVRVA    #1VRVA           A_R order Value
     C                     MOVELWEOBST    #1OBST           Billing Activit
     C                     MOVELWEBCST    #1BCST           Block Order Fla
     C                     MOVELWEBDST    #1BDST           Order Certifica
     C                     MOVELWEUVST    #1UVST           EDI Status 1
     C                     MOVELWEUWST    #1UWST           EDI Status 2
     C                     MOVELWEUXST    #1UXST           EDI Status 3
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Sts/InUse/Evt/etc RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0027    WEAIC3           Company Number
     C                     Z-ADDWL0028    WEC4NB           Order Number
      * Establish starting position
     C           KRSSN     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEGJST    WL0029           Order in Use
     C                     MOVELWEGWST    WL0030           Header Status
     C                     MOVELWEXIST    WL0031           Credit Hold
     C                     MOVELWEXJST    WL0032           Production Hold
     C                     MOVELWEJPCD    WL0033           Event Code
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv InUse/Sts for Ld  RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       YL0008           Access Denied (
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFRMNB    WQSO02           Load ID
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSO02           Load ID
      * Establish starting position
     C           KRSSO     SETLL@BFCPRQ                    *
     C           KRSSO     READE@BFCPRQ                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * FOUND: Order in Use
      * CASE: DB1.Order in Use is yes
     C           WFGJST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0008           Access Denied (
     C                     END                             *FI
      * FOUND: Shipped or Invoiced
      * CASE: DB1.Header Status is Confirmed & Complete
     C           WFGWST    IFEQ 'C'                        *IF
     C           WFGWST    OREQ 'R'
     C                     MOVEL'Y'       YL0008           Access Denied (
     C                     END                             *FI
      * ACCESS DENIED
      * CASE: PAR.Access Denied (Y/N) is yes
     C           YL0008    IFEQ 'Y'                        *IF
     C                     GOTO SOEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSO     READE@BFCPRQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Load for Load Plan RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDWL0034    FJRMNB           Load ID
      * Establish starting position
     C           KRSSP     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0035           Scheduled Ship
     C                     MOVEL*BLANK    WL0036           Load Status
     C                     Z-ADD*ZERO     WL0037           Reefer Temperat
     C                     Z-ADD*ZERO     WL0038           Total Load Orde
     C                     Z-ADD*ZERO     WL0039           Flat Amount
     C                     MOVEL*BLANK    WL0040           Allocate Pounds
     C                     MOVEL*BLANK    WL0041           Carrier Code
     C                     MOVEL*BLANK    WL0042           Truck Size
     C                     Z-ADD*ZERO     WL0043           Rated Freight
     C                     MOVEL*BLANK    WL0044           Load Type
     C                     Z-ADD*ZERO     WL0045           Schedule Sequen
     C                     Z-ADD*ZERO     WL0046           Total Load Mile
     C                     MOVEL*BLANK    WL0047           Shipping Method
     C                     MOVEL*BLANK    WL0048           Ship From Wareh
     C                     MOVEL*BLANK    WL0049           Ship To State C
     C                     MOVEL*BLANK    WL0050           Carrier Broker
     C                     MOVEL*BLANK    WL0051           Load Acceptance
     C                     Z-ADD*ZERO     WL0052           Override Total
     C                     MOVEL*BLANK    WL0053           Shipping Temp C
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFJAODT    WL0035           Scheduled Ship
     C                     MOVELFJPKST    WL0036           Load Status
     C                     Z-ADDFJRNNB    WL0037           Reefer Temperat
     C                     Z-ADDFJRPNB    WL0038           Total Load Orde
     C                     Z-ADDFJFLAM    WL0039           Flat Amount
     C                     MOVELFJXQST    WL0040           Allocate Pounds
     C                     MOVELFJBZNA    WL0041           Carrier Code
     C                     MOVELFJRONB    WL0042           Truck Size
     C                     Z-ADDFJR1NB    WL0043           Rated Freight
     C                     MOVELFJVDST    WL0044           Load Type
     C                     Z-ADDFJT4NB    WL0045           Schedule Sequen
     C                     Z-ADDFJTLMI    WL0046           Total Load Mile
     C                     MOVELFJQ2CD    WL0047           Shipping Method
     C                     MOVELFJVPCD    WL0048           Ship From Wareh
     C                     MOVELFJDBCD    WL0049           Ship To State C
     C                     MOVELFJXCCD    WL0050           Carrier Broker
     C                     MOVELFJRMST    WL0051           Load Acceptance
     C                     Z-ADDFJK2DT    WL0052           Override Total
     C                     MOVELFJWRTX    WL0053           Shipping Temp C
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Any Ord/Blk  on Ld RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
     C                     MOVEL*BLANK    WL0055           USR Check Y/N S
      * OMS203:  need to know if there are any Block orders on load
     C                     MOVEL'F'       WL0056           Block Order Fla
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGRMNB    WQSQ02           Load ID
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ02           Load ID
      * Setup key
     C                     Z-ADDWL0054    WQSQ02           Load ID
      * Establish starting position
     C           KRSSQ     SETLL@BFCPD9                    *
     C           KRSSQ     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WL0055           USR Check Y/N S
      * CASE: DB1.Block Order Flag is Block Order
     C           WGBCST    IFEQ 'B'                        *IF
     C                     MOVELWGBCST    WL0056           Block Order Fla
     C                     GOTO SQEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSQ     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWL0057    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSSR     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    WL0058           Allow Multi_Com
     C                     MOVELDRMPNA    WL0059           Default Printer
     C                     MOVELDRBCCD    WL0060           Salesperson Cod
     C                     Z-ADDDRAIC3    WL0061           Company Number
     C                     MOVELDRBUVN    WL0062           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0063    DTAJVN           User Profile Na
     C                     MOVELWL0064    DTDNCD           Application Cod
      * Establish starting position
     C           KRSSS     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0065           Company Number
     C                     MOVELDTAJCD    WL0066           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * RTV Prod Whse for Co  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHBWC3    WQST01           Shipping Compan
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           Shipping Compan
      * Setup key
     C                     Z-ADDWL0068    WQST01           Shipping Compan
      * Establish starting position
     C           KRSST     SETLL@ADREWA                    *
     C           KRSST     READE@ADREWA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0067           Warehouse Code
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           WHVSST    IFEQ 'A'                        *IF
      * CASE: DB1.Production Warehouse Code is Warehouse Code not Blank
     C           WHAOCD    IFNE *BLANK                     *IF
     C                     MOVELWHAOCD    WL0067           Warehouse Code
     C                     GOTO STEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSST     READE@ADREWA                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0069    ABAIC3           Company Number
      * Establish starting position
     C           KRSSU     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0070           Name
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    WL0070           Name
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * VAL no Stop Entered    RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WL0072           Status - Y or N
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQSV02           Load ID
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV02           Load ID
      * Setup key
     C                     Z-ADDWL0071    WQSV02           Load ID
      * Establish starting position
     C           KRSSV     SETLL@FLCPEB                    *
     C           KRSSV     READE@FLCPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Stop/Drop is EQ Zero
     C           FLRVNB    IFEQ 0                          *IF
     C                     MOVEL'Y'       WL0072           Status - Y or N
     C                     GOTO SVEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSV     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * RTV Hold, Use-by load  RT - OP Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0073           Order in Use
     C                     MOVEL*BLANK    WL0074           Header Status
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGRMNB    WQSW02           Load ID
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WQSW02           Load ID
      * Setup key
     C                     Z-ADDWL0075    WQSW02           Load ID
      * Establish starting position
     C           KRSSW     SETLL@BFCPD9                    *
     C           KRSSW     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * If find 1 order on load which is held/cancelled, set par flag and
      * CASE: DB1.Header Status is Hold
     C           WGGWST    IFEQ 'H'                        *IF
     C                     MOVELWGGWST    WL0074           Header Status
     C                     GOTO SWEXIT                     *QUIT
     C                     ELSE
      * CASE: DB1.Header Status is Cancelled
     C           WGGWST    IFEQ 'X'                        *IF
     C                     MOVELWGGWST    WL0074           Header Status
     C                     GOTO SWEXIT                     *QUIT
     C                     ELSE
      * CASE: DB1.Order in Use is yes
     C           WGGJST    IFEQ 'Y'                        *IF
     C                     MOVELWGGJST    WL0073           Order in Use
     C                     GOTO SWEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSW     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV Ord Requires Revw RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGRMNB    WQSX02           Load ID
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WQSX02           Load ID
      * Setup key
     C                     Z-ADDWL0076    WQSX02           Load ID
      * Establish starting position
     C           KRSSX     SETLL@BFCPD9                    *
     C           KRSSX     READE@BFCPD9                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0077           Order Requires
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGFUSX    WL0077           Order Requires
     C           KRSSX     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * Rtv Min & Max Pounds  RT - OM Truck Size  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           FKRONB           Truck Size
      * Setup key
     C                     MOVELWL0078    FKRONB           Truck Size
      * Establish starting position
     C           KRSSY     CHAIN@FKREBT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1190' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0079           Maximum pounds
     C                     Z-ADD*ZERO     WL0080           Minimum pounds
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFKRSNB    WL0079           Maximum pounds
     C                     Z-ADDFKTANB    WL0080           Minimum pounds
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * Rtv Unlock Load Authr RT - Entry Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           C0AJVN           User Profile Na
     C                     KFLD           C0DNCD           Application Cod
     C                     KFLD           C0AIC3           Company Number
      * Setup key
     C                     MOVEL##USR     C0AJVN           User Profile Na
     C                     MOVE *BLANK    C0DNCD           Application Cod
     C                     MOVEL'O/P'     C0DNCD           Application Cod
     C                     Z-ADD#1AIC3    C0AIC3           Company Number
      * Establish starting position
     C           KRSSZ     CHAIN@C0REO4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0527' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUHTST           Unlock Load Aut
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELC0HTST    WUHTST           Unlock Load Aut
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * PFS Val Order Picked  RT - PFS Ship Load/Order Sts  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BKZGNX    WQTA01           PFS Load ID
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA01           PFS Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQTA01           PFS Load ID
      * Establish starting position
     C           KRSTA     SETLL@BKCPEK                    *
     C           KRSTA     READE@BKCPEK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3504' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WUZMST           Pick Status USR
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUZMST           Pick Status USR
     C                     GOTO TAEXIT                     *QUIT
     C           KRSTA     READE@BKCPEK                  90*
     C                     ENDDO
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * Val Allow to Rmv Order RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       YL0015           Allow to Remove
     C                     MOVEL*BLANK    YL0014           Header Status
     C                     Z-ADD0         YL0016           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGRMNB    WQTB02           Load ID
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WQTB02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQTB02           Load ID
      * Establish starting position
     C           KRSTB     SETLL@BFCPD9                    *
     C           KRSTB     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         YL0016           Count USR
      * CASE: PAR.Order Number NE DB1.Order Number
     C           #1C4NB    IFNE WGC4NB                     *IF
      * see if all other orders are shipped
      * CASE: DB1.Header Status is Confirmed
     C           WGGWST    IFEQ 'R'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0015           Allow to Remove
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWGGWST    YL0014           Header Status
     C                     END                             *FI
     C           KRSTB     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * Rtv ReAlc/AlcAsOrd ATS RT - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0021  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0022 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0023 112       Weight Schedule
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ***** PA PROCESS - USE REQUESTED SHIP DATE FOR Ship Date USR ****
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQTC01           Company Number
     C           *LIKE     DEFN OMC4NB    WQTC02           Order Number
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WQTC01           Company Number
     C                     KFLD           WQTC02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQTC01           Company Number
     C                     Z-ADD#1C4NB    WQTC02           Order Number
      * Establish starting position
     C           KRSTC     SETLL@BGWKL1                    *
     C           KRSTC     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDOMBKC7    WN0021           Ship To Custome
      * CASE: DB1.Detail Line Status is Conf/Comp/Canc
     C           OMGMST    IFEQ 'X'                        *IF
     C           OMGMST    OREQ 'C'
     C           OMGMST    OREQ 'R'
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDOMCCQT    WN0022           Quantity Schedu
     C                     Z-ADDOMAUWG    WN0023           Weight Schedule
      * CASE: DB1.Released by User Sts Y/N is yes
     C           OMF3SX    IFEQ 'Y'                        *IF
      * CHG Released by User  CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDOMAIC3    WL0081           Company Number
     C                     Z-ADDOMC4NB    WL0082           Order Number
     C                     Z-ADDOMDPNB    WL0083           Order Sequence
     C                     Z-ADDOMUENB    WL0084           Order Secondary
     C                     MOVEL'N'       WL0085    P      Released by Use
     C                     EXSR TDCHRC
     C                     END                             *FI
      * Update Availability
      * CASE: PAR.ATS Adj Type USR is Order Allocate
     C           'OA'      IFEQ 'OA'                       *IF
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM OMAIC3    WQ0073  30       Company Number
     C                     PARM OMC4NB    WQ0074  70       Order Number
     C                     PARM OMDPNB    WQ0075  30       Order Sequence
     C                     PARM OMUENB    WQ0076  30       Order Secondary
     C                     PARM OMHGCD    WQ0077  70       Item Code
     C                     PARM OMAJCD    WQ0078  3        Warehouse Code
     C                     PARM OMA5DT    WQ0079  70       Ship Date USR
     C                     PARM *ZERO     WQ0080 112       Quantity Ordere
     C                     PARM *ZERO     WQ0081 112       Weight Ordered
     C           WN0022    PARM WN0022    WQ0082 112       Quantity Schedu
     C           WN0023    PARM WN0023    WQ0083 112       Weight Schedule
     C                     PARM 'OD'      WQ0084  2        ATS Adj Type US
     C                     PARM @CN,013   WQ0085 10        PSAA Program Na
     C                     PARM OMRINY    WQ0086  40       Item Age Days
     C                     PARM OMTIDT    WQ0087  70       Production Ovr
     C                     PARM OMTJDT    WQ0088  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     Z-ADD*ZERO     WN0022           Quantity Schedu
     C                     Z-ADD*ZERO     WN0023           Weight Schedule
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM OMAIC3    WQ0089  30       Company Number
     C                     PARM OMC4NB    WQ0090  70       Order Number
     C                     PARM OMDPNB    WQ0091  30       Order Sequence
     C                     PARM OMUENB    WQ0092  30       Order Secondary
     C                     PARM OMHGCD    WQ0093  70       Item Code
     C                     PARM OMAJCD    WQ0094  3        Warehouse Code
     C                     PARM OMA5DT    WQ0095  70       Ship Date USR
     C                     PARM OMAVQT    WQ0096 112       Quantity Ordere
     C                     PARM OMD0WG    WQ0097 112       Weight Ordered
     C           WN0022    PARM WN0022    WQ0098 112       Quantity Schedu
     C           WN0023    PARM WN0023    WQ0099 112       Weight Schedule
     C                     PARM 'OA'      WQ0100  2        ATS Adj Type US
     C                     PARM @CN,013   WQ0101 10        PSAA Program Na
     C                     PARM OMRINY    WQ0102  40       Item Age Days
     C                     PARM OMTIDT    WQ0103  70       Production Ovr
     C                     PARM OMTJDT    WQ0104  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE: PAR.ATS Adj Type USR is Sched/Alloc As Ordered
     C           'OA'      IFEQ 'AO'                       *IF
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM OMAIC3    WQ0105  30       Company Number
     C                     PARM OMC4NB    WQ0106  70       Order Number
     C                     PARM OMDPNB    WQ0107  30       Order Sequence
     C                     PARM OMUENB    WQ0108  30       Order Secondary
     C                     PARM OMHGCD    WQ0109  70       Item Code
     C                     PARM OMAJCD    WQ0110  3        Warehouse Code
     C                     PARM OMA5DT    WQ0111  70       Ship Date USR
     C                     PARM OMAVQT    WQ0112 112       Quantity Ordere
     C                     PARM OMD0WG    WQ0113 112       Weight Ordered
     C           WN0022    PARM WN0022    WQ0114 112       Quantity Schedu
     C           WN0023    PARM WN0023    WQ0115 112       Weight Schedule
     C                     PARM 'OA'      WQ0116  2        ATS Adj Type US
     C                     PARM @CN,014   WQ0117 10        PSAA Program Na
     C                     PARM OMRINY    WQ0118  40       Item Age Days
     C                     PARM OMTIDT    WQ0119  70       Production Ovr
     C                     PARM OMTJDT    WQ0120  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Update Order Detail
      * CASE: DB1.Quantity Scheduled NE PAR.Quantity Scheduled
     C           OMCCQT    IFNE WN0022                     *IF
      * Chg Qty/Wgt Scheduled CH - PD Order Detail  * 
     C                     EXSR TECHRC
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTC     READE@BGWKL1                  90*
     C                     ENDDO
      * USER: Exit processing
      * EDT Post Open Orders   XF - Order Header TRG  * 
     C                     CALL 'PDHRXFR'              90  EDT Post Open O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0121  30       Company Number
     C                     PARM #1C4NB    WQ0122  70       Order Number
     C                     PARM WN0021    WQ0123  70       Ship To Custome
     C           WUJZVA    PARM WUJZVA    WQ0124 112       Order Value Tot
     C           WUA1WG    PARM *ZERO     WQ0125 112       Order Weight To
     C                     PARM 'PS'      WQ0126  3        Pricing Event C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDCHRC    BEGSR
      *================================================================
      * CHG Released by User  CH - Order Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0024  70       Item Code
     C                     MOVEL*BLANK    WN0025  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0026  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0027  70       Order Group Cod
     C                     MOVEL*BLANK    WN0028  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0029  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0030 112       Billing Detail
     C                     Z-ADD*ZERO     WN0031 112       Billing Detail
     C                     Z-ADD*ZERO     WN0032 112       Billing Detail
     C                     Z-ADD*ZERO     WN0033 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0034  1        Comment Print A
     C                     MOVEL*BLANK    WN0035  1        Comment Print I
     C                     MOVEL*BLANK    WN0036  1        Comment Print P
     C                     MOVEL*BLANK    WN0037  1        Comment Print S
     C                     Z-ADD*ZERO     WN0038 112       Extended Amount
     C                     Z-ADD*ZERO     WN0039  70       Market Pricing
     C                     MOVEL*BLANK    WN0040  3        Commodity Marke
     C                     MOVEL*BLANK    WN0041  3        Date Method Cod
     C                     MOVEL*BLANK    WN0042  3        Price Method Co
     C                     Z-ADD*ZERO     WN0043 114       Price Overage O
     C                     Z-ADD*ZERO     WN0044  70       Contract Number
     C                     MOVEL*BLANK    WN0045  1        Price Status
     C                     Z-ADD*ZERO     WN0046  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0047  2        U_M_Base Price
     C                     MOVEL*BLANK    WN0048  2        U_M_Ordered
     C                     MOVEL*BLANK    WN0049  1        Work Confirm St
     C                     MOVEL*BLANK    WN0050  1        Work Over_Short
     C                     MOVEL*BLANK    WN0051  1        OD Production P
     C                     MOVEL*BLANK    WN0052 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0053 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0054  1        Age Code
     C                     MOVEL*BLANK    WN0055  1        Palletize
     C                     MOVEL*BLANK    WN0056  1        Slip Sheet
     C                     MOVEL*BLANK    WN0057  1        Catch Weight St
     C                     MOVEL*BLANK    WN0058  1        Price Audit
     C                     MOVEL*BLANK    WN0059  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0060  1        Production Date
     C                     Z-ADD*ZERO     WN0061 112       Rated Freight
     C                     Z-ADD*ZERO     WN0062 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0063 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0064 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0065 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0066 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0067 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0068 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0069 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0070 114       Unit Price
     C                     Z-ADD*ZERO     WN0071 114       Unit Price_Cred
     C                     Z-ADD*ZERO     WN0072 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0073 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0074 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0075  70       Requested Ship
     C                     Z-ADD*ZERO     WN0076  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0077  70       Actual Shipped
     C                     MOVEL*BLANK    WN0078  1        Affect Inventor
     C                     MOVEL*BLANK    WN0079  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0080  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0081  30       Item Structure
     C                     Z-ADD*ZERO     WN0082  30       Item Structure
     C                     Z-ADD*ZERO     WN0083  30       Item Structure
     C                     MOVEL*BLANK    WN0084  2        Item Level
     C                     MOVEL*BLANK    WN0085  2        Quality Level
     C                     MOVEL*BLANK    WN0086  2        Pricing Product
     C                     MOVEL*BLANK    WN0087  2        Season Product
     C                     Z-ADD*ZERO     WN0088  70       Date of Origina
     C                     MOVEL*BLANK    WN0089 10        User Profile Na
     C                     MOVEL*BLANK    WN0090  6        Country Code
     C                     MOVEL*BLANK    WN0091  2        Event Code
     C                     MOVEL*BLANK    WN0092  3        Reason Code
     C                     MOVEL*BLANK    WN0093  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0094  1        Modified Flag
     C                     MOVEL*BLANK    WN0095  1        Substituted Fla
     C                     MOVEL*BLANK    WN0096  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0097 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0098 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0099  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0100  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0101  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0102  1        Affect Commissi
     C                     MOVEL*BLANK    WN0103  1        Affect Pricing
     C                     MOVEL*BLANK    WN0104  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0105  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0106  3        Production Ware
     C                     MOVEL*BLANK    WN0107  3        OD Price Type
     C                     Z-ADD*ZERO     WN0108  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0109  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0110  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0111  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0112  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0113  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0114  60       Price Code
     C                     Z-ADD*ZERO     WN0115  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0116  60       Substitution Li
     C                     Z-ADD*ZERO     WN0117  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0118 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0119 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0120 112       OD Item Target
     C                     Z-ADD*ZERO     WN0121 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0122 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0123 114       Order Gate_Fina
     C                     Z-ADD*ZERO     WN0124 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0125 114       OD Gate_Final P
     C                     Z-ADD*ZERO     WN0126 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0127 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0128 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0129 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0130 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0131  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0132  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0133  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0134 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0135  40       Item Age Days
     C                     Z-ADD*ZERO     WN0136  70       Production Ovr
     C                     Z-ADD*ZERO     WN0137  70       Production Ovr
     C                     MOVEL*BLANK    WN0138  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0139  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0140  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0141  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0142  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0143  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0144  1        EDI Status 1
     C                     MOVEL*BLANK    WN0145  1        EDI Status 2
     C                     MOVEL*BLANK    WN0146  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0147  60       Job Time
     C                     MOVEL*BLANK    WN0148 10        User Id
     C                     MOVEL*BLANK    WN0149 10        Job Name
     C                     Z-ADD*ZERO     WN0150  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWL0081    WIAIC3           Company Number
     C                     Z-ADDWL0082    WIC4NB           Order Number
     C                     Z-ADDWL0083    WIDPNB           Order Sequence
     C                     Z-ADDWL0084    WIUENB           Order Secondary
      *
     C           KLCHTD    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIC4NB           Order Number
     C                     KFLD           WIDPNB           Order Sequence
     C                     KFLD           WIUENB           Order Secondary
     C           KLCHTD    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TDEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YARDCS
      * Move non-key fields to @BGWKL0
     C                     MOVELWL0085    WIF3SX    P      Released by Use
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WIAATM           Job Time
     C                     MOVEL##USR     WIAYNA           User Id
     C                     MOVEL##JOB     WIA0NA           Job Name
     C                     Z-ADD##JDT     WIAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TECHRC    BEGSR
      *================================================================
      * Chg Qty/Wgt Scheduled CH - PD Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0151  70       Item Code
     C                     MOVEL*BLANK    WN0152  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0153  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0154  70       Order Group Cod
     C                     MOVEL*BLANK    WN0155  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0156  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0157 112       Billing Detail
     C                     Z-ADD*ZERO     WN0158 112       Billing Detail
     C                     Z-ADD*ZERO     WN0159 112       Billing Detail
     C                     Z-ADD*ZERO     WN0160 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0161  1        Comment Print A
     C                     MOVEL*BLANK    WN0162  1        Comment Print I
     C                     MOVEL*BLANK    WN0163  1        Comment Print P
     C                     MOVEL*BLANK    WN0164  1        Comment Print S
     C                     Z-ADD*ZERO     WN0165 112       Extended Amount
     C                     Z-ADD*ZERO     WN0166  70       Market Pricing
     C                     MOVEL*BLANK    WN0167  3        Commodity Marke
     C                     MOVEL*BLANK    WN0168  3        Date Method Cod
     C                     MOVEL*BLANK    WN0169  3        Price Method Co
     C                     Z-ADD*ZERO     WN0170 114       Price Overage O
     C                     Z-ADD*ZERO     WN0171  70       Contract Number
     C                     MOVEL*BLANK    WN0172  1        Price Status
     C                     Z-ADD*ZERO     WN0173  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0174  2        U_M_Base Price
     C                     MOVEL*BLANK    WN0175  2        U_M_Ordered
     C                     MOVEL*BLANK    WN0176  1        Work Confirm St
     C                     MOVEL*BLANK    WN0177  1        Work Over_Short
     C                     MOVEL*BLANK    WN0178  1        OD Production P
     C                     MOVEL*BLANK    WN0179 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0180 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0181  1        Age Code
     C                     MOVEL*BLANK    WN0182  1        Palletize
     C                     MOVEL*BLANK    WN0183  1        Slip Sheet
     C                     MOVEL*BLANK    WN0184  1        Catch Weight St
     C                     MOVEL*BLANK    WN0185  1        Price Audit
     C                     MOVEL*BLANK    WN0186  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0187  1        Production Date
     C                     Z-ADD*ZERO     WN0188 112       Rated Freight
     C                     Z-ADD*ZERO     WN0189 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0190 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0191 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0192 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0193 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0194 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0195 114       Unit Price
     C                     Z-ADD*ZERO     WN0196 114       Unit Price_Cred
     C                     Z-ADD*ZERO     WN0197 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0198 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0199 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0200  70       Requested Ship
     C                     Z-ADD*ZERO     WN0201  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0202  70       Actual Shipped
     C                     MOVEL*BLANK    WN0203  1        Affect Inventor
     C                     MOVEL*BLANK    WN0204  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0205  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0206  30       Item Structure
     C                     Z-ADD*ZERO     WN0207  30       Item Structure
     C                     Z-ADD*ZERO     WN0208  30       Item Structure
     C                     MOVEL*BLANK    WN0209  2        Item Level
     C                     MOVEL*BLANK    WN0210  2        Quality Level
     C                     MOVEL*BLANK    WN0211  2        Pricing Product
     C                     MOVEL*BLANK    WN0212  2        Season Product
     C                     Z-ADD*ZERO     WN0213  70       Date of Origina
     C                     MOVEL*BLANK    WN0214 10        User Profile Na
     C                     MOVEL*BLANK    WN0215  6        Country Code
     C                     MOVEL*BLANK    WN0216  2        Event Code
     C                     MOVEL*BLANK    WN0217  3        Reason Code
     C                     MOVEL*BLANK    WN0218  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0219  1        Modified Flag
     C                     MOVEL*BLANK    WN0220  1        Substituted Fla
     C                     MOVEL*BLANK    WN0221  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0222 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0223 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0224  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0225  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0226  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0227  1        Affect Commissi
     C                     MOVEL*BLANK    WN0228  1        Affect Pricing
     C                     MOVEL*BLANK    WN0229  1        Released by Use
     C                     MOVEL*BLANK    WN0230  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0231  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0232  3        Production Ware
     C                     MOVEL*BLANK    WN0233  3        OD Price Type
     C                     Z-ADD*ZERO     WN0234  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0235  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0236  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0237  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0238  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0239  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0240  60       Price Code
     C                     Z-ADD*ZERO     WN0241  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0242  60       Substitution Li
     C                     Z-ADD*ZERO     WN0243  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0244 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0245 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0246 112       OD Item Target
     C                     Z-ADD*ZERO     WN0247 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0248 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0249 114       Order Gate_Fina
     C                     Z-ADD*ZERO     WN0250 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0251 114       OD Gate_Final P
     C                     Z-ADD*ZERO     WN0252 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0253 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0254 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0255 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0256 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0257  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0258  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0259  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0260 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0261  40       Item Age Days
     C                     Z-ADD*ZERO     WN0262  70       Production Ovr
     C                     Z-ADD*ZERO     WN0263  70       Production Ovr
     C                     MOVEL*BLANK    WN0264  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0265  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0266  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0267  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0268  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0269  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0270  1        EDI Status 1
     C                     MOVEL*BLANK    WN0271  1        EDI Status 2
     C                     MOVEL*BLANK    WN0272  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0273  60       Job Time
     C                     MOVEL*BLANK    WN0274 10        User Id
     C                     MOVEL*BLANK    WN0275 10        Job Name
     C                     Z-ADD*ZERO     WN0276  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDOMAIC3    WIAIC3           Company Number
     C                     Z-ADDOMC4NB    WIC4NB           Order Number
     C                     Z-ADDOMDPNB    WIDPNB           Order Sequence
     C                     Z-ADDOMUENB    WIUENB           Order Secondary
      *
     C           KLCHTE    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIC4NB           Order Number
     C                     KFLD           WIDPNB           Order Sequence
     C                     KFLD           WIUENB           Order Secondary
     C           KLCHTE    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YBRDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDWN0022    WICCQT           Quantity Schedu
     C                     Z-ADDWN0023    WIAUWG           Weight Schedule
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WIAATM           Job Time
     C                     MOVEL##USR     WIAYNA           User Id
     C                     MOVEL##PGM     WIA0NA           Job Name
     C                     Z-ADD##JDT     WIAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFCHRC    BEGSR
      *================================================================
      * CHG Ord Req Revw- flg CH - Order Header TRG  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     MOVEL*BLANK    WN0277  2        Order Type_Sale
     C                     Z-ADD*ZERO     WN0278  70       AR Customer Num
     C                     Z-ADD*ZERO     WN0279  70       Ship To Custome
     C                     MOVEL*BLANK    WN0280 30        Ship To Name
     C                     MOVEL*BLANK    WN0281 30        Ship To Address
     C                     MOVEL*BLANK    WN0282 30        Ship To Address
     C                     MOVEL*BLANK    WN0283 30        Ship To Address
     C                     MOVEL*BLANK    WN0284 20        Ship To City
     C                     MOVEL*BLANK    WN0285  2        Ship To State C
     C                     MOVEL*BLANK    WN0286 11        Ship To Zip_Pos
     C                     Z-ADD*ZERO     WN0287  70       Bill to Custome
     C                     MOVEL*BLANK    WN0288 30        Bill to Name
     C                     MOVEL*BLANK    WN0289 30        Bill to Address
     C                     MOVEL*BLANK    WN0290 30        Bill to Address
     C                     MOVEL*BLANK    WN0291 30        Bill to Address
     C                     MOVEL*BLANK    WN0292 20        Bill to City
     C                     MOVEL*BLANK    WN0293  2        Bill to State C
     C                     MOVEL*BLANK    WN0294 11        Bill to Zip_Pos
     C                     MOVEL*BLANK    WN0295 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0296  70       Order Date
     C                     Z-ADD*ZERO     WN0297  70       Requested Ship
     C                     Z-ADD*ZERO     WN0298  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0299  70       Cancel Date
     C                     MOVEL*BLANK    WN0300  2        Terms Code
     C                     MOVEL*BLANK    WN0301 40        Special Instruc
     C                     MOVEL*BLANK    WN0302 40        Special Instruc
     C                     MOVEL*BLANK    WN0303  3        Carrier Code
     C                     MOVEL*BLANK    WN0304  1        Comment Print A
     C                     MOVEL*BLANK    WN0305  1        Comment Print I
     C                     MOVEL*BLANK    WN0306  1        Comment Print P
     C                     MOVEL*BLANK    WN0307  1        Comment Print S
     C                     MOVEL*BLANK    WN0308  3        Reason Code
     C                     MOVEL*BLANK    WN0309  1        Order in Use
     C                     MOVEL*BLANK    WN0310  1        Header Status
     C                     MOVEL*BLANK    WN0311  1        Header Status L
     C                     MOVEL*BLANK    WN0312  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0313  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0314 10        User Original E
     C                     Z-ADD*ZERO     WN0315  70       Date of Origina
     C                     Z-ADD*ZERO     WN0316 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0317 112       Order Weight To
     C                     MOVEL*BLANK    WN0318  1        Credit Hold
     C                     MOVEL*BLANK    WN0319  1        Production Hold
     C                     MOVEL*BLANK    WN0320  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0321  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0322  40       Requested Deliv
     C                     MOVEL*BLANK    WN0323  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0324 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0325  70       Load ID
     C                     Z-ADD*ZERO     WN0326  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0327 112       Rated Freight
     C                     MOVEL*BLANK    WN0328  1        LTL Flag
     C                     MOVEL*BLANK    WN0329  1        Price Audit
     C                     MOVEL*BLANK    WN0330  1        Price Status
     C                     MOVEL*BLANK    WN0331  2        Shipping Method
     C                     MOVEL*BLANK    WN0332  1        Export Status
     C                     MOVEL*BLANK    WN0333  1        Palletize
     C                     MOVEL*BLANK    WN0334  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0335  1        Slip Sheet
     C                     MOVEL*BLANK    WN0336  1        Age Code
     C                     Z-ADD*ZERO     WN0337  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0338  1        Load Type
     C                     Z-ADD*ZERO     WN0339  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0340  1        Load Plan Order
     C                     MOVEL*BLANK    WN0341  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0342  70       Resell Referenc
     C                     MOVEL*BLANK    WN0343 30        Special Comment
     C                     MOVEL*BLANK    WN0344 30        Special Comment
     C                     MOVEL*BLANK    WN0345  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0346  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0347  2        Manager Level C
     C                     MOVEL*BLANK    WN0348  3        VP Level Code
     C                     Z-ADD*ZERO     WN0349  70       Attach to Order
     C                     MOVEL*BLANK    WN0350  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0351  70       Invoice Number
     C                     MOVEL*BLANK    WN0352  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0353  70       Invoice Date
     C                     MOVEL*BLANK    WN0354  2        Event Code
     C                     MOVEL*BLANK    WN0355  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0356  1        Modified Flag
     C                     Z-ADD*ZERO     WN0357 112       A_R order Value
     C                     MOVEL*BLANK    WN0358  1        Billing Activit
     C                     MOVEL*BLANK    WN0359  1        Block Order Fla
     C                     MOVEL*BLANK    WN0360  1        Order Certifica
     C                     Z-ADD*ZERO     WN0361 112       Invoice Order V
     C                     MOVEL*BLANK    WN0362  1        Process Sts for
     C                     MOVEL*BLANK    WN0363  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0364  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0365  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0366  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0367  1        Email Cust On O
     C                     MOVEL*BLANK    WN0368  1        Order Emailed
     C                     MOVEL*BLANK    WN0369  1        Export Docs Go
     C                     MOVEL*BLANK    WN0370  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0371  1        Broker Order St
     C                     MOVEL*BLANK    WN0372  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0373  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0374  2        Export USDA App
     C                     MOVEL*BLANK    WN0375  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0376  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0377  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0378  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0379  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0380  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0381  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0382  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0383  60       Time of Origina
     C                     Z-ADD*ZERO     WN0384  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0385  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0386  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0387 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0388 112       Act Non_Ref Frt
     C                     Z-ADD*ZERO     WN0389 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0390 112       OH Total Non_Re
     C                     Z-ADD*ZERO     WN0391 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0392  70       Claim Number
     C                     MOVEL*BLANK    WN0393  1        EDI Status 1
     C                     MOVEL*BLANK    WN0394  1        EDI Status 2
     C                     MOVEL*BLANK    WN0395  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0396  60       Job Time
     C                     MOVEL*BLANK    WN0397 10        User Id
     C                     MOVEL*BLANK    WN0398 10        Job Name
     C                     Z-ADD*ZERO     WN0399  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWL0086    WJAIC3           Company Number
     C                     Z-ADDWL0087    WJC4NB           Order Number
      *
     C           KLCHTF    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJC4NB           Order Number
     C           KLCHTF    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YCRDCS
      * Move non-key fields to @BECPFJ
     C                     MOVELWL0088    WJFUSX    P      Order Requires
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Does not update the record stamp fields
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * CHG Ord Line Error Typ RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQTG01           Company Number
     C           *LIKE     DEFN OMC4NB    WQTG02           Order Number
      * Define keylist
     C           KPSTG     KLIST
     C                     KFLD           WQTG01           Company Number
     C                     KFLD           WQTG02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           WQTG01           Company Number
     C                     KFLD           WQTG02           Order Number
      * Setup key
     C                     Z-ADDWL0089    WQTG01           Company Number
     C                     Z-ADDWL0090    WQTG02           Order Number
     C                     Z-ADDWL0091    OMDPNB           Order Sequence
     C                     Z-ADDWL0092    OMUENB           Order Secondary
      * Establish starting position
     C           KPSTG     SETLL@BGWKL1                    *
     C           KRSTG     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * ** Clear the upload error flag for all line items    C001956
      * CASE: DB1.Order Line Error Type is Upload Error Pending
     C           OMH1ST    IFEQ 'DD'                       *IF
     C           OMH1ST    OREQ 'HD'
     C           OMH1ST    OREQ 'IT'
     C           OMH1ST    OREQ 'AC'
     C           OMH1ST    OREQ 'WT'
     C           OMH1ST    OREQ 'PA'
     C           OMH1ST    OREQ 'SL'
     C           OMH1ST    OREQ 'DT'
     C           OMH1ST    OREQ 'ME'
      * CHG Ord Line Error Typ CH - Order Detail  * 
     C                     EXSR THCHRC
     C                     END                             *FI
     C           KRSTG     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THCHRC    BEGSR
      *================================================================
      * CHG Ord Line Error Typ CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0400  70       Item Code
     C                     MOVEL*BLANK    WN0401  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0402  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0403  70       Order Group Cod
     C                     MOVEL*BLANK    WN0404  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0405  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0406 112       Billing Detail
     C                     Z-ADD*ZERO     WN0407 112       Billing Detail
     C                     Z-ADD*ZERO     WN0408 112       Billing Detail
     C                     Z-ADD*ZERO     WN0409 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0410  1        Comment Print A
     C                     MOVEL*BLANK    WN0411  1        Comment Print I
     C                     MOVEL*BLANK    WN0412  1        Comment Print P
     C                     MOVEL*BLANK    WN0413  1        Comment Print S
     C                     Z-ADD*ZERO     WN0414 112       Extended Amount
     C                     Z-ADD*ZERO     WN0415  70       Market Pricing
     C                     MOVEL*BLANK    WN0416  3        Commodity Marke
     C                     MOVEL*BLANK    WN0417  3        Date Method Cod
     C                     MOVEL*BLANK    WN0418  3        Price Method Co
     C                     Z-ADD*ZERO     WN0419 114       Price Overage O
     C                     Z-ADD*ZERO     WN0420  70       Contract Number
     C                     MOVEL*BLANK    WN0421  1        Price Status
     C                     Z-ADD*ZERO     WN0422  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0423  2        U_M_Base Price
     C                     MOVEL*BLANK    WN0424  2        U_M_Ordered
     C                     MOVEL*BLANK    WN0425  1        Work Confirm St
     C                     MOVEL*BLANK    WN0426  1        Work Over_Short
     C                     MOVEL*BLANK    WN0427  1        OD Production P
     C                     MOVEL*BLANK    WN0428 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0429 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0430  1        Age Code
     C                     MOVEL*BLANK    WN0431  1        Palletize
     C                     MOVEL*BLANK    WN0432  1        Slip Sheet
     C                     MOVEL*BLANK    WN0433  1        Catch Weight St
     C                     MOVEL*BLANK    WN0434  1        Price Audit
     C                     MOVEL*BLANK    WN0435  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0436  1        Production Date
     C                     Z-ADD*ZERO     WN0437 112       Rated Freight
     C                     Z-ADD*ZERO     WN0438 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0439 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0440 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0441 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0442 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0443 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0444 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0445 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0446 114       Unit Price
     C                     Z-ADD*ZERO     WN0447 114       Unit Price_Cred
     C                     Z-ADD*ZERO     WN0448 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0449 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0450 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0451  70       Requested Ship
     C                     Z-ADD*ZERO     WN0452  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0453  70       Actual Shipped
     C                     MOVEL*BLANK    WN0454  1        Affect Inventor
     C                     MOVEL*BLANK    WN0455  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0456  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0457  30       Item Structure
     C                     Z-ADD*ZERO     WN0458  30       Item Structure
     C                     Z-ADD*ZERO     WN0459  30       Item Structure
     C                     MOVEL*BLANK    WN0460  2        Item Level
     C                     MOVEL*BLANK    WN0461  2        Quality Level
     C                     MOVEL*BLANK    WN0462  2        Pricing Product
     C                     MOVEL*BLANK    WN0463  2        Season Product
     C                     Z-ADD*ZERO     WN0464  70       Date of Origina
     C                     MOVEL*BLANK    WN0465 10        User Profile Na
     C                     MOVEL*BLANK    WN0466  6        Country Code
     C                     MOVEL*BLANK    WN0467  2        Event Code
     C                     MOVEL*BLANK    WN0468  3        Reason Code
     C                     MOVEL*BLANK    WN0469  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0470  1        Modified Flag
     C                     MOVEL*BLANK    WN0471  1        Substituted Fla
     C                     MOVEL*BLANK    WN0472  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0473 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0474 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0475  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0476  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0477  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0478  1        Affect Commissi
     C                     MOVEL*BLANK    WN0479  1        Affect Pricing
     C                     MOVEL*BLANK    WN0480  1        Released by Use
     C                     MOVEL*BLANK    WN0481  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0482  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0483  3        Production Ware
     C                     MOVEL*BLANK    WN0484  3        OD Price Type
     C                     Z-ADD*ZERO     WN0485  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0486  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0487  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0488  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0489  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0490  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0491  60       Price Code
     C                     Z-ADD*ZERO     WN0492  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0493  60       Substitution Li
     C                     Z-ADD*ZERO     WN0494  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0495 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0496 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0497 112       OD Item Target
     C                     Z-ADD*ZERO     WN0498 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0499 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0500 114       Order Gate_Fina
     C                     Z-ADD*ZERO     WN0501 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0502 114       OD Gate_Final P
     C                     Z-ADD*ZERO     WN0503 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0504 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0505 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0506 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0507 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0508  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0509  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0510  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0511 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0512  40       Item Age Days
     C                     Z-ADD*ZERO     WN0513  70       Production Ovr
     C                     Z-ADD*ZERO     WN0514  70       Production Ovr
     C                     MOVEL*BLANK    WN0515  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0516  2        OD Clm Full Ret
     C                     Z-ADD*ZERO     WN0517  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0518  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0519  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0520  1        EDI Status 1
     C                     MOVEL*BLANK    WN0521  1        EDI Status 2
     C                     MOVEL*BLANK    WN0522  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0523  60       Job Time
     C                     MOVEL*BLANK    WN0524 10        User Id
     C                     MOVEL*BLANK    WN0525 10        Job Name
     C                     Z-ADD*ZERO     WN0526  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
      * ** This routine does NOT update the change audit fields  P001251
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDOMAIC3    WIAIC3           Company Number
     C                     Z-ADDOMC4NB    WIC4NB           Order Number
     C                     Z-ADDOMDPNB    WIDPNB           Order Sequence
     C                     Z-ADDOMUENB    WIUENB           Order Secondary
      *
     C           KLCHTH    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIC4NB           Order Number
     C                     KFLD           WIDPNB           Order Sequence
     C                     KFLD           WIUENB           Order Secondary
     C           KLCHTH    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO THEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO THEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YDRDCS
      * Move non-key fields to @BGWKL0
     C                     MOVEL*BLANK    WIH1ST    P      Order Line Erro
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * RTV Check Sch to Rlsd RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQTI01           Company Number
     C           *LIKE     DEFN OMC4NB    WQTI02           Order Number
      * Define keylist
     C           KPSTI     KLIST
     C                     KFLD           WQTI01           Company Number
     C                     KFLD           WQTI02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           WQTI01           Company Number
     C                     KFLD           WQTI02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQTI01           Company Number
     C                     Z-ADD#1C4NB    WQTI02           Order Number
     C                     Z-ADD*ZERO     OMDPNB           Order Sequence
     C                     Z-ADD*ZERO     OMUENB           Order Secondary
      * Establish starting position
     C           KPSTI     SETLL@BGWKL1                    *
     C           KRSTI     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Cancelled
     C           OMGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Quantity Ordered EQ DB1.Quantity Scheduled
     C           OMAVQT    IFEQ OMCCQT                     *IF
      * if line items sched=ordered, then dont set released by user to Ye
      * do nothing
     C                     ELSE
      * CASE: *OTHERWISE
      * CHG Released by User  CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDOMAIC3    WL0081           Company Number
     C                     Z-ADDOMC4NB    WL0082           Order Number
     C                     Z-ADDOMDPNB    WL0083           Order Sequence
     C                     Z-ADDOMUENB    WL0084           Order Secondary
     C                     MOVEL'Y'       WL0085    P      Released by Use
     C                     EXSR TDCHRC
      * * FP1054 Create rcd * RLSLIN
     C                     MOVEL*BLANK    WUFYTX           Item Code Txt
     C                     MOVELOMHGCD    WUFYTX           Item Code Txt
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPARC
     C                     Z-ADD#1RMNB    PARMNB           Load ID
     C                     Z-ADD*ZERO     PARVNB           Stop_Drop
     C                     MOVEL'RLSLIN'  PARVST    P      Load Change Typ
     C                     MOVEL'SLS'     PAUJST    P      Department Cont
     C                     MOVELWUFYTX    PAMNTX    P      Change Log Prio
     C                     MOVEL@CN,015   PAMOTX    P      Change Log New
     C                     MOVEL##USR     PAAYNA    P      User Id
     C                     MOVEL##PGM     PAA0NA    P      Job Name
     C                     MOVEL#1BZNA    PABZNA    P      Carrier Code
     C                     Z-ADDOMAIC3    PAAIC3           Company Number
     C                     Z-ADDOMC4NB    PAC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTI     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJCHRC    BEGSR
      *================================================================
      * CHG Prd Hld, Sts,Rsn   CH - Order Header TRG  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     MOVEL*BLANK    WN0527  2        Order Type_Sale
     C                     Z-ADD*ZERO     WN0528  70       AR Customer Num
     C                     Z-ADD*ZERO     WN0529  70       Ship To Custome
     C                     MOVEL*BLANK    WN0530 30        Ship To Name
     C                     MOVEL*BLANK    WN0531 30        Ship To Address
     C                     MOVEL*BLANK    WN0532 30        Ship To Address
     C                     MOVEL*BLANK    WN0533 30        Ship To Address
     C                     MOVEL*BLANK    WN0534 20        Ship To City
     C                     MOVEL*BLANK    WN0535  2        Ship To State C
     C                     MOVEL*BLANK    WN0536 11        Ship To Zip_Pos
     C                     Z-ADD*ZERO     WN0537  70       Bill to Custome
     C                     MOVEL*BLANK    WN0538 30        Bill to Name
     C                     MOVEL*BLANK    WN0539 30        Bill to Address
     C                     MOVEL*BLANK    WN0540 30        Bill to Address
     C                     MOVEL*BLANK    WN0541 30        Bill to Address
     C                     MOVEL*BLANK    WN0542 20        Bill to City
     C                     MOVEL*BLANK    WN0543  2        Bill to State C
     C                     MOVEL*BLANK    WN0544 11        Bill to Zip_Pos
     C                     MOVEL*BLANK    WN0545 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0546  70       Order Date
     C                     Z-ADD*ZERO     WN0547  70       Requested Ship
     C                     Z-ADD*ZERO     WN0548  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0549  70       Cancel Date
     C                     MOVEL*BLANK    WN0550  2        Terms Code
     C                     MOVEL*BLANK    WN0551 40        Special Instruc
     C                     MOVEL*BLANK    WN0552 40        Special Instruc
     C                     MOVEL*BLANK    WN0553  3        Carrier Code
     C                     MOVEL*BLANK    WN0554  1        Comment Print A
     C                     MOVEL*BLANK    WN0555  1        Comment Print I
     C                     MOVEL*BLANK    WN0556  1        Comment Print P
     C                     MOVEL*BLANK    WN0557  1        Comment Print S
     C                     MOVEL*BLANK    WN0558  1        Order in Use
     C                     MOVEL*BLANK    WN0559  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0560  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0561 10        User Original E
     C                     Z-ADD*ZERO     WN0562  70       Date of Origina
     C                     Z-ADD*ZERO     WN0563 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0564 112       Order Weight To
     C                     MOVEL*BLANK    WN0565  1        Credit Hold
     C                     MOVEL*BLANK    WN0566  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0567  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0568  40       Requested Deliv
     C                     MOVEL*BLANK    WN0569  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0570 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0571  70       Load ID
     C                     Z-ADD*ZERO     WN0572  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0573 112       Rated Freight
     C                     MOVEL*BLANK    WN0574  1        LTL Flag
     C                     MOVEL*BLANK    WN0575  1        Price Audit
     C                     MOVEL*BLANK    WN0576  1        Price Status
     C                     MOVEL*BLANK    WN0577  2        Shipping Method
     C                     MOVEL*BLANK    WN0578  1        Export Status
     C                     MOVEL*BLANK    WN0579  1        Palletize
     C                     MOVEL*BLANK    WN0580  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0581  1        Slip Sheet
     C                     MOVEL*BLANK    WN0582  1        Age Code
     C                     Z-ADD*ZERO     WN0583  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0584  1        Load Type
     C                     Z-ADD*ZERO     WN0585  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0586  1        Load Plan Order
     C                     MOVEL*BLANK    WN0587  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0588  70       Resell Referenc
     C                     MOVEL*BLANK    WN0589 30        Special Comment
     C                     MOVEL*BLANK    WN0590 30        Special Comment
     C                     MOVEL*BLANK    WN0591  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0592  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0593  2        Manager Level C
     C                     MOVEL*BLANK    WN0594  3        VP Level Code
     C                     Z-ADD*ZERO     WN0595  70       Attach to Order
     C                     MOVEL*BLANK    WN0596  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0597  70       Invoice Number
     C                     MOVEL*BLANK    WN0598  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0599  70       Invoice Date
     C                     MOVEL*BLANK    WN0600  2        Event Code
     C                     MOVEL*BLANK    WN0601  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0602  1        Modified Flag
     C                     Z-ADD*ZERO     WN0603 112       A_R order Value
     C                     MOVEL*BLANK    WN0604  1        Billing Activit
     C                     MOVEL*BLANK    WN0605  1        Block Order Fla
     C                     MOVEL*BLANK    WN0606  1        Order Certifica
     C                     Z-ADD*ZERO     WN0607 112       Invoice Order V
     C                     MOVEL*BLANK    WN0608  1        Process Sts for
     C                     MOVEL*BLANK    WN0609  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0610  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0611  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0612  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0613  1        Email Cust On O
     C                     MOVEL*BLANK    WN0614  1        Order Emailed
     C                     MOVEL*BLANK    WN0615  1        Export Docs Go
     C                     MOVEL*BLANK    WN0616  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0617  1        Broker Order St
     C                     MOVEL*BLANK    WN0618  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0619  2        Order Requires
     C                     MOVEL*BLANK    WN0620  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0621  2        Export USDA App
     C                     MOVEL*BLANK    WN0622  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0623  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0624  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0625  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0626  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0627  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0628  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0629  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0630  60       Time of Origina
     C                     Z-ADD*ZERO     WN0631  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0632  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0633  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0634 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0635 112       Act Non_Ref Frt
     C                     Z-ADD*ZERO     WN0636 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0637 112       OH Total Non_Re
     C                     Z-ADD*ZERO     WN0638 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0639  70       Claim Number
     C                     MOVEL*BLANK    WN0640  1        EDI Status 1
     C                     MOVEL*BLANK    WN0641  1        EDI Status 2
     C                     MOVEL*BLANK    WN0642  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0643  60       Job Time
     C                     MOVEL*BLANK    WN0644 10        User Id
     C                     MOVEL*BLANK    WN0645 10        Job Name
     C                     Z-ADD*ZERO     WN0646  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWL0093    WJAIC3           Company Number
     C                     Z-ADDWL0094    WJC4NB           Order Number
      *
     C           KLCHTJ    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJC4NB           Order Number
     C           KLCHTJ    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YERDCS
      * Move non-key fields to @BECPFJ
     C                     MOVELWL0095    WJCQCD    P      Reason Code
     C                     MOVELWL0096    WJGWST    P      Header Status
     C                     MOVELWL0097    WJGXST    P      Header Status L
     C                     MOVELWL0098    WJXJST    P      Production Hold
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##PGM     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - Order Header TRG  * 
     C                     CLEARPBRC
     C                     Z-ADDWJAIC3    PBAIC3           Company Number
     C                     Z-ADDWJC4NB    PBC4NB           Order Number
     C                     MOVELWJJNCD    PBJNCD    P      Order Type_Sale
     C                     Z-ADDWJANC7    PBANC7           AR Customer Num
     C                     Z-ADDWJBKC7    PBBKC7           Ship To Custome
     C                     MOVELWJBRTX    PBBRTX    P      Ship To Name
     C                     MOVELWJHMNA    PBHMNA    P      Ship To Address
     C                     MOVELWJHONA    PBHONA    P      Ship To Address
     C                     MOVELWJHPNA    PBHPNA    P      Ship To Address
     C                     MOVELWJHNNA    PBHNNA    P      Ship To City
     C                     MOVELWJDBCD    PBDBCD    P      Ship To State C
     C                     MOVELWJCKTX    PBCKTX    P      Ship To Zip_Pos
     C                     Z-ADDWJB0C7    PBB0C7           Bill to Custome
     C                     MOVELWJAETX    PBAETX    P      Bill to Name
     C                     MOVELWJB1NA    PBB1NA    P      Bill to Address
     C                     MOVELWJB3NA    PBB3NA    P      Bill to Address
     C                     MOVELWJB4NA    PBB4NA    P      Bill to Address
     C                     MOVELWJB2NA    PBB2NA    P      Bill to City
     C                     MOVELWJBHCD    PBBHCD    P      Bill to State C
     C                     MOVELWJC8TX    PBC8TX    P      Bill to Zip_Pos
     C                     MOVELWJBCNA    PBBCNA    P      Customer Purcha
     C                     Z-ADDWJA0DT    PBA0DT           Order Date
     C                     Z-ADDWJA5DT    PBA5DT           Requested Ship
     C                     Z-ADDWJGNDT    PBGNDT           Actual Shipped
     C                     Z-ADDWJACDT    PBACDT           Cancel Date
     C                     MOVELWJAQCD    PBAQCD    P      Terms Code
     C                     MOVELWJB6NA    PBB6NA    P      Special Instruc
     C                     MOVELWJBYNA    PBBYNA    P      Special Instruc
     C                     MOVELWJBZNA    PBBZNA    P      Carrier Code
     C                     MOVELWJGTST    PBGTST    P      Comment Print A
     C                     MOVELWJGVST    PBGVST    P      Comment Print I
     C                     MOVELWJGUST    PBGUST    P      Comment Print P
     C                     MOVELWJQFST    PBQFST    P      Comment Print S
     C                     MOVELWJCQCD    PBCQCD    P      Reason Code
     C                     MOVELWJGJST    PBGJST    P      Order in Use
     C                     MOVELWJGWST    PBGWST    P      Header Status
     C                     MOVELWJGXST    PBGXST    P      Header Status L
     C                     MOVELWJGYST    PBGYST    P      Order Type Prin
     C                     Z-ADDWJAODT    PBAODT           Scheduled Ship
     C                     MOVELWJAIVN    PBAIVN    P      User Original E
     C                     Z-ADDWJCXDT    PBCXDT           Date of Origina
     C                     Z-ADDWJJZVA    PBJZVA           Order Value Tot
     C                     Z-ADDWJA1WG    PBA1WG           Order Weight To
     C                     MOVELWJXIST    PBXIST    P      Credit Hold
     C                     MOVELWJXJST    PBXJST    P      Production Hold
     C                     MOVELWJXKST    PBXKST    P      New Customer Ho
     C                     Z-ADDWJEIDT    PBEIDT           Requested Deliv
     C                     Z-ADDWJAFTM    PBAFTM           Requested Deliv
     C                     MOVELWJE8CD    PBE8CD    P      Accounts Receiv
     C                     MOVELWJE9CD    PBE9CD    P      Accounts Receiv
     C                     Z-ADDWJRMNB    PBRMNB           Load ID
     C                     Z-ADDWJTBNB    PBTBNB           Absorbed Freigh
     C                     Z-ADDWJR1NB    PBR1NB           Rated Freight
     C                     MOVELWJPJST    PBPJST    P      LTL Flag
     C                     MOVELWJU0ST    PBU0ST    P      Price Audit
     C                     MOVELWJU1ST    PBU1ST    P      Price Status
     C                     MOVELWJQ2CD    PBQ2CD    P      Shipping Method
     C                     MOVELWJU2ST    PBU2ST    P      Export Status
     C                     MOVELWJVEST    PBVEST    P      Palletize
     C                     MOVELWJVFST    PBVFST    P      Shrink Wrap
     C                     MOVELWJVGST    PBVGST    P      Slip Sheet
     C                     MOVELWJRPCD    PBRPCD    P      Age Code
     C                     Z-ADDWJRNNB    PBRNNB           Reefer Temperat
     C                     MOVELWJVDST    PBVDST    P      Load Type
     C                     Z-ADDWJATIN    PBATIN           Attach to Invoi
     C                     MOVELWJU4ST    PBU4ST    P      Load Plan Order
     C                     MOVELWJU5ST    PBU5ST    P      Print Pick Slip
     C                     Z-ADDWJRSRN    PBRSRN           Resell Referenc
     C                     MOVELWJMHNA    PBMHNA    P      Special Comment
     C                     MOVELWJMINA    PBMINA    P      Special Comment
     C                     MOVELWJWBST    PBWBST    P      Affect Auto Acc
     C                     MOVELWJR4CD    PBR4CD    P      Sales Route Cod
     C                     MOVELWJBFCD    PBBFCD    P      Manager Level C
     C                     MOVELWJQ4CD    PBQ4CD    P      VP Level Code
     C                     Z-ADDWJT3NB    PBT3NB           Attach to Order
     C                     MOVELWJSICD    PBSICD    P      Reason for Pric
     C                     Z-ADDWJCONB    PBCONB           Invoice Number
     C                     MOVELWJCEST    PBCEST    P      Invoice Suffix
     C                     Z-ADDWJAWDT    PBAWDT           Invoice Date
     C                     MOVELWJJPCD    PBJPCD    P      Event Code
     C                     MOVELWJXUST    PBXUST    P      Trans Contol AS
     C                     MOVELWJZ1ST    PBZ1ST    P      Modified Flag
     C                     Z-ADDWJVRVA    PBVRVA           A_R order Value
     C                     MOVELWJOBST    PBOBST    P      Billing Activit
     C                     MOVELWJBCST    PBBCST    P      Block Order Fla
     C                     MOVELWJBDST    PBBDST    P      Order Certifica
     C                     Z-ADDWJB7VL    PBB7VL           Invoice Order V
     C                     MOVELWJGASX    PBGASX    P      Process Sts for
     C                     MOVELWJGBSX    PBGBSX    P      Order Conf Fax
     C                     MOVELWJGCSX    PBGCSX    P      Manifest Fax St
     C                     MOVELWJGDSX    PBGDSX    P      Invoice Fax Sts
     C                     MOVELWJFNSX    PBFNSX    P      Transfer in Sto
     C                     MOVELWJFOSX    PBFOSX    P      Email Cust On O
     C                     MOVELWJFPSX    PBFPSX    P      Order Emailed
     C                     MOVELWJFQSX    PBFQSX    P      Export Docs Go
     C                     MOVELWJFRSX    PBFRSX    P      Shipping Temp C
     C                     MOVELWJFSSX    PBFSSX    P      Broker Order St
     C                     MOVELWJFTSX    PBFTSX    P      Air Freight Ord
     C                     MOVELWJFUSX    PBFUSX    P      Order Requires
     C                     MOVELWJFVSX    PBFVSX    P      OH Load Plan Re
     C                     MOVELWJFWSX    PBFWSX    P      Export USDA App
     C                     MOVELWJFXSX    PBFXSX    P      HPB Ship to War
     C                     MOVELWJFYSX    PBFYSX    P      OH TF Exempt Co
     C                     Z-ADDWJNODT    PBNODT           OH Appt Confirm
     C                     Z-ADDWJNPDT    PBNPDT           JPN Invoice Iss
     C                     Z-ADDWJNQDT    PBNQDT           Load Actual Shi
     C                     Z-ADDWJNRDT    PBNRDT           Load BOL Comple
     C                     Z-ADDWJNSDT    PBNSDT           Load Truck Depa
     C                     Z-ADDWJBPTM    PBBPTM           Maximum Gross W
     C                     Z-ADDWJBQTM    PBBQTM           Time of Origina
     C                     Z-ADDWJBRTM    PBBRTM           OH Appt Confirm
     C                     Z-ADDWJBSTM    PBBSTM           Load BOL Comple
     C                     Z-ADDWJBTTM    PBBTTM           Load Truck Depa
     C                     Z-ADDWJH0NX    PBH0NX           Act Frt Referen
     C                     Z-ADDWJH1NX    PBH1NX           Act Non_Ref Frt
     C                     Z-ADDWJH2NX    PBH2NX           OH Fuel Surchar
     C                     Z-ADDWJH3NX    PBH3NX           OH Total Non_Re
     C                     Z-ADDWJH4NX    PBH4NX           OH Total Ref Fr
     C                     Z-ADDWJC0C7    PBC0C7           Claim Number
     C                     MOVELWJUVST    PBUVST    P      EDI Status 1
     C                     MOVELWJUWST    PBUWST    P      EDI Status 2
     C                     MOVELWJUXST    PBUXST    P      EDI Status 3
     C                     Z-ADDWJAATM    PBAATM           Job Time
     C                     MOVELWJAYNA    PBAYNA    P      User Id
     C                     MOVELWJA0NA    PBA0NA    P      Job Name
     C                     Z-ADDWJAXDT    PBAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKRVGN    BEGSR
      *================================================================
      * RTV Load Header All,Mg RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTK     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDWL0099    FJRMNB           Load ID
      * Establish starting position
     C           KRSTK     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFJAODT    WL0100           Scheduled Ship
     C                     MOVELFJPJST    WL0101           LTL Flag
     C                     MOVELFJPKST    WL0102           Load Status
     C                     Z-ADDFJRNNB    WL0103           Reefer Temperat
     C                     MOVELFJDMTX    WL0104           Seal 1
     C                     MOVELFJDNTX    WL0105           Seal 2
     C                     MOVELFJDOTX    WL0106           Seal 3
     C                     Z-ADDFJRPNB    WL0107           Total Load Orde
     C                     Z-ADDFJFLAM    WL0108           Flat Amount
     C                     MOVELFJXQST    WL0109           Allocate Pounds
     C                     Z-ADDFJRRNB    WL0110           Total Stops
     C                     MOVELFJDXTX    WL0111           Trailer Id
     C                     MOVELFJDYTX    WL0112           Transloader Car
     C                     Z-ADDFJSBNB    WL0113           BOL Time
     C                     MOVELFJBZNA    WL0114           Carrier Code
     C                     MOVELFJRONB    WL0115           Truck Size
     C                     Z-ADDFJSQNB    WL0116           Ld Hdr_Ld Dtl U
     C                     Z-ADDFJR1NB    WL0117           Rated Freight
     C                     MOVELFJVCST    WL0118           Ship Status
     C                     MOVELFJVDST    WL0119           Load Type
     C                     Z-ADDFJSDNB    WL0120           Number Pallets
     C                     Z-ADDFJPAOU    WL0121           Number Pallets
     C                     Z-ADDFJDGWG    WL0122           Load Carrier Pa
     C                     Z-ADDFJSXNB    WL0123           Estimated Arriv
     C                     Z-ADDFJHADT    WL0124           Actual Arrival
     C                     Z-ADDFJAART    WL0125           Actual Arrival
     C                     Z-ADDFJDHWG    WL0126           Trailer IN Weig
     C                     Z-ADDFJDIWG    WL0127           Trailer OUT Wei
     C                     Z-ADDFJAQDT    WL0128           Actual Departur
     C                     Z-ADDFJS6NB    WL0129           Departure Time
     C                     Z-ADDFJT4NB    WL0130           Schedule Sequen
     C                     Z-ADDFJPRTM    WL0131           Product Tempera
     C                     Z-ADDFJNPSV    WL0132           Number Spacers
     C                     MOVELFJJ8TX    WL0133           Car_Veh_Initial
     C                     Z-ADDFJTLMI    WL0134           Total Load Mile
     C                     MOVELFJJ9TX    WL0135           Recorder ID
     C                     MOVELFJQ2CD    WL0136           Shipping Method
     C                     MOVELFJVPCD    WL0137           Ship From Wareh
     C                     MOVELFJDBCD    WL0138           Ship To State C
     C                     Z-ADDFJGRWE    WL0139           Gross Weight
     C                     MOVELFJXCCD    WL0140           Carrier Broker
     C                     MOVELFJU2ST    WL0141           Export Status
     C                     Z-ADDFJF9DT    WL0142           Actual Ship Dat
     C                     MOVELFJONTM    WL0143           On Time_Y_N
     C                     Z-ADDFJJ4DT    WL0144           Truck Ready Dat
     C                     Z-ADDFJTRTM    WL0145           Truck Ready Tim
     C                     Z-ADDFJJ5DT    WL0146           Spotted Date
     C                     Z-ADDFJSPTM    WL0147           Spotted Time
     C                     Z-ADDFJJ6DT    WL0148           Load Finished D
     C                     Z-ADDFJLFTM    WL0149           Load Finished T
     C                     Z-ADDFJJ7DT    WL0150           BOL Complete Da
     C                     Z-ADDFJBOTM    WL0151           BOL Complete Ti
     C                     Z-ADDFJJ8DT    WL0152           BOL Received Da
     C                     Z-ADDFJBLTM    WL0153           BOL Received Ti
     C                     Z-ADDFJKIDT    WL0154           Truck Departure
     C                     Z-ADDFJASTM    WL0155           Truck Departure
     C                     Z-ADDFJKADT    WL0156           Adjusted Depart
     C                     Z-ADDFJAJCM    WL0157           Adjusted Depart
     C                     MOVELFJXACD    WL0158           Shipping Line
     C                     MOVELFJOANA    WL0159           Port Delv Termi
     C                     MOVELFJK4TX    WL0160           Vessel Name
     C                     Z-ADDFJVOAG    WL0161           Voyage
     C                     Z-ADDFJKBDT    WL0162           Sail Date
     C                     MOVELFJNBBO    WL0163           Booking Number
     C                     MOVELFJW4CD    WL0164           Discharge Port
     C                     Z-ADDFJEFDT    WL0165           Arrival Date
     C                     MOVELFJCNTN    WL0166           Container Numbe
     C                     Z-ADDFJKCDT    WL0167           Date In
     C                     Z-ADDFJTMIN    WL0168           Time In
     C                     Z-ADDFJKDDT    WL0169           Date Out
     C                     Z-ADDFJVMNB    WL0170           Time Out
     C                     Z-ADDFJOCFR    WL0171           Load Total Frei
     C                     Z-ADDFJKJDT    WL0172           Scheduled Deliv
     C                     Z-ADDFJATTM    WL0173           Scheduled Deliv
     C                     MOVELFJOTRS    WL0174           LH Unused Sts
     C                     Z-ADDFJKKDT    WL0175           On Yard Date
     C                     Z-ADDFJAVTM    WL0176           On Yard Time
     C                     Z-ADDFJKZDT    WL0177           Deadline Depart
     C                     Z-ADDFJAXTM    WL0178           Deadline Depart
     C                     MOVELFJRYSX    WL0179           MG Created Load
     C                     GOTO TKEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * Rtv/Chg Whs,ld miles  RT - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0694  70       Total Load Mile
     C                     MOVEL*BLANK    WN0695  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0696  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0697  70       Override Total
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDWL0180    FJRMNB           Load ID
      * Establish starting position
     C           KRSTL     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * RTV First Order Whse   RT - OM Load Detail  * 
     C                     EXSR TMRVGN
      * CASE: DB1.Warehouse Code EQ PAR.Ship From Warehouse
     C           FJAJCD    IFEQ WN0695                     *IF
     C                     MOVEL*BLANK    WN0696           Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELFJAJCD    WN0696           Warehouse Code
     C                     END                             *FI
      * ** 11/16/2007 LJB FP1251 Total Load Miles will = zeros if no
      * ** Miles Between Cities record exists
      * ** Override total load miles will take precedence over tlm  E0020
      * E4119 RMC 7/15/16  Upd miles if NOT MG LOAD
      * CASE: DB1.MG Created Load is Yes
     C           FJRYSX    IFEQ 'Y'                        *IF
     C                     Z-ADDFJTLMI    WN0694           Total Load Mile
     C                     Z-ADDFJK2DT    WN0697           Override Total
     C                     ELSE
      * CASE: *OTHERWISE
      * CLC Total Load Miles   XF - Load Detail  * 
     C                     CLEARPCRC
     C                     Z-ADDFJRMNB    PCRMNB           Load ID
      *
     C                     CALL 'PDW3XFR'              90  CLC Total Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             KEY: Load Detai
     C           WN0694    PARM WN0694    WQ0127  70       Total Load Mile
     C           WN0697    PARM WN0697    WQ0128  70       Override Total
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * ** Add override miles to the update            E00207 LJB 08/13/0
      * CHG Ship FrmWhs,ld mls CH - Load Header  * 
     C                     EXSR TNCHRC
     C                     ENDIF
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMRVGN    BEGSR
      *================================================================
      * RTV First Order Whse   RT - OM Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQTM02           Load ID
      * Define keylist
     C           KPSTM     KLIST
     C                     KFLD           WQTM02           Load ID
     C                     KFLD           FLRVNB           Stop_Drop
      * Define keylist
     C           KRSTM     KLIST
     C                     KFLD           WQTM02           Load ID
      * Setup key
     C                     Z-ADDFJRMNB    WQTM02           Load ID
     C                     Z-ADD1         FLRVNB           Stop_Drop
      * Establish starting position
     C           KPSTM     SETLL@FLCPEB                    *
     C           KRSTM     READE@FLCPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0019           Company Number
     C                     Z-ADDFLC4NB    WL0020           Order Number
     C                     Z-ADD*ZERO     WL0021           Order Sequence
     C                     Z-ADD*ZERO     WL0022           Order Secondary
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0023    WN0695    P      Warehouse Code
     C                     MOVELWL0024    WUG0TX    P      Trans Contol AS
     C                     GOTO TMEXIT                     *QUIT
     C           KRSTM     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNCHRC    BEGSR
      *================================================================
      * CHG Ship FrmWhs,ld mls CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0698  30       Company Number
     C                     Z-ADD*ZERO     WN0699  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0700  1        LTL Flag
     C                     MOVEL*BLANK    WN0701  1        Load Status
     C                     Z-ADD*ZERO     WN0702  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0703 15        Seal 1
     C                     MOVEL*BLANK    WN0704 15        Seal 2
     C                     MOVEL*BLANK    WN0705 15        Seal 3
     C                     MOVEL*BLANK    WN0706 15        Seal 4
     C                     MOVEL*BLANK    WN0707 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0708  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0709 112       Flat Amount
     C                     MOVEL*BLANK    WN0710  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0711  50       Total Stops
     C                     MOVEL*BLANK    WN0712 20        Trailer Id
     C                     MOVEL*BLANK    WN0713  3        Transloader Car
     C                     Z-ADD*ZERO     WN0714  40       BOL Time
     C                     MOVEL*BLANK    WN0715  3        Carrier Code
     C                     MOVEL*BLANK    WN0716  7        Truck Size
     C                     Z-ADD*ZERO     WN0717  70       Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WN0718 112       Rated Freight
     C                     MOVEL*BLANK    WN0719  1        Ship Status
     C                     MOVEL*BLANK    WN0720  1        Load Type
     C                     Z-ADD*ZERO     WN0721  50       Number Pallets
     C                     Z-ADD*ZERO     WN0722  50       Number Pallets
     C                     Z-ADD*ZERO     WN0723 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0724  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0725  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0726  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0727 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0728 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0729  70       Actual Departur
     C                     Z-ADD*ZERO     WN0730  40       Departure Time
     C                     Z-ADD*ZERO     WN0731  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0732  52       Product Tempera
     C                     Z-ADD*ZERO     WN0733  50       Number Spacers
     C                     MOVEL*BLANK    WN0734 12        Car_Veh_Initial
     C                     MOVEL*BLANK    WN0735 12        Recorder ID
     C                     MOVEL*BLANK    WN0736  2        Shipping Method
     C                     MOVEL*BLANK    WN0737  2        Ship To State C
     C                     Z-ADD*ZERO     WN0738  70       Gross Weight
     C                     MOVEL*BLANK    WN0739  3        Carrier Broker
     C                     MOVEL*BLANK    WN0740  1        Export Status
     C                     Z-ADD*ZERO     WN0741  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0742  1        On Time_Y_N
     C                     Z-ADD*ZERO     WN0743  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0744  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0745  70       Spotted Date
     C                     Z-ADD*ZERO     WN0746  60       Spotted Time
     C                     Z-ADD*ZERO     WN0747  70       Load Finished D
     C                     Z-ADD*ZERO     WN0748  60       Load Finished T
     C                     Z-ADD*ZERO     WN0749  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0750  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0751  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0752  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0753  70       Truck Departure
     C                     Z-ADD*ZERO     WN0754  60       Truck Departure
     C                     Z-ADD*ZERO     WN0755  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0756  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0757  3        Shipping Line
     C                     MOVEL*BLANK    WN0758 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0759 30        Vessel Name
     C                     Z-ADD*ZERO     WN0760  50       Voyage
     C                     Z-ADD*ZERO     WN0761  70       Sail Date
     C                     MOVEL*BLANK    WN0762 12        Booking Number
     C                     MOVEL*BLANK    WN0763 20        Discharge Port
     C                     Z-ADD*ZERO     WN0764  70       Arrival Date
     C                     MOVEL*BLANK    WN0765 12        Container Numbe
     C                     Z-ADD*ZERO     WN0766  70       Date In
     C                     Z-ADD*ZERO     WN0767  60       Time In
     C                     Z-ADD*ZERO     WN0768  70       Date Out
     C                     Z-ADD*ZERO     WN0769  60       Time Out
     C                     Z-ADD*ZERO     WN0770 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0771  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0772  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0773  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0774  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0775  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0776  70       Requested Deliv
     C                     MOVEL*BLANK    WN0777  1        Load Acceptance
     C                     Z-ADD*ZERO     WN0778  70       On Yard Date
     C                     Z-ADD*ZERO     WN0779  60       On Yard Time
     C                     Z-ADD*ZERO     WN0780  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0781  60       Deadline Depart
     C                     MOVEL*BLANK    WN0782  1        Load Held Over
     C                     MOVEL*BLANK    WN0783  1        Load Held Over
     C                     MOVEL*BLANK    WN0784 15        Load Held Over
     C                     MOVEL*BLANK    WN0785 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0786 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0787  70       Express Mail Da
     C                     MOVEL*BLANK    WN0788  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0789  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0790  70       Product Complet
     C                     Z-ADD*ZERO     WN0791  60       Product Complet
     C                     Z-ADD*ZERO     WN0792  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0793  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0794  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0795  1        Load Confirmed
     C                     MOVEL*BLANK    WN0796 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0797  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0798  60       Load Door 1
     C                     Z-ADD*ZERO     WN0799  60       Load Door 2
     C                     MOVEL*BLANK    WN0800  1        Partial Load
     C                     MOVEL*BLANK    WN0801  1        Load Confirmati
     C                     MOVEL*BLANK    WN0802  1        Export Load USD
     C                     MOVEL*BLANK    WN0803  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0804 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0805 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0806 15        Late Billing Em
     C                     MOVEL*BLANK    WN0807 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0808 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0809  1        Multi Company L
     C                     MOVEL*BLANK    WN0810  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0811  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0812  1        LH Power Only L
     C                     MOVEL*BLANK    WN0813  1        MG Created Load
     C                     MOVEL*BLANK    WN0814  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0815  2        Load U_M
     C                     MOVEL*BLANK    WN0816  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0817  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0818  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0819  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0820  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0821  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0822  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0823  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0824  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0825  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0826  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0827  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0828  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0829  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0830  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0831  60       LH Unused Time
     C                     MOVEL*BLANK    WN0832  1        EDI Status 1
     C                     MOVEL*BLANK    WN0833  1        EDI Status 2
     C                     MOVEL*BLANK    WN0834  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0835  60       Job Time
     C                     MOVEL*BLANK    WN0836 10        User Id
     C                     MOVEL*BLANK    WN0837 10        Job Name
     C                     Z-ADD*ZERO     WN0838  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDFJRMNB    WKRMNB           Load ID
      *
     C           KLCHTN    KLIST
     C                     KFLD           WKRMNB           Load ID
     C           KLCHTN    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TNEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YFRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDWN0694    WKTLMI           Total Load Mile
     C                     MOVELWN0695    WKVPCD    P      Ship From Wareh
     C                     MOVELWN0696    WKAJCD    P      Warehouse Code
     C                     Z-ADDWN0697    WKK2DT           Override Total
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WKAATM           Job Time
     C                     MOVEL##USR     WKAYNA           User Id
     C                     MOVEL##PGM     WKA0NA           Job Name
     C                     Z-ADD##JDT     WKAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TORVGN    BEGSR
      *================================================================
      * RTV 1st Carr Apt Dt/Tm RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQTO02           Load ID
      * Define keylist
     C           KPSTO     KLIST
     C                     KFLD           WQTO02           Load ID
     C                     KFLD           FLRVNB           Stop_Drop
      * Define keylist
     C           KRSTO     KLIST
     C                     KFLD           WQTO02           Load ID
      * Setup key
     C                     Z-ADDWL0181    WQTO02           Load ID
     C                     Z-ADDWL0182    FLRVNB           Stop_Drop
      * Establish starting position
     C           KPSTO     SETLL@FLCPEB                    *
     C           KRSTO     READE@FLCPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TOEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDFLN7DT    WL0183           LD Carrier Appt
     C                     Z-ADDFLB3TM    WL0184           LD Carrier Appt
     C                     GOTO TOEXIT                     *QUIT
     C           KRSTO     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPRVGN    BEGSR
      *================================================================
      * Rtv 1st Ord Delv Dt/Tm RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQTP02           Load ID
      * Define keylist
     C           KPSTP     KLIST
     C                     KFLD           WQTP02           Load ID
     C                     KFLD           FLRVNB           Stop_Drop
      * Define keylist
     C           KRSTP     KLIST
     C                     KFLD           WQTP02           Load ID
      * Setup key
     C                     Z-ADDWL0185    WQTP02           Load ID
     C                     Z-ADDWL0186    FLRVNB           Stop_Drop
      * Establish starting position
     C           KPSTP     SETLL@FLCPEB                    *
     C           KRSTP     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Delivery Date/Time RT - Order Header TRG  * 
     C                     EXSR TQRVGN
     C                     GOTO TPEXIT                     *QUIT
     C           KRSTP     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQRVGN    BEGSR
      *================================================================
      * Rtv Delivery Date/Time RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTQ     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
      * Setup key
     C                     Z-ADDFLAIC3    WEAIC3           Company Number
     C                     Z-ADDFLC4NB    WEC4NB           Order Number
      * Establish starting position
     C           KRSTQ     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUBRTX           Ship To Name
     C                     MOVEL*BLANK    WUHNNA           Ship To City
     C                     Z-ADD*ZERO     WL0187           Requested Deliv
     C                     Z-ADD*ZERO     WL0188           Requested Deliv
     C                     GOTO TQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEBRTX    WUBRTX           Ship To Name
     C                     MOVELWEHNNA    WUHNNA           Ship To City
     C                     Z-ADDWEEIDT    WL0187           Requested Deliv
     C                     Z-ADDWEAFTM    WL0188           Requested Deliv
     C                     ENDIF
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRRVGN    BEGSR
      *================================================================
      * RTV Shipping Method    RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTR     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDWL0189    FJRMNB           Load ID
      * Establish starting position
     C           KRSTR     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFJQ2CD    WL0190           Shipping Method
     C                     ENDIF
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         TSRVGN    BEGSR
      *================================================================
      * RTV 1st Stop Mileage   RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQTS02           Load ID
      * Define keylist
     C           KPSTS     KLIST
     C                     KFLD           WQTS02           Load ID
     C                     KFLD           FLRVNB           Stop_Drop
     C                     KFLD           FLC4NB           Order Number
      * Define keylist
     C           KRSTS     KLIST
     C                     KFLD           WQTS02           Load ID
      * Setup key
     C                     Z-ADDWL0191    WQTS02           Load ID
     C                     Z-ADDWL0192    FLRVNB           Stop_Drop
     C                     Z-ADDWL0193    FLC4NB           Order Number
      * Establish starting position
     C           KPSTS     SETLL@FLCPEB                    *
     C           KRSTS     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFLRWNB    WL0194           Miles to next s
     C                     GOTO TSEXIT                     *QUIT
     C           KRSTS     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         TSEXIT    ENDSR
      /EJECT
     CSR         TTRVGN    BEGSR
      *================================================================
      * RTV Legal Run Miles DscRT - Legal Run Mileage Hours  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KPSTT     KLIST
     C                     KFLD           LGMILE           Miles to First
      * Setup key
     C                     Z-ADDWL0195    LGMILE           Miles to First
      * Establish starting position
     C           KPSTT     SETLL@LGCPNM                    *
     C                     READ @LGCPNM                  90*
      * Data record not found
     C   90                MOVEL'USR2462' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDLGHRRQ    WL0196           Hours Required
     C                     GOTO TTEXIT                     *QUIT
     C                     READ @LGCPNM                  90*
     C                     ENDDO
      *================================================================
     CSR         TTEXIT    ENDSR
      /EJECT
     CSR         TURVGN    BEGSR
      *================================================================
      * RTV Total Ld Mi/Sts    RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTU     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDWL0197    FJRMNB           Load ID
      * Establish starting position
     C           KRSTU     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFJPKST    WL0198           Load Status
     C                     Z-ADDFJTLMI    WL0199           Total Load Mile
     C                     Z-ADDFJK2DT    WL0200           Override Total
     C                     ENDIF
      *================================================================
     CSR         TUEXIT    ENDSR
      /EJECT
     CSR         TVRVGN    BEGSR
      *================================================================
      * RTV Last Stop Consign  RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLRMNB    WQTV02           Load ID
      * Define keylist
     C           KRSTV     KLIST
     C                     KFLD           WQTV02           Load ID
      * Setup key
     C                     Z-ADDWL0201    WQTV02           Load ID
      * Establish starting position
     C           KRSTV     SETLL@FLCPE8                    *
     C           KRSTV     READE@FLCPE8                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV for B.O.L. Print   RT - PD Order Header  * 
     C                     EXSR TWRVGN
     C                     GOTO TVEXIT                     *QUIT
     C           KRSTV     READE@FLCPE8                  90*
     C                     ENDDO
      *================================================================
     CSR         TVEXIT    ENDSR
      /EJECT
     CSR         TWRVGN    BEGSR
      *================================================================
      * RTV for B.O.L. Print   RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTW     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
      * Setup key
     C                     Z-ADDWLAIC3    WEAIC3           Company Number
     C                     Z-ADDWLC4NB    WEC4NB           Order Number
      * Establish starting position
     C           KRSTW     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWEBKC7    WL0202           Ship To Custome
     C                     MOVELWEBRTX    WL0203           Ship To Name
     C                     MOVELWEHMNA    WL0204           Ship To Address
     C                     MOVELWEHONA    WL0205           Ship To Address
     C                     MOVELWEHPNA    WL0206           Ship To Address
     C                     MOVELWEHNNA    WL0207           Ship To City
     C                     MOVELWEDBCD    WL0208           Ship To State C
     C                     MOVELWECKTX    WL0209           Ship To Zip_Pos
     C                     MOVELWEBCNA    WUG0TX           Customer Purcha
     C                     MOVELWEB6NA    WUG0TX           Special Instruc
     C                     MOVELWEBYNA    WUG0TX           Special Instruc
     C                     Z-ADDWEEIDT    WUNFNN           Requested Deliv
     C                     Z-ADDWEAFTM    WUNFNN           Requested Deliv
     C                     ENDIF
      *================================================================
     CSR         TWEXIT    ENDSR
      /EJECT
     CSR         TXRVGN    BEGSR
      *================================================================
      * RTV Ship To City/St-Ld RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGRMNB    WQTX02           Load ID
      * Define keylist
     C           KRSTX     KLIST
     C                     KFLD           WQTX02           Load ID
      * Setup key
     C                     Z-ADDWL0210    WQTX02           Load ID
      * Establish starting position
     C           KRSTX     SETLL@BFCPD9                    *
     C           KRSTX     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGHNNA    WL0211           Ship To City
     C                     MOVELWGDBCD    WL0212           Ship To State C
     C                     GOTO TXEXIT                     *QUIT
     C           KRSTX     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         TXEXIT    ENDSR
      /EJECT
     CSR         TYRVGN    BEGSR
      *================================================================
      * RTV Destination Amount RT - Carrier Destination Rate  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTY     KLIST
     C                     KFLD           LEBZNA           Carrier Code
     C                     KFLD           LEAJCD           Warehouse Code
     C                     KFLD           LEXECD           Destination Cit
     C                     KFLD           LEBGCD           State Code
      * Setup key
     C                     MOVELWL0213    LEBZNA           Carrier Code
     C                     MOVELWL0214    LEAJCD           Warehouse Code
     C                     MOVELWL0215    LEXECD           Destination Cit
     C                     MOVELWL0216    LEBGCD           State Code
      * Establish starting position
     C           KRSTY     CHAIN@LECPM7              90    *
      * Data record not found
     C   90                MOVEL'USR2455' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * only pass out FLAT amt.  (it could now be a ML rate too)  01/03/0
      * CASE: DB1.CDR Unit of Measure is Flat
     C           LEAVTX    IFEQ 'FL'                       *IF
      * PAR = DB1 By name
     C                     Z-ADDLENMVA    WL0217           Flat Rate
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TYEXIT    ENDSR
      /EJECT
     CSR         TZCHRC    BEGSR
      *================================================================
      * CHG Lock Load Update   CH - Load Header  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0848  30       Company Number
     C                     MOVEL*BLANK    WN0849  1        LTL Flag
     C                     Z-ADD*ZERO     WN0850  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0851 15        Seal 1
     C                     MOVEL*BLANK    WN0852 15        Seal 2
     C                     MOVEL*BLANK    WN0853 15        Seal 3
     C                     MOVEL*BLANK    WN0854 15        Seal 4
     C                     MOVEL*BLANK    WN0855 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0856  70       Total Load Orde
     C                     MOVEL*BLANK    WN0857  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0858  50       Total Stops
     C                     MOVEL*BLANK    WN0859 20        Trailer Id
     C                     MOVEL*BLANK    WN0860  3        Transloader Car
     C                     Z-ADD*ZERO     WN0861  40       BOL Time
     C                     MOVEL*BLANK    WN0862  3        Carrier Code
     C                     MOVEL*BLANK    WN0863  7        Truck Size
     C                     Z-ADD*ZERO     WN0864  70       Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WN0865 112       Rated Freight
     C                     MOVEL*BLANK    WN0866  1        Ship Status
     C                     MOVEL*BLANK    WN0867  1        Load Type
     C                     Z-ADD*ZERO     WN0868  50       Number Pallets
     C                     Z-ADD*ZERO     WN0869  50       Number Pallets
     C                     Z-ADD*ZERO     WN0870 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0871  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0872  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0873  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0874 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0875 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0876  70       Actual Departur
     C                     Z-ADD*ZERO     WN0877  40       Departure Time
     C                     Z-ADD*ZERO     WN0878  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0879  52       Product Tempera
     C                     Z-ADD*ZERO     WN0880  50       Number Spacers
     C                     MOVEL*BLANK    WN0881 12        Car_Veh_Initial
     C                     Z-ADD*ZERO     WN0882  70       Total Load Mile
     C                     MOVEL*BLANK    WN0883 12        Recorder ID
     C                     MOVEL*BLANK    WN0884  2        Shipping Method
     C                     Z-ADD*ZERO     WN0885  70       Gross Weight
     C                     MOVEL*BLANK    WN0886  3        Carrier Broker
     C                     MOVEL*BLANK    WN0887  1        Export Status
     C                     Z-ADD*ZERO     WN0888  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0889  1        On Time_Y_N
     C                     Z-ADD*ZERO     WN0890  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0891  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0892  70       Spotted Date
     C                     Z-ADD*ZERO     WN0893  60       Spotted Time
     C                     Z-ADD*ZERO     WN0894  70       Load Finished D
     C                     Z-ADD*ZERO     WN0895  60       Load Finished T
     C                     Z-ADD*ZERO     WN0896  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0897  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0898  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0899  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0900  70       Truck Departure
     C                     Z-ADD*ZERO     WN0901  60       Truck Departure
     C                     Z-ADD*ZERO     WN0902  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0903  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0904  3        Shipping Line
     C                     MOVEL*BLANK    WN0905 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0906 30        Vessel Name
     C                     Z-ADD*ZERO     WN0907  50       Voyage
     C                     Z-ADD*ZERO     WN0908  70       Sail Date
     C                     MOVEL*BLANK    WN0909 12        Booking Number
     C                     MOVEL*BLANK    WN0910 20        Discharge Port
     C                     Z-ADD*ZERO     WN0911  70       Arrival Date
     C                     MOVEL*BLANK    WN0912 12        Container Numbe
     C                     Z-ADD*ZERO     WN0913  70       Date In
     C                     Z-ADD*ZERO     WN0914  60       Time In
     C                     Z-ADD*ZERO     WN0915  70       Date Out
     C                     Z-ADD*ZERO     WN0916  60       Time Out
     C                     Z-ADD*ZERO     WN0917 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0918  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0919  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0920  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0921  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0922  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0923  70       Requested Deliv
     C                     MOVEL*BLANK    WN0924  1        Load Acceptance
     C                     MOVEL*BLANK    WN0925  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0926  70       On Yard Date
     C                     Z-ADD*ZERO     WN0927  60       On Yard Time
     C                     MOVEL*BLANK    WN0928  1        Load Held Over
     C                     MOVEL*BLANK    WN0929  1        Load Held Over
     C                     MOVEL*BLANK    WN0930 15        Load Held Over
     C                     MOVEL*BLANK    WN0931 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0932 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0933  70       Express Mail Da
     C                     MOVEL*BLANK    WN0934  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0935  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0936  70       Product Complet
     C                     Z-ADD*ZERO     WN0937  60       Product Complet
     C                     Z-ADD*ZERO     WN0938  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0939  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0940  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0941  1        Load Confirmed
     C                     MOVEL*BLANK    WN0942 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0943  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0944  60       Load Door 1
     C                     Z-ADD*ZERO     WN0945  70       Override Total
     C                     Z-ADD*ZERO     WN0946  60       Load Door 2
     C                     MOVEL*BLANK    WN0947  1        Partial Load
     C                     MOVEL*BLANK    WN0948  1        Load Confirmati
     C                     MOVEL*BLANK    WN0949  1        Export Load USD
     C                     MOVEL*BLANK    WN0950  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0951 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0952 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0953 15        Late Billing Em
     C                     MOVEL*BLANK    WN0954 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0955 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0956  1        Multi Company L
     C                     MOVEL*BLANK    WN0957  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0958  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0959  1        LH Power Only L
     C                     MOVEL*BLANK    WN0960  1        MG Created Load
     C                     MOVEL*BLANK    WN0961  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0962  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0963  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0964  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0965  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0966  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0967  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0968  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0969  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0970  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0971  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0972  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0973  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0974  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0975  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0976  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0977  60       LH Unused Time
     C                     MOVEL*BLANK    WN0978  1        EDI Status 1
     C                     MOVEL*BLANK    WN0979  1        EDI Status 2
     C                     MOVEL*BLANK    WN0980  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0981  60       Job Time
     C                     MOVEL*BLANK    WN0982 10        User Id
     C                     MOVEL*BLANK    WN0983 10        Job Name
     C                     Z-ADD*ZERO     WN0984  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWL0218    WKRMNB           Load ID
      *
     C           KLCHTZ    KLIST
     C                     KFLD           WKRMNB           Load ID
     C           KLCHTZ    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TZEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TZEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YGRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDWL0219    WKAODT           Scheduled Ship
     C                     MOVELWL0220    WKPKST    P      Load Status
     C                     Z-ADDWL0221    WKFLAM           Flat Amount
     C                     MOVELWL0222    WKVPCD    P      Ship From Wareh
     C                     MOVELWL0223    WKDBCD    P      Ship To State C
     C                     Z-ADDWL0224    WKKZDT           Deadline Depart
     C                     Z-ADDWL0225    WKAXTM           Deadline Depart
     C                     MOVELWL0226    WKR0SX    P      Load U_M
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WKAATM           Job Time
     C                     MOVEL##USR     WKAYNA           User Id
     C                     MOVEL##JOB     WKA0NA           Job Name
     C                     Z-ADD##JDT     WKAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TZEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Ensure that we're using fresh data
      *================================================================
      * RTV All Header Fields  RT - OP Order Header  * 
     C                     EXSR SMRVGN
     C                     MOVEL#1XJST    #RAEST           USR Production
      * Init screen Credit hold to blank if No.
      * CASE: RCD.Credit Hold is No
     C           #1XIST    IFEQ 'N'                        *IF
     C                     MOVELWUGSTX    #1XIST           Credit Hold
     C                     END                             *FI
      * Init Prod hold to blank if No.
      * CASE: RCD.Production Hold is No
     C           #1XJST    IFEQ 'N'                        *IF
     C                     MOVELWUGSTX    #RAEST           USR Production
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * ** 09/20/2011 LJB P001251 Export Order Automation
      * ** Cannot lock if Export Order Automation Upload had errors
      * ** that have not been cleared up
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * *****
      * ** 09/20/2011 LJB P001251  Export Order Automation Upload
      * ** Cannot lock load if there are errors still pending in the
      * ** Order Detail record
      * *****
      * ** Auto lock if shipping today & no errors            E00495
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * ** The Date and Time being calculated are the latest date and tim
      * ** that the truck can leave the warehouse and still make the
      * ** delivery on time.
      * *****
      * ** E00495 LJB 09.23.2009
      * ** Carrier Appt Date and Time are in the parm Deadline Departure
      * ** date and time, if called from "UPD Ld Mi,Whse,DDD/T IF"
      * *****
      * ** E00207 LJB 08/11/2008
      * ** Override Total Load Miles has been added to the
      * ** Retrieve Total Load Miles function
      * *****
      * ** FP1251 LJB 12/26/2007
      * ** If no Miles To Next record, change SSD/T to zeros.
      * ** Scheduled Deliv Date has (should have) Requested Delivery Date
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Calc Load U/M           -- RMC 6/16/06
      *================================================================
      * ** All boxes=BX, All combos=CB, Any mix of the two=MX   E00239 11
      * RTV UM/Whs Code,BX Qty XF - Order Header TRG  * 
     C                     CALL 'PPYXXFR'              90  RTV UM/Whs Code
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0133  70       Load ID
     C           WN0675    PARM *BLANK    WQ0134  2        Load U_M
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPYXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * ***** Change Log and comments
      *================================================================
      * ** 07/15/16  RMC E4119 Dont recalc deadl depart,miles if MG Creat
      * ** 09/30/2009 LJB E00495
      * **   Use carrier date/time, if entered, to calc DDD/T
      * ** 11/16/2007 LJB FP1251 Deadline Depart Date and Time will be
      * ** zeros if there is no Miles Between Cities record
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * ** The Date and Time being calculated are the latest date and tim
      * ** that the truck can leave the warehouse and still make the
      * ** delivery on time.
      * *****
      * ** E00495 LJB 09.23.2009
      * ** Carrier Appt Date and Time are in the parm Deadline Departure
      * ** date and time, if called from "UPD Ld Mi,Whse,DDD/T IF"
      * *****
      * ** E00207 LJB 08/11/2008
      * ** Override Total Load Miles has been added to the
      * ** Retrieve Total Load Miles function
      * *****
      * ** FP1251 LJB 12/26/2007
      * ** If no Miles To Next record, change SSD/T to zeros.
      * ** Scheduled Deliv Date has (should have) Requested Delivery Date
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Calc Load U/M           -- RMC 6/16/06
      *================================================================
      * ** All boxes=BX, All combos=CB, Any mix of the two=MX   E00239 11
      * RTV UM/Whs Code,BX Qty XF - Order Header TRG  * 
     C                     CALL 'PPYXXFR'              90  RTV UM/Whs Code
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0174  70       Load ID
     C           WN0999    PARM *BLANK    WQ0175  2        Load U_M
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPYXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * ***** Change Log and comments
      *================================================================
      * ** 07/15/16  RMC E4119 Dont recalc deadl depart,miles if MG Creat
      * ** 09/30/2009 LJB E00495
      * **   Use carrier date/time, if entered, to calc DDD/T
      * ** 11/16/2007 LJB FP1251 Deadline Depart Date and Time will be
      * ** zeros if there is no Miles Between Cities record
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
     C           *IN25     IFEQ '0'
      * Bypass when help done
     C                     SETOF                     94    *
     C           W0OVR0    IFEQ '1'
     C           W0OVR0    OREQ '0'
     C           *IN99     ANDEQ'0'
      * If override or no error
     C                     SETON                     94    *
     C           W0RR0     IFNE *ZERO
     C           W0RR0     IFGT ##RRMX
     C                     Z-ADD##RRMX    ##SFRC
     C                     ELSE
     C                     Z-ADDW0RR0     ##SFRC
     C                     END
     C                     END
     C                     Z-ADDW0ROW0    ZZCSRW
     C                     Z-ADDW0COL0    ZZCSCL
     C                     END
     C                     END
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C           ZINPOS    IFGE 02816
     C           ZINPOS    ANDLE05376
      * Cursor in the subfile record area
      * Reset cursor position to the basic (first) record for lookup
     C           W0CRW     SUB  11        W0CSRR  50
     C                     DIV  02        W0CSRR
     C                     MVR            ZINPOS
     C                     ADD  11        ZINPOS
     C                     MULT 256       ZINPOS
     C                     ADD  W0CCL     ZINPOS
      * Calculate rrn of the cursor position
     C                     ADD  ##SFRC    W0CSRR
     C                     ENDIF
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C           W0CFL     IFEQ *BLANK
     C                     Z-ADD0         W0CSRR
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
     C                     SETOF                     94    *
     C                     Z-ADD0         W0RR0   40
     C                     Z-ADD0         W0ROW0  30
     C                     Z-ADD0         W0COL0  30
     C                     MOVE '2'       W0OVR0  1
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD11        ZHSTRW  40
     C                     Z-ADD20        ZHNDRW  40
     C                     Z-ADD2         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
     C                     END
      *
     C           ZHCSRW    IFEQ 010
     C           ZHCSCL    ANDEQ028
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#2XJST'  YPMTFD           Production Hold
     C                     END
      *
     C           ZHCSRW    IFEQ 010
     C           ZHCSCL    ANDEQ030
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#2XIST'  YPMTFD           Credit Hold
     C                     END
      *
     C           ZHCSRW    IFEQ 010
     C           ZHCSCL    ANDEQ032
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#2BCST'  YPMTFD           Block Order Fla
     C                     END
      *
     C           ZHCSRW    IFEQ 010
     C           ZHCSCL    ANDEQ042
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#CPKST'  YPMTFD           Load Status
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1ECST           Error Status
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2AJCD           Warehouse Code
     C                     Z-ADD*ZERO     P2AIC3           Company Number
     C                     MOVEL*BLANK    P2DNCD           Application Cod
     C                     MOVEL*BLANK    P2BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P2AJVN           User Profile Na
     C                     MOVEL*BLANK    P2I6ST           Allow Multi_Com
     C                     MOVEL*BLANK    P2MPNA           Default Printer
     C                     MOVEL*BLANK    P2TAST           First Time Flag
     C                     MOVEL*BLANK    P2HHST           Access Limited
      * Clear all neither parameters
     C                     MOVEL*BLANK    P3XNST           Production Hold
      * Clear all neither parameters
     C                     MOVEL*BLANK    P4PKST           Load Status
      * Clear all neither parameters
     C                     MOVEL*BLANK    P5JNCD           Order Type_Sale
     C                     Z-ADD*ZERO     P5BKC7           Ship To Custome
     C                     MOVEL*BLANK    P5HNNA           Ship To City
     C                     MOVEL*BLANK    P5DBCD           Ship To State C
     C                     MOVEL*BLANK    P5BCNA           Customer Purcha
     C                     Z-ADD*ZERO     P5A0DT           Order Date
     C                     Z-ADD*ZERO     P5A5DT           Requested Ship
     C                     MOVEL*BLANK    P5GWST           Header Status
     C                     Z-ADD*ZERO     P5AODT           Scheduled Ship
     C                     MOVEL*BLANK    P5XIST           Credit Hold
     C                     MOVEL*BLANK    P5XJST           Production Hold
     C                     Z-ADD*ZERO     P5EIDT           Requested Deliv
     C                     Z-ADD*ZERO     P5RMNB           Load ID
      * Clear all neither parameters
     C                     MOVEL*BLANK    P6WRST           PRT Printer Dev
     C                     MOVEL*BLANK    P6WSST           PRT Hold Output
     C                     MOVEL*BLANK    P6WTST           PRT Save Output
     C                     Z-ADD*ZERO     P6DYNB           PRT Number of C
     C                     MOVEL*BLANK    P6WUST           PRT Night Queue
     C                     MOVEL*BLANK    P6BVVN           PRT Night Queue
     C                     MOVEL*BLANK    P6BMVN           Program name US
     C                     MOVEL*BLANK    P6BWVN           Program Name$ U
     C                     MOVEL*BLANK    P6XFST           Display Prt Opt
      * Clear all neither parameters
     C                     MOVEL*BLANK    P7FLST           USR Process sta
      * Clear all neither parameters
     C                     MOVEL*BLANK    P8RYSX           MG Created Load
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAANC7           AR Customer Num
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WAA0DT           Order Date
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WAACDT           Cancel Date
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WAJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WAA1WG           Order Weight To
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WATBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WAATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WARSRN           Resell Referenc
     C                     Z-ADD*ZERO     WAT3NB           Attach to Order
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WAAWDT           Invoice Date
     C                     Z-ADD*ZERO     WAVRVA           A_R order Value
     C                     Z-ADD*ZERO     WAB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WANODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WANPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WANQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WANRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WANSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WABPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WABQTM           Time of Origina
     C                     Z-ADD*ZERO     WABRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WABSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WABTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WAH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WAH1NX           Act Non_Ref Frt
     C                     Z-ADD*ZERO     WAH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WAH3NX           OH Total Non_Re
     C                     Z-ADD*ZERO     WAH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCDPNB           Order Sequence
     C                     Z-ADD*ZERO     WCUENB           Order Secondary
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WCMAVA           Billing Detail
     C                     Z-ADD*ZERO     WCKDVA           Billing Detail
     C                     Z-ADD*ZERO     WCL8VA           Billing Detail
     C                     Z-ADD*ZERO     WCL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WCAYVA           Extended Amount
     C                     Z-ADD*ZERO     WCEXDT           Market Pricing
     C                     Z-ADD*ZERO     WCBZPR           Price Overage O
     C                     Z-ADD*ZERO     WCL6NB           Contract Number
     C                     Z-ADD*ZERO     WCGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WCD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WCCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WCAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WCCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WCATWG           Weight Shipped
     C                     Z-ADD*ZERO     WCAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WCAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WCAKPR           Unit Price
     C                     Z-ADD*ZERO     WCALPR           Unit Price_Cred
     C                     Z-ADD*ZERO     WCAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WCAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WCA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WCA5DT           Requested Ship
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WCRGNB           Item Structure
     C                     Z-ADD*ZERO     WCRHNB           Item Structure
     C                     Z-ADD*ZERO     WCRINB           Item Structure
     C                     Z-ADD*ZERO     WCCXDT           Date of Origina
     C                     Z-ADD*ZERO     WCDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WCB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WCA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WCNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WCNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WCNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WCNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WCNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WCBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WCBVTM           Price Code
     C                     Z-ADD*ZERO     WCBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WCBXTM           Substitution Li
     C                     Z-ADD*ZERO     WCBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WCH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WCH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WCH7NX           OD Item Target
     C                     Z-ADD*ZERO     WCH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WCH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WCDVPR           Order Gate_Fina
     C                     Z-ADD*ZERO     WCDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WCDXPR           OD Gate_Final P
     C                     Z-ADD*ZERO     WCDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WCDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WCGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WCGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WCGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WCPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WCRINY           Item Age Days
     C                     Z-ADD*ZERO     WCTIDT           Production Ovr
     C                     Z-ADD*ZERO     WCTJDT           Production Ovr
     C                     Z-ADD*ZERO     WCTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WCTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WCTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define work field Deadline Departure Time
     C                     Z-ADD*ZERO     WUAXTM  60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WDRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WDFLAM           Flat Amount
     C                     Z-ADD*ZERO     WDRRNB           Total Stops
     C                     Z-ADD*ZERO     WDSBNB           BOL Time
     C                     Z-ADD*ZERO     WDSQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDSDNB           Number Pallets
     C                     Z-ADD*ZERO     WDPAOU           Number Pallets
     C                     Z-ADD*ZERO     WDDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WDSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WDHADT           Actual Arrival
     C                     Z-ADD*ZERO     WDAART           Actual Arrival
     C                     Z-ADD*ZERO     WDDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WDDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WDAQDT           Actual Departur
     C                     Z-ADD*ZERO     WDS6NB           Departure Time
     C                     Z-ADD*ZERO     WDT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WDPRTM           Product Tempera
     C                     Z-ADD*ZERO     WDNPSV           Number Spacers
     C                     Z-ADD*ZERO     WDTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WDGRWE           Gross Weight
     C                     Z-ADD*ZERO     WDF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WDJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WDTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WDJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WDSPTM           Spotted Time
     C                     Z-ADD*ZERO     WDJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WDLFTM           Load Finished T
     C                     Z-ADD*ZERO     WDJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WDBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WDJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WDBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WDKIDT           Truck Departure
     C                     Z-ADD*ZERO     WDASTM           Truck Departure
     C                     Z-ADD*ZERO     WDKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WDAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WDVOAG           Voyage
     C                     Z-ADD*ZERO     WDKBDT           Sail Date
     C                     Z-ADD*ZERO     WDEFDT           Arrival Date
     C                     Z-ADD*ZERO     WDKCDT           Date In
     C                     Z-ADD*ZERO     WDTMIN           Time In
     C                     Z-ADD*ZERO     WDKDDT           Date Out
     C                     Z-ADD*ZERO     WDVMNB           Time Out
     C                     Z-ADD*ZERO     WDOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WDKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WDATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WDBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WDEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WDKKDT           On Yard Date
     C                     Z-ADD*ZERO     WDAVTM           On Yard Time
     C                     Z-ADD*ZERO     WDKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WDAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WDLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WDK0DT           Product Complet
     C                     Z-ADD*ZERO     WDAYTM           Product Complet
     C                     Z-ADD*ZERO     WDKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WDICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WDIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WDK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WDAZTM           Load Door 1
     C                     Z-ADD*ZERO     WDK2DT           Override Total
     C                     Z-ADD*ZERO     WDA0TM           Load Door 2
     C                     Z-ADD*ZERO     WDZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WDPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WDCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WDPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WDCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WDP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WDCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WDP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WDCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WDP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WDCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WDP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WDCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field USR Warehouse Code
     C                     MOVEL*BLANK    WUCPCD  3
      * Define work field USR Program name
     C                     MOVEL*BLANK    WUBNVN 10
      * Define work field USR Program Name 2
     C                     MOVEL*BLANK    WUBQVN 10
      * Define work field Company Number CDE
     C                     Z-ADD*ZERO     WUATNB  30
      * Define work field Company Number Pass   USR
     C                     Z-ADD*ZERO     WUAJAA 155
      * Define work field Order Number 1  PASS  USR
     C                     Z-ADD*ZERO     WUAJAE 155
      * Define work field Order Number 2  PASS  USR
     C                     Z-ADD*ZERO     WUAJAF 155
      * Define work field Date 1          PASS  USR
     C                     Z-ADD*ZERO     WUAJAB 155
      * Define work field Date 2          PASS  USR
     C                     Z-ADD*ZERO     WUAJAC 155
      * Define work field Date 3          PASS  USR
     C                     Z-ADD*ZERO     WULVNX 155
      * Define work field Thru Date Pass        USR
     C                     Z-ADD*ZERO     WUAJAG 155
      * Define work field Blank for 4           USR
     C                     MOVEL*BLANK    WUOTTX  4
      * Define work field Byte
     C                     MOVEL*BLANK    WUTCTX  1
      * Define work field USR Flag 1
     C                     MOVEL*BLANK    WUD4ST  1
      * Define work field Job Name CDE
     C                     MOVEL*BLANK    WUB2VN 10
      * Define work field Name
     C                     MOVEL*BLANK    WUADTX 30
      * Define work field Scheduled Ship Date
     C                     Z-ADD*ZERO     WUAODT  70
      * Define work field Reefer Temperature
     C                     Z-ADD*ZERO     WURNNB  52
      * Define work field Flat Amount
     C                     Z-ADD*ZERO     WUFLAM 112
      * Define work field Allocate Pounds_Miles
     C                     MOVEL*BLANK    WUXQST  1
      * Define work field Rated Freight
     C                     Z-ADD*ZERO     WUR1NB 112
      * Define work field Load Type
     C                     MOVEL*BLANK    WUVDST  1
      * Define work field Schedule Sequence Number
     C                     Z-ADD*ZERO     WUT4NB  50
      * Define work field Total Load Miles
     C                     Z-ADD*ZERO     WUTLMI  70
      * Define work field Ship From Warehouse
     C                     MOVEL*BLANK    WUVPCD  3
      * Define work field Ship To State Code
     C                     MOVEL*BLANK    WUDBCD  2
      * Define work field Carrier Broker
     C                     MOVEL*BLANK    WUXCCD  3
      * Define work field Override Total Load Miles
     C                     Z-ADD*ZERO     WUK2DT  70
      * Define work field Shipping Temp C_F txt
     C                     MOVEL*BLANK    WUWRTX 25
      * Define work field USR Check Y/N Status
     C                     MOVEL*BLANK    WUJDST  1
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Define work field Access Denied (Y/N)
     C                     MOVEL*BLANK    WUWVST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WHBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WHBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WHBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WHBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Define work field Unlock Load Authority
     C                     MOVEL*BLANK    WUHTST  1
      * Define work field Pick Status USR
     C                     MOVEL*BLANK    WUZMST  1
      * Define work field Status - Y or N
     C                     MOVEL*BLANK    WUB8ST  1
      * Define work field Order Value Total
     C                     Z-ADD*ZERO     WUJZVA 112
      * Define work field Order Weight Total
     C                     Z-ADD*ZERO     WUA1WG 112
      * Define work field Item Code Txt
     C                     MOVEL*BLANK    WUFYTX  7
      * Define work field STATUS
     C                     MOVEL*BLANK    WUATUS  1
      * Define work field Load Status
     C                     MOVEL*BLANK    WUPKST  1
      * Define work field LD Carrier Appt Date
     C                     Z-ADD*ZERO     WUN7DT  70
      * Define work field Ship To Name
     C                     MOVEL*BLANK    WUBRTX 30
      * Define work field Ship To City
     C                     MOVEL*BLANK    WUHNNA 20
      * Define work field USR Hours 5.0
     C                     Z-ADD*ZERO     WU      50
      * Define work field @Numeric 6,0
     C                     Z-ADD*ZERO     WUPINB  60
      * Define work field Ship To Customer
     C                     Z-ADD*ZERO     WUBKC7  70
      * Define work field Ship To Address Line 1
     C                     MOVEL*BLANK    WUHMNA 30
      * Define work field Ship To Address Line 2
     C                     MOVEL*BLANK    WUHONA 30
      * Define work field Ship To Address Line 3
     C                     MOVEL*BLANK    WUHPNA 30
      * Define work field Ship To Zip_Postal Code
     C                     MOVEL*BLANK    WUCKTX 11
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLRMNB           Load ID
     C                     Z-ADD*ZERO     WLRUNB           Stop_Drop Seque
     C                     Z-ADD*ZERO     WLRVNB           Stop_Drop
     C                     Z-ADD*ZERO     WLRWNB           Miles to next s
     C                     Z-ADD*ZERO     WLRXNB           Freight Charge
     C                     Z-ADD*ZERO     WLSQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WLT0NB           Freight Misc_Ch
     C                     Z-ADD*ZERO     WLT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WLR1NB           Rated Freight
     C                     Z-ADD*ZERO     WLAIC3           Company Number
     C                     Z-ADD*ZERO     WLC4NB           Order Number
     C                     Z-ADD*ZERO     WLKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WLSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WLKFDT           Appointment Con
     C                     Z-ADD*ZERO     WLACTM           Appointment Con
     C                     Z-ADD*ZERO     WLEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WLAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WLKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WLATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WLHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WLAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WLKKDT           On Yard Date
     C                     Z-ADD*ZERO     WLAVTM           On Yard Time
     C                     Z-ADD*ZERO     WLZ4NB           MPC Number
     C                     Z-ADD*ZERO     WLN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WLN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WLN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WLB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WLB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WLB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Define work field Destination City
     C                     MOVEL*BLANK    WUXECD 20
      * Define work field USR Select/Omit Flag
     C                     MOVEL*BLANK    WUCYST  1
      * Define work field USR Detail or Summary
     C                     MOVEL*BLANK    WUSTST  1
      * Define work field AUTO PRINT PRELIM PICK
     C                     MOVEL*BLANK    WUCLST  1
      * Define work field PRT Printer Device
     C                     MOVEL*BLANK    WUWRST 10
      * Define work field PRT Hold Output Sts
     C                     MOVEL*BLANK    WUWSST  4
      * Define work field PRT Save Output Sts
     C                     MOVEL*BLANK    WUWTST  4
      * Define work field PRT Night Queue Run Sts
     C                     MOVEL*BLANK    WUWUST  1
      * Define work field PRT Night Queue
     C                     MOVEL*BLANK    WUBVVN 10
      * Define work field System Value Numeric
     C                     Z-ADD*ZERO     WUM8NB 155
      * Define work field Trans Contol AS400_Plant
     C                     MOVEL*BLANK    WUXUST  1
      * Define work field Warehouse Description
     C                     MOVEL*BLANK    WUF8NA 30
      * Define work field Load Change Type
     C                     MOVEL*BLANK    WURVST  6
      * Define work field Department Control Code
     C                     MOVEL*BLANK    WUUJST  3
      * Define work field Load Acceptance Flag
     C                     MOVEL*BLANK    WURMST  1
      * Define work field USR Adjustment Amount 1
     C                     Z-ADD*ZERO     WUICVA 112
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Initialize *SET CURSOR data
     C                     MOVE 'Y'       YSETCS  1
     C                     EXSR Y9CLR
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WE   179       *Synon (17,9) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SARVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003  2
     C                     Z-ADD*ZERO     WL0004  70
     C                     MOVEL*BLANK    WL0005 20
     C                     MOVEL*BLANK    WL0006  2
     C                     MOVEL*BLANK    WL0007 15
     C                     Z-ADD*ZERO     WL0008  70
     C                     Z-ADD*ZERO     WL0009  70
     C                     MOVEL*BLANK    WL0010  1
     C                     Z-ADD*ZERO     WL0011  70
     C                     MOVEL*BLANK    WL0012  1
     C                     MOVEL*BLANK    WL0013  1
     C                     Z-ADD*ZERO     WL0014  70
     C                     Z-ADD*ZERO     WL0015  70
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0016  30
     C                     MOVEL*BLANK    WL0017 10
     C                     Z-ADD*ZERO     WL0018 155
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0019  30
     C                     Z-ADD*ZERO     WL0020  70
     C                     Z-ADD*ZERO     WL0021  30
     C                     Z-ADD*ZERO     WL0022  30
     C                     MOVEL*BLANK    WL0023  3
     C                     MOVEL*BLANK    WL0024  1
      * Define local variables for subroutine SKRVGN.
     C                     Z-ADD*ZERO     WL0025  70
     C                     MOVEL*BLANK    WL0026  1
      * Define local variables for subroutine SNRVGN.
     C                     Z-ADD*ZERO     WL0027  30
     C                     Z-ADD*ZERO     WL0028  70
     C                     MOVEL*BLANK    WL0029  1
     C                     MOVEL*BLANK    WL0030  1
     C                     MOVEL*BLANK    WL0031  1
     C                     MOVEL*BLANK    WL0032  1
     C                     MOVEL*BLANK    WL0033  2
      * Define local variables for subroutine SPRVGN.
     C                     Z-ADD*ZERO     WL0034  70
     C                     Z-ADD*ZERO     WL0035  70
     C                     MOVEL*BLANK    WL0036  1
     C                     Z-ADD*ZERO     WL0037  52
     C                     Z-ADD*ZERO     WL0038  70
     C                     Z-ADD*ZERO     WL0039 112
     C                     MOVEL*BLANK    WL0040  1
     C                     MOVEL*BLANK    WL0041  3
     C                     MOVEL*BLANK    WL0042  7
     C                     Z-ADD*ZERO     WL0043 112
     C                     MOVEL*BLANK    WL0044  1
     C                     Z-ADD*ZERO     WL0045  50
     C                     Z-ADD*ZERO     WL0046  70
     C                     MOVEL*BLANK    WL0047  2
     C                     MOVEL*BLANK    WL0048  3
     C                     MOVEL*BLANK    WL0049  2
     C                     MOVEL*BLANK    WL0050  3
     C                     MOVEL*BLANK    WL0051  1
     C                     Z-ADD*ZERO     WL0052  70
     C                     MOVEL*BLANK    WL0053 25
      * Define local variables for subroutine SQRVGN.
     C                     Z-ADD*ZERO     WL0054  70
     C                     MOVEL*BLANK    WL0055  1
     C                     MOVEL*BLANK    WL0056  1
      * Define local variables for subroutine SRRVGN.
     C                     MOVEL*BLANK    WL0057 10
     C                     MOVEL*BLANK    WL0058  1
     C                     MOVEL*BLANK    WL0059 10
     C                     MOVEL*BLANK    WL0060  3
     C                     Z-ADD*ZERO     WL0061  30
     C                     MOVEL*BLANK    WL0062 10
      * Define local variables for subroutine SSRVGN.
     C                     MOVEL*BLANK    WL0063 10
     C                     MOVEL*BLANK    WL0064  6
     C                     Z-ADD*ZERO     WL0065  30
     C                     MOVEL*BLANK    WL0066  3
      * Define local variables for subroutine STRVGN.
     C                     MOVEL*BLANK    WL0067  3
     C                     Z-ADD*ZERO     WL0068  30
      * Define local variables for subroutine SURVGN.
     C                     Z-ADD*ZERO     WL0069  30
     C                     MOVEL*BLANK    WL0070 30
      * Define local variables for subroutine SVRVGN.
     C                     Z-ADD*ZERO     WL0071  70
     C                     MOVEL*BLANK    WL0072  1
      * Define local variables for subroutine SWRVGN.
     C                     MOVEL*BLANK    WL0073  1
     C                     MOVEL*BLANK    WL0074  1
     C                     Z-ADD*ZERO     WL0075  70
      * Define local variables for subroutine SXRVGN.
     C                     Z-ADD*ZERO     WL0076  70
     C                     MOVEL*BLANK    WL0077  2
      * Define local variables for subroutine SYRVGN.
     C                     MOVEL*BLANK    WL0078  7
     C                     Z-ADD*ZERO     WL0079  70
     C                     Z-ADD*ZERO     WL0080  70
      * Define local variables for subroutine TDCHRC.
     C                     Z-ADD*ZERO     WL0081  30
     C                     Z-ADD*ZERO     WL0082  70
     C                     Z-ADD*ZERO     WL0083  30
     C                     Z-ADD*ZERO     WL0084  30
     C                     MOVEL*BLANK    WL0085  1
      * Define local variables for subroutine TFCHRC.
     C                     Z-ADD*ZERO     WL0086  30
     C                     Z-ADD*ZERO     WL0087  70
     C                     MOVEL*BLANK    WL0088  2
      * Define local variables for subroutine TGRVGN.
     C                     Z-ADD*ZERO     WL0089  30
     C                     Z-ADD*ZERO     WL0090  70
     C                     Z-ADD*ZERO     WL0091  30
     C                     Z-ADD*ZERO     WL0092  30
      * Define local variables for subroutine TJCHRC.
     C                     Z-ADD*ZERO     WL0093  30
     C                     Z-ADD*ZERO     WL0094  70
     C                     MOVEL*BLANK    WL0095  3
     C                     MOVEL*BLANK    WL0096  1
     C                     MOVEL*BLANK    WL0097  1
     C                     MOVEL*BLANK    WL0098  1
      * Define local variables for subroutine TKRVGN.
     C                     Z-ADD*ZERO     WL0099  70
     C                     Z-ADD*ZERO     WL0100  70
     C                     MOVEL*BLANK    WL0101  1
     C                     MOVEL*BLANK    WL0102  1
     C                     Z-ADD*ZERO     WL0103  52
     C                     MOVEL*BLANK    WL0104 15
     C                     MOVEL*BLANK    WL0105 15
     C                     MOVEL*BLANK    WL0106 15
     C                     Z-ADD*ZERO     WL0107  70
     C                     Z-ADD*ZERO     WL0108 112
     C                     MOVEL*BLANK    WL0109  1
     C                     Z-ADD*ZERO     WL0110  50
     C                     MOVEL*BLANK    WL0111 20
     C                     MOVEL*BLANK    WL0112  3
     C                     Z-ADD*ZERO     WL0113  40
     C                     MOVEL*BLANK    WL0114  3
     C                     MOVEL*BLANK    WL0115  7
     C                     Z-ADD*ZERO     WL0116  70
     C                     Z-ADD*ZERO     WL0117 112
     C                     MOVEL*BLANK    WL0118  1
     C                     MOVEL*BLANK    WL0119  1
     C                     Z-ADD*ZERO     WL0120  50
     C                     Z-ADD*ZERO     WL0121  50
     C                     Z-ADD*ZERO     WL0122 112
     C                     Z-ADD*ZERO     WL0123  60
     C                     Z-ADD*ZERO     WL0124  70
     C                     Z-ADD*ZERO     WL0125  40
     C                     Z-ADD*ZERO     WL0126 112
     C                     Z-ADD*ZERO     WL0127 112
     C                     Z-ADD*ZERO     WL0128  70
     C                     Z-ADD*ZERO     WL0129  40
     C                     Z-ADD*ZERO     WL0130  50
     C                     Z-ADD*ZERO     WL0131  52
     C                     Z-ADD*ZERO     WL0132  50
     C                     MOVEL*BLANK    WL0133 12
     C                     Z-ADD*ZERO     WL0134  70
     C                     MOVEL*BLANK    WL0135 12
     C                     MOVEL*BLANK    WL0136  2
     C                     MOVEL*BLANK    WL0137  3
     C                     MOVEL*BLANK    WL0138  2
     C                     Z-ADD*ZERO     WL0139  70
     C                     MOVEL*BLANK    WL0140  3
     C                     MOVEL*BLANK    WL0141  1
     C                     Z-ADD*ZERO     WL0142  70
     C                     MOVEL*BLANK    WL0143  1
     C                     Z-ADD*ZERO     WL0144  70
     C                     Z-ADD*ZERO     WL0145  60
     C                     Z-ADD*ZERO     WL0146  70
     C                     Z-ADD*ZERO     WL0147  60
     C                     Z-ADD*ZERO     WL0148  70
     C                     Z-ADD*ZERO     WL0149  60
     C                     Z-ADD*ZERO     WL0150  70
     C                     Z-ADD*ZERO     WL0151  60
     C                     Z-ADD*ZERO     WL0152  70
     C                     Z-ADD*ZERO     WL0153  60
     C                     Z-ADD*ZERO     WL0154  70
     C                     Z-ADD*ZERO     WL0155  60
     C                     Z-ADD*ZERO     WL0156  70
     C                     Z-ADD*ZERO     WL0157  60
     C                     MOVEL*BLANK    WL0158  3
     C                     MOVEL*BLANK    WL0159 20
     C                     MOVEL*BLANK    WL0160 30
     C                     Z-ADD*ZERO     WL0161  50
     C                     Z-ADD*ZERO     WL0162  70
     C                     MOVEL*BLANK    WL0163 12
     C                     MOVEL*BLANK    WL0164 20
     C                     Z-ADD*ZERO     WL0165  70
     C                     MOVEL*BLANK    WL0166 12
     C                     Z-ADD*ZERO     WL0167  70
     C                     Z-ADD*ZERO     WL0168  60
     C                     Z-ADD*ZERO     WL0169  70
     C                     Z-ADD*ZERO     WL0170  60
     C                     Z-ADD*ZERO     WL0171 112
     C                     Z-ADD*ZERO     WL0172  70
     C                     Z-ADD*ZERO     WL0173  60
     C                     MOVEL*BLANK    WL0174  1
     C                     Z-ADD*ZERO     WL0175  70
     C                     Z-ADD*ZERO     WL0176  60
     C                     Z-ADD*ZERO     WL0177  70
     C                     Z-ADD*ZERO     WL0178  60
     C                     MOVEL*BLANK    WL0179  1
      * Define local variables for subroutine TLRVGN.
     C                     Z-ADD*ZERO     WL0180  70
      * Define local variables for subroutine TORVGN.
     C                     Z-ADD*ZERO     WL0181  70
     C                     Z-ADD*ZERO     WL0182  50
     C                     Z-ADD*ZERO     WL0183  70
     C                     Z-ADD*ZERO     WL0184  60
      * Define local variables for subroutine TPRVGN.
     C                     Z-ADD*ZERO     WL0185  70
     C                     Z-ADD*ZERO     WL0186  50
     C                     Z-ADD*ZERO     WL0187  70
     C                     Z-ADD*ZERO     WL0188  40
      * Define local variables for subroutine TRRVGN.
     C                     Z-ADD*ZERO     WL0189  70
     C                     MOVEL*BLANK    WL0190  2
      * Define local variables for subroutine TSRVGN.
     C                     Z-ADD*ZERO     WL0191  70
     C                     Z-ADD*ZERO     WL0192  50
     C                     Z-ADD*ZERO     WL0193  70
     C                     Z-ADD*ZERO     WL0194  50
      * Define local variables for subroutine TTRVGN.
     C                     Z-ADD*ZERO     WL0195  70
     C                     Z-ADD*ZERO     WL0196  51
      * Define local variables for subroutine TURVGN.
     C                     Z-ADD*ZERO     WL0197  70
     C                     MOVEL*BLANK    WL0198  1
     C                     Z-ADD*ZERO     WL0199  70
     C                     Z-ADD*ZERO     WL0200  70
      * Define local variables for subroutine TVRVGN.
     C                     Z-ADD*ZERO     WL0201  70
     C                     Z-ADD*ZERO     WL0202  70
     C                     MOVEL*BLANK    WL0203 30
     C                     MOVEL*BLANK    WL0204 30
     C                     MOVEL*BLANK    WL0205 30
     C                     MOVEL*BLANK    WL0206 30
     C                     MOVEL*BLANK    WL0207 20
     C                     MOVEL*BLANK    WL0208  2
     C                     MOVEL*BLANK    WL0209 11
      * Define local variables for subroutine TXRVGN.
     C                     Z-ADD*ZERO     WL0210  70
     C                     MOVEL*BLANK    WL0211 20
     C                     MOVEL*BLANK    WL0212  2
      * Define local variables for subroutine TYRVGN.
     C                     MOVEL*BLANK    WL0213  3
     C                     MOVEL*BLANK    WL0214  3
     C                     MOVEL*BLANK    WL0215 20
     C                     MOVEL*BLANK    WL0216  2
     C                     Z-ADD*ZERO     WL0217 112
      * Define local variables for subroutine TZCHRC.
     C                     Z-ADD*ZERO     WL0218  70
     C                     Z-ADD*ZERO     WL0219  70
     C                     MOVEL*BLANK    WL0220  1
     C                     Z-ADD*ZERO     WL0221 112
     C                     MOVEL*BLANK    WL0222  3
     C                     MOVEL*BLANK    WL0223  2
     C                     Z-ADD*ZERO     WL0224  70
     C                     Z-ADD*ZERO     WL0225  60
     C                     MOVEL*BLANK    WL0226  2
      * Define local variables for subroutine NARVGN.
     C                     Z-ADD*ZERO     WL0227  70
     C                     MOVEL*BLANK    WL0228  3
     C                     MOVEL*BLANK    WL0229  3
     C                     MOVEL*BLANK    WL0230  3
     C                     MOVEL*BLANK    WL0231  3
     C                     MOVEL*BLANK    WL0232  3
     C                     MOVEL*BLANK    WL0233  3
     C                     MOVEL*BLANK    WL0234  3
     C                     MOVEL*BLANK    WL0235  3
     C                     MOVEL*BLANK    WL0236  3
     C                     MOVEL*BLANK    WL0237  3
      * Define local variables for subroutine NCRVGN.
     C                     Z-ADD*ZERO     WL0238  70
     C                     MOVEL*BLANK    WL0239  1
      * Define local variables for subroutine NGRVGN.
     C                     Z-ADD*ZERO     WL0240  30
     C                     MOVEL*BLANK    WL0241  6
     C                     MOVEL*BLANK    WL0242  1
     C                     MOVEL*BLANK    WL0243  1
      * Define local variables for subroutine NQCHRC.
     C                     Z-ADD*ZERO     WL0244  30
     C                     Z-ADD*ZERO     WL0245  70
     C                     Z-ADD*ZERO     WL0246  30
     C                     Z-ADD*ZERO     WL0247  30
     C                     Z-ADD*ZERO     WL0248 112
      * Define local work field Boxes Total Quantity
     C                     Z-ADD*ZERO     YL0001 112
      * Define local work field U_M_Ordered
     C                     MOVEL*BLANK    YL0002  2
      * Define local work field Box Load Min Box Qty USR
     C                     Z-ADD*ZERO     YL0003  50
      * Define local work field Status Flag 2  Y/N
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field Status Flag 14 Y/N
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field PFS Carlisle Active
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field PFS AccuSort Active
     C                     MOVEL*BLANK    YL0007  1
      * Define local work field Access Denied (Y/N)
     C                     MOVEL*BLANK    YL0008  1
      * Define local work field Load Status
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0010  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0011  3
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0012  30
      * Define local work field Order Requires Review
     C                     MOVEL*BLANK    YL0013  2
      * Define local work field Header Status
     C                     MOVEL*BLANK    YL0014  1
      * Define local work field Allow to Remove Order USR
     C                     MOVEL*BLANK    YL0015  1
      * Define local work field Count USR
     C                     Z-ADD*ZERO     YL0016  50
      * Define local work field Generic Message 80 USR
     C                     MOVEL*BLANK    YL0017 80
      * Define local work field Order Requires Review
     C                     MOVEL*BLANK    YL0018  2
      * Define null work field Ship To State Code
     C                     MOVEL*BLANK    YN0001  2
      * Define local work field Shipping Method
     C                     MOVEL*BLANK    YL0019  2
      * Define local work field Hours Required
     C                     Z-ADD*ZERO     YL0020  51
      * Define local work field Additional Route Hours
     C                     Z-ADD*ZERO     YL0021  50
      * Define local work field PFS AccuSort Active
     C                     MOVEL*BLANK    YL0022  1
      * Define local work field PFS Carlisle Active
     C                     MOVEL*BLANK    YL0023  1
      * Define null work field Default Printer
     C                     MOVEL*BLANK    YN0002 10
      * Define local work field Include in Auto Pre Pick
     C                     MOVEL*BLANK    YL0024  1
      * Define local work field Plant Floor System USR
     C                     MOVEL*BLANK    YL0025  1
      * Define local work field PFS AccuSort Active
     C                     MOVEL*BLANK    YL0026  1
      * Define local work field PFS Carlisle Active
     C                     MOVEL*BLANK    YL0027  1
      * Define local work field Status - Y or N
     C                     MOVEL*BLANK    YL0028  1
      * Define local work field Live with TPM
     C                     MOVEL*BLANK    YL0029  1
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0030  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0031  3
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     Z-ADD05        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
     C                     MOVEL*BLANK    P2DNCD           Application Cod
     C                     MOVEL'P/S'     P2DNCD           Application Cod
      *
     C                     MOVEL*BLANK    WN1482 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN1482           User Profile Na
      *
     C                     MOVEL*BLANK    WN1483 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN1482    WL0057    P      User Profile Na
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0058    P2I6ST    P      Allow Multi_Com
     C                     MOVELWL0059    P2MPNA    P      Default Printer
     C                     MOVELWL0060    P2BCCD    P      Salesperson Cod
     C                     Z-ADDWL0061    YL0030           Company Number
     C                     MOVELWL0062    WN1483    P      User Code Model
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,006                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN1482    ZA0153           User Profile Na
     C                     MOVELP2DNCD    ZA0154           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN1483    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN1482    WL0063    P      User Profile Na
     C                     MOVELP2DNCD    WL0064    P      Application Cod
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0065    P2AIC3           Company Number
     C                     MOVELWL0066    YL0031    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN1483    WL0063    P      User Profile Na
     C                     MOVELP2DNCD    WL0064    P      Application Cod
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0065    P2AIC3           Company Number
     C                     MOVELWL0066    YL0031    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0031    P2AJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN1482    ZA0155           User Profile Na
     C                     MOVELP2DNCD    ZA0156           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0030    IFNE 0                          *IF
     C                     Z-ADDYL0030    P2AIC3           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0031    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           P2AJCD    PARM *BLANK    WQ0222  3        Warehouse Code
     C                     PARM YL0030    WQ0223  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR NRRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
     C                     MOVEL'Y'       P2TAST           First Time Flag
      * RTV Hold Authorities   RT - User Profile Control  * 
     C                     EXSR NTRVGN
     C                     MOVEL'*YES'    P6XFST           Display Prt Opt
     C                     MOVEL'N'       P6WUST           PRT Night Queue
      * ** Allow change to SSD without restrictions           W288
     C                     MOVEL'N'       P2HHST           Access Limited
     C                     Z-ADD999999    W0SLM            *Scan limit
      * SFL Fold/Drop  RPG    US - /UT User Source  * 
     C                     Z-ADD8         ##SFPG
      * EXC Rtv Status        XF - PFS Interface  * 
     C                     CALL 'PBXNXFR'              90  EXC Rtv Status
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P2AIC3    WQ0224  30       PFS Company Num
     C                     PARM 'TMSLDP'  WQ0225  6        PFS Interface C
     C           YL0006    PARM *BLANK    WQ0226  1        PFS Carlisle Ac
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBXNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * EXC Rtv Status-AS     XF - PFS Interface  * 
     C                     CALL 'PBX2XFR'              90  EXC Rtv Status-
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P2AIC3    WQ0227  30       PFS Company Num
     C                     PARM 'TMSLDP'  WQ0228  6        PFS Interface C
     C           YL0007    PARM *BLANK    WQ0229  1        PFS AccuSort Ac
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBX2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** W0BEG
01026025650257402578025880259002592
02594026020260402607026150261902627
02818028210283002834028440284602848
02850028580286002863028710287502883
0308503101031110313603144
** W0END
01103025720257602585025880259002592
02600026020260502613026170262502639
02819028280283202841028440284602848
02856028580286102869028730288102895
0308903101031230314003148
** W0NAM
**SPT     V2AODT    #CCPCD    V2EIDT    #2XJST    #2XIST    #2BCST
#2RMNB    #CPKST    #CODCD    V2C4NB    V2AIC3    V2BKC7    #CAYTX
#1SEL     V1AODT    #RAJCD    V1EIDT    #RAEST    #1XIST    #1BCST
#1RMNB    #RPKST    #RODCD    V1C4NB    V1AIC3    V1BKC7    #RAYTX
#RT4NB    #RRMST    #1A1WG    #RYANB    #RYBNB
** @CN
00001 USR0752
00002 PDRCCLP
00003 ICQHPFR
00004 Order Acknowledgement
00005 Y2U9999
00006 Y2U0005
00007 Opt 15 invalid for single
00008 Order on Load.
00009 Opt 15 invalid. All Order
00010 s have been shipped.
00011 Order not removed. All Or
00012 ders not shipped.
00013 REALCORD
00014 ALCASORD
00015 Released
00016 PDIZPCLP
00017 Auto Print Prelim. Pick
00018 PDSNPFR
00019 PLTFLRSYS
