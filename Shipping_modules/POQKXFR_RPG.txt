     H/TITLE UPD Allocate Prd      XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 10/05/20  Time  : 12:39:26
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPMFDREL2IF  E           K        DISK
      * RSQ : Company Item Ext          RTV, select Active
      *
     FOPBFCPLOIF  E           K        DISK
      * RSQ : Order Header TRG          Ord-D/Co
      *
     FCAAFREL8IF  E           K        DISK
      * RTV : Calendar                  Co/Date PrdDaySts=Y
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FCAAFREL3IF  E           K        DISK
      * RSQ : Calendar                  Co/Date               NV
      *
     FPDJCCPL1IF  E           K        DISK
      * RTV : PS Prod Schedule          Retrieval index
      *
     FPDI8CPL1IF  E           K        DISK
      * RTV : PS Prod Item Schedule     Retrieval index
      *
     FPDI8CPL4IF  E           K        DISK
      * RSQ : PS Prod Item Schedule     Co/Itm/Whs/PrdDte/Typ
      *
     FPDKNCPL1IF  E           K        DISK
      * RTV : Order Detail Schedule     Retrieval index
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse                 Active records only
      *
     FPOB6CPL3IF  E           K        DISK
      * RSQ : Order Detail Sched-Consmd Co/Ord/PrdDt/Cns/Itm/Seq
      *
     FPOB6CPL1IF  E           K        DISK
      * RTV : Order Detail Sched-Consmd Retrieval index
      *
     FCAAFREL6IF  E           K        DISK
      * RSQ : Calendar                  RSQ Co/Date Descending
      *
     FPDKNCPL0UF  E           K        DISK                      A
      * UPD : Order Detail Schedule     Update index
      *
     FPDI8CPL0UF  E           K        DISK                      A
      * UPD : PS Prod Item Schedule     Update index
      *
     FPOB6CPL0UF  E           K        DISK                      A
      * UPD : Order Detail Sched-Consmd Update index
      *
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WAAIC3
     I              BEC4NB                          WAC4NB
     I              BEJNCD                          WAJNCD
     I              BEANC7                          WAANC7
     I              BEBKC7                          WABKC7
     I              BEBRTX                          WABRTX
     I              BEHMNA                          WAHMNA
     I              BEHONA                          WAHONA
     I              BEHPNA                          WAHPNA
     I              BEHNNA                          WAHNNA
     I              BEDBCD                          WADBCD
     I              BECKTX                          WACKTX
     I              BEB0C7                          WAB0C7
     I              BEAETX                          WAAETX
     I              BEB1NA                          WAB1NA
     I              BEB3NA                          WAB3NA
     I              BEB4NA                          WAB4NA
     I              BEB2NA                          WAB2NA
     I              BEBHCD                          WABHCD
     I              BEC8TX                          WAC8TX
     I              BEBCNA                          WABCNA
     I              BEA0DT                          WAA0DT
     I              BEA5DT                          WAA5DT
     I              BEGNDT                          WAGNDT
     I              BEACDT                          WAACDT
     I              BEAQCD                          WAAQCD
     I              BEB6NA                          WAB6NA
     I              BEBYNA                          WABYNA
     I              BEBZNA                          WABZNA
     I              BEGTST                          WAGTST
     I              BEGVST                          WAGVST
     I              BEGUST                          WAGUST
     I              BEQFST                          WAQFST
     I              BECQCD                          WACQCD
     I              BEGJST                          WAGJST
     I              BEGWST                          WAGWST
     I              BEGXST                          WAGXST
     I              BEGYST                          WAGYST
     I              BEAODT                          WAAODT
     I              BEAIVN                          WAAIVN
     I              BECXDT                          WACXDT
     I              BEJZVA                          WAJZVA
     I              BEA1WG                          WAA1WG
     I              BEXIST                          WAXIST
     I              BEXJST                          WAXJST
     I              BEXKST                          WAXKST
     I              BEEIDT                          WAEIDT
     I              BEAFTM                          WAAFTM
     I              BEE8CD                          WAE8CD
     I              BEE9CD                          WAE9CD
     I              BERMNB                          WARMNB
     I              BETBNB                          WATBNB
     I              BER1NB                          WAR1NB
     I              BEPJST                          WAPJST
     I              BEU0ST                          WAU0ST
     I              BEU1ST                          WAU1ST
     I              BEQ2CD                          WAQ2CD
     I              BEU2ST                          WAU2ST
     I              BEVEST                          WAVEST
     I              BEVFST                          WAVFST
     I              BEVGST                          WAVGST
     I              BERPCD                          WARPCD
     I              BERNNB                          WARNNB
     I              BEVDST                          WAVDST
     I              BEATIN                          WAATIN
     I              BEU4ST                          WAU4ST
     I              BEU5ST                          WAU5ST
     I              BERSRN                          WARSRN
     I              BEMHNA                          WAMHNA
     I              BEMINA                          WAMINA
     I              BEWBST                          WAWBST
     I              BER4CD                          WAR4CD
     I              BEBFCD                          WABFCD
     I              BEQ4CD                          WAQ4CD
     I              BET3NB                          WAT3NB
     I              BESICD                          WASICD
     I              BECONB                          WACONB
     I              BECEST                          WACEST
     I              BEAWDT                          WAAWDT
     I              BEJPCD                          WAJPCD
     I              BEXUST                          WAXUST
     I              BEZ1ST                          WAZ1ST
     I              BEVRVA                          WAVRVA
     I              BEOBST                          WAOBST
     I              BEBCST                          WABCST
     I              BEBDST                          WABDST
     I              BEB7VL                          WAB7VL
     I              BEGASX                          WAGASX
     I              BEGBSX                          WAGBSX
     I              BEGCSX                          WAGCSX
     I              BEGDSX                          WAGDSX
     I              BEFNSX                          WAFNSX
     I              BEFOSX                          WAFOSX
     I              BEFPSX                          WAFPSX
     I              BEFQSX                          WAFQSX
     I              BEFRSX                          WAFRSX
     I              BEFSSX                          WAFSSX
     I              BEFTSX                          WAFTSX
     I              BEFUSX                          WAFUSX
     I              BEFVSX                          WAFVSX
     I              BEFWSX                          WAFWSX
     I              BEFXSX                          WAFXSX
     I              BEFYSX                          WAFYSX
     I              BENODT                          WANODT
     I              BENPDT                          WANPDT
     I              BENQDT                          WANQDT
     I              BENRDT                          WANRDT
     I              BENSDT                          WANSDT
     I              BEBPTM                          WABPTM
     I              BEBQTM                          WABQTM
     I              BEBRTM                          WABRTM
     I              BEBSTM                          WABSTM
     I              BEBTTM                          WABTTM
     I              BEH0NX                          WAH0NX
     I              BEH1NX                          WAH1NX
     I              BEH2NX                          WAH2NX
     I              BEH3NX                          WAH3NX
     I              BEH4NX                          WAH4NX
     I              BEC0C7                          WAC0C7
     I              BEUVST                          WAUVST
     I              BEUWST                          WAUWST
     I              BEUXST                          WAUXST
     I              BEAATM                          WAAATM
     I              BEAYNA                          WAAYNA
     I              BEA0NA                          WAA0NA
     I              BEAXDT                          WAAXDT
      *
     I@FDREAW
      * Company Item Ext          RTV, select Active
      * Renamed input format fields
     I              FDAIC3                          WBAIC3
     I              FDHGCD                          WBHGCD
     I              FDD0ST                          WBD0ST
     I              FDD2ST                          WBD2ST
     I              FDD6ST                          WBD6ST
     I              FDWESP                          WBWESP
     I              FDEDST                          WBEDST
     I              FDEFST                          WBEFST
     I              FDEHST                          WBEHST
     I              FDEMST                          WBEMST
     I              FDENST                          WBENST
     I              FDEOST                          WBEOST
     I              FDEPST                          WBEPST
     I              FDEQST                          WBEQST
     I              FDOQNY                          WBOQNY
     I              FDORNY                          WBORNY
     I              FDS2DT                          WBS2DT
     I              FDUFT1                          WBUFT1
     I              FDKUAA                          WBKUAA
     I              FDVSST                          WBVSST
     I              FDMJDT                          WBMJDT
     I              FDBETM                          WBBETM
     I              FDCCVN                          WBCCVN
     I              FDCDVN                          WBCDVN
     I              FDMKDT                          WBMKDT
     I              FDBFTM                          WBBFTM
     I              FDCEVN                          WBCEVN
     I              FDCFVN                          WBCFVN
      *
     I@BFCPY2
      * Order Header TRG          Ord-D/Co
      * Renamed input format fields
     I              BEAIC3                          WCAIC3
     I              BEC4NB                          WCC4NB
     I              BEJNCD                          WCJNCD
     I              BEANC7                          WCANC7
     I              BEBKC7                          WCBKC7
     I              BEBRTX                          WCBRTX
     I              BEHMNA                          WCHMNA
     I              BEHONA                          WCHONA
     I              BEHPNA                          WCHPNA
     I              BEHNNA                          WCHNNA
     I              BEDBCD                          WCDBCD
     I              BECKTX                          WCCKTX
     I              BEB0C7                          WCB0C7
     I              BEAETX                          WCAETX
     I              BEB1NA                          WCB1NA
     I              BEB3NA                          WCB3NA
     I              BEB4NA                          WCB4NA
     I              BEB2NA                          WCB2NA
     I              BEBHCD                          WCBHCD
     I              BEC8TX                          WCC8TX
     I              BEBCNA                          WCBCNA
     I              BEA0DT                          WCA0DT
     I              BEA5DT                          WCA5DT
     I              BEGNDT                          WCGNDT
     I              BEACDT                          WCACDT
     I              BEAQCD                          WCAQCD
     I              BEB6NA                          WCB6NA
     I              BEBYNA                          WCBYNA
     I              BEBZNA                          WCBZNA
     I              BEGTST                          WCGTST
     I              BEGVST                          WCGVST
     I              BEGUST                          WCGUST
     I              BEQFST                          WCQFST
     I              BECQCD                          WCCQCD
     I              BEGJST                          WCGJST
     I              BEGWST                          WCGWST
     I              BEGXST                          WCGXST
     I              BEGYST                          WCGYST
     I              BEAODT                          WCAODT
     I              BEAIVN                          WCAIVN
     I              BECXDT                          WCCXDT
     I              BEJZVA                          WCJZVA
     I              BEA1WG                          WCA1WG
     I              BEXIST                          WCXIST
     I              BEXJST                          WCXJST
     I              BEXKST                          WCXKST
     I              BEEIDT                          WCEIDT
     I              BEAFTM                          WCAFTM
     I              BEE8CD                          WCE8CD
     I              BEE9CD                          WCE9CD
     I              BERMNB                          WCRMNB
     I              BETBNB                          WCTBNB
     I              BER1NB                          WCR1NB
     I              BEPJST                          WCPJST
     I              BEU0ST                          WCU0ST
     I              BEU1ST                          WCU1ST
     I              BEQ2CD                          WCQ2CD
     I              BEU2ST                          WCU2ST
     I              BEVEST                          WCVEST
     I              BEVFST                          WCVFST
     I              BEVGST                          WCVGST
     I              BERPCD                          WCRPCD
     I              BERNNB                          WCRNNB
     I              BEVDST                          WCVDST
     I              BEATIN                          WCATIN
     I              BEU4ST                          WCU4ST
     I              BEU5ST                          WCU5ST
     I              BERSRN                          WCRSRN
     I              BEMHNA                          WCMHNA
     I              BEMINA                          WCMINA
     I              BEWBST                          WCWBST
     I              BER4CD                          WCR4CD
     I              BEBFCD                          WCBFCD
     I              BEQ4CD                          WCQ4CD
     I              BET3NB                          WCT3NB
     I              BESICD                          WCSICD
     I              BECONB                          WCCONB
     I              BECEST                          WCCEST
     I              BEAWDT                          WCAWDT
     I              BEJPCD                          WCJPCD
     I              BEXUST                          WCXUST
     I              BEZ1ST                          WCZ1ST
     I              BEVRVA                          WCVRVA
     I              BEOBST                          WCOBST
     I              BEBCST                          WCBCST
     I              BEBDST                          WCBDST
     I              BEB7VL                          WCB7VL
     I              BEGASX                          WCGASX
     I              BEGBSX                          WCGBSX
     I              BEGCSX                          WCGCSX
     I              BEGDSX                          WCGDSX
     I              BEFNSX                          WCFNSX
     I              BEFOSX                          WCFOSX
     I              BEFPSX                          WCFPSX
     I              BEFQSX                          WCFQSX
     I              BEFRSX                          WCFRSX
     I              BEFSSX                          WCFSSX
     I              BEFTSX                          WCFTSX
     I              BEFUSX                          WCFUSX
     I              BEFVSX                          WCFVSX
     I              BEFWSX                          WCFWSX
     I              BEFXSX                          WCFXSX
     I              BEFYSX                          WCFYSX
     I              BENODT                          WCNODT
     I              BENPDT                          WCNPDT
     I              BENQDT                          WCNQDT
     I              BENRDT                          WCNRDT
     I              BENSDT                          WCNSDT
     I              BEBPTM                          WCBPTM
     I              BEBQTM                          WCBQTM
     I              BEBRTM                          WCBRTM
     I              BEBSTM                          WCBSTM
     I              BEBTTM                          WCBTTM
     I              BEH0NX                          WCH0NX
     I              BEH1NX                          WCH1NX
     I              BEH2NX                          WCH2NX
     I              BEH3NX                          WCH3NX
     I              BEH4NX                          WCH4NX
     I              BEC0C7                          WCC0C7
     I              BEUVST                          WCUVST
     I              BEUWST                          WCUWST
     I              BEUXST                          WCUXST
     I              BEAATM                          WCAATM
     I              BEAYNA                          WCAYNA
     I              BEA0NA                          WCA0NA
     I              BEAXDT                          WCAXDT
      *
     I@AFREY1
      * Calendar                  Co/Date PrdDaySts=Y
      * Renamed input format fields
     I              AFAIC3                          WDAIC3
     I              AFBCDT                          WDBCDT
     I              AFCQNB                          WDCQNB
     I              AFESNB                          WDESNB
     I              AFETNB                          WDETNB
     I              AFBZNB                          WDBZNB
     I              AFA9ST                          WDA9ST
     I              AFEINB                          WDEINB
     I              AFC5ST                          WDC5ST
     I              AFAQNB                          WDAQNB
     I              AFCMST                          WDCMST
     I              AFV9ST                          WDV9ST
     I              AFWAST                          WDWAST
     I              AFX2ST                          WDX2ST
     I              AFOJDT                          WDOJDT
     I              AFNQNX                          WDNQNX
     I              AFNRNX                          WDNRNX
     I              AFI9SX                          WDI9SX
     I              AFJASX                          WDJASX
     I              AFOKDT                          WDOKDT
     I              AFOLDT                          WDOLDT
     I              AFUVST                          WDUVST
     I              AFUWST                          WDUWST
     I              AFUXST                          WDUXST
     I              AFAATM                          WDAATM
     I              AFAYNA                          WDAYNA
     I              AFA0NA                          WDA0NA
     I              AFAXDT                          WDAXDT
      *
     I@AFREBE
      * Calendar                  Retrieval index       NV
      * Renamed input format fields
     I              AFAIC3                          WEAIC3
     I              AFBCDT                          WEBCDT
     I              AFCQNB                          WECQNB
     I              AFESNB                          WEESNB
     I              AFETNB                          WEETNB
     I              AFBZNB                          WEBZNB
     I              AFA9ST                          WEA9ST
     I              AFEINB                          WEEINB
     I              AFC5ST                          WEC5ST
     I              AFAQNB                          WEAQNB
     I              AFCMST                          WECMST
     I              AFV9ST                          WEV9ST
     I              AFWAST                          WEWAST
     I              AFX2ST                          WEX2ST
     I              AFOJDT                          WEOJDT
     I              AFNQNX                          WENQNX
     I              AFNRNX                          WENRNX
     I              AFI9SX                          WEI9SX
     I              AFJASX                          WEJASX
     I              AFOKDT                          WEOKDT
     I              AFOLDT                          WEOLDT
     I              AFUVST                          WEUVST
     I              AFUWST                          WEUWST
     I              AFUXST                          WEUXST
     I              AFAATM                          WEAATM
     I              AFAYNA                          WEAYNA
     I              AFA0NA                          WEA0NA
     I              AFAXDT                          WEAXDT
      *
     I@AFREYY
      * Calendar                  Co/Date               NV
      * Renamed input format fields
     I              AFAIC3                          WFAIC3
     I              AFBCDT                          WFBCDT
     I              AFCQNB                          WFCQNB
     I              AFESNB                          WFESNB
     I              AFETNB                          WFETNB
     I              AFBZNB                          WFBZNB
     I              AFA9ST                          WFA9ST
     I              AFEINB                          WFEINB
     I              AFC5ST                          WFC5ST
     I              AFAQNB                          WFAQNB
     I              AFCMST                          WFCMST
     I              AFV9ST                          WFV9ST
     I              AFWAST                          WFWAST
     I              AFX2ST                          WFX2ST
     I              AFOJDT                          WFOJDT
     I              AFNQNX                          WFNQNX
     I              AFNRNX                          WFNRNX
     I              AFI9SX                          WFI9SX
     I              AFJASX                          WFJASX
     I              AFOKDT                          WFOKDT
     I              AFOLDT                          WFOLDT
     I              AFUVST                          WFUVST
     I              AFUWST                          WFUWST
     I              AFUXST                          WFUXST
     I              AFAATM                          WFAATM
     I              AFAYNA                          WFAYNA
     I              AFA0NA                          WFA0NA
     I              AFAXDT                          WFAXDT
      *
     I@JCCPVC
      * PS Prod Schedule          Retrieval index
      * Renamed input format fields
     I              JCAIC3                          WGAIC3
     I              JCV5ST                          WGV5ST
     I              JCELDT                          WGELDT
     I              JCHVHD                          WGHVHD
     I              JCZ6NB                          WGZ6NB
     I              JCZ7NB                          WGZ7NB
     I              JCDGPC                          WGDGPC
     I              JCAVCW                          WGAVCW
     I              JCDIPC                          WGDIPC
     I              JCZ0NB                          WGZ0NB
     I              JCAVLE                          WGAVLE
     I              JCECWG                          WGECWG
     I              JCUVST                          WGUVST
     I              JCUWST                          WGUWST
     I              JCUXST                          WGUXST
     I              JCVSST                          WGVSST
     I              JCAATM                          WGAATM
     I              JCAYNA                          WGAYNA
     I              JCA0NA                          WGA0NA
     I              JCAXDT                          WGAXDT
      *
     I@I8CPUS
      * PS Prod Item Schedule     Retrieval index
      * Renamed input format fields
     I              I8AIC3                          WHAIC3
     I              I8V5ST                          WHV5ST
     I              I8ELDT                          WHELDT
     I              I8HGCD                          WHHGCD
     I              I8AJCD                          WHAJCD
     I              I8GPDT                          WHGPDT
     I              I8WTSP                          WHWTSP
     I              I8QTSP                          WHQTSP
     I              I8DJPC                          WHDJPC
     I              I8F8WG                          WHF8WG
     I              I8WTIN                          WHWTIN
     I              I8D5NB                          WHD5NB
     I              I8DXWG                          WHDXWG
     I              I8B2NB                          WHB2NB
     I              I8WTCN                          WHWTCN
     I              I8PSCV                          WHPSCV
     I              I8SAWT                          WHSAWT
     I              I8B9NB                          WHB9NB
     I              I8D1WG                          WHD1WG
     I              I8CBNB                          WHCBNB
     I              I8EZWG                          WHEZWG
     I              I8CCNB                          WHCCNB
     I              I8E0WG                          WHE0WG
     I              I8D6NB                          WHD6NB
     I              I8OAWT                          WHOAWT
     I              I8CDNB                          WHCDNB
     I              I8UNW2                          WHUNW2
     I              I8CENB                          WHCENB
     I              I8F9WG                          WHF9WG
     I              I8BPNB                          WHBPNB
     I              I8GAWG                          WHGAWG
     I              I8BQNB                          WHBQNB
     I              I8GBWG                          WHGBWG
     I              I8BRNB                          WHBRNB
     I              I8GCWG                          WHGCWG
     I              I8BSNB                          WHBSNB
     I              I8GDWG                          WHGDWG
     I              I8BWNB                          WHBWNB
     I              I8GEWG                          WHGEWG
     I              I8PS6U                          WHPS6U
     I              I8WCST                          WHWCST
     I              I8WPST                          WHWPST
     I              I8B5ST                          WHB5ST
     I              I8TFST                          WHTFST
     I              I8TEST                          WHTEST
     I              I8THST                          WHTHST
     I              I8UDST                          WHUDST
     I              I8UFST                          WHUFST
     I              I8UGST                          WHUGST
     I              I8UHST                          WHUHST
     I              I8B6ST                          WHB6ST
     I              I8B7ST                          WHB7ST
     I              I8DVWG                          WHDVWG
     I              I8D7NB                          WHD7NB
     I              I8FCAD                          WHFCAD
     I              I8D9NB                          WHD9NB
     I              I8DWWG                          WHDWWG
     I              I8EANB                          WHEANB
     I              I8SHWT                          WHSHWT
     I              I8EBNB                          WHEBNB
     I              I8AVWT                          WHAVWT
     I              I8ECNB                          WHECNB
     I              I8WTON                          WHWTON
     I              I8EDNB                          WHEDNB
     I              I8FNWT                          WHFNWT
     I              I8EENB                          WHEENB
     I              I8QTAS                          WHQTAS
     I              I8EFNB                          WHEFNB
     I              I8WAIO                          WHWAIO
     I              I8EGNB                          WHEGNB
     I              I8R3CD                          WHR3CD
     I              I8RGNB                          WHRGNB
     I              I8RHNB                          WHRHNB
     I              I8RINB                          WHRINB
     I              I8XRCD                          WHXRCD
     I              I8UVST                          WHUVST
     I              I8UWST                          WHUWST
     I              I8UXST                          WHUXST
     I              I8VSST                          WHVSST
     I              I8AATM                          WHAATM
     I              I8AYNA                          WHAYNA
     I              I8A0NA                          WHA0NA
     I              I8AXDT                          WHAXDT
      *
     I@I8CPXP
      * PS Prod Item Schedule     Co/Itm/Whs/PrdDte/Typ
      * Renamed input format fields
     I              I8AIC3                          WIAIC3
     I              I8V5ST                          WIV5ST
     I              I8ELDT                          WIELDT
     I              I8HGCD                          WIHGCD
     I              I8AJCD                          WIAJCD
     I              I8GPDT                          WIGPDT
     I              I8WTSP                          WIWTSP
     I              I8QTSP                          WIQTSP
     I              I8DJPC                          WIDJPC
     I              I8F8WG                          WIF8WG
     I              I8WTIN                          WIWTIN
     I              I8D5NB                          WID5NB
     I              I8DXWG                          WIDXWG
     I              I8B2NB                          WIB2NB
     I              I8WTCN                          WIWTCN
     I              I8PSCV                          WIPSCV
     I              I8SAWT                          WISAWT
     I              I8B9NB                          WIB9NB
     I              I8D1WG                          WID1WG
     I              I8CBNB                          WICBNB
     I              I8EZWG                          WIEZWG
     I              I8CCNB                          WICCNB
     I              I8E0WG                          WIE0WG
     I              I8D6NB                          WID6NB
     I              I8OAWT                          WIOAWT
     I              I8CDNB                          WICDNB
     I              I8UNW2                          WIUNW2
     I              I8CENB                          WICENB
     I              I8F9WG                          WIF9WG
     I              I8BPNB                          WIBPNB
     I              I8GAWG                          WIGAWG
     I              I8BQNB                          WIBQNB
     I              I8GBWG                          WIGBWG
     I              I8BRNB                          WIBRNB
     I              I8GCWG                          WIGCWG
     I              I8BSNB                          WIBSNB
     I              I8GDWG                          WIGDWG
     I              I8BWNB                          WIBWNB
     I              I8GEWG                          WIGEWG
     I              I8PS6U                          WIPS6U
     I              I8WCST                          WIWCST
     I              I8WPST                          WIWPST
     I              I8B5ST                          WIB5ST
     I              I8TFST                          WITFST
     I              I8TEST                          WITEST
     I              I8THST                          WITHST
     I              I8UDST                          WIUDST
     I              I8UFST                          WIUFST
     I              I8UGST                          WIUGST
     I              I8UHST                          WIUHST
     I              I8B6ST                          WIB6ST
     I              I8B7ST                          WIB7ST
     I              I8DVWG                          WIDVWG
     I              I8D7NB                          WID7NB
     I              I8FCAD                          WIFCAD
     I              I8D9NB                          WID9NB
     I              I8DWWG                          WIDWWG
     I              I8EANB                          WIEANB
     I              I8SHWT                          WISHWT
     I              I8EBNB                          WIEBNB
     I              I8AVWT                          WIAVWT
     I              I8ECNB                          WIECNB
     I              I8WTON                          WIWTON
     I              I8EDNB                          WIEDNB
     I              I8FNWT                          WIFNWT
     I              I8EENB                          WIEENB
     I              I8QTAS                          WIQTAS
     I              I8EFNB                          WIEFNB
     I              I8WAIO                          WIWAIO
     I              I8EGNB                          WIEGNB
     I              I8R3CD                          WIR3CD
     I              I8RGNB                          WIRGNB
     I              I8RHNB                          WIRHNB
     I              I8RINB                          WIRINB
     I              I8XRCD                          WIXRCD
     I              I8UVST                          WIUVST
     I              I8UWST                          WIUWST
     I              I8UXST                          WIUXST
     I              I8VSST                          WIVSST
     I              I8AATM                          WIAATM
     I              I8AYNA                          WIAYNA
     I              I8A0NA                          WIA0NA
     I              I8AXDT                          WIAXDT
      *
     I@KNCPHO
      * Order Detail Schedule     Retrieval index
      * Renamed input format fields
     I              KNAIC3                          WJAIC3
     I              KNC4NB                          WJC4NB
     I              KNDPNB                          WJDPNB
     I              KNUENB                          WJUENB
     I              KNJGDT                          WJJGDT
     I              KNAODT                          WJAODT
     I              KNAJCD                          WJAJCD
     I              KNAYAA                          WJAYAA
     I              KNHGCD                          WJHGCD
     I              KNIGQT                          WJIGQT
     I              KNFLWG                          WJFLWG
     I              KNIUQT                          WJIUQT
     I              KNF3WG                          WJF3WG
     I              KNIVQT                          WJIVQT
     I              KNF4WG                          WJF4WG
     I              KNP7ST                          WJP7ST
     I              KNP8ST                          WJP8ST
     I              KNQAST                          WJQAST
     I              KNUVST                          WJUVST
     I              KNUWST                          WJUWST
     I              KNUXST                          WJUXST
     I              KNVSST                          WJVSST
     I              KNAATM                          WJAATM
     I              KNAYNA                          WJAYNA
     I              KNA0NA                          WJA0NA
     I              KNAXDT                          WJAXDT
      *
     I@KNCPHN
      * Order Detail Schedule     Update index
      * Renamed input format fields
     I              KNAIC3                          WKAIC3
     I              KNC4NB                          WKC4NB
     I              KNDPNB                          WKDPNB
     I              KNUENB                          WKUENB
     I              KNJGDT                          WKJGDT
     I              KNAODT                          WKAODT
     I              KNAJCD                          WKAJCD
     I              KNAYAA                          WKAYAA
     I              KNHGCD                          WKHGCD
     I              KNIGQT                          WKIGQT
     I              KNFLWG                          WKFLWG
     I              KNIUQT                          WKIUQT
     I              KNF3WG                          WKF3WG
     I              KNIVQT                          WKIVQT
     I              KNF4WG                          WKF4WG
     I              KNP7ST                          WKP7ST
     I              KNP8ST                          WKP8ST
     I              KNQAST                          WKQAST
     I              KNUVST                          WKUVST
     I              KNUWST                          WKUWST
     I              KNUXST                          WKUXST
     I              KNVSST                          WKVSST
     I              KNAATM                          WKAATM
     I              KNAYNA                          WKAYNA
     I              KNA0NA                          WKA0NA
     I              KNAXDT                          WKAXDT
      *
     I@I8CPUR
      * PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WLAIC3
     I              I8V5ST                          WLV5ST
     I              I8ELDT                          WLELDT
     I              I8HGCD                          WLHGCD
     I              I8AJCD                          WLAJCD
     I              I8GPDT                          WLGPDT
     I              I8WTSP                          WLWTSP
     I              I8QTSP                          WLQTSP
     I              I8DJPC                          WLDJPC
     I              I8F8WG                          WLF8WG
     I              I8WTIN                          WLWTIN
     I              I8D5NB                          WLD5NB
     I              I8DXWG                          WLDXWG
     I              I8B2NB                          WLB2NB
     I              I8WTCN                          WLWTCN
     I              I8PSCV                          WLPSCV
     I              I8SAWT                          WLSAWT
     I              I8B9NB                          WLB9NB
     I              I8D1WG                          WLD1WG
     I              I8CBNB                          WLCBNB
     I              I8EZWG                          WLEZWG
     I              I8CCNB                          WLCCNB
     I              I8E0WG                          WLE0WG
     I              I8D6NB                          WLD6NB
     I              I8OAWT                          WLOAWT
     I              I8CDNB                          WLCDNB
     I              I8UNW2                          WLUNW2
     I              I8CENB                          WLCENB
     I              I8F9WG                          WLF9WG
     I              I8BPNB                          WLBPNB
     I              I8GAWG                          WLGAWG
     I              I8BQNB                          WLBQNB
     I              I8GBWG                          WLGBWG
     I              I8BRNB                          WLBRNB
     I              I8GCWG                          WLGCWG
     I              I8BSNB                          WLBSNB
     I              I8GDWG                          WLGDWG
     I              I8BWNB                          WLBWNB
     I              I8GEWG                          WLGEWG
     I              I8PS6U                          WLPS6U
     I              I8WCST                          WLWCST
     I              I8WPST                          WLWPST
     I              I8B5ST                          WLB5ST
     I              I8TFST                          WLTFST
     I              I8TEST                          WLTEST
     I              I8THST                          WLTHST
     I              I8UDST                          WLUDST
     I              I8UFST                          WLUFST
     I              I8UGST                          WLUGST
     I              I8UHST                          WLUHST
     I              I8B6ST                          WLB6ST
     I              I8B7ST                          WLB7ST
     I              I8DVWG                          WLDVWG
     I              I8D7NB                          WLD7NB
     I              I8FCAD                          WLFCAD
     I              I8D9NB                          WLD9NB
     I              I8DWWG                          WLDWWG
     I              I8EANB                          WLEANB
     I              I8SHWT                          WLSHWT
     I              I8EBNB                          WLEBNB
     I              I8AVWT                          WLAVWT
     I              I8ECNB                          WLECNB
     I              I8WTON                          WLWTON
     I              I8EDNB                          WLEDNB
     I              I8FNWT                          WLFNWT
     I              I8EENB                          WLEENB
     I              I8QTAS                          WLQTAS
     I              I8EFNB                          WLEFNB
     I              I8WAIO                          WLWAIO
     I              I8EGNB                          WLEGNB
     I              I8R3CD                          WLR3CD
     I              I8RGNB                          WLRGNB
     I              I8RHNB                          WLRHNB
     I              I8RINB                          WLRINB
     I              I8XRCD                          WLXRCD
     I              I8UVST                          WLUVST
     I              I8UWST                          WLUWST
     I              I8UXST                          WLUXST
     I              I8VSST                          WLVSST
     I              I8AATM                          WLAATM
     I              I8AYNA                          WLAYNA
     I              I8A0NA                          WLA0NA
     I              I8AXDT                          WLAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WMAIC3
     I              BZHGCD                          WMHGCD
     I              BZAVNA                          WMAVNA
     I              BZAWNA                          WMAWNA
     I              BZL7NA                          WML7NA
     I              BZL8NA                          WML8NA
     I              BZL6NA                          WML6NA
     I              BZMFNA                          WMMFNA
     I              BZADCD                          WMADCD
     I              BZAWPC                          WMAWPC
     I              BZLXST                          WMLXST
     I              BZAECD                          WMAECD
     I              BZAXPC                          WMAXPC
     I              BZLYST                          WMLYST
     I              BZAFCD                          WMAFCD
     I              BZAICD                          WMAICD
     I              BZAIWG                          WMAIWG
     I              BZHICD                          WMHICD
     I              BZRBCD                          WMRBCD
     I              BZFZST                          WMFZST
     I              BZAVST                          WMAVST
     I              BZCZWG                          WMCZWG
     I              BZC0WG                          WMC0WG
     I              BZURTN                          WMURTN
     I              BZAJC8                          WMAJC8
     I              BZRINB                          WMRINB
     I              BZRHNB                          WMRHNB
     I              BZRGNB                          WMRGNB
     I              BZLNCD                          WMLNCD
     I              BZTFNB                          WMTFNB
     I              BZN0CD                          WMN0CD
     I              BZX4ST                          WMX4ST
     I              BZTMVA                          WMTMVA
     I              BZTNVA                          WMTNVA
     I              BZBLPR                          WMBLPR
     I              BZBMPR                          WMBMPR
     I              BZLRCD                          WMLRCD
     I              BZU9ST                          WMU9ST
     I              BZCMCO                          WMCMCO
     I              BZQ1CD                          WMQ1CD
     I              BZQ8CD                          WMQ8CD
     I              BZCHTM                          WMCHTM
     I              BZQZCD                          WMQZCD
     I              BZXWST                          WMXWST
     I              BZXXST                          WMXXST
     I              BZVMST                          WMVMST
     I              BZSWGH                          WMSWGH
     I              BZPPHE                          WMPPHE
     I              BZR3CD                          WMR3CD
     I              BZSDCD                          WMSDCD
     I              BZICN1                          WMICN1
     I              BZSVCD                          WMSVCD
     I              BZICN2                          WMICN2
     I              BZSWCD                          WMSWCD
     I              BZV2NB                          WMV2NB
     I              BZSXCD                          WMSXCD
     I              BZITCN                          WMITCN
     I              BZSYCD                          WMSYCD
     I              BZITC5                          WMITC5
     I              BZSZCD                          WMSZCD
     I              BZICN6                          WMICN6
     I              BZS0CD                          WMS0CD
     I              BZICN7                          WMICN7
     I              BZS1CD                          WMS1CD
     I              BZICN8                          WMICN8
     I              BZS2CD                          WMS2CD
     I              BZICN9                          WMICN9
     I              BZS3CD                          WMS3CD
     I              BZICN0                          WMICN0
     I              BZS4CD                          WMS4CD
     I              BZSFNB                          WMSFNB
     I              BZA3WG                          WMA3WG
     I              BZSJNB                          WMSJNB
     I              BZLLCD                          WMLLCD
     I              BZLMCD                          WMLMCD
     I              BZP3ST                          WMP3ST
     I              BZSKNB                          WMSKNB
     I              BZSLNB                          WMSLNB
     I              BZSMNB                          WMSMNB
     I              BZP4ST                          WMP4ST
     I              BZCFNB                          WMCFNB
     I              BZCGNB                          WMCGNB
     I              BZILNB                          WMILNB
     I              BZCHNB                          WMCHNB
     I              BZCINB                          WMCINB
     I              BZCJNB                          WMCJNB
     I              BZCMNB                          WMCMNB
     I              BZCNNB                          WMCNNB
     I              BZCRNB                          WMCRNB
     I              BZCSNB                          WMCSNB
     I              BZCVNB                          WMCVNB
     I              BZCWNB                          WMCWNB
     I              BZCXNB                          WMCXNB
     I              BZCZNB                          WMCZNB
     I              BZC0NB                          WMC0NB
     I              BZN1CD                          WMN1CD
     I              BZB4NB                          WMB4NB
     I              BZB5NB                          WMB5NB
     I              BZX5ST                          WMX5ST
     I              BZX6ST                          WMX6ST
     I              BZX7ST                          WMX7ST
     I              BZPCCT                          WMPCCT
     I              BZBDNB                          WMBDNB
     I              BZBJNB                          WMBJNB
     I              BZSUST                          WMSUST
     I              BZSVST                          WMSVST
     I              BZSYST                          WMSYST
     I              BZSZST                          WMSZST
     I              BZS1ST                          WMS1ST
     I              BZXRCD                          WMXRCD
     I              BZXTCD                          WMXTCD
     I              BZXUCD                          WMXUCD
     I              BZF5WG                          WMF5WG
     I              BZF6WG                          WMF6WG
     I              BZF7WG                          WMF7WG
     I              BZBLNB                          WMBLNB
     I              BZBNNB                          WMBNNB
     I              BZS2ST                          WMS2ST
     I              BZS4ST                          WMS4ST
     I              BZS5ST                          WMS5ST
     I              BZS6ST                          WMS6ST
     I              BZS8ST                          WMS8ST
     I              BZS9ST                          WMS9ST
     I              BZTCST                          WMTCST
     I              BZTDST                          WMTDST
     I              BZUVST                          WMUVST
     I              BZUWST                          WMUWST
     I              BZUXST                          WMUXST
     I              BZVSST                          WMVSST
     I              BZAATM                          WMAATM
     I              BZAYNA                          WMAYNA
     I              BZA0NA                          WMA0NA
     I              BZAXDT                          WMAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WOAJCD
     I              ADF8NA                          WOF8NA
     I              ADACNA                          WOACNA
     I              ADADNA                          WOADNA
     I              ADAENA                          WOAENA
     I              ADAJNA                          WOAJNA
     I              ADBTTX                          WOBTTX
     I              ADAOCD                          WOAOCD
     I              ADBGCD                          WOBGCD
     I              ADVHST                          WOVHST
     I              ADMPNA                          WOMPNA
     I              ADWPST                          WOWPST
     I              ADXUST                          WOXUST
     I              ADT0ST                          WOT0ST
     I              ADT1ST                          WOT1ST
     I              ADDBNB                          WODBNB
     I              ADT2ST                          WOT2ST
     I              ADT3ST                          WOT3ST
     I              ADT4ST                          WOT4ST
     I              ADT6ST                          WOT6ST
     I              ADBWC3                          WOBWC3
     I              ADBTC3                          WOBTC3
     I              ADBUC3                          WOBUC3
     I              ADBVC3                          WOBVC3
     I              ADFCAA                          WOFCAA
     I              ADRQSX                          WORQSX
     I              ADRRSX                          WORRSX
     I              ADRSSX                          WORSSX
     I              ADRTSX                          WORTSX
     I              ADT7ST                          WOT7ST
     I              ADT8ST                          WOT8ST
     I              ADRNSX                          WORNSX
     I              ADROSX                          WOROSX
     I              ADRPSX                          WORPSX
     I              ADUVST                          WOUVST
     I              ADUWST                          WOUWST
     I              ADUXST                          WOUXST
     I              ADVSST                          WOVSST
     I              ADAATM                          WOAATM
     I              ADAYNA                          WOAYNA
     I              ADA0NA                          WOA0NA
     I              ADAXDT                          WOAXDT
      *
     I@ADRET1
      * Warehouse                 Active records only
      * Renamed input format fields
     I              ADAJCD                          WRAJCD
     I              ADF8NA                          WRF8NA
     I              ADACNA                          WRACNA
     I              ADADNA                          WRADNA
     I              ADAENA                          WRAENA
     I              ADAJNA                          WRAJNA
     I              ADBTTX                          WRBTTX
     I              ADAOCD                          WRAOCD
     I              ADBGCD                          WRBGCD
     I              ADVHST                          WRVHST
     I              ADMPNA                          WRMPNA
     I              ADWPST                          WRWPST
     I              ADXUST                          WRXUST
     I              ADT0ST                          WRT0ST
     I              ADT1ST                          WRT1ST
     I              ADDBNB                          WRDBNB
     I              ADT2ST                          WRT2ST
     I              ADT3ST                          WRT3ST
     I              ADT4ST                          WRT4ST
     I              ADT6ST                          WRT6ST
     I              ADBWC3                          WRBWC3
     I              ADBTC3                          WRBTC3
     I              ADBUC3                          WRBUC3
     I              ADBVC3                          WRBVC3
     I              ADFCAA                          WRFCAA
     I              ADRQSX                          WRRQSX
     I              ADRRSX                          WRRRSX
     I              ADRSSX                          WRRSSX
     I              ADRTSX                          WRRTSX
     I              ADT7ST                          WRT7ST
     I              ADT8ST                          WRT8ST
     I              ADRNSX                          WRRNSX
     I              ADROSX                          WRROSX
     I              ADRPSX                          WRRPSX
     I              ADUVST                          WRUVST
     I              ADUWST                          WRUWST
     I              ADUXST                          WRUXST
     I              ADVSST                          WRVSST
     I              ADAATM                          WRAATM
     I              ADAYNA                          WRAYNA
     I              ADA0NA                          WRA0NA
     I              ADAXDT                          WRAXDT
      *
     I@B6CPAG
      * Order Detail Sched-Consmd Co/Ord/PrdDt/Cns/Itm/Seq
      * Renamed input format fields
     I              B6AIC3                          WSAIC3
     I              B6C4NB                          WSC4NB
     I              B6DPNB                          WSDPNB
     I              B6UENB                          WSUENB
     I              B6JGDT                          WSJGDT
     I              B6OONY                          WSOONY
     I              B6AODT                          WSAODT
     I              B6AJCD                          WSAJCD
     I              B6NUDT                          WSNUDT
     I              B6HGCD                          WSHGCD
     I              B6IGQT                          WSIGQT
     I              B6FLWG                          WSFLWG
     I              B6NSQT                          WSNSQT
     I              B6JQWG                          WSJQWG
     I              B6NVDT                          WSNVDT
     I              B6BUTM                          WSBUTM
     I              B6UVST                          WSUVST
     I              B6UWST                          WSUWST
     I              B6UXST                          WSUXST
     I              B6VSST                          WSVSST
     I              B6AATM                          WSAATM
     I              B6AYNA                          WSAYNA
     I              B6A0NA                          WSA0NA
     I              B6AXDT                          WSAXDT
      *
     I@B6CPNB
      * Order Detail Sched-Consmd Retrieval index
      * Renamed input format fields
     I              B6AIC3                          WTAIC3
     I              B6C4NB                          WTC4NB
     I              B6DPNB                          WTDPNB
     I              B6UENB                          WTUENB
     I              B6JGDT                          WTJGDT
     I              B6OONY                          WTOONY
     I              B6AODT                          WTAODT
     I              B6AJCD                          WTAJCD
     I              B6NUDT                          WTNUDT
     I              B6HGCD                          WTHGCD
     I              B6IGQT                          WTIGQT
     I              B6FLWG                          WTFLWG
     I              B6NSQT                          WTNSQT
     I              B6JQWG                          WTJQWG
     I              B6NVDT                          WTNVDT
     I              B6BUTM                          WTBUTM
     I              B6UVST                          WTUVST
     I              B6UWST                          WTUWST
     I              B6UXST                          WTUXST
     I              B6VSST                          WTVSST
     I              B6AATM                          WTAATM
     I              B6AYNA                          WTAYNA
     I              B6A0NA                          WTA0NA
     I              B6AXDT                          WTAXDT
      *
     I@B6CPNA
      * Order Detail Sched-Consmd Update index
      * Renamed input format fields
     I              B6AIC3                          WVAIC3
     I              B6C4NB                          WVC4NB
     I              B6DPNB                          WVDPNB
     I              B6UENB                          WVUENB
     I              B6JGDT                          WVJGDT
     I              B6OONY                          WVOONY
     I              B6AODT                          WVAODT
     I              B6AJCD                          WVAJCD
     I              B6NUDT                          WVNUDT
     I              B6HGCD                          WVHGCD
     I              B6IGQT                          WVIGQT
     I              B6FLWG                          WVFLWG
     I              B6NSQT                          WVNSQT
     I              B6JQWG                          WVJQWG
     I              B6NVDT                          WVNVDT
     I              B6BUTM                          WVBUTM
     I              B6UVST                          WVUVST
     I              B6UWST                          WVUWST
     I              B6UXST                          WVUXST
     I              B6VSST                          WVVSST
     I              B6AATM                          WVAATM
     I              B6AYNA                          WVAYNA
     I              B6A0NA                          WVA0NA
     I              B6AXDT                          WVAXDT
      *
     I@AFREPU
      * Calendar                  RSQ Co/Date Descending
      * Renamed input format fields
     I              AFAIC3                          WWAIC3
     I              AFBCDT                          WWBCDT
     I              AFCQNB                          WWCQNB
     I              AFESNB                          WWESNB
     I              AFETNB                          WWETNB
     I              AFBZNB                          WWBZNB
     I              AFA9ST                          WWA9ST
     I              AFEINB                          WWEINB
     I              AFC5ST                          WWC5ST
     I              AFAQNB                          WWAQNB
     I              AFCMST                          WWCMST
     I              AFV9ST                          WWV9ST
     I              AFWAST                          WWWAST
     I              AFX2ST                          WWX2ST
     I              AFOJDT                          WWOJDT
     I              AFNQNX                          WWNQNX
     I              AFNRNX                          WWNRNX
     I              AFI9SX                          WWI9SX
     I              AFJASX                          WWJASX
     I              AFOKDT                          WWOKDT
     I              AFOLDT                          WWOLDT
     I              AFUVST                          WWUVST
     I              AFUWST                          WWUWST
     I              AFUXST                          WWUXST
     I              AFAATM                          WWAATM
     I              AFAYNA                          WWAYNA
     I              AFA0NA                          WWA0NA
     I              AFAXDT                          WWAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IQPDKN1    E DSPDKNCPL0
      * UPD : Order Detail Schedule     Update index
      * Renamed input format fields
     I              KNAIC3                          WKAIC3
     I              KNC4NB                          WKC4NB
     I              KNDPNB                          WKDPNB
     I              KNUENB                          WKUENB
     I              KNJGDT                          WKJGDT
     I              KNAODT                          WKAODT
     I              KNAJCD                          WKAJCD
     I              KNAYAA                          WKAYAA
     I              KNHGCD                          WKHGCD
     I              KNIGQT                          WKIGQT
     I              KNFLWG                          WKFLWG
     I              KNIUQT                          WKIUQT
     I              KNF3WG                          WKF3WG
     I              KNIVQT                          WKIVQT
     I              KNF4WG                          WKF4WG
     I              KNP7ST                          WKP7ST
     I              KNP8ST                          WKP8ST
     I              KNQAST                          WKQAST
     I              KNUVST                          WKUVST
     I              KNUWST                          WKUWST
     I              KNUXST                          WKUXST
     I              KNVSST                          WKVSST
     I              KNAATM                          WKAATM
     I              KNAYNA                          WKAYNA
     I              KNA0NA                          WKA0NA
     I              KNAXDT                          WKAXDT
      *
     IYARDCS      DS                            100
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPDI81    E DSPDI8CPL0
      * UPD : PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WLAIC3
     I              I8V5ST                          WLV5ST
     I              I8ELDT                          WLELDT
     I              I8HGCD                          WLHGCD
     I              I8AJCD                          WLAJCD
     I              I8GPDT                          WLGPDT
     I              I8WTSP                          WLWTSP
     I              I8QTSP                          WLQTSP
     I              I8DJPC                          WLDJPC
     I              I8F8WG                          WLF8WG
     I              I8WTIN                          WLWTIN
     I              I8D5NB                          WLD5NB
     I              I8DXWG                          WLDXWG
     I              I8B2NB                          WLB2NB
     I              I8WTCN                          WLWTCN
     I              I8PSCV                          WLPSCV
     I              I8SAWT                          WLSAWT
     I              I8B9NB                          WLB9NB
     I              I8D1WG                          WLD1WG
     I              I8CBNB                          WLCBNB
     I              I8EZWG                          WLEZWG
     I              I8CCNB                          WLCCNB
     I              I8E0WG                          WLE0WG
     I              I8D6NB                          WLD6NB
     I              I8OAWT                          WLOAWT
     I              I8CDNB                          WLCDNB
     I              I8UNW2                          WLUNW2
     I              I8CENB                          WLCENB
     I              I8F9WG                          WLF9WG
     I              I8BPNB                          WLBPNB
     I              I8GAWG                          WLGAWG
     I              I8BQNB                          WLBQNB
     I              I8GBWG                          WLGBWG
     I              I8BRNB                          WLBRNB
     I              I8GCWG                          WLGCWG
     I              I8BSNB                          WLBSNB
     I              I8GDWG                          WLGDWG
     I              I8BWNB                          WLBWNB
     I              I8GEWG                          WLGEWG
     I              I8PS6U                          WLPS6U
     I              I8WCST                          WLWCST
     I              I8WPST                          WLWPST
     I              I8B5ST                          WLB5ST
     I              I8TFST                          WLTFST
     I              I8TEST                          WLTEST
     I              I8THST                          WLTHST
     I              I8UDST                          WLUDST
     I              I8UFST                          WLUFST
     I              I8UGST                          WLUGST
     I              I8UHST                          WLUHST
     I              I8B6ST                          WLB6ST
     I              I8B7ST                          WLB7ST
     I              I8DVWG                          WLDVWG
     I              I8D7NB                          WLD7NB
     I              I8FCAD                          WLFCAD
     I              I8D9NB                          WLD9NB
     I              I8DWWG                          WLDWWG
     I              I8EANB                          WLEANB
     I              I8SHWT                          WLSHWT
     I              I8EBNB                          WLEBNB
     I              I8AVWT                          WLAVWT
     I              I8ECNB                          WLECNB
     I              I8WTON                          WLWTON
     I              I8EDNB                          WLEDNB
     I              I8FNWT                          WLFNWT
     I              I8EENB                          WLEENB
     I              I8QTAS                          WLQTAS
     I              I8EFNB                          WLEFNB
     I              I8WAIO                          WLWAIO
     I              I8EGNB                          WLEGNB
     I              I8R3CD                          WLR3CD
     I              I8RGNB                          WLRGNB
     I              I8RHNB                          WLRHNB
     I              I8RINB                          WLRINB
     I              I8XRCD                          WLXRCD
     I              I8UVST                          WLUVST
     I              I8UWST                          WLUWST
     I              I8UXST                          WLUXST
     I              I8VSST                          WLVSST
     I              I8AATM                          WLAATM
     I              I8AYNA                          WLAYNA
     I              I8A0NA                          WLA0NA
     I              I8AXDT                          WLAXDT
      *
     IYBRDCS      DS                            326
     IYCRDCS      DS                            326
     IQPOB61    E DSPOB6CPL0
      * UPD : Order Detail Sched-Consmd Update index
      * Renamed input format fields
     I              B6AIC3                          WVAIC3
     I              B6C4NB                          WVC4NB
     I              B6DPNB                          WVDPNB
     I              B6UENB                          WVUENB
     I              B6JGDT                          WVJGDT
     I              B6OONY                          WVOONY
     I              B6AODT                          WVAODT
     I              B6AJCD                          WVAJCD
     I              B6NUDT                          WVNUDT
     I              B6HGCD                          WVHGCD
     I              B6IGQT                          WVIGQT
     I              B6FLWG                          WVFLWG
     I              B6NSQT                          WVNSQT
     I              B6JQWG                          WVJQWG
     I              B6NVDT                          WVNVDT
     I              B6BUTM                          WVBUTM
     I              B6UVST                          WVUVST
     I              B6UWST                          WVUWST
     I              B6UXST                          WVUXST
     I              B6VSST                          WVVSST
     I              B6AATM                          WVAATM
     I              B6AYNA                          WVAYNA
     I              B6A0NA                          WVA0NA
     I              B6AXDT                          WVAXDT
      *
     IYDRDCS      DS                             91
     IYERDCS      DS                            326
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * I :  Warehouse Code
     I                                        1   3 P1AJCD
      * I :  Company Number
     I                                    P   4   50P1AIC3
      * I :  Item Code
     I                                    P   6   90P1HGCD
      * B :  Production Date
     I                                    P  10  130P1ELDT
      * N :  Production Type
     I                                       14  14 P1V5ST
      * I :  U/M - Primary
     I                                       15  16 P1ADCD
      * I :  Unit Weight
     I                                    P  17  222P1AIWG
      * I :  Fresh Chilling Time
     I                                    P  23  252P1CHTM
      * I :  Piece Count Item
     I                                       26  26 P1PCCT
      * I :  Pieces Per Bag
     I                                    P  27  300P1BDNB
      * I :  Bags Per Unit
     I                                    P  31  340P1BJNB
      * I :  Warehouse Type
     I                                       35  36 P1WPST
      * I :  Warehouse Std Chill Time
     I                                       37  37 P1T1ST
      * I :  Warehouse Chill Time
     I                                    P  38  402P1DBNB
      * I :  Order Number
     I                                    P  41  440P1C4NB
      * I :  Order Sequence Number
     I                                    P  45  460P1DPNB
      * I :  Order Secondary Line Seq
     I                                    P  47  480P1UENB
      * I :  Production Date RGF
     I                                    P  49  520P1GVDT
      * I :  Production Date RGT
     I                                    P  53  560P1GWDT
      * I :  Quantity Ordered
     I                                    P  57  622P1AVQT
      * I :  Weight Ordered
     I                                    P  63  682P1D0WG
      * B :  Quantity Scheduled
     I                                    P  69  742P1CCQT
      * B :  Weight Scheduled
     I                                    P  75  802P1AUWG
      * B :  ATS Quantity Need USR
     I                                    P  81  862P1HWQT
      * B :  ATS Weight Need USR
     I                                    P  87  922P1ENWG
      * N :  ATS Quantity Avail USR
     I                                    P  93  980P1HXQT
      * N :  ATS Weight Available USR
     I                                    P  99 1042P1EOWG
      * N :  ATS Pieces Available USR
     I                                    P 105 1080P1EWNB
      * N :  Quantity Allocated USR
     I                                    P 109 1142P1IHQT
      * N :  Weight Allocated USR
     I                                    P 115 1192P1E1WG
      * I :  Ship Date USR
     I                                    P 120 1230P1HLDT
      * I :  ATS Adj Type USR 2
     I                                      124 125 P1QJST
      * I :  PSAA Program Name
     I                                      126 135 P1BXVN
     IP2PARM      DS
      * N :  Pieces Allocated USR
     I                                    P   1   40P2PCAL
     IP3PARM      DS
      * N :  Chilling Time USR
     I                                    P   1   32P3CHMT
     IP4PARM      DS
      * N :  PS Avg Piece Wgt
     I                                    P   1   52P4F8WG
     IP5PARM      DS
      * FLD: Item Bill Of Material
      * N :  Production Yield
     I                                    P   1   32P5BPPR
     IP6PARM      DS
      * FLD: *Arrays
      * N :  SM Pieces Need USR
     I                                    P   1   40P6EJNB
      * N :  SM Weight Need USR
     I                                    P   5  102P6GTWG
     IP7PARM      DS
      * FLD: Company Item
      * I :  Base/Conv/Loss Item
     I                                        1   2 P7QZCD
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AJCD    PARM           WP0001  3        Warehouse Code
     C           P1AIC3    PARM           WP0002  30       Company Number
     C           P1HGCD    PARM           WP0003  70       Item Code
     C           P1ELDT    PARM P1ELDT    WP0004  70       Production Date
     C           P1ADCD    PARM           WP0005  2        U/M - Primary
     C           P1AIWG    PARM           WP0006 112       Unit Weight
     C           P1CHTM    PARM           WP0007  52       Fresh Chilling
     C           P1PCCT    PARM           WP0008  1        Piece Count Ite
     C           P1BDNB    PARM           WP0009  70       Pieces Per Bag
     C           P1BJNB    PARM           WP0010  70       Bags Per Unit
     C           P1WPST    PARM           WP0011  2        Warehouse Type
     C           P1T1ST    PARM           WP0012  1        Warehouse Std C
     C           P1DBNB    PARM           WP0013  52       Warehouse Chill
     C           P1C4NB    PARM           WP0014  70       Order Number
     C           P1DPNB    PARM           WP0015  30       Order Sequence
     C           P1UENB    PARM           WP0016  30       Order Secondary
     C           P1GVDT    PARM           WP0017  70       Production Date
     C           P1GWDT    PARM           WP0018  70       Production Date
     C           P1AVQT    PARM           WP0019 112       Quantity Ordere
     C           P1D0WG    PARM           WP0020 112       Weight Ordered
     C           P1CCQT    PARM P1CCQT    WP0021 112       Quantity Schedu
     C           P1AUWG    PARM P1AUWG    WP0022 112       Weight Schedule
     C           P1HWQT    PARM P1HWQT    WP0023 112       ATS Quantity Ne
     C           P1ENWG    PARM P1ENWG    WP0024 112       ATS Weight Need
     C           P1HLDT    PARM           WP0025  70       Ship Date USR
     C           P1QJST    PARM           WP0026  2        ATS Adj Type US
     C           P1BXVN    PARM           WP0027 10        PSAA Program Na
     C           P7QZCD    PARM           WP0028  2        Base/Conv/Loss
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * UPD Allocate Prd      XF
      * FP1054 added FROZEN CASE stmt to alloc production backwards
      *
     C                     MOVEL*BLANK    WN0001  1        Production Type
     C                     Z-ADD*ZERO     WN0002 110       ATS Quantity Av
     C                     Z-ADD*ZERO     WN0003 112       ATS Weight Avai
     C                     Z-ADD*ZERO     WN0004  70       ATS Pieces Avai
     C                     Z-ADD*ZERO     WN0005 112       Quantity Alloca
     C                     Z-ADD*ZERO     WN0006  92       Weight Allocate
     C                     Z-ADD*ZERO     WN0007  70       Pieces Allocate
     C                     Z-ADD*ZERO     WN0008  52       Chilling Time U
     C                     Z-ADD*ZERO     WN0009  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0010  52       Production Yiel
     C                     Z-ADD*ZERO     WN0011  70       SM Pieces Need
     C                     Z-ADD*ZERO     WN0012 112       SM Weight Need
      *
      * UPD Allocate Prd      IF
      * documentation
     C                     EXSR UASUBR                     documentation
      * CASE: PAR.PSAA Program Name is Sched as ordered-Override
     C           P1BXVN    IFEQ @CN,001                    *IF
      * IF called from sched override routine, dont get block order flag
     C                     MOVEL*BLANK    YL0001           Block Order Fla
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Block Order Flag  RT - Order Header TRG  * 
     C                     EXSR SARVGN
     C                     END                             *FI
      * FRESH - Alloc Forward / Backward per Item Allocation Method
      * CASE: PAR.Warehouse Type is Fresh
     C           P1WPST    IFEQ 'FR'                       *IF
      * Rtv CIE Alloc Method  RT - Company Item Ext  * 
     C                     EXSR SBRVGN
      * Chilling Time
      * CASE: PAR.Warehouse Std Chill Time is yes
     C           P1T1ST    IFEQ 'Y'                        *IF
     C                     Z-ADDP1DBNB    WN0008           Chilling Time U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP1CHTM    WN0008           Chilling Time U
     C                     END                             *FI
     C                     Z-ADDP1GWDT    YL0005           Production Date
      * DOC:  Allocation
     C                     EXSR UBSUBR                     DOC:  Allocatio
      * CASE: Allocation Method is Forward - ASAP
      * CASE: LCL.Allocation Method is Forward - ASAP
     C           YL0002    IFEQ 'F'                        *IF
      * Starting Production Date
      * CASE: PAR.Production Date RGF LT JOB.*Job date
     C           P1GVDT    IFLT ##JDT                      *IF
     C                     Z-ADD##JDT     P1ELDT           Production Date
      * CASE: PAR.Production Date RGT LT JOB.*Job date
     C           P1GWDT    IFLT ##JDT                      *IF
     C                     Z-ADDP1GWDT    YL0005           Production Date
     C                     END                             *FI
      * CASE: LCL.Block Order Flag is Block Order
     C           YL0001    IFEQ 'B'                        *IF
      * PAR.Production Date = PAR.Production Date + CON.1 *DAYS
     C           P1ELDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P1ELDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P1ELDT
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP1GVDT    P1ELDT           Production Date
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           P1ELDT    IFEQ ##JDT                      *IF
      * CASE: LCL.Block Order Flag is Block Order
     C           YL0001    IFEQ 'B'                        *IF
      * PAR.Production Date = PAR.Production Date + CON.1 *DAYS
     C           P1ELDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P1ELDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P1ELDT
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ITR:  Allocate Availability based on AGE CODE.
      * DO WHILE: Prd Dte <= Prd Dte RGT & Need > 0
      *  - c1 AND c3
      *   |- c1    : PAR.Production Date LE LCL.Production Date To
      *   |- c3    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     DO   *HIVAL                     *DOW
     C                     MOVEL'0'       Y0CX01  1
     C           P1ELDT    IFLE YL0005                     *IF
     C           P1HWQT    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
     C                     LEAVE
     C                     END                             *FI
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0001           Company Number
     C                     Z-ADDP1ELDT    WL0002           Post to G/L Dat
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0006    P      Production Day
      * FP1054 Check day for a production day per company item ext file
      * Rtv CIE Prod Day Sts  RT - Company Item Ext  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0004           Company Number
     C                     Z-ADDP1HGCD    WL0005           Item Code
     C                     Z-ADDP1ELDT    WL0006           Production Date
     C                     MOVELYL0007    WL0007    P      Production Day
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    YL0007    P      Production Day
      * Allocate Production
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Production Day Status is yes
      *   |- c2    : LCL.Production Day Status USR is not no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0006    IFEQ 'Y'                        *IF
     C           YL0007    IFEQ *BLANK                     *IF
     C           YL0007    OREQ 'Y'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Determine Production Type
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           P1ELDT    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0001           Production Type
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0008           Company Number
     C                     MOVELWN0001    WL0009    P      Production Type
     C                     Z-ADDP1ELDT    WL0010           Production Date
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0011    WUWXST    P      Record Found US
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0001           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Production Date GT JOB.*Job date
     C           P1ELDT    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0001           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Use input Warehouse and co
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0012           Company Number
     C                     MOVELWN0001    WL0013    P      Production Type
     C                     Z-ADDP1ELDT    WL0014           Production Date
     C                     Z-ADDP1HGCD    WL0015           Item Code
     C                     MOVELP1AJCD    WL0016    P      Warehouse Code
     C                     Z-ADDWN0003    WL0018           ATS Weight Avai
     C                     Z-ADDWN0004    WL0019           ATS Pieces Avai
     C                     Z-ADDWN0008    WL0020           Chilling Time U
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0017    WN0009           PS Avg Piece Wg
     C                     Z-ADDWL0018    WN0003           ATS Weight Avai
     C                     Z-ADDWL0019    WN0004           ATS Pieces Avai
      * Quantity Available
      * CASE: Piece Count = Y
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1PCCT    IFEQ 'Y'                        *IF
     C           P1BDNB    IFGT 0                          *IF
     C           P1BJNB    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : PAR.ATS Pieces Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : PAR.Bags Per Unit
     C           P1BDNB    MULT P1BJNB    W0WJ01           *Synon (15,0) w
     C           WN0004    DIV  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0002           ATS Quantity Av
     C                     ELSE
      * CASE: Piece Count = N
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1PCCT    IFEQ *BLANK                     *IF
     C           P1PCCT    OREQ 'N'
     C           P1AIWG    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.ATS Weight Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Unit Weight
     C           WN0003    DIV  P1AIWG    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0002           ATS Quantity Av
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD0         WN0002           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * Schedule As Ordered
      * CASE: PAR.ATS Adj Type USR 2 is Sched/Alloc As Ordered
     C           P1QJST    IFEQ 'AO'                       *IF
      * CASE: PAR.ATS Quantity Avail USR LT PAR.ATS Quantity Need USR
     C           WN0002    IFLT P1HWQT                     *IF
     C                     Z-ADDP1HWQT    WN0002           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * If production avail allocate
      * CASE: PAR.ATS Quantity Avail USR is GT Zero
     C           WN0002    IFGT 0                          *IF
      * Allocate Available Quantity
      * CASE: PAR.ATS Quantity Need USR GT PAR.ATS Quantity Avail USR
     C           P1HWQT    IFGT WN0002                     *IF
     C                     ADD  WN0002    P1CCQT           Quantity Schedu
     C           WN0002    MULT P1AIWG    WN0003           ATS Weight Avai
     C                     ADD  WN0003    P1AUWG           Weight Schedule
     C                     Z-ADDWN0003    WN0006           Weight Allocate
     C                     Z-ADDWN0002    WN0005           Quantity Alloca
     C                     ELSE
      * CASE: PAR.ATS Quantity Need USR LE PAR.ATS Quantity Avail USR
     C           P1HWQT    IFLE WN0002                     *IF
     C                     ADD  P1HWQT    P1CCQT           Quantity Schedu
     C           P1HWQT    MULT P1AIWG    P1ENWG           ATS Weight Need
     C                     ADD  P1ENWG    P1AUWG           Weight Schedule
     C                     Z-ADDP1ENWG    WN0006           Weight Allocate
     C                     Z-ADDP1HWQT    WN0005           Quantity Alloca
     C                     END                             *FI
     C                     END                             *FI
      * If quantity allocated is GT zero
      * CASE: PAR.Quantity Allocated USR is GT Zero
     C           WN0005    IFGT 0                          *IF
      * 8/05/11  RMC  MOVED UP HERE FROM BELOW ORDER DTL SCHED UPDATE
      * CASE: PAR.Piece Count Item is yes
     C           P1PCCT    IFEQ 'Y'                        *IF
      * Pieces Allocated
      * PAR.Pieces Allocated USR =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : PAR.Quantity Allocated USR
      * *     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
     C           WN0005    MULT P1BDNB    W0WJ01           *Synon (15,0) w
     C           W0WJ01    MULT P1BJNB    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0007           Pieces Allocate
      * Weight Allocated
      * PAR.Weight Allocated USR =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Pieces Allocated USR
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Avg Piece Wgt
     C           WN0007    MULT WN0009    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0006           Weight Allocate
     C                     END                             *FI
      * CASE: PAR.Warehouse Code EQ PAR.Warehouse Code PASS   USR
     C           P1AJCD    IFEQ P1AJCD                     *IF
      * Upd Ord Detail Sched  RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0021           Company Number
     C                     Z-ADDP1C4NB    WL0022           Order Number
     C                     Z-ADDP1DPNB    WL0023           Order Sequence
     C                     Z-ADDP1UENB    WL0024           Order Secondary
     C                     Z-ADDP1ELDT    WL0025           OD Production D
     C                     Z-ADDP1HLDT    WL0026           Scheduled Ship
     C                     MOVELP1AJCD    WL0027    P      Warehouse Code
     C                     MOVELP1AJCD    WL0028    P      Order From Ware
     C                     Z-ADDP1HGCD    WL0029           Item Code
     C                     Z-ADDWN0006    WL0030           Weight Allocate
     C                     Z-ADDWN0005    WL0031           Quantity Alloca
     C                     MOVELP7QZCD    WL0032    P      Base/Conv/Loss
     C                     EXSR SKRVGN
     C                     END                             *FI
      * FP1054  ADD sched  TO PAR.WAREHOUSE CODE PASS USR's standard prod
      * CASE: PAR.Warehouse Code NE PAR.Warehouse Code PASS   USR
     C           P1AJCD    IFNE P1AJCD                     *IF
      * CASE: PAR.Base/Conv/Loss Item is Base
     C           P7QZCD    IFEQ 'B'                        *IF
      * FP1054 Upd production by input Warehouse, Co AND order dtl sched-
      * Upd Prod Whse Txfr    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0033           Company Number
     C                     MOVELWN0001    WL0034    P      Production Type
     C                     Z-ADDP1ELDT    WL0035           Production Date
     C                     Z-ADDP1HGCD    WL0036           Item Code
     C                     MOVELP1AJCD    WL0037    P      Warehouse Code
     C                     Z-ADDWN0006    WL0038           Weight Allocate
     C                     Z-ADDWN0007    WL0039           Pieces Allocate
     C                     Z-ADDP1C4NB    WL0040           Order Number
     C                     Z-ADDP1DPNB    WL0041           Order Sequence
     C                     Z-ADDP1UENB    WL0042           Order Secondary
     C                     MOVEL'N'       WL0043    P      Status Flag 19
     C                     EXSR SORVGN
      * use order's warehouse and company
      * BPS Upd Pcs/Wgt Std   RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0131           Company Number
     C                     MOVELWN0001    WL0132    P      Production Type
     C                     Z-ADDP1ELDT    WL0133           Production Date
     C                     Z-ADDP1HGCD    WL0134           Item Code
     C                     MOVELP1AJCD    WL0135    P      Warehouse Code
     C                     Z-ADDWN0007    WL0136           Pieces Schedule
     C                     Z-ADDWN0006    WL0137           Weight Schedule
     C                     EXSR SVRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * FP1054 Upd production by input Warehouse, Co AND order dtl sched-
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0138           Company Number
     C                     MOVELWN0001    WL0139    P      Production Type
     C                     Z-ADDP1ELDT    WL0140           Production Date
     C                     Z-ADDP1HGCD    WL0141           Item Code
     C                     MOVELP1AJCD    WL0142    P      Warehouse Code
     C                     Z-ADDWN0006    WL0143           Weight Allocate
     C                     Z-ADDWN0007    WL0144           Pieces Allocate
     C                     Z-ADDP1C4NB    WL0145           Order Number
     C                     Z-ADDP1DPNB    WL0146           Order Sequence
     C                     Z-ADDP1UENB    WL0147           Order Secondary
     C                     MOVEL'N'       WL0148    P      Status Flag 19
     C                     EXSR SXRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD0         WN0005           Quantity Alloca
     C                     Z-ADD0         WN0006           Weight Allocate
     C                     Z-ADD0         P1CCQT           Quantity Schedu
     C                     Z-ADD0         P1AUWG           Weight Schedule
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  0         P1CCQT           Quantity Schedu
     C                     ADD  0         P1AUWG           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * CLC Inc/Dec Date       IF
      * CASE: PAR.*Duration (factor) is LT Zero
     C           1         IFLT 0                          *IF
     C           1         MULT -1        WUDUF            *Duration (fact
      * Clc Date (descending) RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0181           Company Number
     C                     Z-ADDP1ELDT    WL0182           Post to G/L Dat
     C                     Z-ADDP1ELDT    WL0184           *Date2 (beginni
     C                     Z-ADDWUDUF     WL0185           *Duration (fact
     C                     EXSR TGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0183    P1ELDT           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is GT Zero
     C           1         IFGT 0                          *IF
      * Clc Date (ascending)  RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0186           Company Number
     C                     Z-ADDP1ELDT    WL0187           Post to G/L Dat
     C                     Z-ADDP1ELDT    WL0189           *Date2 (beginni
     C                     Z-ADD1         WL0190           *Duration (fact
     C                     EXSR THRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0188    P1ELDT           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is EQ Zero
     C           1         IFEQ 0                          *IF
     C                     Z-ADDP1ELDT    P1ELDT           *Date1 (ending)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           P1AVQT    SUB  P1CCQT    P1HWQT           ATS Quantity Ne
     C           P1D0WG    SUB  P1AUWG    P1ENWG           ATS Weight Need
     C                     END                             *ITR
     C                     END                             *FI
      * CASE: Allocation Method is Backwards - JIT
      * CASE: LCL.Allocation Method is Backwards - JIT
     C           YL0002    IFEQ 'B'                        *IF
      * For backwards start with the TO date, then -1 day until FROM date
     C                     Z-ADDP1GVDT    YL0015           Production Date
     C                     Z-ADDP1GWDT    P1ELDT           Production Date
      * Starting Production Date
      * CASE: PAR.Production Date RGF LT JOB.*Job date
     C           P1GVDT    IFLT ##JDT                      *IF
     C                     Z-ADD##JDT     YL0015           Production Date
      * CASE: PAR.Production Date RGT LT JOB.*Job date
     C           P1GWDT    IFLT ##JDT                      *IF
     C                     Z-ADDP1GWDT    YL0005           Production Date
     C                     END                             *FI
      * CASE: LCL.Block Order Flag is Block Order
     C           YL0001    IFEQ 'B'                        *IF
      * LCL.Production Date RGF = LCL.Production Date RGF + CON.1 *DAYS
     C           YL0015    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0015
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0015
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP1GWDT    P1ELDT           Production Date
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           P1ELDT    IFEQ ##JDT                      *IF
      * CASE: LCL.Block Order Flag is Block Order
     C           YL0001    IFEQ 'B'                        *IF
      * PAR.Production Date = PAR.Production Date + CON.1 *DAYS
     C           P1ELDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P1ELDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P1ELDT
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ITR:  Allocate Availability based on AGE CODE.
      * DO WHILE: Prd Dte >= Prd Dte RGF & Need > 0
      *  - c1 AND c3
      *   |- c1    : PAR.Production Date GE LCL.Production Date RGF
      *   |- c3    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     DO   *HIVAL                     *DOW
     C                     MOVEL'0'       Y0CX01  1
     C           P1ELDT    IFGE YL0015                     *IF
     C           P1HWQT    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
     C                     LEAVE
     C                     END                             *FI
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0001           Company Number
     C                     Z-ADDP1ELDT    WL0002           Post to G/L Dat
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0006    P      Production Day
      * FP1054 Check day for a production day per company item ext file
      * Rtv CIE Prod Day Sts  RT - Company Item Ext  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0004           Company Number
     C                     Z-ADDP1HGCD    WL0005           Item Code
     C                     Z-ADDP1ELDT    WL0006           Production Date
     C                     MOVELYL0007    WL0007    P      Production Day
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    YL0007    P      Production Day
      * Allocate Production
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Production Day Status is yes
      *   |- c2    : LCL.Production Day Status USR is not no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0006    IFEQ 'Y'                        *IF
     C           YL0007    IFEQ *BLANK                     *IF
     C           YL0007    OREQ 'Y'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Determine Production Type
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           P1ELDT    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0001           Production Type
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0008           Company Number
     C                     MOVELWN0001    WL0009    P      Production Type
     C                     Z-ADDP1ELDT    WL0010           Production Date
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0011    WUWXST    P      Record Found US
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0001           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Production Date GT JOB.*Job date
     C           P1ELDT    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0001           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Use input Warehouse and co
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0012           Company Number
     C                     MOVELWN0001    WL0013    P      Production Type
     C                     Z-ADDP1ELDT    WL0014           Production Date
     C                     Z-ADDP1HGCD    WL0015           Item Code
     C                     MOVELP1AJCD    WL0016    P      Warehouse Code
     C                     Z-ADDWN0003    WL0018           ATS Weight Avai
     C                     Z-ADDWN0004    WL0019           ATS Pieces Avai
     C                     Z-ADDWN0008    WL0020           Chilling Time U
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0017    WN0009           PS Avg Piece Wg
     C                     Z-ADDWL0018    WN0003           ATS Weight Avai
     C                     Z-ADDWL0019    WN0004           ATS Pieces Avai
      * Quantity Available
      * CASE: Piece Count = Y
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1PCCT    IFEQ 'Y'                        *IF
     C           P1BDNB    IFGT 0                          *IF
     C           P1BJNB    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : PAR.ATS Pieces Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : PAR.Bags Per Unit
     C           P1BDNB    MULT P1BJNB    W0WJ01           *Synon (15,0) w
     C           WN0004    DIV  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0002           ATS Quantity Av
     C                     ELSE
      * CASE: Piece Count = N
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1PCCT    IFEQ *BLANK                     *IF
     C           P1PCCT    OREQ 'N'
     C           P1AIWG    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.ATS Weight Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Unit Weight
     C           WN0003    DIV  P1AIWG    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0002           ATS Quantity Av
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD0         WN0002           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * Schedule As Ordered
      * CASE: PAR.ATS Adj Type USR 2 is Sched/Alloc As Ordered
     C           P1QJST    IFEQ 'AO'                       *IF
      * CASE: PAR.ATS Quantity Avail USR LT PAR.ATS Quantity Need USR
     C           WN0002    IFLT P1HWQT                     *IF
     C                     Z-ADDP1HWQT    WN0002           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * If production avail allocate
      * CASE: PAR.ATS Quantity Avail USR is GT Zero
     C           WN0002    IFGT 0                          *IF
      * Allocate Available Quantity
      * CASE: PAR.ATS Quantity Need USR GT PAR.ATS Quantity Avail USR
     C           P1HWQT    IFGT WN0002                     *IF
     C                     ADD  WN0002    P1CCQT           Quantity Schedu
     C           WN0002    MULT P1AIWG    WN0003           ATS Weight Avai
     C                     ADD  WN0003    P1AUWG           Weight Schedule
     C                     Z-ADDWN0003    WN0006           Weight Allocate
     C                     Z-ADDWN0002    WN0005           Quantity Alloca
     C                     ELSE
      * CASE: PAR.ATS Quantity Need USR LE PAR.ATS Quantity Avail USR
     C           P1HWQT    IFLE WN0002                     *IF
     C                     ADD  P1HWQT    P1CCQT           Quantity Schedu
     C           P1HWQT    MULT P1AIWG    P1ENWG           ATS Weight Need
     C                     ADD  P1ENWG    P1AUWG           Weight Schedule
     C                     Z-ADDP1ENWG    WN0006           Weight Allocate
     C                     Z-ADDP1HWQT    WN0005           Quantity Alloca
     C                     END                             *FI
     C                     END                             *FI
      * If quantity allocated is GT zero
      * CASE: PAR.Quantity Allocated USR is GT Zero
     C           WN0005    IFGT 0                          *IF
      * 8/05/11  RMC  MOVED UP HERE FROM BELOW ORDER DTL SCHED UPDATE
      * CASE: PAR.Piece Count Item is yes
     C           P1PCCT    IFEQ 'Y'                        *IF
      * Pieces Allocated
      * PAR.Pieces Allocated USR =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : PAR.Quantity Allocated USR
      * *     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
     C           WN0005    MULT P1BDNB    W0WJ01           *Synon (15,0) w
     C           W0WJ01    MULT P1BJNB    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0007           Pieces Allocate
      * Weight Allocated
      * PAR.Weight Allocated USR =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Pieces Allocated USR
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Avg Piece Wgt
     C           WN0007    MULT WN0009    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0006           Weight Allocate
     C                     END                             *FI
      * CASE: PAR.Warehouse Code EQ PAR.Warehouse Code PASS   USR
     C           P1AJCD    IFEQ P1AJCD                     *IF
      * Upd Ord Detail Sched  RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0021           Company Number
     C                     Z-ADDP1C4NB    WL0022           Order Number
     C                     Z-ADDP1DPNB    WL0023           Order Sequence
     C                     Z-ADDP1UENB    WL0024           Order Secondary
     C                     Z-ADDP1ELDT    WL0025           OD Production D
     C                     Z-ADDP1HLDT    WL0026           Scheduled Ship
     C                     MOVELP1AJCD    WL0027    P      Warehouse Code
     C                     MOVELP1AJCD    WL0028    P      Order From Ware
     C                     Z-ADDP1HGCD    WL0029           Item Code
     C                     Z-ADDWN0006    WL0030           Weight Allocate
     C                     Z-ADDWN0005    WL0031           Quantity Alloca
     C                     MOVELP7QZCD    WL0032    P      Base/Conv/Loss
     C                     EXSR SKRVGN
     C                     END                             *FI
      * FP1054  ADD sched  TO PAR.WAREHOUSE CODE PASS USR's standard prod
      * CASE: PAR.Warehouse Code NE PAR.Warehouse Code PASS   USR
     C           P1AJCD    IFNE P1AJCD                     *IF
      * FP1054 Use input Warehouse and co
      * FOR BASE ONLY  6/02/09 maybe
      * CASE: PAR.Base/Conv/Loss Item is Base
     C           P7QZCD    IFEQ 'B'                        *IF
      * Upd Prod Whse Txfr    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0033           Company Number
     C                     MOVELWN0001    WL0034    P      Production Type
     C                     Z-ADDP1ELDT    WL0035           Production Date
     C                     Z-ADDP1HGCD    WL0036           Item Code
     C                     MOVELP1AJCD    WL0037    P      Warehouse Code
     C                     Z-ADDWN0006    WL0038           Weight Allocate
     C                     Z-ADDWN0007    WL0039           Pieces Allocate
     C                     Z-ADDP1C4NB    WL0040           Order Number
     C                     Z-ADDP1DPNB    WL0041           Order Sequence
     C                     Z-ADDP1UENB    WL0042           Order Secondary
     C                     MOVEL'N'       WL0043    P      Status Flag 19
     C                     EXSR SORVGN
      * use order's warehouse and company
      * BPS Upd Pcs/Wgt Std   RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0131           Company Number
     C                     MOVELWN0001    WL0132    P      Production Type
     C                     Z-ADDP1ELDT    WL0133           Production Date
     C                     Z-ADDP1HGCD    WL0134           Item Code
     C                     MOVELP1AJCD    WL0135    P      Warehouse Code
     C                     Z-ADDWN0007    WL0136           Pieces Schedule
     C                     Z-ADDWN0006    WL0137           Weight Schedule
     C                     EXSR SVRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * FP1054 Use input Warehouse and co
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0138           Company Number
     C                     MOVELWN0001    WL0139    P      Production Type
     C                     Z-ADDP1ELDT    WL0140           Production Date
     C                     Z-ADDP1HGCD    WL0141           Item Code
     C                     MOVELP1AJCD    WL0142    P      Warehouse Code
     C                     Z-ADDWN0006    WL0143           Weight Allocate
     C                     Z-ADDWN0007    WL0144           Pieces Allocate
     C                     Z-ADDP1C4NB    WL0145           Order Number
     C                     Z-ADDP1DPNB    WL0146           Order Sequence
     C                     Z-ADDP1UENB    WL0147           Order Secondary
     C                     MOVEL'N'       WL0148    P      Status Flag 19
     C                     EXSR SXRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD0         WN0005           Quantity Alloca
     C                     Z-ADD0         WN0006           Weight Allocate
     C                     Z-ADD0         P1CCQT           Quantity Schedu
     C                     Z-ADD0         P1AUWG           Weight Schedule
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  0         P1CCQT           Quantity Schedu
     C                     ADD  0         P1AUWG           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 -  subtract 1 day to go backwards
      * CLC Inc/Dec Date       IF
      * CASE: PAR.*Duration (factor) is LT Zero
     C           -1        IFLT 0                          *IF
     C           -1        MULT -1        WUDUF            *Duration (fact
      * Clc Date (descending) RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0181           Company Number
     C                     Z-ADDP1ELDT    WL0182           Post to G/L Dat
     C                     Z-ADDP1ELDT    WL0184           *Date2 (beginni
     C                     Z-ADDWUDUF     WL0185           *Duration (fact
     C                     EXSR TGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0183    P1ELDT           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is GT Zero
     C           -1        IFGT 0                          *IF
      * Clc Date (ascending)  RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0186           Company Number
     C                     Z-ADDP1ELDT    WL0187           Post to G/L Dat
     C                     Z-ADDP1ELDT    WL0189           *Date2 (beginni
     C                     Z-ADD-1        WL0190           *Duration (fact
     C                     EXSR THRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0188    P1ELDT           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is EQ Zero
     C           -1        IFEQ 0                          *IF
     C                     Z-ADDP1ELDT    P1ELDT           *Date1 (ending)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           P1AVQT    SUB  P1CCQT    P1HWQT           ATS Quantity Ne
     C           P1D0WG    SUB  P1AUWG    P1ENWG           ATS Weight Need
     C                     END                             *ITR
     C                     END                             *FI
     C           P1AVQT    SUB  P1CCQT    P1HWQT           ATS Quantity Ne
     C           P1D0WG    SUB  P1AUWG    P1ENWG           ATS Weight Need
     C                     END                             *FI
      * FROZEN - allocate backwards - new for FP1054
      * CASE: PAR.Warehouse Type is Frozen
     C           P1WPST    IFEQ 'FZ'                       *IF
     C                     MOVEL'B'       YL0016           Allocation Meth
      * Chilling Time
      * CASE: PAR.Warehouse Std Chill Time is yes
     C           P1T1ST    IFEQ 'Y'                        *IF
     C                     Z-ADDP1DBNB    WN0008           Chilling Time U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP1CHTM    WN0008           Chilling Time U
     C                     END                             *FI
     C                     Z-ADDP1GWDT    YL0005           Production Date
      * DOC:  Allocation
     C                     EXSR UCSUBR                     DOC:  Allocatio
      * CASE: LCL.Allocation Method USR is Backward
     C           YL0016    IFEQ 'B'                        *IF
      * For backwards start with the TO date, then -1 day until FROM date
     C                     Z-ADDP1GVDT    YL0015           Production Date
     C                     Z-ADDP1GWDT    P1ELDT           Production Date
      * Starting Production Date
      * CASE: PAR.Production Date RGF LT JOB.*Job date
     C           P1GVDT    IFLT ##JDT                      *IF
     C                     Z-ADD##JDT     YL0015           Production Date
      * CASE: PAR.Production Date RGT LT JOB.*Job date
     C           P1GWDT    IFLT ##JDT                      *IF
     C                     Z-ADDP1GWDT    YL0005           Production Date
     C                     END                             *FI
      * CASE: LCL.Block Order Flag is Block Order
     C           YL0001    IFEQ 'B'                        *IF
      * LCL.Production Date RGF = LCL.Production Date RGF + CON.1 *DAYS
     C           YL0015    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0015
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0015
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP1GWDT    P1ELDT           Production Date
     C                     END                             *FI
      * ITR:  Allocate Availability based on AGE CODE.
      * DO WHILE: Prd Dte >= Prd Dte RGF & Need > 0
      *  - c1 AND c3
      *   |- c1    : PAR.Production Date GE LCL.Production Date RGF
      *   |- c3    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     DO   *HIVAL                     *DOW
     C                     MOVEL'0'       Y0CX01  1
     C           P1ELDT    IFGE YL0015                     *IF
     C           P1HWQT    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
     C                     LEAVE
     C                     END                             *FI
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0001           Company Number
     C                     Z-ADDP1ELDT    WL0002           Post to G/L Dat
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0006    P      Production Day
      * FP1054 Check day for a production day per company item ext file
      * Rtv CIE Prod Day Sts  RT - Company Item Ext  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0004           Company Number
     C                     Z-ADDP1HGCD    WL0005           Item Code
     C                     Z-ADDP1ELDT    WL0006           Production Date
     C                     MOVELYL0007    WL0007    P      Production Day
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    YL0007    P      Production Day
      * Allocate Production
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Production Day Status is yes
      *   |- c2    : LCL.Production Day Status USR is not no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0006    IFEQ 'Y'                        *IF
     C           YL0007    IFEQ *BLANK                     *IF
     C           YL0007    OREQ 'Y'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Determine Production Type
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           P1ELDT    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0001           Production Type
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0008           Company Number
     C                     MOVELWN0001    WL0009    P      Production Type
     C                     Z-ADDP1ELDT    WL0010           Production Date
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0011    WUWXST    P      Record Found US
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0001           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Production Date GT JOB.*Job date
     C           P1ELDT    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0001           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Use input Warehouse and co
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0012           Company Number
     C                     MOVELWN0001    WL0013    P      Production Type
     C                     Z-ADDP1ELDT    WL0014           Production Date
     C                     Z-ADDP1HGCD    WL0015           Item Code
     C                     MOVELP1AJCD    WL0016    P      Warehouse Code
     C                     Z-ADDWN0003    WL0018           ATS Weight Avai
     C                     Z-ADDWN0004    WL0019           ATS Pieces Avai
     C                     Z-ADDWN0008    WL0020           Chilling Time U
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0017    WN0009           PS Avg Piece Wg
     C                     Z-ADDWL0018    WN0003           ATS Weight Avai
     C                     Z-ADDWL0019    WN0004           ATS Pieces Avai
      * Quantity Available
      * CASE: Piece Count = Y
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1PCCT    IFEQ 'Y'                        *IF
     C           P1BDNB    IFGT 0                          *IF
     C           P1BJNB    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : PAR.ATS Pieces Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : PAR.Bags Per Unit
     C           P1BDNB    MULT P1BJNB    W0WJ01           *Synon (15,0) w
     C           WN0004    DIV  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0002           ATS Quantity Av
     C                     ELSE
      * CASE: Piece Count = N
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1PCCT    IFEQ *BLANK                     *IF
     C           P1PCCT    OREQ 'N'
     C           P1AIWG    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.ATS Weight Available USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Unit Weight
     C           WN0003    DIV  P1AIWG    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0002           ATS Quantity Av
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD0         WN0002           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * Schedule As Ordered
      * CASE: PAR.ATS Adj Type USR 2 is Sched/Alloc As Ordered
     C           P1QJST    IFEQ 'AO'                       *IF
      * CASE: PAR.ATS Quantity Avail USR LT PAR.ATS Quantity Need USR
     C           WN0002    IFLT P1HWQT                     *IF
     C                     Z-ADDP1HWQT    WN0002           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * If production avail allocate
      * CASE: PAR.ATS Quantity Avail USR is GT Zero
     C           WN0002    IFGT 0                          *IF
      * Allocate Available Quantity
      * CASE: PAR.ATS Quantity Need USR GT PAR.ATS Quantity Avail USR
     C           P1HWQT    IFGT WN0002                     *IF
     C                     ADD  WN0002    P1CCQT           Quantity Schedu
     C           WN0002    MULT P1AIWG    WN0003           ATS Weight Avai
     C                     ADD  WN0003    P1AUWG           Weight Schedule
     C                     Z-ADDWN0003    WN0006           Weight Allocate
     C                     Z-ADDWN0002    WN0005           Quantity Alloca
     C                     ELSE
      * CASE: PAR.ATS Quantity Need USR LE PAR.ATS Quantity Avail USR
     C           P1HWQT    IFLE WN0002                     *IF
     C                     ADD  P1HWQT    P1CCQT           Quantity Schedu
     C           P1HWQT    MULT P1AIWG    P1ENWG           ATS Weight Need
     C                     ADD  P1ENWG    P1AUWG           Weight Schedule
     C                     Z-ADDP1ENWG    WN0006           Weight Allocate
     C                     Z-ADDP1HWQT    WN0005           Quantity Alloca
     C                     END                             *FI
     C                     END                             *FI
      * If quantity allocated is GT zero
      * CASE: PAR.Quantity Allocated USR is GT Zero
     C           WN0005    IFGT 0                          *IF
      * 8/05/11 RMC MOVE UP HERE FROM BELOW ORDER DTL SCHED UPD
      * CASE: PAR.Piece Count Item is yes
     C           P1PCCT    IFEQ 'Y'                        *IF
      * Pieces Allocated
      * PAR.Pieces Allocated USR =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : PAR.Quantity Allocated USR
      * *     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : PAR.Bags Per Unit
     C           WN0005    MULT P1BDNB    W0WJ01           *Synon (15,0) w
     C           W0WJ01    MULT P1BJNB    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0007           Pieces Allocate
      * Weight Allocated
      * PAR.Weight Allocated USR =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Pieces Allocated USR
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Avg Piece Wgt
     C           WN0007    MULT WN0009    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0006           Weight Allocate
     C                     END                             *FI
      * CASE: PAR.Warehouse Code EQ PAR.Warehouse Code PASS   USR
     C           P1AJCD    IFEQ P1AJCD                     *IF
      * Upd Ord Detail Sched  RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0021           Company Number
     C                     Z-ADDP1C4NB    WL0022           Order Number
     C                     Z-ADDP1DPNB    WL0023           Order Sequence
     C                     Z-ADDP1UENB    WL0024           Order Secondary
     C                     Z-ADDP1ELDT    WL0025           OD Production D
     C                     Z-ADDP1HLDT    WL0026           Scheduled Ship
     C                     MOVELP1AJCD    WL0027    P      Warehouse Code
     C                     MOVELP1AJCD    WL0028    P      Order From Ware
     C                     Z-ADDP1HGCD    WL0029           Item Code
     C                     Z-ADDWN0006    WL0030           Weight Allocate
     C                     Z-ADDWN0005    WL0031           Quantity Alloca
     C                     MOVELP7QZCD    WL0032    P      Base/Conv/Loss
     C                     EXSR SKRVGN
     C                     END                             *FI
      * FP1054  ADD sched  TO PAR.WAREHOUSE CODE PASS USR's standard prod
      * CASE: PAR.Warehouse Code NE PAR.Warehouse Code PASS   USR
     C           P1AJCD    IFNE P1AJCD                     *IF
      * FP1054 Use input Warehouse and co
      * Upd Prod Whse Txfr    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0033           Company Number
     C                     MOVELWN0001    WL0034    P      Production Type
     C                     Z-ADDP1ELDT    WL0035           Production Date
     C                     Z-ADDP1HGCD    WL0036           Item Code
     C                     MOVELP1AJCD    WL0037    P      Warehouse Code
     C                     Z-ADDWN0006    WL0038           Weight Allocate
     C                     Z-ADDWN0007    WL0039           Pieces Allocate
     C                     Z-ADDP1C4NB    WL0040           Order Number
     C                     Z-ADDP1DPNB    WL0041           Order Sequence
     C                     Z-ADDP1UENB    WL0042           Order Secondary
     C                     MOVEL'N'       WL0043    P      Status Flag 19
     C                     EXSR SORVGN
      * use order's warehouse and company
      * BPS Upd Pcs/Wgt Std   RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0131           Company Number
     C                     MOVELWN0001    WL0132    P      Production Type
     C                     Z-ADDP1ELDT    WL0133           Production Date
     C                     Z-ADDP1HGCD    WL0134           Item Code
     C                     MOVELP1AJCD    WL0135    P      Warehouse Code
     C                     Z-ADDWN0007    WL0136           Pieces Schedule
     C                     Z-ADDWN0006    WL0137           Weight Schedule
     C                     EXSR SVRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * FP1054 Use input Warehouse and co
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0138           Company Number
     C                     MOVELWN0001    WL0139    P      Production Type
     C                     Z-ADDP1ELDT    WL0140           Production Date
     C                     Z-ADDP1HGCD    WL0141           Item Code
     C                     MOVELP1AJCD    WL0142    P      Warehouse Code
     C                     Z-ADDWN0006    WL0143           Weight Allocate
     C                     Z-ADDWN0007    WL0144           Pieces Allocate
     C                     Z-ADDP1C4NB    WL0145           Order Number
     C                     Z-ADDP1DPNB    WL0146           Order Sequence
     C                     Z-ADDP1UENB    WL0147           Order Secondary
     C                     MOVEL'N'       WL0148    P      Status Flag 19
     C                     EXSR SXRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD0         WN0005           Quantity Alloca
     C                     Z-ADD0         WN0006           Weight Allocate
     C                     Z-ADD0         P1CCQT           Quantity Schedu
     C                     Z-ADD0         P1AUWG           Weight Schedule
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  0         P1CCQT           Quantity Schedu
     C                     ADD  0         P1AUWG           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 -  subtract 1 day to go backwards
      * CLC Inc/Dec Date       IF
      * CASE: PAR.*Duration (factor) is LT Zero
     C           -1        IFLT 0                          *IF
     C           -1        MULT -1        WUDUF            *Duration (fact
      * Clc Date (descending) RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0181           Company Number
     C                     Z-ADDP1ELDT    WL0182           Post to G/L Dat
     C                     Z-ADDP1ELDT    WL0184           *Date2 (beginni
     C                     Z-ADDWUDUF     WL0185           *Duration (fact
     C                     EXSR TGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0183    P1ELDT           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is GT Zero
     C           -1        IFGT 0                          *IF
      * Clc Date (ascending)  RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0186           Company Number
     C                     Z-ADDP1ELDT    WL0187           Post to G/L Dat
     C                     Z-ADDP1ELDT    WL0189           *Date2 (beginni
     C                     Z-ADD-1        WL0190           *Duration (fact
     C                     EXSR THRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0188    P1ELDT           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is EQ Zero
     C           -1        IFEQ 0                          *IF
     C                     Z-ADDP1ELDT    P1ELDT           *Date1 (ending)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           P1AVQT    SUB  P1CCQT    P1HWQT           ATS Quantity Ne
     C           P1D0WG    SUB  P1AUWG    P1ENWG           ATS Weight Need
     C                     END                             *ITR
     C                     END                             *FI
     C           P1AVQT    SUB  P1CCQT    P1HWQT           ATS Quantity Ne
     C           P1D0WG    SUB  P1AUWG    P1ENWG           ATS Weight Need
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Block Order Flag  RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WAAIC3           Company Number
     C                     Z-ADDP1C4NB    WAC4NB           Order Number
      * Establish starting position
     C           KRSSA     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           Block Order Fla
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWABCST    YL0001           Block Order Fla
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv CIE Alloc Method  RT - Company Item Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * E2885 RMC 12/4/13 new alloc method="S"tandard -- if shipping with
      *   3 days, force Alloc Method to F-ASAP, else use B-JIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSB01           Company Number
     C           *LIKE     DEFN WBHGCD    WQSB02           Item Code
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Item Code
      * Setup key
     C                     Z-ADDP1AIC3    WQSB01           Company Number
     C                     Z-ADDP1HGCD    WQSB02           Item Code
      * Establish starting position
     C           KRSSB     SETLL@FDREAW                    *
     C           KRSSB     READE@FDREAW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4125' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0002           Allocation Meth
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv SchShpDte         RT - Order Header TRG  * 
     C                     EXSR SCRVGN
      * CASE: DB1.Allocation Method is Standard or Blank
     C           WBENST    IFEQ *BLANK                     *IF
     C           WBENST    OREQ 'S'
      * Rtv PrdDay Dte -Durtn RT - Calendar  * 
     C                     EXSR SDRVGN
      * CASE: LCL.Scheduled Ship Date LE LCL.Date                  USR
     C           YL0003    IFLE YL0004                     *IF
     C                     MOVEL'F'       YL0002           Allocation Meth
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'B'       YL0002           Allocation Meth
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWBENST    YL0002           Allocation Meth
     C                     END                             *FI
     C           KRSSB     READE@FDREAW                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv SchShpDte         RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCC4NB    WQSC01           Order Number
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Order Number
      * Setup key
     C                     Z-ADDP1C4NB    WQSC01           Order Number
      * Establish starting position
     C           KRSSC     SETLL@BFCPY2                    *
     C           KRSSC     READE@BFCPY2                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0003           Scheduled Ship
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCAODT    YL0003           Scheduled Ship
     C           KRSSC     READE@BFCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv PrdDay Dte -Durtn RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSD01           Company Number
      * Define keylist
     C           KPSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WDBCDT           Post to G/L Dat
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
      * Setup key
     C                     Z-ADDWBAIC3    WQSD01           Company Number
     C                     Z-ADD##JDT     WDBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSD     SETLL@AFREY1                    *
     C           KRSSD     READE@AFREY1                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.Count USR EQ PAR.*Duration (factor)
     C           WUCNTU    IFEQ 3                          *IF
     C                     Z-ADDWDBCDT    YL0004           *DATE
     C                     GOTO SDEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C           KRSSD     READE@AFREY1                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Prd Day Sts       RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADDWL0001    WEAIC3           Company Number
     C                     Z-ADDWL0002    WEBCDT           Post to G/L Dat
      * Establish starting position
     C           KRSSE     CHAIN@AFREBE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0018' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0003           Production Day
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEWAST    WL0003           Production Day
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv CIE Prod Day Sts  RT - Company Item Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSF01           Company Number
     C           *LIKE     DEFN WBHGCD    WQSF02           Item Code
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Item Code
      * Setup key
     C                     Z-ADDWL0004    WQSF01           Company Number
     C                     Z-ADDWL0005    WQSF02           Item Code
      * Establish starting position
     C           KRSSF     SETLL@FDREAW                    *
     C           KRSSF     READE@FDREAW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4125' W0RTN   7
      * USER: Processing if Data record not found
      * default to "Y"es if rcd not found. user isnt overriding it to No
     C                     MOVEL*BLANK    WL0007           Production Day
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Day and Week No.   RT - Calendar  * 
     C                     EXSR SGRVGN
      * CASE: LCL.Day of Week is Sunday
     C           YL0008    IFEQ '1'                        *IF
     C                     MOVELWBD0ST    WL0007           Production Day
     C                     ELSE
      * CASE: LCL.Day of Week is Monday
     C           YL0008    IFEQ '2'                        *IF
     C                     MOVELWBD2ST    WL0007           Production Day
     C                     ELSE
      * CASE: LCL.Day of Week is Tuesday
     C           YL0008    IFEQ '3'                        *IF
     C                     MOVELWBD6ST    WL0007           Production Day
     C                     ELSE
      * CASE: LCL.Day of Week is Wednesday
     C           YL0008    IFEQ '4'                        *IF
     C                     MOVELWBWESP    WL0007           Production Day
     C                     ELSE
      * CASE: LCL.Day of Week is Thursday
     C           YL0008    IFEQ '5'                        *IF
     C                     MOVELWBEDST    WL0007           Production Day
     C                     ELSE
      * CASE: LCL.Day of Week is Friday
     C           YL0008    IFEQ '6'                        *IF
     C                     MOVELWBEFST    WL0007           Production Day
     C                     ELSE
      * CASE: LCL.Day of Week is Saturday
     C           YL0008    IFEQ '7'                        *IF
     C                     MOVELWBEHST    WL0007           Production Day
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSF     READE@FDREAW                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Day and Week No.   RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSG01           Company Number
     C           *LIKE     DEFN WFBCDT    WQSG02           Post to G/L Dat
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Post to G/L Dat
      * Setup key
     C                     Z-ADDWL0004    WQSG01           Company Number
     C                     Z-ADDWL0006    WQSG02           Post to G/L Dat
      * Establish starting position
     C           KRSSG     SETLL@AFREYY                    *
     C           KRSSG     READE@AFREYY                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWFA9ST    YL0008           Day of Week
     C           KRSSG     READE@AFREYY                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Val Sched Existance   RT - PS Prod Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGV5ST           Production Type
     C                     KFLD           WGELDT           Production Date
      * Setup key
     C                     Z-ADDWL0008    WGAIC3           Company Number
     C                     MOVELWL0009    WGV5ST           Production Type
     C                     Z-ADDWL0010    WGELDT           Production Date
      * Establish starting position
     C           KRSSH     CHAIN@JCCPVC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1795' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WL0011           Record Found US
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y'       WL0011           Record Found US
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0013  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0014  70       PS Pieces Ship
     C                     MOVEL*BLANK    WN0015  1        Piece Count Ite
     C                     Z-ADD*ZERO     WN0016  70       Pieces Per Bag
     C                     Z-ADD*ZERO     WN0017  70       Bags Per Unit
     C                     Z-ADD*ZERO     WN0018  92       Weight Producti
     C                     Z-ADD*ZERO     WN0019  70       Pieces Producti
     C                     Z-ADD*ZERO     WN0020 112       OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WN0021 112       OD Weight Sched
     C                     Z-ADD*ZERO     WN0022  70       Pieces Allocate
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0017           PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0013           PS Weight Ship
     C                     Z-ADD*ZERO     WN0014           PS Pieces Ship
     C                     Z-ADD*ZERO     WL0018           ATS Weight Avai
     C                     Z-ADD*ZERO     WL0019           ATS Pieces Avai
     C                     MOVEL*BLANK    WN0015           Piece Count Ite
     C                     Z-ADD*ZERO     WN0016           Pieces Per Bag
     C                     Z-ADD*ZERO     WN0017           Bags Per Unit
     C                     Z-ADD*ZERO     WN0018           Weight Producti
     C                     Z-ADD*ZERO     WN0019           Pieces Producti
     C                     Z-ADD*ZERO     WN0020           OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WN0021           OD Weight Sched
     C                     Z-ADD*ZERO     WN0022           Pieces Allocate
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHV5ST           Production Type
     C                     KFLD           WHELDT           Production Date
     C                     KFLD           WHHGCD           Item Code
     C                     KFLD           WHAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0012    WHAIC3           Company Number
     C                     MOVELWL0013    WHV5ST           Production Type
     C                     Z-ADDWL0014    WHELDT           Production Date
     C                     Z-ADDWL0015    WHHGCD           Item Code
     C                     MOVELWL0016    WHAJCD           Warehouse Code
      * Establish starting position
     C           KRSSI     CHAIN@I8CPUS              90    *
      * Data record not found
     C   90                MOVEL'USR1763' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * FP1054 06/02/06 add planned prod wt and pieces to Weight Prod & P
      * so calc is: Production = Planned Prod + Standard + Prod Adj - Con
      *  instead of:
      * Production = Standard + Prod Adj - Converted
      * Prod Avail = Production + Ship Cut Adj + Ship Adj - Prod Alloc
      * CASE: DB1.PS Lock Status is NOT LOCKED
     C           WHB5ST    IFEQ 'N'                        *IF
      * Ship Cut Adjust
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Chilling Time USR is GT Zero
      *   |- c2    : DB1.Production Date EQ JOB.*Job date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0020    IFGT 0                          *IF
     C           WHELDT    IFEQ ##JDT                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Ship Cut Adjust   RT - PS Prod Item Schedule  * 
     C                     EXSR SJRVGN
     C                     END                             *FI
      * FP1054 06/02/06 add planned prod wt and pieces to Weight Prod & P
      * Weight Production
      * PAR.Weight Production USR =
      *    *COMPUTE (x5+ x1 + x2 - x3 - x4)
      * x5    : DB1.PS Weight Planned Prod
      * +     : PGM.*Synon (15,2) work field
      * x1    : DB1.PS Weight Standard
      * +     : PGM.*Synon (17,7) work field
      * x2    : DB1.PS Weight Prod Adj
      * -     : PGM.*Synon (15,2) work field
      * x3    : DB1.PS Weight Converted
      * -     : PGM.*Synon (17,7) work field
      * x4    : DB1.PS Weight Whse Tfr Adj
     C           WHWTSP    ADD  WHDXWG    W0WA03           *Synon (15,2) w
     C           W0WA03    ADD  WHD1WG    W0WD02           *Synon (17,7) w
     C           W0WD02    SUB  WHWTCN    W0WA01           *Synon (15,2) w
     C           W0WA01    SUB  WHGAWG    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0018           Weight Producti
      * Pieces Production
      * PAR.Pieces Production USR =
      *    *COMPUTE (x5+ x1 + x2 - x3 - x4)
      * x5    : DB1.PS Pieces Planned Prod
      * +     : PGM.*Synon (15,0) work field
      * x1    : DB1.PS Pieces Standard
      * +     : PGM.*Synon (17,7) work field
      * x2    : DB1.PS Pieces Prod Adj
      * -     : PGM.*Synon (15,0) work field
      * x3    : DB1.PS Pieces Converted
      * -     : PGM.*Synon (17,7) work field
      * x4    : DB1.PS Pieces Whse Tfr Adj
     C           WHQTSP    ADD  WHB2NB    W0WJ03           *Synon (15,0) w
     C           W0WJ03    ADD  WHCBNB    W0WD02           *Synon (17,7) w
     C           W0WD02    SUB  WHPSCV    W0WJ01           *Synon (15,0) w
     C           W0WJ01    SUB  WHBPNB    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0019           Pieces Producti
      * Weight Available
      * PAR.ATS Weight Available USR =
      *    *COMPUTE (x1 + x2 + x3 - x4)
      * x1    : PAR.Weight Production USR
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.PS Weight Ship Cut Adj
      * +     : PGM.*Synon (15,2) work field
      * x3    : DB1.PS Weight Shipping Adj
      * -     : PGM.*Synon (15,2) work field
      * x4    : DB1.PS Weight Prod Allocated
     C           WN0018    ADD  WN0013    W0WA02           *Synon (15,2) w
     C           W0WA02    ADD  WHSAWT    W0WA01           *Synon (15,2) w
     C           W0WA01    SUB  WHOAWT    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0018           ATS Weight Avai
      * Pieces Available
      * PAR.ATS Pieces Available USR =
      *    *COMPUTE (x1 + x2 + x3 - x4)
      * x1    : PAR.Pieces Production USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Pieces Ship Cut Adj
      * +     : PGM.*Synon (15,0) work field
      * x3    : DB1.PS Pieces Shipping Adj
      * -     : PGM.*Synon (15,0) work field
      * x4    : DB1.PS Pieces Prod Allocated
     C           WN0019    ADD  WN0014    W0WJ02           *Synon (15,0) w
     C           W0WJ02    ADD  WHB9NB    W0WJ01           *Synon (15,0) w
     C           W0WJ01    SUB  WHCDNB    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0019           ATS Pieces Avai
      * Weight Avail E1971 RMC   2/27/12 change to leave pieces if > 0
      * CASE: PAR.ATS Weight Available USR is Less than zero
     C           WL0018    IFLT 0                          *IF
      * CASE: PAR.ATS Pieces Available USR is LE Zero
     C           WL0019    IFLE 0                          *IF
     C                     Z-ADD0         WL0018           ATS Weight Avai
     C                     Z-ADD0         WL0019           ATS Pieces Avai
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWHF8WG    WL0017           PS Avg Piece Wg
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Ship Cut Adjust   RT - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIAIC3    WQSJ01           Company Number
     C           *LIKE     DEFN WIHGCD    WQSJ02           Item Code
     C           *LIKE     DEFN WIAJCD    WQSJ03           Warehouse Code
     C           *LIKE     DEFN WIELDT    WQSJ04           Production Date
     C           *LIKE     DEFN WIV5ST    WQSJ05           Production Type
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Item Code
     C                     KFLD           WQSJ03           Warehouse Code
     C                     KFLD           WQSJ04           Production Date
     C                     KFLD           WQSJ05           Production Type
      * Setup key
     C                     Z-ADDWHAIC3    WQSJ01           Company Number
     C                     Z-ADDWHHGCD    WQSJ02           Item Code
     C                     MOVELWHAJCD    WQSJ03           Warehouse Code
     C                     Z-ADDWHGPDT    WQSJ04           Production Date
     C                     MOVEL'P'       WQSJ05           Production Type
      * Establish starting position
     C           KRSSJ     SETLL@I8CPXP                    *
     C           KRSSJ     READE@I8CPXP                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0013           PS Weight Ship
     C                     Z-ADD*ZERO     WN0014           PS Pieces Ship
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWIE0WG    WN0013           PS Weight Ship
     C                     Z-ADDWID6NB    WN0014           PS Pieces Ship
     C           KRSSJ     READE@I8CPXP                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Upd Ord Detail Sched  RT - Order Detail Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0023 112       OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WN0024 112       OD Weight Sched
     C                     Z-ADD*ZERO     WN0025 112       OD Quantity Inv
     C                     Z-ADD*ZERO     WN0026 112       OD Weight Inv S
     C                     Z-ADD*ZERO     WN0027 112       OD Quantity Unu
     C                     Z-ADD*ZERO     WN0028 112       OD Unused weigh
     C                     MOVEL*BLANK    WN0029  1        OD Added to Sch
     C                     MOVEL*BLANK    WN0030  1        OD Reallocate S
     C                     MOVEL*BLANK    WN0031  2        OD Status Unuse
     C                     MOVEL*BLANK    WN0032  1        EDI Status 1
     C                     MOVEL*BLANK    WN0033  1        EDI Status 2
     C                     MOVEL*BLANK    WN0034  1        EDI Status 3
     C                     MOVEL*BLANK    WN0035  1        Record Status
     C                     Z-ADD*ZERO     WN0036  60       Job Time
     C                     MOVEL*BLANK    WN0037 10        User Id
     C                     MOVEL*BLANK    WN0038 10        Job Name
     C                     Z-ADD*ZERO     WN0039  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJC4NB           Order Number
     C                     KFLD           WJDPNB           Order Sequence
     C                     KFLD           WJUENB           Order Secondary
     C                     KFLD           WJJGDT           OD Production D
      * Setup key
     C                     Z-ADDWL0021    WJAIC3           Company Number
     C                     Z-ADDWL0022    WJC4NB           Order Number
     C                     Z-ADDWL0023    WJDPNB           Order Sequence
     C                     Z-ADDWL0024    WJUENB           Order Secondary
     C                     Z-ADDWL0025    WJJGDT           OD Production D
      * Establish starting position
     C           KRSSK     CHAIN@KNCPHO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2238' W0RTN   7
      * USER: Processing if Data record not found
      * CRT Ord Detail Sched   CR - Order Detail Schedule  * 
     C                     EXSR SLCRRC
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WJIGQT    ADD  WL0031    WN0023           OD Qty/Cnsmd Pi
     C           WJFLWG    ADD  WL0030    WN0024           OD Weight Sched
     C                     MOVELWJP7ST    YL0009           OD Added to Sch
      * CASE: PAR.Base/Conv/Loss Item is Converted/Fabricated
     C           WL0032    IFEQ 'C'                        *IF
     C           WL0032    OREQ 'F'
      * CASE: PAR.OD Production Date EQ JOB.*Job date
     C           WL0025    IFEQ ##JDT                      *IF
     C                     MOVEL'Y'       YL0009           OD Added to Sch
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.OD Quantity Scheduled is Greater than zero
     C           WN0023    IFGT 0                          *IF
      * CHG Qty/Wgt Scheduled  CH - Order Detail Schedule  * 
     C                     EXSR SMCHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * DLT Ord Detail Sched   DL - Order Detail Schedule  * 
     C                     EXSR SNDLRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCRRC    BEGSR
      *================================================================
      * CRT Ord Detail Sched   CR - Order Detail Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @KNCPHN
     C                     Z-ADDWL0021    WKAIC3           Company Number
     C                     Z-ADDWL0022    WKC4NB           Order Number
     C                     Z-ADDWL0023    WKDPNB           Order Sequence
     C                     Z-ADDWL0024    WKUENB           Order Secondary
     C                     Z-ADDWL0025    WKJGDT           OD Production D
     C                     Z-ADDWL0026    WKAODT           Scheduled Ship
     C                     MOVELWL0027    WKAJCD           Warehouse Code
     C                     MOVELWL0028    WKAYAA           Order From Ware
     C                     Z-ADDWL0029    WKHGCD           Item Code
     C                     Z-ADDWL0031    WKIGQT           OD Qty/Cnsmd Pi
     C                     Z-ADDWL0030    WKFLWG           OD Weight Sched
     C                     Z-ADDWN0025    WKIUQT           OD Quantity Inv
     C                     Z-ADDWN0026    WKF3WG           OD Weight Inv S
     C                     Z-ADDWN0027    WKIVQT           OD Quantity Unu
     C                     Z-ADDWN0028    WKF4WG           OD Unused weigh
     C                     MOVELWN0029    WKP7ST           OD Added to Sch
     C                     MOVELWN0030    WKP8ST           OD Reallocate S
     C                     MOVELWN0031    WKQAST           OD Status Unuse
     C                     MOVELWN0032    WKUVST           EDI Status 1
     C                     MOVELWN0033    WKUWST           EDI Status 2
     C                     MOVELWN0034    WKUXST           EDI Status 3
     C                     MOVELWN0035    WKVSST           Record Status
     C                     Z-ADDWN0036    WKAATM           Job Time
     C                     MOVELWN0037    WKAYNA           User Id
     C                     MOVELWN0038    WKA0NA           Job Name
     C                     Z-ADDWN0039    WKAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WKVSST           Record Status
     C                     Z-ADD##JTM     WKAATM           Job Time
     C                     MOVEL##USR     WKAYNA           User Id
     C                     MOVEL##PGM     WKA0NA           Job Name
     C                     Z-ADD##JDT     WKAXDT           Job Date
     C           KLCRSL    KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKC4NB           Order Number
     C                     KFLD           WKDPNB           Order Sequence
     C                     KFLD           WKUENB           Order Secondary
     C                     KFLD           WKJGDT           OD Production D
      * Check for duplicate primary key
     C           KLCRSL    SETLL@KNCPHN                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2239' W0RTN   7
      * Send message 'Order Detail Schedule  EX'
     C                     MOVEL'USR2239' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C                     WRITE@KNCPHN                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCHRC    BEGSR
      *================================================================
      * CHG Qty/Wgt Scheduled  CH - Order Detail Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0040  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0041  3        Warehouse Code
     C                     MOVEL*BLANK    WN0042  3        Order From Ware
     C                     Z-ADD*ZERO     WN0043  70       Item Code
     C                     Z-ADD*ZERO     WN0044 112       OD Quantity Unu
     C                     Z-ADD*ZERO     WN0045 112       OD Unused weigh
     C                     MOVEL*BLANK    WN0046  1        OD Reallocate S
     C                     MOVEL*BLANK    WN0047  2        OD Status Unuse
     C                     MOVEL*BLANK    WN0048  1        EDI Status 1
     C                     MOVEL*BLANK    WN0049  1        EDI Status 2
     C                     MOVEL*BLANK    WN0050  1        EDI Status 3
     C                     MOVEL*BLANK    WN0051  1        Record Status
     C                     Z-ADD*ZERO     WN0052  60       Job Time
     C                     MOVEL*BLANK    WN0053 10        User Id
     C                     MOVEL*BLANK    WN0054 10        Job Name
     C                     Z-ADD*ZERO     WN0055  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @KNCPHN
     C                     Z-ADDWJAIC3    WKAIC3           Company Number
     C                     Z-ADDWJC4NB    WKC4NB           Order Number
     C                     Z-ADDWJDPNB    WKDPNB           Order Sequence
     C                     Z-ADDWJUENB    WKUENB           Order Secondary
     C                     Z-ADDWJJGDT    WKJGDT           OD Production D
      *
     C           KLCHSM    KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKC4NB           Order Number
     C                     KFLD           WKDPNB           Order Sequence
     C                     KFLD           WKUENB           Order Secondary
     C                     KFLD           WKJGDT           OD Production D
     C           KLCHSM    CHAIN@KNCPHN              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDKNCPL0'MDACP
     C                     MOVEL'@KNCPHN' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDKN1    YARDCS
      * Move non-key fields to @KNCPHN
     C                     Z-ADDWN0023    WKIGQT           OD Qty/Cnsmd Pi
     C                     Z-ADDWN0024    WKFLWG           OD Weight Sched
     C                     Z-ADDWJIUQT    WKIUQT           OD Quantity Inv
     C                     Z-ADDWJF3WG    WKF3WG           OD Weight Inv S
     C                     MOVELYL0009    WKP7ST    P      OD Added to Sch
      *
      * Set PGM.*Record Data Changed flag
     C           QPDKN1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WKAATM           Job Time
     C                     MOVEL##USR     WKAYNA           User Id
     C                     MOVEL##PGM     WKA0NA           Job Name
     C                     Z-ADD##JDT     WKAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDKN1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@KNCPHN                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDKNCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNDLRC    BEGSR
      *================================================================
      * DLT Ord Detail Sched   DL - Order Detail Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @KNCPHN
     C                     Z-ADDWJAIC3    WKAIC3           Company Number
     C                     Z-ADDWJC4NB    WKC4NB           Order Number
     C                     Z-ADDWJDPNB    WKDPNB           Order Sequence
     C                     Z-ADDWJUENB    WKUENB           Order Secondary
     C                     Z-ADDWJJGDT    WKJGDT           OD Production D
      *
     C           KLDLSN    KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKC4NB           Order Number
     C                     KFLD           WKDPNB           Order Sequence
     C                     KFLD           WKUENB           Order Secondary
     C                     KFLD           WKJGDT           OD Production D
     C           KLDLSN    CHAIN@KNCPHN              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDKNCPL0'MDACP
     C                     MOVEL'@KNCPHN' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@KNCPHN                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Upd Prod Whse Txfr    RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0056  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0057  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0058  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0059  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0060  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0061  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0062  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0063  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0064  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0065  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0066  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0067  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0068  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0069  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0070  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0071  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0072  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0073  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0074  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0075  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0076  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0077  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0078  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0079 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0080  70       PS Pieces Whse
     C                     Z-ADD*ZERO     WN0081 112       PS Weight Whse
     C                     Z-ADD*ZERO     WN0082  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0083 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0084  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0085 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0086  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0087 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0088  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0089 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0090  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0091  3        PS Item Id
     C                     MOVEL*BLANK    WN0092  2        Warehouse Type
     C                     MOVEL*BLANK    WN0093  1        PS Lock Status
     C                     MOVEL*BLANK    WN0094  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0095  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0096  1        PS Piece Count
     C                     MOVEL*BLANK    WN0097  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0098  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0099  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0100  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0101  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0102  3        PS Production W
     C                     Z-ADD*ZERO     WN0103  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0104  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0105  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0106  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0107  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0108  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0109  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0110  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0111  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0112  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0113  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0114  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0115  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0116  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0117  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0118  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0119  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0120  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0121  6        Department Code
     C                     Z-ADD*ZERO     WN0122  30       Item Structure
     C                     Z-ADD*ZERO     WN0123  30       Item Structure
     C                     Z-ADD*ZERO     WN0124  30       Item Structure
     C                     MOVEL*BLANK    WN0125  6        Primal Group Co
     C                     MOVEL*BLANK    WN0126  1        EDI Status 1
     C                     MOVEL*BLANK    WN0127  1        EDI Status 2
     C                     MOVEL*BLANK    WN0128  1        EDI Status 3
     C                     MOVEL*BLANK    WN0129  1        Record Status
     C                     Z-ADD*ZERO     WN0130  60       Job Time
     C                     MOVEL*BLANK    WN0131 10        User Id
     C                     MOVEL*BLANK    WN0132 10        Job Name
     C                     Z-ADD*ZERO     WN0133  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHV5ST           Production Type
     C                     KFLD           WHELDT           Production Date
     C                     KFLD           WHHGCD           Item Code
     C                     KFLD           WHAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0033    WHAIC3           Company Number
     C                     MOVELWL0034    WHV5ST           Production Type
     C                     Z-ADDWL0035    WHELDT           Production Date
     C                     Z-ADDWL0036    WHHGCD           Item Code
     C                     MOVELWL0037    WHAJCD           Warehouse Code
      * Establish starting position
     C           KRSSO     CHAIN@I8CPUS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADDWL0038    WN0081           PS Weight Whse
     C                     Z-ADDWL0039    WN0080           PS Pieces Whse
      * CASE: PAR.PS Pieces Whse Tfr Adj is GT Zero
     C           WN0080    IFGT 0                          *IF
      * Average Piece Weight
      * PAR.PS Avg Piece Wgt =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Whse Tfr Adj
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Pieces Whse Tfr Adj
     C           WN0081    DIV  WN0080    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0060           PS Avg Piece Wg
     C                     END                             *FI
      * UPS Crt Prod Detail   CR - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0033    WL0044           Company Number
     C                     MOVELWL0034    WL0045    P      Production Type
     C                     Z-ADDWL0035    WL0046           Production Date
     C                     Z-ADDWL0036    WL0047           Item Code
     C                     MOVELWL0037    WL0048    P      Warehouse Code
     C                     Z-ADDWN0056    WL0049           PS Available Sh
     C                     Z-ADDWN0057    WL0050           PS Weight Plann
     C                     Z-ADDWN0058    WL0051           PS Pieces Plann
     C                     Z-ADDWN0059    WL0052           PS % of Carcass
     C                     Z-ADDWN0060    WL0053           PS Avg Piece Wg
     C                     Z-ADDWN0061    WL0054           PS Weight Inv O
     C                     Z-ADDWN0062    WL0055           PS Pieces Inv O
     C                     Z-ADDWN0063    WL0056           PS Weight Stand
     C                     Z-ADDWN0064    WL0057           PS Pieces Stand
     C                     Z-ADDWN0065    WL0058           PS Weight Conve
     C                     Z-ADDWN0066    WL0059           PS Pieces Conve
     C                     Z-ADDWN0067    WL0060           PS Weight Shipp
     C                     Z-ADDWN0068    WL0061           PS Pieces Shipp
     C                     Z-ADDWN0069    WL0062           PS Weight Prod
     C                     Z-ADDWN0070    WL0063           PS Pieces Prod
     C                     Z-ADDWN0071    WL0064           PS Weight Inv A
     C                     Z-ADDWN0072    WL0065           PS Pieces Inv A
     C                     Z-ADDWN0073    WL0066           PS Weight Ship
     C                     Z-ADDWN0074    WL0067           PS Pieces Ship
     C                     Z-ADDWN0075    WL0068           PS Weight Prod
     C                     Z-ADDWN0076    WL0069           PS Pieces Prod
     C                     Z-ADDWN0077    WL0070           PS Weight Inv A
     C                     Z-ADDWN0078    WL0071           PS Pieces Inv A
     C                     Z-ADDWN0079    WL0072           PS Unit Weight
     C                     Z-ADDWN0080    WL0073           PS Pieces Whse
     C                     Z-ADDWN0081    WL0074           PS Weight Whse
     C                     Z-ADDWN0082    WL0075           PS Pieces Unuse
     C                     Z-ADDWN0083    WL0076           PS Weight Unuse
     C                     Z-ADDWN0084    WL0077           PS Pieces Unuse
     C                     Z-ADDWN0085    WL0078           PS Weight Unuse
     C                     Z-ADDWN0086    WL0079           PS Pieces Unuse
     C                     Z-ADDWN0087    WL0080           PS Weight Unuse
     C                     Z-ADDWN0088    WL0081           PS Pieces Unuse
     C                     Z-ADDWN0089    WL0082           PS Weight Unuse
     C                     Z-ADDWN0090    WL0083           PS Pieces Unuse
     C                     MOVELWN0091    WL0084    P      PS Item Id
     C                     MOVELWN0092    WL0085    P      Warehouse Type
     C                     MOVELWN0093    WL0086    P      PS Lock Status
     C                     MOVELWN0094    WL0087    P      PS Export/Domes
     C                     MOVELWN0095    WL0088    P      PS Print On Sch
     C                     MOVELWN0096    WL0089    P      PS Piece Count
     C                     MOVELWN0097    WL0090    P      PS Unused Sts 1
     C                     MOVELWN0098    WL0091    P      PS Unused Sts 2
     C                     MOVELWN0099    WL0092    P      PS Unused Sts 3
     C                     MOVELWN0100    WL0093    P      PS Unused Sts 4
     C                     MOVELWN0101    WL0094    P      PS Item Sched N
     C                     MOVELWN0102    WL0095    P      PS Production W
     C                     Z-ADDWN0103    WL0096           PS Weight Order
     C                     Z-ADDWN0104    WL0097           PS Pieces Order
     C                     Z-ADDWN0105    WL0098           PS Weight FC Ad
     C                     Z-ADDWN0106    WL0099           PS Pieces FC Ad
     C                     Z-ADDWN0107    WL0100           PS Weight FX Ad
     C                     Z-ADDWN0108    WL0101           PS Pieces FX Ad
     C                     Z-ADDWN0109    WL0102           PS Weight Sched
     C                     Z-ADDWN0110    WL0103           PS Pieces Sched
     C                     Z-ADDWN0111    WL0104           PS Weight Avail
     C                     Z-ADDWN0112    WL0105           PS Pieces Avail
     C                     Z-ADDWN0113    WL0106           PS Weight Produ
     C                     Z-ADDWN0114    WL0107           PS Pieces Produ
     C                     Z-ADDWN0115    WL0108           PS Weight Fab N
     C                     Z-ADDWN0116    WL0109           PS Pieces Fab N
     C                     Z-ADDWN0117    WL0110           PS Weight Sched
     C                     Z-ADDWN0118    WL0111           PS Pieces Sched
     C                     Z-ADDWN0119    WL0112           PS Weight Sched
     C                     Z-ADDWN0120    WL0113           PS Pieces Sched
     C                     MOVELWN0121    WL0114    P      Department Code
     C                     Z-ADDWN0122    WL0115           Item Structure
     C                     Z-ADDWN0123    WL0116           Item Structure
     C                     Z-ADDWN0124    WL0117           Item Structure
     C                     MOVELWN0125    WL0118    P      Primal Group Co
     C                     MOVELWN0126    WL0119    P      EDI Status 1
     C                     MOVELWN0127    WL0120    P      EDI Status 2
     C                     MOVELWN0128    WL0121    P      EDI Status 3
     C                     MOVELWN0129    WL0122    P      Record Status
     C                     Z-ADDWN0130    WL0123           Job Time
     C                     MOVELWN0131    WL0124    P      User Id
     C                     MOVELWN0132    WL0125    P      Job Name
     C                     Z-ADDWN0133    WL0126           Job Date
     C                     EXSR SPCRRC
      *  not necessary here ...
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WHGAWG    ADD  WL0038    WN0081           PS Weight Whse
     C           WHBPNB    ADD  WL0039    WN0080           PS Pieces Whse
      * Chg Prod Whse Txfr    CH - PS Prod Item Schedule  * 
     C                     EXSR SUCHRC
      *  not necessary here ...
      * FP1054 create/delete consumed records - if called from PRD routin
      *  and STD was allocated
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCRRC    BEGSR
      *================================================================
      * UPS Crt Prod Detail   CR - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @I8CPUR
     C                     Z-ADDWL0044    WLAIC3           Company Number
     C                     MOVELWL0045    WLV5ST           Production Type
     C                     Z-ADDWL0046    WLELDT           Production Date
     C                     Z-ADDWL0047    WLHGCD           Item Code
     C                     MOVELWL0048    WLAJCD           Warehouse Code
     C                     Z-ADDWL0049    WLGPDT           PS Available Sh
     C                     Z-ADDWL0050    WLWTSP           PS Weight Plann
     C                     Z-ADDWL0051    WLQTSP           PS Pieces Plann
     C                     Z-ADDWL0052    WLDJPC           PS % of Carcass
     C                     Z-ADDWL0053    WLF8WG           PS Avg Piece Wg
     C                     Z-ADDWL0054    WLWTIN           PS Weight Inv O
     C                     Z-ADDWL0055    WLD5NB           PS Pieces Inv O
     C                     Z-ADDWL0056    WLDXWG           PS Weight Stand
     C                     Z-ADDWL0057    WLB2NB           PS Pieces Stand
     C                     Z-ADDWL0058    WLWTCN           PS Weight Conve
     C                     Z-ADDWL0059    WLPSCV           PS Pieces Conve
     C                     Z-ADDWL0060    WLSAWT           PS Weight Shipp
     C                     Z-ADDWL0061    WLB9NB           PS Pieces Shipp
     C                     Z-ADDWL0062    WLD1WG           PS Weight Prod
     C                     Z-ADDWL0063    WLCBNB           PS Pieces Prod
     C                     Z-ADDWL0064    WLEZWG           PS Weight Inv A
     C                     Z-ADDWL0065    WLCCNB           PS Pieces Inv A
     C                     Z-ADDWL0066    WLE0WG           PS Weight Ship
     C                     Z-ADDWL0067    WLD6NB           PS Pieces Ship
     C                     Z-ADDWL0068    WLOAWT           PS Weight Prod
     C                     Z-ADDWL0069    WLCDNB           PS Pieces Prod
     C                     Z-ADDWL0070    WLUNW2           PS Weight Inv A
     C                     Z-ADDWL0071    WLCENB           PS Pieces Inv A
     C                     Z-ADDWL0072    WLF9WG           PS Unit Weight
     C                     Z-ADDWL0073    WLBPNB           PS Pieces Whse
     C                     Z-ADDWL0074    WLGAWG           PS Weight Whse
     C                     Z-ADDWL0075    WLBQNB           PS Pieces Unuse
     C                     Z-ADDWL0076    WLGBWG           PS Weight Unuse
     C                     Z-ADDWL0077    WLBRNB           PS Pieces Unuse
     C                     Z-ADDWL0078    WLGCWG           PS Weight Unuse
     C                     Z-ADDWL0079    WLBSNB           PS Pieces Unuse
     C                     Z-ADDWL0080    WLGDWG           PS Weight Unuse
     C                     Z-ADDWL0081    WLBWNB           PS Pieces Unuse
     C                     Z-ADDWL0082    WLGEWG           PS Weight Unuse
     C                     Z-ADDWL0083    WLPS6U           PS Pieces Unuse
     C                     MOVELWL0084    WLWCST           PS Item Id
     C                     MOVELWL0085    WLWPST           Warehouse Type
     C                     MOVELWL0086    WLB5ST           PS Lock Status
     C                     MOVELWL0087    WLTFST           PS Export/Domes
     C                     MOVELWL0088    WLTEST           PS Print On Sch
     C                     MOVELWL0089    WLTHST           PS Piece Count
     C                     MOVELWL0090    WLUDST           PS Unused Sts 1
     C                     MOVELWL0091    WLUFST           PS Unused Sts 2
     C                     MOVELWL0092    WLUGST           PS Unused Sts 3
     C                     MOVELWL0093    WLUHST           PS Unused Sts 4
     C                     MOVELWL0094    WLB6ST           PS Item Sched N
     C                     MOVELWL0095    WLB7ST           PS Production W
     C                     Z-ADDWL0096    WLDVWG           PS Weight Order
     C                     Z-ADDWL0097    WLD7NB           PS Pieces Order
     C                     Z-ADDWL0098    WLFCAD           PS Weight FC Ad
     C                     Z-ADDWL0099    WLD9NB           PS Pieces FC Ad
     C                     Z-ADDWL0100    WLDWWG           PS Weight FX Ad
     C                     Z-ADDWL0101    WLEANB           PS Pieces FX Ad
     C                     Z-ADDWL0102    WLSHWT           PS Weight Sched
     C                     Z-ADDWL0103    WLEBNB           PS Pieces Sched
     C                     Z-ADDWL0104    WLAVWT           PS Weight Avail
     C                     Z-ADDWL0105    WLECNB           PS Pieces Avail
     C                     Z-ADDWL0106    WLWTON           PS Weight Produ
     C                     Z-ADDWL0107    WLEDNB           PS Pieces Produ
     C                     Z-ADDWL0108    WLFNWT           PS Weight Fab N
     C                     Z-ADDWL0109    WLEENB           PS Pieces Fab N
     C                     Z-ADDWL0110    WLQTAS           PS Weight Sched
     C                     Z-ADDWL0111    WLEFNB           PS Pieces Sched
     C                     Z-ADDWL0112    WLWAIO           PS Weight Sched
     C                     Z-ADDWL0113    WLEGNB           PS Pieces Sched
     C                     MOVELWL0114    WLR3CD           Department Code
     C                     Z-ADDWL0115    WLRGNB           Item Structure
     C                     Z-ADDWL0116    WLRHNB           Item Structure
     C                     Z-ADDWL0117    WLRINB           Item Structure
     C                     MOVELWL0118    WLXRCD           Primal Group Co
     C                     MOVELWL0119    WLUVST           EDI Status 1
     C                     MOVELWL0120    WLUWST           EDI Status 2
     C                     MOVELWL0121    WLUXST           EDI Status 3
     C                     MOVELWL0122    WLVSST           Record Status
     C                     Z-ADDWL0123    WLAATM           Job Time
     C                     MOVELWL0124    WLAYNA           User Id
     C                     MOVELWL0125    WLA0NA           Job Name
     C                     Z-ADDWL0126    WLAXDT           Job Date
      *
      * USER: Processing before Data update
      * BPS Setup Item Info   IF
      *
     C                     Z-ADD*ZERO     WN0134 155       System Value Nu
      *
      * UPS Rtv Company/Item  IF
      * Rtv Prd Sch Info   PS RT - Company Item  * 
     C                     EXSR SQRVGN
      * BPS Rtv Whs Info      RT - Warehouse  * 
     C                     EXSR SRRVGN
      * BPS Set Up Item Id    IF
      * CASE: PAR.Item Type Code is Raw Materials
     C           WUN0CD    IFEQ 'RM'                       *IF
     C                     MOVEL'RMB'     WLWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Seconds Item is Yes
     C           WUX5ST    IFEQ 'Y'                        *IF
     C                     MOVEL'FSC'     WLWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Variety/Rendered/Cut is Variety
     C           WUXWST    IFEQ 'V'                        *IF
     C                     MOVEL'FVR'     WLWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Rendered
     C           WUXWST    IFEQ 'R'                        *IF
     C                     MOVEL'FRD'     WLWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Cut
     C           WUXWST    IFEQ 'C'                        *IF
      * Base/Converted/Fabricated
      * CASE: PAR.Credit Item Status is yes
     C           WUVMST    IFEQ 'Y'                        *IF
      * Setup Base/Converted/Fabricated Credit
      * CASE: PAR.Converted/Base Item is Base
     C           WUQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FBC'     WLWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WUQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCC'     WLWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WUQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFC'     WLWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WUQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLC'     WLWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup Base/Converted/Fabricated
      * CASE: PAR.Converted/Base Item is Base
     C           WUQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FGB'     WLWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WUQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCV'     WLWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WUQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFB'     WLWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WUQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLS'     WLWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Output PS Prod Warehouse
      * Rtv Productin Whs     RT - Warehouse  * 
     C                     EXSR SSRVGN
      * Available Ship Date
      * CASE: WRK.Warehouse Std Chill Time is yes
     C           WUT1ST    IFEQ 'Y'                        *IF
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0127           Company Number
     C                     Z-ADDWL0046    WL0128           Post to G/L Dat
     C                     Z-ADDWUDBNB    WL0129           Fresh Chilling
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0130    WLGPDT           PS Available Sh
     C                     ELSE
      * CASE: *OTHERWISE
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0127           Company Number
     C                     Z-ADDWL0046    WL0128           Post to G/L Dat
     C                     Z-ADDWUCHTM    WL0129           Fresh Chilling
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0130    WLGPDT           PS Available Sh
     C                     END                             *FI
      * Average Piece Weight
      * CASE: PAR.PS Pieces Planned Prod is GT Zero
     C           WL0051    IFGT 0                          *IF
     C           WL0050    DIV  WL0051    WLF8WG           PS Avg Piece Wg
     C                     END                             *FI
      * UPS CRTOBJ Stamp      IF
     C                     MOVEL'A'       WLVSST           Record Status
     C                     Z-ADD##JTM     WLAATM           Job Time
     C                     MOVEL##USR     WLAYNA           User Id
     C                     MOVEL##PGM     WLA0NA           Job Name
     C                     Z-ADD##JDT     WLAXDT           Job Date
     C                     MOVEL'N'       WLB5ST           PS Lock Status
     C           KLCRSP    KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLV5ST           Production Type
     C                     KFLD           WLELDT           Production Date
     C                     KFLD           WLHGCD           Item Code
     C                     KFLD           WLAJCD           Warehouse Code
      * Check for duplicate primary key
     C           KLCRSP    SETLL@I8CPUR                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1764' W0RTN   7
      * Send message 'PS Prod Item Schedule  EX'
     C                     MOVEL'USR1764' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C                     WRITE@I8CPUR                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WMAIC3           Company Number
     C                     KFLD           WMHGCD           Item Code
      * Setup key
     C                     Z-ADDWLAIC3    WMAIC3           Company Number
     C                     Z-ADDWLHGCD    WMHGCD           Item Code
      * Establish starting position
     C           KRSSQ     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAVNA           Description Lin
     C                     MOVEL*BLANK    WUADCD           U/M - Primary
     C                     Z-ADD*ZERO     WUAIWG           Unit Weight
     C                     Z-ADD*ZERO     WLRINB           Item Structure
     C                     Z-ADD*ZERO     WLRHNB           Item Structure
     C                     Z-ADD*ZERO     WLRGNB           Item Structure
     C                     MOVEL*BLANK    WUN0CD           Item Type Code
     C                     MOVEL*BLANK    WUQ1CD           Default Warehou
     C                     Z-ADD*ZERO     WUCHTM           Fresh Chilling
     C                     MOVEL*BLANK    WUQZCD           Base/Conv/Loss
     C                     MOVEL*BLANK    WUXWST           Variety/Rendere
     C                     MOVEL*BLANK    WUVMST           Credit Item Sta
     C                     Z-ADD*ZERO     WUSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WUPPHE           Pieces Per Head
     C                     MOVEL*BLANK    WLR3CD           Department Code
     C                     MOVEL*BLANK    WUSDCD           Group for Packa
     C                     MOVEL*BLANK    WUX5ST           Seconds Item
     C                     MOVEL*BLANK    WLTHST           Piece Count Ite
     C                     Z-ADD*ZERO     WUBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WUBJNB           Bags Per Unit
     C                     MOVEL*BLANK    WLTFST           Export/Domestic
     C                     MOVEL*BLANK    WLTEST           Print On Schedu
     C                     MOVEL*BLANK    WUSYST           Fresh Inv Alloc
     C                     MOVEL*BLANK    WUSZST           Fresh Sched As
     C                     MOVEL*BLANK    WUS1ST           Frozen Inv Allo
     C                     MOVEL*BLANK    WLXRCD           Primal Group Co
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWMAVNA    WUAVNA           Description Lin
     C                     MOVELWMADCD    WUADCD           U/M - Primary
     C                     Z-ADDWMAIWG    WUAIWG           Unit Weight
     C                     Z-ADDWMRINB    WLRINB           Item Structure
     C                     Z-ADDWMRHNB    WLRHNB           Item Structure
     C                     Z-ADDWMRGNB    WLRGNB           Item Structure
     C                     MOVELWMN0CD    WUN0CD           Item Type Code
     C                     MOVELWMQ1CD    WUQ1CD           Default Warehou
     C                     Z-ADDWMCHTM    WUCHTM           Fresh Chilling
     C                     MOVELWMQZCD    WUQZCD           Base/Conv/Loss
     C                     MOVELWMXWST    WUXWST           Variety/Rendere
     C                     MOVELWMVMST    WUVMST           Credit Item Sta
     C                     Z-ADDWMSWGH    WUSWGH           Std Weight/Head
     C                     Z-ADDWMPPHE    WUPPHE           Pieces Per Head
     C                     MOVELWMR3CD    WLR3CD           Department Code
     C                     MOVELWMSDCD    WUSDCD           Group for Packa
     C                     MOVELWMX5ST    WUX5ST           Seconds Item
     C                     MOVELWMPCCT    WLTHST           Piece Count Ite
     C                     Z-ADDWMBDNB    WUBDNB           Pieces Per Bag
     C                     Z-ADDWMBJNB    WUBJNB           Bags Per Unit
     C                     MOVELWMSUST    WLTFST           Export/Domestic
     C                     MOVELWMSVST    WLTEST           Print On Schedu
     C                     MOVELWMSYST    WUSYST           Fresh Inv Alloc
     C                     MOVELWMSZST    WUSZST           Fresh Sched As
     C                     MOVELWMS1ST    WUS1ST           Frozen Inv Allo
     C                     MOVELWMXRCD    WLXRCD           Primal Group Co
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * BPS Rtv Whs Info      RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WOAJCD           Warehouse Code
      * Setup key
     C                     MOVELWLAJCD    WOAJCD           Warehouse Code
      * Establish starting position
     C           KRSSR     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WLWPST           Warehouse Type
     C                     MOVEL*BLANK    WUXUST           Trans Contol AS
     C                     MOVEL*BLANK    WUT0ST           Warehouse Locat
     C                     MOVEL*BLANK    WUT1ST           Warehouse Std C
     C                     Z-ADD*ZERO     WUDBNB           Warehouse Chill
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWOWPST    WLWPST           Warehouse Type
     C                     MOVELWOXUST    WUXUST           Trans Contol AS
     C                     MOVELWOT0ST    WUT0ST           Warehouse Locat
     C                     MOVELWOT1ST    WUT1ST           Warehouse Std C
     C                     Z-ADDWODBNB    WUDBNB           Warehouse Chill
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv Productin Whs     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WRAJCD           Warehouse Code
      * Setup key
     C                     MOVELWLAJCD    WRAJCD           Warehouse Code
      * Establish starting position
     C           KRSSS     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WLB7ST           Production Ware
     C                     Z-ADD*ZERO     YL0010           Accounting Comp
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWRAOCD    WLB7ST           Production Ware
     C                     Z-ADDWRBTC3    YL0010           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQST01           Company Number
      * Define keylist
     C           KPSST     KLIST
     C                     KFLD           WQST01           Company Number
     C                     KFLD           WEBCDT           Post to G/L Dat
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           Company Number
      * Setup key
     C                     Z-ADDWL0127    WQST01           Company Number
     C                     Z-ADDWL0128    WEBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSST     SETLL@AFREBE                    *
     C           KRSST     READE@AFREBE                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.Count USR EQ PAR.Chilling Time
     C           WUCNTU    IFEQ WL0129                     *IF
     C                     Z-ADDWEBCDT    WL0130           PS Available Sh
     C                     GOTO STEXIT                     *QUIT
     C                     END                             *FI
      * Skip Saturday
      * CASE: DB1.Day of Week is Saturday
     C           WEA9ST    IFEQ '7'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C           KRSST     READE@AFREBE                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCHRC    BEGSR
      *================================================================
      * Chg Prod Whse Txfr    CH - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0135  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0136  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0137  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0138  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0139  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0140  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0141  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0142  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0143  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0144  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0145  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0146  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0147  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0148  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0149  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0150  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0151  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0152  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0153  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0154  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0155  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0156  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0157 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0158  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0159 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0160  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0161 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0162  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0163 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0164  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0165 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0166  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0167  3        PS Item Id
     C                     MOVEL*BLANK    WN0168  2        Warehouse Type
     C                     MOVEL*BLANK    WN0169  1        PS Lock Status
     C                     MOVEL*BLANK    WN0170  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0171  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0172  1        PS Piece Count
     C                     MOVEL*BLANK    WN0173  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0174  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0175  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0176  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0177  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0178  3        PS Production W
     C                     Z-ADD*ZERO     WN0179  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0180  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0181  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0182  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0183  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0184  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0185  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0186  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0187  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0188  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0189  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0190  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0191  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0192  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0193  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0194  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0195  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0196  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0197  6        Department Code
     C                     Z-ADD*ZERO     WN0198  30       Item Structure
     C                     Z-ADD*ZERO     WN0199  30       Item Structure
     C                     Z-ADD*ZERO     WN0200  30       Item Structure
     C                     MOVEL*BLANK    WN0201  6        Primal Group Co
     C                     MOVEL*BLANK    WN0202  1        EDI Status 1
     C                     MOVEL*BLANK    WN0203  1        EDI Status 2
     C                     MOVEL*BLANK    WN0204  1        EDI Status 3
     C                     MOVEL*BLANK    WN0205  1        Record Status
     C                     Z-ADD*ZERO     WN0206  60       Job Time
     C                     MOVEL*BLANK    WN0207 10        User Id
     C                     MOVEL*BLANK    WN0208 10        Job Name
     C                     Z-ADD*ZERO     WN0209  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @I8CPUR
     C                     Z-ADDWHAIC3    WLAIC3           Company Number
     C                     MOVELWHV5ST    WLV5ST    P      Production Type
     C                     Z-ADDWHELDT    WLELDT           Production Date
     C                     Z-ADDWHHGCD    WLHGCD           Item Code
     C                     MOVELWHAJCD    WLAJCD    P      Warehouse Code
      *
     C           KLCHSU    KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLV5ST           Production Type
     C                     KFLD           WLELDT           Production Date
     C                     KFLD           WLHGCD           Item Code
     C                     KFLD           WLAJCD           Warehouse Code
     C           KLCHSU    CHAIN@I8CPUR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDI81    YBRDCS
      * Move non-key fields to @I8CPUR
     C                     Z-ADDWHF8WG    WLF8WG           PS Avg Piece Wg
     C                     Z-ADDWN0080    WLBPNB           PS Pieces Whse
     C                     Z-ADDWN0081    WLGAWG           PS Weight Whse
      *
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * UPS CHGOBJ Stamp      IF
     C                     Z-ADD##JTM     WLAATM           Job Time
     C                     MOVEL##USR     WLAYNA           User Id
     C                     MOVEL##PGM     WLA0NA           Job Name
     C                     Z-ADD##JDT     WLAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@I8CPUR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDI8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * BPS Upd Pcs/Wgt Std   RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0210  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0211  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0212  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0213  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0214  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0215  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0216  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0217  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0218  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0219  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0220  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0221  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0222  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0223  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0224  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0225  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0226  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0227  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0228  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0229  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0230  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0231  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0232  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0233 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0234  70       PS Pieces Whse
     C                     Z-ADD*ZERO     WN0235 112       PS Weight Whse
     C                     Z-ADD*ZERO     WN0236  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0237 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0238  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0239 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0240  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0241 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0242  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0243 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0244  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0245  3        PS Item Id
     C                     MOVEL*BLANK    WN0246  2        Warehouse Type
     C                     MOVEL*BLANK    WN0247  1        PS Lock Status
     C                     MOVEL*BLANK    WN0248  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0249  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0250  1        PS Piece Count
     C                     MOVEL*BLANK    WN0251  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0252  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0253  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0254  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0255  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0256  3        PS Production W
     C                     Z-ADD*ZERO     WN0257  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0258  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0259  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0260  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0261  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0262  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0263  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0264  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0265  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0266  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0267  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0268  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0269  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0270  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0271  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0272  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0273  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0274  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0275  6        Department Code
     C                     Z-ADD*ZERO     WN0276  30       Item Structure
     C                     Z-ADD*ZERO     WN0277  30       Item Structure
     C                     Z-ADD*ZERO     WN0278  30       Item Structure
     C                     MOVEL*BLANK    WN0279  6        Primal Group Co
     C                     MOVEL*BLANK    WN0280  1        EDI Status 1
     C                     MOVEL*BLANK    WN0281  1        EDI Status 2
     C                     MOVEL*BLANK    WN0282  1        EDI Status 3
     C                     MOVEL*BLANK    WN0283  1        Record Status
     C                     Z-ADD*ZERO     WN0284  60       Job Time
     C                     MOVEL*BLANK    WN0285 10        User Id
     C                     MOVEL*BLANK    WN0286 10        Job Name
     C                     Z-ADD*ZERO     WN0287  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHV5ST           Production Type
     C                     KFLD           WHELDT           Production Date
     C                     KFLD           WHHGCD           Item Code
     C                     KFLD           WHAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0131    WHAIC3           Company Number
     C                     MOVELWL0132    WHV5ST           Production Type
     C                     Z-ADDWL0133    WHELDT           Production Date
     C                     Z-ADDWL0134    WHHGCD           Item Code
     C                     MOVELWL0135    WHAJCD           Warehouse Code
      * Establish starting position
     C           KRSSV     CHAIN@I8CPUS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADDWL0137    WN0217           PS Weight Stand
     C                     Z-ADDWL0136    WN0218           PS Pieces Stand
      * Average Piece Weight
      * CASE: PAR.PS Pieces Standard is NE Zeros
     C           WN0218    IFNE 0                          *IF
      * FP1054 RMC 5/14/09 chg above CASE to ne 0 , it was gt 0
      * Avg Piece Weight
      * PAR.PS Avg Piece Wgt =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Standard
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Pieces Standard
     C           WN0217    DIV  WN0218    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0214           PS Avg Piece Wg
      * FP1054 RMC 5/14/09 make positive if negative
      * CASE: PAR.PS Avg Piece Wgt is LT Zero
     C           WN0214    IFLT 0                          *IF
     C                     MULT -1        WN0214           PS Avg Piece Wg
     C                     END                             *FI
     C                     END                             *FI
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.PS Weight Standard is NE Zero
      *   |- c2    : PAR.PS Pieces Standard is NE Zeros
      *   '-
     C           WN0217    IFNE 0                          *IF
     C           WN0218    ORNE 0                          *OR
      * FP1054 RMC 5/14/09 chg above CASE to ne 0 , it was gt 0
      * UPS Crt Prod Detail   CR - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0131    WL0044           Company Number
     C                     MOVELWL0132    WL0045    P      Production Type
     C                     Z-ADDWL0133    WL0046           Production Date
     C                     Z-ADDWL0134    WL0047           Item Code
     C                     MOVELWL0135    WL0048    P      Warehouse Code
     C                     Z-ADDWN0210    WL0049           PS Available Sh
     C                     Z-ADDWN0211    WL0050           PS Weight Plann
     C                     Z-ADDWN0212    WL0051           PS Pieces Plann
     C                     Z-ADDWN0213    WL0052           PS % of Carcass
     C                     Z-ADDWN0214    WL0053           PS Avg Piece Wg
     C                     Z-ADDWN0215    WL0054           PS Weight Inv O
     C                     Z-ADDWN0216    WL0055           PS Pieces Inv O
     C                     Z-ADDWN0217    WL0056           PS Weight Stand
     C                     Z-ADDWN0218    WL0057           PS Pieces Stand
     C                     Z-ADDWN0219    WL0058           PS Weight Conve
     C                     Z-ADDWN0220    WL0059           PS Pieces Conve
     C                     Z-ADDWN0221    WL0060           PS Weight Shipp
     C                     Z-ADDWN0222    WL0061           PS Pieces Shipp
     C                     Z-ADDWN0223    WL0062           PS Weight Prod
     C                     Z-ADDWN0224    WL0063           PS Pieces Prod
     C                     Z-ADDWN0225    WL0064           PS Weight Inv A
     C                     Z-ADDWN0226    WL0065           PS Pieces Inv A
     C                     Z-ADDWN0227    WL0066           PS Weight Ship
     C                     Z-ADDWN0228    WL0067           PS Pieces Ship
     C                     Z-ADDWN0229    WL0068           PS Weight Prod
     C                     Z-ADDWN0230    WL0069           PS Pieces Prod
     C                     Z-ADDWN0231    WL0070           PS Weight Inv A
     C                     Z-ADDWN0232    WL0071           PS Pieces Inv A
     C                     Z-ADDWN0233    WL0072           PS Unit Weight
     C                     Z-ADDWN0234    WL0073           PS Pieces Whse
     C                     Z-ADDWN0235    WL0074           PS Weight Whse
     C                     Z-ADDWN0236    WL0075           PS Pieces Unuse
     C                     Z-ADDWN0237    WL0076           PS Weight Unuse
     C                     Z-ADDWN0238    WL0077           PS Pieces Unuse
     C                     Z-ADDWN0239    WL0078           PS Weight Unuse
     C                     Z-ADDWN0240    WL0079           PS Pieces Unuse
     C                     Z-ADDWN0241    WL0080           PS Weight Unuse
     C                     Z-ADDWN0242    WL0081           PS Pieces Unuse
     C                     Z-ADDWN0243    WL0082           PS Weight Unuse
     C                     Z-ADDWN0244    WL0083           PS Pieces Unuse
     C                     MOVELWN0245    WL0084    P      PS Item Id
     C                     MOVELWN0246    WL0085    P      Warehouse Type
     C                     MOVELWN0247    WL0086    P      PS Lock Status
     C                     MOVELWN0248    WL0087    P      PS Export/Domes
     C                     MOVELWN0249    WL0088    P      PS Print On Sch
     C                     MOVELWN0250    WL0089    P      PS Piece Count
     C                     MOVELWN0251    WL0090    P      PS Unused Sts 1
     C                     MOVELWN0252    WL0091    P      PS Unused Sts 2
     C                     MOVELWN0253    WL0092    P      PS Unused Sts 3
     C                     MOVELWN0254    WL0093    P      PS Unused Sts 4
     C                     MOVELWN0255    WL0094    P      PS Item Sched N
     C                     MOVELWN0256    WL0095    P      PS Production W
     C                     Z-ADDWN0257    WL0096           PS Weight Order
     C                     Z-ADDWN0258    WL0097           PS Pieces Order
     C                     Z-ADDWN0259    WL0098           PS Weight FC Ad
     C                     Z-ADDWN0260    WL0099           PS Pieces FC Ad
     C                     Z-ADDWN0261    WL0100           PS Weight FX Ad
     C                     Z-ADDWN0262    WL0101           PS Pieces FX Ad
     C                     Z-ADDWN0263    WL0102           PS Weight Sched
     C                     Z-ADDWN0264    WL0103           PS Pieces Sched
     C                     Z-ADDWN0265    WL0104           PS Weight Avail
     C                     Z-ADDWN0266    WL0105           PS Pieces Avail
     C                     Z-ADDWN0267    WL0106           PS Weight Produ
     C                     Z-ADDWN0268    WL0107           PS Pieces Produ
     C                     Z-ADDWN0269    WL0108           PS Weight Fab N
     C                     Z-ADDWN0270    WL0109           PS Pieces Fab N
     C                     Z-ADDWN0271    WL0110           PS Weight Sched
     C                     Z-ADDWN0272    WL0111           PS Pieces Sched
     C                     Z-ADDWN0273    WL0112           PS Weight Sched
     C                     Z-ADDWN0274    WL0113           PS Pieces Sched
     C                     MOVELWN0275    WL0114    P      Department Code
     C                     Z-ADDWN0276    WL0115           Item Structure
     C                     Z-ADDWN0277    WL0116           Item Structure
     C                     Z-ADDWN0278    WL0117           Item Structure
     C                     MOVELWN0279    WL0118    P      Primal Group Co
     C                     MOVELWN0280    WL0119    P      EDI Status 1
     C                     MOVELWN0281    WL0120    P      EDI Status 2
     C                     MOVELWN0282    WL0121    P      EDI Status 3
     C                     MOVELWN0283    WL0122    P      Record Status
     C                     Z-ADDWN0284    WL0123           Job Time
     C                     MOVELWN0285    WL0124    P      User Id
     C                     MOVELWN0286    WL0125    P      Job Name
     C                     Z-ADDWN0287    WL0126           Job Date
     C                     EXSR SPCRRC
     C                     END                             *FI
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WHDXWG    ADD  WL0137    WN0217           PS Weight Stand
     C           WHB2NB    ADD  WL0136    WN0218           PS Pieces Stand
      * Average Piece Weight
      * CASE: PAR.PS Pieces Standard is NE Zeros
     C           WN0218    IFNE 0                          *IF
      * FP1054 RMC 5/14/09 chg above CASE to ne 0 , it was gt 0
      * Avg Piece Weight
      * PAR.PS Avg Piece Wgt =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Standard
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Pieces Standard
     C           WN0217    DIV  WN0218    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0214           PS Avg Piece Wg
      * FP1054 RMC 5/14/09 make positive if negative
      * CASE: PAR.PS Avg Piece Wgt is LT Zero
     C           WN0214    IFLT 0                          *IF
     C                     MULT -1        WN0214           PS Avg Piece Wg
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 RMC 5/14/09 dont do below case - they may be negative now
      * BPS Chg Pcs/Wgt Std   CH - PS Prod Item Schedule  * 
     C                     EXSR SWCHRC
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWCHRC    BEGSR
      *================================================================
      * BPS Chg Pcs/Wgt Std   CH - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0288  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0289  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0290  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0291  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0292  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0293  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0294  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0295  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0296  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0297  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0298  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0299  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0300  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0301  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0302  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0303  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0304  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0305  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0306  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0307  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0308 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0309  70       PS Pieces Whse
     C                     Z-ADD*ZERO     WN0310 112       PS Weight Whse
     C                     Z-ADD*ZERO     WN0311  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0312 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0313  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0314 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0315  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0316 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0317  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0318 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0319  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0320  3        PS Item Id
     C                     MOVEL*BLANK    WN0321  2        Warehouse Type
     C                     MOVEL*BLANK    WN0322  1        PS Lock Status
     C                     MOVEL*BLANK    WN0323  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0324  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0325  1        PS Piece Count
     C                     MOVEL*BLANK    WN0326  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0327  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0328  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0329  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0330  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0331  3        PS Production W
     C                     Z-ADD*ZERO     WN0332  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0333  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0334  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0335  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0336  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0337  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0338  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0339  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0340  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0341  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0342  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0343  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0344  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0345  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0346  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0347  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0348  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0349  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0350  6        Department Code
     C                     Z-ADD*ZERO     WN0351  30       Item Structure
     C                     Z-ADD*ZERO     WN0352  30       Item Structure
     C                     Z-ADD*ZERO     WN0353  30       Item Structure
     C                     MOVEL*BLANK    WN0354  6        Primal Group Co
     C                     MOVEL*BLANK    WN0355  1        EDI Status 1
     C                     MOVEL*BLANK    WN0356  1        EDI Status 2
     C                     MOVEL*BLANK    WN0357  1        EDI Status 3
     C                     MOVEL*BLANK    WN0358  1        Record Status
     C                     Z-ADD*ZERO     WN0359  60       Job Time
     C                     MOVEL*BLANK    WN0360 10        User Id
     C                     MOVEL*BLANK    WN0361 10        Job Name
     C                     Z-ADD*ZERO     WN0362  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @I8CPUR
     C                     Z-ADDWHAIC3    WLAIC3           Company Number
     C                     MOVELWHV5ST    WLV5ST    P      Production Type
     C                     Z-ADDWHELDT    WLELDT           Production Date
     C                     Z-ADDWHHGCD    WLHGCD           Item Code
     C                     MOVELWHAJCD    WLAJCD    P      Warehouse Code
      *
     C           KLCHSW    KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLV5ST           Production Type
     C                     KFLD           WLELDT           Production Date
     C                     KFLD           WLHGCD           Item Code
     C                     KFLD           WLAJCD           Warehouse Code
     C           KLCHSW    CHAIN@I8CPUR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SWEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDI81    YCRDCS
      * Move non-key fields to @I8CPUR
     C                     Z-ADDWN0214    WLF8WG           PS Avg Piece Wg
     C                     Z-ADDWN0217    WLDXWG           PS Weight Stand
     C                     Z-ADDWN0218    WLB2NB           PS Pieces Stand
      *
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@I8CPUR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDI8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0363  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0364  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0365  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0366  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0367  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0368  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0369  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0370  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0371  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0372  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0373  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0374  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0375  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0376  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0377  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0378  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0379  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0380  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0381  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0382  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0383  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0384  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0385  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0386 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0387  70       PS Pieces Whse
     C                     Z-ADD*ZERO     WN0388 112       PS Weight Whse
     C                     Z-ADD*ZERO     WN0389  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0390 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0391  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0392 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0393  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0394 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0395  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0396 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0397  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0398  3        PS Item Id
     C                     MOVEL*BLANK    WN0399  2        Warehouse Type
     C                     MOVEL*BLANK    WN0400  1        PS Lock Status
     C                     MOVEL*BLANK    WN0401  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0402  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0403  1        PS Piece Count
     C                     MOVEL*BLANK    WN0404  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0405  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0406  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0407  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0408  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0409  3        PS Production W
     C                     Z-ADD*ZERO     WN0410  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0411  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0412  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0413  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0414  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0415  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0416  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0417  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0418  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0419  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0420  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0421  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0422  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0423  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0424  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0425  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0426  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0427  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0428  6        Department Code
     C                     Z-ADD*ZERO     WN0429  30       Item Structure
     C                     Z-ADD*ZERO     WN0430  30       Item Structure
     C                     Z-ADD*ZERO     WN0431  30       Item Structure
     C                     MOVEL*BLANK    WN0432  6        Primal Group Co
     C                     MOVEL*BLANK    WN0433  1        EDI Status 1
     C                     MOVEL*BLANK    WN0434  1        EDI Status 2
     C                     MOVEL*BLANK    WN0435  1        EDI Status 3
     C                     MOVEL*BLANK    WN0436  1        Record Status
     C                     Z-ADD*ZERO     WN0437  60       Job Time
     C                     MOVEL*BLANK    WN0438 10        User Id
     C                     MOVEL*BLANK    WN0439 10        Job Name
     C                     Z-ADD*ZERO     WN0440  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHV5ST           Production Type
     C                     KFLD           WHELDT           Production Date
     C                     KFLD           WHHGCD           Item Code
     C                     KFLD           WHAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0138    WHAIC3           Company Number
     C                     MOVELWL0139    WHV5ST           Production Type
     C                     Z-ADDWL0140    WHELDT           Production Date
     C                     Z-ADDWL0141    WHHGCD           Item Code
     C                     MOVELWL0142    WHAJCD           Warehouse Code
      * Establish starting position
     C           KRSSX     CHAIN@I8CPUS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADDWL0143    WN0382           PS Weight Prod
     C                     Z-ADDWL0144    WN0383           PS Pieces Prod
      * CASE: PAR.PS Pieces Prod Allocated is GT Zero
     C           WN0383    IFGT 0                          *IF
      * Average Piece Weight
      * PAR.PS Avg Piece Wgt =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Prod Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Pieces Prod Allocated
     C           WN0382    DIV  WN0383    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0367           PS Avg Piece Wg
     C                     END                             *FI
      * UPS Crt Prod Detail   CR - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0138    WL0044           Company Number
     C                     MOVELWL0139    WL0045    P      Production Type
     C                     Z-ADDWL0140    WL0046           Production Date
     C                     Z-ADDWL0141    WL0047           Item Code
     C                     MOVELWL0142    WL0048    P      Warehouse Code
     C                     Z-ADDWN0363    WL0049           PS Available Sh
     C                     Z-ADDWN0364    WL0050           PS Weight Plann
     C                     Z-ADDWN0365    WL0051           PS Pieces Plann
     C                     Z-ADDWN0366    WL0052           PS % of Carcass
     C                     Z-ADDWN0367    WL0053           PS Avg Piece Wg
     C                     Z-ADDWN0368    WL0054           PS Weight Inv O
     C                     Z-ADDWN0369    WL0055           PS Pieces Inv O
     C                     Z-ADDWN0370    WL0056           PS Weight Stand
     C                     Z-ADDWN0371    WL0057           PS Pieces Stand
     C                     Z-ADDWN0372    WL0058           PS Weight Conve
     C                     Z-ADDWN0373    WL0059           PS Pieces Conve
     C                     Z-ADDWN0374    WL0060           PS Weight Shipp
     C                     Z-ADDWN0375    WL0061           PS Pieces Shipp
     C                     Z-ADDWN0376    WL0062           PS Weight Prod
     C                     Z-ADDWN0377    WL0063           PS Pieces Prod
     C                     Z-ADDWN0378    WL0064           PS Weight Inv A
     C                     Z-ADDWN0379    WL0065           PS Pieces Inv A
     C                     Z-ADDWN0380    WL0066           PS Weight Ship
     C                     Z-ADDWN0381    WL0067           PS Pieces Ship
     C                     Z-ADDWN0382    WL0068           PS Weight Prod
     C                     Z-ADDWN0383    WL0069           PS Pieces Prod
     C                     Z-ADDWN0384    WL0070           PS Weight Inv A
     C                     Z-ADDWN0385    WL0071           PS Pieces Inv A
     C                     Z-ADDWN0386    WL0072           PS Unit Weight
     C                     Z-ADDWN0387    WL0073           PS Pieces Whse
     C                     Z-ADDWN0388    WL0074           PS Weight Whse
     C                     Z-ADDWN0389    WL0075           PS Pieces Unuse
     C                     Z-ADDWN0390    WL0076           PS Weight Unuse
     C                     Z-ADDWN0391    WL0077           PS Pieces Unuse
     C                     Z-ADDWN0392    WL0078           PS Weight Unuse
     C                     Z-ADDWN0393    WL0079           PS Pieces Unuse
     C                     Z-ADDWN0394    WL0080           PS Weight Unuse
     C                     Z-ADDWN0395    WL0081           PS Pieces Unuse
     C                     Z-ADDWN0396    WL0082           PS Weight Unuse
     C                     Z-ADDWN0397    WL0083           PS Pieces Unuse
     C                     MOVELWN0398    WL0084    P      PS Item Id
     C                     MOVELWN0399    WL0085    P      Warehouse Type
     C                     MOVELWN0400    WL0086    P      PS Lock Status
     C                     MOVELWN0401    WL0087    P      PS Export/Domes
     C                     MOVELWN0402    WL0088    P      PS Print On Sch
     C                     MOVELWN0403    WL0089    P      PS Piece Count
     C                     MOVELWN0404    WL0090    P      PS Unused Sts 1
     C                     MOVELWN0405    WL0091    P      PS Unused Sts 2
     C                     MOVELWN0406    WL0092    P      PS Unused Sts 3
     C                     MOVELWN0407    WL0093    P      PS Unused Sts 4
     C                     MOVELWN0408    WL0094    P      PS Item Sched N
     C                     MOVELWN0409    WL0095    P      PS Production W
     C                     Z-ADDWN0410    WL0096           PS Weight Order
     C                     Z-ADDWN0411    WL0097           PS Pieces Order
     C                     Z-ADDWN0412    WL0098           PS Weight FC Ad
     C                     Z-ADDWN0413    WL0099           PS Pieces FC Ad
     C                     Z-ADDWN0414    WL0100           PS Weight FX Ad
     C                     Z-ADDWN0415    WL0101           PS Pieces FX Ad
     C                     Z-ADDWN0416    WL0102           PS Weight Sched
     C                     Z-ADDWN0417    WL0103           PS Pieces Sched
     C                     Z-ADDWN0418    WL0104           PS Weight Avail
     C                     Z-ADDWN0419    WL0105           PS Pieces Avail
     C                     Z-ADDWN0420    WL0106           PS Weight Produ
     C                     Z-ADDWN0421    WL0107           PS Pieces Produ
     C                     Z-ADDWN0422    WL0108           PS Weight Fab N
     C                     Z-ADDWN0423    WL0109           PS Pieces Fab N
     C                     Z-ADDWN0424    WL0110           PS Weight Sched
     C                     Z-ADDWN0425    WL0111           PS Pieces Sched
     C                     Z-ADDWN0426    WL0112           PS Weight Sched
     C                     Z-ADDWN0427    WL0113           PS Pieces Sched
     C                     MOVELWN0428    WL0114    P      Department Code
     C                     Z-ADDWN0429    WL0115           Item Structure
     C                     Z-ADDWN0430    WL0116           Item Structure
     C                     Z-ADDWN0431    WL0117           Item Structure
     C                     MOVELWN0432    WL0118    P      Primal Group Co
     C                     MOVELWN0433    WL0119    P      EDI Status 1
     C                     MOVELWN0434    WL0120    P      EDI Status 2
     C                     MOVELWN0435    WL0121    P      EDI Status 3
     C                     MOVELWN0436    WL0122    P      Record Status
     C                     Z-ADDWN0437    WL0123           Job Time
     C                     MOVELWN0438    WL0124    P      User Id
     C                     MOVELWN0439    WL0125    P      Job Name
     C                     Z-ADDWN0440    WL0126           Job Date
     C                     EXSR SPCRRC
      * FP1054 create consumed records
      * Create/update/delete Order Detail Sched-Consmd (POB6CPP)
      * CASE: PAR.Order Number is Greater then zero
     C           WL0145    IFGT 0                          *IF
      * RMC 10-05 20 use ord co instead of par.company which is acctng
      * RTV Company for Ord   RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0145    WL0150           Order Number
     C                     EXSR SYRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0149    YL0011           Company Number
      * Rtv Next Seq for Ord/ItRT - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0011    WL0151           Company Number
     C                     Z-ADDWL0145    WL0152           Order Number
     C                     Z-ADDWL0146    WL0153           Order Sequence
     C                     Z-ADDWL0147    WL0154           Order Secondary
     C                     Z-ADDWL0140    WL0155           OD Production D
     C                     Z-ADDYL0012    WL0156           ODS Sequence Nu
     C                     Z-ADDWL0141    WL0157           Consumed Item C
     C                     Z-ADDWL0141    WL0158           Item Code
     C                     EXSR SZRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0156    YL0012           ODS Sequence Nu
      * CASE: LCL.ODS Sequence Number is zero
     C           YL0012    IFEQ 0                          *IF
      * Rtv Next Seq for Key  RT - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0011    WL0159           Company Number
     C                     Z-ADDWL0145    WL0160           Order Number
     C                     Z-ADDWL0146    WL0161           Order Sequence
     C                     Z-ADDWL0147    WL0162           Order Secondary
     C                     Z-ADDWL0140    WL0163           OD Production D
     C                     Z-ADDYL0012    WL0164           ODS Sequence Nu
     C                     EXSR TARVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0164    YL0012           ODS Sequence Nu
     C                     END                             *FI
      * Upd OrdDtl Sch-Consmd RT - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0011    WL0165           Company Number
     C                     Z-ADDWL0145    WL0166           Order Number
     C                     Z-ADDWL0146    WL0167           Order Sequence
     C                     Z-ADDWL0147    WL0168           Order Secondary
     C                     Z-ADDWL0140    WL0169           OD Production D
     C                     Z-ADDYL0012    WL0170           ODS Sequence Nu
     C                     Z-ADD0         WL0171           Scheduled Ship
     C                     MOVELWL0142    WL0172    P      Warehouse Code
     C                     Z-ADDWL0141    WL0173           Consumed Item C
     C                     Z-ADDWL0141    WL0174           Item Code
     C                     Z-ADDWL0144    WL0175           OD Qty/Cnsmd Pi
     C                     Z-ADDWL0143    WL0176           OD Weight Sched
     C                     Z-ADD0         WL0177           ODS Quantity Sh
     C                     Z-ADD0         WL0178           ODS Weight Shor
     C                     Z-ADD0         WL0179           Deadline Depart
     C                     Z-ADD0         WL0180           Deadline Depart
     C                     EXSR TBRVGN
     C                     END                             *FI
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WHOAWT    ADD  WL0143    WN0382           PS Weight Prod
     C           WHCDNB    ADD  WL0144    WN0383           PS Pieces Prod
      * Chg Prod Allocated    CH - PS Prod Item Schedule  * 
     C                     EXSR TFCHRC
      * FP1054 create/delete consumed records - if called from PRD routin
      *  and STD was allocated
      * CASE: PAR.Status Flag 19 Y/N is Yes
     C           WL0148    IFEQ 'Y'                        *IF
      * Create/update/delete Order Detail Sched-Consmd (POB6CPP)
      * CASE: PAR.Order Number is Greater then zero
     C           WL0145    IFGT 0                          *IF
      * RMC 10-05-2020 was par.company number which is acctng
      * RTV Company for Ord   RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0145    WL0150           Order Number
     C                     EXSR SYRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0149    YL0011           Company Number
      * Rtv Next Seq for Ord/ItRT - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0011    WL0151           Company Number
     C                     Z-ADDWL0145    WL0152           Order Number
     C                     Z-ADDWL0146    WL0153           Order Sequence
     C                     Z-ADDWL0147    WL0154           Order Secondary
     C                     Z-ADDWL0140    WL0155           OD Production D
     C                     Z-ADDYL0012    WL0156           ODS Sequence Nu
     C                     Z-ADDWL0141    WL0157           Consumed Item C
     C                     Z-ADDWL0141    WL0158           Item Code
     C                     EXSR SZRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0156    YL0012           ODS Sequence Nu
      * CASE: LCL.ODS Sequence Number is zero
     C           YL0012    IFEQ 0                          *IF
      * Rtv Next Seq for Key  RT - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0011    WL0159           Company Number
     C                     Z-ADDWL0145    WL0160           Order Number
     C                     Z-ADDWL0146    WL0161           Order Sequence
     C                     Z-ADDWL0147    WL0162           Order Secondary
     C                     Z-ADDWL0140    WL0163           OD Production D
     C                     Z-ADDYL0012    WL0164           ODS Sequence Nu
     C                     EXSR TARVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0164    YL0012           ODS Sequence Nu
     C                     END                             *FI
      * Upd OrdDtl Sch-Consmd RT - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0011    WL0165           Company Number
     C                     Z-ADDWL0145    WL0166           Order Number
     C                     Z-ADDWL0146    WL0167           Order Sequence
     C                     Z-ADDWL0147    WL0168           Order Secondary
     C                     Z-ADDWL0140    WL0169           OD Production D
     C                     Z-ADDYL0012    WL0170           ODS Sequence Nu
     C                     Z-ADD0         WL0171           Scheduled Ship
     C                     MOVELWL0142    WL0172    P      Warehouse Code
     C                     Z-ADDWL0141    WL0173           Consumed Item C
     C                     Z-ADDWL0141    WL0174           Item Code
     C                     Z-ADDWL0144    WL0175           OD Qty/Cnsmd Pi
     C                     Z-ADDWL0143    WL0176           OD Weight Sched
     C                     Z-ADD0         WL0177           ODS Quantity Sh
     C                     Z-ADD0         WL0178           ODS Weight Shor
     C                     Z-ADD0         WL0179           Deadline Depart
     C                     Z-ADD0         WL0180           Deadline Depart
     C                     EXSR TBRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * RTV Company for Ord   RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCC4NB    WQSY01           Order Number
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WQSY01           Order Number
      * Setup key
     C                     Z-ADDWL0150    WQSY01           Order Number
      * Establish starting position
     C           KRSSY     SETLL@BFCPY2                    *
     C           KRSSY     READE@BFCPY2                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCAIC3    WL0149           Company Number
     C           KRSSY     READE@BFCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * Rtv Next Seq for Ord/ItRT - Order Detail Sched-Consmd  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         WL0156           ODS Sequence Nu
      * Declare restrictor key work fields
     C           *LIKE     DEFN WSAIC3    WQSZ01           Company Number
     C           *LIKE     DEFN WSC4NB    WQSZ02           Order Number
     C           *LIKE     DEFN WSDPNB    WQSZ03           Order Sequence
     C           *LIKE     DEFN WSUENB    WQSZ04           Order Secondary
     C           *LIKE     DEFN WSJGDT    WQSZ05           OD Production D
     C           *LIKE     DEFN WSNUDT    WQSZ06           Consumed Item C
     C           *LIKE     DEFN WSHGCD    WQSZ07           Item Code
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WQSZ01           Company Number
     C                     KFLD           WQSZ02           Order Number
     C                     KFLD           WQSZ03           Order Sequence
     C                     KFLD           WQSZ04           Order Secondary
     C                     KFLD           WQSZ05           OD Production D
     C                     KFLD           WQSZ06           Consumed Item C
     C                     KFLD           WQSZ07           Item Code
      * Setup key
     C                     Z-ADDWL0151    WQSZ01           Company Number
     C                     Z-ADDWL0152    WQSZ02           Order Number
     C                     Z-ADDWL0153    WQSZ03           Order Sequence
     C                     Z-ADDWL0154    WQSZ04           Order Secondary
     C                     Z-ADDWL0155    WQSZ05           OD Production D
     C                     Z-ADDWL0157    WQSZ06           Consumed Item C
     C                     Z-ADDWL0158    WQSZ07           Item Code
      * Establish starting position
     C           KRSSZ     SETLL@B6CPAG                    *
     C           KRSSZ     READE@B6CPAG                  90*
      * Data record not found
     C   90                MOVEL'USR3152' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWSOONY    WL0156           ODS Sequence Nu
     C           KRSSZ     READE@B6CPAG                  90*
     C                     ENDDO
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * Rtv Next Seq for Key  RT - Order Detail Sched-Consmd  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         WL0164           ODS Sequence Nu
      * Declare restrictor key work fields
     C           *LIKE     DEFN WTAIC3    WQTA01           Company Number
     C           *LIKE     DEFN WTC4NB    WQTA02           Order Number
     C           *LIKE     DEFN WTDPNB    WQTA03           Order Sequence
     C           *LIKE     DEFN WTUENB    WQTA04           Order Secondary
     C           *LIKE     DEFN WTJGDT    WQTA05           OD Production D
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA01           Company Number
     C                     KFLD           WQTA02           Order Number
     C                     KFLD           WQTA03           Order Sequence
     C                     KFLD           WQTA04           Order Secondary
     C                     KFLD           WQTA05           OD Production D
      * Setup key
     C                     Z-ADDWL0159    WQTA01           Company Number
     C                     Z-ADDWL0160    WQTA02           Order Number
     C                     Z-ADDWL0161    WQTA03           Order Sequence
     C                     Z-ADDWL0162    WQTA04           Order Secondary
     C                     Z-ADDWL0163    WQTA05           OD Production D
      * Establish starting position
     C           KRSTA     SETLL@B6CPNB                    *
     C           KRSTA     READE@B6CPNB                  90*
      * Data record not found
     C   90                MOVEL'USR3152' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWTOONY    WL0164           ODS Sequence Nu
     C           KRSTA     READE@B6CPNB                  90*
     C                     ENDDO
      * USER: Exit processing
     C                     ADD  1         WL0164           ODS Sequence Nu
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * Upd OrdDtl Sch-Consmd RT - Order Detail Sched-Consmd  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0441  1        EDI Status 1
     C                     MOVEL*BLANK    WN0442  1        EDI Status 2
     C                     MOVEL*BLANK    WN0443  1        EDI Status 3
     C                     MOVEL*BLANK    WN0444  1        Record Status
     C                     Z-ADD*ZERO     WN0445  60       Job Time
     C                     MOVEL*BLANK    WN0446 10        User Id
     C                     MOVEL*BLANK    WN0447 10        Job Name
     C                     Z-ADD*ZERO     WN0448  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTC4NB           Order Number
     C                     KFLD           WTDPNB           Order Sequence
     C                     KFLD           WTUENB           Order Secondary
     C                     KFLD           WTJGDT           OD Production D
     C                     KFLD           WTOONY           ODS Sequence Nu
      * Setup key
     C                     Z-ADDWL0165    WTAIC3           Company Number
     C                     Z-ADDWL0166    WTC4NB           Order Number
     C                     Z-ADDWL0167    WTDPNB           Order Sequence
     C                     Z-ADDWL0168    WTUENB           Order Secondary
     C                     Z-ADDWL0169    WTJGDT           OD Production D
     C                     Z-ADDWL0170    WTOONY           ODS Sequence Nu
      * Establish starting position
     C           KRSTB     CHAIN@B6CPNB              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3152' W0RTN   7
      * USER: Processing if Data record not found
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.OD Pieces Scheduled is Greater than zero
      *   |- c2    : PAR.OD Weight Scheduled is Greater than zero
      *   '-
     C           WL0175    IFGT 0                          *IF
     C           WL0176    ORGT 0                          *OR
      * Crt OrdDtl Sch-Consmd CR - Order Detail Sched-Consmd  * 
     C                     EXSR TCCRRC
     C                     END                             *FI
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WTFLWG    ADD  WL0176    YL0013           OD Weight Sched
     C           WTIGQT    ADD  WL0175    YL0014           OD Qty/Cnsmd Pi
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.OD Pieces Scheduled is Less than or equal zero
      *   |- c2    : LCL.OD Weight Scheduled is Less than or equal zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0014    IFLE 0                          *IF
     C           YL0013    IFLE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Del OrdDtl Sch-Consmd DL - Order Detail Sched-Consmd  * 
     C                     EXSR TDDLRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg OrdDtl Sch-Consmd CH - Order Detail Sched-Consmd  * 
     C                     EXSR TECHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCCRRC    BEGSR
      *================================================================
      * Crt OrdDtl Sch-Consmd CR - Order Detail Sched-Consmd  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPNA
     C                     Z-ADDWL0165    WVAIC3           Company Number
     C                     Z-ADDWL0166    WVC4NB           Order Number
     C                     Z-ADDWL0167    WVDPNB           Order Sequence
     C                     Z-ADDWL0168    WVUENB           Order Secondary
     C                     Z-ADDWL0169    WVJGDT           OD Production D
     C                     Z-ADDWL0170    WVOONY           ODS Sequence Nu
     C                     Z-ADDWL0171    WVAODT           Scheduled Ship
     C                     MOVELWL0172    WVAJCD           Warehouse Code
     C                     Z-ADDWL0173    WVNUDT           Consumed Item C
     C                     Z-ADDWL0174    WVHGCD           Item Code
     C                     Z-ADDWL0175    WVIGQT           OD Qty/Cnsmd Pi
     C                     Z-ADDWL0176    WVFLWG           OD Weight Sched
     C                     Z-ADDWL0177    WVNSQT           ODS Quantity Sh
     C                     Z-ADDWL0178    WVJQWG           ODS Weight Shor
     C                     Z-ADDWL0179    WVNVDT           Deadline Depart
     C                     Z-ADDWL0180    WVBUTM           Deadline Depart
     C                     MOVELWN0441    WVUVST           EDI Status 1
     C                     MOVELWN0442    WVUWST           EDI Status 2
     C                     MOVELWN0443    WVUXST           EDI Status 3
     C                     MOVELWN0444    WVVSST           Record Status
     C                     Z-ADDWN0445    WVAATM           Job Time
     C                     MOVELWN0446    WVAYNA           User Id
     C                     MOVELWN0447    WVA0NA           Job Name
     C                     Z-ADDWN0448    WVAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WVVSST           Record Status
     C                     Z-ADD##JTM     WVAATM           Job Time
     C                     MOVEL##USR     WVAYNA           User Id
     C                     MOVEL##PGM     WVA0NA           Job Name
     C                     Z-ADD##JDT     WVAXDT           Job Date
     C           KLCRTC    KLIST
     C                     KFLD           WVAIC3           Company Number
     C                     KFLD           WVC4NB           Order Number
     C                     KFLD           WVDPNB           Order Sequence
     C                     KFLD           WVUENB           Order Secondary
     C                     KFLD           WVJGDT           OD Production D
     C                     KFLD           WVOONY           ODS Sequence Nu
      * Check for duplicate primary key
     C           KLCRTC    SETLL@B6CPNA                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3153' W0RTN   7
      * Send message 'Order Detail Sched-Con EX'
     C                     MOVEL'USR3153' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPNA                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDDLRC    BEGSR
      *================================================================
      * Del OrdDtl Sch-Consmd DL - Order Detail Sched-Consmd  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B6CPNA
     C                     Z-ADDWTAIC3    WVAIC3           Company Number
     C                     Z-ADDWTC4NB    WVC4NB           Order Number
     C                     Z-ADDWTDPNB    WVDPNB           Order Sequence
     C                     Z-ADDWTUENB    WVUENB           Order Secondary
     C                     Z-ADDWTJGDT    WVJGDT           OD Production D
     C                     Z-ADDWTOONY    WVOONY           ODS Sequence Nu
      *
     C           KLDLTD    KLIST
     C                     KFLD           WVAIC3           Company Number
     C                     KFLD           WVC4NB           Order Number
     C                     KFLD           WVDPNB           Order Sequence
     C                     KFLD           WVUENB           Order Secondary
     C                     KFLD           WVJGDT           OD Production D
     C                     KFLD           WVOONY           ODS Sequence Nu
     C           KLDLTD    CHAIN@B6CPNA              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POB6CPL0'MDACP
     C                     MOVEL'@B6CPNA' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TDEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B6CPNA                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TECHRC    BEGSR
      *================================================================
      * Chg OrdDtl Sch-Consmd CH - Order Detail Sched-Consmd  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0449  1        EDI Status 1
     C                     MOVEL*BLANK    WN0450  1        EDI Status 2
     C                     MOVEL*BLANK    WN0451  1        EDI Status 3
     C                     MOVEL*BLANK    WN0452  1        Record Status
     C                     Z-ADD*ZERO     WN0453  60       Job Time
     C                     MOVEL*BLANK    WN0454 10        User Id
     C                     MOVEL*BLANK    WN0455 10        Job Name
     C                     Z-ADD*ZERO     WN0456  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @B6CPNA
     C                     Z-ADDWTAIC3    WVAIC3           Company Number
     C                     Z-ADDWTC4NB    WVC4NB           Order Number
     C                     Z-ADDWTDPNB    WVDPNB           Order Sequence
     C                     Z-ADDWTUENB    WVUENB           Order Secondary
     C                     Z-ADDWTJGDT    WVJGDT           OD Production D
     C                     Z-ADDWTOONY    WVOONY           ODS Sequence Nu
      *
     C           KLCHTE    KLIST
     C                     KFLD           WVAIC3           Company Number
     C                     KFLD           WVC4NB           Order Number
     C                     KFLD           WVDPNB           Order Sequence
     C                     KFLD           WVUENB           Order Secondary
     C                     KFLD           WVJGDT           OD Production D
     C                     KFLD           WVOONY           ODS Sequence Nu
     C           KLCHTE    CHAIN@B6CPNA              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POB6CPL0'MDACP
     C                     MOVEL'@B6CPNA' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPOB61    YDRDCS
      * Move non-key fields to @B6CPNA
     C                     Z-ADDWL0171    WVAODT           Scheduled Ship
     C                     MOVELWL0172    WVAJCD    P      Warehouse Code
     C                     Z-ADDWL0173    WVNUDT           Consumed Item C
     C                     Z-ADDWL0174    WVHGCD           Item Code
     C                     Z-ADDYL0014    WVIGQT           OD Qty/Cnsmd Pi
     C                     Z-ADDYL0013    WVFLWG           OD Weight Sched
     C                     Z-ADDWTNSQT    WVNSQT           ODS Quantity Sh
     C                     Z-ADDWTJQWG    WVJQWG           ODS Weight Shor
     C                     Z-ADD0         WVNVDT           Deadline Depart
     C                     Z-ADD0         WVBUTM           Deadline Depart
      *
      * Set PGM.*Record Data Changed flag
     C           QPOB61    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WVAATM           Job Time
     C                     MOVEL##USR     WVAYNA           User Id
     C                     MOVEL##JOB     WVA0NA           Job Name
     C                     Z-ADD##JDT     WVAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPOB61    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@B6CPNA                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPOB6CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFCHRC    BEGSR
      *================================================================
      * Chg Prod Allocated    CH - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0457  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0458  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0459  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0460  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0461  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0462  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0463  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0464  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0465  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0466  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0467  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0468  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0469  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0470  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0471  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0472  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0473  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0474  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0475  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0476  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0477 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0478  70       PS Pieces Whse
     C                     Z-ADD*ZERO     WN0479 112       PS Weight Whse
     C                     Z-ADD*ZERO     WN0480  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0481 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0482  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0483 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0484  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0485 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0486  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0487 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0488  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0489  3        PS Item Id
     C                     MOVEL*BLANK    WN0490  2        Warehouse Type
     C                     MOVEL*BLANK    WN0491  1        PS Lock Status
     C                     MOVEL*BLANK    WN0492  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0493  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0494  1        PS Piece Count
     C                     MOVEL*BLANK    WN0495  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0496  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0497  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0498  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0499  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0500  3        PS Production W
     C                     Z-ADD*ZERO     WN0501  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0502  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0503  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0504  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0505  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0506  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0507  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0508  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0509  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0510  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0511  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0512  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0513  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0514  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0515  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0516  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0517  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0518  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0519  6        Department Code
     C                     Z-ADD*ZERO     WN0520  30       Item Structure
     C                     Z-ADD*ZERO     WN0521  30       Item Structure
     C                     Z-ADD*ZERO     WN0522  30       Item Structure
     C                     MOVEL*BLANK    WN0523  6        Primal Group Co
     C                     MOVEL*BLANK    WN0524  1        EDI Status 1
     C                     MOVEL*BLANK    WN0525  1        EDI Status 2
     C                     MOVEL*BLANK    WN0526  1        EDI Status 3
     C                     MOVEL*BLANK    WN0527  1        Record Status
     C                     Z-ADD*ZERO     WN0528  60       Job Time
     C                     MOVEL*BLANK    WN0529 10        User Id
     C                     MOVEL*BLANK    WN0530 10        Job Name
     C                     Z-ADD*ZERO     WN0531  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @I8CPUR
     C                     Z-ADDWHAIC3    WLAIC3           Company Number
     C                     MOVELWHV5ST    WLV5ST    P      Production Type
     C                     Z-ADDWHELDT    WLELDT           Production Date
     C                     Z-ADDWHHGCD    WLHGCD           Item Code
     C                     MOVELWHAJCD    WLAJCD    P      Warehouse Code
      *
     C           KLCHTF    KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLV5ST           Production Type
     C                     KFLD           WLELDT           Production Date
     C                     KFLD           WLHGCD           Item Code
     C                     KFLD           WLAJCD           Warehouse Code
     C           KLCHTF    CHAIN@I8CPUR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDI81    YERDCS
      * Move non-key fields to @I8CPUR
     C                     Z-ADDWHF8WG    WLF8WG           PS Avg Piece Wg
     C                     Z-ADDWN0382    WLOAWT           PS Weight Prod
     C                     Z-ADDWN0383    WLCDNB           PS Pieces Prod
      *
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * UPS CHGOBJ Stamp      IF
     C                     Z-ADD##JTM     WLAATM           Job Time
     C                     MOVEL##USR     WLAYNA           User Id
     C                     MOVEL##PGM     WLA0NA           Job Name
     C                     Z-ADD##JDT     WLAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@I8CPUR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDI8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * Clc Date (descending) RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WWAIC3    WQTG01           Company Number
      * Define keylist
     C           KPSTG     KLIST
     C                     KFLD           WQTG01           Company Number
     C                     KFLD           WWBCDT           Post to G/L Dat
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           WQTG01           Company Number
      * Setup key
     C                     Z-ADDWL0181    WQTG01           Company Number
     C                     Z-ADDWL0182    WWBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSTG     SETLL@AFREPU                    *
     C           KRSTG     READE@AFREPU                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Post to G/L Date EQ DB1.Post to G/L Date
     C           WL0182    IFEQ WWBCDT                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
      * CASE: WRK.Count USR EQ PAR.*Duration (factor)
     C           WUCNTU    IFEQ WL0185                     *IF
     C                     Z-ADDWWBCDT    WL0183           *Date1 (ending)
     C                     GOTO TGEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTG     READE@AFREPU                  90*
     C                     ENDDO
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * Clc Date (ascending)  RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQTH01           Company Number
      * Define keylist
     C           KPSTH     KLIST
     C                     KFLD           WQTH01           Company Number
     C                     KFLD           WFBCDT           Post to G/L Dat
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           WQTH01           Company Number
      * Setup key
     C                     Z-ADDWL0186    WQTH01           Company Number
     C                     Z-ADDWL0187    WFBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSTH     SETLL@AFREYY                    *
     C           KRSTH     READE@AFREYY                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Post to G/L Date EQ DB1.Post to G/L Date
     C           WL0187    IFEQ WFBCDT                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
      * CASE: WRK.Count USR EQ PAR.*Duration (factor)
     C           WUCNTU    IFEQ WL0190                     *IF
     C                     Z-ADDWFBCDT    WL0188           *Date1 (ending)
     C                     GOTO THEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTH     READE@AFREYY                  90*
     C                     ENDDO
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * documentation
      *================================================================
      * FP1054 Added CASE stmts for Fresh and Frozen- frozen is alloc bac
      *       Fresh can be backwards or forwards per company item ext sts
      *  1st call: IF par.warehouse code <> par.warehouse code pass usr,t
      *  We're moving fresh production to a diff warehouse for an order
      *   1st move std prod from the Fresh warehouse to the order's wareh
      *   Dont update the order detail schedule yet.
      *  2nd call: IF par.warehouse code = par.warehouse code pass usr,th
      *   alloc the input warehouse's production to the order
      *   And update the order detail schedule.
      * C01643 RMC 8/05/11  move piece count item wt calc above upd to or
      *  sched so its upd with the same weight as pdi8cpp
      * R13899 RMC 10/11/18-If OH Is a BLOCK order, then add 1 day to job
      *  - dont allocate current day prod to a block order UNLESS SCHED O
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * DOC:  Allocation
      *================================================================
      * Backward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      * Forward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * DOC:  Allocation
      *================================================================
      * Backward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      * Forward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1V5ST           Production Type
     C                     Z-ADD*ZERO     P1HXQT           ATS Quantity Av
     C                     Z-ADD*ZERO     P1EOWG           ATS Weight Avai
     C                     Z-ADD*ZERO     P1EWNB           ATS Pieces Avai
     C                     Z-ADD*ZERO     P1IHQT           Quantity Alloca
     C                     Z-ADD*ZERO     P1E1WG           Weight Allocate
     C                     Z-ADD*ZERO     P2PCAL           Pieces Allocate
     C                     Z-ADD*ZERO     P3CHMT           Chilling Time U
     C                     Z-ADD*ZERO     P4F8WG           PS Avg Piece Wg
     C                     Z-ADD*ZERO     P5BPPR           Production Yiel
     C                     Z-ADD*ZERO     P6EJNB           SM Pieces Need
     C                     Z-ADD*ZERO     P6GTWG           SM Weight Need
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WAA0DT           Order Date
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WAACDT           Cancel Date
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WAJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WAA1WG           Order Weight To
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WATBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WAATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WARSRN           Resell Referenc
     C                     Z-ADD*ZERO     WAT3NB           Attach to Order
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WAAWDT           Invoice Date
     C                     Z-ADD*ZERO     WAVRVA           A/R order Value
     C                     Z-ADD*ZERO     WAB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WANODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WANPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WANQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WANRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WANSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WABPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WABQTM           Time of Origina
     C                     Z-ADD*ZERO     WABRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WABSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WABTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WAH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WAH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WAH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WAH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WAH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBOQNY           CIE Unused Numb
     C                     Z-ADD*ZERO     WBORNY           CIE Unused Numb
     C                     Z-ADD*ZERO     WBS2DT           CIE Unused Date
     C                     Z-ADD*ZERO     WBMJDT           Create Date
     C                     Z-ADD*ZERO     WBBETM           Create Time
     C                     Z-ADD*ZERO     WBMKDT           Change Date
     C                     Z-ADD*ZERO     WBBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDBCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WDCQNB           Julian Date
     C                     Z-ADD*ZERO     WDESNB           Accounting Year
     C                     Z-ADD*ZERO     WDETNB           Accounting Peri
     C                     Z-ADD*ZERO     WDBZNB           OM Week
     C                     Z-ADD*ZERO     WDEINB           Week Number
     C                     Z-ADD*ZERO     WDAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WDOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WDNQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WDNRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WDOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WDOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field Count USR
     C                     Z-ADD*ZERO     WUCNTU  50
      * Define work field Record Found USR
     C                     MOVEL*BLANK    WUWXST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGELDT           Production Date
     C                     Z-ADD*ZERO     WGHVHD           Hog Volume
     C                     Z-ADD*ZERO     WGZ6NB           Average Live We
     C                     Z-ADD*ZERO     WGZ7NB           Average Hot Wei
     C                     Z-ADD*ZERO     WGDGPC           Cooler Shrink P
     C                     Z-ADD*ZERO     WGAVCW           Average Cold We
     C                     Z-ADD*ZERO     WGDIPC           Average Lean Pe
     C                     Z-ADD*ZERO     WGZ0NB           Average Backfat
     C                     Z-ADD*ZERO     WGAVLE           Average Loin-Ey
     C                     Z-ADD*ZERO     WGECWG           Hot Weight Tota
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHELDT           Production Date
     C                     Z-ADD*ZERO     WHHGCD           Item Code
     C                     Z-ADD*ZERO     WHGPDT           PS Available Sh
     C                     Z-ADD*ZERO     WHWTSP           PS Weight Plann
     C                     Z-ADD*ZERO     WHQTSP           PS Pieces Plann
     C                     Z-ADD*ZERO     WHDJPC           PS % of Carcass
     C                     Z-ADD*ZERO     WHF8WG           PS Avg Piece Wg
     C                     Z-ADD*ZERO     WHWTIN           PS Weight Inv O
     C                     Z-ADD*ZERO     WHD5NB           PS Pieces Inv O
     C                     Z-ADD*ZERO     WHDXWG           PS Weight Stand
     C                     Z-ADD*ZERO     WHB2NB           PS Pieces Stand
     C                     Z-ADD*ZERO     WHWTCN           PS Weight Conve
     C                     Z-ADD*ZERO     WHPSCV           PS Pieces Conve
     C                     Z-ADD*ZERO     WHSAWT           PS Weight Shipp
     C                     Z-ADD*ZERO     WHB9NB           PS Pieces Shipp
     C                     Z-ADD*ZERO     WHD1WG           PS Weight Prod
     C                     Z-ADD*ZERO     WHCBNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WHEZWG           PS Weight Inv A
     C                     Z-ADD*ZERO     WHCCNB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WHE0WG           PS Weight Ship
     C                     Z-ADD*ZERO     WHD6NB           PS Pieces Ship
     C                     Z-ADD*ZERO     WHOAWT           PS Weight Prod
     C                     Z-ADD*ZERO     WHCDNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WHUNW2           PS Weight Inv A
     C                     Z-ADD*ZERO     WHCENB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WHF9WG           PS Unit Weight
     C                     Z-ADD*ZERO     WHBPNB           PS Pieces Whse
     C                     Z-ADD*ZERO     WHGAWG           PS Weight Whse
     C                     Z-ADD*ZERO     WHBQNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WHGBWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WHBRNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WHGCWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WHBSNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WHGDWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WHBWNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WHGEWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WHPS6U           PS Pieces Unuse
     C                     Z-ADD*ZERO     WHDVWG           PS Weight Order
     C                     Z-ADD*ZERO     WHD7NB           PS Pieces Order
     C                     Z-ADD*ZERO     WHFCAD           PS Weight FC Ad
     C                     Z-ADD*ZERO     WHD9NB           PS Pieces FC Ad
     C                     Z-ADD*ZERO     WHDWWG           PS Weight FX Ad
     C                     Z-ADD*ZERO     WHEANB           PS Pieces FX Ad
     C                     Z-ADD*ZERO     WHSHWT           PS Weight Sched
     C                     Z-ADD*ZERO     WHEBNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WHAVWT           PS Weight Avail
     C                     Z-ADD*ZERO     WHECNB           PS Pieces Avail
     C                     Z-ADD*ZERO     WHWTON           PS Weight Produ
     C                     Z-ADD*ZERO     WHEDNB           PS Pieces Produ
     C                     Z-ADD*ZERO     WHFNWT           PS Weight Fab N
     C                     Z-ADD*ZERO     WHEENB           PS Pieces Fab N
     C                     Z-ADD*ZERO     WHQTAS           PS Weight Sched
     C                     Z-ADD*ZERO     WHEFNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WHWAIO           PS Weight Sched
     C                     Z-ADD*ZERO     WHEGNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WHRGNB           Item Structure
     C                     Z-ADD*ZERO     WHRHNB           Item Structure
     C                     Z-ADD*ZERO     WHRINB           Item Structure
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJC4NB           Order Number
     C                     Z-ADD*ZERO     WJDPNB           Order Sequence
     C                     Z-ADD*ZERO     WJUENB           Order Secondary
     C                     Z-ADD*ZERO     WJJGDT           OD Production D
     C                     Z-ADD*ZERO     WJAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WJHGCD           Item Code
     C                     Z-ADD*ZERO     WJIGQT           OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WJFLWG           OD Weight Sched
     C                     Z-ADD*ZERO     WJIUQT           OD Quantity Inv
     C                     Z-ADD*ZERO     WJF3WG           OD Weight Inv S
     C                     Z-ADD*ZERO     WJIVQT           OD Quantity Unu
     C                     Z-ADD*ZERO     WJF4WG           OD Unused weigh
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Description Line One
     C                     MOVEL*BLANK    WUAVNA 30
      * Define work field U/M - Primary
     C                     MOVEL*BLANK    WUADCD  2
      * Define work field Unit Weight
     C                     Z-ADD*ZERO     WUAIWG 112
      * Define work field Item Type Code
     C                     MOVEL*BLANK    WUN0CD  3
      * Define work field Default Warehouse
     C                     MOVEL*BLANK    WUQ1CD  3
      * Define work field Fresh Chilling Time
     C                     Z-ADD*ZERO     WUCHTM  52
      * Define work field Base/Conv/Loss Item
     C                     MOVEL*BLANK    WUQZCD  2
      * Define work field Variety/Rendered/Cut
     C                     MOVEL*BLANK    WUXWST  1
      * Define work field Credit Item Status
     C                     MOVEL*BLANK    WUVMST  1
      * Define work field Std Weight/Head (Var/Ren)
     C                     Z-ADD*ZERO     WUSWGH 112
      * Define work field Pieces Per Head
     C                     Z-ADD*ZERO     WUPPHE  70
      * Define work field Group for Packaging
     C                     MOVEL*BLANK    WUSDCD  1
      * Define work field Seconds Item
     C                     MOVEL*BLANK    WUX5ST  1
      * Define work field Pieces Per Bag
     C                     Z-ADD*ZERO     WUBDNB  70
      * Define work field Bags Per Unit
     C                     Z-ADD*ZERO     WUBJNB  70
      * Define work field Fresh Inv Allocation Seq
     C                     MOVEL*BLANK    WUSYST  1
      * Define work field Fresh Sched As Ordered
     C                     MOVEL*BLANK    WUSZST  1
      * Define work field Frozen Inv Allocation Seq
     C                     MOVEL*BLANK    WUS1ST  1
      * Define work field Trans Contol AS400/Plant
     C                     MOVEL*BLANK    WUXUST  1
      * Define work field Warehouse Location
     C                     MOVEL*BLANK    WUT0ST  1
      * Define work field Warehouse Std Chill Time
     C                     MOVEL*BLANK    WUT1ST  1
      * Define work field Warehouse Chill Time
     C                     Z-ADD*ZERO     WUDBNB  52
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMAIC3           Company Number
     C                     Z-ADD*ZERO     WMHGCD           Item Code
     C                     Z-ADD*ZERO     WMAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WMAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WMAIWG           Unit Weight
     C                     Z-ADD*ZERO     WMCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WMC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WMURTN           Number Cases On
     C                     Z-ADD*ZERO     WMAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WMRINB           Item Structure
     C                     Z-ADD*ZERO     WMRHNB           Item Structure
     C                     Z-ADD*ZERO     WMRGNB           Item Structure
     C                     Z-ADD*ZERO     WMTFNB           Transportation
     C                     Z-ADD*ZERO     WMTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WMTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WMBLPR           Market Overage
     C                     Z-ADD*ZERO     WMBMPR           Standard Overag
     C                     Z-ADD*ZERO     WMCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WMCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WMSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WMPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WMICN1           Item Category N
     C                     Z-ADD*ZERO     WMICN2           Item Category N
     C                     Z-ADD*ZERO     WMV2NB           Item Category N
     C                     Z-ADD*ZERO     WMITCN           Item Category N
     C                     Z-ADD*ZERO     WMITC5           Item Category N
     C                     Z-ADD*ZERO     WMICN6           Item Category N
     C                     Z-ADD*ZERO     WMICN7           Item Category N
     C                     Z-ADD*ZERO     WMICN8           Item Category N
     C                     Z-ADD*ZERO     WMICN9           Item Category N
     C                     Z-ADD*ZERO     WMICN0           Item Category N
     C                     Z-ADD*ZERO     WMSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WMA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WMSJNB           Production Lead
     C                     Z-ADD*ZERO     WMSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WMSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WMSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WMCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WMCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WMILNB           Packages per ca
     C                     Z-ADD*ZERO     WMCHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WMCINB           PM Batch Size
     C                     Z-ADD*ZERO     WMCJNB           Package Level s
     C                     Z-ADD*ZERO     WMCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WMCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WMCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WMCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WMCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WMCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WMCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WMCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WMC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WMB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WMB5NB           PM Line Number
     C                     Z-ADD*ZERO     WMBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WMBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WMF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WMF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WMF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WMBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WMBNNB           Production Qty
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WODBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WOBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WOBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WOBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WOBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WOAATM           Job Time
     C                     Z-ADD*ZERO     WOAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WSAIC3           Company Number
     C                     Z-ADD*ZERO     WSC4NB           Order Number
     C                     Z-ADD*ZERO     WSDPNB           Order Sequence
     C                     Z-ADD*ZERO     WSUENB           Order Secondary
     C                     Z-ADD*ZERO     WSJGDT           OD Production D
     C                     Z-ADD*ZERO     WSOONY           ODS Sequence Nu
     C                     Z-ADD*ZERO     WSAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WSNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WSHGCD           Item Code
     C                     Z-ADD*ZERO     WSIGQT           OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WSFLWG           OD Weight Sched
     C                     Z-ADD*ZERO     WSNSQT           ODS Quantity Sh
     C                     Z-ADD*ZERO     WSJQWG           ODS Weight Shor
     C                     Z-ADD*ZERO     WSNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WSBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WSAATM           Job Time
     C                     Z-ADD*ZERO     WSAXDT           Job Date
      * Define work field *Duration (factor)
     C                     Z-ADD*ZERO     WUDUF   80
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WA03 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WJ03 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WJ01 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WA02 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WJ02 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WJ00 150       *Synon (15,0) w
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SERVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003  1
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0004  30
     C                     Z-ADD*ZERO     WL0005  70
     C                     Z-ADD*ZERO     WL0006  70
     C                     MOVEL*BLANK    WL0007  1
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0008  30
     C                     MOVEL*BLANK    WL0009  1
     C                     Z-ADD*ZERO     WL0010  70
     C                     MOVEL*BLANK    WL0011  1
      * Define local variables for subroutine SIRVGN.
     C                     Z-ADD*ZERO     WL0012  30
     C                     MOVEL*BLANK    WL0013  1
     C                     Z-ADD*ZERO     WL0014  70
     C                     Z-ADD*ZERO     WL0015  70
     C                     MOVEL*BLANK    WL0016  3
     C                     Z-ADD*ZERO     WL0017  92
     C                     Z-ADD*ZERO     WL0018 112
     C                     Z-ADD*ZERO     WL0019  70
     C                     Z-ADD*ZERO     WL0020  52
      * Define local variables for subroutine SKRVGN.
     C                     Z-ADD*ZERO     WL0021  30
     C                     Z-ADD*ZERO     WL0022  70
     C                     Z-ADD*ZERO     WL0023  30
     C                     Z-ADD*ZERO     WL0024  30
     C                     Z-ADD*ZERO     WL0025  70
     C                     Z-ADD*ZERO     WL0026  70
     C                     MOVEL*BLANK    WL0027  3
     C                     MOVEL*BLANK    WL0028  3
     C                     Z-ADD*ZERO     WL0029  70
     C                     Z-ADD*ZERO     WL0030  92
     C                     Z-ADD*ZERO     WL0031 112
     C                     MOVEL*BLANK    WL0032  2
      * Define local variables for subroutine SORVGN.
     C                     Z-ADD*ZERO     WL0033  30
     C                     MOVEL*BLANK    WL0034  1
     C                     Z-ADD*ZERO     WL0035  70
     C                     Z-ADD*ZERO     WL0036  70
     C                     MOVEL*BLANK    WL0037  3
     C                     Z-ADD*ZERO     WL0038  92
     C                     Z-ADD*ZERO     WL0039  70
     C                     Z-ADD*ZERO     WL0040  70
     C                     Z-ADD*ZERO     WL0041  30
     C                     Z-ADD*ZERO     WL0042  30
     C                     MOVEL*BLANK    WL0043  1
      * Define local variables for subroutine SPCRRC.
     C                     Z-ADD*ZERO     WL0044  30
     C                     MOVEL*BLANK    WL0045  1
     C                     Z-ADD*ZERO     WL0046  70
     C                     Z-ADD*ZERO     WL0047  70
     C                     MOVEL*BLANK    WL0048  3
     C                     Z-ADD*ZERO     WL0049  70
     C                     Z-ADD*ZERO     WL0050  92
     C                     Z-ADD*ZERO     WL0051  70
     C                     Z-ADD*ZERO     WL0052  72
     C                     Z-ADD*ZERO     WL0053  92
     C                     Z-ADD*ZERO     WL0054  92
     C                     Z-ADD*ZERO     WL0055  70
     C                     Z-ADD*ZERO     WL0056  92
     C                     Z-ADD*ZERO     WL0057  70
     C                     Z-ADD*ZERO     WL0058  92
     C                     Z-ADD*ZERO     WL0059  70
     C                     Z-ADD*ZERO     WL0060  92
     C                     Z-ADD*ZERO     WL0061  70
     C                     Z-ADD*ZERO     WL0062  92
     C                     Z-ADD*ZERO     WL0063  70
     C                     Z-ADD*ZERO     WL0064  92
     C                     Z-ADD*ZERO     WL0065  70
     C                     Z-ADD*ZERO     WL0066  92
     C                     Z-ADD*ZERO     WL0067  70
     C                     Z-ADD*ZERO     WL0068  92
     C                     Z-ADD*ZERO     WL0069  70
     C                     Z-ADD*ZERO     WL0070  92
     C                     Z-ADD*ZERO     WL0071  70
     C                     Z-ADD*ZERO     WL0072 112
     C                     Z-ADD*ZERO     WL0073  70
     C                     Z-ADD*ZERO     WL0074 112
     C                     Z-ADD*ZERO     WL0075  70
     C                     Z-ADD*ZERO     WL0076 112
     C                     Z-ADD*ZERO     WL0077  70
     C                     Z-ADD*ZERO     WL0078 112
     C                     Z-ADD*ZERO     WL0079  70
     C                     Z-ADD*ZERO     WL0080 112
     C                     Z-ADD*ZERO     WL0081  70
     C                     Z-ADD*ZERO     WL0082 112
     C                     Z-ADD*ZERO     WL0083  70
     C                     MOVEL*BLANK    WL0084  3
     C                     MOVEL*BLANK    WL0085  2
     C                     MOVEL*BLANK    WL0086  1
     C                     MOVEL*BLANK    WL0087  1
     C                     MOVEL*BLANK    WL0088  1
     C                     MOVEL*BLANK    WL0089  1
     C                     MOVEL*BLANK    WL0090  1
     C                     MOVEL*BLANK    WL0091  1
     C                     MOVEL*BLANK    WL0092  1
     C                     MOVEL*BLANK    WL0093  1
     C                     MOVEL*BLANK    WL0094  2
     C                     MOVEL*BLANK    WL0095  3
     C                     Z-ADD*ZERO     WL0096  92
     C                     Z-ADD*ZERO     WL0097  70
     C                     Z-ADD*ZERO     WL0098  92
     C                     Z-ADD*ZERO     WL0099  70
     C                     Z-ADD*ZERO     WL0100  92
     C                     Z-ADD*ZERO     WL0101  70
     C                     Z-ADD*ZERO     WL0102  92
     C                     Z-ADD*ZERO     WL0103  70
     C                     Z-ADD*ZERO     WL0104  92
     C                     Z-ADD*ZERO     WL0105  70
     C                     Z-ADD*ZERO     WL0106  92
     C                     Z-ADD*ZERO     WL0107  70
     C                     Z-ADD*ZERO     WL0108  92
     C                     Z-ADD*ZERO     WL0109  70
     C                     Z-ADD*ZERO     WL0110  92
     C                     Z-ADD*ZERO     WL0111  70
     C                     Z-ADD*ZERO     WL0112  92
     C                     Z-ADD*ZERO     WL0113  70
     C                     MOVEL*BLANK    WL0114  6
     C                     Z-ADD*ZERO     WL0115  30
     C                     Z-ADD*ZERO     WL0116  30
     C                     Z-ADD*ZERO     WL0117  30
     C                     MOVEL*BLANK    WL0118  6
     C                     MOVEL*BLANK    WL0119  1
     C                     MOVEL*BLANK    WL0120  1
     C                     MOVEL*BLANK    WL0121  1
     C                     MOVEL*BLANK    WL0122  1
     C                     Z-ADD*ZERO     WL0123  60
     C                     MOVEL*BLANK    WL0124 10
     C                     MOVEL*BLANK    WL0125 10
     C                     Z-ADD*ZERO     WL0126  70
      * Define local variables for subroutine STRVGN.
     C                     Z-ADD*ZERO     WL0127  30
     C                     Z-ADD*ZERO     WL0128  70
     C                     Z-ADD*ZERO     WL0129  52
     C                     Z-ADD*ZERO     WL0130  70
      * Define local variables for subroutine SVRVGN.
     C                     Z-ADD*ZERO     WL0131  30
     C                     MOVEL*BLANK    WL0132  1
     C                     Z-ADD*ZERO     WL0133  70
     C                     Z-ADD*ZERO     WL0134  70
     C                     MOVEL*BLANK    WL0135  3
     C                     Z-ADD*ZERO     WL0136  70
     C                     Z-ADD*ZERO     WL0137 112
      * Define local variables for subroutine SXRVGN.
     C                     Z-ADD*ZERO     WL0138  30
     C                     MOVEL*BLANK    WL0139  1
     C                     Z-ADD*ZERO     WL0140  70
     C                     Z-ADD*ZERO     WL0141  70
     C                     MOVEL*BLANK    WL0142  3
     C                     Z-ADD*ZERO     WL0143  92
     C                     Z-ADD*ZERO     WL0144  70
     C                     Z-ADD*ZERO     WL0145  70
     C                     Z-ADD*ZERO     WL0146  30
     C                     Z-ADD*ZERO     WL0147  30
     C                     MOVEL*BLANK    WL0148  1
      * Define local variables for subroutine SYRVGN.
     C                     Z-ADD*ZERO     WL0149  30
     C                     Z-ADD*ZERO     WL0150  70
      * Define local variables for subroutine SZRVGN.
     C                     Z-ADD*ZERO     WL0151  30
     C                     Z-ADD*ZERO     WL0152  70
     C                     Z-ADD*ZERO     WL0153  30
     C                     Z-ADD*ZERO     WL0154  30
     C                     Z-ADD*ZERO     WL0155  70
     C                     Z-ADD*ZERO     WL0156  30
     C                     Z-ADD*ZERO     WL0157  70
     C                     Z-ADD*ZERO     WL0158  70
      * Define local variables for subroutine TARVGN.
     C                     Z-ADD*ZERO     WL0159  30
     C                     Z-ADD*ZERO     WL0160  70
     C                     Z-ADD*ZERO     WL0161  30
     C                     Z-ADD*ZERO     WL0162  30
     C                     Z-ADD*ZERO     WL0163  70
     C                     Z-ADD*ZERO     WL0164  30
      * Define local variables for subroutine TBRVGN.
     C                     Z-ADD*ZERO     WL0165  30
     C                     Z-ADD*ZERO     WL0166  70
     C                     Z-ADD*ZERO     WL0167  30
     C                     Z-ADD*ZERO     WL0168  30
     C                     Z-ADD*ZERO     WL0169  70
     C                     Z-ADD*ZERO     WL0170  30
     C                     Z-ADD*ZERO     WL0171  70
     C                     MOVEL*BLANK    WL0172  3
     C                     Z-ADD*ZERO     WL0173  70
     C                     Z-ADD*ZERO     WL0174  70
     C                     Z-ADD*ZERO     WL0175 112
     C                     Z-ADD*ZERO     WL0176 112
     C                     Z-ADD*ZERO     WL0177  50
     C                     Z-ADD*ZERO     WL0178  92
     C                     Z-ADD*ZERO     WL0179  70
     C                     Z-ADD*ZERO     WL0180  60
      * Define local variables for subroutine TGRVGN.
     C                     Z-ADD*ZERO     WL0181  30
     C                     Z-ADD*ZERO     WL0182  70
     C                     Z-ADD*ZERO     WL0183  70
     C                     Z-ADD*ZERO     WL0184  70
     C                     Z-ADD*ZERO     WL0185  80
      * Define local variables for subroutine THRVGN.
     C                     Z-ADD*ZERO     WL0186  30
     C                     Z-ADD*ZERO     WL0187  70
     C                     Z-ADD*ZERO     WL0188  70
     C                     Z-ADD*ZERO     WL0189  70
     C                     Z-ADD*ZERO     WL0190  80
      * Define local work field Block Order Flag
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Allocation Method
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Scheduled Ship Date
     C                     Z-ADD*ZERO     YL0003  70
      * Define local work field Date                  USR
     C                     Z-ADD*ZERO     YL0004  70
      * Define local work field Production Date To
     C                     Z-ADD*ZERO     YL0005  70
      * Define local work field Production Day Status
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field Production Day Status USR
     C                     MOVEL*BLANK    YL0007  1
      * Define null work field Accounting Period Code
     C                     Z-ADD*ZERO     YN0001  20
      * Define local work field Day of Week
     C                     MOVEL*BLANK    YL0008  1
      * Define null work field Week Number
     C                     Z-ADD*ZERO     YN0002  20
      * Define local work field OD Added to Sched Today
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0010  30
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0011  30
      * Define local work field ODS Sequence Number
     C                     Z-ADD*ZERO     YL0012  30
      * Define local work field OD Weight Scheduled
     C                     Z-ADD*ZERO     YL0013 112
      * Define local work field OD Qty/Cnsmd Pieces Sched
     C                     Z-ADD*ZERO     YL0014 112
      * Define local work field Production Date RGF
     C                     Z-ADD*ZERO     YL0015  70
      * Define local work field Allocation Method USR
     C                     MOVEL*BLANK    YL0016  1
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 SCHASORD
