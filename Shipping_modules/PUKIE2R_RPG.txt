     H/TITLE Edt Appl 4/Exp Hdr PHISE2 Edit record(2 screens)
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Maintain DBF file records, one at a time
     H* - Existing records may be updated or deleted
     H* - Key changes are not allowed
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Edit record(2 screens)
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISJMIST
     H* Date          : 11/19/24  Time  : 03:55:17
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPUKIE2R#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: Edt Appl 4/Exp Hdr PHISE2 Edit record(2 screens)
      *
     FPDMRREL1IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RTV : Export Doc Order Hdr      Retrieval index
      *
     FPUA6CPL1IF  E           K        DISK
      * RTV : Export Doc Order Hdr Ext  Retrieval index
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPDMMREL1IF  E           K        DISK
      * RTV : Export Doc Defaults       Retrieval index
      *
     FCAACREL1IF  E           K        DISK
      * RTV : State Master              Retrieval index       NV
      *
     FOME5REL1IF  E           K        DISK
      * RTV : Country Master            Retrieval index
      *
     FPUCEREL1IF  E           K        DISK
      * RTV : Country Port of Entry     Retrieval index
      *
     FPDMRREL3IF  E           K        DISK
      * RSQ : Export Doc Order Hdr      Co/Order
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FPUA6CPL0UF  E           K        DISK
      * UPD : Export Doc Order Hdr Ext  Update index
      *
     FPDMRREL0UF  E           K        DISK
      * UPD : Export Doc Order Hdr      Update index
      *
     E                    J7          7  1
     E                    K7          7  1
      * RIGHT JUSTIFY INPUT FIELD
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    #L3         3  1
     E                    #L7         7  1
     E                    UCT        40  1               CENTER TABLE
      * KEY Screen: Field position and name array
     E                    W0BEG   4 004  5 0A
     E                    W0END   4 004  5 0A
     E                    W0NAM   4 004 10
      * DETAIL Screen: Field position and name array
     E                    W1BEG   7 043  5 0A
     E                    W1END   7 043  5 0A
     E                    W1NAM   7 043 10
      * DETAIL 2 Screen: Field position and name array
     E                    W2BEG   7 019  5 0A
     E                    W2END   7 019  5 0A
     E                    W2NAM   7 019 10
      * Long constants
     E                    @CN#    1  19  6   @CN    25
      * Screen one error indicator store
     E                    @I1       100  1
      * Screen two error indicator store
     E                    @I2       100  1
     I@A6CPDG
      * Export Doc Order Hdr Ext  Update index
      * Renamed input format fields
     I              A6AIC3                          WAAIC3
     I              A6C4NB                          WAC4NB
     I              A6DGSX                          WADGSX
     I              A6KXCD                          WAKXCD
     I              A6HUSC                          WAHUSC
     I              A6HVSC                          WAHVSC
     I              A6HWSC                          WAHWSC
     I              A6X0AA                          WAX0AA
     I              A6HXSC                          WAHXSC
     I              A6HYSC                          WAHYSC
     I              A6JPU1                          WAJPU1
     I              A6JQU1                          WAJQU1
     I              A6A1DX                          WAA1DX
     I              A6X1AA                          WAX1AA
     I              A6YAAA                          WAYAAA
     I              A6YBAA                          WAYBAA
     I              A6YCAA                          WAYCAA
     I              A6YDAA                          WAYDAA
     I              A6KGU1                          WAKGU1
     I              A6KHU1                          WAKHU1
     I              A6KIU1                          WAKIU1
     I              A6IGSC                          WAIGSC
     I              A6KJU1                          WAKJU1
     I              A6KLU1                          WAKLU1
     I              A6KMU1                          WAKMU1
     I              A6KNU1                          WAKNU1
     I              A6KOU1                          WAKOU1
     I              A6YEAA                          WAYEAA
     I              A6KPU1                          WAKPU1
     I              A6KQU1                          WAKQU1
     I              A6KSU1                          WAKSU1
     I              A6KTU1                          WAKTU1
     I              A6KUU1                          WAKUU1
     I              A6KWU1                          WAKWU1
     I              A6YFAA                          WAYFAA
     I              A6KVU1                          WAKVU1
     I              A6KRU1                          WAKRU1
     I              A6IESC                          WAIESC
     I              A6AUTS                          WAAUTS
     I              A6IFSC                          WAIFSC
     I              A6KFU1                          WAKFU1
     I              A6KKU1                          WAKKU1
     I              A6UVST                          WAUVST
     I              A6UWST                          WAUWST
     I              A6UXST                          WAUXST
     I              A6VSST                          WAVSST
     I              A6AATM                          WAAATM
     I              A6AYNA                          WAAYNA
     I              A6A0NA                          WAA0NA
     I              A6AXDT                          WAAXDT
      *
     I@MRREX3
      * Export Doc Order Hdr      Co/Order
      * Renamed input format fields
     I              MRAIC3                          WBAIC3
     I              MRC4NB                          WBC4NB
     I              MRDGSX                          WBDGSX
     I              MRKXCD                          WBKXCD
     I              MRZMCD                          WBZMCD
     I              MRPSTX                          WBPSTX
     I              MRPUTX                          WBPUTX
     I              MRPVTX                          WBPVTX
     I              MRPWTX                          WBPWTX
     I              MRRVTX                          WBRVTX
     I              MRPPU1                          WBPPU1
     I              MRZ7AA                          WBZ7AA
     I              MRPDU1                          WBPDU1
     I              MRZ8AA                          WBZ8AA
     I              MRRHTX                          WBRHTX
     I              MRRITX                          WBRITX
     I              MRRJTX                          WBRJTX
     I              MRSCTX                          WBSCTX
     I              MRSDTX                          WBSDTX
     I              MRAAAB                          WBAAAB
     I              MRPHU1                          WBPHU1
     I              MRABAB                          WBABAB
     I              MRPXTX                          WBPXTX
     I              MRZOCD                          WBZOCD
     I              MRZNCD                          WBZNCD
     I              MRCSSX                          WBCSSX
     I              MRCTSX                          WBCTSX
     I              MRCUSX                          WBCUSX
     I              MRCVSX                          WBCVSX
     I              MRPTTX                          WBPTTX
     I              MRORNA                          WBORNA
     I              MRRKTX                          WBRKTX
     I              MRPZTX                          WBPZTX
     I              MRRLTX                          WBRLTX
     I              MRP0TX                          WBP0TX
     I              MRP1TX                          WBP1TX
     I              MRP2TX                          WBP2TX
     I              MRP3TX                          WBP3TX
     I              MRP4TX                          WBP4TX
     I              MRP5TX                          WBP5TX
     I              MRP6TX                          WBP6TX
     I              MRYHTX                          WBYHTX
     I              MRYITX                          WBYITX
     I              MRCWSX                          WBCWSX
     I              MROUNA                          WBOUNA
     I              MRP7TX                          WBP7TX
     I              MRP9TX                          WBP9TX
     I              MROVNA                          WBOVNA
     I              MRQATX                          WBQATX
     I              MRQBTX                          WBQBTX
     I              MRQCTX                          WBQCTX
     I              MROWNA                          WBOWNA
     I              MROXNA                          WBOXNA
     I              MRABNX                          WBABNX
     I              MRACNX                          WBACNX
     I              MRADNX                          WBADNX
     I              MRQDTX                          WBQDTX
     I              MRQETX                          WBQETX
     I              MROYNA                          WBOYNA
     I              MROZNA                          WBOZNA
     I              MRO0NA                          WBO0NA
     I              MRO1NA                          WBO1NA
     I              MRCXSX                          WBCXSX
     I              MRCYSX                          WBCYSX
     I              MRAGNX                          WBAGNX
     I              MRCZSX                          WBCZSX
     I              MRC0SX                          WBC0SX
     I              MRC1SX                          WBC1SX
     I              MRQFTX                          WBQFTX
     I              MRAHNX                          WBAHNX
     I              MRQGTX                          WBQGTX
     I              MRQHTX                          WBQHTX
     I              MRQITX                          WBQITX
     I              MRQJTX                          WBQJTX
     I              MRQKTX                          WBQKTX
     I              MRQMTX                          WBQMTX
     I              MRQNTX                          WBQNTX
     I              MRQOTX                          WBQOTX
     I              MRQPTX                          WBQPTX
     I              MRQQTX                          WBQQTX
     I              MRQRTX                          WBQRTX
     I              MRQSTX                          WBQSTX
     I              MRQTTX                          WBQTTX
     I              MRQUTX                          WBQUTX
     I              MRQVTX                          WBQVTX
     I              MRQYTX                          WBQYTX
     I              MRQWTX                          WBQWTX
     I              MRQZTX                          WBQZTX
     I              MRAINX                          WBAINX
     I              MRQ1TX                          WBQ1TX
     I              MRQ2TX                          WBQ2TX
     I              MRQ3TX                          WBQ3TX
     I              MRQ4TX                          WBQ4TX
     I              MRQ5TX                          WBQ5TX
     I              MRQ6TX                          WBQ6TX
     I              MRQ7TX                          WBQ7TX
     I              MRQ8TX                          WBQ8TX
     I              MRQ9TX                          WBQ9TX
     I              MRSMTX                          WBSMTX
     I              MRZQCD                          WBZQCD
     I              MRZRCD                          WBZRCD
     I              MRA7VL                          WBA7VL
     I              MRA8VL                          WBA8VL
     I              MRC2SX                          WBC2SX
     I              MRC8SX                          WBC8SX
     I              MRHRWG                          WBHRWG
     I              MRBIVL                          WBBIVL
     I              MRK2QT                          WBK2QT
     I              MRO5NA                          WBO5NA
     I              MRHSWG                          WBHSWG
     I              MRBJVL                          WBBJVL
     I              MRRATX                          WBRATX
     I              MRRBTX                          WBRBTX
     I              MRRCTX                          WBRCTX
     I              MRRDTX                          WBRDTX
     I              MRRETX                          WBRETX
     I              MRC3SX                          WBC3SX
     I              MRC4SX                          WBC4SX
     I              MRC5SX                          WBC5SX
     I              MRC6SX                          WBC6SX
     I              MRC7SX                          WBC7SX
     I              MRMQDT                          WBMQDT
     I              MRMRDT                          WBMRDT
     I              MRMSDT                          WBMSDT
     I              MRAJNX                          WBAJNX
     I              MRYFTX                          WBYFTX
     I              MRX9TX                          WBX9TX
     I              MRYATX                          WBYATX
     I              MRYBTX                          WBYBTX
     I              MRB5AA                          WBB5AA
     I              MRYCTX                          WBYCTX
     I              MRYDTX                          WBYDTX
     I              MRYETX                          WBYETX
     I              MRB6AA                          WBB6AA
     I              MRPADT                          WBPADT
     I              MRPBDT                          WBPBDT
     I              MRPCDT                          WBPCDT
     I              MRPDDT                          WBPDDT
     I              MRPEDT                          WBPEDT
     I              MRO4SX                          WBO4SX
     I              MRO5SX                          WBO5SX
     I              MRC1T1                          WBC1T1
     I              MRC2T1                          WBC2T1
     I              MRLKSC                          WBLKSC
     I              MRLLSC                          WBLLSC
     I              MRPIU1                          WBPIU1
     I              MRPJU1                          WBPJU1
     I              MRFFNZ                          WBFFNZ
     I              MRBUDX                          WBBUDX
     I              MRUVST                          WBUVST
     I              MRUWST                          WBUWST
     I              MRUXST                          WBUXST
     I              MRVSST                          WBVSST
     I              MRAATM                          WBAATM
     I              MRAYNA                          WBAYNA
     I              MRA0NA                          WBA0NA
     I              MRAXDT                          WBAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     I@1DBRC    E DSPDMRREL0
      * UPD : Export Doc Order Hdr      Update index
      * Current/previous master file format fields for change control
      *
     I#1DBRC      DS                           3848
      * Stored master file format fields
     I                                        1   1 #1DB1
      *
     I@@I1        DS
      * Screen one error indicator store
     I                                        1 100 @I1
     I                                       31  64 INSCR1
     I@@I2        DS
      * Screen two error indicator store
     I                                        1 100 @I2
     I                                       31  40 INSCR2
     IQPUA61    E DSPUA6CPL0
      * UPD : Export Doc Order Hdr Ext  Update index
      * Renamed input format fields
     I              A6AIC3                          WAAIC3
     I              A6C4NB                          WAC4NB
     I              A6DGSX                          WADGSX
     I              A6KXCD                          WAKXCD
     I              A6HUSC                          WAHUSC
     I              A6HVSC                          WAHVSC
     I              A6HWSC                          WAHWSC
     I              A6X0AA                          WAX0AA
     I              A6HXSC                          WAHXSC
     I              A6HYSC                          WAHYSC
     I              A6JPU1                          WAJPU1
     I              A6JQU1                          WAJQU1
     I              A6A1DX                          WAA1DX
     I              A6X1AA                          WAX1AA
     I              A6YAAA                          WAYAAA
     I              A6YBAA                          WAYBAA
     I              A6YCAA                          WAYCAA
     I              A6YDAA                          WAYDAA
     I              A6KGU1                          WAKGU1
     I              A6KHU1                          WAKHU1
     I              A6KIU1                          WAKIU1
     I              A6IGSC                          WAIGSC
     I              A6KJU1                          WAKJU1
     I              A6KLU1                          WAKLU1
     I              A6KMU1                          WAKMU1
     I              A6KNU1                          WAKNU1
     I              A6KOU1                          WAKOU1
     I              A6YEAA                          WAYEAA
     I              A6KPU1                          WAKPU1
     I              A6KQU1                          WAKQU1
     I              A6KSU1                          WAKSU1
     I              A6KTU1                          WAKTU1
     I              A6KUU1                          WAKUU1
     I              A6KWU1                          WAKWU1
     I              A6YFAA                          WAYFAA
     I              A6KVU1                          WAKVU1
     I              A6KRU1                          WAKRU1
     I              A6IESC                          WAIESC
     I              A6AUTS                          WAAUTS
     I              A6IFSC                          WAIFSC
     I              A6KFU1                          WAKFU1
     I              A6KKU1                          WAKKU1
     I              A6UVST                          WAUVST
     I              A6UWST                          WAUWST
     I              A6UXST                          WAUXST
     I              A6VSST                          WAVSST
     I              A6AATM                          WAAATM
     I              A6AYNA                          WAAYNA
     I              A6A0NA                          WAA0NA
     I              A6AXDT                          WAAXDT
      *
     IYARDCS      DS                            944
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
     IYBRDCS      DS                           3848
     IYCRDCS      DS                            944
      /EJECT
     IXDITS       DS
      * Internal date
     I                                        1  26 XDITSM
     I                                        1  10 XDITSD
     I                                       11  11 XDITSX
     I                                       12  19 XDITST
     I                                       20  20 XDITSZ
     I                                       21  260XDITSN
      /EJECT
     IXDI2T       DS
      * Internal date
     I                                        1  10 XDI2DT
     I                                        1   40XDI2CY
     I                                        1   10XDI2CC
     I                                        2   40XDI2YY
     I                                        6   70XDI2MM
     I                                        9  100XDI2DD
      /EJECT
     IXTC2        DS
      * Time: hours, minutes, seconds TM#
     I                                        1   8 XTTI2
     I                                        1   20XTH2
     I                                        4   50XTN2
     I                                        7   80XTS2
      /EJECT
      * Parameter declarations
     IP1PARM      DS                             13
      * KEY: Export Doc Order Hdr      Retrieval index
      * I : RST Company Number
     I                                    P   1   20P1AIC3
      * I : RST Order Number
     I                                    P   3   60P1C4NB
      * I : RST ED Export Document Type
     I                                        7   7 P1DGSX
      * I : RST Country Code
     I                                        8  13 P1KXCD
     IP2PARM      DS
      * I :  ED Print Status
     I                                        1   1 P2C8SX
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Generic Message 80'
      * Generic Message 80 USR
     I                                        1  80 ZA0001
      * Message data for 'CD7 Non numeric data'
      * Message data for 'Generic Message 80 ERR 2'
      * Generic Message 80 USR
     I                                        1  80 ZA0002
      * USR Status (Y/N)
     I                                       81  81 ZA0003
      * Message data for 'Generic Message 80 ERR 2'
      * Generic Message 80 USR
     I                                        1  80 ZA0004
      * USR Status (Y/N)
     I                                       81  81 ZA0005
      * Message data for 'Generic Message 80 ERR 2'
      * Generic Message 80 USR
     I                                        1  80 ZA0006
      * USR Status (Y/N)
     I                                       81  81 ZA0007
      * Message data for 'Value Required'
      * @Allocation Type
     I                                        1   1 ZA0008
      * Message data for 'Value Required'
      * @Allocation Type
     I                                        1   1 ZA0009
      * Message data for 'Value Required'
      * @Allocation Type
     I                                        1   1 ZA0010
      * Message data for 'Value Required'
      * @Allocation Type
     I                                        1   1 ZA0011
      * Message data for 'Value Required'
      * @Allocation Type
     I                                        1   1 ZA0012
      * Message data for 'Value Required'
      * @Allocation Type
     I                                        1   1 ZA0013
      * Message data for 'Value Required'
      * @Allocation Type
     I                                        1   1 ZA0014
      * Message data for 'Value Required'
      * @Allocation Type
     I                                        1   1 ZA0015
      * Message data for 'State Inactive'
      * State Code
     I                                        1   2 ZA0016
      * Message data for 'State file not found'
      * State Code
     I                                        1   2 ZA0017
      * Message data for 'Country Inactive'
      * Country Code
     I                                        1   6 ZA0018
      * Message data for 'Country Code           NX'
      * Country Code
     I                                        1   6 ZA0019
      * Message data for 'State Inactive'
      * State Code
     I                                        1   2 ZA0020
      * Message data for 'State file not found'
      * State Code
     I                                        1   2 ZA0021
      * Message data for 'Country Inactive'
      * Country Code
     I                                        1   6 ZA0022
      * Message data for 'Country Code           NX'
      * Country Code
     I                                        1   6 ZA0023
      * Message data for 'EDE Reason Must Select'
      * EDE Reason f_Replcmnt Sts
     I                                        1   2 ZA0024
      * Message data for 'Generic Message 80 ERR 2'
      * Generic Message 80 USR
     I                                        1  80 ZA0025
      * USR Status (Y/N)
     I                                       81  81 ZA0026
      * Message data for 'Country Master         NF'
      * Country Code
     I                                        1   6 ZA0027
      * Message data for 'Generic Message 80 ERR 2'
      * Generic Message 80 USR
     I                                        1  80 ZA0028
      * USR Status (Y/N)
     I                                       81  81 ZA0029
      * Message data for 'Country Master         NF'
      * Country Code
     I                                        1   6 ZA0030
      * Message data for 'Generic Message 80 ERR 2'
      * Generic Message 80 USR
     I                                        1  80 ZA0031
      * USR Status (Y/N)
     I                                       81  81 ZA0032
      * Message data for 'Generic Message 80 ERR 2'
      * Generic Message 80 USR
     I                                        1  80 ZA0033
      * USR Status (Y/N)
     I                                       81  81 ZA0034
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C                     PARM           P1PARM           KEY: Export Doc
     C           P2C8SX    PARM           WP0001  1        ED Print Status
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Check passed parameters
     C                     EXSR FACKPM
      * Perform once if all passed, else repeat
     C           W0RPT     DOUEQ'N'
      * Display and process key screen
     C                     EXSR BADSKY
     C                     END
      * Terminate program
     C                     EXSR ZXEXPG
      *****************************************************************
      /EJECT
     CSR         BADSKY    BEGSR
      *================================================================
      * Display and process key screen
      *================================================================
      * Bypass first display of key screen is possible
     C                     MOVEL'Y'       W0BYP   1
      * Initialize key screen
     C                     EXSR MDIZ#K
      * Signal start of transaction
     C                     MOVEL'Y'       W0TRN   1
     C           W0TRN     DOWEQ'Y'
     C           W0TRN     OREQ 'K'
      * Ensure transaction continues (if reset)
     C                     MOVEL'Y'       W0TRN   1
      * Set control to display first screen
     C                     Z-ADD1         W0SCR   30
      * Conduct screen conversation
     C           W0TRN     DOWEQ'Y'
      * Convert internal to external form
     C                     EXSR MNCV#K
      * Is bypass key screen still viable?
     C           W0BYP     IFEQ 'Y'
     C           #1AIC3    IFEQ *ZERO                      Company Number
     C           #1C4NB    OREQ *ZERO                      Order Number
     C           #1DGSX    OREQ *BLANK                     ED Export Docum
     C           #1KXCD    OREQ *BLANK                     Country Code
      * One or more key fields is blank
     C           *IN30     OREQ '1'
      * HOME: Reset screen fields
     C                     MOVEL'N'       W0BYP
     C                     END
     C                     END
      * Bypass key screen
     C           W0BYP     IFEQ 'N'
      * Display key screen
     C                     EXSR BBEXFM
     C                     END
      * Cancel key screen bypass
     C                     MOVEL'N'       W0BYP
      * Process response to key screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            BDHMKY
      * Process key screen input
     C                     CAS            BEPRKY
     C                     END
     C           W0TRN     DOWEQ'R'
     C                     MOVEL'Y'       W0TRN
     C                     EXSR BEPRKY
     C                     END
      *
     C                     END
     C                     END
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBEXFM    BEGSR
      *================================================================
      * Display key screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSAK
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
     C                     MOVEL'K'       W0GRP   1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDKEY
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         BDHMKY    BEGSR
      *================================================================
      * Process HOME key
      *================================================================
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         BDEXIT    ENDSR
      /EJECT
     CSR         BEPRKY    BEGSR
      *================================================================
      * Process key screen input
      *================================================================
      * Initialise detail screen
     C                     EXSR MAIZ#1
      * Validate key fields
     C                     EXSR BFVLKY
     C           *IN99     CABEQ'1'       BEEXIT
     C           YPMTFD    CABNE*BLANKS   BEEXIT
      * Check for existing record
     C           KRTV      KLIST
     C                     KFLD           MRAIC3           Company Number
     C                     KFLD           MRC4NB           Order Number
     C                     KFLD           MRDGSX           ED Export Docum
     C                     KFLD           MRKXCD           Country Code
      * Setup key
     C                     Z-ADD#1AIC3    MRAIC3
     C                     Z-ADD#1C4NB    MRC4NB
     C                     MOVEL#1DGSX    MRDGSX
     C                     MOVEL#1KXCD    MRKXCD
     C           KRTV      CHAIN@MRREWT              9091  *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     SETON                     9931  *
     C                     GOTO BEEXIT
     C                     END                             FI 91
      *
      * If record does not exist, error
     C           *IN90     IFEQ '1'
     C                     SETON                     9931  *
      * Send message 'Export Doc Order Hdr   NF'
     C                     MOVEL'USR2743' ZAMSID
     C                     EXSR ZASNMS
     C                     ELSE
     C                     EXSR MBFL#1
      * CALC: Detail screen function fields
      * DTL.PHIS Action Desc USR = Condition name of DTL.EDE PHIS Action
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 2159113   Y2LSNO  70       List number
     C                     PARM #DIFSC    W0INVL 25        EDE PHIS Action
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DK3U1    PARM           W0CNNM 25        PHIS Action Des
      *
      * DTL.EDE Reason f/Replcmnt Dsc = Condition name of DTL.EDE Reason
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 2150677   Y2LSNO  70       List number
     C                     PARM #DHUSC    W0INVL 25        EDE Reason f_Re
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DJRU1    PARM           W0CNNM 25        EDE Reason f/Re
      *
      * DTL.EDE Shipment Type Desc = Condition name of DTL.EDE Shipment T
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 2150685   Y2LSNO  70       List number
     C                     PARM #DHVSC    W0INVL 25        EDE Shipment Ty
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DJSU1    PARM           W0CNNM 25        EDE Shipment Ty
      *
      * USER: Initialize detail screen (existing record)
      * Set Document Date.
      * CASE: DTL.ED Document Date is Not entered
     C           #1PADT    IFEQ *ZERO                      *IF
     C                     Z-ADD##JDT     #1PADT           ED Document Dat
     C                     END                             *FI
      * Get/Set Export Doc Order Hdr Ext Info on Screen.
      * CASE: *OTHERWISE
      * R16637 DN 09/28/20-Set 'NLL' for Unused Consignor/Consignee PHIS
      * DO2416 DN 04/14/22-Added Port of Entry.
      * Rtv PHIS Info         RT - Export Doc Order Hdr Ext  * 
     C                     EXSR SARVGN
      * Default PHIS Action Code to New 'N' if Blank.
      * CASE:
      *  - NOTc1
      *   |- c1    : DTL.EDE PHIS Action is Valid Values
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DIFSC    IFEQ 'X'                        *IF
     C           #DIFSC    OREQ 'N'
     C           #DIFSC    OREQ 'R'
     C           #DIFSC    OREQ 'C'
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       #DIFSC           EDE PHIS Action
     C                     END                             *FI
      * R14822 DN 04/11/19-If Sent to PHIS, Upd PHIS Action to Change if
      * CASE:
      *  - c1 AND c2 AND NOTc3
      *   |- c1    : PAR.ED Print Status is Print/Send to PHIS
      *   |- c2    : DTL.EDE PHIS Action is New
      *   |- c3    : 2ND.EDE PHIS Process Status is Error
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2C8SX    IFEQ 'S'                        *IF
     C           #DIFSC    IFEQ 'N'                        *IF
     C           #DIESC    IFEQ '2'                        *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Upd PHIS Action Sts   RT - Export Doc Order Hdr Ext  * 
     C                     EXSR SBRVGN
     C                     MOVEL'C'       #DIFSC           EDE PHIS Action
     C                     END                             *FI
     C                     MOVEL#DIFSC    YL0001           EDE PHIS Action
      * R16637 DN 12/15/19-Move Logic Below to Check If Live with PHIS On
      * R16637 DN 12/15/20-Only Validate If Live With PHIS.
      * CASE: LCL.ED Live with PHIS is yes
     C           YL0002    IFEQ 'Y'                        *IF
      * R14822 DN 04/12/19-Convert to Output Only if New or Cancel.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.EDE PHIS Action is New
      *   |- c2    : LCL.EDE PHIS Action is Cancellation
      *   '-
     C           YL0001    IFEQ 'N'                        *IF
     C           YL0001    OREQ 'X'                        *OR
     C                     MOVEL'Y'       YL0003           Output Only 1 U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0003           Output Only 1 U
     C                     END                             *FI
     C                     END                             *FI
      * DO2416 DN 03/29/22-Set Submit Status.
      * CASE: *OTHERWISE
      * Default to 'Unsubmitted' if Blanks.
      * CASE:
      *  - NOTc1
      *   |- c1    : DTL.ED Submit Status is *ALL values
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1LKSC    IFEQ 'S'                        *IF
     C           #1LKSC    OREQ 'U'
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'U'       #1LKSC           ED Submit Statu
     C                     END                             *FI
      * DTL.ED Submit Status Dsc U = Condition name of DTL.ED Submit Stat
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 2204390   Y2LSNO  70       List number
     C                     PARM #1LKSC    W0INVL 25        ED Submit Statu
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DQ8U1    PARM           W0CNNM 25        ED Submit Statu
      *
      * DTL.PHIS Action Desc USR = Condition name of DTL.EDE PHIS Action
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 2159113   Y2LSNO  70       List number
     C                     PARM #DIFSC    W0INVL 25        EDE PHIS Action
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DK3U1    PARM           W0CNNM 25        PHIS Action Des
      *
      * DTL.EDE Reason f/Replcmnt Dsc = Condition name of DTL.EDE Reason
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 2150677   Y2LSNO  70       List number
     C                     PARM #DHUSC    W0INVL 25        EDE Reason f_Re
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DJRU1    PARM           W0CNNM 25        EDE Reason f/Re
      *
      * DTL.EDE Shipment Type Desc = Condition name of DTL.EDE Shipment T
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 2150685   Y2LSNO  70       List number
     C                     PARM #DHVSC    W0INVL 25        EDE Shipment Ty
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DJSU1    PARM           W0CNNM 25        EDE Shipment Ty
      *
      * 2ND.EDE PHIS Process Sts Dsc = Condition name of 2ND.EDE PHIS Pro
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 2159108   Y2LSNO  70       List number
     C                     PARM #DIESC    W0INVL 25        EDE PHIS Proces
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DK4U1    PARM           W0CNNM 25        EDE PHIS Proces
      *
      * Pre-Validation for PHIS. Check if Transit Country is Required.
      * CASE: DTL.EDE Transit Country is Blank
     C           #DYDAA    IFEQ *BLANK                     *IF
      * Check if Attach Type 'SPM' & Subtype 'L' (Transit/Letterhead)
      * exist. If exist, send info msg.
      * Val Pre-Validtn 4/PHIS XF - Export Doc Order Hdr  * 
     C                     CALL 'PUKJXFR'              90  Val Pre-Validtn
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0001  30       Company Number
     C                     PARM P1C4NB    WQ0002  70       Order Number
     C                     PARM P1DGSX    WQ0003  1        ED Export Docum
     C                     PARM P1KXCD    WQ0004  6        Country Code
     C                     PARM ##PGM     WQ0005 10        Program name US
     C                     PARM *BLANK    WQ0006  1        SUP/SPM Have Pr
     C           YL0004    PARM *BLANK    WQ0007  6        PHIS Pre-Validt
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUKJXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.PHIS Pre-Validtn Err USR is Transit Country
     C           YL0004    IFEQ @CN,002                    *IF
      * LCL.PHIS Pre-Validtn Err Dsc = Condition name of LCL.PHIS Pre-Val
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 2162146   Y2LSNO  70       List number
     C                     PARM YL0004    W0INVL 25        PHIS Pre-Validt
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           YL0005    PARM           W0CNNM 25        PHIS Pre-Validt
      *
     C                     Z-ADD1         ZQ      50
     C           @CN,003   CAT  @CN,004:ZQYL0006    P      Generic Message
     C                     Z-ADD1         ZQ      50
     C           YL0006    CAT  YL0005:ZQ YL0006    P      Generic Message
     C                     Z-ADD1         ZQ      50
     C           YL0006    CAT  @CN,005:ZQYL0006    P      Generic Message
      * Setup message data for message
     C                     MOVELYL0006    ZA0001           Generic Message
      * Send message 'Generic Message 80'
     C                     MOVEL'USR4976' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
      * DO2416 DN 04/12/22-Set Slaughter & Processing Plant No.
      * CASE: *OTHERWISE
      * Slaughter Plant No.
      * CASE: DB1.ED Slaughter Plant Name is Blank
     C           MRQJTX    IFEQ *BLANK                     *IF
      * RTV Alpha Value        RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDMRAIC3    WL0001           Company Number
     C                     MOVEL'PLTESTNO'WL0002    P      Company Value C
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    #1QJTX    P      System Value Al
     C                     END                             *FI
      * Processing Plant No.
      * CASE: DB1.ED Manufact Plant Name is Blank
     C           MRQQTX    IFEQ *BLANK                     *IF
      * RTV Alpha Value        RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDMRAIC3    WL0001           Company Number
     C                     MOVEL'PLTESTNO'WL0002    P      Company Value C
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    #1QQTX    P      System Value Al
     C                     END                             *FI
     C                     END
      *
      *..................................................
     C   99                GOTO BEEXIT
      *
     C           YPMTFD    IFEQ *BLANK
      * No error: Display and process details
     C                     EXSR CADSDA
     C                     END
      *
      *================================================================
     CSR         BEEXIT    ENDSR
      /EJECT
     CSR         BFVLKY    BEGSR
      *================================================================
      * Validate key fields
      *================================================================
      * Validate Order Number and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV1C4NB    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,006                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #1C4NB           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #1C4NB           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     9931  *
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     END
      * Check relations
      * Check restriction within
     C                     EXSR VACKRL
      * Check restriction within
     C                     EXSR VBCKRL
      * Order Number required
     C           #1C4NB    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         BFEXIT    ENDSR
      /EJECT
     CSR         CADSDA    BEGSR
      *================================================================
      * Display and process detail screen
      *================================================================
      * Conduct detail screen conversation
      * - repeat until screen control flag is reset:
     C           W0TRN     DOWEQ'Y'
      * Convert internal to external form
     C                     EXSR MOCV#D
      * Display detail screen
     C                     EXSR CBEXFM
      * Process response to detail screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * Redisplay previous screen
     C   12                CAS            CCDSPV
      * HOME: Reset screen fields
     C   30                CAS            CCDSPV
      * Process detail screen input
     C                     CAS            CFPRSC
     C                     END
     C           W0TRN     IFEQ 'R'
     C           W0PMD     IFEQ 'ADD'
     C                     EXSR MAIZ#1
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         CBEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
     C           W0HLP     DOUEQ'N'
     C           W0ROL     ANDEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Update screen time
     C                     TIME           ##TME
     C           W0SCR     IFEQ 1
      * Set error
     C                     MOVEAINSCR1    *IN,31
     C                     MOVEL'1'       W0GRP   1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y1SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT2
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
     C                     ELSE
     C           W0SCR     IFEQ 2
      * Set error
     C                     MOVEAINSCR2    *IN,31
     C                     MOVEL'2'       W0GRP   1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y2SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT3
     C                     EXFMT#RCDDTL2
      * Test cursor
     C                     EXSR Y8TST
     C                     END
     C                     END
      * Reset roll flag
     C                     MOVEL'N'       W0ROL   1
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Show next page of details
     C   27                EXSR CDNXSC
      * Show previous page of details
     C   28                EXSR CEPVSC
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CBEXIT    ENDSR
      /EJECT
     CSR         CCDSPV    BEGSR
      *================================================================
      * Redisplay previous screen
      *================================================================
     C   30                MOVEL'R'       W0TRN
     C   12                MOVEL'K'       W0TRN
      * Initialise error memories
     C                     MOVE *ZERO     INSCR1
     C                     MOVE *ZERO     INSCR2
      *================================================================
     CSR         CCEXIT    ENDSR
      /EJECT
     CSR         CDNXSC    BEGSR
      *================================================================
      * Display next screen
      *================================================================
      * Set roll flag
     C                     MOVEL'Y'       W0ROL   1
     C                     Z-ADD2         W0SCR
      *================================================================
     CSR         CDEXIT    ENDSR
      /EJECT
     CSR         CEPVSC    BEGSR
      *================================================================
      * Display previous screen
      *================================================================
      * Set roll flag
     C                     MOVEL'Y'       W0ROL   1
     C                     Z-ADD1         W0SCR
      *================================================================
     CSR         CEEXIT    ENDSR
      /EJECT
     CSR         CFPRSC    BEGSR
      *================================================================
      * Validate record
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate details
     C                     MOVE *ZEROS    INSCR1
     C                     MOVE *ZEROS    INSCR2
     C                     EXSR DCVLDL
      * Display first screen in error
     C           INSCR1    IFNE *ZERO
     C                     Z-ADD1         W0SCR
     C                     ELSE
     C           INSCR2    IFNE *ZERO
     C                     Z-ADD2         W0SCR
     C                     END
     C                     END
      * QUIT if error:
     C           *IN99     CABEQ'1'       CFEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       CFEXIT
      * Prompt for confirmation
     C                     EXSR EAPMCF
      * Quit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO CFEXIT
     C                     END
      * No error: update record
     C                     EXSR EBPR##
      *================================================================
     CSR         CFEXIT    ENDSR
      /EJECT
     CSR         DCVLDL    BEGSR
      *================================================================
      * Validate details
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Validate EDE PHIS Action
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DIFSC'  IFEQ YPMTFD
     C           W0SCR     ANDEQ1
      * EDE PHIS Action
     C                     MOVEL#DIFSC    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHIFSC
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHIFSC
     C           W0INVL    WHEQ 'C'                        C
     C                     Z-ADD2         ZHIFSC
     C           W0INVL    WHEQ 'R'                        R
     C                     Z-ADD3         ZHIFSC
     C           W0INVL    WHEQ 'X'                        X
     C                     Z-ADD4         ZHIFSC
     C                     ENDSL
     C                     EXFMTZGIFSC
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHIFSC    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHIFSC    WHEQ 2
     C                     MOVEL'C'       W0INVL           C
     C           ZHIFSC    WHEQ 3
     C                     MOVEL'R'       W0INVL           R
     C           ZHIFSC    WHEQ 4
     C                     MOVEL'X'       W0INVL           X
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DIFSC
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,31
     C                     SETON                     99    *
     C                     END
      * Validate ED Submit Status
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1LKSC'  IFEQ YPMTFD
     C           W0SCR     ANDEQ1
      * ED Submit Status
     C                     MOVEL#1LKSC    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHLKSC
     C                     SELEC
     C           W0INVL    WHEQ 'S'                        S
     C                     Z-ADD1         ZHLKSC
     C           W0INVL    WHEQ 'U'                        U
     C                     Z-ADD2         ZHLKSC
     C                     ENDSL
     C                     EXFMTZGLKSC
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHLKSC    WHEQ 1
     C                     MOVEL'S'       W0INVL           S
     C           ZHLKSC    WHEQ 2
     C                     MOVEL'U'       W0INVL           U
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1LKSC
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,32
     C                     SETON                     99    *
     C                     END
      * Validate EDE Reason f_Replcmnt Sts
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DHUSC'  IFEQ YPMTFD
     C           W0SCR     ANDEQ1
      * EDE Reason f_Replcmnt Sts
     C                     MOVEL#DHUSC    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHHUSC
     C                     SELEC
     C           W0INVL    WHEQ '4'                        4
     C                     Z-ADD1         ZHHUSC
     C           W0INVL    WHEQ '5'                        5
     C                     Z-ADD2         ZHHUSC
     C           W0INVL    WHEQ '3'                        3
     C                     Z-ADD3         ZHHUSC
     C           W0INVL    WHEQ '2'                        2
     C                     Z-ADD4         ZHHUSC
     C           W0INVL    WHEQ '1'                        1
     C                     Z-ADD5         ZHHUSC
     C                     ENDSL
     C                     EXFMTZGHUSC
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHHUSC    WHEQ 1
     C                     MOVEL'4'       W0INVL           4
     C           ZHHUSC    WHEQ 2
     C                     MOVEL'5'       W0INVL           5
     C           ZHHUSC    WHEQ 3
     C                     MOVEL'3'       W0INVL           3
     C           ZHHUSC    WHEQ 4
     C                     MOVEL'2'       W0INVL           2
     C           ZHHUSC    WHEQ 5
     C                     MOVEL'1'       W0INVL           1
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DHUSC
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,33
     C                     SETON                     99    *
     C                     END
      * Validate ED Document Date
      * External date
     C                     Z-ADDV1PADT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C                     Z-ADDXDINDT    #1PADT
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,34
     C                     SETON                     99    *
     C                     END
      * Validate EDE Shipment Type Sts
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DHVSC'  IFEQ YPMTFD
     C           W0SCR     ANDEQ1
      * EDE Shipment Type Sts
     C                     MOVEL#DHVSC    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHHVSC
     C                     SELEC
     C           W0INVL    WHEQ '1'                        1
     C                     Z-ADD1         ZHHVSC
     C           W0INVL    WHEQ '2'                        2
     C                     Z-ADD2         ZHHVSC
     C           W0INVL    WHEQ '3'                        3
     C                     Z-ADD3         ZHHVSC
     C           W0INVL    WHEQ '7'                        7
     C                     Z-ADD4         ZHHVSC
     C           W0INVL    WHEQ '4'                        4
     C                     Z-ADD5         ZHHVSC
     C           W0INVL    WHEQ '5'                        5
     C                     Z-ADD6         ZHHVSC
     C           W0INVL    WHEQ '6'                        6
     C                     Z-ADD7         ZHHVSC
     C                     ENDSL
     C                     EXFMTZGHVSC
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHHVSC    WHEQ 1
     C                     MOVEL'1'       W0INVL           1
     C           ZHHVSC    WHEQ 2
     C                     MOVEL'2'       W0INVL           2
     C           ZHHVSC    WHEQ 3
     C                     MOVEL'3'       W0INVL           3
     C           ZHHVSC    WHEQ 4
     C                     MOVEL'7'       W0INVL           7
     C           ZHHVSC    WHEQ 5
     C                     MOVEL'4'       W0INVL           4
     C           ZHHVSC    WHEQ 6
     C                     MOVEL'5'       W0INVL           5
     C           ZHHVSC    WHEQ 7
     C                     MOVEL'6'       W0INVL           6
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DHVSC
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,37
     C                     SETON                     99    *
     C                     END
      * Validate EDE Frozen_Shelf Life Sts
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DHWSC'  IFEQ YPMTFD
     C           W0SCR     ANDEQ1
      * EDE Frozen_Shelf Life Sts
     C                     MOVEL#DHWSC    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHHWSC
     C                     SELEC
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD1         ZHHWSC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD2         ZHHWSC
     C                     ENDSL
     C                     EXFMTZGHWSC
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHHWSC    WHEQ 1
     C                     MOVEL'Y'       W0INVL           Y
     C           ZHHWSC    WHEQ 2
     C                     MOVEL'N'       W0INVL           N
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DHWSC
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,42
     C                     SETON                     99    *
     C                     END
      * Validate ED Xlate Desc to Country
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1CVSX'  IFEQ YPMTFD
     C           W0SCR     ANDEQ1
      * ED Xlate Desc to Country
     C                     MOVEL#1CVSX    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHCVSX
     C                     SELEC
     C           W0INVL    WHEQ 'S'                        S
     C                     Z-ADD1         ZHCVSX
     C                     ENDSL
     C                     EXFMTZGCVSX
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHCVSX    WHEQ 1
     C                     MOVEL'S'       W0INVL           S
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1CVSX
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,44
     C                     SETON                     99    *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate detail screen fields
      * R13074 DN 05/23/18-Allow for F4=Prompt.
      * CASE: DTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * Country of Final Destination.
      * CASE: PGM.*Cursor field <IS> DTL.EDE Country of Final Dest
     C           W0SCR     IFEQ 1                          *
     C           W0CFL     ANDEQ'#DX1AA'                   *IF
      * SEL Country Active     SR - Country  * 
     C                     CALL 'PDEGSRR'              90  SEL Country Act
     C                     PARM *BLANK    W0RTN   7
     C           #DX1AA    PARM #DX1AA    WQ0012  6        Country Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEGSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,38           *
     C                     END
     C                     END                             *FI
      * Transit Country.
      * CASE: PGM.*Cursor field <IS> DTL.EDE Transit Country
     C           W0SCR     IFEQ 1                          *
     C           W0CFL     ANDEQ'#DYDAA'                   *IF
      * SEL Country Active     SR - Country  * 
     C                     CALL 'PDEGSRR'              90  SEL Country Act
     C                     PARM *BLANK    W0RTN   7
     C           #DYDAA    PARM #DYDAA    WQ0013  6        Country Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEGSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,39           *
     C                     END
     C                     END                             *FI
      * Port of Entry.                                DO2416 DN 04/14/22
      * CASE: PGM.*Cursor field <IS> DTL.EDE Port of Entry USR
     C           W0SCR     IFEQ 1                          *
     C           W0CFL     ANDEQ'#DRCU1'                   *IF
      * Sel Port of Entry     SR - Country Port of Entry  * 
     C                     CALL 'PUV9SRR'              90  Sel Port of Ent
     C                     PARM *BLANK    W0RTN   7
     C           #DRCU1    PARM #DRCU1    WQ0014 40        Port of Entry N
     C                     PARM #1KXCD    WQ0015  6        Country Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUV9SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,41           *
     C                     END
     C                     END                             *FI
      * Consignor State.
      * CASE: PGM.*Cursor field <IS> DTL.ED Consignor State
     C           W0SCR     IFEQ 1                          *
     C           W0CFL     ANDEQ'#1Z7AA'                   *IF
      * SEL State              SR - State  * 
     C                     CALL 'CAAHSRR'              90  SEL State
     C                     PARM *BLANK    W0RTN   7
     C           #1Z7AA    PARM #1Z7AA    WQ0016  2        State Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAAHSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,50           *
     C                     END
     C                     END                             *FI
      * Consignor Country.                     R16637 DN 09/29/20-Added.
      * CASE: PGM.*Cursor field <IS> DTL.ED Consignor Country Code
     C           W0SCR     IFEQ 1                          *
     C           W0CFL     ANDEQ'#1Z8AA'                   *IF
      * SEL Country Active     SR - Country  * 
     C                     CALL 'PDEGSRR'              90  SEL Country Act
     C                     PARM *BLANK    W0RTN   7
     C           #1Z8AA    PARM #1Z8AA    WQ0017  6        Country Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEGSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,52           *
     C                     END
     C                     END                             *FI
      * Consignee State.
      * CASE: PGM.*Cursor field <IS> DTL.ED Consignee State
     C           W0SCR     IFEQ 1                          *
     C           W0CFL     ANDEQ'#1AAAB'                   *IF
      * SEL State              SR - State  * 
     C                     CALL 'CAAHSRR'              90  SEL State
     C                     PARM *BLANK    W0RTN   7
     C           #1AAAB    PARM #1AAAB    WQ0018  2        State Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAAHSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,59           *
     C                     END
     C                     END                             *FI
      * Consignee Country.                     R16637 DN 09/29/20-Added.
      * CASE: PGM.*Cursor field <IS> DTL.ED Consignee Country Code
     C           W0SCR     IFEQ 1                          *
     C           W0CFL     ANDEQ'#1ABAB'                   *IF
      * SEL Country Active     SR - Country  * 
     C                     CALL 'PDEGSRR'              90  SEL Country Act
     C                     PARM *BLANK    W0RTN   7
     C           #1ABAB    PARM #1ABAB    WQ0019  6        Country Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEGSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,61           *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Validations.
      * CASE: *OTHERWISE
      * PHIS Action.                                  R14822 DN 04/11/19
      * CASE: DTL.EDE PHIS Action NE LCL.EDE PHIS Action
     C           #DIFSC    IFNE YL0001                     *IF
      * R16637 DN 12/15/20-Move Logic Below to Check If Live with PHIS On
      * R16637 DN 12/15/20-Only Validate If Live With PHIS.
      * CASE: LCL.ED Live with PHIS is yes
     C           YL0002    IFEQ 'Y'                        *IF
      * If PHIS Process Sts in Error, Allow to Select New or Cancel Only.
      * CASE: 2ND.EDE PHIS Process Status is Error
     C           #DIESC    IFEQ '2'                        *IF
      * Original Status is in Change Status. Must go to New or Cancel.
      * CASE: LCL.EDE PHIS Action is Change
     C           YL0001    IFEQ 'C'                        *IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DTL.EDE PHIS Action is New
      *   |- c2    : DTL.EDE PHIS Action is Cancellation
      *   '-
     C           #DIFSC    IFEQ 'N'                        *IF
     C           #DIFSC    OREQ 'X'                        *OR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           @CN,007   CAT  @CN,008:ZQYL0006    P      Generic Message
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0006    CAT  @CN,009:ZQYL0006    P      Generic Message
      * Setup message data for message
     C                     MOVELYL0006    ZA0002           Generic Message
     C                     MOVEL#DIFSC    ZA0003           EDE PHIS Action
      * Send message 'Generic Message 80 ERR 2'
     C                     MOVEL'USR5085' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,31           *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Status can't go from Change to New.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.EDE PHIS Action is Change
      *   |- c2    : DTL.EDE PHIS Action is New
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0001    IFEQ 'C'                        *IF
     C           #DIFSC    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD1         ZQ      50
     C           @CN,010   CAT  @CN,011:ZQYL0006    P      Generic Message
      * Setup message data for message
     C                     MOVELYL0006    ZA0004           Generic Message
     C                     MOVEL#DIFSC    ZA0005           EDE PHIS Action
      * Send message 'Generic Message 80 ERR 2'
     C                     MOVEL'USR5085' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,31           *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
      * Status can't go from New or Cancel to Any Status.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.EDE PHIS Action is New
      *   |- c2    : LCL.EDE PHIS Action is Cancellation
      *   '-
     C           YL0001    IFEQ 'N'                        *IF
     C           YL0001    OREQ 'X'                        *OR
      * Convert PHIS Action from input to output. LCL.Output Only 1 USR=Y
     C                     END                             *FI
      * Status can't go from Replace to Anything but only Cancel or Chang
      * CASE: LCL.EDE PHIS Action is Replacement
     C           YL0001    IFEQ 'R'                        *IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DTL.EDE PHIS Action is Change
      *   |- c2    : DTL.EDE PHIS Action is Cancellation
      *   '-
     C           #DIFSC    IFEQ 'C'                        *IF
     C           #DIFSC    OREQ 'X'                        *OR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           @CN,010   CAT  @CN,012:ZQYL0006    P      Generic Message
     C                     Z-ADD1         ZQ      50
     C           YL0006    CAT  @CN,013:ZQYL0006    P      Generic Message
      * Setup message data for message
     C                     MOVELYL0006    ZA0006           Generic Message
     C                     MOVEL#DIFSC    ZA0007           EDE PHIS Action
      * Send message 'Generic Message 80 ERR 2'
     C                     MOVEL'USR5085' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,31           *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * R16637 DN 09/28/20-Validation for Consignor/Consignee.
      * CASE: *OTHERWISE
      * Required Fields If Live with PHIS.
      * CASE: DTL.ED Live with PHIS is yes
     C           #1C2SX    IFEQ 'Y'                        *IF
      * Consignor Addr 4/City.
      * CASE: DTL.ED Consignor Addr 4 is Blank
     C           #1PPU1    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1PPU1    ZA0008           ED Consignor Ad
      * Send message 'Value Required'
     C                     MOVEL'USR1852' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,49           *
      *
     C                     END                             *FI
      * Consignor Zip.
      * CASE: DTL.ED Consignor Postal is Not Entered
     C           #1PDU1    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1PDU1    ZA0009           ED Consignor Po
      * Send message 'Value Required'
     C                     MOVEL'USR1852' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,51           *
      *
     C                     END                             *FI
      * Consignor Country.
      * CASE: DTL.ED Consignor Country Code is Blank
     C           #1Z8AA    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1Z8AA    ZA0010           ED Consignor Co
      * Send message 'Value Required'
     C                     MOVEL'USR1852' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,52           *
      *
     C                     END                             *FI
      * Consignor State if Country is USA.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.ED Consignor State is *Blanks
      *   |- c2    : DTL.ED Consignor Country Code is USA
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1Z7AA    IFEQ *BLANK                     *IF
     C           #1Z8AA    IFEQ 'USA'                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#1Z7AA    ZA0011           ED Consignor St
      * Send message 'Value Required'
     C                     MOVEL'USR1852' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,50           *
      *
     C                     END                             *FI
      * Consignee Addr 4/City.
      * CASE: DTL.ED Consignee Addr 4 is Blank
     C           #1SDTX    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1SDTX    ZA0012           ED Consignee Ad
      * Send message 'Value Required'
     C                     MOVEL'USR1852' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,58           *
      *
     C                     END                             *FI
      * Consignee Country.
      * CASE: DTL.ED Consignee Country Code is Blank
     C           #1ABAB    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1ABAB    ZA0013           ED Consignee Co
      * Send message 'Value Required'
     C                     MOVEL'USR1852' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,61           *
      *
     C                     END                             *FI
      * Applicant/Billing Clerk.
      * CASE: *OTHERWISE
      * First Name.
      * CASE: DTL.EDE Appl/Billing First Nm is Not Entered
     C           #DJPU1    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DJPU1    ZA0014           EDE Appl_Billin
      * Send message 'Value Required'
     C                     MOVEL'USR1852' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,63           *
      *
     C                     END                             *FI
      * Last Name.
      * CASE: DTL.EDE Appl/Billing Last Nm is Not Entered
     C           #DJQU1    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DJQU1    ZA0015           EDE Appl_Billin
      * Send message 'Value Required'
     C                     MOVEL'USR1852' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,64           *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
      * Consignor State.
      * CASE: DTL.ED Consignor State is State code not Blanks
     C           #1Z7AA    IFNE *BLANK                     *IF
      * Val State & Active     RT - State  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1Z7AA    WL0004    P      State Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    YL0007    P      Record Status
      * Check Return Code.
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * CASE: LCL.Record Status is Inactive
     C           YL0007    IFEQ 'I'                        *IF
      * Setup message data for message
     C                     MOVEL#1Z7AA    ZA0016           ED Consignor St
      * Send message 'State Inactive'
     C                     MOVEL'USR5197' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,50           *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1Z7AA    ZA0017           ED Consignor St
      * Send message 'State file not found'
     C                     MOVEL'USR1838' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,50           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Consignor Country.
      * CASE: DTL.ED Consignor Country Code is Entered
     C           #1Z8AA    IFNE *BLANK                     *IF
      * Val Country & Active   RT - Country  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1Z8AA    WL0006    P      Country Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    YL0007    P      Record Status
      * Check Return Code.
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * CASE: LCL.Record Status is Inactive
     C           YL0007    IFEQ 'I'                        *IF
      * Setup message data for message
     C                     MOVEL#1Z8AA    ZA0018           ED Consignor Co
      * Send message 'Country Inactive'
     C                     MOVEL'USR5198' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,52           *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1Z8AA    ZA0019           ED Consignor Co
      * Send message 'Country Code           NX'
     C                     MOVEL'USR2030' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,52           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Consignee State.
      * CASE: DTL.ED Consignee State is State code not Blanks
     C           #1AAAB    IFNE *BLANK                     *IF
      * Val State & Active     RT - State  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1AAAB    WL0004    P      State Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    YL0007    P      Record Status
      * Check Return Code.
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * CASE: LCL.Record Status is Inactive
     C           YL0007    IFEQ 'I'                        *IF
      * Setup message data for message
     C                     MOVEL#1AAAB    ZA0020           ED Consignee St
      * Send message 'State Inactive'
     C                     MOVEL'USR5197' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,59           *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1AAAB    ZA0021           ED Consignee St
      * Send message 'State file not found'
     C                     MOVEL'USR1838' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,59           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Consignee Country.
      * CASE: DTL.ED Consignee Country Code is Entered
     C           #1ABAB    IFNE *BLANK                     *IF
      * Val Country & Active   RT - Country  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1ABAB    WL0006    P      Country Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    YL0007    P      Record Status
      * Check Return Code.
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * CASE: LCL.Record Status is Inactive
     C           YL0007    IFEQ 'I'                        *IF
      * Setup message data for message
     C                     MOVEL#1ABAB    ZA0022           ED Consignee Co
      * Send message 'Country Inactive'
     C                     MOVEL'USR5198' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,61           *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1ABAB    ZA0023           ED Consignee Co
      * Send message 'Country Code           NX'
     C                     MOVEL'USR2030' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,61           *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * DO2416 DN 03/30/22-Set Descriptions.
      * CASE: *OTHERWISE
      * DTL.ED Submit Status Dsc U = Condition name of DTL.ED Submit Stat
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 2204390   Y2LSNO  70       List number
     C                     PARM #1LKSC    W0INVL 25        ED Submit Statu
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DQ8U1    PARM           W0CNNM 25        ED Submit Statu
      *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Detail screen function fields
      * DTL.PHIS Action Desc USR = Condition name of DTL.EDE PHIS Action
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 2159113   Y2LSNO  70       List number
     C                     PARM #DIFSC    W0INVL 25        EDE PHIS Action
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DK3U1    PARM           W0CNNM 25        PHIS Action Des
      *
      * DTL.EDE Reason f/Replcmnt Dsc = Condition name of DTL.EDE Reason
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 2150677   Y2LSNO  70       List number
     C                     PARM #DHUSC    W0INVL 25        EDE Reason f_Re
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DJRU1    PARM           W0CNNM 25        EDE Reason f/Re
      *
      * DTL.EDE Shipment Type Desc = Condition name of DTL.EDE Shipment T
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 2150685   Y2LSNO  70       List number
     C                     PARM #DHVSC    W0INVL 25        EDE Shipment Ty
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DJSU1    PARM           W0CNNM 25        EDE Shipment Ty
      *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate detail screen relations
      * Set Required Data Fields Based on PHIS Action Code.
      * CASE: DTL.EDE PHIS Action is New
     C           #DIFSC    IFEQ 'N'                        *IF
     C                     MOVEL*BLANK    #1QGTX           ED Modified Tex
     C                     MOVEL'original'#1QGTX           ED Modified Tex
     C                     MOVEL*BLANK    #DHUSC           EDE Reason f_Re
     C                     MOVEL*BLANK    #DJRU1           EDE Reason f/Re
     C                     ELSE
      * CASE: DTL.EDE PHIS Action is Replacement
     C           #DIFSC    IFEQ 'R'                        *IF
     C                     MOVEL*BLANK    #1QGTX           ED Modified Tex
     C                     MOVEL'inlieu'  #1QGTX           ED Modified Tex
      * R13074 DN 05/23/18-Replacement Reason must be selected.
      * CASE: DTL.EDE Reason f/Replcmnt Sts is Blank
     C           #DHUSC    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DHUSC    ZA0024           EDE Reason f_Re
      * Send message 'EDE Reason Must Select'
     C                     MOVEL'USR5076' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,33           *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: DTL.EDE PHIS Action is Cancellation
     C           #DIFSC    IFEQ 'X'                        *IF
     C                     MOVEL*BLANK    #1QGTX           ED Modified Tex
     C                     MOVEL'cancel'  #1QGTX           ED Modified Tex
     C                     MOVEL*BLANK    #DHUSC           EDE Reason f_Re
     C                     MOVEL*BLANK    #DJRU1           EDE Reason f/Re
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validations for Export Doc Order Hdr Ext File.
      * CASE: *OTHERWISE
      * Validate Country of Final Dest.
      * CASE: DTL.EDE Country of Final Dest is Entered
     C           #DX1AA    IFNE *BLANK                     *IF
      * RTV Desc, Status       RT - Country  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DX1AA    WL0008    P      Country Code
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0009    YN0016    P      Country Descrip
     C                     MOVELWL0010    YL0007    P      Record Status
      * Record Found?
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Country not active, throw error message.
      * CASE: LCL.Record Status is Inactive/Delete
     C           YL0007    IFEQ 'D'                        *IF
     C           YL0007    OREQ 'I'
     C                     Z-ADD*ZERO     ZQ      50
     C           @CN,014   CAT  @CN,015:ZQYL0006    P      Generic Message
      * Setup message data for message
     C                     MOVELYL0006    ZA0025           Generic Message
     C                     MOVEL#DX1AA    ZA0026           EDE Country of
      * Send message 'Generic Message 80 ERR 2'
     C                     MOVEL'USR5085' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,38           *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DX1AA    ZA0027           EDE Country of
      * Send message 'Country Master         NF'
     C                     MOVEL'USR1158' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,38           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate Transit Country.
      * CASE: *OTHERWISE
      * If Entered, Check Country is Active.
      * CASE: DTL.EDE Transit Country is Entered
     C           #DYDAA    IFNE *BLANK                     *IF
      * RTV Desc, Status       RT - Country  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DYDAA    WL0008    P      Country Code
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0009    YN0016    P      Country Descrip
     C                     MOVELWL0010    YL0007    P      Record Status
      * Record Found?
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Country not active, throw error message.
      * CASE: LCL.Record Status is Inactive/Delete
     C           YL0007    IFEQ 'D'                        *IF
     C           YL0007    OREQ 'I'
     C                     Z-ADD1         ZQ      50
     C           @CN,016   CAT  @CN,017:ZQYL0006    P      Generic Message
      * Setup message data for message
     C                     MOVELYL0006    ZA0028           Generic Message
     C                     MOVEL#DYDAA    ZA0029           EDE Transit Cou
      * Send message 'Generic Message 80 ERR 2'
     C                     MOVEL'USR5085' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,39           *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DYDAA    ZA0030           EDE Transit Cou
      * Send message 'Country Master         NF'
     C                     MOVEL'USR1158' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,39           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Check if Transit Country is Required.
      * CASE: DTL.EDE Transit Country is Blank
     C           #DYDAA    IFEQ *BLANK                     *IF
      * Check if Attach Type 'SPM' & Subtype 'L' (Transit/Letterhead)
      * exist. If exist, send error msg.
      * Val Pre-Validtn 4/PHIS XF - Export Doc Order Hdr  * 
     C                     CALL 'PUKJXFR'              90  Val Pre-Validtn
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0020  30       Company Number
     C                     PARM P1C4NB    WQ0021  70       Order Number
     C                     PARM P1DGSX    WQ0022  1        ED Export Docum
     C                     PARM P1KXCD    WQ0023  6        Country Code
     C                     PARM ##PGM     WQ0024 10        Program name US
     C                     PARM *BLANK    WQ0025  1        SUP/SPM Have Pr
     C           YL0004    PARM *BLANK    WQ0026  6        PHIS Pre-Validt
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUKJXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.PHIS Pre-Validtn Err USR is Transit Country
     C           YL0004    IFEQ @CN,002                    *IF
      * LCL.PHIS Pre-Validtn Err Dsc = Condition name of LCL.PHIS Pre-Val
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 2162146   Y2LSNO  70       List number
     C                     PARM YL0004    W0INVL 25        PHIS Pre-Validt
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           YL0005    PARM           W0CNNM 25        PHIS Pre-Validt
      *
     C                     Z-ADD1         ZQ      50
     C           @CN,003   CAT  @CN,004:ZQYL0006    P      Generic Message
     C                     Z-ADD1         ZQ      50
     C           YL0006    CAT  YL0005:ZQ YL0006    P      Generic Message
     C                     Z-ADD1         ZQ      50
     C           YL0006    CAT  @CN,005:ZQYL0006    P      Generic Message
      * Setup message data for message
     C                     MOVELYL0006    ZA0031           Generic Message
     C                     MOVEL#DYDAA    ZA0032           EDE Transit Cou
      * Send message 'Generic Message 80 ERR 2'
     C                     MOVEL'USR5085' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,39           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Port of Entry.                                DO2416 DN 04/14/22
      * CASE: DTL.EDE Port of Entry USR is Not Blank
     C           #DRCU1    IFNE *BLANK                     *IF
      * Val Port of Entry     RT - Country Port of Entry  * 
     C                     EXSR SHRVGN
      * Check Return Code.
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Not Active, Throw Error Message.
      * CASE:
      *  - NOTc1
      *   |- c1    : LCL.Record Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0007    IFEQ 'A'                        *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD1         ZQ      50
     C           @CN,018   CAT  @CN,019:ZQYL0006    P      Generic Message
      * Setup message data for message
     C                     MOVELYL0006    ZA0033           Generic Message
     C                     MOVEL#DRCU1    ZA0034           EDE Port of Ent
      * Send message 'Generic Message 80 ERR 2'
     C                     MOVEL'USR5085' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,41           *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Country Port of Entry  NF'
     C                     MOVEL'USR5243' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * EDE PHIS Action required
     C           #DIFSC    IFEQ *BLANK                     IF
     C           *IN79     ANDEQ'0'
     C           YPMTFD    ANDEQ*BLANKS
     C                     MOVEL'1'       @I1,31
     C                     SETON                     99    *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * ED Submit Status required
     C           #1LKSC    IFEQ *BLANK                     IF
     C           *IN78     ANDEQ'0'
     C           YPMTFD    ANDEQ*BLANKS
     C                     MOVEL'1'       @I1,32
     C                     SETON                     99    *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * ED Document Date required
     C           #1PADT    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     MOVEL'1'       @I1,34
     C                     SETON                     99    *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * ED USDA Cert Nbr US required
     C           #1QDTX    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     MOVEL'1'       @I1,35
     C                     SETON                     99    *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * EDE Shipment Type Sts required
     C           #DHVSC    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     MOVEL'1'       @I1,37
     C                     SETON                     99    *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * EDE Country of Final Dest required
     C           #DX1AA    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     MOVEL'1'       @I1,38
     C                     SETON                     99    *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * ED Shipping Marks Txt required
     C           #1ORNA    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     MOVEL'1'       @I1,40
     C                     SETON                     99    *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * EDE Frozen_Shelf Life Sts required
     C           #DHWSC    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     MOVEL'1'       @I1,42
     C                     SETON                     99    *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * ED Plant Number required
     C           #1ZNCD    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     MOVEL'1'       @I1,43
     C                     SETON                     99    *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * ED Consignor Name required
     C           #1PUTX    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     MOVEL'1'       @I1,45
     C                     SETON                     99    *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * ED Consignor Addr 1 required
     C           #1PVTX    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     MOVEL'1'       @I1,46
     C                     SETON                     99    *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * ED Consignee Name required
     C           #1RHTX    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     MOVEL'1'       @I1,54
     C                     SETON                     99    *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * ED Consignee Addr 1 required
     C           #1RITX    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     MOVEL'1'       @I1,55
     C                     SETON                     99    *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * ED Title of Official required
     C           #1QYTX    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     MOVEL'1'       @I2,36
     C                     SETON                     99    *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         EAPMCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert internal to external form
     C                     EXSR MOCV#D
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Update screen time
     C                     TIME           ##TME
      * Refresh screen
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C           W0SCR     IFEQ 1
     C                     WRITE#CMDTXT2
     C                     WRITE#RCDDTL1
     C                     ELSE
     C           W0SCR     IFEQ 2
     C                     WRITE#CMDTXT3
     C                     WRITE#RCDDTL2
     C                     END
     C                     END
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO EAEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPR##    BEGSR
      *================================================================
      * Process record:
      *================================================================
      * Process update request
     C           W0PMD     CASNE'ADD'     EECHRQ
     C                     END
     C           W0RTN     IFEQ *BLANK
      * Restart program for next record
     C                     MOVEL'N'       W0TRN
     C                     END
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         EECHRQ    BEGSR
      *================================================================
      * Process update request
      *================================================================
      * USER: Change DBF record
      * Chg All Order Hdr Date3IF
      * R16637 DN 09/11/20-Pass In New Consignor/Consignee Fields.
      * Chg Exp Doc Order Hdr  CH - Export Doc Order Hdr  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0011           Company Number
     C                     Z-ADD#1C4NB    WL0012           Order Number
     C                     MOVEL#1DGSX    WL0013    P      ED Export Docum
     C                     MOVEL#1KXCD    WL0014    P      Country Code
     C                     MOVEL#1ZMCD    WL0015    P      ED Area Office
     C                     MOVEL#1PSTX    WL0016    P      ED Destination
     C                     MOVEL#1PUTX    WL0017    P      ED Consignor Na
     C                     MOVEL#1PVTX    WL0018    P      ED Consignor Ad
     C                     MOVEL#1PWTX    WL0019    P      ED Consignor Ad
     C                     MOVEL#1RVTX    WL0020    P      ED Consignor Ad
     C                     MOVEL#1PPU1    WL0021    P      ED Consignor Ad
     C                     MOVEL#1Z7AA    WL0022    P      ED Consignor St
     C                     MOVEL#1PDU1    WL0023    P      ED Consignor Po
     C                     MOVEL#1Z8AA    WL0024    P      ED Consignor Co
     C                     MOVEL#1RHTX    WL0025    P      ED Consignee Na
     C                     MOVEL#1RITX    WL0026    P      ED Consignee Ad
     C                     MOVEL#1RJTX    WL0027    P      ED Consignee Ad
     C                     MOVEL#1SCTX    WL0028    P      ED Consignee Ad
     C                     MOVEL#1SDTX    WL0029    P      ED Consignee Ad
     C                     MOVEL#1AAAB    WL0030    P      ED Consignee St
     C                     MOVEL#1PHU1    WL0031    P      ED Consignee Po
     C                     MOVEL#1ABAB    WL0032    P      ED Consignee Co
     C                     MOVEL#1PXTX    WL0033    P      ED Plant Locati
     C                     MOVEL#1ZOCD    WL0034    P      ED Plant Locati
     C                     MOVEL#1ZNCD    WL0035    P      ED Plant Number
     C                     MOVEL#1CSSX    WL0036    P      ED Processing P
     C                     MOVEL#1CTSX    WL0037    P      ED Attachment S
     C                     MOVEL#1CUSX    WL0038    P      ED Attachment T
     C                     MOVEL#1CVSX    WL0039    P      ED Xlate Desc t
     C                     MOVEL#1PTTX    WL0040    P      ED Unmarked Txt
     C                     MOVEL#1ORNA    WL0041    P      ED Shipping Mar
     C                     MOVEL#1RKTX    WL0042    P      ED Date of Slau
     C                     MOVEL#1PZTX    WL0043    P      ED Place of Sla
     C                     MOVEL#1RLTX    WL0044    P      ED Date of Proc
     C                     MOVEL#1P0TX    WL0045    P      ED Place of pro
     C                     MOVEL#1P1TX    WL0046    P      ED Continue Com
     C                     MOVEL#1P2TX    WL0047    P      ED Remark Const
     C                     MOVEL#1P3TX    WL0048    P      ED Remark Const
     C                     MOVEL#1P4TX    WL0049    P      ED Remark Const
     C                     MOVEL#1P5TX    WL0050    P      ED Remark Const
     C                     MOVEL#1P6TX    WL0051    P      ED Remark Const
     C                     MOVEL#1YHTX    WL0052    P      ED Remark Const
     C                     MOVEL#1YITX    WL0053    P      ED Remark Const
     C                     MOVEL#1CWSX    WL0054    P      ED Certify that
     C                     MOVEL#1OUNA    WL0055    P      ED Inspector Na
     C                     MOVEL#1P7TX    WL0056    P      ED Origin Count
     C                     MOVEL#1P9TX    WL0057    P      ED Port of Load
     C                     MOVEL#1OVNA    WL0058    P      ED Transportion
     C                     MOVEL#1QATX    WL0059    P      ED Seal Number
     C                     MOVEL#1QBTX    WL0060    P      ED Seal Number
     C                     MOVEL#1QCTX    WL0061    P      ED Can_Import C
     C                     MOVEL#1OWNA    WL0062    P      ED Can_Import C
     C                     MOVEL#1OXNA    WL0063    P      ED Can_Import C
     C                     Z-ADD#1ABNX    WL0064           ED Can_Import C
     C                     Z-ADD#1ACNX    WL0065           ED Can_Import C
     C                     Z-ADD#1ADNX    WL0066           ED Seaboard Pla
     C                     MOVEL#1QDTX    WL0067    P      ED USDA Cert Nb
     C                     MOVEL#1QETX    WL0068    P      ED USDA Cert Nb
     C                     MOVEL#1OYNA    WL0069    P      ED Can_Port of
     C                     MOVEL#1OZNA    WL0070    P      ED Can_Reinsp E
     C                     MOVEL#1O0NA    WL0071    P      ED Can_Reinsp E
     C                     MOVEL#1O1NA    WL0072    P      ED Can_Reinsp E
     C                     MOVEL#1CXSX    WL0073    P      ED Herm Sealed
     C                     MOVEL#1CYSX    WL0074    P      ED Herm Sealed
     C                     MOVEL#1AGNX    WL0075    P      ED Herm Sealed
     C                     MOVEL#1CZSX    WL0076    P      ED Whole Bird S
     C                     MOVEL#1C0SX    WL0077    P      ED Marked Sts
     C                     MOVEL#1C1SX    WL0078    P      ED Tamper Evide
     C                     MOVEL#1QFTX    WL0079    P      ED Plant Contac
     C                     Z-ADD#1AHNX    WL0080           ED Plant Contac
     C                     MOVEL#1QGTX    WL0081    P      ED Modified Tex
     C                     MOVEL#1QHTX    WL0082    P      ED Issued Crt f
     C                     MOVEL#1QITX    WL0083    P      ED Species
     C                     MOVEL#1QJTX    WL0084    P      ED Slaughter Pl
     C                     MOVEL#1QKTX    WL0085    P      ED Slaughter Pl
     C                     MOVEL#1QMTX    WL0086    P      ED Slaughter Pl
     C                     MOVEL#1QNTX    WL0087    P      ED Packaging Pl
     C                     MOVEL#1QOTX    WL0088    P      ED Packaging Pl
     C                     MOVEL#1QPTX    WL0089    P      ED Packaging Pl
     C                     MOVEL#1QQTX    WL0090    P      ED Manufact Pla
     C                     MOVEL#1QRTX    WL0091    P      ED Manufact Pla
     C                     MOVEL#1QSTX    WL0092    P      ED Manufact Pla
     C                     MOVEL#1QTTX    WL0093    P      ED USDA Name 1
     C                     MOVEL#1QUTX    WL0094    P      ED USDA Name 2
     C                     MOVEL#1QVTX    WL0095    P      ED USDA Name 3
     C                     MOVEL#1QYTX    WL0096    P      ED Title of Off
     C                     MOVEL#1QWTX    WL0097    P      ED Letter of Cr
     C                     MOVEL#1QZTX    WL0098    P      ED Unused prd m
     C                     Z-ADD#1AINX    WL0099           ED Nbr of prods
     C                     MOVEL#1Q1TX    WL0100    P      ED Importer Nam
     C                     MOVEL#1Q2TX    WL0101    P      ED Importer Add
     C                     MOVEL#1Q3TX    WL0102    P      ED Importer Add
     C                     MOVEL#1Q4TX    WL0103    P      ED Purchaser Na
     C                     MOVEL#1Q5TX    WL0104    P      ED Purchaser Ad
     C                     MOVEL#1Q6TX    WL0105    P      ED Purchaser Ad
     C                     MOVEL#1Q7TX    WL0106    P      ED Place Drct S
     C                     MOVEL#1Q8TX    WL0107    P      ED Place Drct S
     C                     MOVEL#1Q9TX    WL0108    P      ED Place Drct S
     C                     MOVEL#1SMTX    WL0109    P      ED Place Drct S
     C                     MOVEL#1ZQCD    WL0110    P      ED Currency
     C                     MOVEL#1ZRCD    WL0111    P      ED Conditions o
     C                     Z-ADD#1A7VL    WL0112           ED Total Unit P
     C                     Z-ADD#1A8VL    WL0113           ED Invoice Tota
     C                     MOVEL#1C2SX    WL0114    P      ED Live with PH
     C                     MOVEL#1C8SX    WL0115    P      ED Print Status
     C                     Z-ADD#1HRWG    WL0116           ED Total Net We
     C                     Z-ADD#1BIVL    WL0117           ED Total Net We
     C                     Z-ADD#1K2QT    WL0118           ED Nbr of Packa
     C                     MOVEL#1O5NA    WL0119    P      ED Customer PO
     C                     Z-ADD#1HSWG    WL0120           ED Total Gross
     C                     Z-ADD#1BJVL    WL0121           ED Total Gross
     C                     MOVEL#1RATX    WL0122    P      ED Plant Number
     C                     MOVEL#1RBTX    WL0123    P      ED Language Xla
     C                     MOVEL#1RCTX    WL0124    P      ED Slaughter Da
     C                     MOVEL#1RDTX    WL0125    P      ED Production m
     C                     MOVEL#1RETX    WL0126    P      ED Remark Const
     C                     MOVEL#1C3SX    WL0127    P      ED Allow Print
     C                     MOVEL#1C4SX    WL0128    P      ED Cert of Orig
     C                     MOVEL#1C5SX    WL0129    P      ED Use item lab
     C                     MOVEL#1C6SX    WL0130    P      ED Slg_Proc Dat
     C                     MOVEL#1C7SX    WL0131    P      ED Total Packag
     C                     Z-ADD#1MQDT    WL0132           ED Export Certi
     C                     Z-ADD#1MRDT    WL0133           ED Sail Date
     C                     Z-ADD#1MSDT    WL0134           ED Sworn on Dat
     C                     Z-ADD#1AJNX    WL0135           ED Consignee Ad
     C                     MOVEL#1YFTX    WL0136    P      ED Form Identif
     C                     MOVEL#1X9TX    WL0137    P      ED Cold Storage
     C                     MOVEL#1YATX    WL0138    P      ED Cold Storage
     C                     MOVEL#1YBTX    WL0139    P      ED Cold Storage
     C                     MOVEL#1B5AA    WL0140    P      ED Cold Storage
     C                     MOVEL#1YCTX    WL0141    P      ED Slaughter Da
     C                     MOVEL#1YDTX    WL0142    P      ED Production m
     C                     MOVEL#1YETX    WL0143    P      ED Production m
     C                     MOVEL#1B6AA    WL0144    P      ED Booking Nbr
     C                     Z-ADD#1PADT    WL0145           ED Document Dat
     C                     Z-ADD#1PBDT    WL0146           ED Packing Date
     C                     Z-ADD#1PCDT    WL0147           ED Expiration D
     C                     Z-ADD#1PDDT    WL0148           ED Packing Date
     C                     Z-ADD#1PEDT    WL0149           ED Unused Date
     C                     MOVEL#1O4SX    WL0150    P      ED Print Kilogr
     C                     MOVEL#1O5SX    WL0151    P      ED MPR Canadian
     C                     MOVEL#1C1T1    WL0152    P      ED Container Nb
     C                     MOVEL#1C2T1    WL0153    P      ED Slaughter Da
     C                     MOVEL#1LKSC    WL0154    P      ED Submit Statu
     C                     MOVEL#1LLSC    WL0155    P      EDOH Unused Sts
     C                     MOVEL#1PIU1    WL0156    P      EDOH Unused Tex
     C                     MOVEL#1PJU1    WL0157    P      EDOH Unused Tex
     C                     Z-ADD#1FFNZ    WL0158           EDOH Unused Num
     C                     Z-ADD#1BUDX    WL0159           EDOH Unused Dat
     C                     MOVEL#1UVST    WL0160    P      EDI Status 1
     C                     MOVEL#1UWST    WL0161    P      EDI Status 2
     C                     MOVEL#1UXST    WL0162    P      EDI Status 3
     C                     MOVEL#1VSST    WL0163    P      Record Status
     C                     Z-ADD#1AATM    WL0164           Job Time
     C                     MOVEL#1AYNA    WL0165    P      User Id
     C                     MOVEL#1A0NA    WL0166    P      Job Name
     C                     Z-ADD#1AXDT    WL0167           Job Date
     C                     EXSR SICHRC
      * Update Doc Date used in H CERT, CERT FOR EXP, AND CUSTOM INV doc
      * RMC WHD 99675 5/17/22 do the below for real
      * RMC WHD 75298 3/11/21 Add Consignor Fields to parms. All docs sho
      *       the same consignor.
      * update consignee on all docs  4/7/22
      * Rtv/Chg Order Hdr Date7RT - Export Doc Order Hdr  * 
     C                     EXSR SJRVGN
      * R13944 DN 12/05/18-Create/Update Export Doc Order Hdr Ext.
      * R16637 DN 09/29/20-Removed Unused Consignor/Consignee PHIS fields
      * DO2416 DN 04/14/22-Update EDE Port of Entry.
      * Upd Exp Doc Order Ext2 RT - Export Doc Order Hdr Ext  * 
     C                     EXSR SKRVGN
     C           W0RTN     IFNE *BLANK
      * Data update error
      * Reset screen fields if changed record
     C           W0RTN     CASEQ'Y2U0007' MBFL#1
     C                     END
     C                     ELSE
     C           YCRDC     IFEQ 'Y'
      * Send message '*Record changed'
     C                     MOVEL'Y2U0012' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *================================================================
     CSR         EEEXIT    ENDSR
      /EJECT
     CSR         FACKPM    BEGSR
      *================================================================
      * Check passed parameters
      *================================================================
      * Is full key present?
     C           P1C4NB    IFEQ *ZERO                      Order Number
      * Not every key field passed - loop program
     C                     MOVEL'Y'       W0RPT   1
     C                     ELSE
      * Full key passed, so single shot program
     C                     MOVEL'N'       W0RPT
     C                     END
      *================================================================
     CSR         FAEXIT    ENDSR
      /EJECT
     CSR         GADSAK    BEGSR
      *================================================================
      * Set key screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSAD    BEGSR
      *================================================================
      * Set detail screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      * Protect key fields on detail screen
     C                     SETON                     88    *
     C           W0SCR     IFNE 1
     C                     MOVEL'0'       *IN79
     C                     MOVEL'0'       *IN78
     C                     MOVEL'0'       *IN77
     C                     END
     C           W0SCR     IFNE 2
     C                     MOVEL'0'       *IN79
     C                     MOVEL'0'       *IN78
     C                     END
     C           W0SCR     IFEQ 1
     C                     MOVEL'0'       *IN79
     C           YL0003    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C                     MOVEL'0'       *IN77
     C           #1C2SX    IFEQ *BLANK                     *IF
     C           #1C2SX    OREQ 'N'
     C                     MOVEL'1'       *IN78
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     ELSE
     C           W0SCR     IFEQ 2
     C                     MOVEL'0'       *IN79
     C                     MOVEL'0'       *IN78
     C           #1C2SX    IFEQ *BLANK                     *IF
     C           #1C2SX    OREQ 'N'
     C                     MOVEL'1'       *IN79
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     END
     C                     END
     C           W0RPT     IFEQ 'N'
      * Disable key screen - not applicable
     C                     SETOF                     87    *
     C                     ELSE
      * Enable key screen
     C                     SETON                     87    *
     C                     END
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise record - except for key fields and "neither" paramete
      *================================================================
     C                     MOVEL*BLANK    #DAGT1           Original Applic
     C                     MOVEL*BLANK    #DAHT1           In Lieu Applica
     C                     MOVEL*BLANK    #DKHU1           EDE Unused Text
     C                     MOVEL*BLANK    #DKMU1           EDE Port of Ent
     C                     MOVEL*BLANK    #1QJTX           ED Slaughter Pl
     C                     MOVEL*BLANK    #DX0AA           EDE ISO Alpha_2
     C                     MOVEL*BLANK    #1PXTX           ED Plant Locati
     C                     MOVEL*BLANK    #1ZOCD           ED Plant Locati
     C                     MOVEL*BLANK    #1ZMCD           ED Area Office
     C                     MOVEL*BLANK    #1CSSX           ED Processing P
     C                     MOVEL*BLANK    #1CTSX           ED Attachment S
     C                     MOVEL*BLANK    #1CUSX           ED Attachment T
     C                     MOVEL*BLANK    #1PTTX           ED Unmarked Txt
     C                     MOVEL*BLANK    #1RKTX           ED Date of Slau
     C                     MOVEL*BLANK    #1PZTX           ED Place of Sla
     C                     MOVEL*BLANK    #1RLTX           ED Date of Proc
     C                     MOVEL*BLANK    #1P0TX           ED Place of pro
     C                     MOVEL*BLANK    #1P1TX           ED Continue Com
     C                     MOVEL*BLANK    #1P2TX           ED Remark Const
     C                     MOVEL*BLANK    #1P3TX           ED Remark Const
     C                     MOVEL*BLANK    #1P4TX           ED Remark Const
     C                     MOVEL*BLANK    #1P5TX           ED Remark Const
     C                     MOVEL*BLANK    #1P6TX           ED Remark Const
     C                     MOVEL*BLANK    #1YHTX           ED Remark Const
     C                     MOVEL*BLANK    #1YITX           ED Remark Const
     C                     MOVEL*BLANK    #1CWSX           ED Certify that
     C                     MOVEL*BLANK    #1OUNA           ED Inspector Na
     C                     MOVEL*BLANK    #1P7TX           ED Origin Count
     C                     MOVEL*BLANK    #1P9TX           ED Port of Load
     C                     MOVEL*BLANK    #1OVNA           ED Transportion
     C                     MOVEL*BLANK    #1QATX           ED Seal Number
     C                     MOVEL*BLANK    #1QBTX           ED Seal Number
     C                     MOVEL*BLANK    #1QCTX           ED Can_Import C
     C                     MOVEL*BLANK    #1OWNA           ED Can_Import C
     C                     MOVEL*BLANK    #1OXNA           ED Can_Import C
     C                     Z-ADD*ZERO     #1ABNX           ED Can_Import C
     C                     Z-ADD*ZERO     #1ACNX           ED Can_Import C
     C                     Z-ADD*ZERO     #1ADNX           ED Seaboard Pla
     C                     MOVEL*BLANK    #1QETX           ED USDA Cert Nb
     C                     MOVEL*BLANK    #1OYNA           ED Can_Port of
     C                     MOVEL*BLANK    #1OZNA           ED Can_Reinsp E
     C                     MOVEL*BLANK    #1O0NA           ED Can_Reinsp E
     C                     MOVEL*BLANK    #1O1NA           ED Can_Reinsp E
     C                     MOVEL*BLANK    #1CXSX           ED Herm Sealed
     C                     MOVEL*BLANK    #1CYSX           ED Herm Sealed
     C                     MOVEL*BLANK    #1AGNX           ED Herm Sealed
     C                     MOVEL*BLANK    #1CZSX           ED Whole Bird S
     C                     MOVEL*BLANK    #1C0SX           ED Marked Sts
     C                     MOVEL*BLANK    #1C1SX           ED Tamper Evide
     C                     MOVEL*BLANK    #1QFTX           ED Plant Contac
     C                     Z-ADD*ZERO     #1AHNX           ED Plant Contac
     C                     MOVEL*BLANK    #1QGTX           ED Modified Tex
     C                     MOVEL*BLANK    #1QHTX           ED Issued Crt f
     C                     MOVEL*BLANK    #1QITX           ED Species
     C                     MOVEL*BLANK    #1QKTX           ED Slaughter Pl
     C                     MOVEL*BLANK    #1QMTX           ED Slaughter Pl
     C                     MOVEL*BLANK    #1QNTX           ED Packaging Pl
     C                     MOVEL*BLANK    #1QOTX           ED Packaging Pl
     C                     MOVEL*BLANK    #1QPTX           ED Packaging Pl
     C                     MOVEL*BLANK    #1QQTX           ED Manufact Pla
     C                     MOVEL*BLANK    #1QRTX           ED Manufact Pla
     C                     MOVEL*BLANK    #1QSTX           ED Manufact Pla
     C                     MOVEL*BLANK    #1QTTX           ED USDA Name 1
     C                     MOVEL*BLANK    #1QUTX           ED USDA Name 2
     C                     MOVEL*BLANK    #1QVTX           ED USDA Name 3
     C                     MOVEL*BLANK    #1QYTX           ED Title of Off
     C                     MOVEL*BLANK    #1QWTX           ED Letter of Cr
     C                     MOVEL*BLANK    #1QZTX           ED Unused prd m
     C                     Z-ADD*ZERO     #1AINX           ED Nbr of prods
     C                     MOVEL*BLANK    #1Q1TX           ED Importer Nam
     C                     MOVEL*BLANK    #1Q2TX           ED Importer Add
     C                     MOVEL*BLANK    #1Q3TX           ED Importer Add
     C                     MOVEL*BLANK    #1Q4TX           ED Purchaser Na
     C                     MOVEL*BLANK    #1Q5TX           ED Purchaser Ad
     C                     MOVEL*BLANK    #1Q6TX           ED Purchaser Ad
     C                     MOVEL*BLANK    #1Q7TX           ED Place Drct S
     C                     MOVEL*BLANK    #1Q8TX           ED Place Drct S
     C                     MOVEL*BLANK    #1Q9TX           ED Place Drct S
     C                     MOVEL*BLANK    #1SMTX           ED Place Drct S
     C                     MOVEL*BLANK    #1ZQCD           ED Currency
     C                     MOVEL*BLANK    #1ZRCD           ED Conditions o
     C                     Z-ADD*ZERO     #1A7VL           ED Total Unit P
     C                     Z-ADD*ZERO     #1A8VL           ED Invoice Tota
     C                     MOVEL*BLANK    #1C8SX           ED Print Status
     C                     Z-ADD*ZERO     #1HRWG           ED Total Net We
     C                     Z-ADD*ZERO     #1BIVL           ED Total Net We
     C                     Z-ADD*ZERO     #1K2QT           ED Nbr of Packa
     C                     MOVEL*BLANK    #1O5NA           ED Customer PO
     C                     Z-ADD*ZERO     #1HSWG           ED Total Gross
     C                     Z-ADD*ZERO     #1BJVL           ED Total Gross
     C                     MOVEL*BLANK    #1RATX           ED Plant Number
     C                     MOVEL*BLANK    #1RBTX           ED Language Xla
     C                     MOVEL*BLANK    #1RCTX           ED Slaughter Da
     C                     MOVEL*BLANK    #1RDTX           ED Production m
     C                     MOVEL*BLANK    #1RETX           ED Remark Const
     C                     MOVEL*BLANK    #1C3SX           ED Allow Print
     C                     MOVEL*BLANK    #1C4SX           ED Cert of Orig
     C                     MOVEL*BLANK    #1C5SX           ED Use item lab
     C                     MOVEL*BLANK    #1C6SX           ED Slg_Proc Dat
     C                     MOVEL*BLANK    #1C7SX           ED Total Packag
     C                     Z-ADD*ZERO     #1MRDT           ED Sail Date
     C                     Z-ADD*ZERO     #1MSDT           ED Sworn on Dat
     C                     Z-ADD*ZERO     #1AJNX           ED Consignee Ad
     C                     MOVEL*BLANK    #1YFTX           ED Form Identif
     C                     MOVEL*BLANK    #1X9TX           ED Cold Storage
     C                     MOVEL*BLANK    #1YATX           ED Cold Storage
     C                     MOVEL*BLANK    #1YBTX           ED Cold Storage
     C                     MOVEL*BLANK    #1B5AA           ED Cold Storage
     C                     MOVEL*BLANK    #1YCTX           ED Slaughter Da
     C                     MOVEL*BLANK    #1YDTX           ED Production m
     C                     MOVEL*BLANK    #1YETX           ED Production m
     C                     MOVEL*BLANK    #1B6AA           ED Booking Nbr
     C                     Z-ADD*ZERO     #1PBDT           ED Packing Date
     C                     Z-ADD*ZERO     #1PCDT           ED Expiration D
     C                     Z-ADD*ZERO     #1PDDT           ED Packing Date
     C                     Z-ADD*ZERO     #1PEDT           ED Unused Date
     C                     MOVEL*BLANK    #1O4SX           ED Print Kilogr
     C                     MOVEL*BLANK    #1O5SX           ED MPR Canadian
     C                     MOVEL*BLANK    #1C1T1           ED Container Nb
     C                     MOVEL*BLANK    #1C2T1           ED Slaughter Da
     C                     MOVEL*BLANK    #1LLSC           EDOH Unused Sts
     C                     MOVEL*BLANK    #1PIU1           EDOH Unused Tex
     C                     MOVEL*BLANK    #1PJU1           EDOH Unused Tex
     C                     Z-ADD*ZERO     #1FFNZ           EDOH Unused Num
     C                     Z-ADD*ZERO     #1BUDX           EDOH Unused Dat
     C                     MOVEL*BLANK    #1UVST           EDI Status 1
     C                     MOVEL*BLANK    #1UWST           EDI Status 2
     C                     MOVEL*BLANK    #1UXST           EDI Status 3
     C                     MOVEL*BLANK    #1VSST           Record Status
     C                     Z-ADD*ZERO     #1AATM           Job Time
     C                     MOVEL*BLANK    #1AYNA           User Id
     C                     MOVEL*BLANK    #1A0NA           Job Name
     C                     Z-ADD*ZERO     #1AXDT           Job Date
     C                     MOVEL*BLANK    #1C2SX           ED Live with PH
     C                     MOVEL*BLANK    #DIFSC           EDE PHIS Action
     C                     MOVEL*BLANK    #DK3U1           PHIS Action Des
     C                     MOVEL*BLANK    #1LKSC           ED Submit Statu
     C                     MOVEL*BLANK    #DQ8U1           ED Submit Statu
     C                     MOVEL*BLANK    #DHUSC           EDE Reason f_Re
     C                     MOVEL*BLANK    #DJRU1           EDE Reason f/Re
     C                     Z-ADD*ZERO     #1PADT           ED Document Dat
      * Clear external version also
     C                     Z-ADD*ZERO     V1PADT
     C                     MOVEL*BLANK    #1QDTX           ED USDA Cert Nb
     C                     Z-ADD*ZERO     #1MQDT           ED Export Certi
     C                     MOVEL*BLANK    #1PSTX           ED Destination
     C                     MOVEL*BLANK    #DHVSC           EDE Shipment Ty
     C                     MOVEL*BLANK    #DJSU1           EDE Shipment Ty
     C                     MOVEL*BLANK    #DX1AA           EDE Country of
     C                     MOVEL*BLANK    #DYDAA           EDE Transit Cou
     C                     MOVEL*BLANK    #1ORNA           ED Shipping Mar
     C                     MOVEL*BLANK    #DRCU1           EDE Port of Ent
     C                     MOVEL*BLANK    #DHWSC           EDE Frozen_Shel
     C                     MOVEL*BLANK    #1ZNCD           ED Plant Number
     C                     MOVEL*BLANK    #1CVSX           ED Xlate Desc t
     C                     MOVEL*BLANK    #1PUTX           ED Consignor Na
     C                     MOVEL*BLANK    #1PVTX           ED Consignor Ad
     C                     MOVEL*BLANK    #1PWTX           ED Consignor Ad
     C                     MOVEL*BLANK    #1RVTX           ED Consignor Ad
     C                     MOVEL*BLANK    #1PPU1           ED Consignor Ad
     C                     MOVEL*BLANK    #1Z7AA           ED Consignor St
     C                     MOVEL*BLANK    #1PDU1           ED Consignor Po
     C                     MOVEL*BLANK    #1Z8AA           ED Consignor Co
     C                     MOVEL*BLANK    #DKRU1           EDE Consignor T
     C                     MOVEL*BLANK    #1RHTX           ED Consignee Na
     C                     MOVEL*BLANK    #1RITX           ED Consignee Ad
     C                     MOVEL*BLANK    #1RJTX           ED Consignee Ad
     C                     MOVEL*BLANK    #1SCTX           ED Consignee Ad
     C                     MOVEL*BLANK    #1SDTX           ED Consignee Ad
     C                     MOVEL*BLANK    #1AAAB           ED Consignee St
     C                     MOVEL*BLANK    #1PHU1           ED Consignee Po
     C                     MOVEL*BLANK    #1ABAB           ED Consignee Co
     C                     MOVEL*BLANK    #DKQU1           EDE Consignee T
     C                     MOVEL*BLANK    #DJPU1           EDE Appl_Billin
     C                     MOVEL*BLANK    #DJQU1           EDE Appl_Billin
     C                     MOVEL*BLANK    #DKGU1           EDE Container N
     C                     MOVEL*BLANK    #DKIU1           EDE Additional
     C                     MOVEL*BLANK    #DIESC           EDE PHIS Proces
     C                     MOVEL*BLANK    #DK4U1           EDE PHIS Proces
     C                     MOVELXDTSDL    #DAUTS           EDE ETL Process
      * Clear external version also
     C                     Z-ADD*ZERO     VDAUTS
     C                     MOVEL*BLANK    #DKFU1           EDE Return Cde_
     C                     MOVEL*BLANK    #DKKU1           EDE Application
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @MRREWT fields to screen
      *================================================================
     C                     MOVELMRDGSX    #1DGSX           ED Export Docum
     C                     MOVELMRQJTX    #1QJTX           ED Slaughter Pl
     C                     MOVELMRPXTX    #1PXTX           ED Plant Locati
     C                     MOVELMRZOCD    #1ZOCD           ED Plant Locati
     C                     MOVELMRZMCD    #1ZMCD           ED Area Office
     C                     MOVELMRCSSX    #1CSSX           ED Processing P
     C                     MOVELMRCTSX    #1CTSX           ED Attachment S
     C                     MOVELMRCUSX    #1CUSX           ED Attachment T
     C                     MOVELMRPTTX    #1PTTX           ED Unmarked Txt
     C                     MOVELMRRKTX    #1RKTX           ED Date of Slau
     C                     MOVELMRPZTX    #1PZTX           ED Place of Sla
     C                     MOVELMRRLTX    #1RLTX           ED Date of Proc
     C                     MOVELMRP0TX    #1P0TX           ED Place of pro
     C                     MOVELMRP1TX    #1P1TX           ED Continue Com
     C                     MOVELMRP2TX    #1P2TX           ED Remark Const
     C                     MOVELMRP3TX    #1P3TX           ED Remark Const
     C                     MOVELMRP4TX    #1P4TX           ED Remark Const
     C                     MOVELMRP5TX    #1P5TX           ED Remark Const
     C                     MOVELMRP6TX    #1P6TX           ED Remark Const
     C                     MOVELMRYHTX    #1YHTX           ED Remark Const
     C                     MOVELMRYITX    #1YITX           ED Remark Const
     C                     MOVELMRCWSX    #1CWSX           ED Certify that
     C                     MOVELMROUNA    #1OUNA           ED Inspector Na
     C                     MOVELMRP7TX    #1P7TX           ED Origin Count
     C                     MOVELMRP9TX    #1P9TX           ED Port of Load
     C                     MOVELMROVNA    #1OVNA           ED Transportion
     C                     MOVELMRQATX    #1QATX           ED Seal Number
     C                     MOVELMRQBTX    #1QBTX           ED Seal Number
     C                     MOVELMRQCTX    #1QCTX           ED Can_Import C
     C                     MOVELMROWNA    #1OWNA           ED Can_Import C
     C                     MOVELMROXNA    #1OXNA           ED Can_Import C
     C                     Z-ADDMRABNX    #1ABNX           ED Can_Import C
     C                     Z-ADDMRACNX    #1ACNX           ED Can_Import C
     C                     Z-ADDMRADNX    #1ADNX           ED Seaboard Pla
     C                     MOVELMRQETX    #1QETX           ED USDA Cert Nb
     C                     MOVELMROYNA    #1OYNA           ED Can_Port of
     C                     MOVELMROZNA    #1OZNA           ED Can_Reinsp E
     C                     MOVELMRO0NA    #1O0NA           ED Can_Reinsp E
     C                     MOVELMRO1NA    #1O1NA           ED Can_Reinsp E
     C                     MOVELMRCXSX    #1CXSX           ED Herm Sealed
     C                     MOVELMRCYSX    #1CYSX           ED Herm Sealed
     C                     MOVELMRAGNX    #1AGNX           ED Herm Sealed
     C                     MOVELMRCZSX    #1CZSX           ED Whole Bird S
     C                     MOVELMRC0SX    #1C0SX           ED Marked Sts
     C                     MOVELMRC1SX    #1C1SX           ED Tamper Evide
     C                     MOVELMRQFTX    #1QFTX           ED Plant Contac
     C                     Z-ADDMRAHNX    #1AHNX           ED Plant Contac
     C                     MOVELMRQGTX    #1QGTX           ED Modified Tex
     C                     MOVELMRQHTX    #1QHTX           ED Issued Crt f
     C                     MOVELMRQITX    #1QITX           ED Species
     C                     MOVELMRQKTX    #1QKTX           ED Slaughter Pl
     C                     MOVELMRQMTX    #1QMTX           ED Slaughter Pl
     C                     MOVELMRQNTX    #1QNTX           ED Packaging Pl
     C                     MOVELMRQOTX    #1QOTX           ED Packaging Pl
     C                     MOVELMRQPTX    #1QPTX           ED Packaging Pl
     C                     MOVELMRQQTX    #1QQTX           ED Manufact Pla
     C                     MOVELMRQRTX    #1QRTX           ED Manufact Pla
     C                     MOVELMRQSTX    #1QSTX           ED Manufact Pla
     C                     MOVELMRQTTX    #1QTTX           ED USDA Name 1
     C                     MOVELMRQUTX    #1QUTX           ED USDA Name 2
     C                     MOVELMRQVTX    #1QVTX           ED USDA Name 3
     C                     MOVELMRQYTX    #1QYTX           ED Title of Off
     C                     MOVELMRQWTX    #1QWTX           ED Letter of Cr
     C                     MOVELMRQZTX    #1QZTX           ED Unused prd m
     C                     Z-ADDMRAINX    #1AINX           ED Nbr of prods
     C                     MOVELMRQ1TX    #1Q1TX           ED Importer Nam
     C                     MOVELMRQ2TX    #1Q2TX           ED Importer Add
     C                     MOVELMRQ3TX    #1Q3TX           ED Importer Add
     C                     MOVELMRQ4TX    #1Q4TX           ED Purchaser Na
     C                     MOVELMRQ5TX    #1Q5TX           ED Purchaser Ad
     C                     MOVELMRQ6TX    #1Q6TX           ED Purchaser Ad
     C                     MOVELMRQ7TX    #1Q7TX           ED Place Drct S
     C                     MOVELMRQ8TX    #1Q8TX           ED Place Drct S
     C                     MOVELMRQ9TX    #1Q9TX           ED Place Drct S
     C                     MOVELMRSMTX    #1SMTX           ED Place Drct S
     C                     MOVELMRZQCD    #1ZQCD           ED Currency
     C                     MOVELMRZRCD    #1ZRCD           ED Conditions o
     C                     Z-ADDMRA7VL    #1A7VL           ED Total Unit P
     C                     Z-ADDMRA8VL    #1A8VL           ED Invoice Tota
     C                     MOVELMRC8SX    #1C8SX           ED Print Status
     C                     Z-ADDMRHRWG    #1HRWG           ED Total Net We
     C                     Z-ADDMRBIVL    #1BIVL           ED Total Net We
     C                     Z-ADDMRK2QT    #1K2QT           ED Nbr of Packa
     C                     MOVELMRO5NA    #1O5NA           ED Customer PO
     C                     Z-ADDMRHSWG    #1HSWG           ED Total Gross
     C                     Z-ADDMRBJVL    #1BJVL           ED Total Gross
     C                     MOVELMRRATX    #1RATX           ED Plant Number
     C                     MOVELMRRBTX    #1RBTX           ED Language Xla
     C                     MOVELMRRCTX    #1RCTX           ED Slaughter Da
     C                     MOVELMRRDTX    #1RDTX           ED Production m
     C                     MOVELMRRETX    #1RETX           ED Remark Const
     C                     MOVELMRC3SX    #1C3SX           ED Allow Print
     C                     MOVELMRC4SX    #1C4SX           ED Cert of Orig
     C                     MOVELMRC5SX    #1C5SX           ED Use item lab
     C                     MOVELMRC6SX    #1C6SX           ED Slg_Proc Dat
     C                     MOVELMRC7SX    #1C7SX           ED Total Packag
     C                     Z-ADDMRMRDT    #1MRDT           ED Sail Date
     C                     Z-ADDMRMSDT    #1MSDT           ED Sworn on Dat
     C                     Z-ADDMRAJNX    #1AJNX           ED Consignee Ad
     C                     MOVELMRYFTX    #1YFTX           ED Form Identif
     C                     MOVELMRX9TX    #1X9TX           ED Cold Storage
     C                     MOVELMRYATX    #1YATX           ED Cold Storage
     C                     MOVELMRYBTX    #1YBTX           ED Cold Storage
     C                     MOVELMRB5AA    #1B5AA           ED Cold Storage
     C                     MOVELMRYCTX    #1YCTX           ED Slaughter Da
     C                     MOVELMRYDTX    #1YDTX           ED Production m
     C                     MOVELMRYETX    #1YETX           ED Production m
     C                     MOVELMRB6AA    #1B6AA           ED Booking Nbr
     C                     Z-ADDMRPBDT    #1PBDT           ED Packing Date
     C                     Z-ADDMRPCDT    #1PCDT           ED Expiration D
     C                     Z-ADDMRPDDT    #1PDDT           ED Packing Date
     C                     Z-ADDMRPEDT    #1PEDT           ED Unused Date
     C                     MOVELMRO4SX    #1O4SX           ED Print Kilogr
     C                     MOVELMRO5SX    #1O5SX           ED MPR Canadian
     C                     MOVELMRC1T1    #1C1T1           ED Container Nb
     C                     MOVELMRC2T1    #1C2T1           ED Slaughter Da
     C                     MOVELMRLLSC    #1LLSC           EDOH Unused Sts
     C                     MOVELMRPIU1    #1PIU1           EDOH Unused Tex
     C                     MOVELMRPJU1    #1PJU1           EDOH Unused Tex
     C                     Z-ADDMRFFNZ    #1FFNZ           EDOH Unused Num
     C                     Z-ADDMRBUDX    #1BUDX           EDOH Unused Dat
     C                     MOVELMRUVST    #1UVST           EDI Status 1
     C                     MOVELMRUWST    #1UWST           EDI Status 2
     C                     MOVELMRUXST    #1UXST           EDI Status 3
     C                     MOVELMRVSST    #1VSST           Record Status
     C                     Z-ADDMRAATM    #1AATM           Job Time
     C                     MOVELMRAYNA    #1AYNA           User Id
     C                     MOVELMRA0NA    #1A0NA           Job Name
     C                     Z-ADDMRAXDT    #1AXDT           Job Date
     C                     Z-ADDMRAIC3    #1AIC3           Company Number
     C                     Z-ADDMRC4NB    #1C4NB           Order Number
     C                     MOVELMRKXCD    #1KXCD           Country Code
     C                     MOVELMRC2SX    #1C2SX           ED Live with PH
     C                     MOVELMRLKSC    #1LKSC           ED Submit Statu
     C                     Z-ADDMRPADT    #1PADT           ED Document Dat
     C                     MOVELMRQDTX    #1QDTX           ED USDA Cert Nb
     C                     Z-ADDMRMQDT    #1MQDT           ED Export Certi
     C                     MOVELMRPSTX    #1PSTX           ED Destination
     C                     MOVELMRORNA    #1ORNA           ED Shipping Mar
     C                     MOVELMRZNCD    #1ZNCD           ED Plant Number
     C                     MOVELMRCVSX    #1CVSX           ED Xlate Desc t
     C                     MOVELMRPUTX    #1PUTX           ED Consignor Na
     C                     MOVELMRPVTX    #1PVTX           ED Consignor Ad
     C                     MOVELMRPWTX    #1PWTX           ED Consignor Ad
     C                     MOVELMRRVTX    #1RVTX           ED Consignor Ad
     C                     MOVELMRPPU1    #1PPU1           ED Consignor Ad
     C                     MOVELMRZ7AA    #1Z7AA           ED Consignor St
     C                     MOVELMRPDU1    #1PDU1           ED Consignor Po
     C                     MOVELMRZ8AA    #1Z8AA           ED Consignor Co
     C                     MOVELMRRHTX    #1RHTX           ED Consignee Na
     C                     MOVELMRRITX    #1RITX           ED Consignee Ad
     C                     MOVELMRRJTX    #1RJTX           ED Consignee Ad
     C                     MOVELMRSCTX    #1SCTX           ED Consignee Ad
     C                     MOVELMRSDTX    #1SDTX           ED Consignee Ad
     C                     MOVELMRAAAB    #1AAAB           ED Consignee St
     C                     MOVELMRPHU1    #1PHU1           ED Consignee Po
     C                     MOVELMRABAB    #1ABAB           ED Consignee Co
      * Hold existing record image
     C                     MOVEL@1DBRC    #1DBRC
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MDIZ#K    BEGSR
      *================================================================
      * Initialize key screen
      *================================================================
     C                     Z-ADDP1AIC3    #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     Z-ADDP1C4NB    #1C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V1C4NB
     C                     MOVELP1DGSX    #1DGSX           ED Export Docum
     C                     MOVELP1KXCD    #1KXCD           Country Code
      * Check reference to Order Header TRG
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9931  *
     C                     END
      * Check restriction within
     C                     EXSR VDCKRL
      *================================================================
     CSR         MDEXIT    ENDSR
      /EJECT
     CSR         MNCV#K    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C4NB           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#D    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert ED Document Date to display format
      * Convert date
     C           1000000   ADD  #1PADT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1PADT
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert EDE ETL Process Timestamp to display format
      * Convert date
     C           #DAUTS    IFEQ XDTSDL
     C                     Z-ADD*ZERO     VDAUTS
     C                     ELSE
     C                     MOVEL#DAUTS    XDITSM
     C                     MOVELXDITSD    XDI2DT
     C                     MOVELXDITST    XTTI2
     C                     EXSR XDV24T
     C           XDEXDT    MULT 1000000   VDAUTS
     C                     Z-ADDXTH2      XTHH             HH
     C                     Z-ADDXTN2      XTNN             MM
     C                     Z-ADDXTS2      XTSS             SS
     C                     ADD  XTTIM     VDAUTS
     C                     END
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv PHIS Info         RT - Export Doc Order Hdr Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    #DHUSC           EDE Reason f_Re
     C                     MOVEL*BLANK    #DHVSC           EDE Shipment Ty
     C                     MOVEL*BLANK    #DHWSC           EDE Frozen_Shel
     C                     MOVEL*BLANK    #DX0AA           EDE ISO Alpha_2
     C                     MOVEL*BLANK    #DJPU1           EDE Appl_Billin
     C                     MOVEL*BLANK    #DJQU1           EDE Appl_Billin
     C                     MOVEL*BLANK    #DX1AA           EDE Country of
     C                     MOVEL*BLANK    #DYDAA           EDE Transit Cou
     C                     MOVEL*BLANK    #DKGU1           EDE Container N
     C                     MOVEL*BLANK    #DKHU1           EDE Unused Text
     C                     MOVEL*BLANK    #DKIU1           EDE Additional
     C                     MOVEL*BLANK    #DRCU1           EDE Port of Ent
     C                     MOVEL*BLANK    #DKQU1           EDE Consignee T
     C                     MOVEL*BLANK    #DKRU1           EDE Consignor T
     C                     MOVEL*BLANK    #DIESC           EDE PHIS Proces
     C                     MOVELXDTSDL    #DAUTS           EDE ETL Process
     C                     MOVEL*BLANK    #DIFSC           EDE PHIS Action
     C                     MOVEL*BLANK    #DKFU1           EDE Return Cde_
     C                     MOVEL*BLANK    #DKKU1           EDE Application
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           A6AIC3           Company Number
     C                     KFLD           A6C4NB           Order Number
     C                     KFLD           A6DGSX           ED Export Docum
     C                     KFLD           A6KXCD           Country Code
      * Setup key
     C                     Z-ADDMRAIC3    A6AIC3           Company Number
     C                     Z-ADDMRC4NB    A6C4NB           Order Number
     C                     MOVELMRDGSX    A6DGSX           ED Export Docum
     C                     MOVELMRKXCD    A6KXCD           Country Code
      * Establish starting position
     C           KRSSA     CHAIN@A6CPDH              90    *
      * Data record not found
     C   90                MOVEL'USR5073' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA6HUSC    #DHUSC           EDE Reason f_Re
     C                     MOVELA6HVSC    #DHVSC           EDE Shipment Ty
     C                     MOVELA6HWSC    #DHWSC           EDE Frozen_Shel
     C                     MOVELA6X0AA    #DX0AA           EDE ISO Alpha_2
     C                     MOVELA6JPU1    #DJPU1           EDE Appl_Billin
     C                     MOVELA6JQU1    #DJQU1           EDE Appl_Billin
     C                     MOVELA6X1AA    #DX1AA           EDE Country of
     C                     MOVELA6YDAA    #DYDAA           EDE Transit Cou
     C                     MOVELA6KGU1    #DKGU1           EDE Container N
     C                     MOVELA6KHU1    #DKHU1           EDE Unused Text
     C                     MOVELA6KIU1    #DKIU1           EDE Additional
     C                     MOVELA6KMU1    #DRCU1           EDE Port of Ent
     C                     MOVELA6KQU1    #DKQU1           EDE Consignee T
     C                     MOVELA6KRU1    #DKRU1           EDE Consignor T
     C                     MOVELA6IESC    #DIESC           EDE PHIS Proces
     C                     MOVELA6AUTS    #DAUTS           EDE ETL Process
     C                     MOVELA6IFSC    #DIFSC           EDE PHIS Action
     C                     MOVELA6KFU1    #DKFU1           EDE Return Cde_
     C                     MOVELA6KKU1    #DKKU1           EDE Application
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Upd PHIS Action Sts   RT - Export Doc Order Hdr Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           A6AIC3           Company Number
     C                     KFLD           A6C4NB           Order Number
     C                     KFLD           A6DGSX           ED Export Docum
     C                     KFLD           A6KXCD           Country Code
      * Setup key
     C                     Z-ADDMRAIC3    A6AIC3           Company Number
     C                     Z-ADDMRC4NB    A6C4NB           Order Number
     C                     MOVELMRDGSX    A6DGSX           ED Export Docum
     C                     MOVELMRKXCD    A6KXCD           Country Code
      * Establish starting position
     C           KRSSB     CHAIN@A6CPDH              90    *
      * Data record not found
     C   90                MOVEL'USR5073' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg PHIS Action Sts   CH - Export Doc Order Hdr Ext  * 
     C                     EXSR SCCHRC
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCHRC    BEGSR
      *================================================================
      * Chg PHIS Action Sts   CH - Export Doc Order Hdr Ext  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  2        EDE Reason f_Re
     C                     MOVEL*BLANK    WN0002  2        EDE Shipment Ty
     C                     MOVEL*BLANK    WN0003  1        EDE Frozen_Shel
     C                     MOVEL*BLANK    WN0004  2        EDE ISO Alpha_2
     C                     MOVEL*BLANK    WN0005  1        EDE USDA Export
     C                     MOVEL*BLANK    WN0006  2        EDE Special Pri
     C                     MOVEL*BLANK    WN0007 10        EDE Appl_Billin
     C                     MOVEL*BLANK    WN0008 30        EDE Appl_Billin
     C                     Z-ADD*ZERO     WN0009  80       EDE Unused Date
     C                     MOVEL*BLANK    WN0010  6        EDE Country of
     C                     MOVEL*BLANK    WN0011  6        EDE I Certify S
     C                     MOVEL*BLANK    WN0012 15        EDE Attachment
     C                     MOVEL*BLANK    WN0013 20        EDE Attachment
     C                     MOVEL*BLANK    WN0014  6        EDE Transit Cou
     C                     MOVEL*BLANK    WN0015 25        EDE Container N
     C                     MOVEL*BLANK    WN0016 25        EDE Unused Text
     C                     MOVEL*BLANK    WN0017100        EDE Additional
     C                     MOVEL*BLANK    WN0018  1        EDE Maturity lt
     C                     MOVEL*BLANK    WN0019 25        EDE Seal Nos
     C                     MOVEL*BLANK    WN0020 50        EDE IFS PHIS Do
     C                     MOVEL*BLANK    WN0021 50        EDE Port of Ent
     C                     MOVEL*BLANK    WN0022 50        EDE Unused 2
     C                     MOVEL*BLANK    WN0023 50        EDE Unused 3
     C                     MOVEL*BLANK    WN0024  2        EDE Unused 4
     C                     MOVEL*BLANK    WN0025 20        EDE Unused 5
     C                     MOVEL*BLANK    WN0026 16        EDE Consignee T
     C                     MOVEL*BLANK    WN0027 50        EDE Unused 6
     C                     MOVEL*BLANK    WN0028 50        EDE Unused 7
     C                     MOVEL*BLANK    WN0029 50        EDE Unused 8
     C                     MOVEL*BLANK    WN0030 50        EDE Unused 9
     C                     MOVEL*BLANK    WN0031  2        EDE Unused 10
     C                     MOVEL*BLANK    WN0032 20        EDE Unused 11
     C                     MOVEL*BLANK    WN0033 16        EDE Consignor T
     C                     MOVEL*BLANK    WN0034  1        EDE PHIS Proces
     C                     MOVELXDTSDL    WN0035 26        EDE ETL Process
     C                     MOVEL*BLANK    WN0036 75        EDE Return Cde_
     C                     MOVEL*BLANK    WN0037 36        EDE Application
     C                     MOVEL*BLANK    WN0038  1        EDI Status 1
     C                     MOVEL*BLANK    WN0039  1        EDI Status 2
     C                     MOVEL*BLANK    WN0040  1        EDI Status 3
     C                     MOVEL*BLANK    WN0041  1        Record Status
     C                     Z-ADD*ZERO     WN0042  60       Job Time
     C                     MOVEL*BLANK    WN0043 10        User Id
     C                     MOVEL*BLANK    WN0044 10        Job Name
     C                     Z-ADD*ZERO     WN0045  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @A6CPDG
     C                     Z-ADDA6AIC3    WAAIC3           Company Number
     C                     Z-ADDA6C4NB    WAC4NB           Order Number
     C                     MOVELA6DGSX    WADGSX    P      ED Export Docum
     C                     MOVELA6KXCD    WAKXCD    P      Country Code
      *
     C           KLCHSC    KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
     C                     KFLD           WADGSX           ED Export Docum
     C                     KFLD           WAKXCD           Country Code
     C           KLCHSC    CHAIN@A6CPDG              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PUA6CPL0'MDACP
     C                     MOVEL'@A6CPDG' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPUA61    YARDCS
      * Move non-key fields to @A6CPDG
     C                     MOVEL'C'       WAIFSC    P      EDE PHIS Action
      *
      * Set PGM.*Record Data Changed flag
     C           QPUA61    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * UPS CHGOBJ Stamp      IF
     C                     Z-ADD##JTM     WAAATM           Job Time
     C                     MOVEL##USR     WAAYNA           User Id
     C                     MOVEL##PGM     WAA0NA           Job Name
     C                     Z-ADD##JDT     WAAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPUA61    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@A6CPDG                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPUA6CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Alpha Value        RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           KMAIC3           Company Number
     C                     KFLD           KMV8CD           Company Value C
      * Setup key
     C                     Z-ADDWL0001    KMAIC3           Company Number
     C                     MOVELWL0002    KMV8CD           Company Value C
      * Establish starting position
     C           KRSSD     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELKMBXTX    WL0003           System Value Al
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Val State & Active     RT - State  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0005           Record Status
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           ACBGCD           State Code
      * Setup key
     C                     MOVELWL0004    ACBGCD           State Code
      * Establish starting position
     C           KRSSE     CHAIN@ACREAH              90    *
      * Data record not found
     C   90                MOVEL'USR0005' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           ACVSST    IFEQ 'A'                        *IF
     C                     MOVELACVSST    WL0005           Record Status
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'I'       WL0005           Record Status
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Val Country & Active   RT - Country  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0007           Record Status
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           E5KXCD           Country Code
      * Setup key
     C                     MOVELWL0006    E5KXCD           Country Code
      * Establish starting position
     C           KRSSF     CHAIN@E5REB8              90    *
      * Data record not found
     C   90                MOVEL'USR1158' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           E5VSST    IFEQ 'A'                        *IF
     C                     MOVELE5VSST    WL0007           Record Status
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'I'       WL0007           Record Status
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Desc, Status       RT - Country  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           E5KXCD           Country Code
      * Setup key
     C                     MOVELWL0008    E5KXCD           Country Code
      * Establish starting position
     C           KRSSG     CHAIN@E5REB8              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1158' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0009           Country Descrip
     C                     MOVEL*BLANK    WL0010           Record Status
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELE5DATX    WL0009           Country Descrip
     C                     MOVELE5VSST    WL0010           Record Status
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Val Port of Entry     RT - Country Port of Entry  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0007           Record Status
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           CERAU1           Port of Entry N
      * Setup key
     C                     MOVEL#DRCU1    CERAU1           Port of Entry N
      * Establish starting position
     C           KRSSH     CHAIN@CEREJS              90    *
      * Data record not found
     C   90                MOVEL'USR5243' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELCEVSST    YL0007           Record Status
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICHRC    BEGSR
      *================================================================
      * Chg Exp Doc Order Hdr  CH - Export Doc Order Hdr  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @MRREWS
     C                     Z-ADDWL0011    MRAIC3           Company Number
     C                     Z-ADDWL0012    MRC4NB           Order Number
     C                     MOVELWL0013    MRDGSX    P      ED Export Docum
     C                     MOVELWL0014    MRKXCD    P      Country Code
      *
     C           KLCHSI    KLIST
     C                     KFLD           MRAIC3           Company Number
     C                     KFLD           MRC4NB           Order Number
     C                     KFLD           MRDGSX           ED Export Docum
     C                     KFLD           MRKXCD           Country Code
     C           KLCHSI    CHAIN@MRREWS              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDMRREL0'MDACP
     C                     MOVEL'@MRREWS' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE @1DBRC    YBRDCS
      * USER: Processing after Data read
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.ED Export Document Type is MPD
      *   |- c2    : DB1.ED Export Document Type is 9290/9285/9295/9115/9
      *   '-
     C           MRDGSX    IFEQ 'H'                        *IF
     C           MRDGSX    OREQ 'E'                        *OR
      * The H and or the E record are the only records that we would
      * want to write out the comments records
      * on the A record even if the consignee or consignor are
      * changed do not write out these records
      * R16637 DN 09/10/20-Pass in New Consignor/Consignee Fields.
      * Rtv/Consignor/ConsigneXF - Export Doc Order Comment  * 
     C                     CALL 'PNVIXFR'              90  Rtv/Consignor/C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM ##PGM     WQ0027 10        *PROGRAM
     C                     PARM MRPUTX    WQ0028 63        ED Consignor Na
     C                     PARM MRPVTX    WQ0029 63        ED Consignor Ad
     C                     PARM MRPWTX    WQ0030 63        ED Consignor Ad
     C                     PARM MRRVTX    WQ0031 63        ED Consignor Ad
     C                     PARM MRPPU1    WQ0032 63        ED Consignor Ad
     C                     PARM MRZ7AA    WQ0033  2        ED Consignor St
     C                     PARM MRPDU1    WQ0034 20        ED Consignor Po
     C                     PARM MRZ8AA    WQ0035  6        ED Consignor Co
     C                     PARM MRRHTX    WQ0036 63        ED Consignee Na
     C                     PARM MRRITX    WQ0037 63        ED Consignee Ad
     C                     PARM MRRJTX    WQ0038 63        ED Consignee Ad
     C                     PARM MRSCTX    WQ0039 63        ED Consignee Ad
     C                     PARM MRSDTX    WQ0040 63        ED Consignee Ad
     C                     PARM MRAAAB    WQ0041  2        ED Consignee St
     C                     PARM MRPHU1    WQ0042 20        ED Consignee Po
     C                     PARM MRABAB    WQ0043  6        ED Consignee Co
     C                     PARM WL0011    WQ0044  30       Company Number
     C                     PARM WL0012    WQ0045  70       Order Number
     C                     PARM WL0013    WQ0046  1        ED Export Docum
     C                     PARM WL0014    WQ0047  6        Country Code
     C                     PARM WL0015    WQ0048 15        ED Area Office
     C                     PARM WL0016    WQ0049 20        ED Destination
     C                     PARM WL0017    WQ0050 63        ED Consignor Na
     C                     PARM WL0018    WQ0051 63        ED Consignor Ad
     C                     PARM WL0019    WQ0052 63        ED Consignor Ad
     C                     PARM WL0020    WQ0053 63        ED Consignor Ad
     C                     PARM WL0021    WQ0054 63        ED Consignor Ad
     C                     PARM WL0022    WQ0055  2        ED Consignor St
     C                     PARM WL0023    WQ0056 20        ED Consignor Po
     C                     PARM WL0024    WQ0057  6        ED Consignor Co
     C                     PARM WL0025    WQ0058 63        ED Consignee Na
     C                     PARM WL0026    WQ0059 63        ED Consignee Ad
     C                     PARM WL0027    WQ0060 63        ED Consignee Ad
     C                     PARM WL0028    WQ0061 63        ED Consignee Ad
     C                     PARM WL0029    WQ0062 63        ED Consignee Ad
     C                     PARM WL0030    WQ0063  2        ED Consignee St
     C                     PARM WL0031    WQ0064 20        ED Consignee Po
     C                     PARM WL0032    WQ0065  6        ED Consignee Co
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNVIXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,45           *
     C                     MOVEL'1'       @I1,46           *
     C                     MOVEL'1'       @I1,47           *
     C                     MOVEL'1'       @I1,48           *
     C                     MOVEL'1'       @I1,49           *
     C                     MOVEL'1'       @I1,50           *
     C                     MOVEL'1'       @I1,51           *
     C                     MOVEL'1'       @I1,52           *
     C                     MOVEL'1'       @I1,54           *
     C                     MOVEL'1'       @I1,55           *
     C                     MOVEL'1'       @I1,56           *
     C                     MOVEL'1'       @I1,57           *
     C                     MOVEL'1'       @I1,58           *
     C                     MOVEL'1'       @I1,59           *
     C                     MOVEL'1'       @I1,60           *
     C                     MOVEL'1'       @I1,61           *
     C                     END
     C                     END                             *FI
      * Move non-key fields to @MRREWS
     C                     MOVELWL0015    MRZMCD    P      ED Area Office
     C                     MOVELWL0016    MRPSTX    P      ED Destination
     C                     MOVELWL0017    MRPUTX    P      ED Consignor Na
     C                     MOVELWL0018    MRPVTX    P      ED Consignor Ad
     C                     MOVELWL0019    MRPWTX    P      ED Consignor Ad
     C                     MOVELWL0020    MRRVTX    P      ED Consignor Ad
     C                     MOVELWL0021    MRPPU1    P      ED Consignor Ad
     C                     MOVELWL0022    MRZ7AA    P      ED Consignor St
     C                     MOVELWL0023    MRPDU1    P      ED Consignor Po
     C                     MOVELWL0024    MRZ8AA    P      ED Consignor Co
     C                     MOVELWL0025    MRRHTX    P      ED Consignee Na
     C                     MOVELWL0026    MRRITX    P      ED Consignee Ad
     C                     MOVELWL0027    MRRJTX    P      ED Consignee Ad
     C                     MOVELWL0028    MRSCTX    P      ED Consignee Ad
     C                     MOVELWL0029    MRSDTX    P      ED Consignee Ad
     C                     MOVELWL0030    MRAAAB    P      ED Consignee St
     C                     MOVELWL0031    MRPHU1    P      ED Consignee Po
     C                     MOVELWL0032    MRABAB    P      ED Consignee Co
     C                     MOVELWL0033    MRPXTX    P      ED Plant Locati
     C                     MOVELWL0034    MRZOCD    P      ED Plant Locati
     C                     MOVELWL0035    MRZNCD    P      ED Plant Number
     C                     MOVELWL0036    MRCSSX    P      ED Processing P
     C                     MOVELWL0037    MRCTSX    P      ED Attachment S
     C                     MOVELWL0038    MRCUSX    P      ED Attachment T
     C                     MOVELWL0039    MRCVSX    P      ED Xlate Desc t
     C                     MOVELWL0040    MRPTTX    P      ED Unmarked Txt
     C                     MOVELWL0041    MRORNA    P      ED Shipping Mar
     C                     MOVELWL0042    MRRKTX    P      ED Date of Slau
     C                     MOVELWL0043    MRPZTX    P      ED Place of Sla
     C                     MOVELWL0044    MRRLTX    P      ED Date of Proc
     C                     MOVELWL0045    MRP0TX    P      ED Place of pro
     C                     MOVELWL0046    MRP1TX    P      ED Continue Com
     C                     MOVELWL0047    MRP2TX    P      ED Remark Const
     C                     MOVELWL0048    MRP3TX    P      ED Remark Const
     C                     MOVELWL0049    MRP4TX    P      ED Remark Const
     C                     MOVELWL0050    MRP5TX    P      ED Remark Const
     C                     MOVELWL0051    MRP6TX    P      ED Remark Const
     C                     MOVELWL0052    MRYHTX    P      ED Remark Const
     C                     MOVELWL0053    MRYITX    P      ED Remark Const
     C                     MOVELWL0054    MRCWSX    P      ED Certify that
     C                     MOVELWL0055    MROUNA    P      ED Inspector Na
     C                     MOVELWL0056    MRP7TX    P      ED Origin Count
     C                     MOVELWL0057    MRP9TX    P      ED Port of Load
     C                     MOVELWL0058    MROVNA    P      ED Transportion
     C                     MOVELWL0059    MRQATX    P      ED Seal Number
     C                     MOVELWL0060    MRQBTX    P      ED Seal Number
     C                     MOVELWL0061    MRQCTX    P      ED Can_Import C
     C                     MOVELWL0062    MROWNA    P      ED Can_Import C
     C                     MOVELWL0063    MROXNA    P      ED Can_Import C
     C                     Z-ADDWL0064    MRABNX           ED Can_Import C
     C                     Z-ADDWL0065    MRACNX           ED Can_Import C
     C                     Z-ADDWL0066    MRADNX           ED Seaboard Pla
     C                     MOVELWL0067    MRQDTX    P      ED USDA Cert Nb
     C                     MOVELWL0068    MRQETX    P      ED USDA Cert Nb
     C                     MOVELWL0069    MROYNA    P      ED Can_Port of
     C                     MOVELWL0070    MROZNA    P      ED Can_Reinsp E
     C                     MOVELWL0071    MRO0NA    P      ED Can_Reinsp E
     C                     MOVELWL0072    MRO1NA    P      ED Can_Reinsp E
     C                     MOVELWL0073    MRCXSX    P      ED Herm Sealed
     C                     MOVELWL0074    MRCYSX    P      ED Herm Sealed
     C                     MOVELWL0075    MRAGNX    P      ED Herm Sealed
     C                     MOVELWL0076    MRCZSX    P      ED Whole Bird S
     C                     MOVELWL0077    MRC0SX    P      ED Marked Sts
     C                     MOVELWL0078    MRC1SX    P      ED Tamper Evide
     C                     MOVELWL0079    MRQFTX    P      ED Plant Contac
     C                     Z-ADDWL0080    MRAHNX           ED Plant Contac
     C                     MOVELWL0081    MRQGTX    P      ED Modified Tex
     C                     MOVELWL0082    MRQHTX    P      ED Issued Crt f
     C                     MOVELWL0083    MRQITX    P      ED Species
     C                     MOVELWL0084    MRQJTX    P      ED Slaughter Pl
     C                     MOVELWL0085    MRQKTX    P      ED Slaughter Pl
     C                     MOVELWL0086    MRQMTX    P      ED Slaughter Pl
     C                     MOVELWL0087    MRQNTX    P      ED Packaging Pl
     C                     MOVELWL0088    MRQOTX    P      ED Packaging Pl
     C                     MOVELWL0089    MRQPTX    P      ED Packaging Pl
     C                     MOVELWL0090    MRQQTX    P      ED Manufact Pla
     C                     MOVELWL0091    MRQRTX    P      ED Manufact Pla
     C                     MOVELWL0092    MRQSTX    P      ED Manufact Pla
     C                     MOVELWL0093    MRQTTX    P      ED USDA Name 1
     C                     MOVELWL0094    MRQUTX    P      ED USDA Name 2
     C                     MOVELWL0095    MRQVTX    P      ED USDA Name 3
     C                     MOVELWL0096    MRQYTX    P      ED Title of Off
     C                     MOVELWL0097    MRQWTX    P      ED Letter of Cr
     C                     MOVELWL0098    MRQZTX    P      ED Unused prd m
     C                     Z-ADDWL0099    MRAINX           ED Nbr of prods
     C                     MOVELWL0100    MRQ1TX    P      ED Importer Nam
     C                     MOVELWL0101    MRQ2TX    P      ED Importer Add
     C                     MOVELWL0102    MRQ3TX    P      ED Importer Add
     C                     MOVELWL0103    MRQ4TX    P      ED Purchaser Na
     C                     MOVELWL0104    MRQ5TX    P      ED Purchaser Ad
     C                     MOVELWL0105    MRQ6TX    P      ED Purchaser Ad
     C                     MOVELWL0106    MRQ7TX    P      ED Place Drct S
     C                     MOVELWL0107    MRQ8TX    P      ED Place Drct S
     C                     MOVELWL0108    MRQ9TX    P      ED Place Drct S
     C                     MOVELWL0109    MRSMTX    P      ED Place Drct S
     C                     MOVELWL0110    MRZQCD    P      ED Currency
     C                     MOVELWL0111    MRZRCD    P      ED Conditions o
     C                     Z-ADDWL0112    MRA7VL           ED Total Unit P
     C                     Z-ADDWL0113    MRA8VL           ED Invoice Tota
     C                     MOVELWL0114    MRC2SX    P      ED Live with PH
     C                     MOVELWL0115    MRC8SX    P      ED Print Status
     C                     Z-ADDWL0116    MRHRWG           ED Total Net We
     C                     Z-ADDWL0117    MRBIVL           ED Total Net We
     C                     Z-ADDWL0118    MRK2QT           ED Nbr of Packa
     C                     MOVELWL0119    MRO5NA    P      ED Customer PO
     C                     Z-ADDWL0120    MRHSWG           ED Total Gross
     C                     Z-ADDWL0121    MRBJVL           ED Total Gross
     C                     MOVELWL0122    MRRATX    P      ED Plant Number
     C                     MOVELWL0123    MRRBTX    P      ED Language Xla
     C                     MOVELWL0124    MRRCTX    P      ED Slaughter Da
     C                     MOVELWL0125    MRRDTX    P      ED Production m
     C                     MOVELWL0126    MRRETX    P      ED Remark Const
     C                     MOVELWL0127    MRC3SX    P      ED Allow Print
     C                     MOVELWL0128    MRC4SX    P      ED Cert of Orig
     C                     MOVELWL0129    MRC5SX    P      ED Use item lab
     C                     MOVELWL0130    MRC6SX    P      ED Slg_Proc Dat
     C                     MOVELWL0131    MRC7SX    P      ED Total Packag
     C                     Z-ADDWL0132    MRMQDT           ED Export Certi
     C                     Z-ADDWL0133    MRMRDT           ED Sail Date
     C                     Z-ADDWL0134    MRMSDT           ED Sworn on Dat
     C                     Z-ADDWL0135    MRAJNX           ED Consignee Ad
     C                     MOVELWL0136    MRYFTX    P      ED Form Identif
     C                     MOVELWL0137    MRX9TX    P      ED Cold Storage
     C                     MOVELWL0138    MRYATX    P      ED Cold Storage
     C                     MOVELWL0139    MRYBTX    P      ED Cold Storage
     C                     MOVELWL0140    MRB5AA    P      ED Cold Storage
     C                     MOVELWL0141    MRYCTX    P      ED Slaughter Da
     C                     MOVELWL0142    MRYDTX    P      ED Production m
     C                     MOVELWL0143    MRYETX    P      ED Production m
     C                     MOVELWL0144    MRB6AA    P      ED Booking Nbr
     C                     Z-ADDWL0145    MRPADT           ED Document Dat
     C                     Z-ADDWL0146    MRPBDT           ED Packing Date
     C                     Z-ADDWL0147    MRPCDT           ED Expiration D
     C                     Z-ADDWL0148    MRPDDT           ED Packing Date
     C                     Z-ADDWL0149    MRPEDT           ED Unused Date
     C                     MOVELWL0150    MRO4SX    P      ED Print Kilogr
     C                     MOVELWL0151    MRO5SX    P      ED MPR Canadian
     C                     MOVELWL0152    MRC1T1    P      ED Container Nb
     C                     MOVELWL0153    MRC2T1    P      ED Slaughter Da
     C                     MOVELWL0154    MRLKSC    P      ED Submit Statu
     C                     MOVELWL0155    MRLLSC    P      EDOH Unused Sts
     C                     MOVELWL0156    MRPIU1    P      EDOH Unused Tex
     C                     MOVELWL0157    MRPJU1    P      EDOH Unused Tex
     C                     Z-ADDWL0158    MRFFNZ           EDOH Unused Num
     C                     Z-ADDWL0159    MRBUDX           EDOH Unused Dat
     C                     MOVELWL0160    MRUVST    P      EDI Status 1
     C                     MOVELWL0161    MRUWST    P      EDI Status 2
     C                     MOVELWL0162    MRUXST    P      EDI Status 3
     C                     MOVELWL0163    MRVSST    P      Record Status
     C                     Z-ADDWL0164    MRAATM           Job Time
     C                     MOVELWL0165    MRAYNA    P      User Id
     C                     MOVELWL0166    MRA0NA    P      Job Name
     C                     Z-ADDWL0167    MRAXDT           Job Date
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     MRAATM           Job Time
     C                     MOVEL##USR     MRAYNA           User Id
     C                     MOVEL##PGM     MRA0NA           Job Name
     C                     Z-ADD##JDT     MRAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@MRREWS                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDMRREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv/Chg Order Hdr Date7RT - Export Doc Order Hdr  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSJ01           Company Number
     C           *LIKE     DEFN WBC4NB    WQSJ02           Order Number
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQSJ01           Company Number
     C                     Z-ADD#1C4NB    WQSJ02           Order Number
      * Establish starting position
     C           KRSSJ     SETLL@MRREX3                    *
     C           KRSSJ     READE@MRREX3                  90*
      * Data record not found
     C   90                MOVEL'USR2743' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RMC 5/17/22 Whd 99675 DO update the consignor fields. chg db1 to
      * RMC 04/06/22 update consignee on all docs
      * RMC 12/1/21 whd 75298 UNDO updating the consignor fields for now.
      * RMC 3/11/21 whd 75298 update consignor fields too
      * RMC 3/11/21 whd 75298 update SHIPPING MARKS
      * NEW RMC 03/13/07 upd exp cert no too
      * CASE: PAR.ED Export Certificate Nbr is Entered
     C           #1MQDT    IFNE 0                          *IF
      * CASE: DB1.ED Export Certificate Nbr is Not Entered
     C           WBMQDT    IFEQ 0                          *IF
     C                     Z-ADD#1MQDT    WUMQDT           ED Export Certi
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWBMQDT    WUMQDT           ED Export Certi
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWBMQDT    WUMQDT           ED Export Certi
     C                     END                             *FI
      * Chg Exp Doc Order Hdr  CH - Export Doc Order Hdr  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0011           Company Number
     C                     Z-ADDWBC4NB    WL0012           Order Number
     C                     MOVELWBDGSX    WL0013    P      ED Export Docum
     C                     MOVELWBKXCD    WL0014    P      Country Code
     C                     MOVELWBZMCD    WL0015    P      ED Area Office
     C                     MOVELWBPSTX    WL0016    P      ED Destination
     C                     MOVEL#1PUTX    WL0017    P      ED Consignor Na
     C                     MOVEL#1PVTX    WL0018    P      ED Consignor Ad
     C                     MOVEL#1PWTX    WL0019    P      ED Consignor Ad
     C                     MOVEL#1RVTX    WL0020    P      ED Consignor Ad
     C                     MOVEL#1PPU1    WL0021    P      ED Consignor Ad
     C                     MOVEL#1Z7AA    WL0022    P      ED Consignor St
     C                     MOVEL#1PDU1    WL0023    P      ED Consignor Po
     C                     MOVEL#1Z8AA    WL0024    P      ED Consignor Co
     C                     MOVEL#1RHTX    WL0025    P      ED Consignee Na
     C                     MOVEL#1RITX    WL0026    P      ED Consignee Ad
     C                     MOVEL#1RJTX    WL0027    P      ED Consignee Ad
     C                     MOVEL#1SCTX    WL0028    P      ED Consignee Ad
     C                     MOVEL#1SDTX    WL0029    P      ED Consignee Ad
     C                     MOVEL#1AAAB    WL0030    P      ED Consignee St
     C                     MOVEL#1PHU1    WL0031    P      ED Consignee Po
     C                     MOVEL#1ABAB    WL0032    P      ED Consignee Co
     C                     MOVELWBPXTX    WL0033    P      ED Plant Locati
     C                     MOVELWBZOCD    WL0034    P      ED Plant Locati
     C                     MOVELWBZNCD    WL0035    P      ED Plant Number
     C                     MOVELWBCSSX    WL0036    P      ED Processing P
     C                     MOVELWBCTSX    WL0037    P      ED Attachment S
     C                     MOVELWBCUSX    WL0038    P      ED Attachment T
     C                     MOVELWBCVSX    WL0039    P      ED Xlate Desc t
     C                     MOVELWBPTTX    WL0040    P      ED Unmarked Txt
     C                     MOVEL#1ORNA    WL0041    P      ED Shipping Mar
     C                     MOVELWBRKTX    WL0042    P      ED Date of Slau
     C                     MOVELWBPZTX    WL0043    P      ED Place of Sla
     C                     MOVELWBRLTX    WL0044    P      ED Date of Proc
     C                     MOVELWBP0TX    WL0045    P      ED Place of pro
     C                     MOVELWBP1TX    WL0046    P      ED Continue Com
     C                     MOVELWBP2TX    WL0047    P      ED Remark Const
     C                     MOVELWBP3TX    WL0048    P      ED Remark Const
     C                     MOVELWBP4TX    WL0049    P      ED Remark Const
     C                     MOVELWBP5TX    WL0050    P      ED Remark Const
     C                     MOVELWBP6TX    WL0051    P      ED Remark Const
     C                     MOVELWBYHTX    WL0052    P      ED Remark Const
     C                     MOVELWBYITX    WL0053    P      ED Remark Const
     C                     MOVELWBCWSX    WL0054    P      ED Certify that
     C                     MOVELWBOUNA    WL0055    P      ED Inspector Na
     C                     MOVELWBP7TX    WL0056    P      ED Origin Count
     C                     MOVELWBP9TX    WL0057    P      ED Port of Load
     C                     MOVELWBOVNA    WL0058    P      ED Transportion
     C                     MOVELWBQATX    WL0059    P      ED Seal Number
     C                     MOVELWBQBTX    WL0060    P      ED Seal Number
     C                     MOVELWBQCTX    WL0061    P      ED Can_Import C
     C                     MOVELWBOWNA    WL0062    P      ED Can_Import C
     C                     MOVELWBOXNA    WL0063    P      ED Can_Import C
     C                     Z-ADDWBABNX    WL0064           ED Can_Import C
     C                     Z-ADDWBACNX    WL0065           ED Can_Import C
     C                     Z-ADDWBADNX    WL0066           ED Seaboard Pla
     C                     MOVEL#1QDTX    WL0067    P      ED USDA Cert Nb
     C                     MOVELWBQETX    WL0068    P      ED USDA Cert Nb
     C                     MOVELWBOYNA    WL0069    P      ED Can_Port of
     C                     MOVELWBOZNA    WL0070    P      ED Can_Reinsp E
     C                     MOVELWBO0NA    WL0071    P      ED Can_Reinsp E
     C                     MOVELWBO1NA    WL0072    P      ED Can_Reinsp E
     C                     MOVELWBCXSX    WL0073    P      ED Herm Sealed
     C                     MOVELWBCYSX    WL0074    P      ED Herm Sealed
     C                     MOVELWBAGNX    WL0075    P      ED Herm Sealed
     C                     MOVELWBCZSX    WL0076    P      ED Whole Bird S
     C                     MOVELWBC0SX    WL0077    P      ED Marked Sts
     C                     MOVELWBC1SX    WL0078    P      ED Tamper Evide
     C                     MOVELWBQFTX    WL0079    P      ED Plant Contac
     C                     Z-ADDWBAHNX    WL0080           ED Plant Contac
     C                     MOVELWBQGTX    WL0081    P      ED Modified Tex
     C                     MOVELWBQHTX    WL0082    P      ED Issued Crt f
     C                     MOVELWBQITX    WL0083    P      ED Species
     C                     MOVELWBQJTX    WL0084    P      ED Slaughter Pl
     C                     MOVELWBQKTX    WL0085    P      ED Slaughter Pl
     C                     MOVELWBQMTX    WL0086    P      ED Slaughter Pl
     C                     MOVELWBQNTX    WL0087    P      ED Packaging Pl
     C                     MOVELWBQOTX    WL0088    P      ED Packaging Pl
     C                     MOVELWBQPTX    WL0089    P      ED Packaging Pl
     C                     MOVELWBQQTX    WL0090    P      ED Manufact Pla
     C                     MOVELWBQRTX    WL0091    P      ED Manufact Pla
     C                     MOVELWBQSTX    WL0092    P      ED Manufact Pla
     C                     MOVELWBQTTX    WL0093    P      ED USDA Name 1
     C                     MOVELWBQUTX    WL0094    P      ED USDA Name 2
     C                     MOVELWBQVTX    WL0095    P      ED USDA Name 3
     C                     MOVELWBQYTX    WL0096    P      ED Title of Off
     C                     MOVELWBQWTX    WL0097    P      ED Letter of Cr
     C                     MOVELWBQZTX    WL0098    P      ED Unused prd m
     C                     Z-ADDWBAINX    WL0099           ED Nbr of prods
     C                     MOVELWBQ1TX    WL0100    P      ED Importer Nam
     C                     MOVELWBQ2TX    WL0101    P      ED Importer Add
     C                     MOVELWBQ3TX    WL0102    P      ED Importer Add
     C                     MOVELWBQ4TX    WL0103    P      ED Purchaser Na
     C                     MOVELWBQ5TX    WL0104    P      ED Purchaser Ad
     C                     MOVELWBQ6TX    WL0105    P      ED Purchaser Ad
     C                     MOVELWBQ7TX    WL0106    P      ED Place Drct S
     C                     MOVELWBQ8TX    WL0107    P      ED Place Drct S
     C                     MOVELWBQ9TX    WL0108    P      ED Place Drct S
     C                     MOVELWBSMTX    WL0109    P      ED Place Drct S
     C                     MOVELWBZQCD    WL0110    P      ED Currency
     C                     MOVELWBZRCD    WL0111    P      ED Conditions o
     C                     Z-ADDWBA7VL    WL0112           ED Total Unit P
     C                     Z-ADDWBA8VL    WL0113           ED Invoice Tota
     C                     MOVELWBC2SX    WL0114    P      ED Live with PH
     C                     MOVELWBC8SX    WL0115    P      ED Print Status
     C                     Z-ADDWBHRWG    WL0116           ED Total Net We
     C                     Z-ADDWBBIVL    WL0117           ED Total Net We
     C                     Z-ADDWBK2QT    WL0118           ED Nbr of Packa
     C                     MOVELWBO5NA    WL0119    P      ED Customer PO
     C                     Z-ADDWBHSWG    WL0120           ED Total Gross
     C                     Z-ADDWBBJVL    WL0121           ED Total Gross
     C                     MOVELWBRATX    WL0122    P      ED Plant Number
     C                     MOVELWBRBTX    WL0123    P      ED Language Xla
     C                     MOVELWBRCTX    WL0124    P      ED Slaughter Da
     C                     MOVELWBRDTX    WL0125    P      ED Production m
     C                     MOVELWBRETX    WL0126    P      ED Remark Const
     C                     MOVELWBC3SX    WL0127    P      ED Allow Print
     C                     MOVELWBC4SX    WL0128    P      ED Cert of Orig
     C                     MOVELWBC5SX    WL0129    P      ED Use item lab
     C                     MOVELWBC6SX    WL0130    P      ED Slg_Proc Dat
     C                     MOVELWBC7SX    WL0131    P      ED Total Packag
     C                     Z-ADDWUMQDT    WL0132           ED Export Certi
     C                     Z-ADDWBMRDT    WL0133           ED Sail Date
     C                     Z-ADDWBMSDT    WL0134           ED Sworn on Dat
     C                     Z-ADDWBAJNX    WL0135           ED Consignee Ad
     C                     MOVELWBYFTX    WL0136    P      ED Form Identif
     C                     MOVELWBX9TX    WL0137    P      ED Cold Storage
     C                     MOVELWBYATX    WL0138    P      ED Cold Storage
     C                     MOVELWBYBTX    WL0139    P      ED Cold Storage
     C                     MOVELWBB5AA    WL0140    P      ED Cold Storage
     C                     MOVELWBYCTX    WL0141    P      ED Slaughter Da
     C                     MOVELWBYDTX    WL0142    P      ED Production m
     C                     MOVELWBYETX    WL0143    P      ED Production m
     C                     MOVELWBB6AA    WL0144    P      ED Booking Nbr
     C                     Z-ADD#1PADT    WL0145           ED Document Dat
     C                     Z-ADDWBPBDT    WL0146           ED Packing Date
     C                     Z-ADDWBPCDT    WL0147           ED Expiration D
     C                     Z-ADDWBPDDT    WL0148           ED Packing Date
     C                     Z-ADDWBPEDT    WL0149           ED Unused Date
     C                     MOVELWBO4SX    WL0150    P      ED Print Kilogr
     C                     MOVELWBO5SX    WL0151    P      ED MPR Canadian
     C                     MOVELWBC1T1    WL0152    P      ED Container Nb
     C                     MOVELWBC2T1    WL0153    P      ED Slaughter Da
     C                     MOVELWBLKSC    WL0154    P      ED Submit Statu
     C                     MOVELWBLLSC    WL0155    P      EDOH Unused Sts
     C                     MOVELWBPIU1    WL0156    P      EDOH Unused Tex
     C                     MOVELWBPJU1    WL0157    P      EDOH Unused Tex
     C                     Z-ADDWBFFNZ    WL0158           EDOH Unused Num
     C                     Z-ADDWBBUDX    WL0159           EDOH Unused Dat
     C                     MOVELWBUVST    WL0160    P      EDI Status 1
     C                     MOVELWBUWST    WL0161    P      EDI Status 2
     C                     MOVELWBUXST    WL0162    P      EDI Status 3
     C                     MOVELWBVSST    WL0163    P      Record Status
     C                     Z-ADDWBAATM    WL0164           Job Time
     C                     MOVELWBAYNA    WL0165    P      User Id
     C                     MOVELWBA0NA    WL0166    P      Job Name
     C                     Z-ADDWBAXDT    WL0167           Job Date
     C                     EXSR SICHRC
     C           KRSSJ     READE@MRREX3                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Upd Exp Doc Order Ext2 RT - Export Doc Order Hdr Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN A6AIC3    WQSK01           Company Number
     C           *LIKE     DEFN A6C4NB    WQSK02           Order Number
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Company Number
     C                     KFLD           WQSK02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQSK01           Company Number
     C                     Z-ADD#1C4NB    WQSK02           Order Number
      * Establish starting position
     C           KRSSK     SETLL@A6CPDH                    *
     C           KRSSK     READE@A6CPDH                  90*
      * Data record not found
     C   90                MOVEL'USR5073' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Country Code EQ DB1.Country Code
     C           #1KXCD    IFEQ A6KXCD                     *IF
      * Only Update PHIS Action Code for Doc Type 'A'.
      * CASE: DB1.ED Export Document Type is Application for Export
     C           A6DGSX    IFEQ 'A'                        *IF
     C                     MOVEL#DIFSC    YL0008           EDE PHIS Action
      * Only Update 'EDE Port of Entry' for Doc Type 'A'.
     C                     MOVEL#DRCU1    YL0009           EDE Port of Ent
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELA6IFSC    YL0008           EDE PHIS Action
     C                     MOVELA6KMU1    YL0009           EDE Port of Ent
     C                     END                             *FI
      * R16637 DN 09/29/20-Removed Unused Consignor/Consignee PHIS fields
      * DO2416 DN 04/14/22-Update EDE Port of Entry.
      * Chg Exp Doc Order Ext CH - Export Doc Order Hdr Ext  * 
     C                     EXSR SLCHRC
     C                     END                             *FI
     C           KRSSK     READE@A6CPDH                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCHRC    BEGSR
      *================================================================
      * Chg Exp Doc Order Ext CH - Export Doc Order Hdr Ext  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0046  60       Job Time
     C                     MOVEL*BLANK    WN0047 10        User Id
     C                     MOVEL*BLANK    WN0048 10        Job Name
     C                     Z-ADD*ZERO     WN0049  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @A6CPDG
     C                     Z-ADDA6AIC3    WAAIC3           Company Number
     C                     Z-ADDA6C4NB    WAC4NB           Order Number
     C                     MOVELA6DGSX    WADGSX    P      ED Export Docum
     C                     MOVELA6KXCD    WAKXCD    P      Country Code
      *
     C           KLCHSL    KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
     C                     KFLD           WADGSX           ED Export Docum
     C                     KFLD           WAKXCD           Country Code
     C           KLCHSL    CHAIN@A6CPDG              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PUA6CPL0'MDACP
     C                     MOVEL'@A6CPDG' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPUA61    YCRDCS
      * Move non-key fields to @A6CPDG
     C                     MOVEL#DHUSC    WAHUSC    P      EDE Reason f_Re
     C                     MOVEL#DHVSC    WAHVSC    P      EDE Shipment Ty
     C                     MOVEL#DHWSC    WAHWSC    P      EDE Frozen_Shel
     C                     MOVELA6X0AA    WAX0AA    P      EDE ISO Alpha_2
     C                     MOVELA6HXSC    WAHXSC    P      EDE USDA Export
     C                     MOVELA6HYSC    WAHYSC    P      EDE Special Pri
     C                     MOVEL#DJPU1    WAJPU1    P      EDE Appl_Billin
     C                     MOVEL#DJQU1    WAJQU1    P      EDE Appl_Billin
     C                     Z-ADDA6A1DX    WAA1DX           EDE Unused Date
     C                     MOVEL#DX1AA    WAX1AA    P      EDE Country of
     C                     MOVELA6YAAA    WAYAAA    P      EDE I Certify S
     C                     MOVELA6YBAA    WAYBAA    P      EDE Attachment
     C                     MOVELA6YCAA    WAYCAA    P      EDE Attachment
     C                     MOVEL#DYDAA    WAYDAA    P      EDE Transit Cou
     C                     MOVEL#DKGU1    WAKGU1    P      EDE Container N
     C                     MOVEL#DKHU1    WAKHU1    P      EDE Unused Text
     C                     MOVEL#DKIU1    WAKIU1    P      EDE Additional
     C                     MOVELA6IGSC    WAIGSC    P      EDE Maturity lt
     C                     MOVELA6KJU1    WAKJU1    P      EDE Seal Nos
     C                     MOVELA6KLU1    WAKLU1    P      EDE IFS PHIS Do
     C                     MOVELYL0009    WAKMU1    P      EDE Port of Ent
     C                     MOVELA6KNU1    WAKNU1    P      EDE Unused 2
     C                     MOVELA6KOU1    WAKOU1    P      EDE Unused 3
     C                     MOVELA6YEAA    WAYEAA    P      EDE Unused 4
     C                     MOVELA6KPU1    WAKPU1    P      EDE Unused 5
     C                     MOVEL#DKQU1    WAKQU1    P      EDE Consignee T
     C                     MOVELA6KSU1    WAKSU1    P      EDE Unused 6
     C                     MOVELA6KTU1    WAKTU1    P      EDE Unused 7
     C                     MOVELA6KUU1    WAKUU1    P      EDE Unused 8
     C                     MOVELA6KWU1    WAKWU1    P      EDE Unused 9
     C                     MOVELA6YFAA    WAYFAA    P      EDE Unused 10
     C                     MOVELA6KVU1    WAKVU1    P      EDE Unused 11
     C                     MOVEL#DKRU1    WAKRU1    P      EDE Consignor T
     C                     MOVELA6IESC    WAIESC    P      EDE PHIS Proces
     C                     MOVELA6AUTS    WAAUTS    P      EDE ETL Process
     C                     MOVELYL0008    WAIFSC    P      EDE PHIS Action
     C                     MOVELA6KFU1    WAKFU1    P      EDE Return Cde_
     C                     MOVELA6KKU1    WAKKU1    P      EDE Application
     C                     MOVELA6UVST    WAUVST    P      EDI Status 1
     C                     MOVELA6UWST    WAUWST    P      EDI Status 2
     C                     MOVELA6UXST    WAUXST    P      EDI Status 3
     C                     MOVELA6VSST    WAVSST    P      Record Status
      *
      * Set PGM.*Record Data Changed flag
     C           QPUA61    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * UPS CHGOBJ Stamp      IF
     C                     Z-ADD##JTM     WAAATM           Job Time
     C                     MOVEL##USR     WAAYNA           User Id
     C                     MOVEL##PGM     WAA0NA           Job Name
     C                     Z-ADD##JDT     WAAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPUA61    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@A6CPDG                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPUA6CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSM01           Application Cod
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSM01           Application Cod
     C                     MOVEL'OMS'     WQSM01           Application Cod
      * Establish starting position
     C           KRSSM     SETLL@DNRESF                    *
     C           KRSSM     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SNRVGN
     C                     END                             *FI
     C           KRSSM     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSN01           Application Cod
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSN01           Application Cod
      * Establish starting position
     C           KRSSN     SETLL@DNRESF                    *
     C           KRSSN     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSN     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Live with PHIS    RT - Export Doc Defaults  * From Doc Type
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0002           ED Live with PH
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           MMAIC3           Company Number
     C                     KFLD           MMDGSX           ED Export Docum
     C                     KFLD           MMKXCD           Country Code
      * Setup key
     C                     Z-ADDP1AIC3    MMAIC3           Company Number
     C                     MOVEL'A'       MMDGSX           ED Export Docum
     C                     MOVELP1KXCD    MMKXCD           Country Code
      * Establish starting position
     C           KRSSO     CHAIN@MMREWN              90    *
      * Data record not found
     C   90                MOVEL'USR2733' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELMMC2SX    YL0002           ED Live with PH
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C                     MOVELV1C4NB    WK1X02  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     C           WK1X02    OREQ '?'                        Order Number
     C           YPMTFD    OREQ '#1C4NB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1AIC3' defaulted for 'Company Number'.
      * Field '(KEY) #1C4NB' defaulted for 'Order Number'.
     C                     CALL 'PDPCSRR'              90  SEL Order
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0008  30       Company Number
     C           #1C4NB    PARM #1C4NB    WQ0009  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPCSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9931  *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1C4NB    IFNE *ZERO                      Order Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VA999
     C                     END
     C                     END
      *................................................................
      *
     C           KLVABE    KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    BEAIC3
     C                     Z-ADD#1C4NB    BEC4NB
     C           KLVABE    CHAIN@BECPFK              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VAEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VAEXIT
     C                     END
     C           VA999     TAG
      * Restrictor relation not satisfied
      * Send message 'Order Header TRG       NF'
     C                     MOVEL'USR0176' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'USR0176' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C                     MOVEL#1DGSX    WK1X02  1
     C                     MOVEL#1KXCD    WK1X03  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     C           WK1X02    OREQ '?'                        ED Export Docum
     C           YPMTFD    OREQ '#1DGSX'
     C           WK1X03    OREQ '?'                        Country Code
     C           YPMTFD    OREQ '#1KXCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1AIC3' defaulted for 'Company Number'.
      * Field '(KEY) #1KXCD' defaulted for 'Country Code'.
     C                     CALL 'PDMRSRR'              90  Select PD Expor
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0010  30       Company Number
     C           #1KXCD    PARM #1KXCD    WQ0011  6        Country Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMRSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1DGSX    IFNE *BLANK                     ED Export Docum
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1KXCD    IFNE *BLANK                     Country Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X03    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VB999
     C                     END
     C                     END
      *................................................................
      *
     C           KLVBMM    KLIST
     C                     KFLD           MMAIC3           Company Number
     C                     KFLD           MMDGSX           ED Export Docum
     C                     KFLD           MMKXCD           Country Code
      * Setup key
     C                     Z-ADD#1AIC3    MMAIC3
     C                     MOVEL#1DGSX    MMDGSX
     C                     MOVEL#1KXCD    MMKXCD
     C           KLVBMM    CHAIN@MMREWN              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
     C           VB999     TAG
      * Restrictor relation not satisfied
      * Send message 'Export Doc Defaults    NF'
     C                     MOVEL'USR2733' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'USR2733' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Order Header TRG
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVELV1C4NB    WK1X02  1
     C           WK1X02    IFEQ '?'                        Order Number
     C           YPMTFD    OREQ '#1C4NB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1AIC3' defaulted for 'Company Number'.
      * Field '(KEY) #1C4NB' defaulted for 'Order Number'.
     C                     CALL 'PDPCSRR'              90  SEL Order
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0066  30       Company Number
     C           #1C4NB    PARM #1C4NB    WQ0067  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPCSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9931  *
     C                     END
      *
     C           #1C4NB    IFNE *ZERO                      Order Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1C4NB    IFEQ *ZERO                      Order Number
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCBE    KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    BEAIC3
     C                     Z-ADD#1C4NB    BEC4NB
     C           KLVCBE    CHAIN@BECPFK              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Order Header TRG       NF'
     C                     MOVEL'USR0176' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0176' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C                     MOVEL#1DGSX    WK1X02  1
     C                     MOVEL#1KXCD    WK1X03  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     C           WK1X02    OREQ '?'                        ED Export Docum
     C           YPMTFD    OREQ '#1DGSX'
     C           WK1X03    OREQ '?'                        Country Code
     C           YPMTFD    OREQ '#1KXCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1AIC3' defaulted for 'Company Number'.
      * Field '(KEY) #1KXCD' defaulted for 'Country Code'.
     C                     CALL 'PDMRSRR'              90  Select PD Expor
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0068  30       Company Number
     C           #1KXCD    PARM #1KXCD    WQ0069  6        Country Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMRSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1DGSX    IFNE *BLANK                     ED Export Docum
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1KXCD    IFNE *BLANK                     Country Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X03    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VD999
     C                     END
     C                     END
      *................................................................
      *
     C           KLVDMM    KLIST
     C                     KFLD           MMAIC3           Company Number
     C                     KFLD           MMDGSX           ED Export Docum
     C                     KFLD           MMKXCD           Country Code
      * Setup key
     C                     Z-ADD#1AIC3    MMAIC3
     C                     MOVEL#1DGSX    MMDGSX
     C                     MOVEL#1KXCD    MMKXCD
     C           KLVDMM    CHAIN@MMREWN              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VDEXIT
     C                     END
     C           VD999     TAG
      * Restrictor relation not satisfied
      * Send message 'Export Doc Defaults    NF'
     C                     MOVEL'USR2733' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'USR2733' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         XDV24T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDI2DD    XDEX01           DD
     C                     Z-ADDXDI2MM    XDEX02           MM
     C           1000      MULT XDI2CC    XDEY02           Y
     C                     ADD  XDI2YY    XDEY02            YYY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDI2MM    XDEX01           MM
     C                     Z-ADDXDI2DD    XDEX02           DD
     C           1000      MULT XDI2CC    XDEY02           Y
     C                     ADD  XDI2YY    XDEY02            YYY
     C                     ELSE
      * YMD format
     C           1000      MULT XDI2CC    XDEY01           Y
     C                     ADD  XDI2YY    XDEY01            YYY
     C                     Z-ADDXDI2MM    XDEX03           MM
     C                     Z-ADDXDI2DD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDV24E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y1SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y1EXIT    ENDSR
      /EJECT
     CSR         Y2SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y2EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C           @#DFMT    IFEQ '#RCDKEY'
      * KEY Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C                     ENDIF
     C           @#DFMT    IFEQ '#RCDDTL1'
      * DETAIL Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW1END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW1BEG,F
     C                     MOVELW1NAM,F   W0CFL
     C                     ENDIF
     C                     ENDIF
     C           @#DFMT    IFEQ '#RCDDTL2'
      * DETAIL 2 Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW2END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW2BEG,F
     C                     MOVELW2NAM,F   W0CFL
     C                     ENDIF
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           ZHCSRW    IFEQ 005
     C           ZHCSCL    ANDGE030
     C           ZHCSCL    ANDLE036
     C           @#DFMT    ANDEQ'#RCDKEY'
     C                     MOVEL'#1C4NB'  YPMTFD           Order Number
     C                     END
      *
     C           ZHCSRW    IFEQ 005
     C           ZHCSCL    ANDEQ023
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN79     ANDEQ'0'
     C                     MOVEL'#DIFSC'  YPMTFD           EDE PHIS Action
     C                     END
      *
     C           ZHCSRW    IFEQ 005
     C           ZHCSCL    ANDEQ054
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN78     ANDEQ'0'
     C                     MOVEL'#1LKSC'  YPMTFD           ED Submit Statu
     C                     END
      *
     C           ZHCSRW    IFEQ 005
     C           ZHCSCL    ANDGE077
     C           ZHCSCL    ANDLE078
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DHUSC'  YPMTFD           EDE Reason f_Re
     C                     END
      *
     C           ZHCSRW    IFEQ 007
     C           ZHCSCL    ANDGE023
     C           ZHCSCL    ANDLE024
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DHVSC'  YPMTFD           EDE Shipment Ty
     C                     END
      *
     C           ZHCSRW    IFEQ 009
     C           ZHCSCL    ANDEQ023
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DHWSC'  YPMTFD           EDE Frozen_Shel
     C                     END
      *
     C           ZHCSRW    IFEQ 009
     C           ZHCSCL    ANDEQ096
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1CVSX'  YPMTFD           ED Xlate Desc t
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM 1         YYLGCT  50       # of grps
     C                     PARM W0GRP     YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel and exit from key screen
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
     C                     MOVE '0'       XDTSDL 26 P
     C                     MOVEL@CN,001   XDTSDL
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAA1DX           EDE Unused Date
     C                     MOVELXDTSDL    WAAUTS           EDE ETL Process
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBABNX           ED Can_Import C
     C                     Z-ADD*ZERO     WBACNX           ED Can_Import C
     C                     Z-ADD*ZERO     WBADNX           ED Seaboard Pla
     C                     Z-ADD*ZERO     WBAHNX           ED Plant Contac
     C                     Z-ADD*ZERO     WBAINX           ED Nbr of prods
     C                     Z-ADD*ZERO     WBA7VL           ED Total Unit P
     C                     Z-ADD*ZERO     WBA8VL           ED Invoice Tota
     C                     Z-ADD*ZERO     WBHRWG           ED Total Net We
     C                     Z-ADD*ZERO     WBBIVL           ED Total Net We
     C                     Z-ADD*ZERO     WBK2QT           ED Nbr of Packa
     C                     Z-ADD*ZERO     WBHSWG           ED Total Gross
     C                     Z-ADD*ZERO     WBBJVL           ED Total Gross
     C                     Z-ADD*ZERO     WBMQDT           ED Export Certi
     C                     Z-ADD*ZERO     WBMRDT           ED Sail Date
     C                     Z-ADD*ZERO     WBMSDT           ED Sworn on Dat
     C                     Z-ADD*ZERO     WBAJNX           ED Consignee Ad
     C                     Z-ADD*ZERO     WBPADT           ED Document Dat
     C                     Z-ADD*ZERO     WBPBDT           ED Packing Date
     C                     Z-ADD*ZERO     WBPCDT           ED Expiration D
     C                     Z-ADD*ZERO     WBPDDT           ED Packing Date
     C                     Z-ADD*ZERO     WBPEDT           ED Unused Date
     C                     Z-ADD*ZERO     WBFFNZ           EDOH Unused Num
     C                     Z-ADD*ZERO     WBBUDX           EDOH Unused Dat
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field ED Export Certificate Nbr
     C                     Z-ADD*ZERO     WUMQDT  70
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     MOVEL*BLANK    WL0002 10
     C                     MOVEL*BLANK    WL0003 40
      * Define local variables for subroutine SERVGN.
     C                     MOVEL*BLANK    WL0004  2
     C                     MOVEL*BLANK    WL0005  1
      * Define local variables for subroutine SFRVGN.
     C                     MOVEL*BLANK    WL0006  6
     C                     MOVEL*BLANK    WL0007  1
      * Define local variables for subroutine SGRVGN.
     C                     MOVEL*BLANK    WL0008  6
     C                     MOVEL*BLANK    WL0009 30
     C                     MOVEL*BLANK    WL0010  1
      * Define local variables for subroutine SICHRC.
     C                     Z-ADD*ZERO     WL0011  30
     C                     Z-ADD*ZERO     WL0012  70
     C                     MOVEL*BLANK    WL0013  1
     C                     MOVEL*BLANK    WL0014  6
     C                     MOVEL*BLANK    WL0015 15
     C                     MOVEL*BLANK    WL0016 20
     C                     MOVEL*BLANK    WL0017 63
     C                     MOVEL*BLANK    WL0018 63
     C                     MOVEL*BLANK    WL0019 63
     C                     MOVEL*BLANK    WL0020 63
     C                     MOVEL*BLANK    WL0021 63
     C                     MOVEL*BLANK    WL0022  2
     C                     MOVEL*BLANK    WL0023 20
     C                     MOVEL*BLANK    WL0024  6
     C                     MOVEL*BLANK    WL0025 63
     C                     MOVEL*BLANK    WL0026 63
     C                     MOVEL*BLANK    WL0027 63
     C                     MOVEL*BLANK    WL0028 63
     C                     MOVEL*BLANK    WL0029 63
     C                     MOVEL*BLANK    WL0030  2
     C                     MOVEL*BLANK    WL0031 20
     C                     MOVEL*BLANK    WL0032  6
     C                     MOVEL*BLANK    WL0033 30
     C                     MOVEL*BLANK    WL0034  2
     C                     MOVEL*BLANK    WL0035 10
     C                     MOVEL*BLANK    WL0036  1
     C                     MOVEL*BLANK    WL0037  1
     C                     MOVEL*BLANK    WL0038  1
     C                     MOVEL*BLANK    WL0039  1
     C                     MOVEL*BLANK    WL0040 10
     C                     MOVEL*BLANK    WL0041 15
     C                     MOVEL*BLANK    WL0042 70
     C                     MOVEL*BLANK    WL0043 70
     C                     MOVEL*BLANK    WL0044 70
     C                     MOVEL*BLANK    WL0045 70
     C                     MOVEL*BLANK    WL0046 70
     C                     MOVEL*BLANK    WL0047 70
     C                     MOVEL*BLANK    WL0048 70
     C                     MOVEL*BLANK    WL0049 70
     C                     MOVEL*BLANK    WL0050 70
     C                     MOVEL*BLANK    WL0051 70
     C                     MOVEL*BLANK    WL0052 70
     C                     MOVEL*BLANK    WL0053 70
     C                     MOVEL*BLANK    WL0054  1
     C                     MOVEL*BLANK    WL0055 40
     C                     MOVEL*BLANK    WL0056 10
     C                     MOVEL*BLANK    WL0057 18
     C                     MOVEL*BLANK    WL0058 15
     C                     MOVEL*BLANK    WL0059 10
     C                     MOVEL*BLANK    WL0060 10
     C                     MOVEL*BLANK    WL0061 30
     C                     MOVEL*BLANK    WL0062 30
     C                     MOVEL*BLANK    WL0063 30
     C                     Z-ADD*ZERO     WL0064 100
     C                     Z-ADD*ZERO     WL0065 100
     C                     Z-ADD*ZERO     WL0066 100
     C                     MOVEL*BLANK    WL0067  3
     C                     MOVEL*BLANK    WL0068  8
     C                     MOVEL*BLANK    WL0069 30
     C                     MOVEL*BLANK    WL0070 30
     C                     MOVEL*BLANK    WL0071 30
     C                     MOVEL*BLANK    WL0072 30
     C                     MOVEL*BLANK    WL0073  1
     C                     MOVEL*BLANK    WL0074  1
     C                     MOVEL*BLANK    WL0075 20
     C                     MOVEL*BLANK    WL0076  1
     C                     MOVEL*BLANK    WL0077  1
     C                     MOVEL*BLANK    WL0078  1
     C                     MOVEL*BLANK    WL0079 30
     C                     Z-ADD*ZERO     WL0080 100
     C                     MOVEL*BLANK    WL0081 10
     C                     MOVEL*BLANK    WL0082 50
     C                     MOVEL*BLANK    WL0083 25
     C                     MOVEL*BLANK    WL0084 40
     C                     MOVEL*BLANK    WL0085 40
     C                     MOVEL*BLANK    WL0086 40
     C                     MOVEL*BLANK    WL0087 40
     C                     MOVEL*BLANK    WL0088 40
     C                     MOVEL*BLANK    WL0089 40
     C                     MOVEL*BLANK    WL0090 40
     C                     MOVEL*BLANK    WL0091 40
     C                     MOVEL*BLANK    WL0092 40
     C                     MOVEL*BLANK    WL0093 40
     C                     MOVEL*BLANK    WL0094 40
     C                     MOVEL*BLANK    WL0095 40
     C                     MOVEL*BLANK    WL0096 20
     C                     MOVEL*BLANK    WL0097 10
     C                     MOVEL*BLANK    WL0098 20
     C                     Z-ADD*ZERO     WL0099  20
     C                     MOVEL*BLANK    WL0100 30
     C                     MOVEL*BLANK    WL0101 30
     C                     MOVEL*BLANK    WL0102 30
     C                     MOVEL*BLANK    WL0103 30
     C                     MOVEL*BLANK    WL0104 30
     C                     MOVEL*BLANK    WL0105 30
     C                     MOVEL*BLANK    WL0106 63
     C                     MOVEL*BLANK    WL0107 63
     C                     MOVEL*BLANK    WL0108 63
     C                     MOVEL*BLANK    WL0109 63
     C                     MOVEL*BLANK    WL0110  5
     C                     MOVEL*BLANK    WL0111  5
     C                     Z-ADD*ZERO     WL0112  62
     C                     Z-ADD*ZERO     WL0113  92
     C                     MOVEL*BLANK    WL0114  1
     C                     MOVEL*BLANK    WL0115  1
     C                     Z-ADD*ZERO     WL0116  91
     C                     Z-ADD*ZERO     WL0117  74
     C                     Z-ADD*ZERO     WL0118  50
     C                     MOVEL*BLANK    WL0119 15
     C                     Z-ADD*ZERO     WL0120  91
     C                     Z-ADD*ZERO     WL0121  74
     C                     MOVEL*BLANK    WL0122 10
     C                     MOVEL*BLANK    WL0123 25
     C                     MOVEL*BLANK    WL0124 25
     C                     MOVEL*BLANK    WL0125 30
     C                     MOVEL*BLANK    WL0126 70
     C                     MOVEL*BLANK    WL0127  1
     C                     MOVEL*BLANK    WL0128  1
     C                     MOVEL*BLANK    WL0129  1
     C                     MOVEL*BLANK    WL0130  2
     C                     MOVEL*BLANK    WL0131  2
     C                     Z-ADD*ZERO     WL0132  70
     C                     Z-ADD*ZERO     WL0133  70
     C                     Z-ADD*ZERO     WL0134  70
     C                     Z-ADD*ZERO     WL0135  92
     C                     MOVEL*BLANK    WL0136 65
     C                     MOVEL*BLANK    WL0137 40
     C                     MOVEL*BLANK    WL0138 40
     C                     MOVEL*BLANK    WL0139 40
     C                     MOVEL*BLANK    WL0140 10
     C                     MOVEL*BLANK    WL0141 40
     C                     MOVEL*BLANK    WL0142 40
     C                     MOVEL*BLANK    WL0143 40
     C                     MOVEL*BLANK    WL0144 10
     C                     Z-ADD*ZERO     WL0145  70
     C                     Z-ADD*ZERO     WL0146  70
     C                     Z-ADD*ZERO     WL0147  70
     C                     Z-ADD*ZERO     WL0148  70
     C                     Z-ADD*ZERO     WL0149  70
     C                     MOVEL*BLANK    WL0150  1
     C                     MOVEL*BLANK    WL0151  2
     C                     MOVEL*BLANK    WL0152 25
     C                     MOVEL*BLANK    WL0153 25
     C                     MOVEL*BLANK    WL0154  1
     C                     MOVEL*BLANK    WL0155  3
     C                     MOVEL*BLANK    WL0156 25
     C                     MOVEL*BLANK    WL0157 40
     C                     Z-ADD*ZERO     WL0158  90
     C                     Z-ADD*ZERO     WL0159  80
     C                     MOVEL*BLANK    WL0160  1
     C                     MOVEL*BLANK    WL0161  1
     C                     MOVEL*BLANK    WL0162  1
     C                     MOVEL*BLANK    WL0163  1
     C                     Z-ADD*ZERO     WL0164  60
     C                     MOVEL*BLANK    WL0165 10
     C                     MOVEL*BLANK    WL0166 10
     C                     Z-ADD*ZERO     WL0167  70
      * Define null work field EDE USDA Export Mark Sts
     C                     MOVEL*BLANK    YN0001  1
      * Define null work field EDE Special Printing Ctl
     C                     MOVEL*BLANK    YN0002  2
      * Define null work field EDE Unused Date
     C                     Z-ADD*ZERO     YN0003  80
      * Define null work field EDE IFS PHIS Doc Filename
     C                     MOVEL*BLANK    YN0004 50
      * Define null work field EDE Unused 2
     C                     MOVEL*BLANK    YN0005 50
      * Define null work field EDE Unused 3
     C                     MOVEL*BLANK    YN0006 50
      * Define null work field EDE Unused 4
     C                     MOVEL*BLANK    YN0007  2
      * Define null work field EDE Unused 5
     C                     MOVEL*BLANK    YN0008 20
      * Define null work field EDE Unused 6
     C                     MOVEL*BLANK    YN0009 50
      * Define null work field EDE Unused 7
     C                     MOVEL*BLANK    YN0010 50
      * Define null work field EDE Unused 8
     C                     MOVEL*BLANK    YN0011 50
      * Define null work field EDE Unused 9
     C                     MOVEL*BLANK    YN0012 50
      * Define null work field EDE Unused 10
     C                     MOVEL*BLANK    YN0013  2
      * Define null work field EDE Unused 11
     C                     MOVEL*BLANK    YN0014 20
      * Define local work field EDE PHIS Action
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field ED Live with PHIS
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Output Only 1 USR
     C                     MOVEL*BLANK    YL0003  1
      * Define null work field SUP/SPM Have Print USR
     C                     MOVEL*BLANK    YN0015  1
      * Define local work field PHIS Pre-Validtn Err USR
     C                     MOVEL*BLANK    YL0004  6
      * Define local work field PHIS Pre-Validtn Err Dsc
     C                     MOVEL*BLANK    YL0005 25
      * Define local work field Generic Message 80 USR
     C                     MOVEL*BLANK    YL0006 80
      * Define local work field Record Status
     C                     MOVEL*BLANK    YL0007  1
      * Define null work field Country Description
     C                     MOVEL*BLANK    YN0016 30
      * Define local work field EDE PHIS Action
     C                     MOVEL*BLANK    YL0008  1
      * Define local work field EDE Port of Entry
     C                     MOVEL*BLANK    YL0009 50
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
      * Initialise error memories
     C                     MOVE *ZERO     @@I1
     C                     MOVE *ZERO     @@I2
      * Set to *CHANGE mode
     C                     MOVEL'CHG'     W0PMD   3
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * ***NOTE: This was a cloned from PUHVE2R. Any changes to this
      *          function you may consider changing PUHVE2R also.
      *          R16637 DN 09/28/20-PUHVE2R will no longer be used.
      * VAL Rtv and Center Hdg IF
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SMRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
      * Rtv Live with PHIS    RT - Export Doc Defaults  * From Doc Type A
     C                     EXSR SORVGN
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** KEY Screen: Field position and name array
01054013100156601822
** W0END
01056013160156601827
** W0NAM
V1AIC3    V1C4NB    #1DGSX    #1KXCD
** W1BEG
01047010710110801136013030130701334
01336013570136201400015590158501628
01815018200188401912020710213002327
02353024000283903095033510360703863
04119041300416104178043750463104887
05143053990565505666056970571406172
06183
** W1END
01049010770111301136013030131801334
01346013580138601405015610159101647
01816018440188901917020850216902327
02362024000290103157034130366903925
04120041490416604193044370469304949
05205054610565605685057020572906181
06212
** W1NAM
V1AIC3    V1C4NB    #1KXCD    #1C2SX    #DIFSC    #DK3U1    #1LKSC
#DQ8U1    #DHUSC    #DJRU1    V1PADT    #1QDTX    #1MQDT    #1PSTX
#DHVSC    #DJSU1    #DX1AA    #DYDAA    #1ORNA    #DRCU1    #DHWSC
#1ZNCD    #1CVSX    #1PUTX    #1PVTX    #1PWTX    #1RVTX    #1PPU1
#1Z7AA    #1PDU1    #1Z8AA    #DKRU1    #1RHTX    #1RITX    #1RJTX
#1SCTX    #1SDTX    #1AAAB    #1PHU1    #1ABAB    #DKQU1    #DJPU1
#DJQU1
** W2BEG
01047010710110801136015580181402582
02838030940360604118041410416704374
0514205144051900539805654
** W2END
01049010770111301136015970185302651
02907031630362504127041500419104473
0514205163052080547205689
** W2NAM
V1AIC3    V1C4NB    #1KXCD    #1C2SX    #1QJTX    #1QQTX    #1P2TX
#1P3TX    #1P4TX    #1QYTX    #1QATX    #1QBTX    #DKGU1    #DKIU1
#DIESC    #DK4U1    VDAUTS    #DKFU1    #DKKU1
** @CN
00001 0001-01-01-00.00.00.00000
00002 TRSCNT
00003 Attachment Type 'SPM' &
00004 Subtype 'L' exist.
00005 required.
00006 USR0752
00007 PHIS Process Sts is in er
00008 ror. Must select New or C
00009 ancel for PHIS Action Cde
00010 Cannot update PHIS Action
00011 Code to New.
00012 Code. Select any status
00013 except Cancel.
00014 Country of Final Destinat
00015 ion is inactive.
00016 Transit Country is
00017 inactive.
00018 Port of Entry is not
00019 active.
