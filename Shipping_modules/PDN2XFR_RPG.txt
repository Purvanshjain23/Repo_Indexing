     H/TITLE ADD Ready to Confirm   XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISJMIST
     H* Date          : 03/12/25  Time  : 03:39:22
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FOMFNCPL1IF  E           K        DISK
      * RTV : Manifest Detail           Retrieval index
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FPPBUREL1IF  E           K        DISK
      * RTV : PFS Interface             Retrieval index
      *
     FPNG0REL1IF  E           K        DISK
      * RTV : EDI WHS Interchange       Retrieval index
      *
     FCAEOREL1IF  E           K        DISK
      * RTV : Company Customer          Retrieval index
      *
     FPDMSREL2IF  E           K        DISK
      * RSQ : Export Doc Order Dtl      Co/Order/Seq
      *
     FPMAMREL1IF  E           K        DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FPDL8CPL5IF  E           K        DISK
      * RSQ : Order Inv Allocation      Co/Ord/Sq/Sq2/PD/Lt/Lc/L
      *
     FPDL7CPL2IF  E           K        DISK
      * RSQ : Item Lot Loc Trans        Co/Itm/Whs/Typ/Dte/Sq(d)
      *
     FPDL5CPL1IF  E           K        DISK
      * RTV : Item Lot Location         Retrieval index
      *
     FPDL2REL0IF  E           K        DISK
      * RTV : Warehouse Location        Retrieval index
      *
     FPDL3REL0IF  E           K        DISK
      * RTV : Warehouse Location Type   Retrieval index
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAB1REL0IF  E           K        DISK
      * RTV : Item Balance Detail       Retrieval index       NV
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     FPDMSREL0UF  E           K        DISK
      * UPD : Export Doc Order Dtl      Update index
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FPMAMREL0UF  E           K        DISK                      A
      * UPD : Order Header Extension    Update index
      *
     FOMFFREL1UF  E           K        DISK
      * UPD : Carrier Info              Update index
      *
     FPDL7CPL0IF  E           K        DISK                      A
      * UPD : Item Lot Loc Trans        Update index
      *
     FPDL5CPL0UF  E           K        DISK                      A
      * UPD : Item Lot Location         Update index
      *
     FCAB1REL1UF  E           K        DISK
      * UPD : Item Balance Detail       Update index
      *
     FPDL8CPL0UF  E           K        DISK
      * UPD : Order Inv Allocation      Update index
      *
     E                    #L7         7  1
      * Long constants
     E                    @CN#    1  02  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WAAIC3
     I              BEC4NB                          WAC4NB
     I              BEJNCD                          WAJNCD
     I              BEANC7                          WAANC7
     I              BEBKC7                          WABKC7
     I              BEBRTX                          WABRTX
     I              BEHMNA                          WAHMNA
     I              BEHONA                          WAHONA
     I              BEHPNA                          WAHPNA
     I              BEHNNA                          WAHNNA
     I              BEDBCD                          WADBCD
     I              BECKTX                          WACKTX
     I              BEB0C7                          WAB0C7
     I              BEAETX                          WAAETX
     I              BEB1NA                          WAB1NA
     I              BEB3NA                          WAB3NA
     I              BEB4NA                          WAB4NA
     I              BEB2NA                          WAB2NA
     I              BEBHCD                          WABHCD
     I              BEC8TX                          WAC8TX
     I              BEBCNA                          WABCNA
     I              BEA0DT                          WAA0DT
     I              BEA5DT                          WAA5DT
     I              BEGNDT                          WAGNDT
     I              BEACDT                          WAACDT
     I              BEAQCD                          WAAQCD
     I              BEB6NA                          WAB6NA
     I              BEBYNA                          WABYNA
     I              BEBZNA                          WABZNA
     I              BEGTST                          WAGTST
     I              BEGVST                          WAGVST
     I              BEGUST                          WAGUST
     I              BEQFST                          WAQFST
     I              BECQCD                          WACQCD
     I              BEGJST                          WAGJST
     I              BEGWST                          WAGWST
     I              BEGXST                          WAGXST
     I              BEGYST                          WAGYST
     I              BEAODT                          WAAODT
     I              BEAIVN                          WAAIVN
     I              BECXDT                          WACXDT
     I              BEJZVA                          WAJZVA
     I              BEA1WG                          WAA1WG
     I              BEXIST                          WAXIST
     I              BEXJST                          WAXJST
     I              BEXKST                          WAXKST
     I              BEEIDT                          WAEIDT
     I              BEAFTM                          WAAFTM
     I              BEE8CD                          WAE8CD
     I              BEE9CD                          WAE9CD
     I              BERMNB                          WARMNB
     I              BETBNB                          WATBNB
     I              BER1NB                          WAR1NB
     I              BEPJST                          WAPJST
     I              BEU0ST                          WAU0ST
     I              BEU1ST                          WAU1ST
     I              BEQ2CD                          WAQ2CD
     I              BEU2ST                          WAU2ST
     I              BEVEST                          WAVEST
     I              BEVFST                          WAVFST
     I              BEVGST                          WAVGST
     I              BERPCD                          WARPCD
     I              BERNNB                          WARNNB
     I              BEVDST                          WAVDST
     I              BEATIN                          WAATIN
     I              BEU4ST                          WAU4ST
     I              BEU5ST                          WAU5ST
     I              BERSRN                          WARSRN
     I              BEMHNA                          WAMHNA
     I              BEMINA                          WAMINA
     I              BEWBST                          WAWBST
     I              BER4CD                          WAR4CD
     I              BEBFCD                          WABFCD
     I              BEQ4CD                          WAQ4CD
     I              BET3NB                          WAT3NB
     I              BESICD                          WASICD
     I              BECONB                          WACONB
     I              BECEST                          WACEST
     I              BEAWDT                          WAAWDT
     I              BEJPCD                          WAJPCD
     I              BEXUST                          WAXUST
     I              BEZ1ST                          WAZ1ST
     I              BEVRVA                          WAVRVA
     I              BEOBST                          WAOBST
     I              BEBCST                          WABCST
     I              BEBDST                          WABDST
     I              BEB7VL                          WAB7VL
     I              BEGASX                          WAGASX
     I              BEGBSX                          WAGBSX
     I              BEGCSX                          WAGCSX
     I              BEGDSX                          WAGDSX
     I              BEFNSX                          WAFNSX
     I              BEFOSX                          WAFOSX
     I              BEFPSX                          WAFPSX
     I              BEFQSX                          WAFQSX
     I              BEFRSX                          WAFRSX
     I              BEFSSX                          WAFSSX
     I              BEFTSX                          WAFTSX
     I              BEFUSX                          WAFUSX
     I              BEFVSX                          WAFVSX
     I              BEFWSX                          WAFWSX
     I              BEFXSX                          WAFXSX
     I              BEFYSX                          WAFYSX
     I              BENODT                          WANODT
     I              BENPDT                          WANPDT
     I              BENQDT                          WANQDT
     I              BENRDT                          WANRDT
     I              BENSDT                          WANSDT
     I              BEBPTM                          WABPTM
     I              BEBQTM                          WABQTM
     I              BEBRTM                          WABRTM
     I              BEBSTM                          WABSTM
     I              BEBTTM                          WABTTM
     I              BEH0NX                          WAH0NX
     I              BEH1NX                          WAH1NX
     I              BEH2NX                          WAH2NX
     I              BEH3NX                          WAH3NX
     I              BEH4NX                          WAH4NX
     I              BEC0C7                          WAC0C7
     I              BEUVST                          WAUVST
     I              BEUWST                          WAUWST
     I              BEUXST                          WAUXST
     I              BEAATM                          WAAATM
     I              BEAYNA                          WAAYNA
     I              BEA0NA                          WAA0NA
     I              BEAXDT                          WAAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WBAIC3
     I              OMC4NB                          WBC4NB
     I              OMDPNB                          WBDPNB
     I              OMUENB                          WBUENB
     I              OMHGCD                          WBHGCD
     I              OMAJCD                          WBAJCD
     I              OMBKC7                          WBBKC7
     I              OMCFC7                          WBCFC7
     I              OMGMST                          WBGMST
     I              OMGNST                          WBGNST
     I              OMMAVA                          WBMAVA
     I              OMKDVA                          WBKDVA
     I              OML8VA                          WBL8VA
     I              OML9VA                          WBL9VA
     I              OMGTST                          WBGTST
     I              OMGVST                          WBGVST
     I              OMGUST                          WBGUST
     I              OMQFST                          WBQFST
     I              OMAYVA                          WBAYVA
     I              OMEXDT                          WBEXDT
     I              OMLQCD                          WBLQCD
     I              OMRDCD                          WBRDCD
     I              OMQ7CD                          WBQ7CD
     I              OMBZPR                          WBBZPR
     I              OML6NB                          WBL6NB
     I              OMU1ST                          WBU1ST
     I              OMGIDT                          WBGIDT
     I              OMCRCD                          WBCRCD
     I              OMAGCD                          WBAGCD
     I              OMRZST                          WBRZST
     I              OMR0ST                          WBR0ST
     I              OMR1ST                          WBR1ST
     I              OMG7NA                          WBG7NA
     I              OMG8NA                          WBG8NA
     I              OMRPCD                          WBRPCD
     I              OMVEST                          WBVEST
     I              OMVGST                          WBVGST
     I              OMAVST                          WBAVST
     I              OMU0ST                          WBU0ST
     I              OMRFCD                          WBRFCD
     I              OMFZST                          WBFZST
     I              OMR1NB                          WBR1NB
     I              OMAVQT                          WBAVQT
     I              OMD0WG                          WBD0WG
     I              OMCCQT                          WBCCQT
     I              OMAUWG                          WBAUWG
     I              OMCBQT                          WBCBQT
     I              OMATWG                          WBATWG
     I              OMAQCS                          WBAQCS
     I              OMAGCS                          WBAGCS
     I              OMAKPR                          WBAKPR
     I              OMALPR                          WBALPR
     I              OMAUPR                          WBAUPR
     I              OMAVWG                          WBAVWG
     I              OMA4WG                          WBA4WG
     I              OMA5DT                          WBA5DT
     I              OMAODT                          WBAODT
     I              OMGNDT                          WBGNDT
     I              OMAMST                          WBAMST
     I              OMANST                          WBANST
     I              OMVAST                          WBVAST
     I              OMRGNB                          WBRGNB
     I              OMRHNB                          WBRHNB
     I              OMRINB                          WBRINB
     I              OMRBCD                          WBRBCD
     I              OMHICD                          WBHICD
     I              OMRNCD                          WBRNCD
     I              OMROCD                          WBROCD
     I              OMCXDT                          WBCXDT
     I              OMAJVN                          WBAJVN
     I              OMKXCD                          WBKXCD
     I              OMJPCD                          WBJPCD
     I              OMCQCD                          WBCQCD
     I              OMR4CD                          WBR4CD
     I              OMZ1ST                          WBZ1ST
     I              OMZ3ST                          WBZ3ST
     I              OMZ4ST                          WBZ4ST
     I              OMDUPR                          WBDUPR
     I              OMB6VL                          WBB6VL
     I              OMA1AA                          WBA1AA
     I              OMFZSX                          WBFZSX
     I              OMF0SX                          WBF0SX
     I              OMF1SX                          WBF1SX
     I              OMF2SX                          WBF2SX
     I              OMF3SX                          WBF3SX
     I              OMF4SX                          WBF4SX
     I              OMF5SX                          WBF5SX
     I              OMF6SX                          WBF6SX
     I              OMF7SX                          WBF7SX
     I              OMNTDT                          WBNTDT
     I              OMNUDT                          WBNUDT
     I              OMNVDT                          WBNVDT
     I              OMNWDT                          WBNWDT
     I              OMNXDT                          WBNXDT
     I              OMBUTM                          WBBUTM
     I              OMBVTM                          WBBVTM
     I              OMBWTM                          WBBWTM
     I              OMBXTM                          WBBXTM
     I              OMBYTM                          WBBYTM
     I              OMH5NX                          WBH5NX
     I              OMH6NX                          WBH6NX
     I              OMH7NX                          WBH7NX
     I              OMH8NX                          WBH8NX
     I              OMH9NX                          WBH9NX
     I              OMDVPR                          WBDVPR
     I              OMDWPR                          WBDWPR
     I              OMDXPR                          WBDXPR
     I              OMDYPR                          WBDYPR
     I              OMDZPR                          WBDZPR
     I              OMGSPR                          WBGSPR
     I              OMGTPR                          WBGTPR
     I              OMGUPR                          WBGUPR
     I              OMHOST                          WBHOST
     I              OMHPST                          WBHPST
     I              OMIOST                          WBIOST
     I              OMPEWG                          WBPEWG
     I              OMRINY                          WBRINY
     I              OMTIDT                          WBTIDT
     I              OMTJDT                          WBTJDT
     I              OMH2ST                          WBH2ST
     I              OMH0ST                          WBH0ST
     I              OMH1ST                          WBH1ST
     I              OMTKDT                          WBTKDT
     I              OMTLDT                          WBTLDT
     I              OMTMDT                          WBTMDT
     I              OMUVST                          WBUVST
     I              OMUWST                          WBUWST
     I              OMUXST                          WBUXST
     I              OMAATM                          WBAATM
     I              OMAYNA                          WBAYNA
     I              OMA0NA                          WBA0NA
     I              OMAXDT                          WBAXDT
      *
     I@FNCPCT
      * Manifest Detail           Retrieval index
      * Renamed input format fields
     I              FNAIC3                          WCAIC3
     I              FNC4NB                          WCC4NB
     I              FNDPNB                          WCDPNB
     I              FNUENB                          WCUENB
     I              FNRZNB                          WCRZNB
     I              FNFOQT                          WCFOQT
     I              FNR0NB                          WCR0NB
     I              FNPMST                          WCPMST
     I              FNK7DT                          WCK7DT
     I              FNPFNX                          WCPFNX
     I              FNHGCD                          WCHGCD
     I              FNAJCD                          WCAJCD
     I              FNELDT                          WCELDT
     I              FNN5WG                          WCN5WG
     I              FNRZNA                          WCRZNA
     I              FNH5NY                          WCH5NY
     I              FNH6NY                          WCH6NY
     I              FNH7NY                          WCH7NY
     I              FNGBTX                          WCGBTX
     I              FNN6WG                          WCN6WG
     I              FNN7WG                          WCN7WG
     I              FNGCTX                          WCGCTX
     I              FNGDTX                          WCGDTX
     I              FNRBDT                          WCRBDT
     I              FNITNY                          WCITNY
     I              FNIVNY                          WCIVNY
     I              FNIUNY                          WCIUNY
     I              FNIWNY                          WCIWNY
     I              FNIXNY                          WCIXNY
     I              FNIYNY                          WCIYNY
     I              FNUVST                          WCUVST
     I              FNUWST                          WCUWST
     I              FNUXST                          WCUXST
     I              FNVSST                          WCVSST
     I              FNAATM                          WCAATM
     I              FNAYNA                          WCAYNA
     I              FNA0NA                          WCA0NA
     I              FNAXDT                          WCAXDT
     I              FNLPNZ                          WCLPNZ
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WDAIC3
     I              OMC4NB                          WDC4NB
     I              OMDPNB                          WDDPNB
     I              OMUENB                          WDUENB
     I              OMHGCD                          WDHGCD
     I              OMAJCD                          WDAJCD
     I              OMBKC7                          WDBKC7
     I              OMCFC7                          WDCFC7
     I              OMGMST                          WDGMST
     I              OMGNST                          WDGNST
     I              OMMAVA                          WDMAVA
     I              OMKDVA                          WDKDVA
     I              OML8VA                          WDL8VA
     I              OML9VA                          WDL9VA
     I              OMGTST                          WDGTST
     I              OMGVST                          WDGVST
     I              OMGUST                          WDGUST
     I              OMQFST                          WDQFST
     I              OMAYVA                          WDAYVA
     I              OMEXDT                          WDEXDT
     I              OMLQCD                          WDLQCD
     I              OMRDCD                          WDRDCD
     I              OMQ7CD                          WDQ7CD
     I              OMBZPR                          WDBZPR
     I              OML6NB                          WDL6NB
     I              OMU1ST                          WDU1ST
     I              OMGIDT                          WDGIDT
     I              OMCRCD                          WDCRCD
     I              OMAGCD                          WDAGCD
     I              OMRZST                          WDRZST
     I              OMR0ST                          WDR0ST
     I              OMR1ST                          WDR1ST
     I              OMG7NA                          WDG7NA
     I              OMG8NA                          WDG8NA
     I              OMRPCD                          WDRPCD
     I              OMVEST                          WDVEST
     I              OMVGST                          WDVGST
     I              OMAVST                          WDAVST
     I              OMU0ST                          WDU0ST
     I              OMRFCD                          WDRFCD
     I              OMFZST                          WDFZST
     I              OMR1NB                          WDR1NB
     I              OMAVQT                          WDAVQT
     I              OMD0WG                          WDD0WG
     I              OMCCQT                          WDCCQT
     I              OMAUWG                          WDAUWG
     I              OMCBQT                          WDCBQT
     I              OMATWG                          WDATWG
     I              OMAQCS                          WDAQCS
     I              OMAGCS                          WDAGCS
     I              OMAKPR                          WDAKPR
     I              OMALPR                          WDALPR
     I              OMAUPR                          WDAUPR
     I              OMAVWG                          WDAVWG
     I              OMA4WG                          WDA4WG
     I              OMA5DT                          WDA5DT
     I              OMAODT                          WDAODT
     I              OMGNDT                          WDGNDT
     I              OMAMST                          WDAMST
     I              OMANST                          WDANST
     I              OMVAST                          WDVAST
     I              OMRGNB                          WDRGNB
     I              OMRHNB                          WDRHNB
     I              OMRINB                          WDRINB
     I              OMRBCD                          WDRBCD
     I              OMHICD                          WDHICD
     I              OMRNCD                          WDRNCD
     I              OMROCD                          WDROCD
     I              OMCXDT                          WDCXDT
     I              OMAJVN                          WDAJVN
     I              OMKXCD                          WDKXCD
     I              OMJPCD                          WDJPCD
     I              OMCQCD                          WDCQCD
     I              OMR4CD                          WDR4CD
     I              OMZ1ST                          WDZ1ST
     I              OMZ3ST                          WDZ3ST
     I              OMZ4ST                          WDZ4ST
     I              OMDUPR                          WDDUPR
     I              OMB6VL                          WDB6VL
     I              OMA1AA                          WDA1AA
     I              OMFZSX                          WDFZSX
     I              OMF0SX                          WDF0SX
     I              OMF1SX                          WDF1SX
     I              OMF2SX                          WDF2SX
     I              OMF3SX                          WDF3SX
     I              OMF4SX                          WDF4SX
     I              OMF5SX                          WDF5SX
     I              OMF6SX                          WDF6SX
     I              OMF7SX                          WDF7SX
     I              OMNTDT                          WDNTDT
     I              OMNUDT                          WDNUDT
     I              OMNVDT                          WDNVDT
     I              OMNWDT                          WDNWDT
     I              OMNXDT                          WDNXDT
     I              OMBUTM                          WDBUTM
     I              OMBVTM                          WDBVTM
     I              OMBWTM                          WDBWTM
     I              OMBXTM                          WDBXTM
     I              OMBYTM                          WDBYTM
     I              OMH5NX                          WDH5NX
     I              OMH6NX                          WDH6NX
     I              OMH7NX                          WDH7NX
     I              OMH8NX                          WDH8NX
     I              OMH9NX                          WDH9NX
     I              OMDVPR                          WDDVPR
     I              OMDWPR                          WDDWPR
     I              OMDXPR                          WDDXPR
     I              OMDYPR                          WDDYPR
     I              OMDZPR                          WDDZPR
     I              OMGSPR                          WDGSPR
     I              OMGTPR                          WDGTPR
     I              OMGUPR                          WDGUPR
     I              OMHOST                          WDHOST
     I              OMHPST                          WDHPST
     I              OMIOST                          WDIOST
     I              OMPEWG                          WDPEWG
     I              OMRINY                          WDRINY
     I              OMTIDT                          WDTIDT
     I              OMTJDT                          WDTJDT
     I              OMH2ST                          WDH2ST
     I              OMH0ST                          WDH0ST
     I              OMH1ST                          WDH1ST
     I              OMTKDT                          WDTKDT
     I              OMTLDT                          WDTLDT
     I              OMTMDT                          WDTMDT
     I              OMUVST                          WDUVST
     I              OMUWST                          WDUWST
     I              OMUXST                          WDUXST
     I              OMAATM                          WDAATM
     I              OMAYNA                          WDAYNA
     I              OMA0NA                          WDA0NA
     I              OMAXDT                          WDAXDT
      *
     I@ADREAO
      * Warehouse Codes           Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WEAJCD
     I              ADF8NA                          WEF8NA
     I              ADACNA                          WEACNA
     I              ADADNA                          WEADNA
     I              ADAENA                          WEAENA
     I              ADAJNA                          WEAJNA
     I              ADBTTX                          WEBTTX
     I              ADAOCD                          WEAOCD
     I              ADBGCD                          WEBGCD
     I              ADVHST                          WEVHST
     I              ADMPNA                          WEMPNA
     I              ADWPST                          WEWPST
     I              ADXUST                          WEXUST
     I              ADT0ST                          WET0ST
     I              ADT1ST                          WET1ST
     I              ADDBNB                          WEDBNB
     I              ADT2ST                          WET2ST
     I              ADT3ST                          WET3ST
     I              ADT4ST                          WET4ST
     I              ADT6ST                          WET6ST
     I              ADBWC3                          WEBWC3
     I              ADBTC3                          WEBTC3
     I              ADBUC3                          WEBUC3
     I              ADBVC3                          WEBVC3
     I              ADFCAA                          WEFCAA
     I              ADRQSX                          WERQSX
     I              ADRRSX                          WERRSX
     I              ADRSSX                          WERSSX
     I              ADRTSX                          WERTSX
     I              ADT7ST                          WET7ST
     I              ADT8ST                          WET8ST
     I              ADRNSX                          WERNSX
     I              ADROSX                          WEROSX
     I              ADRPSX                          WERPSX
     I              ADUVST                          WEUVST
     I              ADUWST                          WEUWST
     I              ADUXST                          WEUXST
     I              ADVSST                          WEVSST
     I              ADAATM                          WEAATM
     I              ADAYNA                          WEAYNA
     I              ADA0NA                          WEA0NA
     I              ADAXDT                          WEAXDT
     I              ADQDSC                          WEQDSC
      *
     I@BUREBI
      * PFS Interface             Retrieval index
      * Renamed input format fields
     I              BUY1NX                          WFY1NX
     I              BUGYAA                          WFGYAA
     I              BURENA                          WFRENA
     I              BUWSSX                          WFWSSX
     I              BUWUSX                          WFWUSX
     I              BUQEDT                          WFQEDT
     I              BUCUTM                          WFCUTM
     I              BUB0NY                          WFB0NY
     I              BUB1NY                          WFB1NY
     I              BUWXSX                          WFWXSX
     I              BUWVSX                          WFWVSX
     I              BUWWSX                          WFWWSX
     I              BUUWSX                          WFUWSX
     I              BUUXSX                          WFUXSX
     I              BUV3SX                          WFV3SX
     I              BUAHNY                          WFAHNY
     I              BUAINY                          WFAINY
     I              BUAJNY                          WFAJNY
     I              BUAKNY                          WFAKNY
      *
     I@G0REJZ
      * EDI WHS Interchange       Retrieval index
      * Renamed input format fields
     I              G0AJCD                          WGAJCD
     I              G0M4AA                          WGM4AA
     I              G0M7AA                          WGM7AA
     I              G0J5NX                          WGJ5NX
     I              G0X2T1                          WGX2T1
     I              G0JBSC                          WGJBSC
     I              G0JCSC                          WGJCSC
     I              G0JDSC                          WGJDSC
     I              G0JESC                          WGJESC
     I              G0QGU1                          WGQGU1
     I              G0F5NZ                          WGF5NZ
     I              G0LSSC                          WGLSSC
     I              G0LTSC                          WGLTSC
     I              G0AHAB                          WGAHAB
     I              G0F6NZ                          WGF6NZ
     I              G0VSST                          WGVSST
     I              G0MJDT                          WGMJDT
     I              G0BETM                          WGBETM
     I              G0CCVN                          WGCCVN
     I              G0CDVN                          WGCDVN
     I              G0MKDT                          WGMKDT
     I              G0BFTM                          WGBFTM
     I              G0CEVN                          WGCEVN
     I              G0CFVN                          WGCFVN
      *
     I@EOREXM
      * Company Customer          Retrieval index
      * Renamed input format fields
     I              EOAIC3                          WHAIC3
     I              EOBKC7                          WHBKC7
     I              EOAQCD                          WHAQCD
     I              EOR4CD                          WHR4CD
     I              EOBYNA                          WHBYNA
     I              EOB6NA                          WHB6NA
     I              EOBZNA                          WHBZNA
     I              EOLLST                          WHLLST
     I              EOPPST                          WHPPST
     I              EOR5NB                          WHR5NB
     I              EOR6NB                          WHR6NB
     I              EOQGST                          WHQGST
     I              EOBOCD                          WHBOCD
     I              EOTBNB                          WHTBNB
     I              EOMTCU                          WHMTCU
     I              EOW2NB                          WHW2NB
     I              EORPCD                          WHRPCD
     I              EOAJCD                          WHAJCD
     I              EOX9ST                          WHX9ST
     I              EOT9CD                          WHT9CD
     I              EOUBCD                          WHUBCD
     I              EOISTX                          WHISTX
     I              EOLQCD                          WHLQCD
     I              EONJNA                          WHNJNA
     I              EOI0TX                          WHI0TX
     I              EONKNA                          WHNKNA
     I              EOI1TX                          WHI1TX
     I              EOVLST                          WHVLST
     I              EORLST                          WHRLST
     I              EOMMTX                          WHMMTX
     I              EOOHNA                          WHOHNA
     I              EOQ6ST                          WHQ6ST
     I              EOQ8ST                          WHQ8ST
     I              EORBST                          WHRBST
     I              EOREST                          WHREST
     I              EOUVST                          WHUVST
     I              EOUWST                          WHUWST
     I              EOUXST                          WHUXST
     I              EOVSST                          WHVSST
     I              EOAATM                          WHAATM
     I              EOAYNA                          WHAYNA
     I              EOA0NA                          WHA0NA
     I              EOAXDT                          WHAXDT
      *
     I@MSREX2
      * Export Doc Order Dtl      Co/Order/Seq
      * Renamed input format fields
     I              MSAIC3                          WIAIC3
     I              MSC4NB                          WIC4NB
     I              MSDGSX                          WIDGSX
     I              MSKXCD                          WIKXCD
     I              MSDPNB                          WIDPNB
     I              MSUENB                          WIUENB
     I              MSDIC7                          WIDIC7
     I              MSO3NA                          WIO3NA
     I              MSO4NA                          WIO4NA
     I              MSRMTX                          WIRMTX
     I              MSPTTX                          WIPTTX
     I              MSHJWG                          WIHJWG
     I              MSHKWG                          WIHKWG
     I              MSRNTX                          WIRNTX
     I              MSAONX                          WIAONX
     I              MSROTX                          WIROTX
     I              MSORNA                          WIORNA
     I              MSAMNX                          WIAMNX
     I              MSANNX                          WIANNX
     I              MSAPNX                          WIAPNX
     I              MSDKPR                          WIDKPR
     I              MSA9VL                          WIA9VL
     I              MSC8SX                          WIC8SX
     I              MSRATX                          WIRATX
     I              MSRBTX                          WIRBTX
     I              MSAJNX                          WIAJNX
     I              MSZWTX                          WIZWTX
     I              MSZXTX                          WIZXTX
     I              MSZYTX                          WIZYTX
     I              MSZZTX                          WIZZTX
     I              MSK0U1                          WIK0U1
     I              MSK1U1                          WIK1U1
     I              MSIJSC                          WIIJSC
     I              MSIKSC                          WIIKSC
     I              MSK2U1                          WIK2U1
     I              MSW0DT                          WIW0DT
     I              MSUVST                          WIUVST
     I              MSUWST                          WIUWST
     I              MSUXST                          WIUXST
     I              MSVSST                          WIVSST
     I              MSAATM                          WIAATM
     I              MSAYNA                          WIAYNA
     I              MSA0NA                          WIA0NA
     I              MSAXDT                          WIAXDT
      *
     I@MSREW4
      * Export Doc Order Dtl      Update index
      * Renamed input format fields
     I              MSAIC3                          WJAIC3
     I              MSC4NB                          WJC4NB
     I              MSDGSX                          WJDGSX
     I              MSKXCD                          WJKXCD
     I              MSDPNB                          WJDPNB
     I              MSUENB                          WJUENB
     I              MSDIC7                          WJDIC7
     I              MSO3NA                          WJO3NA
     I              MSO4NA                          WJO4NA
     I              MSRMTX                          WJRMTX
     I              MSPTTX                          WJPTTX
     I              MSHJWG                          WJHJWG
     I              MSHKWG                          WJHKWG
     I              MSRNTX                          WJRNTX
     I              MSAONX                          WJAONX
     I              MSROTX                          WJROTX
     I              MSORNA                          WJORNA
     I              MSAMNX                          WJAMNX
     I              MSANNX                          WJANNX
     I              MSAPNX                          WJAPNX
     I              MSDKPR                          WJDKPR
     I              MSA9VL                          WJA9VL
     I              MSC8SX                          WJC8SX
     I              MSRATX                          WJRATX
     I              MSRBTX                          WJRBTX
     I              MSAJNX                          WJAJNX
     I              MSZWTX                          WJZWTX
     I              MSZXTX                          WJZXTX
     I              MSZYTX                          WJZYTX
     I              MSZZTX                          WJZZTX
     I              MSK0U1                          WJK0U1
     I              MSK1U1                          WJK1U1
     I              MSIJSC                          WJIJSC
     I              MSIKSC                          WJIKSC
     I              MSK2U1                          WJK2U1
     I              MSW0DT                          WJW0DT
     I              MSUVST                          WJUVST
     I              MSUWST                          WJUWST
     I              MSUXST                          WJUXST
     I              MSVSST                          WJVSST
     I              MSAATM                          WJAATM
     I              MSAYNA                          WJAYNA
     I              MSA0NA                          WJA0NA
     I              MSAXDT                          WJAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WKAIC3
     I              BEC4NB                          WKC4NB
     I              BEJNCD                          WKJNCD
     I              BEANC7                          WKANC7
     I              BEBKC7                          WKBKC7
     I              BEBRTX                          WKBRTX
     I              BEHMNA                          WKHMNA
     I              BEHONA                          WKHONA
     I              BEHPNA                          WKHPNA
     I              BEHNNA                          WKHNNA
     I              BEDBCD                          WKDBCD
     I              BECKTX                          WKCKTX
     I              BEB0C7                          WKB0C7
     I              BEAETX                          WKAETX
     I              BEB1NA                          WKB1NA
     I              BEB3NA                          WKB3NA
     I              BEB4NA                          WKB4NA
     I              BEB2NA                          WKB2NA
     I              BEBHCD                          WKBHCD
     I              BEC8TX                          WKC8TX
     I              BEBCNA                          WKBCNA
     I              BEA0DT                          WKA0DT
     I              BEA5DT                          WKA5DT
     I              BEGNDT                          WKGNDT
     I              BEACDT                          WKACDT
     I              BEAQCD                          WKAQCD
     I              BEB6NA                          WKB6NA
     I              BEBYNA                          WKBYNA
     I              BEBZNA                          WKBZNA
     I              BEGTST                          WKGTST
     I              BEGVST                          WKGVST
     I              BEGUST                          WKGUST
     I              BEQFST                          WKQFST
     I              BECQCD                          WKCQCD
     I              BEGJST                          WKGJST
     I              BEGWST                          WKGWST
     I              BEGXST                          WKGXST
     I              BEGYST                          WKGYST
     I              BEAODT                          WKAODT
     I              BEAIVN                          WKAIVN
     I              BECXDT                          WKCXDT
     I              BEJZVA                          WKJZVA
     I              BEA1WG                          WKA1WG
     I              BEXIST                          WKXIST
     I              BEXJST                          WKXJST
     I              BEXKST                          WKXKST
     I              BEEIDT                          WKEIDT
     I              BEAFTM                          WKAFTM
     I              BEE8CD                          WKE8CD
     I              BEE9CD                          WKE9CD
     I              BERMNB                          WKRMNB
     I              BETBNB                          WKTBNB
     I              BER1NB                          WKR1NB
     I              BEPJST                          WKPJST
     I              BEU0ST                          WKU0ST
     I              BEU1ST                          WKU1ST
     I              BEQ2CD                          WKQ2CD
     I              BEU2ST                          WKU2ST
     I              BEVEST                          WKVEST
     I              BEVFST                          WKVFST
     I              BEVGST                          WKVGST
     I              BERPCD                          WKRPCD
     I              BERNNB                          WKRNNB
     I              BEVDST                          WKVDST
     I              BEATIN                          WKATIN
     I              BEU4ST                          WKU4ST
     I              BEU5ST                          WKU5ST
     I              BERSRN                          WKRSRN
     I              BEMHNA                          WKMHNA
     I              BEMINA                          WKMINA
     I              BEWBST                          WKWBST
     I              BER4CD                          WKR4CD
     I              BEBFCD                          WKBFCD
     I              BEQ4CD                          WKQ4CD
     I              BET3NB                          WKT3NB
     I              BESICD                          WKSICD
     I              BECONB                          WKCONB
     I              BECEST                          WKCEST
     I              BEAWDT                          WKAWDT
     I              BEJPCD                          WKJPCD
     I              BEXUST                          WKXUST
     I              BEZ1ST                          WKZ1ST
     I              BEVRVA                          WKVRVA
     I              BEOBST                          WKOBST
     I              BEBCST                          WKBCST
     I              BEBDST                          WKBDST
     I              BEB7VL                          WKB7VL
     I              BEGASX                          WKGASX
     I              BEGBSX                          WKGBSX
     I              BEGCSX                          WKGCSX
     I              BEGDSX                          WKGDSX
     I              BEFNSX                          WKFNSX
     I              BEFOSX                          WKFOSX
     I              BEFPSX                          WKFPSX
     I              BEFQSX                          WKFQSX
     I              BEFRSX                          WKFRSX
     I              BEFSSX                          WKFSSX
     I              BEFTSX                          WKFTSX
     I              BEFUSX                          WKFUSX
     I              BEFVSX                          WKFVSX
     I              BEFWSX                          WKFWSX
     I              BEFXSX                          WKFXSX
     I              BEFYSX                          WKFYSX
     I              BENODT                          WKNODT
     I              BENPDT                          WKNPDT
     I              BENQDT                          WKNQDT
     I              BENRDT                          WKNRDT
     I              BENSDT                          WKNSDT
     I              BEBPTM                          WKBPTM
     I              BEBQTM                          WKBQTM
     I              BEBRTM                          WKBRTM
     I              BEBSTM                          WKBSTM
     I              BEBTTM                          WKBTTM
     I              BEH0NX                          WKH0NX
     I              BEH1NX                          WKH1NX
     I              BEH2NX                          WKH2NX
     I              BEH3NX                          WKH3NX
     I              BEH4NX                          WKH4NX
     I              BEC0C7                          WKC0C7
     I              BEUVST                          WKUVST
     I              BEUWST                          WKUWST
     I              BEUXST                          WKUXST
     I              BEAATM                          WKAATM
     I              BEAYNA                          WKAYNA
     I              BEA0NA                          WKA0NA
     I              BEAXDT                          WKAXDT
      *
     I@AMREJF
      * Order Header Extension    Retrieval index
      * Renamed input format fields
     I              AMAIC3                          WLAIC3
     I              AMC4NB                          WLC4NB
     I              AMRMNB                          WLRMNB
     I              AMRUNB                          WLRUNB
     I              AMXACD                          WLXACD
     I              AMOANA                          WLOANA
     I              AMHBAA                          WLHBAA
     I              AMJ0T1                          WLJ0T1
     I              AMGENY                          WLGENY
     I              AMJ1T1                          WLJ1T1
     I              AMHCAA                          WLHCAA
     I              AMQWDT                          WLQWDT
     I              AMQXDT                          WLQXDT
     I              AMQYDT                          WLQYDT
     I              AMHDAA                          WLHDAA
     I              AMCCTX                          WLCCTX
     I              AMJ2T1                          WLJ2T1
     I              AMRLNA                          WLRLNA
     I              AMRMNA                          WLRMNA
     I              AMGINY                          WLGINY
     I              AMGFNY                          WLGFNY
     I              AMGGNY                          WLGGNY
     I              AMGHNY                          WLGHNY
     I              AMHEVL                          WLHEVL
     I              AMHFVL                          WLHFVL
     I              AMHGVL                          WLHGVL
     I              AMQZDT                          WLQZDT
     I              AMQ0DT                          WLQ0DT
     I              AMQ1DT                          WLQ1DT
     I              AMQ2DT                          WLQ2DT
     I              AMC2TX                          WLC2TX
     I              AMC3TX                          WLC3TX
     I              AMC6TX                          WLC6TX
     I              AMCHTX                          WLCHTX
     I              AMCITX                          WLCITX
     I              AMCLTX                          WLCLTX
     I              AMB4TX                          WLB4TX
     I              AMCUTX                          WLCUTX
     I              AMCVTX                          WLCVTX
     I              AMB9TX                          WLB9TX
     I              AMJWSC                          WLJWSC
     I              AMITNY                          WLITNY
     I              AMLMT1                          WLLMT1
     I              AMLWAA                          WLLWAA
     I              AMFVST                          WLFVST
     I              AMF0ST                          WLF0ST
     I              AMF2ST                          WLF2ST
     I              AMF3ST                          WLF3ST
     I              AMJUSC                          WLJUSC
     I              AMJVSC                          WLJVSC
     I              AMV3T1                          WLV3T1
     I              AMV4T1                          WLV4T1
     I              AMV5T1                          WLV5T1
     I              AMV6T1                          WLV6T1
     I              AMV7T1                          WLV7T1
     I              AMV8T1                          WLV8T1
     I              AMV9T1                          WLV9T1
     I              AMWAT1                          WLWAT1
     I              AMWBT1                          WLWBT1
     I              AMWCT1                          WLWCT1
     I              AMWDT1                          WLWDT1
     I              AMQJNY                          WLQJNY
     I              AMQKNY                          WLQKNY
     I              AMQLNY                          WLQLNY
     I              AMP8NY                          WLP8NY
     I              AMP9NY                          WLP9NY
     I              AMQANY                          WLQANY
     I              AMQCNY                          WLQCNY
     I              AMQDNY                          WLQDNY
     I              AMQENY                          WLQENY
     I              AMQFNY                          WLQFNY
     I              AMQGNY                          WLQGNY
     I              AMQHNY                          WLQHNY
     I              AMQINY                          WLQINY
     I              AMQMNY                          WLQMNY
     I              AMMYU1                          WLMYU1
     I              AMJXSC                          WLJXSC
     I              AMJYSC                          WLJYSC
     I              AMJZSC                          WLJZSC
     I              AMJ0SC                          WLJ0SC
     I              AMMZU1                          WLMZU1
     I              AMM0U1                          WLM0U1
     I              AMM1U1                          WLM1U1
     I              AMM2U1                          WLM2U1
     I              AMM3U1                          WLM3U1
     I              AMW5DT                          WLW5DT
     I              AMW6DT                          WLW6DT
     I              AMUVST                          WLUVST
     I              AMUWST                          WLUWST
     I              AMUXST                          WLUXST
     I              AMVSST                          WLVSST
     I              AMAATM                          WLAATM
     I              AMAYNA                          WLAYNA
     I              AMA0NA                          WLA0NA
     I              AMAXDT                          WLAXDT
      *
     I@AMREJE
      * Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                          WMAIC3
     I              AMC4NB                          WMC4NB
     I              AMRMNB                          WMRMNB
     I              AMRUNB                          WMRUNB
     I              AMXACD                          WMXACD
     I              AMOANA                          WMOANA
     I              AMHBAA                          WMHBAA
     I              AMJ0T1                          WMJ0T1
     I              AMGENY                          WMGENY
     I              AMJ1T1                          WMJ1T1
     I              AMHCAA                          WMHCAA
     I              AMQWDT                          WMQWDT
     I              AMQXDT                          WMQXDT
     I              AMQYDT                          WMQYDT
     I              AMHDAA                          WMHDAA
     I              AMCCTX                          WMCCTX
     I              AMJ2T1                          WMJ2T1
     I              AMRLNA                          WMRLNA
     I              AMRMNA                          WMRMNA
     I              AMGINY                          WMGINY
     I              AMGFNY                          WMGFNY
     I              AMGGNY                          WMGGNY
     I              AMGHNY                          WMGHNY
     I              AMHEVL                          WMHEVL
     I              AMHFVL                          WMHFVL
     I              AMHGVL                          WMHGVL
     I              AMQZDT                          WMQZDT
     I              AMQ0DT                          WMQ0DT
     I              AMQ1DT                          WMQ1DT
     I              AMQ2DT                          WMQ2DT
     I              AMC2TX                          WMC2TX
     I              AMC3TX                          WMC3TX
     I              AMC6TX                          WMC6TX
     I              AMCHTX                          WMCHTX
     I              AMCITX                          WMCITX
     I              AMCLTX                          WMCLTX
     I              AMB4TX                          WMB4TX
     I              AMCUTX                          WMCUTX
     I              AMCVTX                          WMCVTX
     I              AMB9TX                          WMB9TX
     I              AMJWSC                          WMJWSC
     I              AMITNY                          WMITNY
     I              AMLMT1                          WMLMT1
     I              AMLWAA                          WMLWAA
     I              AMFVST                          WMFVST
     I              AMF0ST                          WMF0ST
     I              AMF2ST                          WMF2ST
     I              AMF3ST                          WMF3ST
     I              AMJUSC                          WMJUSC
     I              AMJVSC                          WMJVSC
     I              AMV3T1                          WMV3T1
     I              AMV4T1                          WMV4T1
     I              AMV5T1                          WMV5T1
     I              AMV6T1                          WMV6T1
     I              AMV7T1                          WMV7T1
     I              AMV8T1                          WMV8T1
     I              AMV9T1                          WMV9T1
     I              AMWAT1                          WMWAT1
     I              AMWBT1                          WMWBT1
     I              AMWCT1                          WMWCT1
     I              AMWDT1                          WMWDT1
     I              AMQJNY                          WMQJNY
     I              AMQKNY                          WMQKNY
     I              AMQLNY                          WMQLNY
     I              AMP8NY                          WMP8NY
     I              AMP9NY                          WMP9NY
     I              AMQANY                          WMQANY
     I              AMQCNY                          WMQCNY
     I              AMQDNY                          WMQDNY
     I              AMQENY                          WMQENY
     I              AMQFNY                          WMQFNY
     I              AMQGNY                          WMQGNY
     I              AMQHNY                          WMQHNY
     I              AMQINY                          WMQINY
     I              AMQMNY                          WMQMNY
     I              AMMYU1                          WMMYU1
     I              AMJXSC                          WMJXSC
     I              AMJYSC                          WMJYSC
     I              AMJZSC                          WMJZSC
     I              AMJ0SC                          WMJ0SC
     I              AMMZU1                          WMMZU1
     I              AMM0U1                          WMM0U1
     I              AMM1U1                          WMM1U1
     I              AMM2U1                          WMM2U1
     I              AMM3U1                          WMM3U1
     I              AMW5DT                          WMW5DT
     I              AMW6DT                          WMW6DT
     I              AMUVST                          WMUVST
     I              AMUWST                          WMUWST
     I              AMUXST                          WMUXST
     I              AMVSST                          WMVSST
     I              AMAATM                          WMAATM
     I              AMAYNA                          WMAYNA
     I              AMA0NA                          WMA0NA
     I              AMAXDT                          WMAXDT
      *
     I@FFREBG
      * Carrier Info              Update index
      * Renamed input format fields
     I              FFBZNA                          WOBZNA
     I              FFADTX                          WOADTX
     I              FFACNA                          WOACNA
     I              FFADNA                          WOADNA
     I              FFAENA                          WOAENA
     I              FFAJNA                          WOAJNA
     I              FFBTTX                          WOBTTX
     I              FFEZNB                          WOEZNB
     I              FFBGCD                          WOBGCD
     I              FFEEDT                          WOEEDT
     I              FFDUTX                          WODUTX
     I              FFNRVA                          WONRVA
     I              FFNSVA                          WONSVA
     I              FFNTVA                          WONTVA
     I              FFNUVA                          WONUVA
     I              FFP1ST                          WOP1ST
     I              FFDVTX                          WODVTX
     I              FFDWTX                          WODWTX
     I              FFLVCD                          WOLVCD
     I              FFS8NB                          WOS8NB
     I              FFS9NB                          WOS9NB
     I              FFNMVA                          WONMVA
     I              FFNOVA                          WONOVA
     I              FFNPVA                          WONPVA
     I              FFNQVA                          WONQVA
     I              FFMFCD                          WOMFCD
     I              FFQXNB                          WOQXNB
     I              FFQ1NB                          WOQ1NB
     I              FFMRNG                          WOMRNG
     I              FFMRNE                          WOMRNE
     I              FFRFNB                          WORFNB
     I              FFMREG                          WOMREG
     I              FFBQPR                          WOBQPR
     I              FFBRPR                          WOBRPR
     I              FFBSPR                          WOBSPR
     I              FFBTPR                          WOBTPR
     I              FFBUPR                          WOBUPR
     I              FFBVPR                          WOBVPR
     I              FFDJWG                          WODJWG
     I              FFDKWG                          WODKWG
     I              FFDLWG                          WODLWG
     I              FFDMWG                          WODMWG
     I              FFDNWG                          WODNWG
     I              FFDOWG                          WODOWG
     I              FFB2PR                          WOB2PR
     I              FFB3PR                          WOB3PR
     I              FFB4PR                          WOB4PR
     I              FFB5PR                          WOB5PR
     I              FFB6PR                          WOB6PR
     I              FFB7PR                          WOB7PR
     I              FFAAC7                          WOAAC7
     I              FFCOFI                          WOCOFI
     I              FFK6TX                          WOK6TX
     I              FFOCNA                          WOOCNA
     I              FFODNA                          WOODNA
     I              FFW7CD                          WOW7CD
     I              FFK7TX                          WOK7TX
     I              FFTENO                          WOTENO
     I              FFK8TX                          WOK8TX
     I              FFAOFC                          WOAOFC
     I              FFAOLI                          WOAOLI
     I              FFKHDT                          WOKHDT
     I              FFUNUS                          WOUNUS
     I              FFUNU2                          WOUNU2
     I              FFUNU3                          WOUNU3
     I              FFUVST                          WOUVST
     I              FFUWST                          WOUWST
     I              FFUXST                          WOUXST
     I              FFVSST                          WOVSST
     I              FFAATM                          WOAATM
     I              FFAYNA                          WOAYNA
     I              FFA0NA                          WOA0NA
     I              FFAXDT                          WOAXDT
      *
     I@L8CPZO
      * Order Inv Allocation      Co/Ord/Sq/Sq2/PD/Lt/Lc/L
      * Renamed input format fields
     I              L8AIC3                          WRAIC3
     I              L8C4NB                          WRC4NB
     I              L8DPNB                          WRDPNB
     I              L8UENB                          WRUENB
     I              L8ALSW                          WRALSW
     I              L8J6QT                          WRJ6QT
     I              L8G9WG                          WRG9WG
     I              L8J9QT                          WRJ9QT
     I              L8HAWG                          WRHAWG
     I              L8IOSE                          WRIOSE
     I              L8OIMN                          WROIMN
     I              L8SOAS                          WRSOAS
     I              L8ARSX                          WRARSX
     I              L8OTUS                          WROTUS
     I              L8OTMP                          WROTMP
     I              L8HGCD                          WRHGCD
     I              L8AJCD                          WRAJCD
     I              L8ELDT                          WRELDT
     I              L8LXNM                          WRLXNM
     I              L8YMCD                          WRYMCD
     I              L8YNCD                          WRYNCD
     I              L8UVST                          WRUVST
     I              L8UWST                          WRUWST
     I              L8UXST                          WRUXST
     I              L8VSST                          WRVSST
     I              L8AATM                          WRAATM
     I              L8AYNA                          WRAYNA
     I              L8A0NA                          WRA0NA
     I              L8AXDT                          WRAXDT
      *
     I@L7CPUK
      * Item Lot Loc Trans        Co/Itm/Whs/Typ/Dte/Sq(d)
      * Renamed input format fields
     I              L7AIC3                          WSAIC3
     I              L7HGCD                          WSHGCD
     I              L7AJCD                          WSAJCD
     I              L7LTRT                          WSLTRT
     I              L7LRDT                          WSLRDT
     I              L7LLTS                          WSLLTS
     I              L7LSDT                          WSLSDT
     I              L7J5QT                          WSJ5QT
     I              L7G8WG                          WSG8WG
     I              L7LLTN                          WSLLTN
     I              L7YMCD                          WSYMCD
     I              L7LLCL                          WSLLCL
     I              L7BNAA                          WSBNAA
     I              L7LLTR                          WSLLTR
     I              L7Y2CD                          WSY2CD
     I              L7LLTL                          WSLLTL
     I              L7C4NB                          WSC4NB
     I              L7LOST                          WSLOST
     I              L7LLTU                          WSLLTU
     I              L7LLYT                          WSLLYT
     I              L7UVST                          WSUVST
     I              L7UWST                          WSUWST
     I              L7UXST                          WSUXST
     I              L7VSST                          WSVSST
     I              L7AATM                          WSAATM
     I              L7AYNA                          WSAYNA
     I              L7A0NA                          WSA0NA
     I              L7AXDT                          WSAXDT
      *
     I@L7CPS3
      * Item Lot Loc Trans        Update index
      * Renamed input format fields
     I              L7AIC3                          WTAIC3
     I              L7HGCD                          WTHGCD
     I              L7AJCD                          WTAJCD
     I              L7LTRT                          WTLTRT
     I              L7LRDT                          WTLRDT
     I              L7LLTS                          WTLLTS
     I              L7LSDT                          WTLSDT
     I              L7J5QT                          WTJ5QT
     I              L7G8WG                          WTG8WG
     I              L7LLTN                          WTLLTN
     I              L7YMCD                          WTYMCD
     I              L7LLCL                          WTLLCL
     I              L7BNAA                          WTBNAA
     I              L7LLTR                          WTLLTR
     I              L7Y2CD                          WTY2CD
     I              L7LLTL                          WTLLTL
     I              L7C4NB                          WTC4NB
     I              L7LOST                          WTLOST
     I              L7LLTU                          WTLLTU
     I              L7LLYT                          WTLLYT
     I              L7UVST                          WTUVST
     I              L7UWST                          WTUWST
     I              L7UXST                          WTUXST
     I              L7VSST                          WTVSST
     I              L7AATM                          WTAATM
     I              L7AYNA                          WTAYNA
     I              L7A0NA                          WTA0NA
     I              L7AXDT                          WTAXDT
      *
     I@L5CPSV
      * Item Lot Location         Retrieval index
      * Renamed input format fields
     I              L5AIC3                          WVAIC3
     I              L5HGCD                          WVHGCD
     I              L5AJCD                          WVAJCD
     I              L5ELDT                          WVELDT
     I              L5LXNM                          WVLXNM
     I              L5YMCD                          WVYMCD
     I              L5YNCD                          WVYNCD
     I              L5J2QT                          WVJ2QT
     I              L5G5WG                          WVG5WG
     I              L5J3QT                          WVJ3QT
     I              L5G6WG                          WVG6WG
     I              L5J4QT                          WVJ4QT
     I              L5G7WG                          WVG7WG
     I              L5LODT                          WVLODT
     I              L5LPDT                          WVLPDT
     I              L5LQDT                          WVLQDT
     I              L5NBR                           WVNBR
     I              L5YTCD                          WVYTCD
     I              L5AMSX                          WVAMSX
     I              L5ASSX                          WVASSX
     I              L5ATSX                          WVATSX
     I              L5AUSX                          WVAUSX
     I              L5YSCD                          WVYSCD
     I              L5UVST                          WVUVST
     I              L5UWST                          WVUWST
     I              L5UXST                          WVUXST
     I              L5VSST                          WVVSST
     I              L5AATM                          WVAATM
     I              L5AYNA                          WVAYNA
     I              L5A0NA                          WVA0NA
     I              L5AXDT                          WVAXDT
      *
     I@L2RESM
      * Warehouse Location        Retrieval index
      * Renamed input format fields
     I              L2AJCD                          WWAJCD
     I              L2YMCD                          WWYMCD
     I              L2YPCD                          WWYPCD
     I              L2LCBY                          WWLCBY
     I              L2LCCT                          WWLCCT
     I              L2WLUS                          WWWLUS
     I              L2WUSD                          WWWUSD
     I              L2WLUN                          WWWLUN
     I              L2AGSX                          WWAGSX
     I              L2UVST                          WWUVST
     I              L2UWST                          WWUWST
     I              L2UXST                          WWUXST
     I              L2VSST                          WWVSST
     I              L2AATM                          WWAATM
     I              L2AYNA                          WWAYNA
     I              L2A0NA                          WWA0NA
     I              L2AXDT                          WWAXDT
      *
     I@L3RET8
      * Warehouse Location Type   Retrieval index
      * Renamed input format fields
     I              MEAGSX                          WXAGSX
     I              MEOPNA                          WXOPNA
     I              MESLTY                          WXSLTY
     I              MEAHSX                          WXAHSX
     I              MEAISX                          WXAISX
     I              MEUVST                          WXUVST
     I              MEUWST                          WXUWST
     I              MEUXST                          WXUXST
     I              MEVSST                          WXVSST
     I              MEAATM                          WXAATM
     I              MEAYNA                          WXAYNA
     I              MEA0NA                          WXA0NA
     I              MEAXDT                          WXAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WYAIC3
     I              BZHGCD                          WYHGCD
     I              BZAVNA                          WYAVNA
     I              BZAWNA                          WYAWNA
     I              BZL7NA                          WYL7NA
     I              BZL8NA                          WYL8NA
     I              BZL6NA                          WYL6NA
     I              BZMFNA                          WYMFNA
     I              BZADCD                          WYADCD
     I              BZAWPC                          WYAWPC
     I              BZLXST                          WYLXST
     I              BZAECD                          WYAECD
     I              BZAXPC                          WYAXPC
     I              BZLYST                          WYLYST
     I              BZAFCD                          WYAFCD
     I              BZAICD                          WYAICD
     I              BZAIWG                          WYAIWG
     I              BZHICD                          WYHICD
     I              BZRBCD                          WYRBCD
     I              BZFZST                          WYFZST
     I              BZAVST                          WYAVST
     I              BZCZWG                          WYCZWG
     I              BZC0WG                          WYC0WG
     I              BZURTN                          WYURTN
     I              BZAJC8                          WYAJC8
     I              BZRINB                          WYRINB
     I              BZRHNB                          WYRHNB
     I              BZRGNB                          WYRGNB
     I              BZLNCD                          WYLNCD
     I              BZTFNB                          WYTFNB
     I              BZN0CD                          WYN0CD
     I              BZX4ST                          WYX4ST
     I              BZTMVA                          WYTMVA
     I              BZTNVA                          WYTNVA
     I              BZBLPR                          WYBLPR
     I              BZBMPR                          WYBMPR
     I              BZLRCD                          WYLRCD
     I              BZU9ST                          WYU9ST
     I              BZCMCO                          WYCMCO
     I              BZQ1CD                          WYQ1CD
     I              BZQ8CD                          WYQ8CD
     I              BZCHTM                          WYCHTM
     I              BZQZCD                          WYQZCD
     I              BZXWST                          WYXWST
     I              BZXXST                          WYXXST
     I              BZVMST                          WYVMST
     I              BZSWGH                          WYSWGH
     I              BZPPHE                          WYPPHE
     I              BZR3CD                          WYR3CD
     I              BZSDCD                          WYSDCD
     I              BZICN1                          WYICN1
     I              BZSVCD                          WYSVCD
     I              BZICN2                          WYICN2
     I              BZSWCD                          WYSWCD
     I              BZV2NB                          WYV2NB
     I              BZSXCD                          WYSXCD
     I              BZITCN                          WYITCN
     I              BZSYCD                          WYSYCD
     I              BZITC5                          WYITC5
     I              BZSZCD                          WYSZCD
     I              BZICN6                          WYICN6
     I              BZS0CD                          WYS0CD
     I              BZICN7                          WYICN7
     I              BZS1CD                          WYS1CD
     I              BZICN8                          WYICN8
     I              BZS2CD                          WYS2CD
     I              BZICN9                          WYICN9
     I              BZS3CD                          WYS3CD
     I              BZICN0                          WYICN0
     I              BZS4CD                          WYS4CD
     I              BZSFNB                          WYSFNB
     I              BZA3WG                          WYA3WG
     I              BZSJNB                          WYSJNB
     I              BZLLCD                          WYLLCD
     I              BZLMCD                          WYLMCD
     I              BZP3ST                          WYP3ST
     I              BZSKNB                          WYSKNB
     I              BZSLNB                          WYSLNB
     I              BZSMNB                          WYSMNB
     I              BZP4ST                          WYP4ST
     I              BZCFNB                          WYCFNB
     I              BZCGNB                          WYCGNB
     I              BZILNB                          WYILNB
     I              BZCHNB                          WYCHNB
     I              BZCINB                          WYCINB
     I              BZCJNB                          WYCJNB
     I              BZCMNB                          WYCMNB
     I              BZCNNB                          WYCNNB
     I              BZCRNB                          WYCRNB
     I              BZCSNB                          WYCSNB
     I              BZCVNB                          WYCVNB
     I              BZCWNB                          WYCWNB
     I              BZCXNB                          WYCXNB
     I              BZCZNB                          WYCZNB
     I              BZC0NB                          WYC0NB
     I              BZN1CD                          WYN1CD
     I              BZB4NB                          WYB4NB
     I              BZB5NB                          WYB5NB
     I              BZX5ST                          WYX5ST
     I              BZX6ST                          WYX6ST
     I              BZX7ST                          WYX7ST
     I              BZPCCT                          WYPCCT
     I              BZBDNB                          WYBDNB
     I              BZBJNB                          WYBJNB
     I              BZSUST                          WYSUST
     I              BZSVST                          WYSVST
     I              BZSYST                          WYSYST
     I              BZSZST                          WYSZST
     I              BZS1ST                          WYS1ST
     I              BZXRCD                          WYXRCD
     I              BZXTCD                          WYXTCD
     I              BZXUCD                          WYXUCD
     I              BZF5WG                          WYF5WG
     I              BZF6WG                          WYF6WG
     I              BZF7WG                          WYF7WG
     I              BZBLNB                          WYBLNB
     I              BZBNNB                          WYBNNB
     I              BZS2ST                          WYS2ST
     I              BZS4ST                          WYS4ST
     I              BZS5ST                          WYS5ST
     I              BZS6ST                          WYS6ST
     I              BZS8ST                          WYS8ST
     I              BZS9ST                          WYS9ST
     I              BZTCST                          WYTCST
     I              BZTDST                          WYTDST
     I              BZUVST                          WYUVST
     I              BZUWST                          WYUWST
     I              BZUXST                          WYUXST
     I              BZVSST                          WYVSST
     I              BZAATM                          WYAATM
     I              BZAYNA                          WYAYNA
     I              BZA0NA                          WYA0NA
     I              BZAXDT                          WYAXDT
      *
     I@L5CPSL
      * Item Lot Location         Update index
      * Renamed input format fields
     I              L5AIC3                          TAAIC3
     I              L5HGCD                          TAHGCD
     I              L5AJCD                          TAAJCD
     I              L5ELDT                          TAELDT
     I              L5LXNM                          TALXNM
     I              L5YMCD                          TAYMCD
     I              L5YNCD                          TAYNCD
     I              L5J2QT                          TAJ2QT
     I              L5G5WG                          TAG5WG
     I              L5J3QT                          TAJ3QT
     I              L5G6WG                          TAG6WG
     I              L5J4QT                          TAJ4QT
     I              L5G7WG                          TAG7WG
     I              L5LODT                          TALODT
     I              L5LPDT                          TALPDT
     I              L5LQDT                          TALQDT
     I              L5NBR                           TANBR
     I              L5YTCD                          TAYTCD
     I              L5AMSX                          TAAMSX
     I              L5ASSX                          TAASSX
     I              L5ATSX                          TAATSX
     I              L5AUSX                          TAAUSX
     I              L5YSCD                          TAYSCD
     I              L5UVST                          TAUVST
     I              L5UWST                          TAUWST
     I              L5UXST                          TAUXST
     I              L5VSST                          TAVSST
     I              L5AATM                          TAAATM
     I              L5AYNA                          TAAYNA
     I              L5A0NA                          TAA0NA
     I              L5AXDT                          TAAXDT
      *
     I@B1REJ0
      * Item Balance Detail       Retrieval index       NV
      * Renamed input format fields
     I              B1AIC3                          TBAIC3
     I              B1HGCD                          TBHGCD
     I              B1AJCD                          TBAJCD
     I              B1ELDT                          TBELDT
     I              B1ABWG                          TBABWG
     I              B1AGQT                          TBAGQT
     I              B1AHQT                          TBAHQT
     I              B1AIQT                          TBAIQT
     I              B1CTST                          TBCTST
     I              B1ACWG                          TBACWG
     I              B1ARQT                          TBARQT
     I              B1ASQT                          TBASQT
     I              B1ATQT                          TBATQT
     I              B1HDQT                          TBHDQT
     I              B1HEQT                          TBHEQT
     I              B1F6ST                          TBF6ST
     I              B1BMWG                          TBBMWG
     I              B1DSQT                          TBDSQT
     I              B1DTQT                          TBDTQT
     I              B1DUQT                          TBDUQT
     I              B1DHDT                          TBDHDT
     I              B1AGCS                          TBAGCS
     I              B1AECS                          TBAECS
     I              B1IDVA                          TBIDVA
     I              B1K7DT                          TBK7DT
     I              B1RINB                          TBRINB
     I              B1RHNB                          TBRHNB
     I              B1RGNB                          TBRGNB
     I              B1UVST                          TBUVST
     I              B1UWST                          TBUWST
     I              B1UXST                          TBUXST
     I              B1VSST                          TBVSST
     I              B1AATM                          TBAATM
     I              B1AYNA                          TBAYNA
     I              B1A0NA                          TBA0NA
     I              B1AXDT                          TBAXDT
      *
     I@B1REJ1
      * Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          TCAIC3
     I              B1HGCD                          TCHGCD
     I              B1AJCD                          TCAJCD
     I              B1ELDT                          TCELDT
     I              B1ABWG                          TCABWG
     I              B1AGQT                          TCAGQT
     I              B1AHQT                          TCAHQT
     I              B1AIQT                          TCAIQT
     I              B1CTST                          TCCTST
     I              B1ACWG                          TCACWG
     I              B1ARQT                          TCARQT
     I              B1ASQT                          TCASQT
     I              B1ATQT                          TCATQT
     I              B1HDQT                          TCHDQT
     I              B1HEQT                          TCHEQT
     I              B1F6ST                          TCF6ST
     I              B1BMWG                          TCBMWG
     I              B1DSQT                          TCDSQT
     I              B1DTQT                          TCDTQT
     I              B1DUQT                          TCDUQT
     I              B1DHDT                          TCDHDT
     I              B1AGCS                          TCAGCS
     I              B1AECS                          TCAECS
     I              B1IDVA                          TCIDVA
     I              B1K7DT                          TCK7DT
     I              B1RINB                          TCRINB
     I              B1RHNB                          TCRHNB
     I              B1RGNB                          TCRGNB
     I              B1UVST                          TCUVST
     I              B1UWST                          TCUWST
     I              B1UXST                          TCUXST
     I              B1VSST                          TCVSST
     I              B1AATM                          TCAATM
     I              B1AYNA                          TCAYNA
     I              B1A0NA                          TCA0NA
     I              B1AXDT                          TCAXDT
      *
     I@L8CPSX
      * Order Inv Allocation      Update index
      * Renamed input format fields
     I              L8AIC3                          TDAIC3
     I              L8C4NB                          TDC4NB
     I              L8DPNB                          TDDPNB
     I              L8UENB                          TDUENB
     I              L8ALSW                          TDALSW
     I              L8J6QT                          TDJ6QT
     I              L8G9WG                          TDG9WG
     I              L8J9QT                          TDJ9QT
     I              L8HAWG                          TDHAWG
     I              L8IOSE                          TDIOSE
     I              L8OIMN                          TDOIMN
     I              L8SOAS                          TDSOAS
     I              L8ARSX                          TDARSX
     I              L8OTUS                          TDOTUS
     I              L8OTMP                          TDOTMP
     I              L8HGCD                          TDHGCD
     I              L8AJCD                          TDAJCD
     I              L8ELDT                          TDELDT
     I              L8LXNM                          TDLXNM
     I              L8YMCD                          TDYMCD
     I              L8YNCD                          TDYNCD
     I              L8UVST                          TDUVST
     I              L8UWST                          TDUWST
     I              L8UXST                          TDUXST
     I              L8VSST                          TDVSST
     I              L8AATM                          TDAATM
     I              L8AYNA                          TDAYNA
     I              L8A0NA                          TDA0NA
     I              L8AXDT                          TDAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WDAIC3
     I              OMC4NB                          WDC4NB
     I              OMDPNB                          WDDPNB
     I              OMUENB                          WDUENB
     I              OMHGCD                          WDHGCD
     I              OMAJCD                          WDAJCD
     I              OMBKC7                          WDBKC7
     I              OMCFC7                          WDCFC7
     I              OMGMST                          WDGMST
     I              OMGNST                          WDGNST
     I              OMMAVA                          WDMAVA
     I              OMKDVA                          WDKDVA
     I              OML8VA                          WDL8VA
     I              OML9VA                          WDL9VA
     I              OMGTST                          WDGTST
     I              OMGVST                          WDGVST
     I              OMGUST                          WDGUST
     I              OMQFST                          WDQFST
     I              OMAYVA                          WDAYVA
     I              OMEXDT                          WDEXDT
     I              OMLQCD                          WDLQCD
     I              OMRDCD                          WDRDCD
     I              OMQ7CD                          WDQ7CD
     I              OMBZPR                          WDBZPR
     I              OML6NB                          WDL6NB
     I              OMU1ST                          WDU1ST
     I              OMGIDT                          WDGIDT
     I              OMCRCD                          WDCRCD
     I              OMAGCD                          WDAGCD
     I              OMRZST                          WDRZST
     I              OMR0ST                          WDR0ST
     I              OMR1ST                          WDR1ST
     I              OMG7NA                          WDG7NA
     I              OMG8NA                          WDG8NA
     I              OMRPCD                          WDRPCD
     I              OMVEST                          WDVEST
     I              OMVGST                          WDVGST
     I              OMAVST                          WDAVST
     I              OMU0ST                          WDU0ST
     I              OMRFCD                          WDRFCD
     I              OMFZST                          WDFZST
     I              OMR1NB                          WDR1NB
     I              OMAVQT                          WDAVQT
     I              OMD0WG                          WDD0WG
     I              OMCCQT                          WDCCQT
     I              OMAUWG                          WDAUWG
     I              OMCBQT                          WDCBQT
     I              OMATWG                          WDATWG
     I              OMAQCS                          WDAQCS
     I              OMAGCS                          WDAGCS
     I              OMAKPR                          WDAKPR
     I              OMALPR                          WDALPR
     I              OMAUPR                          WDAUPR
     I              OMAVWG                          WDAVWG
     I              OMA4WG                          WDA4WG
     I              OMA5DT                          WDA5DT
     I              OMAODT                          WDAODT
     I              OMGNDT                          WDGNDT
     I              OMAMST                          WDAMST
     I              OMANST                          WDANST
     I              OMVAST                          WDVAST
     I              OMRGNB                          WDRGNB
     I              OMRHNB                          WDRHNB
     I              OMRINB                          WDRINB
     I              OMRBCD                          WDRBCD
     I              OMHICD                          WDHICD
     I              OMRNCD                          WDRNCD
     I              OMROCD                          WDROCD
     I              OMCXDT                          WDCXDT
     I              OMAJVN                          WDAJVN
     I              OMKXCD                          WDKXCD
     I              OMJPCD                          WDJPCD
     I              OMCQCD                          WDCQCD
     I              OMR4CD                          WDR4CD
     I              OMZ1ST                          WDZ1ST
     I              OMZ3ST                          WDZ3ST
     I              OMZ4ST                          WDZ4ST
     I              OMDUPR                          WDDUPR
     I              OMB6VL                          WDB6VL
     I              OMA1AA                          WDA1AA
     I              OMFZSX                          WDFZSX
     I              OMF0SX                          WDF0SX
     I              OMF1SX                          WDF1SX
     I              OMF2SX                          WDF2SX
     I              OMF3SX                          WDF3SX
     I              OMF4SX                          WDF4SX
     I              OMF5SX                          WDF5SX
     I              OMF6SX                          WDF6SX
     I              OMF7SX                          WDF7SX
     I              OMNTDT                          WDNTDT
     I              OMNUDT                          WDNUDT
     I              OMNVDT                          WDNVDT
     I              OMNWDT                          WDNWDT
     I              OMNXDT                          WDNXDT
     I              OMBUTM                          WDBUTM
     I              OMBVTM                          WDBVTM
     I              OMBWTM                          WDBWTM
     I              OMBXTM                          WDBXTM
     I              OMBYTM                          WDBYTM
     I              OMH5NX                          WDH5NX
     I              OMH6NX                          WDH6NX
     I              OMH7NX                          WDH7NX
     I              OMH8NX                          WDH8NX
     I              OMH9NX                          WDH9NX
     I              OMDVPR                          WDDVPR
     I              OMDWPR                          WDDWPR
     I              OMDXPR                          WDDXPR
     I              OMDYPR                          WDDYPR
     I              OMDZPR                          WDDZPR
     I              OMGSPR                          WDGSPR
     I              OMGTPR                          WDGTPR
     I              OMGUPR                          WDGUPR
     I              OMHOST                          WDHOST
     I              OMHPST                          WDHPST
     I              OMIOST                          WDIOST
     I              OMPEWG                          WDPEWG
     I              OMRINY                          WDRINY
     I              OMTIDT                          WDTIDT
     I              OMTJDT                          WDTJDT
     I              OMH2ST                          WDH2ST
     I              OMH0ST                          WDH0ST
     I              OMH1ST                          WDH1ST
     I              OMTKDT                          WDTKDT
     I              OMTLDT                          WDTLDT
     I              OMTMDT                          WDTMDT
     I              OMUVST                          WDUVST
     I              OMUWST                          WDUWST
     I              OMUXST                          WDUXST
     I              OMAATM                          WDAATM
     I              OMAYNA                          WDAYNA
     I              OMA0NA                          WDA0NA
     I              OMAXDT                          WDAXDT
      *
     IYARDCS      DS                            525
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IYBRDCS      DS                            525
     IQPDMS1    E DSPDMSREL0
      * UPD : Export Doc Order Dtl      Update index
      * Renamed input format fields
     I              MSAIC3                          WJAIC3
     I              MSC4NB                          WJC4NB
     I              MSDGSX                          WJDGSX
     I              MSKXCD                          WJKXCD
     I              MSDPNB                          WJDPNB
     I              MSUENB                          WJUENB
     I              MSDIC7                          WJDIC7
     I              MSO3NA                          WJO3NA
     I              MSO4NA                          WJO4NA
     I              MSRMTX                          WJRMTX
     I              MSPTTX                          WJPTTX
     I              MSHJWG                          WJHJWG
     I              MSHKWG                          WJHKWG
     I              MSRNTX                          WJRNTX
     I              MSAONX                          WJAONX
     I              MSROTX                          WJROTX
     I              MSORNA                          WJORNA
     I              MSAMNX                          WJAMNX
     I              MSANNX                          WJANNX
     I              MSAPNX                          WJAPNX
     I              MSDKPR                          WJDKPR
     I              MSA9VL                          WJA9VL
     I              MSC8SX                          WJC8SX
     I              MSRATX                          WJRATX
     I              MSRBTX                          WJRBTX
     I              MSAJNX                          WJAJNX
     I              MSZWTX                          WJZWTX
     I              MSZXTX                          WJZXTX
     I              MSZYTX                          WJZYTX
     I              MSZZTX                          WJZZTX
     I              MSK0U1                          WJK0U1
     I              MSK1U1                          WJK1U1
     I              MSIJSC                          WJIJSC
     I              MSIKSC                          WJIKSC
     I              MSK2U1                          WJK2U1
     I              MSW0DT                          WJW0DT
     I              MSUVST                          WJUVST
     I              MSUWST                          WJUWST
     I              MSUXST                          WJUXST
     I              MSVSST                          WJVSST
     I              MSAATM                          WJAATM
     I              MSAYNA                          WJAYNA
     I              MSA0NA                          WJA0NA
     I              MSAXDT                          WJAXDT
      *
     IYCRDCS      DS                            428
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WKAIC3
     I              BEC4NB                          WKC4NB
     I              BEJNCD                          WKJNCD
     I              BEANC7                          WKANC7
     I              BEBKC7                          WKBKC7
     I              BEBRTX                          WKBRTX
     I              BEHMNA                          WKHMNA
     I              BEHONA                          WKHONA
     I              BEHPNA                          WKHPNA
     I              BEHNNA                          WKHNNA
     I              BEDBCD                          WKDBCD
     I              BECKTX                          WKCKTX
     I              BEB0C7                          WKB0C7
     I              BEAETX                          WKAETX
     I              BEB1NA                          WKB1NA
     I              BEB3NA                          WKB3NA
     I              BEB4NA                          WKB4NA
     I              BEB2NA                          WKB2NA
     I              BEBHCD                          WKBHCD
     I              BEC8TX                          WKC8TX
     I              BEBCNA                          WKBCNA
     I              BEA0DT                          WKA0DT
     I              BEA5DT                          WKA5DT
     I              BEGNDT                          WKGNDT
     I              BEACDT                          WKACDT
     I              BEAQCD                          WKAQCD
     I              BEB6NA                          WKB6NA
     I              BEBYNA                          WKBYNA
     I              BEBZNA                          WKBZNA
     I              BEGTST                          WKGTST
     I              BEGVST                          WKGVST
     I              BEGUST                          WKGUST
     I              BEQFST                          WKQFST
     I              BECQCD                          WKCQCD
     I              BEGJST                          WKGJST
     I              BEGWST                          WKGWST
     I              BEGXST                          WKGXST
     I              BEGYST                          WKGYST
     I              BEAODT                          WKAODT
     I              BEAIVN                          WKAIVN
     I              BECXDT                          WKCXDT
     I              BEJZVA                          WKJZVA
     I              BEA1WG                          WKA1WG
     I              BEXIST                          WKXIST
     I              BEXJST                          WKXJST
     I              BEXKST                          WKXKST
     I              BEEIDT                          WKEIDT
     I              BEAFTM                          WKAFTM
     I              BEE8CD                          WKE8CD
     I              BEE9CD                          WKE9CD
     I              BERMNB                          WKRMNB
     I              BETBNB                          WKTBNB
     I              BER1NB                          WKR1NB
     I              BEPJST                          WKPJST
     I              BEU0ST                          WKU0ST
     I              BEU1ST                          WKU1ST
     I              BEQ2CD                          WKQ2CD
     I              BEU2ST                          WKU2ST
     I              BEVEST                          WKVEST
     I              BEVFST                          WKVFST
     I              BEVGST                          WKVGST
     I              BERPCD                          WKRPCD
     I              BERNNB                          WKRNNB
     I              BEVDST                          WKVDST
     I              BEATIN                          WKATIN
     I              BEU4ST                          WKU4ST
     I              BEU5ST                          WKU5ST
     I              BERSRN                          WKRSRN
     I              BEMHNA                          WKMHNA
     I              BEMINA                          WKMINA
     I              BEWBST                          WKWBST
     I              BER4CD                          WKR4CD
     I              BEBFCD                          WKBFCD
     I              BEQ4CD                          WKQ4CD
     I              BET3NB                          WKT3NB
     I              BESICD                          WKSICD
     I              BECONB                          WKCONB
     I              BECEST                          WKCEST
     I              BEAWDT                          WKAWDT
     I              BEJPCD                          WKJPCD
     I              BEXUST                          WKXUST
     I              BEZ1ST                          WKZ1ST
     I              BEVRVA                          WKVRVA
     I              BEOBST                          WKOBST
     I              BEBCST                          WKBCST
     I              BEBDST                          WKBDST
     I              BEB7VL                          WKB7VL
     I              BEGASX                          WKGASX
     I              BEGBSX                          WKGBSX
     I              BEGCSX                          WKGCSX
     I              BEGDSX                          WKGDSX
     I              BEFNSX                          WKFNSX
     I              BEFOSX                          WKFOSX
     I              BEFPSX                          WKFPSX
     I              BEFQSX                          WKFQSX
     I              BEFRSX                          WKFRSX
     I              BEFSSX                          WKFSSX
     I              BEFTSX                          WKFTSX
     I              BEFUSX                          WKFUSX
     I              BEFVSX                          WKFVSX
     I              BEFWSX                          WKFWSX
     I              BEFXSX                          WKFXSX
     I              BEFYSX                          WKFYSX
     I              BENODT                          WKNODT
     I              BENPDT                          WKNPDT
     I              BENQDT                          WKNQDT
     I              BENRDT                          WKNRDT
     I              BENSDT                          WKNSDT
     I              BEBPTM                          WKBPTM
     I              BEBQTM                          WKBQTM
     I              BEBRTM                          WKBRTM
     I              BEBSTM                          WKBSTM
     I              BEBTTM                          WKBTTM
     I              BEH0NX                          WKH0NX
     I              BEH1NX                          WKH1NX
     I              BEH2NX                          WKH2NX
     I              BEH3NX                          WKH3NX
     I              BEH4NX                          WKH4NX
     I              BEC0C7                          WKC0C7
     I              BEUVST                          WKUVST
     I              BEUWST                          WKUWST
     I              BEUXST                          WKUXST
     I              BEAATM                          WKAATM
     I              BEAYNA                          WKAYNA
     I              BEA0NA                          WKA0NA
     I              BEAXDT                          WKAXDT
      *
     IYDRDCS      DS                            779
      * Outward parameters
     IPARC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Order Number
     I                                    P   3   60PAC4NB
      * I :  Order Type_Sales
     I                                        7   8 PAJNCD
      * I :  AR Customer Number
     I                                    P   9  120PAANC7
      * I :  Ship To Customer
     I                                    P  13  160PABKC7
      * I :  Ship To Name
     I                                       17  46 PABRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PAHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PAHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PAHPNA
      * I :  Ship To City
     I                                      137 156 PAHNNA
      * I :  Ship To State Code
     I                                      157 158 PADBCD
      * I :  Ship To Zip_Postal Code
     I                                      159 169 PACKTX
      * I :  Bill to Customer
     I                                    P 170 1730PAB0C7
      * I :  Bill to Name
     I                                      174 203 PAAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PAB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PAB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PAB4NA
      * I :  Bill to City
     I                                      294 313 PAB2NA
      * I :  Bill to State Code
     I                                      314 315 PABHCD
      * I :  Bill to Zip_Postal Code
     I                                      316 326 PAC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PABCNA
      * I :  Order Date
     I                                    P 342 3450PAA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PAA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PAGNDT
      * I :  Cancel Date
     I                                    P 354 3570PAACDT
      * I :  Terms Code
     I                                      358 359 PAAQCD
      * I :  Special Instructions
     I                                      360 399 PAB6NA
      * I :  Special Instructions 2
     I                                      400 439 PABYNA
      * I :  Carrier Code
     I                                      440 442 PABZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PAGTST
      * I :  Comment Print Inv_Cr_Memo
     I                                      444 444 PAGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PAGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PAQFST
      * I :  Reason Code
     I                                      447 449 PACQCD
      * I :  Order in Use
     I                                      450 450 PAGJST
      * I :  Header Status
     I                                      451 451 PAGWST
      * I :  Header Status Last
     I                                      452 452 PAGXST
      * I :  Order Type Print Status
     I                                      453 453 PAGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PAAODT
      * I :  User Original Entry
     I                                      458 467 PAAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PACXDT
      * I :  Order Value Total
     I                                    P 472 4772PAJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PAA1WG
      * I :  Credit Hold
     I                                      484 484 PAXIST
      * I :  Production Hold
     I                                      485 485 PAXJST
      * I :  New Customer Hold
     I                                      486 486 PAXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PAEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PAAFTM
      * I :  Accounts Receiv_Ent 1
     I                                      494 497 PAE8CD
      * I :  Accounts Receiv_Ent 2
     I                                      498 509 PAE9CD
      * I :  Load ID
     I                                    P 510 5130PARMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PATBNB
      * I :  Rated Freight
     I                                    P 517 5222PAR1NB
      * I :  LTL Flag
     I                                      523 523 PAPJST
      * I :  Price Audit
     I                                      524 524 PAU0ST
      * I :  Price Status
     I                                      525 525 PAU1ST
      * I :  Shipping Method
     I                                      526 527 PAQ2CD
      * I :  Export Status
     I                                      528 528 PAU2ST
      * I :  Palletize
     I                                      529 529 PAVEST
      * I :  Shrink Wrap
     I                                      530 530 PAVFST
      * I :  Slip Sheet
     I                                      531 531 PAVGST
      * I :  Age Code
     I                                      532 532 PARPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PARNNB
      * I :  Load Type
     I                                      536 536 PAVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PAATIN
      * I :  Load Plan Order
     I                                      541 541 PAU4ST
      * I :  Print Pick Slip
     I                                      542 542 PAU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PARSRN
      * I :  Special Comment 1
     I                                      547 576 PAMHNA
      * I :  Special Comment 2
     I                                      577 606 PAMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PAWBST
      * I :  Sales Route Code
     I                                      608 610 PAR4CD
      * I :  Manager Level Code
     I                                      611 612 PABFCD
      * I :  VP Level Code
     I                                      613 615 PAQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PAT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PASICD
      * I :  Invoice Number
     I                                    P 623 6260PACONB
      * I :  Invoice Suffix
     I                                      627 628 PACEST
      * I :  Invoice Date
     I                                    P 629 6320PAAWDT
      * I :  Event Code
     I                                      633 634 PAJPCD
      * I :  Trans Contol AS400_Plant
     I                                      635 635 PAXUST
      * I :  Modified Flag
     I                                      636 636 PAZ1ST
      * I :  A_R order Value Total
     I                                    P 637 6422PAVRVA
      * I :  Billing Activity Type
     I                                      643 643 PAOBST
      * I :  Block Order Flag
     I                                      644 644 PABCST
      * I :  Order Certification Flag
     I                                      645 645 PABDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PAB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PAGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PAGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PAGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PAGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PAFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PAFOSX
      * I :  Order Emailed
     I                                      658 658 PAFPSX
      * I :  Export Docs Go w_Driver
     I                                      659 659 PAFQSX
      * I :  Shipping Temp Code C_F
     I                                      660 660 PAFRSX
      * I :  Broker Order Status
     I                                      661 661 PAFSSX
      * I :  Air Freight Order
     I                                      662 662 PAFTSX
      * I :  Order Requires Review
     I                                      663 664 PAFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PAFVSX
      * I :  Export USDA Approved
     I                                      667 668 PAFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PAFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PAFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PANODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PANPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PANQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PANRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PANSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PABPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PABQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PABRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PABSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PABTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PAH0NX
      * I :  Act Non_Ref Frt Amount
     I                                    P 721 7262PAH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PAH2NX
      * I :  OH Total Non_Ref Frt Amt
     I                                    P 733 7382PAH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PAH4NX
      * I :  Claim Number
     I                                    P 745 7480PAC0C7
      * I :  EDI Status 1
     I                                      749 749 PAUVST
      * I :  EDI Status 2
     I                                      750 750 PAUWST
      * I :  EDI Status 3
     I                                      751 751 PAUXST
      * I :  Job Time
     I                                    P 752 7550PAAATM
      * I :  User Id
     I                                      756 765 PAAYNA
      * I :  Job Name
     I                                      766 775 PAA0NA
      * I :  Job Date
     I                                    P 776 7790PAAXDT
      *
     IQPMAM1    E DSPMAMREL0
      * UPD : Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                          WMAIC3
     I              AMC4NB                          WMC4NB
     I              AMRMNB                          WMRMNB
     I              AMRUNB                          WMRUNB
     I              AMXACD                          WMXACD
     I              AMOANA                          WMOANA
     I              AMHBAA                          WMHBAA
     I              AMJ0T1                          WMJ0T1
     I              AMGENY                          WMGENY
     I              AMJ1T1                          WMJ1T1
     I              AMHCAA                          WMHCAA
     I              AMQWDT                          WMQWDT
     I              AMQXDT                          WMQXDT
     I              AMQYDT                          WMQYDT
     I              AMHDAA                          WMHDAA
     I              AMCCTX                          WMCCTX
     I              AMJ2T1                          WMJ2T1
     I              AMRLNA                          WMRLNA
     I              AMRMNA                          WMRMNA
     I              AMGINY                          WMGINY
     I              AMGFNY                          WMGFNY
     I              AMGGNY                          WMGGNY
     I              AMGHNY                          WMGHNY
     I              AMHEVL                          WMHEVL
     I              AMHFVL                          WMHFVL
     I              AMHGVL                          WMHGVL
     I              AMQZDT                          WMQZDT
     I              AMQ0DT                          WMQ0DT
     I              AMQ1DT                          WMQ1DT
     I              AMQ2DT                          WMQ2DT
     I              AMC2TX                          WMC2TX
     I              AMC3TX                          WMC3TX
     I              AMC6TX                          WMC6TX
     I              AMCHTX                          WMCHTX
     I              AMCITX                          WMCITX
     I              AMCLTX                          WMCLTX
     I              AMB4TX                          WMB4TX
     I              AMCUTX                          WMCUTX
     I              AMCVTX                          WMCVTX
     I              AMB9TX                          WMB9TX
     I              AMJWSC                          WMJWSC
     I              AMITNY                          WMITNY
     I              AMLMT1                          WMLMT1
     I              AMLWAA                          WMLWAA
     I              AMFVST                          WMFVST
     I              AMF0ST                          WMF0ST
     I              AMF2ST                          WMF2ST
     I              AMF3ST                          WMF3ST
     I              AMJUSC                          WMJUSC
     I              AMJVSC                          WMJVSC
     I              AMV3T1                          WMV3T1
     I              AMV4T1                          WMV4T1
     I              AMV5T1                          WMV5T1
     I              AMV6T1                          WMV6T1
     I              AMV7T1                          WMV7T1
     I              AMV8T1                          WMV8T1
     I              AMV9T1                          WMV9T1
     I              AMWAT1                          WMWAT1
     I              AMWBT1                          WMWBT1
     I              AMWCT1                          WMWCT1
     I              AMWDT1                          WMWDT1
     I              AMQJNY                          WMQJNY
     I              AMQKNY                          WMQKNY
     I              AMQLNY                          WMQLNY
     I              AMP8NY                          WMP8NY
     I              AMP9NY                          WMP9NY
     I              AMQANY                          WMQANY
     I              AMQCNY                          WMQCNY
     I              AMQDNY                          WMQDNY
     I              AMQENY                          WMQENY
     I              AMQFNY                          WMQFNY
     I              AMQGNY                          WMQGNY
     I              AMQHNY                          WMQHNY
     I              AMQINY                          WMQINY
     I              AMQMNY                          WMQMNY
     I              AMMYU1                          WMMYU1
     I              AMJXSC                          WMJXSC
     I              AMJYSC                          WMJYSC
     I              AMJZSC                          WMJZSC
     I              AMJ0SC                          WMJ0SC
     I              AMMZU1                          WMMZU1
     I              AMM0U1                          WMM0U1
     I              AMM1U1                          WMM1U1
     I              AMM2U1                          WMM2U1
     I              AMM3U1                          WMM3U1
     I              AMW5DT                          WMW5DT
     I              AMW6DT                          WMW6DT
     I              AMUVST                          WMUVST
     I              AMUWST                          WMUWST
     I              AMUXST                          WMUXST
     I              AMVSST                          WMVSST
     I              AMAATM                          WMAATM
     I              AMAYNA                          WMAYNA
     I              AMA0NA                          WMA0NA
     I              AMAXDT                          WMAXDT
      *
     IYERDCS      DS                            894
     IYFRDCS      DS                            779
     IQOMFF1    E DSOMFFREL1
      * UPD : Carrier Info              Update index
      * Renamed input format fields
     I              FFBZNA                          WOBZNA
     I              FFADTX                          WOADTX
     I              FFACNA                          WOACNA
     I              FFADNA                          WOADNA
     I              FFAENA                          WOAENA
     I              FFAJNA                          WOAJNA
     I              FFBTTX                          WOBTTX
     I              FFEZNB                          WOEZNB
     I              FFBGCD                          WOBGCD
     I              FFEEDT                          WOEEDT
     I              FFDUTX                          WODUTX
     I              FFNRVA                          WONRVA
     I              FFNSVA                          WONSVA
     I              FFNTVA                          WONTVA
     I              FFNUVA                          WONUVA
     I              FFP1ST                          WOP1ST
     I              FFDVTX                          WODVTX
     I              FFDWTX                          WODWTX
     I              FFLVCD                          WOLVCD
     I              FFS8NB                          WOS8NB
     I              FFS9NB                          WOS9NB
     I              FFNMVA                          WONMVA
     I              FFNOVA                          WONOVA
     I              FFNPVA                          WONPVA
     I              FFNQVA                          WONQVA
     I              FFMFCD                          WOMFCD
     I              FFQXNB                          WOQXNB
     I              FFQ1NB                          WOQ1NB
     I              FFMRNG                          WOMRNG
     I              FFMRNE                          WOMRNE
     I              FFRFNB                          WORFNB
     I              FFMREG                          WOMREG
     I              FFBQPR                          WOBQPR
     I              FFBRPR                          WOBRPR
     I              FFBSPR                          WOBSPR
     I              FFBTPR                          WOBTPR
     I              FFBUPR                          WOBUPR
     I              FFBVPR                          WOBVPR
     I              FFDJWG                          WODJWG
     I              FFDKWG                          WODKWG
     I              FFDLWG                          WODLWG
     I              FFDMWG                          WODMWG
     I              FFDNWG                          WODNWG
     I              FFDOWG                          WODOWG
     I              FFB2PR                          WOB2PR
     I              FFB3PR                          WOB3PR
     I              FFB4PR                          WOB4PR
     I              FFB5PR                          WOB5PR
     I              FFB6PR                          WOB6PR
     I              FFB7PR                          WOB7PR
     I              FFAAC7                          WOAAC7
     I              FFCOFI                          WOCOFI
     I              FFK6TX                          WOK6TX
     I              FFOCNA                          WOOCNA
     I              FFODNA                          WOODNA
     I              FFW7CD                          WOW7CD
     I              FFK7TX                          WOK7TX
     I              FFTENO                          WOTENO
     I              FFK8TX                          WOK8TX
     I              FFAOFC                          WOAOFC
     I              FFAOLI                          WOAOLI
     I              FFKHDT                          WOKHDT
     I              FFUNUS                          WOUNUS
     I              FFUNU2                          WOUNU2
     I              FFUNU3                          WOUNU3
     I              FFUVST                          WOUVST
     I              FFUWST                          WOUWST
     I              FFUXST                          WOUXST
     I              FFVSST                          WOVSST
     I              FFAATM                          WOAATM
     I              FFAYNA                          WOAYNA
     I              FFA0NA                          WOA0NA
     I              FFAXDT                          WOAXDT
      *
     IYGRDCS      DS                            641
     IQPDL71    E DSPDL7CPL0
      * UPD : Item Lot Loc Trans        Update index
      * Renamed input format fields
     I              L7AIC3                          WTAIC3
     I              L7HGCD                          WTHGCD
     I              L7AJCD                          WTAJCD
     I              L7LTRT                          WTLTRT
     I              L7LRDT                          WTLRDT
     I              L7LLTS                          WTLLTS
     I              L7LSDT                          WTLSDT
     I              L7J5QT                          WTJ5QT
     I              L7G8WG                          WTG8WG
     I              L7LLTN                          WTLLTN
     I              L7YMCD                          WTYMCD
     I              L7LLCL                          WTLLCL
     I              L7BNAA                          WTBNAA
     I              L7LLTR                          WTLLTR
     I              L7Y2CD                          WTY2CD
     I              L7LLTL                          WTLLTL
     I              L7C4NB                          WTC4NB
     I              L7LOST                          WTLOST
     I              L7LLTU                          WTLLTU
     I              L7LLYT                          WTLLYT
     I              L7UVST                          WTUVST
     I              L7UWST                          WTUWST
     I              L7UXST                          WTUXST
     I              L7VSST                          WTVSST
     I              L7AATM                          WTAATM
     I              L7AYNA                          WTAYNA
     I              L7A0NA                          WTA0NA
     I              L7AXDT                          WTAXDT
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IQPDL51    E DSPDL5CPL0
      * UPD : Item Lot Location         Update index
      * Renamed input format fields
     I              L5AIC3                          TAAIC3
     I              L5HGCD                          TAHGCD
     I              L5AJCD                          TAAJCD
     I              L5ELDT                          TAELDT
     I              L5LXNM                          TALXNM
     I              L5YMCD                          TAYMCD
     I              L5YNCD                          TAYNCD
     I              L5J2QT                          TAJ2QT
     I              L5G5WG                          TAG5WG
     I              L5J3QT                          TAJ3QT
     I              L5G6WG                          TAG6WG
     I              L5J4QT                          TAJ4QT
     I              L5G7WG                          TAG7WG
     I              L5LODT                          TALODT
     I              L5LPDT                          TALPDT
     I              L5LQDT                          TALQDT
     I              L5NBR                           TANBR
     I              L5YTCD                          TAYTCD
     I              L5AMSX                          TAAMSX
     I              L5ASSX                          TAASSX
     I              L5ATSX                          TAATSX
     I              L5AUSX                          TAAUSX
     I              L5YSCD                          TAYSCD
     I              L5UVST                          TAUVST
     I              L5UWST                          TAUWST
     I              L5UXST                          TAUXST
     I              L5VSST                          TAVSST
     I              L5AATM                          TAAATM
     I              L5AYNA                          TAAYNA
     I              L5A0NA                          TAA0NA
     I              L5AXDT                          TAAXDT
      *
     IYHRDCS      DS                            111
     IQCAB11    E DSCAB1REL1
      * UPD : Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          TCAIC3
     I              B1HGCD                          TCHGCD
     I              B1AJCD                          TCAJCD
     I              B1ELDT                          TCELDT
     I              B1ABWG                          TCABWG
     I              B1AGQT                          TCAGQT
     I              B1AHQT                          TCAHQT
     I              B1AIQT                          TCAIQT
     I              B1CTST                          TCCTST
     I              B1ACWG                          TCACWG
     I              B1ARQT                          TCARQT
     I              B1ASQT                          TCASQT
     I              B1ATQT                          TCATQT
     I              B1HDQT                          TCHDQT
     I              B1HEQT                          TCHEQT
     I              B1F6ST                          TCF6ST
     I              B1BMWG                          TCBMWG
     I              B1DSQT                          TCDSQT
     I              B1DTQT                          TCDTQT
     I              B1DUQT                          TCDUQT
     I              B1DHDT                          TCDHDT
     I              B1AGCS                          TCAGCS
     I              B1AECS                          TCAECS
     I              B1IDVA                          TCIDVA
     I              B1K7DT                          TCK7DT
     I              B1RINB                          TCRINB
     I              B1RHNB                          TCRHNB
     I              B1RGNB                          TCRGNB
     I              B1UVST                          TCUVST
     I              B1UWST                          TCUWST
     I              B1UXST                          TCUXST
     I              B1VSST                          TCVSST
     I              B1AATM                          TCAATM
     I              B1AYNA                          TCAYNA
     I              B1A0NA                          TCA0NA
     I              B1AXDT                          TCAXDT
      *
     IQPDL81    E DSPDL8CPL0
      * UPD : Order Inv Allocation      Update index
      * Renamed input format fields
     I              L8AIC3                          TDAIC3
     I              L8C4NB                          TDC4NB
     I              L8DPNB                          TDDPNB
     I              L8UENB                          TDUENB
     I              L8ALSW                          TDALSW
     I              L8J6QT                          TDJ6QT
     I              L8G9WG                          TDG9WG
     I              L8J9QT                          TDJ9QT
     I              L8HAWG                          TDHAWG
     I              L8IOSE                          TDIOSE
     I              L8OIMN                          TDOIMN
     I              L8SOAS                          TDSOAS
     I              L8ARSX                          TDARSX
     I              L8OTUS                          TDOTUS
     I              L8OTMP                          TDOTMP
     I              L8HGCD                          TDHGCD
     I              L8AJCD                          TDAJCD
     I              L8ELDT                          TDELDT
     I              L8LXNM                          TDLXNM
     I              L8YMCD                          TDYMCD
     I              L8YNCD                          TDYNCD
     I              L8UVST                          TDUVST
     I              L8UWST                          TDUWST
     I              L8UXST                          TDUXST
     I              L8VSST                          TDVSST
     I              L8AATM                          TDAATM
     I              L8AYNA                          TDAYNA
     I              L8A0NA                          TDA0NA
     I              L8AXDT                          TDAXDT
      *
     IYIRDCS      DS                             91
     IYJRDCS      DS                            779
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Detail
      * I : RST Company Number
     I                                    P   1   20P1AIC3
      * I : RST Order Number
     I                                    P   3   60P1C4NB
      * N :  Item Code
     I                                    P   7  100P1HGCD
      * N :  Detail Line Status
     I                                       11  11 P1GMST
      * N :  Detail Line Status Last
     I                                       12  12 P1GNST
      * N :  U_M_Ordered
     I                                       13  14 P1AGCD
      * N :  Work Over_Short Status
     I                                       15  15 P1R0ST
      * N :  Production Date Control
     I                                       16  16 P1FZST
      * N :  Quantity Ordered
     I                                    P  17  222P1AVQT
      * N :  Weight Ordered
     I                                    P  23  282P1D0WG
      * N :  Quantity Scheduled
     I                                    P  29  342P1CCQT
      * N :  Weight Scheduled
     I                                    P  35  402P1AUWG
      * N :  Quantity Shipped Total
     I                                    P  41  462P1CBQT
      * N :  Weight Shipped Total
     I                                    P  47  522P1ATWG
      * N :  Requested Ship Date
     I                                    P  53  560P1A5DT
      * I :  Actual Shipped Date
     I                                    P  57  600P1GNDT
      * N :  Event Code
     I                                       61  62 P1JPCD
     IP2PARM      DS
      * B :  Access Denied (Y/N)
     I                                        1   1 P2WVST
     IP3PARM      DS
      * FLD: Order Header TRG
      * N :  Ship To Customer
     I                                    P   1   40P3BKC7
      * N :  Carrier Code
     I                                        5   7 P3BZNA
      * I :  Scheduled Ship Date
     I                                    P   8  110P3AODT
      * N :  Order Value Total
     I                                    P  12  172P3JZVA
      * N :  Order Weight Total
     I                                    P  18  232P3A1WG
      * N :  Load ID
     I                                    P  24  270P3RMNB
      * N :  Trans Contol AS400_Plant
     I                                       28  28 P3XUST
      * N :  Billing Activity Type
     I                                       29  29 P3OBST
     IP4PARM      DS
      * N :  To Warehouse Code  USR
     I                                        1   3 P4WKCD
     IP5PARM      DS
      * N :  Inter-Plant Transfer USR
     I                                        1   1 P5A5TX
     IP6PARM      DS
      * N :  Create EDI ASN 856 V2 USR
     I                                        1   1 P6KGSC
     IP7PARM      DS
      * FLD: *Arrays
      * I :  Called From Program
     I                                        1  10 P7COAB
      * O :  Send Email f/Failed API U
     I                                       11  11 P7OVSC
     IP8PARM      DS
      * I :  SSCC Pallet ID Valid USR
     I                                        1   1 P8QISC
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Send ShipPost Ord Sts Err'
      * Order Number
     I                                        1   7 ZA0001
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P1GNDT    PARM           WP0003  70       Actual Shipped
     C           P2WVST    PARM P2WVST    WP0004  1        Access Denied (
     C           P3AODT    PARM           WP0005  70       Scheduled Ship
     C           P7COAB    PARM           WP0006 10        Called From Pro
     C                     PARM P7OVSC    WP0007  1        Send Email f/Fa
     C           P8QISC    PARM           WP0008  1        SSCC Pallet ID
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * ADD Ready to Confirm   XF
      * RTV Trans Control@Hdr  RT - Order Header TRG  * 
     C                     EXSR SARVGN
      * RTV Check if Post/Not  RT - Order Detail  * 
     C                     EXSR SBRVGN
      * Access Denied = no means all active lines have manifest
      * CASE: PAR.Access Denied (Y/N) is no
     C           P2WVST    IFEQ 'N'                        *IF
      * 11/04/19 DN R15305-Changed RTV to Also Get Bill to Customer.
      * RTV ShpTo,BillTo,OTyp RT - Order Header TRG  * 
     C                     EXSR SHRVGN
      * Get TO warehouse for transfers
      * CASE: PAR.Billing Activity Type is Warehouse Transfer
     C           P3OBST    IFEQ '4'                        *IF
      * Rtv Default Warehouse  RT - Company Customer  * 
     C                     EXSR SIRVGN
      * 12/04/06 PKD Added Inter-Plant Transfer Processing.
      * Rtv Warehouse SHP     RT - Warehouse  * 
     C                     EXSR SJRVGN
      * E00196 RMC 8/24/12 Chk pfs interface SHPTRN too
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0014           PFS Company Num
     C                     MOVEL'SHPTRN'  WL0015    P      PFS Interface C
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0016    YL0012    P      PFS AccuSort Ac
     C                     MOVELWL0017    YL0013    P      PFS Carlisle Ac
      * Inter-Plant Transfer?
      * CASE:
      *  - c2 AND c3 ANDc4
      *   |- c2    : LCL.Warehouse Location is Internal (Plant)
      *   |- c3    : LCL.WHS Live w/Carlisle is Yes
      *   |- c4    : LCL.PFS Carlisle Active is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0008    IFEQ 'I'                        *IF
     C           YL0011    IFEQ 'Y'                        *IF
     C           YL0013    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       P5A5TX           Inter-Plant Tra
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       P5A5TX           Inter-Plant Tra
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    P4WKCD           To Warehouse Co
     C                     MOVEL'N'       P5A5TX           Inter-Plant Tra
     C                     END                             *FI
      * *********************
      * *********************
      * ** This is the function that does all the Inventory updates, etc
      * WI517 DN 10/03/23-Added 'Called From Program' as Input Parm.
      * - Added 'Send Email f/Failed API U' Output Parm.
      * UPD Post Ship Fields   RT - Order Detail  * 
     C                     EXSR SKRVGN
      * RTV Carrier, Load      RT - OP Order Header  * 
     C                     EXSR SURVGN
      * CLC Price/Price Audit  XF - Order Header TRG  * 
     C                     CALL 'PDPRXFR'              90  CLC Price/Price
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0018  30       Company Number
     C                     PARM P1C4NB    WQ0019  70       Order Number
     C                     PARM *ZERO     WQ0020  30       Order Sequence
     C                     PARM *ZERO     WQ0021  30       Order Secondary
     C                     PARM 'SHP'     WQ0022  3        Pricing Event C
     C           P3JZVA    PARM P3JZVA    WQ0023 112       Order Value Tot
     C           P3A1WG    PARM P3A1WG    WQ0024 112       Order Weight To
     C           WUXJST    PARM WUXJST    WQ0025  1        Production Hold
     C                     PARM '*NO'     WQ0026  4        USR New Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * -----
      * 08/12/11 PKD C1696 Update Order Header with new values
      * RTV Chg ord tot/wgt    RT - Order Header TRG  * 
     C                     EXSR SVRVGN
      * -----
      * Update Carrier Last Used Date
      * CASE: PAR.Carrier Code NE WRK.BLANK
     C           P3BZNA    IFNE WUGSTX                     *IF
      * CHG Last Used Date     CH - OM Carrier  * 
     C                     EXSR SXCHRC
     C                     END                             *FI
      * Update load total weight
      * CASE: PAR.Load ID NE WRK.ZERO
     C           P3RMNB    IFNE WUW0NB                     *IF
      * RTV UPD Ld Abs.Frt/Wgt XF - PD Order Header  * 
     C                     CALL 'PDE0XFR'              90  RTV UPD Ld Abs.
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P3RMNB    WQ0027  70       Load ID
     C           WURPNB    PARM WURPNB    WQ0028  70       Total Load Orde
     C           WURQNB    PARM WURQNB    WQ0029 112       Total Freight
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDE0XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * UPD Load w/ Ship Sts   XF - OM Load Header  * 
     C                     CALL 'PDZ4XFR'              90  UPD Load w/ Shi
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P3RMNB    WQ0030  70       Load ID
     C                     PARM P1AIC3    WQ0031  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDZ4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Cnf Order Ship/Unship IF
      * Cnf Order Ship/Unship RT - Order Inv Allocation  * 
     C                     EXSR SYRVGN
      * WI609_2 JM 10/08/24-EDI 856 Advance Shipping Notice Processing.
      * CASE:
      *  - c1 AND NOTc2
      *   |- c1    : PAR.Called From Program is Exc Upd EDI 945 Trsn   XF
      *   |- c2    : PAR.SSCC Pallet ID Valid USR is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P7COAB    IFEQ @CN,002                    *IF
     C           P8QISC    IFEQ 'N'                        *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Exc Crt EDI 856 ASN V2 XF - EDI Adv Ship Ntc Headr V2  * 
     C                     CALL 'PUOIXFR'              90  Exc Crt EDI 856
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P3RMNB    WQ0032  70       Load ID
     C                     PARM *ZERO     WQ0033  30       Company Number
     C                     PARM *ZERO     WQ0034  70       Bill to Custome
     C                     PARM 'N'       WQ0035  1        F17 Pressed USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUOIXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * T11041 DN 07/12/17-Build EDI WHS Stock Txfr Files for Order Shipp
      * CASE: PAR.Billing Activity Type is Warehouse Transfer
     C           P3OBST    IFEQ '4'                        *IF
      * Upd EDI WHS Stock Txfr XF - EDI WHS Stock Txfr   HDR  * 
     C                     CALL 'PUC5XFR'              90  Upd EDI WHS Sto
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0036  30       Company Number
     C                     PARM P1C4NB    WQ0037  70       Order Number
     C                     PARM 'N'       WQ0038  1        USR Unship Flag
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUC5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Chg Head Status    RT - Order Header TRG  * 
     C                     EXSR TLRVGN
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Trans Control@Hdr  RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WAAIC3           Company Number
     C                     Z-ADDP1C4NB    WAC4NB           Order Number
      * Establish starting position
     C           KRSSA     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    P3XUST           Trans Contol AS
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAXUST    P3XUST           Trans Contol AS
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Check if Post/Not  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Change log
     C                     EXSR UASUBR                     Change log
     C                     MOVEL'N'       P2WVST           Access Denied (
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSB01           Company Number
     C           *LIKE     DEFN WBC4NB    WQSB02           Order Number
      * Define keylist
     C           KPSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Order Number
     C                     KFLD           WBDPNB           Order Sequence
     C                     KFLD           WBUENB           Order Secondary
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSB01           Company Number
     C                     Z-ADDP1C4NB    WQSB02           Order Number
     C                     Z-ADD*ZERO     WBDPNB           Order Sequence
     C                     Z-ADD*ZERO     WBUENB           Order Secondary
      * Establish starting position
     C           KPSSB     SETLL@BGWKL1                    *
     C           KRSSB     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Update all status for non-deleted items
      * CASE: DB1.Detail Line Status is Not cancelled
     C           WBGMST    IFEQ 'L'                        *IF
     C           WBGMST    OREQ 'A'
     C           WBGMST    OREQ 'C'
     C           WBGMST    OREQ 'R'
     C           WBGMST    OREQ 'E'
     C           WBGMST    OREQ 'H'
     C           WBGMST    OREQ 'I'
      * RTV Check Existence    RT - Manifest Detail  * 
     C                     EXSR SCRVGN
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ @CN,001                    *IF
      * CHG Post Dtl Status    CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0001           Company Number
     C                     Z-ADDWBC4NB    WL0002           Order Number
     C                     Z-ADDWBDPNB    WL0003           Order Sequence
     C                     Z-ADDWBUENB    WL0004           Order Secondary
     C                     MOVEL'R'       WL0005    P      Detail Line Sta
     C                     MOVELWBGMST    WL0006    P      Detail Line Sta
     C                     Z-ADDWBKDVA    WL0007           Billing Detail
     C                     Z-ADDWBL8VA    WL0008           Billing Detail
     C                     Z-ADDWBL9VA    WL0009           Quantity to Sub
     C                     Z-ADDWBAYVA    WL0010           Extended Amount
     C                     MOVELWBU0ST    WL0011    P      Price Audit
     C                     MOVELWBRFCD    WL0012    P      Price Audit Rea
     C                     MOVEL'04'      WL0013    P      Event Code
     C                     EXSR SDCHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * If plant floor order change status to shipped
      * CASE: PAR.Trans Contol AS400/Plant is Plant
     C           P3XUST    IFEQ 'P'                        *IF
      * CHG Post Dtl Status    CH - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0001           Company Number
     C                     Z-ADDWBC4NB    WL0002           Order Number
     C                     Z-ADDWBDPNB    WL0003           Order Sequence
     C                     Z-ADDWBUENB    WL0004           Order Secondary
     C                     MOVEL'R'       WL0005    P      Detail Line Sta
     C                     MOVELWBGMST    WL0006    P      Detail Line Sta
     C                     Z-ADD*ZERO     WL0007           Billing Detail
     C                     Z-ADD*ZERO     WL0008           Billing Detail
     C                     Z-ADD*ZERO     WL0009           Quantity to Sub
     C                     Z-ADD*ZERO     WL0010           Extended Amount
     C                     MOVEL'M'       WL0011    P      Price Audit
     C                     MOVEL*BLANK    WL0012           Price Audit Rea
     C                     MOVEL'04'      WL0013    P      Event Code
     C                     EXSR SDCHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * 11/01/08 PKD If live with Carlisle, then Manifest Detail is not
      *              necessary.
      * Rtv Live w/Carlisle   RT - Warehouse  * 
     C                     EXSR SERVGN
      * E00196 RMC 8/24/12 Chk pfs interface SHPTRN too
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0014           PFS Company Num
     C                     MOVEL'SHPTRN'  WL0015    P      PFS Interface C
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0016    YL0002    P      PFS AccuSort Ac
     C                     MOVELWL0017    YL0003    P      PFS Carlisle Ac
      * S15557 RMC 10/02/19 Chk EDI live with 945 too
      * Rtv Whs Interchg Actv RT - EDI WHS Interchange  * 
     C                     EXSR SGRVGN
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.WHS Live w/Carlisle is Yes
      *   |- c2    : LCL.PFS Carlisle Active is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0001    IFEQ 'Y'                        *IF
     C           YL0003    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CHG Post Dtl Status    CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0001           Company Number
     C                     Z-ADDWBC4NB    WL0002           Order Number
     C                     Z-ADDWBDPNB    WL0003           Order Sequence
     C                     Z-ADDWBUENB    WL0004           Order Secondary
     C                     MOVEL'R'       WL0005    P      Detail Line Sta
     C                     MOVELWBGMST    WL0006    P      Detail Line Sta
     C                     Z-ADD*ZERO     WL0007           Billing Detail
     C                     Z-ADD*ZERO     WL0008           Billing Detail
     C                     Z-ADD*ZERO     WL0009           Quantity to Sub
     C                     Z-ADD*ZERO     WL0010           Extended Amount
     C                     MOVEL'M'       WL0011    P      Price Audit
     C                     MOVEL*BLANK    WL0012           Price Audit Rea
     C                     MOVEL'04'      WL0013    P      Event Code
     C                     EXSR SDCHRC
     C                     ELSE
      * CASE: LCL.Record Status Save is Active
     C           YL0004    IFEQ 'A'                        *IF
      * CHG Post Dtl Status    CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0001           Company Number
     C                     Z-ADDWBC4NB    WL0002           Order Number
     C                     Z-ADDWBDPNB    WL0003           Order Sequence
     C                     Z-ADDWBUENB    WL0004           Order Secondary
     C                     MOVEL'R'       WL0005    P      Detail Line Sta
     C                     MOVELWBGMST    WL0006    P      Detail Line Sta
     C                     Z-ADD*ZERO     WL0007           Billing Detail
     C                     Z-ADD*ZERO     WL0008           Billing Detail
     C                     Z-ADD*ZERO     WL0009           Quantity to Sub
     C                     Z-ADD*ZERO     WL0010           Extended Amount
     C                     MOVEL'M'       WL0011    P      Price Audit
     C                     MOVEL*BLANK    WL0012           Price Audit Rea
     C                     MOVEL'04'      WL0013    P      Event Code
     C                     EXSR SDCHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * CHG Post Dtl Status    CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0001           Company Number
     C                     Z-ADDWBC4NB    WL0002           Order Number
     C                     Z-ADDWBDPNB    WL0003           Order Sequence
     C                     Z-ADDWBUENB    WL0004           Order Secondary
     C                     MOVEL'A'       WL0005    P      Detail Line Sta
     C                     MOVELWBGMST    WL0006    P      Detail Line Sta
     C                     Z-ADDWBKDVA    WL0007           Billing Detail
     C                     Z-ADDWBL8VA    WL0008           Billing Detail
     C                     Z-ADDWBL9VA    WL0009           Quantity to Sub
     C                     Z-ADDWBAYVA    WL0010           Extended Amount
     C                     MOVELWBU0ST    WL0011    P      Price Audit
     C                     MOVELWBRFCD    WL0012    P      Price Audit Rea
     C                     MOVEL*BLANK    WL0013           Event Code
     C                     EXSR SDCHRC
     C                     MOVEL'Y'       P2WVST           Access Denied (
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSB     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Check Existence    RT - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSC01           Company Number
     C           *LIKE     DEFN WCC4NB    WQSC02           Order Number
     C           *LIKE     DEFN WCDPNB    WQSC03           Order Sequence
     C           *LIKE     DEFN WCUENB    WQSC04           Order Secondary
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Order Number
     C                     KFLD           WQSC03           Order Sequence
     C                     KFLD           WQSC04           Order Secondary
      * Setup key
     C                     Z-ADDWBAIC3    WQSC01           Company Number
     C                     Z-ADDWBC4NB    WQSC02           Order Number
     C                     Z-ADDWBDPNB    WQSC03           Order Sequence
     C                     Z-ADDWBUENB    WQSC04           Order Secondary
      * Establish starting position
     C           KRSSC     SETLL@FNCPCT                    *
     C           KRSSC     READE@FNCPCT                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1196' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT                     *QUIT
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     GOTO SCEXIT                     *QUIT
     C           KRSSC     READE@FNCPCT                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCHRC    BEGSR
      *================================================================
      * CHG Post Dtl Status    CH - Order Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  70       Item Code
     C                     MOVEL*BLANK    WN0002  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0003  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0004  70       Order Group Cod
     C                     Z-ADD*ZERO     WN0005 112       Billing Detail
     C                     MOVEL*BLANK    WN0006  1        Comment Print A
     C                     MOVEL*BLANK    WN0007  1        Comment Print I
     C                     MOVEL*BLANK    WN0008  1        Comment Print P
     C                     MOVEL*BLANK    WN0009  1        Comment Print S
     C                     Z-ADD*ZERO     WN0010  70       Market Pricing
     C                     MOVEL*BLANK    WN0011  3        Commodity Marke
     C                     MOVEL*BLANK    WN0012  3        Date Method Cod
     C                     MOVEL*BLANK    WN0013  3        Price Method Co
     C                     Z-ADD*ZERO     WN0014 114       Price Overage O
     C                     Z-ADD*ZERO     WN0015  70       Contract Number
     C                     MOVEL*BLANK    WN0016  1        Price Status
     C                     Z-ADD*ZERO     WN0017  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0018  2        U_M_Base Price
     C                     MOVEL*BLANK    WN0019  2        U_M_Ordered
     C                     MOVEL*BLANK    WN0020  1        Work Confirm St
     C                     MOVEL*BLANK    WN0021  1        Work Over_Short
     C                     MOVEL*BLANK    WN0022  1        OD Production P
     C                     MOVEL*BLANK    WN0023 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0024 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0025  1        Age Code
     C                     MOVEL*BLANK    WN0026  1        Palletize
     C                     MOVEL*BLANK    WN0027  1        Slip Sheet
     C                     MOVEL*BLANK    WN0028  1        Catch Weight St
     C                     MOVEL*BLANK    WN0029  1        Production Date
     C                     Z-ADD*ZERO     WN0030 112       Rated Freight
     C                     Z-ADD*ZERO     WN0031 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0032 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0033 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0034 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0035 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0036 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0037 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0038 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0039 114       Unit Price
     C                     Z-ADD*ZERO     WN0040 114       Unit Price_Cred
     C                     Z-ADD*ZERO     WN0041 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0042 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0043 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0044  70       Requested Ship
     C                     Z-ADD*ZERO     WN0045  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0046  70       Actual Shipped
     C                     MOVEL*BLANK    WN0047  1        Affect Inventor
     C                     MOVEL*BLANK    WN0048  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0049  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0050  30       Item Structure
     C                     Z-ADD*ZERO     WN0051  30       Item Structure
     C                     Z-ADD*ZERO     WN0052  30       Item Structure
     C                     MOVEL*BLANK    WN0053  2        Item Level
     C                     MOVEL*BLANK    WN0054  2        Quality Level
     C                     MOVEL*BLANK    WN0055  2        Pricing Product
     C                     MOVEL*BLANK    WN0056  2        Season Product
     C                     Z-ADD*ZERO     WN0057  70       Date of Origina
     C                     MOVEL*BLANK    WN0058 10        User Profile Na
     C                     MOVEL*BLANK    WN0059  6        Country Code
     C                     MOVEL*BLANK    WN0060  3        Reason Code
     C                     MOVEL*BLANK    WN0061  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0062  1        Modified Flag
     C                     MOVEL*BLANK    WN0063  1        Substituted Fla
     C                     MOVEL*BLANK    WN0064  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0065 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0066 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0067  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0068  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0069  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0070  1        Affect Commissi
     C                     MOVEL*BLANK    WN0071  1        Affect Pricing
     C                     MOVEL*BLANK    WN0072  1        Released by Use
     C                     MOVEL*BLANK    WN0073  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0074  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0075  3        Production Ware
     C                     MOVEL*BLANK    WN0076  3        OD Price Type
     C                     Z-ADD*ZERO     WN0077  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0078  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0079  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0080  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0081  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0082  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0083  60       Price Code
     C                     Z-ADD*ZERO     WN0084  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0085  60       Substitution Li
     C                     Z-ADD*ZERO     WN0086  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0087 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0088 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0089 112       OD Item Target
     C                     Z-ADD*ZERO     WN0090 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0091 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0092 114       Order Gate_Fina
     C                     Z-ADD*ZERO     WN0093 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0094 114       OD Gate_Final P
     C                     Z-ADD*ZERO     WN0095 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0096 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0097 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0098 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0099 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0100  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0101  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0102  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0103 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0104  40       Item Age Days
     C                     Z-ADD*ZERO     WN0105  70       Production Ovr
     C                     Z-ADD*ZERO     WN0106  70       Production Ovr
     C                     MOVEL*BLANK    WN0107  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0108  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0109  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0110  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0111  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0112  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0113  1        EDI Status 1
     C                     MOVEL*BLANK    WN0114  1        EDI Status 2
     C                     MOVEL*BLANK    WN0115  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0116  60       Job Time
     C                     MOVEL*BLANK    WN0117 10        User Id
     C                     MOVEL*BLANK    WN0118 10        Job Name
     C                     Z-ADD*ZERO     WN0119  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWL0001    WDAIC3           Company Number
     C                     Z-ADDWL0002    WDC4NB           Order Number
     C                     Z-ADDWL0003    WDDPNB           Order Sequence
     C                     Z-ADDWL0004    WDUENB           Order Secondary
      *
     C           KLCHSD    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
     C                     KFLD           WDDPNB           Order Sequence
     C                     KFLD           WDUENB           Order Secondary
     C           KLCHSD    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YARDCS
      * Move non-key fields to @BGWKL0
     C                     MOVELWL0005    WDGMST    P      Detail Line Sta
     C                     MOVELWL0006    WDGNST    P      Detail Line Sta
     C                     Z-ADDWL0007    WDKDVA           Billing Detail
     C                     Z-ADDWL0008    WDL8VA           Billing Detail
     C                     Z-ADDWL0009    WDL9VA           Quantity to Sub
     C                     Z-ADDWL0010    WDAYVA           Extended Amount
     C                     MOVELWL0011    WDU0ST    P      Price Audit
     C                     MOVELWL0012    WDRFCD    P      Price Audit Rea
     C                     MOVELWL0013    WDJPCD    P      Event Code
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Live w/Carlisle   RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEAJCD           Warehouse Code
      * Setup key
     C                     MOVELWBAJCD    WEAJCD           Warehouse Code
      * Establish starting position
     C           KRSSE     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           WHS Live with C
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWERRSX    YL0001           WHS Live with C
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Active Status     RT - PFS Interface  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WFY1NX           PFS Company Num
     C                     KFLD           WFGYAA           PFS Interface C
      * Setup key
     C                     Z-ADDWL0014    WFY1NX           PFS Company Num
     C                     MOVELWL0015    WFGYAA           PFS Interface C
      * Establish starting position
     C           KRSSF     CHAIN@BUREBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3541' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0016           PFS AccuSort Ac
     C                     MOVEL*BLANK    WL0017           PFS Carlisle Ac
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFWSSX    WL0016           PFS AccuSort Ac
     C                     MOVELWFWUSX    WL0017           PFS Carlisle Ac
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Whs Interchg Actv RT - EDI WHS Interchange  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WGAJCD           Warehouse Code
     C                     KFLD           WGM4AA           Interchange Cod
      * Setup key
     C                     MOVELWBAJCD    WGAJCD           Warehouse Code
     C                     MOVEL'WHSADV'  WGM4AA           Interchange Cod
      * Establish starting position
     C           KRSSG     CHAIN@G0REJZ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4409' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0004           Record Status
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGVSST    YL0004           Record Status
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV ShpTo,BillTo,OTyp RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WAAIC3           Company Number
     C                     Z-ADDP1C4NB    WAC4NB           Order Number
      * Establish starting position
     C           KRSSH     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0005           AR Customer Num
     C                     Z-ADD*ZERO     P3BKC7           Ship To Custome
     C                     Z-ADD*ZERO     YL0006           Bill to Custome
     C                     MOVEL*BLANK    P3OBST           Billing Activit
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWAANC7    YL0005           AR Customer Num
     C                     Z-ADDWABKC7    P3BKC7           Ship To Custome
     C                     Z-ADDWAB0C7    YL0006           Bill to Custome
     C                     MOVELWAOBST    P3OBST           Billing Activit
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Default Warehouse  RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDP1AIC3    WHAIC3           Company Number
     C                     Z-ADDP3BKC7    WHBKC7           Ship To Custome
      * Establish starting position
     C           KRSSI     CHAIN@EOREXM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    P4WKCD           Warehouse Code
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHAJCD    P4WKCD           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Warehouse SHP     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WEAJCD           Warehouse Code
      * Setup key
     C                     MOVELP4WKCD    WEAJCD           Warehouse Code
      * Establish starting position
     C           KRSSJ     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0007           Trans Contol AS
     C                     MOVEL*BLANK    YL0008           Warehouse Locat
     C                     Z-ADD*ZERO     YL0009           Shipping Compan
     C                     Z-ADD*ZERO     YL0010           Accounting Comp
     C                     MOVEL*BLANK    YL0011           WHS Live with C
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEXUST    YL0007           Trans Contol AS
     C                     MOVELWET0ST    YL0008           Warehouse Locat
     C                     Z-ADDWEBWC3    YL0009           Shipping Compan
     C                     Z-ADDWEBTC3    YL0010           Accounting Comp
     C                     MOVELWERRSX    YL0011           WHS Live with C
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * UPD Post Ship Fields   RT - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0120 112       Extended Amount
     C                     Z-ADD*ZERO     WN0121 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0122 114       Unit Cost Per P
     C                     MOVEL*BLANK    WN0123  1        USR New Item St
     C                     MOVEL*BLANK    WN0124  1        USR Deleted Ite
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * WI517 DN 10/04/23-Initialize Flags.
     C                     MOVEL'Y'       YL0014           First Time Thro
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSK01           Company Number
     C           *LIKE     DEFN WBC4NB    WQSK02           Order Number
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Company Number
     C                     KFLD           WQSK02           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSK01           Company Number
     C                     Z-ADDP1C4NB    WQSK02           Order Number
      * Establish starting position
     C           KRSSK     SETLL@BGWKL1                    *
     C           KRSSK     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Access Denied = no means all active lines have manifest
      * Inventory and Order Records updated when complete order confirmed
      * CASE: PAR.Access Denied (Y/N) is no
     C           P2WVST    IFEQ 'N'                        *IF
      * Update Inventory trans and Item Balance files, return cost
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Detail Line Status is Not cancelled
      *   |- c2    : DB1.Affect Inventory Status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WBGMST    IFEQ 'L'                        *IF
     C           WBGMST    OREQ 'A'
     C           WBGMST    OREQ 'C'
     C           WBGMST    OREQ 'R'
     C           WBGMST    OREQ 'E'
     C           WBGMST    OREQ 'H'
     C           WBGMST    OREQ 'I'
     C           WBAMST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * WI517 DN 10/03/23-Added 'Called From Program' as Input Parm.
      * - Added 'Send Email f/Failed API U' Output Parm.
      * UPD Confrm - Ship Post XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDOOXFR'              90  UPD Confrm - Sh
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBAIC3    WQ0001  30       Company Number
     C                     PARM WBC4NB    WQ0002  70       Order Number
     C                     PARM WBDPNB    WQ0003  30       Order Sequence
     C                     PARM WBUENB    WQ0004  30       Order Secondary
     C                     PARM WBHGCD    WQ0005  70       Item Code
     C                     PARM WBAJCD    WQ0006  3        Warehouse Code
     C                     PARM WBAGCD    WQ0007  2        U_M_Ordered
     C                     PARM P1GNDT    WQ0008  70       Actual Shipped
     C                     PARM P3OBST    WQ0009  1        Billing Activit
     C                     PARM P4WKCD    WQ0010  3        To Warehouse Co
     C                     PARM P5A5TX    WQ0011  1        Inter-Plant Tra
     C                     PARM P7COAB    WQ0012 10        Called From Pro
     C           YL0015    PARM *BLANK    WQ0013  1        Send Email f/Fa
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDOOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * WI517 DN 10/04/23-Set 'Send Email f/Failed API U' for Failed API
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Send Email f/Failed API U is Yes
      *   |- c2    : LCL.First Time Through USR is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0015    IFEQ 'Y'                        *IF
     C           YL0014    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       YL0014           First Time Thro
     C                     MOVEL'Y'       P7OVSC           Send Email f/Fa
     C                     END                             *FI
     C                     END                             *FI
      * Let Inventory know of any differences in what has been shipped fr
      *     what has been ordered.
     C                     MOVEL'N'       WN0123           USR New Item St
     C                     MOVEL'N'       WN0124           USR Deleted Ite
      * If affect inventory is yes then affect Product Available
      * CASE: DB1.Affect Inventory Status is yes
     C           WBAMST    IFEQ 'Y'                        *IF
      * Process Over/Short Ship
      * CASE: DB1.Detail Line Status is Not cancelled
     C           WBGMST    IFEQ 'L'                        *IF
     C           WBGMST    OREQ 'A'
     C           WBGMST    OREQ 'C'
     C           WBGMST    OREQ 'R'
     C           WBGMST    OREQ 'E'
     C           WBGMST    OREQ 'H'
     C           WBGMST    OREQ 'I'
      * If dates not =, short scheduled ship, over actual ship
      * CASE: PAR.Scheduled Ship Date NE PAR.Actual Shipped Date
     C           P3AODT    IFNE P1GNDT                     *IF
      * Update allocated qty/wgt so = shipped qty/wgt
      * CHG Allc/Shp Val, Csts CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0018           Company Number
     C                     Z-ADDWBC4NB    WL0019           Order Number
     C                     Z-ADDWBDPNB    WL0020           Order Sequence
     C                     Z-ADDWBUENB    WL0021           Order Secondary
     C                     Z-ADDWBCCQT    WL0022           Quantity Schedu
     C                     Z-ADDWBAUWG    WL0023           Weight Schedule
     C                     Z-ADDWBCBQT    WL0024           Quantity Shippe
     C                     Z-ADDWBATWG    WL0025           Weight Shipped
     C                     Z-ADD*ZERO     WL0026           Unit Cost Prici
     C                     Z-ADD*ZERO     WL0027           Unit Cost Per P
     C                     EXSR SLCHRC
     C                     END                             *FI
      * If dates =, over or short or nothing based on processing
      * CASE: PAR.Scheduled Ship Date EQ PAR.Actual Shipped Date
     C           P3AODT    IFEQ P1GNDT                     *IF
      * Update allocated qty/wgt so = shipped qty/wgt
      * CHG Allc/Shp Val, Csts CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0018           Company Number
     C                     Z-ADDWBC4NB    WL0019           Order Number
     C                     Z-ADDWBDPNB    WL0020           Order Sequence
     C                     Z-ADDWBUENB    WL0021           Order Secondary
     C                     Z-ADDWBCCQT    WL0022           Quantity Schedu
     C                     Z-ADDWBAUWG    WL0023           Weight Schedule
     C                     Z-ADDWBCBQT    WL0024           Quantity Shippe
     C                     Z-ADDWBATWG    WL0025           Weight Shipped
     C                     Z-ADD*ZERO     WL0026           Unit Cost Prici
     C                     Z-ADD*ZERO     WL0027           Unit Cost Per P
     C                     EXSR SLCHRC
      * Rtv/Chg Doc Order Shpd RT - Export Doc Order Dtl  * 
     C                     EXSR SMRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Cancelled or deleted lines
      * CASE: DB1.Detail Line Status is Cancelled
     C           WBGMST    IFEQ 'X'                        *IF
      * CHG Allc/Shp Val, Csts CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0018           Company Number
     C                     Z-ADDWBC4NB    WL0019           Order Number
     C                     Z-ADDWBDPNB    WL0020           Order Sequence
     C                     Z-ADDWBUENB    WL0021           Order Secondary
     C                     Z-ADD*ZERO     WL0022           Quantity Schedu
     C                     Z-ADD*ZERO     WL0023           Weight Schedule
     C                     Z-ADD*ZERO     WL0024           Quantity Shippe
     C                     Z-ADD*ZERO     WL0025           Weight Shipped
     C                     Z-ADD*ZERO     WL0026           Unit Cost Prici
     C                     Z-ADD*ZERO     WL0027           Unit Cost Per P
     C                     EXSR SLCHRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSK     READE@BGWKL1                  90*
     C                     ENDDO
      * USER: Exit processing
      * RTV Chg Confirm Order  RT - Order Header TRG  * 
     C                     EXSR SORVGN
      * FP1110 - RMC 1/10/08 Chg OHE shipped sts
      * RTV Chg for Shipping  RT - Order Header Extension  * 
     C                     EXSR SRRVGN
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCHRC    BEGSR
      *================================================================
      * CHG Allc/Shp Val, Csts CH - Order Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0125  70       Item Code
     C                     MOVEL*BLANK    WN0126  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0127  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0128  70       Order Group Cod
     C                     MOVEL*BLANK    WN0129  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0130  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0131 112       Billing Detail
     C                     Z-ADD*ZERO     WN0132 112       Billing Detail
     C                     Z-ADD*ZERO     WN0133 112       Billing Detail
     C                     Z-ADD*ZERO     WN0134 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0135  1        Comment Print A
     C                     MOVEL*BLANK    WN0136  1        Comment Print I
     C                     MOVEL*BLANK    WN0137  1        Comment Print P
     C                     MOVEL*BLANK    WN0138  1        Comment Print S
     C                     Z-ADD*ZERO     WN0139 112       Extended Amount
     C                     Z-ADD*ZERO     WN0140  70       Market Pricing
     C                     MOVEL*BLANK    WN0141  3        Commodity Marke
     C                     MOVEL*BLANK    WN0142  3        Date Method Cod
     C                     MOVEL*BLANK    WN0143  3        Price Method Co
     C                     Z-ADD*ZERO     WN0144 114       Price Overage O
     C                     Z-ADD*ZERO     WN0145  70       Contract Number
     C                     MOVEL*BLANK    WN0146  1        Price Status
     C                     Z-ADD*ZERO     WN0147  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0148  2        U_M_Base Price
     C                     MOVEL*BLANK    WN0149  2        U_M_Ordered
     C                     MOVEL*BLANK    WN0150  1        Work Confirm St
     C                     MOVEL*BLANK    WN0151  1        Work Over_Short
     C                     MOVEL*BLANK    WN0152  1        OD Production P
     C                     MOVEL*BLANK    WN0153 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0154 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0155  1        Age Code
     C                     MOVEL*BLANK    WN0156  1        Palletize
     C                     MOVEL*BLANK    WN0157  1        Slip Sheet
     C                     MOVEL*BLANK    WN0158  1        Catch Weight St
     C                     MOVEL*BLANK    WN0159  1        Price Audit
     C                     MOVEL*BLANK    WN0160  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0161  1        Production Date
     C                     Z-ADD*ZERO     WN0162 112       Rated Freight
     C                     Z-ADD*ZERO     WN0163 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0164 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0165 114       Unit Price
     C                     Z-ADD*ZERO     WN0166 114       Unit Price_Cred
     C                     Z-ADD*ZERO     WN0167 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0168 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0169 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0170  70       Requested Ship
     C                     Z-ADD*ZERO     WN0171  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0172  70       Actual Shipped
     C                     MOVEL*BLANK    WN0173  1        Affect Inventor
     C                     MOVEL*BLANK    WN0174  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0175  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0176  30       Item Structure
     C                     Z-ADD*ZERO     WN0177  30       Item Structure
     C                     Z-ADD*ZERO     WN0178  30       Item Structure
     C                     MOVEL*BLANK    WN0179  2        Item Level
     C                     MOVEL*BLANK    WN0180  2        Quality Level
     C                     MOVEL*BLANK    WN0181  2        Pricing Product
     C                     MOVEL*BLANK    WN0182  2        Season Product
     C                     Z-ADD*ZERO     WN0183  70       Date of Origina
     C                     MOVEL*BLANK    WN0184 10        User Profile Na
     C                     MOVEL*BLANK    WN0185  6        Country Code
     C                     MOVEL*BLANK    WN0186  2        Event Code
     C                     MOVEL*BLANK    WN0187  3        Reason Code
     C                     MOVEL*BLANK    WN0188  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0189  1        Modified Flag
     C                     MOVEL*BLANK    WN0190  1        Substituted Fla
     C                     MOVEL*BLANK    WN0191  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0192 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0193 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0194  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0195  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0196  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0197  1        Affect Commissi
     C                     MOVEL*BLANK    WN0198  1        Affect Pricing
     C                     MOVEL*BLANK    WN0199  1        Released by Use
     C                     MOVEL*BLANK    WN0200  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0201  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0202  3        Production Ware
     C                     MOVEL*BLANK    WN0203  3        OD Price Type
     C                     Z-ADD*ZERO     WN0204  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0205  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0206  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0207  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0208  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0209  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0210  60       Price Code
     C                     Z-ADD*ZERO     WN0211  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0212  60       Substitution Li
     C                     Z-ADD*ZERO     WN0213  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0214 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0215 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0216 112       OD Item Target
     C                     Z-ADD*ZERO     WN0217 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0218 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0219 114       Order Gate_Fina
     C                     Z-ADD*ZERO     WN0220 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0221 114       OD Gate_Final P
     C                     Z-ADD*ZERO     WN0222 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0223 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0224 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0225 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0226 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0227  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0228  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0229  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0230 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0231  40       Item Age Days
     C                     Z-ADD*ZERO     WN0232  70       Production Ovr
     C                     Z-ADD*ZERO     WN0233  70       Production Ovr
     C                     MOVEL*BLANK    WN0234  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0235  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0236  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0237  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0238  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0239  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0240  1        EDI Status 1
     C                     MOVEL*BLANK    WN0241  1        EDI Status 2
     C                     MOVEL*BLANK    WN0242  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0243  60       Job Time
     C                     MOVEL*BLANK    WN0244 10        User Id
     C                     MOVEL*BLANK    WN0245 10        Job Name
     C                     Z-ADD*ZERO     WN0246  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWL0018    WDAIC3           Company Number
     C                     Z-ADDWL0019    WDC4NB           Order Number
     C                     Z-ADDWL0020    WDDPNB           Order Sequence
     C                     Z-ADDWL0021    WDUENB           Order Secondary
      *
     C           KLCHSL    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
     C                     KFLD           WDDPNB           Order Sequence
     C                     KFLD           WDUENB           Order Secondary
     C           KLCHSL    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YBRDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDWL0022    WDCCQT           Quantity Schedu
     C                     Z-ADDWL0023    WDAUWG           Weight Schedule
     C                     Z-ADDWL0024    WDCBQT           Quantity Shippe
     C                     Z-ADDWL0025    WDATWG           Weight Shipped
     C                     Z-ADDWL0026    WDAQCS           Unit Cost Prici
     C                     Z-ADDWL0027    WDAGCS           Unit Cost Per P
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##JOB     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv/Chg Doc Order Shpd RT - Export Doc Order Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIAIC3    WQSM01           Company Number
     C           *LIKE     DEFN WIC4NB    WQSM02           Order Number
     C           *LIKE     DEFN WIDPNB    WQSM03           Order Sequence
     C           *LIKE     DEFN WIUENB    WQSM04           Order Secondary
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Order Number
     C                     KFLD           WQSM03           Order Sequence
     C                     KFLD           WQSM04           Order Secondary
      * Setup key
     C                     Z-ADDWBAIC3    WQSM01           Company Number
     C                     Z-ADDWBC4NB    WQSM02           Order Number
     C                     Z-ADDWBDPNB    WQSM03           Order Sequence
     C                     Z-ADDWBUENB    WQSM04           Order Secondary
      * Establish starting position
     C           KRSSM     SETLL@MSREX2                    *
     C           KRSSM     READE@MSREX2                  90*
      * Data record not found
     C   90                MOVEL'USR2745' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WBATWG    DIV  2204.6    YL0016           ED Product Net
      * Compute: Total Nbr Pieces
      * LCL.ED Total Nbr of Pieces =
      *    *COMPUTE (x1 * (x2 * x3))
      * x1    : PAR.Quantity Shipped Total
      * *     : PGM.*Synon (17,7) work field *
      * x2    : DB1.ED Pieces per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x3    : DB1.ED Bags per Unit
     C           WIAMNX    MULT WIANNX    W0WD01           *Synon (17,7) w
     C           WBCBQT    MULT W0WD01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0017           ED Total Nbr of
      * Chg Exp Doc Order Dtl  CH - Export Doc Order Dtl  * 
     C                     EXSR SNCHRC
     C           KRSSM     READE@MSREX2                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNCHRC    BEGSR
      *================================================================
      * Chg Exp Doc Order Dtl  CH - Export Doc Order Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @MSREW4
     C                     Z-ADDWIAIC3    WJAIC3           Company Number
     C                     Z-ADDWIC4NB    WJC4NB           Order Number
     C                     MOVELWIDGSX    WJDGSX    P      ED Export Docum
     C                     MOVELWIKXCD    WJKXCD    P      Country Code
     C                     Z-ADDWIDPNB    WJDPNB           Order Sequence
     C                     Z-ADDWIUENB    WJUENB           Order Secondary
      *
     C           KLCHSN    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJC4NB           Order Number
     C                     KFLD           WJDGSX           ED Export Docum
     C                     KFLD           WJKXCD           Country Code
     C                     KFLD           WJDPNB           Order Sequence
     C                     KFLD           WJUENB           Order Secondary
     C           KLCHSN    CHAIN@MSREW4              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDMSREL0'MDACP
     C                     MOVEL'@MSREW4' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDMS1    YCRDCS
      * Move non-key fields to @MSREW4
     C                     Z-ADDWIDIC7    WJDIC7           ED Item Code
     C                     MOVELWIO3NA    WJO3NA    P      ED Item Label L
     C                     MOVELWIO4NA    WJO4NA    P      ED Item Label L
     C                     MOVELWIRMTX    WJRMTX    P      ED Chilled_Froz
     C                     MOVELWIPTTX    WJPTTX    P      ED Unmarked Txt
     C                     Z-ADDWBATWG    WJHJWG           ED Product Net
     C                     Z-ADDYL0016    WJHKWG           ED Product Net
     C                     MOVELWIRNTX    WJRNTX    P      ED Product UOM
     C                     Z-ADDWBCBQT    WJAONX           ED Product Nbr
     C                     MOVELWIROTX    WJROTX    P      ED Product Pkg
     C                     MOVELWIORNA    WJORNA    P      ED Shipping Mar
     C                     Z-ADDWIAMNX    WJAMNX           ED Pieces per B
     C                     Z-ADDWIANNX    WJANNX           ED Bags per Uni
     C                     Z-ADDYL0017    WJAPNX           ED Total Nbr of
     C                     Z-ADDWIDKPR    WJDKPR           ED Product Unit
     C                     Z-ADDWIA9VL    WJA9VL           ED Producet Ext
     C                     MOVELWIC8SX    WJC8SX    P      ED Print Status
     C                     MOVELWIRATX    WJRATX    P      ED Plant Number
     C                     MOVELWIRBTX    WJRBTX    P      ED Language Xla
     C                     Z-ADDWIAJNX    WJAJNX           ED Consignee Ad
     C                     MOVELWIZWTX    WJZWTX    P      ED Date of Slau
     C                     MOVELWIZXTX    WJZXTX    P      ED HACCP Catego
     C                     MOVELWIZYTX    WJZYTX    P      ED Slaughter Da
     C                     MOVELWIZZTX    WJZZTX    P      ED Production D
     C                     MOVELWIK0U1    WJK0U1    P      ED Product UID
     C                     MOVELWIK1U1    WJK1U1    P      ED Language Xla
     C                     MOVELWIIJSC    WJIJSC    P      ED Unused Statu
     C                     MOVELWIIKSC    WJIKSC    P      ED Unused Statu
     C                     MOVELWIK2U1    WJK2U1    P      ED Harmonized T
     C                     Z-ADDWIW0DT    WJW0DT           ED Nbr of Packi
     C                     MOVELWIUVST    WJUVST    P      EDI Status 1
     C                     MOVELWIUWST    WJUWST    P      EDI Status 2
     C                     MOVELWIUXST    WJUXST    P      EDI Status 3
     C                     MOVELWIVSST    WJVSST    P      Record Status
     C                     Z-ADDWIAATM    WJAATM           Job Time
     C                     MOVELWIAYNA    WJAYNA    P      User Id
     C                     MOVELWIA0NA    WJA0NA    P      Job Name
     C                     Z-ADDWIAXDT    WJAXDT           Job Date
      *
      * Set PGM.*Record Data Changed flag
     C           QPDMS1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##PGM     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDMS1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@MSREW4                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDMSREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
      * Rtv/Chg Hdr Shpd Amts XF - Export Doc Order Dtl  * 
     C                     CALL 'POIYXFR'              90  Rtv/Chg Hdr Shp
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WJAIC3    WQ0014  30       Company Number
     C                     PARM WJC4NB    WQ0015  70       Order Number
     C                     PARM WJDGSX    WQ0016  1        ED Export Docum
     C                     PARM WJKXCD    WQ0017  6        Country Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POIYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Chg Confirm Order  RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WAAIC3           Company Number
     C                     Z-ADDP1C4NB    WAC4NB           Order Number
      * Establish starting position
     C           KRSSO     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Modified Flag is Shipped & Modified
     C           WAZ1ST    IFEQ 'M'                        *IF
     C                     MOVEL'M'       WUZ1ST           Modified Flag
     C                     ELSE
      * CASE: DB1.Scheduled Ship Date NE PAR.Actual Shipped Date
     C           WAAODT    IFNE P1GNDT                     *IF
     C                     MOVEL'M'       WUZ1ST           Modified Flag
     C                     ELSE
      * CASE: *OTHERWISE
      * VAL Over/Under Ship    RT - PD Order Detail  * 
     C                     EXSR SPRVGN
     C                     END                             *FI
     C                     END                             *FI
      * If modified flag is not 'M' then modified EQ 'S'
      * CASE: WRK.Modified Flag is Shipped & Modified
     C           WUZ1ST    IFEQ 'M'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'S'       WUZ1ST           Modified Flag
     C                     END                             *FI
      * CHG Evt,Sts,ShpDte,Mod CH - PD Order Header  * 
     C                     EXSR SQCHRC
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * VAL Over/Under Ship    RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    WUZ1ST           Modified Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSP01           Company Number
     C           *LIKE     DEFN WBC4NB    WQSP02           Order Number
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           Company Number
     C                     KFLD           WQSP02           Order Number
      * Setup key
     C                     Z-ADDWAAIC3    WQSP01           Company Number
     C                     Z-ADDWAC4NB    WQSP02           Order Number
      * Establish starting position
     C           KRSSP     SETLL@BGWKL1                    *
     C           KRSSP     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Work Over/Short Status is Over/Short
     C           WBR0ST    IFEQ 'O'                        *IF
     C           WBR0ST    OREQ 'S'
     C                     MOVEL'M'       WUZ1ST           Modified Flag
     C                     GOTO SPEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSP     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCHRC    BEGSR
      *================================================================
      * CHG Evt,Sts,ShpDte,Mod CH - PD Order Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0247  2        Order Type_Sale
     C                     Z-ADD*ZERO     WN0248  70       AR Customer Num
     C                     Z-ADD*ZERO     WN0249  70       Ship To Custome
     C                     MOVEL*BLANK    WN0250 30        Ship To Name
     C                     MOVEL*BLANK    WN0251 30        Ship To Address
     C                     MOVEL*BLANK    WN0252 30        Ship To Address
     C                     MOVEL*BLANK    WN0253 30        Ship To Address
     C                     MOVEL*BLANK    WN0254 20        Ship To City
     C                     MOVEL*BLANK    WN0255  2        Ship To State C
     C                     MOVEL*BLANK    WN0256 11        Ship To Zip_Pos
     C                     Z-ADD*ZERO     WN0257  70       Bill to Custome
     C                     MOVEL*BLANK    WN0258 30        Bill to Name
     C                     MOVEL*BLANK    WN0259 30        Bill to Address
     C                     MOVEL*BLANK    WN0260 30        Bill to Address
     C                     MOVEL*BLANK    WN0261 30        Bill to Address
     C                     MOVEL*BLANK    WN0262 20        Bill to City
     C                     MOVEL*BLANK    WN0263  2        Bill to State C
     C                     MOVEL*BLANK    WN0264 11        Bill to Zip_Pos
     C                     MOVEL*BLANK    WN0265 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0266  70       Order Date
     C                     Z-ADD*ZERO     WN0267  70       Requested Ship
     C                     Z-ADD*ZERO     WN0268  70       Cancel Date
     C                     MOVEL*BLANK    WN0269  2        Terms Code
     C                     MOVEL*BLANK    WN0270 40        Special Instruc
     C                     MOVEL*BLANK    WN0271 40        Special Instruc
     C                     MOVEL*BLANK    WN0272  3        Carrier Code
     C                     MOVEL*BLANK    WN0273  1        Comment Print A
     C                     MOVEL*BLANK    WN0274  1        Comment Print I
     C                     MOVEL*BLANK    WN0275  1        Comment Print P
     C                     MOVEL*BLANK    WN0276  1        Comment Print S
     C                     MOVEL*BLANK    WN0277  3        Reason Code
     C                     MOVEL*BLANK    WN0278  1        Order in Use
     C                     MOVEL*BLANK    WN0279  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0280  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0281 10        User Original E
     C                     Z-ADD*ZERO     WN0282  70       Date of Origina
     C                     Z-ADD*ZERO     WN0283 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0284 112       Order Weight To
     C                     MOVEL*BLANK    WN0285  1        Credit Hold
     C                     MOVEL*BLANK    WN0286  1        Production Hold
     C                     MOVEL*BLANK    WN0287  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0288  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0289  40       Requested Deliv
     C                     MOVEL*BLANK    WN0290  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0291 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0292  70       Load ID
     C                     Z-ADD*ZERO     WN0293  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0294 112       Rated Freight
     C                     MOVEL*BLANK    WN0295  1        LTL Flag
     C                     MOVEL*BLANK    WN0296  1        Price Audit
     C                     MOVEL*BLANK    WN0297  1        Price Status
     C                     MOVEL*BLANK    WN0298  2        Shipping Method
     C                     MOVEL*BLANK    WN0299  1        Export Status
     C                     MOVEL*BLANK    WN0300  1        Palletize
     C                     MOVEL*BLANK    WN0301  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0302  1        Slip Sheet
     C                     MOVEL*BLANK    WN0303  1        Age Code
     C                     Z-ADD*ZERO     WN0304  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0305  1        Load Type
     C                     Z-ADD*ZERO     WN0306  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0307  1        Load Plan Order
     C                     MOVEL*BLANK    WN0308  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0309  70       Resell Referenc
     C                     MOVEL*BLANK    WN0310 30        Special Comment
     C                     MOVEL*BLANK    WN0311 30        Special Comment
     C                     MOVEL*BLANK    WN0312  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0313  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0314  2        Manager Level C
     C                     MOVEL*BLANK    WN0315  3        VP Level Code
     C                     Z-ADD*ZERO     WN0316  70       Attach to Order
     C                     MOVEL*BLANK    WN0317  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0318  70       Invoice Number
     C                     MOVEL*BLANK    WN0319  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0320  70       Invoice Date
     C                     MOVEL*BLANK    WN0321  1        Trans Contol AS
     C                     Z-ADD*ZERO     WN0322 112       A_R order Value
     C                     MOVEL*BLANK    WN0323  1        Billing Activit
     C                     MOVEL*BLANK    WN0324  1        Block Order Fla
     C                     MOVEL*BLANK    WN0325  1        Order Certifica
     C                     Z-ADD*ZERO     WN0326 112       Invoice Order V
     C                     MOVEL*BLANK    WN0327  1        Process Sts for
     C                     MOVEL*BLANK    WN0328  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0329  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0330  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0331  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0332  1        Email Cust On O
     C                     MOVEL*BLANK    WN0333  1        Order Emailed
     C                     MOVEL*BLANK    WN0334  1        Export Docs Go
     C                     MOVEL*BLANK    WN0335  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0336  1        Broker Order St
     C                     MOVEL*BLANK    WN0337  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0338  2        Order Requires
     C                     MOVEL*BLANK    WN0339  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0340  2        Export USDA App
     C                     MOVEL*BLANK    WN0341  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0342  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0343  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0344  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0345  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0346  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0347  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0348  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0349  60       Time of Origina
     C                     Z-ADD*ZERO     WN0350  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0351  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0352  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0353 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0354 112       Act Non_Ref Frt
     C                     Z-ADD*ZERO     WN0355 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0356 112       OH Total Non_Re
     C                     Z-ADD*ZERO     WN0357 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0358  70       Claim Number
     C                     MOVEL*BLANK    WN0359  1        EDI Status 1
     C                     MOVEL*BLANK    WN0360  1        EDI Status 2
     C                     MOVEL*BLANK    WN0361  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0362  60       Job Time
     C                     MOVEL*BLANK    WN0363 10        User Id
     C                     MOVEL*BLANK    WN0364 10        Job Name
     C                     Z-ADD*ZERO     WN0365  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWAAIC3    WKAIC3           Company Number
     C                     Z-ADDWAC4NB    WKC4NB           Order Number
      *
     C           KLCHSQ    KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKC4NB           Order Number
     C           KLCHSQ    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YDRDCS
      * Move non-key fields to @BECPFJ
     C                     Z-ADDP1GNDT    WKGNDT           Actual Shipped
     C                     MOVEL'R'       WKGWST    P      Header Status
     C                     MOVELWAGXST    WKGXST    P      Header Status L
     C                     MOVEL'04'      WKJPCD    P      Event Code
     C                     MOVELWUZ1ST    WKZ1ST    P      Modified Flag
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WKAATM           Job Time
     C                     MOVEL##USR     WKAYNA           User Id
     C                     MOVEL##PGM     WKA0NA           Job Name
     C                     Z-ADD##JDT     WKAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - Order Header TRG  * 
     C                     CLEARPARC
     C                     Z-ADDWKAIC3    PAAIC3           Company Number
     C                     Z-ADDWKC4NB    PAC4NB           Order Number
     C                     MOVELWKJNCD    PAJNCD    P      Order Type_Sale
     C                     Z-ADDWKANC7    PAANC7           AR Customer Num
     C                     Z-ADDWKBKC7    PABKC7           Ship To Custome
     C                     MOVELWKBRTX    PABRTX    P      Ship To Name
     C                     MOVELWKHMNA    PAHMNA    P      Ship To Address
     C                     MOVELWKHONA    PAHONA    P      Ship To Address
     C                     MOVELWKHPNA    PAHPNA    P      Ship To Address
     C                     MOVELWKHNNA    PAHNNA    P      Ship To City
     C                     MOVELWKDBCD    PADBCD    P      Ship To State C
     C                     MOVELWKCKTX    PACKTX    P      Ship To Zip_Pos
     C                     Z-ADDWKB0C7    PAB0C7           Bill to Custome
     C                     MOVELWKAETX    PAAETX    P      Bill to Name
     C                     MOVELWKB1NA    PAB1NA    P      Bill to Address
     C                     MOVELWKB3NA    PAB3NA    P      Bill to Address
     C                     MOVELWKB4NA    PAB4NA    P      Bill to Address
     C                     MOVELWKB2NA    PAB2NA    P      Bill to City
     C                     MOVELWKBHCD    PABHCD    P      Bill to State C
     C                     MOVELWKC8TX    PAC8TX    P      Bill to Zip_Pos
     C                     MOVELWKBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDWKA0DT    PAA0DT           Order Date
     C                     Z-ADDWKA5DT    PAA5DT           Requested Ship
     C                     Z-ADDWKGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDWKACDT    PAACDT           Cancel Date
     C                     MOVELWKAQCD    PAAQCD    P      Terms Code
     C                     MOVELWKB6NA    PAB6NA    P      Special Instruc
     C                     MOVELWKBYNA    PABYNA    P      Special Instruc
     C                     MOVELWKBZNA    PABZNA    P      Carrier Code
     C                     MOVELWKGTST    PAGTST    P      Comment Print A
     C                     MOVELWKGVST    PAGVST    P      Comment Print I
     C                     MOVELWKGUST    PAGUST    P      Comment Print P
     C                     MOVELWKQFST    PAQFST    P      Comment Print S
     C                     MOVELWKCQCD    PACQCD    P      Reason Code
     C                     MOVELWKGJST    PAGJST    P      Order in Use
     C                     MOVELWKGWST    PAGWST    P      Header Status
     C                     MOVELWKGXST    PAGXST    P      Header Status L
     C                     MOVELWKGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDWKAODT    PAAODT           Scheduled Ship
     C                     MOVELWKAIVN    PAAIVN    P      User Original E
     C                     Z-ADDWKCXDT    PACXDT           Date of Origina
     C                     Z-ADDWKJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDWKA1WG    PAA1WG           Order Weight To
     C                     MOVELWKXIST    PAXIST    P      Credit Hold
     C                     MOVELWKXJST    PAXJST    P      Production Hold
     C                     MOVELWKXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDWKEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDWKAFTM    PAAFTM           Requested Deliv
     C                     MOVELWKE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELWKE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDWKRMNB    PARMNB           Load ID
     C                     Z-ADDWKTBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDWKR1NB    PAR1NB           Rated Freight
     C                     MOVELWKPJST    PAPJST    P      LTL Flag
     C                     MOVELWKU0ST    PAU0ST    P      Price Audit
     C                     MOVELWKU1ST    PAU1ST    P      Price Status
     C                     MOVELWKQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELWKU2ST    PAU2ST    P      Export Status
     C                     MOVELWKVEST    PAVEST    P      Palletize
     C                     MOVELWKVFST    PAVFST    P      Shrink Wrap
     C                     MOVELWKVGST    PAVGST    P      Slip Sheet
     C                     MOVELWKRPCD    PARPCD    P      Age Code
     C                     Z-ADDWKRNNB    PARNNB           Reefer Temperat
     C                     MOVELWKVDST    PAVDST    P      Load Type
     C                     Z-ADDWKATIN    PAATIN           Attach to Invoi
     C                     MOVELWKU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELWKU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDWKRSRN    PARSRN           Resell Referenc
     C                     MOVELWKMHNA    PAMHNA    P      Special Comment
     C                     MOVELWKMINA    PAMINA    P      Special Comment
     C                     MOVELWKWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELWKR4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELWKBFCD    PABFCD    P      Manager Level C
     C                     MOVELWKQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDWKT3NB    PAT3NB           Attach to Order
     C                     MOVELWKSICD    PASICD    P      Reason for Pric
     C                     Z-ADDWKCONB    PACONB           Invoice Number
     C                     MOVELWKCEST    PACEST    P      Invoice Suffix
     C                     Z-ADDWKAWDT    PAAWDT           Invoice Date
     C                     MOVELWKJPCD    PAJPCD    P      Event Code
     C                     MOVELWKXUST    PAXUST    P      Trans Contol AS
     C                     MOVELWKZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDWKVRVA    PAVRVA           A_R order Value
     C                     MOVELWKOBST    PAOBST    P      Billing Activit
     C                     MOVELWKBCST    PABCST    P      Block Order Fla
     C                     MOVELWKBDST    PABDST    P      Order Certifica
     C                     Z-ADDWKB7VL    PAB7VL           Invoice Order V
     C                     MOVELWKGASX    PAGASX    P      Process Sts for
     C                     MOVELWKGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELWKGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELWKGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELWKFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELWKFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELWKFPSX    PAFPSX    P      Order Emailed
     C                     MOVELWKFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELWKFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELWKFSSX    PAFSSX    P      Broker Order St
     C                     MOVELWKFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELWKFUSX    PAFUSX    P      Order Requires
     C                     MOVELWKFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELWKFWSX    PAFWSX    P      Export USDA App
     C                     MOVELWKFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELWKFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDWKNODT    PANODT           OH Appt Confirm
     C                     Z-ADDWKNPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDWKNQDT    PANQDT           Load Actual Shi
     C                     Z-ADDWKNRDT    PANRDT           Load BOL Comple
     C                     Z-ADDWKNSDT    PANSDT           Load Truck Depa
     C                     Z-ADDWKBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDWKBQTM    PABQTM           Time of Origina
     C                     Z-ADDWKBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDWKBSTM    PABSTM           Load BOL Comple
     C                     Z-ADDWKBTTM    PABTTM           Load Truck Depa
     C                     Z-ADDWKH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDWKH1NX    PAH1NX           Act Non_Ref Frt
     C                     Z-ADDWKH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDWKH3NX    PAH3NX           OH Total Non_Re
     C                     Z-ADDWKH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDWKC0C7    PAC0C7           Claim Number
     C                     MOVELWKUVST    PAUVST    P      EDI Status 1
     C                     MOVELWKUWST    PAUWST    P      EDI Status 2
     C                     MOVELWKUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDWKAATM    PAAATM           Job Time
     C                     MOVELWKAYNA    PAAYNA    P      User Id
     C                     MOVELWKA0NA    PAA0NA    P      Job Name
     C                     Z-ADDWKAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Chg for Shipping  RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLC4NB           Order Number
      * Setup key
     C                     Z-ADDWBAIC3    WLAIC3           Company Number
     C                     Z-ADDWBC4NB    WLC4NB           Order Number
      * Establish starting position
     C           KRSSR     CHAIN@AMREJF              90    *
      * Data record not found
     C   90                MOVEL'USR3697' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CHG Order Header Exten CH - Order Header Extension  * 
     C                     EXSR SSCHRC
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCHRC    BEGSR
      *================================================================
      * CHG Order Header Exten CH - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @AMREJE
     C                     Z-ADDWLAIC3    WMAIC3           Company Number
     C                     Z-ADDWLC4NB    WMC4NB           Order Number
      *
     C           KLCHSS    KLIST
     C                     KFLD           WMAIC3           Company Number
     C                     KFLD           WMC4NB           Order Number
     C           KLCHSS    CHAIN@AMREJE              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * USER: Processing if Data record not found
      * CRT Existing OHE       CR - Order Header Extension  * 
     C                     EXSR STCRRC
     C           W0RTN     IFNE *BLANK                     IF
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PMAMREL0'MDACP
     C                     MOVEL'@AMREJE' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     ENDIF
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPMAM1    YERDCS
      * Move non-key fields to @AMREJE
     C                     Z-ADDWLRMNB    WMRMNB           Load ID
     C                     Z-ADDWLRUNB    WMRUNB           Stop_Drop Seque
     C                     MOVELWLXACD    WMXACD    P      Shipping Line
     C                     MOVELWLOANA    WMOANA    P      Port Delv Termi
     C                     MOVELWLHBAA    WMHBAA    P      OHE City
     C                     MOVELWLJ0T1    WMJ0T1    P      OHE Vessel_Airl
     C                     MOVELWLGENY    WMGENY    P      OHE Voyage_Flig
     C                     MOVELWLJ1T1    WMJ1T1    P      OHE Booking Num
     C                     MOVELWLHCAA    WMHCAA    P      OHE Discharge P
     C                     Z-ADDWLQWDT    WMQWDT           OHE Sail_Flight
     C                     Z-ADDWLQXDT    WMQXDT           OHE Port Cut Da
     C                     Z-ADDWLQYDT    WMQYDT           OHE Arrival Dat
     C                     MOVELWLHDAA    WMHDAA    P      OHE Late Delive
     C                     MOVEL'S'       WMCCTX    P      OHE Ship Status
     C                     MOVELWLJ2T1    WMJ2T1    P      OHE Container N
     C                     MOVELWLRLNA    WMRLNA    P      OHE Comment 1
     C                     MOVELWLRMNA    WMRMNA    P      OHE Comment 2
     C                     Z-ADDWLGINY    WMGINY           OHE Unused Numb
     C                     Z-ADDWLGFNY    WMGFNY           OHE Unused Numb
     C                     Z-ADDWLGGNY    WMGGNY           OHE Unused Numb
     C                     Z-ADDWLGHNY    WMGHNY           OHE Unused Numb
     C                     Z-ADDWLHEVL    WMHEVL           OHE HPB RIN Equ
     C                     Z-ADDWLHFVL    WMHFVL           OHE HPB RIN Pri
     C                     Z-ADDWLHGVL    WMHGVL           Transload Termi
     C                     Z-ADDWLQZDT    WMQZDT           OHE Est Arrv at
     C                     Z-ADDWLQ0DT    WMQ0DT           OHE Backhaul ET
     C                     Z-ADDWLQ1DT    WMQ1DT           OHE Port_Pier P
     C                     Z-ADDWLQ2DT    WMQ2DT           OHE Actual Ship
     C                     MOVELWLC2TX    WMC2TX    P      OHE Carrier SCA
     C                     MOVELWLC3TX    WMC3TX    P      OHE Spot Buy
     C                     MOVELWLC6TX    WMC6TX    P      OHE PO ACK Flag
     C                     MOVELWLCHTX    WMCHTX    P      OHE Override Ty
     C                     MOVELWLCITX    WMCITX    P      OHE Backhaul St
     C                     MOVELWLCLTX    WMCLTX    P      OHE Backhaul ET
     C                     MOVELWLB4TX    WMB4TX    P      OHE Load Haul T
     C                     MOVELWLCUTX    WMCUTX    P      OHE Backhaul Ca
     C                     MOVELWLCVTX    WMCVTX    P      OHE Bookings Co
     C                     MOVELWLB9TX    WMB9TX    P      OHE EDI Error R
     C                     MOVELWLJWSC    WMJWSC    P      OHE EDI Error R
     C                     Z-ADDWLITNY    WMITNY           HPB COA Batch N
     C                     MOVELWLLMT1    WMLMT1    P      Delivery P_O  N
     C                     MOVELWLLWAA    WMLWAA    P      OHE Intended fo
     C                     MOVELWLFVST    WMFVST    P      OHE EDI 943 Act
     C                     MOVELWLF0ST    WMF0ST    P      OHE EDI 944 Act
     C                     MOVELWLF2ST    WMF2ST    P      OHE EDI 940 Act
     C                     MOVELWLF3ST    WMF3ST    P      OHE EDI 945 Act
     C                     MOVELWLJUSC    WMJUSC    P      OHE EDI 856 Act
     C                     MOVELWLJVSC    WMJVSC    P      OHE EDI 824 Act
     C                     MOVELWLV3T1    WMV3T1    P      OHE Transload S
     C                     MOVELWLV4T1    WMV4T1    P      OHE Abs Rate Ov
     C                     MOVELWLV5T1    WMV5T1    P      OHE Appt Confir
     C                     MOVELWLV6T1    WMV6T1    P      OHE Backhaul Co
     C                     MOVELWLV7T1    WMV7T1    P      OHE Backhaul Ch
     C                     MOVELWLV8T1    WMV8T1    P      OHE Transload C
     C                     MOVELWLV9T1    WMV9T1    P      OHE Pier Pass I
     C                     MOVELWLWAT1    WMWAT1    P      OHE Carrier Nm
     C                     MOVELWLWBT1    WMWBT1    P      OHE Appt Confir
     C                     MOVELWLWCT1    WMWCT1    P      OHE Backhaul Co
     C                     MOVELWLWDT1    WMWDT1    P      Letter of Credi
     C                     Z-ADDWLQJNY    WMQJNY           OHE Backhaul Re
     C                     Z-ADDWLQKNY    WMQKNY           LD Stop_Drop
     C                     Z-ADDWLQLNY    WMQLNY           OHE Unused Numb
     C                     Z-ADDWLP8NY    WMP8NY           OHE Pier Pass F
     C                     Z-ADDWLP9NY    WMP9NY           OHE Port Check
     C                     Z-ADDWLQANY    WMQANY           OHE Port Cut Ti
     C                     Z-ADDWLQCNY    WMQCNY           OHE Backhaul Tr
     C                     Z-ADDWLQDNY    WMQDNY           OHE Load Sched
     C                     Z-ADDWLQENY    WMQENY           Original Appoin
     C                     Z-ADDWLQFNY    WMQFNY           Original Appoin
     C                     Z-ADDWLQGNY    WMQGNY           OHE PowerPro Lo
     C                     Z-ADDWLQHNY    WMQHNY           OHE PowerPro Lo
     C                     Z-ADDWLQINY    WMQINY           OHE Unused Nume
     C                     Z-ADDWLQMNY    WMQMNY           OHE Orig ABS Fr
     C                     MOVELWLMYU1    WMMYU1    P      OHE Genset Numb
     C                     MOVELWLJXSC    WMJXSC    P      OHE Email BOL_S
     C                     MOVELWLJYSC    WMJYSC    P      OHE EDI Order A
     C                     MOVELWLJZSC    WMJZSC    P      OHE EDI 601 Act
     C                     MOVELWLJ0SC    WMJ0SC    P      OHE Unused Stat
     C                     MOVELWLMZU1    WMMZU1    P      OHE Unused Text
     C                     MOVELWLM0U1    WMM0U1    P      OHE Unused Text
     C                     MOVELWLM1U1    WMM1U1    P      OHE Customer Ve
     C                     MOVELWLM2U1    WMM2U1    P      OHE EDI 824 AES
     C                     MOVELWLM3U1    WMM3U1    P      OHE Unused Text
     C                     Z-ADDWLW5DT    WMW5DT           OHE Unused Date
     C                     Z-ADDWLW6DT    WMW6DT           OHE Unused Date
     C                     MOVELWLUVST    WMUVST    P      EDI Status 1
     C                     MOVELWLUWST    WMUWST    P      EDI Status 2
     C                     MOVELWLUXST    WMUXST    P      EDI Status 3
     C                     MOVELWLVSST    WMVSST    P      Record Status
     C                     Z-ADDWLAATM    WMAATM           Job Time
     C                     MOVELWLAYNA    WMAYNA    P      User Id
     C                     MOVELWLA0NA    WMA0NA    P      Job Name
     C                     Z-ADDWLAXDT    WMAXDT           Job Date
      *
      * Set PGM.*Record Data Changed flag
     C           QPMAM1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WMAATM           Job Time
     C                     Z-ADD##JDT     WMAXDT           Job Date
     C                     MOVEL##PGM     WMA0NA           Job Name
     C                     MOVEL##USR     WMAYNA           User Id
      * Set PGM.*Record Data Changed flag
     C           QPMAM1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@AMREJE                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPMAMREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STCRRC    BEGSR
      *================================================================
      * CRT Existing OHE       CR - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AMREJE
     C                     Z-ADDWLAIC3    WMAIC3           Company Number
     C                     Z-ADDWLC4NB    WMC4NB           Order Number
     C                     Z-ADDWLRMNB    WMRMNB           Load ID
     C                     Z-ADDWLRUNB    WMRUNB           Stop_Drop Seque
     C                     MOVELWLXACD    WMXACD           Shipping Line
     C                     MOVELWLOANA    WMOANA           Port Delv Termi
     C                     MOVELWLHBAA    WMHBAA           OHE City
     C                     MOVELWLJ0T1    WMJ0T1           OHE Vessel_Airl
     C                     MOVELWLGENY    WMGENY           OHE Voyage_Flig
     C                     MOVELWLJ1T1    WMJ1T1           OHE Booking Num
     C                     MOVELWLHCAA    WMHCAA           OHE Discharge P
     C                     Z-ADDWLQWDT    WMQWDT           OHE Sail_Flight
     C                     Z-ADDWLQXDT    WMQXDT           OHE Port Cut Da
     C                     Z-ADDWLQYDT    WMQYDT           OHE Arrival Dat
     C                     MOVELWLHDAA    WMHDAA           OHE Late Delive
     C                     MOVEL'S'       WMCCTX           OHE Ship Status
     C                     MOVELWLJ2T1    WMJ2T1           OHE Container N
     C                     MOVELWLRLNA    WMRLNA           OHE Comment 1
     C                     MOVELWLRMNA    WMRMNA           OHE Comment 2
     C                     Z-ADDWLGINY    WMGINY           OHE Unused Numb
     C                     Z-ADDWLGFNY    WMGFNY           OHE Unused Numb
     C                     Z-ADDWLGGNY    WMGGNY           OHE Unused Numb
     C                     Z-ADDWLGHNY    WMGHNY           OHE Unused Numb
     C                     Z-ADDWLHEVL    WMHEVL           OHE HPB RIN Equ
     C                     Z-ADDWLHFVL    WMHFVL           OHE HPB RIN Pri
     C                     Z-ADDWLHGVL    WMHGVL           Transload Termi
     C                     Z-ADDWLQZDT    WMQZDT           OHE Est Arrv at
     C                     Z-ADDWLQ0DT    WMQ0DT           OHE Backhaul ET
     C                     Z-ADDWLQ1DT    WMQ1DT           OHE Port_Pier P
     C                     Z-ADDWLQ2DT    WMQ2DT           OHE Actual Ship
     C                     MOVELWLC2TX    WMC2TX           OHE Carrier SCA
     C                     MOVELWLC3TX    WMC3TX           OHE Spot Buy
     C                     MOVELWLC6TX    WMC6TX           OHE PO ACK Flag
     C                     MOVELWLCHTX    WMCHTX           OHE Override Ty
     C                     MOVELWLCITX    WMCITX           OHE Backhaul St
     C                     MOVELWLCLTX    WMCLTX           OHE Backhaul ET
     C                     MOVELWLB4TX    WMB4TX           OHE Load Haul T
     C                     MOVELWLCUTX    WMCUTX           OHE Backhaul Ca
     C                     MOVELWLCVTX    WMCVTX           OHE Bookings Co
     C                     MOVELWLB9TX    WMB9TX           OHE EDI Error R
     C                     MOVELWLJWSC    WMJWSC           OHE EDI Error R
     C                     Z-ADDWLITNY    WMITNY           HPB COA Batch N
     C                     MOVELWLLMT1    WMLMT1           Delivery P_O  N
     C                     MOVELWLLWAA    WMLWAA           OHE Intended fo
     C                     MOVELWLFVST    WMFVST           OHE EDI 943 Act
     C                     MOVELWLF0ST    WMF0ST           OHE EDI 944 Act
     C                     MOVELWLF2ST    WMF2ST           OHE EDI 940 Act
     C                     MOVELWLF3ST    WMF3ST           OHE EDI 945 Act
     C                     MOVELWLJUSC    WMJUSC           OHE EDI 856 Act
     C                     MOVELWLJVSC    WMJVSC           OHE EDI 824 Act
     C                     MOVELWLV3T1    WMV3T1           OHE Transload S
     C                     MOVELWLV4T1    WMV4T1           OHE Abs Rate Ov
     C                     MOVELWLV5T1    WMV5T1           OHE Appt Confir
     C                     MOVELWLV6T1    WMV6T1           OHE Backhaul Co
     C                     MOVELWLV7T1    WMV7T1           OHE Backhaul Ch
     C                     MOVELWLV8T1    WMV8T1           OHE Transload C
     C                     MOVELWLV9T1    WMV9T1           OHE Pier Pass I
     C                     MOVELWLWAT1    WMWAT1           OHE Carrier Nm
     C                     MOVELWLWBT1    WMWBT1           OHE Appt Confir
     C                     MOVELWLWCT1    WMWCT1           OHE Backhaul Co
     C                     MOVELWLWDT1    WMWDT1           Letter of Credi
     C                     Z-ADDWLQJNY    WMQJNY           OHE Backhaul Re
     C                     Z-ADDWLQKNY    WMQKNY           LD Stop_Drop
     C                     Z-ADDWLQLNY    WMQLNY           OHE Unused Numb
     C                     Z-ADDWLP8NY    WMP8NY           OHE Pier Pass F
     C                     Z-ADDWLP9NY    WMP9NY           OHE Port Check
     C                     Z-ADDWLQANY    WMQANY           OHE Port Cut Ti
     C                     Z-ADDWLQCNY    WMQCNY           OHE Backhaul Tr
     C                     Z-ADDWLQDNY    WMQDNY           OHE Load Sched
     C                     Z-ADDWLQENY    WMQENY           Original Appoin
     C                     Z-ADDWLQFNY    WMQFNY           Original Appoin
     C                     Z-ADDWLQGNY    WMQGNY           OHE PowerPro Lo
     C                     Z-ADDWLQHNY    WMQHNY           OHE PowerPro Lo
     C                     Z-ADDWLQINY    WMQINY           OHE Unused Nume
     C                     Z-ADDWLQMNY    WMQMNY           OHE Orig ABS Fr
     C                     MOVELWLMYU1    WMMYU1           OHE Genset Numb
     C                     MOVELWLJXSC    WMJXSC           OHE Email BOL_S
     C                     MOVELWLJYSC    WMJYSC           OHE EDI Order A
     C                     MOVELWLJZSC    WMJZSC           OHE EDI 601 Act
     C                     MOVELWLJ0SC    WMJ0SC           OHE Unused Stat
     C                     MOVELWLMZU1    WMMZU1           OHE Unused Text
     C                     MOVELWLM0U1    WMM0U1           OHE Unused Text
     C                     MOVELWLM1U1    WMM1U1           OHE Customer Ve
     C                     MOVELWLM2U1    WMM2U1           OHE EDI 824 AES
     C                     MOVELWLM3U1    WMM3U1           OHE Unused Text
     C                     Z-ADDWLW5DT    WMW5DT           OHE Unused Date
     C                     Z-ADDWLW6DT    WMW6DT           OHE Unused Date
     C                     MOVELWLUVST    WMUVST           EDI Status 1
     C                     MOVELWLUWST    WMUWST           EDI Status 2
     C                     MOVELWLUXST    WMUXST           EDI Status 3
     C                     MOVELWLVSST    WMVSST           Record Status
     C                     Z-ADDWLAATM    WMAATM           Job Time
     C                     MOVELWLAYNA    WMAYNA           User Id
     C                     MOVELWLA0NA    WMA0NA           Job Name
     C                     Z-ADDWLAXDT    WMAXDT           Job Date
      *
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WMAATM           Job Time
     C                     Z-ADD##JDT     WMAXDT           Job Date
     C                     MOVEL##PGM     WMA0NA           Job Name
     C                     MOVEL##USR     WMAYNA           User Id
     C           KLCRST    KLIST
     C                     KFLD           WMAIC3           Company Number
     C                     KFLD           WMC4NB           Order Number
      * Check for duplicate primary key
     C           KLCRST    SETLL@AMREJE                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3698' W0RTN   7
      * Send message 'Order Header Extension EX'
     C                     MOVEL'USR3698' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C                     WRITE@AMREJE                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * RTV Carrier, Load      RT - OP Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WAAIC3           Company Number
     C                     Z-ADDP1C4NB    WAC4NB           Order Number
      * Establish starting position
     C           KRSSU     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    P3BZNA           Carrier Code
     C                     Z-ADD*ZERO     P3RMNB           Load ID
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWABZNA    P3BZNA           Carrier Code
     C                     Z-ADDWARMNB    P3RMNB           Load ID
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * RTV Chg ord tot/wgt    RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WAAIC3           Company Number
     C                     Z-ADDP1C4NB    WAC4NB           Order Number
      * Establish starting position
     C           KRSSV     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CHG Ord Val/Wgt,Prt St CH - Order Header TRG  * 
     C                     EXSR SWCHRC
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWCHRC    BEGSR
      *================================================================
      * CHG Ord Val/Wgt,Prt St CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0366  2        Order Type_Sale
     C                     Z-ADD*ZERO     WN0367  70       AR Customer Num
     C                     Z-ADD*ZERO     WN0368  70       Ship To Custome
     C                     MOVEL*BLANK    WN0369 30        Ship To Name
     C                     MOVEL*BLANK    WN0370 30        Ship To Address
     C                     MOVEL*BLANK    WN0371 30        Ship To Address
     C                     MOVEL*BLANK    WN0372 30        Ship To Address
     C                     MOVEL*BLANK    WN0373 20        Ship To City
     C                     MOVEL*BLANK    WN0374  2        Ship To State C
     C                     MOVEL*BLANK    WN0375 11        Ship To Zip_Pos
     C                     Z-ADD*ZERO     WN0376  70       Bill to Custome
     C                     MOVEL*BLANK    WN0377 30        Bill to Name
     C                     MOVEL*BLANK    WN0378 30        Bill to Address
     C                     MOVEL*BLANK    WN0379 30        Bill to Address
     C                     MOVEL*BLANK    WN0380 30        Bill to Address
     C                     MOVEL*BLANK    WN0381 20        Bill to City
     C                     MOVEL*BLANK    WN0382  2        Bill to State C
     C                     MOVEL*BLANK    WN0383 11        Bill to Zip_Pos
     C                     MOVEL*BLANK    WN0384 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0385  70       Order Date
     C                     Z-ADD*ZERO     WN0386  70       Requested Ship
     C                     Z-ADD*ZERO     WN0387  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0388  70       Cancel Date
     C                     MOVEL*BLANK    WN0389  2        Terms Code
     C                     MOVEL*BLANK    WN0390 40        Special Instruc
     C                     MOVEL*BLANK    WN0391 40        Special Instruc
     C                     MOVEL*BLANK    WN0392  3        Carrier Code
     C                     MOVEL*BLANK    WN0393  1        Comment Print A
     C                     MOVEL*BLANK    WN0394  1        Comment Print I
     C                     MOVEL*BLANK    WN0395  1        Comment Print P
     C                     MOVEL*BLANK    WN0396  1        Comment Print S
     C                     MOVEL*BLANK    WN0397  3        Reason Code
     C                     MOVEL*BLANK    WN0398  1        Order in Use
     C                     MOVEL*BLANK    WN0399  1        Header Status
     C                     MOVEL*BLANK    WN0400  1        Header Status L
     C                     Z-ADD*ZERO     WN0401  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0402 10        User Original E
     C                     Z-ADD*ZERO     WN0403  70       Date of Origina
     C                     MOVEL*BLANK    WN0404  1        Credit Hold
     C                     MOVEL*BLANK    WN0405  1        Production Hold
     C                     MOVEL*BLANK    WN0406  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0407  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0408  40       Requested Deliv
     C                     MOVEL*BLANK    WN0409  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0410 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0411  70       Load ID
     C                     Z-ADD*ZERO     WN0412  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0413 112       Rated Freight
     C                     MOVEL*BLANK    WN0414  1        LTL Flag
     C                     MOVEL*BLANK    WN0415  1        Price Audit
     C                     MOVEL*BLANK    WN0416  1        Price Status
     C                     MOVEL*BLANK    WN0417  2        Shipping Method
     C                     MOVEL*BLANK    WN0418  1        Export Status
     C                     MOVEL*BLANK    WN0419  1        Palletize
     C                     MOVEL*BLANK    WN0420  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0421  1        Slip Sheet
     C                     MOVEL*BLANK    WN0422  1        Age Code
     C                     Z-ADD*ZERO     WN0423  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0424  1        Load Type
     C                     Z-ADD*ZERO     WN0425  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0426  1        Load Plan Order
     C                     MOVEL*BLANK    WN0427  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0428  70       Resell Referenc
     C                     MOVEL*BLANK    WN0429 30        Special Comment
     C                     MOVEL*BLANK    WN0430 30        Special Comment
     C                     MOVEL*BLANK    WN0431  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0432  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0433  2        Manager Level C
     C                     MOVEL*BLANK    WN0434  3        VP Level Code
     C                     Z-ADD*ZERO     WN0435  70       Attach to Order
     C                     MOVEL*BLANK    WN0436  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0437  70       Invoice Number
     C                     MOVEL*BLANK    WN0438  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0439  70       Invoice Date
     C                     MOVEL*BLANK    WN0440  2        Event Code
     C                     MOVEL*BLANK    WN0441  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0442  1        Modified Flag
     C                     Z-ADD*ZERO     WN0443 112       A_R order Value
     C                     MOVEL*BLANK    WN0444  1        Billing Activit
     C                     MOVEL*BLANK    WN0445  1        Block Order Fla
     C                     MOVEL*BLANK    WN0446  1        Order Certifica
     C                     Z-ADD*ZERO     WN0447 112       Invoice Order V
     C                     MOVEL*BLANK    WN0448  1        Process Sts for
     C                     MOVEL*BLANK    WN0449  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0450  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0451  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0452  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0453  1        Email Cust On O
     C                     MOVEL*BLANK    WN0454  1        Order Emailed
     C                     MOVEL*BLANK    WN0455  1        Export Docs Go
     C                     MOVEL*BLANK    WN0456  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0457  1        Broker Order St
     C                     MOVEL*BLANK    WN0458  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0459  2        Order Requires
     C                     MOVEL*BLANK    WN0460  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0461  2        Export USDA App
     C                     MOVEL*BLANK    WN0462  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0463  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0464  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0465  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0466  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0467  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0468  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0469  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0470  60       Time of Origina
     C                     Z-ADD*ZERO     WN0471  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0472  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0473  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0474 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0475 112       Act Non_Ref Frt
     C                     Z-ADD*ZERO     WN0476 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0477 112       OH Total Non_Re
     C                     Z-ADD*ZERO     WN0478 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0479  70       Claim Number
     C                     MOVEL*BLANK    WN0480  1        EDI Status 1
     C                     MOVEL*BLANK    WN0481  1        EDI Status 2
     C                     MOVEL*BLANK    WN0482  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0483  60       Job Time
     C                     MOVEL*BLANK    WN0484 10        User Id
     C                     MOVEL*BLANK    WN0485 10        Job Name
     C                     Z-ADD*ZERO     WN0486  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWAAIC3    WKAIC3           Company Number
     C                     Z-ADDWAC4NB    WKC4NB           Order Number
      *
     C           KLCHSW    KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKC4NB           Order Number
     C           KLCHSW    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SWEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YFRDCS
      * Move non-key fields to @BECPFJ
     C                     MOVEL*BLANK    WKGYST    P      Order Type Prin
     C                     Z-ADDP3JZVA    WKJZVA           Order Value Tot
     C                     Z-ADDP3A1WG    WKA1WG           Order Weight To
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WKAATM           Job Time
     C                     MOVEL##USR     WKAYNA           User Id
     C                     MOVEL##PGM     WKA0NA           Job Name
     C                     Z-ADD##JDT     WKAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPARC
     C                     Z-ADDWKAIC3    PAAIC3           Company Number
     C                     Z-ADDWKC4NB    PAC4NB           Order Number
     C                     MOVELWKJNCD    PAJNCD    P      Order Type_Sale
     C                     Z-ADDWKANC7    PAANC7           AR Customer Num
     C                     Z-ADDWKBKC7    PABKC7           Ship To Custome
     C                     MOVELWKBRTX    PABRTX    P      Ship To Name
     C                     MOVELWKHMNA    PAHMNA    P      Ship To Address
     C                     MOVELWKHONA    PAHONA    P      Ship To Address
     C                     MOVELWKHPNA    PAHPNA    P      Ship To Address
     C                     MOVELWKHNNA    PAHNNA    P      Ship To City
     C                     MOVELWKDBCD    PADBCD    P      Ship To State C
     C                     MOVELWKCKTX    PACKTX    P      Ship To Zip_Pos
     C                     Z-ADDWKB0C7    PAB0C7           Bill to Custome
     C                     MOVELWKAETX    PAAETX    P      Bill to Name
     C                     MOVELWKB1NA    PAB1NA    P      Bill to Address
     C                     MOVELWKB3NA    PAB3NA    P      Bill to Address
     C                     MOVELWKB4NA    PAB4NA    P      Bill to Address
     C                     MOVELWKB2NA    PAB2NA    P      Bill to City
     C                     MOVELWKBHCD    PABHCD    P      Bill to State C
     C                     MOVELWKC8TX    PAC8TX    P      Bill to Zip_Pos
     C                     MOVELWKBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDWKA0DT    PAA0DT           Order Date
     C                     Z-ADDWKA5DT    PAA5DT           Requested Ship
     C                     Z-ADDWKGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDWKACDT    PAACDT           Cancel Date
     C                     MOVELWKAQCD    PAAQCD    P      Terms Code
     C                     MOVELWKB6NA    PAB6NA    P      Special Instruc
     C                     MOVELWKBYNA    PABYNA    P      Special Instruc
     C                     MOVELWKBZNA    PABZNA    P      Carrier Code
     C                     MOVELWKGTST    PAGTST    P      Comment Print A
     C                     MOVELWKGVST    PAGVST    P      Comment Print I
     C                     MOVELWKGUST    PAGUST    P      Comment Print P
     C                     MOVELWKQFST    PAQFST    P      Comment Print S
     C                     MOVELWKCQCD    PACQCD    P      Reason Code
     C                     MOVELWKGJST    PAGJST    P      Order in Use
     C                     MOVELWKGWST    PAGWST    P      Header Status
     C                     MOVELWKGXST    PAGXST    P      Header Status L
     C                     MOVELWKGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDWKAODT    PAAODT           Scheduled Ship
     C                     MOVELWKAIVN    PAAIVN    P      User Original E
     C                     Z-ADDWKCXDT    PACXDT           Date of Origina
     C                     Z-ADDWKJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDWKA1WG    PAA1WG           Order Weight To
     C                     MOVELWKXIST    PAXIST    P      Credit Hold
     C                     MOVELWKXJST    PAXJST    P      Production Hold
     C                     MOVELWKXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDWKEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDWKAFTM    PAAFTM           Requested Deliv
     C                     MOVELWKE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELWKE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDWKRMNB    PARMNB           Load ID
     C                     Z-ADDWKTBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDWKR1NB    PAR1NB           Rated Freight
     C                     MOVELWKPJST    PAPJST    P      LTL Flag
     C                     MOVELWKU0ST    PAU0ST    P      Price Audit
     C                     MOVELWKU1ST    PAU1ST    P      Price Status
     C                     MOVELWKQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELWKU2ST    PAU2ST    P      Export Status
     C                     MOVELWKVEST    PAVEST    P      Palletize
     C                     MOVELWKVFST    PAVFST    P      Shrink Wrap
     C                     MOVELWKVGST    PAVGST    P      Slip Sheet
     C                     MOVELWKRPCD    PARPCD    P      Age Code
     C                     Z-ADDWKRNNB    PARNNB           Reefer Temperat
     C                     MOVELWKVDST    PAVDST    P      Load Type
     C                     Z-ADDWKATIN    PAATIN           Attach to Invoi
     C                     MOVELWKU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELWKU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDWKRSRN    PARSRN           Resell Referenc
     C                     MOVELWKMHNA    PAMHNA    P      Special Comment
     C                     MOVELWKMINA    PAMINA    P      Special Comment
     C                     MOVELWKWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELWKR4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELWKBFCD    PABFCD    P      Manager Level C
     C                     MOVELWKQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDWKT3NB    PAT3NB           Attach to Order
     C                     MOVELWKSICD    PASICD    P      Reason for Pric
     C                     Z-ADDWKCONB    PACONB           Invoice Number
     C                     MOVELWKCEST    PACEST    P      Invoice Suffix
     C                     Z-ADDWKAWDT    PAAWDT           Invoice Date
     C                     MOVELWKJPCD    PAJPCD    P      Event Code
     C                     MOVELWKXUST    PAXUST    P      Trans Contol AS
     C                     MOVELWKZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDWKVRVA    PAVRVA           A_R order Value
     C                     MOVELWKOBST    PAOBST    P      Billing Activit
     C                     MOVELWKBCST    PABCST    P      Block Order Fla
     C                     MOVELWKBDST    PABDST    P      Order Certifica
     C                     Z-ADDWKB7VL    PAB7VL           Invoice Order V
     C                     MOVELWKGASX    PAGASX    P      Process Sts for
     C                     MOVELWKGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELWKGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELWKGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELWKFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELWKFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELWKFPSX    PAFPSX    P      Order Emailed
     C                     MOVELWKFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELWKFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELWKFSSX    PAFSSX    P      Broker Order St
     C                     MOVELWKFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELWKFUSX    PAFUSX    P      Order Requires
     C                     MOVELWKFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELWKFWSX    PAFWSX    P      Export USDA App
     C                     MOVELWKFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELWKFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDWKNODT    PANODT           OH Appt Confirm
     C                     Z-ADDWKNPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDWKNQDT    PANQDT           Load Actual Shi
     C                     Z-ADDWKNRDT    PANRDT           Load BOL Comple
     C                     Z-ADDWKNSDT    PANSDT           Load Truck Depa
     C                     Z-ADDWKBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDWKBQTM    PABQTM           Time of Origina
     C                     Z-ADDWKBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDWKBSTM    PABSTM           Load BOL Comple
     C                     Z-ADDWKBTTM    PABTTM           Load Truck Depa
     C                     Z-ADDWKH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDWKH1NX    PAH1NX           Act Non_Ref Frt
     C                     Z-ADDWKH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDWKH3NX    PAH3NX           OH Total Non_Re
     C                     Z-ADDWKH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDWKC0C7    PAC0C7           Claim Number
     C                     MOVELWKUVST    PAUVST    P      EDI Status 1
     C                     MOVELWKUWST    PAUWST    P      EDI Status 2
     C                     MOVELWKUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDWKAATM    PAAATM           Job Time
     C                     MOVELWKAYNA    PAAYNA    P      User Id
     C                     MOVELWKA0NA    PAA0NA    P      Job Name
     C                     Z-ADDWKAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXCHRC    BEGSR
      *================================================================
      * CHG Last Used Date     CH - OM Carrier  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0487 30        Name
     C                     MOVEL*BLANK    WN0488 30        Address Line 1
     C                     MOVEL*BLANK    WN0489 30        Address Line 2
     C                     MOVEL*BLANK    WN0490 30        Address Line 3
     C                     MOVEL*BLANK    WN0491 20        City
     C                     MOVEL*BLANK    WN0492 11        Zip Postal Code
     C                     Z-ADD*ZERO     WN0493 110       Telephone Numbe
     C                     MOVEL*BLANK    WN0494  2        State Code
     C                     MOVEL*BLANK    WN0495 25        Fax Number
     C                     Z-ADD*ZERO     WN0496 112       Pallet Balance
     C                     Z-ADD*ZERO     WN0497 112       Long hook balan
     C                     Z-ADD*ZERO     WN0498 112       Short hook bala
     C                     Z-ADD*ZERO     WN0499 112       Tub Balance
     C                     MOVEL*BLANK    WN0500  1        OM Carrier Stat
     C                     MOVEL*BLANK    WN0501 30        OM Carrier Comm
     C                     MOVEL*BLANK    WN0502 30        OM Carrier Comm
     C                     MOVEL*BLANK    WN0503 10        AP Vendor Numbe
     C                     Z-ADD*ZERO     WN0504 110       Home Phone
     C                     Z-ADD*ZERO     WN0505 110       Other Phone
     C                     Z-ADD*ZERO     WN0506 112       Flat Rate
     C                     Z-ADD*ZERO     WN0507  72       Rate Per Pound
     C                     Z-ADD*ZERO     WN0508  72       Unused Rate Per
     C                     Z-ADD*ZERO     WN0509  72       Miscellaneous C
     C                     MOVEL*BLANK    WN0510  3        Unused Carrier
     C                     Z-ADD*ZERO     WN0511  70       Unused Mile Ran
     C                     Z-ADD*ZERO     WN0512  70       Unused Mile Ran
     C                     Z-ADD*ZERO     WN0513  70       Unused Mile Ran
     C                     Z-ADD*ZERO     WN0514  70       Unused Mile Ran
     C                     Z-ADD*ZERO     WN0515  70       Unused Mile Ran
     C                     Z-ADD*ZERO     WN0516  70       Unused Mile Ran
     C                     Z-ADD*ZERO     WN0517 114       Unused Mile Rat
     C                     Z-ADD*ZERO     WN0518 114       Unused Mile Rat
     C                     Z-ADD*ZERO     WN0519 114       Unused Mile Rat
     C                     Z-ADD*ZERO     WN0520 114       Unused Mile Rat
     C                     Z-ADD*ZERO     WN0521 114       Unused Mile Rat
     C                     Z-ADD*ZERO     WN0522 114       Unused Mile Rat
     C                     Z-ADD*ZERO     WN0523 112       Unused Weight R
     C                     Z-ADD*ZERO     WN0524 112       Unused Weight R
     C                     Z-ADD*ZERO     WN0525 112       Unused Weight R
     C                     Z-ADD*ZERO     WN0526 112       Unused Weight R
     C                     Z-ADD*ZERO     WN0527 112       Unused Weight R
     C                     Z-ADD*ZERO     WN0528 112       Unused Weight R
     C                     Z-ADD*ZERO     WN0529 114       Unused Weight R
     C                     Z-ADD*ZERO     WN0530 114       Unused Weight R
     C                     Z-ADD*ZERO     WN0531 114       Unused Weight R
     C                     Z-ADD*ZERO     WN0532 114       Unused Weight R
     C                     Z-ADD*ZERO     WN0533 114       Unused Weight R
     C                     Z-ADD*ZERO     WN0534 114       Unused Weight R
     C                     Z-ADD*ZERO     WN0535  70       Contact Number
     C                     MOVEL*BLANK    WN0536  1        Certificate of
     C                     MOVEL*BLANK    WN0537 30        Carrier Unused
     C                     MOVEL*BLANK    WN0538 30        Carrier Unused
     C                     MOVEL*BLANK    WN0539 20        Carrier DOT Num
     C                     MOVEL*BLANK    WN0540  2        Carrier Unused
     C                     MOVEL*BLANK    WN0541 11        Carrier Unused
     C                     Z-ADD*ZERO     WN0542 110       Carrier Unused
     C                     MOVEL*BLANK    WN0543 25        Carrier Fed ID
     C                     Z-ADD*ZERO     WN0544 110       Amount of Cargo
     C                     Z-ADD*ZERO     WN0545 110       Amount of Liabi
     C                     Z-ADD*ZERO     WN0546  70       Date of Expirat
     C                     MOVEL*BLANK    WN0547  1        SSI Download Fl
     C                     MOVEL*BLANK    WN0548  1        unused status 2
     C                     MOVEL*BLANK    WN0549  1        unused status 3
     C                     MOVEL*BLANK    WN0550  1        EDI Status 1
     C                     MOVEL*BLANK    WN0551  1        EDI Status 2
     C                     MOVEL*BLANK    WN0552  1        EDI Status 3
     C                     MOVEL*BLANK    WN0553  1        Record Status
     C                     Z-ADD*ZERO     WN0554  60       Job Time
     C                     MOVEL*BLANK    WN0555 10        User Id
     C                     MOVEL*BLANK    WN0556 10        Job Name
     C                     Z-ADD*ZERO     WN0557  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @FFREBG
     C                     MOVELP3BZNA    WOBZNA    P      Carrier Code
      *
     C           KLCHSX    KLIST
     C                     KFLD           WOBZNA           Carrier Code
     C           KLCHSX    CHAIN@FFREBG              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFFREL1'MDACP
     C                     MOVEL'@FFREBG' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SXEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFF1    YGRDCS
      * Move non-key fields to @FFREBG
     C                     Z-ADD##JDT     WOEEDT           Carrier Last Us
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFF1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@FFREBG                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFFREL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * Cnf Order Ship/Unship RT - Order Inv Allocation  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0558  70       Quantity Loc Tr
     C                     Z-ADD*ZERO     WN0559  70       Item Code
     C                     MOVEL*BLANK    WN0560  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0561  70       Production Date
     C                     Z-ADD*ZERO     WN0562  50       Lot Number
     C                     MOVEL*BLANK    WN0563  4        Location Code
     C                     Z-ADD*ZERO     WN0564  20       Location Level
     C                     Z-ADD*ZERO     WN0565  50       LLT Transaction
     C                     Z-ADD*ZERO     WN0566 112       LLT Transaction
     C                     Z-ADD*ZERO     WN0567 112       Weight Order 2
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       YL0018           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WRAIC3    WQSY01           Company Number
     C           *LIKE     DEFN WRC4NB    WQSY02           Order Number
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WQSY01           Company Number
     C                     KFLD           WQSY02           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSY01           Company Number
     C                     Z-ADDP1C4NB    WQSY02           Order Number
      * Establish starting position
     C           KRSSY     SETLL@L8CPZO                    *
     C           KRSSY     READE@L8CPZO                  90*
      * Data record not found
     C   90                MOVEL'USR2640' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADD*ZERO     WN0558           Quantity Loc Tr
     C                     Z-ADD*ZERO     WN0567           Weight Order 2
      * 1ST:  First time process
      * CASE: LCL.First Time Flag is Yes
     C           YL0018    IFEQ 'Y'                        *IF
     C                     Z-ADDWRHGCD    WN0559           Item Code
     C                     MOVELWRAJCD    WN0560           Warehouse Code
     C                     Z-ADDWRELDT    WN0561           Production Date
     C                     Z-ADDWRLXNM    WN0562           Lot Number
     C                     MOVELWRYMCD    WN0563           Location Code
     C                     Z-ADDWRYNCD    WN0564           Location Level
     C                     MOVEL'N'       YL0018           First Time Flag
     C                     END                             *FI
      * CHG: Item, Whs, PDte, Lot, Loc, Level
      * CASE: CHG: Item, Whs, PDte, Lot, Loc, Level
      *  - c1 OR c2 OR c3 OR c4 OR c5 OR c6
      *   |- c1    : PAR.Item Code NE DB1.Item Code
      *   |- c2    : PAR.Warehouse Code NE DB1.Warehouse Code
      *   |- c3    : PAR.Production Date NE DB1.Production Date
      *   |- c4    : PAR.Lot Number NE DB1.Lot Number
      *   |- c5    : PAR.Location Code NE DB1.Location Code
      *   |- c6    : PAR.Location Level NE DB1.Location Level
      *   '-
     C           WN0559    IFNE WRHGCD                     *IF
     C           WN0560    ORNE WRAJCD                     *OR
     C           WN0561    ORNE WRELDT                     *OR
     C           WN0562    ORNE WRLXNM                     *OR
     C           WN0563    ORNE WRYMCD                     *OR
     C           WN0564    ORNE WRYNCD                     *OR
      * CASE: PAR.LLT Trans Qty is NE Zero
     C           WN0565    IFNE 0                          *IF
      *
     C                     Z-ADD*ZERO     WN0568  30       LLT Sequence Nu
     C                     MOVEL*BLANK    WN0569  1        EDI Status 1
     C                     MOVEL*BLANK    WN0570  1        EDI Status 2
     C                     MOVEL*BLANK    WN0571  1        EDI Status 3
     C                     MOVEL*BLANK    WN0572  1        Record Status
     C                     Z-ADD*ZERO     WN0573  60       Job Time
     C                     MOVEL*BLANK    WN0574 10        User Id
     C                     MOVEL*BLANK    WN0575 10        Job Name
     C                     Z-ADD*ZERO     WN0576  70       Job Date
      *
      * Crt Item Lot/Loc Trns IF
      * Rtv Next Seq #        RT - IC Item Lot/Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWRAIC3    WL0028           Company Number
     C                     Z-ADDWN0559    WL0029           Item Code
     C                     MOVELWN0560    WL0030    P      Warehouse Code
     C                     MOVEL'S'       WL0031    P      LLT Transaction
     C                     Z-ADD##JDT     WL0032           LLT Transaction
     C                     EXSR SZRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0033    WN0568           LLT Sequence Nu
      * Crt Item Lot/Loc Trns CR - Item Lot Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWRAIC3    WL0034           Company Number
     C                     Z-ADDWN0559    WL0035           Item Code
     C                     MOVELWN0560    WL0036    P      Warehouse Code
     C                     MOVEL'S'       WL0037    P      LLT Transaction
     C                     Z-ADD##JDT     WL0038           LLT Transaction
     C                     Z-ADDWN0568    WL0039           LLT Sequence Nu
     C                     Z-ADDWN0561    WL0040           LLT Production
     C                     Z-ADDWN0565    WL0041           LLT Transaction
     C                     Z-ADDWN0566    WL0042           LLT Transaction
     C                     Z-ADDWN0562    WL0043           LLT Lot Number
     C                     MOVELWN0563    WL0044    P      Location Code
     C                     Z-ADDWN0564    WL0045           LLT Location Le
     C                     MOVEL*BLANK    WL0046           Transfer Wareho
     C                     Z-ADD*ZERO     WL0047           LLT Transfer Lo
     C                     MOVEL*BLANK    WL0048           Transfer Locati
     C                     Z-ADD*ZERO     WL0049           LLT Transfer Lo
     C                     Z-ADDWRC4NB    WL0050           Order Number
     C                     MOVEL'P'       WL0051    P      LLT Status
     C                     MOVELWULLTU    WL0052    P      LTT Unused Sts
     C                     MOVELWULLYT    WL0053    P      LTT Unused Sts
     C                     MOVELWN0569    WL0054    P      EDI Status 1
     C                     MOVELWN0570    WL0055    P      EDI Status 2
     C                     MOVELWN0571    WL0056    P      EDI Status 3
     C                     MOVELWN0572    WL0057    P      Record Status
     C                     Z-ADDWN0573    WL0058           Job Time
     C                     MOVELWN0574    WL0059    P      User Id
     C                     MOVELWN0575    WL0060    P      Job Name
     C                     Z-ADDWN0576    WL0061           Job Date
     C                     EXSR TACRRC
      * Upd Qty On-Hand,wgt   RT - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWRAIC3    WL0062           Company Number
     C                     Z-ADDWN0559    WL0063           Item Code
     C                     MOVELWN0560    WL0064    P      Warehouse Code
     C                     Z-ADDWN0561    WL0065           Production Date
     C                     Z-ADDWN0562    WL0066           Lot Number
     C                     MOVELWN0563    WL0067    P      Location Code
     C                     Z-ADDWN0564    WL0068           Location Level
     C                     Z-ADDWN0565    WL0069           Quantity Loc Tr
     C                     Z-ADDWN0566    WL0070           Weight Order 2
     C                     EXSR TBRVGN
     C                     END                             *FI
     C                     Z-ADDWRHGCD    WN0559           Item Code
     C                     MOVELWRAJCD    WN0560           Warehouse Code
     C                     Z-ADDWRELDT    WN0561           Production Date
     C                     Z-ADDWRLXNM    WN0562           Lot Number
     C                     MOVELWRYMCD    WN0563           Location Code
     C                     Z-ADDWRYNCD    WN0564           Location Level
     C                     Z-ADD*ZERO     WN0565           LLT Transaction
     C                     Z-ADD*ZERO     WN0566           LLT Transaction
     C                     END                             *FI
      * PRC:  Accumulate Quantity
      * CASE: PAR.OIA Allocation Sts is Shipped
     C           'S'       IFEQ 'S'                        *IF
     C           WRJ6QT    MULT -1        WN0558           Quantity Loc Tr
     C                     ADD  WN0558    WN0565           LLT Transaction
      * RMC 1/9/17 reduce weight too
     C           WRG9WG    MULT -1        WN0567           Weight Order 2
     C                     ADD  WN0567    WN0566           LLT Transaction
      * Chg Allocation Sts    CH - Order Inv Allocation  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWRAIC3    WL0122           Company Number
     C                     Z-ADDWRC4NB    WL0123           Order Number
     C                     Z-ADDWRDPNB    WL0124           Order Sequence
     C                     Z-ADDWRUENB    WL0125           Order Secondary
     C                     Z-ADDWRALSW    WL0126           Allocation Seq
     C                     MOVEL'S'       WL0127    P      OIA Allocation
     C                     EXSR TKCHRC
     C                     ELSE
      * CASE: PAR.OIA Allocation Sts is Unshipped
     C           'S'       IFEQ 'U'                        *IF
     C                     ADD  WRJ6QT    WN0565           LLT Transaction
      * RMC 1/9/17 increase weight too
     C                     ADD  WRG9WG    WN0566           LLT Transaction
      * Chg Allocation Sts    CH - Order Inv Allocation  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWRAIC3    WL0122           Company Number
     C                     Z-ADDWRC4NB    WL0123           Order Number
     C                     Z-ADDWRDPNB    WL0124           Order Sequence
     C                     Z-ADDWRUENB    WL0125           Order Secondary
     C                     Z-ADDWRALSW    WL0126           Allocation Seq
     C                     MOVEL'S'       WL0127    P      OIA Allocation
     C                     EXSR TKCHRC
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSY     READE@L8CPZO                  90*
     C                     ENDDO
      * USER: Exit processing
      * Do if qty> 0    ----RMC 2/15/06
      * CASE: PAR.LLT Trans Qty is NE Zero
     C           WN0565    IFNE 0                          *IF
      *
     C                     Z-ADD*ZERO     WN0649  30       LLT Sequence Nu
     C                     MOVEL*BLANK    WN0650  1        EDI Status 1
     C                     MOVEL*BLANK    WN0651  1        EDI Status 2
     C                     MOVEL*BLANK    WN0652  1        EDI Status 3
     C                     MOVEL*BLANK    WN0653  1        Record Status
     C                     Z-ADD*ZERO     WN0654  60       Job Time
     C                     MOVEL*BLANK    WN0655 10        User Id
     C                     MOVEL*BLANK    WN0656 10        Job Name
     C                     Z-ADD*ZERO     WN0657  70       Job Date
      *
      * Crt Item Lot/Loc Trns IF
      * Rtv Next Seq #        RT - IC Item Lot/Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWRAIC3    WL0028           Company Number
     C                     Z-ADDWN0559    WL0029           Item Code
     C                     MOVELWN0560    WL0030    P      Warehouse Code
     C                     MOVEL'S'       WL0031    P      LLT Transaction
     C                     Z-ADD##JDT     WL0032           LLT Transaction
     C                     EXSR SZRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0033    WN0649           LLT Sequence Nu
      * Crt Item Lot/Loc Trns CR - Item Lot Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWRAIC3    WL0034           Company Number
     C                     Z-ADDWN0559    WL0035           Item Code
     C                     MOVELWN0560    WL0036    P      Warehouse Code
     C                     MOVEL'S'       WL0037    P      LLT Transaction
     C                     Z-ADD##JDT     WL0038           LLT Transaction
     C                     Z-ADDWN0649    WL0039           LLT Sequence Nu
     C                     Z-ADDWN0561    WL0040           LLT Production
     C                     Z-ADDWN0565    WL0041           LLT Transaction
     C                     Z-ADDWN0566    WL0042           LLT Transaction
     C                     Z-ADDWN0562    WL0043           LLT Lot Number
     C                     MOVELWN0563    WL0044    P      Location Code
     C                     Z-ADDWN0564    WL0045           LLT Location Le
     C                     MOVEL*BLANK    WL0046           Transfer Wareho
     C                     Z-ADD*ZERO     WL0047           LLT Transfer Lo
     C                     MOVEL*BLANK    WL0048           Transfer Locati
     C                     Z-ADD*ZERO     WL0049           LLT Transfer Lo
     C                     Z-ADDWRC4NB    WL0050           Order Number
     C                     MOVEL'P'       WL0051    P      LLT Status
     C                     MOVELWULLTU    WL0052    P      LTT Unused Sts
     C                     MOVELWULLYT    WL0053    P      LTT Unused Sts
     C                     MOVELWN0650    WL0054    P      EDI Status 1
     C                     MOVELWN0651    WL0055    P      EDI Status 2
     C                     MOVELWN0652    WL0056    P      EDI Status 3
     C                     MOVELWN0653    WL0057    P      Record Status
     C                     Z-ADDWN0654    WL0058           Job Time
     C                     MOVELWN0655    WL0059    P      User Id
     C                     MOVELWN0656    WL0060    P      Job Name
     C                     Z-ADDWN0657    WL0061           Job Date
     C                     EXSR TACRRC
      * Upd Qty On-Hand,wgt   RT - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWRAIC3    WL0062           Company Number
     C                     Z-ADDWN0559    WL0063           Item Code
     C                     MOVELWN0560    WL0064    P      Warehouse Code
     C                     Z-ADDWN0561    WL0065           Production Date
     C                     Z-ADDWN0562    WL0066           Lot Number
     C                     MOVELWN0563    WL0067    P      Location Code
     C                     Z-ADDWN0564    WL0068           Location Level
     C                     Z-ADDWN0565    WL0069           Quantity Loc Tr
     C                     Z-ADDWN0566    WL0070           Weight Order 2
     C                     EXSR TBRVGN
     C                     END                             *FI
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * Rtv Next Seq #        RT - IC Item Lot/Loc Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WSAIC3    WQSZ01           Company Number
     C           *LIKE     DEFN WSHGCD    WQSZ02           Item Code
     C           *LIKE     DEFN WSAJCD    WQSZ03           Warehouse Code
     C           *LIKE     DEFN WSLTRT    WQSZ04           LLT Transaction
     C           *LIKE     DEFN WSLRDT    WQSZ05           LLT Transaction
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WQSZ01           Company Number
     C                     KFLD           WQSZ02           Item Code
     C                     KFLD           WQSZ03           Warehouse Code
     C                     KFLD           WQSZ04           LLT Transaction
     C                     KFLD           WQSZ05           LLT Transaction
      * Setup key
     C                     Z-ADDWL0028    WQSZ01           Company Number
     C                     Z-ADDWL0029    WQSZ02           Item Code
     C                     MOVELWL0030    WQSZ03           Warehouse Code
     C                     MOVELWL0031    WQSZ04           LLT Transaction
     C                     Z-ADDWL0032    WQSZ05           LLT Transaction
      * Establish starting position
     C           KRSSZ     SETLL@L7CPUK                    *
     C           KRSSZ     READE@L7CPUK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2638' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WL0033           LLT Sequence Nu
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WSLLTS    ADD  1         WL0033           LLT Sequence Nu
     C                     GOTO SZEXIT                     *QUIT
     C           KRSSZ     READE@L7CPUK                  90*
     C                     ENDDO
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TACRRC    BEGSR
      *================================================================
      * Crt Item Lot/Loc Trns CR - Item Lot Loc Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @L7CPS3
     C                     Z-ADDWL0034    WTAIC3           Company Number
     C                     Z-ADDWL0035    WTHGCD           Item Code
     C                     MOVELWL0036    WTAJCD           Warehouse Code
     C                     MOVELWL0037    WTLTRT           LLT Transaction
     C                     Z-ADDWL0038    WTLRDT           LLT Transaction
     C                     Z-ADDWL0039    WTLLTS           LLT Sequence Nu
     C                     Z-ADDWL0040    WTLSDT           LLT Production
     C                     Z-ADDWL0041    WTJ5QT           LLT Transaction
     C                     Z-ADDWL0042    WTG8WG           LLT Transaction
     C                     Z-ADDWL0043    WTLLTN           LLT Lot Number
     C                     MOVELWL0044    WTYMCD           Location Code
     C                     Z-ADDWL0045    WTLLCL           LLT Location Le
     C                     MOVELWL0046    WTBNAA           Transfer Wareho
     C                     Z-ADDWL0047    WTLLTR           LLT Transfer Lo
     C                     MOVELWL0048    WTY2CD           Transfer Locati
     C                     Z-ADDWL0049    WTLLTL           LLT Transfer Lo
     C                     Z-ADDWL0050    WTC4NB           Order Number
     C                     MOVELWL0051    WTLOST           LLT Status
     C                     MOVELWL0052    WTLLTU           LTT Unused Sts
     C                     MOVELWL0053    WTLLYT           LTT Unused Sts
     C                     MOVELWL0054    WTUVST           EDI Status 1
     C                     MOVELWL0055    WTUWST           EDI Status 2
     C                     MOVELWL0056    WTUXST           EDI Status 3
     C                     MOVELWL0057    WTVSST           Record Status
     C                     Z-ADDWL0058    WTAATM           Job Time
     C                     MOVELWL0059    WTAYNA           User Id
     C                     MOVELWL0060    WTA0NA           Job Name
     C                     Z-ADDWL0061    WTAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WTVSST           Record Status
     C                     Z-ADD##JTM     WTAATM           Job Time
     C                     MOVEL##USR     WTAYNA           User Id
     C                     MOVEL##PGM     WTA0NA           Job Name
     C                     Z-ADD##JDT     WTAXDT           Job Date
     C           KLCRTA    KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTHGCD           Item Code
     C                     KFLD           WTAJCD           Warehouse Code
     C                     KFLD           WTLTRT           LLT Transaction
     C                     KFLD           WTLRDT           LLT Transaction
     C                     KFLD           WTLLTS           LLT Sequence Nu
      * Check for duplicate primary key
     C           KLCRTA    SETLL@L7CPS3                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2639' W0RTN   7
      * Send message 'Item Lot Loc Trans     EX'
     C                     MOVEL'USR2639' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C                     WRITE@L7CPS3                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * Upd Qty On-Hand,wgt   RT - Item Lot Location  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0577  50       ILL Item Qty On
     C                     Z-ADD*ZERO     WN0578 112       ILL Unit Weight
     C                     Z-ADD*ZERO     WN0579  50       ILL Co-Packer L
     C                     Z-ADD*ZERO     WN0580 112       ILL Item Wgt On
     C                     Z-ADD*ZERO     WN0581  50       ILL Unused Qty
     C                     Z-ADD*ZERO     WN0582 112       ILL Unused Wgt
     C                     Z-ADD*ZERO     WN0583  70       ILL Avail Ship
     C                     Z-ADD*ZERO     WN0584  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0585  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0586  72       ILL Unused Nbr
     C                     MOVEL*BLANK    WN0587  6        ILL Customer Co
     C                     MOVEL*BLANK    WN0588  1        ILL Status
     C                     MOVEL*BLANK    WN0589  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0590  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0591  2        ILL Unused Sts
     C                     MOVEL*BLANK    WN0592  3        Inv Hold Reason
     C                     MOVEL*BLANK    WN0593  1        EDI Status 1
     C                     MOVEL*BLANK    WN0594  1        EDI Status 2
     C                     MOVEL*BLANK    WN0595  1        EDI Status 3
     C                     MOVEL*BLANK    WN0596  1        Record Status
     C                     Z-ADD*ZERO     WN0597  60       Job Time
     C                     MOVEL*BLANK    WN0598 10        User Id
     C                     MOVEL*BLANK    WN0599 10        Job Name
     C                     Z-ADD*ZERO     WN0600  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WVAIC3           Company Number
     C                     KFLD           WVHGCD           Item Code
     C                     KFLD           WVAJCD           Warehouse Code
     C                     KFLD           WVELDT           Production Date
     C                     KFLD           WVLXNM           Lot Number
     C                     KFLD           WVYMCD           Location Code
     C                     KFLD           WVYNCD           Location Level
      * Setup key
     C                     Z-ADDWL0062    WVAIC3           Company Number
     C                     Z-ADDWL0063    WVHGCD           Item Code
     C                     MOVELWL0064    WVAJCD           Warehouse Code
     C                     Z-ADDWL0065    WVELDT           Production Date
     C                     Z-ADDWL0066    WVLXNM           Lot Number
     C                     MOVELWL0067    WVYMCD           Location Code
     C                     Z-ADDWL0068    WVYNCD           Location Level
      * Establish starting position
     C           KRSTB     CHAIN@L5CPSV              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2634' W0RTN   7
      * USER: Processing if Data record not found
      *
     C                     MOVEL*BLANK    WN0601  1        WLT Type Code
     C                     Z-ADD*ZERO     WN0602  52       WLT Type Chill
      *
      * Clc Loc Avail Shp Dte IF
      * Rtv Loc Type          RT - Warehouse Location  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWL0064    WL0071    P      Warehouse Code
     C                     MOVELWL0067    WL0072    P      Location Code
     C                     EXSR TCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0073    WN0601    P      WLT Type Code
      * Rtv Chill Time        RT - Warehouse Location Type  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0601    WL0074    P      WLT Type Code
     C                     EXSR TDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0075    WN0602           WLT Type Chill
      * PAR.ILL Avail Ship Date = PAR.Production Date + PAR.WLT Type Chil
     C           WL0065    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN0602    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0583
     C                     ELSE
     C           XDINDT    SUB  1000000   WN0583
     C                     END
      * RTV Unit Weight        RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0062    WL0076           Company Number
     C                     Z-ADDWL0063    WL0077           Item Code
     C                     EXSR TERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0078    WN0578           Unit Weight
     C                     MOVELWL0079    YL0019    P      Quality Level
      * Crt Item Loc          CR - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0062    WL0080           Company Number
     C                     Z-ADDWL0063    WL0081           Item Code
     C                     MOVELWL0064    WL0082    P      Warehouse Code
     C                     Z-ADDWL0065    WL0083           Production Date
     C                     Z-ADDWL0066    WL0084           Lot Number
     C                     MOVELWL0067    WL0085    P      Location Code
     C                     Z-ADDWL0068    WL0086           Location Level
     C                     Z-ADDWL0069    WL0087           ILL Item Qty On
     C                     Z-ADDWN0578    WL0088           ILL Unit Weight
     C                     Z-ADDWN0579    WL0089           ILL Co-Packer L
     C                     Z-ADDWN0580    WL0090           ILL Item Wgt On
     C                     Z-ADDWN0581    WL0091           ILL Unused Qty
     C                     Z-ADDWN0582    WL0092           ILL Unused Wgt
     C                     Z-ADDWN0583    WL0093           ILL Avail Ship
     C                     Z-ADDWN0584    WL0094           ILL Unused Date
     C                     Z-ADDWN0585    WL0095           ILL Unused Date
     C                     Z-ADDWN0586    WL0096           ILL Unused Nbr
     C                     MOVELWN0587    WL0097    P      ILL Customer Co
     C                     MOVEL'A'       WL0098    P      ILL Status
     C                     MOVELWN0589    WL0099    P      ILL Unused Sts
     C                     MOVELWN0590    WL0100    P      ILL Unused Sts
     C                     MOVELWN0591    WL0101    P      ILL Unused Sts
     C                     MOVELWN0592    WL0102    P      Inv Hold Reason
     C                     MOVELWN0593    WL0103    P      EDI Status 1
     C                     MOVELWN0594    WL0104    P      EDI Status 2
     C                     MOVELWN0595    WL0105    P      EDI Status 3
     C                     MOVELWN0596    WL0106    P      Record Status
     C                     Z-ADDWN0597    WL0107           Job Time
     C                     MOVELWN0598    WL0108    P      User Id
     C                     MOVELWN0599    WL0109    P      Job Name
     C                     Z-ADDWN0600    WL0110           Job Date
     C                     EXSR TFCRRC
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WVJ2QT    ADD  WL0069    WN0577           ILL Item Qty On
     C           WVG6WG    ADD  WL0070    WN0580           ILL Item Wgt On
      * CASE: PAR.ILL Item Qty On-Hand is GT Zero
     C           WN0577    IFGT 0                          *IF
      * Chg Quantity On-Hn,wg CH - Item Lot Location  * 
     C                     EXSR TGCHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Del Item Location     DL - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0111           Company Number
     C                     Z-ADDWVHGCD    WL0112           Item Code
     C                     MOVELWVAJCD    WL0113    P      Warehouse Code
     C                     Z-ADDWVELDT    WL0114           Production Date
     C                     Z-ADDWVLXNM    WL0115           Lot Number
     C                     MOVELWVYMCD    WL0116    P      Location Code
     C                     Z-ADDWVYNCD    WL0117           Location Level
     C                     EXSR THDLRC
      * Del Item Balance Dtl  RT - Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0118           Company Number
     C                     Z-ADDWVHGCD    WL0119           Item Code
     C                     MOVELWVAJCD    WL0120    P      Warehouse Code
     C                     Z-ADDWVELDT    WL0121           Production Date
     C                     EXSR TIRVGN
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * Rtv Loc Type          RT - Warehouse Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WWAJCD           Warehouse Code
     C                     KFLD           WWYMCD           Location Code
      * Setup key
     C                     MOVELWL0071    WWAJCD           Warehouse Code
     C                     MOVELWL0072    WWYMCD           Location Code
      * Establish starting position
     C           KRSTC     CHAIN@L2RESM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2628' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0073           WLT Type Code
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWWAGSX    WL0073           WLT Type Code
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Rtv Chill Time        RT - Warehouse Location Type  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WXAGSX           WLT Type Code
      * Setup key
     C                     MOVELWL0074    WXAGSX           WLT Type Code
      * Establish starting position
     C           KRSTD     CHAIN@L3RET8              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2660' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0075           WLT Type Chill
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWXSLTY    WL0075           WLT Type Chill
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * RTV Unit Weight        RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           WYAIC3           Company Number
     C                     KFLD           WYHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0076    WYAIC3           Company Number
     C                     Z-ADDWL0077    WYHGCD           Item Code
      * Establish starting position
     C           KRSTE     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0078           Unit Weight
     C                     MOVEL*BLANK    WL0079           Quality Level
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWYAIWG    WL0078           Unit Weight
     C                     MOVELWYHICD    WL0079           Quality Level
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFCRRC    BEGSR
      *================================================================
      * Crt Item Loc          CR - Item Lot Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @L5CPSL
     C                     Z-ADDWL0080    TAAIC3           Company Number
     C                     Z-ADDWL0081    TAHGCD           Item Code
     C                     MOVELWL0082    TAAJCD           Warehouse Code
     C                     Z-ADDWL0083    TAELDT           Production Date
     C                     Z-ADDWL0084    TALXNM           Lot Number
     C                     MOVELWL0085    TAYMCD           Location Code
     C                     Z-ADDWL0086    TAYNCD           Location Level
     C                     Z-ADDWL0087    TAJ2QT           ILL Item Qty On
     C                     Z-ADDWL0088    TAG5WG           ILL Unit Weight
     C                     Z-ADDWL0089    TAJ3QT           ILL Co-Packer L
     C                     Z-ADDWL0090    TAG6WG           ILL Item Wgt On
     C                     Z-ADDWL0091    TAJ4QT           ILL Unused Qty
     C                     Z-ADDWL0092    TAG7WG           ILL Unused Wgt
     C                     Z-ADDWL0093    TALODT           ILL Avail Ship
     C                     Z-ADDWL0094    TALPDT           ILL Unused Date
     C                     Z-ADDWL0095    TALQDT           ILL Unused Date
     C                     Z-ADDWL0096    TANBR            ILL Unused Nbr
     C                     MOVELWL0097    TAYTCD           ILL Customer Co
     C                     MOVELWL0098    TAAMSX           ILL Status
     C                     MOVELWL0099    TAASSX           ILL Unused Sts
     C                     MOVELWL0100    TAATSX           ILL Unused Sts
     C                     MOVELWL0101    TAAUSX           ILL Unused Sts
     C                     MOVELWL0102    TAYSCD           Inv Hold Reason
     C                     MOVELWL0103    TAUVST           EDI Status 1
     C                     MOVELWL0104    TAUWST           EDI Status 2
     C                     MOVELWL0105    TAUXST           EDI Status 3
     C                     MOVELWL0106    TAVSST           Record Status
     C                     Z-ADDWL0107    TAAATM           Job Time
     C                     MOVELWL0108    TAAYNA           User Id
     C                     MOVELWL0109    TAA0NA           Job Name
     C                     Z-ADDWL0110    TAAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       TAVSST           Record Status
     C                     Z-ADD##JTM     TAAATM           Job Time
     C                     MOVEL##USR     TAAYNA           User Id
     C                     MOVEL##PGM     TAA0NA           Job Name
     C                     Z-ADD##JDT     TAAXDT           Job Date
     C           KLCRTF    KLIST
     C                     KFLD           TAAIC3           Company Number
     C                     KFLD           TAHGCD           Item Code
     C                     KFLD           TAAJCD           Warehouse Code
     C                     KFLD           TAELDT           Production Date
     C                     KFLD           TALXNM           Lot Number
     C                     KFLD           TAYMCD           Location Code
     C                     KFLD           TAYNCD           Location Level
      * Check for duplicate primary key
     C           KLCRTF    SETLL@L5CPSL                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2635' W0RTN   7
      * Send message 'Item Lot Location      EX'
     C                     MOVEL'USR2635' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C                     WRITE@L5CPSL                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGCHRC    BEGSR
      *================================================================
      * Chg Quantity On-Hn,wg CH - Item Lot Location  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0603 112       ILL Unit Weight
     C                     Z-ADD*ZERO     WN0604  50       ILL Co-Packer L
     C                     Z-ADD*ZERO     WN0605  50       ILL Unused Qty
     C                     Z-ADD*ZERO     WN0606 112       ILL Unused Wgt
     C                     Z-ADD*ZERO     WN0607  70       ILL Avail Ship
     C                     Z-ADD*ZERO     WN0608  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0609  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0610  72       ILL Unused Nbr
     C                     MOVEL*BLANK    WN0611  6        ILL Customer Co
     C                     MOVEL*BLANK    WN0612  1        ILL Status
     C                     MOVEL*BLANK    WN0613  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0614  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0615  2        ILL Unused Sts
     C                     MOVEL*BLANK    WN0616  3        Inv Hold Reason
     C                     MOVEL*BLANK    WN0617  1        EDI Status 1
     C                     MOVEL*BLANK    WN0618  1        EDI Status 2
     C                     MOVEL*BLANK    WN0619  1        EDI Status 3
     C                     MOVEL*BLANK    WN0620  1        Record Status
     C                     Z-ADD*ZERO     WN0621  60       Job Time
     C                     MOVEL*BLANK    WN0622 10        User Id
     C                     MOVEL*BLANK    WN0623 10        Job Name
     C                     Z-ADD*ZERO     WN0624  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YHRDC   1
      *
      * Move key fields to @L5CPSL
     C                     Z-ADDWVAIC3    TAAIC3           Company Number
     C                     Z-ADDWVHGCD    TAHGCD           Item Code
     C                     MOVELWVAJCD    TAAJCD    P      Warehouse Code
     C                     Z-ADDWVELDT    TAELDT           Production Date
     C                     Z-ADDWVLXNM    TALXNM           Lot Number
     C                     MOVELWVYMCD    TAYMCD    P      Location Code
     C                     Z-ADDWVYNCD    TAYNCD           Location Level
      *
     C           KLCHTG    KLIST
     C                     KFLD           TAAIC3           Company Number
     C                     KFLD           TAHGCD           Item Code
     C                     KFLD           TAAJCD           Warehouse Code
     C                     KFLD           TAELDT           Production Date
     C                     KFLD           TALXNM           Lot Number
     C                     KFLD           TAYMCD           Location Code
     C                     KFLD           TAYNCD           Location Level
     C           KLCHTG    CHAIN@L5CPSL              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDL5CPL0'MDACP
     C                     MOVEL'@L5CPSL' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDL51    YHRDCS
      * Move non-key fields to @L5CPSL
     C                     Z-ADDWN0577    TAJ2QT           ILL Item Qty On
     C                     Z-ADDWN0580    TAG6WG           ILL Item Wgt On
      *
      * Set PGM.*Record Data Changed flag
     C           QPDL51    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     TAAATM           Job Time
     C                     MOVEL##USR     TAAYNA           User Id
     C                     MOVEL##PGM     TAA0NA           Job Name
     C                     Z-ADD##JDT     TAAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDL51    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YHRDC     IFEQ 'Y'
     C                     UPDAT@L5CPSL                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDL5CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THDLRC    BEGSR
      *================================================================
      * Del Item Location     DL - Item Lot Location  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0625  50       ILL Item Qty On
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @L5CPSL
     C                     Z-ADDWL0111    TAAIC3           Company Number
     C                     Z-ADDWL0112    TAHGCD           Item Code
     C                     MOVELWL0113    TAAJCD           Warehouse Code
     C                     Z-ADDWL0114    TAELDT           Production Date
     C                     Z-ADDWL0115    TALXNM           Lot Number
     C                     MOVELWL0116    TAYMCD           Location Code
     C                     Z-ADDWL0117    TAYNCD           Location Level
      *
     C           KLDLTH    KLIST
     C                     KFLD           TAAIC3           Company Number
     C                     KFLD           TAHGCD           Item Code
     C                     KFLD           TAAJCD           Warehouse Code
     C                     KFLD           TAELDT           Production Date
     C                     KFLD           TALXNM           Lot Number
     C                     KFLD           TAYMCD           Location Code
     C                     KFLD           TAYNCD           Location Level
     C           KLDLTH    CHAIN@L5CPSL              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDL5CPL0'MDACP
     C                     MOVEL'@L5CPSL' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL009.
     C                     MOVEL'LBL009'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO THEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO THEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@L5CPSL                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * Del Item Balance Dtl  RT - Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           TBAIC3           Company Number
     C                     KFLD           TBHGCD           Item Code
     C                     KFLD           TBAJCD           Warehouse Code
     C                     KFLD           TBELDT           Production Date
      * Setup key
     C                     Z-ADDWL0118    TBAIC3           Company Number
     C                     Z-ADDWL0119    TBHGCD           Item Code
     C                     MOVELWL0120    TBAJCD           Warehouse Code
     C                     Z-ADDWL0121    TBELDT           Production Date
      * Establish starting position
     C           KRSTI     CHAIN@B1REJ0              90    *
      * Data record not found
     C   90                MOVEL'USR0330' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Quantity on Hand - U/M1 is Equal to zero
     C           TBARQT    IFEQ 0                          *IF
      * Del Item Balance Dtl  DL - IC Item Balance Detail  * 
     C                     EXSR TJDLRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJDLRC    BEGSR
      *================================================================
      * Del Item Balance Dtl  DL - IC Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B1REJ1
     C                     Z-ADDTBAIC3    TCAIC3           Company Number
     C                     Z-ADDTBHGCD    TCHGCD           Item Code
     C                     MOVELTBAJCD    TCAJCD           Warehouse Code
     C                     Z-ADDTBELDT    TCELDT           Production Date
      *
     C           KLDLTJ    KLIST
     C                     KFLD           TCAIC3           Company Number
     C                     KFLD           TCHGCD           Item Code
     C                     KFLD           TCAJCD           Warehouse Code
     C                     KFLD           TCELDT           Production Date
     C           KLDLTJ    CHAIN@B1REJ1              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB1REL1'MDACP
     C                     MOVEL'@B1REJ1' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL010.
     C                     MOVEL'LBL010'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TJEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B1REJ1                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKCHRC    BEGSR
      *================================================================
      * Chg Allocation Sts    CH - Order Inv Allocation  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0626  50       OIA Alloc_Shipp
     C                     Z-ADD*ZERO     WN0627 112       OIA Alloc_Shipp
     C                     Z-ADD*ZERO     WN0628  50       OIA Co-Packer L
     C                     Z-ADD*ZERO     WN0629 112       OIA Serial Numb
     C                     MOVEL*BLANK    WN0630  1        OIA Create Sts
     C                     MOVEL*BLANK    WN0631  1        OIA Modified St
     C                     MOVEL*BLANK    WN0632  2        OIA Loc Pick St
     C                     MOVEL*BLANK    WN0633  1        OIA Unused Sts
     C                     MOVEL*BLANK    WN0634  2        OIA Unused Sts
     C                     Z-ADD*ZERO     WN0635  70       Item Code
     C                     MOVEL*BLANK    WN0636  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0637  70       Production Date
     C                     Z-ADD*ZERO     WN0638  50       Lot Number
     C                     MOVEL*BLANK    WN0639  4        Location Code
     C                     Z-ADD*ZERO     WN0640  20       Location Level
     C                     MOVEL*BLANK    WN0641  1        EDI Status 1
     C                     MOVEL*BLANK    WN0642  1        EDI Status 2
     C                     MOVEL*BLANK    WN0643  1        EDI Status 3
     C                     MOVEL*BLANK    WN0644  1        Record Status
     C                     Z-ADD*ZERO     WN0645  60       Job Time
     C                     MOVEL*BLANK    WN0646 10        User Id
     C                     MOVEL*BLANK    WN0647 10        Job Name
     C                     Z-ADD*ZERO     WN0648  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YIRDC   1
      *
      * Move key fields to @L8CPSX
     C                     Z-ADDWL0122    TDAIC3           Company Number
     C                     Z-ADDWL0123    TDC4NB           Order Number
     C                     Z-ADDWL0124    TDDPNB           Order Sequence
     C                     Z-ADDWL0125    TDUENB           Order Secondary
     C                     Z-ADDWL0126    TDALSW           Allocation Seq
      *
     C           KLCHTK    KLIST
     C                     KFLD           TDAIC3           Company Number
     C                     KFLD           TDC4NB           Order Number
     C                     KFLD           TDDPNB           Order Sequence
     C                     KFLD           TDUENB           Order Secondary
     C                     KFLD           TDALSW           Allocation Seq
     C           KLCHTK    CHAIN@L8CPSX              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDL8CPL0'MDACP
     C                     MOVEL'@L8CPSX' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL011.
     C                     MOVEL'LBL011'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TKEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDL81    YIRDCS
      * Move non-key fields to @L8CPSX
     C                     MOVELWL0127    TDSOAS    P      OIA Allocation
      *
      * Set PGM.*Record Data Changed flag
     C           QPDL81    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     TDAATM           Job Time
     C                     MOVEL##USR     TDAYNA           User Id
     C                     MOVEL##PGM     TDA0NA           Job Name
     C                     Z-ADD##JDT     TDAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDL81    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YIRDC     IFEQ 'Y'
     C                     UPDAT@L8CPSX                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDL8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * RTV Chg Head Status    RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WAAIC3           Company Number
     C                     Z-ADDP1C4NB    WAC4NB           Order Number
      * Establish starting position
     C           KRSTL     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CHG Head Status/Event  CH - Order Header TRG  * 
     C                     EXSR TMCHRC
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           WAC4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVELWAC4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0001           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0001           CD7 Ext Numeric
     C                     END                             *FI
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR2557' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     99    *
     C                     END
      *
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMCHRC    BEGSR
      *================================================================
      * CHG Head Status/Event  CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0658  2        Order Type_Sale
     C                     Z-ADD*ZERO     WN0659  70       AR Customer Num
     C                     Z-ADD*ZERO     WN0660  70       Ship To Custome
     C                     MOVEL*BLANK    WN0661 30        Ship To Name
     C                     MOVEL*BLANK    WN0662 30        Ship To Address
     C                     MOVEL*BLANK    WN0663 30        Ship To Address
     C                     MOVEL*BLANK    WN0664 30        Ship To Address
     C                     MOVEL*BLANK    WN0665 20        Ship To City
     C                     MOVEL*BLANK    WN0666  2        Ship To State C
     C                     MOVEL*BLANK    WN0667 11        Ship To Zip_Pos
     C                     Z-ADD*ZERO     WN0668  70       Bill to Custome
     C                     MOVEL*BLANK    WN0669 30        Bill to Name
     C                     MOVEL*BLANK    WN0670 30        Bill to Address
     C                     MOVEL*BLANK    WN0671 30        Bill to Address
     C                     MOVEL*BLANK    WN0672 30        Bill to Address
     C                     MOVEL*BLANK    WN0673 20        Bill to City
     C                     MOVEL*BLANK    WN0674  2        Bill to State C
     C                     MOVEL*BLANK    WN0675 11        Bill to Zip_Pos
     C                     MOVEL*BLANK    WN0676 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0677  70       Order Date
     C                     Z-ADD*ZERO     WN0678  70       Requested Ship
     C                     Z-ADD*ZERO     WN0679  70       Cancel Date
     C                     MOVEL*BLANK    WN0680  2        Terms Code
     C                     MOVEL*BLANK    WN0681 40        Special Instruc
     C                     MOVEL*BLANK    WN0682 40        Special Instruc
     C                     MOVEL*BLANK    WN0683  3        Carrier Code
     C                     MOVEL*BLANK    WN0684  1        Comment Print A
     C                     MOVEL*BLANK    WN0685  1        Comment Print I
     C                     MOVEL*BLANK    WN0686  1        Comment Print P
     C                     MOVEL*BLANK    WN0687  1        Comment Print S
     C                     MOVEL*BLANK    WN0688  3        Reason Code
     C                     MOVEL*BLANK    WN0689  1        Order in Use
     C                     MOVEL*BLANK    WN0690  1        Header Status L
     C                     MOVEL*BLANK    WN0691  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0692  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0693 10        User Original E
     C                     Z-ADD*ZERO     WN0694  70       Date of Origina
     C                     Z-ADD*ZERO     WN0695 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0696 112       Order Weight To
     C                     MOVEL*BLANK    WN0697  1        Credit Hold
     C                     MOVEL*BLANK    WN0698  1        Production Hold
     C                     MOVEL*BLANK    WN0699  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0700  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0701  40       Requested Deliv
     C                     MOVEL*BLANK    WN0702  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0703 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0704  70       Load ID
     C                     Z-ADD*ZERO     WN0705  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0706 112       Rated Freight
     C                     MOVEL*BLANK    WN0707  1        LTL Flag
     C                     MOVEL*BLANK    WN0708  1        Price Audit
     C                     MOVEL*BLANK    WN0709  1        Price Status
     C                     MOVEL*BLANK    WN0710  2        Shipping Method
     C                     MOVEL*BLANK    WN0711  1        Export Status
     C                     MOVEL*BLANK    WN0712  1        Palletize
     C                     MOVEL*BLANK    WN0713  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0714  1        Slip Sheet
     C                     MOVEL*BLANK    WN0715  1        Age Code
     C                     Z-ADD*ZERO     WN0716  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0717  1        Load Type
     C                     Z-ADD*ZERO     WN0718  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0719  1        Load Plan Order
     C                     MOVEL*BLANK    WN0720  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0721  70       Resell Referenc
     C                     MOVEL*BLANK    WN0722 30        Special Comment
     C                     MOVEL*BLANK    WN0723 30        Special Comment
     C                     MOVEL*BLANK    WN0724  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0725  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0726  2        Manager Level C
     C                     MOVEL*BLANK    WN0727  3        VP Level Code
     C                     Z-ADD*ZERO     WN0728  70       Attach to Order
     C                     MOVEL*BLANK    WN0729  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0730  70       Invoice Number
     C                     MOVEL*BLANK    WN0731  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0732  70       Invoice Date
     C                     MOVEL*BLANK    WN0733  1        Trans Contol AS
     C                     Z-ADD*ZERO     WN0734 112       A_R order Value
     C                     MOVEL*BLANK    WN0735  1        Billing Activit
     C                     MOVEL*BLANK    WN0736  1        Block Order Fla
     C                     MOVEL*BLANK    WN0737  1        Order Certifica
     C                     Z-ADD*ZERO     WN0738 112       Invoice Order V
     C                     MOVEL*BLANK    WN0739  1        Process Sts for
     C                     MOVEL*BLANK    WN0740  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0741  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0742  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0743  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0744  1        Email Cust On O
     C                     MOVEL*BLANK    WN0745  1        Order Emailed
     C                     MOVEL*BLANK    WN0746  1        Export Docs Go
     C                     MOVEL*BLANK    WN0747  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0748  1        Broker Order St
     C                     MOVEL*BLANK    WN0749  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0750  2        Order Requires
     C                     MOVEL*BLANK    WN0751  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0752  2        Export USDA App
     C                     MOVEL*BLANK    WN0753  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0754  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0755  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0756  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0757  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0758  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0759  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0760  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0761  60       Time of Origina
     C                     Z-ADD*ZERO     WN0762  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0763  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0764  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0765 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0766 112       Act Non_Ref Frt
     C                     Z-ADD*ZERO     WN0767 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0768 112       OH Total Non_Re
     C                     Z-ADD*ZERO     WN0769 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0770  70       Claim Number
     C                     MOVEL*BLANK    WN0771  1        EDI Status 1
     C                     MOVEL*BLANK    WN0772  1        EDI Status 2
     C                     MOVEL*BLANK    WN0773  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0774  60       Job Time
     C                     MOVEL*BLANK    WN0775 10        User Id
     C                     MOVEL*BLANK    WN0776 10        Job Name
     C                     Z-ADD*ZERO     WN0777  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YJRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWAAIC3    WKAIC3           Company Number
     C                     Z-ADDWAC4NB    WKC4NB           Order Number
      *
     C           KLCHTM    KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKC4NB           Order Number
     C           KLCHTM    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL012.
     C                     MOVEL'LBL012'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TMEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YJRDCS
      * Move non-key fields to @BECPFJ
     C                     Z-ADDWAGNDT    WKGNDT           Actual Shipped
     C                     MOVEL'A'       WKGWST    P      Header Status
     C                     MOVELWAJPCD    WKJPCD    P      Event Code
     C                     MOVELWAZ1ST    WKZ1ST    P      Modified Flag
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WKAATM           Job Time
     C                     MOVEL##USR     WKAYNA           User Id
     C                     MOVEL##PGM     WKA0NA           Job Name
     C                     Z-ADD##JDT     WKAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPARC
     C                     Z-ADDWKAIC3    PAAIC3           Company Number
     C                     Z-ADDWKC4NB    PAC4NB           Order Number
     C                     MOVELWKJNCD    PAJNCD    P      Order Type_Sale
     C                     Z-ADDWKANC7    PAANC7           AR Customer Num
     C                     Z-ADDWKBKC7    PABKC7           Ship To Custome
     C                     MOVELWKBRTX    PABRTX    P      Ship To Name
     C                     MOVELWKHMNA    PAHMNA    P      Ship To Address
     C                     MOVELWKHONA    PAHONA    P      Ship To Address
     C                     MOVELWKHPNA    PAHPNA    P      Ship To Address
     C                     MOVELWKHNNA    PAHNNA    P      Ship To City
     C                     MOVELWKDBCD    PADBCD    P      Ship To State C
     C                     MOVELWKCKTX    PACKTX    P      Ship To Zip_Pos
     C                     Z-ADDWKB0C7    PAB0C7           Bill to Custome
     C                     MOVELWKAETX    PAAETX    P      Bill to Name
     C                     MOVELWKB1NA    PAB1NA    P      Bill to Address
     C                     MOVELWKB3NA    PAB3NA    P      Bill to Address
     C                     MOVELWKB4NA    PAB4NA    P      Bill to Address
     C                     MOVELWKB2NA    PAB2NA    P      Bill to City
     C                     MOVELWKBHCD    PABHCD    P      Bill to State C
     C                     MOVELWKC8TX    PAC8TX    P      Bill to Zip_Pos
     C                     MOVELWKBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDWKA0DT    PAA0DT           Order Date
     C                     Z-ADDWKA5DT    PAA5DT           Requested Ship
     C                     Z-ADDWKGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDWKACDT    PAACDT           Cancel Date
     C                     MOVELWKAQCD    PAAQCD    P      Terms Code
     C                     MOVELWKB6NA    PAB6NA    P      Special Instruc
     C                     MOVELWKBYNA    PABYNA    P      Special Instruc
     C                     MOVELWKBZNA    PABZNA    P      Carrier Code
     C                     MOVELWKGTST    PAGTST    P      Comment Print A
     C                     MOVELWKGVST    PAGVST    P      Comment Print I
     C                     MOVELWKGUST    PAGUST    P      Comment Print P
     C                     MOVELWKQFST    PAQFST    P      Comment Print S
     C                     MOVELWKCQCD    PACQCD    P      Reason Code
     C                     MOVELWKGJST    PAGJST    P      Order in Use
     C                     MOVELWKGWST    PAGWST    P      Header Status
     C                     MOVELWKGXST    PAGXST    P      Header Status L
     C                     MOVELWKGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDWKAODT    PAAODT           Scheduled Ship
     C                     MOVELWKAIVN    PAAIVN    P      User Original E
     C                     Z-ADDWKCXDT    PACXDT           Date of Origina
     C                     Z-ADDWKJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDWKA1WG    PAA1WG           Order Weight To
     C                     MOVELWKXIST    PAXIST    P      Credit Hold
     C                     MOVELWKXJST    PAXJST    P      Production Hold
     C                     MOVELWKXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDWKEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDWKAFTM    PAAFTM           Requested Deliv
     C                     MOVELWKE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELWKE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDWKRMNB    PARMNB           Load ID
     C                     Z-ADDWKTBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDWKR1NB    PAR1NB           Rated Freight
     C                     MOVELWKPJST    PAPJST    P      LTL Flag
     C                     MOVELWKU0ST    PAU0ST    P      Price Audit
     C                     MOVELWKU1ST    PAU1ST    P      Price Status
     C                     MOVELWKQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELWKU2ST    PAU2ST    P      Export Status
     C                     MOVELWKVEST    PAVEST    P      Palletize
     C                     MOVELWKVFST    PAVFST    P      Shrink Wrap
     C                     MOVELWKVGST    PAVGST    P      Slip Sheet
     C                     MOVELWKRPCD    PARPCD    P      Age Code
     C                     Z-ADDWKRNNB    PARNNB           Reefer Temperat
     C                     MOVELWKVDST    PAVDST    P      Load Type
     C                     Z-ADDWKATIN    PAATIN           Attach to Invoi
     C                     MOVELWKU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELWKU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDWKRSRN    PARSRN           Resell Referenc
     C                     MOVELWKMHNA    PAMHNA    P      Special Comment
     C                     MOVELWKMINA    PAMINA    P      Special Comment
     C                     MOVELWKWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELWKR4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELWKBFCD    PABFCD    P      Manager Level C
     C                     MOVELWKQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDWKT3NB    PAT3NB           Attach to Order
     C                     MOVELWKSICD    PASICD    P      Reason for Pric
     C                     Z-ADDWKCONB    PACONB           Invoice Number
     C                     MOVELWKCEST    PACEST    P      Invoice Suffix
     C                     Z-ADDWKAWDT    PAAWDT           Invoice Date
     C                     MOVELWKJPCD    PAJPCD    P      Event Code
     C                     MOVELWKXUST    PAXUST    P      Trans Contol AS
     C                     MOVELWKZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDWKVRVA    PAVRVA           A_R order Value
     C                     MOVELWKOBST    PAOBST    P      Billing Activit
     C                     MOVELWKBCST    PABCST    P      Block Order Fla
     C                     MOVELWKBDST    PABDST    P      Order Certifica
     C                     Z-ADDWKB7VL    PAB7VL           Invoice Order V
     C                     MOVELWKGASX    PAGASX    P      Process Sts for
     C                     MOVELWKGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELWKGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELWKGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELWKFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELWKFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELWKFPSX    PAFPSX    P      Order Emailed
     C                     MOVELWKFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELWKFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELWKFSSX    PAFSSX    P      Broker Order St
     C                     MOVELWKFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELWKFUSX    PAFUSX    P      Order Requires
     C                     MOVELWKFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELWKFWSX    PAFWSX    P      Export USDA App
     C                     MOVELWKFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELWKFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDWKNODT    PANODT           OH Appt Confirm
     C                     Z-ADDWKNPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDWKNQDT    PANQDT           Load Actual Shi
     C                     Z-ADDWKNRDT    PANRDT           Load BOL Comple
     C                     Z-ADDWKNSDT    PANSDT           Load Truck Depa
     C                     Z-ADDWKBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDWKBQTM    PABQTM           Time of Origina
     C                     Z-ADDWKBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDWKBSTM    PABSTM           Load BOL Comple
     C                     Z-ADDWKBTTM    PABTTM           Load Truck Depa
     C                     Z-ADDWKH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDWKH1NX    PAH1NX           Act Non_Ref Frt
     C                     Z-ADDWKH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDWKH3NX    PAH3NX           OH Total Non_Re
     C                     Z-ADDWKH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDWKC0C7    PAC0C7           Claim Number
     C                     MOVELWKUVST    PAUVST    P      EDI Status 1
     C                     MOVELWKUWST    PAUWST    P      EDI Status 2
     C                     MOVELWKUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDWKAATM    PAAATM           Job Time
     C                     MOVELWKAYNA    PAAYNA    P      User Id
     C                     MOVELWKA0NA    PAA0NA    P      Job Name
     C                     Z-ADDWKAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YJRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Change log
      *================================================================
      * E00196 RMC 8/24/12 Chk pfs interface SHPTRN too
      * 12/3/96 PLL  changed if no manifest & Plant so Price Audit = M
      *              removed PAR.Price Audit.  not really being used
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1HGCD           Item Code
     C                     MOVEL*BLANK    P1GMST           Detail Line Sta
     C                     MOVEL*BLANK    P1GNST           Detail Line Sta
     C                     MOVEL*BLANK    P1AGCD           U_M_Ordered
     C                     MOVEL*BLANK    P1R0ST           Work Over_Short
     C                     MOVEL*BLANK    P1FZST           Production Date
     C                     Z-ADD*ZERO     P1AVQT           Quantity Ordere
     C                     Z-ADD*ZERO     P1D0WG           Weight Ordered
     C                     Z-ADD*ZERO     P1CCQT           Quantity Schedu
     C                     Z-ADD*ZERO     P1AUWG           Weight Schedule
     C                     Z-ADD*ZERO     P1CBQT           Quantity Shippe
     C                     Z-ADD*ZERO     P1ATWG           Weight Shipped
     C                     Z-ADD*ZERO     P1A5DT           Requested Ship
     C                     MOVEL*BLANK    P1JPCD           Event Code
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P3BKC7           Ship To Custome
     C                     MOVEL*BLANK    P3BZNA           Carrier Code
     C                     Z-ADD*ZERO     P3JZVA           Order Value Tot
     C                     Z-ADD*ZERO     P3A1WG           Order Weight To
     C                     Z-ADD*ZERO     P3RMNB           Load ID
     C                     MOVEL*BLANK    P3XUST           Trans Contol AS
     C                     MOVEL*BLANK    P3OBST           Billing Activit
      * Clear all neither parameters
     C                     MOVEL*BLANK    P4WKCD           To Warehouse Co
      * Clear all neither parameters
     C                     MOVEL*BLANK    P5A5TX           Inter-Plant Tra
      * Clear all neither parameters
     C                     MOVEL*BLANK    P6KGSC           Create EDI ASN
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAANC7           AR Customer Num
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WAA0DT           Order Date
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WAACDT           Cancel Date
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WAJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WAA1WG           Order Weight To
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WATBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WAATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WARSRN           Resell Referenc
     C                     Z-ADD*ZERO     WAT3NB           Attach to Order
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WAAWDT           Invoice Date
     C                     Z-ADD*ZERO     WAVRVA           A_R order Value
     C                     Z-ADD*ZERO     WAB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WANODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WANPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WANQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WANRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WANSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WABPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WABQTM           Time of Origina
     C                     Z-ADD*ZERO     WABRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WABSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WABTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WAH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WAH1NX           Act Non_Ref Frt
     C                     Z-ADD*ZERO     WAH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WAH3NX           OH Total Non_Re
     C                     Z-ADD*ZERO     WAH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBDPNB           Order Sequence
     C                     Z-ADD*ZERO     WBUENB           Order Secondary
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WBMAVA           Billing Detail
     C                     Z-ADD*ZERO     WBKDVA           Billing Detail
     C                     Z-ADD*ZERO     WBL8VA           Billing Detail
     C                     Z-ADD*ZERO     WBL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WBAYVA           Extended Amount
     C                     Z-ADD*ZERO     WBEXDT           Market Pricing
     C                     Z-ADD*ZERO     WBBZPR           Price Overage O
     C                     Z-ADD*ZERO     WBL6NB           Contract Number
     C                     Z-ADD*ZERO     WBGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WBD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WBCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WBAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WBCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WBATWG           Weight Shipped
     C                     Z-ADD*ZERO     WBAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WBAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WBAKPR           Unit Price
     C                     Z-ADD*ZERO     WBALPR           Unit Price_Cred
     C                     Z-ADD*ZERO     WBAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WBAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WBA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WBB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WBA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WBNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WBNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WBNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WBNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WBNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WBBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WBBVTM           Price Code
     C                     Z-ADD*ZERO     WBBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WBBXTM           Substitution Li
     C                     Z-ADD*ZERO     WBBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WBH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WBH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WBH7NX           OD Item Target
     C                     Z-ADD*ZERO     WBH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WBH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WBDVPR           Order Gate_Fina
     C                     Z-ADD*ZERO     WBDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WBDXPR           OD Gate_Final P
     C                     Z-ADD*ZERO     WBDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WBDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WBGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WBGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WBGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WBPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WBRINY           Item Age Days
     C                     Z-ADD*ZERO     WBTIDT           Production Ovr
     C                     Z-ADD*ZERO     WBTJDT           Production Ovr
     C                     Z-ADD*ZERO     WBTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WBTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WBTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCDPNB           Order Sequence
     C                     Z-ADD*ZERO     WCUENB           Order Secondary
     C                     Z-ADD*ZERO     WCRZNB           Case Sequence N
     C                     Z-ADD*ZERO     WCFOQT           Case Quantity
     C                     Z-ADD*ZERO     WCR0NB           Case Weight
     C                     Z-ADD*ZERO     WCK7DT           Label Date
     C                     Z-ADD*ZERO     WCPFNX           PT Serial Numbe
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCELDT           Production Date
     C                     Z-ADD*ZERO     WCN5WG           Manifest Gross
     C                     Z-ADD*ZERO     WCH5NY           Manifest Total
     C                     Z-ADD*ZERO     WCH6NY           Manifest Co_Par
     C                     Z-ADD*ZERO     WCH7NY           Manifest Pallet
     C                     Z-ADD*ZERO     WCN6WG           HPB Meter Net G
     C                     Z-ADD*ZERO     WCN7WG           Manifest Net We
     C                     Z-ADD*ZERO     WCRBDT           Manifest Unused
     C                     Z-ADD*ZERO     WCITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WCIVNY           HPB Meter Start
     C                     Z-ADD*ZERO     WCIUNY           HPB Meter Endin
     C                     Z-ADD*ZERO     WCIWNY           HPB Meter Total
     C                     Z-ADD*ZERO     WCIXNY           HPB Meter Net W
     C                     Z-ADD*ZERO     WCIYNY           HPB Density Ref
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
     C                     Z-ADD*ZERO     WCLPNZ           Manifest Pallet
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WEBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WEBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WEBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WEBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFY1NX           PFS Company Num
     C                     Z-ADD*ZERO     WFQEDT           PFS Last Update
     C                     Z-ADD*ZERO     WFCUTM           PFS Last Update
     C                     Z-ADD*ZERO     WFB0NY           PFS Hours Betwe
     C                     Z-ADD*ZERO     WFB1NY           PFS Minutes Btw
     C                     Z-ADD*ZERO     WFUXSX           PFS Process Sta
     C                     Z-ADD*ZERO     WFAHNY           PFS Create Date
     C                     Z-ADD*ZERO     WFAINY           PFS Create Time
     C                     Z-ADD*ZERO     WFAJNY           PFS Change Date
     C                     Z-ADD*ZERO     WFAKNY           PFS Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGF5NZ           EDI Company # 9
     C                     Z-ADD*ZERO     WGF6NZ           Hold til ship w
     C                     Z-ADD*ZERO     WGMJDT           Create Date
     C                     Z-ADD*ZERO     WGBETM           Create Time
     C                     Z-ADD*ZERO     WGMKDT           Change Date
     C                     Z-ADD*ZERO     WGBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WHR5NB           Deliver after t
     C                     Z-ADD*ZERO     WHR6NB           Deliver before
     C                     Z-ADD*ZERO     WHTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WHMTCU           Mileage To Cust
     C                     Z-ADD*ZERO     WHW2NB           Co_Cust Overage
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIC4NB           Order Number
     C                     Z-ADD*ZERO     WIDPNB           Order Sequence
     C                     Z-ADD*ZERO     WIUENB           Order Secondary
     C                     Z-ADD*ZERO     WIDIC7           ED Item Code
     C                     Z-ADD*ZERO     WIHJWG           ED Product Net
     C                     Z-ADD*ZERO     WIHKWG           ED Product Net
     C                     Z-ADD*ZERO     WIAONX           ED Product Nbr
     C                     Z-ADD*ZERO     WIAMNX           ED Pieces per B
     C                     Z-ADD*ZERO     WIANNX           ED Bags per Uni
     C                     Z-ADD*ZERO     WIAPNX           ED Total Nbr of
     C                     Z-ADD*ZERO     WIDKPR           ED Product Unit
     C                     Z-ADD*ZERO     WIA9VL           ED Producet Ext
     C                     Z-ADD*ZERO     WIAJNX           ED Consignee Ad
     C                     Z-ADD*ZERO     WIW0DT           ED Nbr of Packi
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Define work field Modified Flag
     C                     MOVEL*BLANK    WUZ1ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLAIC3           Company Number
     C                     Z-ADD*ZERO     WLC4NB           Order Number
     C                     Z-ADD*ZERO     WLRMNB           Load ID
     C                     Z-ADD*ZERO     WLRUNB           Stop_Drop Seque
     C                     Z-ADD*ZERO     WLQWDT           OHE Sail_Flight
     C                     Z-ADD*ZERO     WLQXDT           OHE Port Cut Da
     C                     Z-ADD*ZERO     WLQYDT           OHE Arrival Dat
     C                     Z-ADD*ZERO     WLGINY           OHE Unused Numb
     C                     Z-ADD*ZERO     WLGFNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WLGGNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WLGHNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WLHEVL           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WLHFVL           OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WLHGVL           Transload Termi
     C                     Z-ADD*ZERO     WLQZDT           OHE Est Arrv at
     C                     Z-ADD*ZERO     WLQ0DT           OHE Backhaul ET
     C                     Z-ADD*ZERO     WLQ1DT           OHE Port_Pier P
     C                     Z-ADD*ZERO     WLQ2DT           OHE Actual Ship
     C                     Z-ADD*ZERO     WLITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WLQJNY           OHE Backhaul Re
     C                     Z-ADD*ZERO     WLQKNY           LD Stop_Drop
     C                     Z-ADD*ZERO     WLQLNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WLP8NY           OHE Pier Pass F
     C                     Z-ADD*ZERO     WLP9NY           OHE Port Check
     C                     Z-ADD*ZERO     WLQANY           OHE Port Cut Ti
     C                     Z-ADD*ZERO     WLQCNY           OHE Backhaul Tr
     C                     Z-ADD*ZERO     WLQDNY           OHE Load Sched
     C                     Z-ADD*ZERO     WLQENY           Original Appoin
     C                     Z-ADD*ZERO     WLQFNY           Original Appoin
     C                     Z-ADD*ZERO     WLQGNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WLQHNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WLQINY           OHE Unused Nume
     C                     Z-ADD*ZERO     WLQMNY           OHE Orig ABS Fr
     C                     Z-ADD*ZERO     WLW5DT           OHE Unused Date
     C                     Z-ADD*ZERO     WLW6DT           OHE Unused Date
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Production Hold
     C                     MOVEL*BLANK    WUXJST  1
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOEZNB           Telephone Numbe
     C                     Z-ADD*ZERO     WOEEDT           Carrier Last Us
     C                     Z-ADD*ZERO     WONRVA           Pallet Balance
     C                     Z-ADD*ZERO     WONSVA           Long hook balan
     C                     Z-ADD*ZERO     WONTVA           Short hook bala
     C                     Z-ADD*ZERO     WONUVA           Tub Balance
     C                     Z-ADD*ZERO     WOS8NB           Home Phone
     C                     Z-ADD*ZERO     WOS9NB           Other Phone
     C                     Z-ADD*ZERO     WONMVA           Flat Rate
     C                     Z-ADD*ZERO     WONOVA           Rate Per Pound
     C                     Z-ADD*ZERO     WONPVA           Unused Rate Per
     C                     Z-ADD*ZERO     WONQVA           Miscellaneous C
     C                     Z-ADD*ZERO     WOQXNB           Unused Mile Ran
     C                     Z-ADD*ZERO     WOQ1NB           Unused Mile Ran
     C                     Z-ADD*ZERO     WOMRNG           Unused Mile Ran
     C                     Z-ADD*ZERO     WOMRNE           Unused Mile Ran
     C                     Z-ADD*ZERO     WORFNB           Unused Mile Ran
     C                     Z-ADD*ZERO     WOMREG           Unused Mile Ran
     C                     Z-ADD*ZERO     WOBQPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WOBRPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WOBSPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WOBTPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WOBUPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WOBVPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WODJWG           Unused Weight R
     C                     Z-ADD*ZERO     WODKWG           Unused Weight R
     C                     Z-ADD*ZERO     WODLWG           Unused Weight R
     C                     Z-ADD*ZERO     WODMWG           Unused Weight R
     C                     Z-ADD*ZERO     WODNWG           Unused Weight R
     C                     Z-ADD*ZERO     WODOWG           Unused Weight R
     C                     Z-ADD*ZERO     WOB2PR           Unused Weight R
     C                     Z-ADD*ZERO     WOB3PR           Unused Weight R
     C                     Z-ADD*ZERO     WOB4PR           Unused Weight R
     C                     Z-ADD*ZERO     WOB5PR           Unused Weight R
     C                     Z-ADD*ZERO     WOB6PR           Unused Weight R
     C                     Z-ADD*ZERO     WOB7PR           Unused Weight R
     C                     Z-ADD*ZERO     WOAAC7           Contact Number
     C                     Z-ADD*ZERO     WOTENO           Carrier Unused
     C                     Z-ADD*ZERO     WOAOFC           Amount of Cargo
     C                     Z-ADD*ZERO     WOAOLI           Amount of Liabi
     C                     Z-ADD*ZERO     WOKHDT           Date of Expirat
     C                     Z-ADD*ZERO     WOAATM           Job Time
     C                     Z-ADD*ZERO     WOAXDT           Job Date
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field Total Load Order Weight
     C                     Z-ADD*ZERO     WURPNB  70
      * Define work field Total Freight
     C                     Z-ADD*ZERO     WURQNB 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WRAIC3           Company Number
     C                     Z-ADD*ZERO     WRC4NB           Order Number
     C                     Z-ADD*ZERO     WRDPNB           Order Sequence
     C                     Z-ADD*ZERO     WRUENB           Order Secondary
     C                     Z-ADD*ZERO     WRALSW           Allocation Seq
     C                     Z-ADD*ZERO     WRJ6QT           OIA Alloc_Shipp
     C                     Z-ADD*ZERO     WRG9WG           OIA Alloc_Shipp
     C                     Z-ADD*ZERO     WRJ9QT           OIA Co-Packer L
     C                     Z-ADD*ZERO     WRHAWG           OIA Serial Numb
     C                     Z-ADD*ZERO     WRHGCD           Item Code
     C                     Z-ADD*ZERO     WRELDT           Production Date
     C                     Z-ADD*ZERO     WRLXNM           Lot Number
     C                     Z-ADD*ZERO     WRYNCD           Location Level
     C                     Z-ADD*ZERO     WRAATM           Job Time
     C                     Z-ADD*ZERO     WRAXDT           Job Date
      * Define work field LTT Unused Sts 1
     C                     MOVEL*BLANK    WULLTU  1
      * Define work field LTT Unused Sts 2
     C                     MOVEL*BLANK    WULLYT  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WSAIC3           Company Number
     C                     Z-ADD*ZERO     WSHGCD           Item Code
     C                     Z-ADD*ZERO     WSLRDT           LLT Transaction
     C                     Z-ADD*ZERO     WSLLTS           LLT Sequence Nu
     C                     Z-ADD*ZERO     WSLSDT           LLT Production
     C                     Z-ADD*ZERO     WSJ5QT           LLT Transaction
     C                     Z-ADD*ZERO     WSG8WG           LLT Transaction
     C                     Z-ADD*ZERO     WSLLTN           LLT Lot Number
     C                     Z-ADD*ZERO     WSLLCL           LLT Location Le
     C                     Z-ADD*ZERO     WSLLTR           LLT Transfer Lo
     C                     Z-ADD*ZERO     WSLLTL           LLT Transfer Lo
     C                     Z-ADD*ZERO     WSC4NB           Order Number
     C                     Z-ADD*ZERO     WSAATM           Job Time
     C                     Z-ADD*ZERO     WSAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WVAIC3           Company Number
     C                     Z-ADD*ZERO     WVHGCD           Item Code
     C                     Z-ADD*ZERO     WVELDT           Production Date
     C                     Z-ADD*ZERO     WVLXNM           Lot Number
     C                     Z-ADD*ZERO     WVYNCD           Location Level
     C                     Z-ADD*ZERO     WVJ2QT           ILL Item Qty On
     C                     Z-ADD*ZERO     WVG5WG           ILL Unit Weight
     C                     Z-ADD*ZERO     WVJ3QT           ILL Co-Packer L
     C                     Z-ADD*ZERO     WVG6WG           ILL Item Wgt On
     C                     Z-ADD*ZERO     WVJ4QT           ILL Unused Qty
     C                     Z-ADD*ZERO     WVG7WG           ILL Unused Wgt
     C                     Z-ADD*ZERO     WVLODT           ILL Avail Ship
     C                     Z-ADD*ZERO     WVLPDT           ILL Unused Date
     C                     Z-ADD*ZERO     WVLQDT           ILL Unused Date
     C                     Z-ADD*ZERO     WVNBR            ILL Unused Nbr
     C                     Z-ADD*ZERO     WVAATM           Job Time
     C                     Z-ADD*ZERO     WVAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WWLCBY           Location Bay
     C                     Z-ADD*ZERO     WWLCCT           Loc Unused Chil
     C                     Z-ADD*ZERO     WWAATM           Job Time
     C                     Z-ADD*ZERO     WWAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WXSLTY           WLT Type Chill
     C                     Z-ADD*ZERO     WXAATM           Job Time
     C                     Z-ADD*ZERO     WXAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WYAIC3           Company Number
     C                     Z-ADD*ZERO     WYHGCD           Item Code
     C                     Z-ADD*ZERO     WYAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WYAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WYAIWG           Unit Weight
     C                     Z-ADD*ZERO     WYCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WYC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WYURTN           Number Cases On
     C                     Z-ADD*ZERO     WYAJC8           Vendor Item Def
     C                     Z-ADD*ZERO     WYRINB           Item Structure
     C                     Z-ADD*ZERO     WYRHNB           Item Structure
     C                     Z-ADD*ZERO     WYRGNB           Item Structure
     C                     Z-ADD*ZERO     WYTFNB           Transportation
     C                     Z-ADD*ZERO     WYTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WYTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WYBLPR           Market Overage
     C                     Z-ADD*ZERO     WYBMPR           Standard Overag
     C                     Z-ADD*ZERO     WYCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WYCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WYSWGH           Std Weight_Head
     C                     Z-ADD*ZERO     WYPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WYICN1           Item Category N
     C                     Z-ADD*ZERO     WYICN2           Item Category N
     C                     Z-ADD*ZERO     WYV2NB           Item Category N
     C                     Z-ADD*ZERO     WYITCN           Item Category N
     C                     Z-ADD*ZERO     WYITC5           Item Category N
     C                     Z-ADD*ZERO     WYICN6           Item Category N
     C                     Z-ADD*ZERO     WYICN7           Item Category N
     C                     Z-ADD*ZERO     WYICN8           Item Category N
     C                     Z-ADD*ZERO     WYICN9           Item Category N
     C                     Z-ADD*ZERO     WYICN0           Item Category N
     C                     Z-ADD*ZERO     WYSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WYA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WYSJNB           Production Lead
     C                     Z-ADD*ZERO     WYSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WYSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WYSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WYCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WYCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WYILNB           Packages per ca
     C                     Z-ADD*ZERO     WYCHNB           Use_Freeze_Sell
     C                     Z-ADD*ZERO     WYCINB           PM Batch Size
     C                     Z-ADD*ZERO     WYCJNB           Package Level s
     C                     Z-ADD*ZERO     WYCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WYCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WYCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WYCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WYCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WYCWNB           PM Std LBS Man
     C                     Z-ADD*ZERO     WYCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WYCZNB           PM Formula LBS
     C                     Z-ADD*ZERO     WYC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WYB4NB           PM Raw Material
     C                     Z-ADD*ZERO     WYB5NB           PM Line Number
     C                     Z-ADD*ZERO     WYBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WYBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WYF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WYF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WYF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WYBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WYBNNB           Production Qty
     C                     Z-ADD*ZERO     WYAATM           Job Time
     C                     Z-ADD*ZERO     WYAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TBAIC3           Company Number
     C                     Z-ADD*ZERO     TBHGCD           Item Code
     C                     Z-ADD*ZERO     TBELDT           Production Date
     C                     Z-ADD*ZERO     TBABWG           Physical Count
     C                     Z-ADD*ZERO     TBAGQT           Physical Count
     C                     Z-ADD*ZERO     TBAHQT           Physical Count
     C                     Z-ADD*ZERO     TBAIQT           Physical Count
     C                     Z-ADD*ZERO     TBACWG           Quantity on Han
     C                     Z-ADD*ZERO     TBARQT           Quantity on Han
     C                     Z-ADD*ZERO     TBASQT           Quantity on Han
     C                     Z-ADD*ZERO     TBATQT           Quantity on Han
     C                     Z-ADD*ZERO     TBHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     TBHEQT           Weight In Chill
     C                     Z-ADD*ZERO     TBBMWG           Physical Start
     C                     Z-ADD*ZERO     TBDSQT           Physical Start
     C                     Z-ADD*ZERO     TBDTQT           Physical Start
     C                     Z-ADD*ZERO     TBDUQT           Physical Start
     C                     Z-ADD*ZERO     TBDHDT           Physical Start
     C                     Z-ADD*ZERO     TBAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     TBAECS           Last Cost
     C                     Z-ADD*ZERO     TBIDVA           Value of On Han
     C                     Z-ADD*ZERO     TBK7DT           Label Date
     C                     Z-ADD*ZERO     TBRINB           Item Structure
     C                     Z-ADD*ZERO     TBRHNB           Item Structure
     C                     Z-ADD*ZERO     TBRGNB           Item Structure
     C                     Z-ADD*ZERO     TBAATM           Job Time
     C                     Z-ADD*ZERO     TBAXDT           Job Date
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SDCHRC.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     Z-ADD*ZERO     WL0003  30
     C                     Z-ADD*ZERO     WL0004  30
     C                     MOVEL*BLANK    WL0005  1
     C                     MOVEL*BLANK    WL0006  1
     C                     Z-ADD*ZERO     WL0007 112
     C                     Z-ADD*ZERO     WL0008 112
     C                     Z-ADD*ZERO     WL0009 112
     C                     Z-ADD*ZERO     WL0010 112
     C                     MOVEL*BLANK    WL0011  1
     C                     MOVEL*BLANK    WL0012  3
     C                     MOVEL*BLANK    WL0013  2
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0014  30
     C                     MOVEL*BLANK    WL0015  6
     C                     MOVEL*BLANK    WL0016  1
     C                     MOVEL*BLANK    WL0017  1
      * Define local variables for subroutine SLCHRC.
     C                     Z-ADD*ZERO     WL0018  30
     C                     Z-ADD*ZERO     WL0019  70
     C                     Z-ADD*ZERO     WL0020  30
     C                     Z-ADD*ZERO     WL0021  30
     C                     Z-ADD*ZERO     WL0022 112
     C                     Z-ADD*ZERO     WL0023 112
     C                     Z-ADD*ZERO     WL0024 112
     C                     Z-ADD*ZERO     WL0025 112
     C                     Z-ADD*ZERO     WL0026 114
     C                     Z-ADD*ZERO     WL0027 114
      * Define local variables for subroutine SZRVGN.
     C                     Z-ADD*ZERO     WL0028  30
     C                     Z-ADD*ZERO     WL0029  70
     C                     MOVEL*BLANK    WL0030  3
     C                     MOVEL*BLANK    WL0031  2
     C                     Z-ADD*ZERO     WL0032  70
     C                     Z-ADD*ZERO     WL0033  30
      * Define local variables for subroutine TACRRC.
     C                     Z-ADD*ZERO     WL0034  30
     C                     Z-ADD*ZERO     WL0035  70
     C                     MOVEL*BLANK    WL0036  3
     C                     MOVEL*BLANK    WL0037  2
     C                     Z-ADD*ZERO     WL0038  70
     C                     Z-ADD*ZERO     WL0039  30
     C                     Z-ADD*ZERO     WL0040  70
     C                     Z-ADD*ZERO     WL0041  50
     C                     Z-ADD*ZERO     WL0042 112
     C                     Z-ADD*ZERO     WL0043  50
     C                     MOVEL*BLANK    WL0044  4
     C                     Z-ADD*ZERO     WL0045  20
     C                     MOVEL*BLANK    WL0046  3
     C                     Z-ADD*ZERO     WL0047  50
     C                     MOVEL*BLANK    WL0048  4
     C                     Z-ADD*ZERO     WL0049  20
     C                     Z-ADD*ZERO     WL0050  70
     C                     MOVEL*BLANK    WL0051  1
     C                     MOVEL*BLANK    WL0052  1
     C                     MOVEL*BLANK    WL0053  1
     C                     MOVEL*BLANK    WL0054  1
     C                     MOVEL*BLANK    WL0055  1
     C                     MOVEL*BLANK    WL0056  1
     C                     MOVEL*BLANK    WL0057  1
     C                     Z-ADD*ZERO     WL0058  60
     C                     MOVEL*BLANK    WL0059 10
     C                     MOVEL*BLANK    WL0060 10
     C                     Z-ADD*ZERO     WL0061  70
      * Define local variables for subroutine TBRVGN.
     C                     Z-ADD*ZERO     WL0062  30
     C                     Z-ADD*ZERO     WL0063  70
     C                     MOVEL*BLANK    WL0064  3
     C                     Z-ADD*ZERO     WL0065  70
     C                     Z-ADD*ZERO     WL0066  50
     C                     MOVEL*BLANK    WL0067  4
     C                     Z-ADD*ZERO     WL0068  20
     C                     Z-ADD*ZERO     WL0069  70
     C                     Z-ADD*ZERO     WL0070 112
      * Define local variables for subroutine TCRVGN.
     C                     MOVEL*BLANK    WL0071  3
     C                     MOVEL*BLANK    WL0072  4
     C                     MOVEL*BLANK    WL0073  1
      * Define local variables for subroutine TDRVGN.
     C                     MOVEL*BLANK    WL0074  1
     C                     Z-ADD*ZERO     WL0075  52
      * Define local variables for subroutine TERVGN.
     C                     Z-ADD*ZERO     WL0076  30
     C                     Z-ADD*ZERO     WL0077  70
     C                     Z-ADD*ZERO     WL0078 112
     C                     MOVEL*BLANK    WL0079  2
      * Define local variables for subroutine TFCRRC.
     C                     Z-ADD*ZERO     WL0080  30
     C                     Z-ADD*ZERO     WL0081  70
     C                     MOVEL*BLANK    WL0082  3
     C                     Z-ADD*ZERO     WL0083  70
     C                     Z-ADD*ZERO     WL0084  50
     C                     MOVEL*BLANK    WL0085  4
     C                     Z-ADD*ZERO     WL0086  20
     C                     Z-ADD*ZERO     WL0087  50
     C                     Z-ADD*ZERO     WL0088 112
     C                     Z-ADD*ZERO     WL0089  50
     C                     Z-ADD*ZERO     WL0090 112
     C                     Z-ADD*ZERO     WL0091  50
     C                     Z-ADD*ZERO     WL0092 112
     C                     Z-ADD*ZERO     WL0093  70
     C                     Z-ADD*ZERO     WL0094  70
     C                     Z-ADD*ZERO     WL0095  70
     C                     Z-ADD*ZERO     WL0096  72
     C                     MOVEL*BLANK    WL0097  6
     C                     MOVEL*BLANK    WL0098  1
     C                     MOVEL*BLANK    WL0099  1
     C                     MOVEL*BLANK    WL0100  1
     C                     MOVEL*BLANK    WL0101  2
     C                     MOVEL*BLANK    WL0102  3
     C                     MOVEL*BLANK    WL0103  1
     C                     MOVEL*BLANK    WL0104  1
     C                     MOVEL*BLANK    WL0105  1
     C                     MOVEL*BLANK    WL0106  1
     C                     Z-ADD*ZERO     WL0107  60
     C                     MOVEL*BLANK    WL0108 10
     C                     MOVEL*BLANK    WL0109 10
     C                     Z-ADD*ZERO     WL0110  70
      * Define local variables for subroutine THDLRC.
     C                     Z-ADD*ZERO     WL0111  30
     C                     Z-ADD*ZERO     WL0112  70
     C                     MOVEL*BLANK    WL0113  3
     C                     Z-ADD*ZERO     WL0114  70
     C                     Z-ADD*ZERO     WL0115  50
     C                     MOVEL*BLANK    WL0116  4
     C                     Z-ADD*ZERO     WL0117  20
      * Define local variables for subroutine TIRVGN.
     C                     Z-ADD*ZERO     WL0118  30
     C                     Z-ADD*ZERO     WL0119  70
     C                     MOVEL*BLANK    WL0120  3
     C                     Z-ADD*ZERO     WL0121  70
      * Define local variables for subroutine TKCHRC.
     C                     Z-ADD*ZERO     WL0122  30
     C                     Z-ADD*ZERO     WL0123  70
     C                     Z-ADD*ZERO     WL0124  30
     C                     Z-ADD*ZERO     WL0125  30
     C                     Z-ADD*ZERO     WL0126  50
     C                     MOVEL*BLANK    WL0127  1
      * Define local work field WHS Live with Carlisle
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field PFS AccuSort Active
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field PFS Carlisle Active
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Record Status Save
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field AR Customer Number
     C                     Z-ADD*ZERO     YL0005  70
      * Define local work field Bill to Customer
     C                     Z-ADD*ZERO     YL0006  70
      * Define local work field Trans Contol AS400_Plant
     C                     MOVEL*BLANK    YL0007  1
      * Define local work field Warehouse Location
     C                     MOVEL*BLANK    YL0008  1
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0009  30
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0010  30
      * Define local work field WHS Live with Carlisle
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field PFS AccuSort Active
     C                     MOVEL*BLANK    YL0012  1
      * Define local work field PFS Carlisle Active
     C                     MOVEL*BLANK    YL0013  1
      * Define local work field First Time Through USR
     C                     MOVEL*BLANK    YL0014  1
      * Define local work field Send Email f/Failed API U
     C                     MOVEL*BLANK    YL0015  1
      * Define local work field ED Product Net Weight MT
     C                     Z-ADD*ZERO     YL0016  74
      * Define local work field ED Total Nbr of Pieces
     C                     Z-ADD*ZERO     YL0017  90
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0018  1
      * Define local work field Quality Level
     C                     MOVEL*BLANK    YL0019  2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Y2U0003
00002 PUEJXFR
