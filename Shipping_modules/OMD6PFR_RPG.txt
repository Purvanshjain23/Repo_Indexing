     H/TITLE Prt Load List          PF Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Print file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 04/06/21  Time  : 16:02:17
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FOMFJCPMJIF  E           K        DISK
      * RSQ : Load Header               SSD/UM/Exp(d)/Seq/Load
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FCAAMREL1IF  E           K        DISK
      * RTV : Unit of Measure           Retrieval index       NV
      *
     FOMFLCPL4IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop(Desc)/Order
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FOMFFREL0IF  E           K        DISK
      * RTV : Carrier                   Retrieval index
      *
     FPMAMREL1IF  E           K        DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FPDLCREL0IF  E           K        DISK
      * RTV : Shipping Line/Port        Retrieval index
      *
     FOMFLCPL1IF  E           K        DISK
      * RTV : Load Detail               Retrieval index
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FPDKECPL1IF  E           K        DISK
      * RTV : Traffic Comments          Retrieval index
      *
     FOPBFCPL8IF  E           K        DISK
      * RSQ : Order Header TRG          Load #/All orders
      *
     FOPBFCPLGIF  E           K        DISK
      * RSQ : Order Header TRG          Load Id/Order Num
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FOMD6PFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: Prt Load List          PF Print file
      *
     E                    UCT        40  1               CENTER TABLE
     E                    #L3         3  1
     E                    #L7         7  1
      * Long constants
     E                    @CN#    1  04  6   @CN    25
     I@FJCPBN
      * Load Header               Retrieval index
      * Renamed input format fields
     I              FJRMNB                          WARMNB
     I              FJAIC3                          WAAIC3
     I              FJAODT                          WAAODT
     I              FJPJST                          WAPJST
     I              FJPKST                          WAPKST
     I              FJRNNB                          WARNNB
     I              FJDMTX                          WADMTX
     I              FJDNTX                          WADNTX
     I              FJDOTX                          WADOTX
     I              FJWTTX                          WAWTTX
     I              FJWUTX                          WAWUTX
     I              FJRPNB                          WARPNB
     I              FJFLAM                          WAFLAM
     I              FJXQST                          WAXQST
     I              FJRRNB                          WARRNB
     I              FJDXTX                          WADXTX
     I              FJDYTX                          WADYTX
     I              FJSBNB                          WASBNB
     I              FJBZNA                          WABZNA
     I              FJRONB                          WARONB
     I              FJSQNB                          WASQNB
     I              FJR1NB                          WAR1NB
     I              FJVCST                          WAVCST
     I              FJVDST                          WAVDST
     I              FJSDNB                          WASDNB
     I              FJPAOU                          WAPAOU
     I              FJDGWG                          WADGWG
     I              FJSXNB                          WASXNB
     I              FJHADT                          WAHADT
     I              FJAART                          WAAART
     I              FJDHWG                          WADHWG
     I              FJDIWG                          WADIWG
     I              FJAQDT                          WAAQDT
     I              FJS6NB                          WAS6NB
     I              FJT4NB                          WAT4NB
     I              FJPRTM                          WAPRTM
     I              FJNPSV                          WANPSV
     I              FJJ8TX                          WAJ8TX
     I              FJTLMI                          WATLMI
     I              FJJ9TX                          WAJ9TX
     I              FJQ2CD                          WAQ2CD
     I              FJVPCD                          WAVPCD
     I              FJDBCD                          WADBCD
     I              FJGRWE                          WAGRWE
     I              FJXCCD                          WAXCCD
     I              FJU2ST                          WAU2ST
     I              FJF9DT                          WAF9DT
     I              FJONTM                          WAONTM
     I              FJJ4DT                          WAJ4DT
     I              FJTRTM                          WATRTM
     I              FJJ5DT                          WAJ5DT
     I              FJSPTM                          WASPTM
     I              FJJ6DT                          WAJ6DT
     I              FJLFTM                          WALFTM
     I              FJJ7DT                          WAJ7DT
     I              FJBOTM                          WABOTM
     I              FJJ8DT                          WAJ8DT
     I              FJBLTM                          WABLTM
     I              FJKIDT                          WAKIDT
     I              FJASTM                          WAASTM
     I              FJKADT                          WAKADT
     I              FJAJCM                          WAAJCM
     I              FJXACD                          WAXACD
     I              FJOANA                          WAOANA
     I              FJK4TX                          WAK4TX
     I              FJVOAG                          WAVOAG
     I              FJKBDT                          WAKBDT
     I              FJNBBO                          WANBBO
     I              FJW4CD                          WAW4CD
     I              FJEFDT                          WAEFDT
     I              FJCNTN                          WACNTN
     I              FJKCDT                          WAKCDT
     I              FJTMIN                          WATMIN
     I              FJKDDT                          WAKDDT
     I              FJVMNB                          WAVMNB
     I              FJOCFR                          WAOCFR
     I              FJKJDT                          WAKJDT
     I              FJATTM                          WAATTM
     I              FJOTRS                          WAOTRS
     I              FJRNST                          WARNST
     I              FJBRBK                          WABRBK
     I              FJEIDT                          WAEIDT
     I              FJRMST                          WARMST
     I              FJAJCD                          WAAJCD
     I              FJKKDT                          WAKKDT
     I              FJAVTM                          WAAVTM
     I              FJKZDT                          WAKZDT
     I              FJAXTM                          WAAXTM
     I              FJLHOS                          WALHOS
     I              FJLHOR                          WALHOR
     I              FJWNTX                          WAWNTX
     I              FJOITX                          WAOITX
     I              FJOJTX                          WAOJTX
     I              FJLLDT                          WALLDT
     I              FJLSHG                          WALSHG
     I              FJYPST                          WAYPST
     I              FJK0DT                          WAK0DT
     I              FJAYTM                          WAAYTM
     I              FJKNNX                          WAKNNX
     I              FJICWG                          WAICWG
     I              FJIDWG                          WAIDWG
     I              FJH9SX                          WAH9SX
     I              FJWOTX                          WAWOTX
     I              FJK1DT                          WAK1DT
     I              FJAZTM                          WAAZTM
     I              FJK2DT                          WAK2DT
     I              FJA0TM                          WAA0TM
     I              FJROST                          WAROST
     I              FJRPST                          WARPST
     I              FJRQST                          WARQST
     I              FJRRST                          WARRST
     I              FJZBVA                          WAZBVA
     I              FJWPTX                          WAWPTX
     I              FJWQTX                          WAWQTX
     I              FJWRTX                          WAWRTX
     I              FJWSTX                          WAWSTX
     I              FJRVSX                          WARVSX
     I              FJRUSX                          WARUSX
     I              FJRWSX                          WARWSX
     I              FJRXSX                          WARXSX
     I              FJRYSX                          WARYSX
     I              FJRZSX                          WARZSX
     I              FJR0SX                          WAR0SX
     I              FJR1SX                          WAR1SX
     I              FJR2SX                          WAR2SX
     I              FJR3SX                          WAR3SX
     I              FJR4SX                          WAR4SX
     I              FJPYDT                          WAPYDT
     I              FJCKTM                          WACKTM
     I              FJPZDT                          WAPZDT
     I              FJCLTM                          WACLTM
     I              FJP0DT                          WAP0DT
     I              FJCMTM                          WACMTM
     I              FJP1DT                          WAP1DT
     I              FJCNTM                          WACNTM
     I              FJP2DT                          WAP2DT
     I              FJCOTM                          WACOTM
     I              FJP3DT                          WAP3DT
     I              FJCQTM                          WACQTM
     I              FJUVST                          WAUVST
     I              FJUWST                          WAUWST
     I              FJUXST                          WAUXST
     I              FJAATM                          WAAATM
     I              FJAYNA                          WAAYNA
     I              FJA0NA                          WAA0NA
     I              FJAXDT                          WAAXDT
      *
     I@AMREJF
      * Order Header Extension    Retrieval index
      * Renamed input format fields
     I              AMAIC3                          WBAIC3
     I              AMC4NB                          WBC4NB
     I              AMRMNB                          WBRMNB
     I              AMRUNB                          WBRUNB
     I              AMXACD                          WBXACD
     I              AMOANA                          WBOANA
     I              AMHBAA                          WBHBAA
     I              AMJ0T1                          WBJ0T1
     I              AMGENY                          WBGENY
     I              AMJ1T1                          WBJ1T1
     I              AMHCAA                          WBHCAA
     I              AMQWDT                          WBQWDT
     I              AMQXDT                          WBQXDT
     I              AMQYDT                          WBQYDT
     I              AMHDAA                          WBHDAA
     I              AMCCTX                          WBCCTX
     I              AMJ2T1                          WBJ2T1
     I              AMRLNA                          WBRLNA
     I              AMRMNA                          WBRMNA
     I              AMGINY                          WBGINY
     I              AMGFNY                          WBGFNY
     I              AMGGNY                          WBGGNY
     I              AMGHNY                          WBGHNY
     I              AMHEVL                          WBHEVL
     I              AMHFVL                          WBHFVL
     I              AMHGVL                          WBHGVL
     I              AMQZDT                          WBQZDT
     I              AMQ0DT                          WBQ0DT
     I              AMQ1DT                          WBQ1DT
     I              AMQ2DT                          WBQ2DT
     I              AMC2TX                          WBC2TX
     I              AMC3TX                          WBC3TX
     I              AMC6TX                          WBC6TX
     I              AMCHTX                          WBCHTX
     I              AMCITX                          WBCITX
     I              AMCLTX                          WBCLTX
     I              AMB4TX                          WBB4TX
     I              AMCUTX                          WBCUTX
     I              AMCVTX                          WBCVTX
     I              AMB9TX                          WBB9TX
     I              AMJWSC                          WBJWSC
     I              AMITNY                          WBITNY
     I              AMLMT1                          WBLMT1
     I              AMLWAA                          WBLWAA
     I              AMFVST                          WBFVST
     I              AMF0ST                          WBF0ST
     I              AMF2ST                          WBF2ST
     I              AMF3ST                          WBF3ST
     I              AMJUSC                          WBJUSC
     I              AMJVSC                          WBJVSC
     I              AMV3T1                          WBV3T1
     I              AMV4T1                          WBV4T1
     I              AMV5T1                          WBV5T1
     I              AMV6T1                          WBV6T1
     I              AMV7T1                          WBV7T1
     I              AMV8T1                          WBV8T1
     I              AMV9T1                          WBV9T1
     I              AMWAT1                          WBWAT1
     I              AMWBT1                          WBWBT1
     I              AMWCT1                          WBWCT1
     I              AMWDT1                          WBWDT1
     I              AMQJNY                          WBQJNY
     I              AMQKNY                          WBQKNY
     I              AMQLNY                          WBQLNY
     I              AMP8NY                          WBP8NY
     I              AMP9NY                          WBP9NY
     I              AMQANY                          WBQANY
     I              AMQCNY                          WBQCNY
     I              AMQDNY                          WBQDNY
     I              AMQENY                          WBQENY
     I              AMQFNY                          WBQFNY
     I              AMQGNY                          WBQGNY
     I              AMQHNY                          WBQHNY
     I              AMQINY                          WBQINY
     I              AMQMNY                          WBQMNY
     I              AMMYU1                          WBMYU1
     I              AMJXSC                          WBJXSC
     I              AMJYSC                          WBJYSC
     I              AMJZSC                          WBJZSC
     I              AMJ0SC                          WBJ0SC
     I              AMMZU1                          WBMZU1
     I              AMM0U1                          WBM0U1
     I              AMM1U1                          WBM1U1
     I              AMM2U1                          WBM2U1
     I              AMM3U1                          WBM3U1
     I              AMW5DT                          WBW5DT
     I              AMW6DT                          WBW6DT
     I              AMUVST                          WBUVST
     I              AMUWST                          WBUWST
     I              AMUXST                          WBUXST
     I              AMVSST                          WBVSST
     I              AMAATM                          WBAATM
     I              AMAYNA                          WBAYNA
     I              AMA0NA                          WBA0NA
     I              AMAXDT                          WBAXDT
      *
     I@FLCPBW
      * Load Detail               Retrieval index
      * Renamed input format fields
     I              FLRMNB                          WCRMNB
     I              FLRUNB                          WCRUNB
     I              FLRVNB                          WCRVNB
     I              FLDQTX                          WCDQTX
     I              FLRWNB                          WCRWNB
     I              FLRXNB                          WCRXNB
     I              FLSQNB                          WCSQNB
     I              FLT0NB                          WCT0NB
     I              FLT1NB                          WCT1NB
     I              FLR1NB                          WCR1NB
     I              FLAIC3                          WCAIC3
     I              FLC4NB                          WCC4NB
     I              FLVCST                          WCVCST
     I              FLKEDT                          WCKEDT
     I              FLSXNB                          WCSXNB
     I              FLKFDT                          WCKFDT
     I              FLACTM                          WCACTM
     I              FLK5TX                          WCK5TX
     I              FLW5CD                          WCW5CD
     I              FLEJDT                          WCEJDT
     I              FLAGTM                          WCAGTM
     I              FLKJDT                          WCKJDT
     I              FLATTM                          WCATTM
     I              FLHDDT                          WCHDDT
     I              FLAUTM                          WCAUTM
     I              FLKKDT                          WCKKDT
     I              FLAVTM                          WCAVTM
     I              FLZ4NB                          WCZ4NB
     I              FLY7ST                          WCY7ST
     I              FLY2ST                          WCY2ST
     I              FLWHTX                          WCWHTX
     I              FLWITX                          WCWITX
     I              FLWJTX                          WCWJTX
     I              FLWKTX                          WCWKTX
     I              FLWLTX                          WCWLTX
     I              FLN7DT                          WCN7DT
     I              FLN8DT                          WCN8DT
     I              FLN9DT                          WCN9DT
     I              FLB3TM                          WCB3TM
     I              FLB4TM                          WCB4TM
     I              FLB5TM                          WCB5TM
     I              FLIASX                          WCIASX
     I              FLIBSX                          WCIBSX
     I              FLICSX                          WCICSX
     I              FLWVTX                          WCWVTX
     I              FLWWTX                          WCWWTX
     I              FLWXTX                          WCWXTX
     I              FLUVST                          WCUVST
     I              FLUWST                          WCUWST
     I              FLUXST                          WCUXST
     I              FLAATM                          WCAATM
     I              FLAYNA                          WCAYNA
     I              FLA0NA                          WCA0NA
     I              FLAXDT                          WCAXDT
      *
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                          WDAIC3
     I              OMC4NB                          WDC4NB
     I              OMDPNB                          WDDPNB
     I              OMUENB                          WDUENB
     I              OMHGCD                          WDHGCD
     I              OMAJCD                          WDAJCD
     I              OMBKC7                          WDBKC7
     I              OMCFC7                          WDCFC7
     I              OMGMST                          WDGMST
     I              OMGNST                          WDGNST
     I              OMMAVA                          WDMAVA
     I              OMKDVA                          WDKDVA
     I              OML8VA                          WDL8VA
     I              OML9VA                          WDL9VA
     I              OMGTST                          WDGTST
     I              OMGVST                          WDGVST
     I              OMGUST                          WDGUST
     I              OMQFST                          WDQFST
     I              OMAYVA                          WDAYVA
     I              OMEXDT                          WDEXDT
     I              OMLQCD                          WDLQCD
     I              OMRDCD                          WDRDCD
     I              OMQ7CD                          WDQ7CD
     I              OMBZPR                          WDBZPR
     I              OML6NB                          WDL6NB
     I              OMU1ST                          WDU1ST
     I              OMGIDT                          WDGIDT
     I              OMCRCD                          WDCRCD
     I              OMAGCD                          WDAGCD
     I              OMRZST                          WDRZST
     I              OMR0ST                          WDR0ST
     I              OMR1ST                          WDR1ST
     I              OMG7NA                          WDG7NA
     I              OMG8NA                          WDG8NA
     I              OMRPCD                          WDRPCD
     I              OMVEST                          WDVEST
     I              OMVGST                          WDVGST
     I              OMAVST                          WDAVST
     I              OMU0ST                          WDU0ST
     I              OMRFCD                          WDRFCD
     I              OMFZST                          WDFZST
     I              OMR1NB                          WDR1NB
     I              OMAVQT                          WDAVQT
     I              OMD0WG                          WDD0WG
     I              OMCCQT                          WDCCQT
     I              OMAUWG                          WDAUWG
     I              OMCBQT                          WDCBQT
     I              OMATWG                          WDATWG
     I              OMAQCS                          WDAQCS
     I              OMAGCS                          WDAGCS
     I              OMAKPR                          WDAKPR
     I              OMALPR                          WDALPR
     I              OMAUPR                          WDAUPR
     I              OMAVWG                          WDAVWG
     I              OMA4WG                          WDA4WG
     I              OMA5DT                          WDA5DT
     I              OMAODT                          WDAODT
     I              OMGNDT                          WDGNDT
     I              OMAMST                          WDAMST
     I              OMANST                          WDANST
     I              OMVAST                          WDVAST
     I              OMRGNB                          WDRGNB
     I              OMRHNB                          WDRHNB
     I              OMRINB                          WDRINB
     I              OMRBCD                          WDRBCD
     I              OMHICD                          WDHICD
     I              OMRNCD                          WDRNCD
     I              OMROCD                          WDROCD
     I              OMCXDT                          WDCXDT
     I              OMAJVN                          WDAJVN
     I              OMKXCD                          WDKXCD
     I              OMJPCD                          WDJPCD
     I              OMCQCD                          WDCQCD
     I              OMR4CD                          WDR4CD
     I              OMZ1ST                          WDZ1ST
     I              OMZ3ST                          WDZ3ST
     I              OMZ4ST                          WDZ4ST
     I              OMDUPR                          WDDUPR
     I              OMB6VL                          WDB6VL
     I              OMA1AA                          WDA1AA
     I              OMFZSX                          WDFZSX
     I              OMF0SX                          WDF0SX
     I              OMF1SX                          WDF1SX
     I              OMF2SX                          WDF2SX
     I              OMF3SX                          WDF3SX
     I              OMF4SX                          WDF4SX
     I              OMF5SX                          WDF5SX
     I              OMF6SX                          WDF6SX
     I              OMF7SX                          WDF7SX
     I              OMNTDT                          WDNTDT
     I              OMNUDT                          WDNUDT
     I              OMNVDT                          WDNVDT
     I              OMNWDT                          WDNWDT
     I              OMNXDT                          WDNXDT
     I              OMBUTM                          WDBUTM
     I              OMBVTM                          WDBVTM
     I              OMBWTM                          WDBWTM
     I              OMBXTM                          WDBXTM
     I              OMBYTM                          WDBYTM
     I              OMH5NX                          WDH5NX
     I              OMH6NX                          WDH6NX
     I              OMH7NX                          WDH7NX
     I              OMH8NX                          WDH8NX
     I              OMH9NX                          WDH9NX
     I              OMDVPR                          WDDVPR
     I              OMDWPR                          WDDWPR
     I              OMDXPR                          WDDXPR
     I              OMDYPR                          WDDYPR
     I              OMDZPR                          WDDZPR
     I              OMGSPR                          WDGSPR
     I              OMGTPR                          WDGTPR
     I              OMGUPR                          WDGUPR
     I              OMHOST                          WDHOST
     I              OMHPST                          WDHPST
     I              OMIOST                          WDIOST
     I              OMPEWG                          WDPEWG
     I              OMRINY                          WDRINY
     I              OMTIDT                          WDTIDT
     I              OMTJDT                          WDTJDT
     I              OMH2ST                          WDH2ST
     I              OMH0ST                          WDH0ST
     I              OMH1ST                          WDH1ST
     I              OMTKDT                          WDTKDT
     I              OMTLDT                          WDTLDT
     I              OMTMDT                          WDTMDT
     I              OMUVST                          WDUVST
     I              OMUWST                          WDUWST
     I              OMUXST                          WDUXST
     I              OMAATM                          WDAATM
     I              OMAYNA                          WDAYNA
     I              OMA0NA                          WDA0NA
     I              OMAXDT                          WDAXDT
      *
     I@BFCPD9
      * Order Header TRG          Load #/All orders
      * Renamed input format fields
     I              BEAIC3                          WEAIC3
     I              BEC4NB                          WEC4NB
     I              BEJNCD                          WEJNCD
     I              BEANC7                          WEANC7
     I              BEBKC7                          WEBKC7
     I              BEBRTX                          WEBRTX
     I              BEHMNA                          WEHMNA
     I              BEHONA                          WEHONA
     I              BEHPNA                          WEHPNA
     I              BEHNNA                          WEHNNA
     I              BEDBCD                          WEDBCD
     I              BECKTX                          WECKTX
     I              BEB0C7                          WEB0C7
     I              BEAETX                          WEAETX
     I              BEB1NA                          WEB1NA
     I              BEB3NA                          WEB3NA
     I              BEB4NA                          WEB4NA
     I              BEB2NA                          WEB2NA
     I              BEBHCD                          WEBHCD
     I              BEC8TX                          WEC8TX
     I              BEBCNA                          WEBCNA
     I              BEA0DT                          WEA0DT
     I              BEA5DT                          WEA5DT
     I              BEGNDT                          WEGNDT
     I              BEACDT                          WEACDT
     I              BEAQCD                          WEAQCD
     I              BEB6NA                          WEB6NA
     I              BEBYNA                          WEBYNA
     I              BEBZNA                          WEBZNA
     I              BEGTST                          WEGTST
     I              BEGVST                          WEGVST
     I              BEGUST                          WEGUST
     I              BEQFST                          WEQFST
     I              BECQCD                          WECQCD
     I              BEGJST                          WEGJST
     I              BEGWST                          WEGWST
     I              BEGXST                          WEGXST
     I              BEGYST                          WEGYST
     I              BEAODT                          WEAODT
     I              BEAIVN                          WEAIVN
     I              BECXDT                          WECXDT
     I              BEJZVA                          WEJZVA
     I              BEA1WG                          WEA1WG
     I              BEXIST                          WEXIST
     I              BEXJST                          WEXJST
     I              BEXKST                          WEXKST
     I              BEEIDT                          WEEIDT
     I              BEAFTM                          WEAFTM
     I              BEE8CD                          WEE8CD
     I              BEE9CD                          WEE9CD
     I              BERMNB                          WERMNB
     I              BETBNB                          WETBNB
     I              BER1NB                          WER1NB
     I              BEPJST                          WEPJST
     I              BEU0ST                          WEU0ST
     I              BEU1ST                          WEU1ST
     I              BEQ2CD                          WEQ2CD
     I              BEU2ST                          WEU2ST
     I              BEVEST                          WEVEST
     I              BEVFST                          WEVFST
     I              BEVGST                          WEVGST
     I              BERPCD                          WERPCD
     I              BERNNB                          WERNNB
     I              BEVDST                          WEVDST
     I              BEATIN                          WEATIN
     I              BEU4ST                          WEU4ST
     I              BEU5ST                          WEU5ST
     I              BERSRN                          WERSRN
     I              BEMHNA                          WEMHNA
     I              BEMINA                          WEMINA
     I              BEWBST                          WEWBST
     I              BER4CD                          WER4CD
     I              BEBFCD                          WEBFCD
     I              BEQ4CD                          WEQ4CD
     I              BET3NB                          WET3NB
     I              BESICD                          WESICD
     I              BECONB                          WECONB
     I              BECEST                          WECEST
     I              BEAWDT                          WEAWDT
     I              BEJPCD                          WEJPCD
     I              BEXUST                          WEXUST
     I              BEZ1ST                          WEZ1ST
     I              BEVRVA                          WEVRVA
     I              BEOBST                          WEOBST
     I              BEBCST                          WEBCST
     I              BEBDST                          WEBDST
     I              BEB7VL                          WEB7VL
     I              BEGASX                          WEGASX
     I              BEGBSX                          WEGBSX
     I              BEGCSX                          WEGCSX
     I              BEGDSX                          WEGDSX
     I              BEFNSX                          WEFNSX
     I              BEFOSX                          WEFOSX
     I              BEFPSX                          WEFPSX
     I              BEFQSX                          WEFQSX
     I              BEFRSX                          WEFRSX
     I              BEFSSX                          WEFSSX
     I              BEFTSX                          WEFTSX
     I              BEFUSX                          WEFUSX
     I              BEFVSX                          WEFVSX
     I              BEFWSX                          WEFWSX
     I              BEFXSX                          WEFXSX
     I              BEFYSX                          WEFYSX
     I              BENODT                          WENODT
     I              BENPDT                          WENPDT
     I              BENQDT                          WENQDT
     I              BENRDT                          WENRDT
     I              BENSDT                          WENSDT
     I              BEBPTM                          WEBPTM
     I              BEBQTM                          WEBQTM
     I              BEBRTM                          WEBRTM
     I              BEBSTM                          WEBSTM
     I              BEBTTM                          WEBTTM
     I              BEH0NX                          WEH0NX
     I              BEH1NX                          WEH1NX
     I              BEH2NX                          WEH2NX
     I              BEH3NX                          WEH3NX
     I              BEH4NX                          WEH4NX
     I              BEC0C7                          WEC0C7
     I              BEUVST                          WEUVST
     I              BEUWST                          WEUWST
     I              BEUXST                          WEUXST
     I              BEAATM                          WEAATM
     I              BEAYNA                          WEAYNA
     I              BEA0NA                          WEA0NA
     I              BEAXDT                          WEAXDT
      *
     I@BFCPRQ
      * Order Header TRG          Load Id/Order Num
      * Renamed input format fields
     I              BEAIC3                          WFAIC3
     I              BEC4NB                          WFC4NB
     I              BEJNCD                          WFJNCD
     I              BEANC7                          WFANC7
     I              BEBKC7                          WFBKC7
     I              BEBRTX                          WFBRTX
     I              BEHMNA                          WFHMNA
     I              BEHONA                          WFHONA
     I              BEHPNA                          WFHPNA
     I              BEHNNA                          WFHNNA
     I              BEDBCD                          WFDBCD
     I              BECKTX                          WFCKTX
     I              BEB0C7                          WFB0C7
     I              BEAETX                          WFAETX
     I              BEB1NA                          WFB1NA
     I              BEB3NA                          WFB3NA
     I              BEB4NA                          WFB4NA
     I              BEB2NA                          WFB2NA
     I              BEBHCD                          WFBHCD
     I              BEC8TX                          WFC8TX
     I              BEBCNA                          WFBCNA
     I              BEA0DT                          WFA0DT
     I              BEA5DT                          WFA5DT
     I              BEGNDT                          WFGNDT
     I              BEACDT                          WFACDT
     I              BEAQCD                          WFAQCD
     I              BEB6NA                          WFB6NA
     I              BEBYNA                          WFBYNA
     I              BEBZNA                          WFBZNA
     I              BEGTST                          WFGTST
     I              BEGVST                          WFGVST
     I              BEGUST                          WFGUST
     I              BEQFST                          WFQFST
     I              BECQCD                          WFCQCD
     I              BEGJST                          WFGJST
     I              BEGWST                          WFGWST
     I              BEGXST                          WFGXST
     I              BEGYST                          WFGYST
     I              BEAODT                          WFAODT
     I              BEAIVN                          WFAIVN
     I              BECXDT                          WFCXDT
     I              BEJZVA                          WFJZVA
     I              BEA1WG                          WFA1WG
     I              BEXIST                          WFXIST
     I              BEXJST                          WFXJST
     I              BEXKST                          WFXKST
     I              BEEIDT                          WFEIDT
     I              BEAFTM                          WFAFTM
     I              BEE8CD                          WFE8CD
     I              BEE9CD                          WFE9CD
     I              BERMNB                          WFRMNB
     I              BETBNB                          WFTBNB
     I              BER1NB                          WFR1NB
     I              BEPJST                          WFPJST
     I              BEU0ST                          WFU0ST
     I              BEU1ST                          WFU1ST
     I              BEQ2CD                          WFQ2CD
     I              BEU2ST                          WFU2ST
     I              BEVEST                          WFVEST
     I              BEVFST                          WFVFST
     I              BEVGST                          WFVGST
     I              BERPCD                          WFRPCD
     I              BERNNB                          WFRNNB
     I              BEVDST                          WFVDST
     I              BEATIN                          WFATIN
     I              BEU4ST                          WFU4ST
     I              BEU5ST                          WFU5ST
     I              BERSRN                          WFRSRN
     I              BEMHNA                          WFMHNA
     I              BEMINA                          WFMINA
     I              BEWBST                          WFWBST
     I              BER4CD                          WFR4CD
     I              BEBFCD                          WFBFCD
     I              BEQ4CD                          WFQ4CD
     I              BET3NB                          WFT3NB
     I              BESICD                          WFSICD
     I              BECONB                          WFCONB
     I              BECEST                          WFCEST
     I              BEAWDT                          WFAWDT
     I              BEJPCD                          WFJPCD
     I              BEXUST                          WFXUST
     I              BEZ1ST                          WFZ1ST
     I              BEVRVA                          WFVRVA
     I              BEOBST                          WFOBST
     I              BEBCST                          WFBCST
     I              BEBDST                          WFBDST
     I              BEB7VL                          WFB7VL
     I              BEGASX                          WFGASX
     I              BEGBSX                          WFGBSX
     I              BEGCSX                          WFGCSX
     I              BEGDSX                          WFGDSX
     I              BEFNSX                          WFFNSX
     I              BEFOSX                          WFFOSX
     I              BEFPSX                          WFFPSX
     I              BEFQSX                          WFFQSX
     I              BEFRSX                          WFFRSX
     I              BEFSSX                          WFFSSX
     I              BEFTSX                          WFFTSX
     I              BEFUSX                          WFFUSX
     I              BEFVSX                          WFFVSX
     I              BEFWSX                          WFFWSX
     I              BEFXSX                          WFFXSX
     I              BEFYSX                          WFFYSX
     I              BENODT                          WFNODT
     I              BENPDT                          WFNPDT
     I              BENQDT                          WFNQDT
     I              BENRDT                          WFNRDT
     I              BENSDT                          WFNSDT
     I              BEBPTM                          WFBPTM
     I              BEBQTM                          WFBQTM
     I              BEBRTM                          WFBRTM
     I              BEBSTM                          WFBSTM
     I              BEBTTM                          WFBTTM
     I              BEH0NX                          WFH0NX
     I              BEH1NX                          WFH1NX
     I              BEH2NX                          WFH2NX
     I              BEH3NX                          WFH3NX
     I              BEH4NX                          WFH4NX
     I              BEC0C7                          WFC0C7
     I              BEUVST                          WFUVST
     I              BEUWST                          WFUWST
     I              BEUXST                          WFUXST
     I              BEAATM                          WFAATM
     I              BEAYNA                          WFAYNA
     I              BEA0NA                          WFA0NA
     I              BEAXDT                          WFAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * N :  Record Found USR
     I                                        1   1 P1WXST
     IP2PARM      DS
      * FLD: Load Header
      * N :  Load ID
     I                                    P   1   40P2RMNB
      * I :  Company Number
     I                                    P   5   60P2AIC3
      * I : RST Scheduled Ship Date
     I                                    P   7  100P2AODT
      * N :  Trailer Id
     I                                       11  30 P2DXTX
      * N :  Carrier Code
     I                                       31  33 P2BZNA
      * I :  Load Type
     I                                       34  34 P2VDST
      * N :  Schedule Sequence Number
     I                                    P  35  370P2T4NB
     IP3PARM      DS
      * FLD: *Arrays
      * B :  USR Warehouse Code
     I                                        1   3 P3CPCD
      * B :  USR CDE Parm 1
     I                                        4   6 P3VSCD
      * B :  USR CDE Parm 2
     I                                        7   9 P3VTCD
      * B :  USR CDE Parm 3
     I                                       10  12 P3VUCD
      * B :  USR CDE Parm 4
     I                                       13  15 P3VVCD
      * B :  USR CDE Parm 5
     I                                       16  18 P3VWCD
      * B :  USR CDE Parm 6
     I                                       19  21 P3VXCD
      * B :  USR CDE Parm 7
     I                                       22  24 P3VYCD
      * B :  USR CDE Parm 8
     I                                       25  27 P3VZCD
      * B :  USR CDE Parm 9
     I                                       28  30 P3V0CD
      * B :  USR Select/Omit Flag
     I                                       31  31 P3CYST
     IP4PARM      DS
      * FLD: Order Header TRG
      * N :  Export Status
     I                                        1   1 P4U2ST
      * N :  Palletize
     I                                        2   2 P4VEST
      * N :  Shrink Wrap
     I                                        3   3 P4VFST
      * N :  Slip Sheet
     I                                        4   4 P4VGST
     IP5PARM      DS
      * I :  U/M - Primary
     I                                        1   2 P5ADCD
     IP6PARM      DS
      * I :  Loads Shipped or Unship
     I                                        1   1 P6DVSX
     IP7PARM      DS
      * I :  Order Company Number Usr
     I                                    P   1   20P7BYC3
     IP8PARM      DS
      * FLD: *Arrays
      * N :  USR U/M 1
     I                                        1   2 P8CVCD
      * N :  Count Export Loads USR
     I                                    P   3   50P8NMNX
      * N :  Count 2 USR
     I                                    P   6   80P8A7NX
      * N :  Count USR 3
     I                                    P   9  110P8NLNX
      * N :  Count Mixed USR
     I                                    P  12  140P8NNNX
      * N :  Quantity 11.0
     I                                    P  15  200P8KIQT
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P2AIC3    PARM           WP0001  30       Company Number
     C           P2AODT    PARM           WP0002  70       Scheduled Ship
     C           P2VDST    PARM           WP0003  1        Load Type
     C           P3CPCD    PARM P3CPCD    WP0004  3        USR Warehouse C
     C           P3VSCD    PARM P3VSCD    WP0005  3        USR CDE Parm 1
     C           P3VTCD    PARM P3VTCD    WP0006  3        USR CDE Parm 2
     C           P3VUCD    PARM P3VUCD    WP0007  3        USR CDE Parm 3
     C           P3VVCD    PARM P3VVCD    WP0008  3        USR CDE Parm 4
     C           P3VWCD    PARM P3VWCD    WP0009  3        USR CDE Parm 5
     C           P3VXCD    PARM P3VXCD    WP0010  3        USR CDE Parm 6
     C           P3VYCD    PARM P3VYCD    WP0011  3        USR CDE Parm 7
     C           P3VZCD    PARM P3VZCD    WP0012  3        USR CDE Parm 8
     C           P3V0CD    PARM P3V0CD    WP0013  3        USR CDE Parm 9
     C           P3CYST    PARM P3CYST    WP0014  1        USR Select/Omit
     C           P5ADCD    PARM           WP0015  2        U/M - Primary
     C           P6DVSX    PARM           WP0016  1        Loads Shipped o
     C           P7BYC3    PARM           WP0017  30       Order Company N
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * PRT Load List          PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$OENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * PRT Load List          PF: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN FJAODT    WQKA01           Scheduled Ship
      * Define keylist
     C           KRSA      KLIST
     C                     KFLD           WQKA01           Scheduled Ship
      * Setup key
     C                     Z-ADDP2AODT    WQKA01           Scheduled Ship
      * Establish starting position
     C           KRSA      SETLL@FJCPX5                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
      * USER: Null report processing
      * CLC Set for Null Rpt   US - /UT User Source  * 
     C                     MOVEL'Y'       W0AP1P
     C                     MOVEL'Y'       W0NEWP
     C                     MOVEL'Y'       WUGGST           USR Display fie
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        Scheduled Ship
     C                     MOVEL'Y'       W0AL01  1        Load U/M
     C                     MOVEL'Y'       W0AL02  1        Export Status
     C                     MOVEL'Y'       W0AL03  1        Schedule Sequen
     C                     MOVEL'Y'       W0AL04  1        Load ID
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADD*ZERO     $NIGWG           Weight 11.0 USR
     C                     Z-ADD*ZERO     $NKIQT           Quantity 11.0
     C                     Z-ADD*ZERO     $NNMNX           Count Export Lo
     C                     Z-ADD*ZERO     $NA7NX           Count 2 USR
     C                     Z-ADD*ZERO     $NNLNX           Count USR 3
     C                     Z-ADD*ZERO     $NNNNX           Count Mixed USR
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Load key header format
     C                     MOVELFJR0SX    $CR0SX           Load U/M
     C                     MOVEL*BLANK    $CUCTX           UOM Description
      * Load related totals format
     C                     MOVELFJR0SX    $MR0SX           Load U/M
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP02  1
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP03  1
     C                     END
      *
     C           W0AL04    IFEQ 'Y'
      * Load related totals format
     C                     MOVEL*BLANK    $LHLTX           Condition Desc.
     C                     Z-ADDFJP0DT    $LP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     $LT4TM           USR Time 4.0
     C                     Z-ADDFJCMTM    $LCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     $LHGCD           Item Code
     C                     Z-ADD*ZERO     $LQS01           Quantity Schedu
     C                     MOVEL*BLANK    $LPFTX           Text 1 Length U
     C                     Z-ADDFJAIC3    $LAIC3           Company Number
     C                     Z-ADDFJRMNB    $LRMNB           Load ID
     C                     MOVELFJPKST    $LPKST           Load Status
     C                     MOVELFJWTTX    $LWTTX           Seal 4
     C                     MOVELFJWUTX    $LWUTX           Seal 2 Unused
     C                     Z-ADDFJPRTM    $LPRTM           Product Tempera
     C                     Z-ADDFJNPSV    $LNPSV           Number Spacers
     C                     MOVELFJJ8TX    $LJ8TX           Car/Veh. Initia
     C                     Z-ADDFJTLMI    $LTLMI           Total Load Mile
     C                     MOVELFJJ9TX    $LJ9TX           Recorder ID
     C                     MOVELFJQ2CD    $LQ2CD           Shipping Method
     C                     MOVELFJVPCD    $LVPCD           Ship From Wareh
     C                     MOVELFJDBCD    $LDBCD           Ship To State C
     C                     Z-ADDFJGRWE    $LGRWE           Gross Weight
     C                     MOVELFJXCCD    $LXCCD           Carrier Broker
     C                     MOVELFJU2ST    $LU2ST           Export Status
     C                     Z-ADDFJF9DT    $LF9DT           Actual Ship Dat
     C                     MOVELFJONTM    $LONTM           On Time - (Y/N)
     C                     Z-ADDFJJ4DT    $LJ4DT           Truck Ready Dat
     C                     Z-ADDFJTRTM    $LTRTM           Truck Ready Tim
     C                     Z-ADDFJJ5DT    $LJ5DT           Spotted Date
     C                     Z-ADDFJSPTM    $LSPTM           Spotted Time
     C                     Z-ADDFJJ6DT    $LJ6DT           Load Finished D
     C                     Z-ADDFJLFTM    $LLFTM           Load Finished T
     C                     Z-ADDFJJ7DT    $LJ7DT           BOL Complete Da
     C                     Z-ADDFJBOTM    $LBOTM           BOL Complete Ti
     C                     Z-ADDFJJ8DT    $LJ8DT           BOL Received Da
     C                     Z-ADDFJBLTM    $LBLTM           BOL Received Ti
     C                     Z-ADDFJKIDT    $LKIDT           Truck Departure
     C                     Z-ADDFJASTM    $LASTM           Truck Departure
     C                     Z-ADDFJKADT    $LKADT           Adjusted Depart
     C                     Z-ADDFJAJCM    $LAJCM           Adjusted Depart
     C                     MOVELFJXACD    $LXACD           Shipping Line
     C                     MOVELFJOANA    $LOANA           Port Delv Termi
     C                     MOVELFJK4TX    $LK4TX           Vessel Name
     C                     Z-ADDFJVOAG    $LVOAG           Voyage
     C                     Z-ADDFJKBDT    $LKBDT           Sail Date
     C                     MOVELFJNBBO    $LNBBO           Booking Number
     C                     MOVELFJW4CD    $LW4CD           Discharge Port
     C                     Z-ADDFJEFDT    $LEFDT           Arrival Date
     C                     MOVELFJCNTN    $LCNTN           Container Numbe
     C                     Z-ADDFJKCDT    $LKCDT           Date In
     C                     Z-ADDFJTMIN    $LTMIN           Time In
     C                     Z-ADDFJKDDT    $LKDDT           Date Out
     C                     Z-ADDFJVMNB    $LVMNB           Time Out
     C                     Z-ADDFJOCFR    $LOCFR           Load Total Frei
     C                     Z-ADDFJKJDT    $LKJDT           Scheduled Deliv
     C                     Z-ADDFJATTM    $LATTM           Scheduled Deliv
     C                     MOVELFJOTRS    $LOTRS           LH Unused Sts
     C                     MOVELFJRNST    $LRNST           LH Carrier Paym
     C                     Z-ADDFJBRBK    $LBRBK           Bring Back Mile
     C                     Z-ADDFJEIDT    $LEIDT           Requested Deliv
     C                     MOVELFJRMST    $LRMST           Load Acceptance
     C                     MOVELFJAJCD    $LAJCD           Warehouse Code
     C                     Z-ADDFJKKDT    $LKKDT           On Yard Date
     C                     Z-ADDFJAVTM    $LAVTM           On Yard Time
     C                     Z-ADDFJKZDT    $LKZDT           Deadline Depart
     C                     Z-ADDFJAXTM    $LAXTM           Deadline Depart
     C                     MOVELFJLHOS    $LLHOS           Load Held Over
     C                     MOVELFJLHOR    $LLHOR           Load Held Over
     C                     MOVELFJWNTX    $LWNTX           Load Held Over
     C                     MOVELFJOITX    $LOITX           Ocean BOL Numbe
     C                     MOVELFJOJTX    $LOJTX           Express Mail Nu
     C                     Z-ADDFJLLDT    $LLLDT           Express Mail Da
     C                     MOVELFJLSHG    $LLSHG           Load Shag Flag
     C                     MOVELFJYPST    $LYPST           Load Wash Flag
     C                     Z-ADDFJK0DT    $LK0DT           Product Complet
     C                     Z-ADDFJAYTM    $LAYTM           Product Complet
     C                     Z-ADDFJKNNX    $LKNNX           Pallets Loaded
     C                     Z-ADDFJICWG    $LICWG           Avg Pallet Tare
     C                     Z-ADDFJIDWG    $LIDWG           Tot Pallet Tare
     C                     MOVELFJH9SX    $LH9SX           Load Confirmed
     C                     MOVELFJWOTX    $LWOTX           Load Confirmed
     C                     Z-ADDFJK1DT    $LK1DT           Load Confirmati
     C                     Z-ADDFJAZTM    $LAZTM           Load Door 1
     C                     Z-ADDFJK2DT    $LK2DT           Override Total
     C                     Z-ADDFJA0TM    $LA0TM           Load Door 2
     C                     MOVELFJROST    $LROST           Partial Load
     C                     MOVELFJRPST    $LRPST           Load Confirmati
     C                     MOVELFJRQST    $LRQST           Export Load USD
     C                     MOVELFJRRST    $LRRST           Late Delivery E
     C                     Z-ADDFJZBVA    $LZBVA           Load Actual Fre
     C                     MOVELFJWPTX    $LWPTX           Hide on WW Load
     C                     MOVELFJWQTX    $LWQTX           Late Billing Em
     C                     MOVELFJWRTX    $LWRTX           Shipping Temp C
     C                     MOVELFJWSTX    $LWSTX           LH Held Over Rs
     C                     MOVELFJRVSX    $LRVSX           Multi Company L
     C                     MOVELFJRUSX    $LRUSX           Fax Sent to SSI
     C                     MOVELFJRWSX    $LRWSX           Schedule Pos Lo
     C                     MOVELFJRXSX    $LRXSX           LH Power Only L
     C                     MOVELFJRYSX    $LRYSX           MG Created Load
     C                     MOVELFJRZSX    $LRZSX           LH Unused Sts 5
     C                     MOVELFJR0SX    $LR0SX           Load U/M
     C                     MOVELFJR1SX    $LR1SX           TPM Shipment St
     C                     MOVELFJR2SX    $LR2SX           LH Unused Sts 8
     C                     MOVELFJR3SX    $LR3SX           LH On-Time Reas
     C                     MOVELFJR4SX    $LR4SX           LH Held Over Re
     C                     Z-ADDFJPYDT    $LPYDT           LH Carrier Paid
     C                     Z-ADDFJCKTM    $LCKTM           LH Carrier Paid
     C                     Z-ADDFJPZDT    $LPZDT           LH Last Combo P
     C                     Z-ADDFJCLTM    $LCLTM           LH Last Combo P
     C                     Z-ADDFJP1DT    $LP1DT           TPM Planned Shi
     C                     Z-ADDFJCNTM    $LCNTM           LH Unused Time
     C                     Z-ADDFJP2DT    $LP2DT           LH Unused Date
     C                     Z-ADDFJCOTM    $LCOTM           LH Unused Time
     C                     Z-ADDFJP3DT    $LP3DT           LH Unused Date
     C                     Z-ADDFJCQTM    $LCQTM           LH Unused Time
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP04  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDFJAIC3    $DAIC3           Company Number
     C                     Z-ADDFJRMNB    $DRMNB           Load ID
     C                     Z-ADDFJAODT    $DAODT           Scheduled Ship
     C                     MOVELFJPJST    $DPJST           LTL Flag
     C                     MOVELFJPKST    $DPKST           Load Status
     C                     Z-ADDFJRNNB    $DRNNB           Reefer Temperat
     C                     MOVELFJDMTX    $DDMTX           Seal 1
     C                     MOVELFJDNTX    $DDNTX           Seal 2
     C                     MOVELFJDOTX    $DDOTX           Seal 3
     C                     MOVELFJWTTX    $DWTTX           Seal 4
     C                     MOVELFJWUTX    $DWUTX           Seal 2 Unused
     C                     Z-ADDFJRPNB    $DRPNB           Total Load Orde
     C                     Z-ADDFJFLAM    $DFLAM           Flat Amount
     C                     MOVELFJXQST    $DXQST           Allocate Pounds
     C                     Z-ADDFJRRNB    $DRRNB           Total Stops
     C                     MOVELFJDXTX    $DDXTX           Trailer Id
     C                     MOVELFJDYTX    $DDYTX           Transloader Car
     C                     Z-ADDFJSBNB    $DSBNB           BOL Time
     C                     MOVELFJBZNA    $DBZNA           Carrier Code
     C                     MOVELFJRONB    $DRONB           Truck Size
     C                     Z-ADDFJSQNB    $DSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADDFJR1NB    $DR1NB           Rated Freight
     C                     MOVELFJVCST    $DVCST           Ship Status
     C                     MOVELFJVDST    $DVDST           Load Type
     C                     Z-ADDFJSDNB    $DSDNB           Number Pallets
     C                     Z-ADDFJPAOU    $DPAOU           Number Pallets
     C                     Z-ADDFJDGWG    $DDGWG           Load Carrier Pa
     C                     Z-ADDFJSXNB    $DSXNB           Estimated Arriv
     C                     Z-ADDFJHADT    $DHADT           Actual Arrival
     C                     Z-ADDFJAART    $DAART           Actual Arrival
     C                     Z-ADDFJDHWG    $DDHWG           Trailer IN Weig
     C                     Z-ADDFJDIWG    $DDIWG           Trailer OUT Wei
     C                     Z-ADDFJAQDT    $DAQDT           Actual Departur
     C                     Z-ADDFJS6NB    $DS6NB           Departure Time
     C                     Z-ADDFJT4NB    $DT4NB           Schedule Sequen
     C                     Z-ADDFJPRTM    $DPRTM           Product Tempera
     C                     Z-ADDFJNPSV    $DNPSV           Number Spacers
     C                     MOVELFJJ8TX    $DJ8TX           Car/Veh. Initia
     C                     Z-ADDFJTLMI    $DTLMI           Total Load Mile
     C                     MOVELFJJ9TX    $DJ9TX           Recorder ID
     C                     MOVELFJQ2CD    $DQ2CD           Shipping Method
     C                     MOVELFJVPCD    $DVPCD           Ship From Wareh
     C                     MOVELFJDBCD    $DDBCD           Ship To State C
     C                     Z-ADDFJGRWE    $DGRWE           Gross Weight
     C                     MOVELFJXCCD    $DXCCD           Carrier Broker
     C                     MOVELFJU2ST    $DU2ST           Export Status
     C                     Z-ADDFJF9DT    $DF9DT           Actual Ship Dat
     C                     MOVELFJONTM    $DONTM           On Time - (Y/N)
     C                     Z-ADDFJJ4DT    $DJ4DT           Truck Ready Dat
     C                     Z-ADDFJTRTM    $DTRTM           Truck Ready Tim
     C                     Z-ADDFJJ5DT    $DJ5DT           Spotted Date
     C                     Z-ADDFJSPTM    $DSPTM           Spotted Time
     C                     Z-ADDFJJ6DT    $DJ6DT           Load Finished D
     C                     Z-ADDFJLFTM    $DLFTM           Load Finished T
     C                     Z-ADDFJJ7DT    $DJ7DT           BOL Complete Da
     C                     Z-ADDFJBOTM    $DBOTM           BOL Complete Ti
     C                     Z-ADDFJJ8DT    $DJ8DT           BOL Received Da
     C                     Z-ADDFJBLTM    $DBLTM           BOL Received Ti
     C                     Z-ADDFJKIDT    $DKIDT           Truck Departure
     C                     Z-ADDFJASTM    $DASTM           Truck Departure
     C                     Z-ADDFJKADT    $DKADT           Adjusted Depart
     C                     Z-ADDFJAJCM    $DAJCM           Adjusted Depart
     C                     MOVELFJXACD    $DXACD           Shipping Line
     C                     MOVELFJOANA    $DOANA           Port Delv Termi
     C                     MOVELFJK4TX    $DK4TX           Vessel Name
     C                     Z-ADDFJVOAG    $DVOAG           Voyage
     C                     Z-ADDFJKBDT    $DKBDT           Sail Date
     C                     MOVELFJNBBO    $DNBBO           Booking Number
     C                     MOVELFJW4CD    $DW4CD           Discharge Port
     C                     Z-ADDFJEFDT    $DEFDT           Arrival Date
     C                     MOVELFJCNTN    $DCNTN           Container Numbe
     C                     Z-ADDFJKCDT    $DKCDT           Date In
     C                     Z-ADDFJTMIN    $DTMIN           Time In
     C                     Z-ADDFJKDDT    $DKDDT           Date Out
     C                     Z-ADDFJVMNB    $DVMNB           Time Out
     C                     Z-ADDFJOCFR    $DOCFR           Load Total Frei
     C                     Z-ADDFJKJDT    $DKJDT           Scheduled Deliv
     C                     Z-ADDFJATTM    $DATTM           Scheduled Deliv
     C                     MOVELFJOTRS    $DOTRS           LH Unused Sts
     C                     MOVELFJRNST    $DRNST           LH Carrier Paym
     C                     Z-ADDFJBRBK    $DBRBK           Bring Back Mile
     C                     Z-ADDFJEIDT    $DEIDT           Requested Deliv
     C                     MOVELFJRMST    $DRMST           Load Acceptance
     C                     MOVELFJAJCD    $DAJCD           Warehouse Code
     C                     Z-ADDFJKKDT    $DKKDT           On Yard Date
     C                     Z-ADDFJAVTM    $DAVTM           On Yard Time
     C                     Z-ADDFJKZDT    $DKZDT           Deadline Depart
     C                     Z-ADDFJAXTM    $DAXTM           Deadline Depart
     C                     MOVELFJLHOS    $DLHOS           Load Held Over
     C                     MOVELFJLHOR    $DLHOR           Load Held Over
     C                     MOVELFJWNTX    $DWNTX           Load Held Over
     C                     MOVELFJOITX    $DOITX           Ocean BOL Numbe
     C                     MOVELFJOJTX    $DOJTX           Express Mail Nu
     C                     Z-ADDFJLLDT    $DLLDT           Express Mail Da
     C                     MOVELFJLSHG    $DLSHG           Load Shag Flag
     C                     MOVELFJYPST    $DYPST           Load Wash Flag
     C                     Z-ADDFJK0DT    $DK0DT           Product Complet
     C                     Z-ADDFJAYTM    $DAYTM           Product Complet
     C                     Z-ADDFJKNNX    $DKNNX           Pallets Loaded
     C                     Z-ADDFJICWG    $DICWG           Avg Pallet Tare
     C                     Z-ADDFJIDWG    $DIDWG           Tot Pallet Tare
     C                     MOVELFJH9SX    $DH9SX           Load Confirmed
     C                     MOVELFJWOTX    $DWOTX           Load Confirmed
     C                     Z-ADDFJK1DT    $DK1DT           Load Confirmati
     C                     Z-ADDFJAZTM    $DAZTM           Load Door 1
     C                     Z-ADDFJK2DT    $DK2DT           Override Total
     C                     Z-ADDFJA0TM    $DA0TM           Load Door 2
     C                     MOVELFJROST    $DROST           Partial Load
     C                     MOVELFJRPST    $DRPST           Load Confirmati
     C                     MOVELFJRQST    $DRQST           Export Load USD
     C                     MOVELFJRRST    $DRRST           Late Delivery E
     C                     Z-ADDFJZBVA    $DZBVA           Load Actual Fre
     C                     MOVELFJWPTX    $DWPTX           Hide on WW Load
     C                     MOVELFJWQTX    $DWQTX           Late Billing Em
     C                     MOVELFJWRTX    $DWRTX           Shipping Temp C
     C                     MOVELFJWSTX    $DWSTX           LH Held Over Rs
     C                     MOVELFJRVSX    $DRVSX           Multi Company L
     C                     MOVELFJRUSX    $DRUSX           Fax Sent to SSI
     C                     MOVELFJRWSX    $DRWSX           Schedule Pos Lo
     C                     MOVELFJRXSX    $DRXSX           LH Power Only L
     C                     MOVELFJRYSX    $DRYSX           MG Created Load
     C                     MOVELFJRZSX    $DRZSX           LH Unused Sts 5
     C                     MOVELFJR0SX    $DR0SX           Load U/M
     C                     MOVELFJR1SX    $DR1SX           TPM Shipment St
     C                     MOVELFJR2SX    $DR2SX           LH Unused Sts 8
     C                     MOVELFJR3SX    $DR3SX           LH On-Time Reas
     C                     MOVELFJR4SX    $DR4SX           LH Held Over Re
     C                     Z-ADDFJPYDT    $DPYDT           LH Carrier Paid
     C                     Z-ADDFJCKTM    $DCKTM           LH Carrier Paid
     C                     Z-ADDFJPZDT    $DPZDT           LH Last Combo P
     C                     Z-ADDFJCLTM    $DCLTM           LH Last Combo P
     C                     Z-ADDFJP0DT    $DP0DT           LPT Load Plan S
     C                     Z-ADDFJCMTM    $DCMTM           LPT Load Plan S
     C                     Z-ADDFJP1DT    $DP1DT           TPM Planned Shi
     C                     Z-ADDFJCNTM    $DCNTM           LH Unused Time
     C                     Z-ADDFJP2DT    $DP2DT           LH Unused Date
     C                     Z-ADDFJCOTM    $DCOTM           LH Unused Time
     C                     Z-ADDFJP3DT    $DP3DT           LH Unused Date
     C                     Z-ADDFJCQTM    $DCQTM           LH Unused Time
     C                     MOVELFJUVST    $DUVST           EDI Status 1
     C                     MOVELFJUWST    $DUWST           EDI Status 2
     C                     MOVELFJUXST    $DUXST           EDI Status 3
     C                     Z-ADDFJAATM    $DAATM           Job Time
     C                     MOVELFJAYNA    $DAYNA           User Id
     C                     MOVELFJA0NA    $DA0NA           Job Name
     C                     Z-ADDFJAXDT    $DAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : PRT Load List Details  PO
     C                     EXSR UASUBR                     Embedded PRTOBJ
      * USER: Process after print of detail format
      * Accum number of loads Export, Box, Combo, or Mixed
      * CASE: PAR.Export Status is yes
     C           P4U2ST    IFEQ 'Y'                        *IF
      * CASE: Count if at least one order on load is an export
      *  - c1 OR c2
      *   |- c1    : PGM.*Record selected is *YES
      *   |- c2    : WRK.Display Flag 1 USR is yes
      *   '-
     C           W0RSL     IFEQ 'Y'                        *IF
     C           WUDXSX    OREQ 'Y'                        *OR
     C                     ADD  1         P8NMNX           Count Export Lo
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: Count if at least one order was selected for load
      *  - c1 OR c2
      *   |- c1    : PGM.*Record selected is *YES
      *   |- c2    : WRK.Display Flag 1 USR is yes
      *   '-
     C           W0RSL     IFEQ 'Y'                        *IF
     C           WUDXSX    OREQ 'Y'                        *OR
      * count load u/m (updated when load is locked)
      * CASE: DB1.Load U/M is Box
     C           FJR0SX    IFEQ 'BX'                       *IF
     C                     ADD  1         P8A7NX           Count 2 USR
     C                     ELSE
      * CASE: DB1.Load U/M is Combo
     C           FJR0SX    IFEQ 'CB'                       *IF
     C                     ADD  1         P8NLNX           Count USR 3
     C                     ELSE
      * CASE: DB1.Load U/M is Mix
     C           FJR0SX    IFEQ 'MX'                       *IF
     C                     ADD  1         P8NNNX           Count Mixed USR
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN FJAODT    WZA001           Scheduled Ship
     C                     Z-ADDFJAODT    WZA001
     C           *LIKE     DEFN FJR0SX    WZA002           Load U/M
     C                     MOVELFJR0SX    WZA002
     C           *LIKE     DEFN FJU2ST    WZA003           Export Status
     C                     MOVELFJU2ST    WZA003
     C           *LIKE     DEFN FJT4NB    WZA004           Schedule Sequen
     C                     Z-ADDFJT4NB    WZA004
     C           *LIKE     DEFN FJRMNB    WZA005           Load ID
     C                     Z-ADDFJRMNB    WZA005
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C           KRSA      READE@FJCPX5                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * ** Select order Company Number                          5/14/04
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Company Number is not equal to zero
      *   |- c2    : PAR.Company Number NE DB1.Company Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2AIC3    IFNE *ZERO                      *IF
     C           P2AIC3    IFNE FJAIC3                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Select Load Type
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Load Type is Bulk or Regular
      *   |- c2    : PAR.Load Type NE DB1.Load Type
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2VDST    IFEQ 'B'                        *IF
     C           P2VDST    OREQ 'R'
     C           P2VDST    IFNE FJVDST                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Select on UOM if entered
      * CASE: PAR.U/M - Primary is Entered
     C           P5ADCD    IFNE *BLANK                     *IF
      * VAL UOM Exists on Ord  RT - PD Order Header  * 
     C                     EXSR SQRVGN
      * CASE: PAR.Record Found USR is Record Not Found
     C           P1WXST    IFEQ 'N'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Select loads shipped/unshipped
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Loads Shipped or Unship is Shipped
      *   |- c2    : DB1.Load Status is Not Shipped
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6DVSX    IFEQ 'S'                        *IF
     C           FJPKST    IFEQ 'C'                        *IF
     C           FJPKST    OREQ 'E'
     C           FJPKST    OREQ 'I'
     C           FJPKST    OREQ 'L'
     C           FJPKST    OREQ 'U'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Loads Shipped or Unship is Unshipped
      *   |- c2    : DB1.Load Status is Shipped or Invoiced
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6DVSX    IFEQ 'U'                        *IF
     C           FJPKST    IFEQ 'I'                        *IF
     C           FJPKST    OREQ 'S'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        Scheduled Ship
     C                     MOVEL*BLANK    W0AL01  1        Load U/M
     C                     MOVEL*BLANK    W0AL02  1        Export Status
     C                     MOVEL*BLANK    W0AL03  1        Schedule Sequen
     C                     MOVEL*BLANK    W0AL04  1        Load ID
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        Scheduled Ship
     C                     MOVEL'Y'       W0AL01  1        Load U/M
     C                     MOVEL'Y'       W0AL02  1        Export Status
     C                     MOVEL'Y'       W0AL03  1        Schedule Sequen
     C                     MOVEL'Y'       W0AL04  1        Load ID
     C                     ELSE
      * Next record - Detect level breaks
     C           FJAODT    IFNE WZA001                     Scheduled Ship
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           FJR0SX    IFNE WZA002                     Load U/M
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C           FJU2ST    IFNE WZA003                     Export Status
     C           W0AL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL02
     C                     END
     C           FJT4NB    IFNE WZA004                     Schedule Sequen
     C           W0AL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL03
     C                     END
     C           FJRMNB    IFNE WZA005                     Load ID
     C           W0AL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL04
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL04    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Load ID format
      * CASE: WRK.USR Active Flag is Record Not Found
     C           WUW2ST    IFEQ 'N'                        *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     ELSE
      * CASE: *OTHERWISE
      * new 2/9/04  print 1st freezer order item/qty/+
      * RTV Freezer Ord Item  RT - Order Header TRG  * 
     C                     EXSR SSRVGN
     C                     Z-ADD$LHGCD    YL0019           Item Code
     C                     Z-ADDYL0017    $LQS01           Quantity Schedu
     C                     END                             *FI
      * CUR.Condition Desc. 1  USR = Condition name of CUR.Load Status
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1195931   Y2LSNO  70       List number
     C                     PARM $LPKST    W0INVL 25        Load Status
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $LHLTX    PARM           W0CNNM 25        Condition Desc.
      *
     C           $LCMTM    DIV  100       $LT4TM           USR Time 4.0
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Convert fields to external form
      * Convert LPT Load Plan Start Dt to display format
      * Convert date
     C           1000000   ADD  $LP0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VLP0DT
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $LHGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$LHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VLHGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VLHGCD           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVEL'0'       *IN79
     C           YL0019    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           WUW2ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
      * Print format
     C                     WRITE$LKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP04
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP03
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP02
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$MKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of final totals format
      * 5/13/04 RMC PKTR01 - was in Company Number totals
     C                     Z-ADDYL0001    $NIGWG           Weight 11.0 USR
     C                     Z-ADDP8KIQT    $NKIQT           Quantity 11.0
     C                     Z-ADDP8NMNX    $NNMNX           Count Export Lo
     C                     Z-ADDP8A7NX    $NA7NX           Count 2 USR
     C                     Z-ADDP8NLNX    $NNLNX           Count USR 3
     C                     Z-ADDP8NNNX    $NNNNX           Count Mixed USR
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 5
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$NFINTTL
     C                     END
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         B0MAIN    BEGSR
      *================================================================
      * PRT Load List Details  PO: Mainline
      *================================================================
      * PRT Load List Details  PO: Initialise
     C                     EXSR ZBINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQKB02           Load ID
      * Define keylist
     C           KRSB      KLIST
     C                     KFLD           WQKB02           Load ID
      * Setup key
     C                     Z-ADDFJRMNB    WQKB02           Load ID
      * Establish starting position
     C           KRSB      SETLL@FLCPE8                    *
      * Read first record with user selection
     C                     EXSR B3READ
     C           W0EOFB    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0BL1P  1        First page
     C                     MOVEL'Y'       W0BL00  1        Load ID
     C                     MOVEL'Y'       W0BL01  1        Stop/Drop
     C                     MOVEL'Y'       W0BL02  1        Order Number
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      * Print report body
     C           W0EOFB    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR B1PHDR
      * Print report detail line
     C                     EXSR B2PDTL
      * Read next record with user selection
     C                     EXSR B3READ
      * Print totals
     C                     EXSR B4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         B0EXIT    ENDSR
      /EJECT
     CSR         B1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0BL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP1P  1
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Load related totals format
     C                     MOVEL*BLANK    $JQ2CD           Shipping Method
     C                     Z-ADDFLAIC3    $JAIC3           Company Number
     C                     Z-ADDFLRMNB    $JRMNB           Load ID
     C                     Z-ADD*ZERO     $JLLNA           USR Weight 9
     C                     Z-ADD*ZERO     $JGFDT           Departure Date
     C                     Z-ADD*ZERO     $JMAQT           Quantity 9.0
     C                     Z-ADD*ZERO     $JS6NB           Departure Time
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP00  1
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Load related totals format
     C                     MOVEL*BLANK    $IQ2CD           Shipping Method
     C                     Z-ADD*ZERO     $IBUNB           USR Weight, 9.0
     C                     Z-ADD*ZERO     $ILLNA           USR Weight 9
     C                     Z-ADD*ZERO     $IGFDT           Departure Date
     C                     Z-ADD*ZERO     $IMAQT           Quantity 9.0
     C                     Z-ADD*ZERO     $IS6NB           Departure Time
     C                     Z-ADDFLAIC3    $IAIC3           Company Number
     C                     Z-ADDFLRMNB    $IRMNB           Load ID
     C                     Z-ADDFLRVNB    $IRVNB           Stop/Drop
     C                     Z-ADDFLC4NB    $IC4NB           Order Number
     C                     Z-ADDFLRWNB    $IRWNB           Miles to next s
     C                     Z-ADDFLRUNB    $IRUNB           Stop/Drop Seque
     C                     MOVELFLVCST    $IVCST           Ship Status
     C                     MOVELFLUVST    $IUVST           EDI Status 1
     C                     MOVELFLUWST    $IUWST           EDI Status 2
     C                     MOVELFLUXST    $IUXST           EDI Status 3
     C                     MOVELFLDQTX    $IDQTX           Comments for Pi
     C                     Z-ADDFLRXNB    $IRXNB           Freight Charge
     C                     Z-ADDFLSQNB    $ISQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADDFLT0NB    $IT0NB           Freight Misc. C
     C                     Z-ADDFLT1NB    $IT1NB           Freight Stop Ch
     C                     Z-ADDFLR1NB    $IR1NB           Rated Freight
     C                     Z-ADDFLAATM    $IAATM           Job Time
     C                     MOVELFLAYNA    $IAYNA           User Id
     C                     MOVELFLA0NA    $IA0NA           Job Name
     C                     Z-ADDFLAXDT    $IAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP01  1
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP02  1
     C                     END
      *
      *================================================================
     CSR         B1EXIT    ENDSR
      /EJECT
     CSR         B2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADD*ZERO     $ET4NB           Schedule Sequen
     C                     Z-ADDFLRMNB    $ERMNB           Load ID
     C                     Z-ADDFLRVNB    $ERVNB           Stop/Drop
     C                     Z-ADDFLC4NB    $EC4NB           Order Number
     C                     MOVEL*BLANK    $EQ2CD           Shipping Method
     C                     MOVEL*BLANK    $ENANA           Yes/No Descript
     C                     MOVEL*BLANK    $EMUTX           Trailer Id
     C                     MOVEL*BLANK    $EDXTX           Trailer Id
     C                     MOVEL*BLANK    $EODCD           USR Unit of Mea
     C                     MOVEL*BLANK    $EEOTX           USR Line Status
     C                     MOVEL*BLANK    $EOENA           USR Customer 18
     C                     Z-ADD*ZERO     $ETLMI           Total Load Mile
     C                     Z-ADD*ZERO     $ELLNA           USR Weight 9
     C                     Z-ADD*ZERO     $EEIDT           Requested Deliv
     C                     Z-ADD*ZERO     $EGFDT           Departure Date
     C                     MOVEL*BLANK    $EVGST           Slip Sheet
     C                     MOVEL*BLANK    $EVFST           Shrink Wrap
     C                     MOVEL*BLANK    $EVEST           Palletize
     C                     MOVEL*BLANK    $EAJCD           Warehouse Code
     C                     Z-ADDFLKEDT    $EKEDT           Estimated Arriv
     C                     Z-ADDFLSXNB    $ESXNB           Estimated Arriv
     C                     Z-ADDFLKFDT    $EKFDT           Appointment Con
     C                     Z-ADDFLACTM    $EACTM           Appointment Con
     C                     MOVELFLK5TX    $EK5TX           Confirmation Ma
     C                     MOVELFLW5CD    $EW5CD           Confirmation Nu
     C                     Z-ADDFLEJDT    $EEJDT           Actual Delivery
     C                     Z-ADDFLAGTM    $EAGTM           Actual Delivery
     C                     Z-ADDFLKJDT    $EKJDT           Scheduled Deliv
     C                     Z-ADDFLATTM    $EATTM           Scheduled Deliv
     C                     Z-ADDFLHDDT    $EHDDT           Deadline Depart
     C                     Z-ADDFLAUTM    $EAUTM           Deadline Depart
     C                     Z-ADDFLKKDT    $EKKDT           On Yard Date
     C                     Z-ADDFLAVTM    $EAVTM           On Yard Time
     C                     Z-ADDFLZ4NB    $EZ4NB           MPC Number
     C                     MOVELFLY7ST    $EY7ST           Load Dtl On Tim
     C                     MOVELFLY2ST    $EY2ST           On Time Add'l R
     C                     MOVELFLWHTX    $EWHTX           Seal Nbr 1
     C                     MOVELFLWITX    $EWITX           Seal Nbr 2
     C                     MOVELFLWJTX    $EWJTX           Seal Nbr 3
     C                     MOVELFLWKTX    $EWKTX           Seal Nbr 4
     C                     MOVELFLWLTX    $EWLTX           Seal Nbr 5
     C                     Z-ADDFLN7DT    $EN7DT           LD Carrier Appt
     C                     Z-ADDFLN8DT    $EN8DT           LD Unused Date
     C                     Z-ADDFLN9DT    $EN9DT           LD Unused Date
     C                     Z-ADDFLB3TM    $EB3TM           LD Carrier Appt
     C                     Z-ADDFLB4TM    $EB4TM           LD Unused Time
     C                     Z-ADDFLB5TM    $EB5TM           LD Unused Time
     C                     MOVELFLIASX    $EIASX           Miles Error Sts
     C                     MOVELFLIBSX    $EIBSX           LD Unused Sts 2
     C                     MOVELFLICSX    $EICSX           HPB Transload S
     C                     MOVELFLWVTX    $EWVTX           LD Cst Svc Trac
     C                     MOVELFLWWTX    $EWWTX           Carrier Ref PRO
     C                     MOVELFLWXTX    $EWXTX           Cust Assigned A
     C                     MOVEL*BLANK    $EJ1TX           BLANK 1
     C                     Z-ADD*ZERO     $EFKNB           USR Company Num
     C                     Z-ADD*ZERO     $EPRTM           Product Tempera
     C                     MOVEL*BLANK    $EPFTX           Text 1 Length U
     C                     Z-ADDFLAIC3    $EAIC3           Company Number
     C                     MOVEL*BLANK    $ENGST           Flag 2
     C                     MOVEL*BLANK    $EFNSX           Transfer in Sto
     C                     MOVEL*BLANK    $EBCNA           Customer Purcha
     C                     MOVEL*BLANK    $ELMNA           USR City 15
     C                     MOVEL*BLANK    $ELNNA           USR State 2
     C                     Z-ADD*ZERO     $EMAQT           Quantity 9.0
     C                     Z-ADD*ZERO     $EAFTM           Requested Deliv
     C                     Z-ADD*ZERO     $ES6NB           Departure Time
     C                     MOVEL*BLANK    $EB6NA           Special Instruc
     C                     MOVEL*BLANK    $EBYNA           Special Instruc
     C                     MOVEL*BLANK    $EQKST           Display Flag
     C                     MOVEL*BLANK    $EEVTX           USR Customer Sh
     C                     Z-ADD*ZERO     $EBUNB           USR Weight, 9.0
     C                     MOVEL*BLANK    $EF2TX           USR City Short
     C                     MOVEL*BLANK    $EGWNA           USR State - ATR
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : PRT Load List 1st Item PO
     C                     EXSR UBSUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : PRT Blank Line         PO
     C                     EXSR UCSUBR                     Embedded PRTOBJ
      * USER: Process after print of detail format
     C                     ADD  $ELLNA    $ILLNA           USR Weight 9
     C                     ADD  $EMAQT    $IMAQT           Quantity 9.0
     C                     Z-ADD$ELLNA    WN0020           USR Weight 9
     C                     Z-ADD*ZERO     $ETLMI           Total Load Mile
      *
      *================================================================
     CSR         B2EXIT    ENDSR
      /EJECT
     CSR         B3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN FLRMNB    WZB001           Load ID
     C                     Z-ADDFLRMNB    WZB001
     C           *LIKE     DEFN FLRVNB    WZB002           Stop/Drop
     C                     Z-ADDFLRVNB    WZB002
     C           *LIKE     DEFN FLC4NB    WZB003           Order Number
     C                     Z-ADDFLC4NB    WZB003
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFB    OREQ '1'
     C           KRSB      READE@FLCPE8                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFB  1
      * Quit if no record read
     C           W0EOFB    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * Verify that the Order Company number is equal the record company
      * Order company
      * CASE: PAR.Company Number EQ DB1.Company Number
     C           P7BYC3    IFEQ FLAIC3                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Select passed warehouses
      * CASE: PAR.USR Select/Omit Flag is Select
     C           P3CYST    IFEQ 'S'                        *IF
      * Select only Order Detail records matching warehouse codes passed
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6ORc7ORc8ORc9ORc10
      *   |- c1    : PAR.USR Warehouse Code is Warehouse Code not Blank
      *   |- c2    : PAR.USR CDE Parm 1 is Warehouse Code not Blank
      *   |- c3    : PAR.USR CDE Parm 2 is Warehouse Code not Blank
      *   |- c4    : PAR.USR CDE Parm 3 is Warehouse Code not Blank
      *   |- c5    : PAR.USR CDE Parm 4 is Warehouse Code not Blank
      *   |- c6    : PAR.USR CDE Parm 5 is Warehouse Code not Blank
      *   |- c7    : PAR.USR CDE Parm 6 is Warehouse Code not Blank
      *   |- c8    : PAR.USR CDE Parm 7 is Warehouse Code not Blank
      *   |- c9    : PAR.USR CDE Parm 8 is Warehouse Code not Blank
      *   |- c10   : PAR.USR CDE Parm 9 is Warehouse Code not Blank
      *   '-
     C           P3CPCD    IFNE *BLANK                     *IF
     C           P3VSCD    ORNE *BLANK                     *OR
     C           P3VTCD    ORNE *BLANK                     *OR
     C           P3VUCD    ORNE *BLANK                     *OR
     C           P3VVCD    ORNE *BLANK                     *OR
     C           P3VWCD    ORNE *BLANK                     *OR
     C           P3VXCD    ORNE *BLANK                     *OR
     C           P3VYCD    ORNE *BLANK                     *OR
     C           P3VZCD    ORNE *BLANK                     *OR
     C           P3V0CD    ORNE *BLANK                     *OR
     C                     MOVEL'N'       WUDJST           Select Status
      * Check warehouse 1
      * CASE: PAR.USR Warehouse Code is Warehouse Code not Blank
     C           P3CPCD    IFNE *BLANK                     *IF
      * RTV Check Warehouse    RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0025           Company Number
     C                     Z-ADDFLC4NB    WL0026           Order Number
     C                     MOVELP3CPCD    WL0027    P      Warehouse Code
     C                     MOVELWUDJST    WL0028    P      Select Status
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0028    WUDJST    P      Select Status
     C                     END                             *FI
      * Check warehouse 2
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.USR CDE Parm 1 is Warehouse Code not Blank
      *   |- c2    : WRK.Select Status is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3VSCD    IFNE *BLANK                     *IF
     C           WUDJST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Check Warehouse    RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0025           Company Number
     C                     Z-ADDFLC4NB    WL0026           Order Number
     C                     MOVELP3VSCD    WL0027    P      Warehouse Code
     C                     MOVELWUDJST    WL0028    P      Select Status
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0028    WUDJST    P      Select Status
     C                     END                             *FI
      * Check warehouse 3
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.USR CDE Parm 2 is Warehouse Code not Blank
      *   |- c2    : WRK.Select Status is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3VTCD    IFNE *BLANK                     *IF
     C           WUDJST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Check Warehouse    RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0025           Company Number
     C                     Z-ADDFLC4NB    WL0026           Order Number
     C                     MOVELP3VTCD    WL0027    P      Warehouse Code
     C                     MOVELWUDJST    WL0028    P      Select Status
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0028    WUDJST    P      Select Status
     C                     END                             *FI
      * Check warehouse 4
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.USR CDE Parm 3 is Warehouse Code not Blank
      *   |- c2    : WRK.Select Status is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3VUCD    IFNE *BLANK                     *IF
     C           WUDJST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Check Warehouse    RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0025           Company Number
     C                     Z-ADDFLC4NB    WL0026           Order Number
     C                     MOVELP3VUCD    WL0027    P      Warehouse Code
     C                     MOVELWUDJST    WL0028    P      Select Status
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0028    WUDJST    P      Select Status
     C                     END                             *FI
      * Check warehouse 5
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.USR CDE Parm 4 is Warehouse Code not Blank
      *   |- c2    : WRK.Select Status is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3VVCD    IFNE *BLANK                     *IF
     C           WUDJST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Check Warehouse    RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0025           Company Number
     C                     Z-ADDFLC4NB    WL0026           Order Number
     C                     MOVELP3VVCD    WL0027    P      Warehouse Code
     C                     MOVELWUDJST    WL0028    P      Select Status
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0028    WUDJST    P      Select Status
     C                     END                             *FI
      * Check warehouse 6
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.USR CDE Parm 5 is Warehouse Code not Blank
      *   |- c2    : WRK.Select Status is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3VWCD    IFNE *BLANK                     *IF
     C           WUDJST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Check Warehouse    RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0025           Company Number
     C                     Z-ADDFLC4NB    WL0026           Order Number
     C                     MOVELP3VWCD    WL0027    P      Warehouse Code
     C                     MOVELWUDJST    WL0028    P      Select Status
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0028    WUDJST    P      Select Status
     C                     END                             *FI
      * Check warehouse 7
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.USR CDE Parm 6 is Warehouse Code not Blank
      *   |- c2    : WRK.Select Status is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3VXCD    IFNE *BLANK                     *IF
     C           WUDJST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Check Warehouse    RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0025           Company Number
     C                     Z-ADDFLC4NB    WL0026           Order Number
     C                     MOVELP3VXCD    WL0027    P      Warehouse Code
     C                     MOVELWUDJST    WL0028    P      Select Status
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0028    WUDJST    P      Select Status
     C                     END                             *FI
      * Check warehouse 8
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.USR CDE Parm 7 is Warehouse Code not Blank
      *   |- c2    : WRK.Select Status is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3VYCD    IFNE *BLANK                     *IF
     C           WUDJST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Check Warehouse    RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0025           Company Number
     C                     Z-ADDFLC4NB    WL0026           Order Number
     C                     MOVELP3VYCD    WL0027    P      Warehouse Code
     C                     MOVELWUDJST    WL0028    P      Select Status
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0028    WUDJST    P      Select Status
     C                     END                             *FI
      * Check warehouse 9
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.USR CDE Parm 8 is Warehouse Code not Blank
      *   |- c2    : WRK.Select Status is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3VZCD    IFNE *BLANK                     *IF
     C           WUDJST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Check Warehouse    RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0025           Company Number
     C                     Z-ADDFLC4NB    WL0026           Order Number
     C                     MOVELP3VZCD    WL0027    P      Warehouse Code
     C                     MOVELWUDJST    WL0028    P      Select Status
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0028    WUDJST    P      Select Status
     C                     END                             *FI
      * Check warehouse 10
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.USR CDE Parm 9 is Warehouse Code not Blank
      *   |- c2    : WRK.Select Status is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3V0CD    IFNE *BLANK                     *IF
     C           WUDJST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Check Warehouse    RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0025           Company Number
     C                     Z-ADDFLC4NB    WL0026           Order Number
     C                     MOVELP3V0CD    WL0027    P      Warehouse Code
     C                     MOVELWUDJST    WL0028    P      Select Status
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0028    WUDJST    P      Select Status
     C                     END                             *FI
      * If select status is no then do not select record
      * CASE: WRK.Select Status is no
     C           WUDJST    IFEQ 'N'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Omit passed warehouses
      * CASE: PAR.USR Select/Omit Flag is Omit
     C           P3CYST    IFEQ 'O'                        *IF
      * Get the warehouse from the first order detail record
      * C2748:  Changed RTV Warehouse Code RT to exclude cancelled lines.
      * RTV Warehouse code     RT - PD Order Detail  * 
     C                     EXSR SPRVGN
      * Omit any Order Detail records matching warehouse codes passed in
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6ORc7ORc8ORc9ORc10
      *   |- c1    : PAR.USR Warehouse Code is Warehouse Code not Blank
      *   |- c2    : PAR.USR CDE Parm 1 is Warehouse Code not Blank
      *   |- c3    : PAR.USR CDE Parm 2 is Warehouse Code not Blank
      *   |- c4    : PAR.USR CDE Parm 3 is Warehouse Code not Blank
      *   |- c5    : PAR.USR CDE Parm 4 is Warehouse Code not Blank
      *   |- c6    : PAR.USR CDE Parm 5 is Warehouse Code not Blank
      *   |- c7    : PAR.USR CDE Parm 6 is Warehouse Code not Blank
      *   |- c8    : PAR.USR CDE Parm 7 is Warehouse Code not Blank
      *   |- c9    : PAR.USR CDE Parm 8 is Warehouse Code not Blank
      *   |- c10   : PAR.USR CDE Parm 9 is Warehouse Code not Blank
      *   '-
     C           P3CPCD    IFNE *BLANK                     *IF
     C           P3VSCD    ORNE *BLANK                     *OR
     C           P3VTCD    ORNE *BLANK                     *OR
     C           P3VUCD    ORNE *BLANK                     *OR
     C           P3VVCD    ORNE *BLANK                     *OR
     C           P3VWCD    ORNE *BLANK                     *OR
     C           P3VXCD    ORNE *BLANK                     *OR
     C           P3VYCD    ORNE *BLANK                     *OR
     C           P3VZCD    ORNE *BLANK                     *OR
     C           P3V0CD    ORNE *BLANK                     *OR
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6ORc7ORc8ORc9ORc10
      *   |- c1    : PAR.USR Warehouse Code EQ WRK.Warehouse Code
      *   |- c2    : PAR.USR CDE Parm 1 EQ WRK.Warehouse Code
      *   |- c3    : PAR.USR CDE Parm 2 EQ WRK.Warehouse Code
      *   |- c4    : PAR.USR CDE Parm 3 EQ WRK.Warehouse Code
      *   |- c5    : PAR.USR CDE Parm 4 EQ WRK.Warehouse Code
      *   |- c6    : PAR.USR CDE Parm 5 EQ WRK.Warehouse Code
      *   |- c7    : PAR.USR CDE Parm 6 EQ WRK.Warehouse Code
      *   |- c8    : PAR.USR CDE Parm 7 EQ WRK.Warehouse Code
      *   |- c9    : PAR.USR CDE Parm 8 EQ WRK.Warehouse Code
      *   |- c10   : PAR.USR CDE Parm 9 EQ WRK.Warehouse Code
      *   '-
     C           P3CPCD    IFEQ WUAJCD                     *IF
     C           P3VSCD    OREQ WUAJCD                     *OR
     C           P3VTCD    OREQ WUAJCD                     *OR
     C           P3VUCD    OREQ WUAJCD                     *OR
     C           P3VVCD    OREQ WUAJCD                     *OR
     C           P3VWCD    OREQ WUAJCD                     *OR
     C           P3VXCD    OREQ WUAJCD                     *OR
     C           P3VYCD    OREQ WUAJCD                     *OR
     C           P3VZCD    OREQ WUAJCD                     *OR
     C           P3V0CD    OREQ WUAJCD                     *OR
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDFLRMNB    WURMNB           Load ID
     C                     Z-ADDFLRUNB    WURUNB           Stop/Drop Seque
     C                     Z-ADDFLRVNB    WURVNB           Stop/Drop
     C                     Z-ADDFLC4NB    WUC4NB           Order Number
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0BL00  1        Load ID
     C                     MOVEL*BLANK    W0BL01  1        Stop/Drop
     C                     MOVEL*BLANK    W0BL02  1        Order Number
     C           W0EOFB    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0BL00  1        Load ID
     C                     MOVEL'Y'       W0BL01  1        Stop/Drop
     C                     MOVEL'Y'       W0BL02  1        Order Number
     C                     ELSE
      * Next record - Detect level breaks
     C           FLRMNB    IFNE WZB001                     Load ID
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL00
     C                     END
     C           FLRVNB    IFNE WZB002                     Stop/Drop
     C           W0BL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL01
     C                     END
     C           FLC4NB    IFNE WZB003                     Order Number
     C           W0BL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL02
     C                     END
     C                     END
      *================================================================
     CSR         B3EXIT    ENDSR
      /EJECT
     CSR         B4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0BL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP02
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Stop/Drop format
     C                     MOVEL'Y'       WN0023           USR Display 3
      * Do not print Departure Date and Time on subtotal line if more tha
      * one stop - print on load total only.
      * CASE: PAR.Total Stops is GT One Stop
     C           FJRRNB    IFGT 1                          *IF
     C                     MOVEL'N'       WN0023           USR Display 3
     C                     END                             *FI
      * Retrieve Departure Date and Time
      * CASE: PAR.Total Stops is One Stop
     C           FJRRNB    IFEQ 1                          *IF
     C                     Z-ADDWN0008    $IGFDT           Departure Date
      * CUR.Departure Time = PAR.Deadline Departure Time *HHMM
     C                     Z-ADDWN0009    XTTIM
     C           XTTIM     DIV  100       $IS6NB
      * Change zero hours to 24:00 hours unless date is also zero
      * CASE:
      *  - c1ANDc2
      *   |- c1    : CUR.Departure Time is Zero
      *   |- c2    : CUR.Departure Date is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $IS6NB    IFEQ *ZERO                      *IF
     C           $IGFDT    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD2400      $IS6NB           Departure Time
     C                     END                             *FI
     C                     END                             *FI
      * Do not print departure deadlines if DDdate/time = zeros
      * CASE:
      *  - c1ANDc2
      *   |- c1    : CUR.Departure Date is Not entered
      *   |- c2    : CUR.Departure Time is Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $IGFDT    IFEQ *ZERO                      *IF
     C           $IS6NB    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       WN0023           USR Display 3
     C                     END                             *FI
      * Do not print departure deadlines if Collect Truck
      * CASE: PAR.Shipping Method is Collect Truck
     C           WN0005    IFEQ 'CT'                       *IF
     C                     MOVEL'N'       WN0023           USR Display 3
     C                     END                             *FI
      * CASE: PAR.USR Weight 9 EQ CUR.USR Weight 9
     C           WN0020    IFEQ $ILLNA                     *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 3
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Convert fields to external form
      * Convert Departure Date to display format
      * Convert date
     C           1000000   ADD  $IGFDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VIGFDT
     C                     MOVEL'0'       *IN79
     C           WN0023    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print format
     C                     WRITE$IKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP01
      * USER: Process after print of Stop/Drop format
     C                     ADD  $ILLNA    $JLLNA           USR Weight 9
     C                     ADD  $IMAQT    $JMAQT           Quantity 9.0
     C                     Z-ADD$ILLNA    WN0020           USR Weight 9
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Load ID format
     C                     MOVEL'Y'       WN0024           USR Display 4
      * CASE: PAR.Total Stops is GT One Stop
     C           FJRRNB    IFGT 1                          *IF
     C                     Z-ADDWN0008    $JGFDT           Departure Date
      * CUR.Departure Time = PAR.Deadline Departure Time *HHMM
     C                     Z-ADDWN0009    XTTIM
     C           XTTIM     DIV  100       $JS6NB
      * ** Set time to midnight if it is zeros and date is entered
      * CASE:
      *  - c1ANDc2
      *   |- c1    : CUR.Departure Time is Zero
      *   |- c2    : CUR.Departure Date is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $JS6NB    IFEQ *ZERO                      *IF
     C           $JGFDT    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD2400      $JS6NB           Departure Time
     C                     END                             *FI
     C                     END                             *FI
      * Do not print departure deadlines if Collect Truck
      * CASE: PAR.Shipping Method is Collect Truck
     C           WN0005    IFEQ 'CT'                       *IF
     C                     MOVEL'N'       WN0024           USR Display 4
     C                     END                             *FI
     C                     ADD  $JLLNA    YL0001           Weight 11.0 USR
     C                     ADD  $JMAQT    P8KIQT           Quantity 11.0
      * CASE: PAR.USR Weight 9 EQ CUR.USR Weight 9
     C           WN0020    IFEQ $JLLNA                     *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Convert fields to external form
      * Convert Departure Date to display format
      * Convert date
     C           1000000   ADD  $JGFDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VJGFDT
     C                     MOVEL'0'       *IN79
     C           WN0024    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print format
     C                     WRITE$JKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP00
      * PRTOBJ calls after print of Load ID format
      * Embedded PRTOBJ : PRT Print Comments     PO
     C                     EXSR UDSUBR                     Embedded PRTOBJ
     C                     END
      *
     C           W0EOFB    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         B4EXIT    ENDSR
      /EJECT
     CSR         C0MAIN    BEGSR
      *================================================================
      * PRT Load List 1st Item PO: Mainline
      *================================================================
      * PRT Load List 1st Item PO: Initialise
     C                     EXSR ZCINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQKC01           Company Number
     C           *LIKE     DEFN WDC4NB    WQKC02           Order Number
      * Define keylist
     C           KPSC      KLIST
     C                     KFLD           WQKC01           Company Number
     C                     KFLD           WQKC02           Order Number
     C                     KFLD           WDDPNB           Order Sequence
     C                     KFLD           WDUENB           Order Secondary
      * Define keylist
     C           KRSC      KLIST
     C                     KFLD           WQKC01           Company Number
     C                     KFLD           WQKC02           Order Number
      * Setup key
     C                     Z-ADD$EAIC3    WQKC01           Company Number
     C                     Z-ADD$EC4NB    WQKC02           Order Number
     C                     Z-ADD*ZERO     WDDPNB           Order Sequence
     C                     Z-ADD*ZERO     WDUENB           Order Secondary
      * Establish starting position
     C           KPSC      SETLL@BGWKAE                    *
      * Read first record with user selection
     C                     EXSR C3READ
     C           W0EOFC    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0CL1P  1        First page
     C                     MOVEL'Y'       W0CL00  1        Company Number
     C                     MOVEL'Y'       W0CL01  1        Order Number
     C                     MOVEL'Y'       W0CL02  1        Order Sequence
     C                     MOVEL'Y'       W0CL03  1        Order Secondary
      * Set column headings flag
     C                     MOVE 'Y'       W0CCDT
      * Print report body
     C           W0EOFC    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR C1PHDR
      * Print report detail line
     C                     EXSR C2PDTL
      * Read next record with user selection
     C                     EXSR C3READ
      * Print totals
     C                     EXSR C4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         C0EXIT    ENDSR
      /EJECT
     CSR         C1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0CL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP1P  1
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP00  1
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP01  1
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP02  1
     C                     END
      *
     C           W0CL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP03  1
     C                     END
      *
      *================================================================
     CSR         C1EXIT    ENDSR
      /EJECT
     CSR         C2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDWDAIC3    $FAIC3           Company Number
     C                     Z-ADDWDC4NB    $FC4NB           Order Number
     C                     Z-ADDWDDPNB    $FDPNB           Order Sequence
     C                     Z-ADDWDUENB    $FUENB           Order Secondary
     C                     MOVELWDG7NA    $FG7NA           Order Desc. Lin
     C                     Z-ADDWDDUPR    $FDUPR           Invoice Unit Pr
     C                     Z-ADDWDB6VL    $FB6VL           Invoice Extende
     C                     Z-ADDWDA1AA    $FA1AA           Ham Group Numbe
     C                     MOVELWDFZSX    $FFZSX           OD Adj Type Ove
     C                     MOVELWDF0SX    $FF0SX           Affect Trade Fu
     C                     MOVELWDF1SX    $FF1SX           Affect Commissi
     C                     MOVELWDF2SX    $FF2SX           Affect Pricing
     C                     MOVELWDF3SX    $FF3SX           Released by Use
     C                     MOVELWDF4SX    $FF4SX           Ord TF Exempt C
     C                     MOVELWDF5SX    $FF5SX           OD Pallet Type
     C                     MOVELWDF6SX    $FF6SX           Production Ware
     C                     MOVELWDF7SX    $FF7SX           OD Price Type
     C                     Z-ADDWDNTDT    $FNTDT           Warehouse Palle
     C                     Z-ADDWDNUDT    $FNUDT           Consumed Item C
     C                     Z-ADDWDNVDT    $FNVDT           Deadline Depart
     C                     Z-ADDWDNWDT    $FNWDT           OD Price Type R
     C                     Z-ADDWDNXDT    $FNXDT           OD Firm Date
     C                     Z-ADDWDBUTM    $FBUTM           Deadline Depart
     C                     Z-ADDWDBVTM    $FBVTM           Price Code
     C                     Z-ADDWDBWTM    $FBWTM           Maximum Net Wei
     C                     Z-ADDWDBXTM    $FBXTM           Substitution Li
     C                     Z-ADDWDBYTM    $FBYTM           Max Qty to sche
     C                     Z-ADDWDH5NX    $FH5NX           Warehouse Palle
     C                     Z-ADDWDH6NX    $FH6NX           Warehouse Avg P
     C                     Z-ADDWDH7NX    $FH7NX           OD Item Target
     C                     Z-ADDWDH8NX    $FH8NX           OD Estimated Gr
     C                     Z-ADDWDH9NX    $FH9NX           OD Maximum Unit
     C                     Z-ADDWDDVPR    $FDVPR           Order Gate/Fina
     C                     Z-ADDWDDWPR    $FDWPR           OD Ceiling Pric
     C                     Z-ADDWDDXPR    $FDXPR           OD Gate/Final P
     C                     Z-ADDWDDYPR    $FDYPR           OD Weighted Avg
     C                     Z-ADDWDDZPR    $FDZPR           OD Original Ord
     C                     Z-ADDWDGSPR    $FGSPR           OD Cancel Date
     C                     Z-ADDWDGTPR    $FGTPR           OD Unused Prc 7
     C                     Z-ADDWDGUPR    $FGUPR           OD Unused Prc 8
     C                     MOVELWDHOST    $FHOST           OD MPR Sent to
     C                     MOVELWDHPST    $FHPST           OD MPR Prc Read
     C                     MOVELWDIOST    $FIOST           OD UnUsed Price
     C                     Z-ADDWDPEWG    $FPEWG           Weight Amount E
     C                     Z-ADDWDRINY    $FRINY           Item Age Days
     C                     Z-ADDWDTIDT    $FTIDT           Production Ovr
     C                     Z-ADDWDTJDT    $FTJDT           Production Ovr
     C                     MOVELWDH2ST    $FH2ST           OD Spot Buy
     C                     MOVELWDH0ST    $FH0ST           OD Clm Full Ret
     C                     MOVELWDH1ST    $FH1ST           Order Line Erro
     C                     Z-ADDWDTKDT    $FTKDT           OD Market Begin
     C                     Z-ADDWDTLDT    $FTLDT           OD Market Endin
     C                     Z-ADDWDTMDT    $FTMDT           OD Atch to Ord
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         C2EXIT    ENDSR
      /EJECT
     CSR         C3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WDAIC3    WZC001           Company Number
     C                     Z-ADDWDAIC3    WZC001
     C           *LIKE     DEFN WDC4NB    WZC002           Order Number
     C                     Z-ADDWDC4NB    WZC002
     C           *LIKE     DEFN WDDPNB    WZC003           Order Sequence
     C                     Z-ADDWDDPNB    WZC003
     C           *LIKE     DEFN WDUENB    WZC004           Order Secondary
     C                     Z-ADDWDUENB    WZC004
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFC    OREQ '1'
     C           KRSC      READE@BGWKAE                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFC  1
      * Quit if no record read
     C           W0EOFC    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * CASE: WRK.First Time Flag is NO
     C           WUTAST    IFEQ 'N'                        *IF
     C                     GOTO C3EXIT                     *QUIT
     C                     END                             *FI
     C                     MOVEL'N'       WUTAST           First Time Flag
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0CL00  1        Company Number
     C                     MOVEL*BLANK    W0CL01  1        Order Number
     C                     MOVEL*BLANK    W0CL02  1        Order Sequence
     C                     MOVEL*BLANK    W0CL03  1        Order Secondary
     C           W0EOFC    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0CL00  1        Company Number
     C                     MOVEL'Y'       W0CL01  1        Order Number
     C                     MOVEL'Y'       W0CL02  1        Order Sequence
     C                     MOVEL'Y'       W0CL03  1        Order Secondary
     C                     ELSE
      * Next record - Detect level breaks
     C           WDAIC3    IFNE WZC001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL00
     C                     END
     C           WDC4NB    IFNE WZC002                     Order Number
     C           W0CL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL01
     C                     END
     C           WDDPNB    IFNE WZC003                     Order Sequence
     C           W0CL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL02
     C                     END
     C           WDUENB    IFNE WZC004                     Order Secondary
     C           W0CL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL03
     C                     END
     C                     END
      *================================================================
     CSR         C3EXIT    ENDSR
      /EJECT
     CSR         C4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0CL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP03
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP02
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP01
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP00
     C                     END
      *
     C           W0EOFC    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         C4EXIT    ENDSR
      /EJECT
     CSR         D0MAIN    BEGSR
      *================================================================
      * PRT Blank Line         PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN ABAIC3    WQKD01           Company Number
      * Define keylist
     C           KRSD      KLIST
     C                     KFLD           WQKD01           Company Number
      * Setup key
     C                     Z-ADD$IAIC3    WQKD01           Company Number
      * Establish starting position
     C           KRSD      SETLL@ABREG3                    *
      * Read first record with user selection
     C                     EXSR D3READ
     C           W0EOFD    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0DL1P  1        First page
      * Set column headings flag
     C                     MOVE 'Y'       W0DCDT
      * Print report body
     C           W0EOFD    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR D1PHDR
      * Print report detail line
     C                     EXSR D2PDTL
      * Read next record with user selection
     C                     EXSR D3READ
      * Print totals
     C                     EXSR D4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         D0EXIT    ENDSR
      /EJECT
     CSR         D1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0DL1P    IFEQ 'Y'
      * Load related totals format
     C                     MOVEL*BLANK    $HAUNA           Description
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP1P  1
     C                     END
      *
      *================================================================
     CSR         D1EXIT    ENDSR
      /EJECT
     CSR         D2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDABAIC3    $GAIC3           Company Number
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         D2EXIT    ENDSR
      /EJECT
     CSR         D3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFD    OREQ '1'
     C           KRSD      READE@ABREG3                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFD  1
      * Quit if no record read
     C           W0EOFD    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C           W0EOFD    IFEQ '1'
      * End of file - Signal all level breaks
     C                     ELSE
      * Next record - Detect level breaks
     C                     END
      *================================================================
     CSR         D3EXIT    ENDSR
      /EJECT
     CSR         D4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0EOFD    IFEQ '1'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of final totals format
     C                     MOVEL*BLANK    $HAUNA           Description
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 1
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$HFINTTL
     C                     END
     C                     END
      *
      *================================================================
     CSR         D4EXIT    ENDSR
      /EJECT
     CSR         E0MAIN    BEGSR
      *================================================================
      * PRT Print Traffic Cmts PO: Mainline
      *================================================================
      * PRT Print Traffic Cmts PO: Initialise
     C                     EXSR ZEINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN KERMNB    WQKE01           Load ID
      * Define keylist
     C           KRSE      KLIST
     C                     KFLD           WQKE01           Load ID
      * Setup key
     C                     Z-ADD$JRMNB    WQKE01           Load ID
      * Establish starting position
     C           KRSE      SETLL@KECPGI                    *
      * Read first record with user selection
     C                     EXSR E3READ
     C           W0EOFE    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0EL1P  1        First page
     C                     MOVEL'Y'       W0EL00  1        Load ID
      * Set column headings flag
     C                     MOVE 'Y'       W0ECDT
      * Print report body
     C           W0EOFE    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR E1PHDR
      * Print report detail line
     C                     EXSR E2PDTL
      * Read next record with user selection
     C                     EXSR E3READ
      * Print totals
     C                     EXSR E4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         E0EXIT    ENDSR
      /EJECT
     CSR         E1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0EL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP1P  1
     C                     END
      *
     C           W0EL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP00  1
     C                     END
      *
      *================================================================
     CSR         E1EXIT    ENDSR
      /EJECT
     CSR         E2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     MOVEL*BLANK    $KO6TX           USR Carrier Upl
     C                     Z-ADDKERMNB    $KRMNB           Load ID
     C                     Z-ADDKEDXNB    $KDXNB           Sequence Number
     C                     MOVELKEGXTX    $KGXTX           Comment Line
     C                     MOVELKEUVST    $KUVST           EDI Status 1
     C                     MOVELKEUWST    $KUWST           EDI Status 2
     C                     MOVELKEUXST    $KUXST           EDI Status 3
     C                     MOVELKEVSST    $KVSST           Record Status
     C                     Z-ADDKEAATM    $KAATM           Job Time
     C                     MOVELKEAYNA    $KAYNA           User Id
     C                     MOVELKEA0NA    $KA0NA           Job Name
     C                     Z-ADDKEAXDT    $KAXDT           Job Date
      * USER: Process before print of detail format
      * CASE: DB1.Job Name EQ WRK.Job Name
     C           KEA0NA    IFEQ WUA0NA                     *IF
     C                     MOVEL'*'       $KO6TX           USR Carrier Upl
     C                     END                             *FI
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         E2EXIT    ENDSR
      /EJECT
     CSR         E3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN KERMNB    WZE001           Load ID
     C                     Z-ADDKERMNB    WZE001
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFE    OREQ '1'
     C           KRSE      READE@KECPGI                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFE  1
      * Quit if no record read
     C           W0EOFE    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0EL00  1        Load ID
     C           W0EOFE    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0EL00  1        Load ID
     C                     ELSE
      * Next record - Detect level breaks
     C           KERMNB    IFNE WZE001                     Load ID
      * Set on level break indicator
     C                     MOVEL'Y'       W0EL00
     C                     END
     C                     END
      *================================================================
     CSR         E3EXIT    ENDSR
      /EJECT
     CSR         E4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0EL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0EP00
     C                     END
      *
     C           W0EOFE    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         E4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of PRT Load List          PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of PRT Load List          PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print Scheduled Ship Date of PRT Load List          PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP00
     C                     END                             FI
      * Print Load U/M of PRT Load List          PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Load U/M format
      * Rtv UOM Description    RT - Unit of Measure  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL$CR0SX    WL0003    P      U/M - Primary D
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    $CUCTX    P      Description
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Print format
     C                     WRITE$CKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print Export Status of PRT Load List          PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP02
     C                     END                             FI
      * Print Schedule Sequence Number of PRT Load List          PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP03
     C                     END                             FI
      * Print Load ID of PRT Load List          PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP04
     C                     END                             FI
      * Print Detail line. of PRT Load List          PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
      * USER: On print of detail format
     C                     MOVEL'N'       WUDTSX           Print (Yes/No)
     C                     MOVEL'N'       WUW2ST           USR Active Flag
     C                     MOVEL*BLANK    P8CVCD           USR U/M 1
      * Mention hidden format
     C   99N99             WRITE$DDTLRCD
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Print First Page Format of PRT Load List Details  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0BL1P
     C                     END                             FI
      * Print Load ID of PRT Load List Details  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP00
     C                     END                             FI
      * Print Stop/Drop of PRT Load List Details  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP01
     C                     END                             FI
      * Print Order Number of PRT Load List Details  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP02
     C                     END                             FI
      * Print Detail line. of PRT Load List Details  PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0BCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
     C                     Z-ADDFJAIC3    $EFKNB           USR Company Num
     C                     MOVEL'Y'       WN0022           USR Display 2
     C                     MOVEL'N'       YL0003           USR Display 5
      * Increment counter (used for null report msg) if select record
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C                     Z-ADDFLRMNB    $ERMNB           Load ID
      * RTV Name,Cty,St,Wgt,BO RT - Order Header TRG  * 
     C                     EXSR SERVGN
      * List hold as CREDIT or PRODUCTION or both
      * CASE: PAR.Header Status is Hold
     C           WN0014    IFEQ 'H'                        *IF
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Credit Hold is Yes
      *   |- c2    : PAR.Production Hold is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0015    IFEQ 'Y'                        *IF
     C           WN0016    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL@CN,001   $EJ1TX           BLANK 1
     C                     ELSE
      * CASE: PAR.Credit Hold is Yes
     C           WN0015    IFEQ 'Y'                        *IF
     C                     MOVEL@CN,002   $EJ1TX           BLANK 1
     C                     ELSE
      * CASE: PAR.Production Hold is Yes
     C           WN0016    IFEQ 'Y'                        *IF
     C                     MOVEL@CN,003   $EJ1TX           BLANK 1
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Print special instructions if entered.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CUR.Special Instructions is Equal to Blank
      *   |- c2    : CUR.Special Instructions 2 is Equal to Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $EB6NA    IFEQ *BLANK                     *IF
     C           $EBYNA    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       WN0025           USR Display fie
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WN0025           USR Display fie
     C                     END                             *FI
      * 2/26/08 SAZ Accumulate the qty
     C           1         MULT WUBAQT    $EMAQT    H      Quantity 9.0
     C           1         MULT WUA1WG    $ELLNA    H      USR Weight 9
     C                     Z-ADD$DTLMI    $ETLMI           Total Load Mile
     C                     Z-ADD*ZERO     $DTLMI           Total Load Mile
      * ** This routine will be used for loads with blank Load U/M  S0026
      * S17054 DN 04/06/21-Count Cases as Boxes. Replaced function with
      *   'RTV UM/Whs Code-Add CS RT'.
      * RTV UM/Whs Code-Add CS RT - Order Detail  * 
     C                     EXSR SGRVGN
     C                     MOVEL'Y'       WUW2ST           USR Active Flag
     C                     MOVEL'Y'       WUE6ST           USR Status (Y/N
     C                     MOVELWUBRTX    $EOENA           USR Customer 18
     C                     MOVELWUHNNA    $ELMNA           USR City 15
     C                     MOVELWUDBCD    $ELNNA           USR State 2
      * RTV Schd. Seq. Carrs   RT - Load Header  * 
     C                     EXSR SIRVGN
      * RTV Name, Status       RT - OM Carrier  * 
     C                     EXSR SJRVGN
      * RTV Load List fields   RT - Order Header TRG  * 
     C                     EXSR SKRVGN
      * ** Check Order Header export status      FP1101 LJB 05/11/2007
      * If Export replace address information with Sail Port information.
      * CASE: PAR.Export Status is yes
     C           P4U2ST    IFEQ 'Y'                        *IF
      * ** 05/11/2007 LJB FP11014  Get Export info from OHE not Load Head
      * 08/06/19 DN R15161-Set OHE Voyage & Booking #. It is not used.
      * RTV OHE Ship fields    RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$EAIC3    WL0008           Company Number
     C                     Z-ADD$EC4NB    WL0009           Order Number
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    WN0006    P      Shipping Line
     C                     MOVELWL0011    WN0007    P      Port Delv Termi
     C                     MOVELWL0012    YL0010    P      OHE City
     C                     MOVELWL0013    WUK4TX    P      OHE Vessel/Airl
     C                     MOVELWL0014    WUGENY    P      OHE Voyage/Flig
     C                     MOVELWL0015    WUJ1T1    P      OHE Booking Num
     C                     MOVELWL0016    WUW4CD    P      OHE Discharge P
     C                     Z-ADDWL0017    WUKBDT           OHE Sail/Flight
     C                     Z-ADDWL0018    YL0011           OHE Port Cut Da
     C                     Z-ADDWL0019    WUEFDT           OHE Arrival Dat
     C                     MOVELWL0020    YL0012    P      OHE Late Delive
     C                     MOVELWL0021    YL0013    P      OHE Ship Status
     C                     MOVELWL0022    WUCNTN    P      OHE Container N
     C                     MOVELWL0023    YL0014    P      OHE Comment 1
     C                     MOVELWL0024    YL0015    P      OHE Comment 2
      * ** Use Shipping Line and Port Deliv Term from OHE
      * CASE: PAR.Port Delv Terminal is Entered
     C           WN0007    IFNE *BLANK                     *IF
      * RTV Shipping Line/PortsRT - Shipping Line/Port  * 
     C                     EXSR SMRVGN
     C                     END                             *FI
      * ** Set flag if at least one export order on this load   E00239
      * CASE: WRK.Select Status is yes
     C           WUDJST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUDXSX           Display Flag 1
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    $ENGST           Flag 2
     C                     MOVELWN0006    $ENGST           Flag 2
     C                     MOVELFJDXTX    $EMUTX           Trailer Id
      * If not first time, then hide sequence number & load id fields
      * CASE: WRK.USR First Time is No
     C           WUTMST    IFEQ 'N'                        *IF
     C                     MOVEL'N'       WUE6ST           USR Status (Y/N
     C                     END                             *FI
     C                     MOVEL'N'       WUTMST           USR First Time
      * CASE: PAR.MG Created Load is Not MG Created Load
     C           WN0010    IFEQ *BLANK                     *IF
      * Print miles on first stop only
      * CASE: CUR.Stop/Drop is Stop One
     C           $ERVNB    IFEQ 1                          *IF
     C                     MOVEL'Y'       WUB8ST           Status - Y or N
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Print miles on 2nd   stop only for MG loads --  whd 57687 RMC
      * CASE: CUR.Stop/Drop is Stop 2
     C           $ERVNB    IFEQ 2                          *IF
     C                     MOVEL'Y'       WUB8ST           Status - Y or N
     C                     END                             *FI
     C                     END                             *FI
      * ** Print truck temperature & text. This is from the Load Header.
      * ** Okay to print load temp on each order line per Bo. E000769
     C                     Z-ADDFJRNNB    $EPRTM           Product Tempera
     C                     MOVELFJWRTX    $EPFTX           Text 1 Length U
      * USR Display 1 is used to control line spacing for the special ins
      * line.  Spacing is controlled by a blank description field at the
      * beginning of the line.  If nothing is going to be printed on that
      * the line spacing should not occur.  Set to Yes then test for No.
     C                     MOVEL'Y'       WN0021           USR Display 1
      * Do not print if line is blank
      * CASE:
      *  - c1ANDc2ANDc3
      *   |- c1    : PAR.Block Order Flag is Firm Order
      *   |- c2    : PAR.Export Status is Not Yes
      *   |- c3    : PAR.USR Display field is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0019    IFEQ 'F'                        *IF
     C           P4U2ST    IFEQ *BLANK                     *IF
     C           P4U2ST    OREQ 'N'
     C           WN0025    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       WN0021           USR Display 1
     C                     END                             *FI
      * Do not print Departure Date and Time on detail line if there is m
      * than 1 order on the load.  They will print at Stop total or Load
      * RTV Nbr of Orders/Load RT - OM Load Detail  * 
     C                     EXSR SNRVGN
      * If multi stops, only print DDD/T on the total line, not here
      * CASE: PAR.Number of Orders is Greater Than 1
     C           WN0013    IFGT 1                          *IF
     C                     Z-ADD*ZERO     $EGFDT           Departure Date
      * CUR.Departure Time = CON.*ZERO *HHMM
     C                     Z-ADD*ZERO     XTTIM
     C           XTTIM     DIV  100       $ES6NB
     C                     MOVEL'N'       WN0022           USR Display 2
      * ** Set flag if at least one warehouse selected on load   E00239
      * CASE: WRK.Select Status is yes
     C           WUDJST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUDXSX           Display Flag 1
     C                     END                             *FI
     C                     END                             *FI
      * Retrieve Departure Date and Time
      * CASE: PAR.Number of Orders is One
     C           WN0013    IFEQ 1                          *IF
     C                     MOVEL'Y'       WN0022           USR Display 2
     C                     Z-ADDWN0008    $EGFDT           Departure Date
      * CUR.Departure Time = PAR.Deadline Departure Time *HHMM
     C                     Z-ADDWN0009    XTTIM
     C           XTTIM     DIV  100       $ES6NB
      * Change zero hours to 24:00 hours unless date is also zero
      * CASE:
      *  - c1ANDc2
      *   |- c1    : CUR.Departure Time is Zero
      *   |- c2    : CUR.Departure Date is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $ES6NB    IFEQ *ZERO                      *IF
     C           $EGFDT    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD2400      $ES6NB           Departure Time
     C                     END                             *FI
      * Do not print departure deadlines if Collect Truck
      * CASE: CUR.Shipping Method is Collect Truck
     C           $EQ2CD    IFEQ 'CT'                       *IF
     C                     MOVEL'N'       WN0022           USR Display 2
     C                     END                             *FI
      * Do not print Departure Date/Time if Load Status is not Locked OR
      *   Mileage is <= Zero OR Load Accepted Flag is not Accepted.
      * e00495 dont do this
     C                     END                             *FI
     C                     MOVEL$EQ2CD    WN0005           Shipping Method
      * ** Display "Invoiced" constant if order has been invoiced
      * CASE: PAR.Load Status is Invoiced
     C           WN0003    IFEQ 'I'                        *IF
     C                     MOVEL'Y'       YL0003           USR Display 5
     C                     END                             *FI
      * Print Invoice Line flag
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.USR Display 5 is No
      *   |- c2    : LCL.Export Docs Go w/Driver is Not Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0003    IFEQ 'N'                        *IF
     C           YL0009    IFEQ *BLANK                     *IF
     C           YL0009    OREQ 'N'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       YL0016           Display Flag
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       YL0016           Display Flag
     C                     END                             *FI
     C                     MOVEL'N'       WUB8ST           Status - Y or N
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $EC4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$EC4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VEC4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VEC4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  $EEIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VEEIDT
      * Convert Departure Date to display format
      * Convert date
     C           1000000   ADD  $EGFDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VEGFDT
      * Convert USR Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $EFKNB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$EFKNB    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VEFKNB           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VEFKNB           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $EAIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$EAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VEAIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VEAIC3           CD3 Ext Numeric
     C                     END                             *FI
     C                     MOVEL'0'       *IN79
     C           WUE6ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           WN0022    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           WN0021    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C           WN0019    IFEQ 'F'                        *IF
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
     C                     MOVEL'0'       *IN75
     C           YL0008    IFEQ *BLANK                     *IF
     C           YL0008    OREQ 'N'
     C                     MOVEL'1'       *IN75
     C                     END                             *FI
     C                     MOVEL'0'       *IN74
     C           P4U2ST    IFEQ *BLANK                     *IF
     C           P4U2ST    OREQ 'N'
     C                     MOVEL'1'       *IN74
     C                     END                             *FI
     C                     MOVEL'0'       *IN73
     C           WN0025    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN73
     C                     END                             *FI
     C                     MOVEL'0'       *IN72
     C           YL0016    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN72
     C                     END                             *FI
     C                     MOVEL'0'       *IN71
     C           YL0003    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN71
     C                     END                             *FI
     C                     MOVEL'0'       *IN70
     C           YL0009    IFEQ *BLANK                     *IF
     C           YL0009    OREQ 'N'
     C                     MOVEL'1'       *IN70
     C                     END                             *FI
      * Print column headings if required
     C           W0BCDT    IFEQ 'Y'
     C                     WRITE$ECOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0BCDT
     C                     END                             FI
      * Print format
     C                     WRITE$EDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BPDT
     C                     END                             FI
      * Print First Page Format of PRT Load List 1st Item PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0CL1P
     C                     END                             FI
      * Print Company Number of PRT Load List 1st Item PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP00
     C                     END                             FI
      * Print Order Number of PRT Load List 1st Item PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP01
     C                     END                             FI
      * Print Order Sequence Number of PRT Load List 1st Item PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP02
     C                     END                             FI
      * Print Order Secondary Line Seq of PRT Load List 1st Item PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP03
     C                     END                             FI
      * Print Detail line. of PRT Load List 1st Item PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0CCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CPDT    ANDEQ'P'
      * Print column headings if required
     C           W0CCDT    IFEQ 'Y'
     C                     WRITE$FCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0CCDT
     C                     END                             FI
      * Print format
     C                     WRITE$FDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0CPDT
     C                     END                             FI
      * Print First Page Format of PRT Blank Line         PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0DL1P
     C                     END                             FI
      * Print Detail line. of PRT Blank Line         PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0DCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DPDT    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$GDTLRCD
      * Reset format print flag
     C                     MOVE *BLANK    W0DPDT
     C                     END                             FI
      * Print First Page Format of PRT Print Traffic Cmts PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0EL1P
     C                     END                             FI
      * Print Load ID of PRT Print Traffic Cmts PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP00
     C                     END                             FI
      * Print Detail line. of PRT Print Traffic Cmts PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ECDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EPDT    ANDEQ'P'
      * Print column headings if required
     C           W0ECDT    IFEQ 'Y'
     C                     WRITE$KCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ECDT
     C                     END                             FI
      * Print format
     C                     WRITE$KDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0EPDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of PRT Load List          PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Scheduled Ship Date of PRT Load List          PF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Load U/M of PRT Load List          PF
     C           W0AP01    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * Export Status of PRT Load List          PF
     C           W0AP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Schedule Sequence Number of PRT Load List          PF
     C           W0AP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Load ID of PRT Load List          PF
     C           W0AP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Load List          PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD0         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT Load List Details  PO
     C           W0BP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Load ID of PRT Load List Details  PO
     C           W0BP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Stop/Drop of PRT Load List Details  PO
     C           W0BP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Number of PRT Load List Details  PO
     C           W0BP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Load List Details  PO
     C           W0BPDT    IFEQ 'Y'
     C                     Z-ADD4         W0DTLN
     C           W0BCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT Load List 1st Item PO
     C           W0CP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of PRT Load List 1st Item PO
     C           W0CP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Number of PRT Load List 1st Item PO
     C           W0CP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Sequence Number of PRT Load List 1st Item PO
     C           W0CP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Secondary Line Seq of PRT Load List 1st Item PO
     C           W0CP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Load List 1st Item PO
     C           W0CPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0CCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT Blank Line         PO
     C           W0DP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Blank Line         PO
     C           W0DPDT    IFEQ 'Y'
     C                     Z-ADD0         W0DTLN
     C           W0DCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT Print Traffic Cmts PO
     C           W0EP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Load ID of PRT Print Traffic Cmts PO
     C           W0EP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Print Traffic Cmts PO
     C           W0EPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0ECDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
      * USER: Process top of page
     C                     Z-ADDP7BYC3    $BBYC3           Order Company N
      * Order company name
      * CASE: TOP.Order Company Number Usr is greater than zero
     C           $BBYC3    IFGT *ZERO                      *IF
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$BBYC3    WL0001           Company Number
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    $BEUT1    P      Name
     C                     END                             *FI
     C                     Z-ADDP2AIC3    $BFKNB           USR Company Num
      * Company Name    5/14/04
      * CASE: TOP.USR Company Number is greater than zero
     C           $BFKNB    IFGT *ZERO                      *IF
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$BFKNB    WL0001           Company Number
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    $BAPTX    P      Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $BAPTX           Company Name
     C                     MOVEL'*ALL'    $BAPTX           Company Name
     C                     END                             *FI
      * Set up warehouses
      * CASE:
      *  - c1ANDc2ANDc3ANDc4ANDc5ANDc6ANDc7ANDc8ANDc9ANDc10
      *   |- c1    : PAR.USR Warehouse Code is Warehouse Code Blank
      *   |- c2    : PAR.USR CDE Parm 1 is Warehouse Code Blank
      *   |- c3    : PAR.USR CDE Parm 2 is Warehouse Code Blank
      *   |- c4    : PAR.USR CDE Parm 3 is Warehouse Code Blank
      *   |- c5    : PAR.USR CDE Parm 4 is Warehouse Code Blank
      *   |- c6    : PAR.USR CDE Parm 5 is Warehouse Code Blank
      *   |- c7    : PAR.USR CDE Parm 6 is Warehouse Code Blank
      *   |- c8    : PAR.USR CDE Parm 7 is Warehouse Code Blank
      *   |- c9    : PAR.USR CDE Parm 8 is Warehouse Code Blank
      *   |- c10   : PAR.USR CDE Parm 9 is Warehouse Code Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3CPCD    IFEQ *BLANK                     *IF
     C           P3VSCD    IFEQ *BLANK                     *IF
     C           P3VTCD    IFEQ *BLANK                     *IF
     C           P3VUCD    IFEQ *BLANK                     *IF
     C           P3VVCD    IFEQ *BLANK                     *IF
     C           P3VWCD    IFEQ *BLANK                     *IF
     C           P3VXCD    IFEQ *BLANK                     *IF
     C           P3VYCD    IFEQ *BLANK                     *IF
     C           P3VZCD    IFEQ *BLANK                     *IF
     C           P3V0CD    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'ALL'     $BCPCD           USR Warehouse C
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELP3CPCD    $BCPCD           USR Warehouse C
     C                     MOVELP3VSCD    $BVSCD           USR CDE Parm 1
     C                     MOVELP3VTCD    $BVTCD           USR CDE Parm 2
     C                     MOVELP3VUCD    $BVUCD           USR CDE Parm 3
     C                     MOVELP3VVCD    $BVVCD           USR CDE Parm 4
     C                     MOVELP3VWCD    $BVWCD           USR CDE Parm 5
     C                     MOVELP3VXCD    $BVXCD           USR CDE Parm 6
     C                     MOVELP3VYCD    $BVYCD           USR CDE Parm 7
     C                     MOVELP3VZCD    $BVZCD           USR CDE Parm 8
     C                     MOVELP3V0CD    $BV0CD           USR CDE Parm 9
     C                     END                             *FI
     C                     Z-ADDP2AODT    $BBQDT           USR Date - ATR
      * TOP.USR Desc. 10 = Condition name of PAR.USR Select/Omit Flag
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1377659   Y2LSNO  70       List number
     C                     PARM P3CYST    W0INVL 25        USR Select/Omit
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $BNCNA    PARM           W0CNNM 25        USR Desc. 10
      *
     C                     MOVELP2VDST    $BVDST           Load Type
      * Set load type description
      * CASE: TOP.Load Type is Blank
     C           $BVDST    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    $BHLTX           Condition Desc.
     C                     MOVEL'ALL'     $BHLTX           Condition Desc.
     C                     ELSE
      * CASE: *OTHERWISE
      * TOP.Condition Desc. 1  USR = Condition name of TOP.Load Type
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1250409   Y2LSNO  70       List number
     C                     PARM $BVDST    W0INVL 25        Load Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $BHLTX    PARM           W0CNNM 25        Condition Desc.
      *
     C                     END                             *FI
     C                     MOVELP5ADCD    $BADCD           U/M - Primary
      * Set UOM description
      * CASE: TOP.U/M - Primary is Not Entered
     C           $BADCD    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    $BAUNA           Description
     C                     MOVEL'ALL'     $BAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv UOM Description    RT - Unit of Measure  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL$BADCD    WL0003    P      U/M - Primary D
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    $BAUNA    P      Description
     C                     END                             *FI
     C                     MOVELP6DVSX    $BDVSX           Loads Shipped o
      * Set Loads shipped/unshipped description
      * CASE: TOP.Loads Shipped or Unship is Shipped
     C           $BDVSX    IFEQ 'S'                        *IF
      * TOP.Condition Desc. 2  USR = Condition name of TOP.Loads Shipped
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1530367   Y2LSNO  70       List number
     C                     PARM $BDVSX    W0INVL 25        Loads Shipped o
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $BHMTX    PARM           W0CNNM 25        Condition Desc.
      *
     C                     ELSE
      * CASE: TOP.Loads Shipped or Unship is Unshipped
     C           $BDVSX    IFEQ 'U'                        *IF
      * TOP.Condition Desc. 2  USR = Condition name of TOP.Loads Shipped
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1530367   Y2LSNO  70       List number
     C                     PARM $BDVSX    W0INVL 25        Loads Shipped o
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $BHMTX    PARM           W0CNNM 25        Condition Desc.
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $BHMTX           Condition Desc.
     C                     MOVEL'ALL'     $BHMTX           Condition Desc.
     C                     END                             *FI
     C                     END                             *FI
      * Convert fields to external form
      * Convert Order Company Number Usr to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $BBYC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$BBYC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VBBYC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VBBYC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert USR Date - ATR to display format
      * Convert date
     C           1000000   ADD  $BBQDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBBQDT
      * Convert USR Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $BFKNB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$BFKNB    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VBFKNB           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VBFKNB           CD3 Ext Numeric
     C                     END                             *FI
     C                     MOVEL'0'       *IN79
     C           WUDTSX    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           WUGGST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSA01           Application Cod
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSA01           Application Cod
     C                     MOVEL'OMS'     WQSA01           Application Cod
      * Establish starting position
     C           KRSSA     SETLL@DNRESF                    *
     C           KRSSA     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
     C           KRSSA     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSB01           Application Cod
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSB01           Application Cod
      * Establish starting position
     C           KRSSB     SETLL@DNRESF                    *
     C           KRSSB     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSB     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0001    ABAIC3           Company Number
      * Establish starting position
     C           KRSSC     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           Name
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    WL0002           Name
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv UOM Description    RT - Unit of Measure  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           AMHHCD           U/M - Primary D
      * Setup key
     C                     MOVELWL0003    AMHHCD           U/M - Primary D
      * Establish starting position
     C           KRSSD     CHAIN@AMREB0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0033' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0004           Description
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELAMAUNA    WL0004           Description
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Name,Cty,St,Wgt,BO RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDFLAIC3    BEAIC3           Company Number
     C                     Z-ADDFLC4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSE     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUBKC7           Ship To Custome
     C                     MOVEL*BLANK    WUBRTX           Ship To Name
     C                     MOVEL*BLANK    WUHNNA           Ship To City
     C                     MOVEL*BLANK    WUDBCD           Ship To State C
     C                     MOVEL*BLANK    $EB6NA           Special Instruc
     C                     MOVEL*BLANK    $EBYNA           Special Instruc
     C                     MOVEL*BLANK    WN0014           Header Status
     C                     Z-ADD*ZERO     WUA1WG           Order Weight To
     C                     MOVEL*BLANK    WN0015           Credit Hold
     C                     MOVEL*BLANK    WN0016           Production Hold
     C                     MOVEL*BLANK    WN0019           Block Order Fla
     C                     MOVEL*BLANK    $EFNSX           Transfer in Sto
     C                     Z-ADD*ZERO     WUBAQT           USR Quantity
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     Z-ADDBEBKC7    WUBKC7           Ship To Custome
     C                     MOVELBEBRTX    WUBRTX           Ship To Name
     C                     MOVELBEHNNA    WUHNNA           Ship To City
     C                     MOVELBEDBCD    WUDBCD           Ship To State C
     C                     MOVELBEB6NA    $EB6NA           Special Instruc
     C                     MOVELBEBYNA    $EBYNA           Special Instruc
     C                     MOVELBEGWST    WN0014           Header Status
     C                     Z-ADDBEA1WG    WUA1WG           Order Weight To
     C                     MOVELBEXIST    WN0015           Credit Hold
     C                     MOVELBEXJST    WN0016           Production Hold
     C                     MOVELBEBCST    WN0019           Block Order Fla
     C                     MOVELBEFNSX    $EFNSX           Transfer in Sto
     C                     Z-ADD*ZERO     WUA1WG           Order Weight To
     C                     Z-ADD*ZERO     WUBAQT           USR Quantity
      * *----------------------------------------------------------------
      * * 05/15/00 PKD OMS336 Replaced with routine that will include
      * *                     the Pallet Tare Weight.
      * * 02/27/08 SAZ E00055 Replaced with routine that will include Qty
      * RTV Pallet/Tare        RT - Load Header  * 
     C                     EXSR SFRVGN
      * RTV Gross Wgt/Qty     XF - Order Detail  * 
     C                     CALL 'PQPQXFR'              90  RTV Gross Wgt/Q
     C                     PARM *BLANK    W0RTN   7
     C                     PARM BEAIC3    WQ0001  30       Company Number
     C                     PARM BEC4NB    WQ0002  70       Order Number
     C                     PARM *ZERO     WQ0003  30       Order Sequence
     C                     PARM *ZERO     WQ0004  30       Order Secondary
     C           WUA1WG    PARM WUA1WG    WQ0005 112       USR Weight Accu
     C           WUBAQT    PARM WUBAQT    WQ0006 112       Order Quantity
     C                     PARM YL0004    WQ0007  92       Avg Pallet Tare
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PQPQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * *----------------------------------------------------------------
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Pallet/Tare        RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WARMNB           Load ID
      * Setup key
     C                     Z-ADDBERMNB    WARMNB           Load ID
      * Establish starting position
     C           KRSSF     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWAICWG    YL0004           Avg Pallet Tare
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV UM/Whs Code-Add CS RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WUTAST           First Time Flag
     C                     Z-ADD*ZERO     YL0005           Boxes Total Qua
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSG01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSG02           Order Number
      * Define keylist
     C           KPSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Order Number
      * Setup key
     C                     Z-ADDFLAIC3    WQSG01           Company Number
     C                     Z-ADD$EC4NB    WQSG02           Order Number
     C                     Z-ADD*ZERO     OMDPNB           Order Sequence
     C                     Z-ADD*ZERO     OMUENB           Order Secondary
      * Establish starting position
     C           KPSSG     SETLL@BGWKL1                    *
     C           KRSSG     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    $EAJCD           Warehouse Code
     C                     MOVEL*BLANK    $EODCD           USR Unit of Mea
     C                     GOTO SGEXIT                     *QUIT
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PF3280 -- add "Cases" to the case-stmt
     C                     MOVELOMAJCD    $EAJCD           Warehouse Code
      * CASE:
      *  - c1ORc2ORc3ORc4
      *   |- c1    : DB1.U/M - Ordered is Combos
      *   |- c2    : DB1.U/M - Ordered is EQ Boxes
      *   |- c3    : DB1.U/M - Ordered is Mixed
      *   |- c4    : DB1.U/M - Ordered is Cases
      *   '-
     C           OMAGCD    IFEQ 'CB'                       *IF
     C           OMAGCD    OREQ 'BX'                       *OR
     C           OMAGCD    OREQ 'MX'                       *OR
     C           OMAGCD    OREQ 'CS'                       *OR
      * CASE: DB1.Detail Line Status is Cancelled
     C           OMGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * S17054 DN 04/06/21-Beyond this point, changed all 'U/M - Ordered'
      *   to reference LCL Context instead of DB1.
      * S17054 DN 04/06/21-Count Type 'Cases' (CS) as 'Boxes' (BX).
      * CASE: *OTHERWISE
     C                     MOVELOMAGCD    YL0006           U/M - Ordered
      * CASE: LCL.U/M - Ordered is Cases
     C           YL0006    IFEQ 'CS'                       *IF
     C                     MOVEL'BX'      YL0006           U/M - Ordered
     C                     END                             *FI
      * Sum for later check
      * CASE: LCL.U/M - Ordered is EQ Boxes
     C           YL0006    IFEQ 'BX'                       *IF
     C                     ADD  OMAVQT    YL0005           Boxes Total Qua
     C                     END                             *FI
      * CASE: PAR.USR Unit of Measure is *Blank
     C           $EODCD    IFEQ *BLANK                     *IF
     C                     MOVELYL0006    $EODCD           USR Unit of Mea
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.U/M - Ordered EQ PAR.USR Unit of Measure
     C           YL0006    IFEQ $EODCD                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'MX'      WUAGCD           U/M - Ordered
     C                     MOVELWUAGCD    $EODCD           USR Unit of Mea
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSG     READE@BGWKL1                  90*
     C                     ENDDO
      * USER: Exit processing
      * E2709 RMC 9/12/13  Classify as BX/CB - never MX
      * CASE: PAR.USR Unit of Measure is Mixed
     C           $EODCD    IFEQ 'MX'                       *IF
      * RTV Numeric Value      RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDOMAIC3    WL0005           Company Number
     C                     MOVEL'BOXLOAD' WL0006    P      Company Value C
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0007    YL0007           System Value Nu
      * CASE: LCL.Boxes Total Quantity LT LCL.Box Load Min Box Qty USR
     C           YL0005    IFLT YL0007                     *IF
     C                     MOVEL'CB'      $EODCD           USR Unit of Mea
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'BX'      $EODCD           USR Unit of Mea
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Numeric Value      RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           KMAIC3           Company Number
     C                     KFLD           KMV8CD           Company Value C
      * Setup key
     C                     Z-ADDWL0005    KMAIC3           Company Number
     C                     MOVELWL0006    KMV8CD           Company Value C
      * Establish starting position
     C           KRSSH     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDKMM8NB    WL0007           System Value Nu
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Schd. Seq. Carrs   RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WARMNB           Load ID
      * Setup key
     C                     Z-ADDFJRMNB    WARMNB           Load ID
      * Establish starting position
     C           KRSSI     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAPKST    WN0003           Load Status
     C                     MOVELWABZNA    WN0004           Carrier Code
     C                     Z-ADDWAT4NB    $ET4NB           Schedule Sequen
     C                     Z-ADDWAKZDT    WN0008           Deadline Depart
     C                     Z-ADDWAAXTM    WN0009           Deadline Depart
     C                     MOVELWARYSX    WN0010           MG Created Load
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Name, Status       RT - OM Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           FFBZNA           Carrier Code
      * Setup key
     C                     MOVELWN0004    FFBZNA           Carrier Code
      * Establish starting position
     C           KRSSJ     CHAIN@FFREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $ENANA           Name
     C                     MOVEL*BLANK    WUVSST           Record Status
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFFADTX    $ENANA           Name
     C                     MOVELFFVSST    WUVSST           Record Status
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Load List fields   RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD$EAIC3    BEAIC3           Company Number
     C                     Z-ADD$EC4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSK     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBEBCNA    $EBCNA           Customer Purcha
     C                     Z-ADDBEA1WG    WUA1WG           Order Weight To
     C                     Z-ADDBEEIDT    $EEIDT           Requested Deliv
     C                     Z-ADDBEAFTM    $EAFTM           Requested Deliv
     C                     MOVELBEQ2CD    $EQ2CD           Shipping Method
     C                     MOVELBEU2ST    P4U2ST           Export Status
     C                     MOVELBEVEST    $EVEST           Palletize
     C                     MOVELBEVFST    $EVFST           Shrink Wrap
     C                     MOVELBEVGST    $EVGST           Slip Sheet
     C                     MOVELBEVDST    WUVDST           Load Type
     C                     MOVELBEMHNA    WUMHNA           Special Comment
     C                     MOVELBEMINA    WUMINA           Special Comment
     C                     MOVELBEBDST    YL0008           Order Certifica
     C                     MOVELBEFQSX    YL0009           Export Docs Go
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV OHE Ship fields    RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0008    WBAIC3           Company Number
     C                     Z-ADDWL0009    WBC4NB           Order Number
      * Establish starting position
     C           KRSSL     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0010           Shipping Line
     C                     MOVEL*BLANK    WL0011           Port Delv Termi
     C                     MOVEL*BLANK    WL0012           OHE City
     C                     MOVEL*BLANK    WL0013           OHE Vessel/Airl
     C                     MOVEL*BLANK    WL0014           OHE Voyage/Flig
     C                     MOVEL*BLANK    WL0015           OHE Booking Num
     C                     MOVEL*BLANK    WL0016           OHE Discharge P
     C                     Z-ADD*ZERO     WL0017           OHE Sail/Flight
     C                     Z-ADD*ZERO     WL0018           OHE Port Cut Da
     C                     Z-ADD*ZERO     WL0019           OHE Arrival Dat
     C                     MOVEL*BLANK    WL0020           OHE Late Delive
     C                     MOVEL*BLANK    WL0021           OHE Ship Status
     C                     MOVEL*BLANK    WL0022           OHE Container N
     C                     MOVEL*BLANK    WL0023           OHE Comment 1
     C                     MOVEL*BLANK    WL0024           OHE Comment 2
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBXACD    WL0010           Shipping Line
     C                     MOVELWBOANA    WL0011           Port Delv Termi
     C                     MOVELWBHBAA    WL0012           OHE City
     C                     MOVELWBJ0T1    WL0013           OHE Vessel/Airl
     C                     MOVELWBGENY    WL0014           OHE Voyage/Flig
     C                     MOVELWBJ1T1    WL0015           OHE Booking Num
     C                     MOVELWBHCAA    WL0016           OHE Discharge P
     C                     Z-ADDWBQWDT    WL0017           OHE Sail/Flight
     C                     Z-ADDWBQXDT    WL0018           OHE Port Cut Da
     C                     Z-ADDWBQYDT    WL0019           OHE Arrival Dat
     C                     MOVELWBHDAA    WL0020           OHE Late Delive
     C                     MOVELWBCCTX    WL0021           OHE Ship Status
     C                     MOVELWBJ2T1    WL0022           OHE Container N
     C                     MOVELWBRLNA    WL0023           OHE Comment 1
     C                     MOVELWBRMNA    WL0024           OHE Comment 2
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Shipping Line/PortsRT - Shipping Line/Port  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           LCXACD           Shipping Line
     C                     KFLD           LCOANA           Port Delv Termi
      * Setup key
     C                     MOVELWN0006    LCXACD           Shipping Line
     C                     MOVELWN0007    LCOANA           Port Delv Termi
      * Establish starting position
     C           KRSSM     CHAIN@LCREL2              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2419' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $ELMNA           Port City
     C                     MOVEL*BLANK    WULBTX           Port Address Li
     C                     MOVEL*BLANK    WULATX           Port Address Li
     C                     MOVEL*BLANK    $ELNNA           Sail Port State
     C                     MOVEL*BLANK    WULCTX           Port Zip/Postal
     C                     Z-ADD*ZERO     WUSPPN           Port Phone Numb
     C                     MOVEL*BLANK    WULDTX           Port Fax Number
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELLCOKTX    $ELMNA           Port City
     C                     MOVELLCLBTX    WULBTX           Port Address Li
     C                     MOVELLCLATX    WULATX           Port Address Li
     C                     MOVELLCXBCD    $ELNNA           Sail Port State
     C                     MOVELLCLCTX    WULCTX           Port Zip/Postal
     C                     Z-ADDLCSPPN    WUSPPN           Port Phone Numb
     C                     MOVELLCLDTX    WULDTX           Port Fax Number
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Nbr of Orders/Load RT - OM Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WN0013           Number of Order
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCRMNB    WQSN01           Load ID
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Load ID
      * Setup key
     C                     Z-ADD$ERMNB    WQSN01           Load ID
      * Establish starting position
     C           KRSSN     SETLL@FLCPBW                    *
     C           KRSSN     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         WN0013           Number of Order
     C           KRSSN     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Check Warehouse    RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSO01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSO02           Order Number
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Company Number
     C                     KFLD           WQSO02           Order Number
      * Setup key
     C                     Z-ADDWL0025    WQSO01           Company Number
     C                     Z-ADDWL0026    WQSO02           Order Number
      * Establish starting position
     C           KRSSO     SETLL@BGWKL1                    *
     C           KRSSO     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Cancelled
     C           OMGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.Warehouse Code
     C           OMAJCD    IFEQ WL0027                     *IF
     C                     MOVEL'Y'       WL0028           Select Status
     C                     GOTO SOEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSO     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Warehouse code     RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSP01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSP02           Order Number
      * Define keylist
     C           KPSSP     KLIST
     C                     KFLD           WQSP01           Company Number
     C                     KFLD           WQSP02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           Company Number
     C                     KFLD           WQSP02           Order Number
      * Setup key
     C                     Z-ADDFLAIC3    WQSP01           Company Number
     C                     Z-ADDFLC4NB    WQSP02           Order Number
     C                     Z-ADD*ZERO     OMDPNB           Order Sequence
     C                     Z-ADD*ZERO     OMUENB           Order Secondary
      * Establish starting position
     C           KPSSP     SETLL@BGWKL1                    *
     C           KRSSP     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAJCD           Warehouse Code
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * C2748:  Changed RTV Warehouse Code RT to exclude Cancelled lines.
      * CASE: DB1.Detail Line Status is Cancelled
     C           OMGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR = DB1 By name
     C                     MOVELOMAJCD    WUAJCD           Warehouse Code
     C                     GOTO SPEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSP     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * VAL UOM Exists on Ord  RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
      * Declare restrictor key work fields
     C           *LIKE     DEFN WERMNB    WQSQ02           Load ID
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ02           Load ID
      * Setup key
     C                     Z-ADDFJRMNB    WQSQ02           Load ID
      * Establish starting position
     C           KRSSQ     SETLL@BFCPD9                    *
     C           KRSSQ     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * VAL UOM Exists on Ord  RT - PD Order Detail  * 
     C                     EXSR SRRVGN
      * CASE: PAR.Record Found USR is Record Found
     C           P1WXST    IFEQ 'Y'                        *IF
     C                     GOTO SQEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSQ     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * VAL UOM Exists on Ord  RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       P1WXST           Record Found US
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSR01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSR02           Order Number
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           Company Number
     C                     KFLD           WQSR02           Order Number
      * Setup key
     C                     Z-ADDWEAIC3    WQSR01           Company Number
     C                     Z-ADDWEC4NB    WQSR02           Order Number
      * Establish starting position
     C           KRSSR     SETLL@BGWKL1                    *
     C           KRSSR     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.U/M - Ordered EQ DB1.U/M - Ordered
     C           P5ADCD    IFEQ OMAGCD                     *IF
     C                     MOVEL'Y'       P1WXST           Record Found US
     C                     GOTO SREXIT                     *QUIT
     C                     END                             *FI
     C           KRSSR     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * RTV Freezer Ord Item  RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/12/04 SLM PKTR01 Multi-Company - Function was changed
      *                                     to remove Company RST or Pos
     C                     Z-ADD*ZERO     $LHGCD           Item Code
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFRMNB    WQSS02           Load ID
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS02           Load ID
      * Setup key
     C                     Z-ADD$LRMNB    WQSS02           Load ID
      * Establish starting position
     C           KRSSS     SETLL@BFCPRQ                    *
     C           KRSSS     READE@BFCPRQ                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Freezer Ord Item  RT - Order Detail  * 
     C                     EXSR STRVGN
     C           KRSSS     READE@BFCPRQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * RTV Freezer Ord Item  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQST01           Company Number
     C           *LIKE     DEFN WDC4NB    WQST02           Order Number
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           Company Number
     C                     KFLD           WQST02           Order Number
      * Setup key
     C                     Z-ADDWFAIC3    WQST01           Company Number
     C                     Z-ADDWFC4NB    WQST02           Order Number
      * Establish starting position
     C           KRSST     SETLL@BGWKAE                    *
     C           KRSST     READE@BGWKAE                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Warehouse Type     RT - Warehouse  * 
     C                     EXSR SURVGN
      * CASE: LCL.Warehouse Type is Frozen
     C           YL0018    IFEQ 'FZ'                       *IF
      * CASE: PAR.Item Code is Not Entered
     C           $LHGCD    IFEQ 0                          *IF
      * PAR = DB1 By name
     C                     Z-ADDWDHGCD    $LHGCD           Item Code
     C                     Z-ADDWDCCQT    YL0017           Quantity Schedu
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'+'       $LPFTX           Text 1 Length U
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     GOTO STEXIT                     *QUIT
     C                     END                             *FI
     C           KRSST     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * RTV Warehouse Type     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWDAJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSU     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0018           Warehouse Type
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADWPST    YL0018           Warehouse Type
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Load List Details  PO
      *================================================================
      * ** Replace miles with override, if entered
      * CASE: DB1.Override Total Load Miles is Entered
     C           FJK2DT    IFNE *ZERO                      *IF
     C                     Z-ADDFJK2DT    $DTLMI           Total Load Mile
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDFJTLMI    $DTLMI           Total Load Mile
     C                     END                             *FI
     C                     MOVEL*BLANK    WUDXSX           Display Flag 1
      * ** Add truck temperature & text                       E000769
      *
     C                     Z-ADD*ZERO     WN0001  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0002  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0003  1        Load Status
     C                     MOVEL*BLANK    WN0004  3        Carrier Code
     C                     MOVEL*BLANK    WN0005  2        Shipping Method
     C                     MOVEL*BLANK    WN0006  3        Shipping Line
     C                     MOVEL*BLANK    WN0007 20        Port Delv Termi
     C                     Z-ADD*ZERO     WN0008  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0009  60       Deadline Depart
     C                     MOVEL*BLANK    WN0010  1        MG Created Load
     C                     Z-ADD*ZERO     WN0011  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0012  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0013  50       Number of Order
     C                     MOVEL*BLANK    WN0014  1        Header Status
     C                     MOVEL*BLANK    WN0015  1        Credit Hold
     C                     MOVEL*BLANK    WN0016  1        Production Hold
     C                     Z-ADD*ZERO     WN0017  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0018  40       Requested Deliv
     C                     MOVEL*BLANK    WN0019  1        Block Order Fla
     C                     Z-ADD*ZERO     WN0020  90       USR Weight 9
     C                     MOVEL*BLANK    WN0021  1        USR Display 1
     C                     MOVEL*BLANK    WN0022  1        USR Display 2
     C                     MOVEL*BLANK    WN0023  1        USR Display 3
     C                     MOVEL*BLANK    WN0024  1        USR Display 4
     C                     MOVEL*BLANK    WN0025  1        USR Display fie
     C                     MOVEL*BLANK    WN0026  1        Display Flag
      *
      * PRT Load List Details  PO: Mainline
     C                     EXSR B0MAIN
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Load List 1st Item PO
      *================================================================
      * CASE: WRK.Load Type is Regular
     C           WUVDST    IFEQ 'R'                        *IF
     C                     GOTO UBEXIT                     *QUIT
     C                     END                             *FI
      * PRT Load List 1st Item PO: Mainline
     C                     EXSR C0MAIN
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Blank Line         PO
      *================================================================
      * PRT Blank Line         PO: Mainline
     C                     EXSR D0MAIN
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Print Comments     PO
      *================================================================
      * PRT Print Traffic Cmts PO: Mainline
     C                     EXSR E0MAIN
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZBINIT    BEGSR
      *================================================================
      * PRT Load List Details  PO: Initialise
      *================================================================
      * USER: Initialize program
     C                     MOVEL'Y'       WUTMST           USR First Time
     C                     MOVEL'N'       WUD4ST           USR Flag 1
     C                     MOVEL'Y'       WUB8ST           Status - Y or N
      *================================================================
     CSR         ZBEXIT    ENDSR
      /EJECT
     CSR         ZCINIT    BEGSR
      *================================================================
      * PRT Load List 1st Item PO: Initialise
      *================================================================
      * USER: Initialize program
     C                     MOVEL'Y'       WUTAST           First Time Flag
      *================================================================
     CSR         ZCEXIT    ENDSR
      /EJECT
     CSR         ZEINIT    BEGSR
      *================================================================
      * PRT Print Traffic Cmts PO: Initialise
      *================================================================
      * USER: Initialize program
     C                     MOVEL@CN,004   WUA0NA           Job Name
      *================================================================
     CSR         ZEEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Reclaim resources of called programs
     C                     CALL 'Y2RCRSC'
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1WXST           Record Found US
     C                     Z-ADD*ZERO     P2RMNB           Load ID
     C                     MOVEL*BLANK    P2DXTX           Trailer Id
     C                     MOVEL*BLANK    P2BZNA           Carrier Code
     C                     Z-ADD*ZERO     P2T4NB           Schedule Sequen
     C                     MOVEL*BLANK    P4U2ST           Export Status
     C                     MOVEL*BLANK    P4VEST           Palletize
     C                     MOVEL*BLANK    P4VFST           Shrink Wrap
     C                     MOVEL*BLANK    P4VGST           Slip Sheet
     C                     MOVEL*BLANK    P8CVCD           USR U/M 1
     C                     Z-ADD*ZERO     P8NMNX           Count Export Lo
     C                     Z-ADD*ZERO     P8A7NX           Count 2 USR
     C                     Z-ADD*ZERO     P8NLNX           Count USR 3
     C                     Z-ADD*ZERO     P8NNNX           Count Mixed USR
     C                     Z-ADD*ZERO     P8KIQT           Quantity 11.0
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Print (Yes/No) USR
     C                     MOVEL*BLANK    WUDTSX  1
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Define work field USR Display field
     C                     MOVEL*BLANK    WUGGST  1
      * Define work field Count USR
     C                     Z-ADD*ZERO     WUCNTU  50
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    FJAODT           Scheduled Ship
     C                     MOVEL*LOVAL    FJR0SX           Load U/M
     C                     MOVEL*HIVAL    FJU2ST           Export Status
     C                     MOVEL*LOVAL    FJT4NB           Schedule Sequen
     C                     MOVEL*LOVAL    FJRMNB           Load ID
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field USR Active Flag
     C                     MOVEL*BLANK    WUW2ST  1
      * Define work field Display Flag 1 USR
     C                     MOVEL*BLANK    WUDXSX  1
      * Define work field USR First Time
     C                     MOVEL*BLANK    WUTMST  1
      * Define work field USR Flag 1
     C                     MOVEL*BLANK    WUD4ST  1
      * Define work field Status - Y or N
     C                     MOVEL*BLANK    WUB8ST  1
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    FLRMNB           Load ID
     C                     MOVEL*HIVAL    FLRVNB           Stop/Drop
     C                     MOVEL*LOVAL    FLC4NB           Order Number
      * Define work field Ship To Customer
     C                     Z-ADD*ZERO     WUBKC7  70
      * Define work field Ship To Name
     C                     MOVEL*BLANK    WUBRTX 30
      * Define work field Ship To City
     C                     MOVEL*BLANK    WUHNNA 20
      * Define work field Ship To State Code
     C                     MOVEL*BLANK    WUDBCD  2
      * Define work field Order Weight Total
     C                     Z-ADD*ZERO     WUA1WG 112
      * Define work field USR Quantity
     C                     Z-ADD*ZERO     WUBAQT 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WARPNB           Total Load Orde
     C                     Z-ADD*ZERO     WAFLAM           Flat Amount
     C                     Z-ADD*ZERO     WARRNB           Total Stops
     C                     Z-ADD*ZERO     WASBNB           BOL Time
     C                     Z-ADD*ZERO     WASQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WASDNB           Number Pallets
     C                     Z-ADD*ZERO     WAPAOU           Number Pallets
     C                     Z-ADD*ZERO     WADGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WASXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WAHADT           Actual Arrival
     C                     Z-ADD*ZERO     WAAART           Actual Arrival
     C                     Z-ADD*ZERO     WADHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WADIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WAAQDT           Actual Departur
     C                     Z-ADD*ZERO     WAS6NB           Departure Time
     C                     Z-ADD*ZERO     WAT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WAPRTM           Product Tempera
     C                     Z-ADD*ZERO     WANPSV           Number Spacers
     C                     Z-ADD*ZERO     WATLMI           Total Load Mile
     C                     Z-ADD*ZERO     WAGRWE           Gross Weight
     C                     Z-ADD*ZERO     WAF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WAJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WATRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WAJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WASPTM           Spotted Time
     C                     Z-ADD*ZERO     WAJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WALFTM           Load Finished T
     C                     Z-ADD*ZERO     WAJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WABOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WAJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WABLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WAKIDT           Truck Departure
     C                     Z-ADD*ZERO     WAASTM           Truck Departure
     C                     Z-ADD*ZERO     WAKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WAAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WAVOAG           Voyage
     C                     Z-ADD*ZERO     WAKBDT           Sail Date
     C                     Z-ADD*ZERO     WAEFDT           Arrival Date
     C                     Z-ADD*ZERO     WAKCDT           Date In
     C                     Z-ADD*ZERO     WATMIN           Time In
     C                     Z-ADD*ZERO     WAKDDT           Date Out
     C                     Z-ADD*ZERO     WAVMNB           Time Out
     C                     Z-ADD*ZERO     WAOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WAKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WAATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WABRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAKKDT           On Yard Date
     C                     Z-ADD*ZERO     WAAVTM           On Yard Time
     C                     Z-ADD*ZERO     WAKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WAAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WALLDT           Express Mail Da
     C                     Z-ADD*ZERO     WAK0DT           Product Complet
     C                     Z-ADD*ZERO     WAAYTM           Product Complet
     C                     Z-ADD*ZERO     WAKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WAICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WAIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WAK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WAAZTM           Load Door 1
     C                     Z-ADD*ZERO     WAK2DT           Override Total
     C                     Z-ADD*ZERO     WAA0TM           Load Door 2
     C                     Z-ADD*ZERO     WAZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WAPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WACKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WAPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WACLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WAP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WACMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WAP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WACNTM           LH Unused Time
     C                     Z-ADD*ZERO     WAP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WACOTM           LH Unused Time
     C                     Z-ADD*ZERO     WAP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WACQTM           LH Unused Time
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      * Define work field U/M - Ordered
     C                     MOVEL*BLANK    WUAGCD  2
      * Define work field USR Status (Y/N)
     C                     MOVEL*BLANK    WUE6ST  1
      * Define work field Record Status
     C                     MOVEL*BLANK    WUVSST  1
      * Define work field Load Type
     C                     MOVEL*BLANK    WUVDST  1
      * Define work field Special Comment 1
     C                     MOVEL*BLANK    WUMHNA 30
      * Define work field Special Comment 2
     C                     MOVEL*BLANK    WUMINA 30
      * Define work field Vessel Name
     C                     MOVEL*BLANK    WUK4TX 30
      * Define work field OHE Voyage/Flight
     C                     MOVEL*BLANK    WUGENY 15
      * Define work field OHE Booking Number
     C                     MOVEL*BLANK    WUJ1T1 15
      * Define work field Discharge Port
     C                     MOVEL*BLANK    WUW4CD 20
      * Define work field Sail Date
     C                     Z-ADD*ZERO     WUKBDT  70
      * Define work field Arrival Date
     C                     Z-ADD*ZERO     WUEFDT  70
      * Define work field Container Number
     C                     MOVEL*BLANK    WUCNTN 12
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WBQWDT           OHE Sail/Flight
     C                     Z-ADD*ZERO     WBQXDT           OHE Port Cut Da
     C                     Z-ADD*ZERO     WBQYDT           OHE Arrival Dat
     C                     Z-ADD*ZERO     WBGINY           OHE Unused Numb
     C                     Z-ADD*ZERO     WBGFNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WBGGNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WBGHNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WBHEVL           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WBHFVL           OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WBHGVL           Transload Termi
     C                     Z-ADD*ZERO     WBQZDT           OHE Est Arrv at
     C                     Z-ADD*ZERO     WBQ0DT           OHE Backhaul ET
     C                     Z-ADD*ZERO     WBQ1DT           OHE Port/Pier P
     C                     Z-ADD*ZERO     WBQ2DT           OHE Actual Ship
     C                     Z-ADD*ZERO     WBITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WBQJNY           OHE Backhaul Re
     C                     Z-ADD*ZERO     WBQKNY           LD Stop/Drop
     C                     Z-ADD*ZERO     WBQLNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WBP8NY           OHE Pier Pass F
     C                     Z-ADD*ZERO     WBP9NY           OHE Port Check
     C                     Z-ADD*ZERO     WBQANY           OHE Port Cut Ti
     C                     Z-ADD*ZERO     WBQCNY           OHE Backhaul Tr
     C                     Z-ADD*ZERO     WBQDNY           OHE Load Sched
     C                     Z-ADD*ZERO     WBQENY           Original Appoin
     C                     Z-ADD*ZERO     WBQFNY           Original Appoin
     C                     Z-ADD*ZERO     WBQGNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WBQHNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WBQINY           OHE Unused Nume
     C                     Z-ADD*ZERO     WBQMNY           OHE Orig ABS Fr
     C                     Z-ADD*ZERO     WBW5DT           OHE Unused Date
     C                     Z-ADD*ZERO     WBW6DT           OHE Unused Date
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field Port Address Line 1
     C                     MOVEL*BLANK    WULBTX 25
      * Define work field Port Address Line 2
     C                     MOVEL*BLANK    WULATX 25
      * Define work field Port Zip/Postal Code
     C                     MOVEL*BLANK    WULCTX 11
      * Define work field Port Phone Number
     C                     Z-ADD*ZERO     WUSPPN 110
      * Define work field Port Fax Number
     C                     MOVEL*BLANK    WULDTX 25
      * Define work field Select Status
     C                     MOVEL*BLANK    WUDJST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WCRVNB           Stop/Drop
     C                     Z-ADD*ZERO     WCRWNB           Miles to next s
     C                     Z-ADD*ZERO     WCRXNB           Freight Charge
     C                     Z-ADD*ZERO     WCSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WCT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WCT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WCSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WCKFDT           Appointment Con
     C                     Z-ADD*ZERO     WCACTM           Appointment Con
     C                     Z-ADD*ZERO     WCEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WCAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WCKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WCATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WCHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WCAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WCKKDT           On Yard Date
     C                     Z-ADD*ZERO     WCAVTM           On Yard Time
     C                     Z-ADD*ZERO     WCZ4NB           MPC Number
     C                     Z-ADD*ZERO     WCN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WCN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WCN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WCB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WCB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WCB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDDPNB           Order Sequence
     C                     Z-ADD*ZERO     WDUENB           Order Secondary
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WDMAVA           Billing Detail
     C                     Z-ADD*ZERO     WDKDVA           Billing Detail
     C                     Z-ADD*ZERO     WDL8VA           Billing Detail
     C                     Z-ADD*ZERO     WDL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WDAYVA           Extended Amount
     C                     Z-ADD*ZERO     WDEXDT           Market Pricing
     C                     Z-ADD*ZERO     WDBZPR           Price Overage O
     C                     Z-ADD*ZERO     WDL6NB           Contract Number
     C                     Z-ADD*ZERO     WDGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WDD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WDCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WDAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WDCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WDATWG           Weight Shipped
     C                     Z-ADD*ZERO     WDAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WDAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WDAKPR           Unit Price
     C                     Z-ADD*ZERO     WDALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WDAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WDAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WDA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WDA5DT           Requested Ship
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WDRGNB           Item Structure
     C                     Z-ADD*ZERO     WDRHNB           Item Structure
     C                     Z-ADD*ZERO     WDRINB           Item Structure
     C                     Z-ADD*ZERO     WDCXDT           Date of Origina
     C                     Z-ADD*ZERO     WDDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WDB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WDA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WDNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WDNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WDNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WDNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WDNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WDBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WDBVTM           Price Code
     C                     Z-ADD*ZERO     WDBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WDBXTM           Substitution Li
     C                     Z-ADD*ZERO     WDBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WDH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WDH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WDH7NX           OD Item Target
     C                     Z-ADD*ZERO     WDH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WDH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WDDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WDDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WDDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WDDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WDDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WDGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WDGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WDGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WDPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WDRINY           Item Age Days
     C                     Z-ADD*ZERO     WDTIDT           Production Ovr
     C                     Z-ADD*ZERO     WDTJDT           Production Ovr
     C                     Z-ADD*ZERO     WDTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WDTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WDTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WDAIC3           Company Number
     C                     MOVEL*LOVAL    WDC4NB           Order Number
     C                     MOVEL*LOVAL    WDDPNB           Order Sequence
     C                     MOVEL*LOVAL    WDUENB           Order Secondary
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    ABAIC3           Company Number
      * Define work field Warehouse Code
     C                     MOVEL*BLANK    WUAJCD  3
      * Define work field Load ID
     C                     Z-ADD*ZERO     WURMNB  70
      * Define work field Stop/Drop Sequence Number
     C                     Z-ADD*ZERO     WURUNB  50
      * Define work field Stop/Drop
     C                     Z-ADD*ZERO     WURVNB  50
      * Define work field Order Number
     C                     Z-ADD*ZERO     WUC4NB  70
      * Define work field Job Name
     C                     MOVEL*BLANK    WUA0NA 10
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    KERMNB           Load ID
     C                     MOVEL*LOVAL    KEDXNB           Sequence Number
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEC4NB           Order Number
     C                     Z-ADD*ZERO     WEANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WEBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WEB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WEA0DT           Order Date
     C                     Z-ADD*ZERO     WEA5DT           Requested Ship
     C                     Z-ADD*ZERO     WEGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WEACDT           Cancel Date
     C                     Z-ADD*ZERO     WEAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WECXDT           Date of Origina
     C                     Z-ADD*ZERO     WEJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WEA1WG           Order Weight To
     C                     Z-ADD*ZERO     WEEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WEAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WERMNB           Load ID
     C                     Z-ADD*ZERO     WETBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WER1NB           Rated Freight
     C                     Z-ADD*ZERO     WERNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WEATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WERSRN           Resell Referenc
     C                     Z-ADD*ZERO     WET3NB           Attach to Order
     C                     Z-ADD*ZERO     WECONB           Invoice Number
     C                     Z-ADD*ZERO     WEAWDT           Invoice Date
     C                     Z-ADD*ZERO     WEVRVA           A/R order Value
     C                     Z-ADD*ZERO     WEB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WENODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WENPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WENQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WENRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WENSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WEBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WEBQTM           Time of Origina
     C                     Z-ADD*ZERO     WEBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WEBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WEBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WEH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WEH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WEH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WEH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WEH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WEC0C7           Claim Number
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     MOVEL*BLANK    WL0002 30
      * Define local variables for subroutine SDRVGN.
     C                     MOVEL*BLANK    WL0003  2
     C                     MOVEL*BLANK    WL0004 30
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0005  30
     C                     MOVEL*BLANK    WL0006 10
     C                     Z-ADD*ZERO     WL0007 155
      * Define local variables for subroutine SLRVGN.
     C                     Z-ADD*ZERO     WL0008  30
     C                     Z-ADD*ZERO     WL0009  70
     C                     MOVEL*BLANK    WL0010  3
     C                     MOVEL*BLANK    WL0011 20
     C                     MOVEL*BLANK    WL0012 25
     C                     MOVEL*BLANK    WL0013 30
     C                     MOVEL*BLANK    WL0014 15
     C                     MOVEL*BLANK    WL0015 15
     C                     MOVEL*BLANK    WL0016 20
     C                     Z-ADD*ZERO     WL0017  70
     C                     Z-ADD*ZERO     WL0018  70
     C                     Z-ADD*ZERO     WL0019  70
     C                     MOVEL*BLANK    WL0020  3
     C                     MOVEL*BLANK    WL0021  1
     C                     MOVEL*BLANK    WL0022 12
     C                     MOVEL*BLANK    WL0023 35
     C                     MOVEL*BLANK    WL0024 75
      * Define local variables for subroutine SORVGN.
     C                     Z-ADD*ZERO     WL0025  30
     C                     Z-ADD*ZERO     WL0026  70
     C                     MOVEL*BLANK    WL0027  3
     C                     MOVEL*BLANK    WL0028  1
      * Define local work field Weight 11.0 USR
     C                     Z-ADD*ZERO     YL0001 110
      * Define local work field Quantity 11.0
     C                     Z-ADD*ZERO     YL0002 110
      * Define local work field USR Display 5
     C                     MOVEL*BLANK    YL0003  1
      * Define null work field Pallets Loaded
     C                     Z-ADD*ZERO     YN0001  50
      * Define local work field Avg Pallet Tare
     C                     Z-ADD*ZERO     YL0004  92
      * Define null work field Tot Pallet Tare
     C                     Z-ADD*ZERO     YN0002  92
      * Define local work field Boxes Total Quantity
     C                     Z-ADD*ZERO     YL0005 112
      * Define local work field U/M - Ordered
     C                     MOVEL*BLANK    YL0006  2
      * Define local work field Box Load Min Box Qty USR
     C                     Z-ADD*ZERO     YL0007  50
      * Define null work field Shipping Line
     C                     MOVEL*BLANK    YN0003  3
      * Define local work field Order Certification Flag
     C                     MOVEL*BLANK    YL0008  1
      * Define local work field Export Docs Go w/Driver
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field OHE City
     C                     MOVEL*BLANK    YL0010 25
      * Define local work field OHE Port Cut Date
     C                     Z-ADD*ZERO     YL0011  70
      * Define local work field OHE Late Delivery Code
     C                     MOVEL*BLANK    YL0012  3
      * Define local work field OHE Ship Status
     C                     MOVEL*BLANK    YL0013  1
      * Define local work field OHE Comment 1
     C                     MOVEL*BLANK    YL0014 35
      * Define local work field OHE Comment 2
     C                     MOVEL*BLANK    YL0015 75
      * Define local work field Display Flag
     C                     MOVEL*BLANK    YL0016  1
      * Define local work field Quantity Scheduled
     C                     Z-ADD*ZERO     YL0017 112
      * Define local work field Warehouse Type
     C                     MOVEL*BLANK    YL0018  2
      * Define local work field Item Code
     C                     Z-ADD*ZERO     YL0019  70
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
     C                     MOVEL'Y'       WUDTSX           Print (Yes/No)
      * VAL Rtv & Ctr Prt Hdg  IF
      * SET Setup Prt Headings IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SARVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * Center Txt String 40 - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc to PrtCo US - /UT User Source  * 
     C                     MOVE WUDE40    $ACMP
     C                     MOVEL'N'       WUGGST           USR Display fie
     C                     Z-ADD*ZERO     WUCNTU           Count USR
     C                     Z-ADD*ZERO     YL0001           Weight 11.0 USR
     C                     Z-ADD*ZERO     YL0002           Quantity 11.0
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 CR/PR HLD
00002 CRD HLD
00003 PRD HLD
00004 CARRIERUPL
