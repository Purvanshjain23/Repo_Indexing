     H/TITLE PFS Ship Load Header  XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISJMIST
     H* Date          : 03/12/25  Time  : 03:39:25
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPPBLCPL3IF  E           K        DISK
      * RSQ : PFS Ship Load Header      Co/Ld/TDt/TTm/Seq PSts=0
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FOMFLCPL1IF  E           K        DISK
      * RTV : Load Detail               Retrieval index
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOMFLCPL4IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop(Desc)/Order
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FPOB2CPLBIF  E           K        DISK
      * RSQ : Product Trace             Co/Ord/Item/Dte/Tm/S#
      *
     FOMFFREL1UF  E           K        DISK
      * UPD : Carrier Info              Update index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     FOMFJCPL1UF  E           K        DISK
      * UPD : Load Header               Update index
      *
     FPPBLCPL0UF  E           K        DISK
      * UPD : PFS Ship Load Header      Update index
      *
     I@BLCPDH
      * PFS Ship Load Header      Co/Ld/TDt/TTm/Seq PSts=0
      * Renamed input format fields
     I              BLY1NX                          WAY1NX
     I              BLAID8                          WAAID8
     I              BLAFTS                          WAAFTS
     I              BLBCNY                          WABCNY
     I              BLZGNX                          WAZGNX
     I              BLAQNY                          WAAQNY
     I              BLVSSX                          WAVSSX
     I              BLBGNY                          WABGNY
     I              BLV1SX                          WAV1SX
     I              BLGLT1                          WAGLT1
     I              BLGMT1                          WAGMT1
     I              BLGNT1                          WAGNT1
     I              BLG9T1                          WAG9T1
     I              BLGOT1                          WAGOT1
     I              BLVTSX                          WAVTSX
     I              BLARNY                          WAARNY
     I              BLBFNY                          WABFNY
     I              BLVUSX                          WAVUSX
     I              BLGXT1                          WAGXT1
     I              BLAJD8                          WAAJD8
     I              BLAGTS                          WAAGTS
     I              BLAKD8                          WAAKD8
     I              BLAHTS                          WAAHTS
     I              BLASNY                          WAASNY
     I              BLBHNY                          WABHNY
     I              BLUWSX                          WAUWSX
     I              BLUXSX                          WAUXSX
     I              BLV3SX                          WAV3SX
     I              BLAHNY                          WAAHNY
     I              BLAINY                          WAAINY
     I              BLAJNY                          WAAJNY
     I              BLAKNY                          WAAKNY
      *
     I@FJCPBN
      * Load Header               Retrieval index
      * Renamed input format fields
     I              FJRMNB                          WBRMNB
     I              FJAIC3                          WBAIC3
     I              FJAODT                          WBAODT
     I              FJPJST                          WBPJST
     I              FJPKST                          WBPKST
     I              FJRNNB                          WBRNNB
     I              FJDMTX                          WBDMTX
     I              FJDNTX                          WBDNTX
     I              FJDOTX                          WBDOTX
     I              FJWTTX                          WBWTTX
     I              FJWUTX                          WBWUTX
     I              FJRPNB                          WBRPNB
     I              FJFLAM                          WBFLAM
     I              FJXQST                          WBXQST
     I              FJRRNB                          WBRRNB
     I              FJDXTX                          WBDXTX
     I              FJDYTX                          WBDYTX
     I              FJSBNB                          WBSBNB
     I              FJBZNA                          WBBZNA
     I              FJRONB                          WBRONB
     I              FJSQNB                          WBSQNB
     I              FJR1NB                          WBR1NB
     I              FJVCST                          WBVCST
     I              FJVDST                          WBVDST
     I              FJSDNB                          WBSDNB
     I              FJPAOU                          WBPAOU
     I              FJDGWG                          WBDGWG
     I              FJSXNB                          WBSXNB
     I              FJHADT                          WBHADT
     I              FJAART                          WBAART
     I              FJDHWG                          WBDHWG
     I              FJDIWG                          WBDIWG
     I              FJAQDT                          WBAQDT
     I              FJS6NB                          WBS6NB
     I              FJT4NB                          WBT4NB
     I              FJPRTM                          WBPRTM
     I              FJNPSV                          WBNPSV
     I              FJJ8TX                          WBJ8TX
     I              FJTLMI                          WBTLMI
     I              FJJ9TX                          WBJ9TX
     I              FJQ2CD                          WBQ2CD
     I              FJVPCD                          WBVPCD
     I              FJDBCD                          WBDBCD
     I              FJGRWE                          WBGRWE
     I              FJXCCD                          WBXCCD
     I              FJU2ST                          WBU2ST
     I              FJF9DT                          WBF9DT
     I              FJONTM                          WBONTM
     I              FJJ4DT                          WBJ4DT
     I              FJTRTM                          WBTRTM
     I              FJJ5DT                          WBJ5DT
     I              FJSPTM                          WBSPTM
     I              FJJ6DT                          WBJ6DT
     I              FJLFTM                          WBLFTM
     I              FJJ7DT                          WBJ7DT
     I              FJBOTM                          WBBOTM
     I              FJJ8DT                          WBJ8DT
     I              FJBLTM                          WBBLTM
     I              FJKIDT                          WBKIDT
     I              FJASTM                          WBASTM
     I              FJKADT                          WBKADT
     I              FJAJCM                          WBAJCM
     I              FJXACD                          WBXACD
     I              FJOANA                          WBOANA
     I              FJK4TX                          WBK4TX
     I              FJVOAG                          WBVOAG
     I              FJKBDT                          WBKBDT
     I              FJNBBO                          WBNBBO
     I              FJW4CD                          WBW4CD
     I              FJEFDT                          WBEFDT
     I              FJCNTN                          WBCNTN
     I              FJKCDT                          WBKCDT
     I              FJTMIN                          WBTMIN
     I              FJKDDT                          WBKDDT
     I              FJVMNB                          WBVMNB
     I              FJOCFR                          WBOCFR
     I              FJKJDT                          WBKJDT
     I              FJATTM                          WBATTM
     I              FJOTRS                          WBOTRS
     I              FJRNST                          WBRNST
     I              FJBRBK                          WBBRBK
     I              FJEIDT                          WBEIDT
     I              FJRMST                          WBRMST
     I              FJAJCD                          WBAJCD
     I              FJKKDT                          WBKKDT
     I              FJAVTM                          WBAVTM
     I              FJKZDT                          WBKZDT
     I              FJAXTM                          WBAXTM
     I              FJLHOS                          WBLHOS
     I              FJLHOR                          WBLHOR
     I              FJWNTX                          WBWNTX
     I              FJOITX                          WBOITX
     I              FJOJTX                          WBOJTX
     I              FJLLDT                          WBLLDT
     I              FJLSHG                          WBLSHG
     I              FJYPST                          WBYPST
     I              FJK0DT                          WBK0DT
     I              FJAYTM                          WBAYTM
     I              FJKNNX                          WBKNNX
     I              FJICWG                          WBICWG
     I              FJIDWG                          WBIDWG
     I              FJH9SX                          WBH9SX
     I              FJWOTX                          WBWOTX
     I              FJK1DT                          WBK1DT
     I              FJAZTM                          WBAZTM
     I              FJK2DT                          WBK2DT
     I              FJA0TM                          WBA0TM
     I              FJROST                          WBROST
     I              FJRPST                          WBRPST
     I              FJRQST                          WBRQST
     I              FJRRST                          WBRRST
     I              FJZBVA                          WBZBVA
     I              FJWPTX                          WBWPTX
     I              FJWQTX                          WBWQTX
     I              FJWRTX                          WBWRTX
     I              FJWSTX                          WBWSTX
     I              FJRVSX                          WBRVSX
     I              FJRUSX                          WBRUSX
     I              FJRWSX                          WBRWSX
     I              FJRXSX                          WBRXSX
     I              FJRYSX                          WBRYSX
     I              FJRZSX                          WBRZSX
     I              FJR0SX                          WBR0SX
     I              FJR1SX                          WBR1SX
     I              FJR2SX                          WBR2SX
     I              FJR3SX                          WBR3SX
     I              FJR4SX                          WBR4SX
     I              FJPYDT                          WBPYDT
     I              FJCKTM                          WBCKTM
     I              FJPZDT                          WBPZDT
     I              FJCLTM                          WBCLTM
     I              FJP0DT                          WBP0DT
     I              FJCMTM                          WBCMTM
     I              FJP1DT                          WBP1DT
     I              FJCNTM                          WBCNTM
     I              FJP2DT                          WBP2DT
     I              FJCOTM                          WBCOTM
     I              FJP3DT                          WBP3DT
     I              FJCQTM                          WBCQTM
     I              FJUVST                          WBUVST
     I              FJUWST                          WBUWST
     I              FJUXST                          WBUXST
     I              FJAATM                          WBAATM
     I              FJAYNA                          WBAYNA
     I              FJA0NA                          WBA0NA
     I              FJAXDT                          WBAXDT
      *
     I@FLCPBW
      * Load Detail               Retrieval index
      * Renamed input format fields
     I              FLRMNB                          WCRMNB
     I              FLRUNB                          WCRUNB
     I              FLRVNB                          WCRVNB
     I              FLDQTX                          WCDQTX
     I              FLRWNB                          WCRWNB
     I              FLRXNB                          WCRXNB
     I              FLSQNB                          WCSQNB
     I              FLT0NB                          WCT0NB
     I              FLT1NB                          WCT1NB
     I              FLR1NB                          WCR1NB
     I              FLAIC3                          WCAIC3
     I              FLC4NB                          WCC4NB
     I              FLVCST                          WCVCST
     I              FLKEDT                          WCKEDT
     I              FLSXNB                          WCSXNB
     I              FLKFDT                          WCKFDT
     I              FLACTM                          WCACTM
     I              FLK5TX                          WCK5TX
     I              FLW5CD                          WCW5CD
     I              FLEJDT                          WCEJDT
     I              FLAGTM                          WCAGTM
     I              FLKJDT                          WCKJDT
     I              FLATTM                          WCATTM
     I              FLHDDT                          WCHDDT
     I              FLAUTM                          WCAUTM
     I              FLKKDT                          WCKKDT
     I              FLAVTM                          WCAVTM
     I              FLZ4NB                          WCZ4NB
     I              FLY7ST                          WCY7ST
     I              FLY2ST                          WCY2ST
     I              FLWHTX                          WCWHTX
     I              FLWITX                          WCWITX
     I              FLWJTX                          WCWJTX
     I              FLWKTX                          WCWKTX
     I              FLWLTX                          WCWLTX
     I              FLN7DT                          WCN7DT
     I              FLN8DT                          WCN8DT
     I              FLN9DT                          WCN9DT
     I              FLB3TM                          WCB3TM
     I              FLB4TM                          WCB4TM
     I              FLB5TM                          WCB5TM
     I              FLIASX                          WCIASX
     I              FLIBSX                          WCIBSX
     I              FLICSX                          WCICSX
     I              FLWVTX                          WCWVTX
     I              FLWWTX                          WCWWTX
     I              FLWXTX                          WCWXTX
     I              FLUVST                          WCUVST
     I              FLUWST                          WCUWST
     I              FLUXST                          WCUXST
     I              FLAATM                          WCAATM
     I              FLAYNA                          WCAYNA
     I              FLA0NA                          WCA0NA
     I              FLAXDT                          WCAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WDAIC3
     I              BEC4NB                          WDC4NB
     I              BEJNCD                          WDJNCD
     I              BEANC7                          WDANC7
     I              BEBKC7                          WDBKC7
     I              BEBRTX                          WDBRTX
     I              BEHMNA                          WDHMNA
     I              BEHONA                          WDHONA
     I              BEHPNA                          WDHPNA
     I              BEHNNA                          WDHNNA
     I              BEDBCD                          WDDBCD
     I              BECKTX                          WDCKTX
     I              BEB0C7                          WDB0C7
     I              BEAETX                          WDAETX
     I              BEB1NA                          WDB1NA
     I              BEB3NA                          WDB3NA
     I              BEB4NA                          WDB4NA
     I              BEB2NA                          WDB2NA
     I              BEBHCD                          WDBHCD
     I              BEC8TX                          WDC8TX
     I              BEBCNA                          WDBCNA
     I              BEA0DT                          WDA0DT
     I              BEA5DT                          WDA5DT
     I              BEGNDT                          WDGNDT
     I              BEACDT                          WDACDT
     I              BEAQCD                          WDAQCD
     I              BEB6NA                          WDB6NA
     I              BEBYNA                          WDBYNA
     I              BEBZNA                          WDBZNA
     I              BEGTST                          WDGTST
     I              BEGVST                          WDGVST
     I              BEGUST                          WDGUST
     I              BEQFST                          WDQFST
     I              BECQCD                          WDCQCD
     I              BEGJST                          WDGJST
     I              BEGWST                          WDGWST
     I              BEGXST                          WDGXST
     I              BEGYST                          WDGYST
     I              BEAODT                          WDAODT
     I              BEAIVN                          WDAIVN
     I              BECXDT                          WDCXDT
     I              BEJZVA                          WDJZVA
     I              BEA1WG                          WDA1WG
     I              BEXIST                          WDXIST
     I              BEXJST                          WDXJST
     I              BEXKST                          WDXKST
     I              BEEIDT                          WDEIDT
     I              BEAFTM                          WDAFTM
     I              BEE8CD                          WDE8CD
     I              BEE9CD                          WDE9CD
     I              BERMNB                          WDRMNB
     I              BETBNB                          WDTBNB
     I              BER1NB                          WDR1NB
     I              BEPJST                          WDPJST
     I              BEU0ST                          WDU0ST
     I              BEU1ST                          WDU1ST
     I              BEQ2CD                          WDQ2CD
     I              BEU2ST                          WDU2ST
     I              BEVEST                          WDVEST
     I              BEVFST                          WDVFST
     I              BEVGST                          WDVGST
     I              BERPCD                          WDRPCD
     I              BERNNB                          WDRNNB
     I              BEVDST                          WDVDST
     I              BEATIN                          WDATIN
     I              BEU4ST                          WDU4ST
     I              BEU5ST                          WDU5ST
     I              BERSRN                          WDRSRN
     I              BEMHNA                          WDMHNA
     I              BEMINA                          WDMINA
     I              BEWBST                          WDWBST
     I              BER4CD                          WDR4CD
     I              BEBFCD                          WDBFCD
     I              BEQ4CD                          WDQ4CD
     I              BET3NB                          WDT3NB
     I              BESICD                          WDSICD
     I              BECONB                          WDCONB
     I              BECEST                          WDCEST
     I              BEAWDT                          WDAWDT
     I              BEJPCD                          WDJPCD
     I              BEXUST                          WDXUST
     I              BEZ1ST                          WDZ1ST
     I              BEVRVA                          WDVRVA
     I              BEOBST                          WDOBST
     I              BEBCST                          WDBCST
     I              BEBDST                          WDBDST
     I              BEB7VL                          WDB7VL
     I              BEGASX                          WDGASX
     I              BEGBSX                          WDGBSX
     I              BEGCSX                          WDGCSX
     I              BEGDSX                          WDGDSX
     I              BEFNSX                          WDFNSX
     I              BEFOSX                          WDFOSX
     I              BEFPSX                          WDFPSX
     I              BEFQSX                          WDFQSX
     I              BEFRSX                          WDFRSX
     I              BEFSSX                          WDFSSX
     I              BEFTSX                          WDFTSX
     I              BEFUSX                          WDFUSX
     I              BEFVSX                          WDFVSX
     I              BEFWSX                          WDFWSX
     I              BEFXSX                          WDFXSX
     I              BEFYSX                          WDFYSX
     I              BENODT                          WDNODT
     I              BENPDT                          WDNPDT
     I              BENQDT                          WDNQDT
     I              BENRDT                          WDNRDT
     I              BENSDT                          WDNSDT
     I              BEBPTM                          WDBPTM
     I              BEBQTM                          WDBQTM
     I              BEBRTM                          WDBRTM
     I              BEBSTM                          WDBSTM
     I              BEBTTM                          WDBTTM
     I              BEH0NX                          WDH0NX
     I              BEH1NX                          WDH1NX
     I              BEH2NX                          WDH2NX
     I              BEH3NX                          WDH3NX
     I              BEH4NX                          WDH4NX
     I              BEC0C7                          WDC0C7
     I              BEUVST                          WDUVST
     I              BEUWST                          WDUWST
     I              BEUXST                          WDUXST
     I              BEAATM                          WDAATM
     I              BEAYNA                          WDAYNA
     I              BEA0NA                          WDA0NA
     I              BEAXDT                          WDAXDT
      *
     I@FLCPE8
      * Load Detail               Load/Stop(Desc)/Order
      * Renamed input format fields
     I              FLRMNB                          WERMNB
     I              FLRUNB                          WERUNB
     I              FLRVNB                          WERVNB
     I              FLDQTX                          WEDQTX
     I              FLRWNB                          WERWNB
     I              FLRXNB                          WERXNB
     I              FLSQNB                          WESQNB
     I              FLT0NB                          WET0NB
     I              FLT1NB                          WET1NB
     I              FLR1NB                          WER1NB
     I              FLAIC3                          WEAIC3
     I              FLC4NB                          WEC4NB
     I              FLVCST                          WEVCST
     I              FLKEDT                          WEKEDT
     I              FLSXNB                          WESXNB
     I              FLKFDT                          WEKFDT
     I              FLACTM                          WEACTM
     I              FLK5TX                          WEK5TX
     I              FLW5CD                          WEW5CD
     I              FLEJDT                          WEEJDT
     I              FLAGTM                          WEAGTM
     I              FLKJDT                          WEKJDT
     I              FLATTM                          WEATTM
     I              FLHDDT                          WEHDDT
     I              FLAUTM                          WEAUTM
     I              FLKKDT                          WEKKDT
     I              FLAVTM                          WEAVTM
     I              FLZ4NB                          WEZ4NB
     I              FLY7ST                          WEY7ST
     I              FLY2ST                          WEY2ST
     I              FLWHTX                          WEWHTX
     I              FLWITX                          WEWITX
     I              FLWJTX                          WEWJTX
     I              FLWKTX                          WEWKTX
     I              FLWLTX                          WEWLTX
     I              FLN7DT                          WEN7DT
     I              FLN8DT                          WEN8DT
     I              FLN9DT                          WEN9DT
     I              FLB3TM                          WEB3TM
     I              FLB4TM                          WEB4TM
     I              FLB5TM                          WEB5TM
     I              FLIASX                          WEIASX
     I              FLIBSX                          WEIBSX
     I              FLICSX                          WEICSX
     I              FLWVTX                          WEWVTX
     I              FLWWTX                          WEWWTX
     I              FLWXTX                          WEWXTX
     I              FLUVST                          WEUVST
     I              FLUWST                          WEUWST
     I              FLUXST                          WEUXST
     I              FLAATM                          WEAATM
     I              FLAYNA                          WEAYNA
     I              FLA0NA                          WEA0NA
     I              FLAXDT                          WEAXDT
      *
     I@FFREBG
      * Carrier Info              Update index
      * Renamed input format fields
     I              FFBZNA                          WFBZNA
     I              FFADTX                          WFADTX
     I              FFACNA                          WFACNA
     I              FFADNA                          WFADNA
     I              FFAENA                          WFAENA
     I              FFAJNA                          WFAJNA
     I              FFBTTX                          WFBTTX
     I              FFEZNB                          WFEZNB
     I              FFBGCD                          WFBGCD
     I              FFEEDT                          WFEEDT
     I              FFDUTX                          WFDUTX
     I              FFNRVA                          WFNRVA
     I              FFNSVA                          WFNSVA
     I              FFNTVA                          WFNTVA
     I              FFNUVA                          WFNUVA
     I              FFP1ST                          WFP1ST
     I              FFDVTX                          WFDVTX
     I              FFDWTX                          WFDWTX
     I              FFLVCD                          WFLVCD
     I              FFS8NB                          WFS8NB
     I              FFS9NB                          WFS9NB
     I              FFNMVA                          WFNMVA
     I              FFNOVA                          WFNOVA
     I              FFNPVA                          WFNPVA
     I              FFNQVA                          WFNQVA
     I              FFMFCD                          WFMFCD
     I              FFQXNB                          WFQXNB
     I              FFQ1NB                          WFQ1NB
     I              FFMRNG                          WFMRNG
     I              FFMRNE                          WFMRNE
     I              FFRFNB                          WFRFNB
     I              FFMREG                          WFMREG
     I              FFBQPR                          WFBQPR
     I              FFBRPR                          WFBRPR
     I              FFBSPR                          WFBSPR
     I              FFBTPR                          WFBTPR
     I              FFBUPR                          WFBUPR
     I              FFBVPR                          WFBVPR
     I              FFDJWG                          WFDJWG
     I              FFDKWG                          WFDKWG
     I              FFDLWG                          WFDLWG
     I              FFDMWG                          WFDMWG
     I              FFDNWG                          WFDNWG
     I              FFDOWG                          WFDOWG
     I              FFB2PR                          WFB2PR
     I              FFB3PR                          WFB3PR
     I              FFB4PR                          WFB4PR
     I              FFB5PR                          WFB5PR
     I              FFB6PR                          WFB6PR
     I              FFB7PR                          WFB7PR
     I              FFAAC7                          WFAAC7
     I              FFCOFI                          WFCOFI
     I              FFK6TX                          WFK6TX
     I              FFOCNA                          WFOCNA
     I              FFODNA                          WFODNA
     I              FFW7CD                          WFW7CD
     I              FFK7TX                          WFK7TX
     I              FFTENO                          WFTENO
     I              FFK8TX                          WFK8TX
     I              FFAOFC                          WFAOFC
     I              FFAOLI                          WFAOLI
     I              FFKHDT                          WFKHDT
     I              FFUNUS                          WFUNUS
     I              FFUNU2                          WFUNU2
     I              FFUNU3                          WFUNU3
     I              FFUVST                          WFUVST
     I              FFUWST                          WFUWST
     I              FFUXST                          WFUXST
     I              FFVSST                          WFVSST
     I              FFAATM                          WFAATM
     I              FFAYNA                          WFAYNA
     I              FFA0NA                          WFA0NA
     I              FFAXDT                          WFAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WGAIC3
     I              OMC4NB                          WGC4NB
     I              OMDPNB                          WGDPNB
     I              OMUENB                          WGUENB
     I              OMHGCD                          WGHGCD
     I              OMAJCD                          WGAJCD
     I              OMBKC7                          WGBKC7
     I              OMCFC7                          WGCFC7
     I              OMGMST                          WGGMST
     I              OMGNST                          WGGNST
     I              OMMAVA                          WGMAVA
     I              OMKDVA                          WGKDVA
     I              OML8VA                          WGL8VA
     I              OML9VA                          WGL9VA
     I              OMGTST                          WGGTST
     I              OMGVST                          WGGVST
     I              OMGUST                          WGGUST
     I              OMQFST                          WGQFST
     I              OMAYVA                          WGAYVA
     I              OMEXDT                          WGEXDT
     I              OMLQCD                          WGLQCD
     I              OMRDCD                          WGRDCD
     I              OMQ7CD                          WGQ7CD
     I              OMBZPR                          WGBZPR
     I              OML6NB                          WGL6NB
     I              OMU1ST                          WGU1ST
     I              OMGIDT                          WGGIDT
     I              OMCRCD                          WGCRCD
     I              OMAGCD                          WGAGCD
     I              OMRZST                          WGRZST
     I              OMR0ST                          WGR0ST
     I              OMR1ST                          WGR1ST
     I              OMG7NA                          WGG7NA
     I              OMG8NA                          WGG8NA
     I              OMRPCD                          WGRPCD
     I              OMVEST                          WGVEST
     I              OMVGST                          WGVGST
     I              OMAVST                          WGAVST
     I              OMU0ST                          WGU0ST
     I              OMRFCD                          WGRFCD
     I              OMFZST                          WGFZST
     I              OMR1NB                          WGR1NB
     I              OMAVQT                          WGAVQT
     I              OMD0WG                          WGD0WG
     I              OMCCQT                          WGCCQT
     I              OMAUWG                          WGAUWG
     I              OMCBQT                          WGCBQT
     I              OMATWG                          WGATWG
     I              OMAQCS                          WGAQCS
     I              OMAGCS                          WGAGCS
     I              OMAKPR                          WGAKPR
     I              OMALPR                          WGALPR
     I              OMAUPR                          WGAUPR
     I              OMAVWG                          WGAVWG
     I              OMA4WG                          WGA4WG
     I              OMA5DT                          WGA5DT
     I              OMAODT                          WGAODT
     I              OMGNDT                          WGGNDT
     I              OMAMST                          WGAMST
     I              OMANST                          WGANST
     I              OMVAST                          WGVAST
     I              OMRGNB                          WGRGNB
     I              OMRHNB                          WGRHNB
     I              OMRINB                          WGRINB
     I              OMRBCD                          WGRBCD
     I              OMHICD                          WGHICD
     I              OMRNCD                          WGRNCD
     I              OMROCD                          WGROCD
     I              OMCXDT                          WGCXDT
     I              OMAJVN                          WGAJVN
     I              OMKXCD                          WGKXCD
     I              OMJPCD                          WGJPCD
     I              OMCQCD                          WGCQCD
     I              OMR4CD                          WGR4CD
     I              OMZ1ST                          WGZ1ST
     I              OMZ3ST                          WGZ3ST
     I              OMZ4ST                          WGZ4ST
     I              OMDUPR                          WGDUPR
     I              OMB6VL                          WGB6VL
     I              OMA1AA                          WGA1AA
     I              OMFZSX                          WGFZSX
     I              OMF0SX                          WGF0SX
     I              OMF1SX                          WGF1SX
     I              OMF2SX                          WGF2SX
     I              OMF3SX                          WGF3SX
     I              OMF4SX                          WGF4SX
     I              OMF5SX                          WGF5SX
     I              OMF6SX                          WGF6SX
     I              OMF7SX                          WGF7SX
     I              OMNTDT                          WGNTDT
     I              OMNUDT                          WGNUDT
     I              OMNVDT                          WGNVDT
     I              OMNWDT                          WGNWDT
     I              OMNXDT                          WGNXDT
     I              OMBUTM                          WGBUTM
     I              OMBVTM                          WGBVTM
     I              OMBWTM                          WGBWTM
     I              OMBXTM                          WGBXTM
     I              OMBYTM                          WGBYTM
     I              OMH5NX                          WGH5NX
     I              OMH6NX                          WGH6NX
     I              OMH7NX                          WGH7NX
     I              OMH8NX                          WGH8NX
     I              OMH9NX                          WGH9NX
     I              OMDVPR                          WGDVPR
     I              OMDWPR                          WGDWPR
     I              OMDXPR                          WGDXPR
     I              OMDYPR                          WGDYPR
     I              OMDZPR                          WGDZPR
     I              OMGSPR                          WGGSPR
     I              OMGTPR                          WGGTPR
     I              OMGUPR                          WGGUPR
     I              OMHOST                          WGHOST
     I              OMHPST                          WGHPST
     I              OMIOST                          WGIOST
     I              OMPEWG                          WGPEWG
     I              OMRINY                          WGRINY
     I              OMTIDT                          WGTIDT
     I              OMTJDT                          WGTJDT
     I              OMH2ST                          WGH2ST
     I              OMH0ST                          WGH0ST
     I              OMH1ST                          WGH1ST
     I              OMTKDT                          WGTKDT
     I              OMTLDT                          WGTLDT
     I              OMTMDT                          WGTMDT
     I              OMUVST                          WGUVST
     I              OMUWST                          WGUWST
     I              OMUXST                          WGUXST
     I              OMAATM                          WGAATM
     I              OMAYNA                          WGAYNA
     I              OMA0NA                          WGA0NA
     I              OMAXDT                          WGAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WHAIC3
     I              OMC4NB                          WHC4NB
     I              OMDPNB                          WHDPNB
     I              OMUENB                          WHUENB
     I              OMHGCD                          WHHGCD
     I              OMAJCD                          WHAJCD
     I              OMBKC7                          WHBKC7
     I              OMCFC7                          WHCFC7
     I              OMGMST                          WHGMST
     I              OMGNST                          WHGNST
     I              OMMAVA                          WHMAVA
     I              OMKDVA                          WHKDVA
     I              OML8VA                          WHL8VA
     I              OML9VA                          WHL9VA
     I              OMGTST                          WHGTST
     I              OMGVST                          WHGVST
     I              OMGUST                          WHGUST
     I              OMQFST                          WHQFST
     I              OMAYVA                          WHAYVA
     I              OMEXDT                          WHEXDT
     I              OMLQCD                          WHLQCD
     I              OMRDCD                          WHRDCD
     I              OMQ7CD                          WHQ7CD
     I              OMBZPR                          WHBZPR
     I              OML6NB                          WHL6NB
     I              OMU1ST                          WHU1ST
     I              OMGIDT                          WHGIDT
     I              OMCRCD                          WHCRCD
     I              OMAGCD                          WHAGCD
     I              OMRZST                          WHRZST
     I              OMR0ST                          WHR0ST
     I              OMR1ST                          WHR1ST
     I              OMG7NA                          WHG7NA
     I              OMG8NA                          WHG8NA
     I              OMRPCD                          WHRPCD
     I              OMVEST                          WHVEST
     I              OMVGST                          WHVGST
     I              OMAVST                          WHAVST
     I              OMU0ST                          WHU0ST
     I              OMRFCD                          WHRFCD
     I              OMFZST                          WHFZST
     I              OMR1NB                          WHR1NB
     I              OMAVQT                          WHAVQT
     I              OMD0WG                          WHD0WG
     I              OMCCQT                          WHCCQT
     I              OMAUWG                          WHAUWG
     I              OMCBQT                          WHCBQT
     I              OMATWG                          WHATWG
     I              OMAQCS                          WHAQCS
     I              OMAGCS                          WHAGCS
     I              OMAKPR                          WHAKPR
     I              OMALPR                          WHALPR
     I              OMAUPR                          WHAUPR
     I              OMAVWG                          WHAVWG
     I              OMA4WG                          WHA4WG
     I              OMA5DT                          WHA5DT
     I              OMAODT                          WHAODT
     I              OMGNDT                          WHGNDT
     I              OMAMST                          WHAMST
     I              OMANST                          WHANST
     I              OMVAST                          WHVAST
     I              OMRGNB                          WHRGNB
     I              OMRHNB                          WHRHNB
     I              OMRINB                          WHRINB
     I              OMRBCD                          WHRBCD
     I              OMHICD                          WHHICD
     I              OMRNCD                          WHRNCD
     I              OMROCD                          WHROCD
     I              OMCXDT                          WHCXDT
     I              OMAJVN                          WHAJVN
     I              OMKXCD                          WHKXCD
     I              OMJPCD                          WHJPCD
     I              OMCQCD                          WHCQCD
     I              OMR4CD                          WHR4CD
     I              OMZ1ST                          WHZ1ST
     I              OMZ3ST                          WHZ3ST
     I              OMZ4ST                          WHZ4ST
     I              OMDUPR                          WHDUPR
     I              OMB6VL                          WHB6VL
     I              OMA1AA                          WHA1AA
     I              OMFZSX                          WHFZSX
     I              OMF0SX                          WHF0SX
     I              OMF1SX                          WHF1SX
     I              OMF2SX                          WHF2SX
     I              OMF3SX                          WHF3SX
     I              OMF4SX                          WHF4SX
     I              OMF5SX                          WHF5SX
     I              OMF6SX                          WHF6SX
     I              OMF7SX                          WHF7SX
     I              OMNTDT                          WHNTDT
     I              OMNUDT                          WHNUDT
     I              OMNVDT                          WHNVDT
     I              OMNWDT                          WHNWDT
     I              OMNXDT                          WHNXDT
     I              OMBUTM                          WHBUTM
     I              OMBVTM                          WHBVTM
     I              OMBWTM                          WHBWTM
     I              OMBXTM                          WHBXTM
     I              OMBYTM                          WHBYTM
     I              OMH5NX                          WHH5NX
     I              OMH6NX                          WHH6NX
     I              OMH7NX                          WHH7NX
     I              OMH8NX                          WHH8NX
     I              OMH9NX                          WHH9NX
     I              OMDVPR                          WHDVPR
     I              OMDWPR                          WHDWPR
     I              OMDXPR                          WHDXPR
     I              OMDYPR                          WHDYPR
     I              OMDZPR                          WHDZPR
     I              OMGSPR                          WHGSPR
     I              OMGTPR                          WHGTPR
     I              OMGUPR                          WHGUPR
     I              OMHOST                          WHHOST
     I              OMHPST                          WHHPST
     I              OMIOST                          WHIOST
     I              OMPEWG                          WHPEWG
     I              OMRINY                          WHRINY
     I              OMTIDT                          WHTIDT
     I              OMTJDT                          WHTJDT
     I              OMH2ST                          WHH2ST
     I              OMH0ST                          WHH0ST
     I              OMH1ST                          WHH1ST
     I              OMTKDT                          WHTKDT
     I              OMTLDT                          WHTLDT
     I              OMTMDT                          WHTMDT
     I              OMUVST                          WHUVST
     I              OMUWST                          WHUWST
     I              OMUXST                          WHUXST
     I              OMAATM                          WHAATM
     I              OMAYNA                          WHAYNA
     I              OMA0NA                          WHA0NA
     I              OMAXDT                          WHAXDT
      *
     I@ADREAO
      * Warehouse Codes           Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WIAJCD
     I              ADF8NA                          WIF8NA
     I              ADACNA                          WIACNA
     I              ADADNA                          WIADNA
     I              ADAENA                          WIAENA
     I              ADAJNA                          WIAJNA
     I              ADBTTX                          WIBTTX
     I              ADAOCD                          WIAOCD
     I              ADBGCD                          WIBGCD
     I              ADVHST                          WIVHST
     I              ADMPNA                          WIMPNA
     I              ADWPST                          WIWPST
     I              ADXUST                          WIXUST
     I              ADT0ST                          WIT0ST
     I              ADT1ST                          WIT1ST
     I              ADDBNB                          WIDBNB
     I              ADT2ST                          WIT2ST
     I              ADT3ST                          WIT3ST
     I              ADT4ST                          WIT4ST
     I              ADT6ST                          WIT6ST
     I              ADBWC3                          WIBWC3
     I              ADBTC3                          WIBTC3
     I              ADBUC3                          WIBUC3
     I              ADBVC3                          WIBVC3
     I              ADFCAA                          WIFCAA
     I              ADRQSX                          WIRQSX
     I              ADRRSX                          WIRRSX
     I              ADRSSX                          WIRSSX
     I              ADRTSX                          WIRTSX
     I              ADT7ST                          WIT7ST
     I              ADT8ST                          WIT8ST
     I              ADRNSX                          WIRNSX
     I              ADROSX                          WIROSX
     I              ADRPSX                          WIRPSX
     I              ADUVST                          WIUVST
     I              ADUWST                          WIUWST
     I              ADUXST                          WIUXST
     I              ADVSST                          WIVSST
     I              ADAATM                          WIAATM
     I              ADAYNA                          WIAYNA
     I              ADA0NA                          WIA0NA
     I              ADAXDT                          WIAXDT
     I              ADQDSC                          WIQDSC
      *
     I@B2CPS3
      * Product Trace             Co/Ord/Item/Dte/Tm/S#
      * Renamed input format fields
     I              B2AIC3                          WJAIC3
     I              B2PFNX                          WJPFNX
     I              B2AADX                          WJAADX
     I              B2B9TM                          WJB9TM
     I              B2ADDX                          WJADDX
     I              B2ABDX                          WJABDX
     I              B2CATM                          WJCATM
     I              B2MNSX                          WJMNSX
     I              B2JOWG                          WJJOWG
     I              B2JPWG                          WJJPWG
     I              B2MOSX                          WJMOSX
     I              B2DNAA                          WJDNAA
     I              B2PGNX                          WJPGNX
     I              B2BTT1                          WJBTT1
     I              B2D7C7                          WJD7C7
     I              B2PYNA                          WJPYNA
     I              B2PZNA                          WJPZNA
     I              B2MPSX                          WJMPSX
     I              B2CCT1                          WJCCT1
     I              B2PHNX                          WJPHNX
     I              B2MQSX                          WJMQSX
     I              B2DOAA                          WJDOAA
     I              B2BUT1                          WJBUT1
     I              B2DYAA                          WJDYAA
     I              B2BVT1                          WJBVT1
     I              B2DPAA                          WJDPAA
     I              B2DQAA                          WJDQAA
     I              B2BZT1                          WJBZT1
     I              B2BWT1                          WJBWT1
     I              B2DRAA                          WJDRAA
     I              B2B9T1                          WJB9T1
     I              B2DSAA                          WJDSAA
     I              B2B8T1                          WJB8T1
     I              B2D4AA                          WJD4AA
     I              B2EPAA                          WJEPAA
     I              B2EQAA                          WJEQAA
     I              B2ERAA                          WJERAA
     I              B2ESAA                          WJESAA
     I              B2PNSX                          WJPNSX
     I              B2UFNX                          WJUFNX
     I              B2UGNX                          WJUGNX
     I              B2UHNX                          WJUHNX
     I              B2AGDX                          WJAGDX
     I              B2CGTM                          WJCGTM
     I              B2POSX                          WJPOSX
     I              B2PPSX                          WJPPSX
     I              B2UINX                          WJUINX
     I              B2UJNX                          WJUJNX
     I              B2UKNX                          WJUKNX
     I              B2ULNX                          WJULNX
     I              B2PRSX                          WJPRSX
     I              B2PSSX                          WJPSSX
     I              B2AATM                          WJAATM
     I              B2AYNA                          WJAYNA
     I              B2A0NA                          WJA0NA
     I              B2AXDT                          WJAXDT
      *
     I@FJCPBO
      * Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WKRMNB
     I              FJAIC3                          WKAIC3
     I              FJAODT                          WKAODT
     I              FJPJST                          WKPJST
     I              FJPKST                          WKPKST
     I              FJRNNB                          WKRNNB
     I              FJDMTX                          WKDMTX
     I              FJDNTX                          WKDNTX
     I              FJDOTX                          WKDOTX
     I              FJWTTX                          WKWTTX
     I              FJWUTX                          WKWUTX
     I              FJRPNB                          WKRPNB
     I              FJFLAM                          WKFLAM
     I              FJXQST                          WKXQST
     I              FJRRNB                          WKRRNB
     I              FJDXTX                          WKDXTX
     I              FJDYTX                          WKDYTX
     I              FJSBNB                          WKSBNB
     I              FJBZNA                          WKBZNA
     I              FJRONB                          WKRONB
     I              FJSQNB                          WKSQNB
     I              FJR1NB                          WKR1NB
     I              FJVCST                          WKVCST
     I              FJVDST                          WKVDST
     I              FJSDNB                          WKSDNB
     I              FJPAOU                          WKPAOU
     I              FJDGWG                          WKDGWG
     I              FJSXNB                          WKSXNB
     I              FJHADT                          WKHADT
     I              FJAART                          WKAART
     I              FJDHWG                          WKDHWG
     I              FJDIWG                          WKDIWG
     I              FJAQDT                          WKAQDT
     I              FJS6NB                          WKS6NB
     I              FJT4NB                          WKT4NB
     I              FJPRTM                          WKPRTM
     I              FJNPSV                          WKNPSV
     I              FJJ8TX                          WKJ8TX
     I              FJTLMI                          WKTLMI
     I              FJJ9TX                          WKJ9TX
     I              FJQ2CD                          WKQ2CD
     I              FJVPCD                          WKVPCD
     I              FJDBCD                          WKDBCD
     I              FJGRWE                          WKGRWE
     I              FJXCCD                          WKXCCD
     I              FJU2ST                          WKU2ST
     I              FJF9DT                          WKF9DT
     I              FJONTM                          WKONTM
     I              FJJ4DT                          WKJ4DT
     I              FJTRTM                          WKTRTM
     I              FJJ5DT                          WKJ5DT
     I              FJSPTM                          WKSPTM
     I              FJJ6DT                          WKJ6DT
     I              FJLFTM                          WKLFTM
     I              FJJ7DT                          WKJ7DT
     I              FJBOTM                          WKBOTM
     I              FJJ8DT                          WKJ8DT
     I              FJBLTM                          WKBLTM
     I              FJKIDT                          WKKIDT
     I              FJASTM                          WKASTM
     I              FJKADT                          WKKADT
     I              FJAJCM                          WKAJCM
     I              FJXACD                          WKXACD
     I              FJOANA                          WKOANA
     I              FJK4TX                          WKK4TX
     I              FJVOAG                          WKVOAG
     I              FJKBDT                          WKKBDT
     I              FJNBBO                          WKNBBO
     I              FJW4CD                          WKW4CD
     I              FJEFDT                          WKEFDT
     I              FJCNTN                          WKCNTN
     I              FJKCDT                          WKKCDT
     I              FJTMIN                          WKTMIN
     I              FJKDDT                          WKKDDT
     I              FJVMNB                          WKVMNB
     I              FJOCFR                          WKOCFR
     I              FJKJDT                          WKKJDT
     I              FJATTM                          WKATTM
     I              FJOTRS                          WKOTRS
     I              FJRNST                          WKRNST
     I              FJBRBK                          WKBRBK
     I              FJEIDT                          WKEIDT
     I              FJRMST                          WKRMST
     I              FJAJCD                          WKAJCD
     I              FJKKDT                          WKKKDT
     I              FJAVTM                          WKAVTM
     I              FJKZDT                          WKKZDT
     I              FJAXTM                          WKAXTM
     I              FJLHOS                          WKLHOS
     I              FJLHOR                          WKLHOR
     I              FJWNTX                          WKWNTX
     I              FJOITX                          WKOITX
     I              FJOJTX                          WKOJTX
     I              FJLLDT                          WKLLDT
     I              FJLSHG                          WKLSHG
     I              FJYPST                          WKYPST
     I              FJK0DT                          WKK0DT
     I              FJAYTM                          WKAYTM
     I              FJKNNX                          WKKNNX
     I              FJICWG                          WKICWG
     I              FJIDWG                          WKIDWG
     I              FJH9SX                          WKH9SX
     I              FJWOTX                          WKWOTX
     I              FJK1DT                          WKK1DT
     I              FJAZTM                          WKAZTM
     I              FJK2DT                          WKK2DT
     I              FJA0TM                          WKA0TM
     I              FJROST                          WKROST
     I              FJRPST                          WKRPST
     I              FJRQST                          WKRQST
     I              FJRRST                          WKRRST
     I              FJZBVA                          WKZBVA
     I              FJWPTX                          WKWPTX
     I              FJWQTX                          WKWQTX
     I              FJWRTX                          WKWRTX
     I              FJWSTX                          WKWSTX
     I              FJRVSX                          WKRVSX
     I              FJRUSX                          WKRUSX
     I              FJRWSX                          WKRWSX
     I              FJRXSX                          WKRXSX
     I              FJRYSX                          WKRYSX
     I              FJRZSX                          WKRZSX
     I              FJR0SX                          WKR0SX
     I              FJR1SX                          WKR1SX
     I              FJR2SX                          WKR2SX
     I              FJR3SX                          WKR3SX
     I              FJR4SX                          WKR4SX
     I              FJPYDT                          WKPYDT
     I              FJCKTM                          WKCKTM
     I              FJPZDT                          WKPZDT
     I              FJCLTM                          WKCLTM
     I              FJP0DT                          WKP0DT
     I              FJCMTM                          WKCMTM
     I              FJP1DT                          WKP1DT
     I              FJCNTM                          WKCNTM
     I              FJP2DT                          WKP2DT
     I              FJCOTM                          WKCOTM
     I              FJP3DT                          WKP3DT
     I              FJCQTM                          WKCQTM
     I              FJUVST                          WKUVST
     I              FJUWST                          WKUWST
     I              FJUXST                          WKUXST
     I              FJAATM                          WKAATM
     I              FJAYNA                          WKAYNA
     I              FJA0NA                          WKA0NA
     I              FJAXDT                          WKAXDT
      *
     I@BLCPZ7
      * PFS Ship Load Header      Update index
      * Renamed input format fields
     I              BLY1NX                          WLY1NX
     I              BLAID8                          WLAID8
     I              BLAFTS                          WLAFTS
     I              BLBCNY                          WLBCNY
     I              BLZGNX                          WLZGNX
     I              BLAQNY                          WLAQNY
     I              BLVSSX                          WLVSSX
     I              BLBGNY                          WLBGNY
     I              BLV1SX                          WLV1SX
     I              BLGLT1                          WLGLT1
     I              BLGMT1                          WLGMT1
     I              BLGNT1                          WLGNT1
     I              BLG9T1                          WLG9T1
     I              BLGOT1                          WLGOT1
     I              BLVTSX                          WLVTSX
     I              BLARNY                          WLARNY
     I              BLBFNY                          WLBFNY
     I              BLVUSX                          WLVUSX
     I              BLGXT1                          WLGXT1
     I              BLAJD8                          WLAJD8
     I              BLAGTS                          WLAGTS
     I              BLAKD8                          WLAKD8
     I              BLAHTS                          WLAHTS
     I              BLASNY                          WLASNY
     I              BLBHNY                          WLBHNY
     I              BLUWSX                          WLUWSX
     I              BLUXSX                          WLUXSX
     I              BLV3SX                          WLV3SX
     I              BLAHNY                          WLAHNY
     I              BLAINY                          WLAINY
     I              BLAJNY                          WLAJNY
     I              BLAKNY                          WLAKNY
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQOMFF1    E DSOMFFREL1
      * UPD : Carrier Info              Update index
      * Renamed input format fields
     I              FFBZNA                          WFBZNA
     I              FFADTX                          WFADTX
     I              FFACNA                          WFACNA
     I              FFADNA                          WFADNA
     I              FFAENA                          WFAENA
     I              FFAJNA                          WFAJNA
     I              FFBTTX                          WFBTTX
     I              FFEZNB                          WFEZNB
     I              FFBGCD                          WFBGCD
     I              FFEEDT                          WFEEDT
     I              FFDUTX                          WFDUTX
     I              FFNRVA                          WFNRVA
     I              FFNSVA                          WFNSVA
     I              FFNTVA                          WFNTVA
     I              FFNUVA                          WFNUVA
     I              FFP1ST                          WFP1ST
     I              FFDVTX                          WFDVTX
     I              FFDWTX                          WFDWTX
     I              FFLVCD                          WFLVCD
     I              FFS8NB                          WFS8NB
     I              FFS9NB                          WFS9NB
     I              FFNMVA                          WFNMVA
     I              FFNOVA                          WFNOVA
     I              FFNPVA                          WFNPVA
     I              FFNQVA                          WFNQVA
     I              FFMFCD                          WFMFCD
     I              FFQXNB                          WFQXNB
     I              FFQ1NB                          WFQ1NB
     I              FFMRNG                          WFMRNG
     I              FFMRNE                          WFMRNE
     I              FFRFNB                          WFRFNB
     I              FFMREG                          WFMREG
     I              FFBQPR                          WFBQPR
     I              FFBRPR                          WFBRPR
     I              FFBSPR                          WFBSPR
     I              FFBTPR                          WFBTPR
     I              FFBUPR                          WFBUPR
     I              FFBVPR                          WFBVPR
     I              FFDJWG                          WFDJWG
     I              FFDKWG                          WFDKWG
     I              FFDLWG                          WFDLWG
     I              FFDMWG                          WFDMWG
     I              FFDNWG                          WFDNWG
     I              FFDOWG                          WFDOWG
     I              FFB2PR                          WFB2PR
     I              FFB3PR                          WFB3PR
     I              FFB4PR                          WFB4PR
     I              FFB5PR                          WFB5PR
     I              FFB6PR                          WFB6PR
     I              FFB7PR                          WFB7PR
     I              FFAAC7                          WFAAC7
     I              FFCOFI                          WFCOFI
     I              FFK6TX                          WFK6TX
     I              FFOCNA                          WFOCNA
     I              FFODNA                          WFODNA
     I              FFW7CD                          WFW7CD
     I              FFK7TX                          WFK7TX
     I              FFTENO                          WFTENO
     I              FFK8TX                          WFK8TX
     I              FFAOFC                          WFAOFC
     I              FFAOLI                          WFAOLI
     I              FFKHDT                          WFKHDT
     I              FFUNUS                          WFUNUS
     I              FFUNU2                          WFUNU2
     I              FFUNU3                          WFUNU3
     I              FFUVST                          WFUVST
     I              FFUWST                          WFUWST
     I              FFUXST                          WFUXST
     I              FFVSST                          WFVSST
     I              FFAATM                          WFAATM
     I              FFAYNA                          WFAYNA
     I              FFA0NA                          WFA0NA
     I              FFAXDT                          WFAXDT
      *
     IYARDCS      DS                            641
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WHAIC3
     I              OMC4NB                          WHC4NB
     I              OMDPNB                          WHDPNB
     I              OMUENB                          WHUENB
     I              OMHGCD                          WHHGCD
     I              OMAJCD                          WHAJCD
     I              OMBKC7                          WHBKC7
     I              OMCFC7                          WHCFC7
     I              OMGMST                          WHGMST
     I              OMGNST                          WHGNST
     I              OMMAVA                          WHMAVA
     I              OMKDVA                          WHKDVA
     I              OML8VA                          WHL8VA
     I              OML9VA                          WHL9VA
     I              OMGTST                          WHGTST
     I              OMGVST                          WHGVST
     I              OMGUST                          WHGUST
     I              OMQFST                          WHQFST
     I              OMAYVA                          WHAYVA
     I              OMEXDT                          WHEXDT
     I              OMLQCD                          WHLQCD
     I              OMRDCD                          WHRDCD
     I              OMQ7CD                          WHQ7CD
     I              OMBZPR                          WHBZPR
     I              OML6NB                          WHL6NB
     I              OMU1ST                          WHU1ST
     I              OMGIDT                          WHGIDT
     I              OMCRCD                          WHCRCD
     I              OMAGCD                          WHAGCD
     I              OMRZST                          WHRZST
     I              OMR0ST                          WHR0ST
     I              OMR1ST                          WHR1ST
     I              OMG7NA                          WHG7NA
     I              OMG8NA                          WHG8NA
     I              OMRPCD                          WHRPCD
     I              OMVEST                          WHVEST
     I              OMVGST                          WHVGST
     I              OMAVST                          WHAVST
     I              OMU0ST                          WHU0ST
     I              OMRFCD                          WHRFCD
     I              OMFZST                          WHFZST
     I              OMR1NB                          WHR1NB
     I              OMAVQT                          WHAVQT
     I              OMD0WG                          WHD0WG
     I              OMCCQT                          WHCCQT
     I              OMAUWG                          WHAUWG
     I              OMCBQT                          WHCBQT
     I              OMATWG                          WHATWG
     I              OMAQCS                          WHAQCS
     I              OMAGCS                          WHAGCS
     I              OMAKPR                          WHAKPR
     I              OMALPR                          WHALPR
     I              OMAUPR                          WHAUPR
     I              OMAVWG                          WHAVWG
     I              OMA4WG                          WHA4WG
     I              OMA5DT                          WHA5DT
     I              OMAODT                          WHAODT
     I              OMGNDT                          WHGNDT
     I              OMAMST                          WHAMST
     I              OMANST                          WHANST
     I              OMVAST                          WHVAST
     I              OMRGNB                          WHRGNB
     I              OMRHNB                          WHRHNB
     I              OMRINB                          WHRINB
     I              OMRBCD                          WHRBCD
     I              OMHICD                          WHHICD
     I              OMRNCD                          WHRNCD
     I              OMROCD                          WHROCD
     I              OMCXDT                          WHCXDT
     I              OMAJVN                          WHAJVN
     I              OMKXCD                          WHKXCD
     I              OMJPCD                          WHJPCD
     I              OMCQCD                          WHCQCD
     I              OMR4CD                          WHR4CD
     I              OMZ1ST                          WHZ1ST
     I              OMZ3ST                          WHZ3ST
     I              OMZ4ST                          WHZ4ST
     I              OMDUPR                          WHDUPR
     I              OMB6VL                          WHB6VL
     I              OMA1AA                          WHA1AA
     I              OMFZSX                          WHFZSX
     I              OMF0SX                          WHF0SX
     I              OMF1SX                          WHF1SX
     I              OMF2SX                          WHF2SX
     I              OMF3SX                          WHF3SX
     I              OMF4SX                          WHF4SX
     I              OMF5SX                          WHF5SX
     I              OMF6SX                          WHF6SX
     I              OMF7SX                          WHF7SX
     I              OMNTDT                          WHNTDT
     I              OMNUDT                          WHNUDT
     I              OMNVDT                          WHNVDT
     I              OMNWDT                          WHNWDT
     I              OMNXDT                          WHNXDT
     I              OMBUTM                          WHBUTM
     I              OMBVTM                          WHBVTM
     I              OMBWTM                          WHBWTM
     I              OMBXTM                          WHBXTM
     I              OMBYTM                          WHBYTM
     I              OMH5NX                          WHH5NX
     I              OMH6NX                          WHH6NX
     I              OMH7NX                          WHH7NX
     I              OMH8NX                          WHH8NX
     I              OMH9NX                          WHH9NX
     I              OMDVPR                          WHDVPR
     I              OMDWPR                          WHDWPR
     I              OMDXPR                          WHDXPR
     I              OMDYPR                          WHDYPR
     I              OMDZPR                          WHDZPR
     I              OMGSPR                          WHGSPR
     I              OMGTPR                          WHGTPR
     I              OMGUPR                          WHGUPR
     I              OMHOST                          WHHOST
     I              OMHPST                          WHHPST
     I              OMIOST                          WHIOST
     I              OMPEWG                          WHPEWG
     I              OMRINY                          WHRINY
     I              OMTIDT                          WHTIDT
     I              OMTJDT                          WHTJDT
     I              OMH2ST                          WHH2ST
     I              OMH0ST                          WHH0ST
     I              OMH1ST                          WHH1ST
     I              OMTKDT                          WHTKDT
     I              OMTLDT                          WHTLDT
     I              OMTMDT                          WHTMDT
     I              OMUVST                          WHUVST
     I              OMUWST                          WHUWST
     I              OMUXST                          WHUXST
     I              OMAATM                          WHAATM
     I              OMAYNA                          WHAYNA
     I              OMA0NA                          WHA0NA
     I              OMAXDT                          WHAXDT
      *
     IYBRDCS      DS                            525
     IYCRDCS      DS                            525
     IQOMFJ1    E DSOMFJCPL1
      * UPD : Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WKRMNB
     I              FJAIC3                          WKAIC3
     I              FJAODT                          WKAODT
     I              FJPJST                          WKPJST
     I              FJPKST                          WKPKST
     I              FJRNNB                          WKRNNB
     I              FJDMTX                          WKDMTX
     I              FJDNTX                          WKDNTX
     I              FJDOTX                          WKDOTX
     I              FJWTTX                          WKWTTX
     I              FJWUTX                          WKWUTX
     I              FJRPNB                          WKRPNB
     I              FJFLAM                          WKFLAM
     I              FJXQST                          WKXQST
     I              FJRRNB                          WKRRNB
     I              FJDXTX                          WKDXTX
     I              FJDYTX                          WKDYTX
     I              FJSBNB                          WKSBNB
     I              FJBZNA                          WKBZNA
     I              FJRONB                          WKRONB
     I              FJSQNB                          WKSQNB
     I              FJR1NB                          WKR1NB
     I              FJVCST                          WKVCST
     I              FJVDST                          WKVDST
     I              FJSDNB                          WKSDNB
     I              FJPAOU                          WKPAOU
     I              FJDGWG                          WKDGWG
     I              FJSXNB                          WKSXNB
     I              FJHADT                          WKHADT
     I              FJAART                          WKAART
     I              FJDHWG                          WKDHWG
     I              FJDIWG                          WKDIWG
     I              FJAQDT                          WKAQDT
     I              FJS6NB                          WKS6NB
     I              FJT4NB                          WKT4NB
     I              FJPRTM                          WKPRTM
     I              FJNPSV                          WKNPSV
     I              FJJ8TX                          WKJ8TX
     I              FJTLMI                          WKTLMI
     I              FJJ9TX                          WKJ9TX
     I              FJQ2CD                          WKQ2CD
     I              FJVPCD                          WKVPCD
     I              FJDBCD                          WKDBCD
     I              FJGRWE                          WKGRWE
     I              FJXCCD                          WKXCCD
     I              FJU2ST                          WKU2ST
     I              FJF9DT                          WKF9DT
     I              FJONTM                          WKONTM
     I              FJJ4DT                          WKJ4DT
     I              FJTRTM                          WKTRTM
     I              FJJ5DT                          WKJ5DT
     I              FJSPTM                          WKSPTM
     I              FJJ6DT                          WKJ6DT
     I              FJLFTM                          WKLFTM
     I              FJJ7DT                          WKJ7DT
     I              FJBOTM                          WKBOTM
     I              FJJ8DT                          WKJ8DT
     I              FJBLTM                          WKBLTM
     I              FJKIDT                          WKKIDT
     I              FJASTM                          WKASTM
     I              FJKADT                          WKKADT
     I              FJAJCM                          WKAJCM
     I              FJXACD                          WKXACD
     I              FJOANA                          WKOANA
     I              FJK4TX                          WKK4TX
     I              FJVOAG                          WKVOAG
     I              FJKBDT                          WKKBDT
     I              FJNBBO                          WKNBBO
     I              FJW4CD                          WKW4CD
     I              FJEFDT                          WKEFDT
     I              FJCNTN                          WKCNTN
     I              FJKCDT                          WKKCDT
     I              FJTMIN                          WKTMIN
     I              FJKDDT                          WKKDDT
     I              FJVMNB                          WKVMNB
     I              FJOCFR                          WKOCFR
     I              FJKJDT                          WKKJDT
     I              FJATTM                          WKATTM
     I              FJOTRS                          WKOTRS
     I              FJRNST                          WKRNST
     I              FJBRBK                          WKBRBK
     I              FJEIDT                          WKEIDT
     I              FJRMST                          WKRMST
     I              FJAJCD                          WKAJCD
     I              FJKKDT                          WKKKDT
     I              FJAVTM                          WKAVTM
     I              FJKZDT                          WKKZDT
     I              FJAXTM                          WKAXTM
     I              FJLHOS                          WKLHOS
     I              FJLHOR                          WKLHOR
     I              FJWNTX                          WKWNTX
     I              FJOITX                          WKOITX
     I              FJOJTX                          WKOJTX
     I              FJLLDT                          WKLLDT
     I              FJLSHG                          WKLSHG
     I              FJYPST                          WKYPST
     I              FJK0DT                          WKK0DT
     I              FJAYTM                          WKAYTM
     I              FJKNNX                          WKKNNX
     I              FJICWG                          WKICWG
     I              FJIDWG                          WKIDWG
     I              FJH9SX                          WKH9SX
     I              FJWOTX                          WKWOTX
     I              FJK1DT                          WKK1DT
     I              FJAZTM                          WKAZTM
     I              FJK2DT                          WKK2DT
     I              FJA0TM                          WKA0TM
     I              FJROST                          WKROST
     I              FJRPST                          WKRPST
     I              FJRQST                          WKRQST
     I              FJRRST                          WKRRST
     I              FJZBVA                          WKZBVA
     I              FJWPTX                          WKWPTX
     I              FJWQTX                          WKWQTX
     I              FJWRTX                          WKWRTX
     I              FJWSTX                          WKWSTX
     I              FJRVSX                          WKRVSX
     I              FJRUSX                          WKRUSX
     I              FJRWSX                          WKRWSX
     I              FJRXSX                          WKRXSX
     I              FJRYSX                          WKRYSX
     I              FJRZSX                          WKRZSX
     I              FJR0SX                          WKR0SX
     I              FJR1SX                          WKR1SX
     I              FJR2SX                          WKR2SX
     I              FJR3SX                          WKR3SX
     I              FJR4SX                          WKR4SX
     I              FJPYDT                          WKPYDT
     I              FJCKTM                          WKCKTM
     I              FJPZDT                          WKPZDT
     I              FJCLTM                          WKCLTM
     I              FJP0DT                          WKP0DT
     I              FJCMTM                          WKCMTM
     I              FJP1DT                          WKP1DT
     I              FJCNTM                          WKCNTM
     I              FJP2DT                          WKP2DT
     I              FJCOTM                          WKCOTM
     I              FJP3DT                          WKP3DT
     I              FJCQTM                          WKCQTM
     I              FJUVST                          WKUVST
     I              FJUWST                          WKUWST
     I              FJUXST                          WKUXST
     I              FJAATM                          WKAATM
     I              FJAYNA                          WKAYNA
     I              FJA0NA                          WKA0NA
     I              FJAXDT                          WKAXDT
      *
     IYDRDCS      DS                            793
      * Outward parameters
     IPARC        DS                             82
      * RCD : Load Order Change Log     Retrieval index
      * N :  Sequence Number
     I                                    P   9  100PADXNB
      * I :  Load ID
     I                                    P  11  140PARMNB
      * I :  Stop_Drop
     I                                    P  15  170PARVNB
      * I :  Load Change Type
     I                                       18  23 PARVST
      * I :  Department Control Code
     I                                       24  26 PAUJST
      * I :  Change Log Prior Value
     I                                       27  38 PAMNTX
      * I :  Change Log New Value
     I                                       39  50 PAMOTX
      * I :  User Id
     I                                       51  60 PAAYNA
      * I :  Job Name
     I                                       61  70 PAA0NA
      * I :  Carrier Code
     I                                       71  73 PABZNA
      * N :  Carrier Broker Carrier Co
     I                                       74  76 PAXMCD
      * I :  Company Number
     I                                    P  77  780PAAIC3
      * I :  Order Number
     I                                    P  79  820PAC4NB
      *
     IQPPBL1    E DSPPBLCPL0
      * UPD : PFS Ship Load Header      Update index
      * Renamed input format fields
     I              BLY1NX                          WLY1NX
     I              BLAID8                          WLAID8
     I              BLAFTS                          WLAFTS
     I              BLBCNY                          WLBCNY
     I              BLZGNX                          WLZGNX
     I              BLAQNY                          WLAQNY
     I              BLVSSX                          WLVSSX
     I              BLBGNY                          WLBGNY
     I              BLV1SX                          WLV1SX
     I              BLGLT1                          WLGLT1
     I              BLGMT1                          WLGMT1
     I              BLGNT1                          WLGNT1
     I              BLG9T1                          WLG9T1
     I              BLGOT1                          WLGOT1
     I              BLVTSX                          WLVTSX
     I              BLARNY                          WLARNY
     I              BLBFNY                          WLBFNY
     I              BLVUSX                          WLVUSX
     I              BLGXT1                          WLGXT1
     I              BLAJD8                          WLAJD8
     I              BLAGTS                          WLAGTS
     I              BLAKD8                          WLAKD8
     I              BLAHTS                          WLAHTS
     I              BLASNY                          WLASNY
     I              BLBHNY                          WLBHNY
     I              BLUWSX                          WLUWSX
     I              BLUXSX                          WLUXSX
     I              BLV3SX                          WLV3SX
     I              BLAHNY                          WLAHNY
     I              BLAINY                          WLAINY
     I              BLAJNY                          WLAJNY
     I              BLAKNY                          WLAKNY
      *
     IYERDCS      DS                            222
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: PFS Ship Load Header
      * I :  PFS Company Number
     I                                        1   30P1Y1NX
      * I :  PFS Load ID
     I                                        4  100P1ZGNX
     IP2PARM      DS
      * B :  Record Found USR
     I                                        1   1 P2WXST
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1Y1NX    PARM           WP0001  30       PFS Company Num
     C           P1ZGNX    PARM           WP0002  70       PFS Load ID
     C           P2WXST    PARM P2WXST    WP0003  1        Record Found US
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * PFS Ship Load Header  XF
      * PFS Ship Load Header  RT - PFS Ship Load Header  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * PFS Ship Load Header  RT - PFS Ship Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  10       PFS Process Sta
     C                     MOVEL*BLANK    WN0002  6        PFS Error Reaso
     C                     Z-ADD*ZERO     WN0003  70       Load ID
     C                     Z-ADD*ZERO     WN0004  30       Company Number
     C                     Z-ADD*ZERO     WN0005  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0006  1        Load Status
     C                     Z-ADD*ZERO     WN0007  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0008 15        Seal 1
     C                     MOVEL*BLANK    WN0009 15        Seal 2
     C                     MOVEL*BLANK    WN0010 15        Seal 3
     C                     MOVEL*BLANK    WN0011 15        Seal 4
     C                     Z-ADD*ZERO     WN0012 112       Flat Amount
     C                     Z-ADD*ZERO     WN0013  50       Total Stops
     C                     MOVEL*BLANK    WN0014 20        Trailer Id
     C                     MOVEL*BLANK    WN0015  3        Carrier Code
     C                     MOVEL*BLANK    WN0016  1        Ship Status
     C                     MOVEL*BLANK    WN0017  1        Load Type
     C                     Z-ADD*ZERO     WN0018  50       Number Pallets
     C                     Z-ADD*ZERO     WN0019  50       Number Pallets
     C                     Z-ADD*ZERO     WN0020  70       Actual Departur
     C                     Z-ADD*ZERO     WN0021  40       Departure Time
     C                     Z-ADD*ZERO     WN0022  52       Product Tempera
     C                     Z-ADD*ZERO     WN0023  50       Number Spacers
     C                     Z-ADD*ZERO     WN0024  70       Total Load Mile
     C                     MOVEL*BLANK    WN0025 12        Recorder ID
     C                     MOVEL*BLANK    WN0026  2        Shipping Method
     C                     MOVEL*BLANK    WN0027  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0028  2        Ship To State C
     C                     MOVEL*BLANK    WN0029  1        Export Status
     C                     Z-ADD*ZERO     WN0030  70       Actual Ship Dat
     C                     Z-ADD*ZERO     WN0031  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0032  60       BOL Complete Ti
     C                     MOVEL*BLANK    WN0033  3        Shipping Line
     C                     MOVEL*BLANK    WN0034 20        Discharge Port
     C                     Z-ADD*ZERO     WN0035  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0036  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0037  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0038  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0039  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0040  92       Tot Pallet Tare
     C                     Z-ADD*ZERO     WN0041  70       Override Total
     C                     MOVEL*BLANK    WN0042  1        Export Load USD
     C                     MOVEL*BLANK    WN0043 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0044  1        MG Created Load
     C                     MOVEL*BLANK    WN0045  2        Load U_M
     C                     Z-ADD*ZERO     WN0046  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0047  60       LH Last Combo P
     C                     MOVEL*BLANK    WN0048  1        EDI Status 1
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAY1NX    WQSA01           PFS Company Num
     C           *LIKE     DEFN WAZGNX    WQSA02           PFS Load ID
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           PFS Company Num
     C                     KFLD           WQSA02           PFS Load ID
      * Setup key
     C                     Z-ADDP1Y1NX    WQSA01           PFS Company Num
     C                     Z-ADDP1ZGNX    WQSA02           PFS Load ID
      * Establish starting position
     C           KRSSA     SETLL@BLCPDH                    *
     C           KRSSA     READE@BLCPDH                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3506' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       P2WXST           Record Found US
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0001           PFS Process Sta
     C                     MOVEL*BLANK    WN0002           PFS Error Reaso
     C                     Z-ADD*ZERO     WN0003           Load ID
     C                     Z-ADD*ZERO     WN0004           Company Number
     C                     Z-ADD*ZERO     WN0005           Scheduled Ship
     C                     MOVEL*BLANK    WN0006           Load Status
     C                     Z-ADD*ZERO     WN0007           Reefer Temperat
     C                     MOVEL*BLANK    WN0008           Seal 1
     C                     MOVEL*BLANK    WN0009           Seal 2
     C                     MOVEL*BLANK    WN0010           Seal 3
     C                     MOVEL*BLANK    WN0011           Seal 4
     C                     Z-ADD*ZERO     WN0012           Flat Amount
     C                     Z-ADD*ZERO     WN0013           Total Stops
     C                     MOVEL*BLANK    WN0014           Trailer Id
     C                     MOVEL*BLANK    WN0015           Carrier Code
     C                     MOVEL*BLANK    WN0016           Ship Status
     C                     MOVEL*BLANK    WN0017           Load Type
     C                     Z-ADD*ZERO     WN0018           Number Pallets
     C                     Z-ADD*ZERO     WN0019           Number Pallets
     C                     Z-ADD*ZERO     WN0020           Actual Departur
     C                     Z-ADD*ZERO     WN0021           Departure Time
     C                     Z-ADD*ZERO     WN0022           Product Tempera
     C                     Z-ADD*ZERO     WN0023           Number Spacers
     C                     Z-ADD*ZERO     WN0024           Total Load Mile
     C                     MOVEL*BLANK    WN0025           Recorder ID
     C                     MOVEL*BLANK    WN0026           Shipping Method
     C                     MOVEL*BLANK    WN0027           Ship From Wareh
     C                     MOVEL*BLANK    WN0028           Ship To State C
     C                     MOVEL*BLANK    WN0029           Export Status
     C                     Z-ADD*ZERO     WN0030           Actual Ship Dat
     C                     Z-ADD*ZERO     WN0031           BOL Complete Da
     C                     Z-ADD*ZERO     WN0032           BOL Complete Ti
     C                     MOVEL*BLANK    WN0033           Shipping Line
     C                     MOVEL*BLANK    WN0034           Discharge Port
     C                     Z-ADD*ZERO     WN0035           Scheduled Deliv
     C                     Z-ADD*ZERO     WN0036           Scheduled Deliv
     C                     MOVEL*BLANK    WN0037           Load Shag Flag
     C                     MOVEL*BLANK    WN0038           Load Wash Flag
     C                     Z-ADD*ZERO     WN0039           Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0040           Tot Pallet Tare
     C                     Z-ADD*ZERO     WN0041           Override Total
     C                     MOVEL*BLANK    WN0042           Export Load USD
     C                     MOVEL*BLANK    WN0043           Shipping Temp C
     C                     MOVEL*BLANK    WN0044           MG Created Load
     C                     MOVEL*BLANK    WN0045           Load U_M
     C                     Z-ADD*ZERO     WN0046           LH Last Combo P
     C                     Z-ADD*ZERO     WN0047           LH Last Combo P
     C                     MOVEL*BLANK    WN0048           EDI Status 1
     C                     MOVEL*BLANK    P2WXST           Record Found US
     C                     MOVEL'Y'       P2WXST           Record Found US
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     Z-ADDWAUXSX    WN0001           PFS Process Sta
     C                     MOVEL*BLANK    WN0002           PFS Error Reaso
      * VALIDATE
     C                     EXSR UASUBR                     VALIDATE
      * PROCESS:  Selected Record
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     Z-ADDWABGNY    WN0022           Product Tempera
     C                     Z-ADDWAAQNY    WN0007           Reefer Temperat
      * 04/02/09 PKD Use IF instead of CL to convert date.
      *
     C                     Z-ADD*ZERO     WN0049  40       Year Code
     C                     Z-ADD*ZERO     WN0050  20       Month
     C                     Z-ADD*ZERO     WN0051  20       Day of Month US
     C                     MOVEL*BLANK    WN0052  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0053  2        Month (Char) US
     C                     MOVEL*BLANK    WN0054  2        Day   (Char) US
     C                     Z-ADD*ZERO     WN0055  20       Year  NBR USR
     C                     MOVEL*BLANK    WN0056  2        Year  (Char) US
     C                     MOVEL*BLANK    WN0057  7        Date (Alpha) US
      *
      * CVT *YYMD to *CYMD    IF
      * ** YEAR **
     C           WAAJD8    DIV  10000     WN0049           Year Code
     C                     Z-ADDWN0049    WN0055           Year  NBR USR
     C                     MOVELWN0055    WN0056           Year  (Char) US
      * ** MONTH **
     C           WAAJD8    DIV  100       WN0050           Month
     C                     MOVELWN0050    WN0053           Month (Char) US
      * ** DAY **
     C                     Z-ADDWAAJD8    WN0051           Day of Month US
     C                     MOVELWN0051    WN0054           Day   (Char) US
      * CENTURY+YEAR
      * CASE: PAR.Year Code is Twentieth Century
     C           WN0049    IFLE 1999                       *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           '0'       CAT  WN0056:ZQ WN0057    P      Date (Alpha) US
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           '1'       CAT  WN0056:ZQ WN0057    P      Date (Alpha) US
     C                     END                             *FI
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0057    CAT  WN0053:ZQ WN0057    P      Date (Alpha) US
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0057    CAT  WN0054:ZQ WN0057    P      Date (Alpha) US
     C                     MOVE WN0057    WN0031           Date
     C                     Z-ADDWAAGTS    WN0032           BOL Complete Ti
     C                     Z-ADDWN0031    WN0020           Actual Departur
      * PAR.Departure Time = PAR.BOL Complete Time
     C                     Z-ADDWN0032    WN0021           Departure Time
     C                     MOVELWAGLT1    WN0008           Seal 1
     C                     MOVELWAGMT1    WN0009           Seal 2
     C                     MOVELWAGNT1    WN0010           Seal 3
     C                     MOVELWAG9T1    WN0011           Seal 4
     C                     MOVELWAGOT1    WN0014           Trailer Id
     C                     Z-ADDWAARNY    WN0018           Number Pallets
     C                     Z-ADDWAASNY    WN0019           Number Pallets
      * R11331 DN 01/29/18-Updated Field Name.
     C                     Z-ADDWABFNY    WN0023           Number Spacers
     C                     Z-ADDWABHNY    WN0040           Tot Pallet Tare
      * CASE: PAR.Number Pallets Loaded is Greater than zero
     C           WN0019    IFGT 0                          *IF
     C           WN0040    DIV  WN0019    WN0039    H      Avg Pallet Tare
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0039           Avg Pallet Tare
     C                     END                             *FI
     C                     MOVELWN0042    WN0042           Export Load USD
     C                     MOVELWAGXT1    WN0025           Recorder ID
      * RTV All Ords Shipped?  RT - Load Detail  * 
     C                     EXSR SCRVGN
      * PRC:  All Orders on Load are Shipped.
      * CASE: LCL.Status - Y or N is yes
     C           YL0004    IFEQ 'Y'                        *IF
      * RTV Act ShpDt Last Ord RT - Load Detail  * 
     C                     EXSR SERVGN
     C                     MOVEL'S'       WN0006           Load Status
     C                     MOVEL'S'       WN0016           Ship Status
      * RTV UPD Ld Abs.Frt/Wgt XF - Order Header TRG  * 
     C                     CALL 'PDE0XFR'              90  RTV UPD Ld Abs.
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0003    WQ0001  70       Load ID
     C           YL0005    PARM YL0005    WQ0002  70       Total Load Orde
     C           YL0006    PARM YL0006    WQ0003 112       Total Freight
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDE0XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CHG Last Used Date     CH - Carrier  * 
     C                     EXSR SGCHRC
      * E4119 Also,Create trigger when CloseTruck so they can get Actual
      * PFS Upd OrdDtl ShpDte RT - Load Detail  * 
     C                     EXSR SHRVGN
      * CASE: PAR.Load U/M is CB or Mixed
     C           WN0045    IFEQ 'CB'                       *IF
     C           WN0045    OREQ 'MX'
      * Rtv Last CB Prd Dt/Tm RT - Load Detail  * 
     C                     EXSR SKRVGN
     C                     END                             *FI
      * R15305 DN 10/25/19-Build EDI 856 ASN Data Sets.
      * Exc Crt EDI 856 ASN V2 XF - EDI Adv Ship Ntc Headr V2  * 
     C                     CALL 'PUOIXFR'              90  Exc Crt EDI 856
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0003    WQ0006  70       Load ID
     C                     PARM *ZERO     WQ0007  30       Company Number
     C                     PARM *ZERO     WQ0008  70       Bill to Custome
     C                     PARM 'N'       WQ0009  1        F17 Pressed USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUOIXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Upd Whs Pallet Tare   RT - Load Detail  * 
     C                     EXSR SORVGN
      * ----------
      * PFS Upd Load Header   RT - Load Header  * 
     C                     EXSR SRRVGN
      * CASE: PAR.Shipping Method is Prepaid
     C           WN0026    IFEQ 'PR'                       *IF
     C           WN0026    OREQ 'PT'
      * UPD Rated Frt Post Shp XF - Load Detail  * 
     C                     CALL 'PDJVXFR'              90  UPD Rated Frt P
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0003    WQ0028  70       Load ID
     C                     PARM WN0004    WQ0029  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDJVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * *------------------------------------------------------------*
      * * 07/13/01 PKD The following routine will automatically create
      * *              Freight Charges.
      * * 04/21/06 RMC pass in the bol complete date
      * * 08/14/08 LJB pass in override total load miles      E00207
      * * 12/05/16 RMC R7575 only create for NOT MG Created loads
      * CASE: PAR.MG Created Load is Not MG Created Load
     C           WN0044    IFEQ *BLANK                     *IF
      * Clc Freight Charges   XF - Freight Charge  * 
     C                     CALL 'POL2XFR'              90  Clc Freight Cha
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0003    WQ0030  70       Load ID
     C                     PARM WN0004    WQ0031  30       Company Number
     C                     PARM WN0005    WQ0032  70       Scheduled Ship
     C                     PARM WN0006    WQ0033  1        Load Status
     C                     PARM WN0012    WQ0034 112       Flat Amount
     C                     PARM WN0013    WQ0035  50       Total Stops
     C                     PARM WN0015    WQ0036  3        Carrier Code
     C                     PARM WN0017    WQ0037  1        Load Type
     C                     PARM WN0024    WQ0038  70       Total Load Mile
     C                     PARM WN0026    WQ0039  2        Shipping Method
     C                     PARM WN0027    WQ0040  3        Ship From Wareh
     C                     PARM WN0028    WQ0041  2        Ship To State C
     C                     PARM WN0029    WQ0042  1        Export Status
     C                     PARM WN0031    WQ0043  70       BOL Complete Da
     C                     PARM WN0033    WQ0044  3        Shipping Line
     C                     PARM WN0034    WQ0045 20        Discharge Port
     C                     PARM WN0037    WQ0046  1        Load Shag Flag
     C                     PARM WN0038    WQ0047  1        Load Wash Flag
     C                     PARM WN0041    WQ0048  70       Override Total
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POL2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * *------------------------------------------------------------*
     C                     END                             *FI
     C                     Z-ADD1         WN0001           PFS Process Sta
     C                     END                             *FI
      * Chg PostSts/ErrRsn    CH - PFS Ship Load Header  * 
     C                     EXSR STCHRC
      * RMC E01523
      * Just process 1 record.. if theres more than one, leave it til the
     C                     GOTO SAEXIT                     *QUIT
     C           KRSSA     READE@BLCPDH                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * PFS Rtv Load Header   RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBRMNB           Load ID
      * Setup key
     C                     Z-ADDWN0003    WBRMNB           Load ID
      * Establish starting position
     C           KRSSB     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0004           Company Number
     C                     Z-ADD*ZERO     WN0005           Scheduled Ship
     C                     MOVEL*BLANK    WN0006           Load Status
     C                     MOVEL*BLANK    WN0008           Seal 1
     C                     MOVEL*BLANK    WN0009           Seal 2
     C                     MOVEL*BLANK    WN0010           Seal 3
     C                     Z-ADD*ZERO     WN0012           Flat Amount
     C                     Z-ADD*ZERO     WN0013           Total Stops
     C                     MOVEL*BLANK    WN0014           Trailer Id
     C                     MOVEL*BLANK    WN0015           Carrier Code
     C                     MOVEL*BLANK    WN0016           Ship Status
     C                     MOVEL*BLANK    WN0017           Load Type
     C                     Z-ADD*ZERO     WN0018           Number Pallets
     C                     Z-ADD*ZERO     WN0019           Number Pallets
     C                     Z-ADD*ZERO     WN0020           Actual Departur
     C                     Z-ADD*ZERO     WN0021           Departure Time
     C                     Z-ADD*ZERO     WN0024           Total Load Mile
     C                     MOVEL*BLANK    WN0025           Recorder ID
     C                     MOVEL*BLANK    WN0026           Shipping Method
     C                     MOVEL*BLANK    WN0027           Ship From Wareh
     C                     MOVEL*BLANK    WN0028           Ship To State C
     C                     MOVEL*BLANK    WN0029           Export Status
     C                     Z-ADD*ZERO     WN0030           Actual Ship Dat
     C                     Z-ADD*ZERO     YL0001           BOL Complete Da
     C                     Z-ADD*ZERO     YL0002           BOL Complete Ti
     C                     MOVEL*BLANK    WN0033           Shipping Line
     C                     MOVEL*BLANK    WN0034           Discharge Port
     C                     Z-ADD*ZERO     WN0035           Scheduled Deliv
     C                     Z-ADD*ZERO     WN0036           Scheduled Deliv
     C                     MOVEL*BLANK    WN0037           Load Shag Flag
     C                     MOVEL*BLANK    WN0038           Load Wash Flag
     C                     Z-ADD*ZERO     WN0039           Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0040           Tot Pallet Tare
     C                     Z-ADD*ZERO     WN0041           Override Total
     C                     MOVEL*BLANK    WN0044           MG Created Load
     C                     MOVEL*BLANK    WN0045           Load U_M
     C                     MOVEL*BLANK    WN0048           EDI Status 1
     C                     MOVEL*BLANK    YL0003           Record Found US
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     MOVEL'N'       YL0003           Record Found US
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     Z-ADDWBAIC3    WN0004           Company Number
     C                     Z-ADDWBAODT    WN0005           Scheduled Ship
     C                     MOVELWBPKST    WN0006           Load Status
     C                     MOVELWBDMTX    WN0008           Seal 1
     C                     MOVELWBDNTX    WN0009           Seal 2
     C                     MOVELWBDOTX    WN0010           Seal 3
     C                     Z-ADDWBFLAM    WN0012           Flat Amount
     C                     Z-ADDWBRRNB    WN0013           Total Stops
     C                     MOVELWBDXTX    WN0014           Trailer Id
     C                     MOVELWBBZNA    WN0015           Carrier Code
     C                     MOVELWBVCST    WN0016           Ship Status
     C                     MOVELWBVDST    WN0017           Load Type
     C                     Z-ADDWBSDNB    WN0018           Number Pallets
     C                     Z-ADDWBPAOU    WN0019           Number Pallets
     C                     Z-ADDWBAQDT    WN0020           Actual Departur
     C                     Z-ADDWBS6NB    WN0021           Departure Time
     C                     Z-ADDWBTLMI    WN0024           Total Load Mile
     C                     MOVELWBJ9TX    WN0025           Recorder ID
     C                     MOVELWBQ2CD    WN0026           Shipping Method
     C                     MOVELWBVPCD    WN0027           Ship From Wareh
     C                     MOVELWBDBCD    WN0028           Ship To State C
     C                     MOVELWBU2ST    WN0029           Export Status
     C                     Z-ADDWBF9DT    WN0030           Actual Ship Dat
     C                     Z-ADDWBJ7DT    YL0001           BOL Complete Da
     C                     Z-ADDWBBOTM    YL0002           BOL Complete Ti
     C                     MOVELWBXACD    WN0033           Shipping Line
     C                     MOVELWBW4CD    WN0034           Discharge Port
     C                     Z-ADDWBKJDT    WN0035           Scheduled Deliv
     C                     Z-ADDWBATTM    WN0036           Scheduled Deliv
     C                     MOVELWBLSHG    WN0037           Load Shag Flag
     C                     MOVELWBYPST    WN0038           Load Wash Flag
     C                     Z-ADDWBICWG    WN0039           Avg Pallet Tare
     C                     Z-ADDWBIDWG    WN0040           Tot Pallet Tare
     C                     Z-ADDWBK2DT    WN0041           Override Total
     C                     MOVELWBRYSX    WN0044           MG Created Load
     C                     MOVELWBR0SX    WN0045           Load U_M
     C                     MOVELWBUVST    WN0048           EDI Status 1
     C                     MOVEL'Y'       YL0003           Record Found US
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV All Ords Shipped?  RT - Load Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0058  1        Header Status
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       YL0004           Status - Y or N
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCRMNB    WQSC01           Load ID
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Load ID
      * Setup key
     C                     Z-ADDWN0003    WQSC01           Load ID
      * Establish starting position
     C           KRSSC     SETLL@FLCPBW                    *
     C           KRSSC     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Assume all orders are shipped, unless find one that isn't
      * RTV Order Status       RT - Order Header TRG  * 
     C                     EXSR SDRVGN
      * CASE: PAR.Header Status is Conf/Comp/Canc
     C           WN0058    IFEQ 'X'                        *IF
     C           WN0058    OREQ 'C'
     C           WN0058    OREQ 'R'
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0004           Status - Y or N
     C                     GOTO SCEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSC     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Order Status       RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
      * Setup key
     C                     Z-ADDWCAIC3    WDAIC3           Company Number
     C                     Z-ADDWCC4NB    WDC4NB           Order Number
      * Establish starting position
     C           KRSSD     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDGWST    WN0058           Header Status
     C                     MOVELWDGXST    WUG0TX           Header Status L
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Act ShpDt Last Ord RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WN0030           Actual Shipped
      * Declare restrictor key work fields
     C           *LIKE     DEFN WERMNB    WQSE02           Load ID
      * Define keylist
     C           KPSSE     KLIST
     C                     KFLD           WQSE02           Load ID
     C                     KFLD           WERVNB           Stop_Drop
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE02           Load ID
      * Setup key
     C                     Z-ADDWN0003    WQSE02           Load ID
     C                     Z-ADD9999      WERVNB           Stop_Drop
      * Establish starting position
     C           KPSSE     SETLL@FLCPE8                    *
     C           KRSSE     READE@FLCPE8                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Actual Ship Date  RT - Order Header TRG  * 
     C                     EXSR SFRVGN
      * CASE: WRK.Actual Shipped Date GT PAR.Actual Shipped Date
     C           WUGNDT    IFGT WN0030                     *IF
     C                     Z-ADDWUGNDT    WN0030           Actual Shipped
     C                     END                             *FI
     C           KRSSE     READE@FLCPE8                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Actual Ship Date  RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
      * Setup key
     C                     Z-ADDWEAIC3    WDAIC3           Company Number
     C                     Z-ADDWEC4NB    WDC4NB           Order Number
      * Establish starting position
     C           KRSSF     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUGNDT           Actual Shipped
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWDGNDT    WUGNDT           Actual Shipped
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCHRC    BEGSR
      *================================================================
      * CHG Last Used Date     CH - Carrier  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0059 30        Name
     C                     MOVEL*BLANK    WN0060 30        Address Line 1
     C                     MOVEL*BLANK    WN0061 30        Address Line 2
     C                     MOVEL*BLANK    WN0062 30        Address Line 3
     C                     MOVEL*BLANK    WN0063 20        City
     C                     MOVEL*BLANK    WN0064 11        Zip Postal Code
     C                     Z-ADD*ZERO     WN0065 110       Telephone Numbe
     C                     MOVEL*BLANK    WN0066  2        State Code
     C                     MOVEL*BLANK    WN0067 25        Fax Number
     C                     Z-ADD*ZERO     WN0068 112       Pallet Balance
     C                     Z-ADD*ZERO     WN0069 112       Long hook balan
     C                     Z-ADD*ZERO     WN0070 112       Short hook bala
     C                     Z-ADD*ZERO     WN0071 112       Tub Balance
     C                     MOVEL*BLANK    WN0072  1        OM Carrier Stat
     C                     MOVEL*BLANK    WN0073 30        OM Carrier Comm
     C                     MOVEL*BLANK    WN0074 30        OM Carrier Comm
     C                     MOVEL*BLANK    WN0075 10        AP Vendor Numbe
     C                     Z-ADD*ZERO     WN0076 110       Home Phone
     C                     Z-ADD*ZERO     WN0077 110       Other Phone
     C                     Z-ADD*ZERO     WN0078 112       Flat Rate
     C                     Z-ADD*ZERO     WN0079  72       Rate Per Pound
     C                     Z-ADD*ZERO     WN0080  72       Unused Rate Per
     C                     Z-ADD*ZERO     WN0081  72       Miscellaneous C
     C                     MOVEL*BLANK    WN0082  3        Unused Carrier
     C                     Z-ADD*ZERO     WN0083  70       Unused Mile Ran
     C                     Z-ADD*ZERO     WN0084  70       Unused Mile Ran
     C                     Z-ADD*ZERO     WN0085  70       Unused Mile Ran
     C                     Z-ADD*ZERO     WN0086  70       Unused Mile Ran
     C                     Z-ADD*ZERO     WN0087  70       Unused Mile Ran
     C                     Z-ADD*ZERO     WN0088  70       Unused Mile Ran
     C                     Z-ADD*ZERO     WN0089 114       Unused Mile Rat
     C                     Z-ADD*ZERO     WN0090 114       Unused Mile Rat
     C                     Z-ADD*ZERO     WN0091 114       Unused Mile Rat
     C                     Z-ADD*ZERO     WN0092 114       Unused Mile Rat
     C                     Z-ADD*ZERO     WN0093 114       Unused Mile Rat
     C                     Z-ADD*ZERO     WN0094 114       Unused Mile Rat
     C                     Z-ADD*ZERO     WN0095 112       Unused Weight R
     C                     Z-ADD*ZERO     WN0096 112       Unused Weight R
     C                     Z-ADD*ZERO     WN0097 112       Unused Weight R
     C                     Z-ADD*ZERO     WN0098 112       Unused Weight R
     C                     Z-ADD*ZERO     WN0099 112       Unused Weight R
     C                     Z-ADD*ZERO     WN0100 112       Unused Weight R
     C                     Z-ADD*ZERO     WN0101 114       Unused Weight R
     C                     Z-ADD*ZERO     WN0102 114       Unused Weight R
     C                     Z-ADD*ZERO     WN0103 114       Unused Weight R
     C                     Z-ADD*ZERO     WN0104 114       Unused Weight R
     C                     Z-ADD*ZERO     WN0105 114       Unused Weight R
     C                     Z-ADD*ZERO     WN0106 114       Unused Weight R
     C                     Z-ADD*ZERO     WN0107  70       Contact Number
     C                     MOVEL*BLANK    WN0108  1        Certificate of
     C                     MOVEL*BLANK    WN0109 30        Carrier Unused
     C                     MOVEL*BLANK    WN0110 30        Carrier Unused
     C                     MOVEL*BLANK    WN0111 20        Carrier DOT Num
     C                     MOVEL*BLANK    WN0112  2        Carrier Unused
     C                     MOVEL*BLANK    WN0113 11        Carrier Unused
     C                     Z-ADD*ZERO     WN0114 110       Carrier Unused
     C                     MOVEL*BLANK    WN0115 25        Carrier Fed ID
     C                     Z-ADD*ZERO     WN0116 110       Amount of Cargo
     C                     Z-ADD*ZERO     WN0117 110       Amount of Liabi
     C                     Z-ADD*ZERO     WN0118  70       Date of Expirat
     C                     MOVEL*BLANK    WN0119  1        SSI Download Fl
     C                     MOVEL*BLANK    WN0120  1        unused status 2
     C                     MOVEL*BLANK    WN0121  1        unused status 3
     C                     MOVEL*BLANK    WN0122  1        EDI Status 1
     C                     MOVEL*BLANK    WN0123  1        EDI Status 2
     C                     MOVEL*BLANK    WN0124  1        EDI Status 3
     C                     MOVEL*BLANK    WN0125  1        Record Status
     C                     Z-ADD*ZERO     WN0126  60       Job Time
     C                     MOVEL*BLANK    WN0127 10        User Id
     C                     MOVEL*BLANK    WN0128 10        Job Name
     C                     Z-ADD*ZERO     WN0129  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @FFREBG
     C                     MOVELWN0015    WFBZNA    P      Carrier Code
      *
     C           KLCHSG    KLIST
     C                     KFLD           WFBZNA           Carrier Code
     C           KLCHSG    CHAIN@FFREBG              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFFREL1'MDACP
     C                     MOVEL'@FFREBG' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFF1    YARDCS
      * Move non-key fields to @FFREBG
     C                     Z-ADD##JDT     WFEEDT           Carrier Last Us
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@FFREBG                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFFREL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * PFS Upd OrdDtl ShpDte RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCRMNB    WQSH01           Load ID
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Load ID
      * Setup key
     C                     Z-ADDWN0003    WQSH01           Load ID
      * Establish starting position
     C           KRSSH     SETLL@FLCPBW                    *
     C           KRSSH     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PFS Upd OrdDtl ShpDte RT - Order Detail  * 
     C                     EXSR SIRVGN
      * E4119 Create trigger when CloseTruck so they can get Actual wt/qt
      * CASE: PAR.MG Created Load is Yes
     C           WN0044    IFEQ 'Y'                        *IF
      * Rtv Crt OH Trigger    XF - TMS Order Header Trigger  * 
     C                     CALL 'PBWVXFR'              90  Rtv Crt OH Trig
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WCC4NB    WQ0004  70       Order Number
     C                     PARM WCAIC3    WQ0005  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBWVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C           KRSSH     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * PFS Upd OrdDtl ShpDte RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAIC3    WQSI01           Company Number
     C           *LIKE     DEFN WGC4NB    WQSI02           Order Number
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Company Number
     C                     KFLD           WQSI02           Order Number
      * Setup key
     C                     Z-ADDWCAIC3    WQSI01           Company Number
     C                     Z-ADDWCC4NB    WQSI02           Order Number
      * Establish starting position
     C           KRSSI     SETLL@BGWKL1                    *
     C           KRSSI     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Actual Shipped Date is not entered
     C           WGGNDT    IFEQ 0                          *IF
      * CHG Actual Ship Date   CH - Order Detail  * 
     C                     EXSR SJCHRC
     C                     END                             *FI
     C           KRSSI     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCHRC    BEGSR
      *================================================================
      * CHG Actual Ship Date   CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0130  70       Item Code
     C                     MOVEL*BLANK    WN0131  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0132  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0133  70       Order Group Cod
     C                     MOVEL*BLANK    WN0134  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0135  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0136 112       Billing Detail
     C                     Z-ADD*ZERO     WN0137 112       Billing Detail
     C                     Z-ADD*ZERO     WN0138 112       Billing Detail
     C                     Z-ADD*ZERO     WN0139 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0140  1        Comment Print A
     C                     MOVEL*BLANK    WN0141  1        Comment Print I
     C                     MOVEL*BLANK    WN0142  1        Comment Print P
     C                     MOVEL*BLANK    WN0143  1        Comment Print S
     C                     Z-ADD*ZERO     WN0144 112       Extended Amount
     C                     Z-ADD*ZERO     WN0145  70       Market Pricing
     C                     MOVEL*BLANK    WN0146  3        Commodity Marke
     C                     MOVEL*BLANK    WN0147  3        Date Method Cod
     C                     MOVEL*BLANK    WN0148  3        Price Method Co
     C                     Z-ADD*ZERO     WN0149 114       Price Overage O
     C                     Z-ADD*ZERO     WN0150  70       Contract Number
     C                     MOVEL*BLANK    WN0151  1        Price Status
     C                     Z-ADD*ZERO     WN0152  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0153  2        U_M_Base Price
     C                     MOVEL*BLANK    WN0154  2        U_M_Ordered
     C                     MOVEL*BLANK    WN0155  1        Work Confirm St
     C                     MOVEL*BLANK    WN0156  1        Work Over_Short
     C                     MOVEL*BLANK    WN0157  1        OD Production P
     C                     MOVEL*BLANK    WN0158 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0159 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0160  1        Age Code
     C                     MOVEL*BLANK    WN0161  1        Palletize
     C                     MOVEL*BLANK    WN0162  1        Slip Sheet
     C                     MOVEL*BLANK    WN0163  1        Catch Weight St
     C                     MOVEL*BLANK    WN0164  1        Price Audit
     C                     MOVEL*BLANK    WN0165  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0166  1        Production Date
     C                     Z-ADD*ZERO     WN0167 112       Rated Freight
     C                     Z-ADD*ZERO     WN0168 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0169 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0170 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0171 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0172 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0173 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0174 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0175 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0176 114       Unit Price
     C                     Z-ADD*ZERO     WN0177 114       Unit Price_Cred
     C                     Z-ADD*ZERO     WN0178 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0179 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0180 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0181  70       Requested Ship
     C                     Z-ADD*ZERO     WN0182  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0183  1        Affect Inventor
     C                     MOVEL*BLANK    WN0184  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0185  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0186  30       Item Structure
     C                     Z-ADD*ZERO     WN0187  30       Item Structure
     C                     Z-ADD*ZERO     WN0188  30       Item Structure
     C                     MOVEL*BLANK    WN0189  2        Item Level
     C                     MOVEL*BLANK    WN0190  2        Quality Level
     C                     MOVEL*BLANK    WN0191  2        Pricing Product
     C                     MOVEL*BLANK    WN0192  2        Season Product
     C                     Z-ADD*ZERO     WN0193  70       Date of Origina
     C                     MOVEL*BLANK    WN0194 10        User Profile Na
     C                     MOVEL*BLANK    WN0195  6        Country Code
     C                     MOVEL*BLANK    WN0196  2        Event Code
     C                     MOVEL*BLANK    WN0197  3        Reason Code
     C                     MOVEL*BLANK    WN0198  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0199  1        Modified Flag
     C                     MOVEL*BLANK    WN0200  1        Substituted Fla
     C                     MOVEL*BLANK    WN0201  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0202 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0203 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0204  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0205  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0206  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0207  1        Affect Commissi
     C                     MOVEL*BLANK    WN0208  1        Affect Pricing
     C                     MOVEL*BLANK    WN0209  1        Released by Use
     C                     MOVEL*BLANK    WN0210  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0211  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0212  3        Production Ware
     C                     MOVEL*BLANK    WN0213  3        OD Price Type
     C                     Z-ADD*ZERO     WN0214  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0215  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0216  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0217  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0218  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0219  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0220  60       Price Code
     C                     Z-ADD*ZERO     WN0221  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0222  60       Substitution Li
     C                     Z-ADD*ZERO     WN0223  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0224 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0225 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0226 112       OD Item Target
     C                     Z-ADD*ZERO     WN0227 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0228 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0229 114       Order Gate_Fina
     C                     Z-ADD*ZERO     WN0230 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0231 114       OD Gate_Final P
     C                     Z-ADD*ZERO     WN0232 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0233 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0234 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0235 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0236 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0237  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0238  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0239  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0240 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0241  40       Item Age Days
     C                     Z-ADD*ZERO     WN0242  70       Production Ovr
     C                     Z-ADD*ZERO     WN0243  70       Production Ovr
     C                     MOVEL*BLANK    WN0244  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0245  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0246  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0247  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0248  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0249  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0250  1        EDI Status 1
     C                     MOVEL*BLANK    WN0251  1        EDI Status 2
     C                     MOVEL*BLANK    WN0252  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0253  60       Job Time
     C                     MOVEL*BLANK    WN0254 10        User Id
     C                     MOVEL*BLANK    WN0255 10        Job Name
     C                     Z-ADD*ZERO     WN0256  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWGAIC3    WHAIC3           Company Number
     C                     Z-ADDWGC4NB    WHC4NB           Order Number
     C                     Z-ADDWGDPNB    WHDPNB           Order Sequence
     C                     Z-ADDWGUENB    WHUENB           Order Secondary
      *
     C           KLCHSJ    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHC4NB           Order Number
     C                     KFLD           WHDPNB           Order Sequence
     C                     KFLD           WHUENB           Order Secondary
     C           KLCHSJ    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YBRDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDWN0030    WHGNDT           Actual Shipped
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##JOB     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Last CB Prd Dt/Tm RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCRMNB    WQSK01           Load ID
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Load ID
      * Setup key
     C                     Z-ADDWN0003    WQSK01           Load ID
      * Establish starting position
     C           KRSSK     SETLL@FLCPBW                    *
     C           KRSSK     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Last CB Prd Dt/Tm RT - Order Detail  * 
     C                     EXSR SLRVGN
     C           KRSSK     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Last CB Prd Dt/Tm RT - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0257  30       Accounting Comp
     C                     Z-ADD*ZERO     WN0258  60       PT Production T
     C                     Z-ADD*ZERO     WN0259  80       PT Label Date Y
     C                     Z-ADD*ZERO     WN0260  70       Production Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       YL0007           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAIC3    WQSL01           Company Number
     C           *LIKE     DEFN WGC4NB    WQSL02           Order Number
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Company Number
     C                     KFLD           WQSL02           Order Number
      * Setup key
     C                     Z-ADDWCAIC3    WQSL01           Company Number
     C                     Z-ADDWCC4NB    WQSL02           Order Number
      * Establish starting position
     C           KRSSL     SETLL@BGWKL1                    *
     C           KRSSL     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.U/M - Ordered is Combos
     C           WGAGCD    IFEQ 'CB'                       *IF
      * CASE: DB1.Quantity Shipped Total is Greater than zero
     C           WGCBQT    IFGT 0                          *IF
      * CASE: LCL.First Time Flag is Yes
     C           YL0007    IFEQ 'Y'                        *IF
      * Rtv Acct Co          RT - Warehouse  * 
     C                     EXSR SMRVGN
     C                     MOVEL'N'       YL0007           First Time Flag
     C                     END                             *FI
      * Rtv Last CB Prd Dt/Tm RT - Product Trace  * 
     C                     EXSR SNRVGN
      *
     C                     Z-ADD*ZERO     WN0261  40       Year Code
     C                     Z-ADD*ZERO     WN0262  20       Month
     C                     Z-ADD*ZERO     WN0263  20       Day of Month US
     C                     MOVEL*BLANK    WN0264  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0265  2        Month (Char) US
     C                     MOVEL*BLANK    WN0266  2        Day   (Char) US
     C                     Z-ADD*ZERO     WN0267  20       Year  NBR USR
     C                     MOVEL*BLANK    WN0268  2        Year  (Char) US
     C                     MOVEL*BLANK    WN0269  7        Date (Alpha) US
      *
      * CVT *YYMD to *CYMD    IF
      * ** YEAR **
     C           WN0259    DIV  10000     WN0261           Year Code
     C                     Z-ADDWN0261    WN0267           Year  NBR USR
     C                     MOVELWN0267    WN0268           Year  (Char) US
      * ** MONTH **
     C           WN0259    DIV  100       WN0262           Month
     C                     MOVELWN0262    WN0265           Month (Char) US
      * ** DAY **
     C                     Z-ADDWN0259    WN0263           Day of Month US
     C                     MOVELWN0263    WN0266           Day   (Char) US
      * CENTURY+YEAR
      * CASE: PAR.Year Code is Twentieth Century
     C           WN0261    IFLE 1999                       *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           '0'       CAT  WN0268:ZQ WN0269    P      Date (Alpha) US
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           '1'       CAT  WN0268:ZQ WN0269    P      Date (Alpha) US
     C                     END                             *FI
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0269    CAT  WN0265:ZQ WN0269    P      Date (Alpha) US
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0269    CAT  WN0266:ZQ WN0269    P      Date (Alpha) US
     C                     MOVE WN0269    WN0260           Date
      * CASE: PAR.Production Date LT PAR.LH Last Combo Prod Date
     C           WN0260    IFLT WN0046                     *IF
     C                     ELSE
      * CASE: PAR.Production Date GT PAR.LH Last Combo Prod Date
     C           WN0260    IFGT WN0046                     *IF
     C                     Z-ADDWN0260    WN0046           LH Last Combo P
     C                     Z-ADDWN0258    WN0047           LH Last Combo P
     C                     ELSE
      * CASE: PAR.Production Date EQ PAR.LH Last Combo Prod Date
     C           WN0260    IFEQ WN0046                     *IF
      * CHK: Production Time
      * CASE: PAR.PT Production Time GT PAR.LH Last Combo Prod Time
     C           WN0258    IFGT WN0047                     *IF
     C                     Z-ADDWN0258    WN0047           LH Last Combo P
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSL     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Acct Co          RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WIAJCD           Warehouse Code
      * Setup key
     C                     MOVELWGAJCD    WIAJCD           Warehouse Code
      * Establish starting position
     C           KRSSM     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0257           Accounting Comp
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWIBTC3    WN0257           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Last CB Prd Dt/Tm RT - Product Trace  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0258           PT Production T
     C                     Z-ADD*ZERO     WN0259           PT Label Date Y
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJAIC3    WQSN01           Company Number
     C           *LIKE     DEFN WJPGNX    WQSN02           PT Order Number
     C           *LIKE     DEFN WJD7C7    WQSN03           PT Product Code
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Company Number
     C                     KFLD           WQSN02           PT Order Number
     C                     KFLD           WQSN03           PT Product Code
      * Setup key
     C                     Z-ADDWN0257    WQSN01           Company Number
     C                     Z-ADDWGC4NB    WQSN02           PT Order Number
     C                     Z-ADDWGHGCD    WQSN03           PT Product Code
      * Establish starting position
     C           KRSSN     SETLL@B2CPS3                    *
     C           KRSSN     READE@B2CPS3                  90*
      * Data record not found
     C   90                MOVEL'USR3144' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWJB9TM    WN0258           PT Production T
     C                     Z-ADDWJADDX    WN0259           PT Label Date Y
     C                     GOTO SNEXIT                     *QUIT
     C           KRSSN     READE@B2CPS3                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Upd Whs Pallet Tare   RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    YL0009           Order Changed Y
     C                     MOVEL'*NO'     YL0009           Order Changed Y
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCRMNB    WQSO01           Load ID
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Load ID
      * Setup key
     C                     Z-ADDWN0003    WQSO01           Load ID
      * Establish starting position
     C           KRSSO     SETLL@FLCPBW                    *
     C           KRSSO     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Upd Whs Pallet Tare   RT - PD Order Detail  * 
     C                     EXSR SPRVGN
      * CASE: LCL.Order Changed Y/N is *YES
     C           YL0009    IFEQ '*YES'                     *IF
     C                     GOTO SOEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSO     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Upd Whs Pallet Tare   RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAIC3    WQSP01           Company Number
     C           *LIKE     DEFN WGC4NB    WQSP02           Order Number
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           Company Number
     C                     KFLD           WQSP02           Order Number
      * Setup key
     C                     Z-ADDWCAIC3    WQSP01           Company Number
     C                     Z-ADDWCC4NB    WQSP02           Order Number
      * Establish starting position
     C           KRSSP     SETLL@BGWKL1                    *
     C           KRSSP     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Warehouse Code NE PAR.USR Warehouse Code
     C           WGAJCD    IFNE YL0008                     *IF
     C                     GOTO SPEXIT                     *QUIT
     C                     END                             *FI
      * CASE: DB1.Detail Line Status is Not cancelled
     C           WGGMST    IFEQ 'L'                        *IF
     C           WGGMST    OREQ 'A'
     C           WGGMST    OREQ 'C'
     C           WGGMST    OREQ 'R'
     C           WGGMST    OREQ 'E'
     C           WGGMST    OREQ 'H'
     C           WGGMST    OREQ 'I'
      * Chg Whs Pallet Tare   CH - PD Order Detail  * 
     C                     EXSR SQCHRC
     C                     MOVEL'*YES'    YL0009           Order Changed Y
     C                     GOTO SPEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSP     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCHRC    BEGSR
      *================================================================
      * Chg Whs Pallet Tare   CH - PD Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0270  70       Item Code
     C                     MOVEL*BLANK    WN0271  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0272  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0273  70       Order Group Cod
     C                     MOVEL*BLANK    WN0274  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0275  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0276 112       Billing Detail
     C                     Z-ADD*ZERO     WN0277 112       Billing Detail
     C                     Z-ADD*ZERO     WN0278 112       Billing Detail
     C                     Z-ADD*ZERO     WN0279 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0280  1        Comment Print A
     C                     MOVEL*BLANK    WN0281  1        Comment Print I
     C                     MOVEL*BLANK    WN0282  1        Comment Print P
     C                     MOVEL*BLANK    WN0283  1        Comment Print S
     C                     Z-ADD*ZERO     WN0284 112       Extended Amount
     C                     Z-ADD*ZERO     WN0285  70       Market Pricing
     C                     MOVEL*BLANK    WN0286  3        Commodity Marke
     C                     MOVEL*BLANK    WN0287  3        Date Method Cod
     C                     MOVEL*BLANK    WN0288  3        Price Method Co
     C                     Z-ADD*ZERO     WN0289 114       Price Overage O
     C                     Z-ADD*ZERO     WN0290  70       Contract Number
     C                     MOVEL*BLANK    WN0291  1        Price Status
     C                     Z-ADD*ZERO     WN0292  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0293  2        U_M_Base Price
     C                     MOVEL*BLANK    WN0294  2        U_M_Ordered
     C                     MOVEL*BLANK    WN0295  1        Work Confirm St
     C                     MOVEL*BLANK    WN0296  1        Work Over_Short
     C                     MOVEL*BLANK    WN0297  1        OD Production P
     C                     MOVEL*BLANK    WN0298 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0299 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0300  1        Age Code
     C                     MOVEL*BLANK    WN0301  1        Palletize
     C                     MOVEL*BLANK    WN0302  1        Slip Sheet
     C                     MOVEL*BLANK    WN0303  1        Catch Weight St
     C                     MOVEL*BLANK    WN0304  1        Price Audit
     C                     MOVEL*BLANK    WN0305  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0306  1        Production Date
     C                     Z-ADD*ZERO     WN0307 112       Rated Freight
     C                     Z-ADD*ZERO     WN0308 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0309 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0310 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0311 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0312 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0313 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0314 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0315 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0316 114       Unit Price
     C                     Z-ADD*ZERO     WN0317 114       Unit Price_Cred
     C                     Z-ADD*ZERO     WN0318 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0319 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0320 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0321  70       Requested Ship
     C                     Z-ADD*ZERO     WN0322  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0323  70       Actual Shipped
     C                     MOVEL*BLANK    WN0324  1        Affect Inventor
     C                     MOVEL*BLANK    WN0325  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0326  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0327  30       Item Structure
     C                     Z-ADD*ZERO     WN0328  30       Item Structure
     C                     Z-ADD*ZERO     WN0329  30       Item Structure
     C                     MOVEL*BLANK    WN0330  2        Item Level
     C                     MOVEL*BLANK    WN0331  2        Quality Level
     C                     MOVEL*BLANK    WN0332  2        Pricing Product
     C                     MOVEL*BLANK    WN0333  2        Season Product
     C                     Z-ADD*ZERO     WN0334  70       Date of Origina
     C                     MOVEL*BLANK    WN0335 10        User Profile Na
     C                     MOVEL*BLANK    WN0336  6        Country Code
     C                     MOVEL*BLANK    WN0337  2        Event Code
     C                     MOVEL*BLANK    WN0338  3        Reason Code
     C                     MOVEL*BLANK    WN0339  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0340  1        Modified Flag
     C                     MOVEL*BLANK    WN0341  1        Substituted Fla
     C                     MOVEL*BLANK    WN0342  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0343 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0344 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0345  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0346  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0347  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0348  1        Affect Commissi
     C                     MOVEL*BLANK    WN0349  1        Affect Pricing
     C                     MOVEL*BLANK    WN0350  1        Released by Use
     C                     MOVEL*BLANK    WN0351  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0352  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0353  3        Production Ware
     C                     MOVEL*BLANK    WN0354  3        OD Price Type
     C                     Z-ADD*ZERO     WN0355  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0356  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0357  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0358  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0359  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0360  60       Price Code
     C                     Z-ADD*ZERO     WN0361  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0362  60       Substitution Li
     C                     Z-ADD*ZERO     WN0363  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0364 112       OD Item Target
     C                     Z-ADD*ZERO     WN0365 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0366 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0367 114       Order Gate_Fina
     C                     Z-ADD*ZERO     WN0368 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0369 114       OD Gate_Final P
     C                     Z-ADD*ZERO     WN0370 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0371 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0372 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0373 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0374 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0375  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0376  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0377  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0378 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0379  40       Item Age Days
     C                     Z-ADD*ZERO     WN0380  70       Production Ovr
     C                     Z-ADD*ZERO     WN0381  70       Production Ovr
     C                     MOVEL*BLANK    WN0382  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0383  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0384  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0385  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0386  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0387  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0388  1        EDI Status 1
     C                     MOVEL*BLANK    WN0389  1        EDI Status 2
     C                     MOVEL*BLANK    WN0390  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0391  60       Job Time
     C                     MOVEL*BLANK    WN0392 10        User Id
     C                     MOVEL*BLANK    WN0393 10        Job Name
     C                     Z-ADD*ZERO     WN0394  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWGAIC3    WHAIC3           Company Number
     C                     Z-ADDWGC4NB    WHC4NB           Order Number
     C                     Z-ADDWGDPNB    WHDPNB           Order Sequence
     C                     Z-ADDWGUENB    WHUENB           Order Secondary
      *
     C           KLCHSQ    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHC4NB           Order Number
     C                     KFLD           WHDPNB           Order Sequence
     C                     KFLD           WHUENB           Order Secondary
     C           KLCHSQ    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YCRDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDWN0019    WHNTDT           Warehouse Palle
     C                     Z-ADDWN0040    WHH5NX           Warehouse Palle
     C                     Z-ADDWN0039    WHH6NX           Warehouse Avg P
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * PFS Upd Load Header   RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WBRMNB           Load ID
      * Setup key
     C                     Z-ADDWN0003    WBRMNB           Load ID
      * Establish starting position
     C           KRSSR     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWBCNTN    YL0010           Container Numbe
      * CASE: DB1.Export Status is yes
     C           WBU2ST    IFEQ 'Y'                        *IF
      * CASE: DB1.MG Created Load is Yes
     C           WBRYSX    IFEQ 'Y'                        *IF
     C                     MOVELWN0014    YL0010           Container Numbe
      * RTV UPD Cntnr-ords/ld  XF - Order Header Extension  * 
     C                     CALL 'PBRXXFR'              90  RTV UPD Cntnr-o
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBRMNB    WQ0010  70       Load ID
     C                     PARM WBXACD    WQ0011  3        Shipping Line
     C                     PARM YL0010    WQ0012 12        OHE Container N
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBRXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * PFS Chg Load Header   CH - Load Header  * 
     C                     EXSR SSCHRC
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCHRC    BEGSR
      *================================================================
      * PFS Chg Load Header   CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0395  30       Company Number
     C                     Z-ADD*ZERO     WN0396  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0397  1        LTL Flag
     C                     MOVEL*BLANK    WN0398 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0399  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0400 112       Flat Amount
     C                     MOVEL*BLANK    WN0401  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0402  50       Total Stops
     C                     MOVEL*BLANK    WN0403  3        Transloader Car
     C                     Z-ADD*ZERO     WN0404  40       BOL Time
     C                     MOVEL*BLANK    WN0405  3        Carrier Code
     C                     MOVEL*BLANK    WN0406  7        Truck Size
     C                     Z-ADD*ZERO     WN0407  70       Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WN0408 112       Rated Freight
     C                     MOVEL*BLANK    WN0409  1        Load Type
     C                     Z-ADD*ZERO     WN0410 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0411  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0412  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0413  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0414 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0415 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0416  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0417  52       Product Tempera
     C                     MOVEL*BLANK    WN0418 12        Car_Veh_Initial
     C                     Z-ADD*ZERO     WN0419  70       Total Load Mile
     C                     MOVEL*BLANK    WN0420  2        Shipping Method
     C                     MOVEL*BLANK    WN0421  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0422  2        Ship To State C
     C                     Z-ADD*ZERO     WN0423  70       Gross Weight
     C                     MOVEL*BLANK    WN0424  3        Carrier Broker
     C                     MOVEL*BLANK    WN0425  1        Export Status
     C                     Z-ADD*ZERO     WN0426  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0427  1        On Time_Y_N
     C                     Z-ADD*ZERO     WN0428  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0429  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0430  70       Spotted Date
     C                     Z-ADD*ZERO     WN0431  60       Spotted Time
     C                     Z-ADD*ZERO     WN0432  70       Load Finished D
     C                     Z-ADD*ZERO     WN0433  60       Load Finished T
     C                     Z-ADD*ZERO     WN0434  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0435  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0436  70       Truck Departure
     C                     Z-ADD*ZERO     WN0437  60       Truck Departure
     C                     Z-ADD*ZERO     WN0438  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0439  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0440  3        Shipping Line
     C                     MOVEL*BLANK    WN0441 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0442 30        Vessel Name
     C                     Z-ADD*ZERO     WN0443  50       Voyage
     C                     Z-ADD*ZERO     WN0444  70       Sail Date
     C                     MOVEL*BLANK    WN0445 12        Booking Number
     C                     MOVEL*BLANK    WN0446 20        Discharge Port
     C                     Z-ADD*ZERO     WN0447  70       Arrival Date
     C                     Z-ADD*ZERO     WN0448  70       Date In
     C                     Z-ADD*ZERO     WN0449  60       Time In
     C                     Z-ADD*ZERO     WN0450  70       Date Out
     C                     Z-ADD*ZERO     WN0451  60       Time Out
     C                     Z-ADD*ZERO     WN0452 112       Load Total Frei
     C                     MOVEL*BLANK    WN0453  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0454  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0455  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0456  70       Requested Deliv
     C                     MOVEL*BLANK    WN0457  1        Load Acceptance
     C                     MOVEL*BLANK    WN0458  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0459  70       On Yard Date
     C                     Z-ADD*ZERO     WN0460  60       On Yard Time
     C                     Z-ADD*ZERO     WN0461  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0462  60       Deadline Depart
     C                     MOVEL*BLANK    WN0463  1        Load Held Over
     C                     MOVEL*BLANK    WN0464  1        Load Held Over
     C                     MOVEL*BLANK    WN0465 15        Load Held Over
     C                     MOVEL*BLANK    WN0466 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0467 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0468  70       Express Mail Da
     C                     MOVEL*BLANK    WN0469  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0470  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0471  70       Product Complet
     C                     Z-ADD*ZERO     WN0472  60       Product Complet
     C                     Z-ADD*ZERO     WN0473  50       Pallets Loaded
     C                     MOVEL*BLANK    WN0474  1        Load Confirmed
     C                     MOVEL*BLANK    WN0475 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0476  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0477  60       Load Door 1
     C                     Z-ADD*ZERO     WN0478  70       Override Total
     C                     Z-ADD*ZERO     WN0479  60       Load Door 2
     C                     MOVEL*BLANK    WN0480  1        Partial Load
     C                     MOVEL*BLANK    WN0481  1        Load Confirmati
     C                     MOVEL*BLANK    WN0482  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0483 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0484 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0485 15        Late Billing Em
     C                     MOVEL*BLANK    WN0486 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0487 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0488  1        Multi Company L
     C                     MOVEL*BLANK    WN0489  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0490  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0491  1        LH Power Only L
     C                     MOVEL*BLANK    WN0492  1        MG Created Load
     C                     MOVEL*BLANK    WN0493  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0494  2        Load U_M
     C                     MOVEL*BLANK    WN0495  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0496  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0497  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0498  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0499  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0500  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0501  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0502  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0503  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0504  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0505  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0506  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0507  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0508  60       LH Unused Time
     C                     MOVEL*BLANK    WN0509  1        EDI Status 2
     C                     MOVEL*BLANK    WN0510  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0511  60       Job Time
     C                     MOVEL*BLANK    WN0512 10        User Id
     C                     MOVEL*BLANK    WN0513 10        Job Name
     C                     Z-ADD*ZERO     WN0514  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
      * change log
     C                     EXSR UBSUBR                     change log
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWN0003    WKRMNB           Load ID
      *
     C           KLCHSS    KLIST
     C                     KFLD           WKRMNB           Load ID
     C           KLCHSS    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YDRDCS
      * USER: Processing after Data read
      * Save copy of fields written to Load Order Change Log
      * CASE: *OTHERWISE
     C                     Z-ADDWKKJDT    YL0011           Scheduled Deliv
      * CASE: DB1.MG Created Load is Yes
     C           WKRYSX    IFEQ 'Y'                        *IF
      * If Seal 1 changes: Write TMS load trigger
      * CASE:
      *  - c1ORc2ORc3ORc4
      *   |- c1    : PAR.Seal 1 NE DB1.Seal 1
      *   |- c2    : PAR.Seal 2 NE DB1.Seal 2
      *   |- c3    : PAR.Seal 3 NE DB1.Seal 3
      *   |- c4    : PAR.Trailer Id NE DB1.Trailer Id
      *   '-
     C           WN0008    IFNE WKDMTX                     *IF
     C           WN0009    ORNE WKDNTX                     *OR
     C           WN0010    ORNE WKDOTX                     *OR
     C           WN0014    ORNE WKDXTX                     *OR
     C                     MOVELWUS3TX    YL0012           Load Change Typ
     C                     MOVELWUS3TX    YL0013           Load Change Typ
     C                     MOVELWUS3TX    YL0014           Load Change Typ
     C                     MOVELWUS3TX    YL0015           Load Change Typ
     C                     MOVELWUS3TX    YL0016           Load Change Typ
      * CASE: PAR.Trailer Id NE DB1.Trailer Id
     C           WN0014    IFNE WKDXTX                     *IF
     C                     MOVEL'TRAILR'  YL0012           Load Change Typ
     C                     END                             *FI
      * CASE:
      *  - c1ORc2ORc3
      *   |- c1    : PAR.Seal 1 NE DB1.Seal 1
      *   |- c2    : PAR.Seal 2 NE DB1.Seal 2
      *   |- c3    : PAR.Seal 3 NE DB1.Seal 3
      *   '-
     C           WN0008    IFNE WKDMTX                     *IF
     C           WN0009    ORNE WKDNTX                     *OR
     C           WN0010    ORNE WKDOTX                     *OR
      * CASE: LCL.Load Change Type EQ WRK.Blank 6 USR
     C           YL0012    IFEQ WUXKTX                     *IF
     C                     MOVEL'EXSEAL'  YL0012           Load Change Typ
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'EXSEAL'  YL0013           Load Change Typ
     C                     END                             *FI
     C                     END                             *FI
      * Exc Crt TMS Load Trg  XF - TMS Load Trigger  * 
     C                     CALL 'PBXOXFR'              90  Exc Crt TMS Loa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM ##JDT     WQ0013  70       Job Date
     C                     PARM ##JTM     WQ0014  60       Job Time
     C                     PARM WKRMNB    WQ0015  70       Load ID
     C                     PARM WKAIC3    WQ0016  30       TMS LH Load Str
     C                     PARM YL0017    WQ0017 35        TMS LH Field Ch
     C                     PARM 'A'       WQ0018  1        TMS Record Stat
     C                     PARM *ZERO     WQ0019  30       TMS Process Sta
     C                     PARM *BLANK    WQ0020  6        TMS Error Reaso
     C                     PARM *ZERO     WQ0021  80       TMS Change Date
     C                     PARM *ZERO     WQ0022  60       TMS Change time
     C                     PARM YL0012    WQ0023  6        Load Change Typ
     C                     PARM YL0013    WQ0024  6        Load Change Typ
     C                     PARM YL0014    WQ0025  6        Load Change Typ
     C                     PARM YL0015    WQ0026  6        Load Change Typ
     C                     PARM YL0016    WQ0027  6        Load Change Typ
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBXOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Move non-key fields to @FJCPBO
     C                     MOVELWN0006    WKPKST    P      Load Status
     C                     Z-ADDWN0007    WKRNNB           Reefer Temperat
     C                     MOVELWN0008    WKDMTX    P      Seal 1
     C                     MOVELWN0009    WKDNTX    P      Seal 2
     C                     MOVELWN0010    WKDOTX    P      Seal 3
     C                     MOVELWN0011    WKWTTX    P      Seal 4
     C                     MOVELWN0014    WKDXTX    P      Trailer Id
     C                     MOVELWN0016    WKVCST    P      Ship Status
     C                     Z-ADDWN0018    WKSDNB           Number Pallets
     C                     Z-ADDWN0019    WKPAOU           Number Pallets
     C                     Z-ADDWN0020    WKAQDT           Actual Departur
     C                     Z-ADDWN0021    WKS6NB           Departure Time
     C                     Z-ADDWN0023    WKNPSV           Number Spacers
     C                     MOVELWN0025    WKJ9TX    P      Recorder ID
     C                     Z-ADDWN0031    WKJ7DT           BOL Complete Da
     C                     Z-ADDWN0032    WKBOTM           BOL Complete Ti
     C                     MOVELYL0010    WKCNTN    P      Container Numbe
     C                     Z-ADDWN0035    WKKJDT           Scheduled Deliv
     C                     Z-ADDWN0036    WKATTM           Scheduled Deliv
     C                     Z-ADDWN0039    WKICWG           Avg Pallet Tare
     C                     Z-ADDWN0040    WKIDWG           Tot Pallet Tare
     C                     MOVELWN0042    WKRQST    P      Export Load USD
     C                     Z-ADDWN0046    WKPZDT           LH Last Combo P
     C                     Z-ADDWN0047    WKCLTM           LH Last Combo P
     C                     MOVEL'M'       WKUVST    P      EDI Status 1
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WKAATM           Job Time
     C                     MOVEL##USR     WKAYNA           User Id
     C                     MOVEL##PGM     WKA0NA           Job Name
     C                     Z-ADD##JDT     WKAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
      * Load Order Change Log
      * CASE: *OTHERWISE
      * Scheduled Delivery Date
      * CASE: PAR.Scheduled Delivery Date NE LCL.Scheduled Delivery Date
     C           WN0035    IFNE YL0011                     *IF
      * Convert dates to character
     C                     MOVEL*BLANK    YL0018           Date From Alpha
     C                     MOVELYL0011    YL0018           Date From Alpha
     C                     MOVEL*BLANK    YL0019           Date To Alpha
     C                     MOVELWN0035    YL0019           Date To Alpha
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPARC
     C                     Z-ADDWKRMNB    PARMNB           Load ID
     C                     Z-ADD*ZERO     PARVNB           Stop_Drop
     C                     MOVEL'SCHDLV'  PARVST    P      Load Change Typ
     C                     MOVEL'SHP'     PAUJST    P      Department Cont
     C                     MOVELYL0018    PAMNTX    P      Change Log Prio
     C                     MOVELYL0019    PAMOTX    P      Change Log New
     C                     MOVEL##USR     PAAYNA    P      User Id
     C                     MOVEL##PGM     PAA0NA    P      Job Name
     C                     MOVELWKBZNA    PABZNA    P      Carrier Code
     C                     Z-ADDWKAIC3    PAAIC3           Company Number
     C                     Z-ADD*ZERO     PAC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STCHRC    BEGSR
      *================================================================
      * Chg PostSts/ErrRsn    CH - PFS Ship Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0515  52       PFS Actual Reef
     C                     MOVEL*BLANK    WN0516  1        PFS Actual Reef
     C                     Z-ADD*ZERO     WN0517  52       PFS Actual Prod
     C                     MOVEL*BLANK    WN0518  1        PFS Actual Prod
     C                     MOVEL*BLANK    WN0519 15        PFS Seal 1
     C                     MOVEL*BLANK    WN0520 15        PFS Seal 2
     C                     MOVEL*BLANK    WN0521 15        PFS Seal 3
     C                     MOVEL*BLANK    WN0522 20        PFS Trailer Num
     C                     MOVEL*BLANK    WN0523  1        PFS Truck Condi
     C                     Z-ADD*ZERO     WN0524  50       PFS Pallets Rec
     C                     Z-ADD*ZERO     WN0525  50       PFS Spacers Loa
     C                     MOVEL*BLANK    WN0526  1        PFS Export USDA
     C                     MOVEL*BLANK    WN0527 12        PFS Recorder ID
     C                     Z-ADD*ZERO     WN0528  80       PFS BOL Complet
     C                     Z-ADD*ZERO     WN0529  60       PFS BOL Complet
     C                     Z-ADD*ZERO     WN0530  80       PFS Actual Depa
     C                     Z-ADD*ZERO     WN0531  60       PFS Actual Depa
     C                     Z-ADD*ZERO     WN0532  50       PFS Pallets Loa
     C                     Z-ADD*ZERO     WN0533  82       PFS Total Palle
     C                     MOVEL*BLANK    WN0534  1        PFS Record Stat
     C                     Z-ADD*ZERO     WN0535  80       PFS Create Date
     C                     Z-ADD*ZERO     WN0536  60       PFS Create Time
     C                     Z-ADD*ZERO     WN0537  80       PFS Change Date
     C                     Z-ADD*ZERO     WN0538  60       PFS Change Time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @BLCPZ7
     C                     Z-ADDWAY1NX    WLY1NX           PFS Company Num
     C                     Z-ADDWAAID8    WLAID8           PFS Transaction
     C                     Z-ADDWAAFTS    WLAFTS           PFS Transaction
     C                     Z-ADDWABCNY    WLBCNY           PFS Transaction
      *
     C           KLCHST    KLIST
     C                     KFLD           WLY1NX           PFS Company Num
     C                     KFLD           WLAID8           PFS Transaction
     C                     KFLD           WLAFTS           PFS Transaction
     C                     KFLD           WLBCNY           PFS Transaction
     C           KLCHST    CHAIN@BLCPZ7              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PPBLCPL0'MDACP
     C                     MOVEL'@BLCPZ7' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO STEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPPBL1    YERDCS
      * Move non-key fields to @BLCPZ7
     C                     Z-ADDWAZGNX    WLZGNX           PFS Load ID
     C                     MOVELWAG9T1    WLG9T1    P      PFS Seal 4
     C                     Z-ADDWN0001    WLUXSX           PFS Process Sta
     C                     MOVELWN0002    WLV3SX    P      PFS Error Reaso
      *
      * Set PGM.*Record Data Changed flag
     C           QPPBL1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Change Stamp      IF
     C                     Z-ADD##JDT     WLAJNY           PFS Change Date
     C                     Z-ADD##JTM     WLAKNY           PFS Change Time
      * Set PGM.*Record Data Changed flag
     C           QPPBL1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@BLCPZ7                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPPBLCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * VALIDATE
      *================================================================
     C                     Z-ADDWAZGNX    WN0003           Load ID
      * ** Override Total Load Miles included in rtv       E00207  8/18/0
      * PFS Rtv Load Header   RT - Load Header  * 
     C                     EXSR SBRVGN
      * CASE: LCL.Record Found USR is Record Not Found
     C           YL0003    IFEQ 'N'                        *IF
     C                     Z-ADD2         WN0001           PFS Process Sta
     C                     MOVEL'LOADNF'  WN0002           PFS Error Reaso
     C                     END                             *FI
      * CASE: PAR.PFS Process Status is Error
     C           WN0001    IFEQ 2                          *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * change log
      *================================================================
      * FP1061
      * TCJ 10/03/07 - Load Order Change Log created if Carrier Code or
      *                Scheduled Delivery Date changes
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAY1NX           PFS Company Num
     C                     Z-ADD*ZERO     WAAID8           PFS Transaction
     C                     Z-ADD*ZERO     WAAFTS           PFS Transaction
     C                     Z-ADD*ZERO     WABCNY           PFS Transaction
     C                     Z-ADD*ZERO     WAZGNX           PFS Load ID
     C                     Z-ADD*ZERO     WAAQNY           PFS Actual Reef
     C                     Z-ADD*ZERO     WABGNY           PFS Actual Prod
     C                     Z-ADD*ZERO     WAARNY           PFS Pallets Rec
     C                     Z-ADD*ZERO     WABFNY           PFS Spacers Loa
     C                     Z-ADD*ZERO     WAAJD8           PFS BOL Complet
     C                     Z-ADD*ZERO     WAAGTS           PFS BOL Complet
     C                     Z-ADD*ZERO     WAAKD8           PFS Actual Depa
     C                     Z-ADD*ZERO     WAAHTS           PFS Actual Depa
     C                     Z-ADD*ZERO     WAASNY           PFS Pallets Loa
     C                     Z-ADD*ZERO     WABHNY           PFS Total Palle
     C                     Z-ADD*ZERO     WAUXSX           PFS Process Sta
     C                     Z-ADD*ZERO     WAAHNY           PFS Create Date
     C                     Z-ADD*ZERO     WAAINY           PFS Create Time
     C                     Z-ADD*ZERO     WAAJNY           PFS Change Date
     C                     Z-ADD*ZERO     WAAKNY           PFS Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WBFLAM           Flat Amount
     C                     Z-ADD*ZERO     WBRRNB           Total Stops
     C                     Z-ADD*ZERO     WBSBNB           BOL Time
     C                     Z-ADD*ZERO     WBSQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBSDNB           Number Pallets
     C                     Z-ADD*ZERO     WBPAOU           Number Pallets
     C                     Z-ADD*ZERO     WBDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WBSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WBHADT           Actual Arrival
     C                     Z-ADD*ZERO     WBAART           Actual Arrival
     C                     Z-ADD*ZERO     WBDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WBDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WBAQDT           Actual Departur
     C                     Z-ADD*ZERO     WBS6NB           Departure Time
     C                     Z-ADD*ZERO     WBT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WBPRTM           Product Tempera
     C                     Z-ADD*ZERO     WBNPSV           Number Spacers
     C                     Z-ADD*ZERO     WBTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WBGRWE           Gross Weight
     C                     Z-ADD*ZERO     WBF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WBJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WBTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WBJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WBSPTM           Spotted Time
     C                     Z-ADD*ZERO     WBJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WBLFTM           Load Finished T
     C                     Z-ADD*ZERO     WBJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WBBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WBJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WBBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WBKIDT           Truck Departure
     C                     Z-ADD*ZERO     WBASTM           Truck Departure
     C                     Z-ADD*ZERO     WBKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WBAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WBVOAG           Voyage
     C                     Z-ADD*ZERO     WBKBDT           Sail Date
     C                     Z-ADD*ZERO     WBEFDT           Arrival Date
     C                     Z-ADD*ZERO     WBKCDT           Date In
     C                     Z-ADD*ZERO     WBTMIN           Time In
     C                     Z-ADD*ZERO     WBKDDT           Date Out
     C                     Z-ADD*ZERO     WBVMNB           Time Out
     C                     Z-ADD*ZERO     WBOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WBKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WBATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WBBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBKKDT           On Yard Date
     C                     Z-ADD*ZERO     WBAVTM           On Yard Time
     C                     Z-ADD*ZERO     WBKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WBAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WBLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WBK0DT           Product Complet
     C                     Z-ADD*ZERO     WBAYTM           Product Complet
     C                     Z-ADD*ZERO     WBKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WBICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WBIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WBK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WBAZTM           Load Door 1
     C                     Z-ADD*ZERO     WBK2DT           Override Total
     C                     Z-ADD*ZERO     WBA0TM           Load Door 2
     C                     Z-ADD*ZERO     WBZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WBPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WBCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WBPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WBCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WBP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WBCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WBP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WBCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WBP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WBCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WBP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WBCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCRUNB           Stop_Drop Seque
     C                     Z-ADD*ZERO     WCRVNB           Stop_Drop
     C                     Z-ADD*ZERO     WCRWNB           Miles to next s
     C                     Z-ADD*ZERO     WCRXNB           Freight Charge
     C                     Z-ADD*ZERO     WCSQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WCT0NB           Freight Misc_Ch
     C                     Z-ADD*ZERO     WCT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WCSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WCKFDT           Appointment Con
     C                     Z-ADD*ZERO     WCACTM           Appointment Con
     C                     Z-ADD*ZERO     WCEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WCAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WCKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WCATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WCHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WCAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WCKKDT           On Yard Date
     C                     Z-ADD*ZERO     WCAVTM           On Yard Time
     C                     Z-ADD*ZERO     WCZ4NB           MPC Number
     C                     Z-ADD*ZERO     WCN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WCN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WCN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WCB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WCB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WCB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDANC7           AR Customer Num
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WDA0DT           Order Date
     C                     Z-ADD*ZERO     WDA5DT           Requested Ship
     C                     Z-ADD*ZERO     WDGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WDACDT           Cancel Date
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDCXDT           Date of Origina
     C                     Z-ADD*ZERO     WDJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WDA1WG           Order Weight To
     C                     Z-ADD*ZERO     WDEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WDAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WDATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WDRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WDT3NB           Attach to Order
     C                     Z-ADD*ZERO     WDCONB           Invoice Number
     C                     Z-ADD*ZERO     WDAWDT           Invoice Date
     C                     Z-ADD*ZERO     WDVRVA           A_R order Value
     C                     Z-ADD*ZERO     WDB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WDNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WDNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WDNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WDNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WDNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WDBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WDBQTM           Time of Origina
     C                     Z-ADD*ZERO     WDBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WDBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WDBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WDH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WDH1NX           Act Non_Ref Frt
     C                     Z-ADD*ZERO     WDH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WDH3NX           OH Total Non_Re
     C                     Z-ADD*ZERO     WDH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WDC0C7           Claim Number
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field Actual Shipped Date
     C                     Z-ADD*ZERO     WUGNDT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFEZNB           Telephone Numbe
     C                     Z-ADD*ZERO     WFEEDT           Carrier Last Us
     C                     Z-ADD*ZERO     WFNRVA           Pallet Balance
     C                     Z-ADD*ZERO     WFNSVA           Long hook balan
     C                     Z-ADD*ZERO     WFNTVA           Short hook bala
     C                     Z-ADD*ZERO     WFNUVA           Tub Balance
     C                     Z-ADD*ZERO     WFS8NB           Home Phone
     C                     Z-ADD*ZERO     WFS9NB           Other Phone
     C                     Z-ADD*ZERO     WFNMVA           Flat Rate
     C                     Z-ADD*ZERO     WFNOVA           Rate Per Pound
     C                     Z-ADD*ZERO     WFNPVA           Unused Rate Per
     C                     Z-ADD*ZERO     WFNQVA           Miscellaneous C
     C                     Z-ADD*ZERO     WFQXNB           Unused Mile Ran
     C                     Z-ADD*ZERO     WFQ1NB           Unused Mile Ran
     C                     Z-ADD*ZERO     WFMRNG           Unused Mile Ran
     C                     Z-ADD*ZERO     WFMRNE           Unused Mile Ran
     C                     Z-ADD*ZERO     WFRFNB           Unused Mile Ran
     C                     Z-ADD*ZERO     WFMREG           Unused Mile Ran
     C                     Z-ADD*ZERO     WFBQPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WFBRPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WFBSPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WFBTPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WFBUPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WFBVPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WFDJWG           Unused Weight R
     C                     Z-ADD*ZERO     WFDKWG           Unused Weight R
     C                     Z-ADD*ZERO     WFDLWG           Unused Weight R
     C                     Z-ADD*ZERO     WFDMWG           Unused Weight R
     C                     Z-ADD*ZERO     WFDNWG           Unused Weight R
     C                     Z-ADD*ZERO     WFDOWG           Unused Weight R
     C                     Z-ADD*ZERO     WFB2PR           Unused Weight R
     C                     Z-ADD*ZERO     WFB3PR           Unused Weight R
     C                     Z-ADD*ZERO     WFB4PR           Unused Weight R
     C                     Z-ADD*ZERO     WFB5PR           Unused Weight R
     C                     Z-ADD*ZERO     WFB6PR           Unused Weight R
     C                     Z-ADD*ZERO     WFB7PR           Unused Weight R
     C                     Z-ADD*ZERO     WFAAC7           Contact Number
     C                     Z-ADD*ZERO     WFTENO           Carrier Unused
     C                     Z-ADD*ZERO     WFAOFC           Amount of Cargo
     C                     Z-ADD*ZERO     WFAOLI           Amount of Liabi
     C                     Z-ADD*ZERO     WFKHDT           Date of Expirat
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGC4NB           Order Number
     C                     Z-ADD*ZERO     WGDPNB           Order Sequence
     C                     Z-ADD*ZERO     WGUENB           Order Secondary
     C                     Z-ADD*ZERO     WGHGCD           Item Code
     C                     Z-ADD*ZERO     WGBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WGCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WGMAVA           Billing Detail
     C                     Z-ADD*ZERO     WGKDVA           Billing Detail
     C                     Z-ADD*ZERO     WGL8VA           Billing Detail
     C                     Z-ADD*ZERO     WGL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WGAYVA           Extended Amount
     C                     Z-ADD*ZERO     WGEXDT           Market Pricing
     C                     Z-ADD*ZERO     WGBZPR           Price Overage O
     C                     Z-ADD*ZERO     WGL6NB           Contract Number
     C                     Z-ADD*ZERO     WGGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WGR1NB           Rated Freight
     C                     Z-ADD*ZERO     WGAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WGD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WGCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WGAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WGCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WGATWG           Weight Shipped
     C                     Z-ADD*ZERO     WGAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WGAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WGAKPR           Unit Price
     C                     Z-ADD*ZERO     WGALPR           Unit Price_Cred
     C                     Z-ADD*ZERO     WGAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WGAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WGA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WGA5DT           Requested Ship
     C                     Z-ADD*ZERO     WGAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WGGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WGRGNB           Item Structure
     C                     Z-ADD*ZERO     WGRHNB           Item Structure
     C                     Z-ADD*ZERO     WGRINB           Item Structure
     C                     Z-ADD*ZERO     WGCXDT           Date of Origina
     C                     Z-ADD*ZERO     WGDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WGB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WGA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WGNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WGNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WGNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WGNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WGNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WGBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WGBVTM           Price Code
     C                     Z-ADD*ZERO     WGBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WGBXTM           Substitution Li
     C                     Z-ADD*ZERO     WGBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WGH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WGH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WGH7NX           OD Item Target
     C                     Z-ADD*ZERO     WGH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WGH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WGDVPR           Order Gate_Fina
     C                     Z-ADD*ZERO     WGDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WGDXPR           OD Gate_Final P
     C                     Z-ADD*ZERO     WGDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WGDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WGGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WGGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WGGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WGPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WGRINY           Item Age Days
     C                     Z-ADD*ZERO     WGTIDT           Production Ovr
     C                     Z-ADD*ZERO     WGTJDT           Production Ovr
     C                     Z-ADD*ZERO     WGTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WGTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WGTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WIBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WIBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WIBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WIBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJPFNX           PT Serial Numbe
     C                     Z-ADD*ZERO     WJAADX           PT Prod Date YY
     C                     Z-ADD*ZERO     WJB9TM           PT Production T
     C                     Z-ADD*ZERO     WJADDX           PT Label Date Y
     C                     Z-ADD*ZERO     WJABDX           PT Offset Prod
     C                     Z-ADD*ZERO     WJCATM           PT Offset Prod
     C                     Z-ADD*ZERO     WJJOWG           PT Net Weight
     C                     Z-ADD*ZERO     WJJPWG           PT Gross Weight
     C                     Z-ADD*ZERO     WJPGNX           PT Order Number
     C                     Z-ADD*ZERO     WJD7C7           PT Product Code
     C                     Z-ADD*ZERO     WJPHNX           PT Tattoo Numbe
     C                     Z-ADD*ZERO     WJUFNX           PT Item Str Cla
     C                     Z-ADD*ZERO     WJUGNX           PT Item Str Gro
     C                     Z-ADD*ZERO     WJUHNX           PT Item Str Typ
     C                     Z-ADD*ZERO     WJAGDX           PT WIP Dump/Pro
     C                     Z-ADD*ZERO     WJCGTM           PT WIP Dump/Pro
     C                     Z-ADD*ZERO     WJUINX           PT From FG Seri
     C                     Z-ADD*ZERO     WJUJNX           PT To FG Serial
     C                     Z-ADD*ZERO     WJUKNX           PT Unused Nbr 3
     C                     Z-ADD*ZERO     WJULNX           PT Unused Nbr 4
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Define work field Blank for 12          USR
     C                     MOVEL*BLANK    WUS3TX 12
      * Define work field Blank 6 USR
     C                     MOVEL*BLANK    WUXKTX  6
     C                     MOVEL'N'       W0PMT   1
      * Define local work field BOL Complete Date
     C                     Z-ADD*ZERO     YL0001  70
      * Define local work field BOL Complete Time
     C                     Z-ADD*ZERO     YL0002  60
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Status - Y or N
     C                     MOVEL*BLANK    YL0004  1
      * Define null work field Ship To Name
     C                     MOVEL*BLANK    YN0001 30
      * Define null work field Ship To City
     C                     MOVEL*BLANK    YN0002 20
      * Define null work field Ship To State Code
     C                     MOVEL*BLANK    YN0003  2
      * Define local work field Total Load Order Weight
     C                     Z-ADD*ZERO     YL0005  70
      * Define local work field Total Freight
     C                     Z-ADD*ZERO     YL0006 112
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0007  1
      * Define local work field USR Warehouse Code
     C                     MOVEL*BLANK    YL0008  3
      * Define local work field Order Changed Y/N
     C                     MOVEL*BLANK    YL0009  4
      * Define local work field Container Number
     C                     MOVEL*BLANK    YL0010 12
      * Define local work field Scheduled Delivery Date
     C                     Z-ADD*ZERO     YL0011  70
      * Define local work field Load Change Type
     C                     MOVEL*BLANK    YL0012  6
      * Define local work field Load Change Type 2
     C                     MOVEL*BLANK    YL0013  6
      * Define local work field Load Change Type 3
     C                     MOVEL*BLANK    YL0014  6
      * Define local work field Load Change Type 4
     C                     MOVEL*BLANK    YL0015  6
      * Define local work field Load Change Type 5
     C                     MOVEL*BLANK    YL0016  6
      * Define local work field TMS LH Field Chg Text
     C                     MOVEL*BLANK    YL0017 35
      * Define local work field Date From Alpha       USR
     C                     MOVEL*BLANK    YL0018  7
      * Define local work field Date To Alpha         USR
     C                     MOVEL*BLANK    YL0019  7
      *================================================================
     CSR         ZZEXIT    ENDSR
