     H/TITLE EDT Cst Srv/Dispatcher E1 Edit record(1 screen)
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Maintain DBF file records, one at a time
     H* - Existing records may be updated or deleted
     H* - Key changes are not allowed
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Edit record(1 screen)
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISSPATI
     H* Date          : 09/11/24  Time  : 08:25:58
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPDTFE1R#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: EDT Cst Srv/Dispatcher E1 Edit record(1 screen)
      *
     FOMFJCPL0IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RTV : Load Header               Retrieval index
      *
     FPMAMREL2IF  E           K        DISK
      * RSQ : Order Header Extension    Load ID/Order#/Co#
      *
     FOMFFREL0IF  E           K        DISK
      * RTV : Carrier Info              Retrieval index
      *
     FOMFLCPL2IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop/Order
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FPDLYREL1IF  E           K        DISK
      * RTV : Trailer Master            Retrieval index
      *
     FOMFLCPL4IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop(Desc)/Order
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOMFJCPMOIF  E           K        DISK
      * RSQ : Load Header               Trailer/Carrier/Load
      *
     FOMFJCPLKIF  E           K        DISK
      * RSQ : Load Header               Carrier/Trailer
      *
     FPDKECPL1IF  E           K        DISK
      * RTV : Traffic Comments          Retrieval index
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FPPBUREL1IF  E           K        DISK
      * RTV : PFS Interface             Retrieval index
      *
     FPDJYREL2IF  E           K        DISK
      * RTV : Company Defaults Internal Active Records
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FPDLYREL0UF  E           K        DISK                      A
      * UPD : Trailer Master            Update index
      *
     FOMFJCPL1UF  E           K        DISK
      * UPD : Load Header               Update index
      *
     E                    #L3         3  1
     E                    J3          3  1
     E                    K3          3  1
      * RIGHT JUSTIFY INPUT FIELD
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    UCT        40  1               CENTER TABLE
      * KEY Screen: Field position and name array
     E                    W0BEG   1 001  5 0A
     E                    W0END   1 001  5 0A
     E                    W0NAM   1 001 10
      * DETAIL Screen: Field position and name array
     E                    W1BEG   7 044  5 0A
     E                    W1END   7 044  5 0A
     E                    W1NAM   7 044 10
      * Long constants
     E                    @CN#    1  08  6   @CN    25
     I@FLCPE8
      * Load Detail               Load/Stop(Desc)/Order
      * Renamed input format fields
     I              FLRMNB                          WARMNB
     I              FLRUNB                          WARUNB
     I              FLRVNB                          WARVNB
     I              FLDQTX                          WADQTX
     I              FLRWNB                          WARWNB
     I              FLRXNB                          WARXNB
     I              FLSQNB                          WASQNB
     I              FLT0NB                          WAT0NB
     I              FLT1NB                          WAT1NB
     I              FLR1NB                          WAR1NB
     I              FLAIC3                          WAAIC3
     I              FLC4NB                          WAC4NB
     I              FLVCST                          WAVCST
     I              FLKEDT                          WAKEDT
     I              FLSXNB                          WASXNB
     I              FLKFDT                          WAKFDT
     I              FLACTM                          WAACTM
     I              FLK5TX                          WAK5TX
     I              FLW5CD                          WAW5CD
     I              FLEJDT                          WAEJDT
     I              FLAGTM                          WAAGTM
     I              FLKJDT                          WAKJDT
     I              FLATTM                          WAATTM
     I              FLHDDT                          WAHDDT
     I              FLAUTM                          WAAUTM
     I              FLKKDT                          WAKKDT
     I              FLAVTM                          WAAVTM
     I              FLZ4NB                          WAZ4NB
     I              FLY7ST                          WAY7ST
     I              FLY2ST                          WAY2ST
     I              FLWHTX                          WAWHTX
     I              FLWITX                          WAWITX
     I              FLWJTX                          WAWJTX
     I              FLWKTX                          WAWKTX
     I              FLWLTX                          WAWLTX
     I              FLN7DT                          WAN7DT
     I              FLN8DT                          WAN8DT
     I              FLN9DT                          WAN9DT
     I              FLB3TM                          WAB3TM
     I              FLB4TM                          WAB4TM
     I              FLB5TM                          WAB5TM
     I              FLIASX                          WAIASX
     I              FLIBSX                          WAIBSX
     I              FLICSX                          WAICSX
     I              FLWVTX                          WAWVTX
     I              FLWWTX                          WAWWTX
     I              FLWXTX                          WAWXTX
     I              FLUVST                          WAUVST
     I              FLUWST                          WAUWST
     I              FLUXST                          WAUXST
     I              FLAATM                          WAAATM
     I              FLAYNA                          WAAYNA
     I              FLA0NA                          WAA0NA
     I              FLAXDT                          WAAXDT
      *
     I@FJCPMJ
      * Load Header               Trailer/Carrier/Load
      * Renamed input format fields
     I              FJRMNB                          WBRMNB
     I              FJAIC3                          WBAIC3
     I              FJAODT                          WBAODT
     I              FJPJST                          WBPJST
     I              FJPKST                          WBPKST
     I              FJRNNB                          WBRNNB
     I              FJDMTX                          WBDMTX
     I              FJDNTX                          WBDNTX
     I              FJDOTX                          WBDOTX
     I              FJWTTX                          WBWTTX
     I              FJWUTX                          WBWUTX
     I              FJRPNB                          WBRPNB
     I              FJFLAM                          WBFLAM
     I              FJXQST                          WBXQST
     I              FJRRNB                          WBRRNB
     I              FJDXTX                          WBDXTX
     I              FJDYTX                          WBDYTX
     I              FJSBNB                          WBSBNB
     I              FJBZNA                          WBBZNA
     I              FJRONB                          WBRONB
     I              FJSQNB                          WBSQNB
     I              FJR1NB                          WBR1NB
     I              FJVCST                          WBVCST
     I              FJVDST                          WBVDST
     I              FJSDNB                          WBSDNB
     I              FJPAOU                          WBPAOU
     I              FJDGWG                          WBDGWG
     I              FJSXNB                          WBSXNB
     I              FJHADT                          WBHADT
     I              FJAART                          WBAART
     I              FJDHWG                          WBDHWG
     I              FJDIWG                          WBDIWG
     I              FJAQDT                          WBAQDT
     I              FJS6NB                          WBS6NB
     I              FJT4NB                          WBT4NB
     I              FJPRTM                          WBPRTM
     I              FJNPSV                          WBNPSV
     I              FJJ8TX                          WBJ8TX
     I              FJTLMI                          WBTLMI
     I              FJJ9TX                          WBJ9TX
     I              FJQ2CD                          WBQ2CD
     I              FJVPCD                          WBVPCD
     I              FJDBCD                          WBDBCD
     I              FJGRWE                          WBGRWE
     I              FJXCCD                          WBXCCD
     I              FJU2ST                          WBU2ST
     I              FJF9DT                          WBF9DT
     I              FJONTM                          WBONTM
     I              FJJ4DT                          WBJ4DT
     I              FJTRTM                          WBTRTM
     I              FJJ5DT                          WBJ5DT
     I              FJSPTM                          WBSPTM
     I              FJJ6DT                          WBJ6DT
     I              FJLFTM                          WBLFTM
     I              FJJ7DT                          WBJ7DT
     I              FJBOTM                          WBBOTM
     I              FJJ8DT                          WBJ8DT
     I              FJBLTM                          WBBLTM
     I              FJKIDT                          WBKIDT
     I              FJASTM                          WBASTM
     I              FJKADT                          WBKADT
     I              FJAJCM                          WBAJCM
     I              FJXACD                          WBXACD
     I              FJOANA                          WBOANA
     I              FJK4TX                          WBK4TX
     I              FJVOAG                          WBVOAG
     I              FJKBDT                          WBKBDT
     I              FJNBBO                          WBNBBO
     I              FJW4CD                          WBW4CD
     I              FJEFDT                          WBEFDT
     I              FJCNTN                          WBCNTN
     I              FJKCDT                          WBKCDT
     I              FJTMIN                          WBTMIN
     I              FJKDDT                          WBKDDT
     I              FJVMNB                          WBVMNB
     I              FJOCFR                          WBOCFR
     I              FJKJDT                          WBKJDT
     I              FJATTM                          WBATTM
     I              FJOTRS                          WBOTRS
     I              FJRNST                          WBRNST
     I              FJBRBK                          WBBRBK
     I              FJEIDT                          WBEIDT
     I              FJRMST                          WBRMST
     I              FJAJCD                          WBAJCD
     I              FJKKDT                          WBKKDT
     I              FJAVTM                          WBAVTM
     I              FJKZDT                          WBKZDT
     I              FJAXTM                          WBAXTM
     I              FJLHOS                          WBLHOS
     I              FJLHOR                          WBLHOR
     I              FJWNTX                          WBWNTX
     I              FJOITX                          WBOITX
     I              FJOJTX                          WBOJTX
     I              FJLLDT                          WBLLDT
     I              FJLSHG                          WBLSHG
     I              FJYPST                          WBYPST
     I              FJK0DT                          WBK0DT
     I              FJAYTM                          WBAYTM
     I              FJKNNX                          WBKNNX
     I              FJICWG                          WBICWG
     I              FJIDWG                          WBIDWG
     I              FJH9SX                          WBH9SX
     I              FJWOTX                          WBWOTX
     I              FJK1DT                          WBK1DT
     I              FJAZTM                          WBAZTM
     I              FJK2DT                          WBK2DT
     I              FJA0TM                          WBA0TM
     I              FJROST                          WBROST
     I              FJRPST                          WBRPST
     I              FJRQST                          WBRQST
     I              FJRRST                          WBRRST
     I              FJZBVA                          WBZBVA
     I              FJWPTX                          WBWPTX
     I              FJWQTX                          WBWQTX
     I              FJWRTX                          WBWRTX
     I              FJWSTX                          WBWSTX
     I              FJRVSX                          WBRVSX
     I              FJRUSX                          WBRUSX
     I              FJRWSX                          WBRWSX
     I              FJRXSX                          WBRXSX
     I              FJRYSX                          WBRYSX
     I              FJRZSX                          WBRZSX
     I              FJR0SX                          WBR0SX
     I              FJR1SX                          WBR1SX
     I              FJR2SX                          WBR2SX
     I              FJR3SX                          WBR3SX
     I              FJR4SX                          WBR4SX
     I              FJPYDT                          WBPYDT
     I              FJCKTM                          WBCKTM
     I              FJPZDT                          WBPZDT
     I              FJCLTM                          WBCLTM
     I              FJP0DT                          WBP0DT
     I              FJCMTM                          WBCMTM
     I              FJP1DT                          WBP1DT
     I              FJCNTM                          WBCNTM
     I              FJP2DT                          WBP2DT
     I              FJCOTM                          WBCOTM
     I              FJP3DT                          WBP3DT
     I              FJCQTM                          WBCQTM
     I              FJUVST                          WBUVST
     I              FJUWST                          WBUWST
     I              FJUXST                          WBUXST
     I              FJAATM                          WBAATM
     I              FJAYNA                          WBAYNA
     I              FJA0NA                          WBA0NA
     I              FJAXDT                          WBAXDT
      *
     I@FJCPR4
      * Load Header               Carrier/Trailer
      * Renamed input format fields
     I              FJRMNB                          WCRMNB
     I              FJAIC3                          WCAIC3
     I              FJAODT                          WCAODT
     I              FJPJST                          WCPJST
     I              FJPKST                          WCPKST
     I              FJRNNB                          WCRNNB
     I              FJDMTX                          WCDMTX
     I              FJDNTX                          WCDNTX
     I              FJDOTX                          WCDOTX
     I              FJWTTX                          WCWTTX
     I              FJWUTX                          WCWUTX
     I              FJRPNB                          WCRPNB
     I              FJFLAM                          WCFLAM
     I              FJXQST                          WCXQST
     I              FJRRNB                          WCRRNB
     I              FJDXTX                          WCDXTX
     I              FJDYTX                          WCDYTX
     I              FJSBNB                          WCSBNB
     I              FJBZNA                          WCBZNA
     I              FJRONB                          WCRONB
     I              FJSQNB                          WCSQNB
     I              FJR1NB                          WCR1NB
     I              FJVCST                          WCVCST
     I              FJVDST                          WCVDST
     I              FJSDNB                          WCSDNB
     I              FJPAOU                          WCPAOU
     I              FJDGWG                          WCDGWG
     I              FJSXNB                          WCSXNB
     I              FJHADT                          WCHADT
     I              FJAART                          WCAART
     I              FJDHWG                          WCDHWG
     I              FJDIWG                          WCDIWG
     I              FJAQDT                          WCAQDT
     I              FJS6NB                          WCS6NB
     I              FJT4NB                          WCT4NB
     I              FJPRTM                          WCPRTM
     I              FJNPSV                          WCNPSV
     I              FJJ8TX                          WCJ8TX
     I              FJTLMI                          WCTLMI
     I              FJJ9TX                          WCJ9TX
     I              FJQ2CD                          WCQ2CD
     I              FJVPCD                          WCVPCD
     I              FJDBCD                          WCDBCD
     I              FJGRWE                          WCGRWE
     I              FJXCCD                          WCXCCD
     I              FJU2ST                          WCU2ST
     I              FJF9DT                          WCF9DT
     I              FJONTM                          WCONTM
     I              FJJ4DT                          WCJ4DT
     I              FJTRTM                          WCTRTM
     I              FJJ5DT                          WCJ5DT
     I              FJSPTM                          WCSPTM
     I              FJJ6DT                          WCJ6DT
     I              FJLFTM                          WCLFTM
     I              FJJ7DT                          WCJ7DT
     I              FJBOTM                          WCBOTM
     I              FJJ8DT                          WCJ8DT
     I              FJBLTM                          WCBLTM
     I              FJKIDT                          WCKIDT
     I              FJASTM                          WCASTM
     I              FJKADT                          WCKADT
     I              FJAJCM                          WCAJCM
     I              FJXACD                          WCXACD
     I              FJOANA                          WCOANA
     I              FJK4TX                          WCK4TX
     I              FJVOAG                          WCVOAG
     I              FJKBDT                          WCKBDT
     I              FJNBBO                          WCNBBO
     I              FJW4CD                          WCW4CD
     I              FJEFDT                          WCEFDT
     I              FJCNTN                          WCCNTN
     I              FJKCDT                          WCKCDT
     I              FJTMIN                          WCTMIN
     I              FJKDDT                          WCKDDT
     I              FJVMNB                          WCVMNB
     I              FJOCFR                          WCOCFR
     I              FJKJDT                          WCKJDT
     I              FJATTM                          WCATTM
     I              FJOTRS                          WCOTRS
     I              FJRNST                          WCRNST
     I              FJBRBK                          WCBRBK
     I              FJEIDT                          WCEIDT
     I              FJRMST                          WCRMST
     I              FJAJCD                          WCAJCD
     I              FJKKDT                          WCKKDT
     I              FJAVTM                          WCAVTM
     I              FJKZDT                          WCKZDT
     I              FJAXTM                          WCAXTM
     I              FJLHOS                          WCLHOS
     I              FJLHOR                          WCLHOR
     I              FJWNTX                          WCWNTX
     I              FJOITX                          WCOITX
     I              FJOJTX                          WCOJTX
     I              FJLLDT                          WCLLDT
     I              FJLSHG                          WCLSHG
     I              FJYPST                          WCYPST
     I              FJK0DT                          WCK0DT
     I              FJAYTM                          WCAYTM
     I              FJKNNX                          WCKNNX
     I              FJICWG                          WCICWG
     I              FJIDWG                          WCIDWG
     I              FJH9SX                          WCH9SX
     I              FJWOTX                          WCWOTX
     I              FJK1DT                          WCK1DT
     I              FJAZTM                          WCAZTM
     I              FJK2DT                          WCK2DT
     I              FJA0TM                          WCA0TM
     I              FJROST                          WCROST
     I              FJRPST                          WCRPST
     I              FJRQST                          WCRQST
     I              FJRRST                          WCRRST
     I              FJZBVA                          WCZBVA
     I              FJWPTX                          WCWPTX
     I              FJWQTX                          WCWQTX
     I              FJWRTX                          WCWRTX
     I              FJWSTX                          WCWSTX
     I              FJRVSX                          WCRVSX
     I              FJRUSX                          WCRUSX
     I              FJRWSX                          WCRWSX
     I              FJRXSX                          WCRXSX
     I              FJRYSX                          WCRYSX
     I              FJRZSX                          WCRZSX
     I              FJR0SX                          WCR0SX
     I              FJR1SX                          WCR1SX
     I              FJR2SX                          WCR2SX
     I              FJR3SX                          WCR3SX
     I              FJR4SX                          WCR4SX
     I              FJPYDT                          WCPYDT
     I              FJCKTM                          WCCKTM
     I              FJPZDT                          WCPZDT
     I              FJCLTM                          WCCLTM
     I              FJP0DT                          WCP0DT
     I              FJCMTM                          WCCMTM
     I              FJP1DT                          WCP1DT
     I              FJCNTM                          WCCNTM
     I              FJP2DT                          WCP2DT
     I              FJCOTM                          WCCOTM
     I              FJP3DT                          WCP3DT
     I              FJCQTM                          WCCQTM
     I              FJUVST                          WCUVST
     I              FJUWST                          WCUWST
     I              FJUXST                          WCUXST
     I              FJAATM                          WCAATM
     I              FJAYNA                          WCAYNA
     I              FJA0NA                          WCA0NA
     I              FJAXDT                          WCAXDT
      *
     I@LYRER2
      * Trailer Master            Update index
      * Renamed input format fields
     I              LYBZNA                          WDBZNA
     I              LYDXTX                          WDDXTX
     I              LYAIC3                          WDAIC3
     I              LYVDST                          WDVDST
     I              LYX3ST                          WDX3ST
     I              LYXGST                          WDXGST
     I              LYSTOY                          WDSTOY
     I              LYKKDT                          WDKKDT
     I              LYAVTM                          WDAVTM
     I              LYSTAS                          WDSTAS
     I              LYXRST                          WDXRST
     I              LYX7CD                          WDX7CD
     I              LYGXTX                          WDGXTX
     I              LYXTST                          WDXTST
     I              LYXVST                          WDXVST
     I              LYSTU3                          WDSTU3
     I              LYSTU4                          WDSTU4
     I              LYSTU5                          WDSTU5
     I              LYLCDT                          WDLCDT
     I              LYLDDT                          WDLDDT
     I              LYLEDT                          WDLEDT
     I              LYLFDT                          WDLFDT
     I              LYLGDT                          WDLGDT
     I              LYUVST                          WDUVST
     I              LYUWST                          WDUWST
     I              LYUXST                          WDUXST
     I              LYVSST                          WDVSST
     I              LYAATM                          WDAATM
     I              LYAYNA                          WDAYNA
     I              LYA0NA                          WDA0NA
     I              LYAXDT                          WDAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     I@1DBRC    E DSOMFJCPL1
      * UPD : Load Header               Update index
      * Current/previous master file format fields for change control
      *
     I#1DBRC      DS                            793
      * Stored master file format fields
     I                                        1   1 #1DB1
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
      * Outward parameters
     IPARC        DS                             23
      * KEY : Trailer Master            Retrieval index
      * I :  Carrier Code
     I                                        1   3 PABZNA
      * I :  Trailer Id
     I                                        4  23 PADXTX
      *
      * Outward parameters
     IPBRC        DS                             82
      * RCD : Load Order Change Log     Retrieval index
      * N :  Sequence Number
     I                                    P   9  100PBDXNB
      * I :  Load ID
     I                                    P  11  140PBRMNB
      * I :  Stop_Drop
     I                                    P  15  170PBRVNB
      * I :  Load Change Type
     I                                       18  23 PBRVST
      * I :  Department Control Code
     I                                       24  26 PBUJST
      * I :  Change Log Prior Value
     I                                       27  38 PBMNTX
      * I :  Change Log New Value
     I                                       39  50 PBMOTX
      * I :  User Id
     I                                       51  60 PBAYNA
      * I :  Job Name
     I                                       61  70 PBA0NA
      * I :  Carrier Code
     I                                       71  73 PBBZNA
      * N :  Carrier Broker Carrier Co
     I                                       74  76 PBXMCD
      * I :  Company Number
     I                                    P  77  780PBAIC3
      * I :  Order Number
     I                                    P  79  820PBC4NB
      *
     IQPDLY1    E DSPDLYREL0
      * UPD : Trailer Master            Update index
      * Renamed input format fields
     I              LYBZNA                          WDBZNA
     I              LYDXTX                          WDDXTX
     I              LYAIC3                          WDAIC3
     I              LYVDST                          WDVDST
     I              LYX3ST                          WDX3ST
     I              LYXGST                          WDXGST
     I              LYSTOY                          WDSTOY
     I              LYKKDT                          WDKKDT
     I              LYAVTM                          WDAVTM
     I              LYSTAS                          WDSTAS
     I              LYXRST                          WDXRST
     I              LYX7CD                          WDX7CD
     I              LYGXTX                          WDGXTX
     I              LYXTST                          WDXTST
     I              LYXVST                          WDXVST
     I              LYSTU3                          WDSTU3
     I              LYSTU4                          WDSTU4
     I              LYSTU5                          WDSTU5
     I              LYLCDT                          WDLCDT
     I              LYLDDT                          WDLDDT
     I              LYLEDT                          WDLEDT
     I              LYLFDT                          WDLFDT
     I              LYLGDT                          WDLGDT
     I              LYUVST                          WDUVST
     I              LYUWST                          WDUWST
     I              LYUXST                          WDUXST
     I              LYVSST                          WDVSST
     I              LYAATM                          WDAATM
     I              LYAYNA                          WDAYNA
     I              LYA0NA                          WDA0NA
     I              LYAXDT                          WDAXDT
      *
     IYARDCS      DS                            129
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IYBRDCS      DS                            793
     IYCRDCS      DS                            129
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Load Header
      * B : RST Load ID
     I                                    P   1   40P1RMNB
      * B :  Company Number
     I                                    P   5   60P1AIC3
      * N :  On Yard Date
     I                                    P   7  100P1KKDT
      * N :  On Yard Time
     I                                    P  11  140P1AVTM
     IP2PARM      DS
      * FLD: Trailer Master
      * N :  Trailer Type
     I                                        1   1 P2X3ST
      * N :  Seaboard Owned Status
     I                                        2   2 P2XGST
      * N :  On Yard Status
     I                                        3   3 P2STOY
      * N :  Assigned Status
     I                                        4   4 P2STAS
      * N :  Available Status
     I                                        5   5 P2XRST
      * N :  Not Available Reason Code
     I                                        6   8 P2X7CD
      * N :  Comment Line
     I                                        9  38 P2GXTX
      * N :  Record Status
     I                                       39  39 P2VSST
     IP3PARM      DS
      * FLD: *Arrays
      * O :  USR Exit Program
     I                                        1   1 P3STYN
      * B :  Flag 2
     I                                        2   5 P3NGST
      * N :  USR Trailer Output Only
     I                                        6   6 P3ZGST
      * N :  USR Flag 1
     I                                        7   7 P3D4ST
      * I :  Warehouse Specific Usr
     I                                        8   8 P3PRTX
     IP4PARM      DS
      * FLD: *Arrays
      * N :  Warehouse Code
     I                                        1   3 P4AJCD
      * N :  Salesperson Code
     I                                        4   6 P4BCCD
      * N :  User Profile Name
     I                                        7  16 P4AJVN
      * N :  Allow Multi_Company
     I                                       17  17 P4I6ST
      * N :  Default Printer
     I                                       18  27 P4MPNA
     IP5PARM      DS
      * N :  Current System Date
     I                                    P   1   85P5SDTE
     IP6PARM      DS
      * FLD: *Arrays
      * N :  PRT Description
     I                                        1  25 P6G3TX
      * N :  PRT Printer Device
     I                                       26  35 P6WRST
      * N :  PRT Hold Output Sts
     I                                       36  39 P6WSST
      * N :  PRT Save Output Sts
     I                                       40  43 P6WTST
      * N :  PRT Number of Copies
     I                                       44  450P6DYNB
      * N :  PRT Night Queue Run Sts
     I                                       46  46 P6WUST
      * N :  PRT Night Queue
     I                                       47  56 P6BVVN
      * N :  Company Number Pass   USR
     I                                    P  57  645P6AJAA
      * N :  Date 1          PASS  USR
     I                                    P  65  725P6AJAB
      * N :  Order Number 1  PASS  USR
     I                                    P  73  805P6AJAE
      * N :  System Value Numeric
     I                                    P  81  885P6M8NB
      * N :  Status - Y or N
     I                                       89  89 P6B8ST
      * N :  Change Flag USR
     I                                       90  90 P6HWSX
     IP7PARM      DS
      * FLD: *Arrays
      * N :  Status Flag 1  Y/N
     I                                        1   1 P7Q1ST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Access Denied: Co    INF'
      * Condition Name 10 USR
     I                                        1  10 ZA0001
      * Company Number CDE
     I                                    P  11  120ZA0002
      * Message data for 'Warehouse Code Required'
      * Warehouse Code
     I                                        1   3 ZA0003
      * Message data for 'Access Denied: Warehouse'
      * User Profile Name
     I                                        1  10 ZA0004
      * Warehouse Code
     I                                       11  13 ZA0005
      * Message data for 'Warehouse Codes        NF'
      * Warehouse Code
     I                                        1   3 ZA0006
      * Message data for 'CD3 Non numeric data'
      * Message data for 'Access Denied: Company'
      * Condition Name 10 USR
     I                                        1  10 ZA0007
      * Company Number CDE
     I                                    P  11  120ZA0008
      * Message data for 'OM Load Header not found'
      * Load ID
     I                                    P   1   40ZA0009
      * Message data for 'Truck Ready Time/Date'
      * Truck Ready Date
     I                                    P   1   40ZA0010
      * USR Ready Time
     I                                    P   5   70ZA0011
      * Message data for 'Door Required'
      * Load Door 1 USR
     I                                    P   1   20ZA0012
      * Message data for 'Time field minutes GT 59'
      * Requested Delivery Time
     I                                    P   1   30ZA0013
      * Message data for 'Time field minutes GT 59'
      * Requested Delivery Time
     I                                    P   1   30ZA0014
      * Message data for 'Time field minutes GT 59'
      * Requested Delivery Time
     I                                    P   1   30ZA0015
      * Message data for 'Time field minutes GT 59'
      * Requested Delivery Time
     I                                    P   1   30ZA0016
      * Message data for 'Time field minutes GT 59'
      * Requested Delivery Time
     I                                    P   1   30ZA0017
      * Message data for 'Time field minutes GT 59'
      * Requested Delivery Time
     I                                    P   1   30ZA0018
      * Message data for 'Time field minutes GT 59'
      * Requested Delivery Time
     I                                    P   1   30ZA0019
      * Message data for 'Time field minutes GT 59'
      * Requested Delivery Time
     I                                    P   1   30ZA0020
      * Message data for 'Trailer is assigned...'
      * Load ID
     I                                    P   1   40ZA0021
      * Message data for 'Trailer is assigned...'
      * Load ID
     I                                    P   1   40ZA0022
      * Message data for 'Carrier req to enter trlr'
      * Carrier Code
     I                                        1   3 ZA0023
      * Message data for 'Trailer Co#<>Ld Str Co#'
      * Trailer ID USR
     I                                        1  12 ZA0024
      * Message data for 'Load type must match load'
      * Load Type
     I                                        1   1 ZA0025
      * USR Load Type
     I                                        2   2 ZA0026
      * Trailer ID USR
     I                                        3  14 ZA0027
      * Message data for 'Trailer is already assgnd'
      * Trailer ID USR
     I                                        1  12 ZA0028
      * USR Load Assigned
     I                                    P  13  160ZA0029
      * Message data for 'Trail dprting is assignd'
      * Trailer ID USR
     I                                        1  12 ZA0030
      * USR Load Assigned
     I                                    P  13  160ZA0031
      * Message data for 'Trailer is not On Yard.'
      * Trailer ID USR
     I                                        1  12 ZA0032
      * Message data for 'Trailer is not Available.'
      * Trailer ID USR
     I                                        1  12 ZA0033
      * Message data for 'Trailer is Sbd owned.'
      * Trailer ID USR
     I                                        1  12 ZA0034
      * Message data for 'Previous date/time not e'
      * Date To               USR
     I                                    P   1   40ZA0035
      * Time
     I                                    P   5   80ZA0036
      * Message data for 'Invalid date/time entries'
      * Date To               USR
     I                                    P   1   40ZA0037
      * Time
     I                                    P   5   80ZA0038
      * Message data for 'Invalid date/time entries'
      * Date To               USR
     I                                    P   1   40ZA0039
      * Time
     I                                    P   5   80ZA0040
      * Message data for 'Traffic Comments Required'
      * Date From             USR
     I                                    P   1   40ZA0041
      * Message data for 'Previous date/time not e'
      * Date To               USR
     I                                    P   1   40ZA0042
      * Time
     I                                    P   5   80ZA0043
      * Message data for 'Invalid date/time entries'
      * Date To               USR
     I                                    P   1   40ZA0044
      * Time
     I                                    P   5   80ZA0045
      * Message data for 'Time Required'
      * @Time 4.0
     I                                    P   1   30ZA0046
      * Message data for 'Invalid date/time entries'
      * Date To               USR
     I                                    P   1   40ZA0047
      * Time
     I                                    P   5   80ZA0048
      * Message data for 'Previous date/time not e'
      * Date To               USR
     I                                    P   1   40ZA0049
      * Time
     I                                    P   5   80ZA0050
      * Message data for 'Invalid date/time entries'
      * Date To               USR
     I                                    P   1   40ZA0051
      * Time
     I                                    P   5   80ZA0052
      * Message data for 'Invalid date/time entries'
      * Date To               USR
     I                                    P   1   40ZA0053
      * Time
     I                                    P   5   80ZA0054
      * Message data for 'Previous date/time not e'
      * Date To               USR
     I                                    P   1   40ZA0055
      * Time
     I                                    P   5   80ZA0056
      * Message data for 'Invalid date/time entries'
      * Date To               USR
     I                                    P   1   40ZA0057
      * Time
     I                                    P   5   80ZA0058
      * Message data for 'Invalid date/time entries'
      * Date To               USR
     I                                    P   1   40ZA0059
      * Time
     I                                    P   5   80ZA0060
      * Message data for 'Previous date/time not e'
      * Date To               USR
     I                                    P   1   40ZA0061
      * Time
     I                                    P   5   80ZA0062
      * Message data for 'Invalid date/time entries'
      * Date To               USR
     I                                    P   1   40ZA0063
      * Time
     I                                    P   5   80ZA0064
      * Message data for 'Invalid date/time entries'
      * Date To               USR
     I                                    P   1   40ZA0065
      * Time
     I                                    P   5   80ZA0066
      * Message data for 'Previous date/time not e'
      * Date To               USR
     I                                    P   1   40ZA0067
      * Time
     I                                    P   5   80ZA0068
      * Message data for 'Invalid date/time entries'
      * Date To               USR
     I                                    P   1   40ZA0069
      * Time
     I                                    P   5   80ZA0070
      * Message data for 'Invalid date/time entries'
      * Date To               USR
     I                                    P   1   40ZA0071
      * Time
     I                                    P   5   80ZA0072
      * Message data for 'Previous date/time not e'
      * Date To               USR
     I                                    P   1   40ZA0073
      * Time
     I                                    P   5   80ZA0074
      * Message data for 'Invalid date/time entries'
      * Date To               USR
     I                                    P   1   40ZA0075
      * Time
     I                                    P   5   80ZA0076
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0077
      * Application Code
     I                                       11  16 ZA0078
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0079
      * Application Code
     I                                       11  16 ZA0080
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1RMNB    PARM P1RMNB    WP0001  70       Load ID
     C           P1AIC3    PARM P1AIC3    WP0002  30       Company Number
     C                     PARM P3STYN    WP0003  1        USR Exit Progra
     C           P3NGST    PARM P3NGST    WP0004  4        Flag 2
     C           P3PRTX    PARM           WP0005  1        Warehouse Speci
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Check passed parameters
     C                     EXSR FACKPM
      * Perform once if all passed, else repeat
     C           W0RPT     DOUEQ'N'
      * Display and process key screen
     C                     EXSR BADSKY
     C                     END
      * Terminate program
     C                     EXSR ZXEXPG
      *****************************************************************
      /EJECT
     CSR         BADSKY    BEGSR
      *================================================================
      * Display and process key screen
      *================================================================
      * Bypass first display of key screen is possible
     C                     MOVEL'Y'       W0BYP   1
      * Initialize key screen
     C                     EXSR MDIZ#K
      * Signal start of transaction
     C                     MOVEL'Y'       W0TRN   1
     C           W0TRN     DOWEQ'Y'
     C           W0TRN     OREQ 'K'
      * Ensure transaction continues (if reset)
     C                     MOVEL'Y'       W0TRN   1
      * Conduct screen conversation
     C           W0TRN     DOWEQ'Y'
      * Is bypass key screen still viable?
     C           W0BYP     IFEQ 'Y'
     C           #1RMNB    IFEQ *ZERO                      Load ID
      * One or more key fields is blank
     C           *IN30     OREQ '1'
      * HOME: Reset screen fields
     C                     MOVEL'N'       W0BYP
     C                     END
     C                     END
      * Bypass key screen
     C           W0BYP     IFEQ 'N'
      * Display key screen
     C                     EXSR BBEXFM
     C                     END
      * Cancel key screen bypass
     C                     MOVEL'N'       W0BYP
      * Process response to key screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            BDHMKY
      * Process key screen input
     C                     CAS            BEPRKY
     C                     END
     C           W0TRN     DOWEQ'R'
     C                     MOVEL'Y'       W0TRN
     C                     EXSR BEPRKY
     C                     END
      *
     C                     END
     C                     END
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBEXFM    BEGSR
      *================================================================
      * Display key screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSAK
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
     C                     MOVEL'K'       W0GRP   1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDKEY
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1
      * Reset global error indicator
     C                     SETOF                         99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         BDHMKY    BEGSR
      *================================================================
      * Process HOME key
      *================================================================
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         BDEXIT    ENDSR
      /EJECT
     CSR         BEPRKY    BEGSR
      *================================================================
      * Process key screen input
      *================================================================
      * Initialise detail screen
     C                     EXSR MAIZ#1
      * Validate key fields
     C                     EXSR BFVLKY
     C           *IN99     CABEQ'1'       BEEXIT
     C           YPMTFD    CABNE*BLANKS   BEEXIT
      * Check for existing record
     C           KRTV      KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    FJRMNB
     C           KRTV      CHAIN@FJCPBN              9091  *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     SETON                     9931  *
     C                     GOTO BEEXIT
     C                     END                             FI 91
      *
      * If record does not exist, error
     C           *IN90     IFEQ '1'
     C                     SETON                     9931  *
      * Send message 'Load Header            NF'
     C                     MOVEL'USR1188' ZAMSID
     C                     EXSR ZASNMS
     C                     ELSE
     C                     EXSR MBFL#1
      * USER: Initialize detail screen (existing record)
      * DTL = DB1 By name
     C                     MOVELFJBZNA    #1BZNA           Carrier Code
     C                     Z-ADDFJRMNB    #1RMNB           Load ID
     C                     MOVELFJPJST    #1PJST           LTL Flag
     C                     MOVELFJPKST    #1PKST           Load Status
     C                     Z-ADDFJRNNB    #1RNNB           Reefer Temperat
     C                     MOVELFJDMTX    #1DMTX           Seal 1
     C                     MOVELFJDNTX    #1DNTX           Seal 2
     C                     MOVELFJDOTX    #1DOTX           Seal 3
     C                     MOVELFJWTTX    #1WTTX           Seal 4
     C                     MOVELFJWUTX    #1WUTX           Seal 2 Unused
     C                     Z-ADDFJRPNB    #1RPNB           Total Load Orde
     C                     Z-ADDFJFLAM    #1FLAM           Flat Amount
     C                     MOVELFJXQST    #1XQST           Allocate Pounds
     C                     Z-ADDFJRRNB    #1RRNB           Total Stops
     C                     MOVELFJDXTX    #1DXTX           Trailer Id
     C                     MOVELFJDBCD    #1DBCD           Ship To State C
     C                     Z-ADDFJAIC3    #1AIC3           Company Number
     C                     Z-ADDFJT4NB    #1T4NB           Schedule Sequen
     C                     Z-ADDFJAODT    #1AODT           Scheduled Ship
     C                     MOVELFJQ2CD    #1Q2CD           Shipping Method
     C                     Z-ADDFJF9DT    #1F9DT           Actual Ship Dat
     C                     Z-ADDFJP1DT    #1P1DT           TPM Planned Shi
     C                     MOVELFJDYTX    #1DYTX           Transloader Car
     C                     MOVELFJRONB    #1RONB           Truck Size
     C                     Z-ADDFJSQNB    #1SQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADDFJR1NB    #1R1NB           Rated Freight
     C                     MOVELFJVCST    #1VCST           Ship Status
     C                     MOVELFJVDST    #1VDST           Load Type
     C                     Z-ADDFJSDNB    #1SDNB           Number Pallets
     C                     Z-ADDFJPAOU    #1PAOU           Number Pallets
     C                     Z-ADDFJDGWG    #1DGWG           Load Carrier Pa
     C                     Z-ADDFJSXNB    #1SXNB           Estimated Arriv
     C                     Z-ADDFJHADT    #1HADT           Actual Arrival
     C                     Z-ADDFJAART    #1AART           Actual Arrival
     C                     Z-ADDFJDHWG    #1DHWG           Trailer IN Weig
     C                     Z-ADDFJDIWG    #1DIWG           Trailer OUT Wei
     C                     Z-ADDFJAQDT    #1AQDT           Actual Departur
     C                     Z-ADDFJPRTM    #1PRTM           Product Tempera
     C                     Z-ADDFJNPSV    #1NPSV           Number Spacers
     C                     MOVELFJJ8TX    #1J8TX           Car_Veh_Initial
     C                     Z-ADDFJTLMI    #1TLMI           Total Load Mile
     C                     MOVELFJJ9TX    #1J9TX           Recorder ID
     C                     MOVELFJLSHG    #1LSHG           Load Shag Flag
     C                     MOVELFJYPST    #1YPST           Load Wash Flag
     C                     MOVELFJVPCD    #1VPCD           Ship From Wareh
     C                     Z-ADDFJKZDT    #1KZDT           Deadline Depart
     C                     Z-ADDFJGRWE    #1GRWE           Gross Weight
     C                     MOVELFJXCCD    #1XCCD           Carrier Broker
     C                     MOVELFJU2ST    #1U2ST           Export Status
     C                     MOVELFJONTM    #1ONTM           On Time_Y_N
     C                     MOVELFJK4TX    #1K4TX           Vessel Name
     C                     Z-ADDFJVOAG    #1VOAG           Voyage
     C                     Z-ADDFJKBDT    #1KBDT           Sail Date
     C                     MOVELFJNBBO    #1NBBO           Booking Number
     C                     MOVELFJW4CD    #1W4CD           Discharge Port
     C                     Z-ADDFJEFDT    #1EFDT           Arrival Date
     C                     MOVELFJCNTN    #1CNTN           Container Numbe
     C                     Z-ADDFJKCDT    #1KCDT           Date In
     C                     Z-ADDFJTMIN    #1TMIN           Time In
     C                     Z-ADDFJKDDT    #1KDDT           Date Out
     C                     Z-ADDFJVMNB    #1VMNB           Time Out
     C                     Z-ADDFJOCFR    #1OCFR           Load Total Frei
     C                     Z-ADDFJKJDT    #1KJDT           Scheduled Deliv
     C                     Z-ADDFJATTM    #1ATTM           Scheduled Deliv
     C                     MOVELFJOTRS    #1OTRS           LH Unused Sts
     C                     MOVELFJRNST    #1RNST           LH Carrier Paym
     C                     Z-ADDFJBRBK    #1BRBK           Bring Back Mile
     C                     Z-ADDFJEIDT    #1EIDT           Requested Deliv
     C                     MOVELFJRMST    #1RMST           Load Acceptance
     C                     MOVELFJAJCD    #1AJCD           Warehouse Code
     C                     Z-ADDFJAXTM    #1AXTM           Deadline Depart
     C                     MOVELFJLHOS    #1LHOS           Load Held Over
     C                     MOVELFJLHOR    #1LHOR           Load Held Over
     C                     MOVELFJWNTX    #1WNTX           Load Held Over
     C                     MOVELFJOITX    #1OITX           Ocean BOL Numbe
     C                     MOVELFJOJTX    #1OJTX           Express Mail Nu
     C                     Z-ADDFJLLDT    #1LLDT           Express Mail Da
     C                     MOVELFJOANA    #1OANA           Port Delv Termi
     C                     Z-ADDFJK0DT    #1K0DT           Product Complet
     C                     MOVELFJXACD    #1XACD           Shipping Line
     C                     Z-ADDFJAYTM    #1AYTM           Product Complet
     C                     Z-ADDFJKNNX    #1KNNX           Pallets Loaded
     C                     Z-ADDFJICWG    #1ICWG           Avg Pallet Tare
     C                     Z-ADDFJIDWG    #1IDWG           Tot Pallet Tare
     C                     MOVELFJH9SX    #1H9SX           Load Confirmed
     C                     MOVELFJWOTX    #1WOTX           Load Confirmed
     C                     Z-ADDFJK1DT    #1K1DT           Load Confirmati
     C                     Z-ADDFJAZTM    #1AZTM           Load Door 1
     C                     Z-ADDFJK2DT    #1K2DT           Override Total
     C                     Z-ADDFJA0TM    #1A0TM           Load Door 2
     C                     MOVELFJRQST    #1RQST           Export Load USD
     C                     MOVELFJRRST    #1RRST           Late Delivery E
     C                     Z-ADDFJZBVA    #1ZBVA           Load Actual Fre
     C                     MOVELFJWPTX    #1WPTX           Hide on WW Load
     C                     MOVELFJWQTX    #1WQTX           Late Billing Em
     C                     MOVELFJWRTX    #1WRTX           Shipping Temp C
     C                     MOVELFJWSTX    #1WSTX           LH Held Over Rs
     C                     MOVELFJRVSX    #1RVSX           Multi Company L
     C                     MOVELFJRUSX    #1RUSX           Fax Sent to SSI
     C                     MOVELFJRWSX    #1RWSX           Schedule Pos Lo
     C                     MOVELFJRXSX    #1RXSX           LH Power Only L
     C                     MOVELFJRYSX    #1RYSX           MG Created Load
     C                     MOVELFJRZSX    #1RZSX           LH Unused Sts 5
     C                     MOVELFJR0SX    #1R0SX           Load U_M
     C                     MOVELFJR1SX    #1R1SX           TPM Shipment St
     C                     MOVELFJR2SX    #1R2SX           LH Unused Sts 8
     C                     MOVELFJR3SX    #1R3SX           LH On-Time Reas
     C                     MOVELFJR4SX    #1R4SX           LH Held Over Re
     C                     Z-ADDFJPYDT    #1PYDT           LH Carrier Paid
     C                     Z-ADDFJCKTM    #1CKTM           LH Carrier Paid
     C                     Z-ADDFJPZDT    #1PZDT           LH Last Combo P
     C                     Z-ADDFJCLTM    #1CLTM           LH Last Combo P
     C                     Z-ADDFJP0DT    #1P0DT           LPT Load Plan S
     C                     Z-ADDFJCMTM    #1CMTM           LPT Load Plan S
     C                     Z-ADDFJCNTM    #1CNTM           LH Unused Time
     C                     Z-ADDFJP2DT    #1P2DT           LH Unused Date
     C                     Z-ADDFJCOTM    #1COTM           LH Unused Time
     C                     Z-ADDFJP3DT    #1P3DT           LH Unused Date
     C                     Z-ADDFJCQTM    #1CQTM           LH Unused Time
     C                     Z-ADDFJTRTM    #1TRTM           Truck Ready Tim
     C                     Z-ADDFJKKDT    #1KKDT           On Yard Date
     C                     Z-ADDFJJ4DT    #1J4DT           Truck Ready Dat
     C                     Z-ADDFJAVTM    #1AVTM           On Yard Time
     C                     Z-ADDFJJ5DT    #1J5DT           Spotted Date
     C                     MOVELFJRPST    #1RPST           Load Confirmati
     C                     Z-ADDFJSPTM    #1SPTM           Spotted Time
     C                     MOVELFJROST    #1ROST           Partial Load
     C                     Z-ADDFJJ6DT    #1J6DT           Load Finished D
     C                     Z-ADDFJLFTM    #1LFTM           Load Finished T
     C                     Z-ADDFJJ7DT    #1J7DT           BOL Complete Da
     C                     Z-ADDFJBOTM    #1BOTM           BOL Complete Ti
     C                     Z-ADDFJJ8DT    #1J8DT           BOL Received Da
     C                     Z-ADDFJBLTM    #1BLTM           BOL Received Ti
     C                     Z-ADDFJSBNB    #1SBNB           BOL Time
     C                     Z-ADDFJKIDT    #1KIDT           Truck Departure
     C                     Z-ADDFJASTM    #1ASTM           Truck Departure
     C                     Z-ADDFJS6NB    #1S6NB           Departure Time
     C                     Z-ADDFJKADT    #1KADT           Adjusted Depart
     C                     Z-ADDFJAJCM    #1AJCM           Adjusted Depart
     C                     MOVELFJUVST    #1UVST           EDI Status 1
     C                     MOVELFJUWST    #1UWST           EDI Status 2
     C                     MOVELFJUXST    #1UXST           EDI Status 3
     C                     Z-ADDFJAATM    #1AATM           Job Time
     C                     MOVELFJAYNA    #1AYNA           User Id
     C                     MOVELFJA0NA    #1A0NA           Job Name
     C                     Z-ADDFJAXDT    #1AXDT           Job Date
      * Flag 2:  *YES = coming from menu; no load has been entered
      * CASE: PAR.Flag 2 is *YES
     C           P3NGST    IFEQ '*YES'                     *IF
     C                     Z-ADD*ZERO     #DLOID           Load ID USR
     C                     MOVEL*BLANK    P3NGST           Flag 2
     C                     MOVEL'*NO'     P3NGST           Flag 2
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP1RMNB    #DLOID           Load ID USR
     C                     Z-ADDP1AIC3    #DAOC3           Company Number
      * ** 12/09/2005 LJB - Put PAR.company number into output field
     C                     Z-ADDP1AIC3    #1AIC3           Company Number
     C                     END                             *FI
     C                     MOVEL#1DXTX    #DS2TX           Trailer ID USR
      * Convert Trailer ID to all caps                        E004079
      * CASE: DTL.Trailer ID USR is Entered
     C           #DS2TX    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    YL0001           Case Sensitive
     C                     MOVEL#DS2TX    YL0001           Case Sensitive
      * CVT to Upper Alpha 3   XF - /UT User Source  * 
     C                     CALL 'PBSBXFR'              90  CVT to Upper Al
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0001    WQ0001 30        Case Sensitive
     C           YL0002    PARM *BLANK    WQ0002 30        Case Upper Fiel
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBSBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0002    #DS2TX           Trailer ID USR
     C                     END                             *FI
     C                     MOVEL*BLANK    WUMUTX           Trailer Id
     C                     MOVEL#DS2TX    WUMUTX           Trailer Id
     C                     Z-ADD#DLOID    #1RMNB           Load ID
      * E4687A JJH 02/03/16 - Remove logic for OHE Mexican Buyer Truck
      * RTV Shipping Line-OHE  RT - Order Header Extension  * 
     C                     EXSR SARVGN
      * RTV Carrier Name       RT - Carrier  * Rtv shipping line
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DQXAA    WL0001    P      Carrier Code
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #DI6TX    P      Name
     C                     MOVELWL0003    WUVSST    P      Record Status
      * E01488 RMC 5/20/11  get this for (RI) on req delv date
      * RTV Appt Cnfrm Info   RT - Load Detail  * 
     C                     EXSR SCRVGN
      * ** Not an error if no record
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     END                             *FI
      * process load
      * CASE: DTL.Load ID USR EQ WRK.ZERO
     C           #DLOID    IFEQ WUW0NB                     *IF
      * DTL = CON By name
     C                     MOVEL*BLANK    #DW2ST           USR Active Flag
     C                     MOVEL*BLANK    #DTXST           Error Status  3
     C                     MOVEL*BLANK    #DTUST           Error Status  2
     C                     MOVEL*BLANK    #DECST           Error Status
     C                     MOVEL*BLANK    #DUFL3           USR Flag 3
     C                     MOVEL*BLANK    #DUFL2           USR Flag 2
     C                     MOVEL*BLANK    #DD4ST           USR Flag 1
     C                     Z-ADD*ZERO     #DAOC3           Company Number
     C                     MOVEL*BLANK    #DAPTX           Company Name
     C                     MOVEL*BLANK    #1BZNA           Carrier Code
     C                     MOVEL*BLANK    #DADTX           Name
     C                     Z-ADD*ZERO     #1RMNB           Load ID
     C                     MOVEL*BLANK    #1PJST           LTL Flag
     C                     MOVEL*BLANK    #1PKST           Load Status
     C                     Z-ADD*ZERO     #1RNNB           Reefer Temperat
     C                     MOVEL*BLANK    #1DMTX           Seal 1
     C                     MOVEL*BLANK    #1DNTX           Seal 2
     C                     MOVEL*BLANK    #1DOTX           Seal 3
     C                     MOVEL*BLANK    #1WTTX           Seal 4
     C                     MOVEL*BLANK    #1WUTX           Seal 2 Unused
     C                     Z-ADD*ZERO     #1RPNB           Total Load Orde
     C                     Z-ADD*ZERO     #1FLAM           Flat Amount
     C                     MOVEL*BLANK    #1XQST           Allocate Pounds
     C                     Z-ADD*ZERO     #1RRNB           Total Stops
     C                     MOVEL*BLANK    #1DXTX           Trailer Id
     C                     MOVEL*BLANK    #DBRTX           Ship To Name
     C                     MOVEL*BLANK    #DHNNA           Ship To City
     C                     MOVEL*BLANK    #1DBCD           Ship To State C
     C                     Z-ADD*ZERO     #DLOID           Load ID USR
     C                     Z-ADD*ZERO     #1AIC3           Company Number
     C                     Z-ADD*ZERO     #1T4NB           Schedule Sequen
     C                     Z-ADD*ZERO     #1AODT           Scheduled Ship
     C                     Z-ADD*ZERO     #DABTH           LPT Load Plan T
     C                     MOVEL*BLANK    #DS2TX           Trailer ID USR
     C                     MOVEL*BLANK    #1Q2CD           Shipping Method
     C                     Z-ADD*ZERO     #1F9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     #1P1DT           TPM Planned Shi
     C                     MOVEL*BLANK    #1DYTX           Transloader Car
     C                     MOVEL*BLANK    #1RONB           Truck Size
     C                     Z-ADD*ZERO     #1SQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     #1R1NB           Rated Freight
     C                     MOVEL*BLANK    #1VCST           Ship Status
     C                     MOVEL*BLANK    #1VDST           Load Type
     C                     Z-ADD*ZERO     #1SDNB           Number Pallets
     C                     Z-ADD*ZERO     #1PAOU           Number Pallets
     C                     Z-ADD*ZERO     #1DGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     #1SXNB           Estimated Arriv
     C                     Z-ADD*ZERO     #1HADT           Actual Arrival
     C                     Z-ADD*ZERO     #1AART           Actual Arrival
     C                     Z-ADD*ZERO     #1DHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     #1DIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     #1AQDT           Actual Departur
     C                     Z-ADD*ZERO     #1PRTM           Product Tempera
     C                     Z-ADD*ZERO     #1NPSV           Number Spacers
     C                     MOVEL*BLANK    #1J8TX           Car_Veh_Initial
     C                     Z-ADD*ZERO     #1TLMI           Total Load Mile
     C                     MOVEL*BLANK    #1J9TX           Recorder ID
     C                     MOVEL*BLANK    #1LSHG           Load Shag Flag
     C                     MOVEL*BLANK    #1YPST           Load Wash Flag
     C                     Z-ADD*ZERO     #DKGDT           Delivery Date
     C                     MOVEL*BLANK    #1VPCD           Ship From Wareh
     C                     MOVEL*BLANK    #DC2TX           OHE Carrier SCA
     C                     Z-ADD*ZERO     #1KZDT           Deadline Depart
     C                     Z-ADD*ZERO     #DOTNB           USR Deadline De
     C                     Z-ADD*ZERO     #DAGTH           TMS Deadline De
     C                     Z-ADD*ZERO     #1GRWE           Gross Weight
     C                     MOVEL*BLANK    #1XCCD           Carrier Broker
     C                     MOVEL*BLANK    #1U2ST           Export Status
     C                     MOVEL*BLANK    #1ONTM           On Time_Y_N
     C                     MOVEL*BLANK    #1K4TX           Vessel Name
     C                     Z-ADD*ZERO     #1VOAG           Voyage
     C                     Z-ADD*ZERO     #1KBDT           Sail Date
     C                     MOVEL*BLANK    #1NBBO           Booking Number
     C                     MOVEL*BLANK    #1W4CD           Discharge Port
     C                     Z-ADD*ZERO     #1EFDT           Arrival Date
     C                     MOVEL*BLANK    #1CNTN           Container Numbe
     C                     Z-ADD*ZERO     #1KCDT           Date In
     C                     Z-ADD*ZERO     #1TMIN           Time In
     C                     Z-ADD*ZERO     #1KDDT           Date Out
     C                     Z-ADD*ZERO     #1VMNB           Time Out
     C                     Z-ADD*ZERO     #1OCFR           Load Total Frei
     C                     Z-ADD*ZERO     #1KJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     #1ATTM           Scheduled Deliv
     C                     MOVEL*BLANK    #1OTRS           LH Unused Sts
     C                     MOVEL*BLANK    #1RNST           LH Carrier Paym
     C                     Z-ADD*ZERO     #1BRBK           Bring Back Mile
     C                     Z-ADD*ZERO     #1EIDT           Requested Deliv
     C                     MOVEL*BLANK    #1RMST           Load Acceptance
     C                     MOVEL*BLANK    #1AJCD           Warehouse Code
     C                     Z-ADD*ZERO     #1AXTM           Deadline Depart
     C                     MOVEL*BLANK    #1LHOS           Load Held Over
     C                     MOVEL*BLANK    #1LHOR           Load Held Over
     C                     MOVEL*BLANK    #1WNTX           Load Held Over
     C                     MOVEL*BLANK    #1OITX           Ocean BOL Numbe
     C                     MOVEL*BLANK    #1OJTX           Express Mail Nu
     C                     Z-ADD*ZERO     #1LLDT           Express Mail Da
     C                     MOVEL*BLANK    #1OANA           Port Delv Termi
     C                     Z-ADD*ZERO     #1K0DT           Product Complet
     C                     MOVEL*BLANK    #DFQSX           Export Docs Go
     C                     Z-ADD*ZERO     #DB2TM           USR Product com
     C                     MOVEL*BLANK    #DQXAA           Shipping Line 1
     C                     MOVEL*BLANK    #1XACD           Shipping Line
     C                     MOVEL*BLANK    #DI6TX           Description 14A
     C                     Z-ADD*ZERO     #1AYTM           Product Complet
     C                     Z-ADD*ZERO     #1KNNX           Pallets Loaded
     C                     Z-ADD*ZERO     #1ICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     #1IDWG           Tot Pallet Tare
     C                     MOVEL*BLANK    #1H9SX           Load Confirmed
     C                     MOVEL*BLANK    #1WOTX           Load Confirmed
     C                     Z-ADD*ZERO     #1K1DT           Load Confirmati
     C                     Z-ADD*ZERO     #1AZTM           Load Door 1
     C                     Z-ADD*ZERO     #1K2DT           Override Total
     C                     Z-ADD*ZERO     #1A0TM           Load Door 2
     C                     MOVEL*BLANK    #1RQST           Export Load USD
     C                     MOVEL*BLANK    #1RRST           Late Delivery E
     C                     Z-ADD*ZERO     #1ZBVA           Load Actual Fre
     C                     MOVEL*BLANK    #1WPTX           Hide on WW Load
     C                     MOVEL*BLANK    #1WQTX           Late Billing Em
     C                     MOVEL*BLANK    #1WRTX           Shipping Temp C
     C                     MOVEL*BLANK    #1WSTX           LH Held Over Rs
     C                     MOVEL*BLANK    #1RVSX           Multi Company L
     C                     MOVEL*BLANK    #1RUSX           Fax Sent to SSI
     C                     MOVEL*BLANK    #1RWSX           Schedule Pos Lo
     C                     MOVEL*BLANK    #1RXSX           LH Power Only L
     C                     MOVEL*BLANK    #1RYSX           MG Created Load
     C                     MOVEL*BLANK    #1RZSX           LH Unused Sts 5
     C                     MOVEL*BLANK    #1R0SX           Load U_M
     C                     MOVEL*BLANK    #1R1SX           TPM Shipment St
     C                     MOVEL*BLANK    #1R2SX           LH Unused Sts 8
     C                     MOVEL*BLANK    #1R3SX           LH On-Time Reas
     C                     MOVEL*BLANK    #1R4SX           LH Held Over Re
     C                     Z-ADD*ZERO     #1PYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     #1CKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     #1PZDT           LH Last Combo P
     C                     Z-ADD*ZERO     #1CLTM           LH Last Combo P
     C                     Z-ADD*ZERO     #1P0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     #1CMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     #1CNTM           LH Unused Time
     C                     Z-ADD*ZERO     #1P2DT           LH Unused Date
     C                     Z-ADD*ZERO     #1COTM           LH Unused Time
     C                     Z-ADD*ZERO     #1P3DT           LH Unused Date
     C                     Z-ADD*ZERO     #1CQTM           LH Unused Time
     C                     Z-ADD*ZERO     #1TRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     #1KKDT           On Yard Date
     C                     Z-ADD*ZERO     #DOYTM           USR On Yard Tim
     C                     Z-ADD*ZERO     #1J4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     #DRDTM           USR Ready Time
     C                     Z-ADD*ZERO     #1AVTM           On Yard Time
     C                     Z-ADD*ZERO     #1J5DT           Spotted Date
     C                     Z-ADD*ZERO     #D               USR Picked Up T
     C                     Z-ADD*ZERO     #DM6NX           Load Door 1 USR
     C                     Z-ADD*ZERO     #DM7NX           Load Door 2 USR
     C                     MOVEL*BLANK    #1RPST           Load Confirmati
     C                     Z-ADD*ZERO     #1SPTM           Spotted Time
     C                     MOVEL*BLANK    #1ROST           Partial Load
     C                     Z-ADD*ZERO     #1J6DT           Load Finished D
     C                     Z-ADD*ZERO     #DFDTM           USR Finished Ti
     C                     Z-ADD*ZERO     #1LFTM           Load Finished T
     C                     Z-ADD*ZERO     #1J7DT           BOL Complete Da
     C                     Z-ADD*ZERO     #DCPTM           USR Complete Ti
     C                     Z-ADD*ZERO     #1BOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     #1J8DT           BOL Received Da
     C                     Z-ADD*ZERO     #DBDTM           USR Billed Time
     C                     Z-ADD*ZERO     #1BLTM           BOL Received Ti
     C                     Z-ADD*ZERO     #1SBNB           BOL Time
     C                     Z-ADD*ZERO     #1KIDT           Truck Departure
     C                     Z-ADD*ZERO     #1ASTM           Truck Departure
     C                     Z-ADD*ZERO     #DT9NB           USR Delivery Af
     C                     Z-ADD*ZERO     #1S6NB           Departure Time
     C                     Z-ADD*ZERO     #1KADT           Adjusted Depart
     C                     Z-ADD*ZERO     #DXXTM           Departure Time
     C                     Z-ADD*ZERO     #1AJCM           Adjusted Depart
     C                     MOVEL*BLANK    #1UVST           EDI Status 1
     C                     MOVEL*BLANK    #1UWST           EDI Status 2
     C                     MOVEL*BLANK    #1UXST           EDI Status 3
     C                     Z-ADD*ZERO     #1AATM           Job Time
     C                     MOVEL*BLANK    #1AYNA           User Id
     C                     MOVEL*BLANK    #1A0NA           Job Name
     C                     Z-ADD*ZERO     #1AXDT           Job Date
     C                     Z-ADDP1AIC3    #DAOC3           Company Number
      * ** Put par.co# into output screen field & use to get name
     C                     Z-ADDP1AIC3    #1AIC3           Company Number
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0004           Company Number
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    #DAPTX    P      Name
     C                     MOVEL'N'       P3ZGST           USR Trailer Out
      * *Set Cursor: DTL.Load ID USR  (*Override=*YES)
     C                     Z-ADD006       W0ROW1
     C                     Z-ADD017       W0COL1
     C                     MOVEL'1'       W0OVR1           *YES
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Retrieve start load company for later testing   E00192 7/15/08
      * RTV Load Str Company  RT - Load Header  * 
     C                     EXSR SERVGN
      * ** Error if user is restricted to one Company and this isn't it
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.USR Company Number NE WRK.Company Number
      *   |- c2    : PAR.Allow Multi-Company is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0009    IFNE WUAIC3                     *IF
     C           P4I6ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL##USR     ZA0001           *USER
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           P1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVELP1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0002           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0002           CD3 Ext Numeric
     C                     END                             *FI
      * Send message 'Access Denied: Co    INF'
     C                     MOVEL'USR3964' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
      * VAL: Application Warehouse Access
      * CASE: PAR.Warehouse Specific Usr is Warehouse Specific Proc
     C           P3PRTX    IFEQ 'W'                        *IF
      * Val Warehouse         IF
      * VAL: Warehouse Code
      * CASE: PAR.Application WHS Restrict is yes
     C           YL0010    IFEQ 'Y'                        *IF
      * CASE: PAR.Warehouse Code is Blanks
     C           FJVPCD    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVELFJVPCD    ZA0003           Warehouse Code
      * Send message 'Warehouse Code Required'
     C                     MOVEL'USR2015' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO BEEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * Val App Whs Itm Acs   XF - User Profile Control  * 
     C                     CALL 'PNMOXFR'              90  Val App Whs Itm
     C                     PARM *BLANK    W0RTN   7
     C                     PARM ##USR     WQ0003 10        User Profile Na
     C                     PARM 'PDTFE1'  WQ0004  6        Application Cod
     C                     PARM FJVPCD    WQ0005  3        Warehouse Code
     C                     PARM *ZERO     WQ0006  70       Item Code
     C           YL0011    PARM *BLANK    WQ0007  1        WHS/Item Access
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNMOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.WHS/Item Access Sts USR is Access Denied
     C           YL0011    IFEQ 'D'                        *IF
      * Setup message data for message
     C                     MOVEL##USR     ZA0004           *USER
     C                     MOVELFJVPCD    ZA0005           Warehouse Code
      * Send message 'Access Denied: Warehouse'
     C                     MOVEL'USR2776' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO BEEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Warehouse Code is Not Blanks
     C           FJVPCD    IFNE *BLANK                     *IF
      * Val Warehouse Exists   RT - Warehouse  * 
     C                     EXSR SFRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
     C                     MOVELFJVPCD    ZA0006           Warehouse Code
      * Send message 'Warehouse Codes        NF'
     C                     MOVEL'USR0007' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO BEEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * *Set Cursor: DTL.Load ID USR  (*Override=*YES)
     C                     Z-ADD006       W0ROW1
     C                     Z-ADD017       W0COL1
     C                     MOVEL'1'       W0OVR1           *YES
      * RTV Carrier Name       RT - Carrier  * Rtv carrier name
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1BZNA    WL0001    P      Carrier Code
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #DADTX    P      Name
     C                     MOVELWL0003    WUVSST    P      Record Status
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0004           Company Number
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    #DAPTX    P      Name
      * RTV Load Dispatch new  RT - Load Header  * 
     C                     EXSR SGRVGN
      * Use ShipLine/Container if Exports, else Carrier/Trailer  E004079
      * CASE: DTL.Shipping Line 1 USR is Entered
     C           #DQXAA    IFNE *BLANK                     *IF
     C                     MOVEL#1CNTN    YL0013           Trailer ID USR
     C                     MOVEL#DQXAA    YL0014           Carrier Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#DS2TX    YL0013           Trailer ID USR
     C                     MOVEL#1BZNA    YL0014           Carrier Code
     C                     END                             *FI
      * Convert Trailer ID to all caps                        E004079
      * CASE: LCL.Trailer ID USR is Entered
     C           YL0013    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    YL0001           Case Sensitive
     C                     MOVELYL0013    YL0001           Case Sensitive
      * CVT to Upper Alpha 3   XF - /UT User Source  * 
     C                     CALL 'PBSBXFR'              90  CVT to Upper Al
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0001    WQ0008 30        Case Sensitive
     C           YL0002    PARM *BLANK    WQ0009 30        Case Upper Fiel
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBSBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0002    YL0013           Trailer ID USR
     C                     END                             *FI
      * Rtv Trailer            RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0014    WL0006    P      Carrier Code
     C                     MOVELYL0013    WL0007    P      Trailer Id
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0008    YN0004           Company Number
     C                     MOVELWL0009    WUWNST    P      Load Type
     C                     MOVELWL0010    P2X3ST    P      Trailer Type
     C                     MOVELWL0011    P2XGST    P      Seaboard Owned
     C                     MOVELWL0012    P2STOY    P      On Yard Status
     C                     Z-ADDWL0013    WULNDT           On Yard Date
     C                     Z-ADDWL0014    WUA3TM           On Yard Time
     C                     MOVELWL0015    P2STAS    P      Assigned Status
     C                     MOVELWL0016    P2XRST    P      Available Statu
     C                     MOVELWL0017    P2X7CD    P      Not Available R
     C                     MOVELWL0018    P2GXTX    P      Comment Line
     C                     MOVELWL0019    P2VSST    P      Record Status
      * If BOL Cmplt and Trailer entered, change Trailer to output only
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.Trailer ID USR NE WRK.Blank for 12          USR
      *   |- c2    : DTL.BOL Complete Date is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DS2TX    IFNE WUS3TX                     *IF
     C           #1J7DT    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       P3ZGST           USR Trailer Out
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       P3ZGST           USR Trailer Out
     C                     END                             *FI
      * RTV Carrier Name       RT - Carrier  * Rtv ShipLine name
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DQXAA    WL0001    P      Carrier Code
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #DI6TX    P      Name
     C                     MOVELWL0003    WUVSST    P      Record Status
      * ** 04/09/2008 LJB S00164
      * ** Default Shag flag, if it is blanks
      * CASE: DTL.Load Shag Flag is blank
     C           #1LSHG    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       #1LSHG           Load Shag Flag
     C                     END                             *FI
      * ** Default Wash flag, if it is blanks
      * CASE: DTL.Load Wash Flag is blank
     C           #1YPST    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       #1YPST           Load Wash Flag
     C                     END                             *FI
      * 08/14/24 SP WI648-Start
      * Set field Load Wash Flag
      * CASE: DTL.Load Status is Shipped or Invoiced
     C           #1PKST    IFEQ 'I'                        *IF
     C           #1PKST    OREQ 'S'
      * CASE: DTL.Scheduled Ship Date GE LCL.Date From             USR
     C           #1AODT    IFGE YL0015                     *IF
     C                     MOVELYL0016    #1YPST           Load Wash Flag
     C                     MOVEL'N'       YL0017           Change Wash Fla
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       YL0017           Change Wash Fla
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELYL0016    #1YPST           Load Wash Flag
      * CASE: LCL.Load Wash Flag        Usr is no
     C           YL0016    IFEQ 'N'                        *IF
     C                     MOVEL'N'       YL0017           Change Wash Fla
     C                     ELSE
      * CASE: LCL.Load Wash Flag        Usr is yes
     C           YL0016    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0017           Change Wash Fla
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ** LJB 07/01/2014 E003167 Default Nor-Am, Millard Shag/Wash="N"
      * 09/06/24 SP WI648-Start
      * Default Shag & Wash to NO if NA1, EF1, EF2, EF3, or EF4   E003167
      * CASE:
      *  - c1 OR c2 OR c3 OR c4 OR c5
      *   |- c1    : DTL.Ship From Warehouse is EF1-Millard Freezer
      *   |- c2    : DTL.Ship From Warehouse is EF2-Millard-Friona
      *   |- c3    : DTL.Ship From Warehouse is EF3-Millard Freezer
      *   |- c4    : DTL.Ship From Warehouse is EF4-Millard-Fresh
      *   |- c5    : DTL.Ship From Warehouse is NA1-Nor-Am Cold Storage
      *   '-
     C           #1VPCD    IFEQ 'EF1'                      *IF
     C           #1VPCD    OREQ 'EF2'                      *OR
     C           #1VPCD    OREQ 'EF3'                      *OR
     C           #1VPCD    OREQ 'EF4'                      *OR
     C           #1VPCD    OREQ 'NA1'                      *OR
     C                     MOVEL'N'       #1LSHG           Load Shag Flag
     C                     END                             *FI
      * RTV All               RT - Warehouse Codes  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1VPCD    WL0020    P      Warehouse Code
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0021    YN0005    P      Warehouse Descr
     C                     MOVELWL0022    YN0006    P      Address Line 1
     C                     MOVELWL0023    YN0007    P      Address Line 2
     C                     MOVELWL0024    YN0008    P      Address Line 3
     C                     MOVELWL0025    YN0009    P      City
     C                     MOVELWL0026    YN0010    P      Zip Postal Code
     C                     MOVELWL0027    YN0011    P      Production Ware
     C                     MOVELWL0028    YN0012    P      State Code
     C                     MOVELWL0029    YN0013    P      Lot Tracking Fl
     C                     MOVELWL0030    YN0014    P      Default Printer
     C                     MOVELWL0031    YN0015    P      Warehouse Type
     C                     MOVELWL0032    YN0016    P      Trans Contol AS
     C                     MOVELWL0033    YL0018    P      Warehouse Locat
     C                     MOVELWL0034    YN0017    P      Warehouse Std C
     C                     Z-ADDWL0035    YN0018           Warehouse Chill
     C                     MOVELWL0036    YN0019    P      Include in Auto
     C                     MOVELWL0037    YN0020    P      Default Manifes
     C                     MOVELWL0038    YN0021    P      Default Load Se
     C                     MOVELWL0039    YN0022    P      WHS Slotting Li
     C                     Z-ADDWL0040    YN0023           Shipping Compan
     C                     Z-ADDWL0041    YN0024           Accounting Comp
     C                     Z-ADDWL0042    YN0025           WHS Sched Prod
     C                     Z-ADDWL0043    YN0026           WHS Inventory C
     C                     MOVELWL0044    YN0027    P      Parent Warehous
     C                     MOVELWL0045    YN0028    P      Default Shippin
     C                     MOVELWL0046    YN0029    P      WHS Live with C
     C                     MOVELWL0047    YN0030    P      WHS PFS Interfa
     C                     MOVELWL0048    YN0031    P      WHS Req Meter R
     C                     MOVELWL0049    YN0032    P      WHS Default Loa
     C                     MOVELWL0050    YN0033    P      WHS TMS Plannin
     C                     MOVELWL0051    YN0034    P      Default Carrier
     C                     MOVELWL0052    YN0035    P      Inventory Logic
     C                     MOVELWL0053    YN0036    P      WHS Auto Inv Re
     C                     MOVELWL0054    YN0037    P      EDI Status 1
     C                     MOVELWL0055    YN0038    P      EDI Status 2
     C                     MOVELWL0056    YN0039    P      EDI Status 3
     C                     MOVELWL0057    YN0040    P      Record Status
      * Validate and Update Wash Flag for Warehouse with External Locatio
      * CASE: LCL.Warehouse Location is External
     C           YL0018    IFEQ 'E'                        *IF
     C                     MOVEL'N'       #1YPST           Load Wash Flag
      * Set field Load Wash Flag
      * CASE: DTL.Load Status is Shipped or Invoiced
     C           #1PKST    IFEQ 'I'                        *IF
     C           #1PKST    OREQ 'S'
     C                     MOVEL'N'       YL0017           Change Wash Fla
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.Date From             USR is Not Entered
     C           YL0015    IFEQ *ZERO                      *IF
     C                     MOVEL'N'       YL0017           Change Wash Fla
     C                     ELSE
      * CASE: DTL.Scheduled Ship Date GE LCL.Date From             USR
     C           #1AODT    IFGE YL0015                     *IF
     C                     MOVELYL0016    #1YPST           Load Wash Flag
      * CASE: LCL.Load Wash Flag        Usr is no
     C           YL0016    IFEQ 'N'                        *IF
     C                     MOVEL'N'       YL0017           Change Wash Fla
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       YL0017           Change Wash Fla
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0017           Change Wash Fla
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 09/06/24 SP WI648-End
      * 08/14/24 SP WI648-End
      * ** If Load Status is Shipped or Invoiced, change shag/wash to out
      * CASE: DTL.Load Status is Shipped or Invoiced
     C           #1PKST    IFEQ 'I'                        *IF
     C           #1PKST    OREQ 'S'
     C                     MOVEL'N'       P6HWSX           Change Flag USR
     C                     END                             *FI
      * ** 10/31/2007 LJB FT617
      * ** If BOL Cmplt, change Shag and Wash flags to output only
      * CASE: DTL.BOL Complete Date is Entered
     C           #1J7DT    IFNE *ZERO                      *IF
     C                     MOVEL'N'       P6HWSX           Change Flag USR
     C                     END                             *FI
     C                     Z-ADD#1KKDT    WULKDT           USR On Yard Dat
     C                     Z-ADD#1KKDT    P1KKDT           On Yard Date
     C                     Z-ADD#1KIDT    WULJDT           USR Truck Depar
     C                     Z-ADD#DT9NB    WU               USR Truck Depar
      * *******
     C                     Z-ADDFJEIDT    #DKGDT           Delivery Date
      * RTV Act ShpDt Last Ord RT - Load Detail  * 
     C                     EXSR SJRVGN
      * ***** 3/4/02  Exp doc with driver sts
      * RTV 1st Export Order   RT - Load Detail  * 
     C                     EXSR SLRVGN
      * Get Exp Docs
      * CASE: WRK.Order Number is Not equal to zeros
     C           WUC4NB    IFNE *ZERO                      *IF
      * RTV Exp Doc w/Drvr     RT - Order Header TRG  * 
     C                     EXSR SNRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #DFQSX           Export Docs Go
     C                     END                             *FI
      * *****
      * RMC 6/21/06 make bol complet dt/time output all the time with thi
     C                     MOVEL'Y'       P3D4ST           USR Flag 1
      * ** Rtv Sail Port City/State from OHE file if exports exist
      * CASE: DB1.Export Status is yes
     C           FJU2ST    IFEQ 'Y'                        *IF
      * 07/30/19 DN R15161-OHE Voyage/Flight parm type changed from NBR t
      * RTV ExpOrd Info for LD XF - Order Header TRG  * 
     C                     CALL 'PMJMXFR'              90  RTV ExpOrd Info
     C                     PARM *BLANK    W0RTN   7
     C           WUNFNN    PARM *ZERO     WQ0010  70       Order Number
     C           WUNFNN    PARM *ZERO     WQ0011  70       Ship To Custome
     C           #DBRTX    PARM *BLANK    WQ0012 30        Ship To Name
     C           WUG0TX    PARM *BLANK    WQ0013 30        Ship To Address
     C           WUG0TX    PARM *BLANK    WQ0014 30        Ship To Address
     C           WUG0TX    PARM *BLANK    WQ0015 30        Ship To Address
     C           WUG0TX    PARM *BLANK    WQ0016 20        Ship To City
     C           WUG0TX    PARM *BLANK    WQ0017  2        Ship To State C
     C           WUG0TX    PARM *BLANK    WQ0018 11        Ship To Zip_Pos
     C           WUG0TX    PARM *BLANK    WQ0019  3        Carrier Code
     C                     PARM FJRMNB    WQ0020  70       Load ID
     C           WUG0TX    PARM *BLANK    WQ0021  1        Export Status
     C           WUG0TX    PARM *BLANK    WQ0022  1        Export Docs Go
     C           WUG0TX    PARM *BLANK    WQ0023  1        Air Freight Ord
     C           WUG0TX    PARM *BLANK    WQ0024  2        Export USDA App
     C           WUNFNN    PARM *ZERO     WQ0025  30       Company Number
     C           WUNFNN    PARM *ZERO     WQ0026  50       Stop_Drop Seque
     C           WUG0TX    PARM *BLANK    WQ0027  3        Shipping Line
     C           WUG0TX    PARM *BLANK    WQ0028 20        Port Delv Termi
     C           WUG0TX    PARM *BLANK    WQ0029 25        OHE City
     C           WUG0TX    PARM *BLANK    WQ0030 30        OHE Vessel_Airl
     C           WUG0TX    PARM *BLANK    WQ0031 15        OHE Voyage_Flig
     C           WUG0TX    PARM *BLANK    WQ0032 15        OHE Booking Num
     C           WUG0TX    PARM *BLANK    WQ0033 20        OHE Discharge P
     C           WUNFNN    PARM *ZERO     WQ0034  70       OHE Sail_Flight
     C           WUNFNN    PARM *ZERO     WQ0035  70       OHE Port Cut Da
     C           WUNFNN    PARM *ZERO     WQ0036  70       OHE Arrival Dat
     C           WUG0TX    PARM *BLANK    WQ0037  3        OHE Late Delive
     C           WUG0TX    PARM *BLANK    WQ0038  1        OHE Ship Status
     C           WUG0TX    PARM *BLANK    WQ0039 12        OHE Container N
     C           WUG0TX    PARM *BLANK    WQ0040 35        OHE Comment 1
     C           WUG0TX    PARM *BLANK    WQ0041 75        OHE Comment 2
     C           #DHNNA    PARM *BLANK    WQ0042 25        Port City
     C           WUG0TX    PARM *BLANK    WQ0043 25        Port Address Li
     C           WUG0TX    PARM *BLANK    WQ0044 25        Port Address Li
     C           #1DBCD    PARM *BLANK    WQ0045  2        Sail Port State
     C           WUG0TX    PARM *BLANK    WQ0046 11        Port Zip_Postal
     C           WUNFNN    PARM *ZERO     WQ0047 110       Port Phone Numb
     C           WUG0TX    PARM *BLANK    WQ0048 25        Port Fax Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMJMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Default dates
      * CASE: DTL.On Yard Date is not entered
     C           #1KKDT    IFEQ *ZERO                      *IF
      * Put On Yard Date from Trailer into screen fields  E002966
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : DTL.Trailer ID USR NE WRK.Blank for 12          USR
      *   |- c2    : DTL.Truck Departure Date is not entered
      *   |- c3    : WRK.On Yard Date-Trailer  USR is not entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DS2TX    IFNE WUS3TX                     *IF
     C           #1KIDT    IFEQ *ZERO                      *IF
     C           WULNDT    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD##JDT     #1KKDT           On Yard Date
     C                     ELSE
      * CASE: WRK.On Yard Date-Trailer  USR is Entered
     C           WULNDT    IFNE *ZERO                      *IF
     C                     Z-ADDWULNDT    #1KKDT           On Yard Date
     C                     MOVEL'N'       WUZ2SX           USR Display 11
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: DTL.Truck Ready Date is not entered
     C           #1J4DT    IFEQ *ZERO                      *IF
      * DTL.Truck Ready Date = PAR.Current System Date
     C                     Z-ADDP5SDTE    #1J4DT           Truck Ready Dat
     C                     ELSE
      * CASE: DTL.Spotted Date is not entered
     C           #1J5DT    IFEQ *ZERO                      *IF
      * DTL.Spotted Date = PAR.Current System Date
     C                     Z-ADDP5SDTE    #1J5DT           Spotted Date
     C                     ELSE
      * CASE: DTL.Load Finished Date is not entered
     C           #1J6DT    IFEQ *ZERO                      *IF
      * DTL.Load Finished Date = PAR.Current System Date
     C                     Z-ADDP5SDTE    #1J6DT           Load Finished D
     C                     ELSE
      * CASE: DTL.BOL Received Date is not entered
     C           #1J8DT    IFEQ *ZERO                      *IF
      * DTL.BOL Received Date = PAR.Current System Date
     C                     Z-ADDP5SDTE    #1J8DT           BOL Received Da
     C                     ELSE
      * CASE: DTL.Truck Departure Date is not entered
     C           #1KIDT    IFEQ *ZERO                      *IF
      * DTL.Truck Departure Date = PAR.Current System Date
     C                     Z-ADDP5SDTE    #1KIDT           Truck Departure
     C                     ELSE
      * CASE: DTL.Adjusted Departure Date is not entered
     C           #1KADT    IFEQ *ZERO                      *IF
      * DTL.Adjusted Departure Date = PAR.Current System Date
     C                     Z-ADDP5SDTE    #1KADT           Adjusted Depart
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Default times
      * CASE: DTL.On Yard Time is Not Entered
     C           #1AVTM    IFEQ *ZERO                      *IF
      * Put On Yard Date/Time from Trailer into screen fields  E002966
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : DTL.Trailer ID USR NE WRK.Blank for 12          USR
      *   |- c2    : DTL.Truck Departure Date is not entered
      *   |- c3    : WRK.On Yard Time-Trailer  USR is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DS2TX    IFNE WUS3TX                     *IF
     C           #1KIDT    IFEQ *ZERO                      *IF
     C           WUA3TM    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD##JTM     #1AVTM           On Yard Time
     C                     ELSE
      * CASE: WRK.On Yard Time-Trailer  USR is Entered
     C           WUA3TM    IFGT *ZERO                      *IF
     C                     Z-ADDWUA3TM    #1AVTM           On Yard Time
     C                     Z-ADDWUA3TM    WUAVTM           On Yard Time
     C                     MOVEL'N'       WUZ2SX           USR Display 11
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: DTL.Truck Ready Time is Not Entered
     C           #1TRTM    IFEQ *ZERO                      *IF
     C                     Z-ADD##JTM     #1TRTM           Truck Ready Tim
     C                     ELSE
      * CASE: DTL.Spotted Time is Not Entered
     C           #1SPTM    IFEQ *ZERO                      *IF
     C                     Z-ADD##JTM     #1SPTM           Spotted Time
     C                     ELSE
      * CASE: DTL.Load Finished Time is Not Entered
     C           #1LFTM    IFEQ *ZERO                      *IF
     C                     Z-ADD##JTM     #1LFTM           Load Finished T
      * *Set Cursor: DTL.Partial Load  (*Override=*YES)
     C                     Z-ADD016       W0ROW1
     C                     Z-ADD042       W0COL1
     C                     MOVEL'1'       W0OVR1           *YES
     C                     ELSE
      * CASE: DTL.BOL Received Time is Not Entered
     C           #1BLTM    IFEQ *ZERO                      *IF
     C                     Z-ADD##JTM     #1BLTM           BOL Received Ti
     C                     ELSE
      * CASE: DTL.Truck Departure Time is Not Entered
     C           #1ASTM    IFEQ *ZERO                      *IF
     C                     Z-ADD##JTM     #1ASTM           Truck Departure
     C                     ELSE
      * CASE: DTL.Adjusted Departure Time is Not Entered
     C           #1AJCM    IFEQ *ZERO                      *IF
     C                     Z-ADD##JTM     #1AJCM           Adjusted Depart
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Move 6.0 time fields to 4.0 - user does not want to see seconds
     C           #1AJCM    DIV  100       #DXXTM           Departure Time
     C           #1ASTM    DIV  100       #DT9NB           USR Delivery Af
     C           #1BLTM    DIV  100       #DBDTM           USR Billed Time
     C           #1BOTM    DIV  100       #DCPTM           USR Complete Ti
     C           #1LFTM    DIV  100       #DFDTM           USR Finished Ti
     C           #1SPTM    DIV  100       #D               USR Picked Up T
     C           #1TRTM    DIV  100       #DRDTM           USR Ready Time
     C           #1AVTM    DIV  100       #DOYTM           USR On Yard Tim
     C           #1CMTM    DIV  100       #DABTH           LPT Load Plan T
      * ** 11/16/2007 LJB FP1251 DDD&T will be zeros if one or more of
      * ** the Miles Between Cities records is missing
      * E7892-Replaced 'USR Deadline Deprt Time' with 'TMS Deadline Depar
     C           #1AXTM    DIV  100       #DAGTH           TMS Deadline De
     C           #1AYTM    DIV  100       #DB2TM           USR Product com
     C                     Z-ADD#1AZTM    #DM6NX           Load Door 1 USR
     C                     Z-ADD#1A0TM    #DM7NX           Load Door 2 USR
      * Default:  Partial Load
      * CASE: DB1.Partial Load is Not Entered
     C           FJROST    IFEQ *BLANK                     *IF
     C                     MOVEL'N'       #1ROST           Partial Load
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      *
      *..................................................
     C   99                GOTO BEEXIT
      *
     C           YPMTFD    IFEQ *BLANK
      * No error: Display and process details
     C                     EXSR CADSDA
     C                     END
      *
      *================================================================
     CSR         BEEXIT    ENDSR
      /EJECT
     CSR         BFVLKY    BEGSR
      *================================================================
      * Validate key fields
      *================================================================
     C           YPMTFD    IFNE *BLANK
      * Select existing record
     C                     EXSR VACKRL
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate key screen
     C                     Z-ADD#1RMNB    P1RMNB           Load ID
     C                     END
      * Load ID required
     C           #1RMNB    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         BFEXIT    ENDSR
      /EJECT
     CSR         CADSDA    BEGSR
      *================================================================
      * Display and process detail screen
      *================================================================
      * Conduct detail screen conversation
      * - repeat until screen control flag is reset:
     C           W0TRN     DOWEQ'Y'
      * Convert internal to external form
     C                     EXSR MOCV#D
      * Display detail screen
     C                     EXSR CBEXFM
      * Process response to detail screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * Redisplay previous screen
     C   12                CAS            CCDSPV
      * HOME: Reset screen fields
     C   30                CAS            CCDSPV
      * Process detail screen input
     C                     CAS            CFPRSC
     C                     END
     C           W0TRN     IFEQ 'R'
     C           W0PMD     IFEQ 'ADD'
     C                     EXSR MAIZ#1
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         CBEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
     C                     MOVEL'1'       W0GRP   1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y1SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT2
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1
      * Reset global error indicator
     C                     SETOF                         99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CBEXIT    ENDSR
      /EJECT
     CSR         CCDSPV    BEGSR
      *================================================================
      * Redisplay previous screen
      *================================================================
     C   30                MOVEL'R'       W0TRN
     C   12                MOVEL'K'       W0TRN
      *================================================================
     CSR         CCEXIT    ENDSR
      /EJECT
     CSR         CFPRSC    BEGSR
      *================================================================
      * Validate record
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate details
     C                     EXSR DCVLDL
      * QUIT if error:
     C   99                GOTO CFEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       CFEXIT
      * Prompt for confirmation
     C                     EXSR EAPMCF
      * Quit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO CFEXIT
     C                     END
      * No error: update record
     C                     EXSR EBPR##
      *================================================================
     CSR         CFEXIT    ENDSR
      /EJECT
     CSR         DCVLDL    BEGSR
      *================================================================
      * Validate details
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Validate Company Number and convert to internal.
      * CD3 Ext/Int
     C                     MOVELV1AIC3    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC3  3
     C                     MOVEA*BLANKS   K3
     C                     Z-ADD3         C       30
     C                     Z-ADD3         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUDMCD    J3
     C                     MOVE *BLANKS   W0RTN
     C                     DO   3
     C           J3,C      IFNE ' '
     C                     MOVEAJ3,C      K3,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK3        JUSTC3
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC3    TESTC   1
     C           TESTC     IFGT '?'
     C           TESTC     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC3     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC3    WUDMCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,002                    *IF
      * Setup message data for message
      * Send message 'CD3 Non numeric data'
     C                     MOVEL'USR0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #1AIC3           CD3 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUDMCD    #1AIC3           CD3 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Load Shag Flag
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1LSHG    W0NSRQ  1        Load Shag Flag
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#1LSHG'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1106245   Y2LSNO  70
     C           #1LSHG    PARM #1LSHG    W0EXVL 25        Load Shag Flag
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * Validate Load Wash Flag
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#1YPST    W0NSRQ  1        Load Wash Flag
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#1YPST'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1106245   Y2LSNO  70
     C           #1YPST    PARM #1YPST    W0EXVL 25        Load Wash Flag
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * Validate On Yard Date
      * External date
     C                     Z-ADDV1KKDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9936  *
     C                     END
     C                     Z-ADDXDINDT    #1KKDT
      * Validate Truck Ready Date
      * External date
     C                     Z-ADDV1J4DT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9938  *
     C                     END
     C                     Z-ADDXDINDT    #1J4DT
      * Validate Spotted Date
      * External date
     C                     Z-ADDV1J5DT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9940  *
     C                     END
     C                     Z-ADDXDINDT    #1J5DT
      * Validate Partial Load
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1ROST'  IFEQ YPMTFD
      * Partial Load
     C                     MOVEL#1ROST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHROST
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHROST
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZHROST
     C                     ENDSL
     C                     EXFMTZGROST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHROST    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHROST    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1ROST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Load Finished Date
      * External date
     C                     Z-ADDV1J6DT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9945  *
     C                     END
     C                     Z-ADDXDINDT    #1J6DT
      * Validate BOL Complete Date
      * External date
     C                     Z-ADDV1J7DT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9947  *
     C                     END
     C                     Z-ADDXDINDT    #1J7DT
      * Validate BOL Received Date
      * External date
     C                     Z-ADDV1J8DT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9949  *
     C                     END
     C                     Z-ADDXDINDT    #1J8DT
      * Validate Truck Departure Date
      * External date
     C                     Z-ADDV1KIDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9951  *
     C                     END
     C                     Z-ADDXDINDT    #1KIDT
      * Validate Adjusted Departure Date
      * External date
     C                     Z-ADDV1KADT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9953  *
     C                     END
     C                     Z-ADDXDINDT    #1KADT
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate detail screen fields
      * ** If Allow-Multi Company = NO, then Load Company must match
      * ** Company Number from Security parms       E00192 7/15/2008
      * ** Error if user is restricted to one Company and this isn't it
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.USR Company Number NE WRK.Company Number
      *   |- c2    : PAR.Allow Multi-Company is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0009    IFNE WUAIC3                     *IF
     C           P4I6ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL##USR     ZA0007           *USER
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           WUAIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVELWUAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0008           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0008           CD3 Ext Numeric
     C                     END                             *FI
      * Send message 'Access Denied: Company'
     C                     MOVEL'USR3610' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * F5=Refresh
      * CASE: DTL.*CMD key is *Refresh
     C           *IN05     IFEQ '1'                        *IF
     C                     Z-ADD#1RMNB    P1RMNB           Load ID
     C                     Z-ADD#1AIC3    P1AIC3           Company Number
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * F4=Prompt Company or Load
      * CASE: DTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * Prompt on Company Number - 12/09/2005 LJB - Use dtl.company numbe
      * CASE: PGM.*Cursor field <IS> DTL.Company Number
     C           W0CFL     IFEQ 'V1AIC3'                   *IF
      * CASE: PAR.Allow Multi-Company is yes
     C           P4I6ST    IFEQ 'Y'                        *IF
      * SEL Company by Number  SR - Company Name and Address  * 
     C                     CALL 'CAAJSRR'              90  SEL Company by
     C                     PARM *BLANK    W0RTN   7
     C           #DAOC3    PARM #DAOC3    WQ0051  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAAJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Function not available'
     C                     MOVEL'USR1942' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Prompt on Load ID
      * CASE: PGM.*Cursor field <IS> DTL.Load ID USR
     C           W0CFL     IFEQ '#DLOID'                   *IF
     C                     Z-ADD#1AIC3    #DAOC3           Company Number
      * SEL Load ID by Co#     SR - Load Header  * 
     C                     CALL 'PPVJSRR'              90  SEL Load ID by
     C                     PARM *BLANK    W0RTN   7
     C           #DLOID    PARM #DLOID    WQ0052  70       Load ID
     C           #DAOC3    PARM #DAOC3    WQ0053  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPVJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * ** 12/12/2005 - if co# was selected, load it to screen
      * CASE: DTL.Company Number Select NE DTL.Company Number
     C           #DAOC3    IFNE #1AIC3                     *IF
     C                     Z-ADD#DAOC3    #1AIC3           Company Number
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * F4=Prompt on Trailer (or container  E004079)
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Trailer ID USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DS2TX'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD#1AIC3    YL0019           Company Number
      * If export use ShipLine/Container, else use Carrier/Trailer  E0040
      * CASE: DTL.Shipping Line 1 USR is Entered
     C           #DQXAA    IFNE *BLANK                     *IF
     C                     MOVEL#DQXAA    YL0014           Carrier Code
     C                     MOVEL#1CNTN    YL0013           Trailer ID USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#1BZNA    YL0014           Carrier Code
     C                     MOVEL#DS2TX    YL0013           Trailer ID USR
     C                     END                             *FI
      * Sel Trailer           SR - Trailer  * 
     C                     CALL 'PBRFSRR'              90  Sel Trailer
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0014    WQ0054  3        Carrier Code
     C           YL0013    PARM *BLANK    WQ0055 20        Trailer Id
     C           YL0019    PARM YL0019    WQ0056  30       Company Number
     C                     PARM *BLANK    WQ0057  1        On Yard Status
     C                     PARM *ZERO     WQ0058  70       On Yard Date
     C                     PARM *ZERO     WQ0059  60       On Yard Time
     C                     PARM *BLANK    WQ0060  1        Available Statu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBRFSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Update screen with retrieved values                   E004079
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     MOVELYL0014    #DQXAA           Shipping Line 1
     C                     MOVELYL0013    #DS2TX           Trailer ID USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELYL0014    #1BZNA           Carrier Code
     C                     MOVELYL0013    #DS2TX           Trailer ID USR
     C                     END                             *FI
     C                     END                             *FI
      * F22=Search Load Id by PO#; E7762
      * CASE: DTL.*CMD key is CF22
     C           *IN22     IFEQ '1'                        *IF
     C                     MOVEL*BLANK    YL0020           Customer Purcha
     C                     Z-ADD*ZERO     #DLOID           Load ID USR
      * SEL Load Id by PO      SR - Order Header TRG  * 
     C                     CALL 'PBY1SRR'              90  SEL Load Id by
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0061  30       Company Number
     C           YL0020    PARM YL0020    WQ0062 15        Customer Purcha
     C           #DLOID    PARM #DLOID    WQ0063  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBY1SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993231*
     C                     END
     C                     END                             *FI
      * Exit if changed load id
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DTL.Load ID USR NE DTL.Load ID
      *   |- c2    : DTL.Company Number Select NE DTL.Company Number
      *   '-
     C           #DLOID    IFNE #1RMNB                     *IF
     C           #DAOC3    ORNE #1AIC3                     *OR
      * VAL Load Exist        RT - OM Load Header  * 
     C                     EXSR SORVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
     C                     Z-ADD#DLOID    ZA0009           Load ID USR
      * Send message 'OM Load Header not found'
     C                     MOVEL'USR2313' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#DLOID    P1RMNB           Load ID
     C                     Z-ADD#1AIC3    P1AIC3           Company Number
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     END                             *FI
      * F20=Traffic Comments
      * CASE: DTL.*CMD key is CF20
     C           *IN20     IFEQ '1'                        *IF
      * EDT PD Traffic Comment EF - PD Traffic Comments  * 
     C                     CALL 'PDCZEFR'              90  EDT PD Traffic
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0064  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCZEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * F21=Print Confirmation
      * CASE: DTL.*CMD key is *Print 21
     C           *IN21     IFEQ '1'                        *IF
      * CASE:
      *  - c1ORc2
      *   |- c1    : DTL.Truck Ready Date is not entered
      *   |- c2    : DTL.USR Ready Time is *Not Entered
      *   '-
     C           #1J4DT    IFEQ *ZERO                      *IF
     C           #DRDTM    OREQ *ZERO                      *OR
      * Setup message data for message
      * Convert Truck Ready Date to display format
      * Convert date
     C           1000000   ADD  #1J4DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0010
     C                     Z-ADD#DRDTM    ZA0011           USR Ready Time
      * Send message 'Truck Ready Time/Date'
     C                     MOVEL'USR2797' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993839*
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#1AIC3    WUAJAA           Company Number
      * ** load par fields with screen fields                P000737
     C                     Z-ADD#1AIC3    P6AJAA           Company Number
     C                     Z-ADD#DLOID    P6AJAE           Order Number 1
     C                     Z-ADD#1AIC3    WUAJAA           Company Number
     C                     Z-ADD9         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00010
     C           ZQ        ORGT 00010
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST##JOB:ZQ  WUA0NA    P  90  Job Name
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WUA0NA    CAT  'P':ZQ    WUA0NA    P      Job Name
      * ** Remove WF Load Confirmation Work functions      P000737
     C                     MOVEL*BLANK    YL0021           Job Log Create
     C                     MOVEL'*NO'     YL0021           Job Log Create
     C                     MOVEL@CN,003   P6G3TX           PRT Description
     C                     MOVELP4MPNA    P6WRST           PRT Printer Dev
     C                     MOVEL*BLANK    P6WSST           PRT Hold Output
     C                     MOVEL'*NO'     P6WSST           PRT Hold Output
     C                     MOVEL*BLANK    P6WTST           PRT Save Output
     C                     MOVEL'*NO'     P6WTST           PRT Save Output
     C                     MOVEL'N'       P6WUST           PRT Night Queue
     C                     MOVEL*BLANK    P6BVVN           PRT Night Queue
      * PMT Print Option  SHR  PV - Print Options  * 
     C                     CALL 'PDG0PVR'              90  PMT Print Optio
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P6G3TX    WQ0065 25        PRT Description
     C           P6WRST    PARM P6WRST    WQ0066 10        PRT Printer Dev
     C           P6WSST    PARM P6WSST    WQ0067  4        PRT Hold Output
     C           P6WTST    PARM P6WTST    WQ0068  4        PRT Save Output
     C           P6DYNB    PARM P6DYNB    WQ0069  20       PRT Number of C
     C           P6WUST    PARM P6WUST    WQ0070  1        PRT Night Queue
     C           P6BVVN    PARM P6BVVN    WQ0071 10        PRT Night Queue
     C                     PARM 'O/M'     WQ0072  6        Application Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDG0PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Call the submitting program
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ @CN,004                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Remove PCA2UPR and call function for PDVVUPC    P000737
      * ** to Print Only the load confirmation
     C                     Z-ADDP6DYNB    P6M8NB           System Value Nu
      * ** default # of copies to 1 if it is zeros      P000737
      * CASE: PAR.System Value Numeric is Equal to zero
     C           P6M8NB    IFEQ *ZERO                      *IF
     C                     Z-ADD1         P6M8NB           System Value Nu
     C                     END                             *FI
     C                     MOVEL'P'       WUE6ST           USR Status (Y/N
     C                     MOVEL@CN,005   WUNMTX           Status Descript
     C                     MOVEL'N'       WUB8ST           Status - Y or N
     C                     MOVEL'N'       WUQ1ST           Status Flag 1
      * EXC Load Confirm Fax   IF - Load Header  * 
     C                     EXSR SPINFN
      * CASE: WRK.Return Code Usr is *Blank
     C           WUH3TX    IFEQ *BLANK                     *IF
      * Send message 'Print has been Submitted'
     C                     MOVEL'USR1832' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
      * Trailer ID formatting
      * CASE: DTL.Trailer ID USR EQ WRK.Blank for 12          USR
     C           #DS2TX    IFEQ WUS3TX                     *IF
     C                     MOVEL*BLANK    #1DXTX           Trailer Id
     C                     Z-ADD*ZERO     #1KKDT           On Yard Date
     C                     Z-ADD*ZERO     #DOYTM           USR On Yard Tim
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #1DXTX           Trailer Id
     C                     MOVEL#DS2TX    #1DXTX           Trailer Id
     C                     END                             *FI
      * F6 & F17: Trailer - do not allow if Warehouse Specific is true
      * CASE: PAR.Warehouse Specific Usr is Warehouse Specific Proc
     C           P3PRTX    IFEQ 'W'                        *IF
      * CASE: Do not allow Crt Trailer or WW Trailer
      *  - c1 OR c2
      *   |- c1    : DTL.*CMD key is CF06
      *   |- c2    : DTL.*CMD key is CF17
      *   '-
     C           *IN06     IFEQ '1'                        *IF
     C           *IN17     OREQ '1'                        *OR
      * Send message 'Function key not allowed'
     C                     MOVEL'USR1833' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * F6=Create Trailer
      * CASE: DTL.*CMD key is *Create
     C           *IN06     IFEQ '1'                        *IF
      * EDT Trailer            PV - PD Trailer  * 
     C                     CLEARPARC
     C                     MOVEL*BLANK    PABZNA    P      Carrier Code
     C                     MOVEL*BLANK    PADXTX    P      Trailer Id
      *
     C                     CALL 'PDI0PVR'              90  EDT Trailer
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Trailer Ma
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDI0PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * F17=WW Trailer
      * CASE: DTL.*CMD key is CF17
     C           *IN17     IFEQ '1'                        *IF
      * WW Trailer             DF - Trailer  * 
     C                     CALL 'PDGNDFR'              90  WW Trailer
     C                     PARM *BLANK    W0RTN   7
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGNDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
      * VAL:  Doors
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.USR Picked Up Time is Entered
      *   |- c2    : DTL.Load Status is Prior to Shipped
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #D        IFNE *ZERO                      *IF
     C           #1PKST    IFEQ 'C'                        *IF
     C           #1PKST    OREQ 'E'
     C           #1PKST    OREQ 'L'
     C           #1PKST    OREQ 'U'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: DTL.Load Door 1 USR is Not Entered
     C           #DM6NX    IFEQ *ZERO                      *IF
      * Setup message data for message
     C                     Z-ADD#DM6NX    ZA0012           Load Door 1 USR
      * Send message 'Door Required'
     C                     MOVEL'USR2998' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9942  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * Check relations
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate detail screen relations
      * Convert Trailer ID to all caps                        E004079
      * CASE: DTL.Trailer ID USR is Entered
     C           #DS2TX    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    YL0001           Case Sensitive
     C                     MOVEL#DS2TX    YL0001           Case Sensitive
      * CVT to Upper Alpha 3   XF - /UT User Source  * 
     C                     CALL 'PBSBXFR'              90  CVT to Upper Al
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0001    WQ0093 30        Case Sensitive
     C           YL0002    PARM *BLANK    WQ0094 30        Case Upper Fiel
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBSBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0002    #DS2TX           Trailer ID USR
     C                     END                             *FI
      * OMS245 - see Narrative for changes on 5/01/97
     C           #DXXTM    MULT 100       #1AJCM           Adjusted Depart
     C           #DT9NB    MULT 100       #1ASTM           Truck Departure
     C           #DBDTM    MULT 100       #1BLTM           BOL Received Ti
     C           #DCPTM    MULT 100       #1BOTM           BOL Complete Ti
     C           #DFDTM    MULT 100       #1LFTM           Load Finished T
     C           #D        MULT 100       #1SPTM           Spotted Time
     C           #DRDTM    MULT 100       #1TRTM           Truck Ready Tim
     C           #DOYTM    MULT 100       #1AVTM           On Yard Time
     C                     Z-ADD59        YL0022           test field two
      * Check times for minutes *gt 59
     C                     EXSR UBSUBR                     Check times for
      * OMS301 -- Validate Trailer    E001790--Error if Trailer is alread
      * CASE: IF Trailer is entered and has been changed.
      *  - c1 AND c2
      *   |- c1    : DTL.Trailer ID USR NE WRK.Blank for 12          USR
      *   |- c2    : DTL.Trailer ID USR NE WRK.Trailer Id            USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DS2TX    IFNE WUS3TX                     *IF
     C           #DS2TX    IFNE WUMUTX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ** Don't allow selection if trailer is used on another load  E001
      * ** Allow multiple carriers to use the same Trailer ID E002105
      * ** Validate ShipLine/Container or Carrier/Trailer ID  E004079
     C                     MOVEL#1BZNA    YL0014           Carrier Code
     C                     MOVEL#DS2TX    YL0013           Trailer ID USR
     C                     Z-ADD*ZERO     YL0033           Load ID USR
      * VAL Trailer assignmnt RT - Load Header  * 
     C                     EXSR SQRVGN
      * * Send message if trailer is used, else validate   E001790
      * CASE: PGM.*Return code is Trailer already assigned
     C           W0RTN     IFEQ @CN,006                    *IF
      * Setup message data for message
     C                     Z-ADDYL0034    ZA0021           Load Id 3
      * Send message 'Trailer is assigned...'
     C                     MOVEL'USR2822' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0035           Record Found US
      * * If Export, see if trailer has been assigned as OHE Container E0
      * CASE: DTL.Export Status is yes
     C           #1U2ST    IFEQ 'Y'                        *IF
     C                     MOVEL#DQXAA    YL0014           Carrier Code
     C                     MOVEL#DS2TX    YL0013           Trailer ID USR
      * ** See if Trailer ID exist in OHE             E002105
      * VAL Dup Assignd Contnr XF - Order Header Extension  * 
     C                     CALL 'PBDTXFR'              90  VAL Dup Assignd
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #DLOID    WQ0167  70       Load ID
     C                     PARM YL0013    WQ0168 12        OHE Container N
     C                     PARM YL0014    WQ0169  3        Carrier Code Us
     C           YL0034    PARM *ZERO     WQ0170  70       Load Id 1
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBDTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * CASE: PGM.*Return code is Trailer already assigned
     C           W0RTN     IFEQ @CN,006                    *IF
      * Setup message data for message
     C                     Z-ADDYL0034    ZA0022           Load Id 3
      * Send message 'Trailer is assigned...'
     C                     MOVEL'USR2822' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'Y'       YL0035           Record Found US
     C                     END                             *FI
     C                     END                             *FI
      * * Validate trailer if not assigned and not an Export container  E
      * CASE: LCL.Record Found USR is Record Not Found
     C           YL0035    IFEQ 'N'                        *IF
      * Rtv Trailer            RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0014    WL0006    P      Carrier Code
     C                     MOVELYL0013    WL0007    P      Trailer Id
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0008    YL0019           Company Number
     C                     MOVELWL0009    WUWNST    P      Load Type
     C                     MOVELWL0010    P2X3ST    P      Trailer Type
     C                     MOVELWL0011    P2XGST    P      Seaboard Owned
     C                     MOVELWL0012    P2STOY    P      On Yard Status
     C                     Z-ADDWL0013    WULMDT           On Yard Date
     C                     Z-ADDWL0014    WUA2TM           On Yard Time
     C                     MOVELWL0015    P2STAS    P      Assigned Status
     C                     MOVELWL0016    P2XRST    P      Available Statu
     C                     MOVELWL0017    P2X7CD    P      Not Available R
     C                     MOVELWL0018    P2GXTX    P      Comment Line
     C                     MOVELWL0019    P2VSST    P      Record Status
      * Validate trailer fields if found
      * CASE: WRK.USR Load Type is Blank
     C           WUWNST    IFEQ *BLANK                     *IF
      * C3819: Create trailer if it doesn't exist
      * Carrier required; otherwise info message
      * CASE: DTL.Carrier Code EQ WRK.BLANK
     C           #1BZNA    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVEL#1BZNA    ZA0023           Carrier Code
      * Send message 'Carrier req to enter trlr'
     C                     MOVEL'USR2668' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Trailer will be created'
     C                     MOVEL'USR2667' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
      * If wrk.OYD New is zeros, update with today's date   E004079
      * CASE: WRK.USR On Yard Date New is not entered
     C           WULMDT    IFEQ *ZERO                      *IF
      * * If trailer is new, update screen fields with new info   E004079
      * DTL.On Yard Date = PAR.Current System Date
     C                     Z-ADDP5SDTE    #1KKDT           On Yard Date
     C                     Z-ADD##JTM     #1AVTM           On Yard Time
     C           #1AVTM    DIV  100       #DOYTM           USR On Yard Tim
     C                     Z-ADD#1KKDT    P1KKDT           On Yard Date
     C                     Z-ADD#1AVTM    P1AVTM           On Yard Time
     C                     MOVEL'N'       P2XGST           Seaboard Owned
     C                     MOVEL'Y'       P2STOY           On Yard Status
     C                     MOVEL'Y'       P2STAS           Assigned Status
     C                     MOVEL'N'       P2XRST           Available Statu
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Warning if Trailer Co# <> Load Start Co#             E00117 3/
      * CASE: LCL.Company Number NE DTL.Company Number
     C           YL0019    IFNE #1AIC3                     *IF
      * Setup message data for message
     C                     MOVEL#DS2TX    ZA0024           Trailer ID USR
      * Send message 'Trailer Co#<>Ld Str Co#'
     C                     MOVEL'USR3902' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
      *  Load the On Yard Date/Time
      * CASE: WRK.USR On Yard Date New is Entered
     C           WULMDT    IFNE *ZERO                      *IF
     C                     Z-ADDWULMDT    #1KKDT           On Yard Date
     C                     Z-ADDWUA2TM    #1AVTM           On Yard Time
     C           #1AVTM    DIV  100       #DOYTM           USR On Yard Tim
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.Truck Ready Date is not entered
      *   |- c2    : DTL.On Yard Date is not entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1J4DT    IFEQ *ZERO                      *IF
     C           #1KKDT    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * DTL.On Yard Date = PAR.Current System Date
     C                     Z-ADDP5SDTE    #1KKDT           On Yard Date
     C                     Z-ADD##JTM     #1AVTM           On Yard Time
     C           #1AVTM    DIV  100       #DOYTM           USR On Yard Tim
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.On Yard Date is not entered
     C           #1KKDT    IFEQ *ZERO                      *IF
     C                     Z-ADD*ZERO     #1KKDT           On Yard Date
     C                     Z-ADD*ZERO     #1AVTM           On Yard Time
     C                     Z-ADD*ZERO     #DOYTM           USR On Yard Tim
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Load Type
      * CASE: WRK.USR Load Type NE DTL.Load Type
     C           WUWNST    IFNE #1VDST                     *IF
      * Setup message data for message
     C                     MOVEL#1VDST    ZA0025           Load Type
     C                     MOVELWUWNST    ZA0026           USR Load Type
     C                     MOVEL#DS2TX    ZA0027           Trailer ID USR
      * Send message 'Load type must match load'
     C                     MOVEL'USR2613' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     END                             *FI
      * Assigned Sts
      * CASE: PAR.Assigned Status is yes
     C           P2STAS    IFEQ 'Y'                        *IF
     C                     Z-ADD*ZERO     YL0036           USR Load Assign
      * RTV Load ID for Trailr RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#DLOID    WL0058           Load ID
     C                     MOVELYL0013    WL0060    P      Trailer Id
     C                     MOVELYL0014    WL0061    P      Carrier Code
     C                     MOVELWUZJST    WL0062    P      USR Active Load
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0059    YL0019           Company Number
     C                     MOVELWL0062    WUZJST    P      USR Active Load
     C                     Z-ADDWL0063    WUL1LD           USR Load Assign
      * CASE: WRK.USR Active Load is yes
     C           WUZJST    IFEQ 'Y'                        *IF
      * CASE: DTL.Truck Departure Date is not entered
     C           #1KIDT    IFEQ *ZERO                      *IF
      * Setup message data for message
     C                     MOVELYL0013    ZA0028           Trailer ID USR
     C                     Z-ADDWUL1LD    ZA0029           USR Load Assign
      * Send message 'Trailer is already assgnd'
     C                     MOVEL'USR2618' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVELYL0013    ZA0030           Trailer ID USR
     C                     Z-ADDWUL1LD    ZA0031           USR Load Assign
      * Send message 'Trail dprting is assignd'
     C                     MOVEL'USR2622' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * On Yard
      * CASE: WRK.USR On Yard Date New is not entered
     C           WULMDT    IFEQ *ZERO                      *IF
      * Setup message data for message
     C                     MOVELYL0013    ZA0032           Trailer ID USR
      * Send message 'Trailer is not On Yard.'
     C                     MOVEL'USR2619' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
      * Available Sts
      * CASE: PAR.Available Status is Not Yes
     C           P2XRST    IFEQ *BLANK                     *IF
     C           P2XRST    OREQ 'N'
      * Setup message data for message
     C                     MOVELYL0013    ZA0033           Trailer ID USR
      * Send message 'Trailer is not Available.'
     C                     MOVEL'USR2616' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
      * Seaboard Owned
      * CASE: PAR.Seaboard Owned Status is yes
     C           P2XGST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVELYL0013    ZA0034           Trailer ID USR
      * Send message 'Trailer is Sbd owned.'
     C                     MOVEL'USR2617' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Edit Adjusted Departure Date & Time
      * CASE: DTL.Adjusted Departure Date is Entered
     C           #1KADT    IFNE *ZERO                      *IF
      * CASE: DTL.Truck Departure Date is not entered
     C           #1KIDT    IFEQ *ZERO                      *IF
      * Setup message data for message
      * Convert Adjusted Departure Date to display format
      * Convert date
     C           1000000   ADD  #1KADT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0035
     C                     Z-ADD#DXXTM    ZA0036           Departure Time
      * Send message 'Previous date/time not e'
     C                     MOVEL'USR2430' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Adjusted Departure Date LT DTL.Truck Departure Date
     C           #1KADT    IFLT #1KIDT                     *IF
      * Setup message data for message
      * Convert Adjusted Departure Date to display format
      * Convert date
     C           1000000   ADD  #1KADT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0037
     C                     Z-ADD#DXXTM    ZA0038           Departure Time
      * Send message 'Invalid date/time entries'
     C                     MOVEL'USR2422' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DTL.Adjusted Departure Date EQ DTL.Truck Departure D
      *   |- c2    : DTL.Adjusted Departure Time LE DTL.Truck Departure T
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1KADT    IFEQ #1KIDT                     *IF
     C           #1AJCM    IFLE #1ASTM                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Convert Adjusted Departure Date to display format
      * Convert date
     C           1000000   ADD  #1KADT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0039
     C                     Z-ADD#DXXTM    ZA0040           Departure Time
      * Send message 'Invalid date/time entries'
     C                     MOVEL'USR2422' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Verify Trffc Cmnts RT - PD Traffic Comments  * 
     C                     EXSR SSRVGN
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ @CN,007                    *IF
      * Send message 'Warning Traffic Comm Req'
     C                     MOVEL'USR2450' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Adjusted Departure Date to display format
      * Convert date
     C           1000000   ADD  #1KADT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0041
      * Send message 'Traffic Comments Required'
     C                     MOVEL'USR2425' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9953  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Edit Truck Departure Date & Time
      * CASE: DTL.Truck Departure Date is Entered
     C           #1KIDT    IFNE *ZERO                      *IF
      * CASE: DTL.BOL Received Date is not entered
     C           #1J8DT    IFEQ *ZERO                      *IF
      * Setup message data for message
      * Convert Truck Departure Date to display format
      * Convert date
     C           1000000   ADD  #1KIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0042
     C                     Z-ADD#DT9NB    ZA0043           USR Delivery Af
      * Send message 'Previous date/time not e'
     C                     MOVEL'USR2430' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Truck Departure Date LT DTL.BOL Received Date
     C           #1KIDT    IFLT #1J8DT                     *IF
      * Setup message data for message
      * Convert Truck Departure Date to display format
      * Convert date
     C           1000000   ADD  #1KIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0044
     C                     Z-ADD#DT9NB    ZA0045           USR Delivery Af
      * Send message 'Invalid date/time entries'
     C                     MOVEL'USR2422' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Truck Departure Time is Not Entered
     C           #1ASTM    IFEQ *ZERO                      *IF
      * Setup message data for message
     C                     Z-ADD#DT9NB    ZA0046           USR Delivery Af
      * Send message 'Time Required'
     C                     MOVEL'USR2333' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9952  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Validate later than received dt/tm
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DTL.Truck Departure Date EQ DTL.BOL Received Date
      *   |- c2    : DTL.Truck Departure Time LE DTL.BOL Received Time
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1KIDT    IFEQ #1J8DT                     *IF
     C           #1ASTM    IFLE #1BLTM                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Convert Truck Departure Date to display format
      * Convert date
     C           1000000   ADD  #1KIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0047
     C                     Z-ADD#DT9NB    ZA0048           USR Delivery Af
      * Send message 'Invalid date/time entries'
     C                     MOVEL'USR2422' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Edit BOL Received Date & Time
      * CASE: DTL.BOL Received Date is Entered
     C           #1J8DT    IFNE *ZERO                      *IF
      * CASE: DTL.BOL Complete Date is not entered
     C           #1J7DT    IFEQ *ZERO                      *IF
      * Setup message data for message
      * Convert BOL Received Date to display format
      * Convert date
     C           1000000   ADD  #1J8DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0049
     C                     Z-ADD#DBDTM    ZA0050           USR Billed Time
      * Send message 'Previous date/time not e'
     C                     MOVEL'USR2430' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.BOL Received Date LT DTL.BOL Complete Date
     C           #1J8DT    IFLT #1J7DT                     *IF
      * Setup message data for message
      * Convert BOL Received Date to display format
      * Convert date
     C           1000000   ADD  #1J8DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0051
     C                     Z-ADD#DBDTM    ZA0052           USR Billed Time
      * Send message 'Invalid date/time entries'
     C                     MOVEL'USR2422' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DTL.BOL Received Date EQ DTL.BOL Complete Date
      *   |- c2    : DTL.BOL Received Time LE DTL.BOL Complete Time
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1J8DT    IFEQ #1J7DT                     *IF
     C           #1BLTM    IFLE #1BOTM                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Convert BOL Received Date to display format
      * Convert date
     C           1000000   ADD  #1J8DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0053
     C                     Z-ADD#DBDTM    ZA0054           USR Billed Time
      * Send message 'Invalid date/time entries'
     C                     MOVEL'USR2422' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Edit BOL Complete Date & Time
      * CASE: DTL.BOL Complete Date is Entered
     C           #1J7DT    IFNE *ZERO                      *IF
      * CASE: DTL.Load Finished Date is not entered
     C           #1J6DT    IFEQ *ZERO                      *IF
      * Setup message data for message
      * Convert BOL Complete Date to display format
      * Convert date
     C           1000000   ADD  #1J7DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0055
     C                     Z-ADD#DCPTM    ZA0056           USR Complete Ti
      * Send message 'Previous date/time not e'
     C                     MOVEL'USR2430' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.BOL Complete Date LT DTL.Load Finished Date
     C           #1J7DT    IFLT #1J6DT                     *IF
      * Setup message data for message
      * Convert BOL Complete Date to display format
      * Convert date
     C           1000000   ADD  #1J7DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0057
     C                     Z-ADD#DCPTM    ZA0058           USR Complete Ti
      * Send message 'Invalid date/time entries'
     C                     MOVEL'USR2422' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DTL.BOL Complete Date EQ DTL.Load Finished Date
      *   |- c2    : DTL.BOL Complete Time LE DTL.Load Finished Time
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1J7DT    IFEQ #1J6DT                     *IF
     C           #1BOTM    IFLE #1LFTM                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Convert BOL Complete Date to display format
      * Convert date
     C           1000000   ADD  #1J7DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0059
     C                     Z-ADD#DCPTM    ZA0060           USR Complete Ti
      * Send message 'Invalid date/time entries'
     C                     MOVEL'USR2422' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Edit Load Finished Date & Time
      * CASE: DTL.Load Finished Date is Entered
     C           #1J6DT    IFNE *ZERO                      *IF
      * CASE: DTL.Spotted Date is not entered
     C           #1J5DT    IFEQ *ZERO                      *IF
      * Setup message data for message
      * Convert Load Finished Date to display format
      * Convert date
     C           1000000   ADD  #1J6DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0061
     C                     Z-ADD#DFDTM    ZA0062           USR Finished Ti
      * Send message 'Previous date/time not e'
     C                     MOVEL'USR2430' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Load Finished Date LT DTL.Spotted Date
     C           #1J6DT    IFLT #1J5DT                     *IF
      * Setup message data for message
      * Convert Load Finished Date to display format
      * Convert date
     C           1000000   ADD  #1J6DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0063
     C                     Z-ADD#DFDTM    ZA0064           USR Finished Ti
      * Send message 'Invalid date/time entries'
     C                     MOVEL'USR2422' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DTL.Load Finished Date EQ DTL.Spotted Date
      *   |- c2    : DTL.Load Finished Time LE DTL.Spotted Time
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1J6DT    IFEQ #1J5DT                     *IF
     C           #1LFTM    IFLE #1SPTM                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Convert Load Finished Date to display format
      * Convert date
     C           1000000   ADD  #1J6DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0065
     C                     Z-ADD#DFDTM    ZA0066           USR Finished Ti
      * Send message 'Invalid date/time entries'
     C                     MOVEL'USR2422' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Edit Spotted Date & Time
      * CASE: DTL.Spotted Date is Entered
     C           #1J5DT    IFNE *ZERO                      *IF
      * CASE: DTL.Truck Ready Date is not entered
     C           #1J4DT    IFEQ *ZERO                      *IF
      * Setup message data for message
      * Convert Spotted Date to display format
      * Convert date
     C           1000000   ADD  #1J5DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0067
     C                     Z-ADD#D        ZA0068           USR Picked Up T
      * Send message 'Previous date/time not e'
     C                     MOVEL'USR2430' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Spotted Date LT DTL.Truck Ready Date
     C           #1J5DT    IFLT #1J4DT                     *IF
      * Setup message data for message
      * Convert Spotted Date to display format
      * Convert date
     C           1000000   ADD  #1J5DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0069
     C                     Z-ADD#D        ZA0070           USR Picked Up T
      * Send message 'Invalid date/time entries'
     C                     MOVEL'USR2422' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DTL.Spotted Date EQ DTL.Truck Ready Date
      *   |- c2    : DTL.Spotted Time LE DTL.Truck Ready Time
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1J5DT    IFEQ #1J4DT                     *IF
     C           #1SPTM    IFLE #1TRTM                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Convert Spotted Date to display format
      * Convert date
     C           1000000   ADD  #1J5DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0071
     C                     Z-ADD#D        ZA0072           USR Picked Up T
      * Send message 'Invalid date/time entries'
     C                     MOVEL'USR2422' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Edit Truck Ready Date & Time
      * CASE: DTL.Truck Ready Date is Entered
     C           #1J4DT    IFNE *ZERO                      *IF
      * CASE: DTL.On Yard Date is not entered
     C           #1KKDT    IFEQ *ZERO                      *IF
      * Setup message data for message
      * Convert Truck Ready Date to display format
      * Convert date
     C           1000000   ADD  #1J4DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0073
     C                     Z-ADD#DRDTM    ZA0074           USR Ready Time
      * Send message 'Previous date/time not e'
     C                     MOVEL'USR2430' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.Truck Ready Date LT DTL.On Yard Date
     C           #1J4DT    IFLT #1KKDT                     *IF
      * Setup message data for message
      * Convert Truck Ready Date to display format
      * Convert date
     C           1000000   ADD  #1J4DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0075
     C                     Z-ADD#DRDTM    ZA0076           USR Ready Time
      * Send message 'Invalid date/time entries'
     C                     MOVEL'USR2422' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Load ID USR required
     C           #DLOID    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         EAPMCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert internal to external form
     C                     EXSR MOCV#D
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Update screen time
     C                     TIME           ##TME
      * Refresh screen
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT2
     C                     WRITE#RCDDTL1
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO EAEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPR##    BEGSR
      *================================================================
      * Process record:
      *================================================================
      * Process update request
     C           W0PMD     CASNE'ADD'     EECHRQ
     C                     END
     C           W0RTN     IFEQ *BLANK
      * USER: Process command keys
     C                     Z-ADD#DLOID    P1RMNB           Load ID
     C                     Z-ADD#1AIC3    P1AIC3           Company Number
      * *** OMS301 --  Update Trailer File
      * ** If Load is reassigned to a different Trailer, update the
      * ** original Trailer from the Trailer file.
      * ** and then add a record to Load Order Change Log     E001790 12/
      * log the trailer assignment or change
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.Trailer ID USR NE WRK.Trailer Id            USR
      *   |- c2    : WRK.Trailer Id            USR NE WRK.Blank for 12
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DS2TX    IFNE WUMUTX                     *IF
     C           WUMUTX    IFNE WUS3TX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Update of the trailer file is in the chgobj, rmvd from here  E004
      * Write log record if trailer has been changed          e004079
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADD#1RMNB    PBRMNB           Load ID
     C                     Z-ADD*ZERO     PBRVNB           Stop_Drop
     C                     MOVEL'ASNTRL'  PBRVST    P      Load Change Typ
     C                     MOVEL'TRF'     PBUJST    P      Department Cont
     C                     MOVELWUMUTX    PBMNTX    P      Change Log Prio
     C                     MOVEL#DS2TX    PBMOTX    P      Change Log New
     C                     MOVEL#1AYNA    PBAYNA    P      User Id
     C                     MOVEL#1A0NA    PBA0NA    P      Job Name
     C                     MOVEL#1BZNA    PBBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PBAIC3           Company Number
     C                     Z-ADD*ZERO     PBC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993332*
     C                     END
      * S00549 RMC 11/07/8 download to carlisle if load is locked,and pfs
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DTL.Load Status is Lock
      *   |- c2    : LCL.PFS Carlisle Active is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1PKST    IFEQ 'L'                        *IF
     C           YL0037    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PFS Lock Load/Order   XF - PFS Load Header  * 
     C                     CALL 'PPNLXFR'              90  PFS Lock Load/O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0171  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Update the Trailer if assigned or on yard or departure dates chan
      * CASE: DTL.Trailer ID USR NE WRK.Blank for 12          USR
     C           #DS2TX    IFNE WUS3TX                     *IF
      * On Yard Date & Truck Departure Date tests
      * CASE: DTL.On Yard Date is Entered
     C           #1KKDT    IFNE *ZERO                      *IF
      * CASE: DTL.Truck Departure Date is not entered
     C           #1KIDT    IFEQ *ZERO                      *IF
      * Flag trailer as assigned/unavailable
     C                     MOVEL'Y'       P2STOY           On Yard Status
     C                     MOVEL'N'       P2XRST           Available Statu
     C                     MOVEL'Y'       P2STAS           Assigned Status
     C                     Z-ADD#1KKDT    WULNDT           On Yard Date-Tr
     C                     Z-ADD#1AVTM    WUA3TM           On Yard Time-Tr
      * Rtv/Chg Assg Trailer   RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1BZNA    WL0064    P      Carrier Code
     C                     MOVEL#DS2TX    WL0065    P      Trailer Id
     C                     Z-ADD#1AIC3    WL0066           Company Number
     C                     MOVELP2STOY    WL0067    P      On Yard Status
     C                     Z-ADDWULNDT    WL0068           On Yard Date
     C                     Z-ADDWUA3TM    WL0069           On Yard Time
     C                     MOVELP2STAS    WL0070    P      Assigned Status
     C                     MOVELP2XRST    WL0071    P      Available Statu
     C                     MOVELP2GXTX    WL0072    P      Comment Line
     C                     EXSR STRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD*ZERO     WUNKDT           Blank Date
      * If Truck has Departed, delete trailer record          E004079
      * CASE: DTL.Truck Departure Date is Entered
     C           #1KIDT    IFNE *ZERO                      *IF
      * DLT Trailer            DO - Trailer  * E004079
     C                     EXSR SVDLRC
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
     C                     END                             *FI
      * ***
      * Restart program for next record
     C                     MOVEL'N'       W0TRN
     C                     END
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         EECHRQ    BEGSR
      *================================================================
      * Process update request
      *================================================================
      * USER: Change DBF record
      *
     C                     MOVEL*BLANK    WN0003  1        On Yard Status
     C                     MOVEL*BLANK    WN0004  1        Assigned Status
     C                     MOVEL*BLANK    WN0005  1        Available Statu
     C                     MOVEL*BLANK    WN0006  1        Record Status
     C                     Z-ADD*ZERO     WN0007  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0008  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0009  40       Requested Deliv
      *
      * CHG Ld Head/Trlr/Cstsv IF
      * RMC 6/21/06 dont update the bol complete dt/time
      * RMC If Trailer, bol rcvd, depart, adj depart changes: Write TMS o
      * Pre set On Yard, Assigned for Trailer
      * CASE: PAR.On Yard Date EQ WRK.ZERO
     C           #1KKDT    IFEQ WUW0NB                     *IF
     C                     MOVEL'N'       WN0003           On Yard Status
     C                     MOVEL'N'       WN0005           Available Statu
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WN0003           On Yard Status
     C                     MOVEL'Y'       WN0005           Available Statu
     C                     END                             *FI
      * CASE: PAR.MG Created Load is Not MG Created Load
     C           #1RYSX    IFEQ *BLANK                     *IF
      * CLC Deadline Date/Time XF - Load Detail  * 
     C                     CALL 'PMP9XFR'              90  CLC Deadline Da
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #DLOID    WQ0172  70       Load ID
     C           WN0007    PARM WN0007    WQ0173  70       Deadline Depart
     C           WN0008    PARM *ZERO     WQ0174  60       Deadline Depart
     C           YL0038    PARM *ZERO     WQ0175  70       Requested Deliv
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMP9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#1KZDT    WN0007           Deadline Depart
     C                     Z-ADD#1AXTM    WN0008           Deadline Depart
     C                     END                             *FI
      * CHG Load Cust Service  CH - Load Header  * 
     C                     EXSR SWCHRC
      * * Trailer can now be added if not on yard, update dt/tm here  E00
      * Use ShipLine/Cntnr if entered, else Carr/Trlr & upd   E004079
      * CASE: PAR.Shipping Line is entered
     C           #DQXAA    IFNE *BLANK                     *IF
     C                     MOVEL#DQXAA    YL0045           Carrier Code
     C                     MOVEL#DS2TX    YL0046           Trailer Id
      * RTV UPD Cntnr-ords/ld  XF - Order Header Extension  * 
     C                     CALL 'PBRXXFR'              90  RTV UPD Cntnr-o
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #DLOID    WQ0191  70       Load ID
     C                     PARM #DQXAA    WQ0192  3        Shipping Line
     C                     PARM YL0046    WQ0193 12        OHE Container N
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBRXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#1BZNA    YL0045           Carrier Code
     C                     MOVEL#DS2TX    YL0046           Trailer Id
     C                     END                             *FI
      * Create or change trailer
      * CASE: LCL.Trailer Id NE WRK.Blank for 30          USR
     C           YL0046    IFNE WUW4TX                     *IF
      * Rtv Trailer            RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0045    WL0006    P      Carrier Code
     C                     MOVELYL0046    WL0007    P      Trailer Id
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0008    YL0047           Company Number
     C                     MOVELWL0009    YL0048    P      Load Type
     C                     MOVELWL0010    YL0049    P      Trailer Type
     C                     MOVELWL0011    YL0050    P      Seaboard Owned
     C                     MOVELWL0012    YL0051    P      On Yard Status
     C                     Z-ADDWL0013    YL0052           On Yard Date
     C                     Z-ADDWL0014    YL0053           On Yard Time
     C                     MOVELWL0015    YL0054    P      Assigned Status
     C                     MOVELWL0016    YL0055    P      Available Statu
     C                     MOVELWL0017    YL0056    P      Not Available R
     C                     MOVELWL0018    YL0057    P      Comment Line
     C                     MOVELWL0019    WN0006    P      Record Status
      * If trailer does not exist, add it, else update it     E002966
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Create trailer
      * CASE: PAR.Load Type is Regular
     C           #1VDST    IFEQ 'R'                        *IF
      * Regular:  Reefer
      * Crt PD Trailer         CR - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0045    WL0104    P      Carrier Code
     C                     MOVELYL0046    WL0105    P      Trailer Id
     C                     Z-ADD#DAOC3    WL0106           Company Number
     C                     MOVEL#1VDST    WL0107    P      Load Type
     C                     MOVEL'R'       WL0108    P      Trailer Type
     C                     MOVEL'N'       WL0109    P      Seaboard Owned
     C                     MOVEL'Y'       WL0110    P      On Yard Status
     C                     Z-ADD##JDT     WL0111           On Yard Date
     C                     Z-ADD##JTM     WL0112           On Yard Time
     C                     MOVEL'Y'       WL0113    P      Assigned Status
     C                     MOVEL'N'       WL0114    P      Available Statu
     C                     MOVELWUGSTX    WL0115    P      Not Available R
     C                     MOVEL*BLANK    WL0116           Comment Line
     C                     MOVELWUGSTX    WL0117    P      Status Unused 1
     C                     MOVELWUGSTX    WL0118    P      Status Unused 2
     C                     MOVELWUGSTX    WL0119    P      Status Unused 3
     C                     MOVELWUGSTX    WL0120    P      Status Unused 4
     C                     MOVELWUGSTX    WL0121    P      Status Unused 5
     C                     Z-ADDWUW0NB    WL0122           Date Unused 1
     C                     Z-ADDWUW0NB    WL0123           Date Unused 2
     C                     Z-ADDWUW0NB    WL0124           Date Unused 3
     C                     Z-ADDWUW0NB    WL0125           Date Unused 4
     C                     Z-ADDWUW0NB    WL0126           Date Unused 5
     C                     MOVELWUGSTX    WL0127    P      EDI Status 1
     C                     MOVELWUGSTX    WL0128    P      EDI Status 2
     C                     MOVELWUGSTX    WL0129    P      EDI Status 3
     C                     MOVEL'A'       WL0130    P      Record Status
     C                     Z-ADD##JTM     WL0131           Job Time
     C                     MOVEL##USR     WL0132    P      User Id
     C                     MOVEL##PGM     WL0133    P      Job Name
     C                     Z-ADD##JDT     WL0134           Job Date
     C                     EXSR SXCRRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Bulk:  Tanker
      * Crt PD Trailer         CR - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0045    WL0104    P      Carrier Code
     C                     MOVELYL0046    WL0105    P      Trailer Id
     C                     Z-ADD#DAOC3    WL0106           Company Number
     C                     MOVEL#1VDST    WL0107    P      Load Type
     C                     MOVEL'T'       WL0108    P      Trailer Type
     C                     MOVEL'N'       WL0109    P      Seaboard Owned
     C                     MOVEL'Y'       WL0110    P      On Yard Status
     C                     Z-ADD##JDT     WL0111           On Yard Date
     C                     Z-ADD##JTM     WL0112           On Yard Time
     C                     MOVEL'Y'       WL0113    P      Assigned Status
     C                     MOVEL'N'       WL0114    P      Available Statu
     C                     MOVELWUGSTX    WL0115    P      Not Available R
     C                     MOVEL*BLANK    WL0116           Comment Line
     C                     MOVELWUGSTX    WL0117    P      Status Unused 1
     C                     MOVELWUGSTX    WL0118    P      Status Unused 2
     C                     MOVELWUGSTX    WL0119    P      Status Unused 3
     C                     MOVELWUGSTX    WL0120    P      Status Unused 4
     C                     MOVELWUGSTX    WL0121    P      Status Unused 5
     C                     Z-ADDWUW0NB    WL0122           Date Unused 1
     C                     Z-ADDWUW0NB    WL0123           Date Unused 2
     C                     Z-ADDWUW0NB    WL0124           Date Unused 3
     C                     Z-ADDWUW0NB    WL0125           Date Unused 4
     C                     Z-ADDWUW0NB    WL0126           Date Unused 5
     C                     MOVELWUGSTX    WL0127    P      EDI Status 1
     C                     MOVELWUGSTX    WL0128    P      EDI Status 2
     C                     MOVELWUGSTX    WL0129    P      EDI Status 3
     C                     MOVEL'A'       WL0130    P      Record Status
     C                     Z-ADD##JTM     WL0131           Job Time
     C                     MOVEL##USR     WL0132    P      User Id
     C                     MOVEL##PGM     WL0133    P      Job Name
     C                     Z-ADD##JDT     WL0134           Job Date
     C                     EXSR SXCRRC
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * trailer on file
      * Update current/new trailer from dispatcher screen
      * CASE: PAR.Record Status is Active
     C           WN0006    IFEQ 'A'                        *IF
      * CHG Asgn, Avail, On Yd CH - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0045    WL0135    P      Carrier Code
     C                     MOVELYL0046    WL0136    P      Trailer Id
     C                     Z-ADD#DAOC3    WL0137           Company Number
     C                     MOVELYL0051    WL0138    P      On Yard Status
     C                     Z-ADDYL0052    WL0139           On Yard Date
     C                     Z-ADDYL0053    WL0140           On Yard Time
     C                     MOVEL'Y'       WL0141    P      Assigned Status
     C                     MOVEL'N'       WL0142    P      Available Statu
     C                     MOVEL'A'       WL0143    P      Record Status
     C                     EXSR SYCHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * If trailer on file but inactive, update
      * Regular versus Bulk
      * CASE: PAR.Load Type is Regular
     C           #1VDST    IFEQ 'R'                        *IF
      * Regular:  Reefer
      * Chg PD Trailer         CH - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0045    WL0073    P      Carrier Code
     C                     MOVELYL0046    WL0074    P      Trailer Id
     C                     Z-ADD#DAOC3    WL0075           Company Number
     C                     MOVEL#1VDST    WL0076    P      Load Type
     C                     MOVEL'R'       WL0077    P      Trailer Type
     C                     MOVEL'N'       WL0078    P      Seaboard Owned
     C                     MOVELYL0051    WL0079    P      On Yard Status
     C                     Z-ADDYL0052    WL0080           On Yard Date
     C                     Z-ADDYL0053    WL0081           On Yard Time
     C                     MOVEL'Y'       WL0082    P      Assigned Status
     C                     MOVEL'N'       WL0083    P      Available Statu
     C                     MOVELWUGSTX    WL0084    P      Not Available R
     C                     MOVEL*BLANK    WL0085           Comment Line
     C                     MOVELWUGSTX    WL0086    P      Status Unused 1
     C                     MOVELWUGSTX    WL0087    P      Status Unused 2
     C                     MOVELWUGSTX    WL0088    P      Status Unused 3
     C                     MOVELWUGSTX    WL0089    P      Status Unused 4
     C                     MOVELWUGSTX    WL0090    P      Status Unused 5
     C                     Z-ADDWUW0NB    WL0091           Date Unused 1
     C                     Z-ADDWUW0NB    WL0092           Date Unused 2
     C                     Z-ADDWUW0NB    WL0093           Date Unused 3
     C                     Z-ADDWUW0NB    WL0094           Date Unused 4
     C                     Z-ADDWUW0NB    WL0095           Date Unused 5
     C                     MOVELWUGSTX    WL0096    P      EDI Status 1
     C                     MOVELWUGSTX    WL0097    P      EDI Status 2
     C                     MOVELWUGSTX    WL0098    P      EDI Status 3
     C                     MOVEL'A'       WL0099    P      Record Status
     C                     Z-ADD##JTM     WL0100           Job Time
     C                     MOVEL##USR     WL0101    P      User Id
     C                     MOVEL##PGM     WL0102    P      Job Name
     C                     Z-ADD##JDT     WL0103           Job Date
     C                     EXSR SUCHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Bulk:  Tanker
      * Chg PD Trailer         CH - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0045    WL0073    P      Carrier Code
     C                     MOVELYL0046    WL0074    P      Trailer Id
     C                     Z-ADD#DAOC3    WL0075           Company Number
     C                     MOVEL#1VDST    WL0076    P      Load Type
     C                     MOVEL'T'       WL0077    P      Trailer Type
     C                     MOVEL'N'       WL0078    P      Seaboard Owned
     C                     MOVELYL0051    WL0079    P      On Yard Status
     C                     Z-ADDYL0052    WL0080           On Yard Date
     C                     Z-ADDYL0053    WL0081           On Yard Time
     C                     MOVEL'Y'       WL0082    P      Assigned Status
     C                     MOVEL'N'       WL0083    P      Available Statu
     C                     MOVELWUGSTX    WL0084    P      Not Available R
     C                     MOVEL*BLANK    WL0085           Comment Line
     C                     MOVELWUGSTX    WL0086    P      Status Unused 1
     C                     MOVELWUGSTX    WL0087    P      Status Unused 2
     C                     MOVELWUGSTX    WL0088    P      Status Unused 3
     C                     MOVELWUGSTX    WL0089    P      Status Unused 4
     C                     MOVELWUGSTX    WL0090    P      Status Unused 5
     C                     Z-ADDWUW0NB    WL0091           Date Unused 1
     C                     Z-ADDWUW0NB    WL0092           Date Unused 2
     C                     Z-ADDWUW0NB    WL0093           Date Unused 3
     C                     Z-ADDWUW0NB    WL0094           Date Unused 4
     C                     Z-ADDWUW0NB    WL0095           Date Unused 5
     C                     MOVELWUGSTX    WL0096    P      EDI Status 1
     C                     MOVELWUGSTX    WL0097    P      EDI Status 2
     C                     MOVELWUGSTX    WL0098    P      EDI Status 3
     C                     MOVEL'A'       WL0099    P      Record Status
     C                     Z-ADD##JTM     WL0100           Job Time
     C                     MOVEL##USR     WL0101    P      User Id
     C                     MOVEL##PGM     WL0102    P      Job Name
     C                     Z-ADD##JDT     WL0103           Job Date
     C                     EXSR SUCHRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * If Trailer chgd, wrt Ld Ord Chg Log & Upd orig trailer      E0040
      * CASE: PAR.Trailer Id NE PAR.Trailer Id            USR
     C           #DS2TX    IFNE WUMUTX                     *IF
      * Update the original trailer (chgd from) to available     E004079
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Trailer Id            USR is Entered
      *   |- c2    : PAR.Trailer Id            USR NE PAR.Trailer Id
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUMUTX    IFNE *BLANK                     *IF
     C           WUMUTX    IFNE #DS2TX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv info for the original trailer                     E004079
      * Rtv Trailer            RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0045    WL0006    P      Carrier Code
     C                     MOVELWUMUTX    WL0007    P      Trailer Id
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0008    YL0047           Company Number
     C                     MOVELWL0009    YL0048    P      Load Type
     C                     MOVELWL0010    YL0049    P      Trailer Type
     C                     MOVELWL0011    YL0050    P      Seaboard Owned
     C                     MOVELWL0012    YL0051    P      On Yard Status
     C                     Z-ADDWL0013    YL0052           On Yard Date
     C                     Z-ADDWL0014    YL0053           On Yard Time
     C                     MOVELWL0015    YL0054    P      Assigned Status
     C                     MOVELWL0016    YL0055    P      Available Statu
     C                     MOVELWL0017    YL0056    P      Not Available R
     C                     MOVELWL0018    YL0057    P      Comment Line
     C                     MOVELWL0019    YL0058    P      Record Status
      * not an error if trailer not found                     E004079
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
      * Create trailer
      * CASE: PAR.Load Type is Regular
     C           #1VDST    IFEQ 'R'                        *IF
      * Regular:  Reefer
      * Crt PD Trailer         CR - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0045    WL0104    P      Carrier Code
     C                     MOVELWUMUTX    WL0105    P      Trailer Id
     C                     Z-ADD#DAOC3    WL0106           Company Number
     C                     MOVEL#1VDST    WL0107    P      Load Type
     C                     MOVEL'R'       WL0108    P      Trailer Type
     C                     MOVEL'N'       WL0109    P      Seaboard Owned
     C                     MOVEL'Y'       WL0110    P      On Yard Status
     C                     Z-ADD##JDT     WL0111           On Yard Date
     C                     Z-ADD##JTM     WL0112           On Yard Time
     C                     MOVEL'N'       WL0113    P      Assigned Status
     C                     MOVEL'Y'       WL0114    P      Available Statu
     C                     MOVELWUGSTX    WL0115    P      Not Available R
     C                     MOVEL*BLANK    WL0116           Comment Line
     C                     MOVELWUGSTX    WL0117    P      Status Unused 1
     C                     MOVELWUGSTX    WL0118    P      Status Unused 2
     C                     MOVELWUGSTX    WL0119    P      Status Unused 3
     C                     MOVELWUGSTX    WL0120    P      Status Unused 4
     C                     MOVELWUGSTX    WL0121    P      Status Unused 5
     C                     Z-ADDWUW0NB    WL0122           Date Unused 1
     C                     Z-ADDWUW0NB    WL0123           Date Unused 2
     C                     Z-ADDWUW0NB    WL0124           Date Unused 3
     C                     Z-ADDWUW0NB    WL0125           Date Unused 4
     C                     Z-ADDWUW0NB    WL0126           Date Unused 5
     C                     MOVELWUGSTX    WL0127    P      EDI Status 1
     C                     MOVELWUGSTX    WL0128    P      EDI Status 2
     C                     MOVELWUGSTX    WL0129    P      EDI Status 3
     C                     MOVEL'A'       WL0130    P      Record Status
     C                     Z-ADD##JTM     WL0131           Job Time
     C                     MOVEL##USR     WL0132    P      User Id
     C                     MOVEL##PGM     WL0133    P      Job Name
     C                     Z-ADD##JDT     WL0134           Job Date
     C                     EXSR SXCRRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Bulk:  Tanker
      * Crt PD Trailer         CR - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0045    WL0104    P      Carrier Code
     C                     MOVELWUMUTX    WL0105    P      Trailer Id
     C                     Z-ADD#DAOC3    WL0106           Company Number
     C                     MOVEL#1VDST    WL0107    P      Load Type
     C                     MOVEL'T'       WL0108    P      Trailer Type
     C                     MOVEL'N'       WL0109    P      Seaboard Owned
     C                     MOVEL'Y'       WL0110    P      On Yard Status
     C                     Z-ADD##JDT     WL0111           On Yard Date
     C                     Z-ADD##JTM     WL0112           On Yard Time
     C                     MOVEL'N'       WL0113    P      Assigned Status
     C                     MOVEL'Y'       WL0114    P      Available Statu
     C                     MOVELWUGSTX    WL0115    P      Not Available R
     C                     MOVEL*BLANK    WL0116           Comment Line
     C                     MOVELWUGSTX    WL0117    P      Status Unused 1
     C                     MOVELWUGSTX    WL0118    P      Status Unused 2
     C                     MOVELWUGSTX    WL0119    P      Status Unused 3
     C                     MOVELWUGSTX    WL0120    P      Status Unused 4
     C                     MOVELWUGSTX    WL0121    P      Status Unused 5
     C                     Z-ADDWUW0NB    WL0122           Date Unused 1
     C                     Z-ADDWUW0NB    WL0123           Date Unused 2
     C                     Z-ADDWUW0NB    WL0124           Date Unused 3
     C                     Z-ADDWUW0NB    WL0125           Date Unused 4
     C                     Z-ADDWUW0NB    WL0126           Date Unused 5
     C                     MOVELWUGSTX    WL0127    P      EDI Status 1
     C                     MOVELWUGSTX    WL0128    P      EDI Status 2
     C                     MOVELWUGSTX    WL0129    P      EDI Status 3
     C                     MOVEL'A'       WL0130    P      Record Status
     C                     Z-ADD##JTM     WL0131           Job Time
     C                     MOVEL##USR     WL0132    P      User Id
     C                     MOVEL##PGM     WL0133    P      Job Name
     C                     Z-ADD##JDT     WL0134           Job Date
     C                     EXSR SXCRRC
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV/Upd Chgd Trlr/CntnrRT - Trailer  * 
     C                     EXSR SZRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'ASNTRL'  WURVST           Load Change Typ
     C                     MOVEL'TRF'     WUUJST           Department Cont
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADD#DLOID    PBRMNB           Load ID
     C                     Z-ADD*ZERO     PBRVNB           Stop_Drop
     C                     MOVELWURVST    PBRVST    P      Load Change Typ
     C                     MOVELWUUJST    PBUJST    P      Department Cont
     C                     MOVELWUMUTX    PBMNTX    P      Change Log Prio
     C                     MOVEL#DS2TX    PBMOTX    P      Change Log New
     C                     MOVEL##USR     PBAYNA    P      User Id
     C                     MOVEL##PGM     PBA0NA    P      Job Name
     C                     MOVELYL0045    PBBZNA    P      Carrier Code
     C                     Z-ADD#DAOC3    PBAIC3           Company Number
     C                     Z-ADD*ZERO     PBC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993133*
     C                     END
     C                     END                             *FI
      * ***** Change Log and Comments
     C                     EXSR UDSUBR                     ***** Change Lo
     C           W0RTN     IFNE *BLANK
      * Data update error
      * Reset screen fields if changed record
     C           W0RTN     CASEQ'Y2U0007' MBFL#1
     C                     END
     C                     ELSE
     C           YCRDC     IFEQ 'Y'
      * Send message '*Record changed'
     C                     MOVEL'Y2U0012' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *================================================================
     CSR         EEEXIT    ENDSR
      /EJECT
     CSR         FACKPM    BEGSR
      *================================================================
      * Check passed parameters
      *================================================================
      * Is full key present?
     C           P1RMNB    IFEQ *ZERO                      Load ID
      * Not every key field passed - loop program
     C                     MOVEL'Y'       W0RPT   1
     C                     ELSE
      * Full key passed, so single shot program
     C                     MOVEL'N'       W0RPT
     C                     END
      *================================================================
     CSR         FAEXIT    ENDSR
      /EJECT
     CSR         GADSAK    BEGSR
      *================================================================
      * Set key screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSAD    BEGSR
      *================================================================
      * Set detail screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      * Protect key fields on detail screen
     C                     SETON                     88    *
     C                     MOVEL'0'       *IN79
     C           P4I6ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           P3ZGST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           P6HWSX    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C           YL0017    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
     C                     MOVEL'0'       *IN75
     C           YL0005    IFNE *BLANK                     *IF
     C                     MOVEL'1'       *IN75
     C                     END                             *FI
     C                     MOVEL'0'       *IN74
     C           #1OANA    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN74
     C                     END                             *FI
     C                     MOVEL'0'       *IN73
     C           WUC4NB    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN73
     C                     END                             *FI
     C                     MOVEL'0'       *IN72
     C           P3D4ST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN72
     C                     END                             *FI
     C           W0RPT     IFEQ 'N'
      * Disable key screen - not applicable
     C                     SETOF                     87    *
     C                     ELSE
      * Enable key screen
     C                     SETON                     87    *
     C                     END
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise record - except for key fields and "neither" paramete
      *================================================================
     C                     MOVEL*BLANK    #DW2ST           USR Active Flag
     C                     MOVEL*BLANK    #DTXST           Error Status  3
     C                     MOVEL*BLANK    #DTUST           Error Status  2
     C                     MOVEL*BLANK    #DECST           Error Status
     C                     MOVEL*BLANK    #DUFL3           USR Flag 3
     C                     MOVEL*BLANK    #DUFL2           USR Flag 2
     C                     MOVEL*BLANK    #DD4ST           USR Flag 1
     C                     Z-ADD*ZERO     #DAOC3           Company Number
     C                     MOVEL*BLANK    #DAPTX           Company Name
     C                     MOVEL*BLANK    #1PJST           LTL Flag
     C                     MOVEL*BLANK    #1PKST           Load Status
     C                     Z-ADD*ZERO     #1RNNB           Reefer Temperat
     C                     MOVEL*BLANK    #1DMTX           Seal 1
     C                     MOVEL*BLANK    #1DNTX           Seal 2
     C                     MOVEL*BLANK    #1DOTX           Seal 3
     C                     MOVEL*BLANK    #1WTTX           Seal 4
     C                     MOVEL*BLANK    #1WUTX           Seal 2 Unused
     C                     Z-ADD*ZERO     #1RPNB           Total Load Orde
     C                     Z-ADD*ZERO     #1FLAM           Flat Amount
     C                     MOVEL*BLANK    #1XQST           Allocate Pounds
     C                     Z-ADD*ZERO     #1RRNB           Total Stops
     C                     MOVEL*BLANK    #1DXTX           Trailer Id
     C                     Z-ADD*ZERO     #1P1DT           TPM Planned Shi
     C                     MOVEL*BLANK    #1DYTX           Transloader Car
     C                     MOVEL*BLANK    #1RONB           Truck Size
     C                     Z-ADD*ZERO     #1SQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     #1R1NB           Rated Freight
     C                     MOVEL*BLANK    #1VCST           Ship Status
     C                     MOVEL*BLANK    #1VDST           Load Type
     C                     Z-ADD*ZERO     #1SDNB           Number Pallets
     C                     Z-ADD*ZERO     #1PAOU           Number Pallets
     C                     Z-ADD*ZERO     #1DGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     #1SXNB           Estimated Arriv
     C                     Z-ADD*ZERO     #1HADT           Actual Arrival
     C                     Z-ADD*ZERO     #1AART           Actual Arrival
     C                     Z-ADD*ZERO     #1DHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     #1DIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     #1AQDT           Actual Departur
     C                     Z-ADD*ZERO     #1PRTM           Product Tempera
     C                     Z-ADD*ZERO     #1NPSV           Number Spacers
     C                     MOVEL*BLANK    #1J8TX           Car_Veh_Initial
     C                     Z-ADD*ZERO     #1TLMI           Total Load Mile
     C                     MOVEL*BLANK    #1J9TX           Recorder ID
     C                     MOVEL*BLANK    #DC2TX           OHE Carrier SCA
     C                     Z-ADD*ZERO     #DOTNB           USR Deadline De
     C                     Z-ADD*ZERO     #1GRWE           Gross Weight
     C                     MOVEL*BLANK    #1XCCD           Carrier Broker
     C                     MOVEL*BLANK    #1U2ST           Export Status
     C                     MOVEL*BLANK    #1ONTM           On Time_Y_N
     C                     MOVEL*BLANK    #1K4TX           Vessel Name
     C                     Z-ADD*ZERO     #1VOAG           Voyage
     C                     Z-ADD*ZERO     #1KBDT           Sail Date
     C                     MOVEL*BLANK    #1NBBO           Booking Number
     C                     MOVEL*BLANK    #1W4CD           Discharge Port
     C                     Z-ADD*ZERO     #1EFDT           Arrival Date
     C                     MOVEL*BLANK    #1CNTN           Container Numbe
     C                     Z-ADD*ZERO     #1KCDT           Date In
     C                     Z-ADD*ZERO     #1TMIN           Time In
     C                     Z-ADD*ZERO     #1KDDT           Date Out
     C                     Z-ADD*ZERO     #1VMNB           Time Out
     C                     Z-ADD*ZERO     #1OCFR           Load Total Frei
     C                     Z-ADD*ZERO     #1KJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     #1ATTM           Scheduled Deliv
     C                     MOVEL*BLANK    #1OTRS           LH Unused Sts
     C                     MOVEL*BLANK    #1RNST           LH Carrier Paym
     C                     Z-ADD*ZERO     #1BRBK           Bring Back Mile
     C                     Z-ADD*ZERO     #1EIDT           Requested Deliv
     C                     MOVEL*BLANK    #1RMST           Load Acceptance
     C                     MOVEL*BLANK    #1AJCD           Warehouse Code
     C                     Z-ADD*ZERO     #1AXTM           Deadline Depart
     C                     MOVEL*BLANK    #1LHOS           Load Held Over
     C                     MOVEL*BLANK    #1LHOR           Load Held Over
     C                     MOVEL*BLANK    #1WNTX           Load Held Over
     C                     MOVEL*BLANK    #1OITX           Ocean BOL Numbe
     C                     MOVEL*BLANK    #1OJTX           Express Mail Nu
     C                     Z-ADD*ZERO     #1LLDT           Express Mail Da
     C                     MOVEL*BLANK    #1XACD           Shipping Line
     C                     Z-ADD*ZERO     #1AYTM           Product Complet
     C                     Z-ADD*ZERO     #1KNNX           Pallets Loaded
     C                     Z-ADD*ZERO     #1ICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     #1IDWG           Tot Pallet Tare
     C                     MOVEL*BLANK    #1H9SX           Load Confirmed
     C                     MOVEL*BLANK    #1WOTX           Load Confirmed
     C                     Z-ADD*ZERO     #1K1DT           Load Confirmati
     C                     Z-ADD*ZERO     #1AZTM           Load Door 1
     C                     Z-ADD*ZERO     #1K2DT           Override Total
     C                     Z-ADD*ZERO     #1A0TM           Load Door 2
     C                     MOVEL*BLANK    #1RQST           Export Load USD
     C                     MOVEL*BLANK    #1RRST           Late Delivery E
     C                     Z-ADD*ZERO     #1ZBVA           Load Actual Fre
     C                     MOVEL*BLANK    #1WPTX           Hide on WW Load
     C                     MOVEL*BLANK    #1WQTX           Late Billing Em
     C                     MOVEL*BLANK    #1WRTX           Shipping Temp C
     C                     MOVEL*BLANK    #1WSTX           LH Held Over Rs
     C                     MOVEL*BLANK    #1RVSX           Multi Company L
     C                     MOVEL*BLANK    #1RUSX           Fax Sent to SSI
     C                     MOVEL*BLANK    #1RWSX           Schedule Pos Lo
     C                     MOVEL*BLANK    #1RXSX           LH Power Only L
     C                     MOVEL*BLANK    #1RYSX           MG Created Load
     C                     MOVEL*BLANK    #1RZSX           LH Unused Sts 5
     C                     MOVEL*BLANK    #1R0SX           Load U_M
     C                     MOVEL*BLANK    #1R1SX           TPM Shipment St
     C                     MOVEL*BLANK    #1R2SX           LH Unused Sts 8
     C                     MOVEL*BLANK    #1R3SX           LH On-Time Reas
     C                     MOVEL*BLANK    #1R4SX           LH Held Over Re
     C                     Z-ADD*ZERO     #1PYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     #1CKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     #1PZDT           LH Last Combo P
     C                     Z-ADD*ZERO     #1CLTM           LH Last Combo P
     C                     Z-ADD*ZERO     #1P0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     #1CMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     #1CNTM           LH Unused Time
     C                     Z-ADD*ZERO     #1P2DT           LH Unused Date
     C                     Z-ADD*ZERO     #1COTM           LH Unused Time
     C                     Z-ADD*ZERO     #1P3DT           LH Unused Date
     C                     Z-ADD*ZERO     #1CQTM           LH Unused Time
     C                     Z-ADD*ZERO     #1TRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     #1AVTM           On Yard Time
     C                     MOVEL*BLANK    #1RPST           Load Confirmati
     C                     Z-ADD*ZERO     #1SPTM           Spotted Time
     C                     Z-ADD*ZERO     #1LFTM           Load Finished T
     C                     Z-ADD*ZERO     #1BOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     #1BLTM           BOL Received Ti
     C                     Z-ADD*ZERO     #1SBNB           BOL Time
     C                     Z-ADD*ZERO     #1ASTM           Truck Departure
     C                     Z-ADD*ZERO     #1S6NB           Departure Time
     C                     Z-ADD*ZERO     #1AJCM           Adjusted Depart
     C                     MOVEL*BLANK    #1UVST           EDI Status 1
     C                     MOVEL*BLANK    #1UWST           EDI Status 2
     C                     MOVEL*BLANK    #1UXST           EDI Status 3
     C                     Z-ADD*ZERO     #1AATM           Job Time
     C                     MOVEL*BLANK    #1AYNA           User Id
     C                     MOVEL*BLANK    #1A0NA           Job Name
     C                     Z-ADD*ZERO     #1AXDT           Job Date
     C                     MOVEL*BLANK    #1BZNA           Carrier Code
     C                     MOVEL*BLANK    #DADTX           Name
     C                     MOVEL*BLANK    #DBRTX           Ship To Name
     C                     MOVEL*BLANK    #DHNNA           Ship To City
     C                     MOVEL*BLANK    #1DBCD           Ship To State C
     C                     Z-ADD*ZERO     #DLOID           Load ID USR
     C                     Z-ADD*ZERO     #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     Z-ADD*ZERO     #1T4NB           Schedule Sequen
     C                     Z-ADD*ZERO     #1AODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V1AODT
     C                     Z-ADD*ZERO     #DABTH           LPT Load Plan T
     C                     MOVEL*BLANK    #DS2TX           Trailer ID USR
     C                     MOVEL*BLANK    #1Q2CD           Shipping Method
     C                     Z-ADD*ZERO     #1F9DT           Actual Ship Dat
      * Clear external version also
     C                     Z-ADD*ZERO     V1F9DT
     C                     MOVEL*BLANK    #1LSHG           Load Shag Flag
     C                     MOVEL*BLANK    #1YPST           Load Wash Flag
     C                     Z-ADD*ZERO     #DKGDT           Delivery Date
      * Clear external version also
     C                     Z-ADD*ZERO     VDKGDT
     C                     MOVEL*BLANK    #1VPCD           Ship From Wareh
     C                     Z-ADD*ZERO     #1KZDT           Deadline Depart
      * Clear external version also
     C                     Z-ADD*ZERO     V1KZDT
     C                     Z-ADD*ZERO     #DAGTH           TMS Deadline De
     C                     MOVEL*BLANK    #1OANA           Port Delv Termi
     C                     Z-ADD*ZERO     #1K0DT           Product Complet
      * Clear external version also
     C                     Z-ADD*ZERO     V1K0DT
     C                     MOVEL*BLANK    #DFQSX           Export Docs Go
     C                     Z-ADD*ZERO     #DB2TM           USR Product com
     C                     MOVEL*BLANK    #DQXAA           Shipping Line 1
     C                     MOVEL*BLANK    #DI6TX           Description 14A
     C                     Z-ADD*ZERO     #1KKDT           On Yard Date
      * Clear external version also
     C                     Z-ADD*ZERO     V1KKDT
     C                     Z-ADD*ZERO     #DOYTM           USR On Yard Tim
     C                     Z-ADD*ZERO     #1J4DT           Truck Ready Dat
      * Clear external version also
     C                     Z-ADD*ZERO     V1J4DT
     C                     Z-ADD*ZERO     #DRDTM           USR Ready Time
     C                     Z-ADD*ZERO     #1J5DT           Spotted Date
      * Clear external version also
     C                     Z-ADD*ZERO     V1J5DT
     C                     Z-ADD*ZERO     #D               USR Picked Up T
     C                     Z-ADD*ZERO     #DM6NX           Load Door 1 USR
     C                     Z-ADD*ZERO     #DM7NX           Load Door 2 USR
     C                     MOVEL*BLANK    #1ROST           Partial Load
     C                     Z-ADD*ZERO     #1J6DT           Load Finished D
      * Clear external version also
     C                     Z-ADD*ZERO     V1J6DT
     C                     Z-ADD*ZERO     #DFDTM           USR Finished Ti
     C                     Z-ADD*ZERO     #1J7DT           BOL Complete Da
      * Clear external version also
     C                     Z-ADD*ZERO     V1J7DT
     C                     Z-ADD*ZERO     #DCPTM           USR Complete Ti
     C                     Z-ADD*ZERO     #1J8DT           BOL Received Da
      * Clear external version also
     C                     Z-ADD*ZERO     V1J8DT
     C                     Z-ADD*ZERO     #DBDTM           USR Billed Time
     C                     Z-ADD*ZERO     #1KIDT           Truck Departure
      * Clear external version also
     C                     Z-ADD*ZERO     V1KIDT
     C                     Z-ADD*ZERO     #DT9NB           USR Delivery Af
     C                     Z-ADD*ZERO     #1KADT           Adjusted Depart
      * Clear external version also
     C                     Z-ADD*ZERO     V1KADT
     C                     Z-ADD*ZERO     #DXXTM           Departure Time
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @FJCPBN fields to screen
      *================================================================
     C                     Z-ADDFJRMNB    #1RMNB           Load ID
     C                     MOVELFJPJST    #1PJST           LTL Flag
     C                     MOVELFJPKST    #1PKST           Load Status
     C                     Z-ADDFJRNNB    #1RNNB           Reefer Temperat
     C                     MOVELFJDMTX    #1DMTX           Seal 1
     C                     MOVELFJDNTX    #1DNTX           Seal 2
     C                     MOVELFJDOTX    #1DOTX           Seal 3
     C                     MOVELFJWTTX    #1WTTX           Seal 4
     C                     MOVELFJWUTX    #1WUTX           Seal 2 Unused
     C                     Z-ADDFJRPNB    #1RPNB           Total Load Orde
     C                     Z-ADDFJFLAM    #1FLAM           Flat Amount
     C                     MOVELFJXQST    #1XQST           Allocate Pounds
     C                     Z-ADDFJRRNB    #1RRNB           Total Stops
     C                     MOVELFJDXTX    #1DXTX           Trailer Id
     C                     Z-ADDFJP1DT    #1P1DT           TPM Planned Shi
     C                     MOVELFJDYTX    #1DYTX           Transloader Car
     C                     MOVELFJRONB    #1RONB           Truck Size
     C                     Z-ADDFJSQNB    #1SQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADDFJR1NB    #1R1NB           Rated Freight
     C                     MOVELFJVCST    #1VCST           Ship Status
     C                     MOVELFJVDST    #1VDST           Load Type
     C                     Z-ADDFJSDNB    #1SDNB           Number Pallets
     C                     Z-ADDFJPAOU    #1PAOU           Number Pallets
     C                     Z-ADDFJDGWG    #1DGWG           Load Carrier Pa
     C                     Z-ADDFJSXNB    #1SXNB           Estimated Arriv
     C                     Z-ADDFJHADT    #1HADT           Actual Arrival
     C                     Z-ADDFJAART    #1AART           Actual Arrival
     C                     Z-ADDFJDHWG    #1DHWG           Trailer IN Weig
     C                     Z-ADDFJDIWG    #1DIWG           Trailer OUT Wei
     C                     Z-ADDFJAQDT    #1AQDT           Actual Departur
     C                     Z-ADDFJPRTM    #1PRTM           Product Tempera
     C                     Z-ADDFJNPSV    #1NPSV           Number Spacers
     C                     MOVELFJJ8TX    #1J8TX           Car_Veh_Initial
     C                     Z-ADDFJTLMI    #1TLMI           Total Load Mile
     C                     MOVELFJJ9TX    #1J9TX           Recorder ID
     C                     Z-ADDFJGRWE    #1GRWE           Gross Weight
     C                     MOVELFJXCCD    #1XCCD           Carrier Broker
     C                     MOVELFJU2ST    #1U2ST           Export Status
     C                     MOVELFJONTM    #1ONTM           On Time_Y_N
     C                     MOVELFJK4TX    #1K4TX           Vessel Name
     C                     Z-ADDFJVOAG    #1VOAG           Voyage
     C                     Z-ADDFJKBDT    #1KBDT           Sail Date
     C                     MOVELFJNBBO    #1NBBO           Booking Number
     C                     MOVELFJW4CD    #1W4CD           Discharge Port
     C                     Z-ADDFJEFDT    #1EFDT           Arrival Date
     C                     MOVELFJCNTN    #1CNTN           Container Numbe
     C                     Z-ADDFJKCDT    #1KCDT           Date In
     C                     Z-ADDFJTMIN    #1TMIN           Time In
     C                     Z-ADDFJKDDT    #1KDDT           Date Out
     C                     Z-ADDFJVMNB    #1VMNB           Time Out
     C                     Z-ADDFJOCFR    #1OCFR           Load Total Frei
     C                     Z-ADDFJKJDT    #1KJDT           Scheduled Deliv
     C                     Z-ADDFJATTM    #1ATTM           Scheduled Deliv
     C                     MOVELFJOTRS    #1OTRS           LH Unused Sts
     C                     MOVELFJRNST    #1RNST           LH Carrier Paym
     C                     Z-ADDFJBRBK    #1BRBK           Bring Back Mile
     C                     Z-ADDFJEIDT    #1EIDT           Requested Deliv
     C                     MOVELFJRMST    #1RMST           Load Acceptance
     C                     MOVELFJAJCD    #1AJCD           Warehouse Code
     C                     Z-ADDFJAXTM    #1AXTM           Deadline Depart
     C                     MOVELFJLHOS    #1LHOS           Load Held Over
     C                     MOVELFJLHOR    #1LHOR           Load Held Over
     C                     MOVELFJWNTX    #1WNTX           Load Held Over
     C                     MOVELFJOITX    #1OITX           Ocean BOL Numbe
     C                     MOVELFJOJTX    #1OJTX           Express Mail Nu
     C                     Z-ADDFJLLDT    #1LLDT           Express Mail Da
     C                     MOVELFJXACD    #1XACD           Shipping Line
     C                     Z-ADDFJAYTM    #1AYTM           Product Complet
     C                     Z-ADDFJKNNX    #1KNNX           Pallets Loaded
     C                     Z-ADDFJICWG    #1ICWG           Avg Pallet Tare
     C                     Z-ADDFJIDWG    #1IDWG           Tot Pallet Tare
     C                     MOVELFJH9SX    #1H9SX           Load Confirmed
     C                     MOVELFJWOTX    #1WOTX           Load Confirmed
     C                     Z-ADDFJK1DT    #1K1DT           Load Confirmati
     C                     Z-ADDFJAZTM    #1AZTM           Load Door 1
     C                     Z-ADDFJK2DT    #1K2DT           Override Total
     C                     Z-ADDFJA0TM    #1A0TM           Load Door 2
     C                     MOVELFJRQST    #1RQST           Export Load USD
     C                     MOVELFJRRST    #1RRST           Late Delivery E
     C                     Z-ADDFJZBVA    #1ZBVA           Load Actual Fre
     C                     MOVELFJWPTX    #1WPTX           Hide on WW Load
     C                     MOVELFJWQTX    #1WQTX           Late Billing Em
     C                     MOVELFJWRTX    #1WRTX           Shipping Temp C
     C                     MOVELFJWSTX    #1WSTX           LH Held Over Rs
     C                     MOVELFJRVSX    #1RVSX           Multi Company L
     C                     MOVELFJRUSX    #1RUSX           Fax Sent to SSI
     C                     MOVELFJRWSX    #1RWSX           Schedule Pos Lo
     C                     MOVELFJRXSX    #1RXSX           LH Power Only L
     C                     MOVELFJRYSX    #1RYSX           MG Created Load
     C                     MOVELFJRZSX    #1RZSX           LH Unused Sts 5
     C                     MOVELFJR0SX    #1R0SX           Load U_M
     C                     MOVELFJR1SX    #1R1SX           TPM Shipment St
     C                     MOVELFJR2SX    #1R2SX           LH Unused Sts 8
     C                     MOVELFJR3SX    #1R3SX           LH On-Time Reas
     C                     MOVELFJR4SX    #1R4SX           LH Held Over Re
     C                     Z-ADDFJPYDT    #1PYDT           LH Carrier Paid
     C                     Z-ADDFJCKTM    #1CKTM           LH Carrier Paid
     C                     Z-ADDFJPZDT    #1PZDT           LH Last Combo P
     C                     Z-ADDFJCLTM    #1CLTM           LH Last Combo P
     C                     Z-ADDFJP0DT    #1P0DT           LPT Load Plan S
     C                     Z-ADDFJCMTM    #1CMTM           LPT Load Plan S
     C                     Z-ADDFJCNTM    #1CNTM           LH Unused Time
     C                     Z-ADDFJP2DT    #1P2DT           LH Unused Date
     C                     Z-ADDFJCOTM    #1COTM           LH Unused Time
     C                     Z-ADDFJP3DT    #1P3DT           LH Unused Date
     C                     Z-ADDFJCQTM    #1CQTM           LH Unused Time
     C                     Z-ADDFJTRTM    #1TRTM           Truck Ready Tim
     C                     Z-ADDFJAVTM    #1AVTM           On Yard Time
     C                     MOVELFJRPST    #1RPST           Load Confirmati
     C                     Z-ADDFJSPTM    #1SPTM           Spotted Time
     C                     Z-ADDFJLFTM    #1LFTM           Load Finished T
     C                     Z-ADDFJBOTM    #1BOTM           BOL Complete Ti
     C                     Z-ADDFJBLTM    #1BLTM           BOL Received Ti
     C                     Z-ADDFJSBNB    #1SBNB           BOL Time
     C                     Z-ADDFJASTM    #1ASTM           Truck Departure
     C                     Z-ADDFJS6NB    #1S6NB           Departure Time
     C                     Z-ADDFJAJCM    #1AJCM           Adjusted Depart
     C                     MOVELFJUVST    #1UVST           EDI Status 1
     C                     MOVELFJUWST    #1UWST           EDI Status 2
     C                     MOVELFJUXST    #1UXST           EDI Status 3
     C                     Z-ADDFJAATM    #1AATM           Job Time
     C                     MOVELFJAYNA    #1AYNA           User Id
     C                     MOVELFJA0NA    #1A0NA           Job Name
     C                     Z-ADDFJAXDT    #1AXDT           Job Date
     C                     MOVELFJBZNA    #1BZNA           Carrier Code
     C                     MOVELFJDBCD    #1DBCD           Ship To State C
     C                     Z-ADDFJAIC3    #1AIC3           Company Number
     C                     Z-ADDFJT4NB    #1T4NB           Schedule Sequen
     C                     Z-ADDFJAODT    #1AODT           Scheduled Ship
     C                     MOVELFJQ2CD    #1Q2CD           Shipping Method
     C                     Z-ADDFJF9DT    #1F9DT           Actual Ship Dat
     C                     MOVELFJLSHG    #1LSHG           Load Shag Flag
     C                     MOVELFJYPST    #1YPST           Load Wash Flag
     C                     MOVELFJVPCD    #1VPCD           Ship From Wareh
     C                     Z-ADDFJKZDT    #1KZDT           Deadline Depart
     C                     MOVELFJOANA    #1OANA           Port Delv Termi
     C                     Z-ADDFJK0DT    #1K0DT           Product Complet
     C                     Z-ADDFJKKDT    #1KKDT           On Yard Date
     C                     Z-ADDFJJ4DT    #1J4DT           Truck Ready Dat
     C                     Z-ADDFJJ5DT    #1J5DT           Spotted Date
     C                     MOVELFJROST    #1ROST           Partial Load
     C                     Z-ADDFJJ6DT    #1J6DT           Load Finished D
     C                     Z-ADDFJJ7DT    #1J7DT           BOL Complete Da
     C                     Z-ADDFJJ8DT    #1J8DT           BOL Received Da
     C                     Z-ADDFJKIDT    #1KIDT           Truck Departure
     C                     Z-ADDFJKADT    #1KADT           Adjusted Depart
      * Hold existing record image
     C                     MOVEL@1DBRC    #1DBRC
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MDIZ#K    BEGSR
      *================================================================
      * Initialize key screen
      *================================================================
     C                     Z-ADDP1RMNB    #1RMNB           Load ID
      *================================================================
     CSR         MDEXIT    ENDSR
      /EJECT
     CSR         MOCV#D    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #1AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1AODT
      * Convert Actual Ship Date to display format
      * Convert date
     C           1000000   ADD  #1F9DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1F9DT
      * Convert Delivery Date to display format
      * Convert date
     C           1000000   ADD  #DKGDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDKGDT
      * Convert Deadline Departure Date to display format
      * Convert date
     C           1000000   ADD  #1KZDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1KZDT
      * Convert Product Complete Date to display format
      * Convert date
     C           1000000   ADD  #1K0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1K0DT
      * Convert On Yard Date to display format
      * Convert date
     C           1000000   ADD  #1KKDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1KKDT
      * Convert Truck Ready Date to display format
      * Convert date
     C           1000000   ADD  #1J4DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1J4DT
      * Convert Spotted Date to display format
      * Convert date
     C           1000000   ADD  #1J5DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1J5DT
      * Convert Load Finished Date to display format
      * Convert date
     C           1000000   ADD  #1J6DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1J6DT
      * Convert BOL Complete Date to display format
      * Convert date
     C           1000000   ADD  #1J7DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1J7DT
      * Convert BOL Received Date to display format
      * Convert date
     C           1000000   ADD  #1J8DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1J8DT
      * Convert Truck Departure Date to display format
      * Convert date
     C           1000000   ADD  #1KIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1KIDT
      * Convert Adjusted Departure Date to display format
      * Convert date
     C           1000000   ADD  #1KADT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1KADT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Shipping Line-OHE  RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN AMRMNB    WQSA01           Load ID
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSA01           Load ID
      * Establish starting position
     C           KRSSA     SETLL@AMREJM                    *
     C           KRSSA     READE@AMREJM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DQXAA           Shipping Line
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * ** pass back the first record found with a shipping line
      * CASE: DB1.Shipping Line is not entered
     C           AMXACD    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR = DB1 By name
     C                     MOVELAMXACD    #DQXAA           Shipping Line
     C                     GOTO SAEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSA     READE@AMREJM                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Carrier Name       RT - Carrier  * Rtv shipping line
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           FFBZNA           Carrier Code
      * Setup key
     C                     MOVELWL0001    FFBZNA           Carrier Code
      * Establish starting position
     C           KRSSB     CHAIN@FFREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           Name
     C                     MOVEL*BLANK    WL0003           Record Status
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFFADTX    WL0002           Name
     C                     MOVELFFVSST    WL0003           Record Status
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Appt Cnfrm Info   RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQSC02           Load ID
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC02           Load ID
      * Setup key
     C                     Z-ADDFJRMNB    WQSC02           Load ID
      * Establish starting position
     C           KRSSC     SETLL@FLCPEB                    *
     C           KRSSC     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFLKFDT    YL0003           Appointment Con
     C                     Z-ADDFLACTM    YL0004           Appointment Con
     C                     MOVELFLK5TX    YL0005           Confirmation Ma
     C                     MOVELFLW5CD    YL0006           Confirmation Nu
     C                     Z-ADDFLN8DT    YL0007           LD Unused Date
     C                     Z-ADDFLB4TM    YL0008           LD Unused Time
     C                     GOTO SCEXIT                     *QUIT
     C           KRSSC     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0004    ABAIC3           Company Number
      * Establish starting position
     C           KRSSD     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0005           Name
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    WL0005           Name
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Load Str Company  RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDFJRMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSE     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0009           Company Number
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFJAIC3    YL0009           Company Number
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Val Warehouse Exists   RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELFJVPCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSF     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Load Dispatch new  RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ***** Change Log and Comments
      * ** 09/19/2006 LJB PK0036
      * ** Change to use new 3 char LH Heldover Reason code
      * *****
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSG     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFJAODT    #1AODT           Scheduled Ship
     C                     MOVELFJDXTX    WUMUTX           Trailer Id
     C                     MOVELFJBZNA    #1BZNA           Carrier Code
     C                     Z-ADDFJT4NB    #1T4NB           Schedule Sequen
     C                     MOVELFJQ2CD    #1Q2CD           Shipping Method
     C                     MOVELFJONTM    #1ONTM           On Time_Y_N
     C                     Z-ADDFJJ4DT    #1J4DT           Truck Ready Dat
     C                     Z-ADDFJTRTM    #1TRTM           Truck Ready Tim
     C                     Z-ADDFJJ5DT    #1J5DT           Spotted Date
     C                     Z-ADDFJSPTM    #1SPTM           Spotted Time
     C                     Z-ADDFJJ6DT    #1J6DT           Load Finished D
     C                     Z-ADDFJLFTM    #1LFTM           Load Finished T
     C                     Z-ADDFJJ7DT    #1J7DT           BOL Complete Da
     C                     Z-ADDFJBOTM    #1BOTM           BOL Complete Ti
     C                     Z-ADDFJJ8DT    #1J8DT           BOL Received Da
     C                     Z-ADDFJBLTM    #1BLTM           BOL Received Ti
     C                     Z-ADDFJKIDT    #1KIDT           Truck Departure
     C                     Z-ADDFJASTM    #1ASTM           Truck Departure
     C                     Z-ADDFJKADT    #1KADT           Adjusted Depart
     C                     Z-ADDFJAJCM    #1AJCM           Adjusted Depart
     C                     MOVELFJXACD    YL0012           Shipping Line
     C                     MOVELFJOANA    #1OANA           Port Delv Termi
     C                     Z-ADDFJKJDT    #1KJDT           Scheduled Deliv
     C                     Z-ADDFJATTM    #1ATTM           Scheduled Deliv
     C                     MOVELFJOTRS    #1OTRS           LH Unused Sts
     C                     Z-ADDFJKKDT    #1KKDT           On Yard Date
     C                     Z-ADDFJAVTM    #1AVTM           On Yard Time
     C                     MOVELFJLHOS    #1LHOS           Load Held Over
     C                     Z-ADDFJK0DT    #1K0DT           Product Complet
     C                     Z-ADDFJAYTM    #1AYTM           Product Complet
     C                     Z-ADDFJK1DT    #1K1DT           Load Confirmati
     C                     Z-ADDFJAZTM    #1AZTM           Load Door 1
     C                     Z-ADDFJA0TM    #1A0TM           Load Door 2
     C                     MOVELFJROST    #1ROST           Partial Load
     C                     MOVELFJWSTX    #1WSTX           LH Held Over Rs
     C                     MOVELFJR3SX    #1R3SX           LH On-Time Reas
     C                     MOVELFJR4SX    #1R4SX           LH Held Over Re
     C                     Z-ADDFJCMTM    #1CMTM           LPT Load Plan S
     C                     Z-ADDFJP1DT    #1P1DT           TPM Planned Shi
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Trailer            RT - Trailer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           LYBZNA           Carrier Code
     C                     KFLD           LYDXTX           Trailer Id
      * Setup key
     C                     MOVELWL0006    LYBZNA           Carrier Code
     C                     MOVELWL0007    LYDXTX           Trailer Id
      * Establish starting position
     C           KRSSH     CHAIN@LYRER3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2598' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0008           Company Number
     C                     MOVEL*BLANK    WL0009           Load Type
     C                     MOVEL*BLANK    WL0010           Trailer Type
     C                     MOVEL*BLANK    WL0011           Seaboard Owned
     C                     MOVEL*BLANK    WL0012           On Yard Status
     C                     Z-ADD*ZERO     WL0013           On Yard Date
     C                     Z-ADD*ZERO     WL0014           On Yard Time
     C                     MOVEL*BLANK    WL0015           Assigned Status
     C                     MOVEL*BLANK    WL0016           Available Statu
     C                     MOVEL*BLANK    WL0017           Not Available R
     C                     MOVEL*BLANK    WL0018           Comment Line
     C                     MOVEL*BLANK    WL0019           Record Status
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDLYAIC3    WL0008           Company Number
     C                     MOVELLYVDST    WL0009           Load Type
     C                     MOVELLYX3ST    WL0010           Trailer Type
     C                     MOVELLYXGST    WL0011           Seaboard Owned
     C                     MOVELLYSTOY    WL0012           On Yard Status
     C                     Z-ADDLYKKDT    WL0013           On Yard Date
     C                     Z-ADDLYAVTM    WL0014           On Yard Time
     C                     MOVELLYSTAS    WL0015           Assigned Status
     C                     MOVELLYXRST    WL0016           Available Statu
     C                     MOVELLYX7CD    WL0017           Not Available R
     C                     MOVELLYGXTX    WL0018           Comment Line
     C                     MOVELLYVSST    WL0019           Record Status
     C                     GOTO SHEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV All               RT - Warehouse Codes  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0020    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSI     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0021           Warehouse Descr
     C                     MOVEL*BLANK    WL0022           Address Line 1
     C                     MOVEL*BLANK    WL0023           Address Line 2
     C                     MOVEL*BLANK    WL0024           Address Line 3
     C                     MOVEL*BLANK    WL0025           City
     C                     MOVEL*BLANK    WL0026           Zip Postal Code
     C                     MOVEL*BLANK    WL0027           Production Ware
     C                     MOVEL*BLANK    WL0028           State Code
     C                     MOVEL*BLANK    WL0029           Lot Tracking Fl
     C                     MOVEL*BLANK    WL0030           Default Printer
     C                     MOVEL*BLANK    WL0031           Warehouse Type
     C                     MOVEL*BLANK    WL0032           Trans Contol AS
     C                     MOVEL*BLANK    WL0033           Warehouse Locat
     C                     MOVEL*BLANK    WL0034           Warehouse Std C
     C                     Z-ADD*ZERO     WL0035           Warehouse Chill
     C                     MOVEL*BLANK    WL0036           Include in Auto
     C                     MOVEL*BLANK    WL0037           Default Manifes
     C                     MOVEL*BLANK    WL0038           Default Load Se
     C                     MOVEL*BLANK    WL0039           WHS Slotting Li
     C                     Z-ADD*ZERO     WL0040           Shipping Compan
     C                     Z-ADD*ZERO     WL0041           Accounting Comp
     C                     Z-ADD*ZERO     WL0042           WHS Sched Prod
     C                     Z-ADD*ZERO     WL0043           WHS Inventory C
     C                     MOVEL*BLANK    WL0044           Parent Warehous
     C                     MOVEL*BLANK    WL0045           Default Shippin
     C                     MOVEL*BLANK    WL0046           WHS Live with C
     C                     MOVEL*BLANK    WL0047           WHS PFS Interfa
     C                     MOVEL*BLANK    WL0048           WHS Req Meter R
     C                     MOVEL*BLANK    WL0049           WHS Default Loa
     C                     MOVEL*BLANK    WL0050           WHS TMS Plannin
     C                     MOVEL*BLANK    WL0051           Default Carrier
     C                     MOVEL*BLANK    WL0052           Inventory Logic
     C                     MOVEL*BLANK    WL0053           WHS Auto Inv Re
     C                     MOVEL*BLANK    WL0054           EDI Status 1
     C                     MOVEL*BLANK    WL0055           EDI Status 2
     C                     MOVEL*BLANK    WL0056           EDI Status 3
     C                     MOVEL*BLANK    WL0057           Record Status
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADF8NA    WL0021           Warehouse Descr
     C                     MOVELADACNA    WL0022           Address Line 1
     C                     MOVELADADNA    WL0023           Address Line 2
     C                     MOVELADAENA    WL0024           Address Line 3
     C                     MOVELADAJNA    WL0025           City
     C                     MOVELADBTTX    WL0026           Zip Postal Code
     C                     MOVELADAOCD    WL0027           Production Ware
     C                     MOVELADBGCD    WL0028           State Code
     C                     MOVELADVHST    WL0029           Lot Tracking Fl
     C                     MOVELADMPNA    WL0030           Default Printer
     C                     MOVELADWPST    WL0031           Warehouse Type
     C                     MOVELADXUST    WL0032           Trans Contol AS
     C                     MOVELADT0ST    WL0033           Warehouse Locat
     C                     MOVELADT1ST    WL0034           Warehouse Std C
     C                     Z-ADDADDBNB    WL0035           Warehouse Chill
     C                     MOVELADT2ST    WL0036           Include in Auto
     C                     MOVELADT3ST    WL0037           Default Manifes
     C                     MOVELADT4ST    WL0038           Default Load Se
     C                     MOVELADT6ST    WL0039           WHS Slotting Li
     C                     Z-ADDADBWC3    WL0040           Shipping Compan
     C                     Z-ADDADBTC3    WL0041           Accounting Comp
     C                     Z-ADDADBUC3    WL0042           WHS Sched Prod
     C                     Z-ADDADBVC3    WL0043           WHS Inventory C
     C                     MOVELADFCAA    WL0044           Parent Warehous
     C                     MOVELADRQSX    WL0045           Default Shippin
     C                     MOVELADRRSX    WL0046           WHS Live with C
     C                     MOVELADRSSX    WL0047           WHS PFS Interfa
     C                     MOVELADRTSX    WL0048           WHS Req Meter R
     C                     MOVELADT7ST    WL0049           WHS Default Loa
     C                     MOVELADT8ST    WL0050           WHS TMS Plannin
     C                     MOVELADRNSX    WL0051           Default Carrier
     C                     MOVELADROSX    WL0052           Inventory Logic
     C                     MOVELADRPSX    WL0053           WHS Auto Inv Re
     C                     MOVELADUVST    WL0054           EDI Status 1
     C                     MOVELADUWST    WL0055           EDI Status 2
     C                     MOVELADUXST    WL0056           EDI Status 3
     C                     MOVELADVSST    WL0057           Record Status
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Act ShpDt Last Ord RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     #1F9DT           Actual Shipped
      * Declare restrictor key work fields
     C           *LIKE     DEFN WARMNB    WQSJ02           Load ID
      * Define keylist
     C           KPSSJ     KLIST
     C                     KFLD           WQSJ02           Load ID
     C                     KFLD           WARVNB           Stop_Drop
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSJ02           Load ID
     C                     Z-ADD99999     WARVNB           Stop_Drop
      * Establish starting position
     C           KPSSJ     SETLL@FLCPE8                    *
     C           KRSSJ     READE@FLCPE8                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Actual Ship Date  RT - Order Header TRG  * 
     C                     EXSR SKRVGN
      * CASE: WRK.Actual Shipped Date GT PAR.Actual Shipped Date
     C           WUGNDT    IFGT #1F9DT                     *IF
     C                     Z-ADDWUGNDT    #1F9DT           Actual Shipped
     C                     END                             *FI
     C           KRSSJ     READE@FLCPE8                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Actual Ship Date  RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDWAAIC3    BEAIC3           Company Number
     C                     Z-ADDWAC4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSK     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DBRTX           Ship To Name
     C                     MOVEL*BLANK    #DHNNA           Ship To City
     C                     MOVEL*BLANK    #1DBCD           Ship To State C
     C                     Z-ADD*ZERO     WUGNDT           Actual Shipped
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBEBRTX    #DBRTX           Ship To Name
     C                     MOVELBEHNNA    #DHNNA           Ship To City
     C                     MOVELBEDBCD    #1DBCD           Ship To State C
     C                     Z-ADDBEGNDT    WUGNDT           Actual Shipped
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV 1st Export Order   RT - Load Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  70       Ship To Custome
     C                     MOVEL*BLANK    WN0002  1        Export Status
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQSL02           Load ID
      * Define keylist
     C           KPSSL     KLIST
     C                     KFLD           WQSL02           Load ID
     C                     KFLD           FLRVNB           Stop_Drop
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL02           Load ID
      * Setup key
     C                     Z-ADDFJRMNB    WQSL02           Load ID
     C                     Z-ADD*ZERO     FLRVNB           Stop_Drop
      * Establish starting position
     C           KPSSL     SETLL@FLCPEB                    *
     C           KRSSL     READE@FLCPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUC4NB           Order Number
     C                     Z-ADD*ZERO     WUZ4NB           MPC Number
     C                     Z-ADD*ZERO     WN0001           Ship To Custome
     C                     MOVEL*BLANK    WN0002           Export Status
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * *** If Export Order, then Stop Search and Return Order #
      * RTV Exprt Sts/ShipCust RT - PD Order Header  * 
     C                     EXSR SMRVGN
      * CASE: PAR.Export Status is yes
     C           WN0002    IFEQ 'Y'                        *IF
      * PAR = DB1 By name
     C                     Z-ADDFLC4NB    WUC4NB           Order Number
     C                     Z-ADDFLZ4NB    WUZ4NB           MPC Number
     C                     GOTO SLEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUC4NB           Order Number
     C                     Z-ADD*ZERO     WUZ4NB           MPC Number
     C                     Z-ADD*ZERO     WN0001           Ship To Custome
     C                     MOVEL*BLANK    WN0002           Export Status
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     END                             *FI
     C           KRSSL     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Exprt Sts/ShipCust RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDFLAIC3    BEAIC3           Company Number
     C                     Z-ADDFLC4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSM     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0001           Ship To Custome
     C                     MOVEL*BLANK    WN0002           Export Status
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBEBKC7    WN0001           Ship To Custome
     C                     MOVELBEU2ST    WN0002           Export Status
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Exp Doc w/Drvr     RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDFJAIC3    BEAIC3           Company Number
     C                     Z-ADDWUC4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSN     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBEFQSX    #DFQSX           Export Docs Go
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * VAL Load Exist        RT - OM Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#DLOID    FJRMNB           Load ID
      * Establish starting position
     C           KRSSO     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SOEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPINFN    BEGSR
      *================================================================
      * EXC Load Confirm Fax   IF - Load Header  * 
      *================================================================
      * EXC Load Confirm Fax   IF
      * ** See comments for explanation of parms.
      * PRC Submit Fax Load Cn UP - /UT User Programs  * 
     C                     CALL 'PDVVUPC'              90  PRC Submit Fax
     C                     PARM WUH3TX    WQ0073  7        Return Code Usr
     C           P6AJAA    PARM P6AJAA    WQ0074 155       Company Number
     C           P6AJAE    PARM P6AJAE    WQ0075 155       Order Number 1
     C                     PARM *BLANK    WQ0076  3        Transloader Car
     C                     PARM #1BZNA    WQ0077  3        Carrier Code
     C                     PARM *BLANK    WQ0078  3        Shipping Line
     C                     PARM *BLANK    WQ0079  4        OHE Carrier SCA
     C                     PARM WUQ1ST    WQ0080  1        Status Flag 1
     C                     PARM 'N'       WQ0081  1        Status Flag 2
     C                     PARM 'N'       WQ0082  1        Status Flag 3
     C                     PARM 'N'       WQ0083  1        Status Flag 4
     C                     PARM 'N'       WQ0084  1        Status Flag 5
     C                     PARM WUB8ST    WQ0085  1        Status - Y or N
     C                     PARM WUNMTX    WQ0086 10        Status Descript
     C                     PARM WUE6ST    WQ0087  1        USR Status (Y/N
     C                     PARM P6WRST    WQ0088 10        PRT Printer Dev
     C                     PARM P6WSST    WQ0089  4        PRT Hold Output
     C                     PARM P6WTST    WQ0090  4        PRT Save Output
     C                     PARM P6M8NB    WQ0091 155       System Value Nu
     C                     PARM *BLANK    WQ0092 50        Email Address
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDVVUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * ***** Change Log and Comments
     C                     EXSR UASUBR                     ***** Change Lo
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * VAL Trailer assignmnt RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ***** Changes and comments
     C                     EXSR UCSUBR                     ***** Changes a
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBDXTX    WQSQ01           Trailer Id
     C           *LIKE     DEFN WBBZNA    WQSQ02           Carrier Code
      * Define keylist
     C           KPSSQ     KLIST
     C                     KFLD           WQSQ01           Trailer Id
     C                     KFLD           WQSQ02           Carrier Code
     C                     KFLD           WBRMNB           Load ID
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           Trailer Id
     C                     KFLD           WQSQ02           Carrier Code
      * Setup key
     C                     MOVELYL0013    WQSQ01           Trailer Id
     C                     MOVELYL0014    WQSQ02           Carrier Code
     C                     Z-ADD*ZERO     WBRMNB           Load ID
      * Establish starting position
     C           KPSSQ     SETLL@FJCPMJ                    *
     C           KRSSQ     READE@FJCPMJ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'TRLRAVL' W0RTN            *Return code
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Load ID NE PAR.Load Id 2
     C           WBRMNB    IFNE #DLOID                     *IF
      * CASE: DB1.Load Status is Prior to Shipped
     C           WBPKST    IFEQ 'C'                        *IF
     C           WBPKST    OREQ 'E'
     C           WBPKST    OREQ 'L'
     C           WBPKST    OREQ 'U'
     C                     MOVEL'TRLRASN' W0RTN            *Return code
      * PAR.USR Load ID = DB1.Load ID
     C                     Z-ADDWBRMNB    YL0034           USR Load ID
     C                     GOTO SQEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSQ     READE@FJCPMJ                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Load ID for Trailr RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WL0062           USR Active Load
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCBZNA    WQSR01           Carrier Code
     C           *LIKE     DEFN WCDXTX    WQSR02           Trailer Id
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           Carrier Code
     C                     KFLD           WQSR02           Trailer Id
      * Setup key
     C                     MOVELWL0061    WQSR01           Carrier Code
     C                     MOVELWL0060    WQSR02           Trailer Id
      * Establish starting position
     C           KRSSR     SETLL@FJCPR4                    *
     C           KRSSR     READE@FJCPR4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0059           Company Number
     C                     MOVEL*BLANK    WL0062           USR Active Load
     C                     Z-ADD*ZERO     WL0063           USR Load Assign
     C                     MOVEL'N'       WL0062           USR Active Load
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Truck Departure Date is not entered
     C           WCKIDT    IFEQ 0                          *IF
      * Active load
      * If Load is not the Load currently being edited.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Load ID NE PAR.Load ID
      *   |- c2    : DB1.Load Status is Entered,Comb,Unlck,Locked
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCRMNB    IFNE WL0058                     *IF
     C           WCPKST    IFEQ 'C'                        *IF
     C           WCPKST    OREQ 'E'
     C           WCPKST    OREQ 'L'
     C           WCPKST    OREQ 'U'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WL0062           USR Active Load
     C                     Z-ADDWCRMNB    WL0063           USR Load Assign
     C                     Z-ADDWCAIC3    WL0059           Company Number
     C                     GOTO SREXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * NOT Active load
     C                     END                             *FI
     C           KRSSR     READE@FJCPR4                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * RTV Verify Trffc Cmnts RT - PD Traffic Comments  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN KERMNB    WQSS01           Load ID
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSS01           Load ID
      * Establish starting position
     C           KRSSS     SETLL@KECPGI                    *
     C           KRSSS     READE@KECPGI                  90*
      * Data record not found
     C   90                MOVEL'USR2199' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     GOTO SSEXIT                     *QUIT
     C           KRSSS     READE@KECPGI                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv/Chg Assg Trailer   RT - Trailer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           LYBZNA           Carrier Code
     C                     KFLD           LYDXTX           Trailer Id
      * Setup key
     C                     MOVELWL0064    LYBZNA           Carrier Code
     C                     MOVELWL0065    LYDXTX           Trailer Id
      * Establish starting position
     C           KRSST     CHAIN@LYRER3              90    *
      * Data record not found
     C   90                MOVEL'USR2598' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg PD Trailer         CH - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELLYBZNA    WL0073    P      Carrier Code
     C                     MOVELLYDXTX    WL0074    P      Trailer Id
     C                     Z-ADDWL0066    WL0075           Company Number
     C                     MOVELLYVDST    WL0076    P      Load Type
     C                     MOVELLYX3ST    WL0077    P      Trailer Type
     C                     MOVELLYXGST    WL0078    P      Seaboard Owned
     C                     MOVELWL0067    WL0079    P      On Yard Status
     C                     Z-ADDWL0068    WL0080           On Yard Date
     C                     Z-ADDWL0069    WL0081           On Yard Time
     C                     MOVELWL0070    WL0082    P      Assigned Status
     C                     MOVELWL0071    WL0083    P      Available Statu
     C                     MOVELLYX7CD    WL0084    P      Not Available R
     C                     MOVELLYGXTX    WL0085    P      Comment Line
     C                     MOVELLYXTST    WL0086    P      Status Unused 1
     C                     MOVELLYXVST    WL0087    P      Status Unused 2
     C                     MOVELLYSTU3    WL0088    P      Status Unused 3
     C                     MOVELLYSTU4    WL0089    P      Status Unused 4
     C                     MOVELLYSTU5    WL0090    P      Status Unused 5
     C                     Z-ADDLYLCDT    WL0091           Date Unused 1
     C                     Z-ADDLYLDDT    WL0092           Date Unused 2
     C                     Z-ADDLYLEDT    WL0093           Date Unused 3
     C                     Z-ADDLYLFDT    WL0094           Date Unused 4
     C                     Z-ADDLYLGDT    WL0095           Date Unused 5
     C                     MOVELLYUVST    WL0096    P      EDI Status 1
     C                     MOVELLYUWST    WL0097    P      EDI Status 2
     C                     MOVELLYUXST    WL0098    P      EDI Status 3
     C                     MOVELLYVSST    WL0099    P      Record Status
     C                     Z-ADDLYAATM    WL0100           Job Time
     C                     MOVELLYAYNA    WL0101    P      User Id
     C                     MOVELLYA0NA    WL0102    P      Job Name
     C                     Z-ADDLYAXDT    WL0103           Job Date
     C                     EXSR SUCHRC
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCHRC    BEGSR
      *================================================================
      * Chg PD Trailer         CH - Trailer  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @LYRER2
     C                     MOVELWL0073    WDBZNA    P      Carrier Code
     C                     MOVELWL0074    WDDXTX    P      Trailer Id
      *
     C           KLCHSU    KLIST
     C                     KFLD           WDBZNA           Carrier Code
     C                     KFLD           WDDXTX           Trailer Id
     C           KLCHSU    CHAIN@LYRER2              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDLYREL0'MDACP
     C                     MOVEL'@LYRER2' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDLY1    YARDCS
      * Move non-key fields to @LYRER2
     C                     Z-ADDWL0075    WDAIC3           Company Number
     C                     MOVELWL0076    WDVDST    P      Load Type
     C                     MOVELWL0077    WDX3ST    P      Trailer Type
     C                     MOVELWL0078    WDXGST    P      Seaboard Owned
     C                     MOVELWL0079    WDSTOY    P      On Yard Status
     C                     Z-ADDWL0080    WDKKDT           On Yard Date
     C                     Z-ADDWL0081    WDAVTM           On Yard Time
     C                     MOVELWL0082    WDSTAS    P      Assigned Status
     C                     MOVELWL0083    WDXRST    P      Available Statu
     C                     MOVELWL0084    WDX7CD    P      Not Available R
     C                     MOVELWL0085    WDGXTX    P      Comment Line
     C                     MOVELWL0086    WDXTST    P      Status Unused 1
     C                     MOVELWL0087    WDXVST    P      Status Unused 2
     C                     MOVELWL0088    WDSTU3    P      Status Unused 3
     C                     MOVELWL0089    WDSTU4    P      Status Unused 4
     C                     MOVELWL0090    WDSTU5    P      Status Unused 5
     C                     Z-ADDWL0091    WDLCDT           Date Unused 1
     C                     Z-ADDWL0092    WDLDDT           Date Unused 2
     C                     Z-ADDWL0093    WDLEDT           Date Unused 3
     C                     Z-ADDWL0094    WDLFDT           Date Unused 4
     C                     Z-ADDWL0095    WDLGDT           Date Unused 5
     C                     MOVELWL0096    WDUVST    P      EDI Status 1
     C                     MOVELWL0097    WDUWST    P      EDI Status 2
     C                     MOVELWL0098    WDUXST    P      EDI Status 3
     C                     MOVELWL0099    WDVSST    P      Record Status
     C                     Z-ADDWL0100    WDAATM           Job Time
     C                     MOVELWL0101    WDAYNA    P      User Id
     C                     MOVELWL0102    WDA0NA    P      Job Name
     C                     Z-ADDWL0103    WDAXDT           Job Date
      *
      * Set PGM.*Record Data Changed flag
     C           QPDLY1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##PGM     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDLY1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@LYRER2                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDLYREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVDLRC    BEGSR
      *================================================================
      * DLT Trailer            DO - Trailer  * E004079
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @LYRER2
     C                     MOVEL#1BZNA    WDBZNA           Carrier Code
     C                     MOVEL#DS2TX    WDDXTX           Trailer Id
      *
     C           KLDLSV    KLIST
     C                     KFLD           WDBZNA           Carrier Code
     C                     KFLD           WDDXTX           Trailer Id
     C           KLDLSV    CHAIN@LYRER2              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDLYREL0'MDACP
     C                     MOVEL'@LYRER2' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SVEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@LYRER2                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWCHRC    BEGSR
      *================================================================
      * CHG Load Cust Service  CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0010  30       Company Number
     C                     Z-ADD*ZERO     WN0011  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0012  1        LTL Flag
     C                     MOVEL*BLANK    WN0013  1        Load Status
     C                     Z-ADD*ZERO     WN0014  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0015 15        Seal 1
     C                     MOVEL*BLANK    WN0016 15        Seal 2
     C                     MOVEL*BLANK    WN0017 15        Seal 3
     C                     MOVEL*BLANK    WN0018 15        Seal 4
     C                     MOVEL*BLANK    WN0019 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0020  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0021 112       Flat Amount
     C                     MOVEL*BLANK    WN0022  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0023  50       Total Stops
     C                     MOVEL*BLANK    WN0024  3        Transloader Car
     C                     Z-ADD*ZERO     WN0025  40       BOL Time
     C                     MOVEL*BLANK    WN0026  3        Carrier Code
     C                     MOVEL*BLANK    WN0027  7        Truck Size
     C                     Z-ADD*ZERO     WN0028  70       Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WN0029 112       Rated Freight
     C                     MOVEL*BLANK    WN0030  1        Ship Status
     C                     MOVEL*BLANK    WN0031  1        Load Type
     C                     Z-ADD*ZERO     WN0032  50       Number Pallets
     C                     Z-ADD*ZERO     WN0033  50       Number Pallets
     C                     Z-ADD*ZERO     WN0034 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0035  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0036  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0037  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0038 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0039 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0040  70       Actual Departur
     C                     Z-ADD*ZERO     WN0041  40       Departure Time
     C                     Z-ADD*ZERO     WN0042  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0043  52       Product Tempera
     C                     Z-ADD*ZERO     WN0044  50       Number Spacers
     C                     MOVEL*BLANK    WN0045 12        Car_Veh_Initial
     C                     Z-ADD*ZERO     WN0046  70       Total Load Mile
     C                     MOVEL*BLANK    WN0047 12        Recorder ID
     C                     MOVEL*BLANK    WN0048  2        Shipping Method
     C                     MOVEL*BLANK    WN0049  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0050  2        Ship To State C
     C                     Z-ADD*ZERO     WN0051  70       Gross Weight
     C                     MOVEL*BLANK    WN0052  3        Carrier Broker
     C                     MOVEL*BLANK    WN0053  1        Export Status
     C                     Z-ADD*ZERO     WN0054  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0055  1        On Time_Y_N
     C                     Z-ADD*ZERO     WN0056  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0057  60       BOL Complete Ti
     C                     MOVEL*BLANK    WN0058  3        Shipping Line
     C                     MOVEL*BLANK    WN0059 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0060 30        Vessel Name
     C                     Z-ADD*ZERO     WN0061  50       Voyage
     C                     Z-ADD*ZERO     WN0062  70       Sail Date
     C                     MOVEL*BLANK    WN0063 12        Booking Number
     C                     MOVEL*BLANK    WN0064 20        Discharge Port
     C                     Z-ADD*ZERO     WN0065  70       Arrival Date
     C                     MOVEL*BLANK    WN0066 12        Container Numbe
     C                     Z-ADD*ZERO     WN0067  70       Date In
     C                     Z-ADD*ZERO     WN0068  60       Time In
     C                     Z-ADD*ZERO     WN0069  70       Date Out
     C                     Z-ADD*ZERO     WN0070  60       Time Out
     C                     Z-ADD*ZERO     WN0071 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0072  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0073  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0074  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0075  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0076  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0077  70       Requested Deliv
     C                     MOVEL*BLANK    WN0078  1        Load Acceptance
     C                     MOVEL*BLANK    WN0079  3        Warehouse Code
     C                     MOVEL*BLANK    WN0080  1        Load Held Over
     C                     MOVEL*BLANK    WN0081  1        Load Held Over
     C                     MOVEL*BLANK    WN0082 15        Load Held Over
     C                     MOVEL*BLANK    WN0083 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0084 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0085  70       Express Mail Da
     C                     Z-ADD*ZERO     WN0086  70       Product Complet
     C                     Z-ADD*ZERO     WN0087  60       Product Complet
     C                     Z-ADD*ZERO     WN0088  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0089  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0090  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0091  1        Load Confirmed
     C                     MOVEL*BLANK    WN0092 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0093  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0094  70       Override Total
     C                     MOVEL*BLANK    WN0095  1        Load Confirmati
     C                     MOVEL*BLANK    WN0096  1        Export Load USD
     C                     MOVEL*BLANK    WN0097  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0098 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0099 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0100 15        Late Billing Em
     C                     MOVEL*BLANK    WN0101 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0102 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0103  1        Multi Company L
     C                     MOVEL*BLANK    WN0104  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0105  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0106  1        LH Power Only L
     C                     MOVEL*BLANK    WN0107  1        MG Created Load
     C                     MOVEL*BLANK    WN0108  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0109  2        Load U_M
     C                     MOVEL*BLANK    WN0110  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0111  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0112  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0113  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0114  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0115  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0116  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0117  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0118  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0119  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0120  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0121  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0122  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0123  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0124  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0125  60       LH Unused Time
     C                     MOVEL*BLANK    WN0126  1        EDI Status 1
     C                     MOVEL*BLANK    WN0127  1        EDI Status 2
     C                     MOVEL*BLANK    WN0128  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0129  60       Job Time
     C                     MOVEL*BLANK    WN0130 10        User Id
     C                     MOVEL*BLANK    WN0131 10        Job Name
     C                     Z-ADD*ZERO     WN0132  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADD#DLOID    FJRMNB           Load ID
      *
     C           KLCHSW    KLIST
     C                     KFLD           FJRMNB           Load ID
     C           KLCHSW    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SWEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE @1DBRC    YBRDCS
      * USER: Processing after Data read
      * CASE: DB1.MG Created Load is Yes
     C           FJRYSX    IFEQ 'Y'                        *IF
      * If Trailer, adj dep,dep, bol rcv  changes: Write TMS ord trigger
      * CASE:
      *  - c1ORc2ORc8ORc3ORc4ORc5ORc6ORc7
      *   |- c1    : PAR.Trailer Id NE DB1.Trailer Id
      *   |- c2    : PAR.Truck Departure Date NE DB1.Truck Departure Date
      *   |- c8    : PAR.Truck Departure Time NE DB1.Truck Departure Time
      *   |- c3    : PAR.Adjusted Departure Date NE DB1.Adjusted Departur
      *   |- c4    : PAR.Adjusted Departure Time NE DB1.Adjusted Departur
      *   |- c5    : PAR.BOL Received Date NE DB1.BOL Received Date
      *   |- c6    : PAR.BOL Received Time NE DB1.BOL Received Time
      *   |- c7    : PAR.Trailer Id NE DB1.Trailer Id
      *   '-
     C           #DS2TX    IFNE FJDXTX                     *IF
     C           #1KIDT    ORNE FJKIDT                     *OR
     C           #1ASTM    ORNE FJASTM                     *OR
     C           #1KADT    ORNE FJKADT                     *OR
     C           #1AJCM    ORNE FJAJCM                     *OR
     C           #1J8DT    ORNE FJJ8DT                     *OR
     C           #1BLTM    ORNE FJBLTM                     *OR
     C           #DS2TX    ORNE FJDXTX                     *OR
     C                     MOVELWUS3TX    YL0039           Load Change Typ
     C                     MOVELWUS3TX    YL0040           Load Change Typ
     C                     MOVELWUS3TX    YL0041           Load Change Typ
     C                     MOVELWUS3TX    YL0042           Load Change Typ
     C                     MOVELWUS3TX    YL0043           Load Change Typ
      * trailer
      * CASE: PAR.Trailer Id NE DB1.Trailer Id
     C           #DS2TX    IFNE FJDXTX                     *IF
     C                     MOVEL'ASNTRL'  YL0039           Load Change Typ
     C                     END                             *FI
      * truck depart
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.Truck Departure Date NE DB1.Truck Departure Date
      *   |- c2    : PAR.Truck Departure Time NE DB1.Truck Departure Time
      *   '-
     C           #1KIDT    IFNE FJKIDT                     *IF
     C           #1ASTM    ORNE FJASTM                     *OR
      * CASE: LCL.Load Change Type EQ WRK.Blank for 12          USR
     C           YL0039    IFEQ WUS3TX                     *IF
     C                     MOVEL'TRKDPT'  YL0039           Load Change Typ
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'TRKDPT'  YL0040           Load Change Typ
     C                     END                             *FI
     C                     END                             *FI
      * adj depart
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.Adjusted Departure Date NE DB1.Adjusted Departur
      *   |- c2    : PAR.Adjusted Departure Time NE DB1.Adjusted Departur
      *   '-
     C           #1KADT    IFNE FJKADT                     *IF
     C           #1AJCM    ORNE FJAJCM                     *OR
      * CASE: LCL.Load Change Type EQ WRK.Blank for 12          USR
     C           YL0039    IFEQ WUS3TX                     *IF
     C                     MOVEL'ADJDPT'  YL0039           Load Change Typ
     C                     ELSE
      * CASE: LCL.Load Change Type 2 EQ WRK.Blank for 12          USR
     C           YL0040    IFEQ WUS3TX                     *IF
     C                     MOVEL'ADJDPT'  YL0040           Load Change Typ
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'ADJDPT'  YL0041           Load Change Typ
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * bol recvd
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.BOL Received Date NE DB1.BOL Received Date
      *   |- c2    : PAR.BOL Received Time NE DB1.BOL Received Time
      *   '-
     C           #1J8DT    IFNE FJJ8DT                     *IF
     C           #1BLTM    ORNE FJBLTM                     *OR
      * CASE: LCL.Load Change Type EQ WRK.Blank for 12          USR
     C           YL0039    IFEQ WUS3TX                     *IF
     C                     MOVEL'BOLRCV'  YL0039           Load Change Typ
     C                     ELSE
      * CASE: LCL.Load Change Type 2 EQ WRK.Blank for 12          USR
     C           YL0040    IFEQ WUS3TX                     *IF
     C                     MOVEL'BOLRCV'  YL0040           Load Change Typ
     C                     ELSE
      * CASE: LCL.Load Change Type 3 EQ WRK.Blank for 12          USR
     C           YL0041    IFEQ WUS3TX                     *IF
     C                     MOVEL'BOLRCV'  YL0041           Load Change Typ
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'BOLRCV'  YL0042           Load Change Typ
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Exc Crt TMS Load Trg  XF - TMS Load Trigger  * 
     C                     CALL 'PBXOXFR'              90  Exc Crt TMS Loa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM ##JDT     WQ0176  70       Job Date
     C                     PARM ##JTM     WQ0177  60       Job Time
     C                     PARM FJRMNB    WQ0178  70       Load ID
     C                     PARM FJAIC3    WQ0179  30       TMS LH Load Str
     C                     PARM YL0044    WQ0180 35        TMS LH Field Ch
     C                     PARM 'A'       WQ0181  1        TMS Record Stat
     C                     PARM *ZERO     WQ0182  30       TMS Process Sta
     C                     PARM *BLANK    WQ0183  6        TMS Error Reaso
     C                     PARM *ZERO     WQ0184  80       TMS Change Date
     C                     PARM *ZERO     WQ0185  60       TMS Change time
     C                     PARM YL0039    WQ0186  6        Load Change Typ
     C                     PARM YL0040    WQ0187  6        Load Change Typ
     C                     PARM YL0041    WQ0188  6        Load Change Typ
     C                     PARM YL0042    WQ0189  6        Load Change Typ
     C                     PARM YL0043    WQ0190  6        Load Change Typ
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBXOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Move non-key fields to @FJCPBO
     C                     MOVEL#DS2TX    FJDXTX    P      Trailer Id
     C                     Z-ADD#1J4DT    FJJ4DT           Truck Ready Dat
     C                     Z-ADD#1TRTM    FJTRTM           Truck Ready Tim
     C                     Z-ADD#1J5DT    FJJ5DT           Spotted Date
     C                     Z-ADD#1SPTM    FJSPTM           Spotted Time
     C                     Z-ADD#1J6DT    FJJ6DT           Load Finished D
     C                     Z-ADD#1LFTM    FJLFTM           Load Finished T
     C                     Z-ADD#1J8DT    FJJ8DT           BOL Received Da
     C                     Z-ADD#1BLTM    FJBLTM           BOL Received Ti
     C                     Z-ADD#1KIDT    FJKIDT           Truck Departure
     C                     Z-ADD#1ASTM    FJASTM           Truck Departure
     C                     Z-ADD#1KADT    FJKADT           Adjusted Depart
     C                     Z-ADD#1AJCM    FJAJCM           Adjusted Depart
     C                     Z-ADD#1KKDT    FJKKDT           On Yard Date
     C                     Z-ADD#1AVTM    FJAVTM           On Yard Time
     C                     Z-ADDWN0007    FJKZDT           Deadline Depart
     C                     Z-ADDWN0008    FJAXTM           Deadline Depart
     C                     MOVEL#1LSHG    FJLSHG    P      Load Shag Flag
     C                     MOVEL#1YPST    FJYPST    P      Load Wash Flag
     C                     Z-ADD#DM6NX    FJAZTM           Load Door 1
     C                     Z-ADD#DM7NX    FJA0TM           Load Door 2
     C                     MOVEL#1ROST    FJROST    P      Partial Load
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     FJAATM           Job Time
     C                     MOVEL##USR     FJAYNA           User Id
     C                     MOVEL##JOB     FJA0NA           Job Name
     C                     Z-ADD##JDT     FJAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXCRRC    BEGSR
      *================================================================
      * Crt PD Trailer         CR - Trailer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @LYRER2
     C                     MOVELWL0104    WDBZNA           Carrier Code
     C                     MOVELWL0105    WDDXTX           Trailer Id
     C                     Z-ADDWL0106    WDAIC3           Company Number
     C                     MOVELWL0107    WDVDST           Load Type
     C                     MOVELWL0108    WDX3ST           Trailer Type
     C                     MOVELWL0109    WDXGST           Seaboard Owned
     C                     MOVELWL0110    WDSTOY           On Yard Status
     C                     Z-ADDWL0111    WDKKDT           On Yard Date
     C                     Z-ADDWL0112    WDAVTM           On Yard Time
     C                     MOVELWL0113    WDSTAS           Assigned Status
     C                     MOVELWL0114    WDXRST           Available Statu
     C                     MOVELWL0115    WDX7CD           Not Available R
     C                     MOVELWL0116    WDGXTX           Comment Line
     C                     MOVELWL0117    WDXTST           Status Unused 1
     C                     MOVELWL0118    WDXVST           Status Unused 2
     C                     MOVELWL0119    WDSTU3           Status Unused 3
     C                     MOVELWL0120    WDSTU4           Status Unused 4
     C                     MOVELWL0121    WDSTU5           Status Unused 5
     C                     Z-ADDWL0122    WDLCDT           Date Unused 1
     C                     Z-ADDWL0123    WDLDDT           Date Unused 2
     C                     Z-ADDWL0124    WDLEDT           Date Unused 3
     C                     Z-ADDWL0125    WDLFDT           Date Unused 4
     C                     Z-ADDWL0126    WDLGDT           Date Unused 5
     C                     MOVELWL0127    WDUVST           EDI Status 1
     C                     MOVELWL0128    WDUWST           EDI Status 2
     C                     MOVELWL0129    WDUXST           EDI Status 3
     C                     MOVELWL0130    WDVSST           Record Status
     C                     Z-ADDWL0131    WDAATM           Job Time
     C                     MOVELWL0132    WDAYNA           User Id
     C                     MOVELWL0133    WDA0NA           Job Name
     C                     Z-ADDWL0134    WDAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WDVSST           Record Status
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##PGM     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
     C           KLCRSX    KLIST
     C                     KFLD           WDBZNA           Carrier Code
     C                     KFLD           WDDXTX           Trailer Id
      * Check for duplicate primary key
     C           KLCRSX    SETLL@LYRER2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2599' W0RTN   7
      * Send message 'Trailer Master         EX'
     C                     MOVEL'USR2599' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C                     WRITE@LYRER2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYCHRC    BEGSR
      *================================================================
      * CHG Asgn, Avail, On Yd CH - Trailer  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     MOVEL*BLANK    WN0133  1        Load Type
     C                     MOVEL*BLANK    WN0134  1        Trailer Type
     C                     MOVEL*BLANK    WN0135  1        Seaboard Owned
     C                     MOVEL*BLANK    WN0136  3        Not Available R
     C                     MOVEL*BLANK    WN0137 30        Comment Line
     C                     MOVEL*BLANK    WN0138  1        Status Unused 1
     C                     MOVEL*BLANK    WN0139  1        Status Unused 2
     C                     MOVEL*BLANK    WN0140  1        Status Unused 3
     C                     MOVEL*BLANK    WN0141  1        Status Unused 4
     C                     MOVEL*BLANK    WN0142  1        Status Unused 5
     C                     Z-ADD*ZERO     WN0143  70       Date Unused 1
     C                     Z-ADD*ZERO     WN0144  70       Date Unused 2
     C                     Z-ADD*ZERO     WN0145  70       Date Unused 3
     C                     Z-ADD*ZERO     WN0146  70       Date Unused 4
     C                     Z-ADD*ZERO     WN0147  70       Date Unused 5
     C                     MOVEL*BLANK    WN0148  1        EDI Status 1
     C                     MOVEL*BLANK    WN0149  1        EDI Status 2
     C                     MOVEL*BLANK    WN0150  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0151  60       Job Time
     C                     MOVEL*BLANK    WN0152 10        User Id
     C                     MOVEL*BLANK    WN0153 10        Job Name
     C                     Z-ADD*ZERO     WN0154  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @LYRER2
     C                     MOVELWL0135    WDBZNA    P      Carrier Code
     C                     MOVELWL0136    WDDXTX    P      Trailer Id
      *
     C           KLCHSY    KLIST
     C                     KFLD           WDBZNA           Carrier Code
     C                     KFLD           WDDXTX           Trailer Id
     C           KLCHSY    CHAIN@LYRER2              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDLYREL0'MDACP
     C                     MOVEL'@LYRER2' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SYEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDLY1    YCRDCS
      * Move non-key fields to @LYRER2
     C                     Z-ADDWL0137    WDAIC3           Company Number
     C                     MOVELWL0138    WDSTOY    P      On Yard Status
     C                     Z-ADDWL0139    WDKKDT           On Yard Date
     C                     Z-ADDWL0140    WDAVTM           On Yard Time
     C                     MOVELWL0141    WDSTAS    P      Assigned Status
     C                     MOVELWL0142    WDXRST    P      Available Statu
     C                     MOVELWL0143    WDVSST    P      Record Status
      *
      * Set PGM.*Record Data Changed flag
     C           QPDLY1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##PGM     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDLY1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@LYRER2                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDLYREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * RTV/Upd Chgd Trlr/CntnrRT - Trailer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           LYBZNA           Carrier Code
     C                     KFLD           LYDXTX           Trailer Id
      * Setup key
     C                     MOVELYL0045    LYBZNA           Carrier Code
     C                     MOVELWUMUTX    LYDXTX           Trailer Id
      * Establish starting position
     C           KRSSZ     CHAIN@LYRER3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2598' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg PD Trailer         CH - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0045    WL0073    P      Carrier Code
     C                     MOVELWUMUTX    WL0074    P      Trailer Id
     C                     Z-ADDYL0047    WL0075           Company Number
     C                     MOVELLYVDST    WL0076    P      Load Type
     C                     MOVELLYX3ST    WL0077    P      Trailer Type
     C                     MOVELLYXGST    WL0078    P      Seaboard Owned
     C                     MOVELYL0051    WL0079    P      On Yard Status
     C                     Z-ADDYL0052    WL0080           On Yard Date
     C                     Z-ADDYL0053    WL0081           On Yard Time
     C                     MOVEL'N'       WL0082    P      Assigned Status
     C                     MOVEL'Y'       WL0083    P      Available Statu
     C                     MOVELLYX7CD    WL0084    P      Not Available R
     C                     MOVELLYGXTX    WL0085    P      Comment Line
     C                     MOVELLYXTST    WL0086    P      Status Unused 1
     C                     MOVELLYXVST    WL0087    P      Status Unused 2
     C                     MOVELLYSTU3    WL0088    P      Status Unused 3
     C                     MOVELLYSTU4    WL0089    P      Status Unused 4
     C                     MOVELLYSTU5    WL0090    P      Status Unused 5
     C                     Z-ADDLYLCDT    WL0091           Date Unused 1
     C                     Z-ADDLYLDDT    WL0092           Date Unused 2
     C                     Z-ADDLYLEDT    WL0093           Date Unused 3
     C                     Z-ADDLYLFDT    WL0094           Date Unused 4
     C                     Z-ADDLYLGDT    WL0095           Date Unused 5
     C                     MOVELLYUVST    WL0096    P      EDI Status 1
     C                     MOVELLYUWST    WL0097    P      EDI Status 2
     C                     MOVELLYUXST    WL0098    P      EDI Status 3
     C                     MOVELLYVSST    WL0099    P      Record Status
     C                     Z-ADDLYAATM    WL0100           Job Time
     C                     MOVELLYAYNA    WL0101    P      User Id
     C                     MOVELLYA0NA    WL0102    P      Job Name
     C                     Z-ADDLYAXDT    WL0103           Job Date
     C                     EXSR SUCHRC
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0155    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSTA     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    P4I6ST           Allow Multi_Com
     C                     MOVELDRMPNA    P4MPNA           Default Printer
     C                     MOVELDRBCCD    P4BCCD           Salesperson Cod
     C                     Z-ADDDRAIC3    YL0063           Company Number
     C                     MOVELDRBUVN    WN0156           User Code Model
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - User Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0144    DTAJVN           User Profile Na
     C                     MOVELWL0145    DTDNCD           Application Cod
      * Establish starting position
     C           KRSTB     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0146           Company Number
     C                     MOVELDTAJCD    WL0147           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQTC01           Application Cod
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WQTC01           Application Cod
      * Setup key
     C                     MOVEL'PDTFE1'  WQTC01           Application Cod
      * Establish starting position
     C           KRSTC     SETLL@DNRESF                    *
     C           KRSTC     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR TDRVGN
     C                     END                             *FI
     C           KRSTC     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQTD01           Application Cod
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WQTD01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQTD01           Application Cod
      * Establish starting position
     C           KRSTD     SETLL@DNRESF                    *
     C           KRSTD     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSTD     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * Rtv Profile Model     RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVEL##USR     DRAJVN           User Profile Na
      * Establish starting position
     C           KRSTE     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUBUVN           User Code Model
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRBUVN    WUBUVN           User Code Model
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * RTV Appl Whs Restrict  RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVEL##USR     DRAJVN           User Profile Na
      * Establish starting position
     C           KRSTF     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0010           Application WHS
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI7ST    YL0010           Application WHS
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * Rtv Active Status     RT - PFS Interface  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           BUY1NX           PFS Company Num
     C                     KFLD           BUGYAA           PFS Interface C
      * Setup key
     C                     Z-ADDP1AIC3    BUY1NX           PFS Company Num
     C                     MOVEL'LDORDD'  BUGYAA           PFS Interface C
      * Establish starting position
     C           KRSTG     CHAIN@BUREBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3541' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0065           PFS AccuSort Ac
     C                     MOVEL*BLANK    YL0037           PFS Carlisle Ac
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBUWSSX    YL0065           PFS AccuSort Ac
     C                     MOVELBUWUSX    YL0037           PFS Carlisle Ac
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           JYAIC3           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    JYAIC3           Company Number
      * Establish starting position
     C           KRSTH     CHAIN@JYRECE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2025' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0066           Plant Company S
     C                     MOVEL*BLANK    YL0067           Company Organiz
     C                     GOTO THEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELJYYISX    YL0066           Plant Company S
     C                     MOVELJYYJSX    YL0067           Company Organiz
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * RTV Numeric Value      RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           KMAIC3           Company Number
     C                     KFLD           KMV8CD           Company Value C
      * Setup key
     C                     Z-ADDP1AIC3    KMAIC3           Company Number
     C                     MOVEL@CN,008   KMV8CD           Company Value C
      * Establish starting position
     C           KRSTI     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDKMM8NB    YL0015           System Value Nu
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * RTV Alpha Value        RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           KMAIC3           Company Number
     C                     KFLD           KMV8CD           Company Value C
      * Setup key
     C                     Z-ADDP1AIC3    KMAIC3           Company Number
     C                     MOVE *BLANK    KMV8CD           Company Value C
     C                     MOVEL'DFTWASH' KMV8CD           Company Value C
      * Establish starting position
     C           KRSTJ     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELKMBXTX    YL0016           System Value Al
     C                     ENDIF
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * *****
      * ** 04/24/2011 LJB P000737
      * ** Pgm PODPUPR replaced with PDVVUPC. Parms changed to either
      * ** Print Only or Fax/Email to all carriers that are passed in.
      * ** *** Parms are:
      * ** Status-Y or N = Fax Carrier, Status Flag 1 Y/N=Fax Dispatcher,
      * ** Status Flag 2 Y/N=Fax Transloader, Status Flag 3 Y/N=Fax Mexic
      * ** Status Flag 4 Y/N=Fax Exp Coordn, Status Flag 5 Y/N=Fax Ocean
      * ** Usr Status (Y/N)=Print Only/Fax, Status Description 3=Printer
      * *****
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Check times for minutes *gt 59
      *================================================================
      * Error if On Yard time minutes is *gt 59
      * CASE: DTL.USR On Yard Time is Entered
     C           #DOYTM    IFNE 0                          *IF
     C                     MOVEL*BLANK    YL0023           Time Alpha usr
     C                     MOVEL#1AVTM    YL0023           Time Alpha usr
      * Mov DteTme MM dd YY.etcXF - /UT Functions  * 
     C                     CALL 'PNI4XFR'              90  Mov DteTme MM d
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0024    WQ0095  7        Date (Alpha) US
     C                     PARM YL0023    WQ0096  6        Time Alpha usr
     C           YL0025    PARM *BLANK    WQ0097  2        Month (Char) US
     C           YL0026    PARM *BLANK    WQ0098  2        Day   (Char) US
     C           YL0027    PARM *BLANK    WQ0099  2        Century Usr TXT
     C           YL0028    PARM *BLANK    WQ0100  2        Year  (Char) US
     C           YL0029    PARM *BLANK    WQ0101  2        Hours  2A
     C           YL0030    PARM *BLANK    WQ0102  2        Minutes  2A
     C           YL0031    PARM *BLANK    WQ0103  2        Seconds 2A
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNI4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVE YL0030    YL0032           USR Number 2.0
      * CASE: LCL.USR Number 2.0 GT LCL.test field two
     C           YL0032    IFGT YL0022                     *IF
      * Setup message data for message
     C                     Z-ADD#DOYTM    ZA0013           USR On Yard Tim
      * Send message 'Time field minutes GT 59'
     C                     MOVEL'USR2175' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Error if Truck Ready time minutes is *gt 59
      * CASE: DTL.USR Ready Time is Entered
     C           #DRDTM    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    YL0023           Time Alpha usr
     C                     MOVEL#1TRTM    YL0023           Time Alpha usr
      * Mov DteTme MM dd YY.etcXF - /UT Functions  * 
     C                     CALL 'PNI4XFR'              90  Mov DteTme MM d
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0024    WQ0104  7        Date (Alpha) US
     C                     PARM YL0023    WQ0105  6        Time Alpha usr
     C           YL0025    PARM *BLANK    WQ0106  2        Month (Char) US
     C           YL0026    PARM *BLANK    WQ0107  2        Day   (Char) US
     C           YL0027    PARM *BLANK    WQ0108  2        Century Usr TXT
     C           YL0028    PARM *BLANK    WQ0109  2        Year  (Char) US
     C           YL0029    PARM *BLANK    WQ0110  2        Hours  2A
     C           YL0030    PARM *BLANK    WQ0111  2        Minutes  2A
     C           YL0031    PARM *BLANK    WQ0112  2        Seconds 2A
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNI4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVE YL0030    YL0032           USR Number 2.0
      * CASE: LCL.USR Number 2.0 GT LCL.test field two
     C           YL0032    IFGT YL0022                     *IF
      * Setup message data for message
     C                     Z-ADD#DRDTM    ZA0014           USR Ready Time
      * Send message 'Time field minutes GT 59'
     C                     MOVEL'USR2175' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Error if Spotted time minutes is *gt 59
      * CASE: DTL.USR Picked Up Time is Entered
     C           #D        IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    YL0023           Time Alpha usr
     C                     MOVEL#1SPTM    YL0023           Time Alpha usr
      * Mov DteTme MM dd YY.etcXF - /UT Functions  * 
     C                     CALL 'PNI4XFR'              90  Mov DteTme MM d
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0024    WQ0113  7        Date (Alpha) US
     C                     PARM YL0023    WQ0114  6        Time Alpha usr
     C           YL0025    PARM *BLANK    WQ0115  2        Month (Char) US
     C           YL0026    PARM *BLANK    WQ0116  2        Day   (Char) US
     C           YL0027    PARM *BLANK    WQ0117  2        Century Usr TXT
     C           YL0028    PARM *BLANK    WQ0118  2        Year  (Char) US
     C           YL0029    PARM *BLANK    WQ0119  2        Hours  2A
     C           YL0030    PARM *BLANK    WQ0120  2        Minutes  2A
     C           YL0031    PARM *BLANK    WQ0121  2        Seconds 2A
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNI4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVE YL0030    YL0032           USR Number 2.0
      * CASE: LCL.USR Number 2.0 GT LCL.test field two
     C           YL0032    IFGT YL0022                     *IF
      * Setup message data for message
     C                     Z-ADD#D        ZA0015           USR Picked Up T
      * Send message 'Time field minutes GT 59'
     C                     MOVEL'USR2175' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9941  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Error if Load Finished time minutes is *gt 59
      * CASE: DTL.USR Finished Time is Entered
     C           #DFDTM    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    YL0023           Time Alpha usr
     C                     MOVEL#1LFTM    YL0023           Time Alpha usr
      * Mov DteTme MM dd YY.etcXF - /UT Functions  * 
     C                     CALL 'PNI4XFR'              90  Mov DteTme MM d
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0024    WQ0122  7        Date (Alpha) US
     C                     PARM YL0023    WQ0123  6        Time Alpha usr
     C           YL0025    PARM *BLANK    WQ0124  2        Month (Char) US
     C           YL0026    PARM *BLANK    WQ0125  2        Day   (Char) US
     C           YL0027    PARM *BLANK    WQ0126  2        Century Usr TXT
     C           YL0028    PARM *BLANK    WQ0127  2        Year  (Char) US
     C           YL0029    PARM *BLANK    WQ0128  2        Hours  2A
     C           YL0030    PARM *BLANK    WQ0129  2        Minutes  2A
     C           YL0031    PARM *BLANK    WQ0130  2        Seconds 2A
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNI4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVE YL0030    YL0032           USR Number 2.0
      * CASE: LCL.USR Number 2.0 GT LCL.test field two
     C           YL0032    IFGT YL0022                     *IF
      * Setup message data for message
     C                     Z-ADD#DFDTM    ZA0016           USR Finished Ti
      * Send message 'Time field minutes GT 59'
     C                     MOVEL'USR2175' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9946  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Error if BOL Complete time minutes is *gt 59
      * CASE: DTL.USR Complete Time is Entered
     C           #DCPTM    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    YL0023           Time Alpha usr
     C                     MOVEL#1BOTM    YL0023           Time Alpha usr
      * Mov DteTme MM dd YY.etcXF - /UT Functions  * 
     C                     CALL 'PNI4XFR'              90  Mov DteTme MM d
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0024    WQ0131  7        Date (Alpha) US
     C                     PARM YL0023    WQ0132  6        Time Alpha usr
     C           YL0025    PARM *BLANK    WQ0133  2        Month (Char) US
     C           YL0026    PARM *BLANK    WQ0134  2        Day   (Char) US
     C           YL0027    PARM *BLANK    WQ0135  2        Century Usr TXT
     C           YL0028    PARM *BLANK    WQ0136  2        Year  (Char) US
     C           YL0029    PARM *BLANK    WQ0137  2        Hours  2A
     C           YL0030    PARM *BLANK    WQ0138  2        Minutes  2A
     C           YL0031    PARM *BLANK    WQ0139  2        Seconds 2A
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNI4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVE YL0030    YL0032           USR Number 2.0
      * CASE: LCL.USR Number 2.0 GT LCL.test field two
     C           YL0032    IFGT YL0022                     *IF
      * Setup message data for message
     C                     Z-ADD#1BOTM    ZA0017           BOL Complete Ti
      * Send message 'Time field minutes GT 59'
     C                     MOVEL'USR2175' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Error if BOL Received time minutes is *gt 59
      * CASE: DTL.USR Billed Time is Entered
     C           #DBDTM    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    YL0023           Time Alpha usr
     C                     MOVEL#1BLTM    YL0023           Time Alpha usr
      * Mov DteTme MM dd YY.etcXF - /UT Functions  * 
     C                     CALL 'PNI4XFR'              90  Mov DteTme MM d
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0024    WQ0140  7        Date (Alpha) US
     C                     PARM YL0023    WQ0141  6        Time Alpha usr
     C           YL0025    PARM *BLANK    WQ0142  2        Month (Char) US
     C           YL0026    PARM *BLANK    WQ0143  2        Day   (Char) US
     C           YL0027    PARM *BLANK    WQ0144  2        Century Usr TXT
     C           YL0028    PARM *BLANK    WQ0145  2        Year  (Char) US
     C           YL0029    PARM *BLANK    WQ0146  2        Hours  2A
     C           YL0030    PARM *BLANK    WQ0147  2        Minutes  2A
     C           YL0031    PARM *BLANK    WQ0148  2        Seconds 2A
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNI4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVE YL0030    YL0032           USR Number 2.0
      * CASE: LCL.USR Number 2.0 GT LCL.test field two
     C           YL0032    IFGT YL0022                     *IF
      * Setup message data for message
     C                     Z-ADD#DBDTM    ZA0018           USR Billed Time
      * Send message 'Time field minutes GT 59'
     C                     MOVEL'USR2175' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9950  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Error if Truck Departure time minutes is *gt 59
      * CASE: DTL.USR Delivery After Time is Entered
     C           #DT9NB    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    YL0023           Time Alpha usr
     C                     MOVEL#1ASTM    YL0023           Time Alpha usr
      * Mov DteTme MM dd YY.etcXF - /UT Functions  * 
     C                     CALL 'PNI4XFR'              90  Mov DteTme MM d
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0024    WQ0149  7        Date (Alpha) US
     C                     PARM YL0023    WQ0150  6        Time Alpha usr
     C           YL0025    PARM *BLANK    WQ0151  2        Month (Char) US
     C           YL0026    PARM *BLANK    WQ0152  2        Day   (Char) US
     C           YL0027    PARM *BLANK    WQ0153  2        Century Usr TXT
     C           YL0028    PARM *BLANK    WQ0154  2        Year  (Char) US
     C           YL0029    PARM *BLANK    WQ0155  2        Hours  2A
     C           YL0030    PARM *BLANK    WQ0156  2        Minutes  2A
     C           YL0031    PARM *BLANK    WQ0157  2        Seconds 2A
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNI4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVE YL0030    YL0032           USR Number 2.0
      * CASE: LCL.USR Number 2.0 GT LCL.test field two
     C           YL0032    IFGT YL0022                     *IF
      * Setup message data for message
     C                     Z-ADD#DT9NB    ZA0019           USR Delivery Af
      * Send message 'Time field minutes GT 59'
     C                     MOVEL'USR2175' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9952  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Error if Adjusted Departure time minutes is *gt 59
      * CASE: DTL.Departure Time DFT is Entered
     C           #DXXTM    IFNE 0                          *IF
     C                     MOVEL*BLANK    YL0023           Time Alpha usr
     C                     MOVEL#1AJCM    YL0023           Time Alpha usr
      * Mov DteTme MM dd YY.etcXF - /UT Functions  * 
     C                     CALL 'PNI4XFR'              90  Mov DteTme MM d
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0024    WQ0158  7        Date (Alpha) US
     C                     PARM YL0023    WQ0159  6        Time Alpha usr
     C           YL0025    PARM *BLANK    WQ0160  2        Month (Char) US
     C           YL0026    PARM *BLANK    WQ0161  2        Day   (Char) US
     C           YL0027    PARM *BLANK    WQ0162  2        Century Usr TXT
     C           YL0028    PARM *BLANK    WQ0163  2        Year  (Char) US
     C           YL0029    PARM *BLANK    WQ0164  2        Hours  2A
     C           YL0030    PARM *BLANK    WQ0165  2        Minutes  2A
     C           YL0031    PARM *BLANK    WQ0166  2        Seconds 2A
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNI4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVE YL0030    YL0032           USR Number 2.0
      * CASE: LCL.USR Number 2.0 GT LCL.test field two
     C           YL0032    IFGT YL0022                     *IF
      * Setup message data for message
     C                     Z-ADD#DXXTM    ZA0020           Departure Time
      * Send message 'Time field minutes GT 59'
     C                     MOVEL'USR2175' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9954  *
      *
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * ***** Changes and comments
      *================================================================
      * ** 05/14/2012 LJB E002105
      * ** Restrict to Carrier/Trailer, okay if multiple carriers have
      * ** the same trailer id
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * ** 05/07/2015 LJB E004079
      * ** If Trailer was changed, update original trailer as available.
      * ** 02/28/2009 LJB E002966
      * ** Trailer can now be added to load header when not yet on yard.
      * **  Update on yard date/time here, if that is the case
      * ** 09/30/2009 LJB E00495
      * ** Retrieve carrier appointment date/time. If it is entered,
      * ** Use for Deadline Departure Date/Time calcs
      * ** 11/16/2007 LJB FP1251
      * ** Deadline Depart date and time set to zeros if there is
      * ** no miles between cities record.
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Select existing record
      *================================================================
      * Name search required?
     C           YPMTFD    IFEQ '#1RMNB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1RMNB' defaulted for 'Load ID'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) P1AIC3' defaulted for 'Company Number'.
     C                     CALL 'OMCPSRR'              90  SEL Load ID
     C                     PARM *BLANK    W0RTN   7
     C           #1RMNB    PARM #1RMNB    WQ0049  70       Load ID
     C           P1AIC3    PARM P1AIC3    WQ0050  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMCPSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9931  *
     C                     END
      *
     C           #1RMNB    IFNE *ZERO                      Load ID
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y1SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
     C           *IN25     IFEQ '0'
      * Bypass when help done
     C                     SETOF                     94    *
     C           W0OVR1    IFEQ '1'
     C           W0OVR1    OREQ '0'
     C           *IN99     ANDEQ'0'
      * If override or no error
     C                     SETON                     94    *
     C                     Z-ADDW0ROW1    ZZCSRW
     C                     Z-ADDW0COL1    ZZCSCL
     C                     END
     C                     END
      *================================================================
     CSR         Y1EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C           @#DFMT    IFEQ '#RCDKEY'
      * KEY Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C                     ENDIF
     C           @#DFMT    IFEQ '#RCDDTL1'
      * DETAIL Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW1END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW1BEG,F
     C                     MOVELW1NAM,F   W0CFL
     C                     ENDIF
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
     C                     SETOF                     94    *
     C                     Z-ADD0         W0ROW1  30
     C                     Z-ADD0         W0COL1  30
     C                     MOVE '2'       W0OVR1  1
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           ZHCSRW    IFEQ 004
     C           ZHCSCL    ANDGE021
     C           ZHCSCL    ANDLE027
     C           @#DFMT    ANDEQ'#RCDKEY'
     C                     MOVEL'#1RMNB'  YPMTFD           Load ID
     C                     END
      *
     C           ZHCSRW    IFEQ 008
     C           ZHCSCL    ANDEQ017
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN77     ANDEQ'0'
     C                     MOVEL'#1LSHG'  YPMTFD           Load Shag Flag
     C                     END
      *
     C           ZHCSRW    IFEQ 008
     C           ZHCSCL    ANDEQ028
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN76     ANDEQ'0'
     C                     MOVEL'#1YPST'  YPMTFD           Load Wash Flag
     C                     END
      *
     C           ZHCSRW    IFEQ 016
     C           ZHCSCL    ANDEQ042
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1ROST'  YPMTFD           Partial Load
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM 1         YYLGCT  50       # of grps
     C                     PARM W0GRP     YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel and exit from key screen
      *================================================================
      * USER: Exit program processing
      * CASE: KEY.*CMD key is *Exit
     C           *IN03     IFEQ '1'                        *IF
     C                     MOVEL'Y'       P3STYN           USR Exit Progra
     C                     END                             *FI
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1KKDT           On Yard Date
     C                     Z-ADD*ZERO     P1AVTM           On Yard Time
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2X3ST           Trailer Type
     C                     MOVEL*BLANK    P2XGST           Seaboard Owned
     C                     MOVEL*BLANK    P2STOY           On Yard Status
     C                     MOVEL*BLANK    P2STAS           Assigned Status
     C                     MOVEL*BLANK    P2XRST           Available Statu
     C                     MOVEL*BLANK    P2X7CD           Not Available R
     C                     MOVEL*BLANK    P2GXTX           Comment Line
     C                     MOVEL*BLANK    P2VSST           Record Status
      * Clear all neither parameters
     C                     MOVEL*BLANK    P3ZGST           USR Trailer Out
     C                     MOVEL*BLANK    P3D4ST           USR Flag 1
      * Clear all neither parameters
     C                     MOVEL*BLANK    P4AJCD           Warehouse Code
     C                     MOVEL*BLANK    P4BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P4AJVN           User Profile Na
     C                     MOVEL*BLANK    P4I6ST           Allow Multi_Com
     C                     MOVEL*BLANK    P4MPNA           Default Printer
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P5SDTE           Current System
      * Clear all neither parameters
     C                     MOVEL*BLANK    P6G3TX           PRT Description
     C                     MOVEL*BLANK    P6WRST           PRT Printer Dev
     C                     MOVEL*BLANK    P6WSST           PRT Hold Output
     C                     MOVEL*BLANK    P6WTST           PRT Save Output
     C                     Z-ADD*ZERO     P6DYNB           PRT Number of C
     C                     MOVEL*BLANK    P6WUST           PRT Night Queue
     C                     MOVEL*BLANK    P6BVVN           PRT Night Queue
     C                     Z-ADD*ZERO     P6AJAA           Company Number
     C                     Z-ADD*ZERO     P6AJAB           Date 1
     C                     Z-ADD*ZERO     P6AJAE           Order Number 1
     C                     Z-ADD*ZERO     P6M8NB           System Value Nu
     C                     MOVEL*BLANK    P6B8ST           Status - Y or N
     C                     MOVEL*BLANK    P6HWSX           Change Flag USR
      * Clear all neither parameters
     C                     MOVEL*BLANK    P7Q1ST           Status Flag 1
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Trailer Id            USR
     C                     MOVEL*BLANK    WUMUTX 20
      * Define work field Record Status
     C                     MOVEL*BLANK    WUVSST  1
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field USR Load Type
     C                     MOVEL*BLANK    WUWNST  1
      * Define work field On Yard Date-Trailer  USR
     C                     Z-ADD*ZERO     WULNDT  70
      * Define work field On Yard Time-Trailer  USR
     C                     Z-ADD*ZERO     WUA3TM  60
      * Define work field Blank for 12          USR
     C                     MOVEL*BLANK    WUS3TX 12
      * Define work field USR On Yard Date
     C                     Z-ADD*ZERO     WULKDT  70
      * Define work field USR Truck Depart Date
     C                     Z-ADD*ZERO     WULJDT  70
      * Define work field USR Truck Depart Time
     C                     Z-ADD*ZERO     WU      40
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WARUNB           Stop_Drop Seque
     C                     Z-ADD*ZERO     WARVNB           Stop_Drop
     C                     Z-ADD*ZERO     WARWNB           Miles to next s
     C                     Z-ADD*ZERO     WARXNB           Freight Charge
     C                     Z-ADD*ZERO     WASQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WAT0NB           Freight Misc_Ch
     C                     Z-ADD*ZERO     WAT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WASXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WAKFDT           Appointment Con
     C                     Z-ADD*ZERO     WAACTM           Appointment Con
     C                     Z-ADD*ZERO     WAEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WAAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WAKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WAATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WAHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WAAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WAKKDT           On Yard Date
     C                     Z-ADD*ZERO     WAAVTM           On Yard Time
     C                     Z-ADD*ZERO     WAZ4NB           MPC Number
     C                     Z-ADD*ZERO     WAN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WAN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WAN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WAB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WAB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WAB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Actual Shipped Date
     C                     Z-ADD*ZERO     WUGNDT  70
      * Define work field Order Number
     C                     Z-ADD*ZERO     WUC4NB  70
      * Define work field MPC Number
     C                     Z-ADD*ZERO     WUZ4NB  70
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Define work field USR Display 11
     C                     MOVEL*BLANK    WUZ2SX  1
      * Define work field On Yard Time
     C                     Z-ADD*ZERO     WUAVTM  60
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field Company Number Pass   USR
     C                     Z-ADD*ZERO     WUAJAA 155
      * Define work field Job Name
     C                     MOVEL*BLANK    WUA0NA 10
      * Define work field USR Status (Y/N)
     C                     MOVEL*BLANK    WUE6ST  1
      * Define work field Status Description 3  USR
     C                     MOVEL*BLANK    WUNMTX 10
      * Define work field Status - Y or N
     C                     MOVEL*BLANK    WUB8ST  1
      * Define work field Status Flag 1  Y/N
     C                     MOVEL*BLANK    WUQ1ST  1
      * Define work field Return Code Usr
     C                     MOVEL*BLANK    WUH3TX  7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WBFLAM           Flat Amount
     C                     Z-ADD*ZERO     WBRRNB           Total Stops
     C                     Z-ADD*ZERO     WBSBNB           BOL Time
     C                     Z-ADD*ZERO     WBSQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBSDNB           Number Pallets
     C                     Z-ADD*ZERO     WBPAOU           Number Pallets
     C                     Z-ADD*ZERO     WBDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WBSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WBHADT           Actual Arrival
     C                     Z-ADD*ZERO     WBAART           Actual Arrival
     C                     Z-ADD*ZERO     WBDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WBDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WBAQDT           Actual Departur
     C                     Z-ADD*ZERO     WBS6NB           Departure Time
     C                     Z-ADD*ZERO     WBT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WBPRTM           Product Tempera
     C                     Z-ADD*ZERO     WBNPSV           Number Spacers
     C                     Z-ADD*ZERO     WBTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WBGRWE           Gross Weight
     C                     Z-ADD*ZERO     WBF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WBJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WBTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WBJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WBSPTM           Spotted Time
     C                     Z-ADD*ZERO     WBJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WBLFTM           Load Finished T
     C                     Z-ADD*ZERO     WBJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WBBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WBJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WBBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WBKIDT           Truck Departure
     C                     Z-ADD*ZERO     WBASTM           Truck Departure
     C                     Z-ADD*ZERO     WBKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WBAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WBVOAG           Voyage
     C                     Z-ADD*ZERO     WBKBDT           Sail Date
     C                     Z-ADD*ZERO     WBEFDT           Arrival Date
     C                     Z-ADD*ZERO     WBKCDT           Date In
     C                     Z-ADD*ZERO     WBTMIN           Time In
     C                     Z-ADD*ZERO     WBKDDT           Date Out
     C                     Z-ADD*ZERO     WBVMNB           Time Out
     C                     Z-ADD*ZERO     WBOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WBKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WBATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WBBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBKKDT           On Yard Date
     C                     Z-ADD*ZERO     WBAVTM           On Yard Time
     C                     Z-ADD*ZERO     WBKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WBAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WBLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WBK0DT           Product Complet
     C                     Z-ADD*ZERO     WBAYTM           Product Complet
     C                     Z-ADD*ZERO     WBKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WBICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WBIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WBK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WBAZTM           Load Door 1
     C                     Z-ADD*ZERO     WBK2DT           Override Total
     C                     Z-ADD*ZERO     WBA0TM           Load Door 2
     C                     Z-ADD*ZERO     WBZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WBPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WBCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WBPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WBCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WBP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WBCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WBP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WBCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WBP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WBCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WBP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WBCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field USR On Yard Date New
     C                     Z-ADD*ZERO     WULMDT  70
      * Define work field USR On Yard Time New
     C                     Z-ADD*ZERO     WUA2TM  60
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define work field USR Active Load
     C                     MOVEL*BLANK    WUZJST  1
      * Define work field USR Load Assigned
     C                     Z-ADD*ZERO     WUL1LD  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDKKDT           On Yard Date
     C                     Z-ADD*ZERO     WDAVTM           On Yard Time
     C                     Z-ADD*ZERO     WDLCDT           Date Unused 1
     C                     Z-ADD*ZERO     WDLDDT           Date Unused 2
     C                     Z-ADD*ZERO     WDLEDT           Date Unused 3
     C                     Z-ADD*ZERO     WDLFDT           Date Unused 4
     C                     Z-ADD*ZERO     WDLGDT           Date Unused 5
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field Blank Date            USR
     C                     Z-ADD*ZERO     WUNKDT  70
      * Define work field Carrier Code Usr
     C                     MOVEL*BLANK    WUH8AA  3
      * Define work field Trailer ID USR
     C                     MOVEL*BLANK    WUS2TX 12
      * Define work field Type Code
     C                     MOVEL*BLANK    WUBOCD  2
      * Define work field Blank for 30          USR
     C                     MOVEL*BLANK    WUW4TX 30
      * Define work field Load Change Type
     C                     MOVEL*BLANK    WURVST  6
      * Define work field Department Control Code
     C                     MOVEL*BLANK    WUUJST  3
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Define work field User Code Model
     C                     MOVEL*BLANK    WUBUVN 10
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      * Initialize *SET CURSOR data
     C                     MOVE 'Y'       YSETCS  1
     C                     EXSR Y9CLR
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     MOVEL*BLANK    WL0001  3
     C                     MOVEL*BLANK    WL0002 30
     C                     MOVEL*BLANK    WL0003  1
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0004  30
     C                     MOVEL*BLANK    WL0005 30
      * Define local variables for subroutine SHRVGN.
     C                     MOVEL*BLANK    WL0006  3
     C                     MOVEL*BLANK    WL0007 20
     C                     Z-ADD*ZERO     WL0008  30
     C                     MOVEL*BLANK    WL0009  1
     C                     MOVEL*BLANK    WL0010  1
     C                     MOVEL*BLANK    WL0011  1
     C                     MOVEL*BLANK    WL0012  1
     C                     Z-ADD*ZERO     WL0013  70
     C                     Z-ADD*ZERO     WL0014  60
     C                     MOVEL*BLANK    WL0015  1
     C                     MOVEL*BLANK    WL0016  1
     C                     MOVEL*BLANK    WL0017  3
     C                     MOVEL*BLANK    WL0018 30
     C                     MOVEL*BLANK    WL0019  1
      * Define local variables for subroutine SIRVGN.
     C                     MOVEL*BLANK    WL0020  3
     C                     MOVEL*BLANK    WL0021 30
     C                     MOVEL*BLANK    WL0022 30
     C                     MOVEL*BLANK    WL0023 30
     C                     MOVEL*BLANK    WL0024 30
     C                     MOVEL*BLANK    WL0025 20
     C                     MOVEL*BLANK    WL0026 11
     C                     MOVEL*BLANK    WL0027  3
     C                     MOVEL*BLANK    WL0028  2
     C                     MOVEL*BLANK    WL0029  1
     C                     MOVEL*BLANK    WL0030 10
     C                     MOVEL*BLANK    WL0031  2
     C                     MOVEL*BLANK    WL0032  1
     C                     MOVEL*BLANK    WL0033  1
     C                     MOVEL*BLANK    WL0034  1
     C                     Z-ADD*ZERO     WL0035  52
     C                     MOVEL*BLANK    WL0036  1
     C                     MOVEL*BLANK    WL0037  1
     C                     MOVEL*BLANK    WL0038  1
     C                     MOVEL*BLANK    WL0039  1
     C                     Z-ADD*ZERO     WL0040  30
     C                     Z-ADD*ZERO     WL0041  30
     C                     Z-ADD*ZERO     WL0042  30
     C                     Z-ADD*ZERO     WL0043  30
     C                     MOVEL*BLANK    WL0044  3
     C                     MOVEL*BLANK    WL0045  1
     C                     MOVEL*BLANK    WL0046  1
     C                     MOVEL*BLANK    WL0047  1
     C                     MOVEL*BLANK    WL0048  1
     C                     MOVEL*BLANK    WL0049  2
     C                     MOVEL*BLANK    WL0050  2
     C                     MOVEL*BLANK    WL0051  3
     C                     MOVEL*BLANK    WL0052  3
     C                     MOVEL*BLANK    WL0053  3
     C                     MOVEL*BLANK    WL0054  1
     C                     MOVEL*BLANK    WL0055  1
     C                     MOVEL*BLANK    WL0056  1
     C                     MOVEL*BLANK    WL0057  1
      * Define local variables for subroutine SRRVGN.
     C                     Z-ADD*ZERO     WL0058  70
     C                     Z-ADD*ZERO     WL0059  30
     C                     MOVEL*BLANK    WL0060 20
     C                     MOVEL*BLANK    WL0061  3
     C                     MOVEL*BLANK    WL0062  1
     C                     Z-ADD*ZERO     WL0063  70
      * Define local variables for subroutine STRVGN.
     C                     MOVEL*BLANK    WL0064  3
     C                     MOVEL*BLANK    WL0065 20
     C                     Z-ADD*ZERO     WL0066  30
     C                     MOVEL*BLANK    WL0067  1
     C                     Z-ADD*ZERO     WL0068  70
     C                     Z-ADD*ZERO     WL0069  60
     C                     MOVEL*BLANK    WL0070  1
     C                     MOVEL*BLANK    WL0071  1
     C                     MOVEL*BLANK    WL0072 30
      * Define local variables for subroutine SUCHRC.
     C                     MOVEL*BLANK    WL0073  3
     C                     MOVEL*BLANK    WL0074 20
     C                     Z-ADD*ZERO     WL0075  30
     C                     MOVEL*BLANK    WL0076  1
     C                     MOVEL*BLANK    WL0077  1
     C                     MOVEL*BLANK    WL0078  1
     C                     MOVEL*BLANK    WL0079  1
     C                     Z-ADD*ZERO     WL0080  70
     C                     Z-ADD*ZERO     WL0081  60
     C                     MOVEL*BLANK    WL0082  1
     C                     MOVEL*BLANK    WL0083  1
     C                     MOVEL*BLANK    WL0084  3
     C                     MOVEL*BLANK    WL0085 30
     C                     MOVEL*BLANK    WL0086  1
     C                     MOVEL*BLANK    WL0087  1
     C                     MOVEL*BLANK    WL0088  1
     C                     MOVEL*BLANK    WL0089  1
     C                     MOVEL*BLANK    WL0090  1
     C                     Z-ADD*ZERO     WL0091  70
     C                     Z-ADD*ZERO     WL0092  70
     C                     Z-ADD*ZERO     WL0093  70
     C                     Z-ADD*ZERO     WL0094  70
     C                     Z-ADD*ZERO     WL0095  70
     C                     MOVEL*BLANK    WL0096  1
     C                     MOVEL*BLANK    WL0097  1
     C                     MOVEL*BLANK    WL0098  1
     C                     MOVEL*BLANK    WL0099  1
     C                     Z-ADD*ZERO     WL0100  60
     C                     MOVEL*BLANK    WL0101 10
     C                     MOVEL*BLANK    WL0102 10
     C                     Z-ADD*ZERO     WL0103  70
      * Define local variables for subroutine SXCRRC.
     C                     MOVEL*BLANK    WL0104  3
     C                     MOVEL*BLANK    WL0105 20
     C                     Z-ADD*ZERO     WL0106  30
     C                     MOVEL*BLANK    WL0107  1
     C                     MOVEL*BLANK    WL0108  1
     C                     MOVEL*BLANK    WL0109  1
     C                     MOVEL*BLANK    WL0110  1
     C                     Z-ADD*ZERO     WL0111  70
     C                     Z-ADD*ZERO     WL0112  60
     C                     MOVEL*BLANK    WL0113  1
     C                     MOVEL*BLANK    WL0114  1
     C                     MOVEL*BLANK    WL0115  3
     C                     MOVEL*BLANK    WL0116 30
     C                     MOVEL*BLANK    WL0117  1
     C                     MOVEL*BLANK    WL0118  1
     C                     MOVEL*BLANK    WL0119  1
     C                     MOVEL*BLANK    WL0120  1
     C                     MOVEL*BLANK    WL0121  1
     C                     Z-ADD*ZERO     WL0122  70
     C                     Z-ADD*ZERO     WL0123  70
     C                     Z-ADD*ZERO     WL0124  70
     C                     Z-ADD*ZERO     WL0125  70
     C                     Z-ADD*ZERO     WL0126  70
     C                     MOVEL*BLANK    WL0127  1
     C                     MOVEL*BLANK    WL0128  1
     C                     MOVEL*BLANK    WL0129  1
     C                     MOVEL*BLANK    WL0130  1
     C                     Z-ADD*ZERO     WL0131  60
     C                     MOVEL*BLANK    WL0132 10
     C                     MOVEL*BLANK    WL0133 10
     C                     Z-ADD*ZERO     WL0134  70
      * Define local variables for subroutine SYCHRC.
     C                     MOVEL*BLANK    WL0135  3
     C                     MOVEL*BLANK    WL0136 20
     C                     Z-ADD*ZERO     WL0137  30
     C                     MOVEL*BLANK    WL0138  1
     C                     Z-ADD*ZERO     WL0139  70
     C                     Z-ADD*ZERO     WL0140  60
     C                     MOVEL*BLANK    WL0141  1
     C                     MOVEL*BLANK    WL0142  1
     C                     MOVEL*BLANK    WL0143  1
      * Define local variables for subroutine TBRVGN.
     C                     MOVEL*BLANK    WL0144 10
     C                     MOVEL*BLANK    WL0145  6
     C                     Z-ADD*ZERO     WL0146  30
     C                     MOVEL*BLANK    WL0147  3
      * Define local work field Case Sensitive Field
     C                     MOVEL*BLANK    YL0001 30
      * Define local work field Case Upper Field
     C                     MOVEL*BLANK    YL0002 30
      * Define local work field Appointment Confirm Date
     C                     Z-ADD*ZERO     YL0003  70
      * Define local work field Appointment Confirm Time
     C                     Z-ADD*ZERO     YL0004  60
      * Define local work field Confirmation Made With
     C                     MOVEL*BLANK    YL0005 30
      * Define local work field Confirmation Number
     C                     MOVEL*BLANK    YL0006 10
      * Define local work field LD Unused Date 2
     C                     Z-ADD*ZERO     YL0007  70
      * Define local work field LD Unused Time 2
     C                     Z-ADD*ZERO     YL0008  60
      * Define local work field USR Company Number
     C                     Z-ADD*ZERO     YL0009  30
      * Define local work field Application WHS Restrict
     C                     MOVEL*BLANK    YL0010  1
      * Define local work field WHS/Item Access Sts USR
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field Shipping Line
     C                     MOVEL*BLANK    YL0012  3
      * Define null work field Deadline Departure Date
     C                     Z-ADD*ZERO     YN0001  70
      * Define null work field Deadline Departure Time
     C                     Z-ADD*ZERO     YN0002  60
      * Define null work field Load Confirmed Contact
     C                     MOVEL*BLANK    YN0003 25
      * Define local work field Trailer ID USR
     C                     MOVEL*BLANK    YL0013 12
      * Define local work field Carrier Code
     C                     MOVEL*BLANK    YL0014  3
      * Define null work field Company Number
     C                     Z-ADD*ZERO     YN0004  30
      * Define local work field Date From             USR
     C                     Z-ADD*ZERO     YL0015  70
      * Define local work field Load Wash Flag        Usr
     C                     MOVEL*BLANK    YL0016  1
      * Define local work field Change Wash Flag      USR
     C                     MOVEL*BLANK    YL0017  1
      * Define null work field Warehouse Description
     C                     MOVEL*BLANK    YN0005 30
      * Define null work field Address Line 1
     C                     MOVEL*BLANK    YN0006 30
      * Define null work field Address Line 2
     C                     MOVEL*BLANK    YN0007 30
      * Define null work field Address Line 3
     C                     MOVEL*BLANK    YN0008 30
      * Define null work field City
     C                     MOVEL*BLANK    YN0009 20
      * Define null work field Zip Postal Code
     C                     MOVEL*BLANK    YN0010 11
      * Define null work field Production Warehouse Code
     C                     MOVEL*BLANK    YN0011  3
      * Define null work field State Code
     C                     MOVEL*BLANK    YN0012  2
      * Define null work field Lot Tracking Flag
     C                     MOVEL*BLANK    YN0013  1
      * Define null work field Default Printer
     C                     MOVEL*BLANK    YN0014 10
      * Define null work field Warehouse Type
     C                     MOVEL*BLANK    YN0015  2
      * Define null work field Trans Contol AS400_Plant
     C                     MOVEL*BLANK    YN0016  1
      * Define local work field Warehouse Location
     C                     MOVEL*BLANK    YL0018  1
      * Define null work field Warehouse Std Chill Time
     C                     MOVEL*BLANK    YN0017  1
      * Define null work field Warehouse Chill Time
     C                     Z-ADD*ZERO     YN0018  52
      * Define null work field Include in Auto Pre Pick
     C                     MOVEL*BLANK    YN0019  1
      * Define null work field Default Manifest Copies
     C                     MOVEL*BLANK    YN0020  1
      * Define null work field Default Load Sequence
     C                     MOVEL*BLANK    YN0021  1
      * Define null work field WHS Slotting Limit Type
     C                     MOVEL*BLANK    YN0022  1
      * Define null work field Shipping Company
     C                     Z-ADD*ZERO     YN0023  30
      * Define null work field Accounting Company
     C                     Z-ADD*ZERO     YN0024  30
      * Define null work field WHS Sched Prod Max Days
     C                     Z-ADD*ZERO     YN0025  30
      * Define null work field WHS Inventory Chill Time
     C                     Z-ADD*ZERO     YN0026  30
      * Define null work field Parent Warehouse
     C                     MOVEL*BLANK    YN0027  3
      * Define null work field Default Shipping Whs
     C                     MOVEL*BLANK    YN0028  1
      * Define null work field WHS Live with Carlisle
     C                     MOVEL*BLANK    YN0029  1
      * Define null work field WHS PFS Interface
     C                     MOVEL*BLANK    YN0030  1
      * Define null work field WHS Req Meter Reading Shp
     C                     MOVEL*BLANK    YN0031  1
      * Define null work field WHS Default Load Type
     C                     MOVEL*BLANK    YN0032  2
      * Define null work field WHS TMS Planning Region
     C                     MOVEL*BLANK    YN0033  2
      * Define null work field Default Carrier Code
     C                     MOVEL*BLANK    YN0034  3
      * Define null work field Inventory Logic Version
     C                     MOVEL*BLANK    YN0035  3
      * Define null work field WHS Auto Inv Restoration
     C                     MOVEL*BLANK    YN0036  3
      * Define null work field EDI Status 1
     C                     MOVEL*BLANK    YN0037  1
      * Define null work field EDI Status 2
     C                     MOVEL*BLANK    YN0038  1
      * Define null work field EDI Status 3
     C                     MOVEL*BLANK    YN0039  1
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0040  1
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0019  30
      * Define null work field On Yard Status
     C                     MOVEL*BLANK    YN0041  1
      * Define null work field On Yard Date
     C                     Z-ADD*ZERO     YN0042  70
      * Define null work field On Yard Time
     C                     Z-ADD*ZERO     YN0043  60
      * Define null work field Available Status
     C                     MOVEL*BLANK    YN0044  1
      * Define local work field Customer Purchase Order #
     C                     MOVEL*BLANK    YL0020 15
      * Define local work field Job Log Create
     C                     MOVEL*BLANK    YL0021  4
      * Define local work field test field two
     C                     Z-ADD*ZERO     YL0022  20
      * Define local work field Time Alpha usr 6
     C                     MOVEL*BLANK    YL0023  6
      * Define local work field Date (Alpha) USR
     C                     MOVEL*BLANK    YL0024  7
      * Define local work field Month (Char) USR
     C                     MOVEL*BLANK    YL0025  2
      * Define local work field Day   (Char) USR
     C                     MOVEL*BLANK    YL0026  2
      * Define local work field Century Usr TXT
     C                     MOVEL*BLANK    YL0027  2
      * Define local work field Year  (Char) USR
     C                     MOVEL*BLANK    YL0028  2
      * Define local work field Hours  2A            USR
     C                     MOVEL*BLANK    YL0029  2
      * Define local work field Minutes  2A          USR
     C                     MOVEL*BLANK    YL0030  2
      * Define local work field Seconds 2A            USR
     C                     MOVEL*BLANK    YL0031  2
      * Define local work field USR Number 2.0
     C                     Z-ADD*ZERO     YL0032  20
      * Define local work field Load ID USR
     C                     Z-ADD*ZERO     YL0033  70
      * Define local work field Load Id 3
     C                     Z-ADD*ZERO     YL0034  70
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0035  1
      * Define local work field USR Load Assigned
     C                     Z-ADD*ZERO     YL0036  70
      * Define local work field PFS Carlisle Active
     C                     MOVEL*BLANK    YL0037  1
      * Define local work field Requested Delivery Date
     C                     Z-ADD*ZERO     YL0038  70
      * Define local work field Load Change Type
     C                     MOVEL*BLANK    YL0039  6
      * Define local work field Load Change Type 2
     C                     MOVEL*BLANK    YL0040  6
      * Define local work field Load Change Type 3
     C                     MOVEL*BLANK    YL0041  6
      * Define local work field Load Change Type 4
     C                     MOVEL*BLANK    YL0042  6
      * Define local work field Load Change Type 5
     C                     MOVEL*BLANK    YL0043  6
      * Define local work field TMS LH Field Chg Text
     C                     MOVEL*BLANK    YL0044 35
      * Define local work field Carrier Code
     C                     MOVEL*BLANK    YL0045  3
      * Define local work field Trailer Id
     C                     MOVEL*BLANK    YL0046 20
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0047  30
      * Define local work field Load Type
     C                     MOVEL*BLANK    YL0048  1
      * Define local work field Trailer Type
     C                     MOVEL*BLANK    YL0049  1
      * Define local work field Seaboard Owned Status
     C                     MOVEL*BLANK    YL0050  1
      * Define local work field On Yard Status
     C                     MOVEL*BLANK    YL0051  1
      * Define local work field On Yard Date
     C                     Z-ADD*ZERO     YL0052  70
      * Define local work field On Yard Time
     C                     Z-ADD*ZERO     YL0053  60
      * Define local work field Assigned Status
     C                     MOVEL*BLANK    YL0054  1
      * Define local work field Available Status
     C                     MOVEL*BLANK    YL0055  1
      * Define local work field Not Available Reason Code
     C                     MOVEL*BLANK    YL0056  3
      * Define local work field Comment Line
     C                     MOVEL*BLANK    YL0057 30
      * Define local work field Record Status
     C                     MOVEL*BLANK    YL0058  1
      * Define local work field Job Time
     C                     Z-ADD*ZERO     YL0059  60
      * Define local work field User Id
     C                     MOVEL*BLANK    YL0060 10
      * Define local work field Job Name
     C                     MOVEL*BLANK    YL0061 10
      * Define local work field Job Date
     C                     Z-ADD*ZERO     YL0062  70
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0063  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0064  3
      * Define local work field PFS AccuSort Active
     C                     MOVEL*BLANK    YL0065  1
      * Define local work field Plant Company Sts
     C                     MOVEL*BLANK    YL0066  1
      * Define local work field Company Organization
     C                     MOVEL*BLANK    YL0067  1
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
      * Set to *CHANGE mode
     C                     MOVEL'CHG'     W0PMD   3
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      *
     C                     MOVEL*BLANK    WN0155 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0155           User Profile Na
      *
     C                     MOVEL*BLANK    WN0156 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR TARVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0155    ZA0077           User Profile Na
     C                     MOVEL'PDTFE1'  ZA0078           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0156    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0155    WL0144    P      User Profile Na
     C                     MOVEL'PDTFE1'  WL0145    P      Application Cod
     C                     EXSR TBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0146    WUAIC3           Company Number
     C                     MOVELWL0147    YL0064    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0156    WL0144    P      User Profile Na
     C                     MOVEL'PDTFE1'  WL0145    P      Application Cod
     C                     EXSR TBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0146    WUAIC3           Company Number
     C                     MOVELWL0147    YL0064    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0064    P4AJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0155    ZA0079           User Profile Na
     C                     MOVEL'PDTFE1'  ZA0080           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0063    IFNE 0                          *IF
     C                     Z-ADDYL0063    WUAIC3           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0064    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           P4AJCD    PARM *BLANK    WQ0194  3        Warehouse Code
     C                     PARM YL0063    WQ0195  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR TCRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
      * Rtv Profile Model     RT - User Profile Control  * 
     C                     EXSR TERVGN
      * ** If Company Number is blank, default to security parms value
      * CASE: PAR.Company Number is Equal to zero
     C           P1AIC3    IFEQ *ZERO                      *IF
     C                     Z-ADDWUAIC3    P1AIC3           Company Number
     C                     END                             *FI
     C                     MOVEL'Y'       WUTAST           First Time Flag
     C                     MOVEL'N'       P3STYN           USR Exit Progra
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           P5SDTE    PARM *ZERO     WQ0196 155       Current System
     C           WUNFNN    PARM *ZERO     WQ0197 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       P6HWSX           Change Flag USR
      * RTV Appl Whs Restrict  RT - User Profile Control  * 
     C                     EXSR TFRVGN
      * P00196 RMC 8/24/12 get this now to chk it in the command proc
      * Rtv Active Status     RT - PFS Interface  * 
     C                     EXSR TGRVGN
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
     C                     EXSR THRVGN
      * 08/14/24 SP WI648-Start (Get field Effective Wash Date and Defaul
      * RTV Numeric Value      RT - Company Values  * 
     C                     EXSR TIRVGN
      * RTV Alpha Value        RT - Company Values  * 
     C                     EXSR TJRVGN
     C                     MOVEL'Y'       YL0017           Change Wash Fla
      * 08/14/24 SP WI648-End
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** KEY Screen: Field position and name array
01045
** W0END
01051
** W0NAM
#1RMNB
** W1BEG
01041010450129701329013500155301567
01581016020161101809018370185802065
02076021140232102370023790257702626
02833028360286102868033750338603631
03642038870389803910039130413804143
04154043990441004655046660491104922
0516705178
** W1END
01043010670132601348013510155901569
01585016090161501820018380186502065
02076021210232302377023830259602633
02833028400286302881033820339003638
03646038940390203911039140413804150
04158044060441404662046700491804926
0517405182
** W1NAM
#1BZNA    #DADTX    #DBRTX    #DHNNA    #1DBCD    #DLOID    V1AIC3
#1T4NB    V1AODT    #DABTH    #DS2TX    #1Q2CD    V1F9DT    #1LSHG
#1YPST    VDKGDT    #1VPCD    V1KZDT    #DAGTH    #1OANA    V1K0DT
#DFQSX    #DB2TM    #DQXAA    #DI6TX    V1KKDT    #DOYTM    V1J4DT
#DRDTM    V1J5DT    #D        #DM6NX    #DM7NX    #1ROST    V1J6DT
#DFDTM    V1J7DT    #DCPTM    V1J8DT    #DBDTM    V1KIDT    #DT9NB
V1KADT    #DXXTM
** @CN
00001 Y2U0005
00002 USR0752
00003 Print Load Confirm
00004 Y2U9999
00005 PNW2PFR$
00006 TRLRASN
00007 Y2U0003
00008 EFFWASHDT
