     H/TITLE UPD Create Weight Adj. XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.5 (1351)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 12/17/13  Time  : 16:39:35
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAB7CPLEIF  E           K        DISK
      * RSQ : Item Transaction Detail   Normal KEY Sequence (D)
      *
     FCAB7CPL0IF  E           K        DISK                      A
      * UPD : Item Transaction Detail   Update index
      *
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     I@B7CPZA
      * Item Transaction Detail   Normal KEY Sequence (D)
      * Renamed input format fields
     I              B7AIC3                          WAAIC3
     I              B7HGCD                          WAHGCD
     I              B7AJCD                          WAAJCD
     I              B7W9ST                          WAW9ST
     I              B7BSST                          WABSST
     I              B7B4DT                          WAB4DT
     I              B7C4NY                          WAC4NY
     I              B7DXNB                          WADXNB
     I              B7ELDT                          WAELDT
     I              B7HVCD                          WAHVCD
     I              B7F1ST                          WAF1ST
     I              B7AUNA                          WAAUNA
     I              B7A5QT                          WAA5QT
     I              B7AHWG                          WAAHWG
     I              B7AKCS                          WAAKCS
     I              B7CGCD                          WACGCD
     I              B7AYVA                          WAAYVA
     I              B7BJNA                          WABJNA
     I              B7CKNB                          WACKNB
     I              B7BMST                          WABMST
     I              B7CQCD                          WACQCD
     I              B7DTCD                          WADTCD
     I              B7MGNA                          WAMGNA
     I              B7TRBN                          WATRBN
     I              B7TRBS                          WATRBS
     I              B7C4NB                          WAC4NB
     I              B7RINB                          WARINB
     I              B7RHNB                          WARHNB
     I              B7RGNB                          WARGNB
     I              B7M3NA                          WAM3NA
     I              B7AWTM                          WAAWTM
     I              B7XLCD                          WAXLCD
     I              B7K7DT                          WAK7DT
     I              B7UVST                          WAUVST
     I              B7UWST                          WAUWST
     I              B7UXST                          WAUXST
     I              B7VSST                          WAVSST
     I              B7AATM                          WAAATM
     I              B7AYNA                          WAAYNA
     I              B7A0NA                          WAA0NA
     I              B7AXDT                          WAAXDT
      *
     I@B7CPJZ
      * Item Transaction Detail   Update index
      * Renamed input format fields
     I              B7AIC3                          WBAIC3
     I              B7HGCD                          WBHGCD
     I              B7AJCD                          WBAJCD
     I              B7W9ST                          WBW9ST
     I              B7BSST                          WBBSST
     I              B7B4DT                          WBB4DT
     I              B7C4NY                          WBC4NY
     I              B7DXNB                          WBDXNB
     I              B7ELDT                          WBELDT
     I              B7HVCD                          WBHVCD
     I              B7F1ST                          WBF1ST
     I              B7AUNA                          WBAUNA
     I              B7A5QT                          WBA5QT
     I              B7AHWG                          WBAHWG
     I              B7AKCS                          WBAKCS
     I              B7CGCD                          WBCGCD
     I              B7AYVA                          WBAYVA
     I              B7BJNA                          WBBJNA
     I              B7CKNB                          WBCKNB
     I              B7BMST                          WBBMST
     I              B7CQCD                          WBCQCD
     I              B7DTCD                          WBDTCD
     I              B7MGNA                          WBMGNA
     I              B7TRBN                          WBTRBN
     I              B7TRBS                          WBTRBS
     I              B7C4NB                          WBC4NB
     I              B7RINB                          WBRINB
     I              B7RHNB                          WBRHNB
     I              B7RGNB                          WBRGNB
     I              B7M3NA                          WBM3NA
     I              B7AWTM                          WBAWTM
     I              B7XLCD                          WBXLCD
     I              B7K7DT                          WBK7DT
     I              B7UVST                          WBUVST
     I              B7UWST                          WBUWST
     I              B7UXST                          WBUXST
     I              B7VSST                          WBVSST
     I              B7AATM                          WBAATM
     I              B7AYNA                          WBAYNA
     I              B7A0NA                          WBA0NA
     I              B7AXDT                          WBAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQCAB71    E DSCAB7CPL0
      * UPD : Item Transaction Detail   Update index
      * Renamed input format fields
     I              B7AIC3                          WBAIC3
     I              B7HGCD                          WBHGCD
     I              B7AJCD                          WBAJCD
     I              B7W9ST                          WBW9ST
     I              B7BSST                          WBBSST
     I              B7B4DT                          WBB4DT
     I              B7C4NY                          WBC4NY
     I              B7DXNB                          WBDXNB
     I              B7ELDT                          WBELDT
     I              B7HVCD                          WBHVCD
     I              B7F1ST                          WBF1ST
     I              B7AUNA                          WBAUNA
     I              B7A5QT                          WBA5QT
     I              B7AHWG                          WBAHWG
     I              B7AKCS                          WBAKCS
     I              B7CGCD                          WBCGCD
     I              B7AYVA                          WBAYVA
     I              B7BJNA                          WBBJNA
     I              B7CKNB                          WBCKNB
     I              B7BMST                          WBBMST
     I              B7CQCD                          WBCQCD
     I              B7DTCD                          WBDTCD
     I              B7MGNA                          WBMGNA
     I              B7TRBN                          WBTRBN
     I              B7TRBS                          WBTRBS
     I              B7C4NB                          WBC4NB
     I              B7RINB                          WBRINB
     I              B7RHNB                          WBRHNB
     I              B7RGNB                          WBRGNB
     I              B7M3NA                          WBM3NA
     I              B7AWTM                          WBAWTM
     I              B7XLCD                          WBXLCD
     I              B7K7DT                          WBK7DT
     I              B7UVST                          WBUVST
     I              B7UWST                          WBUWST
     I              B7UXST                          WBUXST
     I              B7VSST                          WBVSST
     I              B7AATM                          WBAATM
     I              B7AYNA                          WBAYNA
     I              B7A0NA                          WBA0NA
     I              B7AXDT                          WBAXDT
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Item Transaction Detail
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Item Code
     I                                    P   3   60P1HGCD
      * I :  Warehouse Code
     I                                        7   9 P1AJCD
      * I :  Transaction Date Code
     I                                    P  10  130P1B4DT
      * N :  ITD Sequence Number
     I                                    P  14  160P1C4NY
      * N :  Sequence Number
     I                                    P  17  180P1DXNB
      * I :  Production Date
     I                                    P  19  220P1ELDT
      * I :  U/M - Transaction
     I                                       23  24 P1HVCD
      * I :  Transaction Weight
     I                                    P  25  302P1AHWG
      * I :  USR Transaction-Unit Cost
     I                                    P  31  364P1AKCS
      * I :  U/M - Cost
     I                                       37  38 P1CGCD
      * N :  Extended Amount
     I                                    P  39  442P1AYVA
      * I :  Item Structure Class Code
     I                                    P  45  460P1RINB
      * I :  Item Structure Group Code
     I                                    P  47  480P1RHNB
      * I :  Item Structure Type Code
     I                                    P  49  500P1RGNB
      * I :  Shift Number
     I                                       51  51 P1XLCD
      * I :  Label Date
     I                                    P  52  550P1K7DT
     IP2PARM      DS
      * N :  USR Reason Code
     I                                        1   3 P2O9CD
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1HGCD    PARM           WP0002  70       Item Code
     C           P1AJCD    PARM           WP0003  3        Warehouse Code
     C           P1B4DT    PARM           WP0004  70       Transaction Dat
     C           P1ELDT    PARM           WP0005  70       Production Date
     C           P1HVCD    PARM           WP0006  2        U/M - Transacti
     C           P1AHWG    PARM           WP0007 112       Transaction Wei
     C           P1AKCS    PARM           WP0008 114       USR Transaction
     C           P1CGCD    PARM           WP0009  2        U/M - Cost
     C           P1RINB    PARM           WP0010  30       Item Structure
     C           P1RHNB    PARM           WP0011  30       Item Structure
     C           P1RGNB    PARM           WP0012  30       Item Structure
     C           P1XLCD    PARM           WP0013  1        Shift Number
     C           P1K7DT    PARM           WP0014  70       Label Date
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * UPD Create Weight Adj. XF
      * Crts weight adjustment transaction for when qty goes 0, wgt doesn
      * change sign on weight
     C           *ZERO     SUB  P1AHWG    WUAHWG           Transaction Wei
      * CASE: WRK.Transaction Weight EQ WRK.ZERO
     C           WUAHWG    IFEQ WUW0NB                     *IF
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     MOVEL*BLANK    P2O9CD           USR Reason Code
     C           P1AKCS    MULT P1AHWG    P1AYVA    H      Extended Amount
      * Error if unit cost = 0
      * CASE: PAR.USR Transaction-Unit Cost EQ WRK.ZERO
     C           P1AKCS    IFEQ WUW0NB                     *IF
     C                     MOVEL'ERR'     P2O9CD           USR Reason Code
     C                     END                             *FI
      * Rtv Next Sequence No.  RT - Item Transaction Detail  * 
     C                     EXSR SARVGN
      * C2954 RMC 12/17/13 crt cab7cpp with system date instead of jobdat
      * Crt IC Trans. W/SystDt CR - Item Transaction Detail  * 
     C                     EXSR SBCRRC
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Next Sequence No.  RT - Item Transaction Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
     C           *LIKE     DEFN WAHGCD    WQSA02           Item Code
     C           *LIKE     DEFN WAAJCD    WQSA03           Warehouse Code
     C           *LIKE     DEFN WAW9ST    WQSA04           Inventory Trans
     C           *LIKE     DEFN WABSST    WQSA05           Inventory Trans
     C           *LIKE     DEFN WAB4DT    WQSA06           Transaction Dat
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WQSA02           Item Code
     C                     KFLD           WQSA03           Warehouse Code
     C                     KFLD           WQSA04           Inventory Trans
     C                     KFLD           WQSA05           Inventory Trans
     C                     KFLD           WQSA06           Transaction Dat
      * Setup key
     C                     Z-ADDP1AIC3    WQSA01           Company Number
     C                     Z-ADDP1HGCD    WQSA02           Item Code
     C                     MOVELP1AJCD    WQSA03           Warehouse Code
     C                     MOVEL'A'       WQSA04           Inventory Trans
     C                     MOVEL'AW'      WQSA05           Inventory Trans
     C                     Z-ADDP1B4DT    WQSA06           Transaction Dat
      * Establish starting position
     C           KRSSA     SETLL@B7CPZA                    *
     C           KRSSA     READE@B7CPZA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0344' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         P1C4NY           ITD Sequence Nu
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WAC4NY    ADD  1         P1C4NY           ITD Sequence Nu
     C                     GOTO SAEXIT                     *QUIT
     C           KRSSA     READE@B7CPZA                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCRRC    BEGSR
      *================================================================
      * Crt IC Trans. W/SystDt CR - Item Transaction Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  60       Job Time
     C                     MOVEL*BLANK    WN0002 10        User Id
     C                     MOVEL*BLANK    WN0003 10        Job Name
     C                     Z-ADD*ZERO     WN0004  70       Job Date
     C                     Z-ADD*ZERO     WN0005  20       Production Hour
     C                     Z-ADD*ZERO     WN0006 112       Production Weig
     C                     Z-ADD*ZERO     WN0007  50       Production Quan
     C                     Z-ADD*ZERO     WN0008  70       Production Piec
     C                     MOVEL*BLANK    WN0009  1        Export/Domestic
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B7CPJZ
     C                     Z-ADDP1AIC3    WBAIC3           Company Number
     C                     Z-ADDP1HGCD    WBHGCD           Item Code
     C                     MOVELP1AJCD    WBAJCD           Warehouse Code
     C                     MOVEL'A'       WBW9ST           Inventory Trans
     C                     MOVEL'AW'      WBBSST           Inventory Trans
     C                     Z-ADDP1B4DT    WBB4DT           Transaction Dat
     C                     Z-ADDP1C4NY    WBC4NY           ITD Sequence Nu
     C                     Z-ADD*ZERO     WBDXNB           Sequence Number
     C                     Z-ADDP1ELDT    WBELDT           Production Date
     C                     MOVELP1HVCD    WBHVCD           U/M - Transacti
     C                     MOVEL'SG'      WBF1ST           Item Transactio
     C                     MOVEL@CN,001   WBAUNA           Description
     C                     Z-ADD*ZERO     WBA5QT           Transaction Qua
     C                     Z-ADDWUAHWG    WBAHWG           Transaction Wei
     C                     Z-ADD*ZERO     WBAKCS           USR Transaction
     C                     MOVELP1CGCD    WBCGCD           U/M - Cost
     C                     Z-ADDP1AYVA    WBAYVA           Extended Amount
     C                     MOVEL*BLANK    WBBJNA           Ticket Number
     C                     Z-ADD*ZERO     WBCKNB           G/L Document Nu
     C                     MOVEL*BLANK    WBBMST           G/L Update Stat
     C                     MOVELP2O9CD    WBCQCD           Reason Code
     C                     MOVEL*BLANK    WBDTCD           Reference Numbe
     C                     MOVEL*BLANK    WBMGNA           Lot ID
     C                     Z-ADD*ZERO     WBTRBN           Transfer Batch
     C                     Z-ADD*ZERO     WBTRBS           Transfer Batch
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADDP1RINB    WBRINB           Item Structure
     C                     Z-ADDP1RHNB    WBRHNB           Item Structure
     C                     Z-ADDP1RGNB    WBRGNB           Item Structure
     C                     MOVEL*BLANK    WBM3NA           Employee Badge
     C                     Z-ADD*ZERO     WBAWTM           Production Time
     C                     MOVELP1XLCD    WBXLCD           Shift Number
     C                     Z-ADDP1K7DT    WBK7DT           Label Date
     C                     MOVEL*BLANK    WBUVST           EDI Status 1
     C                     MOVEL*BLANK    WBUWST           EDI Status 2
     C                     MOVEL*BLANK    WBUXST           EDI Status 3
     C                     MOVEL'A'       WBVSST           Record Status
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WBAATM           Job Time
     C                     MOVEL##USR     WBAYNA           User Id
     C                     MOVEL##JOB     WBA0NA           Job Name
     C                     Z-ADD##JDT     WBAXDT           Job Date
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           WBAXDT    PARM *ZERO     WQ0001 155       Current System
     C           WBAATM    PARM *ZERO     WQ0002 155       Current System
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C           KLCRSB    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBHGCD           Item Code
     C                     KFLD           WBAJCD           Warehouse Code
     C                     KFLD           WBW9ST           Inventory Trans
     C                     KFLD           WBBSST           Inventory Trans
     C                     KFLD           WBB4DT           Transaction Dat
     C                     KFLD           WBC4NY           ITD Sequence Nu
     C                     KFLD           WBDXNB           Sequence Number
      * Check for duplicate primary key
     C           KLCRSB    SETLL@B7CPJZ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0345' W0RTN   7
      * Send message 'Item Transaction Detai EX'
     C                     MOVEL'USR0345' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C                     WRITE@B7CPJZ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * Crt Export Rate Dtl   XF - Item Transaction Detail  * 
     C                     CALL 'POO5XFR'              90  Crt Export Rate
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBAIC3    WQ0003  30       Company Number
     C                     PARM WBHGCD    WQ0004  70       Item Code
     C                     PARM WBAJCD    WQ0005  3        Warehouse Code
     C                     PARM WBW9ST    WQ0006  1        Inventory Trans
     C                     PARM WBBSST    WQ0007  2        Inventory Trans
     C                     PARM WBB4DT    WQ0008  70       Transaction Dat
     C                     PARM WBDXNB    WQ0009  30       Sequence Number
     C                     PARM WBELDT    WQ0010  70       Production Date
     C                     PARM WBHVCD    WQ0011  2        U/M - Transacti
     C                     PARM WBF1ST    WQ0012  2        Item Transactio
     C                     PARM WBAUNA    WQ0013 30        Description
     C                     PARM WBA5QT    WQ0014 112       Transaction Qua
     C                     PARM WBAHWG    WQ0015 112       Transaction Wei
     C                     PARM WBAKCS    WQ0016 114       USR Transaction
     C                     PARM WBCGCD    WQ0017  2        U/M - Cost
     C                     PARM WBAYVA    WQ0018 112       Extended Amount
     C                     PARM WBBJNA    WQ0019  6        Ticket Number
     C                     PARM WBCKNB    WQ0020  80       G/L Document Nu
     C                     PARM WBBMST    WQ0021  1        G/L Update Stat
     C                     PARM WBCQCD    WQ0022  3        Reason Code
     C                     PARM WBDTCD    WQ0023 15        Reference Numbe
     C                     PARM WBMGNA    WQ0024 10        Lot ID
     C                     PARM WBTRBN    WQ0025  70       Transfer Batch
     C                     PARM WBTRBS    WQ0026  30       Transfer Batch
     C                     PARM WBC4NB    WQ0027  70       Order Number
     C                     PARM WBRINB    WQ0028  30       Item Structure
     C                     PARM WBRHNB    WQ0029  30       Item Structure
     C                     PARM WBRGNB    WQ0030  30       Item Structure
     C                     PARM WBM3NA    WQ0031 10        Employee Badge
     C                     PARM WBAWTM    WQ0032  60       Production Time
     C                     PARM WBXLCD    WQ0033  1        Shift Number
     C                     PARM WBK7DT    WQ0034  70       Label Date
     C                     PARM WBVSST    WQ0035  1        Record Status
     C                     PARM WBAATM    WQ0036  60       Job Time
     C                     PARM WBAXDT    WQ0037  70       Job Date
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POO5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1C4NY           ITD Sequence Nu
     C                     Z-ADD*ZERO     P1DXNB           Sequence Number
     C                     Z-ADD*ZERO     P1AYVA           Extended Amount
     C                     MOVEL*BLANK    P2O9CD           USR Reason Code
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Transaction Weight
     C                     Z-ADD*ZERO     WUAHWG 112
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WAB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WAC4NY           ITD Sequence Nu
     C                     Z-ADD*ZERO     WADXNB           Sequence Number
     C                     Z-ADD*ZERO     WAELDT           Production Date
     C                     Z-ADD*ZERO     WAA5QT           Transaction Qua
     C                     Z-ADD*ZERO     WAAHWG           Transaction Wei
     C                     Z-ADD*ZERO     WAAKCS           USR Transaction
     C                     Z-ADD*ZERO     WAAYVA           Extended Amount
     C                     Z-ADD*ZERO     WACKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WATRBN           Transfer Batch
     C                     Z-ADD*ZERO     WATRBS           Transfer Batch
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WAAWTM           Production Time
     C                     Z-ADD*ZERO     WAK7DT           Label Date
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Clear all neither parameters
      * Crt IC Trans. W/SystDt CR - Item Transaction Detail  * 
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Adjustment to Weight
