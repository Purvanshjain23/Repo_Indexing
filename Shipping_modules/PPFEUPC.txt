/********************************************************************/
/*  FAX ORDER ACKNOWLEDGEMENTS                                      */
/********************************************************************/
/*                                                                  */
/*  SYNOPSIS -  THIS CL IS CALLED FROM PPFDXFR AND WILL FAX THE     */
/*              ORDER ACKNOWLEDGEMENT SHEET TO THE SALES MANAGER,   */
/*              THE BUYER, AND/OR THE BROKER.                       */
/*                                                                  */
/*  SYSTEM    - ORDER MANAGEMENT SYSTEM                             */
/*  PROGRAM   - PPFEUPC - PRC CALL TELEX 3 UP                       */
/*  DATE      - SEE THE ORIGINAL IN PPFEUPCSV                       */
/*                                                                  */
/*  PARAMETERS:                                                     */
/*                                                                  */
/*  I    &ACKPRTF    - PRINTER FILE TO EMAIL (I.E. PDKOPFR)         */
/*  I    &LENGTH     - PAGE LENGTH                                  */
/*  I    &WIDTH      - PAGE WIDTH                                   */
/*  I    &CPI        - CHARACTERS PER INCH                          */
/*  I    &LPI        - LINES PER INCH                               */
/*  I    &OUTQ       - OUTPUT QUEUE - FAXQ OR QPRINT                */
/*  I    &OUTQLIB    - OUTPUT QUEUE LIBRARY = *LIBL                 */
/*  I    &BUYNAME    - BUYER NAME - CUSTOMER FAX NAME               */
/*  I    &CUSTNAME   - CUSTOMER NAME - SHIP TO CUSTOMER             */
/*  I    &AREA       - AREA CODE - BLANK                            */
/*  I    &PHONE      - FAX NUMBER - SHIP TO FAX NUMBER              */
/*  I    &DESC       - DESCRIPTION - OUTQ DESCRIPTION               */
/*  I    &OVERFLOW   - PAGE OVERFLOW NUMBER                         */
/*  I    &COMP       - COMPANY NUMBER                               */
/*  I    &TYPE       - DOCUMENT TYPE                                */
/*  I    &DEPT       - DOCUMENT DEPARTMENT                          */
/*  I    &NAME       - DOCUMENT NAME                                */
/*  I    &HOLD       - HOLD OUTPUT = *NO                            */
/********************************************************************/
/* MODIFICATIONS:                                                  */
/* 05/18/2007 LJB DLY029   A SAVE COPY NAMED PPFEUPCSV IS IN       */
/*            OMSDEVGEN. THIS PROGRAM WAS HEAVILY MODIFIED SO IT   */
/*            REPLACED PPITPFR WITH DATA FROM COMPANY DOCUMENTS    */
/*            DEFAULT FILE. THIS DATA IS PASSED IN AND THE PRINTER */
/*            FILE IS OVERRIDEN TO IT.                             */
/* 12/18/2007 RMC FP1110 - CPI NEEDS BE 3.1 ALIEU 2.0 FOR 16.7 CPI */
/*  3/13/08   RMC     CHANGE THIS PARAM:MSG(&EMAILMSG) ON ESNDMAILS*/
/*             TO MSG(*NONE) SO LEADING BLANK PAGE WONT GET FAXED  */
/* 12/01/2008 LJB E00255   ADD FAX TO CUSTOMER OPTION              */
/* 05/03/2013 RMC C2576   &SLSFAX COVER WAS PRINTING BUYFAX# - CHGD TO SLSFAX*/
/********************************************************************/

 PPFEUPC:    PGM        PARM(&ACKPRTF &SLSNAME &CUSTNAME &AREA +
                          &SLSFAX &DESC &COMP &TYPE &DEPT &OVERLAY +
                          &PGMNAME &PGMFILE &OUTQ &HOLD &SAVE +
                          &DRAWER &PRTDEVTYP &LENGTH &WIDTH &LPI +
                          &CPI &OVERFLOW &ROTATE &BUYFAX &BUYNAME +
                          &CUSTFAX &CUSTOMER &BROKRNAME &BROKRFAX)

             DCL  VAR(&ACKPRTF)   TYPE(*CHAR) LEN(10)
             DCL  VAR(&PGMFILE)   TYPE(*CHAR) LEN(10) /* CVRSHEET */
             DCL  VAR(&DESC)      TYPE(*CHAR) LEN(25)
             DCL  VAR(&LENGTH)    TYPE(*DEC)  LEN(3 0)
             DCL  VAR(&WIDTH)     TYPE(*DEC)  LEN(3 0)
             DCL  VAR(&CPI)       TYPE(*DEC)  LEN(3 1)
             DCL  VAR(&LPI)       TYPE(*DEC)  LEN(2 0)
             DCL  VAR(&OUTQ)      TYPE(*CHAR) LEN(10)
             DCL  VAR(&PGMNAME)   TYPE(*CHAR) LEN(10) /* COVERSHEET */
             DCL  VAR(&AREA)      TYPE(*CHAR) LEN(3)
             DCL  VAR(&SLSNAME)   TYPE(*CHAR) LEN(25)
             DCL  VAR(&CUSTNAME)  TYPE(*CHAR) LEN(25)
             DCL  VAR(&CUSTFAX)   TYPE(*CHAR) LEN(25)
             DCL  VAR(&CUSTOMER)  TYPE(*CHAR) LEN(25)
             DCL  VAR(&SLSFAX)    TYPE(*CHAR) LEN(25)
             DCL  VAR(&OVERFLOW)  TYPE(*DEC)  LEN(3 0)
             DCL  VAR(&TYPE)      TYPE(*CHAR) LEN(2)
             DCL  VAR(&DEPT)      TYPE(*CHAR) LEN(6)
             DCL  VAR(&OVERLAY)   TYPE(*CHAR) LEN(8)
             DCL  VAR(&BUYFAX)    TYPE(*CHAR) LEN(25)
             DCL  VAR(&BUYNAME)   TYPE(*CHAR) LEN(25)
             DCL  VAR(&BROKRNAME) TYPE(*CHAR) LEN(25)
             DCL  VAR(&BROKRFAX)  TYPE(*CHAR) LEN(25)
             DCL  VAR(&EMAILMSG)  TYPE(*CHAR) LEN(30) VALUE(*NONE)
             DCL  VAR(&USER)      TYPE(*CHAR) LEN(10)
             DCL  VAR(&PRTDEVTYP) TYPE(*CHAR) LEN(10)
             DCL  VAR(&ROTATE)    TYPE(*CHAR) LEN(5)
             DCL  VAR(&FTX2)      TYPE(*CHAR) LEN(75)
             DCL  VAR(&FAXTO)      TYPE(*CHAR) LEN(25)
             DCL  VAR(&HOLD)      TYPE(*CHAR) LEN(4)
             DCL  VAR(&SAVE)      TYPE(*CHAR) LEN(4)
             DCL  VAR(&DRAWER)    TYPE(*DEC)  LEN(3 0)
             DCL  VAR(&COMP)      TYPE(*DEC)  LEN(3 0)
             DCL  VAR(&BLANK)     TYPE(*CHAR) LEN(25) +
                          VALUE('                         ')

/*----------------------------------------------------------------- */
/** FOR TESTING **                                             ******/
/*----------------------------------------------------------------- */
             CHGJOB     LOG(4 00 *SECLVL)
             RTVJOBA    USER(&USER)

/*           IF COND(&USER = 'ISRCENT') THEN(GOTO END) */
/*           IF COND(&USER = 'ISPPATE') THEN(GOTO END) */
             IF COND(&USER = 'ISSMASO') THEN(GOTO END)
             IF COND(&USER = 'ISSZURN') THEN(GOTO END)
/******      IF COND(&USER = 'ISLBUSE') THEN(GOTO END)   ************/
             IF COND(&USER = 'PRKTEST') THEN(GOTO END)

/** FOR TESTING **                                             ******/
             IF COND(&USER = 'ISLBUSE') THEN(CHGVAR +
                  VAR(&EMAILMSG) VALUE('GIVE TO LARA BUSER'))

/*----------------------------------------------------------------- */
/* NOTE - IF OVERLAY THEN THE ESNDMAIL MUST USE TYPE = *PDF.        */
/* OVERRIDE THE COVER SHEET FOR ACKNOWLEDGEMENTS TO THE OVERLAY     */
/* AND OUTQ FROM THE PPAQREP FILE                                   */
/*----------------------------------------------------------------- */
             CHGVAR     VAR(&FAXTO) VALUE(&BLANK)
             OVRPRTF    FILE(&PGMFILE) DEVTYPE(&PRTDEVTYP) +
                          PAGESIZE(&LENGTH &WIDTH) LPI(&LPI) +
                          CPI(&CPI) OVRFLW(&OVERFLOW) +
                          DRAWER(&DRAWER) PAGRTT(&ROTATE) +
                          FRONTOVL(&OVERLAY) OUTQ(&OUTQ) COPIES(1) +
                          HOLD(&HOLD) SAVE(&SAVE)

/*******************************************************************/
/* FAX TO BUYER                                                    */
/*******************************************************************/
 BUYER:      IF         COND(&BUYFAX *NE &BLANK) THEN(DO)

/* PRINT THE COVESHEET                                              */
             CHGVAR     VAR(&FAXTO) VALUE(&BUYFAX)


             CALL       PGM(&PGMNAME) PARM('' &COMP &TYPE &DEPT +
                          &OVERLAY &CUSTNAME &BUYNAME &FAXTO)

/* GET EMAIL ADDRESS FROM SYSTEM VALUES                              */
             CHGVAR     VAR(&FAXTO) VALUE(&BLANK)
             CALL       PGM(PPJXXFR) PARM(' ' 'FAXSERVER' &FAXTO)
             CHGVAR     VAR(&FTX2) VALUE(&BUYFAX *TCAT &FAXTO)
             CHGVAR     VAR(&DESC) VALUE(&CUSTNAME)

             ESEND/ESNDMAIL RECIPIENT(&FTX2) SUBJECT(&DESC) +
                          ATTLIST((* *PDF *N &PGMFILE) (* *PDF *N +
                          &ACKPRTF))
 BUYEREND:   ENDDO
/*****************************************************************/
/* FAX TO FIELD REP/SALES MANAGER                                */
/*****************************************************************/
 FIELDREP:   IF         COND(&SLSFAX *NE &BLANK) THEN(DO)

/* PRINT THE COVER SHEET FOR ACKNOWLEDGEMENTS                       */
             CHGVAR     VAR(&FAXTO) VALUE(&SLSFAX)
             CALL       PGM(&PGMNAME) PARM('' &COMP &TYPE &DEPT +
                          &OVERLAY ' ' &SLSNAME &FAXTO)

/* GET EMAIL ADDRESS FROM SYSTEM VALUES                              */
             CALL       PGM(PPJXXFR) PARM(' ' 'FAXSERVER' &FAXTO)
             CHGVAR     VAR(&FTX2) VALUE(&SLSFAX *TCAT &FAXTO)
             CHGVAR     VAR(&DESC) VALUE(&CUSTNAME)
             ESEND/ESNDMAIL RECIPIENT(&FTX2) SUBJECT(&DESC) +
                          ATTLIST((* *PDF *N &PGMFILE) (* *PDF *N +
                          &ACKPRTF))
 FLDREPEND:  ENDDO
/*****************************************************************/
/* FAX TO BROKER                                                 */
/*****************************************************************/
 BROKER:     IF         COND(&BROKRFAX *NE &BLANK) THEN(DO)

/* PRINT THE COVER SHEET FOR ACKNOWLEDGEMENTS                       */
             CHGVAR     VAR(&FAXTO) VALUE(&BROKRFAX)
             CALL       PGM(&PGMNAME) PARM('' &COMP &TYPE &DEPT +
                          &OVERLAY &CUSTNAME &BROKRNAME &FAXTO)

/* GET EMAIL ADDRESS FROM SYSTEM VALUES                              */
             CALL       PGM(PPJXXFR) PARM(' ' 'FAXSERVER' &FAXTO)
             CHGVAR     VAR(&FTX2) VALUE(&BROKRFAX *TCAT &FAXTO)
             CHGVAR     VAR(&DESC) VALUE(&CUSTNAME)

             ESEND/ESNDMAIL RECIPIENT(&FTX2) SUBJECT(&DESC) +
                          ATTLIST((* *PDF *N &PGMFILE) (* *PDF *N +
                          &ACKPRTF))
 BROKEREND:  ENDDO
/*******************************************************************/
/* FAX TO CUSTOMER                                                 */
/*******************************************************************/
 CUSTOMER:   IF         COND(&CUSTFAX *NE &BLANK) THEN(DO)

/* PRINT THE COVESHEET                                              */
             CHGVAR     VAR(&FAXTO) VALUE(&CUSTFAX)
             CALL       PGM(&PGMNAME) PARM('' &COMP &TYPE &DEPT +
                          &OVERLAY &CUSTNAME &BUYNAME &FAXTO)

/* GET SEABOARD FAX EMAIL ADDRESS FROM SYSTEM VALUES                 */
             CHGVAR     VAR(&FAXTO) VALUE(&BLANK)
             CALL       PGM(PPJXXFR) PARM(' ' 'FAXSERVER' &FAXTO)
             CHGVAR     VAR(&FTX2) VALUE(&CUSTFAX *TCAT &FAXTO)
             CHGVAR     VAR(&DESC) VALUE(&CUSTNAME)

             ESEND/ESNDMAIL RECIPIENT(&FTX2) SUBJECT(&DESC) +
                          ATTLIST((* *PDF *N &PGMFILE) (* *PDF *N +
                          &ACKPRTF))
 CUSTEND:    ENDDO
 /****************************************************************/
 DLTS:       DLTSPLF    FILE(&PGMFILE) SELECT(*ALL)
             MONMSG     MSGID(CPF3309)
             DLTSPLF    FILE(&ACKPRTF) SELECT(*ALL)
             MONMSG     MSGID(CPF3309)

             GOTO       CMDLBL(END)

 END:        ENDPGM
