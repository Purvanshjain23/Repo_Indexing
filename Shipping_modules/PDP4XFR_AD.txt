// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PDP4XFR
// ?Date: 14.08.2025 Time: 03:35:46
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?RMC 04/10/07 If TO date is the same as the From date, dont format it
CASE;

// IF PAR.ED Slg/Proc Date Format is Month DD, YEAR
IF PAR.ED_Slg_Proc_Date_Format = 'MD';

EXECUTE FUNCTION(CLC Format Date Range  IF) TYPE(EXCINTFUN)                     AC1530342;
PARAMETER(PAR.Date_From_USR);
PARAMETER(PAR.Date_To_USR);
PARAMETER(PAR.Text_USR_40);
{
 //?Execute internal function

 //?Format Date Range as "June 10,1998 - June 17, 1998"
 // WRK.Month                 USR = PAR.Date From             USR *MONTH
 WRK.Month_USR = DATEDTLS(PAR.Date_From_USR 'MO' 1111111 'NONE' 'N' 1);

 // WRK.Day NBR USR = PAR.Date From             USR *DAY OF MONTH
 WRK.Day_NBR_USR = DATEDTLS(PAR.Date_From_USR 'DM' 1111111 'NONE' 'N' 1);

 // WRK.Year Code = PAR.Date From             USR *YEAR
 WRK.Year_Code = DATEDTLS(PAR.Date_From_USR 'YR' 1111111 'NONE' 'N' 1);

 EXECUTE FUNCTION(Load Month Description) TYPE(EXCINTFUN)                        AC1520585;
 PARAMETER(WRK.Month_USR);
 PARAMETER(WRK.Month_Description_USR);
 {
  //?Execute internal function

  // PAR.Month Description     USR = CND.NOT ENTERED
  PAR.Month_Description_USR = *BLANK;

  CASE;

  // IF PAR.Month                 USR is January
  IF PAR.Month_USR = 01;

  // PAR.Month Description     USR = CON.January
  PAR.Month_Description_USR = 'January';

  // IF PAR.Month                 USR is February
  IF PAR.Month_USR = 02;

  // PAR.Month Description     USR = CON.February
  PAR.Month_Description_USR = 'February';

  // IF PAR.Month                 USR is March
  IF PAR.Month_USR = 03;

  // PAR.Month Description     USR = CON.March
  PAR.Month_Description_USR = 'March';

  // IF PAR.Month                 USR is April
  IF PAR.Month_USR = 04;

  // PAR.Month Description     USR = CON.April
  PAR.Month_Description_USR = 'April';

  // IF PAR.Month                 USR is May
  IF PAR.Month_USR = 05;

  // PAR.Month Description     USR = CON.May
  PAR.Month_Description_USR = 'May';

  // IF PAR.Month                 USR is June
  IF PAR.Month_USR = 06;

  // PAR.Month Description     USR = CON.June
  PAR.Month_Description_USR = 'June';

  // IF PAR.Month                 USR is July
  IF PAR.Month_USR = 07;

  // PAR.Month Description     USR = CON.July
  PAR.Month_Description_USR = 'July';

  // IF PAR.Month                 USR is August
  IF PAR.Month_USR = 08;

  // PAR.Month Description     USR = CON.August
  PAR.Month_Description_USR = 'August';

  // IF PAR.Month                 USR is September
  IF PAR.Month_USR = 09;

  // PAR.Month Description     USR = CON.September
  PAR.Month_Description_USR = 'September';

  // IF PAR.Month                 USR is October
  IF PAR.Month_USR = 10;

  // PAR.Month Description     USR = CON.October
  PAR.Month_Description_USR = 'October';

  // IF PAR.Month                 USR is November
  IF PAR.Month_USR = 11;

  // PAR.Month Description     USR = CON.November
  PAR.Month_Description_USR = 'November';

  // IF PAR.Month                 USR is December
  IF PAR.Month_USR = 12;

  // PAR.Month Description     USR = CON.December
  PAR.Month_Description_USR = 'December';

  ENDIF;

 }

 CASE;

 // IF PAR.Date To               USR NE PAR.Date From             USR
 IF PAR.Date_To_USR <> PAR.Date_From_USR;

 // WRK.To Month              USR = PAR.Date To               USR *MONTH
 WRK.To_Month_USR = DATEDTLS(PAR.Date_To_USR 'MO' 1111111 'NONE' 'N' 1);

 // WRK.To Day of Month       USR = PAR.Date To               USR *DAY OF MONTH
 WRK.To_Day_of_Month_USR = DATEDTLS(PAR.Date_To_USR 'DM' 1111111 'NONE' 'N' 1);

 // WRK.To Year 4.0           USR = PAR.Date To               USR *YEAR
 WRK.To_Year_4_0_USR = DATEDTLS(PAR.Date_To_USR 'YR' 1111111 'NONE' 'N' 1);

 EXECUTE FUNCTION(Load Month Description) TYPE(EXCINTFUN)                        AC1520585;
 PARAMETER(WRK.To_Month_USR);
 PARAMETER(WRK.Month_Desc_2_USR);
 {
  //?Execute internal function

  // PAR.Month Description     USR = CND.NOT ENTERED
  PAR.Month_Description_USR = *BLANK;

  CASE;

  // IF PAR.Month                 USR is January
  IF PAR.Month_USR = 01;

  // PAR.Month Description     USR = CON.January
  PAR.Month_Description_USR = 'January';

  // IF PAR.Month                 USR is February
  IF PAR.Month_USR = 02;

  // PAR.Month Description     USR = CON.February
  PAR.Month_Description_USR = 'February';

  // IF PAR.Month                 USR is March
  IF PAR.Month_USR = 03;

  // PAR.Month Description     USR = CON.March
  PAR.Month_Description_USR = 'March';

  // IF PAR.Month                 USR is April
  IF PAR.Month_USR = 04;

  // PAR.Month Description     USR = CON.April
  PAR.Month_Description_USR = 'April';

  // IF PAR.Month                 USR is May
  IF PAR.Month_USR = 05;

  // PAR.Month Description     USR = CON.May
  PAR.Month_Description_USR = 'May';

  // IF PAR.Month                 USR is June
  IF PAR.Month_USR = 06;

  // PAR.Month Description     USR = CON.June
  PAR.Month_Description_USR = 'June';

  // IF PAR.Month                 USR is July
  IF PAR.Month_USR = 07;

  // PAR.Month Description     USR = CON.July
  PAR.Month_Description_USR = 'July';

  // IF PAR.Month                 USR is August
  IF PAR.Month_USR = 08;

  // PAR.Month Description     USR = CON.August
  PAR.Month_Description_USR = 'August';

  // IF PAR.Month                 USR is September
  IF PAR.Month_USR = 09;

  // PAR.Month Description     USR = CON.September
  PAR.Month_Description_USR = 'September';

  // IF PAR.Month                 USR is October
  IF PAR.Month_USR = 10;

  // PAR.Month Description     USR = CON.October
  PAR.Month_Description_USR = 'October';

  // IF PAR.Month                 USR is November
  IF PAR.Month_USR = 11;

  // PAR.Month Description     USR = CON.November
  PAR.Month_Description_USR = 'November';

  // IF PAR.Month                 USR is December
  IF PAR.Month_USR = 12;

  // PAR.Month Description     USR = CON.December
  PAR.Month_Description_USR = 'December';

  ENDIF;

 }

 // IF *OTHERWISE
 IF *OTHERWISE;

 // WRK.To Month              USR = CON.*ZERO
 WRK.To_Month_USR = *ZERO;

 // WRK.To Day of Month       USR = CON.*ZERO
 WRK.To_Day_of_Month_USR = *ZERO;

 // WRK.To Year 4.0           USR = CON.*ZERO
 WRK.To_Year_4_0_USR = *ZERO;

 // WRK.Month Desc 2          USR = CON.*BLANK
 WRK.Month_Desc_2_USR = *BLANK;

 ENDIF;

 // Execute function CLC Format Date Range  US.
 EXECUTE FUNCTION(CLC Format Date Range  US) TYPE(EXCUSRSRC) ('PDPDUFR');
 {
  E                    J          40  1
  C*  FORMAT DATES AS 'MONTH1 DAY1, YEAR1 - MONTH2 DAY2, YEAR2'
  C*          *ENTRY    PLIST
  C*                    PARM           WUAYNX  40
  C*                    PARM           WUPITX 10
  C*                    PARM           WUA5NX  20
  C*                    PARM           WUA4NX  40
  C*                    PARM           WUSGTX 10
  C*                    PARM           DAY2    20
  C*                    PARM           P3SHTX 40
  C                     MOVE *BLANKS   J
  C* FROM DATE
  C                     MOVE WUAYNX    YEARA   4
  C                     MOVE WUDNBU    DAYA    2
  C           WUDNBU    IFLT 10
  C                     MOVEL' '       DAYA
  C                     END
  C                     MOVE WUA4NX    YEARA2  4
  C                     MOVE WUA5NX    DAYA2   2
  C           WUA5NX    IFLT 10
  C                     MOVEL' '       DAYA2
  C                     END
  C*
  C                     MOVEAWUPITX    J,1
  C                     Z-ADD1         X       20
  C           J,X       DOUEQ' '
  C                     ADD  1         X
  C                     ENDDO
  C*
  C                     ADD  1         X
  C                     MOVEADAYA      J,X
  C                     ADD  2         X
  C                     MOVE ','       J,X
  C                     ADD  2         X
  C                     MOVEAYEARA     J,X
  C*  04/10/07
  C*  RMC DONT FORMAT TO DATE IF SAME AS FROM DATE, MONTH WILL BE BLANK HERE.
  C*
  C*  HYPHEN
  C           WUSGTX    IFNE *BLANK
  C                     ADD  5         X
  C                     MOVE '-'       J,X
  C*  TO DATE
  C                     ADD  2         X
  C                     MOVEAWUSGTX    J,X
  C           J,X       DOUEQ' '
  C                     ADD  1         X
  C                     ENDDO
  C                     ADD  1         X
  C                     MOVEADAYA2     J,X
  C                     ADD  2         X
  C                     MOVE ','       J,X
  C                     ADD  2         X
  C                     MOVEAYEARA2    J,X
  C                     ENDIF
  C*
  C                     MOVEAJ         P3SHTX
  C                     RETRN
 }

}


// IF PAR.ED Slg/Proc Date Format is DD-MM-YY
IF PAR.ED_Slg_Proc_Date_Format = 'DM';

EXECUTE FUNCTION(CLC Format Dt DD-MM-YY IF) TYPE(EXCINTFUN)                     AC1624360;
PARAMETER(PAR.Date_From_USR);
PARAMETER(PAR.Date_To_USR);
PARAMETER(PAR.Text_USR_40);
{
 //?Execute internal function

 //?04/10/07
 //?If TO Date is same as from date, dont format it or the TO
 //?*****
 //?2/24/03
 //?Format Date Range as "18-06-2003 to 21-06-2003"      DD-MM-YEAR
 //?*****
 // WRK.Month                 USR = PAR.Date From             USR *MONTH
 WRK.Month_USR = DATEDTLS(PAR.Date_From_USR 'MO' 1111111 'NONE' 'N' 1);

 // WRK.Day NBR USR = PAR.Date From             USR *DAY OF MONTH
 WRK.Day_NBR_USR = DATEDTLS(PAR.Date_From_USR 'DM' 1111111 'NONE' 'N' 1);

 // WRK.Year Code = PAR.Date From             USR *YEAR
 WRK.Year_Code = DATEDTLS(PAR.Date_From_USR 'YR' 1111111 'NONE' 'N' 1);

 // WRK.Day (Alpha) USR = WRK.Day NBR USR
 WRK.Day_Alpha_USR = WRK.Day_NBR_USR;

 // WRK.Month (Char) USR = WRK.Month                 USR
 WRK.Month_Char_USR = WRK.Month_USR;

 // WRK.Year Alpha (YYYY) USR = WRK.Year Code
 WRK.Year_Alpha_YYYY_USR = WRK.Year_Code;

 // WRK.Day DD/  3A = CONCAT(WRK.Day (Alpha) USR,CON.-,CON.*ZERO)
 WRK.Day_DD_3A = WRK.Day_Alpha_USR + '-' (*ZERO);

 // WRK.Month MM/  3A = CONCAT(WRK.Month (Char) USR,CON.-,CON.*ZERO)
 WRK.Month_MM_3A = WRK.Month_Char_USR + '-' (*ZERO);

 // WRK.DDMM USR = CONCAT(WRK.Day DD/  3A,WRK.Month MM/  3A,CON.*ZERO)
 WRK.DDMM_USR = WRK.Day_DD_3A + WRK.Month_MM_3A (*ZERO);

 // WRK.DDMMYYYY Usr = CONCAT(WRK.DDMM USR,WRK.Year Alpha (YYYY) USR,CON.*ZERO)
 WRK.DDMMYYYY_Usr = WRK.DDMM_USR + WRK.Year_Alpha_YYYY_USR (*ZERO);

 CASE;

 // IF PAR.Date From             USR NE PAR.Date To               USR
 IF PAR.Date_From_USR <> PAR.Date_To_USR;

 // WRK.DDMMYYYY to  USR = CONCAT(WRK.DDMMYYYY Usr,CON.to,CON.1)
 WRK.DDMMYYYY_to_USR = WRK.DDMMYYYY_Usr + 'to' (1);

 // WRK.To Month              USR = PAR.Date To               USR *MONTH
 WRK.To_Month_USR = DATEDTLS(PAR.Date_To_USR 'MO' 1111111 'NONE' 'N' 1);

 // WRK.To Day of Month       USR = PAR.Date To               USR *DAY OF MONTH
 WRK.To_Day_of_Month_USR = DATEDTLS(PAR.Date_To_USR 'DM' 1111111 'NONE' 'N' 1);

 // WRK.To Year 4.0           USR = PAR.Date To               USR *YEAR
 WRK.To_Year_4_0_USR = DATEDTLS(PAR.Date_To_USR 'YR' 1111111 'NONE' 'N' 1);

 // WRK.Day (Alpha) USR = WRK.To Day of Month       USR
 WRK.Day_Alpha_USR = WRK.To_Day_of_Month_USR;

 // WRK.Month (Char) USR = WRK.To Month              USR
 WRK.Month_Char_USR = WRK.To_Month_USR;

 // WRK.Year Alpha (YYYY) USR = WRK.To Year 4.0           USR
 WRK.Year_Alpha_YYYY_USR = WRK.To_Year_4_0_USR;

 // WRK.Day DD/  3A = CONCAT(WRK.Day (Alpha) USR,CON.-,CON.*ZERO)
 WRK.Day_DD_3A = WRK.Day_Alpha_USR + '-' (*ZERO);

 // WRK.Month MM/  3A = CONCAT(WRK.Month (Char) USR,CON.-,CON.*ZERO)
 WRK.Month_MM_3A = WRK.Month_Char_USR + '-' (*ZERO);

 // WRK.DDMM USR = CONCAT(WRK.Day DD/  3A,WRK.Month MM/  3A,CON.*ZERO)
 WRK.DDMM_USR = WRK.Day_DD_3A + WRK.Month_MM_3A (*ZERO);

 // WRK.DDMMYYYY Usr = CONCAT(WRK.DDMM USR,WRK.Year Alpha (YYYY) USR,CON.*ZERO)
 WRK.DDMMYYYY_Usr = WRK.DDMM_USR + WRK.Year_Alpha_YYYY_USR (*ZERO);

 // PAR.Text USR 40 = CONCAT(WRK.DDMMYYYY to  USR,WRK.DDMMYYYY Usr,CON.1)
 PAR.Text_USR_40 = WRK.DDMMYYYY_to_USR + WRK.DDMMYYYY_Usr (1);

 // IF *OTHERWISE
 IF *OTHERWISE;

 // PAR.Text USR 40 = WRK.DDMMYYYY Usr
 PAR.Text_USR_40 = WRK.DDMMYYYY_Usr;

 ENDIF;

}


ENDIF;

