     H/TITLE WW Unship Orders       DF Display file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Displays the records from DBF as a subfile
     H* - Loads the SFL from the DBF a page at a time
     H* - The DBF record at which the SFL display starts may be
     H*   controlled by positioning fields on the SFL header
     H* - Any key fields on the SFL header will be used as
     H*   positioning values
     H* - Any non-key fields on the SFL header will be used as
     H*   selection values: a maximum of W0SLM records will be
     H*   read from the DBF before giving up
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Display file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 10/30/23  Time  : 09:54:31
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPDMLDFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: WW Unship Orders       DF Display file
      *
     FOPBFCPLRIF  E           K        DISK
     F                                              KINFDS INFDS1
      * RSQ : Order Header TRG          Shipped Order Header
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FPDL1REL1IF  E           K        DISK
      * RTV : User Warehouse Access     Retrieval index
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse Codes           Active records only
      *
     FOPEYCPL9IF  E           K        DISK
      * RSQ : Order Events              Co/Order/Event Code
      *
     FOPEYCPL1IF  E           K        DISK
      * RTV : Order Events              Retrieval index       NV
      *
     FCAEOREL1IF  E           K        DISK
      * RTV : Company Customer          Retrieval index
      *
     FOMFNCPL5IF  E           K        DISK
      * RSQ : Manifest Detail           Co/Ord#/Seq/Seq2/PrdDte
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAB1REL0IF  E           K        DISK
      * RTV : Item Balance Detail       Retrieval index       NV
      *
     FPDL8CPL5IF  E           K        DISK
      * RSQ : Order Inv Allocation      Co/Ord/Sq/Sq2/PD/Lt/Lc/L
      *
     FPDL7CPL2IF  E           K        DISK
      * RSQ : Item Lot Loc Trans        Co/Itm/Whs/Typ/Dte/Sq(d)
      *
     FPDL5CPL1IF  E           K        DISK
      * RTV : Item Lot Location         Retrieval index
      *
     FPDL2REL0IF  E           K        DISK
      * RTV : Warehouse Location        Retrieval index
      *
     FPDL3REL0IF  E           K        DISK
      * RTV : Warehouse Location Type   Retrieval index
      *
     FOMFNCPL1IF  E           K        DISK
      * RTV : Manifest Detail           Retrieval index
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FCAB7CPLNIF  E           K        DISK
      * RSQ : Item Transaction Detail   Co/Order/Trans Sel ERR
      *
     FPDMSREL2IF  E           K        DISK
      * RSQ : Export Doc Order Dtl      Co/Order/Seq
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FOPEYCPL0UF  E           K        DISK
      * UPD : Order Events              Update index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     FPDL7CPL0IF  E           K        DISK                      A
      * UPD : Item Lot Loc Trans        Update index
      *
     FPDL5CPL0UF  E           K        DISK                      A
      * UPD : Item Lot Location         Update index
      *
     FCAB1REL1UF  E           K        DISK
      * UPD : Item Balance Detail       Update index
      *
     FPDL8CPL0UF  E           K        DISK
      * UPD : Order Inv Allocation      Update index
      *
     FOMFNCPL0UF  E           K        DISK
      * UPD : Manifest Detail           Update index
      *
     FOMFJCPL1UF  E           K        DISK
      * UPD : Load Header               Update index
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FCAB7CPL0UF  E           K        DISK
      * UPD : Item Transaction Detail   Update index
      *
     FPDMSREL0UF  E           K        DISK
      * UPD : Export Doc Order Dtl      Update index
      *
     E                    J3          3  1
     E                    K3          3  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    J7          7  1
     E                    K7          7  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    #L7         7  1
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * Screen: Field position and name array
     E                    W0BEG   7 021  5 0A
     E                    W0END   7 021  5 0A
     E                    W0NAM   7 021 10
      * Long constants
     E                    @CN#    1  06  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@ADRET1
      * Warehouse Codes           Active records only
      * Renamed input format fields
     I              ADAJCD                          WAAJCD
     I              ADF8NA                          WAF8NA
     I              ADACNA                          WAACNA
     I              ADADNA                          WAADNA
     I              ADAENA                          WAAENA
     I              ADAJNA                          WAAJNA
     I              ADBTTX                          WABTTX
     I              ADAOCD                          WAAOCD
     I              ADBGCD                          WABGCD
     I              ADVHST                          WAVHST
     I              ADMPNA                          WAMPNA
     I              ADWPST                          WAWPST
     I              ADXUST                          WAXUST
     I              ADT0ST                          WAT0ST
     I              ADT1ST                          WAT1ST
     I              ADDBNB                          WADBNB
     I              ADT2ST                          WAT2ST
     I              ADT3ST                          WAT3ST
     I              ADT4ST                          WAT4ST
     I              ADT6ST                          WAT6ST
     I              ADBWC3                          WABWC3
     I              ADBTC3                          WABTC3
     I              ADBUC3                          WABUC3
     I              ADBVC3                          WABVC3
     I              ADFCAA                          WAFCAA
     I              ADRQSX                          WARQSX
     I              ADRRSX                          WARRSX
     I              ADRSSX                          WARSSX
     I              ADRTSX                          WARTSX
     I              ADT7ST                          WAT7ST
     I              ADT8ST                          WAT8ST
     I              ADRNSX                          WARNSX
     I              ADROSX                          WAROSX
     I              ADRPSX                          WARPSX
     I              ADUVST                          WAUVST
     I              ADUWST                          WAUWST
     I              ADUXST                          WAUXST
     I              ADVSST                          WAVSST
     I              ADAATM                          WAAATM
     I              ADAYNA                          WAAYNA
     I              ADA0NA                          WAA0NA
     I              ADAXDT                          WAAXDT
      *
     I@EYCPY3
      * Order Events              Update index
      * Renamed input format fields
     I              EYAIC3                          WBAIC3
     I              EYC4NB                          WBC4NB
     I              EYQ2NB                          WBQ2NB
     I              EYJPCD                          WBJPCD
     I              EYAUC3                          WBAUC3
     I              EYQ7NB                          WBQ7NB
     I              EYOMST                          WBOMST
     I              EYD2DT                          WBD2DT
     I              EYONST                          WBONST
     I              EYOOST                          WBOOST
     I              EYOPST                          WBOPST
     I              EYAWC3                          WBAWC3
     I              EYQ8NB                          WBQ8NB
     I              EYQ9NB                          WBQ9NB
     I              EYBKC7                          WBBKC7
     I              EYUVST                          WBUVST
     I              EYUWST                          WBUWST
     I              EYUXST                          WBUXST
     I              EYAATM                          WBAATM
     I              EYAYNA                          WBAYNA
     I              EYA0NA                          WBA0NA
     I              EYAXDT                          WBAXDT
      *
     I@EYCPY2
      * Order Events              Retrieval index       NV
      * Renamed input format fields
     I              EYAIC3                          WCAIC3
     I              EYC4NB                          WCC4NB
     I              EYQ2NB                          WCQ2NB
     I              EYJPCD                          WCJPCD
     I              EYAUC3                          WCAUC3
     I              EYQ7NB                          WCQ7NB
     I              EYOMST                          WCOMST
     I              EYD2DT                          WCD2DT
     I              EYONST                          WCONST
     I              EYOOST                          WCOOST
     I              EYOPST                          WCOPST
     I              EYAWC3                          WCAWC3
     I              EYQ8NB                          WCQ8NB
     I              EYQ9NB                          WCQ9NB
     I              EYBKC7                          WCBKC7
     I              EYUVST                          WCUVST
     I              EYUWST                          WCUWST
     I              EYUXST                          WCUXST
     I              EYAATM                          WCAATM
     I              EYAYNA                          WCAYNA
     I              EYA0NA                          WCA0NA
     I              EYAXDT                          WCAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WDAIC3
     I              OMC4NB                          WDC4NB
     I              OMDPNB                          WDDPNB
     I              OMUENB                          WDUENB
     I              OMHGCD                          WDHGCD
     I              OMAJCD                          WDAJCD
     I              OMBKC7                          WDBKC7
     I              OMCFC7                          WDCFC7
     I              OMGMST                          WDGMST
     I              OMGNST                          WDGNST
     I              OMMAVA                          WDMAVA
     I              OMKDVA                          WDKDVA
     I              OML8VA                          WDL8VA
     I              OML9VA                          WDL9VA
     I              OMGTST                          WDGTST
     I              OMGVST                          WDGVST
     I              OMGUST                          WDGUST
     I              OMQFST                          WDQFST
     I              OMAYVA                          WDAYVA
     I              OMEXDT                          WDEXDT
     I              OMLQCD                          WDLQCD
     I              OMRDCD                          WDRDCD
     I              OMQ7CD                          WDQ7CD
     I              OMBZPR                          WDBZPR
     I              OML6NB                          WDL6NB
     I              OMU1ST                          WDU1ST
     I              OMGIDT                          WDGIDT
     I              OMCRCD                          WDCRCD
     I              OMAGCD                          WDAGCD
     I              OMRZST                          WDRZST
     I              OMR0ST                          WDR0ST
     I              OMR1ST                          WDR1ST
     I              OMG7NA                          WDG7NA
     I              OMG8NA                          WDG8NA
     I              OMRPCD                          WDRPCD
     I              OMVEST                          WDVEST
     I              OMVGST                          WDVGST
     I              OMAVST                          WDAVST
     I              OMU0ST                          WDU0ST
     I              OMRFCD                          WDRFCD
     I              OMFZST                          WDFZST
     I              OMR1NB                          WDR1NB
     I              OMAVQT                          WDAVQT
     I              OMD0WG                          WDD0WG
     I              OMCCQT                          WDCCQT
     I              OMAUWG                          WDAUWG
     I              OMCBQT                          WDCBQT
     I              OMATWG                          WDATWG
     I              OMAQCS                          WDAQCS
     I              OMAGCS                          WDAGCS
     I              OMAKPR                          WDAKPR
     I              OMALPR                          WDALPR
     I              OMAUPR                          WDAUPR
     I              OMAVWG                          WDAVWG
     I              OMA4WG                          WDA4WG
     I              OMA5DT                          WDA5DT
     I              OMAODT                          WDAODT
     I              OMGNDT                          WDGNDT
     I              OMAMST                          WDAMST
     I              OMANST                          WDANST
     I              OMVAST                          WDVAST
     I              OMRGNB                          WDRGNB
     I              OMRHNB                          WDRHNB
     I              OMRINB                          WDRINB
     I              OMRBCD                          WDRBCD
     I              OMHICD                          WDHICD
     I              OMRNCD                          WDRNCD
     I              OMROCD                          WDROCD
     I              OMCXDT                          WDCXDT
     I              OMAJVN                          WDAJVN
     I              OMKXCD                          WDKXCD
     I              OMJPCD                          WDJPCD
     I              OMCQCD                          WDCQCD
     I              OMR4CD                          WDR4CD
     I              OMZ1ST                          WDZ1ST
     I              OMZ3ST                          WDZ3ST
     I              OMZ4ST                          WDZ4ST
     I              OMDUPR                          WDDUPR
     I              OMB6VL                          WDB6VL
     I              OMA1AA                          WDA1AA
     I              OMFZSX                          WDFZSX
     I              OMF0SX                          WDF0SX
     I              OMF1SX                          WDF1SX
     I              OMF2SX                          WDF2SX
     I              OMF3SX                          WDF3SX
     I              OMF4SX                          WDF4SX
     I              OMF5SX                          WDF5SX
     I              OMF6SX                          WDF6SX
     I              OMF7SX                          WDF7SX
     I              OMNTDT                          WDNTDT
     I              OMNUDT                          WDNUDT
     I              OMNVDT                          WDNVDT
     I              OMNWDT                          WDNWDT
     I              OMNXDT                          WDNXDT
     I              OMBUTM                          WDBUTM
     I              OMBVTM                          WDBVTM
     I              OMBWTM                          WDBWTM
     I              OMBXTM                          WDBXTM
     I              OMBYTM                          WDBYTM
     I              OMH5NX                          WDH5NX
     I              OMH6NX                          WDH6NX
     I              OMH7NX                          WDH7NX
     I              OMH8NX                          WDH8NX
     I              OMH9NX                          WDH9NX
     I              OMDVPR                          WDDVPR
     I              OMDWPR                          WDDWPR
     I              OMDXPR                          WDDXPR
     I              OMDYPR                          WDDYPR
     I              OMDZPR                          WDDZPR
     I              OMGSPR                          WDGSPR
     I              OMGTPR                          WDGTPR
     I              OMGUPR                          WDGUPR
     I              OMHOST                          WDHOST
     I              OMHPST                          WDHPST
     I              OMIOST                          WDIOST
     I              OMPEWG                          WDPEWG
     I              OMRINY                          WDRINY
     I              OMTIDT                          WDTIDT
     I              OMTJDT                          WDTJDT
     I              OMH2ST                          WDH2ST
     I              OMH0ST                          WDH0ST
     I              OMH1ST                          WDH1ST
     I              OMTKDT                          WDTKDT
     I              OMTLDT                          WDTLDT
     I              OMTMDT                          WDTMDT
     I              OMUVST                          WDUVST
     I              OMUWST                          WDUWST
     I              OMUXST                          WDUXST
     I              OMAATM                          WDAATM
     I              OMAYNA                          WDAYNA
     I              OMA0NA                          WDA0NA
     I              OMAXDT                          WDAXDT
      *
     I@L7CPS3
      * Item Lot Loc Trans        Update index
      * Renamed input format fields
     I              L7AIC3                          WEAIC3
     I              L7HGCD                          WEHGCD
     I              L7AJCD                          WEAJCD
     I              L7LTRT                          WELTRT
     I              L7LRDT                          WELRDT
     I              L7LLTS                          WELLTS
     I              L7LSDT                          WELSDT
     I              L7J5QT                          WEJ5QT
     I              L7G8WG                          WEG8WG
     I              L7LLTN                          WELLTN
     I              L7YMCD                          WEYMCD
     I              L7LLCL                          WELLCL
     I              L7BNAA                          WEBNAA
     I              L7LLTR                          WELLTR
     I              L7Y2CD                          WEY2CD
     I              L7LLTL                          WELLTL
     I              L7C4NB                          WEC4NB
     I              L7LOST                          WELOST
     I              L7LLTU                          WELLTU
     I              L7LLYT                          WELLYT
     I              L7UVST                          WEUVST
     I              L7UWST                          WEUWST
     I              L7UXST                          WEUXST
     I              L7VSST                          WEVSST
     I              L7AATM                          WEAATM
     I              L7AYNA                          WEAYNA
     I              L7A0NA                          WEA0NA
     I              L7AXDT                          WEAXDT
      *
     I@L5CPSL
      * Item Lot Location         Update index
      * Renamed input format fields
     I              L5AIC3                          WFAIC3
     I              L5HGCD                          WFHGCD
     I              L5AJCD                          WFAJCD
     I              L5ELDT                          WFELDT
     I              L5LXNM                          WFLXNM
     I              L5YMCD                          WFYMCD
     I              L5YNCD                          WFYNCD
     I              L5J2QT                          WFJ2QT
     I              L5G5WG                          WFG5WG
     I              L5J3QT                          WFJ3QT
     I              L5G6WG                          WFG6WG
     I              L5J4QT                          WFJ4QT
     I              L5G7WG                          WFG7WG
     I              L5LODT                          WFLODT
     I              L5LPDT                          WFLPDT
     I              L5LQDT                          WFLQDT
     I              L5NBR                           WFNBR
     I              L5YTCD                          WFYTCD
     I              L5AMSX                          WFAMSX
     I              L5ASSX                          WFASSX
     I              L5ATSX                          WFATSX
     I              L5AUSX                          WFAUSX
     I              L5YSCD                          WFYSCD
     I              L5UVST                          WFUVST
     I              L5UWST                          WFUWST
     I              L5UXST                          WFUXST
     I              L5VSST                          WFVSST
     I              L5AATM                          WFAATM
     I              L5AYNA                          WFAYNA
     I              L5A0NA                          WFA0NA
     I              L5AXDT                          WFAXDT
      *
     I@B1REJ1
      * Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          WGAIC3
     I              B1HGCD                          WGHGCD
     I              B1AJCD                          WGAJCD
     I              B1ELDT                          WGELDT
     I              B1ABWG                          WGABWG
     I              B1AGQT                          WGAGQT
     I              B1AHQT                          WGAHQT
     I              B1AIQT                          WGAIQT
     I              B1CTST                          WGCTST
     I              B1ACWG                          WGACWG
     I              B1ARQT                          WGARQT
     I              B1ASQT                          WGASQT
     I              B1ATQT                          WGATQT
     I              B1HDQT                          WGHDQT
     I              B1HEQT                          WGHEQT
     I              B1F6ST                          WGF6ST
     I              B1BMWG                          WGBMWG
     I              B1DSQT                          WGDSQT
     I              B1DTQT                          WGDTQT
     I              B1DUQT                          WGDUQT
     I              B1DHDT                          WGDHDT
     I              B1AGCS                          WGAGCS
     I              B1AECS                          WGAECS
     I              B1IDVA                          WGIDVA
     I              B1K7DT                          WGK7DT
     I              B1RINB                          WGRINB
     I              B1RHNB                          WGRHNB
     I              B1RGNB                          WGRGNB
     I              B1UVST                          WGUVST
     I              B1UWST                          WGUWST
     I              B1UXST                          WGUXST
     I              B1VSST                          WGVSST
     I              B1AATM                          WGAATM
     I              B1AYNA                          WGAYNA
     I              B1A0NA                          WGA0NA
     I              B1AXDT                          WGAXDT
      *
     I@L8CPSX
      * Order Inv Allocation      Update index
      * Renamed input format fields
     I              L8AIC3                          WHAIC3
     I              L8C4NB                          WHC4NB
     I              L8DPNB                          WHDPNB
     I              L8UENB                          WHUENB
     I              L8ALSW                          WHALSW
     I              L8J6QT                          WHJ6QT
     I              L8G9WG                          WHG9WG
     I              L8J9QT                          WHJ9QT
     I              L8HAWG                          WHHAWG
     I              L8IOSE                          WHIOSE
     I              L8OIMN                          WHOIMN
     I              L8SOAS                          WHSOAS
     I              L8ARSX                          WHARSX
     I              L8OTUS                          WHOTUS
     I              L8OTMP                          WHOTMP
     I              L8HGCD                          WHHGCD
     I              L8AJCD                          WHAJCD
     I              L8ELDT                          WHELDT
     I              L8LXNM                          WHLXNM
     I              L8YMCD                          WHYMCD
     I              L8YNCD                          WHYNCD
     I              L8UVST                          WHUVST
     I              L8UWST                          WHUWST
     I              L8UXST                          WHUXST
     I              L8VSST                          WHVSST
     I              L8AATM                          WHAATM
     I              L8AYNA                          WHAYNA
     I              L8A0NA                          WHA0NA
     I              L8AXDT                          WHAXDT
      *
     I@FNCPCT
      * Manifest Detail           Retrieval index
      * Renamed input format fields
     I              FNAIC3                          WIAIC3
     I              FNC4NB                          WIC4NB
     I              FNDPNB                          WIDPNB
     I              FNUENB                          WIUENB
     I              FNRZNB                          WIRZNB
     I              FNFOQT                          WIFOQT
     I              FNR0NB                          WIR0NB
     I              FNPMST                          WIPMST
     I              FNK7DT                          WIK7DT
     I              FNPFNX                          WIPFNX
     I              FNHGCD                          WIHGCD
     I              FNAJCD                          WIAJCD
     I              FNELDT                          WIELDT
     I              FNN5WG                          WIN5WG
     I              FNRZNA                          WIRZNA
     I              FNH5NY                          WIH5NY
     I              FNH6NY                          WIH6NY
     I              FNH7NY                          WIH7NY
     I              FNGBTX                          WIGBTX
     I              FNN6WG                          WIN6WG
     I              FNN7WG                          WIN7WG
     I              FNGCTX                          WIGCTX
     I              FNGDTX                          WIGDTX
     I              FNRBDT                          WIRBDT
     I              FNITNY                          WIITNY
     I              FNIVNY                          WIIVNY
     I              FNIUNY                          WIIUNY
     I              FNIWNY                          WIIWNY
     I              FNIXNY                          WIIXNY
     I              FNIYNY                          WIIYNY
     I              FNUVST                          WIUVST
     I              FNUWST                          WIUWST
     I              FNUXST                          WIUXST
     I              FNVSST                          WIVSST
     I              FNAATM                          WIAATM
     I              FNAYNA                          WIAYNA
     I              FNA0NA                          WIA0NA
     I              FNAXDT                          WIAXDT
      *
     I@FNCPCS
      * Manifest Detail           Update index
      * Renamed input format fields
     I              FNAIC3                          WJAIC3
     I              FNC4NB                          WJC4NB
     I              FNDPNB                          WJDPNB
     I              FNUENB                          WJUENB
     I              FNRZNB                          WJRZNB
     I              FNFOQT                          WJFOQT
     I              FNR0NB                          WJR0NB
     I              FNPMST                          WJPMST
     I              FNK7DT                          WJK7DT
     I              FNPFNX                          WJPFNX
     I              FNHGCD                          WJHGCD
     I              FNAJCD                          WJAJCD
     I              FNELDT                          WJELDT
     I              FNN5WG                          WJN5WG
     I              FNRZNA                          WJRZNA
     I              FNH5NY                          WJH5NY
     I              FNH6NY                          WJH6NY
     I              FNH7NY                          WJH7NY
     I              FNGBTX                          WJGBTX
     I              FNN6WG                          WJN6WG
     I              FNN7WG                          WJN7WG
     I              FNGCTX                          WJGCTX
     I              FNGDTX                          WJGDTX
     I              FNRBDT                          WJRBDT
     I              FNITNY                          WJITNY
     I              FNIVNY                          WJIVNY
     I              FNIUNY                          WJIUNY
     I              FNIWNY                          WJIWNY
     I              FNIXNY                          WJIXNY
     I              FNIYNY                          WJIYNY
     I              FNUVST                          WJUVST
     I              FNUWST                          WJUWST
     I              FNUXST                          WJUXST
     I              FNVSST                          WJVSST
     I              FNAATM                          WJAATM
     I              FNAYNA                          WJAYNA
     I              FNA0NA                          WJA0NA
     I              FNAXDT                          WJAXDT
      *
     I@FJCPBO
      * Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WKRMNB
     I              FJAIC3                          WKAIC3
     I              FJAODT                          WKAODT
     I              FJPJST                          WKPJST
     I              FJPKST                          WKPKST
     I              FJRNNB                          WKRNNB
     I              FJDMTX                          WKDMTX
     I              FJDNTX                          WKDNTX
     I              FJDOTX                          WKDOTX
     I              FJWTTX                          WKWTTX
     I              FJWUTX                          WKWUTX
     I              FJRPNB                          WKRPNB
     I              FJFLAM                          WKFLAM
     I              FJXQST                          WKXQST
     I              FJRRNB                          WKRRNB
     I              FJDXTX                          WKDXTX
     I              FJDYTX                          WKDYTX
     I              FJSBNB                          WKSBNB
     I              FJBZNA                          WKBZNA
     I              FJRONB                          WKRONB
     I              FJSQNB                          WKSQNB
     I              FJR1NB                          WKR1NB
     I              FJVCST                          WKVCST
     I              FJVDST                          WKVDST
     I              FJSDNB                          WKSDNB
     I              FJPAOU                          WKPAOU
     I              FJDGWG                          WKDGWG
     I              FJSXNB                          WKSXNB
     I              FJHADT                          WKHADT
     I              FJAART                          WKAART
     I              FJDHWG                          WKDHWG
     I              FJDIWG                          WKDIWG
     I              FJAQDT                          WKAQDT
     I              FJS6NB                          WKS6NB
     I              FJT4NB                          WKT4NB
     I              FJPRTM                          WKPRTM
     I              FJNPSV                          WKNPSV
     I              FJJ8TX                          WKJ8TX
     I              FJTLMI                          WKTLMI
     I              FJJ9TX                          WKJ9TX
     I              FJQ2CD                          WKQ2CD
     I              FJVPCD                          WKVPCD
     I              FJDBCD                          WKDBCD
     I              FJGRWE                          WKGRWE
     I              FJXCCD                          WKXCCD
     I              FJU2ST                          WKU2ST
     I              FJF9DT                          WKF9DT
     I              FJONTM                          WKONTM
     I              FJJ4DT                          WKJ4DT
     I              FJTRTM                          WKTRTM
     I              FJJ5DT                          WKJ5DT
     I              FJSPTM                          WKSPTM
     I              FJJ6DT                          WKJ6DT
     I              FJLFTM                          WKLFTM
     I              FJJ7DT                          WKJ7DT
     I              FJBOTM                          WKBOTM
     I              FJJ8DT                          WKJ8DT
     I              FJBLTM                          WKBLTM
     I              FJKIDT                          WKKIDT
     I              FJASTM                          WKASTM
     I              FJKADT                          WKKADT
     I              FJAJCM                          WKAJCM
     I              FJXACD                          WKXACD
     I              FJOANA                          WKOANA
     I              FJK4TX                          WKK4TX
     I              FJVOAG                          WKVOAG
     I              FJKBDT                          WKKBDT
     I              FJNBBO                          WKNBBO
     I              FJW4CD                          WKW4CD
     I              FJEFDT                          WKEFDT
     I              FJCNTN                          WKCNTN
     I              FJKCDT                          WKKCDT
     I              FJTMIN                          WKTMIN
     I              FJKDDT                          WKKDDT
     I              FJVMNB                          WKVMNB
     I              FJOCFR                          WKOCFR
     I              FJKJDT                          WKKJDT
     I              FJATTM                          WKATTM
     I              FJOTRS                          WKOTRS
     I              FJRNST                          WKRNST
     I              FJBRBK                          WKBRBK
     I              FJEIDT                          WKEIDT
     I              FJRMST                          WKRMST
     I              FJAJCD                          WKAJCD
     I              FJKKDT                          WKKKDT
     I              FJAVTM                          WKAVTM
     I              FJKZDT                          WKKZDT
     I              FJAXTM                          WKAXTM
     I              FJLHOS                          WKLHOS
     I              FJLHOR                          WKLHOR
     I              FJWNTX                          WKWNTX
     I              FJOITX                          WKOITX
     I              FJOJTX                          WKOJTX
     I              FJLLDT                          WKLLDT
     I              FJLSHG                          WKLSHG
     I              FJYPST                          WKYPST
     I              FJK0DT                          WKK0DT
     I              FJAYTM                          WKAYTM
     I              FJKNNX                          WKKNNX
     I              FJICWG                          WKICWG
     I              FJIDWG                          WKIDWG
     I              FJH9SX                          WKH9SX
     I              FJWOTX                          WKWOTX
     I              FJK1DT                          WKK1DT
     I              FJAZTM                          WKAZTM
     I              FJK2DT                          WKK2DT
     I              FJA0TM                          WKA0TM
     I              FJROST                          WKROST
     I              FJRPST                          WKRPST
     I              FJRQST                          WKRQST
     I              FJRRST                          WKRRST
     I              FJZBVA                          WKZBVA
     I              FJWPTX                          WKWPTX
     I              FJWQTX                          WKWQTX
     I              FJWRTX                          WKWRTX
     I              FJWSTX                          WKWSTX
     I              FJRVSX                          WKRVSX
     I              FJRUSX                          WKRUSX
     I              FJRWSX                          WKRWSX
     I              FJRXSX                          WKRXSX
     I              FJRYSX                          WKRYSX
     I              FJRZSX                          WKRZSX
     I              FJR0SX                          WKR0SX
     I              FJR1SX                          WKR1SX
     I              FJR2SX                          WKR2SX
     I              FJR3SX                          WKR3SX
     I              FJR4SX                          WKR4SX
     I              FJPYDT                          WKPYDT
     I              FJCKTM                          WKCKTM
     I              FJPZDT                          WKPZDT
     I              FJCLTM                          WKCLTM
     I              FJP0DT                          WKP0DT
     I              FJCMTM                          WKCMTM
     I              FJP1DT                          WKP1DT
     I              FJCNTM                          WKCNTM
     I              FJP2DT                          WKP2DT
     I              FJCOTM                          WKCOTM
     I              FJP3DT                          WKP3DT
     I              FJCQTM                          WKCQTM
     I              FJUVST                          WKUVST
     I              FJUWST                          WKUWST
     I              FJUXST                          WKUXST
     I              FJAATM                          WKAATM
     I              FJAYNA                          WKAYNA
     I              FJA0NA                          WKA0NA
     I              FJAXDT                          WKAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WLAIC3
     I              BEC4NB                          WLC4NB
     I              BEJNCD                          WLJNCD
     I              BEANC7                          WLANC7
     I              BEBKC7                          WLBKC7
     I              BEBRTX                          WLBRTX
     I              BEHMNA                          WLHMNA
     I              BEHONA                          WLHONA
     I              BEHPNA                          WLHPNA
     I              BEHNNA                          WLHNNA
     I              BEDBCD                          WLDBCD
     I              BECKTX                          WLCKTX
     I              BEB0C7                          WLB0C7
     I              BEAETX                          WLAETX
     I              BEB1NA                          WLB1NA
     I              BEB3NA                          WLB3NA
     I              BEB4NA                          WLB4NA
     I              BEB2NA                          WLB2NA
     I              BEBHCD                          WLBHCD
     I              BEC8TX                          WLC8TX
     I              BEBCNA                          WLBCNA
     I              BEA0DT                          WLA0DT
     I              BEA5DT                          WLA5DT
     I              BEGNDT                          WLGNDT
     I              BEACDT                          WLACDT
     I              BEAQCD                          WLAQCD
     I              BEB6NA                          WLB6NA
     I              BEBYNA                          WLBYNA
     I              BEBZNA                          WLBZNA
     I              BEGTST                          WLGTST
     I              BEGVST                          WLGVST
     I              BEGUST                          WLGUST
     I              BEQFST                          WLQFST
     I              BECQCD                          WLCQCD
     I              BEGJST                          WLGJST
     I              BEGWST                          WLGWST
     I              BEGXST                          WLGXST
     I              BEGYST                          WLGYST
     I              BEAODT                          WLAODT
     I              BEAIVN                          WLAIVN
     I              BECXDT                          WLCXDT
     I              BEJZVA                          WLJZVA
     I              BEA1WG                          WLA1WG
     I              BEXIST                          WLXIST
     I              BEXJST                          WLXJST
     I              BEXKST                          WLXKST
     I              BEEIDT                          WLEIDT
     I              BEAFTM                          WLAFTM
     I              BEE8CD                          WLE8CD
     I              BEE9CD                          WLE9CD
     I              BERMNB                          WLRMNB
     I              BETBNB                          WLTBNB
     I              BER1NB                          WLR1NB
     I              BEPJST                          WLPJST
     I              BEU0ST                          WLU0ST
     I              BEU1ST                          WLU1ST
     I              BEQ2CD                          WLQ2CD
     I              BEU2ST                          WLU2ST
     I              BEVEST                          WLVEST
     I              BEVFST                          WLVFST
     I              BEVGST                          WLVGST
     I              BERPCD                          WLRPCD
     I              BERNNB                          WLRNNB
     I              BEVDST                          WLVDST
     I              BEATIN                          WLATIN
     I              BEU4ST                          WLU4ST
     I              BEU5ST                          WLU5ST
     I              BERSRN                          WLRSRN
     I              BEMHNA                          WLMHNA
     I              BEMINA                          WLMINA
     I              BEWBST                          WLWBST
     I              BER4CD                          WLR4CD
     I              BEBFCD                          WLBFCD
     I              BEQ4CD                          WLQ4CD
     I              BET3NB                          WLT3NB
     I              BESICD                          WLSICD
     I              BECONB                          WLCONB
     I              BECEST                          WLCEST
     I              BEAWDT                          WLAWDT
     I              BEJPCD                          WLJPCD
     I              BEXUST                          WLXUST
     I              BEZ1ST                          WLZ1ST
     I              BEVRVA                          WLVRVA
     I              BEOBST                          WLOBST
     I              BEBCST                          WLBCST
     I              BEBDST                          WLBDST
     I              BEB7VL                          WLB7VL
     I              BEGASX                          WLGASX
     I              BEGBSX                          WLGBSX
     I              BEGCSX                          WLGCSX
     I              BEGDSX                          WLGDSX
     I              BEFNSX                          WLFNSX
     I              BEFOSX                          WLFOSX
     I              BEFPSX                          WLFPSX
     I              BEFQSX                          WLFQSX
     I              BEFRSX                          WLFRSX
     I              BEFSSX                          WLFSSX
     I              BEFTSX                          WLFTSX
     I              BEFUSX                          WLFUSX
     I              BEFVSX                          WLFVSX
     I              BEFWSX                          WLFWSX
     I              BEFXSX                          WLFXSX
     I              BEFYSX                          WLFYSX
     I              BENODT                          WLNODT
     I              BENPDT                          WLNPDT
     I              BENQDT                          WLNQDT
     I              BENRDT                          WLNRDT
     I              BENSDT                          WLNSDT
     I              BEBPTM                          WLBPTM
     I              BEBQTM                          WLBQTM
     I              BEBRTM                          WLBRTM
     I              BEBSTM                          WLBSTM
     I              BEBTTM                          WLBTTM
     I              BEH0NX                          WLH0NX
     I              BEH1NX                          WLH1NX
     I              BEH2NX                          WLH2NX
     I              BEH3NX                          WLH3NX
     I              BEH4NX                          WLH4NX
     I              BEC0C7                          WLC0C7
     I              BEUVST                          WLUVST
     I              BEUWST                          WLUWST
     I              BEUXST                          WLUXST
     I              BEAATM                          WLAATM
     I              BEAYNA                          WLAYNA
     I              BEA0NA                          WLA0NA
     I              BEAXDT                          WLAXDT
      *
     I@B7CPJZ
      * Item Transaction Detail   Update index
      * Renamed input format fields
     I              B7AIC3                          WMAIC3
     I              B7HGCD                          WMHGCD
     I              B7AJCD                          WMAJCD
     I              B7W9ST                          WMW9ST
     I              B7BSST                          WMBSST
     I              B7B4DT                          WMB4DT
     I              B7C4NY                          WMC4NY
     I              B7DXNB                          WMDXNB
     I              B7ELDT                          WMELDT
     I              B7HVCD                          WMHVCD
     I              B7F1ST                          WMF1ST
     I              B7AUNA                          WMAUNA
     I              B7A5QT                          WMA5QT
     I              B7AHWG                          WMAHWG
     I              B7AKCS                          WMAKCS
     I              B7CGCD                          WMCGCD
     I              B7AYVA                          WMAYVA
     I              B7BJNA                          WMBJNA
     I              B7CKNB                          WMCKNB
     I              B7BMST                          WMBMST
     I              B7CQCD                          WMCQCD
     I              B7DTCD                          WMDTCD
     I              B7MGNA                          WMMGNA
     I              B7TRBN                          WMTRBN
     I              B7TRBS                          WMTRBS
     I              B7C4NB                          WMC4NB
     I              B7RINB                          WMRINB
     I              B7RHNB                          WMRHNB
     I              B7RGNB                          WMRGNB
     I              B7M3NA                          WMM3NA
     I              B7AWTM                          WMAWTM
     I              B7XLCD                          WMXLCD
     I              B7K7DT                          WMK7DT
     I              B7UVST                          WMUVST
     I              B7UWST                          WMUWST
     I              B7UXST                          WMUXST
     I              B7VSST                          WMVSST
     I              B7AATM                          WMAATM
     I              B7AYNA                          WMAYNA
     I              B7A0NA                          WMA0NA
     I              B7AXDT                          WMAXDT
      *
     I@MSREW4
      * Export Doc Order Dtl      Update index
      * Renamed input format fields
     I              MSAIC3                          WOAIC3
     I              MSC4NB                          WOC4NB
     I              MSDGSX                          WODGSX
     I              MSKXCD                          WOKXCD
     I              MSDPNB                          WODPNB
     I              MSUENB                          WOUENB
     I              MSDIC7                          WODIC7
     I              MSO3NA                          WOO3NA
     I              MSO4NA                          WOO4NA
     I              MSRMTX                          WORMTX
     I              MSPTTX                          WOPTTX
     I              MSHJWG                          WOHJWG
     I              MSHKWG                          WOHKWG
     I              MSRNTX                          WORNTX
     I              MSAONX                          WOAONX
     I              MSROTX                          WOROTX
     I              MSORNA                          WOORNA
     I              MSAMNX                          WOAMNX
     I              MSANNX                          WOANNX
     I              MSAPNX                          WOAPNX
     I              MSDKPR                          WODKPR
     I              MSA9VL                          WOA9VL
     I              MSC8SX                          WOC8SX
     I              MSRATX                          WORATX
     I              MSRBTX                          WORBTX
     I              MSAJNX                          WOAJNX
     I              MSZWTX                          WOZWTX
     I              MSZXTX                          WOZXTX
     I              MSZYTX                          WOZYTX
     I              MSZZTX                          WOZZTX
     I              MSK0U1                          WOK0U1
     I              MSK1U1                          WOK1U1
     I              MSIJSC                          WOIJSC
     I              MSIKSC                          WOIKSC
     I              MSK2U1                          WOK2U1
     I              MSW0DT                          WOW0DT
     I              MSUVST                          WOUVST
     I              MSUWST                          WOUWST
     I              MSUXST                          WOUXST
     I              MSVSST                          WOVSST
     I              MSAATM                          WOAATM
     I              MSAYNA                          WOAYNA
     I              MSA0NA                          WOA0NA
     I              MSAXDT                          WOAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     IQOPEY1    E DSOPEYCPL0
      * UPD : Order Events              Update index
      * Renamed input format fields
     I              EYAIC3                          WBAIC3
     I              EYC4NB                          WBC4NB
     I              EYQ2NB                          WBQ2NB
     I              EYJPCD                          WBJPCD
     I              EYAUC3                          WBAUC3
     I              EYQ7NB                          WBQ7NB
     I              EYOMST                          WBOMST
     I              EYD2DT                          WBD2DT
     I              EYONST                          WBONST
     I              EYOOST                          WBOOST
     I              EYOPST                          WBOPST
     I              EYAWC3                          WBAWC3
     I              EYQ8NB                          WBQ8NB
     I              EYQ9NB                          WBQ9NB
     I              EYBKC7                          WBBKC7
     I              EYUVST                          WBUVST
     I              EYUWST                          WBUWST
     I              EYUXST                          WBUXST
     I              EYAATM                          WBAATM
     I              EYAYNA                          WBAYNA
     I              EYA0NA                          WBA0NA
     I              EYAXDT                          WBAXDT
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WDAIC3
     I              OMC4NB                          WDC4NB
     I              OMDPNB                          WDDPNB
     I              OMUENB                          WDUENB
     I              OMHGCD                          WDHGCD
     I              OMAJCD                          WDAJCD
     I              OMBKC7                          WDBKC7
     I              OMCFC7                          WDCFC7
     I              OMGMST                          WDGMST
     I              OMGNST                          WDGNST
     I              OMMAVA                          WDMAVA
     I              OMKDVA                          WDKDVA
     I              OML8VA                          WDL8VA
     I              OML9VA                          WDL9VA
     I              OMGTST                          WDGTST
     I              OMGVST                          WDGVST
     I              OMGUST                          WDGUST
     I              OMQFST                          WDQFST
     I              OMAYVA                          WDAYVA
     I              OMEXDT                          WDEXDT
     I              OMLQCD                          WDLQCD
     I              OMRDCD                          WDRDCD
     I              OMQ7CD                          WDQ7CD
     I              OMBZPR                          WDBZPR
     I              OML6NB                          WDL6NB
     I              OMU1ST                          WDU1ST
     I              OMGIDT                          WDGIDT
     I              OMCRCD                          WDCRCD
     I              OMAGCD                          WDAGCD
     I              OMRZST                          WDRZST
     I              OMR0ST                          WDR0ST
     I              OMR1ST                          WDR1ST
     I              OMG7NA                          WDG7NA
     I              OMG8NA                          WDG8NA
     I              OMRPCD                          WDRPCD
     I              OMVEST                          WDVEST
     I              OMVGST                          WDVGST
     I              OMAVST                          WDAVST
     I              OMU0ST                          WDU0ST
     I              OMRFCD                          WDRFCD
     I              OMFZST                          WDFZST
     I              OMR1NB                          WDR1NB
     I              OMAVQT                          WDAVQT
     I              OMD0WG                          WDD0WG
     I              OMCCQT                          WDCCQT
     I              OMAUWG                          WDAUWG
     I              OMCBQT                          WDCBQT
     I              OMATWG                          WDATWG
     I              OMAQCS                          WDAQCS
     I              OMAGCS                          WDAGCS
     I              OMAKPR                          WDAKPR
     I              OMALPR                          WDALPR
     I              OMAUPR                          WDAUPR
     I              OMAVWG                          WDAVWG
     I              OMA4WG                          WDA4WG
     I              OMA5DT                          WDA5DT
     I              OMAODT                          WDAODT
     I              OMGNDT                          WDGNDT
     I              OMAMST                          WDAMST
     I              OMANST                          WDANST
     I              OMVAST                          WDVAST
     I              OMRGNB                          WDRGNB
     I              OMRHNB                          WDRHNB
     I              OMRINB                          WDRINB
     I              OMRBCD                          WDRBCD
     I              OMHICD                          WDHICD
     I              OMRNCD                          WDRNCD
     I              OMROCD                          WDROCD
     I              OMCXDT                          WDCXDT
     I              OMAJVN                          WDAJVN
     I              OMKXCD                          WDKXCD
     I              OMJPCD                          WDJPCD
     I              OMCQCD                          WDCQCD
     I              OMR4CD                          WDR4CD
     I              OMZ1ST                          WDZ1ST
     I              OMZ3ST                          WDZ3ST
     I              OMZ4ST                          WDZ4ST
     I              OMDUPR                          WDDUPR
     I              OMB6VL                          WDB6VL
     I              OMA1AA                          WDA1AA
     I              OMFZSX                          WDFZSX
     I              OMF0SX                          WDF0SX
     I              OMF1SX                          WDF1SX
     I              OMF2SX                          WDF2SX
     I              OMF3SX                          WDF3SX
     I              OMF4SX                          WDF4SX
     I              OMF5SX                          WDF5SX
     I              OMF6SX                          WDF6SX
     I              OMF7SX                          WDF7SX
     I              OMNTDT                          WDNTDT
     I              OMNUDT                          WDNUDT
     I              OMNVDT                          WDNVDT
     I              OMNWDT                          WDNWDT
     I              OMNXDT                          WDNXDT
     I              OMBUTM                          WDBUTM
     I              OMBVTM                          WDBVTM
     I              OMBWTM                          WDBWTM
     I              OMBXTM                          WDBXTM
     I              OMBYTM                          WDBYTM
     I              OMH5NX                          WDH5NX
     I              OMH6NX                          WDH6NX
     I              OMH7NX                          WDH7NX
     I              OMH8NX                          WDH8NX
     I              OMH9NX                          WDH9NX
     I              OMDVPR                          WDDVPR
     I              OMDWPR                          WDDWPR
     I              OMDXPR                          WDDXPR
     I              OMDYPR                          WDDYPR
     I              OMDZPR                          WDDZPR
     I              OMGSPR                          WDGSPR
     I              OMGTPR                          WDGTPR
     I              OMGUPR                          WDGUPR
     I              OMHOST                          WDHOST
     I              OMHPST                          WDHPST
     I              OMIOST                          WDIOST
     I              OMPEWG                          WDPEWG
     I              OMRINY                          WDRINY
     I              OMTIDT                          WDTIDT
     I              OMTJDT                          WDTJDT
     I              OMH2ST                          WDH2ST
     I              OMH0ST                          WDH0ST
     I              OMH1ST                          WDH1ST
     I              OMTKDT                          WDTKDT
     I              OMTLDT                          WDTLDT
     I              OMTMDT                          WDTMDT
     I              OMUVST                          WDUVST
     I              OMUWST                          WDUWST
     I              OMUXST                          WDUXST
     I              OMAATM                          WDAATM
     I              OMAYNA                          WDAYNA
     I              OMA0NA                          WDA0NA
     I              OMAXDT                          WDAXDT
      *
     IYARDCS      DS                            525
     IQPDL71    E DSPDL7CPL0
      * UPD : Item Lot Loc Trans        Update index
      * Renamed input format fields
     I              L7AIC3                          WEAIC3
     I              L7HGCD                          WEHGCD
     I              L7AJCD                          WEAJCD
     I              L7LTRT                          WELTRT
     I              L7LRDT                          WELRDT
     I              L7LLTS                          WELLTS
     I              L7LSDT                          WELSDT
     I              L7J5QT                          WEJ5QT
     I              L7G8WG                          WEG8WG
     I              L7LLTN                          WELLTN
     I              L7YMCD                          WEYMCD
     I              L7LLCL                          WELLCL
     I              L7BNAA                          WEBNAA
     I              L7LLTR                          WELLTR
     I              L7Y2CD                          WEY2CD
     I              L7LLTL                          WELLTL
     I              L7C4NB                          WEC4NB
     I              L7LOST                          WELOST
     I              L7LLTU                          WELLTU
     I              L7LLYT                          WELLYT
     I              L7UVST                          WEUVST
     I              L7UWST                          WEUWST
     I              L7UXST                          WEUXST
     I              L7VSST                          WEVSST
     I              L7AATM                          WEAATM
     I              L7AYNA                          WEAYNA
     I              L7A0NA                          WEA0NA
     I              L7AXDT                          WEAXDT
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IQPDL51    E DSPDL5CPL0
      * UPD : Item Lot Location         Update index
      * Renamed input format fields
     I              L5AIC3                          WFAIC3
     I              L5HGCD                          WFHGCD
     I              L5AJCD                          WFAJCD
     I              L5ELDT                          WFELDT
     I              L5LXNM                          WFLXNM
     I              L5YMCD                          WFYMCD
     I              L5YNCD                          WFYNCD
     I              L5J2QT                          WFJ2QT
     I              L5G5WG                          WFG5WG
     I              L5J3QT                          WFJ3QT
     I              L5G6WG                          WFG6WG
     I              L5J4QT                          WFJ4QT
     I              L5G7WG                          WFG7WG
     I              L5LODT                          WFLODT
     I              L5LPDT                          WFLPDT
     I              L5LQDT                          WFLQDT
     I              L5NBR                           WFNBR
     I              L5YTCD                          WFYTCD
     I              L5AMSX                          WFAMSX
     I              L5ASSX                          WFASSX
     I              L5ATSX                          WFATSX
     I              L5AUSX                          WFAUSX
     I              L5YSCD                          WFYSCD
     I              L5UVST                          WFUVST
     I              L5UWST                          WFUWST
     I              L5UXST                          WFUXST
     I              L5VSST                          WFVSST
     I              L5AATM                          WFAATM
     I              L5AYNA                          WFAYNA
     I              L5A0NA                          WFA0NA
     I              L5AXDT                          WFAXDT
      *
     IYBRDCS      DS                            111
     IQCAB11    E DSCAB1REL1
      * UPD : Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          WGAIC3
     I              B1HGCD                          WGHGCD
     I              B1AJCD                          WGAJCD
     I              B1ELDT                          WGELDT
     I              B1ABWG                          WGABWG
     I              B1AGQT                          WGAGQT
     I              B1AHQT                          WGAHQT
     I              B1AIQT                          WGAIQT
     I              B1CTST                          WGCTST
     I              B1ACWG                          WGACWG
     I              B1ARQT                          WGARQT
     I              B1ASQT                          WGASQT
     I              B1ATQT                          WGATQT
     I              B1HDQT                          WGHDQT
     I              B1HEQT                          WGHEQT
     I              B1F6ST                          WGF6ST
     I              B1BMWG                          WGBMWG
     I              B1DSQT                          WGDSQT
     I              B1DTQT                          WGDTQT
     I              B1DUQT                          WGDUQT
     I              B1DHDT                          WGDHDT
     I              B1AGCS                          WGAGCS
     I              B1AECS                          WGAECS
     I              B1IDVA                          WGIDVA
     I              B1K7DT                          WGK7DT
     I              B1RINB                          WGRINB
     I              B1RHNB                          WGRHNB
     I              B1RGNB                          WGRGNB
     I              B1UVST                          WGUVST
     I              B1UWST                          WGUWST
     I              B1UXST                          WGUXST
     I              B1VSST                          WGVSST
     I              B1AATM                          WGAATM
     I              B1AYNA                          WGAYNA
     I              B1A0NA                          WGA0NA
     I              B1AXDT                          WGAXDT
      *
     IQPDL81    E DSPDL8CPL0
      * UPD : Order Inv Allocation      Update index
      * Renamed input format fields
     I              L8AIC3                          WHAIC3
     I              L8C4NB                          WHC4NB
     I              L8DPNB                          WHDPNB
     I              L8UENB                          WHUENB
     I              L8ALSW                          WHALSW
     I              L8J6QT                          WHJ6QT
     I              L8G9WG                          WHG9WG
     I              L8J9QT                          WHJ9QT
     I              L8HAWG                          WHHAWG
     I              L8IOSE                          WHIOSE
     I              L8OIMN                          WHOIMN
     I              L8SOAS                          WHSOAS
     I              L8ARSX                          WHARSX
     I              L8OTUS                          WHOTUS
     I              L8OTMP                          WHOTMP
     I              L8HGCD                          WHHGCD
     I              L8AJCD                          WHAJCD
     I              L8ELDT                          WHELDT
     I              L8LXNM                          WHLXNM
     I              L8YMCD                          WHYMCD
     I              L8YNCD                          WHYNCD
     I              L8UVST                          WHUVST
     I              L8UWST                          WHUWST
     I              L8UXST                          WHUXST
     I              L8VSST                          WHVSST
     I              L8AATM                          WHAATM
     I              L8AYNA                          WHAYNA
     I              L8A0NA                          WHA0NA
     I              L8AXDT                          WHAXDT
      *
     IYCRDCS      DS                             91
     IQOMFN1    E DSOMFNCPL0
      * UPD : Manifest Detail           Update index
      * Renamed input format fields
     I              FNAIC3                          WJAIC3
     I              FNC4NB                          WJC4NB
     I              FNDPNB                          WJDPNB
     I              FNUENB                          WJUENB
     I              FNRZNB                          WJRZNB
     I              FNFOQT                          WJFOQT
     I              FNR0NB                          WJR0NB
     I              FNPMST                          WJPMST
     I              FNK7DT                          WJK7DT
     I              FNPFNX                          WJPFNX
     I              FNHGCD                          WJHGCD
     I              FNAJCD                          WJAJCD
     I              FNELDT                          WJELDT
     I              FNN5WG                          WJN5WG
     I              FNRZNA                          WJRZNA
     I              FNH5NY                          WJH5NY
     I              FNH6NY                          WJH6NY
     I              FNH7NY                          WJH7NY
     I              FNGBTX                          WJGBTX
     I              FNN6WG                          WJN6WG
     I              FNN7WG                          WJN7WG
     I              FNGCTX                          WJGCTX
     I              FNGDTX                          WJGDTX
     I              FNRBDT                          WJRBDT
     I              FNITNY                          WJITNY
     I              FNIVNY                          WJIVNY
     I              FNIUNY                          WJIUNY
     I              FNIWNY                          WJIWNY
     I              FNIXNY                          WJIXNY
     I              FNIYNY                          WJIYNY
     I              FNUVST                          WJUVST
     I              FNUWST                          WJUWST
     I              FNUXST                          WJUXST
     I              FNVSST                          WJVSST
     I              FNAATM                          WJAATM
     I              FNAYNA                          WJAYNA
     I              FNA0NA                          WJA0NA
     I              FNAXDT                          WJAXDT
      *
     IQOMFJ1    E DSOMFJCPL1
      * UPD : Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WKRMNB
     I              FJAIC3                          WKAIC3
     I              FJAODT                          WKAODT
     I              FJPJST                          WKPJST
     I              FJPKST                          WKPKST
     I              FJRNNB                          WKRNNB
     I              FJDMTX                          WKDMTX
     I              FJDNTX                          WKDNTX
     I              FJDOTX                          WKDOTX
     I              FJWTTX                          WKWTTX
     I              FJWUTX                          WKWUTX
     I              FJRPNB                          WKRPNB
     I              FJFLAM                          WKFLAM
     I              FJXQST                          WKXQST
     I              FJRRNB                          WKRRNB
     I              FJDXTX                          WKDXTX
     I              FJDYTX                          WKDYTX
     I              FJSBNB                          WKSBNB
     I              FJBZNA                          WKBZNA
     I              FJRONB                          WKRONB
     I              FJSQNB                          WKSQNB
     I              FJR1NB                          WKR1NB
     I              FJVCST                          WKVCST
     I              FJVDST                          WKVDST
     I              FJSDNB                          WKSDNB
     I              FJPAOU                          WKPAOU
     I              FJDGWG                          WKDGWG
     I              FJSXNB                          WKSXNB
     I              FJHADT                          WKHADT
     I              FJAART                          WKAART
     I              FJDHWG                          WKDHWG
     I              FJDIWG                          WKDIWG
     I              FJAQDT                          WKAQDT
     I              FJS6NB                          WKS6NB
     I              FJT4NB                          WKT4NB
     I              FJPRTM                          WKPRTM
     I              FJNPSV                          WKNPSV
     I              FJJ8TX                          WKJ8TX
     I              FJTLMI                          WKTLMI
     I              FJJ9TX                          WKJ9TX
     I              FJQ2CD                          WKQ2CD
     I              FJVPCD                          WKVPCD
     I              FJDBCD                          WKDBCD
     I              FJGRWE                          WKGRWE
     I              FJXCCD                          WKXCCD
     I              FJU2ST                          WKU2ST
     I              FJF9DT                          WKF9DT
     I              FJONTM                          WKONTM
     I              FJJ4DT                          WKJ4DT
     I              FJTRTM                          WKTRTM
     I              FJJ5DT                          WKJ5DT
     I              FJSPTM                          WKSPTM
     I              FJJ6DT                          WKJ6DT
     I              FJLFTM                          WKLFTM
     I              FJJ7DT                          WKJ7DT
     I              FJBOTM                          WKBOTM
     I              FJJ8DT                          WKJ8DT
     I              FJBLTM                          WKBLTM
     I              FJKIDT                          WKKIDT
     I              FJASTM                          WKASTM
     I              FJKADT                          WKKADT
     I              FJAJCM                          WKAJCM
     I              FJXACD                          WKXACD
     I              FJOANA                          WKOANA
     I              FJK4TX                          WKK4TX
     I              FJVOAG                          WKVOAG
     I              FJKBDT                          WKKBDT
     I              FJNBBO                          WKNBBO
     I              FJW4CD                          WKW4CD
     I              FJEFDT                          WKEFDT
     I              FJCNTN                          WKCNTN
     I              FJKCDT                          WKKCDT
     I              FJTMIN                          WKTMIN
     I              FJKDDT                          WKKDDT
     I              FJVMNB                          WKVMNB
     I              FJOCFR                          WKOCFR
     I              FJKJDT                          WKKJDT
     I              FJATTM                          WKATTM
     I              FJOTRS                          WKOTRS
     I              FJRNST                          WKRNST
     I              FJBRBK                          WKBRBK
     I              FJEIDT                          WKEIDT
     I              FJRMST                          WKRMST
     I              FJAJCD                          WKAJCD
     I              FJKKDT                          WKKKDT
     I              FJAVTM                          WKAVTM
     I              FJKZDT                          WKKZDT
     I              FJAXTM                          WKAXTM
     I              FJLHOS                          WKLHOS
     I              FJLHOR                          WKLHOR
     I              FJWNTX                          WKWNTX
     I              FJOITX                          WKOITX
     I              FJOJTX                          WKOJTX
     I              FJLLDT                          WKLLDT
     I              FJLSHG                          WKLSHG
     I              FJYPST                          WKYPST
     I              FJK0DT                          WKK0DT
     I              FJAYTM                          WKAYTM
     I              FJKNNX                          WKKNNX
     I              FJICWG                          WKICWG
     I              FJIDWG                          WKIDWG
     I              FJH9SX                          WKH9SX
     I              FJWOTX                          WKWOTX
     I              FJK1DT                          WKK1DT
     I              FJAZTM                          WKAZTM
     I              FJK2DT                          WKK2DT
     I              FJA0TM                          WKA0TM
     I              FJROST                          WKROST
     I              FJRPST                          WKRPST
     I              FJRQST                          WKRQST
     I              FJRRST                          WKRRST
     I              FJZBVA                          WKZBVA
     I              FJWPTX                          WKWPTX
     I              FJWQTX                          WKWQTX
     I              FJWRTX                          WKWRTX
     I              FJWSTX                          WKWSTX
     I              FJRVSX                          WKRVSX
     I              FJRUSX                          WKRUSX
     I              FJRWSX                          WKRWSX
     I              FJRXSX                          WKRXSX
     I              FJRYSX                          WKRYSX
     I              FJRZSX                          WKRZSX
     I              FJR0SX                          WKR0SX
     I              FJR1SX                          WKR1SX
     I              FJR2SX                          WKR2SX
     I              FJR3SX                          WKR3SX
     I              FJR4SX                          WKR4SX
     I              FJPYDT                          WKPYDT
     I              FJCKTM                          WKCKTM
     I              FJPZDT                          WKPZDT
     I              FJCLTM                          WKCLTM
     I              FJP0DT                          WKP0DT
     I              FJCMTM                          WKCMTM
     I              FJP1DT                          WKP1DT
     I              FJCNTM                          WKCNTM
     I              FJP2DT                          WKP2DT
     I              FJCOTM                          WKCOTM
     I              FJP3DT                          WKP3DT
     I              FJCQTM                          WKCQTM
     I              FJUVST                          WKUVST
     I              FJUWST                          WKUWST
     I              FJUXST                          WKUXST
     I              FJAATM                          WKAATM
     I              FJAYNA                          WKAYNA
     I              FJA0NA                          WKA0NA
     I              FJAXDT                          WKAXDT
      *
     IYDRDCS      DS                            793
     IYERDCS      DS                            793
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WLAIC3
     I              BEC4NB                          WLC4NB
     I              BEJNCD                          WLJNCD
     I              BEANC7                          WLANC7
     I              BEBKC7                          WLBKC7
     I              BEBRTX                          WLBRTX
     I              BEHMNA                          WLHMNA
     I              BEHONA                          WLHONA
     I              BEHPNA                          WLHPNA
     I              BEHNNA                          WLHNNA
     I              BEDBCD                          WLDBCD
     I              BECKTX                          WLCKTX
     I              BEB0C7                          WLB0C7
     I              BEAETX                          WLAETX
     I              BEB1NA                          WLB1NA
     I              BEB3NA                          WLB3NA
     I              BEB4NA                          WLB4NA
     I              BEB2NA                          WLB2NA
     I              BEBHCD                          WLBHCD
     I              BEC8TX                          WLC8TX
     I              BEBCNA                          WLBCNA
     I              BEA0DT                          WLA0DT
     I              BEA5DT                          WLA5DT
     I              BEGNDT                          WLGNDT
     I              BEACDT                          WLACDT
     I              BEAQCD                          WLAQCD
     I              BEB6NA                          WLB6NA
     I              BEBYNA                          WLBYNA
     I              BEBZNA                          WLBZNA
     I              BEGTST                          WLGTST
     I              BEGVST                          WLGVST
     I              BEGUST                          WLGUST
     I              BEQFST                          WLQFST
     I              BECQCD                          WLCQCD
     I              BEGJST                          WLGJST
     I              BEGWST                          WLGWST
     I              BEGXST                          WLGXST
     I              BEGYST                          WLGYST
     I              BEAODT                          WLAODT
     I              BEAIVN                          WLAIVN
     I              BECXDT                          WLCXDT
     I              BEJZVA                          WLJZVA
     I              BEA1WG                          WLA1WG
     I              BEXIST                          WLXIST
     I              BEXJST                          WLXJST
     I              BEXKST                          WLXKST
     I              BEEIDT                          WLEIDT
     I              BEAFTM                          WLAFTM
     I              BEE8CD                          WLE8CD
     I              BEE9CD                          WLE9CD
     I              BERMNB                          WLRMNB
     I              BETBNB                          WLTBNB
     I              BER1NB                          WLR1NB
     I              BEPJST                          WLPJST
     I              BEU0ST                          WLU0ST
     I              BEU1ST                          WLU1ST
     I              BEQ2CD                          WLQ2CD
     I              BEU2ST                          WLU2ST
     I              BEVEST                          WLVEST
     I              BEVFST                          WLVFST
     I              BEVGST                          WLVGST
     I              BERPCD                          WLRPCD
     I              BERNNB                          WLRNNB
     I              BEVDST                          WLVDST
     I              BEATIN                          WLATIN
     I              BEU4ST                          WLU4ST
     I              BEU5ST                          WLU5ST
     I              BERSRN                          WLRSRN
     I              BEMHNA                          WLMHNA
     I              BEMINA                          WLMINA
     I              BEWBST                          WLWBST
     I              BER4CD                          WLR4CD
     I              BEBFCD                          WLBFCD
     I              BEQ4CD                          WLQ4CD
     I              BET3NB                          WLT3NB
     I              BESICD                          WLSICD
     I              BECONB                          WLCONB
     I              BECEST                          WLCEST
     I              BEAWDT                          WLAWDT
     I              BEJPCD                          WLJPCD
     I              BEXUST                          WLXUST
     I              BEZ1ST                          WLZ1ST
     I              BEVRVA                          WLVRVA
     I              BEOBST                          WLOBST
     I              BEBCST                          WLBCST
     I              BEBDST                          WLBDST
     I              BEB7VL                          WLB7VL
     I              BEGASX                          WLGASX
     I              BEGBSX                          WLGBSX
     I              BEGCSX                          WLGCSX
     I              BEGDSX                          WLGDSX
     I              BEFNSX                          WLFNSX
     I              BEFOSX                          WLFOSX
     I              BEFPSX                          WLFPSX
     I              BEFQSX                          WLFQSX
     I              BEFRSX                          WLFRSX
     I              BEFSSX                          WLFSSX
     I              BEFTSX                          WLFTSX
     I              BEFUSX                          WLFUSX
     I              BEFVSX                          WLFVSX
     I              BEFWSX                          WLFWSX
     I              BEFXSX                          WLFXSX
     I              BEFYSX                          WLFYSX
     I              BENODT                          WLNODT
     I              BENPDT                          WLNPDT
     I              BENQDT                          WLNQDT
     I              BENRDT                          WLNRDT
     I              BENSDT                          WLNSDT
     I              BEBPTM                          WLBPTM
     I              BEBQTM                          WLBQTM
     I              BEBRTM                          WLBRTM
     I              BEBSTM                          WLBSTM
     I              BEBTTM                          WLBTTM
     I              BEH0NX                          WLH0NX
     I              BEH1NX                          WLH1NX
     I              BEH2NX                          WLH2NX
     I              BEH3NX                          WLH3NX
     I              BEH4NX                          WLH4NX
     I              BEC0C7                          WLC0C7
     I              BEUVST                          WLUVST
     I              BEUWST                          WLUWST
     I              BEUXST                          WLUXST
     I              BEAATM                          WLAATM
     I              BEAYNA                          WLAYNA
     I              BEA0NA                          WLA0NA
     I              BEAXDT                          WLAXDT
      *
     IYFRDCS      DS                            779
      * Outward parameters
     IPARC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Order Number
     I                                    P   3   60PAC4NB
      * I :  Order Type_Sales
     I                                        7   8 PAJNCD
      * I :  AR Customer Number
     I                                    P   9  120PAANC7
      * I :  Ship To Customer
     I                                    P  13  160PABKC7
      * I :  Ship To Name
     I                                       17  46 PABRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PAHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PAHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PAHPNA
      * I :  Ship To City
     I                                      137 156 PAHNNA
      * I :  Ship To State Code
     I                                      157 158 PADBCD
      * I :  Ship To Zip_Postal Code
     I                                      159 169 PACKTX
      * I :  Bill to Customer
     I                                    P 170 1730PAB0C7
      * I :  Bill to Name
     I                                      174 203 PAAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PAB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PAB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PAB4NA
      * I :  Bill to City
     I                                      294 313 PAB2NA
      * I :  Bill to State Code
     I                                      314 315 PABHCD
      * I :  Bill to Zip_Postal Code
     I                                      316 326 PAC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PABCNA
      * I :  Order Date
     I                                    P 342 3450PAA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PAA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PAGNDT
      * I :  Cancel Date
     I                                    P 354 3570PAACDT
      * I :  Terms Code
     I                                      358 359 PAAQCD
      * I :  Special Instructions
     I                                      360 399 PAB6NA
      * I :  Special Instructions 2
     I                                      400 439 PABYNA
      * I :  Carrier Code
     I                                      440 442 PABZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PAGTST
      * I :  Comment Print Inv_Cr.Memo
     I                                      444 444 PAGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PAGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PAQFST
      * I :  Reason Code
     I                                      447 449 PACQCD
      * I :  Order in Use
     I                                      450 450 PAGJST
      * I :  Header Status
     I                                      451 451 PAGWST
      * I :  Header Status Last
     I                                      452 452 PAGXST
      * I :  Order Type Print Status
     I                                      453 453 PAGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PAAODT
      * I :  User Original Entry
     I                                      458 467 PAAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PACXDT
      * I :  Order Value Total
     I                                    P 472 4772PAJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PAA1WG
      * I :  Credit Hold
     I                                      484 484 PAXIST
      * I :  Production Hold
     I                                      485 485 PAXJST
      * I :  New Customer Hold
     I                                      486 486 PAXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PAEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PAAFTM
      * I :  Accounts Receiv. Ent 1
     I                                      494 497 PAE8CD
      * I :  Accounts Receiv. Ent 2
     I                                      498 509 PAE9CD
      * I :  Load ID
     I                                    P 510 5130PARMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PATBNB
      * I :  Rated Freight
     I                                    P 517 5222PAR1NB
      * I :  LTL Flag
     I                                      523 523 PAPJST
      * I :  Price Audit
     I                                      524 524 PAU0ST
      * I :  Price Status
     I                                      525 525 PAU1ST
      * I :  Shipping Method
     I                                      526 527 PAQ2CD
      * I :  Export Status
     I                                      528 528 PAU2ST
      * I :  Palletize
     I                                      529 529 PAVEST
      * I :  Shrink Wrap
     I                                      530 530 PAVFST
      * I :  Slip Sheet
     I                                      531 531 PAVGST
      * I :  Age Code
     I                                      532 532 PARPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PARNNB
      * I :  Load Type
     I                                      536 536 PAVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PAATIN
      * I :  Load Plan Order
     I                                      541 541 PAU4ST
      * I :  Print Pick Slip
     I                                      542 542 PAU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PARSRN
      * I :  Special Comment 1
     I                                      547 576 PAMHNA
      * I :  Special Comment 2
     I                                      577 606 PAMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PAWBST
      * I :  Sales Route Code
     I                                      608 610 PAR4CD
      * I :  Manager Level Code
     I                                      611 612 PABFCD
      * I :  VP Level Code
     I                                      613 615 PAQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PAT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PASICD
      * I :  Invoice Number
     I                                    P 623 6260PACONB
      * I :  Invoice Suffix
     I                                      627 628 PACEST
      * I :  Invoice Date
     I                                    P 629 6320PAAWDT
      * I :  Event Code
     I                                      633 634 PAJPCD
      * I :  Trans Contol AS400_Plant
     I                                      635 635 PAXUST
      * I :  Modified Flag
     I                                      636 636 PAZ1ST
      * I :  A/R order Value Total
     I                                    P 637 6422PAVRVA
      * I :  Billing Activity Type
     I                                      643 643 PAOBST
      * I :  Block Order Flag
     I                                      644 644 PABCST
      * I :  Order Certification Flag
     I                                      645 645 PABDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PAB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PAGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PAGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PAGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PAGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PAFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PAFOSX
      * I :  Order Emailed
     I                                      658 658 PAFPSX
      * I :  Export Docs Go w_Driver
     I                                      659 659 PAFQSX
      * I :  Shipping Temp Code C_F
     I                                      660 660 PAFRSX
      * I :  Broker Order Status
     I                                      661 661 PAFSSX
      * I :  Air Freight Order
     I                                      662 662 PAFTSX
      * I :  Order Requires Review
     I                                      663 664 PAFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PAFVSX
      * I :  Export USDA Approved
     I                                      667 668 PAFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PAFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PAFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PANODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PANPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PANQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PANRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PANSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PABPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PABQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PABRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PABSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PABTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PAH0NX
      * I :  Act Non_Ref Frt Amount
     I                                    P 721 7262PAH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PAH2NX
      * I :  OH Total Non_Ref Frt Amt
     I                                    P 733 7382PAH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PAH4NX
      * I :  Claim Number
     I                                    P 745 7480PAC0C7
      * I :  EDI Status 1
     I                                      749 749 PAUVST
      * I :  EDI Status 2
     I                                      750 750 PAUWST
      * I :  EDI Status 3
     I                                      751 751 PAUXST
      * I :  Job Time
     I                                    P 752 7550PAAATM
      * I :  User Id
     I                                      756 765 PAAYNA
      * I :  Job Name
     I                                      766 775 PAA0NA
      * I :  Job Date
     I                                    P 776 7790PAAXDT
      *
     IQCAB71    E DSCAB7CPL0
      * UPD : Item Transaction Detail   Update index
      * Renamed input format fields
     I              B7AIC3                          WMAIC3
     I              B7HGCD                          WMHGCD
     I              B7AJCD                          WMAJCD
     I              B7W9ST                          WMW9ST
     I              B7BSST                          WMBSST
     I              B7B4DT                          WMB4DT
     I              B7C4NY                          WMC4NY
     I              B7DXNB                          WMDXNB
     I              B7ELDT                          WMELDT
     I              B7HVCD                          WMHVCD
     I              B7F1ST                          WMF1ST
     I              B7AUNA                          WMAUNA
     I              B7A5QT                          WMA5QT
     I              B7AHWG                          WMAHWG
     I              B7AKCS                          WMAKCS
     I              B7CGCD                          WMCGCD
     I              B7AYVA                          WMAYVA
     I              B7BJNA                          WMBJNA
     I              B7CKNB                          WMCKNB
     I              B7BMST                          WMBMST
     I              B7CQCD                          WMCQCD
     I              B7DTCD                          WMDTCD
     I              B7MGNA                          WMMGNA
     I              B7TRBN                          WMTRBN
     I              B7TRBS                          WMTRBS
     I              B7C4NB                          WMC4NB
     I              B7RINB                          WMRINB
     I              B7RHNB                          WMRHNB
     I              B7RGNB                          WMRGNB
     I              B7M3NA                          WMM3NA
     I              B7AWTM                          WMAWTM
     I              B7XLCD                          WMXLCD
     I              B7K7DT                          WMK7DT
     I              B7UVST                          WMUVST
     I              B7UWST                          WMUWST
     I              B7UXST                          WMUXST
     I              B7VSST                          WMVSST
     I              B7AATM                          WMAATM
     I              B7AYNA                          WMAYNA
     I              B7A0NA                          WMA0NA
     I              B7AXDT                          WMAXDT
      *
     IYGRDCS      DS                            192
     IQPDMS1    E DSPDMSREL0
      * UPD : Export Doc Order Dtl      Update index
      * Renamed input format fields
     I              MSAIC3                          WOAIC3
     I              MSC4NB                          WOC4NB
     I              MSDGSX                          WODGSX
     I              MSKXCD                          WOKXCD
     I              MSDPNB                          WODPNB
     I              MSUENB                          WOUENB
     I              MSDIC7                          WODIC7
     I              MSO3NA                          WOO3NA
     I              MSO4NA                          WOO4NA
     I              MSRMTX                          WORMTX
     I              MSPTTX                          WOPTTX
     I              MSHJWG                          WOHJWG
     I              MSHKWG                          WOHKWG
     I              MSRNTX                          WORNTX
     I              MSAONX                          WOAONX
     I              MSROTX                          WOROTX
     I              MSORNA                          WOORNA
     I              MSAMNX                          WOAMNX
     I              MSANNX                          WOANNX
     I              MSAPNX                          WOAPNX
     I              MSDKPR                          WODKPR
     I              MSA9VL                          WOA9VL
     I              MSC8SX                          WOC8SX
     I              MSRATX                          WORATX
     I              MSRBTX                          WORBTX
     I              MSAJNX                          WOAJNX
     I              MSZWTX                          WOZWTX
     I              MSZXTX                          WOZXTX
     I              MSZYTX                          WOZYTX
     I              MSZZTX                          WOZZTX
     I              MSK0U1                          WOK0U1
     I              MSK1U1                          WOK1U1
     I              MSIJSC                          WOIJSC
     I              MSIKSC                          WOIKSC
     I              MSK2U1                          WOK2U1
     I              MSW0DT                          WOW0DT
     I              MSUVST                          WOUVST
     I              MSUWST                          WOUWST
     I              MSUXST                          WOUXST
     I              MSVSST                          WOVSST
     I              MSAATM                          WOAATM
     I              MSAYNA                          WOAYNA
     I              MSA0NA                          WOA0NA
     I              MSAXDT                          WOAXDT
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Header TRG
      * N :  Company Number
     I                                    P   1   20P1AIC3
      * N : MAP Load ID
     I                                    P   3   60P1RMNB
     IP2PARM      DS
      * FLD: *Arrays
      * N :  Warehouse Code
     I                                        1   3 P2AJCD
      * N :  Application Code
     I                                        4   9 P2DNCD
      * N :  Salesperson Code
     I                                       10  12 P2BCCD
      * N :  System Date Format
     I                                       13  15 P2B8NA
      * N :  Allow Multi-Company
     I                                       16  16 P2I6ST
      * N :  Allow Multi Warehouse
     I                                       17  17 P2I8ST
      * N :  Default Printer
     I                                       18  27 P2MPNA
      * N :  First Time Flag
     I                                       28  28 P2TAST
     IP3PARM      DS
      * N :  USR Status (Y/N)
     I                                        1   1 P3E6ST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Warehouse Code Required'
      * Warehouse Code
     I                                        1   3 ZA0001
      * Message data for 'Access Denied: Warehouse'
      * User Profile Name
     I                                        1  10 ZA0002
      * Warehouse Code
     I                                       11  13 ZA0003
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0004
      * Condition Name USR
     I                                       11  35 ZA0005
      * Warehouse Code
     I                                       36  38 ZA0006
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0007
      * Condition Name USR
     I                                       11  35 ZA0008
      * Warehouse Code
     I                                       36  38 ZA0009
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0010
      * Condition Name USR
     I                                       11  35 ZA0011
      * Warehouse Code
     I                                       36  38 ZA0012
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0013
      * Condition Name USR
     I                                       11  35 ZA0014
      * Warehouse Code
     I                                       36  38 ZA0015
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0016
      * Condition Name USR
     I                                       11  35 ZA0017
      * Warehouse Code
     I                                       36  38 ZA0018
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0019
      * Condition Name USR
     I                                       11  35 ZA0020
      * Warehouse Code
     I                                       36  38 ZA0021
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0022
      * Condition Name USR
     I                                       11  35 ZA0023
      * Warehouse Code
     I                                       36  38 ZA0024
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0025
      * Condition Name USR
     I                                       11  35 ZA0026
      * Warehouse Code
     I                                       36  38 ZA0027
      * Message data for 'CD3 Non numeric data'
      * Message data for 'CD7 Non numeric data'
      * Message data for 'Option Not Allowed'
      * *SFLSEL
     I                                        1   1 ZA0028
      * Message data for 'COA Batch Header RIN foun'
      * Order Number
     I                                        1   7 ZA0029
      * Message data for 'Unship Order Notification'
      * Order Number
     I                                        1   7 ZA0030
      * *USER
     I                                        8  17 ZA0031
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0032
      * Application Code
     I                                       11  16 ZA0033
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0034
      * Application Code
     I                                       11  16 ZA0035
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise & load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END                             OD W0RSF
     C                     END                             OD *HIVAL
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise and load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
      * USER: Initialize subfile control
      * First Time Flag
      * CASE: PAR.First Time Flag is Yes
     C           P2TAST    IFEQ 'Y'                        *IF
     C                     Z-ADDP1AIC3    #2AIC3           Company Number
     C                     MOVELP2AJCD    #CAJCD           Warehouse Code
     C                     MOVEL'N'       P2TAST           First Time Flag
     C                     END                             *FI
      * Val:  Warehouse Code
      * CASE: CTL.Warehouse Code is Warehouse Code Blank
     C           #CAJCD    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#CAJCD    ZA0001           Warehouse Code
      * Send message 'Warehouse Code Required'
     C                     MOVEL'USR2015' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     GOTO BAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     MOVEL*BLANK    WN0001  1        UWA Inventory T
     C                     MOVEL*BLANK    WN0002  1        UWA Lot Loc Tra
     C                     MOVEL*BLANK    WN0003  1        UWA Shipping Tr
     C                     MOVEL*BLANK    WN0004  1        UWA Cross Appli
     C                     MOVEL*BLANK    WN0005  1        UWA Unused Stat
     C                     MOVEL*BLANK    WN0006  1        UWA Unused Stat
     C                     MOVEL*BLANK    WN0007  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0008  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0009  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0010  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0011  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0012  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0013  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0014  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0015  2        UWA Unused Sts
     C                     MOVEL*BLANK    WN0016  2        UWA Unused Sts
     C                     MOVEL*BLANK    WN0017  2        UWA Unused Sts
     C                     MOVEL*BLANK    WN0018  2        UWA Unused Sts
     C                     MOVEL*BLANK    WN0019  2        UWA Unused Sts
     C                     MOVEL*BLANK    WN0020 10        User Code Model
     C                     MOVEL*BLANK    WN0021  1        Record Found US
      *
      * Val User Whs Access   IF
      * Rtv Profile Model     RT - User Profile Control  * 
     C                     EXSR SARVGN
      * Retrieve User Warehouse Access Type
      * CASE: PAR.User Code Model is equal to blank
     C           WN0020    IFEQ *BLANK                     *IF
      * Rtv User Whs Access   RT - User Warehouse Access  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##USR     WL0001    P      User Profile Na
     C                     MOVEL#CAJCD    WL0002    P      Warehouse Code
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    WN0001    P      UWA Inventory T
     C                     MOVELWL0004    WN0002    P      UWA Lot Loc Tra
     C                     MOVELWL0005    WN0003    P      UWA Shipping Tr
     C                     MOVELWL0006    WN0004    P      UWA Cross Appli
     C                     MOVELWL0007    WN0005    P      UWA Unused Stat
     C                     MOVELWL0008    WN0006    P      UWA Unused Stat
     C                     MOVELWL0009    WN0007    P      UWA Unused Sts
     C                     MOVELWL0010    WN0008    P      UWA Unused Sts
     C                     MOVELWL0011    WN0009    P      UWA Unused Sts
     C                     MOVELWL0012    WN0010    P      UWA Unused Sts
     C                     MOVELWL0013    WN0011    P      UWA Unused Sts
     C                     MOVELWL0014    WN0012    P      UWA Unused Sts
     C                     MOVELWL0015    WN0013    P      UWA Unused Sts
     C                     MOVELWL0016    WN0014    P      UWA Unused Sts
     C                     MOVELWL0017    WN0015    P      UWA Unused Sts
     C                     MOVELWL0018    WN0016    P      UWA Unused Sts
     C                     MOVELWL0019    WN0017    P      UWA Unused Sts
     C                     MOVELWL0020    WN0018    P      UWA Unused Sts
     C                     MOVELWL0021    WN0019    P      UWA Unused Sts
     C                     MOVELWL0022    WN0021    P      Record Found US
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv User Whs Access   RT - User Warehouse Access  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0020    WL0001    P      User Profile Na
     C                     MOVEL#CAJCD    WL0002    P      Warehouse Code
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    WN0001    P      UWA Inventory T
     C                     MOVELWL0004    WN0002    P      UWA Lot Loc Tra
     C                     MOVELWL0005    WN0003    P      UWA Shipping Tr
     C                     MOVELWL0006    WN0004    P      UWA Cross Appli
     C                     MOVELWL0007    WN0005    P      UWA Unused Stat
     C                     MOVELWL0008    WN0006    P      UWA Unused Stat
     C                     MOVELWL0009    WN0007    P      UWA Unused Sts
     C                     MOVELWL0010    WN0008    P      UWA Unused Sts
     C                     MOVELWL0011    WN0009    P      UWA Unused Sts
     C                     MOVELWL0012    WN0010    P      UWA Unused Sts
     C                     MOVELWL0013    WN0011    P      UWA Unused Sts
     C                     MOVELWL0014    WN0012    P      UWA Unused Sts
     C                     MOVELWL0015    WN0013    P      UWA Unused Sts
     C                     MOVELWL0016    WN0014    P      UWA Unused Sts
     C                     MOVELWL0017    WN0015    P      UWA Unused Sts
     C                     MOVELWL0018    WN0016    P      UWA Unused Sts
     C                     MOVELWL0019    WN0017    P      UWA Unused Sts
     C                     MOVELWL0020    WN0018    P      UWA Unused Sts
     C                     MOVELWL0021    WN0019    P      UWA Unused Sts
     C                     MOVELWL0022    WN0021    P      Record Found US
     C                     END                             *FI
      * Validate Access
      * CASE: PAR.Record Found USR is Record Not Found
     C           WN0021    IFEQ 'N'                        *IF
      * Setup message data for message
     C                     MOVEL##USR     ZA0002           User Profile Na
     C                     MOVEL#CAJCD    ZA0003           Warehouse Code
      * Send message 'Access Denied: Warehouse'
     C                     MOVEL'USR2776' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     GOTO BAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * Inventory Transactions
      * CASE: PAR.Access Area Needed USR is Inventory Transactions
     C           'S'       IFEQ 'I'                        *IF
      * CASE: PAR.Access Needed USR is Update
     C           'U'       IFEQ 'U'                        *IF
      * CASE: PAR.UWA Inventory Trans is *Not Update
     C           WN0001    IFEQ 'N'                        *IF
     C           WN0001    OREQ 'R'
      *
     C                     MOVEL*BLANK    WN0022 10        Condition Name
     C                     MOVEL*BLANK    WN0023 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0022    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'S'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0023    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0022    ZA0004           Condition Name
     C                     MOVELWN0023    ZA0005           Condition Name
     C                     MOVEL#CAJCD    ZA0006           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     GOTO BAEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Access Needed USR is Read
     C           'U'       IFEQ 'R'                        *IF
      * CASE: PAR.UWA Inventory Trans is None
     C           WN0001    IFEQ 'N'                        *IF
      *
     C                     MOVEL*BLANK    WN0024 10        Condition Name
     C                     MOVEL*BLANK    WN0025 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0024    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'S'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0025    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0024    ZA0007           Condition Name
     C                     MOVELWN0025    ZA0008           Condition Name
     C                     MOVEL#CAJCD    ZA0009           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     GOTO BAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Lot Loc Transactions
      * CASE: PAR.Access Area Needed USR is Lot Loc Transactions
     C           'S'       IFEQ 'L'                        *IF
      * CASE: PAR.Access Needed USR is Update
     C           'U'       IFEQ 'U'                        *IF
      * CASE: PAR.UWA Lot Loc Trans is *Not Update
     C           WN0002    IFEQ 'N'                        *IF
     C           WN0002    OREQ 'R'
      *
     C                     MOVEL*BLANK    WN0026 10        Condition Name
     C                     MOVEL*BLANK    WN0027 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0026    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'S'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0027    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0026    ZA0010           Condition Name
     C                     MOVELWN0027    ZA0011           Condition Name
     C                     MOVEL#CAJCD    ZA0012           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     GOTO BAEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Access Needed USR is Read
     C           'U'       IFEQ 'R'                        *IF
      * CASE: PAR.UWA Lot Loc Trans is None
     C           WN0002    IFEQ 'N'                        *IF
      *
     C                     MOVEL*BLANK    WN0028 10        Condition Name
     C                     MOVEL*BLANK    WN0029 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0028    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'S'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0029    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0028    ZA0013           Condition Name
     C                     MOVELWN0029    ZA0014           Condition Name
     C                     MOVEL#CAJCD    ZA0015           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     GOTO BAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Shipping Transactions
      * CASE: PAR.Access Area Needed USR is Shipping Transactions
     C           'S'       IFEQ 'S'                        *IF
      * CASE: PAR.Access Needed USR is Update
     C           'U'       IFEQ 'U'                        *IF
      * CASE: PAR.UWA Shipping Trans is *Not Update
     C           WN0003    IFEQ 'N'                        *IF
     C           WN0003    OREQ 'R'
      *
     C                     MOVEL*BLANK    WN0030 10        Condition Name
     C                     MOVEL*BLANK    WN0031 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0030    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'S'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0031    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0030    ZA0016           Condition Name
     C                     MOVELWN0031    ZA0017           Condition Name
     C                     MOVEL#CAJCD    ZA0018           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     GOTO BAEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Access Needed USR is Read
     C           'U'       IFEQ 'R'                        *IF
      * CASE: PAR.UWA Shipping Trans is None
     C           WN0003    IFEQ 'N'                        *IF
      *
     C                     MOVEL*BLANK    WN0032 10        Condition Name
     C                     MOVEL*BLANK    WN0033 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0032    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'S'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0033    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0032    ZA0019           Condition Name
     C                     MOVELWN0033    ZA0020           Condition Name
     C                     MOVEL#CAJCD    ZA0021           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     GOTO BAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Cross Applications
      * CASE: PAR.Access Area Needed USR is Cross Applications
     C           'S'       IFEQ 'C'                        *IF
      * CASE: PAR.Access Needed USR is Update
     C           'U'       IFEQ 'U'                        *IF
      * CASE: PAR.UWA Unused Sts is *Not Update
     C           WN0004    IFEQ 'N'                        *IF
     C           WN0004    OREQ 'R'
      *
     C                     MOVEL*BLANK    WN0034 10        Condition Name
     C                     MOVEL*BLANK    WN0035 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0034    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'S'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0035    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0034    ZA0022           Condition Name
     C                     MOVELWN0035    ZA0023           Condition Name
     C                     MOVEL#CAJCD    ZA0024           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     GOTO BAEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Access Needed USR is Read
     C           'U'       IFEQ 'R'                        *IF
      * CASE: PAR.UWA Unused Sts is None
     C           WN0004    IFEQ 'N'                        *IF
      *
     C                     MOVEL*BLANK    WN0036 10        Condition Name
     C                     MOVEL*BLANK    WN0037 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0036    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'S'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0037    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0036    ZA0025           Condition Name
     C                     MOVELWN0037    ZA0026           Condition Name
     C                     MOVEL#CAJCD    ZA0027           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     GOTO BAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Rtv Live w/CT LD/ORD  RT - Warehouse  * 
     C                     EXSR SCRVGN
      * Position DBF file
     C           KPOS      KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BERMNB           Load ID
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD#2AIC3    BEAIC3
     C           #2RMNB    IFEQ *ZERO
     C                     MOVEL*HIVAL    BERMNB           Load ID
     C                     ELSE
     C                     Z-ADD#2RMNB    BERMNB
     C                     ENDIF
     C           #2C4NB    IFEQ *ZERO
     C                     MOVEL*HIVAL    BEC4NB           Order Number
     C                     ELSE
     C                     Z-ADD#2C4NB    BEC4NB
     C                     ENDIF
     C           KPOS      SETLL@BFCPZI
     C                     READ @BFCPZI                8782*82=EOF
      * Save previous selector values
     C           *LIKE     DEFN #2AODT    WZAODT
     C                     MOVEL#2AODT    WZAODT           Scheduled Ship
     C           *LIKE     DEFN #CO6NA    WZO6NA
     C                     MOVEL#CO6NA    WZO6NA           Warehouse Desc
     C           *LIKE     DEFN #2AIC3    WZAIC3
     C                     MOVEL#2AIC3    WZAIC3           Company Number
     C           *LIKE     DEFN #2RMNB    WZRMNB
     C                     MOVEL#2RMNB    WZRMNB           Load ID
     C           *LIKE     DEFN #2C4NB    WZC4NB
     C                     MOVEL#2C4NB    WZC4NB           Order Number
     C           *LIKE     DEFN #2GWST    WZGWST
     C                     MOVEL#2GWST    WZGWST           Header Status
     C           *LIKE     DEFN #2BKC7    WZBKC7
     C                     MOVEL#2BKC7    WZBKC7           Ship To Custome
     C           *LIKE     DEFN #2BRTX    WZBRTX
     C                     MOVEL#2BRTX    WZBRTX           Ship To Name
     C           *LIKE     DEFN #2A0DT    WZA0DT
     C                     MOVEL#2A0DT    WZA0DT           Order Date
     C           *LIKE     DEFN #2GNDT    WZGNDT
     C                     MOVEL#2GNDT    WZGNDT           Actual Shipped
      * Load subfile page
     C                     Z-ADD0         ##RROK  50
     C                     EXSR BBLDSF
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@BFCPZI                  90*
     C  N82                READ @BFCPZI                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVEL*ALL'0'   WKIND0  1
     C                     MOVEAWKIND0    *IN,35
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
      * Reset count of DBF records read
     C                     Z-ADD0         ##RRRD  90
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next SFL page until SFL page full, or
      * Scan limit reached
     C           *IN82     DOWEQ'0'                        DO
     C           ##RROK    ANDLT##SFLN
     C           ##RRRD    ANDLTW0SLM
      * Check selection fields - if fail, read next record
     C           #2AODT    IFNE *ZERO                      Scheduled Ship
     C           BEAODT    CABNE#2AODT    BB020            Scheduled Ship
     C                     END
     C           #2AIC3    IFEQ *ZERO                      Company Number
     C           #2RMNB    IFNE *ZERO                      Load ID
     C           BERMNB    CABNE#2RMNB    BB020            Load ID
     C                     END
     C                     END
     C           #2AIC3    IFEQ *ZERO                      Company Number
     C           #2RMNB    OREQ *ZERO                      Load ID
     C           #2C4NB    IFNE *ZERO                      Order Number
     C           BEC4NB    CABNE#2C4NB    BB020            Order Number
     C                     END
     C                     END
     C           #2GWST    IFNE *BLANK                     Header Status
     C           BEGWST    CABNE#2GWST    BB020            Header Status
     C                     END
     C           #2BKC7    IFNE *ZERO                      Ship To Custome
     C           BEBKC7    CABNE#2BKC7    BB020            Ship To Custome
     C                     END
     C           #2BRTX    IFNE *BLANK                     Ship To Name
     C           BEBRTX    CABNE#2BRTX    BB020            Ship To Name
     C                     END
     C           #2A0DT    IFNE *ZERO                      Order Date
     C           BEA0DT    CABNE#2A0DT    BB020            Order Date
     C                     END
     C           #2GNDT    IFNE *ZERO                      Actual Shipped
     C           BEGNDT    CABNE#2GNDT    BB020            Actual Shipped
     C                     END
      * Load SFL fields
     C                     EXSR MBFL#1
     C                     MOVEL'Y'       W0RSL   1
      * Allow for possible *Set Cursor processing
     C                     ADD  1         ##RR
      * USER: Initialize subfile record from DBF record
     C                     MOVEL'N'       W0RSL            *Record selecte
      * Sel Order by Whs      RT - Order Detail  * 
     C                     EXSR SDRVGN
      * Match CTL company, if any
      * CASE: CTL.Company Number NE WRK.ZERO
     C           #2AIC3    IFNE WUW0NB                     *IF
      * CASE: DB1.Company Number NE CTL.Company Number
     C           BEAIC3    IFNE #2AIC3                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Exclude memos
      * CASE: DB1.Billing Activity Type is Credit or Debit Memo
     C           BEOBST    IFEQ '2'                        *IF
     C           BEOBST    OREQ '3'
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     SUB  1         ##RR
      * DBF record not selected
     C           W0RSL     CABNE'Y'       BB020
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Output to subfile
     C                     ADD  1         ##RR
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * Increment scan check count
     C                     ADD  1         ##RRRD
     C                     READ @BFCPZI                  82*82=EOF
     C                     END                             OD 1 - ##SFPG
      *................................................................
     C           BB900     TAG
      *................................................................
      * If no DBF records found, display error message
     C           ##RR      IFEQ *ZERO
     C           *IN82     ANDEQ'1'
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI ##RR = *ZERO
      *
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      * If scan limit reached, display error message
     C           ##RRRD    IFGE W0SLM
      * Send message '*Scan limit reached'
     C                     MOVEL'Y2U0017' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     ELSE
     C                     Z-ADD0         ##RROK
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     SETOF                       8392*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate Company Number and convert to internal.
      * CD3 Ext/Int
     C                     MOVELV2AIC3    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC3  3
     C                     MOVEA*BLANKS   K3
     C                     Z-ADD3         C       30
     C                     Z-ADD3         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUDMCD    J3
     C                     MOVE *BLANKS   W0RTN
     C                     DO   3
     C           J3,C      IFNE ' '
     C                     MOVEAJ3,C      K3,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK3        JUSTC3
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC3    TESTC   1
     C           TESTC     IFGT '?'
     C           TESTC     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC3     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC3    WUDMCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Send message 'CD3 Non numeric data'
     C                     MOVEL'USR0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #2AIC3           CD3 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUDMCD    #2AIC3           CD3 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Order Number and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV2C4NB    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #2C4NB           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #2C4NB           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      *................................................................
     C           YPMTFD    IFNE *BLANKS
     C           YPMRRN    ANDEQ*ZERO
     C                     GOTO DAEXIT
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Subfile control function fields
     C                     MOVEL*BLANK    #CO6NA           Warehouse Desc
      * Warehouse Desc DRV
      * RTV Whse Descrip       RT - Warehouse  * 
     C                     EXSR SERVGN
     C                     END
     C           YPMTFD    CABNE*BLANKS   DATAG1
      * Change of position specified
     C           WZAIC3    CASNE#2AIC3    FBRQRL
     C           WZRMNB    CASNE#2RMNB    FBRQRL
     C           WZC4NB    CASNE#2C4NB    FBRQRL
     C                     END
     C           DATAG1    TAG
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process subfile control (Pre-confirm)
      * Select
      * CASE: CTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * CASE: PGM.*Cursor field <IS> CTL.Company Number
     C           W0CFL     IFEQ 'V2AIC3'                   *IF
      * SEL Company - plants   SR - Company Name and Address  * 
     C                     CALL 'PPF2SRR'              90  SEL Company - p
     C                     PARM *BLANK    W0RTN   7
     C           #2AIC3    PARM #2AIC3    WQ0001  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPF2SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
     C                     ELSE
      * CASE: PGM.*Cursor field <IS> CTL.Warehouse Code
     C           W0CFL     IFEQ '#CAJCD'                   *IF
      * SEL Warehouse          SR - Warehouse  * 
     C                     CALL 'CAANSRR'              90  SEL Warehouse
     C                     PARM *BLANK    W0RTN   7
     C           #CAJCD    PARM #CAJCD    WQ0002  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAANSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Reload Subfile if Warehouse Code changed.
      * CASE: PAR.Warehouse Code NE CTL.Warehouse Code
     C           P2AJCD    IFNE #CAJCD                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVEL#CAJCD    P2AJCD           Warehouse Code
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * Reload subfile requested
     C           W0RSF     CABEQ'Y'       DAEXIT
     C                     END
     C           *IN81     IFEQ '1'
      * Process subfile records
     C                     EXSR DBPRSF
     C                     END
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * If error, quit processing
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPRCF
      * Exit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO DAEXIT
     C                     END
      * Process subfile (pass 2)
     C                     EXSR EAPRSF
      * If error during 2nd pass exit:
     C           *IN99     CABEQ'1'       DAEXIT
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
      * Process subfile record
     C                     EXSR DCPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Setof error indicators and SFLNXTCHG
     C                     MOVEAWKIND0    *IN,35
     C                     SETOF                     98    *
     C           YPMTFD    CABNE*BLANKS   DCEXIT
      * SFLNXTCHG
     C                     SETON                     84
      * USER: Process subfile record (Pre-confirm)
      * CASE: RCD.*SFLSEL is *Select
     C           #1SEL     IFEQ '1'                        *IF
     C           #1SEL     OREQ ' 1'
      * Live with Carlisle?
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.WHS Live w/Carlisle is Yes
      *   |- c2    : LCL.WHS PFS Interface is Upload/Both
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0001    IFEQ 'Y'                        *IF
     C           YL0002    IFEQ 'U'                        *IF
     C           YL0002    OREQ 'B'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0028           *SFLSEL
      * Send message 'Option Not Allowed'
     C                     MOVEL'USR2262' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9835  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * *****************************************************************
      * ***  FP1110 - RMC 8/07/08 HPB ONLY - Dont allow unship if RIN #
      * ***  exists on the COA Batch RIN Number rcd
      * *****************************************************************
      * Rtv Plant Co/Org      XF - Company Defaults Internal  * 
     C                     CALL 'PMOVXFR'              90  Rtv Plant Co/Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0003  30       Company Number
     C           YL0003    PARM *BLANK    WQ0004  1        Plant Company S
     C           YL0004    PARM *BLANK    WQ0005  1        Company Organiz
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMOVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE: LCL.Company Organization is High Plains Biodiesel
     C           YL0004    IFEQ 'H'                        *IF
      * Exc Val RIN bef/unshp XF - COA Batch Header RIN  * 
     C                     CALL 'PMXAXFR'              90  Exc Val RIN bef
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0006  30       Company Number
     C           YL0005    PARM *BLANK    WQ0007 38        COA Batch Heade
     C                     PARM #1C4NB    WQ0008  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMXAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE: LCL.COA Batch Header RIN is Eq Blank
     C           YL0005    IFEQ *BLANK                     *IF
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0029           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0029           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'COA Batch Header RIN foun'
     C                     MOVEL'USR3986' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * not hpb
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     END                             FI *IN98
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         DHPRCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#SFLCTL
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         EAPRSF    BEGSR
      *================================================================
      * Update DBF from subfile
      *================================================================
     C           *IN81     IFEQ '1'
      * Process all modified subfile records
     C                     READC#SFLRCD                  92*
     C           *IN92     DOWEQ'0'
      * Process modified subfile record
     C                     EXSR EBPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END                             WOD *92
     C                     END                             FI *81
      * If any errors, cancel reload
     C           *IN99     IFEQ '1'
     C                     MOVEL'N'       W0RSF   1
     C                     END
      * USER: Final processing (Post-confirm)
     C                     MOVEL'Y'       W0DCF            *Defer confirm
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPRSR    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,35
     C                     SETOF                     98
      * USER: Process subfile record (Post-confirm)
      * Unship
      * CASE: RCD.*SFLSEL is *Select
     C           #1SEL     IFEQ '1'                        *IF
      * PA and Inventory will not be adjusted during the unship
      * RTV Delete Ship Event  RT - Order Events  * 
     C                     EXSR SFRVGN
      * RTV Next Event Number  RT - Order Events  * 
     C                     EXSR SHRVGN
      * RTV Event Code         RT - Order Events  * 
     C                     EXSR SIRVGN
      * WI517 DN 10/12/23-Setup Eradani's Environment Libraries.
      * Upd Setup Eradani Libs CL - /UT User Programs  * 
     C                     CALL 'PVBFUPC'              90  Upd Setup Erada
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVBFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     98    *
     C                     END
      * WI517 DN 10/06/23-Initialize.
     C                     MOVEL'N'       YL0006           Send Email f/Fa
      * WI517 DN 10/04/23-Added 'Called From Program' Input Parm.
      * - Added 'Send Email f/Failed API U' Output Parm.
      * UPD Unship Ship Detail RT - Order Detail  * 
     C                     EXSR SJRVGN
      * WI517 DN 10/04/23-If 'Send Email f/Failed API U=Yes' Then Send Em
      * CASE: LCL.Send Email f/Failed API U is Yes
     C           YL0006    IFEQ 'Y'                        *IF
      * Prc Eml Shipping & IT  XF - WIM API Failure Log  * 
     C                     CALL 'PVA9XFR'              90  Prc Eml Shippin
     C                     PARM *BLANK    W0RTN   7
     C                     PARM @CN,002   WQ0095 10        Called From Pro
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVA9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * ** FP1127 Use Load ID for Lot# if Ext Whse, Not PFS, Lot Trck=Y
      * Cnf Order Ship/Unship IF
      * Cnf Order Ship/Unship RT - Order Inv Allocation  * 
     C                     EXSR SQRVGN
      * If Plant order delete manifest.
      * CASE: RCD.Trans Contol AS400/Plant is Plant
     C           #1XUST    IFEQ 'P'                        *IF
      * DLT to Unship Mainfest RT - Manifest Detail  * 
     C                     EXSR TDRVGN
     C                     END                             *FI
      * CLC Tot Ord Val Ship   XF - Order Detail  * 
     C                     CALL 'PDP1XFR'              90  CLC Tot Ord Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0096  30       Company Number
     C                     PARM #1C4NB    WQ0097  70       Order Number
     C           WUJSVA    PARM WUJSVA    WQ0098 112       USR Order Value
     C           WUAYWG    PARM WUAYWG    WQ0099 112       USR Order Weigh
     C           WUXPST    PARM WUXPST    WQ0100  1        USR Production
     C           WUR4ST    PARM WUR4ST    WQ0101  1        USR Update Flag
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDP1XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL#1GWST    #1GXST           Header Status L
     C                     MOVEL'A'       #1GWST           Header Status
      * Per OMS245 - 5/05/97 - S. Schertz - When an order is unshipped, c
      * out BOL Complete date/time, as well as indication that BOL has pr
      * UPD Unship Load Status RT - Load Header  * 
     C                     EXSR TFRVGN
      * *****************************************************************
      * CHG Load Status/ActShp CH - Load Header  * 
     C                     EXSR THCHRC
      * CHG for Unship         CH - Order Header TRG  * 
     C                     EXSR TICHRC
      * C3087/C3093:  When unship, clear out ERR Reason from IC Transacti
      * UPD Err Transactions   RT - Item Transaction Detail  * 
     C                     EXSR TJRVGN
      * *****************************************************************
      * ***  FP1110 - RMC 7/17/08 HPB ONLY - Delete COA Batch RIN if it e
      * *****************************************************************
      * Rtv Plant Co/Org      XF - Company Defaults Internal  * 
     C                     CALL 'PMOVXFR'              90  Rtv Plant Co/Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0102  30       Company Number
     C           YL0003    PARM *BLANK    WQ0103  1        Plant Company S
     C           YL0004    PARM *BLANK    WQ0104  1        Company Organiz
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMOVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE: LCL.Company Organization is High Plains Biodiesel
     C           YL0004    IFEQ 'H'                        *IF
      * Exc Delet RINS f/unshp XF - COA Batch Header RIN  * 
     C                     CALL 'PMWSXFR'              90  Exc Delet RINS
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0105  30       Company Number
     C                     PARM #1C4NB    WQ0106  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMWSXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * *****************************************************************
      * ***  S00619 - RMC 1/06/09 export orders only - del Exp doc dtls b
      * ***  products may be removed from the order; the dtls will be
      * ***  recreated when the documents are selected to print again.
      * *****************************************************************
      * CASE: RCD.Export Status is yes
     C           #1U2ST    IFEQ 'Y'                        *IF
      * Rtv & Dlt for Cancel  RT - Export Doc Order Dtl  * 
     C                     EXSR TLRVGN
     C                     END                             *FI
      * *****************************************************************
      * **** Send pager message     8/26/02
      * *****************************************************************
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0030           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0030           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVEL##USR     ZA0031           *USER
      * Retrieve message Unship Order Notification
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3167' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0020    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * RTV Alpha Value        RT - Company Values  * 
     C                     EXSR TNRVGN
      * SND Pager Msg (MPLUS) UP - /UT User Programs  * 
     C                     CALL 'POMSUPC'              90  SND Pager Msg (
     C                     PARM YL0021    WQ0107 10        DL List ID
     C                     PARM YL0020    WQ0108132        Office Message
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMSUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     98    *
     C                     END
      * *****
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C                     SETON                     84    SFLNXTCHG
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     GOTO EBEXIT
     C                     ELSE
      * SFLRCD valid
     C                     SETOF                     84    SFLNXTCHG
     C                     MOVEL*BLANK    #1SEL
     C                     END                             FI *IN98
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         GBDSA2    BEGSR
      *================================================================
      * Set display attributes for Subfile control
      *================================================================
     C                     MOVEL'0'       *IN79
     C           P2I8ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @BFCPZI fields to subfile
      *================================================================
     C                     MOVEL*BLANK    #1SEL
     C                     MOVELBEJNCD    #1JNCD           Order Type_Sale
     C                     Z-ADDBEANC7    #1ANC7           AR Customer Num
     C                     MOVELBEHMNA    #1HMNA           Ship To Address
     C                     MOVELBEHONA    #1HONA           Ship To Address
     C                     MOVELBEHPNA    #1HPNA           Ship To Address
     C                     MOVELBEHNNA    #1HNNA           Ship To City
     C                     MOVELBEDBCD    #1DBCD           Ship To State C
     C                     MOVELBECKTX    #1CKTX           Ship To Zip_Pos
     C                     Z-ADDBEB0C7    #1B0C7           Bill to Custome
     C                     MOVELBEAETX    #1AETX           Bill to Name
     C                     MOVELBEB1NA    #1B1NA           Bill to Address
     C                     MOVELBEB3NA    #1B3NA           Bill to Address
     C                     MOVELBEB4NA    #1B4NA           Bill to Address
     C                     MOVELBEB2NA    #1B2NA           Bill to City
     C                     MOVELBEBHCD    #1BHCD           Bill to State C
     C                     MOVELBEC8TX    #1C8TX           Bill to Zip_Pos
     C                     MOVELBEBCNA    #1BCNA           Customer Purcha
     C                     Z-ADDBEA5DT    #1A5DT           Requested Ship
     C                     Z-ADDBEACDT    #1ACDT           Cancel Date
     C                     MOVELBEAQCD    #1AQCD           Terms Code
     C                     MOVELBEB6NA    #1B6NA           Special Instruc
     C                     MOVELBEBYNA    #1BYNA           Special Instruc
     C                     MOVELBEBZNA    #1BZNA           Carrier Code
     C                     MOVELBEGTST    #1GTST           Comment Print A
     C                     MOVELBEGVST    #1GVST           Comment Print I
     C                     MOVELBEGUST    #1GUST           Comment Print P
     C                     MOVELBEQFST    #1QFST           Comment Print S
     C                     MOVELBECQCD    #1CQCD           Reason Code
     C                     MOVELBEGJST    #1GJST           Order in Use
     C                     MOVELBEGXST    #1GXST           Header Status L
     C                     MOVELBEGYST    #1GYST           Order Type Prin
     C                     Z-ADDBEAODT    #1AODT           Scheduled Ship
     C                     MOVELBEAIVN    #1AIVN           User Original E
     C                     Z-ADDBECXDT    #1CXDT           Date of Origina
     C                     Z-ADDBEJZVA    #1JZVA           Order Value Tot
     C                     Z-ADDBEA1WG    #1A1WG           Order Weight To
     C                     MOVELBEXIST    #1XIST           Credit Hold
     C                     MOVELBEXJST    #1XJST           Production Hold
     C                     MOVELBEXKST    #1XKST           New Customer Ho
     C                     Z-ADDBEEIDT    #1EIDT           Requested Deliv
     C                     Z-ADDBEAFTM    #1AFTM           Requested Deliv
     C                     MOVELBEE8CD    #1E8CD           Accounts Receiv
     C                     MOVELBEE9CD    #1E9CD           Accounts Receiv
     C                     Z-ADDBETBNB    #1TBNB           Absorbed Freigh
     C                     Z-ADDBER1NB    #1R1NB           Rated Freight
     C                     MOVELBEPJST    #1PJST           LTL Flag
     C                     MOVELBEU0ST    #1U0ST           Price Audit
     C                     MOVELBEU1ST    #1U1ST           Price Status
     C                     MOVELBEQ2CD    #1Q2CD           Shipping Method
     C                     MOVELBEU2ST    #1U2ST           Export Status
     C                     MOVELBEVEST    #1VEST           Palletize
     C                     MOVELBEVFST    #1VFST           Shrink Wrap
     C                     MOVELBEVGST    #1VGST           Slip Sheet
     C                     MOVELBERPCD    #1RPCD           Age Code
     C                     Z-ADDBERNNB    #1RNNB           Reefer Temperat
     C                     MOVELBEVDST    #1VDST           Load Type
     C                     Z-ADDBEATIN    #1ATIN           Attach to Invoi
     C                     MOVELBEU4ST    #1U4ST           Load Plan Order
     C                     MOVELBEU5ST    #1U5ST           Print Pick Slip
     C                     Z-ADDBERSRN    #1RSRN           Resell Referenc
     C                     MOVELBEMHNA    #1MHNA           Special Comment
     C                     MOVELBEMINA    #1MINA           Special Comment
     C                     MOVELBEWBST    #1WBST           Affect Auto Acc
     C                     MOVELBER4CD    #1R4CD           Sales Route Cod
     C                     MOVELBEBFCD    #1BFCD           Manager Level C
     C                     MOVELBEQ4CD    #1Q4CD           VP Level Code
     C                     Z-ADDBET3NB    #1T3NB           Attach to Order
     C                     MOVELBESICD    #1SICD           Reason for Pric
     C                     Z-ADDBECONB    #1CONB           Invoice Number
     C                     MOVELBECEST    #1CEST           Invoice Suffix
     C                     Z-ADDBEAWDT    #1AWDT           Invoice Date
     C                     MOVELBEJPCD    #1JPCD           Event Code
     C                     MOVELBEXUST    #1XUST           Trans Contol AS
     C                     MOVELBEZ1ST    #1Z1ST           Modified Flag
     C                     Z-ADDBEVRVA    #1VRVA           A/R order Value
     C                     MOVELBEOBST    #1OBST           Billing Activit
     C                     MOVELBEBCST    #1BCST           Block Order Fla
     C                     MOVELBEBDST    #1BDST           Order Certifica
     C                     Z-ADDBEB7VL    #1B7VL           Invoice Order V
     C                     MOVELBEGASX    #1GASX           Process Sts for
     C                     MOVELBEGBSX    #1GBSX           Order Conf Fax
     C                     MOVELBEGCSX    #1GCSX           Manifest Fax St
     C                     MOVELBEGDSX    #1GDSX           Invoice Fax Sts
     C                     MOVELBEFNSX    #1FNSX           Transfer in Sto
     C                     MOVELBEFOSX    #1FOSX           Email Cust On O
     C                     MOVELBEFPSX    #1FPSX           Order Emailed
     C                     MOVELBEFQSX    #1FQSX           Export Docs Go
     C                     MOVELBEFRSX    #1FRSX           Shipping Temp C
     C                     MOVELBEFSSX    #1FSSX           Broker Order St
     C                     MOVELBEFTSX    #1FTSX           Air Freight Ord
     C                     MOVELBEFUSX    #1FUSX           Order Requires
     C                     MOVELBEFVSX    #1FVSX           OH Load Plan Re
     C                     MOVELBEFWSX    #1FWSX           Export USDA App
     C                     MOVELBEFXSX    #1FXSX           HPB Ship to War
     C                     MOVELBEFYSX    #1FYSX           OH TF Exempt Co
     C                     Z-ADDBENODT    #1NODT           OH Appt Confirm
     C                     Z-ADDBENPDT    #1NPDT           JPN Invoice Iss
     C                     Z-ADDBENQDT    #1NQDT           Load Actual Shi
     C                     Z-ADDBENRDT    #1NRDT           Load BOL Comple
     C                     Z-ADDBENSDT    #1NSDT           Load Truck Depa
     C                     Z-ADDBEBPTM    #1BPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    #1BQTM           Time of Origina
     C                     Z-ADDBEBRTM    #1BRTM           OH Appt Confirm
     C                     Z-ADDBEBSTM    #1BSTM           Load BOL Comple
     C                     Z-ADDBEBTTM    #1BTTM           Load Truck Depa
     C                     Z-ADDBEH0NX    #1H0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    #1H1NX           Act Non_Ref Frt
     C                     Z-ADDBEH2NX    #1H2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    #1H3NX           OH Total Non_Re
     C                     Z-ADDBEH4NX    #1H4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    #1C0C7           Claim Number
     C                     MOVELBEUVST    #1UVST           EDI Status 1
     C                     MOVELBEUWST    #1UWST           EDI Status 2
     C                     MOVELBEUXST    #1UXST           EDI Status 3
     C                     Z-ADDBEAATM    #1AATM           Job Time
     C                     MOVELBEAYNA    #1AYNA           User Id
     C                     MOVELBEA0NA    #1A0NA           Job Name
     C                     Z-ADDBEAXDT    #1AXDT           Job Date
     C                     Z-ADDBEAIC3    #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     Z-ADDBERMNB    #1RMNB           Load ID
     C                     Z-ADDBEC4NB    #1C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V1C4NB
     C                     MOVELBEGWST    #1GWST           Header Status
     C                     Z-ADDBEBKC7    #1BKC7           Ship To Custome
      * Clear external version also
     C                     MOVEL*BLANK    V1BKC7
     C                     MOVELBEBRTX    #1BRTX           Ship To Name
     C                     Z-ADDBEA0DT    #1A0DT           Order Date
      * Clear external version also
     C                     Z-ADD*ZERO     V1A0DT
     C                     Z-ADDBEGNDT    #1GNDT           Actual Shipped
      * Clear external version also
     C                     Z-ADD*ZERO     V1GNDT
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     Z-ADD*ZERO     #2AODT           Scheduled Ship
     C                     MOVEL*BLANK    #CAJCD           Warehouse Code
     C                     MOVEL*BLANK    #CO6NA           Warehouse Desc
     C                     Z-ADD*ZERO     #2AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V2AIC3
     C                     Z-ADDP1RMNB    #2RMNB           Load ID
     C                     Z-ADD*ZERO     #2C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V2C4NB
     C                     MOVEL*BLANK    #2GWST           Header Status
     C                     Z-ADD*ZERO     #2BKC7           Ship To Custome
      * Clear external version also
     C                     MOVEL*BLANK    V2BKC7
     C                     MOVEL*BLANK    #2BRTX           Ship To Name
     C                     Z-ADD*ZERO     #2A0DT           Order Date
      * Clear external version also
     C                     Z-ADD*ZERO     V2A0DT
     C                     Z-ADD*ZERO     #2GNDT           Actual Shipped
      * Clear external version also
     C                     Z-ADD*ZERO     V2GNDT
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1BKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1BKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Order Date to display format
      * Convert date
     C           1000000   ADD  #1A0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1A0DT
      * Convert Actual Shipped Date to display format
      * Convert date
     C           1000000   ADD  #1GNDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1GNDT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V2AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2BKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2BKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Order Date to display format
      * Convert date
     C           1000000   ADD  #2A0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2A0DT
      * Convert Actual Shipped Date to display format
      * Convert date
     C           1000000   ADD  #2GNDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2GNDT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Profile Model     RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVEL##USR     DRAJVN           User Profile Na
      * Establish starting position
     C           KRSSA     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0020           User Code Model
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRBUVN    WN0020           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv User Whs Access   RT - User Warehouse Access  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           L1AJVN           User Profile Na
     C                     KFLD           L1AJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0001    L1AJVN           User Profile Na
     C                     MOVELWL0002    L1AJCD           Warehouse Code
      * Establish starting position
     C           KRSSB     CHAIN@L1RESJ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2626' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0003           UWA Inventory T
     C                     MOVEL*BLANK    WL0004           UWA Lot Loc Tra
     C                     MOVEL*BLANK    WL0005           UWA Shipping Tr
     C                     MOVEL*BLANK    WL0006           UWA Cross Appli
     C                     MOVEL*BLANK    WL0007           UWA Unused Stat
     C                     MOVEL*BLANK    WL0008           UWA Unused Stat
     C                     MOVEL*BLANK    WL0009           UWA Unused Sts
     C                     MOVEL*BLANK    WL0010           UWA Unused Sts
     C                     MOVEL*BLANK    WL0011           UWA Unused Sts
     C                     MOVEL*BLANK    WL0012           UWA Unused Sts
     C                     MOVEL*BLANK    WL0013           UWA Unused Sts
     C                     MOVEL*BLANK    WL0014           UWA Unused Sts
     C                     MOVEL*BLANK    WL0015           UWA Unused Sts
     C                     MOVEL*BLANK    WL0016           UWA Unused Sts
     C                     MOVEL*BLANK    WL0017           UWA Unused Sts
     C                     MOVEL*BLANK    WL0018           UWA Unused Sts
     C                     MOVEL*BLANK    WL0019           UWA Unused Sts
     C                     MOVEL*BLANK    WL0020           UWA Unused Sts
     C                     MOVEL*BLANK    WL0021           UWA Unused Sts
     C                     MOVEL*BLANK    WL0022           Record Found US
     C                     MOVEL'N'       WL0022           Record Found US
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELL1UWAS    WL0003           UWA Inventory T
     C                     MOVELL1EPSX    WL0004           UWA Lot Loc Tra
     C                     MOVELL1EQSX    WL0005           UWA Shipping Tr
     C                     MOVELL1ERSX    WL0006           UWA Cross Appli
     C                     MOVELL1UWAT    WL0007           UWA Unused Stat
     C                     MOVELL1EKSX    WL0008           UWA Unused Stat
     C                     MOVELL1ECSX    WL0009           UWA Unused Sts
     C                     MOVELL1EDSX    WL0010           UWA Unused Sts
     C                     MOVELL1EESX    WL0011           UWA Unused Sts
     C                     MOVELL1EFSX    WL0012           UWA Unused Sts
     C                     MOVELL1EGSX    WL0013           UWA Unused Sts
     C                     MOVELL1EHSX    WL0014           UWA Unused Sts
     C                     MOVELL1EISX    WL0015           UWA Unused Sts
     C                     MOVELL1EJSX    WL0016           UWA Unused Sts
     C                     MOVELL1UWAU    WL0017           UWA Unused Sts
     C                     MOVELL1ELSX    WL0018           UWA Unused Sts
     C                     MOVELL1EMSX    WL0019           UWA Unused Sts
     C                     MOVELL1ENSX    WL0020           UWA Unused Sts
     C                     MOVELL1EOSX    WL0021           UWA Unused Sts
     C                     MOVEL'Y'       WL0022           Record Found US
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Live w/CT LD/ORD  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#CAJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSC     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           WHS Live with C
     C                     MOVEL*BLANK    YL0002           WHS PFS Interfa
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADRRSX    YL0001           WHS Live with C
     C                     MOVELADRSSX    YL0002           WHS PFS Interfa
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Sel Order by Whs      RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WUEASX           Whs Ord Found S
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSD01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSD02           Order Number
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQSD01           Company Number
     C                     Z-ADD#1C4NB    WQSD02           Order Number
      * Establish starting position
     C           KRSSD     SETLL@BGWKL1                    *
     C           KRSSD     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           OMGMST    IFEQ 'L'                        *IF
     C           OMGMST    OREQ 'A'
     C           OMGMST    OREQ 'C'
     C           OMGMST    OREQ 'R'
     C           OMGMST    OREQ 'E'
     C           OMGMST    OREQ 'H'
     C           OMGMST    OREQ 'I'
      * CASE: PAR.Warehouse Code EQ DB1.Warehouse Code
     C           #CAJCD    IFEQ OMAJCD                     *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     MOVEL'Y'       WUEASX           Whs Ord Found S
     C                     GOTO SDEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSD     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Whse Descrip       RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WAAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#CAJCD    WAAJCD           Warehouse Code
      * Establish starting position
     C           KRSSE     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #CO6NA           Warehouse Descr
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWAF8NA    #CO6NA           Warehouse Descr
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Delete Ship Event  RT - Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN EYAIC3    WQSF01           Company Number
     C           *LIKE     DEFN EYC4NB    WQSF02           Order Number
     C           *LIKE     DEFN EYJPCD    WQSF03           Event Code
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Order Number
     C                     KFLD           WQSF03           Event Code
      * Setup key
     C                     Z-ADD#1AIC3    WQSF01           Company Number
     C                     Z-ADD#1C4NB    WQSF02           Order Number
     C                     MOVEL'04'      WQSF03           Event Code
      * Establish starting position
     C           KRSSF     SETLL@EYCPZE                    *
     C           KRSSF     READE@EYCPZE                  90*
      * Data record not found
     C   90                MOVEL'USR1074' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DEL Ship Event         DC - OP Order Events  * 
     C                     EXSR SGDLRC
     C           KRSSF     READE@EYCPZE                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGDLRC    BEGSR
      *================================================================
      * DEL Ship Event         DC - OP Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @EYCPY3
     C                     Z-ADDEYAIC3    WBAIC3           Company Number
     C                     Z-ADDEYC4NB    WBC4NB           Order Number
     C                     Z-ADDEYQ2NB    WBQ2NB           Event Number
      *
     C           KLDLSG    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
     C                     KFLD           WBQ2NB           Event Number
     C           KLDLSG    CHAIN@EYCPY3              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPEYCPL0'MDACP
     C                     MOVEL'@EYCPY3' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@EYCPY3                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Next Event Number  RT - Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSH01           Company Number
     C           *LIKE     DEFN WCC4NB    WQSH02           Order Number
      * Define keylist
     C           KPSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           Order Number
     C                     KFLD           WCQ2NB           Event Number
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQSH01           Company Number
     C                     Z-ADD#1C4NB    WQSH02           Order Number
     C                     Z-ADDWUQ2NB    WCQ2NB           Event Number
      * Establish starting position
     C           KPSSH     SETLL@EYCPY2                    *
     C           KRSSH     READE@EYCPY2                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1074' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WUQ2NB           Event Number
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWCQ2NB    WUQ2NB           Event Number
     C           KRSSH     READE@EYCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Event Code         RT - Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
     C                     KFLD           WCQ2NB           Event Number
      * Setup key
     C                     Z-ADD#1AIC3    WCAIC3           Company Number
     C                     Z-ADD#1C4NB    WCC4NB           Order Number
     C                     Z-ADDWUQ2NB    WCQ2NB           Event Number
      * Establish starting position
     C           KRSSI     SETGT@EYCPY2                91  *
     C                     READP@EYCPY2                9190*
      * Check high order keys
     C  N90      #1AIC3    IFNE WCAIC3                     Company Number
     C           #1C4NB    ORNE WCC4NB                     Order Number
     C                     SETON                     90
     C                     END
      *
      * Data record not found
     C   90                MOVEL'USR1074' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCJPCD    WUJPCD           Event Code
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * UPD Unship Ship Detail RT - Order Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0038  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0039  1        Price Audit
     C                     MOVEL*BLANK    WN0040  3        Price Audit Rea
     C                     Z-ADD*ZERO     WN0041 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0042 112       Weight Shipped
     C                     MOVEL*BLANK    WN0043  3        USR Warehouse C
     C                     MOVEL*BLANK    WN0044  1        Inter-Plant Tra
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSJ01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSJ02           Order Number
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQSJ01           Company Number
     C                     Z-ADD#1C4NB    WQSJ02           Order Number
      * Establish starting position
     C           KRSSJ     SETLL@BGWKL1                    *
     C           KRSSJ     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.Detail Line Status is Confirmed
      *   |- c2    : DB1.Item Code is Not Fuel Surcharge
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           OMGMST    IFEQ 'R'                        *IF
     C           OMHGCD    IFNE 99400                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVELOMGMST    WN0038           Detail Line Sta
     C                     MOVELOMU0ST    WN0039           Price Audit
     C                     MOVELOMRFCD    WN0040           Price Audit Rea
      * If qty and weight are zero then make price audit "N".
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Quantity Shipped Total is Equal to zero
      *   |- c2    : DB1.Weight Shipped Total is Equal to zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           OMCBQT    IFEQ 0                          *IF
     C           OMATWG    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       WN0039           Price Audit
     C                     MOVEL'SUB'     WN0040           Price Audit Rea
     C                     END                             *FI
      * Set Quantity/Weight shipped to 0 if this is a Plant order
      * CASE: PAR.Trans Contol AS400/Plant is Plant
     C           #1XUST    IFEQ 'P'                        *IF
     C                     Z-ADD*ZERO     WN0041           Quantity Shippe
     C                     Z-ADD*ZERO     WN0042           Weight Shipped
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDOMCBQT    WN0041           Quantity Shippe
     C                     Z-ADDOMATWG    WN0042           Weight Shipped
     C                     END                             *FI
      * Reverse Issue
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Quantity Shipped Total is not equal zero
      *   |- c2    : DB1.Weight Shipped Total is Not equal zero
      *   '-
     C           OMCBQT    IFNE 0                          *IF
     C           OMATWG    ORNE 0                          *OR
      * CASE: PAR.Billing Activity Type is Warehouse Transfer
     C           #1OBST    IFEQ '4'                        *IF
      * Rtv Default Warehouse  RT - Company Customer  * 
     C                     EXSR SKRVGN
      * 12/04/06 PKD Added Inter-Plant Transfer Processing.
      * Rtv Warehouse SHP     RT - Warehouse  * 
     C                     EXSR SLRVGN
      * Inter-Plant Transfer?
      * CASE:
      *  - c2 AND c3
      *   |- c2    : LCL.Warehouse Location is Internal (Plant)
      *   |- c3    : LCL.WHS Live w/Carlisle is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0008    IFEQ 'I'                        *IF
     C           YL0011    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WN0044           Inter-Plant Tra
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WN0044           Inter-Plant Tra
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WN0044           Inter-Plant Tra
     C                     END                             *FI
      * WI517 DN 10/04/23-Added 'Called From Program' as Input Parm.
      * - Added 'Send Email f/Failed API U' Output Parm.
      * UPD Inv From Unship    RT - Manifest Detail  * 
     C                     EXSR SMRVGN
      * WI517 DN 10/06/23-Set 'Send Email f/Failed API U' for Failed API
      * CASE: LCL.Send Email f/Failed API U is Yes
     C           YL0012    IFEQ 'Y'                        *IF
     C                     MOVELYL0012    YL0006           Send Email f/Fa
     C                     END                             *FI
     C                     END                             *FI
      * CHG for UnShip         CH - Order Detail  * 
     C                     EXSR SPCHRC
     C                     END                             *FI
     C           KRSSJ     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Default Warehouse  RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           EOAIC3           Company Number
     C                     KFLD           EOBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1AIC3    EOAIC3           Company Number
     C                     Z-ADD#1BKC7    EOBKC7           Ship To Custome
      * Establish starting position
     C           KRSSK     CHAIN@EOREXM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0043           Warehouse Code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELEOAJCD    WN0043           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Warehouse SHP     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWN0043    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSL     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0007           Trans Contol AS
     C                     MOVEL*BLANK    YL0008           Warehouse Locat
     C                     Z-ADD*ZERO     YL0009           Shipping Compan
     C                     Z-ADD*ZERO     YL0010           Accounting Comp
     C                     MOVEL*BLANK    YL0011           WHS Live with C
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADXUST    YL0007           Trans Contol AS
     C                     MOVELADT0ST    YL0008           Warehouse Locat
     C                     Z-ADDADBWC3    YL0009           Shipping Compan
     C                     Z-ADDADBTC3    YL0010           Accounting Comp
     C                     MOVELADRRSX    YL0011           WHS Live with C
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * UPD Inv From Unship    RT - Manifest Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0045  70       Label Date
     C                     Z-ADD*ZERO     WN0046  70       Production Date
     C                     Z-ADD*ZERO     WN0047 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0048 112       Weight Shipped
     C                     MOVEL*BLANK    WN0049  1        First Time Flag
     C                     Z-ADD*ZERO     WN0050 112       Weight Billed
     C                     MOVEL*BLANK    WN0051 30        Description
     C                     MOVEL*BLANK    WN0052  2        UOM Cost
     C                     MOVEL*BLANK    WN0053  1        Shift Number
     C                     MOVEL*BLANK    WN0054 30        Description Lin
     C                     MOVEL*BLANK    WN0055 30        Description Lin
     C                     MOVEL*BLANK    WN0056  2        UOM Primary
     C                     Z-ADD*ZERO     WN0057  94       Conversion Fact
     C                     MOVEL*BLANK    WN0058  1        Operation Facto
     C                     MOVEL*BLANK    WN0059  2        UOM Second
     C                     Z-ADD*ZERO     WN0060  94       Conversion Fact
     C                     MOVEL*BLANK    WN0061  1        Operation Facto
     C                     MOVEL*BLANK    WN0062  2        UOM Third
     C                     MOVEL*BLANK    WN0063  2        UOM Pricing
     C                     Z-ADD*ZERO     WN0064 112       Unit Weight
     C                     MOVEL*BLANK    WN0065  1        Production Date
     C                     MOVEL*BLANK    WN0066  1        Catch Weight St
     C                     Z-ADD*ZERO     WN0067  52       Fresh Chilling
     C                     Z-ADD*ZERO     WN0068 114       Cost based on U
     C                     Z-ADD*ZERO     WN0069 114       Cost based on U
     C                     Z-ADD*ZERO     WN0070 114       Cost based on U
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WN0049           First Time Flag
     C                     Z-ADD*ZERO     WN0047           Quantity Shippe
     C                     Z-ADD*ZERO     WN0048           Weight Shipped
     C                     Z-ADD*ZERO     WN0050           Weight Billed
     C                     MOVEL'1'       WN0053           Shift Number
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           YL0013    PARM *ZERO     WQ0009 155       Current System
     C           YL0014    PARM *ZERO     WQ0010 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     98    *
     C                     END
      * WI517 DN 10/04/23-Initialize Flags.
     C                     MOVEL'N'       YL0015           API was Called?
     C                     MOVEL'N'       YL0016           Inventory Updat
     C                     MOVEL'Y'       YL0017           First Time Thro
      * Declare restrictor key work fields
     C           *LIKE     DEFN FNAIC3    WQSM01           Company Number
     C           *LIKE     DEFN FNC4NB    WQSM02           Order Number
     C           *LIKE     DEFN FNDPNB    WQSM03           Order Sequence
     C           *LIKE     DEFN FNUENB    WQSM04           Order Secondary
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Order Number
     C                     KFLD           WQSM03           Order Sequence
     C                     KFLD           WQSM04           Order Secondary
      * Setup key
     C                     Z-ADDOMAIC3    WQSM01           Company Number
     C                     Z-ADDOMC4NB    WQSM02           Order Number
     C                     Z-ADDOMDPNB    WQSM03           Order Sequence
     C                     Z-ADDOMUENB    WQSM04           Order Secondary
      * Establish starting position
     C           KRSSM     SETLL@FNCPEZ                    *
     C           KRSSM     READE@FNCPEZ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1196' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0045           Label Date
     C                     Z-ADD*ZERO     WN0046           Production Date
     C                     Z-ADD*ZERO     WN0047           Quantity Shippe
     C                     Z-ADD*ZERO     WN0048           Weight Shipped
     C                     MOVEL*BLANK    WN0049           First Time Flag
     C                     Z-ADD*ZERO     WN0050           Weight Billed
     C                     MOVEL*BLANK    WN0051           Description
     C                     MOVEL*BLANK    WN0052           UOM Cost
     C                     MOVEL*BLANK    WN0053           Shift Number
     C                     MOVEL*BLANK    WN0054           Description Lin
     C                     MOVEL*BLANK    WN0055           Description Lin
     C                     MOVEL*BLANK    WN0056           UOM Primary
     C                     Z-ADD*ZERO     WN0057           Conversion Fact
     C                     MOVEL*BLANK    WN0058           Operation Facto
     C                     MOVEL*BLANK    WN0059           UOM Second
     C                     Z-ADD*ZERO     WN0060           Conversion Fact
     C                     MOVEL*BLANK    WN0061           Operation Facto
     C                     MOVEL*BLANK    WN0062           UOM Third
     C                     MOVEL*BLANK    WN0063           UOM Pricing
     C                     Z-ADD*ZERO     WN0064           Unit Weight
     C                     MOVEL*BLANK    WN0065           Production Date
     C                     MOVEL*BLANK    WN0066           Catch Weight St
     C                     Z-ADD*ZERO     WN0067           Fresh Chilling
     C                     Z-ADD*ZERO     WN0068           Cost based on U
     C                     Z-ADD*ZERO     WN0069           Cost based on U
     C                     Z-ADD*ZERO     WN0070           Cost based on U
     C                     MOVEL*BLANK    YL0012           Send Email f/Fa
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Set production date for break usage & rtv item info
      * CASE: PAR.First Time Flag is Yes
     C           WN0049    IFEQ 'Y'                        *IF
     C                     Z-ADDFNELDT    WN0046           Production Date
     C                     Z-ADDFNK7DT    WN0045           Label Date
      * Rtv Base Values        RT - Company/Item  * 
     C                     EXSR SNRVGN
      * Set unit of measure for cost
      * CASE: PAR.Catch Weight Status is yes
     C           WN0066    IFEQ 'Y'                        *IF
     C                     MOVEL'LB'      WN0052           UOM Cost
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWN0056    WN0052           UOM Cost
     C                     END                             *FI
     C                     MOVEL*BLANK    WUE7TX           Order Number Al
     C                     MOVELOMC4NB    WUE7TX           Order Number Al
     C                     MOVEL@CN,003   WUI6TX           Description 14A
     C                     Z-ADD1         ZQ      50
     C           WUI6TX    CAT  WUE7TX:ZQ WN0051    P      Description
     C                     MOVEL'N'       WN0049           First Time Flag
     C                     END                             *FI
      * When production date changes update inventory files
      * CASE: PAR.Production Date NE DB1.Production Date
     C           WN0046    IFNE FNELDT                     *IF
      * CASE: PAR.Billing Activity Type is Invoice
     C           #1OBST    IFEQ '1'                        *IF
      * 07/07/23 DN WI517-Added 'Upd Both Legacy & WIM USR=Y'.
      *   Added 'Inventory Updated USR', 'API was Called? U' &
      *   'Called From Program' Parms.
      * Upd Balances Issue/Adj XF - Item Balance  * 
     C                     CALL 'PDQRXFR'              90  Upd Balances Is
     C                     PARM *BLANK    W0RTN   7
     C                     PARM OMAIC3    WQ0011  30       Company Number
     C                     PARM OMHGCD    WQ0012  70       Item Code
     C                     PARM OMAJCD    WQ0013  3        Warehouse Code
     C                     PARM 'I'       WQ0014  1        Inventory Trans
     C                     PARM 'IO'      WQ0015  2        Inventory Trans
     C                     PARM YL0013    WQ0016  70       Transaction Dat
     C                     PARM WN0046    WQ0017  70       Production Date
     C                     PARM 'OP'      WQ0018  2        Item Transactio
     C                     PARM WN0051    WQ0019 30        Description
     C                     PARM *BLANK    WQ0020  3        Reason Code
     C                     PARM *BLANK    WQ0021 10        Lot ID
     C                     PARM OMC4NB    WQ0022  70       Order Number
     C                     PARM WN0053    WQ0023  1        Shift Number
     C                     PARM WN0045    WQ0024  70       Label Date
     C                     PARM WN0048    WQ0025 112       USR Weight Accu
     C                     PARM WN0047    WQ0026 112       Transaction Qty
     C                     PARM 'Y'       WQ0027  1        USR Unship Flag
     C                     PARM 'Y'       WQ0028  1        Upd Both Legacy
     C           YL0016    PARM *BLANK    WQ0029  1        Inventory Updat
     C           YL0015    PARM *BLANK    WQ0030  1        API was Called?
     C                     PARM @CN,002   WQ0031 10        Called From Pro
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * WI517 DN 10/04/23-Set 'Send Email f/Failed API U' for Failed API
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : LCL.API was Called? U is Yes
      *   |- c2    : LCL.Inventory Updated USR is No
      *   |- c3    : LCL.First Time Through USR is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0015    IFEQ 'Y'                        *IF
     C           YL0016    IFEQ 'N'                        *IF
     C           YL0017    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       YL0017           First Time Thro
     C                     MOVEL'Y'       YL0012           Send Email f/Fa
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Billing Activity Type is Warehouse Transfer
     C           #1OBST    IFEQ '4'                        *IF
      * WI517 DN 10/05/23-Added 'Inventory Updated USR', 'API was Called?
      *   & 'Called From Program' Parms.
      * Upd Balances Transfer  XF - Item Balance  * 
     C                     CALL 'PDQTXFR'              90  Upd Balances Tr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM OMAIC3    WQ0032  30       Company Number
     C                     PARM OMHGCD    WQ0033  70       Item Code
     C                     PARM OMAJCD    WQ0034  3        Warehouse Code
     C                     PARM 'T'       WQ0035  1        Inventory Trans
     C                     PARM 'TW'      WQ0036  2        Inventory Trans
     C                     PARM YL0013    WQ0037  70       Transaction Dat
     C                     PARM WN0046    WQ0038  70       Production Date
     C                     PARM 'OP'      WQ0039  2        Item Transactio
     C                     PARM WN0051    WQ0040 30        Description
     C                     PARM *BLANK    WQ0041  3        Reason Code
     C                     PARM OMC4NB    WQ0042  70       Order Number
     C                     PARM WN0053    WQ0043  1        Shift Number
     C                     PARM WN0045    WQ0044  70       Label Date
     C                     PARM WN0043    WQ0045  3        USR Warehouse C
     C                     PARM WN0048    WQ0046 112       USR Weight Accu
     C                     PARM WN0047    WQ0047 112       USR Quantity
     C                     PARM 'Y'       WQ0048  1        USR Unship Flag
     C                     PARM WN0044    WQ0049  1        Inter-Plant Tra
     C           YL0016    PARM *BLANK    WQ0050  1        Inventory Updat
     C           YL0015    PARM *BLANK    WQ0051  1        API was Called?
     C                     PARM @CN,002   WQ0052 10        Called From Pro
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * WI517 DN 10/05/23-Set 'Send Email f/Failed API U' for Failed API
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : LCL.API was Called? U is Yes
      *   |- c2    : LCL.Inventory Updated USR is No
      *   |- c3    : LCL.First Time Through USR is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0015    IFEQ 'Y'                        *IF
     C           YL0016    IFEQ 'N'                        *IF
     C           YL0017    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       YL0017           First Time Thro
     C                     MOVEL'Y'       YL0012           Send Email f/Fa
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDFNELDT    WN0046           Production Date
      * RTV Label Date         RT - Item Balance Detail  * 
     C                     EXSR SORVGN
      * If item bal detail doesn't exist, use manifest label date
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,004                    *IF
     C                     Z-ADDFNK7DT    WN0045           Label Date
     C                     END                             *FI
     C                     Z-ADD*ZERO     WN0047           Quantity Shippe
     C                     Z-ADD*ZERO     WN0048           Weight Shipped
     C                     END                             *FI
      * Add up quantity and weight for production date
     C                     ADD  FNFOQT    WN0047           Quantity Shippe
     C                     ADD  FNR0NB    WN0048           Weight Shipped
     C                     ADD  FNR0NB    WN0050           Weight Billed
     C           KRSSM     READE@FNCPEZ                  90*
     C                     ENDDO
      * USER: Exit processing
      * Update inventory for last production date read
      * CASE: PAR.Billing Activity Type is Invoice
     C           #1OBST    IFEQ '1'                        *IF
      * 07/07/23 DN WI517-Added 'Upd Both Legacy & WIM USR=Y'.
      *   Added 'Inventory Updated USR', 'API was Called? U' &
      *   'Called From Program' Parms.
      * Upd Balances Issue/Adj XF - Item Balance  * 
     C                     CALL 'PDQRXFR'              90  Upd Balances Is
     C                     PARM *BLANK    W0RTN   7
     C                     PARM OMAIC3    WQ0053  30       Company Number
     C                     PARM OMHGCD    WQ0054  70       Item Code
     C                     PARM OMAJCD    WQ0055  3        Warehouse Code
     C                     PARM 'I'       WQ0056  1        Inventory Trans
     C                     PARM 'IO'      WQ0057  2        Inventory Trans
     C                     PARM YL0013    WQ0058  70       Transaction Dat
     C                     PARM WN0046    WQ0059  70       Production Date
     C                     PARM 'OP'      WQ0060  2        Item Transactio
     C                     PARM WN0051    WQ0061 30        Description
     C                     PARM *BLANK    WQ0062  3        Reason Code
     C                     PARM *BLANK    WQ0063 10        Lot ID
     C                     PARM OMC4NB    WQ0064  70       Order Number
     C                     PARM WN0053    WQ0065  1        Shift Number
     C                     PARM WN0045    WQ0066  70       Label Date
     C                     PARM WN0048    WQ0067 112       USR Weight Accu
     C                     PARM WN0047    WQ0068 112       Transaction Qty
     C                     PARM 'Y'       WQ0069  1        USR Unship Flag
     C                     PARM 'Y'       WQ0070  1        Upd Both Legacy
     C           YL0016    PARM *BLANK    WQ0071  1        Inventory Updat
     C           YL0015    PARM *BLANK    WQ0072  1        API was Called?
     C                     PARM @CN,002   WQ0073 10        Called From Pro
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * WI517 DN 10/04/23-Set 'Send Email f/Failed API U' for Failed API
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : LCL.API was Called? U is Yes
      *   |- c2    : LCL.Inventory Updated USR is No
      *   |- c3    : LCL.First Time Through USR is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0015    IFEQ 'Y'                        *IF
     C           YL0016    IFEQ 'N'                        *IF
     C           YL0017    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       YL0017           First Time Thro
     C                     MOVEL'Y'       YL0012           Send Email f/Fa
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Billing Activity Type is Warehouse Transfer
     C           #1OBST    IFEQ '4'                        *IF
      * WI517 DN 10/05/23-Added 'Inventory Updated USR', 'API was Called?
      *   & 'Called From Program' Parms.
      * Upd Balances Transfer  XF - Item Balance  * 
     C                     CALL 'PDQTXFR'              90  Upd Balances Tr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM OMAIC3    WQ0074  30       Company Number
     C                     PARM OMHGCD    WQ0075  70       Item Code
     C                     PARM OMAJCD    WQ0076  3        Warehouse Code
     C                     PARM 'T'       WQ0077  1        Inventory Trans
     C                     PARM 'TW'      WQ0078  2        Inventory Trans
     C                     PARM YL0013    WQ0079  70       Transaction Dat
     C                     PARM WN0046    WQ0080  70       Production Date
     C                     PARM 'OP'      WQ0081  2        Item Transactio
     C                     PARM WN0051    WQ0082 30        Description
     C                     PARM *BLANK    WQ0083  3        Reason Code
     C                     PARM OMC4NB    WQ0084  70       Order Number
     C                     PARM WN0053    WQ0085  1        Shift Number
     C                     PARM WN0045    WQ0086  70       Label Date
     C                     PARM WN0043    WQ0087  3        USR Warehouse C
     C                     PARM WN0048    WQ0088 112       USR Weight Accu
     C                     PARM WN0047    WQ0089 112       USR Quantity
     C                     PARM 'Y'       WQ0090  1        USR Unship Flag
     C                     PARM WN0044    WQ0091  1        Inter-Plant Tra
     C           YL0016    PARM *BLANK    WQ0092  1        Inventory Updat
     C           YL0015    PARM *BLANK    WQ0093  1        API was Called?
     C                     PARM @CN,002   WQ0094 10        Called From Pro
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * WI517 DN 10/05/23-Set 'Send Email f/Failed API U' for Failed API
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : LCL.API was Called? U is Yes
      *   |- c2    : LCL.Inventory Updated USR is No
      *   |- c3    : LCL.First Time Through USR is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0015    IFEQ 'Y'                        *IF
     C           YL0016    IFEQ 'N'                        *IF
     C           YL0017    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       YL0017           First Time Thro
     C                     MOVEL'Y'       YL0012           Send Email f/Fa
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Base Values        RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADDOMAIC3    BZAIC3           Company Number
     C                     Z-ADDOMHGCD    BZHGCD           Item Code
      * Establish starting position
     C           KRSSN     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0054           Description Lin
     C                     MOVEL*BLANK    WN0055           Description Lin
     C                     MOVEL*BLANK    WN0056           UOM Primary
     C                     Z-ADD*ZERO     WN0057           Conversion Fact
     C                     MOVEL*BLANK    WN0058           Operation Facto
     C                     MOVEL*BLANK    WN0059           UOM Second
     C                     Z-ADD*ZERO     WN0060           Conversion Fact
     C                     MOVEL*BLANK    WN0061           Operation Facto
     C                     MOVEL*BLANK    WN0062           UOM Third
     C                     MOVEL*BLANK    WN0063           UOM Pricing
     C                     Z-ADD*ZERO     WN0064           Unit Weight
     C                     MOVEL*BLANK    WN0065           Production Date
     C                     MOVEL*BLANK    WN0066           Catch Weight St
     C                     Z-ADD*ZERO     WN0067           Fresh Chilling
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBZAVNA    WN0054           Description Lin
     C                     MOVELBZAWNA    WN0055           Description Lin
     C                     MOVELBZADCD    WN0056           UOM Primary
     C                     Z-ADDBZAWPC    WN0057           Conversion Fact
     C                     MOVELBZLXST    WN0058           Operation Facto
     C                     MOVELBZAECD    WN0059           UOM Second
     C                     Z-ADDBZAXPC    WN0060           Conversion Fact
     C                     MOVELBZLYST    WN0061           Operation Facto
     C                     MOVELBZAFCD    WN0062           UOM Third
     C                     MOVELBZAICD    WN0063           UOM Pricing
     C                     Z-ADDBZAIWG    WN0064           Unit Weight
     C                     MOVELBZFZST    WN0065           Production Date
     C                     MOVELBZAVST    WN0066           Catch Weight St
     C                     Z-ADDBZCHTM    WN0067           Fresh Chilling
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Label Date         RT - Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           B1AIC3           Company Number
     C                     KFLD           B1HGCD           Item Code
     C                     KFLD           B1AJCD           Warehouse Code
     C                     KFLD           B1ELDT           Production Date
      * Setup key
     C                     Z-ADDOMAIC3    B1AIC3           Company Number
     C                     Z-ADDOMHGCD    B1HGCD           Item Code
     C                     MOVELOMAJCD    B1AJCD           Warehouse Code
     C                     Z-ADDWN0046    B1ELDT           Production Date
      * Establish starting position
     C           KRSSO     CHAIN@B1REJ0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0330' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDB1K7DT    WN0045           Label Date
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCHRC    BEGSR
      *================================================================
      * CHG for UnShip         CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0071  70       Item Code
     C                     MOVEL*BLANK    WN0072  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0073  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0074  70       Order Group Cod
     C                     Z-ADD*ZERO     WN0075 112       Billing Detail
     C                     Z-ADD*ZERO     WN0076 112       Billing Detail
     C                     Z-ADD*ZERO     WN0077 112       Billing Detail
     C                     Z-ADD*ZERO     WN0078 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0079  1        Comment Print A
     C                     MOVEL*BLANK    WN0080  1        Comment Print I
     C                     MOVEL*BLANK    WN0081  1        Comment Print P
     C                     MOVEL*BLANK    WN0082  1        Comment Print S
     C                     Z-ADD*ZERO     WN0083 112       Extended Amount
     C                     Z-ADD*ZERO     WN0084  70       Market Pricing
     C                     MOVEL*BLANK    WN0085  3        Commodity Marke
     C                     MOVEL*BLANK    WN0086  3        Date Method Cod
     C                     MOVEL*BLANK    WN0087  3        Price Method Co
     C                     Z-ADD*ZERO     WN0088 114       Price Overage O
     C                     Z-ADD*ZERO     WN0089  70       Contract Number
     C                     MOVEL*BLANK    WN0090  1        Price Status
     C                     Z-ADD*ZERO     WN0091  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0092  2        U_M_Base Price
     C                     MOVEL*BLANK    WN0093  2        U_M_Ordered
     C                     MOVEL*BLANK    WN0094  1        Work Confirm St
     C                     MOVEL*BLANK    WN0095  1        Work Over_Short
     C                     MOVEL*BLANK    WN0096  1        OD Production P
     C                     MOVEL*BLANK    WN0097 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0098 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0099  1        Age Code
     C                     MOVEL*BLANK    WN0100  1        Palletize
     C                     MOVEL*BLANK    WN0101  1        Slip Sheet
     C                     MOVEL*BLANK    WN0102  1        Catch Weight St
     C                     MOVEL*BLANK    WN0103  1        Production Date
     C                     Z-ADD*ZERO     WN0104 112       Rated Freight
     C                     Z-ADD*ZERO     WN0105 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0106 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0107 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0108 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0109 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0110 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0111 114       Unit Price
     C                     Z-ADD*ZERO     WN0112 114       Unit Price_Cred
     C                     Z-ADD*ZERO     WN0113 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0114 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0115 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0116  70       Requested Ship
     C                     Z-ADD*ZERO     WN0117  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0118  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0119  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0120  30       Item Structure
     C                     Z-ADD*ZERO     WN0121  30       Item Structure
     C                     Z-ADD*ZERO     WN0122  30       Item Structure
     C                     MOVEL*BLANK    WN0123  2        Item Level
     C                     MOVEL*BLANK    WN0124  2        Quality Level
     C                     MOVEL*BLANK    WN0125  2        Pricing Product
     C                     MOVEL*BLANK    WN0126  2        Season Product
     C                     Z-ADD*ZERO     WN0127  70       Date of Origina
     C                     MOVEL*BLANK    WN0128 10        User Profile Na
     C                     MOVEL*BLANK    WN0129  6        Country Code
     C                     MOVEL*BLANK    WN0130  3        Reason Code
     C                     MOVEL*BLANK    WN0131  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0132  1        Modified Flag
     C                     MOVEL*BLANK    WN0133  1        Substituted Fla
     C                     MOVEL*BLANK    WN0134  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0135 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0136 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0137  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0138  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0139  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0140  1        Affect Commissi
     C                     MOVEL*BLANK    WN0141  1        Affect Pricing
     C                     MOVEL*BLANK    WN0142  1        Released by Use
     C                     MOVEL*BLANK    WN0143  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0144  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0145  3        Production Ware
     C                     MOVEL*BLANK    WN0146  3        OD Price Type
     C                     Z-ADD*ZERO     WN0147  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0148  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0149  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0150  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0151  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0152  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0153  60       Price Code
     C                     Z-ADD*ZERO     WN0154  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0155  60       Substitution Li
     C                     Z-ADD*ZERO     WN0156  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0157 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0158 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0159 112       OD Item Target
     C                     Z-ADD*ZERO     WN0160 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0161 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0162 114       Order Gate_Fina
     C                     Z-ADD*ZERO     WN0163 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0164 114       OD Gate_Final P
     C                     Z-ADD*ZERO     WN0165 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0166 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0167 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0168 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0169 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0170  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0171  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0172  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0173 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0174  40       Item Age Days
     C                     Z-ADD*ZERO     WN0175  70       Production Ovr
     C                     Z-ADD*ZERO     WN0176  70       Production Ovr
     C                     MOVEL*BLANK    WN0177  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0178  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0179  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0180  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0181  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0182  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0183  1        EDI Status 1
     C                     MOVEL*BLANK    WN0184  1        EDI Status 2
     C                     MOVEL*BLANK    WN0185  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0186  60       Job Time
     C                     MOVEL*BLANK    WN0187 10        User Id
     C                     MOVEL*BLANK    WN0188 10        Job Name
     C                     Z-ADD*ZERO     WN0189  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDOMAIC3    WDAIC3           Company Number
     C                     Z-ADDOMC4NB    WDC4NB           Order Number
     C                     Z-ADDOMDPNB    WDDPNB           Order Sequence
     C                     Z-ADDOMUENB    WDUENB           Order Secondary
      *
     C           KLCHSP    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
     C                     KFLD           WDDPNB           Order Sequence
     C                     KFLD           WDUENB           Order Secondary
     C           KLCHSP    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YARDCS
      * Move non-key fields to @BGWKL0
     C                     MOVEL'A'       WDGMST    P      Detail Line Sta
     C                     MOVELWN0038    WDGNST    P      Detail Line Sta
     C                     MOVELWN0039    WDU0ST    P      Price Audit
     C                     MOVELWN0040    WDRFCD    P      Price Audit Rea
     C                     Z-ADDWN0041    WDCBQT           Quantity Shippe
     C                     Z-ADDWN0042    WDATWG           Weight Shipped
     C                     Z-ADD*ZERO     WDGNDT           Actual Shipped
     C                     MOVELOMAMST    WDAMST    P      Affect Inventor
     C                     MOVELWUJPCD    WDJPCD    P      Event Code
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WDAATM' defaulted for 'Job Time'.
      * Field '(DB1) WDAYNA' defaulted for 'User Id'.
      * Field '(DB1) WDA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WDAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##JOB     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
     C                     MOVEL@CN,005   WDA0NA           Job Name
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Cnf Order Ship/Unship RT - Order Inv Allocation  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0190  70       Quantity Loc Tr
     C                     Z-ADD*ZERO     WN0191  70       Item Code
     C                     MOVEL*BLANK    WN0192  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0193  70       Production Date
     C                     Z-ADD*ZERO     WN0194  50       Lot Number
     C                     MOVEL*BLANK    WN0195  4        Location Code
     C                     Z-ADD*ZERO     WN0196  20       Location Level
     C                     Z-ADD*ZERO     WN0197  50       LLT Transaction
     C                     Z-ADD*ZERO     WN0198 112       LLT Transaction
     C                     Z-ADD*ZERO     WN0199 112       Weight Order 2
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       YL0018           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN L8AIC3    WQSQ01           Company Number
     C           *LIKE     DEFN L8C4NB    WQSQ02           Order Number
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           Company Number
     C                     KFLD           WQSQ02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQSQ01           Company Number
     C                     Z-ADD#1C4NB    WQSQ02           Order Number
      * Establish starting position
     C           KRSSQ     SETLL@L8CPZO                    *
     C           KRSSQ     READE@L8CPZO                  90*
      * Data record not found
     C   90                MOVEL'USR2640' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADD*ZERO     WN0190           Quantity Loc Tr
     C                     Z-ADD*ZERO     WN0199           Weight Order 2
      * 1ST:  First time process
      * CASE: LCL.First Time Flag is Yes
     C           YL0018    IFEQ 'Y'                        *IF
     C                     Z-ADDL8HGCD    WN0191           Item Code
     C                     MOVELL8AJCD    WN0192           Warehouse Code
     C                     Z-ADDL8ELDT    WN0193           Production Date
     C                     Z-ADDL8LXNM    WN0194           Lot Number
     C                     MOVELL8YMCD    WN0195           Location Code
     C                     Z-ADDL8YNCD    WN0196           Location Level
     C                     MOVEL'N'       YL0018           First Time Flag
     C                     END                             *FI
      * CHG: Item, Whs, PDte, Lot, Loc, Level
      * CASE: CHG: Item, Whs, PDte, Lot, Loc, Level
      *  - c1 OR c2 OR c3 OR c4 OR c5 OR c6
      *   |- c1    : PAR.Item Code NE DB1.Item Code
      *   |- c2    : PAR.Warehouse Code NE DB1.Warehouse Code
      *   |- c3    : PAR.Production Date NE DB1.Production Date
      *   |- c4    : PAR.Lot Number NE DB1.Lot Number
      *   |- c5    : PAR.Location Code NE DB1.Location Code
      *   |- c6    : PAR.Location Level NE DB1.Location Level
      *   '-
     C           WN0191    IFNE L8HGCD                     *IF
     C           WN0192    ORNE L8AJCD                     *OR
     C           WN0193    ORNE L8ELDT                     *OR
     C           WN0194    ORNE L8LXNM                     *OR
     C           WN0195    ORNE L8YMCD                     *OR
     C           WN0196    ORNE L8YNCD                     *OR
      * CASE: PAR.LLT Trans Qty is NE Zero
     C           WN0197    IFNE 0                          *IF
      *
     C                     Z-ADD*ZERO     WN0200  30       LLT Sequence Nu
     C                     MOVEL*BLANK    WN0201  1        EDI Status 1
     C                     MOVEL*BLANK    WN0202  1        EDI Status 2
     C                     MOVEL*BLANK    WN0203  1        EDI Status 3
     C                     MOVEL*BLANK    WN0204  1        Record Status
     C                     Z-ADD*ZERO     WN0205  60       Job Time
     C                     MOVEL*BLANK    WN0206 10        User Id
     C                     MOVEL*BLANK    WN0207 10        Job Name
     C                     Z-ADD*ZERO     WN0208  70       Job Date
      *
      * Crt Item Lot/Loc Trns IF
      * Rtv Next Seq #        RT - IC Item Lot/Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDL8AIC3    WL0023           Company Number
     C                     Z-ADDWN0191    WL0024           Item Code
     C                     MOVELWN0192    WL0025    P      Warehouse Code
     C                     MOVEL'S'       WL0026    P      LLT Transaction
     C                     Z-ADD##JDT     WL0027           LLT Transaction
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0028    WN0200           LLT Sequence Nu
      * Crt Item Lot/Loc Trns CR - Item Lot Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDL8AIC3    WL0029           Company Number
     C                     Z-ADDWN0191    WL0030           Item Code
     C                     MOVELWN0192    WL0031    P      Warehouse Code
     C                     MOVEL'S'       WL0032    P      LLT Transaction
     C                     Z-ADD##JDT     WL0033           LLT Transaction
     C                     Z-ADDWN0200    WL0034           LLT Sequence Nu
     C                     Z-ADDWN0193    WL0035           LLT Production
     C                     Z-ADDWN0197    WL0036           LLT Transaction
     C                     Z-ADDWN0198    WL0037           LLT Transaction
     C                     Z-ADDWN0194    WL0038           LLT Lot Number
     C                     MOVELWN0195    WL0039    P      Location Code
     C                     Z-ADDWN0196    WL0040           LLT Location Le
     C                     MOVEL*BLANK    WL0041           Transfer Wareho
     C                     Z-ADD*ZERO     WL0042           LLT Transfer Lo
     C                     MOVEL*BLANK    WL0043           Transfer Locati
     C                     Z-ADD*ZERO     WL0044           LLT Transfer Lo
     C                     Z-ADDL8C4NB    WL0045           Order Number
     C                     MOVEL'P'       WL0046    P      LLT Status
     C                     MOVELWULLTU    WL0047    P      LTT Unused Sts
     C                     MOVELWULLYT    WL0048    P      LTT Unused Sts
     C                     MOVELWN0201    WL0049    P      EDI Status 1
     C                     MOVELWN0202    WL0050    P      EDI Status 2
     C                     MOVELWN0203    WL0051    P      EDI Status 3
     C                     MOVELWN0204    WL0052    P      Record Status
     C                     Z-ADDWN0205    WL0053           Job Time
     C                     MOVELWN0206    WL0054    P      User Id
     C                     MOVELWN0207    WL0055    P      Job Name
     C                     Z-ADDWN0208    WL0056           Job Date
     C                     EXSR SSCRRC
      * Upd Qty On-Hand,wgt   RT - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDL8AIC3    WL0057           Company Number
     C                     Z-ADDWN0191    WL0058           Item Code
     C                     MOVELWN0192    WL0059    P      Warehouse Code
     C                     Z-ADDWN0193    WL0060           Production Date
     C                     Z-ADDWN0194    WL0061           Lot Number
     C                     MOVELWN0195    WL0062    P      Location Code
     C                     Z-ADDWN0196    WL0063           Location Level
     C                     Z-ADDWN0197    WL0064           Quantity Loc Tr
     C                     Z-ADDWN0198    WL0065           Weight Order 2
     C                     EXSR STRVGN
     C                     END                             *FI
     C                     Z-ADDL8HGCD    WN0191           Item Code
     C                     MOVELL8AJCD    WN0192           Warehouse Code
     C                     Z-ADDL8ELDT    WN0193           Production Date
     C                     Z-ADDL8LXNM    WN0194           Lot Number
     C                     MOVELL8YMCD    WN0195           Location Code
     C                     Z-ADDL8YNCD    WN0196           Location Level
     C                     Z-ADD*ZERO     WN0197           LLT Transaction
     C                     Z-ADD*ZERO     WN0198           LLT Transaction
     C                     END                             *FI
      * PRC:  Accumulate Quantity
      * CASE: PAR.OIA Allocation Sts is Shipped
     C           'U'       IFEQ 'S'                        *IF
     C           L8J6QT    MULT -1        WN0190           Quantity Loc Tr
     C                     ADD  WN0190    WN0197           LLT Transaction
      * RMC 1/9/17 reduce weight too
     C           L8G9WG    MULT -1        WN0199           Weight Order 2
     C                     ADD  WN0199    WN0198           LLT Transaction
      * Chg Allocation Sts    CH - Order Inv Allocation  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDL8AIC3    WL0117           Company Number
     C                     Z-ADDL8C4NB    WL0118           Order Number
     C                     Z-ADDL8DPNB    WL0119           Order Sequence
     C                     Z-ADDL8UENB    WL0120           Order Secondary
     C                     Z-ADDL8ALSW    WL0121           Allocation Seq
     C                     MOVEL'U'       WL0122    P      OIA Allocation
     C                     EXSR TCCHRC
     C                     ELSE
      * CASE: PAR.OIA Allocation Sts is Unshipped
     C           'U'       IFEQ 'U'                        *IF
     C                     ADD  L8J6QT    WN0197           LLT Transaction
      * RMC 1/9/17 increase weight too
     C                     ADD  L8G9WG    WN0198           LLT Transaction
      * Chg Allocation Sts    CH - Order Inv Allocation  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDL8AIC3    WL0117           Company Number
     C                     Z-ADDL8C4NB    WL0118           Order Number
     C                     Z-ADDL8DPNB    WL0119           Order Sequence
     C                     Z-ADDL8UENB    WL0120           Order Secondary
     C                     Z-ADDL8ALSW    WL0121           Allocation Seq
     C                     MOVEL'U'       WL0122    P      OIA Allocation
     C                     EXSR TCCHRC
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSQ     READE@L8CPZO                  90*
     C                     ENDDO
      * USER: Exit processing
      * Do if qty> 0    ----RMC 2/15/06
      * CASE: PAR.LLT Trans Qty is NE Zero
     C           WN0197    IFNE 0                          *IF
      *
     C                     Z-ADD*ZERO     WN0281  30       LLT Sequence Nu
     C                     MOVEL*BLANK    WN0282  1        EDI Status 1
     C                     MOVEL*BLANK    WN0283  1        EDI Status 2
     C                     MOVEL*BLANK    WN0284  1        EDI Status 3
     C                     MOVEL*BLANK    WN0285  1        Record Status
     C                     Z-ADD*ZERO     WN0286  60       Job Time
     C                     MOVEL*BLANK    WN0287 10        User Id
     C                     MOVEL*BLANK    WN0288 10        Job Name
     C                     Z-ADD*ZERO     WN0289  70       Job Date
      *
      * Crt Item Lot/Loc Trns IF
      * Rtv Next Seq #        RT - IC Item Lot/Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDL8AIC3    WL0023           Company Number
     C                     Z-ADDWN0191    WL0024           Item Code
     C                     MOVELWN0192    WL0025    P      Warehouse Code
     C                     MOVEL'S'       WL0026    P      LLT Transaction
     C                     Z-ADD##JDT     WL0027           LLT Transaction
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0028    WN0281           LLT Sequence Nu
      * Crt Item Lot/Loc Trns CR - Item Lot Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDL8AIC3    WL0029           Company Number
     C                     Z-ADDWN0191    WL0030           Item Code
     C                     MOVELWN0192    WL0031    P      Warehouse Code
     C                     MOVEL'S'       WL0032    P      LLT Transaction
     C                     Z-ADD##JDT     WL0033           LLT Transaction
     C                     Z-ADDWN0281    WL0034           LLT Sequence Nu
     C                     Z-ADDWN0193    WL0035           LLT Production
     C                     Z-ADDWN0197    WL0036           LLT Transaction
     C                     Z-ADDWN0198    WL0037           LLT Transaction
     C                     Z-ADDWN0194    WL0038           LLT Lot Number
     C                     MOVELWN0195    WL0039    P      Location Code
     C                     Z-ADDWN0196    WL0040           LLT Location Le
     C                     MOVEL*BLANK    WL0041           Transfer Wareho
     C                     Z-ADD*ZERO     WL0042           LLT Transfer Lo
     C                     MOVEL*BLANK    WL0043           Transfer Locati
     C                     Z-ADD*ZERO     WL0044           LLT Transfer Lo
     C                     Z-ADDL8C4NB    WL0045           Order Number
     C                     MOVEL'P'       WL0046    P      LLT Status
     C                     MOVELWULLTU    WL0047    P      LTT Unused Sts
     C                     MOVELWULLYT    WL0048    P      LTT Unused Sts
     C                     MOVELWN0282    WL0049    P      EDI Status 1
     C                     MOVELWN0283    WL0050    P      EDI Status 2
     C                     MOVELWN0284    WL0051    P      EDI Status 3
     C                     MOVELWN0285    WL0052    P      Record Status
     C                     Z-ADDWN0286    WL0053           Job Time
     C                     MOVELWN0287    WL0054    P      User Id
     C                     MOVELWN0288    WL0055    P      Job Name
     C                     Z-ADDWN0289    WL0056           Job Date
     C                     EXSR SSCRRC
      * Upd Qty On-Hand,wgt   RT - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDL8AIC3    WL0057           Company Number
     C                     Z-ADDWN0191    WL0058           Item Code
     C                     MOVELWN0192    WL0059    P      Warehouse Code
     C                     Z-ADDWN0193    WL0060           Production Date
     C                     Z-ADDWN0194    WL0061           Lot Number
     C                     MOVELWN0195    WL0062    P      Location Code
     C                     Z-ADDWN0196    WL0063           Location Level
     C                     Z-ADDWN0197    WL0064           Quantity Loc Tr
     C                     Z-ADDWN0198    WL0065           Weight Order 2
     C                     EXSR STRVGN
     C                     END                             *FI
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv Next Seq #        RT - IC Item Lot/Loc Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN L7AIC3    WQSR01           Company Number
     C           *LIKE     DEFN L7HGCD    WQSR02           Item Code
     C           *LIKE     DEFN L7AJCD    WQSR03           Warehouse Code
     C           *LIKE     DEFN L7LTRT    WQSR04           LLT Transaction
     C           *LIKE     DEFN L7LRDT    WQSR05           LLT Transaction
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           Company Number
     C                     KFLD           WQSR02           Item Code
     C                     KFLD           WQSR03           Warehouse Code
     C                     KFLD           WQSR04           LLT Transaction
     C                     KFLD           WQSR05           LLT Transaction
      * Setup key
     C                     Z-ADDWL0023    WQSR01           Company Number
     C                     Z-ADDWL0024    WQSR02           Item Code
     C                     MOVELWL0025    WQSR03           Warehouse Code
     C                     MOVELWL0026    WQSR04           LLT Transaction
     C                     Z-ADDWL0027    WQSR05           LLT Transaction
      * Establish starting position
     C           KRSSR     SETLL@L7CPUK                    *
     C           KRSSR     READE@L7CPUK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2638' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WL0028           LLT Sequence Nu
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           L7LLTS    ADD  1         WL0028           LLT Sequence Nu
     C                     GOTO SREXIT                     *QUIT
     C           KRSSR     READE@L7CPUK                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCRRC    BEGSR
      *================================================================
      * Crt Item Lot/Loc Trns CR - Item Lot Loc Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @L7CPS3
     C                     Z-ADDWL0029    WEAIC3           Company Number
     C                     Z-ADDWL0030    WEHGCD           Item Code
     C                     MOVELWL0031    WEAJCD           Warehouse Code
     C                     MOVELWL0032    WELTRT           LLT Transaction
     C                     Z-ADDWL0033    WELRDT           LLT Transaction
     C                     Z-ADDWL0034    WELLTS           LLT Sequence Nu
     C                     Z-ADDWL0035    WELSDT           LLT Production
     C                     Z-ADDWL0036    WEJ5QT           LLT Transaction
     C                     Z-ADDWL0037    WEG8WG           LLT Transaction
     C                     Z-ADDWL0038    WELLTN           LLT Lot Number
     C                     MOVELWL0039    WEYMCD           Location Code
     C                     Z-ADDWL0040    WELLCL           LLT Location Le
     C                     MOVELWL0041    WEBNAA           Transfer Wareho
     C                     Z-ADDWL0042    WELLTR           LLT Transfer Lo
     C                     MOVELWL0043    WEY2CD           Transfer Locati
     C                     Z-ADDWL0044    WELLTL           LLT Transfer Lo
     C                     Z-ADDWL0045    WEC4NB           Order Number
     C                     MOVELWL0046    WELOST           LLT Status
     C                     MOVELWL0047    WELLTU           LTT Unused Sts
     C                     MOVELWL0048    WELLYT           LTT Unused Sts
     C                     MOVELWL0049    WEUVST           EDI Status 1
     C                     MOVELWL0050    WEUWST           EDI Status 2
     C                     MOVELWL0051    WEUXST           EDI Status 3
     C                     MOVELWL0052    WEVSST           Record Status
     C                     Z-ADDWL0053    WEAATM           Job Time
     C                     MOVELWL0054    WEAYNA           User Id
     C                     MOVELWL0055    WEA0NA           Job Name
     C                     Z-ADDWL0056    WEAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WEVSST           Record Status
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##PGM     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
     C           KLCRSS    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEHGCD           Item Code
     C                     KFLD           WEAJCD           Warehouse Code
     C                     KFLD           WELTRT           LLT Transaction
     C                     KFLD           WELRDT           LLT Transaction
     C                     KFLD           WELLTS           LLT Sequence Nu
      * Check for duplicate primary key
     C           KLCRSS    SETLL@L7CPS3                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2639' W0RTN   7
      * Send message 'Item Lot Loc Trans     EX'
     C                     MOVEL'USR2639' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C                     WRITE@L7CPS3                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Upd Qty On-Hand,wgt   RT - Item Lot Location  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0209  50       ILL Item Qty On
     C                     Z-ADD*ZERO     WN0210 112       ILL Unit Weight
     C                     Z-ADD*ZERO     WN0211  50       ILL Co-Packer L
     C                     Z-ADD*ZERO     WN0212 112       ILL Item Wgt On
     C                     Z-ADD*ZERO     WN0213  50       ILL Unused Qty
     C                     Z-ADD*ZERO     WN0214 112       ILL Unused Wgt
     C                     Z-ADD*ZERO     WN0215  70       ILL Avail Ship
     C                     Z-ADD*ZERO     WN0216  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0217  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0218  72       ILL Unused Nbr
     C                     MOVEL*BLANK    WN0219  6        ILL Customer Co
     C                     MOVEL*BLANK    WN0220  1        ILL Status
     C                     MOVEL*BLANK    WN0221  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0222  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0223  2        ILL Unused Sts
     C                     MOVEL*BLANK    WN0224  3        Inv Hold Reason
     C                     MOVEL*BLANK    WN0225  1        EDI Status 1
     C                     MOVEL*BLANK    WN0226  1        EDI Status 2
     C                     MOVEL*BLANK    WN0227  1        EDI Status 3
     C                     MOVEL*BLANK    WN0228  1        Record Status
     C                     Z-ADD*ZERO     WN0229  60       Job Time
     C                     MOVEL*BLANK    WN0230 10        User Id
     C                     MOVEL*BLANK    WN0231 10        Job Name
     C                     Z-ADD*ZERO     WN0232  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           L5AIC3           Company Number
     C                     KFLD           L5HGCD           Item Code
     C                     KFLD           L5AJCD           Warehouse Code
     C                     KFLD           L5ELDT           Production Date
     C                     KFLD           L5LXNM           Lot Number
     C                     KFLD           L5YMCD           Location Code
     C                     KFLD           L5YNCD           Location Level
      * Setup key
     C                     Z-ADDWL0057    L5AIC3           Company Number
     C                     Z-ADDWL0058    L5HGCD           Item Code
     C                     MOVELWL0059    L5AJCD           Warehouse Code
     C                     Z-ADDWL0060    L5ELDT           Production Date
     C                     Z-ADDWL0061    L5LXNM           Lot Number
     C                     MOVELWL0062    L5YMCD           Location Code
     C                     Z-ADDWL0063    L5YNCD           Location Level
      * Establish starting position
     C           KRSST     CHAIN@L5CPSV              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2634' W0RTN   7
      * USER: Processing if Data record not found
      *
     C                     MOVEL*BLANK    WN0233  1        WLT Type Code
     C                     Z-ADD*ZERO     WN0234  52       WLT Type Chill
      *
      * Clc Loc Avail Shp Dte IF
      * Rtv Loc Type          RT - Warehouse Location  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWL0059    WL0066    P      Warehouse Code
     C                     MOVELWL0062    WL0067    P      Location Code
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0068    WN0233    P      WLT Type Code
      * Rtv Chill Time        RT - Warehouse Location Type  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0233    WL0069    P      WLT Type Code
     C                     EXSR SVRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0070    WN0234           WLT Type Chill
      * PAR.ILL Avail Ship Date = PAR.Production Date + PAR.WLT Type Chil
     C           WL0060    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN0234    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0215
     C                     ELSE
     C           XDINDT    SUB  1000000   WN0215
     C                     END
      * RTV Unit Weight        RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0057    WL0071           Company Number
     C                     Z-ADDWL0058    WL0072           Item Code
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0073    WN0210           Unit Weight
     C                     MOVELWL0074    YL0019    P      Quality Level
      * Crt Item Loc          CR - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0057    WL0075           Company Number
     C                     Z-ADDWL0058    WL0076           Item Code
     C                     MOVELWL0059    WL0077    P      Warehouse Code
     C                     Z-ADDWL0060    WL0078           Production Date
     C                     Z-ADDWL0061    WL0079           Lot Number
     C                     MOVELWL0062    WL0080    P      Location Code
     C                     Z-ADDWL0063    WL0081           Location Level
     C                     Z-ADDWL0064    WL0082           ILL Item Qty On
     C                     Z-ADDWN0210    WL0083           ILL Unit Weight
     C                     Z-ADDWN0211    WL0084           ILL Co-Packer L
     C                     Z-ADDWN0212    WL0085           ILL Item Wgt On
     C                     Z-ADDWN0213    WL0086           ILL Unused Qty
     C                     Z-ADDWN0214    WL0087           ILL Unused Wgt
     C                     Z-ADDWN0215    WL0088           ILL Avail Ship
     C                     Z-ADDWN0216    WL0089           ILL Unused Date
     C                     Z-ADDWN0217    WL0090           ILL Unused Date
     C                     Z-ADDWN0218    WL0091           ILL Unused Nbr
     C                     MOVELWN0219    WL0092    P      ILL Customer Co
     C                     MOVEL'A'       WL0093    P      ILL Status
     C                     MOVELWN0221    WL0094    P      ILL Unused Sts
     C                     MOVELWN0222    WL0095    P      ILL Unused Sts
     C                     MOVELWN0223    WL0096    P      ILL Unused Sts
     C                     MOVELWN0224    WL0097    P      Inv Hold Reason
     C                     MOVELWN0225    WL0098    P      EDI Status 1
     C                     MOVELWN0226    WL0099    P      EDI Status 2
     C                     MOVELWN0227    WL0100    P      EDI Status 3
     C                     MOVELWN0228    WL0101    P      Record Status
     C                     Z-ADDWN0229    WL0102           Job Time
     C                     MOVELWN0230    WL0103    P      User Id
     C                     MOVELWN0231    WL0104    P      Job Name
     C                     Z-ADDWN0232    WL0105           Job Date
     C                     EXSR SXCRRC
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           L5J2QT    ADD  WL0064    WN0209           ILL Item Qty On
     C           L5G6WG    ADD  WL0065    WN0212           ILL Item Wgt On
      * CASE: PAR.ILL Item Qty On-Hand is GT Zero
     C           WN0209    IFGT 0                          *IF
      * Chg Quantity On-Hn,wg CH - Item Lot Location  * 
     C                     EXSR SYCHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Del Item Location     DL - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDL5AIC3    WL0106           Company Number
     C                     Z-ADDL5HGCD    WL0107           Item Code
     C                     MOVELL5AJCD    WL0108    P      Warehouse Code
     C                     Z-ADDL5ELDT    WL0109           Production Date
     C                     Z-ADDL5LXNM    WL0110           Lot Number
     C                     MOVELL5YMCD    WL0111    P      Location Code
     C                     Z-ADDL5YNCD    WL0112           Location Level
     C                     EXSR SZDLRC
      * Del Item Balance Dtl  RT - Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDL5AIC3    WL0113           Company Number
     C                     Z-ADDL5HGCD    WL0114           Item Code
     C                     MOVELL5AJCD    WL0115    P      Warehouse Code
     C                     Z-ADDL5ELDT    WL0116           Production Date
     C                     EXSR TARVGN
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Rtv Loc Type          RT - Warehouse Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           L2AJCD           Warehouse Code
     C                     KFLD           L2YMCD           Location Code
      * Setup key
     C                     MOVELWL0066    L2AJCD           Warehouse Code
     C                     MOVELWL0067    L2YMCD           Location Code
      * Establish starting position
     C           KRSSU     CHAIN@L2RESM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2628' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0068           WLT Type Code
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELL2AGSX    WL0068           WLT Type Code
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Rtv Chill Time        RT - Warehouse Location Type  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           MEAGSX           WLT Type Code
      * Setup key
     C                     MOVELWL0069    MEAGSX           WLT Type Code
      * Establish starting position
     C           KRSSV     CHAIN@L3RET8              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2660' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0070           WLT Type Chill
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDMESLTY    WL0070           WLT Type Chill
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * RTV Unit Weight        RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0071    BZAIC3           Company Number
     C                     Z-ADDWL0072    BZHGCD           Item Code
      * Establish starting position
     C           KRSSW     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0073           Unit Weight
     C                     MOVEL*BLANK    WL0074           Quality Level
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBZAIWG    WL0073           Unit Weight
     C                     MOVELBZHICD    WL0074           Quality Level
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXCRRC    BEGSR
      *================================================================
      * Crt Item Loc          CR - Item Lot Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @L5CPSL
     C                     Z-ADDWL0075    WFAIC3           Company Number
     C                     Z-ADDWL0076    WFHGCD           Item Code
     C                     MOVELWL0077    WFAJCD           Warehouse Code
     C                     Z-ADDWL0078    WFELDT           Production Date
     C                     Z-ADDWL0079    WFLXNM           Lot Number
     C                     MOVELWL0080    WFYMCD           Location Code
     C                     Z-ADDWL0081    WFYNCD           Location Level
     C                     Z-ADDWL0082    WFJ2QT           ILL Item Qty On
     C                     Z-ADDWL0083    WFG5WG           ILL Unit Weight
     C                     Z-ADDWL0084    WFJ3QT           ILL Co-Packer L
     C                     Z-ADDWL0085    WFG6WG           ILL Item Wgt On
     C                     Z-ADDWL0086    WFJ4QT           ILL Unused Qty
     C                     Z-ADDWL0087    WFG7WG           ILL Unused Wgt
     C                     Z-ADDWL0088    WFLODT           ILL Avail Ship
     C                     Z-ADDWL0089    WFLPDT           ILL Unused Date
     C                     Z-ADDWL0090    WFLQDT           ILL Unused Date
     C                     Z-ADDWL0091    WFNBR            ILL Unused Nbr
     C                     MOVELWL0092    WFYTCD           ILL Customer Co
     C                     MOVELWL0093    WFAMSX           ILL Status
     C                     MOVELWL0094    WFASSX           ILL Unused Sts
     C                     MOVELWL0095    WFATSX           ILL Unused Sts
     C                     MOVELWL0096    WFAUSX           ILL Unused Sts
     C                     MOVELWL0097    WFYSCD           Inv Hold Reason
     C                     MOVELWL0098    WFUVST           EDI Status 1
     C                     MOVELWL0099    WFUWST           EDI Status 2
     C                     MOVELWL0100    WFUXST           EDI Status 3
     C                     MOVELWL0101    WFVSST           Record Status
     C                     Z-ADDWL0102    WFAATM           Job Time
     C                     MOVELWL0103    WFAYNA           User Id
     C                     MOVELWL0104    WFA0NA           Job Name
     C                     Z-ADDWL0105    WFAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WFVSST           Record Status
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##PGM     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
     C           KLCRSX    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFHGCD           Item Code
     C                     KFLD           WFAJCD           Warehouse Code
     C                     KFLD           WFELDT           Production Date
     C                     KFLD           WFLXNM           Lot Number
     C                     KFLD           WFYMCD           Location Code
     C                     KFLD           WFYNCD           Location Level
      * Check for duplicate primary key
     C           KLCRSX    SETLL@L5CPSL                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2635' W0RTN   7
      * Send message 'Item Lot Location      EX'
     C                     MOVEL'USR2635' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C                     WRITE@L5CPSL                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYCHRC    BEGSR
      *================================================================
      * Chg Quantity On-Hn,wg CH - Item Lot Location  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0235 112       ILL Unit Weight
     C                     Z-ADD*ZERO     WN0236  50       ILL Co-Packer L
     C                     Z-ADD*ZERO     WN0237  50       ILL Unused Qty
     C                     Z-ADD*ZERO     WN0238 112       ILL Unused Wgt
     C                     Z-ADD*ZERO     WN0239  70       ILL Avail Ship
     C                     Z-ADD*ZERO     WN0240  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0241  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0242  72       ILL Unused Nbr
     C                     MOVEL*BLANK    WN0243  6        ILL Customer Co
     C                     MOVEL*BLANK    WN0244  1        ILL Status
     C                     MOVEL*BLANK    WN0245  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0246  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0247  2        ILL Unused Sts
     C                     MOVEL*BLANK    WN0248  3        Inv Hold Reason
     C                     MOVEL*BLANK    WN0249  1        EDI Status 1
     C                     MOVEL*BLANK    WN0250  1        EDI Status 2
     C                     MOVEL*BLANK    WN0251  1        EDI Status 3
     C                     MOVEL*BLANK    WN0252  1        Record Status
     C                     Z-ADD*ZERO     WN0253  60       Job Time
     C                     MOVEL*BLANK    WN0254 10        User Id
     C                     MOVEL*BLANK    WN0255 10        Job Name
     C                     Z-ADD*ZERO     WN0256  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @L5CPSL
     C                     Z-ADDL5AIC3    WFAIC3           Company Number
     C                     Z-ADDL5HGCD    WFHGCD           Item Code
     C                     MOVELL5AJCD    WFAJCD    P      Warehouse Code
     C                     Z-ADDL5ELDT    WFELDT           Production Date
     C                     Z-ADDL5LXNM    WFLXNM           Lot Number
     C                     MOVELL5YMCD    WFYMCD    P      Location Code
     C                     Z-ADDL5YNCD    WFYNCD           Location Level
      *
     C           KLCHSY    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFHGCD           Item Code
     C                     KFLD           WFAJCD           Warehouse Code
     C                     KFLD           WFELDT           Production Date
     C                     KFLD           WFLXNM           Lot Number
     C                     KFLD           WFYMCD           Location Code
     C                     KFLD           WFYNCD           Location Level
     C           KLCHSY    CHAIN@L5CPSL              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDL5CPL0'MDACP
     C                     MOVEL'@L5CPSL' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SYEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDL51    YBRDCS
      * Move non-key fields to @L5CPSL
     C                     Z-ADDWN0209    WFJ2QT           ILL Item Qty On
     C                     Z-ADDWN0212    WFG6WG           ILL Item Wgt On
      *
      * Set PGM.*Record Data Changed flag
     C           QPDL51    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##PGM     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDL51    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@L5CPSL                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDL5CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZDLRC    BEGSR
      *================================================================
      * Del Item Location     DL - Item Lot Location  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0257  50       ILL Item Qty On
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @L5CPSL
     C                     Z-ADDWL0106    WFAIC3           Company Number
     C                     Z-ADDWL0107    WFHGCD           Item Code
     C                     MOVELWL0108    WFAJCD           Warehouse Code
     C                     Z-ADDWL0109    WFELDT           Production Date
     C                     Z-ADDWL0110    WFLXNM           Lot Number
     C                     MOVELWL0111    WFYMCD           Location Code
     C                     Z-ADDWL0112    WFYNCD           Location Level
      *
     C           KLDLSZ    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFHGCD           Item Code
     C                     KFLD           WFAJCD           Warehouse Code
     C                     KFLD           WFELDT           Production Date
     C                     KFLD           WFLXNM           Lot Number
     C                     KFLD           WFYMCD           Location Code
     C                     KFLD           WFYNCD           Location Level
     C           KLDLSZ    CHAIN@L5CPSL              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDL5CPL0'MDACP
     C                     MOVEL'@L5CPSL' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SZEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@L5CPSL                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * Del Item Balance Dtl  RT - Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           B1AIC3           Company Number
     C                     KFLD           B1HGCD           Item Code
     C                     KFLD           B1AJCD           Warehouse Code
     C                     KFLD           B1ELDT           Production Date
      * Setup key
     C                     Z-ADDWL0113    B1AIC3           Company Number
     C                     Z-ADDWL0114    B1HGCD           Item Code
     C                     MOVELWL0115    B1AJCD           Warehouse Code
     C                     Z-ADDWL0116    B1ELDT           Production Date
      * Establish starting position
     C           KRSTA     CHAIN@B1REJ0              90    *
      * Data record not found
     C   90                MOVEL'USR0330' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Quantity on Hand - U/M1 is Equal to zero
     C           B1ARQT    IFEQ 0                          *IF
      * Del Item Balance Dtl  DL - IC Item Balance Detail  * 
     C                     EXSR TBDLRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBDLRC    BEGSR
      *================================================================
      * Del Item Balance Dtl  DL - IC Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B1REJ1
     C                     Z-ADDB1AIC3    WGAIC3           Company Number
     C                     Z-ADDB1HGCD    WGHGCD           Item Code
     C                     MOVELB1AJCD    WGAJCD           Warehouse Code
     C                     Z-ADDB1ELDT    WGELDT           Production Date
      *
     C           KLDLTB    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGHGCD           Item Code
     C                     KFLD           WGAJCD           Warehouse Code
     C                     KFLD           WGELDT           Production Date
     C           KLDLTB    CHAIN@B1REJ1              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB1REL1'MDACP
     C                     MOVEL'@B1REJ1' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TBEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B1REJ1                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCCHRC    BEGSR
      *================================================================
      * Chg Allocation Sts    CH - Order Inv Allocation  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0258  50       OIA Alloc_Shipp
     C                     Z-ADD*ZERO     WN0259 112       OIA Alloc_Shipp
     C                     Z-ADD*ZERO     WN0260  50       OIA Co-Packer L
     C                     Z-ADD*ZERO     WN0261 112       OIA Serial Numb
     C                     MOVEL*BLANK    WN0262  1        OIA Create Sts
     C                     MOVEL*BLANK    WN0263  1        OIA Modified St
     C                     MOVEL*BLANK    WN0264  2        OIA Loc Pick St
     C                     MOVEL*BLANK    WN0265  1        OIA Unused Sts
     C                     MOVEL*BLANK    WN0266  2        OIA Unused Sts
     C                     Z-ADD*ZERO     WN0267  70       Item Code
     C                     MOVEL*BLANK    WN0268  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0269  70       Production Date
     C                     Z-ADD*ZERO     WN0270  50       Lot Number
     C                     MOVEL*BLANK    WN0271  4        Location Code
     C                     Z-ADD*ZERO     WN0272  20       Location Level
     C                     MOVEL*BLANK    WN0273  1        EDI Status 1
     C                     MOVEL*BLANK    WN0274  1        EDI Status 2
     C                     MOVEL*BLANK    WN0275  1        EDI Status 3
     C                     MOVEL*BLANK    WN0276  1        Record Status
     C                     Z-ADD*ZERO     WN0277  60       Job Time
     C                     MOVEL*BLANK    WN0278 10        User Id
     C                     MOVEL*BLANK    WN0279 10        Job Name
     C                     Z-ADD*ZERO     WN0280  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @L8CPSX
     C                     Z-ADDWL0117    WHAIC3           Company Number
     C                     Z-ADDWL0118    WHC4NB           Order Number
     C                     Z-ADDWL0119    WHDPNB           Order Sequence
     C                     Z-ADDWL0120    WHUENB           Order Secondary
     C                     Z-ADDWL0121    WHALSW           Allocation Seq
      *
     C           KLCHTC    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHC4NB           Order Number
     C                     KFLD           WHDPNB           Order Sequence
     C                     KFLD           WHUENB           Order Secondary
     C                     KFLD           WHALSW           Allocation Seq
     C           KLCHTC    CHAIN@L8CPSX              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDL8CPL0'MDACP
     C                     MOVEL'@L8CPSX' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDL81    YCRDCS
      * Move non-key fields to @L8CPSX
     C                     MOVELWL0122    WHSOAS    P      OIA Allocation
      *
      * Set PGM.*Record Data Changed flag
     C           QPDL81    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##PGM     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDL81    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@L8CPSX                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDL8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * DLT to Unship Mainfest RT - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIAIC3    WQTD01           Company Number
     C           *LIKE     DEFN WIC4NB    WQTD02           Order Number
      * Define keylist
     C           KPSTD     KLIST
     C                     KFLD           WQTD01           Company Number
     C                     KFLD           WQTD02           Order Number
     C                     KFLD           WIDPNB           Order Sequence
     C                     KFLD           WIUENB           Order Secondary
     C                     KFLD           WIRZNB           Case Sequence N
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WQTD01           Company Number
     C                     KFLD           WQTD02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQTD01           Company Number
     C                     Z-ADD#1C4NB    WQTD02           Order Number
     C                     Z-ADD*ZERO     WIDPNB           Order Sequence
     C                     Z-ADD*ZERO     WIUENB           Order Secondary
     C                     Z-ADD*ZERO     WIRZNB           Case Sequence N
      * Establish starting position
     C           KPSTD     SETLL@FNCPCT                    *
     C           KRSTD     READE@FNCPCT                  90*
      * Data record not found
     C   90                MOVEL'USR1196' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DLT Manifest Detail    DL - Manifest Detail  * 
     C                     EXSR TEDLRC
     C           KRSTD     READE@FNCPCT                  90*
     C                     ENDDO
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TEDLRC    BEGSR
      *================================================================
      * DLT Manifest Detail    DL - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @FNCPCS
     C                     Z-ADDWIAIC3    WJAIC3           Company Number
     C                     Z-ADDWIC4NB    WJC4NB           Order Number
     C                     Z-ADDWIDPNB    WJDPNB           Order Sequence
     C                     Z-ADDWIUENB    WJUENB           Order Secondary
     C                     Z-ADDWIRZNB    WJRZNB           Case Sequence N
      *
     C           KLDLTE    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJC4NB           Order Number
     C                     KFLD           WJDPNB           Order Sequence
     C                     KFLD           WJUENB           Order Secondary
     C                     KFLD           WJRZNB           Case Sequence N
     C           KLDLTE    CHAIN@FNCPCS              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFNCPL0'MDACP
     C                     MOVEL'@FNCPCS' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TEEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@FNCPCS                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * DBF delete successful
      * USER: Processing after Data update
     C                     MOVEL'Y'       WUR4ST           USR Update Flag
     C                     MOVEL'Y'       WURINS           COA RIN Modifie
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * UPD Unship Load Status RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSTF     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * 11/12/02  zero out actual ship date
      * CASE: DB1.Load Status is Shipped
     C           FJPKST    IFEQ 'S'                        *IF
      * CHG Load when UnshippedCH - Load Header  * 
     C                     EXSR TGCHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGCHRC    BEGSR
      *================================================================
      * CHG Load when UnshippedCH - Load Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0290  1        LTL Flag
     C                     Z-ADD*ZERO     WN0291  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0292 15        Seal 1
     C                     MOVEL*BLANK    WN0293 15        Seal 2
     C                     MOVEL*BLANK    WN0294 15        Seal 3
     C                     MOVEL*BLANK    WN0295 15        Seal 4
     C                     MOVEL*BLANK    WN0296 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0297  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0298 112       Flat Amount
     C                     MOVEL*BLANK    WN0299  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0300  50       Total Stops
     C                     MOVEL*BLANK    WN0301 20        Trailer Id
     C                     MOVEL*BLANK    WN0302  3        Transloader Car
     C                     Z-ADD*ZERO     WN0303  40       BOL Time
     C                     MOVEL*BLANK    WN0304  3        Carrier Code
     C                     MOVEL*BLANK    WN0305  7        Truck Size
     C                     Z-ADD*ZERO     WN0306  70       Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WN0307 112       Rated Freight
     C                     MOVEL*BLANK    WN0308  1        Ship Status
     C                     MOVEL*BLANK    WN0309  1        Load Type
     C                     Z-ADD*ZERO     WN0310  50       Number Pallets
     C                     Z-ADD*ZERO     WN0311  50       Number Pallets
     C                     Z-ADD*ZERO     WN0312 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0313  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0314  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0315  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0316 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0317 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0318  70       Actual Departur
     C                     Z-ADD*ZERO     WN0319  40       Departure Time
     C                     Z-ADD*ZERO     WN0320  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0321  52       Product Tempera
     C                     Z-ADD*ZERO     WN0322  50       Number Spacers
     C                     MOVEL*BLANK    WN0323 12        Car_Veh. Initia
     C                     Z-ADD*ZERO     WN0324  70       Total Load Mile
     C                     MOVEL*BLANK    WN0325 12        Recorder ID
     C                     MOVEL*BLANK    WN0326  2        Shipping Method
     C                     MOVEL*BLANK    WN0327  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0328  2        Ship To State C
     C                     Z-ADD*ZERO     WN0329  70       Gross Weight
     C                     MOVEL*BLANK    WN0330  3        Carrier Broker
     C                     MOVEL*BLANK    WN0331  1        Export Status
     C                     MOVEL*BLANK    WN0332  1        On Time (Y_N)
     C                     Z-ADD*ZERO     WN0333  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0334  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0335  70       Spotted Date
     C                     Z-ADD*ZERO     WN0336  60       Spotted Time
     C                     Z-ADD*ZERO     WN0337  70       Load Finished D
     C                     Z-ADD*ZERO     WN0338  60       Load Finished T
     C                     Z-ADD*ZERO     WN0339  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0340  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0341  70       Truck Departure
     C                     Z-ADD*ZERO     WN0342  60       Truck Departure
     C                     Z-ADD*ZERO     WN0343  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0344  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0345  3        Shipping Line
     C                     MOVEL*BLANK    WN0346 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0347 30        Vessel Name
     C                     Z-ADD*ZERO     WN0348  50       Voyage
     C                     Z-ADD*ZERO     WN0349  70       Sail Date
     C                     MOVEL*BLANK    WN0350 12        Booking Number
     C                     MOVEL*BLANK    WN0351 20        Discharge Port
     C                     Z-ADD*ZERO     WN0352  70       Arrival Date
     C                     MOVEL*BLANK    WN0353 12        Container Numbe
     C                     Z-ADD*ZERO     WN0354  70       Date In
     C                     Z-ADD*ZERO     WN0355  60       Time In
     C                     Z-ADD*ZERO     WN0356  70       Date Out
     C                     Z-ADD*ZERO     WN0357  60       Time Out
     C                     Z-ADD*ZERO     WN0358 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0359  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0360  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0361  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0362  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0363  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0364  70       Requested Deliv
     C                     MOVEL*BLANK    WN0365  1        Load Acceptance
     C                     MOVEL*BLANK    WN0366  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0367  70       On Yard Date
     C                     Z-ADD*ZERO     WN0368  60       On Yard Time
     C                     Z-ADD*ZERO     WN0369  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0370  60       Deadline Depart
     C                     MOVEL*BLANK    WN0371  1        Load Held Over
     C                     MOVEL*BLANK    WN0372  1        Load Held Over
     C                     MOVEL*BLANK    WN0373 15        Load Held Over
     C                     MOVEL*BLANK    WN0374 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0375 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0376  70       Express Mail Da
     C                     MOVEL*BLANK    WN0377  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0378  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0379  70       Product Complet
     C                     Z-ADD*ZERO     WN0380  60       Product Complet
     C                     Z-ADD*ZERO     WN0381  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0382  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0383  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0384  1        Load Confirmed
     C                     MOVEL*BLANK    WN0385 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0386  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0387  60       Load Door 1
     C                     Z-ADD*ZERO     WN0388  70       Override Total
     C                     Z-ADD*ZERO     WN0389  60       Load Door 2
     C                     MOVEL*BLANK    WN0390  1        Partial Load
     C                     MOVEL*BLANK    WN0391  1        Load Confirmati
     C                     MOVEL*BLANK    WN0392  1        Export Load USD
     C                     MOVEL*BLANK    WN0393  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0394 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0395 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0396 15        Late Billing Em
     C                     MOVEL*BLANK    WN0397 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0398 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0399  1        Multi Company L
     C                     MOVEL*BLANK    WN0400  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0401  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0402  1        LH Power Only L
     C                     MOVEL*BLANK    WN0403  1        MG Created Load
     C                     MOVEL*BLANK    WN0404  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0405  2        Load U_M
     C                     MOVEL*BLANK    WN0406  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0407  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0408  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0409  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0410  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0411  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0412  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0413  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0414  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0415  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0416  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0417  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0418  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0419  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0420  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0421  60       LH Unused Time
     C                     MOVEL*BLANK    WN0422  1        EDI Status 1
     C                     MOVEL*BLANK    WN0423  1        EDI Status 2
     C                     MOVEL*BLANK    WN0424  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0425  60       Job Time
     C                     MOVEL*BLANK    WN0426 10        User Id
     C                     MOVEL*BLANK    WN0427 10        Job Name
     C                     Z-ADD*ZERO     WN0428  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDFJRMNB    WKRMNB           Load ID
      *
     C           KLCHTG    KLIST
     C                     KFLD           WKRMNB           Load ID
     C           KLCHTG    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YDRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDFJAIC3    WKAIC3           Company Number
     C                     Z-ADDFJAODT    WKAODT           Scheduled Ship
     C                     MOVEL'L'       WKPKST    P      Load Status
     C                     Z-ADD*ZERO     WKF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WKJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WKBOTM           BOL Complete Ti
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WKAATM           Job Time
     C                     MOVEL##USR     WKAYNA           User Id
     C                     MOVEL##JOB     WKA0NA           Job Name
     C                     Z-ADD##JDT     WKAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THCHRC    BEGSR
      *================================================================
      * CHG Load Status/ActShp CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0429  30       Company Number
     C                     MOVEL*BLANK    WN0430  1        LTL Flag
     C                     Z-ADD*ZERO     WN0431  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0432 15        Seal 1
     C                     MOVEL*BLANK    WN0433 15        Seal 2
     C                     MOVEL*BLANK    WN0434 15        Seal 3
     C                     MOVEL*BLANK    WN0435 15        Seal 4
     C                     MOVEL*BLANK    WN0436 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0437  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0438 112       Flat Amount
     C                     MOVEL*BLANK    WN0439  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0440  50       Total Stops
     C                     MOVEL*BLANK    WN0441 20        Trailer Id
     C                     MOVEL*BLANK    WN0442  3        Transloader Car
     C                     Z-ADD*ZERO     WN0443  40       BOL Time
     C                     MOVEL*BLANK    WN0444  3        Carrier Code
     C                     MOVEL*BLANK    WN0445  7        Truck Size
     C                     Z-ADD*ZERO     WN0446  70       Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WN0447 112       Rated Freight
     C                     MOVEL*BLANK    WN0448  1        Ship Status
     C                     MOVEL*BLANK    WN0449  1        Load Type
     C                     Z-ADD*ZERO     WN0450  50       Number Pallets
     C                     Z-ADD*ZERO     WN0451  50       Number Pallets
     C                     Z-ADD*ZERO     WN0452 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0453  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0454  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0455  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0456 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0457 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0458  70       Actual Departur
     C                     Z-ADD*ZERO     WN0459  40       Departure Time
     C                     Z-ADD*ZERO     WN0460  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0461  52       Product Tempera
     C                     Z-ADD*ZERO     WN0462  50       Number Spacers
     C                     MOVEL*BLANK    WN0463 12        Car_Veh. Initia
     C                     Z-ADD*ZERO     WN0464  70       Total Load Mile
     C                     MOVEL*BLANK    WN0465 12        Recorder ID
     C                     MOVEL*BLANK    WN0466  2        Shipping Method
     C                     MOVEL*BLANK    WN0467  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0468  2        Ship To State C
     C                     Z-ADD*ZERO     WN0469  70       Gross Weight
     C                     MOVEL*BLANK    WN0470  3        Carrier Broker
     C                     MOVEL*BLANK    WN0471  1        Export Status
     C                     MOVEL*BLANK    WN0472  1        On Time (Y_N)
     C                     Z-ADD*ZERO     WN0473  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0474  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0475  70       Spotted Date
     C                     Z-ADD*ZERO     WN0476  60       Spotted Time
     C                     Z-ADD*ZERO     WN0477  70       Load Finished D
     C                     Z-ADD*ZERO     WN0478  60       Load Finished T
     C                     Z-ADD*ZERO     WN0479  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0480  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0481  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0482  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0483  70       Truck Departure
     C                     Z-ADD*ZERO     WN0484  60       Truck Departure
     C                     Z-ADD*ZERO     WN0485  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0486  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0487  3        Shipping Line
     C                     MOVEL*BLANK    WN0488 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0489 30        Vessel Name
     C                     Z-ADD*ZERO     WN0490  50       Voyage
     C                     Z-ADD*ZERO     WN0491  70       Sail Date
     C                     MOVEL*BLANK    WN0492 12        Booking Number
     C                     MOVEL*BLANK    WN0493 20        Discharge Port
     C                     Z-ADD*ZERO     WN0494  70       Arrival Date
     C                     MOVEL*BLANK    WN0495 12        Container Numbe
     C                     Z-ADD*ZERO     WN0496  70       Date In
     C                     Z-ADD*ZERO     WN0497  60       Time In
     C                     Z-ADD*ZERO     WN0498  70       Date Out
     C                     Z-ADD*ZERO     WN0499  60       Time Out
     C                     Z-ADD*ZERO     WN0500 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0501  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0502  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0503  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0504  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0505  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0506  70       Requested Deliv
     C                     MOVEL*BLANK    WN0507  1        Load Acceptance
     C                     MOVEL*BLANK    WN0508  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0509  70       On Yard Date
     C                     Z-ADD*ZERO     WN0510  60       On Yard Time
     C                     Z-ADD*ZERO     WN0511  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0512  60       Deadline Depart
     C                     MOVEL*BLANK    WN0513  1        Load Held Over
     C                     MOVEL*BLANK    WN0514  1        Load Held Over
     C                     MOVEL*BLANK    WN0515 15        Load Held Over
     C                     MOVEL*BLANK    WN0516 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0517 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0518  70       Express Mail Da
     C                     MOVEL*BLANK    WN0519  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0520  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0521  70       Product Complet
     C                     Z-ADD*ZERO     WN0522  60       Product Complet
     C                     Z-ADD*ZERO     WN0523  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0524  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0525  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0526  1        Load Confirmed
     C                     MOVEL*BLANK    WN0527 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0528  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0529  60       Load Door 1
     C                     Z-ADD*ZERO     WN0530  70       Override Total
     C                     Z-ADD*ZERO     WN0531  60       Load Door 2
     C                     MOVEL*BLANK    WN0532  1        Partial Load
     C                     MOVEL*BLANK    WN0533  1        Load Confirmati
     C                     MOVEL*BLANK    WN0534  1        Export Load USD
     C                     MOVEL*BLANK    WN0535  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0536 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0537 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0538 15        Late Billing Em
     C                     MOVEL*BLANK    WN0539 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0540 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0541  1        Multi Company L
     C                     MOVEL*BLANK    WN0542  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0543  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0544  1        LH Power Only L
     C                     MOVEL*BLANK    WN0545  1        MG Created Load
     C                     MOVEL*BLANK    WN0546  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0547  2        Load U_M
     C                     MOVEL*BLANK    WN0548  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0549  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0550  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0551  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0552  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0553  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0554  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0555  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0556  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0557  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0558  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0559  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0560  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0561  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0562  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0563  60       LH Unused Time
     C                     MOVEL*BLANK    WN0564  1        EDI Status 1
     C                     MOVEL*BLANK    WN0565  1        EDI Status 2
     C                     MOVEL*BLANK    WN0566  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0567  60       Job Time
     C                     MOVEL*BLANK    WN0568 10        User Id
     C                     MOVEL*BLANK    WN0569 10        Job Name
     C                     Z-ADD*ZERO     WN0570  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADD#1RMNB    WKRMNB           Load ID
      *
     C           KLCHTH    KLIST
     C                     KFLD           WKRMNB           Load ID
     C           KLCHTH    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL009.
     C                     MOVEL'LBL009'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO THEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO THEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YERDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADD#1AODT    WKAODT           Scheduled Ship
     C                     MOVEL'L'       WKPKST    P      Load Status
     C                     Z-ADD*ZERO     WKF9DT           Actual Ship Dat
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WKAATM           Job Time
     C                     MOVEL##USR     WKAYNA           User Id
     C                     MOVEL##JOB     WKA0NA           Job Name
     C                     Z-ADD##JDT     WKAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TICHRC    BEGSR
      *================================================================
      * CHG for Unship         CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0571  2        Order Type_Sale
     C                     Z-ADD*ZERO     WN0572  70       AR Customer Num
     C                     Z-ADD*ZERO     WN0573  70       Ship To Custome
     C                     MOVEL*BLANK    WN0574 30        Ship To Name
     C                     MOVEL*BLANK    WN0575 30        Ship To Address
     C                     MOVEL*BLANK    WN0576 30        Ship To Address
     C                     MOVEL*BLANK    WN0577 30        Ship To Address
     C                     MOVEL*BLANK    WN0578 20        Ship To City
     C                     MOVEL*BLANK    WN0579  2        Ship To State C
     C                     MOVEL*BLANK    WN0580 11        Ship To Zip_Pos
     C                     Z-ADD*ZERO     WN0581  70       Bill to Custome
     C                     MOVEL*BLANK    WN0582 30        Bill to Name
     C                     MOVEL*BLANK    WN0583 30        Bill to Address
     C                     MOVEL*BLANK    WN0584 30        Bill to Address
     C                     MOVEL*BLANK    WN0585 30        Bill to Address
     C                     MOVEL*BLANK    WN0586 20        Bill to City
     C                     MOVEL*BLANK    WN0587  2        Bill to State C
     C                     MOVEL*BLANK    WN0588 11        Bill to Zip_Pos
     C                     MOVEL*BLANK    WN0589 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0590  70       Order Date
     C                     Z-ADD*ZERO     WN0591  70       Requested Ship
     C                     Z-ADD*ZERO     WN0592  70       Cancel Date
     C                     MOVEL*BLANK    WN0593  2        Terms Code
     C                     MOVEL*BLANK    WN0594 40        Special Instruc
     C                     MOVEL*BLANK    WN0595 40        Special Instruc
     C                     MOVEL*BLANK    WN0596  3        Carrier Code
     C                     MOVEL*BLANK    WN0597  1        Comment Print A
     C                     MOVEL*BLANK    WN0598  1        Comment Print I
     C                     MOVEL*BLANK    WN0599  1        Comment Print P
     C                     MOVEL*BLANK    WN0600  1        Comment Print S
     C                     MOVEL*BLANK    WN0601  3        Reason Code
     C                     MOVEL*BLANK    WN0602  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0603  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0604 10        User Original E
     C                     Z-ADD*ZERO     WN0605  70       Date of Origina
     C                     Z-ADD*ZERO     WN0606 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0607 112       Order Weight To
     C                     MOVEL*BLANK    WN0608  1        Credit Hold
     C                     MOVEL*BLANK    WN0609  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0610  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0611  40       Requested Deliv
     C                     MOVEL*BLANK    WN0612  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0613 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0614  70       Load ID
     C                     Z-ADD*ZERO     WN0615  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0616 112       Rated Freight
     C                     MOVEL*BLANK    WN0617  1        LTL Flag
     C                     MOVEL*BLANK    WN0618  1        Price Audit
     C                     MOVEL*BLANK    WN0619  1        Price Status
     C                     MOVEL*BLANK    WN0620  2        Shipping Method
     C                     MOVEL*BLANK    WN0621  1        Export Status
     C                     MOVEL*BLANK    WN0622  1        Palletize
     C                     MOVEL*BLANK    WN0623  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0624  1        Slip Sheet
     C                     MOVEL*BLANK    WN0625  1        Age Code
     C                     Z-ADD*ZERO     WN0626  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0627  1        Load Type
     C                     Z-ADD*ZERO     WN0628  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0629  1        Load Plan Order
     C                     MOVEL*BLANK    WN0630  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0631  70       Resell Referenc
     C                     MOVEL*BLANK    WN0632 30        Special Comment
     C                     MOVEL*BLANK    WN0633 30        Special Comment
     C                     MOVEL*BLANK    WN0634  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0635  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0636  2        Manager Level C
     C                     MOVEL*BLANK    WN0637  3        VP Level Code
     C                     Z-ADD*ZERO     WN0638  70       Attach to Order
     C                     MOVEL*BLANK    WN0639  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0640  70       Invoice Number
     C                     MOVEL*BLANK    WN0641  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0642  70       Invoice Date
     C                     MOVEL*BLANK    WN0643  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0644  1        Block Order Fla
     C                     MOVEL*BLANK    WN0645  1        Order Certifica
     C                     Z-ADD*ZERO     WN0646 112       Invoice Order V
     C                     MOVEL*BLANK    WN0647  1        Process Sts for
     C                     MOVEL*BLANK    WN0648  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0649  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0650  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0651  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0652  1        Email Cust On O
     C                     MOVEL*BLANK    WN0653  1        Order Emailed
     C                     MOVEL*BLANK    WN0654  1        Export Docs Go
     C                     MOVEL*BLANK    WN0655  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0656  1        Broker Order St
     C                     MOVEL*BLANK    WN0657  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0658  2        Order Requires
     C                     MOVEL*BLANK    WN0659  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0660  2        Export USDA App
     C                     MOVEL*BLANK    WN0661  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0662  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0663  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0664  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0665  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0666  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0667  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0668  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0669  60       Time of Origina
     C                     Z-ADD*ZERO     WN0670  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0671  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0672  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0673 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0674 112       Act Non_Ref Frt
     C                     Z-ADD*ZERO     WN0675 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0676 112       OH Total Non_Re
     C                     Z-ADD*ZERO     WN0677 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0678  70       Claim Number
     C                     MOVEL*BLANK    WN0679  1        EDI Status 1
     C                     MOVEL*BLANK    WN0680  1        EDI Status 2
     C                     MOVEL*BLANK    WN0681  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0682  60       Job Time
     C                     MOVEL*BLANK    WN0683 10        User Id
     C                     MOVEL*BLANK    WN0684 10        Job Name
     C                     Z-ADD*ZERO     WN0685  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADD#1AIC3    WLAIC3           Company Number
     C                     Z-ADD#1C4NB    WLC4NB           Order Number
      *
     C           KLCHTI    KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLC4NB           Order Number
     C           KLCHTI    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL010.
     C                     MOVEL'LBL010'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YFRDCS
      * Move non-key fields to @BECPFJ
     C                     Z-ADD*ZERO     WLGNDT           Actual Shipped
     C                     MOVEL'N'       WLGJST    P      Order in Use
     C                     MOVEL#1GWST    WLGWST    P      Header Status
     C                     MOVEL#1GXST    WLGXST    P      Header Status L
     C                     MOVEL#1XJST    WLXJST    P      Production Hold
     C                     MOVELWUJPCD    WLJPCD    P      Event Code
     C                     MOVEL#1Z1ST    WLZ1ST    P      Modified Flag
     C                     Z-ADD#1VRVA    WLVRVA           A/R order Value
     C                     MOVEL#1OBST    WLOBST    P      Billing Activit
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WLAATM           Job Time
     C                     MOVEL##USR     WLAYNA           User Id
     C                     MOVEL##PGM     WLA0NA           Job Name
     C                     Z-ADD##JDT     WLAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPARC
     C                     Z-ADDWLAIC3    PAAIC3           Company Number
     C                     Z-ADDWLC4NB    PAC4NB           Order Number
     C                     MOVELWLJNCD    PAJNCD    P      Order Type_Sale
     C                     Z-ADDWLANC7    PAANC7           AR Customer Num
     C                     Z-ADDWLBKC7    PABKC7           Ship To Custome
     C                     MOVELWLBRTX    PABRTX    P      Ship To Name
     C                     MOVELWLHMNA    PAHMNA    P      Ship To Address
     C                     MOVELWLHONA    PAHONA    P      Ship To Address
     C                     MOVELWLHPNA    PAHPNA    P      Ship To Address
     C                     MOVELWLHNNA    PAHNNA    P      Ship To City
     C                     MOVELWLDBCD    PADBCD    P      Ship To State C
     C                     MOVELWLCKTX    PACKTX    P      Ship To Zip_Pos
     C                     Z-ADDWLB0C7    PAB0C7           Bill to Custome
     C                     MOVELWLAETX    PAAETX    P      Bill to Name
     C                     MOVELWLB1NA    PAB1NA    P      Bill to Address
     C                     MOVELWLB3NA    PAB3NA    P      Bill to Address
     C                     MOVELWLB4NA    PAB4NA    P      Bill to Address
     C                     MOVELWLB2NA    PAB2NA    P      Bill to City
     C                     MOVELWLBHCD    PABHCD    P      Bill to State C
     C                     MOVELWLC8TX    PAC8TX    P      Bill to Zip_Pos
     C                     MOVELWLBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDWLA0DT    PAA0DT           Order Date
     C                     Z-ADDWLA5DT    PAA5DT           Requested Ship
     C                     Z-ADDWLGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDWLACDT    PAACDT           Cancel Date
     C                     MOVELWLAQCD    PAAQCD    P      Terms Code
     C                     MOVELWLB6NA    PAB6NA    P      Special Instruc
     C                     MOVELWLBYNA    PABYNA    P      Special Instruc
     C                     MOVELWLBZNA    PABZNA    P      Carrier Code
     C                     MOVELWLGTST    PAGTST    P      Comment Print A
     C                     MOVELWLGVST    PAGVST    P      Comment Print I
     C                     MOVELWLGUST    PAGUST    P      Comment Print P
     C                     MOVELWLQFST    PAQFST    P      Comment Print S
     C                     MOVELWLCQCD    PACQCD    P      Reason Code
     C                     MOVELWLGJST    PAGJST    P      Order in Use
     C                     MOVELWLGWST    PAGWST    P      Header Status
     C                     MOVELWLGXST    PAGXST    P      Header Status L
     C                     MOVELWLGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDWLAODT    PAAODT           Scheduled Ship
     C                     MOVELWLAIVN    PAAIVN    P      User Original E
     C                     Z-ADDWLCXDT    PACXDT           Date of Origina
     C                     Z-ADDWLJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDWLA1WG    PAA1WG           Order Weight To
     C                     MOVELWLXIST    PAXIST    P      Credit Hold
     C                     MOVELWLXJST    PAXJST    P      Production Hold
     C                     MOVELWLXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDWLEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDWLAFTM    PAAFTM           Requested Deliv
     C                     MOVELWLE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELWLE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDWLRMNB    PARMNB           Load ID
     C                     Z-ADDWLTBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDWLR1NB    PAR1NB           Rated Freight
     C                     MOVELWLPJST    PAPJST    P      LTL Flag
     C                     MOVELWLU0ST    PAU0ST    P      Price Audit
     C                     MOVELWLU1ST    PAU1ST    P      Price Status
     C                     MOVELWLQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELWLU2ST    PAU2ST    P      Export Status
     C                     MOVELWLVEST    PAVEST    P      Palletize
     C                     MOVELWLVFST    PAVFST    P      Shrink Wrap
     C                     MOVELWLVGST    PAVGST    P      Slip Sheet
     C                     MOVELWLRPCD    PARPCD    P      Age Code
     C                     Z-ADDWLRNNB    PARNNB           Reefer Temperat
     C                     MOVELWLVDST    PAVDST    P      Load Type
     C                     Z-ADDWLATIN    PAATIN           Attach to Invoi
     C                     MOVELWLU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELWLU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDWLRSRN    PARSRN           Resell Referenc
     C                     MOVELWLMHNA    PAMHNA    P      Special Comment
     C                     MOVELWLMINA    PAMINA    P      Special Comment
     C                     MOVELWLWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELWLR4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELWLBFCD    PABFCD    P      Manager Level C
     C                     MOVELWLQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDWLT3NB    PAT3NB           Attach to Order
     C                     MOVELWLSICD    PASICD    P      Reason for Pric
     C                     Z-ADDWLCONB    PACONB           Invoice Number
     C                     MOVELWLCEST    PACEST    P      Invoice Suffix
     C                     Z-ADDWLAWDT    PAAWDT           Invoice Date
     C                     MOVELWLJPCD    PAJPCD    P      Event Code
     C                     MOVELWLXUST    PAXUST    P      Trans Contol AS
     C                     MOVELWLZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDWLVRVA    PAVRVA           A/R order Value
     C                     MOVELWLOBST    PAOBST    P      Billing Activit
     C                     MOVELWLBCST    PABCST    P      Block Order Fla
     C                     MOVELWLBDST    PABDST    P      Order Certifica
     C                     Z-ADDWLB7VL    PAB7VL           Invoice Order V
     C                     MOVELWLGASX    PAGASX    P      Process Sts for
     C                     MOVELWLGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELWLGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELWLGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELWLFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELWLFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELWLFPSX    PAFPSX    P      Order Emailed
     C                     MOVELWLFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELWLFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELWLFSSX    PAFSSX    P      Broker Order St
     C                     MOVELWLFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELWLFUSX    PAFUSX    P      Order Requires
     C                     MOVELWLFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELWLFWSX    PAFWSX    P      Export USDA App
     C                     MOVELWLFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELWLFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDWLNODT    PANODT           OH Appt Confirm
     C                     Z-ADDWLNPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDWLNQDT    PANQDT           Load Actual Shi
     C                     Z-ADDWLNRDT    PANRDT           Load BOL Comple
     C                     Z-ADDWLNSDT    PANSDT           Load Truck Depa
     C                     Z-ADDWLBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDWLBQTM    PABQTM           Time of Origina
     C                     Z-ADDWLBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDWLBSTM    PABSTM           Load BOL Comple
     C                     Z-ADDWLBTTM    PABTTM           Load Truck Depa
     C                     Z-ADDWLH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDWLH1NX    PAH1NX           Act Non_Ref Frt
     C                     Z-ADDWLH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDWLH3NX    PAH3NX           OH Total Non_Re
     C                     Z-ADDWLH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDWLC0C7    PAC0C7           Claim Number
     C                     MOVELWLUVST    PAUVST    P      EDI Status 1
     C                     MOVELWLUWST    PAUWST    P      EDI Status 2
     C                     MOVELWLUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDWLAATM    PAAATM           Job Time
     C                     MOVELWLAYNA    PAAYNA    P      User Id
     C                     MOVELWLA0NA    PAA0NA    P      Job Name
     C                     Z-ADDWLAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * UPD Err Transactions   RT - Item Transaction Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN B7AIC3    WQTJ01           Company Number
     C           *LIKE     DEFN B7C4NB    WQTJ02           Order Number
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           WQTJ01           Company Number
     C                     KFLD           WQTJ02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQTJ01           Company Number
     C                     Z-ADD#1C4NB    WQTJ02           Order Number
      * Establish starting position
     C           KRSTJ     SETLL@B7CPJD                    *
     C           KRSTJ     READE@B7CPJD                  90*
      * Data record not found
     C   90                MOVEL'USR0344' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Reason Code        CH - Item Transaction Detail  * 
     C                     EXSR TKCHRC
     C           KRSTJ     READE@B7CPJD                  90*
     C                     ENDDO
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKCHRC    BEGSR
      *================================================================
      * CHG Reason Code        CH - Item Transaction Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0686  70       Production Date
     C                     MOVEL*BLANK    WN0687  2        UOM Transaction
     C                     MOVEL*BLANK    WN0688  2        Item Transactio
     C                     MOVEL*BLANK    WN0689 30        Description
     C                     Z-ADD*ZERO     WN0690 112       Transaction Qua
     C                     Z-ADD*ZERO     WN0691 112       Transaction Wei
     C                     Z-ADD*ZERO     WN0692 114       USR Transaction
     C                     MOVEL*BLANK    WN0693  2        UOM Cost
     C                     Z-ADD*ZERO     WN0694 112       Extended Amount
     C                     MOVEL*BLANK    WN0695  6        Ticket Number
     C                     Z-ADD*ZERO     WN0696  80       GL Document Num
     C                     MOVEL*BLANK    WN0697  1        GL Update Statu
     C                     MOVEL*BLANK    WN0698 15        Reference Numbe
     C                     MOVEL*BLANK    WN0699 10        Lot ID
     C                     Z-ADD*ZERO     WN0700  70       Transfer Batch
     C                     Z-ADD*ZERO     WN0701  30       Transfer Batch
     C                     Z-ADD*ZERO     WN0702  70       Order Number
     C                     Z-ADD*ZERO     WN0703  30       Item Structure
     C                     Z-ADD*ZERO     WN0704  30       Item Structure
     C                     Z-ADD*ZERO     WN0705  30       Item Structure
     C                     MOVEL*BLANK    WN0706 10        Employee Badge
     C                     Z-ADD*ZERO     WN0707  60       Production Time
     C                     MOVEL*BLANK    WN0708  1        Shift Number
     C                     Z-ADD*ZERO     WN0709  70       Label Date
     C                     MOVEL*BLANK    WN0710  1        EDI Status 1
     C                     MOVEL*BLANK    WN0711  1        EDI Status 2
     C                     MOVEL*BLANK    WN0712  1        EDI Status 3
     C                     MOVEL*BLANK    WN0713  1        Record Status
     C                     Z-ADD*ZERO     WN0714  60       Job Time
     C                     MOVEL*BLANK    WN0715 10        User Id
     C                     MOVEL*BLANK    WN0716 10        Job Name
     C                     Z-ADD*ZERO     WN0717  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @B7CPJZ
     C                     Z-ADDB7AIC3    WMAIC3           Company Number
     C                     Z-ADDB7HGCD    WMHGCD           Item Code
     C                     MOVELB7AJCD    WMAJCD    P      Warehouse Code
     C                     MOVELB7W9ST    WMW9ST    P      Inventory Trans
     C                     MOVELB7BSST    WMBSST    P      Inventory Trans
     C                     Z-ADDB7B4DT    WMB4DT           Transaction Dat
     C                     Z-ADDB7C4NY    WMC4NY           ITD Sequence Nu
     C                     Z-ADDB7DXNB    WMDXNB           Sequence Number
      *
     C           KLCHTK    KLIST
     C                     KFLD           WMAIC3           Company Number
     C                     KFLD           WMHGCD           Item Code
     C                     KFLD           WMAJCD           Warehouse Code
     C                     KFLD           WMW9ST           Inventory Trans
     C                     KFLD           WMBSST           Inventory Trans
     C                     KFLD           WMB4DT           Transaction Dat
     C                     KFLD           WMC4NY           ITD Sequence Nu
     C                     KFLD           WMDXNB           Sequence Number
     C           KLCHTK    CHAIN@B7CPJZ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB7CPL0'MDACP
     C                     MOVEL'@B7CPJZ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL011.
     C                     MOVEL'LBL011'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TKEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB71    YGRDCS
      * Move non-key fields to @B7CPJZ
     C                     MOVEL*BLANK    WMCQCD    P      Reason Code
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB71    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * USER: Processing before Data update
      * 01/29/02 PKD Do not change the Record Stamp per Tom Dye. This
      *              causes inaccurate reporting on the Item Transaction
      *              Journal.
      * Set PGM.*Record Data Changed flag
     C           QCAB71    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@B7CPJZ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB7CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * Rtv & Dlt for Cancel  RT - Export Doc Order Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN MSAIC3    WQTL01           Company Number
     C           *LIKE     DEFN MSC4NB    WQTL02           Order Number
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           WQTL01           Company Number
     C                     KFLD           WQTL02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQTL01           Company Number
     C                     Z-ADD#1C4NB    WQTL02           Order Number
      * Establish starting position
     C           KRSTL     SETLL@MSREX2                    *
     C           KRSTL     READE@MSREX2                  90*
      * Data record not found
     C   90                MOVEL'USR2745' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del Exp Doc Order Dtl  DL - Export Doc Order Dtl  * 
     C                     EXSR TMDLRC
     C           KRSTL     READE@MSREX2                  90*
     C                     ENDDO
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMDLRC    BEGSR
      *================================================================
      * Del Exp Doc Order Dtl  DL - Export Doc Order Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @MSREW4
     C                     Z-ADDMSAIC3    WOAIC3           Company Number
     C                     Z-ADDMSC4NB    WOC4NB           Order Number
     C                     MOVELMSDGSX    WODGSX           ED Export Docum
     C                     MOVELMSKXCD    WOKXCD           Country Code
     C                     Z-ADDMSDPNB    WODPNB           Order Sequence
     C                     Z-ADDMSUENB    WOUENB           Order Secondary
      *
     C           KLDLTM    KLIST
     C                     KFLD           WOAIC3           Company Number
     C                     KFLD           WOC4NB           Order Number
     C                     KFLD           WODGSX           ED Export Docum
     C                     KFLD           WOKXCD           Country Code
     C                     KFLD           WODPNB           Order Sequence
     C                     KFLD           WOUENB           Order Secondary
     C           KLDLTM    CHAIN@MSREW4              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDMSREL0'MDACP
     C                     MOVEL'@MSREW4' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL012.
     C                     MOVEL'LBL012'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TMEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@MSREW4                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNRVGN    BEGSR
      *================================================================
      * RTV Alpha Value        RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTN     KLIST
     C                     KFLD           KMAIC3           Company Number
     C                     KFLD           KMV8CD           Company Value C
      * Setup key
     C                     Z-ADD#1AIC3    KMAIC3           Company Number
     C                     MOVEL@CN,006   KMV8CD           Company Value C
      * Establish starting position
     C           KRSTN     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELKMBXTX    YL0021           System Value Al
     C                     ENDIF
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TORVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTO     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0718    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSTO     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    P2I6ST           Allow Multi-Com
     C                     MOVELDRMPNA    P2MPNA           Default Printer
     C                     MOVELDRBCCD    P2BCCD           Salesperson Cod
     C                     Z-ADDDRAIC3    YL0022           Company Number
     C                     MOVELDRBUVN    WN0719           User Code Model
     C                     ENDIF
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - User Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTP     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0123    DTAJVN           User Profile Na
     C                     MOVELWL0124    DTDNCD           Application Cod
      * Establish starting position
     C           KRSTP     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0125           Company Number
     C                     MOVELDTAJCD    WL0126           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQTQ01           Application Cod
      * Define keylist
     C           KRSTQ     KLIST
     C                     KFLD           WQTQ01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQTQ01           Application Cod
     C                     MOVEL'OMS'     WQTQ01           Application Cod
      * Establish starting position
     C           KRSTQ     SETLL@DNRESF                    *
     C           KRSTQ     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR TRRVGN
     C                     END                             *FI
     C           KRSTQ     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQTR01           Application Cod
      * Define keylist
     C           KRSTR     KLIST
     C                     KFLD           WQTR01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQTR01           Application Cod
      * Establish starting position
     C           KRSTR     SETLL@DNRESF                    *
     C           KRSTR     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TREXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSTR     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         TSRVGN    BEGSR
      *================================================================
      * Rtv Allow Multi-Whs   RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTS     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVEL##USR     DRAJVN           User Profile Na
      * Establish starting position
     C           KRSTS     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    P2I8ST           Allow Multi War
     C                     GOTO TSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI8ST    P2I8ST           Allow Multi War
     C                     ENDIF
      *================================================================
     CSR         TSEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C           ZINPOS    IFGE 02816
     C           ZINPOS    ANDLE05632
      * Cursor in the subfile record area
      * Reset cursor position to the basic (first) record for lookup
     C           W0CRW     SUB  11        W0CSRR  50
     C           02816     ADD  W0CCL     ZINPOS
      * Calculate rrn of the cursor position
     C                     ADD  ##SFRC    W0CSRR
     C                     ENDIF
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C           W0CFL     IFEQ *BLANK
     C                     Z-ADD0         W0CSRR
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD11        ZHSTRW  40
     C                     Z-ADD21        ZHNDRW  40
     C                     Z-ADD1         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1AIC3           Company Number
     C                     Z-ADD*ZERO     P1RMNB           Load ID
     C                     MOVEL*BLANK    P2AJCD           Warehouse Code
     C                     MOVEL*BLANK    P2DNCD           Application Cod
     C                     MOVEL*BLANK    P2BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P2B8NA           System Date For
     C                     MOVEL*BLANK    P2I6ST           Allow Multi-Com
     C                     MOVEL*BLANK    P2I8ST           Allow Multi War
     C                     MOVEL*BLANK    P2MPNA           Default Printer
     C                     MOVEL*BLANK    P2TAST           First Time Flag
     C                     MOVEL*BLANK    P3E6ST           USR Status (Y/N
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Whs Ord Found STS
     C                     MOVEL*BLANK    WUEASX  1
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WADBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WABWC3           Shipping Compan
     C                     Z-ADD*ZERO     WABTC3           Accounting Comp
     C                     Z-ADD*ZERO     WABUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WABVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBQ2NB           Event Number
     C                     Z-ADD*ZERO     WBAUC3           Invoice_Memo Co
     C                     Z-ADD*ZERO     WBQ7NB           Invoice_Memo Nu
     C                     Z-ADD*ZERO     WBD2DT           Event Date
     C                     Z-ADD*ZERO     WBAWC3           Cross Event Ref
     C                     Z-ADD*ZERO     WBQ8NB           Cross Event Ref
     C                     Z-ADD*ZERO     WBQ9NB           Cross Event Ref
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field Event Number
     C                     Z-ADD*ZERO     WUQ2NB  50
      * Define work field Event Code
     C                     MOVEL*BLANK    WUJPCD  2
      * Define work field Order Number Alpha
     C                     MOVEL*BLANK    WUE7TX  7
      * Define work field Description 14A      USR
     C                     MOVEL*BLANK    WUI6TX 14
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDDPNB           Order Sequence
     C                     Z-ADD*ZERO     WDUENB           Order Secondary
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WDMAVA           Billing Detail
     C                     Z-ADD*ZERO     WDKDVA           Billing Detail
     C                     Z-ADD*ZERO     WDL8VA           Billing Detail
     C                     Z-ADD*ZERO     WDL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WDAYVA           Extended Amount
     C                     Z-ADD*ZERO     WDEXDT           Market Pricing
     C                     Z-ADD*ZERO     WDBZPR           Price Overage O
     C                     Z-ADD*ZERO     WDL6NB           Contract Number
     C                     Z-ADD*ZERO     WDGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WDD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WDCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WDAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WDCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WDATWG           Weight Shipped
     C                     Z-ADD*ZERO     WDAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WDAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WDAKPR           Unit Price
     C                     Z-ADD*ZERO     WDALPR           Unit Price_Cred
     C                     Z-ADD*ZERO     WDAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WDAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WDA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WDA5DT           Requested Ship
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WDRGNB           Item Structure
     C                     Z-ADD*ZERO     WDRHNB           Item Structure
     C                     Z-ADD*ZERO     WDRINB           Item Structure
     C                     Z-ADD*ZERO     WDCXDT           Date of Origina
     C                     Z-ADD*ZERO     WDDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WDB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WDA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WDNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WDNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WDNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WDNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WDNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WDBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WDBVTM           Price Code
     C                     Z-ADD*ZERO     WDBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WDBXTM           Substitution Li
     C                     Z-ADD*ZERO     WDBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WDH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WDH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WDH7NX           OD Item Target
     C                     Z-ADD*ZERO     WDH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WDH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WDDVPR           Order Gate_Fina
     C                     Z-ADD*ZERO     WDDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WDDXPR           OD Gate_Final P
     C                     Z-ADD*ZERO     WDDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WDDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WDGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WDGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WDGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WDPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WDRINY           Item Age Days
     C                     Z-ADD*ZERO     WDTIDT           Production Ovr
     C                     Z-ADD*ZERO     WDTJDT           Production Ovr
     C                     Z-ADD*ZERO     WDTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WDTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WDTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field LTT Unused Sts 1
     C                     MOVEL*BLANK    WULLTU  1
      * Define work field LTT Unused Sts 2
     C                     MOVEL*BLANK    WULLYT  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEHGCD           Item Code
     C                     Z-ADD*ZERO     WELRDT           LLT Transaction
     C                     Z-ADD*ZERO     WELLTS           LLT Sequence Nu
     C                     Z-ADD*ZERO     WELSDT           LLT Production
     C                     Z-ADD*ZERO     WEJ5QT           LLT Transaction
     C                     Z-ADD*ZERO     WEG8WG           LLT Transaction
     C                     Z-ADD*ZERO     WELLTN           LLT Lot Number
     C                     Z-ADD*ZERO     WELLCL           LLT Location Le
     C                     Z-ADD*ZERO     WELLTR           LLT Transfer Lo
     C                     Z-ADD*ZERO     WELLTL           LLT Transfer Lo
     C                     Z-ADD*ZERO     WEC4NB           Order Number
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFHGCD           Item Code
     C                     Z-ADD*ZERO     WFELDT           Production Date
     C                     Z-ADD*ZERO     WFLXNM           Lot Number
     C                     Z-ADD*ZERO     WFYNCD           Location Level
     C                     Z-ADD*ZERO     WFJ2QT           ILL Item Qty On
     C                     Z-ADD*ZERO     WFG5WG           ILL Unit Weight
     C                     Z-ADD*ZERO     WFJ3QT           ILL Co-Packer L
     C                     Z-ADD*ZERO     WFG6WG           ILL Item Wgt On
     C                     Z-ADD*ZERO     WFJ4QT           ILL Unused Qty
     C                     Z-ADD*ZERO     WFG7WG           ILL Unused Wgt
     C                     Z-ADD*ZERO     WFLODT           ILL Avail Ship
     C                     Z-ADD*ZERO     WFLPDT           ILL Unused Date
     C                     Z-ADD*ZERO     WFLQDT           ILL Unused Date
     C                     Z-ADD*ZERO     WFNBR            ILL Unused Nbr
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGHGCD           Item Code
     C                     Z-ADD*ZERO     WGELDT           Production Date
     C                     Z-ADD*ZERO     WGABWG           Physical Count
     C                     Z-ADD*ZERO     WGAGQT           Physical Count
     C                     Z-ADD*ZERO     WGAHQT           Physical Count
     C                     Z-ADD*ZERO     WGAIQT           Physical Count
     C                     Z-ADD*ZERO     WGACWG           Quantity on Han
     C                     Z-ADD*ZERO     WGARQT           Quantity on Han
     C                     Z-ADD*ZERO     WGASQT           Quantity on Han
     C                     Z-ADD*ZERO     WGATQT           Quantity on Han
     C                     Z-ADD*ZERO     WGHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WGHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WGBMWG           Physical Start
     C                     Z-ADD*ZERO     WGDSQT           Physical Start
     C                     Z-ADD*ZERO     WGDTQT           Physical Start
     C                     Z-ADD*ZERO     WGDUQT           Physical Start
     C                     Z-ADD*ZERO     WGDHDT           Physical Start
     C                     Z-ADD*ZERO     WGAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WGAECS           Last Cost
     C                     Z-ADD*ZERO     WGIDVA           Value of On Han
     C                     Z-ADD*ZERO     WGK7DT           Label Date
     C                     Z-ADD*ZERO     WGRINB           Item Structure
     C                     Z-ADD*ZERO     WGRHNB           Item Structure
     C                     Z-ADD*ZERO     WGRGNB           Item Structure
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHC4NB           Order Number
     C                     Z-ADD*ZERO     WHDPNB           Order Sequence
     C                     Z-ADD*ZERO     WHUENB           Order Secondary
     C                     Z-ADD*ZERO     WHALSW           Allocation Seq
     C                     Z-ADD*ZERO     WHJ6QT           OIA Alloc_Shipp
     C                     Z-ADD*ZERO     WHG9WG           OIA Alloc_Shipp
     C                     Z-ADD*ZERO     WHJ9QT           OIA Co-Packer L
     C                     Z-ADD*ZERO     WHHAWG           OIA Serial Numb
     C                     Z-ADD*ZERO     WHHGCD           Item Code
     C                     Z-ADD*ZERO     WHELDT           Production Date
     C                     Z-ADD*ZERO     WHLXNM           Lot Number
     C                     Z-ADD*ZERO     WHYNCD           Location Level
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIC4NB           Order Number
     C                     Z-ADD*ZERO     WIDPNB           Order Sequence
     C                     Z-ADD*ZERO     WIUENB           Order Secondary
     C                     Z-ADD*ZERO     WIRZNB           Case Sequence N
     C                     Z-ADD*ZERO     WIFOQT           Case Quantity
     C                     Z-ADD*ZERO     WIR0NB           Case Weight
     C                     Z-ADD*ZERO     WIK7DT           Label Date
     C                     Z-ADD*ZERO     WIPFNX           PT Serial Numbe
     C                     Z-ADD*ZERO     WIHGCD           Item Code
     C                     Z-ADD*ZERO     WIELDT           Production Date
     C                     Z-ADD*ZERO     WIN5WG           Manifest Gross
     C                     Z-ADD*ZERO     WIH5NY           Manifest Total
     C                     Z-ADD*ZERO     WIH6NY           Manifest Co-Par
     C                     Z-ADD*ZERO     WIH7NY           Manifest Pallet
     C                     Z-ADD*ZERO     WIN6WG           HPB Meter Net G
     C                     Z-ADD*ZERO     WIN7WG           Manifest Net We
     C                     Z-ADD*ZERO     WIRBDT           Manifest Unused
     C                     Z-ADD*ZERO     WIITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WIIVNY           HPB Meter Start
     C                     Z-ADD*ZERO     WIIUNY           HPB Meter Endin
     C                     Z-ADD*ZERO     WIIWNY           HPB Meter Total
     C                     Z-ADD*ZERO     WIIXNY           HPB Meter Net W
     C                     Z-ADD*ZERO     WIIYNY           HPB Density Ref
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Define work field USR Update Flag
     C                     MOVEL*BLANK    WUR4ST  1
      * Define work field COA RIN Modified Sts
     C                     MOVEL*BLANK    WURINS  1
      * Define work field USR Order Value
     C                     Z-ADD*ZERO     WUJSVA 112
      * Define work field USR Order Weight
     C                     Z-ADD*ZERO     WUAYWG 112
      * Define work field USR Production
     C                     MOVEL*BLANK    WUXPST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKRMNB           Load ID
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WKRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WKRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WKFLAM           Flat Amount
     C                     Z-ADD*ZERO     WKRRNB           Total Stops
     C                     Z-ADD*ZERO     WKSBNB           BOL Time
     C                     Z-ADD*ZERO     WKSQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WKR1NB           Rated Freight
     C                     Z-ADD*ZERO     WKSDNB           Number Pallets
     C                     Z-ADD*ZERO     WKPAOU           Number Pallets
     C                     Z-ADD*ZERO     WKDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WKSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WKHADT           Actual Arrival
     C                     Z-ADD*ZERO     WKAART           Actual Arrival
     C                     Z-ADD*ZERO     WKDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WKDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WKAQDT           Actual Departur
     C                     Z-ADD*ZERO     WKS6NB           Departure Time
     C                     Z-ADD*ZERO     WKT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WKPRTM           Product Tempera
     C                     Z-ADD*ZERO     WKNPSV           Number Spacers
     C                     Z-ADD*ZERO     WKTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WKGRWE           Gross Weight
     C                     Z-ADD*ZERO     WKF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WKJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WKTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WKJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WKSPTM           Spotted Time
     C                     Z-ADD*ZERO     WKJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WKLFTM           Load Finished T
     C                     Z-ADD*ZERO     WKJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WKBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WKJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WKBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WKKIDT           Truck Departure
     C                     Z-ADD*ZERO     WKASTM           Truck Departure
     C                     Z-ADD*ZERO     WKKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WKAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WKVOAG           Voyage
     C                     Z-ADD*ZERO     WKKBDT           Sail Date
     C                     Z-ADD*ZERO     WKEFDT           Arrival Date
     C                     Z-ADD*ZERO     WKKCDT           Date In
     C                     Z-ADD*ZERO     WKTMIN           Time In
     C                     Z-ADD*ZERO     WKKDDT           Date Out
     C                     Z-ADD*ZERO     WKVMNB           Time Out
     C                     Z-ADD*ZERO     WKOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WKKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WKATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WKBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WKEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WKKKDT           On Yard Date
     C                     Z-ADD*ZERO     WKAVTM           On Yard Time
     C                     Z-ADD*ZERO     WKKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WKAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WKLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WKK0DT           Product Complet
     C                     Z-ADD*ZERO     WKAYTM           Product Complet
     C                     Z-ADD*ZERO     WKKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WKICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WKIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WKK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WKAZTM           Load Door 1
     C                     Z-ADD*ZERO     WKK2DT           Override Total
     C                     Z-ADD*ZERO     WKA0TM           Load Door 2
     C                     Z-ADD*ZERO     WKZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WKPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WKCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WKPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WKCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WKP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WKCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WKP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WKCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WKP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WKCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WKP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WKCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLAIC3           Company Number
     C                     Z-ADD*ZERO     WLC4NB           Order Number
     C                     Z-ADD*ZERO     WLANC7           AR Customer Num
     C                     Z-ADD*ZERO     WLBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WLB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WLA0DT           Order Date
     C                     Z-ADD*ZERO     WLA5DT           Requested Ship
     C                     Z-ADD*ZERO     WLGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WLACDT           Cancel Date
     C                     Z-ADD*ZERO     WLAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WLCXDT           Date of Origina
     C                     Z-ADD*ZERO     WLJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WLA1WG           Order Weight To
     C                     Z-ADD*ZERO     WLEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WLAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WLRMNB           Load ID
     C                     Z-ADD*ZERO     WLTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WLR1NB           Rated Freight
     C                     Z-ADD*ZERO     WLRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WLATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WLRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WLT3NB           Attach to Order
     C                     Z-ADD*ZERO     WLCONB           Invoice Number
     C                     Z-ADD*ZERO     WLAWDT           Invoice Date
     C                     Z-ADD*ZERO     WLVRVA           A/R order Value
     C                     Z-ADD*ZERO     WLB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WLNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WLNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WLNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WLNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WLNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WLBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WLBQTM           Time of Origina
     C                     Z-ADD*ZERO     WLBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WLBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WLBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WLH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WLH1NX           Act Non_Ref Frt
     C                     Z-ADD*ZERO     WLH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WLH3NX           OH Total Non_Re
     C                     Z-ADD*ZERO     WLH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WLC0C7           Claim Number
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMAIC3           Company Number
     C                     Z-ADD*ZERO     WMHGCD           Item Code
     C                     Z-ADD*ZERO     WMB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WMC4NY           ITD Sequence Nu
     C                     Z-ADD*ZERO     WMDXNB           Sequence Number
     C                     Z-ADD*ZERO     WMELDT           Production Date
     C                     Z-ADD*ZERO     WMA5QT           Transaction Qua
     C                     Z-ADD*ZERO     WMAHWG           Transaction Wei
     C                     Z-ADD*ZERO     WMAKCS           USR Transaction
     C                     Z-ADD*ZERO     WMAYVA           Extended Amount
     C                     Z-ADD*ZERO     WMCKNB           GL Document Num
     C                     Z-ADD*ZERO     WMTRBN           Transfer Batch
     C                     Z-ADD*ZERO     WMTRBS           Transfer Batch
     C                     Z-ADD*ZERO     WMC4NB           Order Number
     C                     Z-ADD*ZERO     WMRINB           Item Structure
     C                     Z-ADD*ZERO     WMRHNB           Item Structure
     C                     Z-ADD*ZERO     WMRGNB           Item Structure
     C                     Z-ADD*ZERO     WMAWTM           Production Time
     C                     Z-ADD*ZERO     WMK7DT           Label Date
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOAIC3           Company Number
     C                     Z-ADD*ZERO     WOC4NB           Order Number
     C                     Z-ADD*ZERO     WODPNB           Order Sequence
     C                     Z-ADD*ZERO     WOUENB           Order Secondary
     C                     Z-ADD*ZERO     WODIC7           ED Item Code
     C                     Z-ADD*ZERO     WOHJWG           ED Product Net
     C                     Z-ADD*ZERO     WOHKWG           ED Product Net
     C                     Z-ADD*ZERO     WOAONX           ED Product Nbr
     C                     Z-ADD*ZERO     WOAMNX           ED Pieces per B
     C                     Z-ADD*ZERO     WOANNX           ED Bags per Uni
     C                     Z-ADD*ZERO     WOAPNX           ED Total Nbr of
     C                     Z-ADD*ZERO     WODKPR           ED Product Unit
     C                     Z-ADD*ZERO     WOA9VL           ED Producet Ext
     C                     Z-ADD*ZERO     WOAJNX           ED Consignee Ad
     C                     Z-ADD*ZERO     WOW0DT           ED Nbr of Packi
     C                     Z-ADD*ZERO     WOAATM           Job Time
     C                     Z-ADD*ZERO     WOAXDT           Job Date
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     MOVEL*BLANK    WL0001 10
     C                     MOVEL*BLANK    WL0002  3
     C                     MOVEL*BLANK    WL0003  1
     C                     MOVEL*BLANK    WL0004  1
     C                     MOVEL*BLANK    WL0005  1
     C                     MOVEL*BLANK    WL0006  1
     C                     MOVEL*BLANK    WL0007  1
     C                     MOVEL*BLANK    WL0008  1
     C                     MOVEL*BLANK    WL0009  1
     C                     MOVEL*BLANK    WL0010  1
     C                     MOVEL*BLANK    WL0011  1
     C                     MOVEL*BLANK    WL0012  1
     C                     MOVEL*BLANK    WL0013  1
     C                     MOVEL*BLANK    WL0014  1
     C                     MOVEL*BLANK    WL0015  1
     C                     MOVEL*BLANK    WL0016  1
     C                     MOVEL*BLANK    WL0017  2
     C                     MOVEL*BLANK    WL0018  2
     C                     MOVEL*BLANK    WL0019  2
     C                     MOVEL*BLANK    WL0020  2
     C                     MOVEL*BLANK    WL0021  2
     C                     MOVEL*BLANK    WL0022  1
      * Define local variables for subroutine SRRVGN.
     C                     Z-ADD*ZERO     WL0023  30
     C                     Z-ADD*ZERO     WL0024  70
     C                     MOVEL*BLANK    WL0025  3
     C                     MOVEL*BLANK    WL0026  2
     C                     Z-ADD*ZERO     WL0027  70
     C                     Z-ADD*ZERO     WL0028  30
      * Define local variables for subroutine SSCRRC.
     C                     Z-ADD*ZERO     WL0029  30
     C                     Z-ADD*ZERO     WL0030  70
     C                     MOVEL*BLANK    WL0031  3
     C                     MOVEL*BLANK    WL0032  2
     C                     Z-ADD*ZERO     WL0033  70
     C                     Z-ADD*ZERO     WL0034  30
     C                     Z-ADD*ZERO     WL0035  70
     C                     Z-ADD*ZERO     WL0036  50
     C                     Z-ADD*ZERO     WL0037 112
     C                     Z-ADD*ZERO     WL0038  50
     C                     MOVEL*BLANK    WL0039  4
     C                     Z-ADD*ZERO     WL0040  20
     C                     MOVEL*BLANK    WL0041  3
     C                     Z-ADD*ZERO     WL0042  50
     C                     MOVEL*BLANK    WL0043  4
     C                     Z-ADD*ZERO     WL0044  20
     C                     Z-ADD*ZERO     WL0045  70
     C                     MOVEL*BLANK    WL0046  1
     C                     MOVEL*BLANK    WL0047  1
     C                     MOVEL*BLANK    WL0048  1
     C                     MOVEL*BLANK    WL0049  1
     C                     MOVEL*BLANK    WL0050  1
     C                     MOVEL*BLANK    WL0051  1
     C                     MOVEL*BLANK    WL0052  1
     C                     Z-ADD*ZERO     WL0053  60
     C                     MOVEL*BLANK    WL0054 10
     C                     MOVEL*BLANK    WL0055 10
     C                     Z-ADD*ZERO     WL0056  70
      * Define local variables for subroutine STRVGN.
     C                     Z-ADD*ZERO     WL0057  30
     C                     Z-ADD*ZERO     WL0058  70
     C                     MOVEL*BLANK    WL0059  3
     C                     Z-ADD*ZERO     WL0060  70
     C                     Z-ADD*ZERO     WL0061  50
     C                     MOVEL*BLANK    WL0062  4
     C                     Z-ADD*ZERO     WL0063  20
     C                     Z-ADD*ZERO     WL0064  70
     C                     Z-ADD*ZERO     WL0065 112
      * Define local variables for subroutine SURVGN.
     C                     MOVEL*BLANK    WL0066  3
     C                     MOVEL*BLANK    WL0067  4
     C                     MOVEL*BLANK    WL0068  1
      * Define local variables for subroutine SVRVGN.
     C                     MOVEL*BLANK    WL0069  1
     C                     Z-ADD*ZERO     WL0070  52
      * Define local variables for subroutine SWRVGN.
     C                     Z-ADD*ZERO     WL0071  30
     C                     Z-ADD*ZERO     WL0072  70
     C                     Z-ADD*ZERO     WL0073 112
     C                     MOVEL*BLANK    WL0074  2
      * Define local variables for subroutine SXCRRC.
     C                     Z-ADD*ZERO     WL0075  30
     C                     Z-ADD*ZERO     WL0076  70
     C                     MOVEL*BLANK    WL0077  3
     C                     Z-ADD*ZERO     WL0078  70
     C                     Z-ADD*ZERO     WL0079  50
     C                     MOVEL*BLANK    WL0080  4
     C                     Z-ADD*ZERO     WL0081  20
     C                     Z-ADD*ZERO     WL0082  50
     C                     Z-ADD*ZERO     WL0083 112
     C                     Z-ADD*ZERO     WL0084  50
     C                     Z-ADD*ZERO     WL0085 112
     C                     Z-ADD*ZERO     WL0086  50
     C                     Z-ADD*ZERO     WL0087 112
     C                     Z-ADD*ZERO     WL0088  70
     C                     Z-ADD*ZERO     WL0089  70
     C                     Z-ADD*ZERO     WL0090  70
     C                     Z-ADD*ZERO     WL0091  72
     C                     MOVEL*BLANK    WL0092  6
     C                     MOVEL*BLANK    WL0093  1
     C                     MOVEL*BLANK    WL0094  1
     C                     MOVEL*BLANK    WL0095  1
     C                     MOVEL*BLANK    WL0096  2
     C                     MOVEL*BLANK    WL0097  3
     C                     MOVEL*BLANK    WL0098  1
     C                     MOVEL*BLANK    WL0099  1
     C                     MOVEL*BLANK    WL0100  1
     C                     MOVEL*BLANK    WL0101  1
     C                     Z-ADD*ZERO     WL0102  60
     C                     MOVEL*BLANK    WL0103 10
     C                     MOVEL*BLANK    WL0104 10
     C                     Z-ADD*ZERO     WL0105  70
      * Define local variables for subroutine SZDLRC.
     C                     Z-ADD*ZERO     WL0106  30
     C                     Z-ADD*ZERO     WL0107  70
     C                     MOVEL*BLANK    WL0108  3
     C                     Z-ADD*ZERO     WL0109  70
     C                     Z-ADD*ZERO     WL0110  50
     C                     MOVEL*BLANK    WL0111  4
     C                     Z-ADD*ZERO     WL0112  20
      * Define local variables for subroutine TARVGN.
     C                     Z-ADD*ZERO     WL0113  30
     C                     Z-ADD*ZERO     WL0114  70
     C                     MOVEL*BLANK    WL0115  3
     C                     Z-ADD*ZERO     WL0116  70
      * Define local variables for subroutine TCCHRC.
     C                     Z-ADD*ZERO     WL0117  30
     C                     Z-ADD*ZERO     WL0118  70
     C                     Z-ADD*ZERO     WL0119  30
     C                     Z-ADD*ZERO     WL0120  30
     C                     Z-ADD*ZERO     WL0121  50
     C                     MOVEL*BLANK    WL0122  1
      * Define local variables for subroutine TPRVGN.
     C                     MOVEL*BLANK    WL0123 10
     C                     MOVEL*BLANK    WL0124  6
     C                     Z-ADD*ZERO     WL0125  30
     C                     MOVEL*BLANK    WL0126  3
      * Define local work field WHS Live with Carlisle
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field WHS PFS Interface
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Plant Company Sts
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Company Organization
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field COA Batch Header RIN
     C                     MOVEL*BLANK    YL0005 38
      * Define local work field Send Email f/Failed API U
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field Trans Contol AS400_Plant
     C                     MOVEL*BLANK    YL0007  1
      * Define local work field Warehouse Location
     C                     MOVEL*BLANK    YL0008  1
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0009  30
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0010  30
      * Define local work field WHS Live with Carlisle
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field Send Email f/Failed API U
     C                     MOVEL*BLANK    YL0012  1
      * Define local work field Current System Date
     C                     Z-ADD*ZERO     YL0013 155
      * Define local work field Current System Time
     C                     Z-ADD*ZERO     YL0014 155
      * Define local work field API was Called? U
     C                     MOVEL*BLANK    YL0015  1
      * Define local work field Inventory Updated USR
     C                     MOVEL*BLANK    YL0016  1
      * Define local work field First Time Through USR
     C                     MOVEL*BLANK    YL0017  1
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0018  1
      * Define local work field Quality Level
     C                     MOVEL*BLANK    YL0019  2
      * Define local work field Office Message USR
     C                     MOVEL*BLANK    YL0020132
      * Define local work field DL List ID
     C                     MOVEL*BLANK    YL0021 10
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0022  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0023  3
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     Z-ADD11        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      *
     C                     MOVEL*BLANK    WN0718 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0718           User Profile Na
      *
     C                     MOVEL*BLANK    WN0719 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR TORVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,004                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0718    ZA0032           User Profile Na
     C                     MOVEL'OMS'     ZA0033           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0719    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0718    WL0123    P      User Profile Na
     C                     MOVEL'OMS'     WL0124    P      Application Cod
     C                     EXSR TPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0125    P1AIC3           Company Number
     C                     MOVELWL0126    YL0023    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0719    WL0123    P      User Profile Na
     C                     MOVEL'OMS'     WL0124    P      Application Cod
     C                     EXSR TPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0125    P1AIC3           Company Number
     C                     MOVELWL0126    YL0023    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0023    P2AJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0718    ZA0034           User Profile Na
     C                     MOVEL'OMS'     ZA0035           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0022    IFNE 0                          *IF
     C                     Z-ADDYL0022    P1AIC3           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0023    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           P2AJCD    PARM *BLANK    WQ0109  3        Warehouse Code
     C                     PARM YL0022    WQ0110  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR TQRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
      * Rtv Allow Multi-Whs   RT - User Profile Control  * 
     C                     EXSR TSRVGN
     C                     MOVEL'Y'       P2TAST           First Time Flag
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** W0BEG
01041010480153801794025640256802576
02585025880259602620026300281802820
02824028320284102844028520287602886
** W0END
01043010770161501871025660257402582
02585025940261802627026370281802822
02830028380284102850028740288302893
** W0NAM
#CAJCD    #CO6NA    **SPT     #2ST1     V2AIC3    #2RMNB    V2C4NB
#2GWST    V2BKC7    #2BRTX    V2A0DT    V2GNDT    #1SEL     V1AIC3
#1RMNB    V1C4NB    #1GWST    V1BKC7    #1BRTX    V1A0DT    V1GNDT
** @CN
00001 USR0752
00002 PDMLDFR
00003 Unship Order
00004 Y2U0005
00005 UNSHIP
00006 PRKUNSHIP
