// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PUOIXFR
// ?Date: 14.08.2025 Time: 03:50:57
// ?------------------------------------------------------------------------------------------------

//?Execute user function

// Execute function EUS EDI 856 Data Dfn  US.
EXECUTE FUNCTION(EUS EDI 856 Data Dfn  US) TYPE(EXCUSRSRC) ('PUOKUFR');
{
 * Declare EDI 856 Data Definitions
 D digits          C                   '0123456789'
}


EXECUTE FUNCTION(Exc Crt EDI 856 ASN V2 RT) TYPE(RTVOBJ) FILE(OPBFCPP)          AC2177039;
PARAMETER(PAR.Load_ID);
PARAMETER(PAR.Bill_to_Customer);
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.F17_Pressed_USR);
{
 //?USER: Initialize routine

 //?W108669 DN 11/09/22-One Time Processing to Reset 'Error' OHE EDI 856 Sts.
 // LCL.First Time Through USR = CND.Yes
 LCL.First_Time_Through_USR = 'Y';

 //?USER: Process Data record

 //?INITIALIZATION:
 CASE;

 // IF *OTHERWISE
 IF *OTHERWISE;

 // PAR.Create EDI ASN 856 V2 USR = CND.No
 PAR.Create_EDI_ASN_856_V2_USR = 'N';

 // PAR.OHE EDI Error Reasons 2 = CND.Blank
 PAR.OHE_EDI_Error_Reasons_2 = *BLANK;

 ENDIF;

 //?VALIDATIONS:
 CASE;

 // IF *OTHERWISE
 IF *OTHERWISE;

 EXECUTE FUNCTION(Val Cust Setup 4/856 V2IF) TYPE(EXCINTFUN)                     AC2178250;
 PARAMETER(PAR.Create_EDI_ASN_856_V2_USR);
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 PARAMETER(DB1.Bill_to_Customer);
 PARAMETER(LCL.EDI_Trading_Partner_No);
 PARAMETER(LCL.Country_Code);
 PARAMETER(LCL.Warehouse_Code);
 PARAMETER(LCL.Warehouse_Location);
 PARAMETER(*BLANK);
 {
  //?Execute internal function

  //?VALIDATIONS: Is Bill To Customer Setup for EDI 856 ASN V2?
  CASE;

  // IF *OTHERWISE
  IF *OTHERWISE;

  // PAR.Create EDI ASN 856 V2 USR = CND.No
  PAR.Create_EDI_ASN_856_V2_USR = 'N';

  EXECUTE FUNCTION(RTV EDI ASN 856 Info  RT) TYPE(RTVOBJ) FILE(PNGQREP)           AC2177034;
  PARAMETER(PAR.Bill_to_Customer);
  PARAMETER('ADVSN');
  PARAMETER(PAR.EDI_Trading_Partner_No);
  PARAMETER(LCL.EDI_Detailed_ASN_856_Rqd);
  PARAMETER(LCL.Record_Status);
  {
   //?USER: Initialize routine

   MOVE *ALL (To: PAR From: CON);

   //?USER: Process Data record

   MOVE *ALL (To: PAR From: DB1);

  }

  //?Do Not Check Customer & Warehouse if Coming From PDN2XFR Program.
  CASE;

  //?Do Not Check Customer & Warehouse if Coming From PDN2XFR Program.
  // IF *OTHERWISE
  IF *OTHERWISE;

  //?Bill To Customer Must Be Active & Setup for EDI 856.
  CASE;

  // IF LCL.EDI Detailed ASN 856 Rqd is Yes
  IF LCL.EDI_Detailed_ASN_856_Rqd = 'Y';

  // AND LCL.Record Status is Active
  AND LCL.Record_Status = 'A';

  // PAR.Create EDI ASN 856 V2 USR = CND.Yes
  PAR.Create_EDI_ASN_856_V2_USR = 'Y';

  ENDIF;

  //?WI609_2 Check Internal or External Warehouse Qualifies for 856 ASN.
  CASE;

  // IF PAR.Create EDI ASN 856 V2 USR is Yes
  IF PAR.Create_EDI_ASN_856_V2_USR = 'Y';

  EXECUTE FUNCTION(RTV 1st Whse/Country   RT) TYPE(RTVOBJ) FILE(OPBGWKP)          AC1426676;
  PARAMETER(PAR.Company_Number);
  PARAMETER(PAR.Order_Number);
  PARAMETER(1);
  PARAMETER(1);
  PARAMETER(LCL.Warehouse_Code);
  PARAMETER(PAR.Country_Code);
  {
   //?USER: Process Data record

   MOVE *ALL (To: PAR From: DB1);

   QUIT;

  }

  EXECUTE FUNCTION(Rtv EDI 856 ASN Info RT) TYPE(RTVOBJ) FILE(CAADREP)            AC2234972;
  PARAMETER(LCL.Warehouse_Code);
  PARAMETER(LCL.Warehouse_Location);
  PARAMETER(LCL.WHS_Live_with_Carlisle);
  PARAMETER(NLL.WHS_PFS_Interface);
  PARAMETER(LCL.Crt_856_ASN_for_3PL_Whse);
  {
   //?USER: Processing if Data record not found

   MOVE *ALL (To: PAR From: CON);

   //?USER: Process Data record

   MOVE *ALL (To: PAR From: DB1);

  }

  // PAR.Warehouse Location = LCL.Warehouse Location
  PAR.Warehouse_Location = LCL.Warehouse_Location;

  CASE;

  // IF LCL.Warehouse Location is Internal (Plant)
  IF LCL.Warehouse_Location = 'I';

  // AND LCL.WHS Live w/Carlisle is Yes
  AND LCL.WHS_Live_with_Carlisle = 'Y';

  // PAR.Create EDI ASN 856 V2 USR = CND.Yes
  PAR.Create_EDI_ASN_856_V2_USR = 'Y';

  // PAR.Warehouse Code = LCL.Warehouse Code
  PAR.Warehouse_Code = LCL.Warehouse_Code;

  // IF *OTHERWISE
  IF *OTHERWISE;

  // PAR.Create EDI ASN 856 V2 USR = CND.No
  PAR.Create_EDI_ASN_856_V2_USR = 'N';

  //?WI609_2 JM 10/08/24-Allow External 3PL Warehouses to Receive EDI 856 ASN.
  CASE;

  // IF LCL.Warehouse Location is External
  IF LCL.Warehouse_Location = 'E';

  CASE;

  // IF LCL.Crt 856 ASN for 3PL Whse is Yes
  IF LCL.Crt_856_ASN_for_3PL_Whse = 'Y';

  // PAR.Create EDI ASN 856 V2 USR = CND.Yes
  PAR.Create_EDI_ASN_856_V2_USR = 'Y';

  // PAR.Warehouse Code = LCL.Warehouse Code
  PAR.Warehouse_Code = LCL.Warehouse_Code;

  ENDIF;

  ENDIF;

  ENDIF;

  ENDIF;

  //?WI609_2 JM 10/08/24-Check EDI Manual PO.
  CASE;

  // IF PAR.Create EDI ASN 856 V2 USR is Yes
  IF PAR.Create_EDI_ASN_856_V2_USR = 'Y';

  // Call program Rtv EDI Manual PO Sts XF.
  CALL PROGRAM(Rtv EDI Manual PO Sts XF) ('PUTBXFR');
  PARAMETER(PAR.Company_Number);
  PARAMETER(PAR.Order_Number);
  PARAMETER('ADVSN');
  PARAMETER(LCL.Send_EDI_Document_Y_N);

  //?If Send EDI Documents = N, set Create EDI ASN 856 V2 USR = N
  CASE;

  // IF LCL.Send EDI Document Y/N is No
  IF LCL.Send_EDI_Document_Y_N = 'N';

  // PAR.Create EDI ASN 856 V2 USR = CND.No
  PAR.Create_EDI_ASN_856_V2_USR = 'N';

  ENDIF;

  ENDIF;

  ENDIF;

  ENDIF;

 }

 //?R17040 DN 03/05/21-Additional Validations.
 CASE;

 // IF *OTHERWISE
 IF *OTHERWISE;

 //?WI609_2 JM 03/12/25-Only allow Same Load/BTC/Company toRecreate 856.
 CASE;

 // IF PAR.Create EDI ASN 856 V2 USR is Yes
 IF PAR.Create_EDI_ASN_856_V2_USR = 'Y';

 //?WI609_2 JM 03/12/25-Only allow Same Load/BTC/Company toRecreate 856.
 CASE;

 // IF PAR.F17 Pressed USR is Yes
 IF PAR.F17_Pressed_USR = 'Y';

 CASE;

 // IF DB1.Bill to Customer EQ PAR.Bill to Customer
 IF DB1.Bill_to_Customer = PAR.Bill_to_Customer;

 // AND DB1.Company Number EQ PAR.Company Number
 AND DB1.Company_Number = PAR.Company_Number;

 // PAR.Create EDI ASN 856 V2 USR = CND.Yes
 PAR.Create_EDI_ASN_856_V2_USR = 'Y';

 // IF *OTHERWISE
 IF *OTHERWISE;

 // PAR.Create EDI ASN 856 V2 USR = CND.No
 PAR.Create_EDI_ASN_856_V2_USR = 'N';

 ENDIF;

 //?WI609_2 JM 03/12/25-Only allow Same Load/BTC/Company toRecreate 856.
 // IF *OTHERWISE
 IF *OTHERWISE;

 //?This scenario will handle Loads with different Bill To Customers
 //?that may have a Load(s) that may have already been 'Sent'.
 EXECUTE FUNCTION(RTV EDI 856/824 Sts    RT) TYPE(RTVOBJ) FILE(PMAMREP)          AC2176913;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 PARAMETER(NLL.OHE_EDI_Error_Reasons_2);
 PARAMETER(LCL.OHE_EDI_856_Action);
 PARAMETER(NLL.OHE_EDI_824_Action);
 {
  //?USER: Initialize routine

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 CASE;

 // IF LCL.OHE EDI 856 Action is Sent
 IF LCL.OHE_EDI_856_Action = 'S';

 // PAR.Create EDI ASN 856 V2 USR = CND.No
 PAR.Create_EDI_ASN_856_V2_USR = 'N';

 ENDIF;

 ENDIF;

 ENDIF;

 //?If Trade Partner Control is Setup, Check for Held EDI 856.
 CASE;

 // IF PAR.Create EDI ASN 856 V2 USR is Yes
 IF PAR.Create_EDI_ASN_856_V2_USR = 'Y';

 EXECUTE FUNCTION(RTV EDI 856 Cntrl Flag RT) TYPE(RTVOBJ) FILE(PBB8REP)          AC2195453;
 PARAMETER(LCL.EDI_Trading_Partner_No);
 PARAMETER(LCL.Hold_856_f_Cust_Asgn_App#);
 PARAMETER(LCL.Hold_856_f_Carr_PRO);
 {
  //?USER: Initialize routine

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 CASE;

 // IF LCL.Hold 856 f/Cust Asgn App# is Yes
 IF LCL.Hold_856_f_Cust_Asgn_App# = 'Y';

 // OR LCL.Hold 856 f/Carr PRO is Yes
 OR LCL.Hold_856_f_Carr_PRO = 'Y';

 // Call program Val Upd Held 856 f/TP XF.
 CALL PROGRAM(Val Upd Held 856 f/TP XF) ('PUSWXFR');
 PARAMETER(PAR.Load_ID);
 PARAMETER(DB1.Bill_to_Customer);
 PARAMETER(LCL.Hold_856_f_Cust_Asgn_App#);
 PARAMETER(LCL.Hold_856_f_Carr_PRO);
 PARAMETER(PAR.Create_EDI_ASN_856_V2_USR);

 ENDIF;

 ENDIF;

 //?WI609_2 JM 02/27/25-Checkfor Load/BTC#/Co that AllOrders Have Been shipped
 CASE;

 // IF PAR.Create EDI ASN 856 V2 USR is Yes
 IF PAR.Create_EDI_ASN_856_V2_USR = 'Y';

 // Call program Val All Orders Shipped XF.
 CALL PROGRAM(Val All Orders Shipped XF) ('PVJ5XFR');
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Bill_to_Customer);
 PARAMETER(DB1.Load_ID);
 PARAMETER(LCL.All_Orders_Shipped_2_USR);

 CASE;

 // IF LCL.All Orders Shipped 2 USR is No
 IF LCL.All_Orders_Shipped_2_USR = 'N';

 // PAR.Create EDI ASN 856 V2 USR = CND.No
 PAR.Create_EDI_ASN_856_V2_USR = 'N';

 ENDIF;

 ENDIF;

 ENDIF;

 //?Validate All Pallet ID Must Be Entered for all Orders on Load.
 CASE;

 // IF PAR.Create EDI ASN 856 V2 USR is Yes
 IF PAR.Create_EDI_ASN_856_V2_USR = 'Y';

 //?W108669 DN 11/09/22-One Time Processing to Reset 'Error' OHE EDI 856 Sts.
 CASE;

 // IF LCL.First Time Through USR is Yes
 IF LCL.First_Time_Through_USR = 'Y';

 // LCL.First Time Through USR = CND.No
 LCL.First_Time_Through_USR = 'N';

 EXECUTE FUNCTION(Upd OHE EDI 856 Error2 RT) TYPE(RTVOBJ) FILE(PMAMREP)          AC2209945;
 PARAMETER(PAR.Load_ID);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 {
  //?USER: Process Data record

  //?Reset for Invalid Pallet ID=0 Only.
  CASE;

  // IF DB1.OHE EDI 856 Action is Snd-Error
  IF DB1.OHE_EDI_856_Action = 'E';

  // AND DB1.OHE EDI Error Reasons 2 is Invalid Pallet
  AND DB1.OHE_EDI_Error_Reasons_2 = 'PALLT';

  EXECUTE FUNCTION(CHG OHE EDI 856 Error  CH) TYPE(CHGOBJ) FILE(PMAMREP)          AC2177297;
  PARAMETER(DB1.Company_Number);
  PARAMETER(DB1.Order_Number);
  PARAMETER(PAR.OHE_EDI_Error_Reasons_2);
  PARAMETER(PAR.OHE_EDI_856_Action);
  {
   //?USER: Processing before Data update

   // DB1.Job Time = JOB.*Job time
   DB1.Job_Time = JOB.*Job_time;

   // DB1.Job Date = JOB.*Job date
   DB1.Job_Date = JOB.*Job_date;

   // DB1.Job Name = JOB.*PROGRAM
   DB1.Job_Name = JOB.*PROGRAM;

   // DB1.User Id = JOB.*USER
   DB1.User_Id = JOB.*USER;

  }

  ENDIF;

 }

 ENDIF;

 //?W108669 DN 11/08/22-Added 'Create EDI ASN 856 V2 USR' Flag.
 CASE;

 // IF LCL.Warehouse Location is Internal (Plant)
 IF LCL.Warehouse_Location = 'I';

 // Call program Val Pallet ID 4/856   XF.
 CALL PROGRAM(Val Pallet ID 4/856   XF) ('PUO1XFR');
 PARAMETER(PAR.Load_ID);
 PARAMETER(PAR.Set_EDI_856_Pallet_ID1_U);
 PARAMETER(PAR.Create_EDI_ASN_856_V2_USR);

 ENDIF;

 ENDIF;

 ENDIF;

 //?PROCESS: Create EDI 856 ASN V2 Data Sets.
 CASE;

 // IF PAR.Create EDI ASN 856 V2 USR is Yes
 IF PAR.Create_EDI_ASN_856_V2_USR = 'Y';

 //?Break by BTC#/Co.
 CASE;

 // IF DB1.Bill to Customer NE LCL.Bill to Customer
 IF DB1.Bill_to_Customer <> LCL.Bill_to_Customer;

 // OR DB1.Company Number NE LCL.Company Number
 OR DB1.Company_Number <> LCL.Company_Number;

 //?Save Break Level.
 // LCL.Bill to Customer = DB1.Bill to Customer
 LCL.Bill_to_Customer = DB1.Bill_to_Customer;

 // LCL.Company Number = DB1.Company Number
 LCL.Company_Number = DB1.Company_Number;

 //?Create EDI Adv Ship Ntc HDR (ECP139), DTL (ECP140) & TARE (ECP145).
 CASE;

 // IF *OTHERWISE
 IF *OTHERWISE;

 // PAR.EDI SURROGATE NUMBER = CON.999999999
 PAR.EDI_SURROGATE_NUMBER = 999999999;

 //?04/17/24 SP S310456 - Add record in ECP139 in "Rtv Next Surrogate #  RT"
 EXECUTE FUNCTION(CRT ECP139 & Get Nxt Surr) TYPE(RTVOBJ) FILE(ECP139)           AC2177165;
 PARAMETER(PAR.EDI_SURROGATE_NUMBER);
 PARAMETER(PAR.Load_ID);
 PARAMETER(LCL.EDI_Trading_Partner_No);
 {
  //?USER: Processing if Data record not found

  // PAR.EDI SURROGATE NUMBER = CON.100
  PAR.EDI_SURROGATE_NUMBER = 100;

  //?USER: Process Data record

  // PAR.EDI SURROGATE NUMBER = DB1.EDI SURROGATE NUMBER + CON.1
  PAR.EDI_SURROGATE_NUMBER = DB1.EDI_SURROGATE_NUMBER + 1;

  EXECUTE FUNCTION(Crt EDI ASN Headr V2  CR) TYPE(CRTOBJ) FILE(ECP139)            AC2175254;
  PARAMETER(PAR.EDI_SURROGATE_NUMBER);
  PARAMETER(PAR.Load_ID);
  PARAMETER(PAR.EDI_Trading_Partner_No);
  PARAMETER(LCL.EDI_Record_Processed);
  PARAMETER(LCL.W0501_Order_Status_Code);
  PARAMETER(LCL.DTM02_Schedule_Ship_Date);
  PARAMETER(LCL.DTM03_Scheduled_Ship_Time);
  PARAMETER(LCL.DTM02_Schedule_Del_Date);
  PARAMETER(LCL.DTM03_Schedule_Del_Time);
  PARAMETER(LCL.TD102_Case_Quantity);
  PARAMETER(LCL.TD107_Weight_Net);
  PARAMETER(LCL.TD107_Weight_Gross);
  PARAMETER(LCL.TD303_Equipment_Nbr);
  PARAMETER(LCL.TD503_Carrier_Name);
  PARAMETER(LCL.TD503_SCAC_Carrer_Code);
  PARAMETER(LCL.TD504_Trans_Type_Code);
  PARAMETER(LCL.DTM02_Date_Estimated_Dlv);
  PARAMETER(LCL.DTM02_Actual_Ship_Date);
  PARAMETER(LCL.DTM02_Unused_Date_3);
  PARAMETER(LCL.DTM02_Unused_Date_4);
  PARAMETER(LCL.REF02_AO_Cust_AssgnAppt_#);
  PARAMETER(LCL.GSIN_Shipment_Number);
  PARAMETER(LCL.REF_CN_Carrier_Reference);
  PARAMETER(LCL.FOB01_SHPMT_METHOD_OF_PAY);
  PARAMETER(LCL.TD102_Pallet_Count_Hdr);
  PARAMETER(LCL.Unit_Count_Hdr);
  QUIT;

 }

 // LCL.Scheduled Ship Dte USR = DB1.Scheduled Ship Date
 LCL.Scheduled_Ship_Dte_USR = DB1.Scheduled_Ship_Date;

 // LCL.Actual Shipped Date USR = DB1.Actual Shipped Date
 LCL.Actual_Shipped_Date_USR = DB1.Actual_Shipped_Date;

 // LCL.Requested Delivery DteUSR = DB1.Requested Delivery Date
 LCL.Requested_Delivery_DteUSR = DB1.Requested_Delivery_Date;

 EXECUTE FUNCTION(RTV Carrier & Trailer  RT) TYPE(RTVOBJ) FILE(OMFJCPP)          AC2038863;
 PARAMETER(PAR.Load_ID);
 PARAMETER(LCL.Trailer_Id);
 PARAMETER(LCL.Carrier_Code);
 {
  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 EXECUTE FUNCTION(RTV Carrier Name       RT) TYPE(RTVOBJ) FILE(OMFFREP)          AC1382687;
 PARAMETER(LCL.Carrier_Code);
 PARAMETER(LCL.Name);
 PARAMETER(NLL.Record_Status);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  // PGM.*Return code = CND.*Record does not exist
  PGM.*Return_code = 'Y2U0005';

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

  // PGM.*Return code = CND.*Normal
  PGM.*Return_code = *BLANK;

 }

 // LCL.TD503-SCAC Carrer Code = SUBSTRING(LCL.Name,CON.1,CON.4)
 LCL.TD503_SCAC_Carrer_Code = SUBSTRING(LCL.Name:1:4);

 //?R17040 DN 03/04/21-Set 'FOB01-SHPMT METHOD OF PAY' Field.
 //?Set TD504-Trans Type Code & FOB01-SHPMT METHOD OF PAY.
 CASE;

 // IF DB1.Shipping Method is Collect Truck
 IF DB1.Shipping_Method = 'CT';

 // LCL.TD504-Trans Type Code = CND.Customer Pickup
 LCL.TD504_Trans_Type_Code = 'H';

 // LCL.FOB01-SHPMT METHOD OF PAY = CON.PU
 LCL.FOB01_SHPMT_METHOD_OF_PAY = 'PU';

 //?Set TD504-Trans Type Code & FOB01-SHPMT METHOD OF PAY.
 // IF DB1.Shipping Method is Prepaid Truck
 IF DB1.Shipping_Method = 'PT';

 // LCL.TD504-Trans Type Code = CND.Motor(Common Carrier)
 LCL.TD504_Trans_Type_Code = 'M';

 // LCL.FOB01-SHPMT METHOD OF PAY = CON.PP
 LCL.FOB01_SHPMT_METHOD_OF_PAY = 'PP';

 //?Set TD504-Trans Type Code & FOB01-SHPMT METHOD OF PAY.
 // IF *OTHERWISE
 IF *OTHERWISE;

 // LCL.TD504-Trans Type Code = CND.Blank
 LCL.TD504_Trans_Type_Code = *BLANK;

 // LCL.FOB01-SHPMT METHOD OF PAY = CON.*BLANK
 LCL.FOB01_SHPMT_METHOD_OF_PAY = *BLANK;

 ENDIF;

 //?Set Schedule Delivery Date/Time.
 CASE;

 // IF *OTHERWISE
 IF *OTHERWISE;

 //?R17040 DN 03/03/21-Get Carrier Ref PRO/Inv & Cust Assigned Appt #.
 EXECUTE FUNCTION(RTV Order Info by Load RT) TYPE(RTVOBJ) FILE(OMFLCPP)          AC1814603;
 PARAMETER(PAR.Load_ID);
 PARAMETER(NLL.Stop_Drop_Sequence_Number);
 PARAMETER(NLL.Stop_Drop);
 PARAMETER(NLL.Comments_for_Pickup);
 PARAMETER(NLL.Miles_to_next_stop);
 PARAMETER(NLL.Freight_Charge);
 PARAMETER(NLL.Ld_Hdr_Ld_Dtl_Unused);
 PARAMETER(NLL.Freight_Misc_Charge);
 PARAMETER(NLL.Freight_Stop_Charge);
 PARAMETER(NLL.Rated_Freight);
 PARAMETER(NLL.Company_Number);
 PARAMETER(DB1.Order_Number);
 PARAMETER(NLL.Ship_Status);
 PARAMETER(NLL.Estimated_Arrival_Date);
 PARAMETER(NLL.Estimated_Arrival_Time);
 PARAMETER(NLL.Appointment_Confirm_Date);
 PARAMETER(NLL.Appointment_Confirm_Time);
 PARAMETER(NLL.Confirmation_Made_With);
 PARAMETER(NLL.Confirmation_Number);
 PARAMETER(NLL.Actual_Delivery_Date);
 PARAMETER(NLL.Actual_Delivery_time);
 PARAMETER(LCL.Scheduled_Delivery_Date);
 PARAMETER(LCL.Scheduled_Delivery_Time);
 PARAMETER(NLL.Deadline_Depart_DT_HDR);
 PARAMETER(NLL.Deadline_Depart_Time_HDR);
 PARAMETER(NLL.On_Yard_Date);
 PARAMETER(NLL.On_Yard_Time);
 PARAMETER(NLL.MPC_Number);
 PARAMETER(NLL.Load_Dtl_On_Time_Flag);
 PARAMETER(NLL.On_Time_Addl_Rsn_Unused);
 PARAMETER(NLL.Seal_Nbr_1);
 PARAMETER(NLL.Seal_Nbr_2);
 PARAMETER(NLL.Seal_Nbr_3);
 PARAMETER(NLL.Seal_Nbr_4);
 PARAMETER(NLL.Seal_Nbr_5);
 PARAMETER(LCL.LD_Carrier_Appt_Date);
 PARAMETER(NLL.LD_Unused_Date_2);
 PARAMETER(NLL.LD_Unused_Date_3);
 PARAMETER(LCL.LD_Carrier_Appt_Time);
 PARAMETER(NLL.LD_Unused_Time_2);
 PARAMETER(NLL.LD_Unused_Time_3);
 PARAMETER(NLL.Miles_Error_Sts);
 PARAMETER(NLL.LD_Unused_Sts_2);
 PARAMETER(NLL.HPB_Transload_Station);
 PARAMETER(NLL.LD_Cst_Svc_Tracer_Cmmnt);
 PARAMETER(LCL.Carrier_Ref_PRO_Inv);
 PARAMETER(LCL.Cust_Assigned_Appt_#);
 PARAMETER(NLL.EDI_Status_1);
 PARAMETER(NLL.EDI_Status_2);
 PARAMETER(NLL.EDI_Status_3);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 //?If SDD is 0, try Carrier Appt Date.
 CASE;

 // IF LCL.Scheduled Delivery Date is not entered
 IF LCL.Scheduled_Delivery_Date = *ZERO;

 //?If CAD is 0, Try Requested Delivery Date.
 CASE;

 // IF LCL.LD Carrier Appt Date is Zeros
 IF LCL.LD_Carrier_Appt_Date = *ZERO;

 // LCL.Scheduled Delivery Date U = DB1.Requested Delivery Date
 LCL.Scheduled_Delivery_Date_U = DB1.Requested_Delivery_Date;

 // LCL.Scheduled Delivery Time = DB1.Requested Delivery Time
 LCL.Scheduled_Delivery_Time = DB1.Requested_Delivery_Time;

 //?If CAD is 0, Try Requested Delivery Date.
 // IF *OTHERWISE
 IF *OTHERWISE;

 // LCL.Scheduled Delivery Date U = LCL.LD Carrier Appt Date
 LCL.Scheduled_Delivery_Date_U = LCL.LD_Carrier_Appt_Date;

 // LCL.Scheduled Delivery Time = LCL.LD Carrier Appt Time
 LCL.Scheduled_Delivery_Time = LCL.LD_Carrier_Appt_Time;

 ENDIF;

 //?If SDD is 0, try Carrier Appt Date.
 // IF *OTHERWISE
 IF *OTHERWISE;

 // LCL.Scheduled Delivery Date U = LCL.Scheduled Delivery Date
 LCL.Scheduled_Delivery_Date_U = LCL.Scheduled_Delivery_Date;

 ENDIF;

 ENDIF;

 //?Sum up Qty/Wgt for all Orders for Same Load/BTC#/Co and Create
 //?EDI ASN Ntc Order V2 (ECP142), EDI ASN Ntc Dtl V2 (ECP140) &
 //?EDI ASN Ntc Tare V2 (ECP145).
 //?R17040 DN 03/08/21-Added 'Total Unit Count' & 'Total Pallet Count' to Parm
 //?S17064 DN 05/06/21-Added 'EDI Trading Partner No.' as Input Parm.
 // Call program Crt EDI 856 DTL & TARE XF.
 CALL PROGRAM(Crt EDI 856 DTL & TARE XF) ('PUONXFR');
 PARAMETER(PAR.Load_ID);
 PARAMETER(DB1.Bill_to_Customer);
 PARAMETER(DB1.Company_Number);
 PARAMETER(PAR.EDI_SURROGATE_NUMBER);
 PARAMETER(PAR.Set_EDI_856_Pallet_ID1_U);
 PARAMETER(LCL.EDI_Trading_Partner_No);
 PARAMETER(LCL.Total_Quantity_Ship_USR);
 PARAMETER(LCL.Total_Weight_Ship_USR);
 PARAMETER(LCL.Total_Gross_Weight_USR);
 PARAMETER(LCL.Total_Pallet_Count_Hdr_U);
 PARAMETER(LCL.Total_Unit_Count_Hdr_U);

 EXECUTE FUNCTION(Val Load ID Exist     RT) TYPE(RTVOBJ) FILE(ECP139)            AC2177717;
 PARAMETER(PAR.Load_ID);
 {
  //?USER: Process Data record

  QUIT;

 }

 //?Load ID exist set Order Status Code='Change' Else 'Original'.
 CASE;

 // IF PGM.*Return code is *Normal
 IF PGM.*Return_code = *BLANK;

 // LCL.W0501 Order Status Code = CND.R-Change
 LCL.W0501_Order_Status_Code = 'R';

 //?Load ID exist set Order Status Code='Change' Else 'Original'.
 // IF *OTHERWISE
 IF *OTHERWISE;

 // LCL.W0501 Order Status Code = CND.N-Original
 LCL.W0501_Order_Status_Code = 'N';

 ENDIF;

 //?R17040 DN 03/24/21-Execute Check Digit for Load ID.
 CASE;

 // IF *OTHERWISE
 IF *OTHERWISE;

 //?GSIN Shipment Number = Federal Tax ID || 00 || Load ID || Check Digit
 EXECUTE FUNCTION(Get Calc Check Digit 2 IF) TYPE(EXCINTFUN)                     AC2196320;
 PARAMETER(DB1.Load_ID);
 PARAMETER(DB1.Company_Number);
 PARAMETER(LCL.GSIN_Shipment_Number);
 {
  //?Execute internal function

  // PAR.GSIN Shipment Number = CND.Not Entered
  PAR.GSIN_Shipment_Number = *BLANK;

  //?SUM Up Odd & Even # Positions for Federal Tax ID.
  CASE;

  // IF *OTHERWISE
  IF *OTHERWISE;

  //?Substring Out Each Digit From Federal Tax ID.
  CASE;

  // IF *OTHERWISE
  IF *OTHERWISE;

  EXECUTE FUNCTION(RTV Federal Tax ID    RT) TYPE(RTVOBJ) FILE(CAABREP)           AC2149185;
  PARAMETER(PAR.Company_Number);
  PARAMETER(LCL.Federal_Tax_Id);
  {
   //?USER: Initialize routine

   MOVE *ALL (To: PAR From: CON);

   //?USER: Process Data record

   MOVE *ALL (To: PAR From: DB1);

  }

  // LCL.Text 7 Alpha Usr = SUBSTRING(LCL.Federal Tax Id.,CON.1,CON.7)
  LCL.Text_7_Alpha_Usr = SUBSTRING(LCL.Federal_Tax_Id:1:7);

  // LCL.Federal Tax ID 7 Byte U = LCL.Text 7 Alpha Usr
  LCL.Federal_Tax_ID_7_Byte_U = LCL.Text_7_Alpha_Usr;

  // LCL.Position 1 Text USR = SUBSTRING(LCL.Federal Tax ID 7 Byte U,CON.1,CON.1)
  LCL.Position_1_Text_USR = SUBSTRING(LCL.Federal_Tax_ID_7_Byte_U:1:1);

  // LCL.Position 2 Text USR = SUBSTRING(LCL.Federal Tax ID 7 Byte U,CON.2,CON.1)
  LCL.Position_2_Text_USR = SUBSTRING(LCL.Federal_Tax_ID_7_Byte_U:2:1);

  // LCL.Position 3 Text USR = SUBSTRING(LCL.Federal Tax ID 7 Byte U,CON.3,CON.1)
  LCL.Position_3_Text_USR = SUBSTRING(LCL.Federal_Tax_ID_7_Byte_U:3:1);

  // LCL.Position 4 Text USR = SUBSTRING(LCL.Federal Tax ID 7 Byte U,CON.4,CON.1)
  LCL.Position_4_Text_USR = SUBSTRING(LCL.Federal_Tax_ID_7_Byte_U:4:1);

  // LCL.Position 5 Text USR = SUBSTRING(LCL.Federal Tax ID 7 Byte U,CON.5,CON.1)
  LCL.Position_5_Text_USR = SUBSTRING(LCL.Federal_Tax_ID_7_Byte_U:5:1);

  // LCL.Position 6 Text USR = SUBSTRING(LCL.Federal Tax ID 7 Byte U,CON.6,CON.1)
  LCL.Position_6_Text_USR = SUBSTRING(LCL.Federal_Tax_ID_7_Byte_U:6:1);

  // LCL.Position 7 Text USR = SUBSTRING(LCL.Federal Tax ID 7 Byte U,CON.7,CON.1)
  LCL.Position_7_Text_USR = SUBSTRING(LCL.Federal_Tax_ID_7_Byte_U:7:1);

  // LCL.Federal Tax ID-Pos1 Nbr = CVTVAR(LCL.Position 1 Text USR)
  LCL.Federal_Tax_ID_Pos1_Nbr = CVTVAR(LCL.Position_1_Text_USR);

  // LCL.Federal Tax ID-Pos2 Nbr = CVTVAR(LCL.Position 2 Text USR)
  LCL.Federal_Tax_ID_Pos2_Nbr = CVTVAR(LCL.Position_2_Text_USR);

  // LCL.Federal Tax ID-Pos3 Nbr = CVTVAR(LCL.Position 3 Text USR)
  LCL.Federal_Tax_ID_Pos3_Nbr = CVTVAR(LCL.Position_3_Text_USR);

  // LCL.Federal Tax ID-Pos4 Nbr = CVTVAR(LCL.Position 4 Text USR)
  LCL.Federal_Tax_ID_Pos4_Nbr = CVTVAR(LCL.Position_4_Text_USR);

  // LCL.Federal Tax ID-Pos5 Nbr = CVTVAR(LCL.Position 5 Text USR)
  LCL.Federal_Tax_ID_Pos5_Nbr = CVTVAR(LCL.Position_5_Text_USR);

  // LCL.Federal Tax ID-Pos6 Nbr = CVTVAR(LCL.Position 6 Text USR)
  LCL.Federal_Tax_ID_Pos6_Nbr = CVTVAR(LCL.Position_6_Text_USR);

  // LCL.Federal Tax ID-Pos7 Nbr = CVTVAR(LCL.Position 7 Text USR)
  LCL.Federal_Tax_ID_Pos7_Nbr = CVTVAR(LCL.Position_7_Text_USR);

  ENDIF;

  // SUM Val for Odd # Pos
  PAR.SUM_Val_for_Odd_#_Pos = ( ( LCL.Federal_Tax_ID_Pos1_Nbr
  + LCL.Federal_Tax_ID_Pos3_Nbr ) + LCL.Federal_Tax_ID_Pos5_Nbr )
  + LCL.Federal_Tax_ID_Pos7_Nbr;

  // SUM Val for Even # Pos
  PAR.SUM_Val_for_Even_#_Pos = ( LCL.Federal_Tax_ID_Pos2_Nbr + LCL.Federal_Tax_ID_Pos4_Nbr )
  + LCL.Federal_Tax_ID_Pos6_Nbr;

  ENDIF;

  //?SUM Up Odd & Even # Positions for Load ID.
  CASE;

  // IF *OTHERWISE
  IF *OTHERWISE;

  //?Substring Out Each Digit From Load ID.
  CASE;

  // IF *OTHERWISE
  IF *OTHERWISE;

  // LCL.Load ID Alpha USR = CVTVAR(PAR.Load ID)
  LCL.Load_ID_Alpha_USR = CVTVAR(PAR.Load_ID);

  // LCL.Load ID Alpha 9 Byte U = CONCAT(CON.00,LCL.Load ID Alpha USR,CON.*ZERO)
  LCL.Load_ID_Alpha_9_Byte_U = '00' + LCL.Load_ID_Alpha_USR (*ZERO);

  // LCL.Position 1 Text USR = SUBSTRING(LCL.Load ID Alpha 9 Byte U,CON.1,CON.1)
  LCL.Position_1_Text_USR = SUBSTRING(LCL.Load_ID_Alpha_9_Byte_U:1:1);

  // LCL.Position 2 Text USR = SUBSTRING(LCL.Load ID Alpha 9 Byte U,CON.2,CON.1)
  LCL.Position_2_Text_USR = SUBSTRING(LCL.Load_ID_Alpha_9_Byte_U:2:1);

  // LCL.Position 3 Text USR = SUBSTRING(LCL.Load ID Alpha 9 Byte U,CON.3,CON.1)
  LCL.Position_3_Text_USR = SUBSTRING(LCL.Load_ID_Alpha_9_Byte_U:3:1);

  // LCL.Position 4 Text USR = SUBSTRING(LCL.Load ID Alpha 9 Byte U,CON.4,CON.1)
  LCL.Position_4_Text_USR = SUBSTRING(LCL.Load_ID_Alpha_9_Byte_U:4:1);

  // LCL.Position 5 Text USR = SUBSTRING(LCL.Load ID Alpha 9 Byte U,CON.5,CON.1)
  LCL.Position_5_Text_USR = SUBSTRING(LCL.Load_ID_Alpha_9_Byte_U:5:1);

  // LCL.Position 6 Text USR = SUBSTRING(LCL.Load ID Alpha 9 Byte U,CON.6,CON.1)
  LCL.Position_6_Text_USR = SUBSTRING(LCL.Load_ID_Alpha_9_Byte_U:6:1);

  // LCL.Position 7 Text USR = SUBSTRING(LCL.Load ID Alpha 9 Byte U,CON.7,CON.1)
  LCL.Position_7_Text_USR = SUBSTRING(LCL.Load_ID_Alpha_9_Byte_U:7:1);

  // LCL.Position 8 Text USR = SUBSTRING(LCL.Load ID Alpha 9 Byte U,CON.8,CON.1)
  LCL.Position_8_Text_USR = SUBSTRING(LCL.Load_ID_Alpha_9_Byte_U:8:1);

  // LCL.Position 9 Text USR = SUBSTRING(LCL.Load ID Alpha 9 Byte U,CON.9,CON.1)
  LCL.Position_9_Text_USR = SUBSTRING(LCL.Load_ID_Alpha_9_Byte_U:9:1);

  // LCL.Load ID-Pos1 Nbr U = CVTVAR(LCL.Position 1 Text USR)
  LCL.Load_ID_Pos1_Nbr_U = CVTVAR(LCL.Position_1_Text_USR);

  // LCL.Load ID-Pos2 Nbr U = CVTVAR(LCL.Position 2 Text USR)
  LCL.Load_ID_Pos2_Nbr_U = CVTVAR(LCL.Position_2_Text_USR);

  // LCL.Load ID-Pos3 Nbr U = CVTVAR(LCL.Position 3 Text USR)
  LCL.Load_ID_Pos3_Nbr_U = CVTVAR(LCL.Position_3_Text_USR);

  // LCL.Load ID-Pos4 Nbr U = CVTVAR(LCL.Position 4 Text USR)
  LCL.Load_ID_Pos4_Nbr_U = CVTVAR(LCL.Position_4_Text_USR);

  // LCL.Load ID-Pos5 Nbr U = CVTVAR(LCL.Position 5 Text USR)
  LCL.Load_ID_Pos5_Nbr_U = CVTVAR(LCL.Position_5_Text_USR);

  // LCL.Load ID-Pos6 Nbr U = CVTVAR(LCL.Position 6 Text USR)
  LCL.Load_ID_Pos6_Nbr_U = CVTVAR(LCL.Position_6_Text_USR);

  // LCL.Load ID-Pos7 Nbr U = CVTVAR(LCL.Position 7 Text USR)
  LCL.Load_ID_Pos7_Nbr_U = CVTVAR(LCL.Position_7_Text_USR);

  // LCL.Load ID-Pos8 Nbr U = CVTVAR(LCL.Position 8 Text USR)
  LCL.Load_ID_Pos8_Nbr_U = CVTVAR(LCL.Position_8_Text_USR);

  // LCL.Load ID-Pos9 Nbr U = CVTVAR(LCL.Position 9 Text USR)
  LCL.Load_ID_Pos9_Nbr_U = CVTVAR(LCL.Position_9_Text_USR);

  ENDIF;

  // SUM Val for Odd # Pos
  PAR.SUM_Val_for_Odd_#_Pos = ( ( ( ( PAR.SUM_Val_for_Odd_#_Pos + LCL.Load_ID_Pos1_Nbr_U )
  + LCL.Load_ID_Pos3_Nbr_U ) + LCL.Load_ID_Pos5_Nbr_U ) + LCL.Load_ID_Pos7_Nbr_U )
  + LCL.Load_ID_Pos9_Nbr_U;

  // SUM Val for Even # Pos
  PAR.SUM_Val_for_Even_#_Pos = ( ( ( PAR.SUM_Val_for_Even_#_Pos + LCL.Load_ID_Pos2_Nbr_U )
  + LCL.Load_ID_Pos4_Nbr_U ) + LCL.Load_ID_Pos6_Nbr_U ) + LCL.Load_ID_Pos8_Nbr_U;

  ENDIF;

  //?Calculated Check Digit Number.
  CASE;

  // IF *OTHERWISE
  IF *OTHERWISE;

  // Calculated Value
  LCL.Calc_Value_USR = ( PAR.SUM_Val_for_Odd_#_Pos * 3 ) + PAR.SUM_Val_for_Even_#_Pos;

  // LCL.Calc Value Last Digit USR = LCL.Calc Value USR
  LCL.Calc_Value_Last_Digit_USR = LCL.Calc_Value_USR;

  // LCL.Calc Check Digit# USR = CON.10 - LCL.Calc Value Last Digit USR
  LCL.Calc_Check_Digit#_USR = 10 - LCL.Calc_Value_Last_Digit_USR;

  ENDIF;

  //?Format GSIN Shipment Number for Output.
  CASE;

  // IF *OTHERWISE
  IF *OTHERWISE;

  // LCL.Calc Check Digit# Txt USR = CVTVAR(LCL.Calc Check Digit# USR)
  LCL.Calc_Check_Digit#_Txt_USR = CVTVAR(LCL.Calc_Check_Digit#_USR);

  // LCL.GSIN Shipment Number = CONCAT(LCL.Federal Tax ID 7 Byte U,LCL.Load ID Alpha 9 Byte U,CON.*Z
  LCL.GSIN_Shipment_Number = LCL.Federal_Tax_ID_7_Byte_U + LCL.Load_ID_Alpha_9_Byte_U (*ZERO);

  // LCL.GSIN Shipment Number = CONCAT(LCL.GSIN Shipment Number,LCL.Calc Check Digit# Txt USR,CON.*Z
  LCL.GSIN_Shipment_Number = LCL.GSIN_Shipment_Number + LCL.Calc_Check_Digit#_Txt_USR (*ZERO);

  // PAR.GSIN Shipment Number = LCL.GSIN Shipment Number
  PAR.GSIN_Shipment_Number = LCL.GSIN_Shipment_Number;

  ENDIF;

 }

 ENDIF;

 //?Note: Trailer Id is 20 bytes but Equipment Nbr fld is 10 bytes.
 //?Create EDI Adv Ship Ntc Headr V2 (ECP139).
 //?R17040 DN 03/04/21-Set New Fields.
 //?04/17/24 SP S310456-Start
 EXECUTE FUNCTION(Chg EDI ASN Headr V2  CH) TYPE(CHGOBJ) FILE(ECP139)            AC2175255;
 PARAMETER(PAR.EDI_SURROGATE_NUMBER);
 PARAMETER(PAR.Load_ID);
 PARAMETER(LCL.EDI_Trading_Partner_No);
 PARAMETER('N');
 PARAMETER(LCL.W0501_Order_Status_Code);
 PARAMETER(LCL.Scheduled_Ship_Dte_USR);
 PARAMETER(060000);
 PARAMETER(LCL.Scheduled_Delivery_Date_U);
 PARAMETER(LCL.Scheduled_Delivery_Time);
 PARAMETER(LCL.Total_Quantity_Ship_USR);
 PARAMETER(LCL.Total_Weight_Ship_USR);
 PARAMETER(LCL.Total_Gross_Weight_USR);
 PARAMETER(LCL.Trailer_Id);
 PARAMETER(LCL.Name);
 PARAMETER(LCL.TD503_SCAC_Carrer_Code);
 PARAMETER(LCL.TD504_Trans_Type_Code);
 PARAMETER(LCL.Requested_Delivery_DteUSR);
 PARAMETER(LCL.Actual_Shipped_Date_USR);
 PARAMETER(*ZERO);
 PARAMETER(*ZERO);
 PARAMETER(LCL.Cust_Assigned_Appt_#);
 PARAMETER(LCL.GSIN_Shipment_Number);
 PARAMETER(LCL.Carrier_Ref_PRO_Inv);
 PARAMETER(LCL.FOB01_SHPMT_METHOD_OF_PAY);
 PARAMETER(LCL.Total_Pallet_Count_Hdr_U);
 PARAMETER(LCL.Total_Unit_Count_Hdr_U);
 //?04/17/24 SP S310456-End
 ENDIF;

 //?Create EDI Adv Ship Ntc Name V2 (ECP141).
 CASE;

 // IF *OTHERWISE
 IF *OTHERWISE;

 //?Create Ship From 'SF' & Vendor 'VN' Record.
 CASE;

 // IF *OTHERWISE
 IF *OTHERWISE;

 //?Use Acct Co for Whse to know whose Product it is.
 EXECUTE FUNCTION(Rtv EDI 856 ASN Info  RT) TYPE(RTVOBJ) FILE(CAADREP)           AC2235008;
 PARAMETER(LCL.Warehouse_Code);
 PARAMETER(LCL.Warehouse_Description);
 PARAMETER(LCL.Address_Line_1);
 PARAMETER(LCL.Address_Line_2);
 PARAMETER(LCL.Address_Line_3);
 PARAMETER(LCL.City);
 PARAMETER(LCL.Zip_Postal_Code);
 PARAMETER(LCL.State_Code);
 PARAMETER(LCL.Warehouse_Location);
 PARAMETER(LCL.Accounting_Company);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 EXECUTE FUNCTION(RTV Name & Country     RT) TYPE(RTVOBJ) FILE(CAABREP)          AC2235009;
 PARAMETER(LCL.Accounting_Company);
 PARAMETER(LCL.N102_NAME);
 PARAMETER(LCL.Country_Code_USR);
 {
  //?USER: Initialize routine

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 //?WI609_2 JM 10/08/24-If External Warehouse, override N102-NAME
 CASE;

 // IF LCL.Warehouse Location is External
 IF LCL.Warehouse_Location = 'E';

 // LCL.N102-NAME = LCL.Warehouse Description
 LCL.N102_NAME = LCL.Warehouse_Description;

 ENDIF;

 //?Build ID Code from DUNSNUM & Acct Co.
 CASE;

 // IF *OTHERWISE
 IF *OTHERWISE;

 EXECUTE FUNCTION(RTV Alpha Value        RT) TYPE(RTVOBJ) FILE(PDKMREP)          AC1381513;
 PARAMETER(LCL.Accounting_Company);
 PARAMETER('DUNSNUM');
 PARAMETER(LCL.D_N104_DUNS_NBR);
 {
  //?USER: Processing if Data record not found

  // PGM.*Return code = CND.*Record does not exist
  PGM.*Return_code = 'Y2U0005';

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 //?Move Acct Co to a 4 position numeric.
 // LCL.Calc 4 = LCL.Accounting Company
 LCL.Calc_4 = LCL.Accounting_Company;

 //?Move Acct Co to a 4 position numeric to a alpha 4 field.
 // LCL.Amount Right 4 position = LCL.Calc 4
 LCL.Amount_Right_4_position = LCL.Calc_4;

 // LCL.Text USR 9 = LCL.D-N104-DUNS NBR
 LCL.Text_USR_9 = LCL.D_N104_DUNS_NBR;

 // LCL.N104-ID CODE = CONCAT(LCL.Text USR 9,LCL.Amount Right 4 position,CON.*ZERO)
 LCL.N104_ID_CODE = LCL.Text_USR_9 + LCL.Amount_Right_4_position (*ZERO);

 ENDIF;

 //?Suppress State Code.
 CASE;

 // IF LCL.State Code is International Accounts
 IF LCL.State_Code = '.';

 // LCL.State Code = CON.*BLANK
 LCL.State_Code = *BLANK;

 ENDIF;

 //?Suppress Zip Code.
 CASE;

 // IF LCL.Zip/Postal Code is International
 IF LCL.Zip_Postal_Code = '.';

 // LCL.Zip/Postal Code = CON.*BLANK
 LCL.Zip_Postal_Code = *BLANK;

 ENDIF;

 EXECUTE FUNCTION(Crt EDI ASN Name V2   CR) TYPE(CRTOBJ) FILE(ECP141)            AC2175932;
 PARAMETER(PAR.EDI_SURROGATE_NUMBER);
 PARAMETER(PAR.Load_ID);
 PARAMETER('SF');
 PARAMETER(LCL.N102_NAME);
 PARAMETER(LCL.N104_ID_CODE);
 PARAMETER(LCL.Address_Line_1);
 PARAMETER(LCL.Address_Line_2);
 PARAMETER(LCL.City);
 PARAMETER(LCL.State_Code);
 PARAMETER(LCL.Zip_Postal_Code);
 PARAMETER(LCL.Country_Code_USR);
 //?W100559 DN 06/14/22-Create Vendor 'VN' Record.
 CASE;

 // IF *OTHERWISE
 IF *OTHERWISE;

 EXECUTE FUNCTION(RTV ASN 856 Crt VN Name) TYPE(RTVOBJ) FILE(PBB8REP)            AC2206139;
 PARAMETER(LCL.EDI_Trading_Partner_No);
 PARAMETER(LCL.ASN_856_Crt_VN_Name);
 {
  //?USER: Initialize routine

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 CASE;

 // IF LCL.ASN 856 Crt VN Name is Yes
 IF LCL.ASN_856_Crt_VN_Name = 'Y';

 EXECUTE FUNCTION(Crt EDI ASN Name V2   CR) TYPE(CRTOBJ) FILE(ECP141)            AC2175932;
 PARAMETER(PAR.EDI_SURROGATE_NUMBER);
 PARAMETER(PAR.Load_ID);
 PARAMETER('VN');
 PARAMETER(LCL.N102_NAME);
 PARAMETER(LCL.N104_ID_CODE);
 PARAMETER(LCL.Address_Line_1);
 PARAMETER(LCL.Address_Line_2);
 PARAMETER(LCL.City);
 PARAMETER(LCL.State_Code);
 PARAMETER(LCL.Zip_Postal_Code);
 PARAMETER(LCL.Country_Code_USR);
 ENDIF;

 ENDIF;

 ENDIF;

 //?Create Ship To 'ST' Record.
 CASE;

 // IF *OTHERWISE
 IF *OTHERWISE;

 //?S17064 DN 05/06/21-Always use the Ship To Customer # to get DUNS #.
 //?Set ID Code from DUNS # by STC #.
 CASE;

 // IF *OTHERWISE
 IF *OTHERWISE;

 EXECUTE FUNCTION(Rtv EDI Cust Duns Nbr RT) TYPE(RTVOBJ) FILE(PDNEREP)           AC2175820;
 PARAMETER(DB1.Ship_To_Customer);
 PARAMETER(LCL.EDI_Cust_Duns_Number);
 {
  //?USER: Initialize routine

  // PAR.EDI Cust Duns Number = CON.*BLANK
  PAR.EDI_Cust_Duns_Number = *BLANK;

  //?USER: Process Data record

  // PAR.EDI Cust Duns Number = DB1.EDI Cust Duns Number
  PAR.EDI_Cust_Duns_Number = DB1.EDI_Cust_Duns_Number;

 }

 // LCL.N104-ID CODE = LCL.EDI Cust Duns Number
 LCL.N104_ID_CODE = LCL.EDI_Cust_Duns_Number;

 ENDIF;

 //?Suppress State Code.
 CASE;

 // IF DB1.Ship To State Code is International Accounts
 IF DB1.Ship_To_State_Code = '.';

 // LCL.Ship To State Code = CON.*BLANK
 LCL.Ship_To_State_Code = *BLANK;

 //?Suppress State Code.
 // IF *OTHERWISE
 IF *OTHERWISE;

 // LCL.Ship To State Code = DB1.Ship To State Code
 LCL.Ship_To_State_Code = DB1.Ship_To_State_Code;

 ENDIF;

 //?Suppress Zip Code.
 CASE;

 // IF DB1.Ship To Zip/Postal Code is International
 IF DB1.Ship_To_Zip_Postal_Code = '.';

 // LCL.Ship To Zip/Postal Code = CON.*BLANK
 LCL.Ship_To_Zip_Postal_Code = *BLANK;

 //?Suppress Zip Code.
 // IF *OTHERWISE
 IF *OTHERWISE;

 // LCL.Ship To Zip/Postal Code = DB1.Ship To Zip/Postal Code
 LCL.Ship_To_Zip_Postal_Code = DB1.Ship_To_Zip_Postal_Code;

 ENDIF;

 //?Set Country Code.    R17040 DN 03/31/21-Always set Country Code.
 CASE;

 // IF DB1.Ship To State Code is International Accounts
 IF DB1.Ship_To_State_Code = '.';

 //?Set Country Code.    R17040 DN 03/31/21-Always set Country Code.
 // IF *OTHERWISE
 IF *OTHERWISE;

 //?Always default to 'USA' if Blank.
 CASE;

 // IF LCL.Country Code is Blank
 IF LCL.Country_Code = *BLANK;

 // LCL.Country Code = CND.USA
 LCL.Country_Code = 'USA';

 ENDIF;

 ENDIF;

 //?Replace Special Charc with blank for Ship To Name, Addr Line 1&2.
 CASE;

 // IF *OTHERWISE
 IF *OTHERWISE;

 // LCL.String Text-Old USR = DB1.Ship To Name
 LCL.String_Text_Old_USR = DB1.Ship_To_Name;

 // Call program Exc Repl SpcChar 2 BlnkXF.
 CALL PROGRAM(Exc Repl SpcChar 2 BlnkXF) ('PUGPXFR');
 PARAMETER(LCL.String_Text_Old_USR);
 PARAMETER(LCL.String_Text_New_USR);

 // LCL.Ship To Name = LCL.String Text-New USR
 LCL.Ship_To_Name = LCL.String_Text_New_USR;

 //?WI464 DN 04/22/22-Commented Old Method to Format Ship To Address Line 1&2.
 //?Format/Set ST Address Line 1 & 2 If Address Line 1 is Blank. WI464 DN 4/22
 CASE;

 // IF DB1.Ship To Address Line 1 is Blank
 IF DB1.Ship_To_Address_Line_1 = *BLANK;

 // LCL.String Text-Old USR = DB1.Ship To Address Line 2
 LCL.String_Text_Old_USR = DB1.Ship_To_Address_Line_2;

 // Call program Exc Repl SpcChar 2 BlnkXF.
 CALL PROGRAM(Exc Repl SpcChar 2 BlnkXF) ('PUGPXFR');
 PARAMETER(LCL.String_Text_Old_USR);
 PARAMETER(LCL.String_Text_New_USR);

 // LCL.Ship To Address Line 1 = LCL.String Text-New USR
 LCL.Ship_To_Address_Line_1 = LCL.String_Text_New_USR;

 // LCL.Ship To Address Line 2 = CND.Blank
 LCL.Ship_To_Address_Line_2 = *BLANK;

 CASE;

 // IF DB1.Ship To Address Line 3 is NE Blank
 IF DB1.Ship_To_Address_Line_3 <> *BLANK;

 // LCL.String Text-Old USR = DB1.Ship To Address Line 3
 LCL.String_Text_Old_USR = DB1.Ship_To_Address_Line_3;

 // Call program Exc Repl SpcChar 2 BlnkXF.
 CALL PROGRAM(Exc Repl SpcChar 2 BlnkXF) ('PUGPXFR');
 PARAMETER(LCL.String_Text_Old_USR);
 PARAMETER(LCL.String_Text_New_USR);

 // LCL.Ship To Address Line 2 = LCL.String Text-New USR
 LCL.Ship_To_Address_Line_2 = LCL.String_Text_New_USR;

 ENDIF;

 //?Format/Set ST Address Line 1 & 2 If Address Line 1 is Blank. WI464 DN 4/22
 // IF *OTHERWISE
 IF *OTHERWISE;

 // LCL.String Text-Old USR = DB1.Ship To Address Line 1
 LCL.String_Text_Old_USR = DB1.Ship_To_Address_Line_1;

 // Call program Exc Repl SpcChar 2 BlnkXF.
 CALL PROGRAM(Exc Repl SpcChar 2 BlnkXF) ('PUGPXFR');
 PARAMETER(LCL.String_Text_Old_USR);
 PARAMETER(LCL.String_Text_New_USR);

 // LCL.Ship To Address Line 1 = LCL.String Text-New USR
 LCL.Ship_To_Address_Line_1 = LCL.String_Text_New_USR;

 // LCL.Ship To Address Line 2 = CND.Blank
 LCL.Ship_To_Address_Line_2 = *BLANK;

 CASE;

 // IF DB1.Ship To Address Line 2 is NE Blank
 IF DB1.Ship_To_Address_Line_2 <> *BLANK;

 // LCL.String Text-Old USR = DB1.Ship To Address Line 2
 LCL.String_Text_Old_USR = DB1.Ship_To_Address_Line_2;

 // Call program Exc Repl SpcChar 2 BlnkXF.
 CALL PROGRAM(Exc Repl SpcChar 2 BlnkXF) ('PUGPXFR');
 PARAMETER(LCL.String_Text_Old_USR);
 PARAMETER(LCL.String_Text_New_USR);

 // LCL.Ship To Address Line 2 = LCL.String Text-New USR
 LCL.Ship_To_Address_Line_2 = LCL.String_Text_New_USR;

 ENDIF;

 ENDIF;

 ENDIF;

 EXECUTE FUNCTION(Crt EDI ASN Name V2   CR) TYPE(CRTOBJ) FILE(ECP141)            AC2175932;
 PARAMETER(PAR.EDI_SURROGATE_NUMBER);
 PARAMETER(PAR.Load_ID);
 PARAMETER('ST');
 PARAMETER(LCL.Ship_To_Name);
 PARAMETER(LCL.N104_ID_CODE);
 PARAMETER(LCL.Ship_To_Address_Line_1);
 PARAMETER(LCL.Ship_To_Address_Line_2);
 PARAMETER(DB1.Ship_To_City);
 PARAMETER(LCL.Ship_To_State_Code);
 PARAMETER(LCL.Ship_To_Zip_Postal_Code);
 PARAMETER(LCL.Country_Code);
 ENDIF;

 ENDIF;

 ENDIF;

 ENDIF;

}


