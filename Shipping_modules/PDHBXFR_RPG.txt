     H/TITLE UPD Transfer Complete  XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 05/24/16  Time  : 08:12:51
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOPBFCPH7IF  E           K        DISK
      * RSQ : Order Header TRG          Ready to Complete Xfer
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FOPEYCPL1IF  E           K        DISK
      * RTV : Order Events              Retrieval index       NV
      *
     FOPEYCPL9IF  E           K        DISK
      * RSQ : Order Events              Co/Order/Event Code
      *
     FOPBFCPL8IF  E           K        DISK
      * RSQ : Order Header TRG          Load #/All orders
      *
     FOPEYCPL0IF  E           K        DISK                      A
      * UPD : Order Events              Update index
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FOMFJCPL1UF  E           K        DISK
      * UPD : Load Header               Update index
      *
      * Long constants
     E                    @CN#    1  02  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@BFCPH7
      * Order Header TRG          Ready to Complete Xfer
      * Renamed input format fields
     I              BEAIC3                          WAAIC3
     I              BEC4NB                          WAC4NB
     I              BEJNCD                          WAJNCD
     I              BEANC7                          WAANC7
     I              BEBKC7                          WABKC7
     I              BEBRTX                          WABRTX
     I              BEHMNA                          WAHMNA
     I              BEHONA                          WAHONA
     I              BEHPNA                          WAHPNA
     I              BEHNNA                          WAHNNA
     I              BEDBCD                          WADBCD
     I              BECKTX                          WACKTX
     I              BEB0C7                          WAB0C7
     I              BEAETX                          WAAETX
     I              BEB1NA                          WAB1NA
     I              BEB3NA                          WAB3NA
     I              BEB4NA                          WAB4NA
     I              BEB2NA                          WAB2NA
     I              BEBHCD                          WABHCD
     I              BEC8TX                          WAC8TX
     I              BEBCNA                          WABCNA
     I              BEA0DT                          WAA0DT
     I              BEA5DT                          WAA5DT
     I              BEGNDT                          WAGNDT
     I              BEACDT                          WAACDT
     I              BEAQCD                          WAAQCD
     I              BEB6NA                          WAB6NA
     I              BEBYNA                          WABYNA
     I              BEBZNA                          WABZNA
     I              BEGTST                          WAGTST
     I              BEGVST                          WAGVST
     I              BEGUST                          WAGUST
     I              BEQFST                          WAQFST
     I              BECQCD                          WACQCD
     I              BEGJST                          WAGJST
     I              BEGWST                          WAGWST
     I              BEGXST                          WAGXST
     I              BEGYST                          WAGYST
     I              BEAODT                          WAAODT
     I              BEAIVN                          WAAIVN
     I              BECXDT                          WACXDT
     I              BEJZVA                          WAJZVA
     I              BEA1WG                          WAA1WG
     I              BEXIST                          WAXIST
     I              BEXJST                          WAXJST
     I              BEXKST                          WAXKST
     I              BEEIDT                          WAEIDT
     I              BEAFTM                          WAAFTM
     I              BEE8CD                          WAE8CD
     I              BEE9CD                          WAE9CD
     I              BERMNB                          WARMNB
     I              BETBNB                          WATBNB
     I              BER1NB                          WAR1NB
     I              BEPJST                          WAPJST
     I              BEU0ST                          WAU0ST
     I              BEU1ST                          WAU1ST
     I              BEQ2CD                          WAQ2CD
     I              BEU2ST                          WAU2ST
     I              BEVEST                          WAVEST
     I              BEVFST                          WAVFST
     I              BEVGST                          WAVGST
     I              BERPCD                          WARPCD
     I              BERNNB                          WARNNB
     I              BEVDST                          WAVDST
     I              BEATIN                          WAATIN
     I              BEU4ST                          WAU4ST
     I              BEU5ST                          WAU5ST
     I              BERSRN                          WARSRN
     I              BEMHNA                          WAMHNA
     I              BEMINA                          WAMINA
     I              BEWBST                          WAWBST
     I              BER4CD                          WAR4CD
     I              BEBFCD                          WABFCD
     I              BEQ4CD                          WAQ4CD
     I              BET3NB                          WAT3NB
     I              BESICD                          WASICD
     I              BECONB                          WACONB
     I              BECEST                          WACEST
     I              BEAWDT                          WAAWDT
     I              BEJPCD                          WAJPCD
     I              BEXUST                          WAXUST
     I              BEZ1ST                          WAZ1ST
     I              BEVRVA                          WAVRVA
     I              BEOBST                          WAOBST
     I              BEBCST                          WABCST
     I              BEBDST                          WABDST
     I              BEB7VL                          WAB7VL
     I              BEGASX                          WAGASX
     I              BEGBSX                          WAGBSX
     I              BEGCSX                          WAGCSX
     I              BEGDSX                          WAGDSX
     I              BEFNSX                          WAFNSX
     I              BEFOSX                          WAFOSX
     I              BEFPSX                          WAFPSX
     I              BEFQSX                          WAFQSX
     I              BEFRSX                          WAFRSX
     I              BEFSSX                          WAFSSX
     I              BEFTSX                          WAFTSX
     I              BEFUSX                          WAFUSX
     I              BEFVSX                          WAFVSX
     I              BEFWSX                          WAFWSX
     I              BEFXSX                          WAFXSX
     I              BEFYSX                          WAFYSX
     I              BENODT                          WANODT
     I              BENPDT                          WANPDT
     I              BENQDT                          WANQDT
     I              BENRDT                          WANRDT
     I              BENSDT                          WANSDT
     I              BEBPTM                          WABPTM
     I              BEBQTM                          WABQTM
     I              BEBRTM                          WABRTM
     I              BEBSTM                          WABSTM
     I              BEBTTM                          WABTTM
     I              BEH0NX                          WAH0NX
     I              BEH1NX                          WAH1NX
     I              BEH2NX                          WAH2NX
     I              BEH3NX                          WAH3NX
     I              BEH4NX                          WAH4NX
     I              BEC0C7                          WAC0C7
     I              BEUVST                          WAUVST
     I              BEUWST                          WAUWST
     I              BEUXST                          WAUXST
     I              BEAATM                          WAAATM
     I              BEAYNA                          WAAYNA
     I              BEA0NA                          WAA0NA
     I              BEAXDT                          WAAXDT
      *
     I@KMREHC
      * Company Values            Retrieval index
      * Renamed input format fields
     I              KMAIC3                          WBAIC3
     I              KMV8CD                          WBV8CD
     I              KMAUNA                          WBAUNA
     I              KMI5ST                          WBI5ST
     I              KMBXTX                          WBBXTX
     I              KMM8NB                          WBM8NB
     I              KMUVST                          WBUVST
     I              KMUWST                          WBUWST
     I              KMUXST                          WBUXST
     I              KMVSST                          WBVSST
     I              KMAATM                          WBAATM
     I              KMAYNA                          WBAYNA
     I              KMA0NA                          WBA0NA
     I              KMAXDT                          WBAXDT
      *
     I@FJCPBN
      * Load Header               Retrieval index
      * Renamed input format fields
     I              FJRMNB                          WCRMNB
     I              FJAIC3                          WCAIC3
     I              FJAODT                          WCAODT
     I              FJPJST                          WCPJST
     I              FJPKST                          WCPKST
     I              FJRNNB                          WCRNNB
     I              FJDMTX                          WCDMTX
     I              FJDNTX                          WCDNTX
     I              FJDOTX                          WCDOTX
     I              FJWTTX                          WCWTTX
     I              FJWUTX                          WCWUTX
     I              FJRPNB                          WCRPNB
     I              FJFLAM                          WCFLAM
     I              FJXQST                          WCXQST
     I              FJRRNB                          WCRRNB
     I              FJDXTX                          WCDXTX
     I              FJDYTX                          WCDYTX
     I              FJSBNB                          WCSBNB
     I              FJBZNA                          WCBZNA
     I              FJRONB                          WCRONB
     I              FJSQNB                          WCSQNB
     I              FJR1NB                          WCR1NB
     I              FJVCST                          WCVCST
     I              FJVDST                          WCVDST
     I              FJSDNB                          WCSDNB
     I              FJPAOU                          WCPAOU
     I              FJDGWG                          WCDGWG
     I              FJSXNB                          WCSXNB
     I              FJHADT                          WCHADT
     I              FJAART                          WCAART
     I              FJDHWG                          WCDHWG
     I              FJDIWG                          WCDIWG
     I              FJAQDT                          WCAQDT
     I              FJS6NB                          WCS6NB
     I              FJT4NB                          WCT4NB
     I              FJPRTM                          WCPRTM
     I              FJNPSV                          WCNPSV
     I              FJJ8TX                          WCJ8TX
     I              FJTLMI                          WCTLMI
     I              FJJ9TX                          WCJ9TX
     I              FJQ2CD                          WCQ2CD
     I              FJVPCD                          WCVPCD
     I              FJDBCD                          WCDBCD
     I              FJGRWE                          WCGRWE
     I              FJXCCD                          WCXCCD
     I              FJU2ST                          WCU2ST
     I              FJF9DT                          WCF9DT
     I              FJONTM                          WCONTM
     I              FJJ4DT                          WCJ4DT
     I              FJTRTM                          WCTRTM
     I              FJJ5DT                          WCJ5DT
     I              FJSPTM                          WCSPTM
     I              FJJ6DT                          WCJ6DT
     I              FJLFTM                          WCLFTM
     I              FJJ7DT                          WCJ7DT
     I              FJBOTM                          WCBOTM
     I              FJJ8DT                          WCJ8DT
     I              FJBLTM                          WCBLTM
     I              FJKIDT                          WCKIDT
     I              FJASTM                          WCASTM
     I              FJKADT                          WCKADT
     I              FJAJCM                          WCAJCM
     I              FJXACD                          WCXACD
     I              FJOANA                          WCOANA
     I              FJK4TX                          WCK4TX
     I              FJVOAG                          WCVOAG
     I              FJKBDT                          WCKBDT
     I              FJNBBO                          WCNBBO
     I              FJW4CD                          WCW4CD
     I              FJEFDT                          WCEFDT
     I              FJCNTN                          WCCNTN
     I              FJKCDT                          WCKCDT
     I              FJTMIN                          WCTMIN
     I              FJKDDT                          WCKDDT
     I              FJVMNB                          WCVMNB
     I              FJOCFR                          WCOCFR
     I              FJKJDT                          WCKJDT
     I              FJATTM                          WCATTM
     I              FJOTRS                          WCOTRS
     I              FJRNST                          WCRNST
     I              FJBRBK                          WCBRBK
     I              FJEIDT                          WCEIDT
     I              FJRMST                          WCRMST
     I              FJAJCD                          WCAJCD
     I              FJKKDT                          WCKKDT
     I              FJAVTM                          WCAVTM
     I              FJKZDT                          WCKZDT
     I              FJAXTM                          WCAXTM
     I              FJLHOS                          WCLHOS
     I              FJLHOR                          WCLHOR
     I              FJWNTX                          WCWNTX
     I              FJOITX                          WCOITX
     I              FJOJTX                          WCOJTX
     I              FJLLDT                          WCLLDT
     I              FJLSHG                          WCLSHG
     I              FJYPST                          WCYPST
     I              FJK0DT                          WCK0DT
     I              FJAYTM                          WCAYTM
     I              FJKNNX                          WCKNNX
     I              FJICWG                          WCICWG
     I              FJIDWG                          WCIDWG
     I              FJH9SX                          WCH9SX
     I              FJWOTX                          WCWOTX
     I              FJK1DT                          WCK1DT
     I              FJAZTM                          WCAZTM
     I              FJK2DT                          WCK2DT
     I              FJA0TM                          WCA0TM
     I              FJROST                          WCROST
     I              FJRPST                          WCRPST
     I              FJRQST                          WCRQST
     I              FJRRST                          WCRRST
     I              FJZBVA                          WCZBVA
     I              FJWPTX                          WCWPTX
     I              FJWQTX                          WCWQTX
     I              FJWRTX                          WCWRTX
     I              FJWSTX                          WCWSTX
     I              FJRVSX                          WCRVSX
     I              FJRUSX                          WCRUSX
     I              FJRWSX                          WCRWSX
     I              FJRXSX                          WCRXSX
     I              FJRYSX                          WCRYSX
     I              FJRZSX                          WCRZSX
     I              FJR0SX                          WCR0SX
     I              FJR1SX                          WCR1SX
     I              FJR2SX                          WCR2SX
     I              FJR3SX                          WCR3SX
     I              FJR4SX                          WCR4SX
     I              FJPYDT                          WCPYDT
     I              FJCKTM                          WCCKTM
     I              FJPZDT                          WCPZDT
     I              FJCLTM                          WCCLTM
     I              FJP0DT                          WCP0DT
     I              FJCMTM                          WCCMTM
     I              FJP1DT                          WCP1DT
     I              FJCNTM                          WCCNTM
     I              FJP2DT                          WCP2DT
     I              FJCOTM                          WCCOTM
     I              FJP3DT                          WCP3DT
     I              FJCQTM                          WCCQTM
     I              FJUVST                          WCUVST
     I              FJUWST                          WCUWST
     I              FJUXST                          WCUXST
     I              FJAATM                          WCAATM
     I              FJAYNA                          WCAYNA
     I              FJA0NA                          WCA0NA
     I              FJAXDT                          WCAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WDAIC3
     I              OMC4NB                          WDC4NB
     I              OMDPNB                          WDDPNB
     I              OMUENB                          WDUENB
     I              OMHGCD                          WDHGCD
     I              OMAJCD                          WDAJCD
     I              OMBKC7                          WDBKC7
     I              OMCFC7                          WDCFC7
     I              OMGMST                          WDGMST
     I              OMGNST                          WDGNST
     I              OMMAVA                          WDMAVA
     I              OMKDVA                          WDKDVA
     I              OML8VA                          WDL8VA
     I              OML9VA                          WDL9VA
     I              OMGTST                          WDGTST
     I              OMGVST                          WDGVST
     I              OMGUST                          WDGUST
     I              OMQFST                          WDQFST
     I              OMAYVA                          WDAYVA
     I              OMEXDT                          WDEXDT
     I              OMLQCD                          WDLQCD
     I              OMRDCD                          WDRDCD
     I              OMQ7CD                          WDQ7CD
     I              OMBZPR                          WDBZPR
     I              OML6NB                          WDL6NB
     I              OMU1ST                          WDU1ST
     I              OMGIDT                          WDGIDT
     I              OMCRCD                          WDCRCD
     I              OMAGCD                          WDAGCD
     I              OMRZST                          WDRZST
     I              OMR0ST                          WDR0ST
     I              OMR1ST                          WDR1ST
     I              OMG7NA                          WDG7NA
     I              OMG8NA                          WDG8NA
     I              OMRPCD                          WDRPCD
     I              OMVEST                          WDVEST
     I              OMVGST                          WDVGST
     I              OMAVST                          WDAVST
     I              OMU0ST                          WDU0ST
     I              OMRFCD                          WDRFCD
     I              OMFZST                          WDFZST
     I              OMR1NB                          WDR1NB
     I              OMAVQT                          WDAVQT
     I              OMD0WG                          WDD0WG
     I              OMCCQT                          WDCCQT
     I              OMAUWG                          WDAUWG
     I              OMCBQT                          WDCBQT
     I              OMATWG                          WDATWG
     I              OMAQCS                          WDAQCS
     I              OMAGCS                          WDAGCS
     I              OMAKPR                          WDAKPR
     I              OMALPR                          WDALPR
     I              OMAUPR                          WDAUPR
     I              OMAVWG                          WDAVWG
     I              OMA4WG                          WDA4WG
     I              OMA5DT                          WDA5DT
     I              OMAODT                          WDAODT
     I              OMGNDT                          WDGNDT
     I              OMAMST                          WDAMST
     I              OMANST                          WDANST
     I              OMVAST                          WDVAST
     I              OMRGNB                          WDRGNB
     I              OMRHNB                          WDRHNB
     I              OMRINB                          WDRINB
     I              OMRBCD                          WDRBCD
     I              OMHICD                          WDHICD
     I              OMRNCD                          WDRNCD
     I              OMROCD                          WDROCD
     I              OMCXDT                          WDCXDT
     I              OMAJVN                          WDAJVN
     I              OMKXCD                          WDKXCD
     I              OMJPCD                          WDJPCD
     I              OMCQCD                          WDCQCD
     I              OMR4CD                          WDR4CD
     I              OMZ1ST                          WDZ1ST
     I              OMZ3ST                          WDZ3ST
     I              OMZ4ST                          WDZ4ST
     I              OMDUPR                          WDDUPR
     I              OMB6VL                          WDB6VL
     I              OMA1AA                          WDA1AA
     I              OMFZSX                          WDFZSX
     I              OMF0SX                          WDF0SX
     I              OMF1SX                          WDF1SX
     I              OMF2SX                          WDF2SX
     I              OMF3SX                          WDF3SX
     I              OMF4SX                          WDF4SX
     I              OMF5SX                          WDF5SX
     I              OMF6SX                          WDF6SX
     I              OMF7SX                          WDF7SX
     I              OMNTDT                          WDNTDT
     I              OMNUDT                          WDNUDT
     I              OMNVDT                          WDNVDT
     I              OMNWDT                          WDNWDT
     I              OMNXDT                          WDNXDT
     I              OMBUTM                          WDBUTM
     I              OMBVTM                          WDBVTM
     I              OMBWTM                          WDBWTM
     I              OMBXTM                          WDBXTM
     I              OMBYTM                          WDBYTM
     I              OMH5NX                          WDH5NX
     I              OMH6NX                          WDH6NX
     I              OMH7NX                          WDH7NX
     I              OMH8NX                          WDH8NX
     I              OMH9NX                          WDH9NX
     I              OMDVPR                          WDDVPR
     I              OMDWPR                          WDDWPR
     I              OMDXPR                          WDDXPR
     I              OMDYPR                          WDDYPR
     I              OMDZPR                          WDDZPR
     I              OMGSPR                          WDGSPR
     I              OMGTPR                          WDGTPR
     I              OMGUPR                          WDGUPR
     I              OMHOST                          WDHOST
     I              OMHPST                          WDHPST
     I              OMIOST                          WDIOST
     I              OMPEWG                          WDPEWG
     I              OMRINY                          WDRINY
     I              OMTIDT                          WDTIDT
     I              OMTJDT                          WDTJDT
     I              OMH2ST                          WDH2ST
     I              OMH0ST                          WDH0ST
     I              OMH1ST                          WDH1ST
     I              OMTKDT                          WDTKDT
     I              OMTLDT                          WDTLDT
     I              OMTMDT                          WDTMDT
     I              OMUVST                          WDUVST
     I              OMUWST                          WDUWST
     I              OMUXST                          WDUXST
     I              OMAATM                          WDAATM
     I              OMAYNA                          WDAYNA
     I              OMA0NA                          WDA0NA
     I              OMAXDT                          WDAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WEAJCD
     I              ADF8NA                          WEF8NA
     I              ADACNA                          WEACNA
     I              ADADNA                          WEADNA
     I              ADAENA                          WEAENA
     I              ADAJNA                          WEAJNA
     I              ADBTTX                          WEBTTX
     I              ADAOCD                          WEAOCD
     I              ADBGCD                          WEBGCD
     I              ADVHST                          WEVHST
     I              ADMPNA                          WEMPNA
     I              ADWPST                          WEWPST
     I              ADXUST                          WEXUST
     I              ADT0ST                          WET0ST
     I              ADT1ST                          WET1ST
     I              ADDBNB                          WEDBNB
     I              ADT2ST                          WET2ST
     I              ADT3ST                          WET3ST
     I              ADT4ST                          WET4ST
     I              ADT6ST                          WET6ST
     I              ADBWC3                          WEBWC3
     I              ADBTC3                          WEBTC3
     I              ADBUC3                          WEBUC3
     I              ADBVC3                          WEBVC3
     I              ADFCAA                          WEFCAA
     I              ADRQSX                          WERQSX
     I              ADRRSX                          WERRSX
     I              ADRSSX                          WERSSX
     I              ADRTSX                          WERTSX
     I              ADT7ST                          WET7ST
     I              ADT8ST                          WET8ST
     I              ADRNSX                          WERNSX
     I              ADROSX                          WEROSX
     I              ADRPSX                          WERPSX
     I              ADUVST                          WEUVST
     I              ADUWST                          WEUWST
     I              ADUXST                          WEUXST
     I              ADVSST                          WEVSST
     I              ADAATM                          WEAATM
     I              ADAYNA                          WEAYNA
     I              ADA0NA                          WEA0NA
     I              ADAXDT                          WEAXDT
      *
     I@EYCPY2
      * Order Events              Retrieval index       NV
      * Renamed input format fields
     I              EYAIC3                          WFAIC3
     I              EYC4NB                          WFC4NB
     I              EYQ2NB                          WFQ2NB
     I              EYJPCD                          WFJPCD
     I              EYAUC3                          WFAUC3
     I              EYQ7NB                          WFQ7NB
     I              EYOMST                          WFOMST
     I              EYD2DT                          WFD2DT
     I              EYONST                          WFONST
     I              EYOOST                          WFOOST
     I              EYOPST                          WFOPST
     I              EYAWC3                          WFAWC3
     I              EYQ8NB                          WFQ8NB
     I              EYQ9NB                          WFQ9NB
     I              EYBKC7                          WFBKC7
     I              EYUVST                          WFUVST
     I              EYUWST                          WFUWST
     I              EYUXST                          WFUXST
     I              EYAATM                          WFAATM
     I              EYAYNA                          WFAYNA
     I              EYA0NA                          WFA0NA
     I              EYAXDT                          WFAXDT
      *
     I@EYCPZE
      * Order Events              Co/Order/Event Code
      * Renamed input format fields
     I              EYAIC3                          WGAIC3
     I              EYC4NB                          WGC4NB
     I              EYQ2NB                          WGQ2NB
     I              EYJPCD                          WGJPCD
     I              EYAUC3                          WGAUC3
     I              EYQ7NB                          WGQ7NB
     I              EYOMST                          WGOMST
     I              EYD2DT                          WGD2DT
     I              EYONST                          WGONST
     I              EYOOST                          WGOOST
     I              EYOPST                          WGOPST
     I              EYAWC3                          WGAWC3
     I              EYQ8NB                          WGQ8NB
     I              EYQ9NB                          WGQ9NB
     I              EYBKC7                          WGBKC7
     I              EYUVST                          WGUVST
     I              EYUWST                          WGUWST
     I              EYUXST                          WGUXST
     I              EYAATM                          WGAATM
     I              EYAYNA                          WGAYNA
     I              EYA0NA                          WGA0NA
     I              EYAXDT                          WGAXDT
      *
     I@EYCPY3
      * Order Events              Update index
      * Renamed input format fields
     I              EYAIC3                          WHAIC3
     I              EYC4NB                          WHC4NB
     I              EYQ2NB                          WHQ2NB
     I              EYJPCD                          WHJPCD
     I              EYAUC3                          WHAUC3
     I              EYQ7NB                          WHQ7NB
     I              EYOMST                          WHOMST
     I              EYD2DT                          WHD2DT
     I              EYONST                          WHONST
     I              EYOOST                          WHOOST
     I              EYOPST                          WHOPST
     I              EYAWC3                          WHAWC3
     I              EYQ8NB                          WHQ8NB
     I              EYQ9NB                          WHQ9NB
     I              EYBKC7                          WHBKC7
     I              EYUVST                          WHUVST
     I              EYUWST                          WHUWST
     I              EYUXST                          WHUXST
     I              EYAATM                          WHAATM
     I              EYAYNA                          WHAYNA
     I              EYA0NA                          WHA0NA
     I              EYAXDT                          WHAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WIAIC3
     I              BEC4NB                          WIC4NB
     I              BEJNCD                          WIJNCD
     I              BEANC7                          WIANC7
     I              BEBKC7                          WIBKC7
     I              BEBRTX                          WIBRTX
     I              BEHMNA                          WIHMNA
     I              BEHONA                          WIHONA
     I              BEHPNA                          WIHPNA
     I              BEHNNA                          WIHNNA
     I              BEDBCD                          WIDBCD
     I              BECKTX                          WICKTX
     I              BEB0C7                          WIB0C7
     I              BEAETX                          WIAETX
     I              BEB1NA                          WIB1NA
     I              BEB3NA                          WIB3NA
     I              BEB4NA                          WIB4NA
     I              BEB2NA                          WIB2NA
     I              BEBHCD                          WIBHCD
     I              BEC8TX                          WIC8TX
     I              BEBCNA                          WIBCNA
     I              BEA0DT                          WIA0DT
     I              BEA5DT                          WIA5DT
     I              BEGNDT                          WIGNDT
     I              BEACDT                          WIACDT
     I              BEAQCD                          WIAQCD
     I              BEB6NA                          WIB6NA
     I              BEBYNA                          WIBYNA
     I              BEBZNA                          WIBZNA
     I              BEGTST                          WIGTST
     I              BEGVST                          WIGVST
     I              BEGUST                          WIGUST
     I              BEQFST                          WIQFST
     I              BECQCD                          WICQCD
     I              BEGJST                          WIGJST
     I              BEGWST                          WIGWST
     I              BEGXST                          WIGXST
     I              BEGYST                          WIGYST
     I              BEAODT                          WIAODT
     I              BEAIVN                          WIAIVN
     I              BECXDT                          WICXDT
     I              BEJZVA                          WIJZVA
     I              BEA1WG                          WIA1WG
     I              BEXIST                          WIXIST
     I              BEXJST                          WIXJST
     I              BEXKST                          WIXKST
     I              BEEIDT                          WIEIDT
     I              BEAFTM                          WIAFTM
     I              BEE8CD                          WIE8CD
     I              BEE9CD                          WIE9CD
     I              BERMNB                          WIRMNB
     I              BETBNB                          WITBNB
     I              BER1NB                          WIR1NB
     I              BEPJST                          WIPJST
     I              BEU0ST                          WIU0ST
     I              BEU1ST                          WIU1ST
     I              BEQ2CD                          WIQ2CD
     I              BEU2ST                          WIU2ST
     I              BEVEST                          WIVEST
     I              BEVFST                          WIVFST
     I              BEVGST                          WIVGST
     I              BERPCD                          WIRPCD
     I              BERNNB                          WIRNNB
     I              BEVDST                          WIVDST
     I              BEATIN                          WIATIN
     I              BEU4ST                          WIU4ST
     I              BEU5ST                          WIU5ST
     I              BERSRN                          WIRSRN
     I              BEMHNA                          WIMHNA
     I              BEMINA                          WIMINA
     I              BEWBST                          WIWBST
     I              BER4CD                          WIR4CD
     I              BEBFCD                          WIBFCD
     I              BEQ4CD                          WIQ4CD
     I              BET3NB                          WIT3NB
     I              BESICD                          WISICD
     I              BECONB                          WICONB
     I              BECEST                          WICEST
     I              BEAWDT                          WIAWDT
     I              BEJPCD                          WIJPCD
     I              BEXUST                          WIXUST
     I              BEZ1ST                          WIZ1ST
     I              BEVRVA                          WIVRVA
     I              BEOBST                          WIOBST
     I              BEBCST                          WIBCST
     I              BEBDST                          WIBDST
     I              BEB7VL                          WIB7VL
     I              BEGASX                          WIGASX
     I              BEGBSX                          WIGBSX
     I              BEGCSX                          WIGCSX
     I              BEGDSX                          WIGDSX
     I              BEFNSX                          WIFNSX
     I              BEFOSX                          WIFOSX
     I              BEFPSX                          WIFPSX
     I              BEFQSX                          WIFQSX
     I              BEFRSX                          WIFRSX
     I              BEFSSX                          WIFSSX
     I              BEFTSX                          WIFTSX
     I              BEFUSX                          WIFUSX
     I              BEFVSX                          WIFVSX
     I              BEFWSX                          WIFWSX
     I              BEFXSX                          WIFXSX
     I              BEFYSX                          WIFYSX
     I              BENODT                          WINODT
     I              BENPDT                          WINPDT
     I              BENQDT                          WINQDT
     I              BENRDT                          WINRDT
     I              BENSDT                          WINSDT
     I              BEBPTM                          WIBPTM
     I              BEBQTM                          WIBQTM
     I              BEBRTM                          WIBRTM
     I              BEBSTM                          WIBSTM
     I              BEBTTM                          WIBTTM
     I              BEH0NX                          WIH0NX
     I              BEH1NX                          WIH1NX
     I              BEH2NX                          WIH2NX
     I              BEH3NX                          WIH3NX
     I              BEH4NX                          WIH4NX
     I              BEC0C7                          WIC0C7
     I              BEUVST                          WIUVST
     I              BEUWST                          WIUWST
     I              BEUXST                          WIUXST
     I              BEAATM                          WIAATM
     I              BEAYNA                          WIAYNA
     I              BEA0NA                          WIA0NA
     I              BEAXDT                          WIAXDT
      *
     I@BFCPD9
      * Order Header TRG          Load #/All orders
      * Renamed input format fields
     I              BEAIC3                          WJAIC3
     I              BEC4NB                          WJC4NB
     I              BEJNCD                          WJJNCD
     I              BEANC7                          WJANC7
     I              BEBKC7                          WJBKC7
     I              BEBRTX                          WJBRTX
     I              BEHMNA                          WJHMNA
     I              BEHONA                          WJHONA
     I              BEHPNA                          WJHPNA
     I              BEHNNA                          WJHNNA
     I              BEDBCD                          WJDBCD
     I              BECKTX                          WJCKTX
     I              BEB0C7                          WJB0C7
     I              BEAETX                          WJAETX
     I              BEB1NA                          WJB1NA
     I              BEB3NA                          WJB3NA
     I              BEB4NA                          WJB4NA
     I              BEB2NA                          WJB2NA
     I              BEBHCD                          WJBHCD
     I              BEC8TX                          WJC8TX
     I              BEBCNA                          WJBCNA
     I              BEA0DT                          WJA0DT
     I              BEA5DT                          WJA5DT
     I              BEGNDT                          WJGNDT
     I              BEACDT                          WJACDT
     I              BEAQCD                          WJAQCD
     I              BEB6NA                          WJB6NA
     I              BEBYNA                          WJBYNA
     I              BEBZNA                          WJBZNA
     I              BEGTST                          WJGTST
     I              BEGVST                          WJGVST
     I              BEGUST                          WJGUST
     I              BEQFST                          WJQFST
     I              BECQCD                          WJCQCD
     I              BEGJST                          WJGJST
     I              BEGWST                          WJGWST
     I              BEGXST                          WJGXST
     I              BEGYST                          WJGYST
     I              BEAODT                          WJAODT
     I              BEAIVN                          WJAIVN
     I              BECXDT                          WJCXDT
     I              BEJZVA                          WJJZVA
     I              BEA1WG                          WJA1WG
     I              BEXIST                          WJXIST
     I              BEXJST                          WJXJST
     I              BEXKST                          WJXKST
     I              BEEIDT                          WJEIDT
     I              BEAFTM                          WJAFTM
     I              BEE8CD                          WJE8CD
     I              BEE9CD                          WJE9CD
     I              BERMNB                          WJRMNB
     I              BETBNB                          WJTBNB
     I              BER1NB                          WJR1NB
     I              BEPJST                          WJPJST
     I              BEU0ST                          WJU0ST
     I              BEU1ST                          WJU1ST
     I              BEQ2CD                          WJQ2CD
     I              BEU2ST                          WJU2ST
     I              BEVEST                          WJVEST
     I              BEVFST                          WJVFST
     I              BEVGST                          WJVGST
     I              BERPCD                          WJRPCD
     I              BERNNB                          WJRNNB
     I              BEVDST                          WJVDST
     I              BEATIN                          WJATIN
     I              BEU4ST                          WJU4ST
     I              BEU5ST                          WJU5ST
     I              BERSRN                          WJRSRN
     I              BEMHNA                          WJMHNA
     I              BEMINA                          WJMINA
     I              BEWBST                          WJWBST
     I              BER4CD                          WJR4CD
     I              BEBFCD                          WJBFCD
     I              BEQ4CD                          WJQ4CD
     I              BET3NB                          WJT3NB
     I              BESICD                          WJSICD
     I              BECONB                          WJCONB
     I              BECEST                          WJCEST
     I              BEAWDT                          WJAWDT
     I              BEJPCD                          WJJPCD
     I              BEXUST                          WJXUST
     I              BEZ1ST                          WJZ1ST
     I              BEVRVA                          WJVRVA
     I              BEOBST                          WJOBST
     I              BEBCST                          WJBCST
     I              BEBDST                          WJBDST
     I              BEB7VL                          WJB7VL
     I              BEGASX                          WJGASX
     I              BEGBSX                          WJGBSX
     I              BEGCSX                          WJGCSX
     I              BEGDSX                          WJGDSX
     I              BEFNSX                          WJFNSX
     I              BEFOSX                          WJFOSX
     I              BEFPSX                          WJFPSX
     I              BEFQSX                          WJFQSX
     I              BEFRSX                          WJFRSX
     I              BEFSSX                          WJFSSX
     I              BEFTSX                          WJFTSX
     I              BEFUSX                          WJFUSX
     I              BEFVSX                          WJFVSX
     I              BEFWSX                          WJFWSX
     I              BEFXSX                          WJFXSX
     I              BEFYSX                          WJFYSX
     I              BENODT                          WJNODT
     I              BENPDT                          WJNPDT
     I              BENQDT                          WJNQDT
     I              BENRDT                          WJNRDT
     I              BENSDT                          WJNSDT
     I              BEBPTM                          WJBPTM
     I              BEBQTM                          WJBQTM
     I              BEBRTM                          WJBRTM
     I              BEBSTM                          WJBSTM
     I              BEBTTM                          WJBTTM
     I              BEH0NX                          WJH0NX
     I              BEH1NX                          WJH1NX
     I              BEH2NX                          WJH2NX
     I              BEH3NX                          WJH3NX
     I              BEH4NX                          WJH4NX
     I              BEC0C7                          WJC0C7
     I              BEUVST                          WJUVST
     I              BEUWST                          WJUWST
     I              BEUXST                          WJUXST
     I              BEAATM                          WJAATM
     I              BEAYNA                          WJAYNA
     I              BEA0NA                          WJA0NA
     I              BEAXDT                          WJAXDT
      *
     I@FJCPBO
      * Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WKRMNB
     I              FJAIC3                          WKAIC3
     I              FJAODT                          WKAODT
     I              FJPJST                          WKPJST
     I              FJPKST                          WKPKST
     I              FJRNNB                          WKRNNB
     I              FJDMTX                          WKDMTX
     I              FJDNTX                          WKDNTX
     I              FJDOTX                          WKDOTX
     I              FJWTTX                          WKWTTX
     I              FJWUTX                          WKWUTX
     I              FJRPNB                          WKRPNB
     I              FJFLAM                          WKFLAM
     I              FJXQST                          WKXQST
     I              FJRRNB                          WKRRNB
     I              FJDXTX                          WKDXTX
     I              FJDYTX                          WKDYTX
     I              FJSBNB                          WKSBNB
     I              FJBZNA                          WKBZNA
     I              FJRONB                          WKRONB
     I              FJSQNB                          WKSQNB
     I              FJR1NB                          WKR1NB
     I              FJVCST                          WKVCST
     I              FJVDST                          WKVDST
     I              FJSDNB                          WKSDNB
     I              FJPAOU                          WKPAOU
     I              FJDGWG                          WKDGWG
     I              FJSXNB                          WKSXNB
     I              FJHADT                          WKHADT
     I              FJAART                          WKAART
     I              FJDHWG                          WKDHWG
     I              FJDIWG                          WKDIWG
     I              FJAQDT                          WKAQDT
     I              FJS6NB                          WKS6NB
     I              FJT4NB                          WKT4NB
     I              FJPRTM                          WKPRTM
     I              FJNPSV                          WKNPSV
     I              FJJ8TX                          WKJ8TX
     I              FJTLMI                          WKTLMI
     I              FJJ9TX                          WKJ9TX
     I              FJQ2CD                          WKQ2CD
     I              FJVPCD                          WKVPCD
     I              FJDBCD                          WKDBCD
     I              FJGRWE                          WKGRWE
     I              FJXCCD                          WKXCCD
     I              FJU2ST                          WKU2ST
     I              FJF9DT                          WKF9DT
     I              FJONTM                          WKONTM
     I              FJJ4DT                          WKJ4DT
     I              FJTRTM                          WKTRTM
     I              FJJ5DT                          WKJ5DT
     I              FJSPTM                          WKSPTM
     I              FJJ6DT                          WKJ6DT
     I              FJLFTM                          WKLFTM
     I              FJJ7DT                          WKJ7DT
     I              FJBOTM                          WKBOTM
     I              FJJ8DT                          WKJ8DT
     I              FJBLTM                          WKBLTM
     I              FJKIDT                          WKKIDT
     I              FJASTM                          WKASTM
     I              FJKADT                          WKKADT
     I              FJAJCM                          WKAJCM
     I              FJXACD                          WKXACD
     I              FJOANA                          WKOANA
     I              FJK4TX                          WKK4TX
     I              FJVOAG                          WKVOAG
     I              FJKBDT                          WKKBDT
     I              FJNBBO                          WKNBBO
     I              FJW4CD                          WKW4CD
     I              FJEFDT                          WKEFDT
     I              FJCNTN                          WKCNTN
     I              FJKCDT                          WKKCDT
     I              FJTMIN                          WKTMIN
     I              FJKDDT                          WKKDDT
     I              FJVMNB                          WKVMNB
     I              FJOCFR                          WKOCFR
     I              FJKJDT                          WKKJDT
     I              FJATTM                          WKATTM
     I              FJOTRS                          WKOTRS
     I              FJRNST                          WKRNST
     I              FJBRBK                          WKBRBK
     I              FJEIDT                          WKEIDT
     I              FJRMST                          WKRMST
     I              FJAJCD                          WKAJCD
     I              FJKKDT                          WKKKDT
     I              FJAVTM                          WKAVTM
     I              FJKZDT                          WKKZDT
     I              FJAXTM                          WKAXTM
     I              FJLHOS                          WKLHOS
     I              FJLHOR                          WKLHOR
     I              FJWNTX                          WKWNTX
     I              FJOITX                          WKOITX
     I              FJOJTX                          WKOJTX
     I              FJLLDT                          WKLLDT
     I              FJLSHG                          WKLSHG
     I              FJYPST                          WKYPST
     I              FJK0DT                          WKK0DT
     I              FJAYTM                          WKAYTM
     I              FJKNNX                          WKKNNX
     I              FJICWG                          WKICWG
     I              FJIDWG                          WKIDWG
     I              FJH9SX                          WKH9SX
     I              FJWOTX                          WKWOTX
     I              FJK1DT                          WKK1DT
     I              FJAZTM                          WKAZTM
     I              FJK2DT                          WKK2DT
     I              FJA0TM                          WKA0TM
     I              FJROST                          WKROST
     I              FJRPST                          WKRPST
     I              FJRQST                          WKRQST
     I              FJRRST                          WKRRST
     I              FJZBVA                          WKZBVA
     I              FJWPTX                          WKWPTX
     I              FJWQTX                          WKWQTX
     I              FJWRTX                          WKWRTX
     I              FJWSTX                          WKWSTX
     I              FJRVSX                          WKRVSX
     I              FJRUSX                          WKRUSX
     I              FJRWSX                          WKRWSX
     I              FJRXSX                          WKRXSX
     I              FJRYSX                          WKRYSX
     I              FJRZSX                          WKRZSX
     I              FJR0SX                          WKR0SX
     I              FJR1SX                          WKR1SX
     I              FJR2SX                          WKR2SX
     I              FJR3SX                          WKR3SX
     I              FJR4SX                          WKR4SX
     I              FJPYDT                          WKPYDT
     I              FJCKTM                          WKCKTM
     I              FJPZDT                          WKPZDT
     I              FJCLTM                          WKCLTM
     I              FJP0DT                          WKP0DT
     I              FJCMTM                          WKCMTM
     I              FJP1DT                          WKP1DT
     I              FJCNTM                          WKCNTM
     I              FJP2DT                          WKP2DT
     I              FJCOTM                          WKCOTM
     I              FJP3DT                          WKP3DT
     I              FJCQTM                          WKCQTM
     I              FJUVST                          WKUVST
     I              FJUWST                          WKUWST
     I              FJUXST                          WKUXST
     I              FJAATM                          WKAATM
     I              FJAYNA                          WKAYNA
     I              FJA0NA                          WKA0NA
     I              FJAXDT                          WKAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IQOPEY1    E DSOPEYCPL0
      * UPD : Order Events              Update index
      * Renamed input format fields
     I              EYAIC3                          WHAIC3
     I              EYC4NB                          WHC4NB
     I              EYQ2NB                          WHQ2NB
     I              EYJPCD                          WHJPCD
     I              EYAUC3                          WHAUC3
     I              EYQ7NB                          WHQ7NB
     I              EYOMST                          WHOMST
     I              EYD2DT                          WHD2DT
     I              EYONST                          WHONST
     I              EYOOST                          WHOOST
     I              EYOPST                          WHOPST
     I              EYAWC3                          WHAWC3
     I              EYQ8NB                          WHQ8NB
     I              EYQ9NB                          WHQ9NB
     I              EYBKC7                          WHBKC7
     I              EYUVST                          WHUVST
     I              EYUWST                          WHUWST
     I              EYUXST                          WHUXST
     I              EYAATM                          WHAATM
     I              EYAYNA                          WHAYNA
     I              EYA0NA                          WHA0NA
     I              EYAXDT                          WHAXDT
      *
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WIAIC3
     I              BEC4NB                          WIC4NB
     I              BEJNCD                          WIJNCD
     I              BEANC7                          WIANC7
     I              BEBKC7                          WIBKC7
     I              BEBRTX                          WIBRTX
     I              BEHMNA                          WIHMNA
     I              BEHONA                          WIHONA
     I              BEHPNA                          WIHPNA
     I              BEHNNA                          WIHNNA
     I              BEDBCD                          WIDBCD
     I              BECKTX                          WICKTX
     I              BEB0C7                          WIB0C7
     I              BEAETX                          WIAETX
     I              BEB1NA                          WIB1NA
     I              BEB3NA                          WIB3NA
     I              BEB4NA                          WIB4NA
     I              BEB2NA                          WIB2NA
     I              BEBHCD                          WIBHCD
     I              BEC8TX                          WIC8TX
     I              BEBCNA                          WIBCNA
     I              BEA0DT                          WIA0DT
     I              BEA5DT                          WIA5DT
     I              BEGNDT                          WIGNDT
     I              BEACDT                          WIACDT
     I              BEAQCD                          WIAQCD
     I              BEB6NA                          WIB6NA
     I              BEBYNA                          WIBYNA
     I              BEBZNA                          WIBZNA
     I              BEGTST                          WIGTST
     I              BEGVST                          WIGVST
     I              BEGUST                          WIGUST
     I              BEQFST                          WIQFST
     I              BECQCD                          WICQCD
     I              BEGJST                          WIGJST
     I              BEGWST                          WIGWST
     I              BEGXST                          WIGXST
     I              BEGYST                          WIGYST
     I              BEAODT                          WIAODT
     I              BEAIVN                          WIAIVN
     I              BECXDT                          WICXDT
     I              BEJZVA                          WIJZVA
     I              BEA1WG                          WIA1WG
     I              BEXIST                          WIXIST
     I              BEXJST                          WIXJST
     I              BEXKST                          WIXKST
     I              BEEIDT                          WIEIDT
     I              BEAFTM                          WIAFTM
     I              BEE8CD                          WIE8CD
     I              BEE9CD                          WIE9CD
     I              BERMNB                          WIRMNB
     I              BETBNB                          WITBNB
     I              BER1NB                          WIR1NB
     I              BEPJST                          WIPJST
     I              BEU0ST                          WIU0ST
     I              BEU1ST                          WIU1ST
     I              BEQ2CD                          WIQ2CD
     I              BEU2ST                          WIU2ST
     I              BEVEST                          WIVEST
     I              BEVFST                          WIVFST
     I              BEVGST                          WIVGST
     I              BERPCD                          WIRPCD
     I              BERNNB                          WIRNNB
     I              BEVDST                          WIVDST
     I              BEATIN                          WIATIN
     I              BEU4ST                          WIU4ST
     I              BEU5ST                          WIU5ST
     I              BERSRN                          WIRSRN
     I              BEMHNA                          WIMHNA
     I              BEMINA                          WIMINA
     I              BEWBST                          WIWBST
     I              BER4CD                          WIR4CD
     I              BEBFCD                          WIBFCD
     I              BEQ4CD                          WIQ4CD
     I              BET3NB                          WIT3NB
     I              BESICD                          WISICD
     I              BECONB                          WICONB
     I              BECEST                          WICEST
     I              BEAWDT                          WIAWDT
     I              BEJPCD                          WIJPCD
     I              BEXUST                          WIXUST
     I              BEZ1ST                          WIZ1ST
     I              BEVRVA                          WIVRVA
     I              BEOBST                          WIOBST
     I              BEBCST                          WIBCST
     I              BEBDST                          WIBDST
     I              BEB7VL                          WIB7VL
     I              BEGASX                          WIGASX
     I              BEGBSX                          WIGBSX
     I              BEGCSX                          WIGCSX
     I              BEGDSX                          WIGDSX
     I              BEFNSX                          WIFNSX
     I              BEFOSX                          WIFOSX
     I              BEFPSX                          WIFPSX
     I              BEFQSX                          WIFQSX
     I              BEFRSX                          WIFRSX
     I              BEFSSX                          WIFSSX
     I              BEFTSX                          WIFTSX
     I              BEFUSX                          WIFUSX
     I              BEFVSX                          WIFVSX
     I              BEFWSX                          WIFWSX
     I              BEFXSX                          WIFXSX
     I              BEFYSX                          WIFYSX
     I              BENODT                          WINODT
     I              BENPDT                          WINPDT
     I              BENQDT                          WINQDT
     I              BENRDT                          WINRDT
     I              BENSDT                          WINSDT
     I              BEBPTM                          WIBPTM
     I              BEBQTM                          WIBQTM
     I              BEBRTM                          WIBRTM
     I              BEBSTM                          WIBSTM
     I              BEBTTM                          WIBTTM
     I              BEH0NX                          WIH0NX
     I              BEH1NX                          WIH1NX
     I              BEH2NX                          WIH2NX
     I              BEH3NX                          WIH3NX
     I              BEH4NX                          WIH4NX
     I              BEC0C7                          WIC0C7
     I              BEUVST                          WIUVST
     I              BEUWST                          WIUWST
     I              BEUXST                          WIUXST
     I              BEAATM                          WIAATM
     I              BEAYNA                          WIAYNA
     I              BEA0NA                          WIA0NA
     I              BEAXDT                          WIAXDT
      *
     IYARDCS      DS                            779
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      * Outward parameters
     IPARC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Order Number
     I                                    P   3   60PAC4NB
      * I :  Order Type - Sales
     I                                        7   8 PAJNCD
      * I :  A/R Customer Number
     I                                    P   9  120PAANC7
      * I :  Ship To Customer
     I                                    P  13  160PABKC7
      * I :  Ship To Name
     I                                       17  46 PABRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PAHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PAHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PAHPNA
      * I :  Ship To City
     I                                      137 156 PAHNNA
      * I :  Ship To State Code
     I                                      157 158 PADBCD
      * I :  Ship To Zip/Postal Code
     I                                      159 169 PACKTX
      * I :  Bill to Customer
     I                                    P 170 1730PAB0C7
      * I :  Bill to Name
     I                                      174 203 PAAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PAB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PAB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PAB4NA
      * I :  Bill to City
     I                                      294 313 PAB2NA
      * I :  Bill to State Code
     I                                      314 315 PABHCD
      * I :  Bill to Zip/Postal Code
     I                                      316 326 PAC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PABCNA
      * I :  Order Date
     I                                    P 342 3450PAA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PAA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PAGNDT
      * I :  Cancel Date
     I                                    P 354 3570PAACDT
      * I :  Terms Code
     I                                      358 359 PAAQCD
      * I :  Special Instructions
     I                                      360 399 PAB6NA
      * I :  Special Instructions 2
     I                                      400 439 PABYNA
      * I :  Carrier Code
     I                                      440 442 PABZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PAGTST
      * I :  Comment Print Inv/Cr.Memo
     I                                      444 444 PAGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PAGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PAQFST
      * I :  Reason Code
     I                                      447 449 PACQCD
      * I :  Order in Use
     I                                      450 450 PAGJST
      * I :  Header Status
     I                                      451 451 PAGWST
      * I :  Header Status Last
     I                                      452 452 PAGXST
      * I :  Order Type Print Status
     I                                      453 453 PAGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PAAODT
      * I :  User Original Entry
     I                                      458 467 PAAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PACXDT
      * I :  Order Value Total
     I                                    P 472 4772PAJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PAA1WG
      * I :  Credit Hold
     I                                      484 484 PAXIST
      * I :  Production Hold
     I                                      485 485 PAXJST
      * I :  New Customer Hold
     I                                      486 486 PAXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PAEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PAAFTM
      * I :  Accounts Receiv. Ent 1
     I                                      494 497 PAE8CD
      * I :  Accounts Receiv. Ent 2
     I                                      498 509 PAE9CD
      * I :  Load ID
     I                                    P 510 5130PARMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PATBNB
      * I :  Rated Freight
     I                                    P 517 5222PAR1NB
      * I :  LTL Flag
     I                                      523 523 PAPJST
      * I :  Price Audit
     I                                      524 524 PAU0ST
      * I :  Price Status
     I                                      525 525 PAU1ST
      * I :  Shipping Method
     I                                      526 527 PAQ2CD
      * I :  Export Status
     I                                      528 528 PAU2ST
      * I :  Palletize
     I                                      529 529 PAVEST
      * I :  Shrink Wrap
     I                                      530 530 PAVFST
      * I :  Slip Sheet
     I                                      531 531 PAVGST
      * I :  Age Code
     I                                      532 532 PARPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PARNNB
      * I :  Load Type
     I                                      536 536 PAVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PAATIN
      * I :  Load Plan Order
     I                                      541 541 PAU4ST
      * I :  Print Pick Slip
     I                                      542 542 PAU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PARSRN
      * I :  Special Comment 1
     I                                      547 576 PAMHNA
      * I :  Special Comment 2
     I                                      577 606 PAMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PAWBST
      * I :  Sales Route Code
     I                                      608 610 PAR4CD
      * I :  Manager Level Code
     I                                      611 612 PABFCD
      * I :  VP Level Code
     I                                      613 615 PAQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PAT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PASICD
      * I :  Invoice Number
     I                                    P 623 6260PACONB
      * I :  Invoice Suffix
     I                                      627 628 PACEST
      * I :  Invoice Date
     I                                    P 629 6320PAAWDT
      * I :  Event Code
     I                                      633 634 PAJPCD
      * I :  Trans Contol AS400/Plant
     I                                      635 635 PAXUST
      * I :  Modified Flag
     I                                      636 636 PAZ1ST
      * I :  A/R order Value Total
     I                                    P 637 6422PAVRVA
      * I :  Billing Activity Type
     I                                      643 643 PAOBST
      * I :  Block Order Flag
     I                                      644 644 PABCST
      * I :  Order Certification Flag
     I                                      645 645 PABDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PAB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PAGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PAGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PAGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PAGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PAFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PAFOSX
      * I :  Order Emailed
     I                                      658 658 PAFPSX
      * I :  Export Docs Go w/Driver
     I                                      659 659 PAFQSX
      * I :  Shipping Temp Code C/F
     I                                      660 660 PAFRSX
      * I :  Broker Order Status
     I                                      661 661 PAFSSX
      * I :  Air Freight Order
     I                                      662 662 PAFTSX
      * I :  Order Requires Review
     I                                      663 664 PAFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PAFVSX
      * I :  Export USDA Approved
     I                                      667 668 PAFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PAFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PAFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PANODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PANPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PANQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PANRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PANSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PABPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PABQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PABRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PABSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PABTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PAH0NX
      * I :  Act Non-Ref Frt Amount
     I                                    P 721 7262PAH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PAH2NX
      * I :  OH Total Non-Ref Frt Amt
     I                                    P 733 7382PAH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PAH4NX
      * I :  Claim Number
     I                                    P 745 7480PAC0C7
      * I :  EDI Status 1
     I                                      749 749 PAUVST
      * I :  EDI Status 2
     I                                      750 750 PAUWST
      * I :  EDI Status 3
     I                                      751 751 PAUXST
      * I :  Job Time
     I                                    P 752 7550PAAATM
      * I :  User Id
     I                                      756 765 PAAYNA
      * I :  Job Name
     I                                      766 775 PAA0NA
      * I :  Job Date
     I                                    P 776 7790PAAXDT
      *
     IQOMFJ1    E DSOMFJCPL1
      * UPD : Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WKRMNB
     I              FJAIC3                          WKAIC3
     I              FJAODT                          WKAODT
     I              FJPJST                          WKPJST
     I              FJPKST                          WKPKST
     I              FJRNNB                          WKRNNB
     I              FJDMTX                          WKDMTX
     I              FJDNTX                          WKDNTX
     I              FJDOTX                          WKDOTX
     I              FJWTTX                          WKWTTX
     I              FJWUTX                          WKWUTX
     I              FJRPNB                          WKRPNB
     I              FJFLAM                          WKFLAM
     I              FJXQST                          WKXQST
     I              FJRRNB                          WKRRNB
     I              FJDXTX                          WKDXTX
     I              FJDYTX                          WKDYTX
     I              FJSBNB                          WKSBNB
     I              FJBZNA                          WKBZNA
     I              FJRONB                          WKRONB
     I              FJSQNB                          WKSQNB
     I              FJR1NB                          WKR1NB
     I              FJVCST                          WKVCST
     I              FJVDST                          WKVDST
     I              FJSDNB                          WKSDNB
     I              FJPAOU                          WKPAOU
     I              FJDGWG                          WKDGWG
     I              FJSXNB                          WKSXNB
     I              FJHADT                          WKHADT
     I              FJAART                          WKAART
     I              FJDHWG                          WKDHWG
     I              FJDIWG                          WKDIWG
     I              FJAQDT                          WKAQDT
     I              FJS6NB                          WKS6NB
     I              FJT4NB                          WKT4NB
     I              FJPRTM                          WKPRTM
     I              FJNPSV                          WKNPSV
     I              FJJ8TX                          WKJ8TX
     I              FJTLMI                          WKTLMI
     I              FJJ9TX                          WKJ9TX
     I              FJQ2CD                          WKQ2CD
     I              FJVPCD                          WKVPCD
     I              FJDBCD                          WKDBCD
     I              FJGRWE                          WKGRWE
     I              FJXCCD                          WKXCCD
     I              FJU2ST                          WKU2ST
     I              FJF9DT                          WKF9DT
     I              FJONTM                          WKONTM
     I              FJJ4DT                          WKJ4DT
     I              FJTRTM                          WKTRTM
     I              FJJ5DT                          WKJ5DT
     I              FJSPTM                          WKSPTM
     I              FJJ6DT                          WKJ6DT
     I              FJLFTM                          WKLFTM
     I              FJJ7DT                          WKJ7DT
     I              FJBOTM                          WKBOTM
     I              FJJ8DT                          WKJ8DT
     I              FJBLTM                          WKBLTM
     I              FJKIDT                          WKKIDT
     I              FJASTM                          WKASTM
     I              FJKADT                          WKKADT
     I              FJAJCM                          WKAJCM
     I              FJXACD                          WKXACD
     I              FJOANA                          WKOANA
     I              FJK4TX                          WKK4TX
     I              FJVOAG                          WKVOAG
     I              FJKBDT                          WKKBDT
     I              FJNBBO                          WKNBBO
     I              FJW4CD                          WKW4CD
     I              FJEFDT                          WKEFDT
     I              FJCNTN                          WKCNTN
     I              FJKCDT                          WKKCDT
     I              FJTMIN                          WKTMIN
     I              FJKDDT                          WKKDDT
     I              FJVMNB                          WKVMNB
     I              FJOCFR                          WKOCFR
     I              FJKJDT                          WKKJDT
     I              FJATTM                          WKATTM
     I              FJOTRS                          WKOTRS
     I              FJRNST                          WKRNST
     I              FJBRBK                          WKBRBK
     I              FJEIDT                          WKEIDT
     I              FJRMST                          WKRMST
     I              FJAJCD                          WKAJCD
     I              FJKKDT                          WKKKDT
     I              FJAVTM                          WKAVTM
     I              FJKZDT                          WKKZDT
     I              FJAXTM                          WKAXTM
     I              FJLHOS                          WKLHOS
     I              FJLHOR                          WKLHOR
     I              FJWNTX                          WKWNTX
     I              FJOITX                          WKOITX
     I              FJOJTX                          WKOJTX
     I              FJLLDT                          WKLLDT
     I              FJLSHG                          WKLSHG
     I              FJYPST                          WKYPST
     I              FJK0DT                          WKK0DT
     I              FJAYTM                          WKAYTM
     I              FJKNNX                          WKKNNX
     I              FJICWG                          WKICWG
     I              FJIDWG                          WKIDWG
     I              FJH9SX                          WKH9SX
     I              FJWOTX                          WKWOTX
     I              FJK1DT                          WKK1DT
     I              FJAZTM                          WKAZTM
     I              FJK2DT                          WKK2DT
     I              FJA0TM                          WKA0TM
     I              FJROST                          WKROST
     I              FJRPST                          WKRPST
     I              FJRQST                          WKRQST
     I              FJRRST                          WKRRST
     I              FJZBVA                          WKZBVA
     I              FJWPTX                          WKWPTX
     I              FJWQTX                          WKWQTX
     I              FJWRTX                          WKWRTX
     I              FJWSTX                          WKWSTX
     I              FJRVSX                          WKRVSX
     I              FJRUSX                          WKRUSX
     I              FJRWSX                          WKRWSX
     I              FJRXSX                          WKRXSX
     I              FJRYSX                          WKRYSX
     I              FJRZSX                          WKRZSX
     I              FJR0SX                          WKR0SX
     I              FJR1SX                          WKR1SX
     I              FJR2SX                          WKR2SX
     I              FJR3SX                          WKR3SX
     I              FJR4SX                          WKR4SX
     I              FJPYDT                          WKPYDT
     I              FJCKTM                          WKCKTM
     I              FJPZDT                          WKPZDT
     I              FJCLTM                          WKCLTM
     I              FJP0DT                          WKP0DT
     I              FJCMTM                          WKCMTM
     I              FJP1DT                          WKP1DT
     I              FJCNTM                          WKCNTM
     I              FJP2DT                          WKP2DT
     I              FJCOTM                          WKCOTM
     I              FJP3DT                          WKP3DT
     I              FJCQTM                          WKCQTM
     I              FJUVST                          WKUVST
     I              FJUWST                          WKUWST
     I              FJUXST                          WKUXST
     I              FJAATM                          WKAATM
     I              FJAYNA                          WKAYNA
     I              FJA0NA                          WKA0NA
     I              FJAXDT                          WKAXDT
      *
     IYBRDCS      DS                            793
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Header TRG
      * I :  Company Number
     I                                    P   1   20P1AIC3
     IP2PARM      DS
      * I :  Process Cust Types Usr
     I                                        1   2 P2YDSX
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P2YDSX    PARM           WP0002  2        Process Cust Ty
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * UPD Transfer Complete  XF
      * 05/12/04 SLM PKTR01 Multi-Company - Order Header TRG Remove Co
      *                                     from Logical View
      * This Sequence Contains Function Documentation
     C                     EXSR UASUBR                     This Sequence C
      * UPD Transfer Complete  RT - Order Header TRG  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * UPD Transfer Complete  RT - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  1        Affect Inventor
     C                     MOVEL*BLANK    WN0002  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0003  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0004  40       Accounting Year
     C                     Z-ADD*ZERO     WN0005  20       Accounting Peri
     C                     Z-ADD*ZERO     WN0006  30       OM Week
     C                     Z-ADD*ZERO     WN0007 112       Quantity Billed
     C                     Z-ADD*ZERO     WN0008 112       Weight Billed
     C                     Z-ADD*ZERO     WN0009  70       Order Number Re
     C                     MOVEL*BLANK    WN0010  1        Invoiced Flag U
     C                     MOVEL*BLANK    WN0011  1        USR Process sta
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * CHANGE LOG
     C                     EXSR UBSUBR                     CHANGE LOG
      * RTV Alpha Value        RT - Company Values  * 
     C                     EXSR SBRVGN
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSA01           Company Number
      * Establish starting position
     C           KRSSA     SETLL@BFCPH7                    *
     C           KRSSA     READE@BFCPH7                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WN0011           USR Process sta
      * Do not process if load status <> "S"
      * CASE: DB1.Load ID NE WRK.ZERO
     C           WARMNB    IFNE WUW0NB                     *IF
      * RTV Load Status        RT - Load Header  * 
     C                     EXSR SCRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,002                    *IF
     C                     MOVEL'N'       WN0011           USR Process sta
     C                     ELSE
      * CASE: WRK.Load Status is Not Shipped
     C           WUPKST    IFEQ 'C'                        *IF
     C           WUPKST    OREQ 'E'
     C           WUPKST    OREQ 'I'
     C           WUPKST    OREQ 'L'
     C           WUPKST    OREQ 'U'
     C                     MOVEL'N'       WN0011           USR Process sta
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * RTV EDI Status 1       RT - Load Header  * 
     C                     EXSR SDRVGN
      * Do not process if BOL not printed and the order is load planned
      * CASE: DB1.Load Plan Order is no
     C           WAU4ST    IFEQ 'N'                        *IF
     C                     ELSE
      * CASE: DB1.Modified Flag is Modified
     C           WAZ1ST    IFEQ 'M'                        *IF
     C                     ELSE
      * CASE: WRK.EDI Status 1 is Modified
     C           WUUVST    IFEQ 'M'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WN0011           USR Process sta
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * *********** RMC E00074 - 1/18/08 added this validation here.
      * Do Truck Departure validation if sts is Yes from company values
      * CASE: WRK.Status - Y or N is yes
     C           WUB8ST    IFEQ 'Y'                        *IF
      * RTV LdSts/DptDtTM/BOL RT - Load Header  * 
     C                     EXSR SERVGN
      * Do not process if truck departure not entered
      * CASE: DB1.Load Plan Order is no
     C           WAU4ST    IFEQ 'N'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1ORc2
      *   |- c1    : WRK.Truck Departure Date is not entered
      *   |- c2    : WRK.Truck Departure Time is Not Entered
      *   '-
     C           WUKIDT    IFEQ 0                          *IF
     C           WUASTM    OREQ 0                          *OR
     C                     MOVEL'N'       WN0011           USR Process sta
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * LCL.Scheduled Ship Date USR = JOB.*Job date + CON.-5 *DAYS
     C           ##JDT     ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-5        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0001
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0001
     C                     END
      * OVERRIDE:  USR Process Status
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Scheduled Ship Date LT LCL.Scheduled Ship Date U
      *   |- c2    : WRK.Load Status is Shipped
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAAODT    IFLT YL0001                     *IF
     C           WUPKST    IFEQ 'S'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WN0011           USR Process sta
     C                     END                             *FI
      * ***********
      * Only process completion if passed above edits
      * CASE: PAR.USR Process status is yes
     C           WN0011    IFEQ 'Y'                        *IF
      * Process Shipping Detail
     C                     EXSR UCSUBR                     Process Shippin
      * Change/Create A/R Summary Record
     C                     EXSR UDSUBR                     Change/Create A
      * RTV Last Event Code    RT - Order Events  * 
     C                     EXSR SHRVGN
      * CRT History Event      RT - Order Events  * 
     C                     EXSR SIRVGN
      * Update Order Header Status and Event
      * NOTE:  Transfers are not really written to history
     C                     MOVELWAGWST    YL0004           Header Status L
      * CHG for Invoice Post   CH - Order Header TRG  * 
     C                     EXSR SKCHRC
      * **** Read all Load Orders, if all orders have been Invoiced then
      * **** Update Load as Invoiced
      * RTV Ld Orders Invoiced RT - Order Header TRG  * 
     C                     EXSR SLRVGN
      * If all Load Orders have been Invoiced, then update load
      * CASE: PAR.Invoiced Flag USR is Invoiced
     C           WN0010    IFEQ 'Y'                        *IF
      * CHG Load Status        CH - Load Header  * 
     C                     EXSR SMCHRC
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSA     READE@BFCPH7                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Alpha Value        RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBV8CD           Company Value C
      * Setup key
     C                     Z-ADDP1AIC3    WBAIC3           Company Number
     C                     MOVEL@CN,001   WBV8CD           Company Value C
      * Establish starting position
     C           KRSSB     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBBXTX    WUB8ST           System Value Al
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Load Status        RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCRMNB           Load ID
      * Setup key
     C                     Z-ADDWARMNB    WCRMNB           Load ID
      * Establish starting position
     C           KRSSC     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUPKST           Load Status
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWCPKST    WUPKST           Load Status
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV EDI Status 1       RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WCRMNB           Load ID
      * Setup key
     C                     Z-ADDWARMNB    WCRMNB           Load ID
      * Establish starting position
     C           KRSSD     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUUVST           EDI Status 1
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCUVST    WUUVST           EDI Status 1
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV LdSts/DptDtTM/BOL RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WCRMNB           Load ID
      * Setup key
     C                     Z-ADDWARMNB    WCRMNB           Load ID
      * Establish starting position
     C           KRSSE     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUKIDT           Truck Departure
     C                     Z-ADD*ZERO     WUASTM           Truck Departure
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     Z-ADDWCKIDT    WUKIDT           Truck Departure
     C                     Z-ADDWCASTM    WUASTM           Truck Departure
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV OD Whs/ShpCo/AccCo RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSF01           Company Number
     C           *LIKE     DEFN WDC4NB    WQSF02           Order Number
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Order Number
      * Setup key
     C                     Z-ADDWAAIC3    WQSF01           Company Number
     C                     Z-ADDWAC4NB    WQSF02           Order Number
      * Establish starting position
     C           KRSSF     SETLL@BGWKL1                    *
     C           KRSSF     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           WDGMST    IFEQ 'L'                        *IF
     C           WDGMST    OREQ 'A'
     C           WDGMST    OREQ 'C'
     C           WDGMST    OREQ 'R'
     C           WDGMST    OREQ 'E'
     C           WDGMST    OREQ 'H'
     C           WDGMST    OREQ 'I'
      * RTV OD Whs/ShpCo/AccCo RT - Warehouse  * Retrieve object
     C                     EXSR SGRVGN
     C                     MOVELWDAJCD    YN0004           Warehouse Code
     C                     GOTO SFEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSF     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV OD Whs/ShpCo/AccCo RT - Warehouse  * Retrieve object
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WEAJCD           Warehouse Code
      * Setup key
     C                     MOVELWDAJCD    WEAJCD           Warehouse Code
      * Establish starting position
     C           KRSSG     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0002           Shipping Compan
     C                     Z-ADD*ZERO     YL0003           Accounting Comp
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWEBWC3    YL0002           Shipping Compan
     C                     Z-ADDWEBTC3    YL0003           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Last Event Code    RT - Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSH01           Company Number
     C           *LIKE     DEFN WFC4NB    WQSH02           Order Number
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           Order Number
      * Setup key
     C                     Z-ADDWAAIC3    WQSH01           Company Number
     C                     Z-ADDWAC4NB    WQSH02           Order Number
      * Establish starting position
     C           KRSSH     SETLL@EYCPY2                    *
     C           KRSSH     READE@EYCPY2                  90*
      * Data record not found
     C   90                MOVEL'USR1074' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWFQ2NB    WUNFNN           Event Number
     C                     MOVELWFJPCD    WUJPCD           Event Code
     C           KRSSH     READE@EYCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * CRT History Event      RT - Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAIC3    WQSI01           Company Number
     C           *LIKE     DEFN WGC4NB    WQSI02           Order Number
     C           *LIKE     DEFN WGJPCD    WQSI03           Event Code
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Company Number
     C                     KFLD           WQSI02           Order Number
     C                     KFLD           WQSI03           Event Code
      * Setup key
     C                     Z-ADDWAAIC3    WQSI01           Company Number
     C                     Z-ADDWAC4NB    WQSI02           Order Number
     C                     MOVELWUJPCD    WQSI03           Event Code
      * Establish starting position
     C           KRSSI     SETLL@EYCPZE                    *
     C           KRSSI     READE@EYCPZE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1074' W0RTN   7
      * USER: Processing if Data record not found
      * CRT OP Order Events    CR - Order Events  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0001           Company Number
     C                     Z-ADDWAC4NB    WL0002           Order Number
     C                     Z-ADD1         WL0003           Event Number
     C                     MOVELWUJPCD    WL0004    P      Event Code
     C                     Z-ADDWAAIC3    WL0005           Invoice/Memo Co
     C                     Z-ADD0         WL0006           Invoice/Memo Nu
     C                     MOVEL*BLANK    WL0007           Invoice/Memo Su
     C                     Z-ADD##JDT     WL0008           Event Date
     C                     MOVEL'Y'       WL0009    P      Activity Comple
     C                     MOVEL'N'       WL0010    P      Activity Hold
     C                     MOVEL'Y'       WL0011    P      Post Cash Compl
     C                     Z-ADD0         WL0012           Cross Event Ref
     C                     Z-ADD0         WL0013           Cross Event Ref
     C                     Z-ADD0         WL0014           Cross Event Ref
     C                     Z-ADD0         WL0015           Ship To Custome
     C                     EXSR SJCRRC
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WGQ2NB    ADD  1         WUQ2NB           Event Number
      * CRT OP Order Events    CR - OP Order Events  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWGAIC3    WL0001           Company Number
     C                     Z-ADDWGC4NB    WL0002           Order Number
     C                     Z-ADDWUQ2NB    WL0003           Event Number
     C                     MOVEL'07'      WL0004    P      Event Code
     C                     Z-ADDWGAIC3    WL0005           Invoice/Memo Co
     C                     Z-ADDWGQ7NB    WL0006           Invoice/Memo Nu
     C                     MOVELWGOMST    WL0007    P      Invoice/Memo Su
     C                     Z-ADD##JDT     WL0008           Event Date
     C                     MOVEL'N'       WL0009    P      Activity Comple
     C                     MOVEL'N'       WL0010    P      Activity Hold
     C                     MOVEL'N'       WL0011    P      Post Cash Compl
     C                     Z-ADD0         WL0012           Cross Event Ref
     C                     Z-ADD0         WL0013           Cross Event Ref
     C                     Z-ADD0         WL0014           Cross Event Ref
     C                     Z-ADDWABKC7    WL0015           Ship To Custome
     C                     EXSR SJCRRC
     C                     GOTO SIEXIT                     *QUIT
     C           KRSSI     READE@EYCPZE                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCRRC    BEGSR
      *================================================================
      * CRT OP Order Events    CR - Order Events  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0012  1        EDI Status 1
     C                     MOVEL*BLANK    WN0013  1        EDI Status 2
     C                     MOVEL*BLANK    WN0014  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0015  60       Job Time
     C                     MOVEL*BLANK    WN0016 10        User Id
     C                     MOVEL*BLANK    WN0017 10        Job Name
     C                     Z-ADD*ZERO     WN0018  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @EYCPY3
     C                     Z-ADDWL0001    WHAIC3           Company Number
     C                     Z-ADDWL0002    WHC4NB           Order Number
     C                     Z-ADDWL0003    WHQ2NB           Event Number
     C                     MOVELWL0004    WHJPCD           Event Code
     C                     Z-ADDWL0005    WHAUC3           Invoice/Memo Co
     C                     Z-ADDWL0006    WHQ7NB           Invoice/Memo Nu
     C                     MOVELWL0007    WHOMST           Invoice/Memo Su
     C                     Z-ADDWL0008    WHD2DT           Event Date
     C                     MOVELWL0009    WHONST           Activity Comple
     C                     MOVELWL0010    WHOOST           Activity Hold
     C                     MOVELWL0011    WHOPST           Post Cash Compl
     C                     Z-ADDWL0012    WHAWC3           Cross Event Ref
     C                     Z-ADDWL0013    WHQ8NB           Cross Event Ref
     C                     Z-ADDWL0014    WHQ9NB           Cross Event Ref
     C                     Z-ADDWL0015    WHBKC7           Ship To Custome
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##JOB     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
     C           KLCRSJ    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHC4NB           Order Number
     C                     KFLD           WHQ2NB           Event Number
      * Check for duplicate primary key
     C           KLCRSJ    SETLL@EYCPY3                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1075' W0RTN   7
      * Send message 'Order Events           EX'
     C                     MOVEL'USR1075' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C                     WRITE@EYCPY3                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCHRC    BEGSR
      *================================================================
      * CHG for Invoice Post   CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0019  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0020  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0021  70       Ship To Custome
     C                     MOVEL*BLANK    WN0022 30        Ship To Name
     C                     MOVEL*BLANK    WN0023 30        Ship To Address
     C                     MOVEL*BLANK    WN0024 30        Ship To Address
     C                     MOVEL*BLANK    WN0025 30        Ship To Address
     C                     MOVEL*BLANK    WN0026 20        Ship To City
     C                     MOVEL*BLANK    WN0027  2        Ship To State C
     C                     MOVEL*BLANK    WN0028 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0029  70       Bill to Custome
     C                     MOVEL*BLANK    WN0030 30        Bill to Name
     C                     MOVEL*BLANK    WN0031 30        Bill to Address
     C                     MOVEL*BLANK    WN0032 30        Bill to Address
     C                     MOVEL*BLANK    WN0033 30        Bill to Address
     C                     MOVEL*BLANK    WN0034 20        Bill to City
     C                     MOVEL*BLANK    WN0035  2        Bill to State C
     C                     MOVEL*BLANK    WN0036 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0037 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0038  70       Order Date
     C                     Z-ADD*ZERO     WN0039  70       Requested Ship
     C                     Z-ADD*ZERO     WN0040  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0041  70       Cancel Date
     C                     MOVEL*BLANK    WN0042  2        Terms Code
     C                     MOVEL*BLANK    WN0043 40        Special Instruc
     C                     MOVEL*BLANK    WN0044 40        Special Instruc
     C                     MOVEL*BLANK    WN0045  3        Carrier Code
     C                     MOVEL*BLANK    WN0046  1        Comment Print A
     C                     MOVEL*BLANK    WN0047  1        Comment Print I
     C                     MOVEL*BLANK    WN0048  1        Comment Print P
     C                     MOVEL*BLANK    WN0049  1        Comment Print S
     C                     MOVEL*BLANK    WN0050  3        Reason Code
     C                     MOVEL*BLANK    WN0051  1        Order in Use
     C                     Z-ADD*ZERO     WN0052  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0053 10        User Original E
     C                     Z-ADD*ZERO     WN0054  70       Date of Origina
     C                     Z-ADD*ZERO     WN0055 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0056 112       Order Weight To
     C                     MOVEL*BLANK    WN0057  1        Credit Hold
     C                     MOVEL*BLANK    WN0058  1        Production Hold
     C                     MOVEL*BLANK    WN0059  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0060  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0061  40       Requested Deliv
     C                     MOVEL*BLANK    WN0062  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0063 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0064  70       Load ID
     C                     Z-ADD*ZERO     WN0065  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0066 112       Rated Freight
     C                     MOVEL*BLANK    WN0067  1        LTL Flag
     C                     MOVEL*BLANK    WN0068  1        Price Audit
     C                     MOVEL*BLANK    WN0069  1        Price Status
     C                     MOVEL*BLANK    WN0070  2        Shipping Method
     C                     MOVEL*BLANK    WN0071  1        Export Status
     C                     MOVEL*BLANK    WN0072  1        Palletize
     C                     MOVEL*BLANK    WN0073  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0074  1        Slip Sheet
     C                     MOVEL*BLANK    WN0075  1        Age Code
     C                     Z-ADD*ZERO     WN0076  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0077  1        Load Type
     C                     Z-ADD*ZERO     WN0078  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0079  1        Load Plan Order
     C                     MOVEL*BLANK    WN0080  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0081  70       Resell Referenc
     C                     MOVEL*BLANK    WN0082 30        Special Comment
     C                     MOVEL*BLANK    WN0083 30        Special Comment
     C                     MOVEL*BLANK    WN0084  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0085  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0086  2        Manager Level C
     C                     MOVEL*BLANK    WN0087  3        VP Level Code
     C                     Z-ADD*ZERO     WN0088  70       Attach to Order
     C                     MOVEL*BLANK    WN0089  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0090  70       Invoice Number
     C                     MOVEL*BLANK    WN0091  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0092  70       Invoice Date
     C                     MOVEL*BLANK    WN0093  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0094  1        Modified Flag
     C                     Z-ADD*ZERO     WN0095 112       Invoice Order V
     C                     MOVEL*BLANK    WN0096  1        Process Sts for
     C                     MOVEL*BLANK    WN0097  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0098  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0099  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0100  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0101  1        Email Cust On O
     C                     MOVEL*BLANK    WN0102  1        Order Emailed
     C                     MOVEL*BLANK    WN0103  1        Export Docs Go
     C                     MOVEL*BLANK    WN0104  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0105  1        Broker Order St
     C                     MOVEL*BLANK    WN0106  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0107  2        Order Requires
     C                     MOVEL*BLANK    WN0108  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0109  2        Export USDA App
     C                     MOVEL*BLANK    WN0110  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0111  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0112  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0113  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0114  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0115  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0116  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0117  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0118  60       Time of Origina
     C                     Z-ADD*ZERO     WN0119  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0120  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0121  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0122 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0123 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0124 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0125 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0126 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0127  70       Claim Number
     C                     MOVEL*BLANK    WN0128  1        EDI Status 1
     C                     MOVEL*BLANK    WN0129  1        EDI Status 2
     C                     MOVEL*BLANK    WN0130  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0131  60       Job Time
     C                     MOVEL*BLANK    WN0132 10        User Id
     C                     MOVEL*BLANK    WN0133 10        Job Name
     C                     Z-ADD*ZERO     WN0134  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWAAIC3    WIAIC3           Company Number
     C                     Z-ADDWAC4NB    WIC4NB           Order Number
      *
     C           KLCHSK    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIC4NB           Order Number
     C           KLCHSK    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YARDCS
      * USER: Processing after Data read
      * doesnt upd the last from here - discovered 3.10.16
      * Move non-key fields to @BECPFJ
     C                     MOVEL'C'       WIGWST    P      Header Status
     C                     MOVELYL0004    WIGXST    P      Header Status L
     C                     MOVEL'Y'       WIGYST    P      Order Type Prin
     C                     MOVEL'07'      WIJPCD    P      Event Code
     C                     Z-ADDWAVRVA    WIVRVA           A/R order Value
     C                     MOVELWAOBST    WIOBST    P      Billing Activit
     C                     MOVELWABCST    WIBCST    P      Block Order Fla
     C                     MOVELWABDST    WIBDST    P      Order Certifica
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WIAATM           Job Time
     C                     MOVEL##USR     WIAYNA           User Id
     C                     MOVEL##PGM     WIA0NA           Job Name
     C                     Z-ADD##JDT     WIAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - Order Header TRG  * 
     C                     CLEARPARC
     C                     Z-ADDWIAIC3    PAAIC3           Company Number
     C                     Z-ADDWIC4NB    PAC4NB           Order Number
     C                     MOVELWIJNCD    PAJNCD    P      Order Type - Sa
     C                     Z-ADDWIANC7    PAANC7           A/R Customer Nu
     C                     Z-ADDWIBKC7    PABKC7           Ship To Custome
     C                     MOVELWIBRTX    PABRTX    P      Ship To Name
     C                     MOVELWIHMNA    PAHMNA    P      Ship To Address
     C                     MOVELWIHONA    PAHONA    P      Ship To Address
     C                     MOVELWIHPNA    PAHPNA    P      Ship To Address
     C                     MOVELWIHNNA    PAHNNA    P      Ship To City
     C                     MOVELWIDBCD    PADBCD    P      Ship To State C
     C                     MOVELWICKTX    PACKTX    P      Ship To Zip/Pos
     C                     Z-ADDWIB0C7    PAB0C7           Bill to Custome
     C                     MOVELWIAETX    PAAETX    P      Bill to Name
     C                     MOVELWIB1NA    PAB1NA    P      Bill to Address
     C                     MOVELWIB3NA    PAB3NA    P      Bill to Address
     C                     MOVELWIB4NA    PAB4NA    P      Bill to Address
     C                     MOVELWIB2NA    PAB2NA    P      Bill to City
     C                     MOVELWIBHCD    PABHCD    P      Bill to State C
     C                     MOVELWIC8TX    PAC8TX    P      Bill to Zip/Pos
     C                     MOVELWIBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDWIA0DT    PAA0DT           Order Date
     C                     Z-ADDWIA5DT    PAA5DT           Requested Ship
     C                     Z-ADDWIGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDWIACDT    PAACDT           Cancel Date
     C                     MOVELWIAQCD    PAAQCD    P      Terms Code
     C                     MOVELWIB6NA    PAB6NA    P      Special Instruc
     C                     MOVELWIBYNA    PABYNA    P      Special Instruc
     C                     MOVELWIBZNA    PABZNA    P      Carrier Code
     C                     MOVELWIGTST    PAGTST    P      Comment Print A
     C                     MOVELWIGVST    PAGVST    P      Comment Print I
     C                     MOVELWIGUST    PAGUST    P      Comment Print P
     C                     MOVELWIQFST    PAQFST    P      Comment Print S
     C                     MOVELWICQCD    PACQCD    P      Reason Code
     C                     MOVELWIGJST    PAGJST    P      Order in Use
     C                     MOVELWIGWST    PAGWST    P      Header Status
     C                     MOVELWIGXST    PAGXST    P      Header Status L
     C                     MOVELWIGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDWIAODT    PAAODT           Scheduled Ship
     C                     MOVELWIAIVN    PAAIVN    P      User Original E
     C                     Z-ADDWICXDT    PACXDT           Date of Origina
     C                     Z-ADDWIJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDWIA1WG    PAA1WG           Order Weight To
     C                     MOVELWIXIST    PAXIST    P      Credit Hold
     C                     MOVELWIXJST    PAXJST    P      Production Hold
     C                     MOVELWIXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDWIEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDWIAFTM    PAAFTM           Requested Deliv
     C                     MOVELWIE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELWIE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDWIRMNB    PARMNB           Load ID
     C                     Z-ADDWITBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDWIR1NB    PAR1NB           Rated Freight
     C                     MOVELWIPJST    PAPJST    P      LTL Flag
     C                     MOVELWIU0ST    PAU0ST    P      Price Audit
     C                     MOVELWIU1ST    PAU1ST    P      Price Status
     C                     MOVELWIQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELWIU2ST    PAU2ST    P      Export Status
     C                     MOVELWIVEST    PAVEST    P      Palletize
     C                     MOVELWIVFST    PAVFST    P      Shrink Wrap
     C                     MOVELWIVGST    PAVGST    P      Slip Sheet
     C                     MOVELWIRPCD    PARPCD    P      Age Code
     C                     Z-ADDWIRNNB    PARNNB           Reefer Temperat
     C                     MOVELWIVDST    PAVDST    P      Load Type
     C                     Z-ADDWIATIN    PAATIN           Attach to Invoi
     C                     MOVELWIU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELWIU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDWIRSRN    PARSRN           Resell Referenc
     C                     MOVELWIMHNA    PAMHNA    P      Special Comment
     C                     MOVELWIMINA    PAMINA    P      Special Comment
     C                     MOVELWIWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELWIR4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELWIBFCD    PABFCD    P      Manager Level C
     C                     MOVELWIQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDWIT3NB    PAT3NB           Attach to Order
     C                     MOVELWISICD    PASICD    P      Reason for Pric
     C                     Z-ADDWICONB    PACONB           Invoice Number
     C                     MOVELWICEST    PACEST    P      Invoice Suffix
     C                     Z-ADDWIAWDT    PAAWDT           Invoice Date
     C                     MOVELWIJPCD    PAJPCD    P      Event Code
     C                     MOVELWIXUST    PAXUST    P      Trans Contol AS
     C                     MOVELWIZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDWIVRVA    PAVRVA           A/R order Value
     C                     MOVELWIOBST    PAOBST    P      Billing Activit
     C                     MOVELWIBCST    PABCST    P      Block Order Fla
     C                     MOVELWIBDST    PABDST    P      Order Certifica
     C                     Z-ADDWIB7VL    PAB7VL           Invoice Order V
     C                     MOVELWIGASX    PAGASX    P      Process Sts for
     C                     MOVELWIGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELWIGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELWIGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELWIFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELWIFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELWIFPSX    PAFPSX    P      Order Emailed
     C                     MOVELWIFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELWIFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELWIFSSX    PAFSSX    P      Broker Order St
     C                     MOVELWIFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELWIFUSX    PAFUSX    P      Order Requires
     C                     MOVELWIFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELWIFWSX    PAFWSX    P      Export USDA App
     C                     MOVELWIFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELWIFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDWINODT    PANODT           OH Appt Confirm
     C                     Z-ADDWINPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDWINQDT    PANQDT           Load Actual Shi
     C                     Z-ADDWINRDT    PANRDT           Load BOL Comple
     C                     Z-ADDWINSDT    PANSDT           Load Truck Depa
     C                     Z-ADDWIBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDWIBQTM    PABQTM           Time of Origina
     C                     Z-ADDWIBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDWIBSTM    PABSTM           Load BOL Comple
     C                     Z-ADDWIBTTM    PABTTM           Load Truck Depa
     C                     Z-ADDWIH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDWIH1NX    PAH1NX           Act Non-Ref Frt
     C                     Z-ADDWIH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDWIH3NX    PAH3NX           OH Total Non-Re
     C                     Z-ADDWIH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDWIC0C7    PAC0C7           Claim Number
     C                     MOVELWIUVST    PAUVST    P      EDI Status 1
     C                     MOVELWIUWST    PAUWST    P      EDI Status 2
     C                     MOVELWIUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDWIAATM    PAAATM           Job Time
     C                     MOVELWIAYNA    PAAYNA    P      User Id
     C                     MOVELWIA0NA    PAA0NA    P      Job Name
     C                     Z-ADDWIAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Ld Orders Invoiced RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/12/04 SLM PKTR01 Multi-Company - Function was changed
      *                                     to remove Company RST or Pos
     C                     MOVEL'Y'       WN0010           Invoiced Flag U
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJRMNB    WQSL02           Load ID
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL02           Load ID
      * Setup key
     C                     Z-ADDWARMNB    WQSL02           Load ID
      * Establish starting position
     C           KRSSL     SETLL@BFCPD9                    *
     C           KRSSL     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - ((c1 AND c2) OR c3)
      *   |- c1    : DB1.Header Status is Complete
      *   |- c2    : DB1.Event Code is 07 Written to History
      *   |- c3    : DB1.Header Status is Cancelled
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WJGWST    IFEQ 'C'                        *IF
     C           WJJPCD    IFEQ '07'                       *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WJGWST    IFEQ 'X'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WN0010           Invoiced Flag U
     C                     GOTO SLEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSL     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCHRC    BEGSR
      *================================================================
      * CHG Load Status        CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0135  30       Company Number
     C                     MOVEL*BLANK    WN0136  1        LTL Flag
     C                     Z-ADD*ZERO     WN0137  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0138 15        Seal 1
     C                     MOVEL*BLANK    WN0139 15        Seal 2
     C                     MOVEL*BLANK    WN0140 15        Seal 3
     C                     MOVEL*BLANK    WN0141 15        Seal 1 Unused
     C                     MOVEL*BLANK    WN0142 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0143  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0144 112       Flat Amount
     C                     MOVEL*BLANK    WN0145  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0146  50       Total Stops
     C                     MOVEL*BLANK    WN0147 20        Trailer Id
     C                     MOVEL*BLANK    WN0148  3        Transloader Car
     C                     Z-ADD*ZERO     WN0149  40       BOL Time
     C                     MOVEL*BLANK    WN0150  3        Carrier Code
     C                     MOVEL*BLANK    WN0151  7        Truck Size
     C                     Z-ADD*ZERO     WN0152  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0153 112       Rated Freight
     C                     MOVEL*BLANK    WN0154  1        Ship Status
     C                     MOVEL*BLANK    WN0155  1        Load Type
     C                     Z-ADD*ZERO     WN0156  50       Number Pallets
     C                     Z-ADD*ZERO     WN0157  50       Number Pallets
     C                     Z-ADD*ZERO     WN0158 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0159  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0160  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0161  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0162 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0163 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0164  70       Actual Departur
     C                     Z-ADD*ZERO     WN0165  40       Departure Time
     C                     Z-ADD*ZERO     WN0166  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0167  52       Product Tempera
     C                     Z-ADD*ZERO     WN0168  50       Number Pallets
     C                     MOVEL*BLANK    WN0169 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0170  70       Total Load Mile
     C                     MOVEL*BLANK    WN0171 12        Recorder ID
     C                     MOVEL*BLANK    WN0172  2        Shipping Method
     C                     MOVEL*BLANK    WN0173  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0174  2        Ship To State C
     C                     Z-ADD*ZERO     WN0175  70       Gross Weight
     C                     MOVEL*BLANK    WN0176  3        Carrier Broker
     C                     MOVEL*BLANK    WN0177  1        Export Status
     C                     Z-ADD*ZERO     WN0178  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0179  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0180  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0181  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0182  70       Spotted Date
     C                     Z-ADD*ZERO     WN0183  60       Spotted Time
     C                     Z-ADD*ZERO     WN0184  70       Load Finished D
     C                     Z-ADD*ZERO     WN0185  60       Load Finished T
     C                     Z-ADD*ZERO     WN0186  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0187  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0188  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0189  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0190  70       Truck Departure
     C                     Z-ADD*ZERO     WN0191  60       Truck Departure
     C                     Z-ADD*ZERO     WN0192  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0193  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0194  3        Shipping Line
     C                     MOVEL*BLANK    WN0195 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0196 30        Vessel Name
     C                     Z-ADD*ZERO     WN0197  50       Voyage
     C                     Z-ADD*ZERO     WN0198  70       Sail Date
     C                     MOVEL*BLANK    WN0199 12        Booking Number
     C                     MOVEL*BLANK    WN0200 20        Discharge Port
     C                     Z-ADD*ZERO     WN0201  70       Arrival Date
     C                     MOVEL*BLANK    WN0202 12        Container Numbe
     C                     Z-ADD*ZERO     WN0203  70       Date In
     C                     Z-ADD*ZERO     WN0204  60       Time In
     C                     Z-ADD*ZERO     WN0205  70       Date Out
     C                     Z-ADD*ZERO     WN0206  60       Time Out
     C                     Z-ADD*ZERO     WN0207 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0208  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0209  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0210  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0211  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0212  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0213  70       Requested Deliv
     C                     MOVEL*BLANK    WN0214  1        Load Acceptance
     C                     MOVEL*BLANK    WN0215  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0216  70       On Yard Date
     C                     Z-ADD*ZERO     WN0217  60       On Yard Time
     C                     Z-ADD*ZERO     WN0218  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0219  60       Deadline Depart
     C                     MOVEL*BLANK    WN0220  1        Load Held Over
     C                     MOVEL*BLANK    WN0221  1        Load Held Over
     C                     MOVEL*BLANK    WN0222 15        Load Held Over
     C                     MOVEL*BLANK    WN0223 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0224 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0225  70       Express Mail Da
     C                     MOVEL*BLANK    WN0226  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0227  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0228  70       Product Complet
     C                     Z-ADD*ZERO     WN0229  60       Product Complet
     C                     Z-ADD*ZERO     WN0230  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0231  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0232  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0233  1        Load Confirmed
     C                     MOVEL*BLANK    WN0234 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0235  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0236  60       Load Door 1
     C                     Z-ADD*ZERO     WN0237  70       Override Total
     C                     Z-ADD*ZERO     WN0238  60       Load Door 2
     C                     MOVEL*BLANK    WN0239  1        Partial Load
     C                     MOVEL*BLANK    WN0240  1        Load Confirmati
     C                     MOVEL*BLANK    WN0241  1        Export Load USD
     C                     MOVEL*BLANK    WN0242  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0243 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0244 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0245 15        Late Billing Em
     C                     MOVEL*BLANK    WN0246 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0247 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0248  1        Multi Company L
     C                     MOVEL*BLANK    WN0249  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0250  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0251  1        LH Power Only L
     C                     MOVEL*BLANK    WN0252  1        LH Unused Sts 4
     C                     MOVEL*BLANK    WN0253  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0254  2        Load U/M
     C                     MOVEL*BLANK    WN0255  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0256  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0257  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0258  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0259  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0260  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0261  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0262  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0263  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0264  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0265  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0266  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0267  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0268  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0269  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0270  60       LH Unused Time
     C                     MOVEL*BLANK    WN0271  1        EDI Status 1
     C                     MOVEL*BLANK    WN0272  1        EDI Status 2
     C                     MOVEL*BLANK    WN0273  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0274  60       Job Time
     C                     MOVEL*BLANK    WN0275 10        User Id
     C                     MOVEL*BLANK    WN0276 10        Job Name
     C                     Z-ADD*ZERO     WN0277  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWARMNB    WKRMNB           Load ID
      *
     C           KLCHSM    KLIST
     C                     KFLD           WKRMNB           Load ID
     C           KLCHSM    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YBRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDWAAODT    WKAODT           Scheduled Ship
     C                     MOVEL'I'       WKPKST    P      Load Status
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WKAATM           Job Time
     C                     MOVEL##USR     WKAYNA           User Id
     C                     MOVEL##JOB     WKA0NA           Job Name
     C                     Z-ADD##JDT     WKAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * This Sequence Contains Function Documentation
      *================================================================
      * ****************************************************************
      * *  Read Order Header
      * *      Read Shipping Detail
      * *         Update Status, Event, G/L Update Flag in Shipping Dtl
      * *  *** NOTE:  Whse Transfers are not really written to history
      * *         Update Contracts if used.
      * *         Return Total Amount/Weight Billed
      * ****************************************************************
      * S00074  RMC 01/18/08  Dont complete if truck departure not entere
      * ****************************************************************
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * CHANGE LOG
      *================================================================
      * E4119 RMC 5/23/2016 Remove Live with tpm checks
      * E004119 12/09/2015 PKD Added Live with TPM logic
      * S00074 - get company value for truck departure validation
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Process Shipping Detail
      *================================================================
     C                     Z-ADD0         WN0007           Quantity Billed
     C                     Z-ADD0         WN0008           Weight Billed
      * This function updates Shipping Detail Status="C", Last Status
      *                       Event code to "07", G/L Update Status="N"
      *                       (not G/L Update Status - not in Detail file
      *                       & returns Order Total Qty & Weight Billed
      *                       & also affect inventory, sales $, sales # f
      * NOTE:  This is the same function used in Invoice Post program
      * UPD Invoice Post Dtl   XF - Order Detail  * 
     C                     CALL 'PDT4XFR'              90  UPD Invoice Pos
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0001  30       Company Number
     C                     PARM WAC4NB    WQ0002  70       Order Number
     C           WN0001    PARM *BLANK    WQ0003  1        Affect Inventor
     C           WN0002    PARM *BLANK    WQ0004  1        Affect Sales Do
     C           WN0003    PARM *BLANK    WQ0005  1        Affect Sales Pn
     C           WN0007    PARM WN0007    WQ0006 112       Quantity Billed
     C           WN0008    PARM WN0008    WQ0007 112       Weight Billed
     C                     PARM WACXDT    WQ0008  70       Date of Origina
     C                     PARM WAOBST    WQ0009  1        Billing Activit
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDT4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Change/Create A/R Summary Record
      *================================================================
      * 12/07/06 PKD PK0040 Use Accounting Company if there
      * RTV OD Whs/ShpCo/AccCo RT - Order Detail  * 
     C                     EXSR SFRVGN
      * CASE: LCL.Accounting Company is Equal to zero
     C           YL0003    IFEQ 0                          *IF
      * EDT A/R Summary        XF - A/R Summary  * Accounting Company
     C                     CALL 'PDU4XFR'              90  EDT A/R Summary
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0010  30       Company Number
     C                     PARM WAANC7    WQ0011  70       A/R Customer Nu
     C                     PARM WAA0DT    WQ0012  70       Order Date
     C                     PARM WAGNDT    WQ0013  70       Actual Shipped
     C                     PARM WAJZVA    WQ0014 112       Order Value Tot
     C                     PARM WAA1WG    WQ0015 112       Order Weight To
     C                     PARM WAVRVA    WQ0016 112       A/R order Value
     C                     PARM WAOBST    WQ0017  1        Billing Activit
     C                     PARM WN0002    WQ0018  1        Affect Sales Do
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDU4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * EDT A/R Summary        XF - A/R Summary  * Accounting Company
     C                     CALL 'PDU4XFR'              90  EDT A/R Summary
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0003    WQ0019  30       Company Number
     C                     PARM WAANC7    WQ0020  70       A/R Customer Nu
     C                     PARM WAA0DT    WQ0021  70       Order Date
     C                     PARM WAGNDT    WQ0022  70       Actual Shipped
     C                     PARM WAJZVA    WQ0023 112       Order Value Tot
     C                     PARM WAA1WG    WQ0024 112       Order Weight To
     C                     PARM WAVRVA    WQ0025 112       A/R order Value
     C                     PARM WAOBST    WQ0026  1        Billing Activit
     C                     PARM WN0002    WQ0027  1        Affect Sales Do
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDU4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WAA0DT           Order Date
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WAACDT           Cancel Date
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WAJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WAA1WG           Order Weight To
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WATBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WAATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WARSRN           Resell Referenc
     C                     Z-ADD*ZERO     WAT3NB           Attach to Order
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WAAWDT           Invoice Date
     C                     Z-ADD*ZERO     WAVRVA           A/R order Value
     C                     Z-ADD*ZERO     WAB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WANODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WANPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WANQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WANRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WANSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WABPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WABQTM           Time of Origina
     C                     Z-ADD*ZERO     WABRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WABSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WABTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WAH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WAH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WAH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WAH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WAH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Status - Y or N
     C                     MOVEL*BLANK    WUB8ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBM8NB           System Value Nu
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field Load Status
     C                     MOVEL*BLANK    WUPKST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WCRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WCFLAM           Flat Amount
     C                     Z-ADD*ZERO     WCRRNB           Total Stops
     C                     Z-ADD*ZERO     WCSBNB           BOL Time
     C                     Z-ADD*ZERO     WCSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCSDNB           Number Pallets
     C                     Z-ADD*ZERO     WCPAOU           Number Pallets
     C                     Z-ADD*ZERO     WCDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WCSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WCHADT           Actual Arrival
     C                     Z-ADD*ZERO     WCAART           Actual Arrival
     C                     Z-ADD*ZERO     WCDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WCDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WCAQDT           Actual Departur
     C                     Z-ADD*ZERO     WCS6NB           Departure Time
     C                     Z-ADD*ZERO     WCT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WCPRTM           Product Tempera
     C                     Z-ADD*ZERO     WCNPSV           Number Pallets
     C                     Z-ADD*ZERO     WCTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WCGRWE           Gross Weight
     C                     Z-ADD*ZERO     WCF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WCJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WCTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WCJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WCSPTM           Spotted Time
     C                     Z-ADD*ZERO     WCJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WCLFTM           Load Finished T
     C                     Z-ADD*ZERO     WCJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WCBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WCJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WCBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WCKIDT           Truck Departure
     C                     Z-ADD*ZERO     WCASTM           Truck Departure
     C                     Z-ADD*ZERO     WCKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WCAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WCVOAG           Voyage
     C                     Z-ADD*ZERO     WCKBDT           Sail Date
     C                     Z-ADD*ZERO     WCEFDT           Arrival Date
     C                     Z-ADD*ZERO     WCKCDT           Date In
     C                     Z-ADD*ZERO     WCTMIN           Time In
     C                     Z-ADD*ZERO     WCKDDT           Date Out
     C                     Z-ADD*ZERO     WCVMNB           Time Out
     C                     Z-ADD*ZERO     WCOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WCKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WCATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WCBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WCEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WCKKDT           On Yard Date
     C                     Z-ADD*ZERO     WCAVTM           On Yard Time
     C                     Z-ADD*ZERO     WCKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WCAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WCLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WCK0DT           Product Complet
     C                     Z-ADD*ZERO     WCAYTM           Product Complet
     C                     Z-ADD*ZERO     WCKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WCICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WCIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WCK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WCAZTM           Load Door 1
     C                     Z-ADD*ZERO     WCK2DT           Override Total
     C                     Z-ADD*ZERO     WCA0TM           Load Door 2
     C                     Z-ADD*ZERO     WCZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WCPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WCCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WCPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WCCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WCP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WCCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WCP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WCCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WCP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WCCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WCP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WCCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field EDI Status 1
     C                     MOVEL*BLANK    WUUVST  1
      * Define work field Truck Departure Date
     C                     Z-ADD*ZERO     WUKIDT  70
      * Define work field Truck Departure Time
     C                     Z-ADD*ZERO     WUASTM  60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDDPNB           Order Sequence
     C                     Z-ADD*ZERO     WDUENB           Order Secondary
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WDMAVA           Billing Detail
     C                     Z-ADD*ZERO     WDKDVA           Billing Detail
     C                     Z-ADD*ZERO     WDL8VA           Billing Detail
     C                     Z-ADD*ZERO     WDL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WDAYVA           Extended Amount
     C                     Z-ADD*ZERO     WDEXDT           Market Pricing
     C                     Z-ADD*ZERO     WDBZPR           Price Overage O
     C                     Z-ADD*ZERO     WDL6NB           Contract Number
     C                     Z-ADD*ZERO     WDGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WDD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WDCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WDAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WDCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WDATWG           Weight Shipped
     C                     Z-ADD*ZERO     WDAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WDAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WDAKPR           Unit Price
     C                     Z-ADD*ZERO     WDALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WDAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WDAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WDA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WDA5DT           Requested Ship
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WDRGNB           Item Structure
     C                     Z-ADD*ZERO     WDRHNB           Item Structure
     C                     Z-ADD*ZERO     WDRINB           Item Structure
     C                     Z-ADD*ZERO     WDCXDT           Date of Origina
     C                     Z-ADD*ZERO     WDDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WDB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WDA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WDNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WDNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WDNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WDNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WDNXDT           OD Unused Date
     C                     Z-ADD*ZERO     WDBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WDBVTM           Price Code
     C                     Z-ADD*ZERO     WDBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WDBXTM           Substitution Li
     C                     Z-ADD*ZERO     WDBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WDH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WDH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WDH7NX           OD Item Target
     C                     Z-ADD*ZERO     WDH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WDH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WDDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WDDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WDDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WDDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WDDZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WDGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WDGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WDGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WDPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WDRINY           Item Age Days
     C                     Z-ADD*ZERO     WDTIDT           Production Ovr
     C                     Z-ADD*ZERO     WDTJDT           Production Ovr
     C                     Z-ADD*ZERO     WDTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WDTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WDTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WEBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WEBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WEBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WEBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Define work field Event Code
     C                     MOVEL*BLANK    WUJPCD  2
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFC4NB           Order Number
     C                     Z-ADD*ZERO     WFQ2NB           Event Number
     C                     Z-ADD*ZERO     WFAUC3           Invoice/Memo Co
     C                     Z-ADD*ZERO     WFQ7NB           Invoice/Memo Nu
     C                     Z-ADD*ZERO     WFD2DT           Event Date
     C                     Z-ADD*ZERO     WFAWC3           Cross Event Ref
     C                     Z-ADD*ZERO     WFQ8NB           Cross Event Ref
     C                     Z-ADD*ZERO     WFQ9NB           Cross Event Ref
     C                     Z-ADD*ZERO     WFBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Clear all neither parameters
      * CRT OP Order Events    CR - Order Events  * 
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Event Number
     C                     Z-ADD*ZERO     WUQ2NB  50
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SJCRRC.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     Z-ADD*ZERO     WL0003  50
     C                     MOVEL*BLANK    WL0004  2
     C                     Z-ADD*ZERO     WL0005  30
     C                     Z-ADD*ZERO     WL0006  70
     C                     MOVEL*BLANK    WL0007  2
     C                     Z-ADD*ZERO     WL0008  70
     C                     MOVEL*BLANK    WL0009  1
     C                     MOVEL*BLANK    WL0010  1
     C                     MOVEL*BLANK    WL0011  1
     C                     Z-ADD*ZERO     WL0012  30
     C                     Z-ADD*ZERO     WL0013  70
     C                     Z-ADD*ZERO     WL0014  50
     C                     Z-ADD*ZERO     WL0015  70
      * Define null work field Load Status
     C                     MOVEL*BLANK    YN0001  1
      * Define null work field BOL Complete Date
     C                     Z-ADD*ZERO     YN0002  70
      * Define null work field BOL Complete Time
     C                     Z-ADD*ZERO     YN0003  60
      * Define local work field Scheduled Ship Date USR
     C                     Z-ADD*ZERO     YL0001  70
      * Define null work field Warehouse Code
     C                     MOVEL*BLANK    YN0004  3
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0002  30
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0003  30
      * Define local work field Header Status Last
     C                     MOVEL*BLANK    YL0004  1
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 INVTRKDPTR
00002 Y2U0005
