     H/TITLE Prt Frght Comparison   PV Prompt & validate record
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Prompts fields, allowing user changes
     H* - Validates fields
     H* - If valid, performs an action
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Prompt & validate record
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 01/12/17  Time  : 13:01:50
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOMNGPVR#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: Prt Frght Comparison   PV Prompt & validate record
      *
     FOMHLREL3IF  E           K        DISK
      * RTV : Accrual Program           Active Records Only
      *
     FCAAMREL3IF  E           K        DISK
      * RTV : Unit of Measure           Active Records
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FPDJYREL2IF  E           K        DISK
      * RTV : Company Defaults Internal Active Records
      *
     FCABBRELCIF  E           K        DISK
      * RSQ : Customer                  RSQ Parent # Active
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer                  Retrieval index       NV
      *
     FCABBRELBIF  E           K        DISK
      * RSQ : Customer                  RSQ Bill to (A/R) Active
      *
     FCABBRELAIF  E           K        DISK
      * RTV : Customer                  Active Only
      *
     FOMFFREL0IF  E           K        DISK
      * RTV : Carrier                   Retrieval index
      *
     FOMHSTPN8IF  E           K        DISK
      * RSQ : Sales History             Load#/Order#
      *
     FOPBFCPL8IF  E           K        DISK
      * RSQ : Order Header TRG          Load #/All orders
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FPDJEREL1IF  E           K        DISK
      * RTV : Sales Route               Retrieval index
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    J7          7  1
     E                    K7          7  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    #L7         7  1
     E                    UCT        40  1               CENTER TABLE
      * DETAIL Screen: Field position and name array
     E                    W0BEG   7 020  5 0A
     E                    W0END   7 020  5 0A
     E                    W0NAM   7 020 10
      * Long constants
     E                    @CN#    1  24  6   @CN    25
     I@HLREU8
      * Accrual Program           Active Records Only
      * Renamed input format fields
     I              HLOJCD                          WAOJCD
     I              HLLENA                          WALENA
     I              HLTOST                          WATOST
     I              HLTQST                          WATQST
     I              HLTRST                          WATRST
     I              HLTSST                          WATSST
     I              HLOKCD                          WAOKCD
     I              HLTYST                          WATYST
     I              HLOQCD                          WAOQCD
     I              HLHHCD                          WAHHCD
     I              HLI2TX                          WAI2TX
     I              HLJFTX                          WAJFTX
     I              HLI3TX                          WAI3TX
     I              HLJGTX                          WAJGTX
     I              HLLEDG                          WALEDG
     I              HLTTST                          WATTST
     I              HLBKPR                          WABKPR
     I              HLSHSX                          WASHSX
     I              HLQFSX                          WAQFSX
     I              HLFDTX                          WAFDTX
     I              HLFETX                          WAFETX
     I              HLFFTX                          WAFFTX
     I              HLFGTX                          WAFGTX
     I              HLHQVL                          WAHQVL
     I              HLFHTX                          WAFHTX
     I              HLUVST                          WAUVST
     I              HLUWST                          WAUWST
     I              HLUXST                          WAUXST
     I              HLVSST                          WAVSST
     I              HLAATM                          WAAATM
     I              HLAYNA                          WAAYNA
     I              HLA0NA                          WAA0NA
     I              HLAXDT                          WAAXDT
      *
     I@AMREU9
      * Unit of Measure           Active Records
      * Renamed input format fields
     I              AMHHCD                          WBHHCD
     I              AMAUNA                          WBAUNA
     I              AMUVST                          WBUVST
     I              AMUWST                          WBUWST
     I              AMUXST                          WBUXST
     I              AMVSST                          WBVSST
     I              AMAATM                          WBAATM
     I              AMAYNA                          WBAYNA
     I              AMA0NA                          WBA0NA
     I              AMAXDT                          WBAXDT
      *
     I@ABREG3
      * Company Name and Address  Retrieval index       NV
      * Renamed input format fields
     I              ABAIC3                          WCAIC3
     I              ABADTX                          WCADTX
     I              ABACNA                          WCACNA
     I              ABADNA                          WCADNA
     I              ABAENA                          WCAENA
     I              ABAJNA                          WCAJNA
     I              ABBTTX                          WCBTTX
     I              ABBVTX                          WCBVTX
     I              ABBWTX                          WCBWTX
     I              ABA2NA                          WCA2NA
     I              ABABTX                          WCABTX
     I              ABBGCD                          WCBGCD
     I              ABKXCD                          WCKXCD
     I              ABUVST                          WCUVST
     I              ABUWST                          WCUWST
     I              ABUXST                          WCUXST
     I              ABVSST                          WCVSST
     I              ABAATM                          WCAATM
     I              ABAYNA                          WCAYNA
     I              ABA0NA                          WCA0NA
     I              ABAXDT                          WCAXDT
      *
     I@JYRECE
      * Company Defaults Internal Active Records
      * Renamed input format fields
     I              JYAIC3                          WDAIC3
     I              JYZ9ST                          WDZ9ST
     I              JYCSST                          WDCSST
     I              JYZ8ST                          WDZ8ST
     I              JYCXST                          WDCXST
     I              JYSWST                          WDSWST
     I              JYXXTM                          WDXXTM
     I              JYUECD                          WDUECD
     I              JYHSST                          WDHSST
     I              JYAMEO                          WDAMEO
     I              JYSSDF                          WDSSDF
     I              JYPDFT                          WDPDFT
     I              JYYISX                          WDYISX
     I              JYYJSX                          WDYJSX
     I              JYYKSX                          WDYKSX
     I              JYYLSX                          WDYLSX
     I              JYYMSX                          WDYMSX
     I              JYYNSX                          WDYNSX
     I              JYUVST                          WDUVST
     I              JYUWST                          WDUWST
     I              JYUXST                          WDUXST
     I              JYVSST                          WDVSST
     I              JYAATM                          WDAATM
     I              JYAYNA                          WDAYNA
     I              JYA0NA                          WDA0NA
     I              JYAXDT                          WDAXDT
      *
     I@BBREXK
      * Customer                  RSQ Parent # Active
      * Renamed input format fields
     I              BBBKC7                          WEBKC7
     I              BBAYTX                          WEAYTX
     I              BBACNA                          WEACNA
     I              BBADNA                          WEADNA
     I              BBAENA                          WEAENA
     I              BBAJNA                          WEAJNA
     I              BBBGCD                          WEBGCD
     I              BBG5CD                          WEG5CD
     I              BBBTTX                          WEBTTX
     I              BBBVTX                          WEBVTX
     I              BBBWTX                          WEBWTX
     I              BBABTX                          WEABTX
     I              BBA2NA                          WEA2NA
     I              BBCBST                          WECBST
     I              BBB0NA                          WEB0NA
     I              BBP3NB                          WEP3NB
     I              BBAXNA                          WEAXNA
     I              BBI6DT                          WEI6DT
     I              BBAYDT                          WEAYDT
     I              BBANC7                          WEANC7
     I              BBBTC7                          WEBTC7
     I              BBK6ST                          WEK6ST
     I              BBUZST                          WEUZST
     I              BBKXCD                          WEKXCD
     I              BBLTCD                          WELTCD
     I              BBQNST                          WEQNST
     I              BBS2NB                          WES2NB
     I              BBVHVA                          WEVHVA
     I              BBI7DT                          WEI7DT
     I              BBRJST                          WERJST
     I              BBRKST                          WERKST
     I              BBQWST                          WEQWST
     I              BBQXST                          WEQXST
     I              BBQYST                          WEQYST
     I              BBUNCS                          WEUNCS
     I              BBUVST                          WEUVST
     I              BBUWST                          WEUWST
     I              BBUXST                          WEUXST
     I              BBVSST                          WEVSST
     I              BBAATM                          WEAATM
     I              BBAYNA                          WEAYNA
     I              BBA0NA                          WEA0NA
     I              BBAXDT                          WEAXDT
      *
     I@BBREE9
      * Customer                  Retrieval index       NV
      * Renamed input format fields
     I              BBBKC7                          WFBKC7
     I              BBAYTX                          WFAYTX
     I              BBACNA                          WFACNA
     I              BBADNA                          WFADNA
     I              BBAENA                          WFAENA
     I              BBAJNA                          WFAJNA
     I              BBBGCD                          WFBGCD
     I              BBG5CD                          WFG5CD
     I              BBBTTX                          WFBTTX
     I              BBBVTX                          WFBVTX
     I              BBBWTX                          WFBWTX
     I              BBABTX                          WFABTX
     I              BBA2NA                          WFA2NA
     I              BBCBST                          WFCBST
     I              BBB0NA                          WFB0NA
     I              BBP3NB                          WFP3NB
     I              BBAXNA                          WFAXNA
     I              BBI6DT                          WFI6DT
     I              BBAYDT                          WFAYDT
     I              BBANC7                          WFANC7
     I              BBBTC7                          WFBTC7
     I              BBK6ST                          WFK6ST
     I              BBUZST                          WFUZST
     I              BBKXCD                          WFKXCD
     I              BBLTCD                          WFLTCD
     I              BBQNST                          WFQNST
     I              BBS2NB                          WFS2NB
     I              BBVHVA                          WFVHVA
     I              BBI7DT                          WFI7DT
     I              BBRJST                          WFRJST
     I              BBRKST                          WFRKST
     I              BBQWST                          WFQWST
     I              BBQXST                          WFQXST
     I              BBQYST                          WFQYST
     I              BBUNCS                          WFUNCS
     I              BBUVST                          WFUVST
     I              BBUWST                          WFUWST
     I              BBUXST                          WFUXST
     I              BBVSST                          WFVSST
     I              BBAATM                          WFAATM
     I              BBAYNA                          WFAYNA
     I              BBA0NA                          WFA0NA
     I              BBAXDT                          WFAXDT
      *
     I@BBREXJ
      * Customer                  RSQ Bill to (A/R) Active
      * Renamed input format fields
     I              BBBKC7                          WGBKC7
     I              BBAYTX                          WGAYTX
     I              BBACNA                          WGACNA
     I              BBADNA                          WGADNA
     I              BBAENA                          WGAENA
     I              BBAJNA                          WGAJNA
     I              BBBGCD                          WGBGCD
     I              BBG5CD                          WGG5CD
     I              BBBTTX                          WGBTTX
     I              BBBVTX                          WGBVTX
     I              BBBWTX                          WGBWTX
     I              BBABTX                          WGABTX
     I              BBA2NA                          WGA2NA
     I              BBCBST                          WGCBST
     I              BBB0NA                          WGB0NA
     I              BBP3NB                          WGP3NB
     I              BBAXNA                          WGAXNA
     I              BBI6DT                          WGI6DT
     I              BBAYDT                          WGAYDT
     I              BBANC7                          WGANC7
     I              BBBTC7                          WGBTC7
     I              BBK6ST                          WGK6ST
     I              BBUZST                          WGUZST
     I              BBKXCD                          WGKXCD
     I              BBLTCD                          WGLTCD
     I              BBQNST                          WGQNST
     I              BBS2NB                          WGS2NB
     I              BBVHVA                          WGVHVA
     I              BBI7DT                          WGI7DT
     I              BBRJST                          WGRJST
     I              BBRKST                          WGRKST
     I              BBQWST                          WGQWST
     I              BBQXST                          WGQXST
     I              BBQYST                          WGQYST
     I              BBUNCS                          WGUNCS
     I              BBUVST                          WGUVST
     I              BBUWST                          WGUWST
     I              BBUXST                          WGUXST
     I              BBVSST                          WGVSST
     I              BBAATM                          WGAATM
     I              BBAYNA                          WGAYNA
     I              BBA0NA                          WGA0NA
     I              BBAXDT                          WGAXDT
      *
     I@BBREWG
      * Customer                  Active Only
      * Renamed input format fields
     I              BBBKC7                          WHBKC7
     I              BBAYTX                          WHAYTX
     I              BBACNA                          WHACNA
     I              BBADNA                          WHADNA
     I              BBAENA                          WHAENA
     I              BBAJNA                          WHAJNA
     I              BBBGCD                          WHBGCD
     I              BBG5CD                          WHG5CD
     I              BBBTTX                          WHBTTX
     I              BBBVTX                          WHBVTX
     I              BBBWTX                          WHBWTX
     I              BBABTX                          WHABTX
     I              BBA2NA                          WHA2NA
     I              BBCBST                          WHCBST
     I              BBB0NA                          WHB0NA
     I              BBP3NB                          WHP3NB
     I              BBAXNA                          WHAXNA
     I              BBI6DT                          WHI6DT
     I              BBAYDT                          WHAYDT
     I              BBANC7                          WHANC7
     I              BBBTC7                          WHBTC7
     I              BBK6ST                          WHK6ST
     I              BBUZST                          WHUZST
     I              BBKXCD                          WHKXCD
     I              BBLTCD                          WHLTCD
     I              BBQNST                          WHQNST
     I              BBS2NB                          WHS2NB
     I              BBVHVA                          WHVHVA
     I              BBI7DT                          WHI7DT
     I              BBRJST                          WHRJST
     I              BBRKST                          WHRKST
     I              BBQWST                          WHQWST
     I              BBQXST                          WHQXST
     I              BBQYST                          WHQYST
     I              BBUNCS                          WHUNCS
     I              BBUVST                          WHUVST
     I              BBUWST                          WHUWST
     I              BBUXST                          WHUXST
     I              BBVSST                          WHVSST
     I              BBAATM                          WHAATM
     I              BBAYNA                          WHAYNA
     I              BBA0NA                          WHA0NA
     I              BBAXDT                          WHAXDT
      *
     I@FFREBF
      * Carrier                   Retrieval index
      * Renamed input format fields
     I              FFBZNA                          WIBZNA
     I              FFADTX                          WIADTX
     I              FFACNA                          WIACNA
     I              FFADNA                          WIADNA
     I              FFAENA                          WIAENA
     I              FFAJNA                          WIAJNA
     I              FFBTTX                          WIBTTX
     I              FFEZNB                          WIEZNB
     I              FFBGCD                          WIBGCD
     I              FFEEDT                          WIEEDT
     I              FFDUTX                          WIDUTX
     I              FFNRVA                          WINRVA
     I              FFNSVA                          WINSVA
     I              FFNTVA                          WINTVA
     I              FFNUVA                          WINUVA
     I              FFP1ST                          WIP1ST
     I              FFDVTX                          WIDVTX
     I              FFDWTX                          WIDWTX
     I              FFLVCD                          WILVCD
     I              FFS8NB                          WIS8NB
     I              FFS9NB                          WIS9NB
     I              FFNMVA                          WINMVA
     I              FFNOVA                          WINOVA
     I              FFNPVA                          WINPVA
     I              FFNQVA                          WINQVA
     I              FFMFCD                          WIMFCD
     I              FFQXNB                          WIQXNB
     I              FFQ1NB                          WIQ1NB
     I              FFMRNG                          WIMRNG
     I              FFMRNE                          WIMRNE
     I              FFRFNB                          WIRFNB
     I              FFMREG                          WIMREG
     I              FFBQPR                          WIBQPR
     I              FFBRPR                          WIBRPR
     I              FFBSPR                          WIBSPR
     I              FFBTPR                          WIBTPR
     I              FFBUPR                          WIBUPR
     I              FFBVPR                          WIBVPR
     I              FFDJWG                          WIDJWG
     I              FFDKWG                          WIDKWG
     I              FFDLWG                          WIDLWG
     I              FFDMWG                          WIDMWG
     I              FFDNWG                          WIDNWG
     I              FFDOWG                          WIDOWG
     I              FFB2PR                          WIB2PR
     I              FFB3PR                          WIB3PR
     I              FFB4PR                          WIB4PR
     I              FFB5PR                          WIB5PR
     I              FFB6PR                          WIB6PR
     I              FFB7PR                          WIB7PR
     I              FFAAC7                          WIAAC7
     I              FFCOFI                          WICOFI
     I              FFK6TX                          WIK6TX
     I              FFOCNA                          WIOCNA
     I              FFODNA                          WIODNA
     I              FFW7CD                          WIW7CD
     I              FFK7TX                          WIK7TX
     I              FFTENO                          WITENO
     I              FFK8TX                          WIK8TX
     I              FFAOFC                          WIAOFC
     I              FFAOLI                          WIAOLI
     I              FFKHDT                          WIKHDT
     I              FFUNUS                          WIUNUS
     I              FFUNU2                          WIUNU2
     I              FFUNU3                          WIUNU3
     I              FFUVST                          WIUVST
     I              FFUWST                          WIUWST
     I              FFUXST                          WIUXST
     I              FFVSST                          WIVSST
     I              FFAATM                          WIAATM
     I              FFAYNA                          WIAYNA
     I              FFA0NA                          WIA0NA
     I              FFAXDT                          WIAXDT
      *
     I@HSTPUX
      * Sales History             Load#/Order#
      * Renamed input format fields
     I              F4AIC3                          WJAIC3
     I              F4C4NB                          WJC4NB
     I              F4DPNB                          WJDPNB
     I              F4UENB                          WJUENB
     I              F4MONA                          WJMONA
     I              F4RJCD                          WJRJCD
     I              F4RKCD                          WJRKCD
     I              F4GPTX                          WJGPTX
     I              F4ABTX                          WJABTX
     I              F4KXCD                          WJKXCD
     I              F4BOCD                          WJBOCD
     I              F4BTC7                          WJBTC7
     I              F4ANC7                          WJANC7
     I              F4AQTX                          WJAQTX
     I              F4BKC7                          WJBKC7
     I              F4BRTX                          WJBRTX
     I              F4HNNA                          WJHNNA
     I              F4DBCD                          WJDBCD
     I              F4CKTX                          WJCKTX
     I              F4BCNA                          WJBCNA
     I              F4A0DT                          WJA0DT
     I              F4ACDT                          WJACDT
     I              F4R4CD                          WJR4CD
     I              F4R5CD                          WJR5CD
     I              F4BFCD                          WJBFCD
     I              F4Q4CD                          WJQ4CD
     I              F4AQCD                          WJAQCD
     I              F4TBNB                          WJTBNB
     I              F4BZNA                          WJBZNA
     I              F4RLCD                          WJRLCD
     I              F4JNCD                          WJJNCD
     I              F4Q2CD                          WJQ2CD
     I              F4U2ST                          WJU2ST
     I              F4ATIN                          WJATIN
     I              F4T3NB                          WJT3NB
     I              F4RSRN                          WJRSRN
     I              F4ORIT                          WJORIT
     I              F4AJCD                          WJAJCD
     I              F4AVQT                          WJAVQT
     I              F4D0WG                          WJD0WG
     I              F4CCQT                          WJCCQT
     I              F4AUWG                          WJAUWG
     I              F4AGCD                          WJAGCD
     I              F4AKPR                          WJAKPR
     I              F4AUPR                          WJAUPR
     I              F4CRCD                          WJCRCD
     I              F4A5DT                          WJA5DT
     I              F4AWDT                          WJAWDT
     I              F4HDDT                          WJHDDT
     I              F4AGCS                          WJAGCS
     I              F4AQCS                          WJAQCS
     I              F4AVWG                          WJAVWG
     I              F4AYVA                          WJAYVA
     I              F4AMST                          WJAMST
     I              F4ANST                          WJANST
     I              F4VAST                          WJVAST
     I              F4L6NB                          WJL6NB
     I              F4UMCD                          WJUMCD
     I              F4HCDT                          WJHCDT
     I              F4ESNB                          WJESNB
     I              F4ETNB                          WJETNB
     I              F4BZNB                          WJBZNB
     I              F4EXQT                          WJEXQT
     I              F4BYWG                          WJBYWG
     I              F4S5NB                          WJS5NB
     I              F4MAVA                          WJMAVA
     I              F4KDVA                          WJKDVA
     I              F4USVA                          WJUSVA
     I              F4UTVA                          WJUTVA
     I              F4A4WG                          WJA4WG
     I              F4CKNB                          WJCKNB
     I              F4BMST                          WJBMST
     I              F4R8NB                          WJR8NB
     I              F4RMCD                          WJRMCD
     I              F4BZPR                          WJBZPR
     I              F4RDCD                          WJRDCD
     I              F4Q7CD                          WJQ7CD
     I              F4EXDT                          WJEXDT
     I              F4LQCD                          WJLQCD
     I              F4HICD                          WJHICD
     I              F4RBCD                          WJRBCD
     I              F4RGNB                          WJRGNB
     I              F4RHNB                          WJRHNB
     I              F4RINB                          WJRINB
     I              F4R1NB                          WJR1NB
     I              F4CONB                          WJCONB
     I              F4CEST                          WJCEST
     I              F4GNDT                          WJGNDT
     I              F4RMNB                          WJRMNB
     I              F4AODT                          WJAODT
     I              F4LLCD                          WJLLCD
     I              F4LMCD                          WJLMCD
     I              F4SKNB                          WJSKNB
     I              F4SLNB                          WJSLNB
     I              F4SMNB                          WJSMNB
     I              F4G7NA                          WJG7NA
     I              F4ONVA                          WJONVA
     I              F4N0CD                          WJN0CD
     I              F4B4NB                          WJB4NB
     I              F4B5NB                          WJB5NB
     I              F4N1CD                          WJN1CD
     I              F4GIDT                          WJGIDT
     I              F4Z1ST                          WJZ1ST
     I              F4ULVA                          WJULVA
     I              F4UNVA                          WJUNVA
     I              F4UOVA                          WJUOVA
     I              F4UPVA                          WJUPVA
     I              F4UQVA                          WJUQVA
     I              F4SDCD                          WJSDCD
     I              F4QZCD                          WJQZCD
     I              F4XWST                          WJXWST
     I              F4T9CD                          WJT9CD
     I              F4UBCD                          WJUBCD
     I              F4CFC7                          WJCFC7
     I              F4X1CD                          WJX1CD
     I              F4GASX                          WJGASX
     I              F4DUPR                          WJDUPR
     I              F4B6VL                          WJB6VL
     I              F4IANX                          WJIANX
     I              F4IBNX                          WJIBNX
     I              F4RPCD                          WJRPCD
     I              F4NYDT                          WJNYDT
     I              F4BZTM                          WJBZTM
     I              F4Z4NB                          WJZ4NB
     I              F4XACD                          WJXACD
     I              F4OANA                          WJOANA
     I              F4OKTX                          WJOKTX
     I              F4K4TX                          WJK4TX
     I              F4NBBO                          WJNBBO
     I              F4OCFR                          WJOCFR
     I              F4C0C7                          WJC0C7
     I              F4A1AA                          WJA1AA
     I              F4VEST                          WJVEST
     I              F4A5PR                          WJA5PR
     I              F4CDPR                          WJCDPR
     I              F4D0PR                          WJD0PR
     I              F4D0VL                          WJD0VL
     I              F4IRSX                          WJIRSX
     I              F4CEVL                          WJCEVL
     I              F4ISSX                          WJISSX
     I              F4ITSX                          WJITSX
     I              F4IUSX                          WJIUSX
     I              F4OHDT                          WJOHDT
     I              F4D9PR                          WJD9PR
     I              F4CFVL                          WJCFVL
     I              F4UVST                          WJUVST
     I              F4UWST                          WJUWST
     I              F4UXST                          WJUXST
     I              F4AATM                          WJAATM
     I              F4AYNA                          WJAYNA
     I              F4A0NA                          WJA0NA
     I              F4AXDT                          WJAXDT
      *
     I@BFCPD9
      * Order Header TRG          Load #/All orders
      * Renamed input format fields
     I              BEAIC3                          WKAIC3
     I              BEC4NB                          WKC4NB
     I              BEJNCD                          WKJNCD
     I              BEANC7                          WKANC7
     I              BEBKC7                          WKBKC7
     I              BEBRTX                          WKBRTX
     I              BEHMNA                          WKHMNA
     I              BEHONA                          WKHONA
     I              BEHPNA                          WKHPNA
     I              BEHNNA                          WKHNNA
     I              BEDBCD                          WKDBCD
     I              BECKTX                          WKCKTX
     I              BEB0C7                          WKB0C7
     I              BEAETX                          WKAETX
     I              BEB1NA                          WKB1NA
     I              BEB3NA                          WKB3NA
     I              BEB4NA                          WKB4NA
     I              BEB2NA                          WKB2NA
     I              BEBHCD                          WKBHCD
     I              BEC8TX                          WKC8TX
     I              BEBCNA                          WKBCNA
     I              BEA0DT                          WKA0DT
     I              BEA5DT                          WKA5DT
     I              BEGNDT                          WKGNDT
     I              BEACDT                          WKACDT
     I              BEAQCD                          WKAQCD
     I              BEB6NA                          WKB6NA
     I              BEBYNA                          WKBYNA
     I              BEBZNA                          WKBZNA
     I              BEGTST                          WKGTST
     I              BEGVST                          WKGVST
     I              BEGUST                          WKGUST
     I              BEQFST                          WKQFST
     I              BECQCD                          WKCQCD
     I              BEGJST                          WKGJST
     I              BEGWST                          WKGWST
     I              BEGXST                          WKGXST
     I              BEGYST                          WKGYST
     I              BEAODT                          WKAODT
     I              BEAIVN                          WKAIVN
     I              BECXDT                          WKCXDT
     I              BEJZVA                          WKJZVA
     I              BEA1WG                          WKA1WG
     I              BEXIST                          WKXIST
     I              BEXJST                          WKXJST
     I              BEXKST                          WKXKST
     I              BEEIDT                          WKEIDT
     I              BEAFTM                          WKAFTM
     I              BEE8CD                          WKE8CD
     I              BEE9CD                          WKE9CD
     I              BERMNB                          WKRMNB
     I              BETBNB                          WKTBNB
     I              BER1NB                          WKR1NB
     I              BEPJST                          WKPJST
     I              BEU0ST                          WKU0ST
     I              BEU1ST                          WKU1ST
     I              BEQ2CD                          WKQ2CD
     I              BEU2ST                          WKU2ST
     I              BEVEST                          WKVEST
     I              BEVFST                          WKVFST
     I              BEVGST                          WKVGST
     I              BERPCD                          WKRPCD
     I              BERNNB                          WKRNNB
     I              BEVDST                          WKVDST
     I              BEATIN                          WKATIN
     I              BEU4ST                          WKU4ST
     I              BEU5ST                          WKU5ST
     I              BERSRN                          WKRSRN
     I              BEMHNA                          WKMHNA
     I              BEMINA                          WKMINA
     I              BEWBST                          WKWBST
     I              BER4CD                          WKR4CD
     I              BEBFCD                          WKBFCD
     I              BEQ4CD                          WKQ4CD
     I              BET3NB                          WKT3NB
     I              BESICD                          WKSICD
     I              BECONB                          WKCONB
     I              BECEST                          WKCEST
     I              BEAWDT                          WKAWDT
     I              BEJPCD                          WKJPCD
     I              BEXUST                          WKXUST
     I              BEZ1ST                          WKZ1ST
     I              BEVRVA                          WKVRVA
     I              BEOBST                          WKOBST
     I              BEBCST                          WKBCST
     I              BEBDST                          WKBDST
     I              BEB7VL                          WKB7VL
     I              BEGASX                          WKGASX
     I              BEGBSX                          WKGBSX
     I              BEGCSX                          WKGCSX
     I              BEGDSX                          WKGDSX
     I              BEFNSX                          WKFNSX
     I              BEFOSX                          WKFOSX
     I              BEFPSX                          WKFPSX
     I              BEFQSX                          WKFQSX
     I              BEFRSX                          WKFRSX
     I              BEFSSX                          WKFSSX
     I              BEFTSX                          WKFTSX
     I              BEFUSX                          WKFUSX
     I              BEFVSX                          WKFVSX
     I              BEFWSX                          WKFWSX
     I              BEFXSX                          WKFXSX
     I              BEFYSX                          WKFYSX
     I              BENODT                          WKNODT
     I              BENPDT                          WKNPDT
     I              BENQDT                          WKNQDT
     I              BENRDT                          WKNRDT
     I              BENSDT                          WKNSDT
     I              BEBPTM                          WKBPTM
     I              BEBQTM                          WKBQTM
     I              BEBRTM                          WKBRTM
     I              BEBSTM                          WKBSTM
     I              BEBTTM                          WKBTTM
     I              BEH0NX                          WKH0NX
     I              BEH1NX                          WKH1NX
     I              BEH2NX                          WKH2NX
     I              BEH3NX                          WKH3NX
     I              BEH4NX                          WKH4NX
     I              BEC0C7                          WKC0C7
     I              BEUVST                          WKUVST
     I              BEUWST                          WKUWST
     I              BEUXST                          WKUXST
     I              BEAATM                          WKAATM
     I              BEAYNA                          WKAYNA
     I              BEA0NA                          WKA0NA
     I              BEAXDT                          WKAXDT
      *
     I@AFREBE
      * Calendar                  Retrieval index       NV
      * Renamed input format fields
     I              AFAIC3                          WLAIC3
     I              AFBCDT                          WLBCDT
     I              AFCQNB                          WLCQNB
     I              AFESNB                          WLESNB
     I              AFETNB                          WLETNB
     I              AFBZNB                          WLBZNB
     I              AFA9ST                          WLA9ST
     I              AFEINB                          WLEINB
     I              AFC5ST                          WLC5ST
     I              AFAQNB                          WLAQNB
     I              AFCMST                          WLCMST
     I              AFV9ST                          WLV9ST
     I              AFWAST                          WLWAST
     I              AFX2ST                          WLX2ST
     I              AFOJDT                          WLOJDT
     I              AFNQNX                          WLNQNX
     I              AFNRNX                          WLNRNX
     I              AFI9SX                          WLI9SX
     I              AFJASX                          WLJASX
     I              AFOKDT                          WLOKDT
     I              AFOLDT                          WLOLDT
     I              AFUVST                          WLUVST
     I              AFUWST                          WLUWST
     I              AFUXST                          WLUXST
     I              AFAATM                          WLAATM
     I              AFAYNA                          WLAYNA
     I              AFA0NA                          WLA0NA
     I              AFAXDT                          WLAXDT
      *
     I@JEREWF
      * Sales Route               Retrieval index
      * Renamed input format fields
     I              JER4CD                          WMR4CD
     I              JEMZNA                          WMMZNA
     I              JEBCCD                          WMBCCD
     I              JEBFCD                          WMBFCD
     I              JEQ4CD                          WMQ4CD
     I              JEWOST                          WMWOST
     I              JER8CD                          WMR8CD
     I              JEUVST                          WMUVST
     I              JEUWST                          WMUWST
     I              JEUXST                          WMUXST
     I              JEVSST                          WMVSST
     I              JEAATM                          WMAATM
     I              JEAYNA                          WMAYNA
     I              JEA0NA                          WMA0NA
     I              JEAXDT                          WMAXDT
      *
     I@DRRETH
      * User Profile Control      Retrieval index       NV
      * Renamed input format fields
     I              DRAJVN                          WOAJVN
     I              DRAUNA                          WOAUNA
     I              DRB8NA                          WOB8NA
     I              DRAHVN                          WOAHVN
     I              DRI6ST                          WOI6ST
     I              DRI7ST                          WOI7ST
     I              DRXMST                          WOXMST
     I              DRXNST                          WOXNST
     I              DRI8ST                          WOI8ST
     I              DRNLNB                          WONLNB
     I              DRMPNA                          WOMPNA
     I              DRBCCD                          WOBCCD
     I              DRAIC3                          WOAIC3
     I              DRDQCD                          WODQCD
     I              DRDRCD                          WODRCD
     I              DRAJCD                          WOAJCD
     I              DRBUVN                          WOBUVN
     I              DRUVST                          WOUVST
     I              DRUWST                          WOUWST
     I              DRUXST                          WOUXST
     I              DRAATM                          WOAATM
     I              DRAYNA                          WOAYNA
     I              DRA0NA                          WOA0NA
     I              DRAXDT                          WOAXDT
      *
     I@DTRETE
      * User Application Profile  Retrieval index       NV
      * Renamed input format fields
     I              DTAJVN                          WRAJVN
     I              DTDNCD                          WRDNCD
     I              DTAIC3                          WRAIC3
     I              DTDQCD                          WRDQCD
     I              DTDRCD                          WRDRCD
     I              DTAJCD                          WRAJCD
     I              DTJFST                          WRJFST
     I              DTUVST                          WRUVST
     I              DTUWST                          WRUWST
     I              DTUXST                          WRUXST
     I              DTAATM                          WRAATM
     I              DTAYNA                          WRAYNA
     I              DTA0NA                          WRA0NA
     I              DTAXDT                          WRAXDT
      *
     I@DNRESF
      * Application               RSQ Application Code
      * Renamed input format fields
     I              DNDNCD                          WSDNCD
     I              DNAUNA                          WSAUNA
     I              DNVKST                          WSVKST
     I              DNRSCD                          WSRSCD
     I              DNUVST                          WSUVST
     I              DNUWST                          WSUWST
     I              DNUXST                          WSUXST
     I              DNAATM                          WSAATM
     I              DNAYNA                          WSAYNA
     I              DNA0NA                          WSA0NA
     I              DNAXDT                          WSAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * N :  Warehouse Code
     I                                        1   3 P1AJCD
      * N :  Company Number
     I                                    P   4   50P1AIC3
      * N :  Application Code
     I                                        6  11 P1DNCD
      * N :  System Date Format
     I                                       12  14 P1B8NA
      * N :  User Profile Name
     I                                       15  24 P1AJVN
      * N :  Allow Multi-Company
     I                                       25  25 P1I6ST
      * N :  Default Printer
     I                                       26  35 P1MPNA
     IP2PARM      DS
      * FLD: *Arrays
      * N :  PRT Description
     I                                        1  25 P2G3TX
      * N :  PRT Printer Device
     I                                       26  35 P2WRST
      * N :  PRT Hold Output Sts
     I                                       36  39 P2WSST
      * N :  PRT Save Output Sts
     I                                       40  43 P2WTST
      * N :  PRT Number of Copies
     I                                       44  450P2DYNB
      * N :  PRT Night Queue Run Sts
     I                                       46  46 P2WUST
      * N :  PRT Night Queue
     I                                       47  56 P2BVVN
      * N :  Company Number Pass   USR
     I                                    P  57  645P2AJAA
      * N :  Customer Number Pass  USR
     I                                    P  65  725P2AJNC
      * N : MAP Date 1          PASS  USR
     I                                    P  73  805P2AJAB
      * N : MAP Date 2          PASS  USR
     I                                    P  81  885P2AJAC
      * N :  From Date Pass        USR
     I                                    P  89  965P2AJAD
      * N :  Thru Date Pass        USR
     I                                    P  97 1045P2AJAG
      * N :  Order Number 1  PASS  USR
     I                                    P 105 1125P2AJAE
      * N :  System Value Numeric
     I                                    P 113 1205P2M8NB
      * N : MAP Ship to Customer Pass USR
     I                                    P 121 1285P2SHTC
     IP3PARM      DS
      * N :  Load Id Pass
     I                                    P   1   85P3
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'CD7 Non numeric data'
      * Message data for 'CD7 Non numeric data'
      * Message data for 'CD7 Non numeric data'
      * Message data for 'Parent Customer invalid'
      * Parent Customer
     I                                        1   7 ZA0001
      * Message data for 'A/R Customer invalid'
      * A/R Customer Number
     I                                        1   7 ZA0002
      * Message data for 'Shipto Customer invalid'
      * Ship To Customer
     I                                        1   7 ZA0003
      * Message data for 'Carrier doesn't exists'
      * Carrier Code
     I                                        1   3 ZA0004
      * Message data for 'Only one Cust Can be Ent'
      * Ship To Customer
     I                                        1   7 ZA0005
      * A/R Customer Number
     I                                        8  14 ZA0006
      * Parent Customer
     I                                       15  21 ZA0007
      * Message data for 'Date not in calendar'
      * Requested Ship Date
     I                                    P   1   40ZA0008
      * Message data for 'Date not in calendar'
      * Requested Ship Date
     I                                    P   1   40ZA0009
      * Message data for 'From date exceeds to date'
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0010
      * Application Code
     I                                       11  16 ZA0011
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0012
      * Application Code
     I                                       11  16 ZA0013
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Conduct screen conversation
     C                     DO   *HIVAL
      * Start new transaction
     C                     MOVEL'Y'       W0TRN   1
      * Process current transaction
     C           W0TRN     DOWEQ'Y'
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            MALDSC
      * Process screen input
     C                     CAS            DAPRSC
     C                     END
      *
     C                     END
      *
     C                     END
      *****************************************************************
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPRSC    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate screen input
     C                     EXSR DBVLSC
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * USER: User defined action
      * PAR = DTL By name
     C                     Z-ADD#DAIC3    P1AIC3           Company Number
     C                     Z-ADD#PAJAB    P2AJAB           Date 1
     C                     Z-ADD#PAJAC    P2AJAC           Date 2
     C                     Z-ADD#DAJAD    P2AJAD           From Date Pass
     C                     Z-ADD#PSHTC    P2SHTC           Ship to Custome
      * Submit job for Print
     C                     Z-ADD#DATNB    P2AJAA           Company Number
      * PAR.Date 1          PASS  USR = DTL.USR From Date
     C                     Z-ADD#DBDDT    P2AJAB           Date 1
      * PAR.Date 2          PASS  USR = DTL.USR Through Date
     C                     Z-ADD#DBEDT    P2AJAC           Date 2
     C                     Z-ADD#DBTC7    P2AJNC           Customer Number
      * Order number is being used for A/R customer
     C                     Z-ADD#DANC7    P2AJAE           Order Number 1
     C                     Z-ADD#DBKC7    P2SHTC           Ship to Custome
     C                     Z-ADD#DRMNB    P3               Load Id Pass
      * CASE: DTL.USR Detail or Summary is Report Selection 1
     C           #DSTST    IFEQ '1'                        *IF
      * PRT Pmt&Pass Dts/Flgs  UP - /UT User Programs  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #DSBST' defaulted for 'USR Confirm Status (Y/N)'.
      * Field '(DTL) #DCYVN' defaulted for 'Document Name USR'.
     C                     CALL 'PDMJUPR'              90  PRT Pmt&Pass Dt
     C           WUH3TX    PARM *BLANK    WQ0001  7        Return Code Usr
     C                     PARM 'O/M'     WQ0002  6        Application Cod
     C                     PARM @CN,001   WQ0003 10        USR Program nam
     C                     PARM @CN,002   WQ0004 10        USR Program Nam
     C                     PARM @CN,003   WQ0005 25        PRT Description
     C           P2WRST    PARM P2WRST    WQ0006 10        PRT Printer Dev
     C           P2WSST    PARM P2WSST    WQ0007  4        PRT Hold Output
     C           P2WTST    PARM P2WTST    WQ0008  4        PRT Save Output
     C           P2WUST    PARM P2WUST    WQ0009  1        PRT Night Queue
     C           P2BVVN    PARM P2BVVN    WQ0010 10        PRT Night Queue
     C           P2AJAA    PARM P2AJAA    WQ0011 155       Company Number
     C           P2AJNC    PARM P2AJNC    WQ0012 155       Customer Number
     C           P2AJAB    PARM P2AJAB    WQ0013 155       Date 1
     C           P2AJAC    PARM P2AJAC    WQ0014 155       Date 2
     C           P2AJAE    PARM P2AJAE    WQ0015 155       Order Number 1
     C           P2M8NB    PARM P2M8NB    WQ0016 155       System Value Nu
     C           #DDBSX    PARM #DDBSX    WQ0017  1        USR Summary/Det
     C           #DSTST    PARM #DSTST    WQ0018  1        USR Detail or S
     C           #DR4CD    PARM #DR4CD    WQ0019  3        Salesperson Cod
     C           P2SHTC    PARM P2SHTC    WQ0020 155       Ship to Custome
     C           #DO8SX    PARM #DO8SX    WQ0021  1        Status - Y or N
     C           #DMCSX    PARM #DMCSX    WQ0022  1        Loads Shipped o
     C                     PARM #DSBST    WQ0023  1        USR Confirm Sta
     C                     PARM #DBZNA    WQ0024  3        Carrier Code
     C                     PARM P3        WQ0025 155       Load Id Pass
     C                     PARM #DCYVN    WQ0026  8        Document Name U
     C                     PARM #DUGTX    WQ0027 50        Email Address
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMJUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     994333*
     C                     SETON                     364142*
     C                     SETON                     403538*
     C                     SETON                     37    *
     C                     END
     C                     ELSE
      * CASE: DTL.USR Detail or Summary is Report Selection 2
     C           #DSTST    IFEQ '2'                        *IF
      * ** Pass email address so new View can email a spreadsheet
      * PRT Pmt&Pass Dts/Flgs  UP - /UT User Programs  * 
     C                     CALL 'PDMJUPR'              90  PRT Pmt&Pass Dt
     C           WUH3TX    PARM *BLANK    WQ0028  7        Return Code Usr
     C                     PARM 'O/M'     WQ0029  6        Application Cod
     C                     PARM @CN,004   WQ0030 10        USR Program nam
     C                     PARM @CN,005   WQ0031 10        USR Program Nam
     C                     PARM @CN,006   WQ0032 25        PRT Description
     C           P2WRST    PARM P2WRST    WQ0033 10        PRT Printer Dev
     C           P2WSST    PARM P2WSST    WQ0034  4        PRT Hold Output
     C           P2WTST    PARM P2WTST    WQ0035  4        PRT Save Output
     C           P2WUST    PARM P2WUST    WQ0036  1        PRT Night Queue
     C           P2BVVN    PARM P2BVVN    WQ0037 10        PRT Night Queue
     C           P2AJAA    PARM P2AJAA    WQ0038 155       Company Number
     C           P2AJNC    PARM P2AJNC    WQ0039 155       Customer Number
     C           P2AJAB    PARM P2AJAB    WQ0040 155       Date 1
     C           P2AJAC    PARM P2AJAC    WQ0041 155       Date 2
     C           P2AJAE    PARM P2AJAE    WQ0042 155       Order Number 1
     C           P2M8NB    PARM P2M8NB    WQ0043 155       System Value Nu
     C           #DDBSX    PARM #DDBSX    WQ0044  1        USR Summary/Det
     C           #DSTST    PARM #DSTST    WQ0045  1        USR Detail or S
     C           #DR4CD    PARM #DR4CD    WQ0046  3        Salesperson Cod
     C           P2SHTC    PARM P2SHTC    WQ0047 155       Ship to Custome
     C           #DO8SX    PARM #DO8SX    WQ0048  1        Status - Y or N
     C           #DMCSX    PARM #DMCSX    WQ0049  1        Loads Shipped o
     C                     PARM #DSBST    WQ0050  1        USR Confirm Sta
     C                     PARM #DBZNA    WQ0051  3        Carrier Code
     C                     PARM P3        WQ0052 155       Load Id Pass
     C                     PARM #DCYVN    WQ0053  8        Document Name U
     C                     PARM #DUGTX    WQ0054 50        Email Address
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMJUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     994333*
     C                     SETON                     364142*
     C                     SETON                     403538*
     C                     SETON                     37    *
     C                     END
     C                     ELSE
      * CASE: DTL.USR Detail or Summary is Report Selection 3
     C           #DSTST    IFEQ '3'                        *IF
      * PRT Pmt&Pass Dts/Flgs  UP - /UT User Programs  * 
     C                     CALL 'PDMJUPR'              90  PRT Pmt&Pass Dt
     C           WUH3TX    PARM *BLANK    WQ0055  7        Return Code Usr
     C                     PARM 'O/M'     WQ0056  6        Application Cod
     C                     PARM @CN,007   WQ0057 10        USR Program nam
     C                     PARM @CN,008   WQ0058 10        USR Program Nam
     C                     PARM @CN,009   WQ0059 25        PRT Description
     C           P2WRST    PARM P2WRST    WQ0060 10        PRT Printer Dev
     C           P2WSST    PARM P2WSST    WQ0061  4        PRT Hold Output
     C           P2WTST    PARM P2WTST    WQ0062  4        PRT Save Output
     C           P2WUST    PARM P2WUST    WQ0063  1        PRT Night Queue
     C           P2BVVN    PARM P2BVVN    WQ0064 10        PRT Night Queue
     C           P2AJAA    PARM P2AJAA    WQ0065 155       Company Number
     C           P2AJNC    PARM P2AJNC    WQ0066 155       Customer Number
     C           P2AJAB    PARM P2AJAB    WQ0067 155       Date 1
     C           P2AJAC    PARM P2AJAC    WQ0068 155       Date 2
     C           P2AJAE    PARM P2AJAE    WQ0069 155       Order Number 1
     C           P2M8NB    PARM P2M8NB    WQ0070 155       System Value Nu
     C           #DDBSX    PARM #DDBSX    WQ0071  1        USR Summary/Det
     C           #DSTST    PARM #DSTST    WQ0072  1        USR Detail or S
     C           #DR4CD    PARM #DR4CD    WQ0073  3        Salesperson Cod
     C           P2SHTC    PARM P2SHTC    WQ0074 155       Ship to Custome
     C           #DO8SX    PARM #DO8SX    WQ0075  1        Status - Y or N
     C           #DMCSX    PARM #DMCSX    WQ0076  1        Loads Shipped o
     C                     PARM #DSBST    WQ0077  1        USR Confirm Sta
     C                     PARM #DBZNA    WQ0078  3        Carrier Code
     C                     PARM P3        WQ0079 155       Load Id Pass
     C                     PARM #DCYVN    WQ0080  8        Document Name U
     C                     PARM #DUGTX    WQ0081 50        Email Address
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMJUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     994333*
     C                     SETON                     364142*
     C                     SETON                     403538*
     C                     SETON                     37    *
     C                     END
     C                     ELSE
      * CASE: DTL.USR Detail or Summary is Report Selection 4
     C           #DSTST    IFEQ '4'                        *IF
      * PRT Pmt&Pass Dts/Flgs  UP - /UT User Programs  * 
     C                     CALL 'PDMJUPR'              90  PRT Pmt&Pass Dt
     C           WUH3TX    PARM *BLANK    WQ0082  7        Return Code Usr
     C                     PARM 'O/M'     WQ0083  6        Application Cod
     C                     PARM @CN,010   WQ0084 10        USR Program nam
     C                     PARM @CN,011   WQ0085 10        USR Program Nam
     C                     PARM @CN,012   WQ0086 25        PRT Description
     C           P2WRST    PARM P2WRST    WQ0087 10        PRT Printer Dev
     C           P2WSST    PARM P2WSST    WQ0088  4        PRT Hold Output
     C           P2WTST    PARM P2WTST    WQ0089  4        PRT Save Output
     C           P2WUST    PARM P2WUST    WQ0090  1        PRT Night Queue
     C           P2BVVN    PARM P2BVVN    WQ0091 10        PRT Night Queue
     C           P2AJAA    PARM P2AJAA    WQ0092 155       Company Number
     C           P2AJNC    PARM P2AJNC    WQ0093 155       Customer Number
     C           P2AJAB    PARM P2AJAB    WQ0094 155       Date 1
     C           P2AJAC    PARM P2AJAC    WQ0095 155       Date 2
     C           P2AJAE    PARM P2AJAE    WQ0096 155       Order Number 1
     C           P2M8NB    PARM P2M8NB    WQ0097 155       System Value Nu
     C           #DDBSX    PARM #DDBSX    WQ0098  1        USR Summary/Det
     C           #DSTST    PARM #DSTST    WQ0099  1        USR Detail or S
     C           #DR4CD    PARM #DR4CD    WQ0100  3        Salesperson Cod
     C           P2SHTC    PARM P2SHTC    WQ0101 155       Ship to Custome
     C           #DO8SX    PARM #DO8SX    WQ0102  1        Status - Y or N
     C           #DMCSX    PARM #DMCSX    WQ0103  1        Loads Shipped o
     C                     PARM #DSBST    WQ0104  1        USR Confirm Sta
     C                     PARM #DBZNA    WQ0105  3        Carrier Code
     C                     PARM P3        WQ0106 155       Load Id Pass
     C                     PARM #DCYVN    WQ0107  8        Document Name U
     C                     PARM #DUGTX    WQ0108 50        Email Address
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMJUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     994333*
     C                     SETON                     364142*
     C                     SETON                     403538*
     C                     SETON                     37    *
     C                     END
     C                     ELSE
      * CASE: DTL.USR Detail or Summary is Report Selection 5
     C           #DSTST    IFEQ '5'                        *IF
      * PRT Pmt&Pass FrtCmpXfr UP - /UT User Programs  * 
     C                     CALL 'POOWUPC'              90  PRT Pmt&Pass Fr
     C           WUH3TX    PARM *BLANK    WQ0109  7        Return Code Usr
     C                     PARM 'O/M'     WQ0110  6        Application Cod
     C                     PARM @CN,013   WQ0111 10        USR Program nam
     C                     PARM @CN,014   WQ0112 10        USR Program Nam
     C                     PARM @CN,015   WQ0113 25        PRT Description
     C           P2WRST    PARM P2WRST    WQ0114 10        PRT Printer Dev
     C           P2WSST    PARM P2WSST    WQ0115  4        PRT Hold Output
     C           P2WTST    PARM P2WTST    WQ0116  4        PRT Save Output
     C           P2WUST    PARM P2WUST    WQ0117  1        PRT Night Queue
     C           P2BVVN    PARM P2BVVN    WQ0118 10        PRT Night Queue
     C           P2AJAA    PARM P2AJAA    WQ0119 155       Company Number
     C           P2AJAB    PARM P2AJAB    WQ0120 155       Date 1
     C           P2AJAC    PARM P2AJAC    WQ0121 155       Date 2
     C           P2M8NB    PARM P2M8NB    WQ0122 155       System Value Nu
     C           #DO8SX    PARM #DO8SX    WQ0123  1        Status - Y or N
     C           #DMCSX    PARM #DMCSX    WQ0124  1        Loads Shipped o
     C           #DSBST    PARM #DSBST    WQ0125  1        USR Confirm Sta
     C                     PARM #DDBSX    WQ0126  1        Report Type Bot
     C                     PARM #DCYVN    WQ0127  8        Document Name U
     C                     PARM #DUGTX    WQ0128 50        Email Address
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POOWUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     994142*
     C                     SETON                     404338*
     C                     SETON                     37    *
     C                     END
     C                     ELSE
      * CASE: DTL.USR Detail or Summary is Report Selection 6
     C           #DSTST    IFEQ '6'                        *IF
      * PRT Pmt&Pass Dts/Flgs  UP - /UT User Programs  * 
     C                     CALL 'PDMJUPR'              90  PRT Pmt&Pass Dt
     C           WUH3TX    PARM *BLANK    WQ0129  7        Return Code Usr
     C                     PARM 'O/M'     WQ0130  6        Application Cod
     C                     PARM @CN,016   WQ0131 10        USR Program nam
     C                     PARM @CN,017   WQ0132 10        USR Program Nam
     C                     PARM @CN,018   WQ0133 25        PRT Description
     C           P2WRST    PARM P2WRST    WQ0134 10        PRT Printer Dev
     C           P2WSST    PARM P2WSST    WQ0135  4        PRT Hold Output
     C           P2WTST    PARM P2WTST    WQ0136  4        PRT Save Output
     C           P2WUST    PARM P2WUST    WQ0137  1        PRT Night Queue
     C           P2BVVN    PARM P2BVVN    WQ0138 10        PRT Night Queue
     C           P2AJAA    PARM P2AJAA    WQ0139 155       Company Number
     C           P2AJNC    PARM P2AJNC    WQ0140 155       Customer Number
     C           P2AJAB    PARM P2AJAB    WQ0141 155       Date 1
     C           P2AJAC    PARM P2AJAC    WQ0142 155       Date 2
     C           P2AJAE    PARM P2AJAE    WQ0143 155       Order Number 1
     C           P2M8NB    PARM P2M8NB    WQ0144 155       System Value Nu
     C           #DDBSX    PARM #DDBSX    WQ0145  1        USR Summary/Det
     C           #DSTST    PARM #DSTST    WQ0146  1        USR Detail or S
     C           #DR4CD    PARM #DR4CD    WQ0147  3        Salesperson Cod
     C           P2SHTC    PARM P2SHTC    WQ0148 155       Ship to Custome
     C           #DO8SX    PARM #DO8SX    WQ0149  1        Status - Y or N
     C           #DMCSX    PARM #DMCSX    WQ0150  1        Loads Shipped o
     C                     PARM #DSBST    WQ0151  1        USR Confirm Sta
     C                     PARM #DBZNA    WQ0152  3        Carrier Code
     C                     PARM P3        WQ0153 155       Load Id Pass
     C                     PARM #DCYVN    WQ0154  8        Document Name U
     C                     PARM #DUGTX    WQ0155 50        Email Address
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMJUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     994333*
     C                     SETON                     364142*
     C                     SETON                     403538*
     C                     SETON                     37    *
     C                     END
     C                     ELSE
      * CASE: DTL.USR Detail or Summary is Report Selection 7
     C           #DSTST    IFEQ '7'                        *IF
      * PRT Pmt&Pass Dts/Flgs  UP - /UT User Programs  * 
     C                     CALL 'PDMJUPR'              90  PRT Pmt&Pass Dt
     C           WUH3TX    PARM *BLANK    WQ0156  7        Return Code Usr
     C                     PARM 'O/M'     WQ0157  6        Application Cod
     C                     PARM @CN,019   WQ0158 10        USR Program nam
     C                     PARM @CN,020   WQ0159 10        USR Program Nam
     C                     PARM @CN,021   WQ0160 25        PRT Description
     C           P2WRST    PARM P2WRST    WQ0161 10        PRT Printer Dev
     C           P2WSST    PARM P2WSST    WQ0162  4        PRT Hold Output
     C           P2WTST    PARM P2WTST    WQ0163  4        PRT Save Output
     C           P2WUST    PARM P2WUST    WQ0164  1        PRT Night Queue
     C           P2BVVN    PARM P2BVVN    WQ0165 10        PRT Night Queue
     C           P2AJAA    PARM P2AJAA    WQ0166 155       Company Number
     C           P2AJNC    PARM P2AJNC    WQ0167 155       Customer Number
     C           P2AJAB    PARM P2AJAB    WQ0168 155       Date 1
     C           P2AJAC    PARM P2AJAC    WQ0169 155       Date 2
     C           P2AJAE    PARM P2AJAE    WQ0170 155       Order Number 1
     C           P2M8NB    PARM P2M8NB    WQ0171 155       System Value Nu
     C           #DDBSX    PARM #DDBSX    WQ0172  1        USR Summary/Det
     C           #DSTST    PARM #DSTST    WQ0173  1        USR Detail or S
     C           #DR4CD    PARM #DR4CD    WQ0174  3        Salesperson Cod
     C           P2SHTC    PARM P2SHTC    WQ0175 155       Ship to Custome
     C           #DO8SX    PARM #DO8SX    WQ0176  1        Status - Y or N
     C           #DMCSX    PARM #DMCSX    WQ0177  1        Loads Shipped o
     C                     PARM #DSBST    WQ0178  1        USR Confirm Sta
     C                     PARM #DBZNA    WQ0179  3        Carrier Code
     C                     PARM P3        WQ0180 155       Load Id Pass
     C                     PARM #DCYVN    WQ0181  8        Document Name U
     C                     PARM #DUGTX    WQ0182 50        Email Address
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMJUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     994333*
     C                     SETON                     364142*
     C                     SETON                     403538*
     C                     SETON                     37    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: WRK.Return Code Usr is *Blank
     C           WUH3TX    IFEQ *BLANK                     *IF
      * Send message 'Print has been Submitted'
     C                     MOVEL'USR1832' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
      * Request new transaction
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBVLSC    BEGSR
      *================================================================
      * Validate screen input
      *================================================================
      * Validate USR From Date
      * External date
     C                     Z-ADDVDBDDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     Z-ADDXDINDT    #DBDDT
      * Validate USR Through Date
      * External date
     C                     Z-ADDVDBEDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
     C                     Z-ADDXDINDT    #DBEDT
      * Validate USR Detail or Summary
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DSTST'  IFEQ YPMTFD
      * USR Detail or Summary
     C                     MOVEL#DSTST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHSTST
     C                     SELEC
     C           W0INVL    WHEQ '1'                        1
     C                     Z-ADD1         ZHSTST
     C           W0INVL    WHEQ '2'                        2
     C                     Z-ADD2         ZHSTST
     C           W0INVL    WHEQ '3'                        3
     C                     Z-ADD3         ZHSTST
     C           W0INVL    WHEQ '4'                        4
     C                     Z-ADD4         ZHSTST
     C           W0INVL    WHEQ '5'                        5
     C                     Z-ADD5         ZHSTST
     C           W0INVL    WHEQ '6'                        6
     C                     Z-ADD6         ZHSTST
     C           W0INVL    WHEQ '7'                        7
     C                     Z-ADD7         ZHSTST
     C                     ENDSL
     C                     EXFMTZGSTST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHSTST    WHEQ 1
     C                     MOVEL'1'       W0INVL           1
     C           ZHSTST    WHEQ 2
     C                     MOVEL'2'       W0INVL           2
     C           ZHSTST    WHEQ 3
     C                     MOVEL'3'       W0INVL           3
     C           ZHSTST    WHEQ 4
     C                     MOVEL'4'       W0INVL           4
     C           ZHSTST    WHEQ 5
     C                     MOVEL'5'       W0INVL           5
     C           ZHSTST    WHEQ 6
     C                     MOVEL'6'       W0INVL           6
     C           ZHSTST    WHEQ 7
     C                     MOVEL'7'       W0INVL           7
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DSTST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate USR Confirm Status (Y/N)
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DSBST'  IFEQ YPMTFD
      * USR Confirm Status (Y/N)
     C                     MOVEL#DSBST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHSBST
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHSBST
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZHSBST
     C           W0INVL    WHEQ 'E'                        E
     C                     Z-ADD3         ZHSBST
     C           W0INVL    WHEQ 'A'                        A
     C                     Z-ADD4         ZHSBST
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD5         ZHSBST
     C                     ENDSL
     C                     EXFMTZGSBST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHSBST    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHSBST    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C           ZHSBST    WHEQ 3
     C                     MOVEL'E'       W0INVL           E
     C           ZHSBST    WHEQ 4
     C                     MOVEL'A'       W0INVL           A
     C           ZHSBST    WHEQ 5
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DSBST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Type Inc/Exc Sts
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#DO8SX    W0NSRQ  1        Type Inc/Exc St
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#DO8SX'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1669726   Y2LSNO  70
     C           #DO8SX    PARM #DO8SX    W0EXVL 25        Type Inc/Exc St
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * Validate Exclude Shp Mth is CT STS
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DMCSX'  IFEQ YPMTFD
      * Exclude Shp Mth is CT STS
     C                     MOVEL#DMCSX    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHMCSX
     C                     SELEC
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD1         ZHMCSX
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD2         ZHMCSX
     C                     ENDSL
     C                     EXFMTZGMCSX
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHMCSX    WHEQ 1
     C                     MOVEL'Y'       W0INVL           Y
     C           ZHMCSX    WHEQ 2
     C                     MOVEL'N'       W0INVL           N
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DMCSX
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Report Type Both      USR
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DDBSX'  IFEQ YPMTFD
      * Report Type Both      USR
     C                     MOVEL#DDBSX    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHDBSX
     C                     SELEC
     C           W0INVL    WHEQ 'D'                        D
     C                     Z-ADD1         ZHDBSX
     C           W0INVL    WHEQ 'S'                        S
     C                     Z-ADD2         ZHDBSX
     C                     ENDSL
     C                     EXFMTZGDBSX
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHDBSX    WHEQ 1
     C                     MOVEL'D'       W0INVL           D
     C           ZHDBSX    WHEQ 2
     C                     MOVEL'S'       W0INVL           S
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DDBSX
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Parent Customer and convert to internal.
      * CD7 Ext/Int
     C                     MOVELVDBTC7    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELVDBTC7    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,022                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD0         #DBTC7           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #DBTC7           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate A/R Customer Number and convert to internal.
      * CD7 Ext/Int
     C                     MOVELVDANC7    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELVDANC7    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,022                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD0         #DANC7           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #DANC7           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Ship To Customer and convert to internal.
      * CD7 Ext/Int
     C                     MOVELVDBKC7    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELVDBKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,022                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD0         #DBKC7           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #DBKC7           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate fields
      * Process F4
      * CASE: DTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * Select company
      * CASE: PGM.*Cursor field <IS> DTL.Company Number CDE
     C           W0CFL     IFEQ '#DATNB'                   *IF
      * CASE: PAR.Allow Multi-Company is yes
     C           P1I6ST    IFEQ 'Y'                        *IF
      * SEL Company - plants   SR - Company Name and Address  * 
     C                     CALL 'PPF2SRR'              90  SEL Company - p
     C                     PARM *BLANK    W0RTN   7
     C           #DATNB    PARM #DATNB    WQ0183  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPF2SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9939  *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Prompt Not Allowed'
     C                     MOVEL'USR2410' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Select parent customer
      * CASE: PGM.*Cursor field <IS> DTL.Parent Customer
     C           W0CFL     IFEQ 'VDBTC7'                   *IF
      * SEL Parent Customer    SR - Customer  * 
     C                     CALL 'PDWBSRR'              90  SEL Parent Cust
     C                     PARM *BLANK    W0RTN   7
     C           #DBTC7    PARM #DBTC7    WQ0184  70       Ship To Custome
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDWBSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9944  *
     C                     END
     C                     END                             *FI
      * Select A/R customer
      * CASE: PGM.*Cursor field <IS> DTL.A/R Customer Number
     C           W0CFL     IFEQ 'VDANC7'                   *IF
      * SEL A/R Customer       SR - Customer  * 
     C                     CALL 'PDXESRR'              90  SEL A/R Custome
     C                     PARM *BLANK    W0RTN   7
     C           #DANC7    PARM #DANC7    WQ0185  70       Ship To Custome
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXESRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9945  *
     C                     END
     C                     END                             *FI
      * Select Ship to customer
      * CASE: PGM.*Cursor field <IS> DTL.Ship To Customer
     C           W0CFL     IFEQ 'VDBKC7'                   *IF
      * 033104 SLM CHANGE TO USE THE SELECT SHIP TO CUSTOMER
      * SEL Cust/ShpTo Flag 'Y'SR - Customer  * 
     C                     CALL 'PDYSSRR'              90  SEL Cust/ShpTo
     C                     PARM *BLANK    W0RTN   7
     C           #DBKC7    PARM #DBKC7    WQ0186  70       Ship To Custome
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYSSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9946  *
     C                     END
     C                     END                             *FI
      * Select Carrier
      * CASE: PGM.*Cursor field <IS> DTL.Carrier Code
     C           W0CFL     IFEQ '#DBZNA'                   *IF
      * SEL Active Carrier     SR - OM Carrier  * 
     C                     CALL 'OMY6SRR'              90  SEL Active Carr
     C                     PARM *BLANK    W0RTN   7
     C           #DBZNA    PARM #DBZNA    WQ0187  3        Carrier Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMY6SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9935  *
     C                     END
     C                     END                             *FI
      * Select Sales Route
      * CASE: PGM.*Cursor field <IS> DTL.Sales Route Code
     C           W0CFL     IFEQ '#DR4CD'                   *IF
      * SEL Route by Sls Persn SR - Sales Route  * 
     C                     CALL 'PDS1SRR'              90  SEL Route by Sl
     C                     PARM *BLANK    W0RTN   7
     C           #DR4CD    PARM #DR4CD    WQ0188  3        Sales Route Cod
     C           YL0001    PARM YL0001    WQ0189  3        Salesperson Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDS1SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9936  *
     C                     END
     C                     END                             *FI
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END
      * Bypass ref file checks if error already detected
     C   99                GOTO DBEXIT
      * Select existing record
     C                     EXSR VACKRL
      * Check reference to Accrual Program
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Unit of Measure
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate relations
     C                     MOVEL*BLANK    #DAGTX           USR Company Nam
     C                     MOVEL*BLANK    #DADTX           Name
     C                     MOVEL*BLANK    #DAQTX           A/R Customer Na
     C                     MOVEL*BLANK    #DBRTX           Ship To Name
      * company name
      * CASE: DTL.Company Number CDE is not equal to zero
     C           #DATNB    IFNE *ZERO                      *IF
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#DATNB    WL0001           Company Number
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #DAGTX    P      Name
      * Company not found
      * CASE: PGM.*Return code is Company not found
     C           W0RTN     IFEQ @CN,023                    *IF
     C                     Z-ADD#DATNB    #DAIC3           Company Number
      * Send message 'Company Number not found'
     C                     MOVEL'USR0163' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * 02/13/07 PKD Removed hardcoding of company number
      * Rtv Plant Co Status   RT - Company Defaults Internal  * 
     C                     EXSR SBRVGN
      * CASE: LCL.Plant Company Sts is Plant Company
     C           YL0002    IFEQ 'P'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #DAGTX           USR Company Nam
     C                     Z-ADD#DATNB    #DAIC3           Company Number
      * Send message 'Company Number not found'
     C                     MOVEL'USR0163' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate parent customer if entered
      * CASE: DTL.Parent Customer is not equal to zero
     C           #DBTC7    IFNE *ZERO                      *IF
      * VAL Parent Customer    RT - Customer  * 
     C                     EXSR SCRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,024                    *IF
      * Setup message data for message
      * Convert Parent Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #DBTC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#DBTC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0001           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0001           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Parent Customer invalid'
     C                     MOVEL'USR2111' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9944  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Customer Name      RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#DBTC7    WL0003           Ship To Custome
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    #DADTX    P      Customer Name
     C                     END                             *FI
     C                     END                             *FI
      * Validate A/R customer if entered
      * CASE: DTL.A/R Customer Number is not equal to zero
     C           #DANC7    IFNE *ZERO                      *IF
      * VAL A/R Customer       RT - Customer  * 
     C                     EXSR SERVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,024                    *IF
      * Setup message data for message
      * Convert A/R Customer Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #DANC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#DANC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0002           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0002           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'A/R Customer invalid'
     C                     MOVEL'USR2110' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9945  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Customer Name      RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#DANC7    WL0003           Ship To Custome
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    #DAQTX    P      Customer Name
     C                     END                             *FI
     C                     END                             *FI
      * Validate ship to customer if entered
      * CASE: DTL.Ship To Customer is not equal to zero
     C           #DBKC7    IFNE *ZERO                      *IF
      * VAL Ship to Customer   RT - Customer  * 
     C                     EXSR SFRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,024                    *IF
      * Setup message data for message
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #DBKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#DBKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0003           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0003           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Shipto Customer invalid'
     C                     MOVEL'USR2452' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9946  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate Carrier if entered
      * CASE: DTL.Carrier Code is entered
     C           #DBZNA    IFNE *BLANK                     *IF
      * Val Carrier           RT - Carrier  * 
     C                     EXSR SGRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,024                    *IF
      * Setup message data for message
     C                     MOVEL#DBZNA    ZA0004           Carrier Code
      * Send message 'Carrier doesn't exists'
     C                     MOVEL'USR1252' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Only one customer can be entered at a time.
      * CASE:
      *  - (c1 AND c2) OR (c1 AND c3) OR (c2 AND c3)
      *   |- c1    : DTL.Parent Customer is not equal to zero
      *   |- c2    : DTL.A/R Customer Number is not equal to zero
      *   |- c3    : DTL.Ship To Customer is not equal to zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DBTC7    IFNE *ZERO                      *IF
     C           #DANC7    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           #DBTC7    IFNE *ZERO                      *IF
     C           #DBKC7    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           #DANC7    IFNE *ZERO                      *IF
     C           #DBKC7    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #DBKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#DBKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0005           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0005           CD7 Ext Numeric
     C                     END                             *FI
      * Convert A/R Customer Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #DANC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#DANC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0006           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0006           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Parent Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #DBTC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#DBTC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0007           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0007           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Only one Cust Can be Ent'
     C                     MOVEL'USR2453' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     994645*
     C                     SETON                     44    *
      *
     C                     END                             *FI
      * Val Load id, default from/to actual ship dates     RMC 11/15/06
      * CASE: DTL.Load ID is NE Blank
     C           #DRMNB    IFNE *ZERO                      *IF
      * RTV Act Ship per Ld   RT - Sales History  * 
     C                     EXSR SHRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,024                    *IF
      * Rtv Load Act Ship Dte RT - Order Header TRG  * 
     C                     EXSR SIRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,024                    *IF
      * Send message 'Load Header            NF'
     C                     MOVEL'USR1188' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWUGNDT    #DBDDT           USR From Date
     C                     Z-ADDWUGNDT    #DBEDT           USR Through Dat
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate From Date
      * CASE: DTL.USR From Date is not equal zero
     C           #DBDDT    IFNE *ZERO                      *IF
      * RTV Calendar           RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#DATNB    WL0005           Company Number
     C                     Z-ADD#DBDDT    WL0006           Post to G/L Dat
     C                     EXSR SJRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert USR From Date to display format
      * Convert date
     C           1000000   ADD  #DBDDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0008
      * Send message 'Date not in calendar'
     C                     MOVEL'USR0567' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
      * Validate Thru Date
      * CASE: DTL.USR Through Date is not equal zero
     C           #DBEDT    IFNE *ZERO                      *IF
      * RTV Calendar           RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#DATNB    WL0005           Company Number
     C                     Z-ADD#DBEDT    WL0006           Post to G/L Dat
     C                     EXSR SJRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert USR Through Date to display format
      * Convert date
     C           1000000   ADD  #DBEDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0009
      * Send message 'Date not in calendar'
     C                     MOVEL'USR0567' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     END                             *FI
      * If From Date GT Through Date, send error message
      * CASE: DTL.USR From Date GT DTL.USR Through Date
     C           #DBDDT    IFGT #DBEDT                     *IF
      * Setup message data for message
      * Send message 'From date exceeds to date'
     C                     MOVEL'USR0319' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
      * Validate Sales Route     9/17/02
      * CASE: DTL.Sales Route Code is entered
     C           #DR4CD    IFNE *BLANK                     *IF
      * RTV Check Existence    RT - Sales Route  * 
     C                     EXSR SKRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,024                    *IF
      * Send message 'Sales Route            NF'
     C                     MOVEL'USR1800' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * USR From Date required
     C           #DBDDT    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * USR Through Date required
     C           #DBEDT    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9932  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * USR Detail or Summary required
     C           #DSTST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9933  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * USR Confirm Status (Y/N) required
     C           #DSBST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9940  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Exclude Shp Mth is CT STS required
     C           #DMCSX    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9942  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Report Type Both      USR required
     C           #DDBSX    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9943  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for screen
      *================================================================
     C                     MOVEL'0'       *IN79
     C           YL0006    IFEQ 'D'                        *IF
     C           YL0006    OREQ 'H'
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           P1I6ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         MALDSC    BEGSR
      *================================================================
      * Load screen from passed parameters
      *================================================================
     C                     Z-ADD*ZERO     #DAIC3           Company Number
     C                     Z-ADDP2SHTC    #PSHTC           Ship to Custome
     C                     Z-ADDP2AJAB    #PAJAB           Date 1
     C                     Z-ADDP2AJAC    #PAJAC           Date 2
     C                     Z-ADD*ZERO     #DAJAD           From Date Pass
     C                     MOVEL*BLANK    #DMBSX           Exclude if Carr
     C                     MOVEL*BLANK    #1OJCD           Accrual Code
     C                     MOVEL*BLANK    #1LENA           Accrual Descrip
     C                     MOVEL*BLANK    #1TOST           Automatic Accru
     C                     MOVEL*BLANK    #1TQST           Print On Invoic
     C                     MOVEL*BLANK    #1TRST           Rate Usage
     C                     MOVEL*BLANK    #1TSST           Add-on/Allowanc
     C                     MOVEL*BLANK    #1OKCD           Accrual Type
     C                     MOVEL*BLANK    #1TYST           Sub Ledger Code
     C                     MOVEL*BLANK    #1OQCD           Reverse Accrual
     C                     MOVEL*BLANK    #1HHCD           U/M - Primary D
     C                     MOVEL*BLANK    #1I2TX           G/L Code Dr
     C                     MOVEL*BLANK    #1JFTX           G/L Code Cr
     C                     MOVEL*BLANK    #1I3TX           G/L Sub Account
     C                     MOVEL*BLANK    #1JGTX           Sales History E
     C                     MOVEL*BLANK    #1LEDG           Post to G/L (Y/
     C                     MOVEL*BLANK    #1TTST           All Products (Y
     C                     Z-ADD*ZERO     #1BKPR           Accrual Rate
     C                     MOVEL*BLANK    #1SHSX           Accrual Rate Ty
     C                     MOVEL*BLANK    #1QFSX           Accrual Detail
     C                     MOVEL*BLANK    #1FDTX           Standard Schedu
     C                     MOVEL*BLANK    #1FETX           Affect Sales Re
     C                     MOVEL*BLANK    #1FFTX           Affect Invoice
     C                     MOVEL*BLANK    #1FGTX           Invoice Print T
     C                     Z-ADD*ZERO     #1HQVL           Max Accrual Amo
     C                     MOVEL*BLANK    #1FHTX           Max Accrual Amo
     C                     MOVEL*BLANK    #1UVST           EDI Status 1
     C                     MOVEL*BLANK    #1UWST           EDI Status 2
     C                     MOVEL*BLANK    #1UXST           EDI Status 3
     C                     MOVEL*BLANK    #1VSST           Record Status
     C                     Z-ADD*ZERO     #1AATM           Job Time
     C                     MOVEL*BLANK    #1AYNA           User Id
     C                     MOVEL*BLANK    #1A0NA           Job Name
     C                     Z-ADD*ZERO     #1AXDT           Job Date
     C                     Z-ADD*ZERO     #DBDDT           USR From Date
      * Clear external version also
     C                     Z-ADD*ZERO     VDBDDT
     C                     Z-ADD*ZERO     #DBEDT           USR Through Dat
      * Clear external version also
     C                     Z-ADD*ZERO     VDBEDT
     C                     MOVEL*BLANK    #DSTST           USR Detail or S
     C                     Z-ADD*ZERO     #DRMNB           Load ID
     C                     MOVEL*BLANK    #DBZNA           Carrier Code
     C                     MOVEL*BLANK    #DR4CD           Sales Route Cod
     C                     MOVEL*BLANK    #DUGTX           Email Address
     C                     MOVEL*BLANK    #DCYVN           Document Name U
     C                     Z-ADD*ZERO     #DATNB           Company Number
     C                     MOVEL*BLANK    #DAGTX           USR Company Nam
     C                     MOVEL*BLANK    #DSBST           USR Confirm Sta
     C                     MOVEL*BLANK    #DO8SX           Type Inc/Exc St
     C                     MOVEL*BLANK    #DMCSX           Exclude Shp Mth
     C                     MOVEL*BLANK    #DDBSX           Report Type Bot
     C                     Z-ADD*ZERO     #DBTC7           Parent Customer
      * Clear external version also
     C                     MOVEL*BLANK    VDBTC7
     C                     MOVEL*BLANK    #DADTX           Name
     C                     Z-ADD*ZERO     #DANC7           A/R Customer Nu
      * Clear external version also
     C                     MOVEL*BLANK    VDANC7
     C                     MOVEL*BLANK    #DAQTX           A/R Customer Na
     C                     Z-ADD*ZERO     #DBKC7           Ship To Custome
      * Clear external version also
     C                     MOVEL*BLANK    VDBKC7
     C                     MOVEL*BLANK    #DBRTX           Ship To Name
      * USER: Load screen
      * ** Default Co# only if Allow Multi-Co = No       3/07/2006 LJB
      * CASE: PAR.Allow Multi-Company is no
     C           P1I6ST    IFEQ 'N'                        *IF
     C                     Z-ADDP1AIC3    #DAIC3           Company Number
     C                     Z-ADDP1AIC3    #DATNB           Company Number
     C                     END                             *FI
      * select company
      * CASE: DTL.Company Number is not equal to zero
     C           #DAIC3    IFNE *ZERO                      *IF
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#DATNB    WL0001           Company Number
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #DAGTX    P      Name
     C                     END                             *FI
     C                     MOVEL'1'       #DSTST           USR Detail or S
     C                     MOVEL'Y'       #DSBST           USR Confirm Sta
      * ** Blanks=All, I=Paid Only, E=Unpaid & Partials       WI262
     C                     MOVEL*BLANK    #DO8SX           Type Inc/Exc St
     C                     MOVEL'Y'       #DMCSX           Exclude Shp Mth
     C                     MOVEL'D'       #DDBSX           Report Type Bot
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert USR From Date to display format
      * Convert date
     C           1000000   ADD  #DBDDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDBDDT
      * Convert USR Through Date to display format
      * Convert date
     C           1000000   ADD  #DBEDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDBEDT
      * Convert Parent Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #DBTC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#DBTC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VDBTC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VDBTC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert A/R Customer Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #DANC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#DANC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VDANC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VDANC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #DBKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#DBKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VDBKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VDBKC7           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WCAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0001    WCAIC3           Company Number
      * Establish starting position
     C           KRSSA     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           Name
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCADTX    WL0002           Name
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Plant Co Status   RT - Company Defaults Internal  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WDAIC3           Company Number
      * Setup key
     C                     Z-ADD#DATNB    WDAIC3           Company Number
      * Establish starting position
     C           KRSSB     CHAIN@JYRECE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2025' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0002           Plant Company S
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDYISX    YL0002           Plant Company S
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * VAL Parent Customer    RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEBTC7    WQSC01           Parent Customer
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Parent Customer
      * Setup key
     C                     Z-ADD#DBTC7    WQSC01           Parent Customer
      * Establish starting position
     C           KRSSC     SETLL@BBREXK                    *
     C           KRSSC     READE@BBREXK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     GOTO SCEXIT                     *QUIT
     C           KRSSC     READE@BBREXK                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Customer Name      RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WFBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0003    WFBKC7           Ship To Custome
      * Establish starting position
     C           KRSSD     CHAIN@BBREE9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0004           Customer Name
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFAYTX    WL0004           Customer Name
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * VAL A/R Customer       RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGANC7    WQSE01           A/R Customer Nu
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           A/R Customer Nu
      * Setup key
     C                     Z-ADD#DANC7    WQSE01           A/R Customer Nu
      * Establish starting position
     C           KRSSE     SETLL@BBREXJ                    *
     C           KRSSE     READE@BBREXJ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     GOTO SEEXIT                     *QUIT
     C           KRSSE     READE@BBREXJ                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * VAL Ship to Customer   RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WHBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#DBKC7    WHBKC7           Ship To Custome
      * Establish starting position
     C           KRSSF     CHAIN@BBREWG              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DBRTX           Customer Name
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHAYTX    #DBRTX           Customer Name
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Val Carrier           RT - Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WIBZNA           Carrier Code
      * Setup key
     C                     MOVEL#DBZNA    WIBZNA           Carrier Code
      * Establish starting position
     C           KRSSG     CHAIN@FFREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Act Ship per Ld   RT - Sales History  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     #DBDDT           USR From Date
     C                     Z-ADD*ZERO     #DBEDT           USR Through Dat
     C                     MOVEL'Y'       YL0003           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJRMNB    WQSH01           Load ID
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Load ID
      * Setup key
     C                     Z-ADD#DRMNB    WQSH01           Load ID
      * Establish starting position
     C           KRSSH     SETLL@HSTPUX                    *
     C           KRSSH     READE@HSTPUX                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1241' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * First Time
      * CASE: LCL.First Time Flag is Yes
     C           YL0003    IFEQ 'Y'                        *IF
     C                     Z-ADDWJGNDT    YL0004           USR From Date
     C                     Z-ADDWJGNDT    YL0005           USR Through Dat
     C                     MOVEL'N'       YL0003           First Time Flag
     C                     END                             *FI
      * From Date
      * CASE: DB1.Actual Shipped Date LT LCL.USR From Date
     C           WJGNDT    IFLT YL0004                     *IF
     C                     Z-ADDWJGNDT    YL0004           USR From Date
     C                     END                             *FI
      * Through Date
      * CASE: DB1.Actual Shipped Date GT LCL.USR Through Date
     C           WJGNDT    IFGT YL0005                     *IF
     C                     Z-ADDWJGNDT    YL0005           USR Through Dat
     C                     END                             *FI
     C           KRSSH     READE@HSTPUX                  90*
     C                     ENDDO
      * USER: Exit processing
     C                     Z-ADDYL0004    #DBDDT           USR From Date
     C                     Z-ADDYL0005    #DBEDT           USR Through Dat
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Load Act Ship Dte RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKRMNB    WQSI02           Load ID
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI02           Load ID
      * Setup key
     C                     Z-ADD#DRMNB    WQSI02           Load ID
      * Establish starting position
     C           KRSSI     SETLL@BFCPD9                    *
     C           KRSSI     READE@BFCPD9                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUGNDT           Actual Shipped
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWKGNDT    WUGNDT           Actual Shipped
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SIEXIT                     *QUIT
     C           KRSSI     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Calendar           RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADDWL0005    WLAIC3           Company Number
     C                     Z-ADDWL0006    WLBCDT           Post to G/L Dat
      * Establish starting position
     C           KRSSJ     CHAIN@AFREBE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0018' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'USR0018' W0RTN            *Return code
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Check Existence    RT - Sales Route  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WMR4CD           Sales Route Cod
      * Setup key
     C                     MOVEL#DR4CD    WMR4CD           Sales Route Cod
      * Establish starting position
     C           KRSSK     CHAIN@JEREWF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1800' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SKEXIT                     *QUIT
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     GOTO SKEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WOAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0001    WOAJVN           User Profile Na
      * Establish starting position
     C           KRSSL     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWOI6ST    P1I6ST           Allow Multi-Com
     C                     MOVELWOMPNA    P1MPNA           Default Printer
     C                     MOVELWOBCCD    WUBCCD           Salesperson Cod
     C                     Z-ADDWOAIC3    YL0007           Company Number
     C                     MOVELWOBUVN    WN0002           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - User Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WRAJVN           User Profile Na
     C                     KFLD           WRDNCD           Application Cod
      * Setup key
     C                     MOVELWL0007    WRAJVN           User Profile Na
     C                     MOVELWL0008    WRDNCD           Application Cod
      * Establish starting position
     C           KRSSM     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWRAIC3    WL0009           Company Number
     C                     MOVELWRAJCD    WL0010           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WSDNCD    WQSN01           Application Cod
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSN01           Application Cod
     C                     MOVEL'OMS'     WQSN01           Application Cod
      * Establish starting position
     C           KRSSN     SETLL@DNRESF                    *
     C           KRSSN     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           WSRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELWSAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SORVGN
     C                     END                             *FI
     C           KRSSN     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WSDNCD    WQSO01           Application Cod
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Application Cod
      * Setup key
     C                     MOVELWSRSCD    WQSO01           Application Cod
      * Establish starting position
     C           KRSSO     SETLL@DNRESF                    *
     C           KRSSO     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWSAUNA    WUAUNA           Description
     C           KRSSO     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WDAIC3           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WDAIC3           Company Number
      * Establish starting position
     C           KRSSP     CHAIN@JYRECE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2025' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0002           Plant Company S
     C                     MOVEL*BLANK    YL0006           Company Organiz
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDYISX    YL0002           Plant Company S
     C                     MOVELWDYJSX    YL0006           Company Organiz
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** Change Log and comments
      *================================================================
      * *****
      * ** 08/14/13  RMC    e2719
      * ** Added download option to ftp file in xls format since it may b
      * ** too big to email Seaboard only:
      * EXECUTE VIEW(PNFWCPPV1) pcfmt(*xls)
      *                RECIPIENT('ftp:DOWNLOAD.PORK/transportation/
      * *****
      * ** 12/17/2009 LJB E000322
      * ** Added Email Address for the rest of the reports
      * ** 12/10/2009 LJB E000322
      * ** Added Email Address for Customer Report (for now) so
      * ** the new view can email a spreadsheet of this report
      * *****
      * ** 11/23/2009 LJB WI262
      * ** Added Allow Capability to only print Paid Loads
      * ** Change "Exclude if Carrier Paid" to "Type Inc/Exc Sts" to
      * ** select Include, Exclude or Blanks for all
      * *****
      * ** 06/06/2008 RMC E00156
      * ** added report type 7. and summary rpt for Whse Txfr selection
      * *****
      * ** 05/08/2008 RMC S00223
      * ** get act ship date from sales history if load is entered.
      * *****
      * ** 03/07/2006 LJB
      * ** If Allow Multi-Company=NO, default the company number and make
      * ** it output only, otherwise, leave it blank.
      * *****
      * 9/17/02  Added Sales Route report type 6 and Detail/Summary for
      *   report types 2 (customer),3 (carrier), 6 (sales route)
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Select existing record
      *================================================================
      * Name search required?
     C                     MOVEL#1OJCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Accrual Code
     C           YPMTFD    OREQ '#1OJCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1OJCD' defaulted for 'Accrual Code'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1LENA' defaulted for 'Accrual Description'.
      * Field '(DTL) #1OKCD' defaulted for 'Accrual Type'.
     C                     CALL 'PBDSSRR'              90  SEL Accrual Cde
     C                     PARM *BLANK    W0RTN   7
     C           #1OJCD    PARM #1OJCD    WQ0190  3        Accrual Code
     C           #1LENA    PARM *BLANK    WQ0191 30        Accrual Descrip
     C           #1OKCD    PARM *BLANK    WQ0192  2        Accrual Type
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBDSSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1OJCD    IFNE *BLANK                     Accrual Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Accrual Program
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1OQCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Accrual Code
     C           YPMTFD    OREQ '#1OQCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1OQCD' defaulted for 'Reverse Accrual Code'.
     C                     CALL 'OMLWSRR'              90  SEL OM Accrual
     C                     PARM *BLANK    W0RTN   7
     C           #1OQCD    PARM #1OQCD    WQ0193  3        Accrual Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMLWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1OQCD    IFNE *BLANK                     Accrual Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1OQCD    IFEQ *BLANK                     Accrual Code
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBWA    KLIST
     C                     KFLD           WAOJCD           Accrual Code
      * Setup key
     C                     MOVEL#1OQCD    WAOJCD
     C           KLVBWA    CHAIN@HLREU8              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Accrual Program        NF'
     C                     MOVEL'USR1514' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1514' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Unit of Measure
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1HHCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        U/M - Primary D
     C           YPMTFD    OREQ '#1HHCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1HHCD' defaulted for 'U/M - Primary Dft'.
     C                     CALL 'CAB5SRR'              90  SEL Unit of Mea
     C                     PARM *BLANK    W0RTN   7
     C           #1HHCD    PARM #1HHCD    WQ0194  2        U/M - Primary D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAB5SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1HHCD    IFNE *BLANK                     U/M - Primary D
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1HHCD    IFEQ *BLANK                     U/M - Primary D
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCWB    KLIST
     C                     KFLD           WBHHCD           U/M - Primary D
      * Setup key
     C                     MOVEL#1HHCD    WBHHCD
     C           KLVCWB    CHAIN@AMREU9              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Unit of Measure        NF'
     C                     MOVEL'USR0033' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0033' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           ZHCSRW    IFEQ 006
     C           ZHCSCL    ANDEQ038
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DSTST'  YPMTFD           USR Detail or S
     C                     END
      *
     C           ZHCSRW    IFEQ 015
     C           ZHCSCL    ANDEQ041
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DSBST'  YPMTFD           USR Confirm Sta
     C                     END
      *
     C           ZHCSRW    IFEQ 016
     C           ZHCSCL    ANDEQ041
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DO8SX'  YPMTFD           Type Inc/Exc St
     C                     END
      *
     C           ZHCSRW    IFEQ 017
     C           ZHCSCL    ANDEQ041
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DMCSX'  YPMTFD           Exclude Shp Mth
     C                     END
      *
     C           ZHCSRW    IFEQ 018
     C           ZHCSCL    ANDEQ041
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DDBSX'  YPMTFD           Report Type Bot
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM 'OMNGPVRH'W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
      * USER: Exit program processing
      * CASE: DTL.*CMD key is *Exit
     C           *IN03     IFEQ '1'                        *IF
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Reclaim resources of called programs
     C                     CALL 'Y2RCRSC'
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1AJCD           Warehouse Code
     C                     Z-ADD*ZERO     P1AIC3           Company Number
     C                     MOVEL*BLANK    P1DNCD           Application Cod
     C                     MOVEL*BLANK    P1B8NA           System Date For
     C                     MOVEL*BLANK    P1AJVN           User Profile Na
     C                     MOVEL*BLANK    P1I6ST           Allow Multi-Com
     C                     MOVEL*BLANK    P1MPNA           Default Printer
     C                     MOVEL*BLANK    P2G3TX           PRT Description
     C                     MOVEL*BLANK    P2WRST           PRT Printer Dev
     C                     MOVEL*BLANK    P2WSST           PRT Hold Output
     C                     MOVEL*BLANK    P2WTST           PRT Save Output
     C                     Z-ADD*ZERO     P2DYNB           PRT Number of C
     C                     MOVEL*BLANK    P2WUST           PRT Night Queue
     C                     MOVEL*BLANK    P2BVVN           PRT Night Queue
     C                     Z-ADD*ZERO     P2AJAA           Company Number
     C                     Z-ADD*ZERO     P2AJNC           Customer Number
     C                     Z-ADD*ZERO     P2AJAB           Date 1
     C                     Z-ADD*ZERO     P2AJAC           Date 2
     C                     Z-ADD*ZERO     P2AJAD           From Date Pass
     C                     Z-ADD*ZERO     P2AJAG           Thru Date Pass
     C                     Z-ADD*ZERO     P2AJAE           Order Number 1
     C                     Z-ADD*ZERO     P2M8NB           System Value Nu
     C                     Z-ADD*ZERO     P2SHTC           Ship to Custome
     C                     Z-ADD*ZERO     P3               Load Id Pass
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Return Code Usr
     C                     MOVEL*BLANK    WUH3TX  7
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WABKPR           Accrual Rate
     C                     Z-ADD*ZERO     WAHQVL           Max Accrual Amo
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDXXTM           Departure Time
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WEP3NB           D & B Number
     C                     Z-ADD*ZERO     WEI6DT           Date of D & B R
     C                     Z-ADD*ZERO     WEAYDT           Credit Line Exp
     C                     Z-ADD*ZERO     WEANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WEBTC7           Parent Customer
     C                     Z-ADD*ZERO     WES2NB           Parent Credit L
     C                     Z-ADD*ZERO     WEVHVA           A/R Credit Limi
     C                     Z-ADD*ZERO     WEI7DT           Order Entry Hol
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIEZNB           Telephone Numbe
     C                     Z-ADD*ZERO     WIEEDT           Carrier Last Us
     C                     Z-ADD*ZERO     WINRVA           Pallet Balance
     C                     Z-ADD*ZERO     WINSVA           Long hook balan
     C                     Z-ADD*ZERO     WINTVA           Short hook bala
     C                     Z-ADD*ZERO     WINUVA           Tub Balance
     C                     Z-ADD*ZERO     WIS8NB           Home Phone
     C                     Z-ADD*ZERO     WIS9NB           Other Phone
     C                     Z-ADD*ZERO     WINMVA           Flat Rate
     C                     Z-ADD*ZERO     WINOVA           Rate Per Pound
     C                     Z-ADD*ZERO     WINPVA           Unused Rate Per
     C                     Z-ADD*ZERO     WINQVA           Miscellaneous C
     C                     Z-ADD*ZERO     WIQXNB           Unused Mile Ran
     C                     Z-ADD*ZERO     WIQ1NB           Unused Mile Ran
     C                     Z-ADD*ZERO     WIMRNG           Unused Mile Ran
     C                     Z-ADD*ZERO     WIMRNE           Unused Mile Ran
     C                     Z-ADD*ZERO     WIRFNB           Unused Mile Ran
     C                     Z-ADD*ZERO     WIMREG           Unused Mile Ran
     C                     Z-ADD*ZERO     WIBQPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WIBRPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WIBSPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WIBTPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WIBUPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WIBVPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WIDJWG           Unused Weight R
     C                     Z-ADD*ZERO     WIDKWG           Unused Weight R
     C                     Z-ADD*ZERO     WIDLWG           Unused Weight R
     C                     Z-ADD*ZERO     WIDMWG           Unused Weight R
     C                     Z-ADD*ZERO     WIDNWG           Unused Weight R
     C                     Z-ADD*ZERO     WIDOWG           Unused Weight R
     C                     Z-ADD*ZERO     WIB2PR           Unused Weight R
     C                     Z-ADD*ZERO     WIB3PR           Unused Weight R
     C                     Z-ADD*ZERO     WIB4PR           Unused Weight R
     C                     Z-ADD*ZERO     WIB5PR           Unused Weight R
     C                     Z-ADD*ZERO     WIB6PR           Unused Weight R
     C                     Z-ADD*ZERO     WIB7PR           Unused Weight R
     C                     Z-ADD*ZERO     WIAAC7           Contact Number
     C                     Z-ADD*ZERO     WITENO           Carrier Unused
     C                     Z-ADD*ZERO     WIAOFC           Amount of Cargo
     C                     Z-ADD*ZERO     WIAOLI           Amount of Liabi
     C                     Z-ADD*ZERO     WIKHDT           Date of Expirat
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJC4NB           Order Number
     C                     Z-ADD*ZERO     WJDPNB           Order Sequence
     C                     Z-ADD*ZERO     WJUENB           Order Secondary
     C                     Z-ADD*ZERO     WJBTC7           Parent Customer
     C                     Z-ADD*ZERO     WJANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WJBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WJA0DT           Order Date
     C                     Z-ADD*ZERO     WJACDT           Cancel Date
     C                     Z-ADD*ZERO     WJTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WJATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WJT3NB           Attach to Order
     C                     Z-ADD*ZERO     WJRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WJORIT           Original Item
     C                     Z-ADD*ZERO     WJAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WJD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WJCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WJAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WJAKPR           Unit Price
     C                     Z-ADD*ZERO     WJAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WJA5DT           Requested Ship
     C                     Z-ADD*ZERO     WJAWDT           Invoice Date
     C                     Z-ADD*ZERO     WJHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WJAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WJAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WJAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WJAYVA           Extended Amount
     C                     Z-ADD*ZERO     WJL6NB           Contract Number
     C                     Z-ADD*ZERO     WJHCDT           LD Arrival Date
     C                     Z-ADD*ZERO     WJESNB           Accounting Year
     C                     Z-ADD*ZERO     WJETNB           Accounting Peri
     C                     Z-ADD*ZERO     WJBZNB           OM Week
     C                     Z-ADD*ZERO     WJEXQT           Quantity Billed
     C                     Z-ADD*ZERO     WJBYWG           Weight Billed
     C                     Z-ADD*ZERO     WJS5NB           Shipped Item Co
     C                     Z-ADD*ZERO     WJMAVA           Billing Detail
     C                     Z-ADD*ZERO     WJKDVA           Billing Detail
     C                     Z-ADD*ZERO     WJUSVA           FOB Gross Amoun
     C                     Z-ADD*ZERO     WJUTVA           Standard Overag
     C                     Z-ADD*ZERO     WJA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WJCKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WJR8NB           Shipping Compan
     C                     Z-ADD*ZERO     WJBZPR           Price Overage O
     C                     Z-ADD*ZERO     WJEXDT           Market Pricing
     C                     Z-ADD*ZERO     WJRGNB           Item Structure
     C                     Z-ADD*ZERO     WJRHNB           Item Structure
     C                     Z-ADD*ZERO     WJRINB           Item Structure
     C                     Z-ADD*ZERO     WJR1NB           Rated Freight
     C                     Z-ADD*ZERO     WJCONB           Invoice Number
     C                     Z-ADD*ZERO     WJGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WJRMNB           Load ID
     C                     Z-ADD*ZERO     WJAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WJSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WJSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WJSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WJONVA           Actual Freight
     C                     Z-ADD*ZERO     WJB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WJB5NB           PM Line Number
     C                     Z-ADD*ZERO     WJGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WJULVA           Absorbed Freigh
     C                     Z-ADD*ZERO     WJUNVA           Ledgrd Trd Fund
     C                     Z-ADD*ZERO     WJUOVA           Commission Amou
     C                     Z-ADD*ZERO     WJUPVA           Financials Amou
     C                     Z-ADD*ZERO     WJUQVA           Financials Amou
     C                     Z-ADD*ZERO     WJCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WJDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WJB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WJIANX           Req Shipping Te
     C                     Z-ADD*ZERO     WJIBNX           Actual Shipping
     C                     Z-ADD*ZERO     WJNYDT           Req Delivery Da
     C                     Z-ADD*ZERO     WJBZTM           Req Delivery Ti
     C                     Z-ADD*ZERO     WJZ4NB           MPC Number
     C                     Z-ADD*ZERO     WJOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WJC0C7           Claim Number
     C                     Z-ADD*ZERO     WJA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WJA5PR           Commodity Marke
     C                     Z-ADD*ZERO     WJCDPR           Market Value
     C                     Z-ADD*ZERO     WJD0PR           Default Cmdty M
     C                     Z-ADD*ZERO     WJD0VL           Raw Material Co
     C                     Z-ADD*ZERO     WJCEVL           Sales Expense T
     C                     Z-ADD*ZERO     WJOHDT           LD Sail Date
     C                     Z-ADD*ZERO     WJD9PR           NonLedgrd TrdFn
     C                     Z-ADD*ZERO     WJCFVL           HST Item Target
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Define work field Actual Shipped Date
     C                     Z-ADD*ZERO     WUGNDT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKC4NB           Order Number
     C                     Z-ADD*ZERO     WKANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WKBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WKB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WKA0DT           Order Date
     C                     Z-ADD*ZERO     WKA5DT           Requested Ship
     C                     Z-ADD*ZERO     WKGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WKACDT           Cancel Date
     C                     Z-ADD*ZERO     WKAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WKCXDT           Date of Origina
     C                     Z-ADD*ZERO     WKJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WKA1WG           Order Weight To
     C                     Z-ADD*ZERO     WKEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WKAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WKRMNB           Load ID
     C                     Z-ADD*ZERO     WKTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WKR1NB           Rated Freight
     C                     Z-ADD*ZERO     WKRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WKATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WKRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WKT3NB           Attach to Order
     C                     Z-ADD*ZERO     WKCONB           Invoice Number
     C                     Z-ADD*ZERO     WKAWDT           Invoice Date
     C                     Z-ADD*ZERO     WKVRVA           A/R order Value
     C                     Z-ADD*ZERO     WKB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WKNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WKNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WKNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WKNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WKNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WKBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WKBQTM           Time of Origina
     C                     Z-ADD*ZERO     WKBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WKBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WKBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WKH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WKH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WKH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WKH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WKH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WKC0C7           Claim Number
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLAIC3           Company Number
     C                     Z-ADD*ZERO     WLBCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WLCQNB           Julian Date
     C                     Z-ADD*ZERO     WLESNB           Accounting Year
     C                     Z-ADD*ZERO     WLETNB           Accounting Peri
     C                     Z-ADD*ZERO     WLBZNB           OM Week
     C                     Z-ADD*ZERO     WLEINB           Week Number
     C                     Z-ADD*ZERO     WLAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WLOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WLNQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WLNRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WLOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WLOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Define work field Salesperson Code
     C                     MOVEL*BLANK    WUBCCD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WONLNB           Entity Number
     C                     Z-ADD*ZERO     WOAIC3           Company Number
     C                     Z-ADD*ZERO     WOAATM           Job Time
     C                     Z-ADD*ZERO     WOAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WRAIC3           Company Number
     C                     Z-ADD*ZERO     WRAATM           Job Time
     C                     Z-ADD*ZERO     WRAXDT           Job Date
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WSAATM           Job Time
     C                     Z-ADD*ZERO     WSAXDT           Job Date
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SARVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     MOVEL*BLANK    WL0002 30
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0003  70
     C                     MOVEL*BLANK    WL0004 30
      * Define local variables for subroutine SJRVGN.
     C                     Z-ADD*ZERO     WL0005  30
     C                     Z-ADD*ZERO     WL0006  70
      * Define local variables for subroutine SMRVGN.
     C                     MOVEL*BLANK    WL0007 10
     C                     MOVEL*BLANK    WL0008  6
     C                     Z-ADD*ZERO     WL0009  30
     C                     MOVEL*BLANK    WL0010  3
      * Define local work field Salesperson Code
     C                     MOVEL*BLANK    YL0001  3
      * Define local work field Plant Company Sts
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field USR From Date
     C                     Z-ADD*ZERO     YL0004  70
      * Define local work field USR Through Date
     C                     Z-ADD*ZERO     YL0005  70
      * Define local work field Company Organization
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0007  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0008  3
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      *
     C                     MOVEL*BLANK    WN0001 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0001           User Profile Na
      *
     C                     MOVEL*BLANK    WN0002 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR SLRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,024                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0001    ZA0010           User Profile Na
     C                     MOVEL'OMS'     ZA0011           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0002    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0001    WL0007    P      User Profile Na
     C                     MOVEL'OMS'     WL0008    P      Application Cod
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0009    P1AIC3           Company Number
     C                     MOVELWL0010    YL0008    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0002    WL0007    P      User Profile Na
     C                     MOVEL'OMS'     WL0008    P      Application Cod
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0009    P1AIC3           Company Number
     C                     MOVELWL0010    YL0008    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0008    P1AJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0001    ZA0012           User Profile Na
     C                     MOVEL'OMS'     ZA0013           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0007    IFNE 0                          *IF
     C                     Z-ADDYL0007    P1AIC3           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0008    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           P1AJCD    PARM *BLANK    WQ0195  3        Warehouse Code
     C                     PARM YL0007    WQ0196  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SNRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
     C                     MOVEL*BLANK    P2WRST           PRT Printer Dev
     C                     MOVEL'N'       P2WUST           PRT Night Queue
     C                     Z-ADDP1AIC3    P2AJAA           Company Number
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
     C                     EXSR SPRVGN
      * ***** Change Log and comments
     C                     EXSR UASUBR                     ***** Change Lo
      * Load screen
     C                     EXSR MALDSC
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** W0BEG
01062010750157401600018530233503098
03369036250363203881041370439304649
049020491305158051690541405425
** W0END
01069010820157401606018550233703147
03376036270366103881041370439304649
049080494205164051980542005454
** W0NAM
VDBDDT    VDBEDT    #DSTST    #DRMNB    #DBZNA    #DR4CD    #DUGTX
#DCYVN    #DATNB    #DAGTX    #DSBST    #DO8SX    #DMCSX    #DDBSX
VDBTC7    #DADTX    VDANC7    #DAQTX    VDBKC7    #DBRTX
** @CN
00001 OMNBPCLP
00002 OMNBPFR
00003 Freight Comp by BOL
00004 PDMOPCLP
00005 PDMOPFR
00006 Freight Comp by Cust
00007 PDXWPCLP
00008 PDXWPFR
00009 Freight Comp by Carrier
00010 POOHPCLP
00011 POOHPFR
00012 Frt Comp by ExpSts,LdType
00013 POOVPCLP
00014 POOVPFR
00015 Frt Comp for Transfers
00016 POR9PCLP
00017 POR9PFR
00018 Frt Comp by Sales Route
00019 PMVFPCLP
00020 PMVFPFR
00021 Freight Comp by Cust/Co
00022 USR0752
00023 USR0003
00024 Y2U0005
