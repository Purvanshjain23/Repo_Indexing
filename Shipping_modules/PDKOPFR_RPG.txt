     H/TITLE PRT Acknowledgements   PF Print file
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Print file
     H* Object type   : *PGM
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISABANS
     H* Date          : 05/08/25  Time  : 07:02:53
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCADRREL1  IF   E           K DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FPDJYREL2  IF   E           K DISK
      * RTV : Company Defaults Internal Active Records
      *
     FOPBFCPLN  IF   E           K DISK
      * RSQ : Order Header TRG          K=Co, Order,Cust
      *
     FOPEXREL1  IF   E           K DISK
      * RTV : Order Types               Retrieval index
      *
     FCABBREL1  IF   E           K DISK
      * RTV : Customer Master           Retrieval index       NV
      *
     FPDJEREL1  IF   E           K DISK
      * RTV : Sales Route               Retrieval index
      *
     FCAASREL2  IF   E           K DISK
      * RTV : Company Control           Retrieval index       NV
      *
     FCAABREL3  IF   E           K DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FOME5REL1  IF   E           K DISK
      * RTV : Country Master            Retrieval index
      *
     FOPBGWKLA  IF   E           K DISK
      * RSQ : Order Detail              co/
      *
     FPDMRREL1  IF   E           K DISK
      * RTV : Export Doc Order Hdr      Retrieval index
      *
     FPDMMREL1  IF   E           K DISK
      * RTV : Export Doc Defaults       Retrieval index
      *
     FOPCOCPL1  IF   E           K DISK
      * RTV : Order Comment             Retrieval index       NV
      *
     FPDIECPL1  IF   E           K DISK
      * RTV : Shipping Instructions     Retrieval index
      *
     FPOAVCPL2  IF   E           K DISK
      * RSQ : Customer Comment          Cust/Type/Seq(D)
      *
     FPOAVCPL1  IF   E           K DISK
      * RTV : Customer Comment          Retrieval index
      *
     FPPB1REL2  IF   E           K DISK
      * RSQ : Country Comment           Country/Type/Seq(d)
      *
     FPPB1REL1  IF   E           K DISK
      * RTV : Country Comment           Retrieval index
      *
     FOMFLCPL1  IF   E           K DISK
      * RTV : Load Detail               Retrieval index
      *
     FOPBGWKL1  IF   E           K DISK
      * RTV : Order Detail              Retrieval index
      *
     FCAADREL1  IF   E           K DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FPOBIREL1  IF   E           K DISK
      * RTV : Customer Item Reference   Retrieval index
      *
     FOMHQCPL1  IF   E           K DISK
      * RTV : Order Detail Accrual      Retrieval index
      *
     FOMHOREL0  IF   E           K DISK
      * RTV : Customer Accrual          Retrieval index
      *
     FOMHPREL1  IF   E           K DISK
      * RTV : Customer Accrual Item     Retrieval index
      *
     FPOC8REL1  IF   E           K DISK
      * RTV : Customer Accrual Str      Retrieval index
      *
     FOMHLREL1  IF   E           K DISK
      * RTV : Accrual Program           Retrieval index
      *
     FOPCPCPL1  IF   E           K DISK
      * RTV : Order Detail Comment      Retrieval index       NV
      *
     FOMCRWKL1  IF   E           K DISK
      * RTV : Order Detail Fin          Retrieval index
      *
     FOMGKCPL1  IF   E           K DISK
      * RTV : Item Brokerage            Retrieval index
      *
     FCAAPREL2  IF   E           K DISK
      * RTV : Salesperson               Retrieval index       V
      *
     FOMGLCPL1  IF   E           K DISK
      * RTV : Item Cust Brokerage       Retrieval index
      *
     FPDJEREL2  IF   E           K DISK
      * RTV : Sales Route               Active Records
      *
     FPDNFREL1  IF   E           K DISK
      * RTV : Salesperson Electronic CM Retrieval index
      *
     FOPBFCPLL  IF   E           K DISK
      * RSQ : Order Header TRG          Ld(d)/Ord
      *
     FPMAMREL1  IF   E           K DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FPDNIREL1  IF   E           K DISK
      * RTV : Company Customer EXT      Retrieval index
      *
     FPDKOPFR$  O    E             PRINTER OFLIND(*IN97)
     F                                     INFDS(INFDS$)
      * PRT: PRT Acknowledgements   PF Print file
      *
      * Long constants
     D @CN#            S              6    DIM(15)CTDATA PERRCD(1)
     D @CN             S             25    DIM(15) ALT(@CN#)
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
     D INFDS$        E DS                  EXTNAME(Y2I$DSP)
      * Printer file information data structure
      *
      /EJECT
     D XDINT           DS
      * Internal date
     D  XDINDT                 1      7  0
     D  XDINYY                 1      3  0
     D  XDINMM                 4      5  0
     D  XDINDD                 6      7  0
      /EJECT
     D XDEX            DS
      * External date
     D  XDEXDT                 1      8  0
     D  XDEY01                 1      4  0
     D  XDEX01                 1      2  0
     D  XDEX02                 3      4  0
     D  XDEY02                 5      8  0
     D  XDEX03                 5      6  0
     D  XDEX04                 7      8  0
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  WP0001         S              3  0
     D  WP0002         S              1
     D  WP0003         S              3
     D  WP0004         S              3
     D  WP0005         S              3
     D  WP0006         S              3
     D  WP0007         S              3
     D  WP0008         S              3
     D  WP0009         S              3
     D  WP0010         S              3
     D  WP0011         S              3
     D  WP0012         S              3
     D  WP0013         S              1
     D  WP0014         S             50
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  W0PFM          S              1
     D  @$WRK          S              4  0
     D  @$HDL          S              4  0
     D  W0PGL          S              4  0
     D  W0OFL          S              4  0
     D  W0NEWP         S              1
     D  WUAHVN         S             10
     D  WUI7ST         S              1
     D  WUAIC3         S              3  0
     D  WUDQCD         S              4
     D  WUDRCD         S             12
     D  YN0001         S              1
     D  YL0001         S              1
     D  W0FSUM         S                   LIKE(@$CLN)
     D  W0DTLN         S                   LIKE(@$CLN)
     D  W0COLN         S                   LIKE(@$CLN)
     D  W0SKP          S              1
     D  W0AL1P         S              1
     D  W0AL00         S              1
     D  W0AL01         S              1
     D  W0AL02         S              1
     D  XDDTFM         S              3
     D  W0AP1P         S              1
     D  W0AP00         S              1
     D  W0AP01         S              1
     D  WUJVNA         S             30
     D  WUOAST         S              1
     D  WUOBST         S              1
     D  WUOEST         S              1
     D  WUOFST         S              1
     D  WUVBST         S              1
     D  YN0002         S             30
     D  WUE6TX         S              3
     D  WUE7TX         S              7
     D  WUABTX         S             25
     D  ZQ             S              5  0
     D  WUADTX         S             30
     D  WUACNA         S             30
     D  WUADNA         S             30
     D  WUAENA         S             30
     D  WUAJNA         S             20
     D  WUBTTX         S             11
     D  WUBVTX         S             25
     D  WUBGCD         S              2
     D  WUDATX         S             30
     D  WUKSTX         S             30
     D  WUD4NA         S             30
     D  WUD5NA         S             30
     D  WUD6NA         S             30
     D  WUHHNA         S             30
     D  WUU2ST         S              1
     D  WL0001         S              7  0
     D  WL0002         S              6
     D  WUD4ST         S              1
     D  WUVSST         S              1
     D  WL0003         S              6
     D  WL0004         S             30
     D  WL0005         S              1
     D  WUEINA         S              2
     D  WUUFL2         S              1
     D  WUW4TX         S             30
     D  YN0003         S              2
     D  WQSK01         S                   LIKE(OMAIC3)
     D  WQSK02         S                   LIKE(OMC4NB)
     D  YL0002         S              6
     D  WL0006         S              3  0
     D  WL0007         S              7  0
     D  WL0008         S              6
     D  WQSL01         S                   LIKE(OMAIC3)
     D  WQSL02         S                   LIKE(OMC4NB)
     D  YL0003         S              6
     D  WL0009         S              3  0
     D  WL0010         S              7  0
     D  WL0011         S              1
     D  WL0012         S              6
     D  WL0013         S             63
     D  WL0014         S             63
     D  WL0015         S             63
     D  WL0016         S             63
     D  WL0017         S             63
     D  WL0018         S              2
     D  WL0019         S             20
     D  WL0020         S              6
     D  WL0021         S             63
     D  WL0022         S             63
     D  WL0023         S             63
     D  WL0024         S             63
     D  WL0025         S             63
     D  WL0026         S              2
     D  WL0027         S             20
     D  WL0028         S              6
     D  WL0029         S             15
     D  WQSM01         S                   LIKE(MRAIC3)
     D  WQSM02         S                   LIKE(MRC4NB)
     D  WQSM03         S                   LIKE(MRDGSX)
     D  YL0004         S              1
     D  Y0CX01         S              1
     D  YL0005         S             63
     D  YL0006         S              1
     D  YL0007         S             63
     D  WL0030         S              6
     D  WL0031         S             30
     D  WQSP01         S                   LIKE(MRAIC3)
     D  WQSP02         S                   LIKE(MRC4NB)
     D  WQSP03         S                   LIKE(MRDGSX)
     D  WUEOCD         S              7
     D  W0AP02         S              1
     D  W0APDT         S              1
     D  W0ACDT         S              1
     D  YL0008         S              5  0
     D  WQKB01         S                   LIKE(COAIC3)
     D  WQKB02         S                   LIKE(COC4NB)
     D  WQKB03         S                   LIKE(COI1SX)
     D  W0BL1P         S              1
     D  W0BL00         S              1
     D  W0BL01         S              1
     D  W0BL02         S              1
     D  W0BP1P         S              1
     D  W0BP00         S              1
     D  W0BP01         S              1
     D  Y2LSNO         S              7  0
     D  W0INVL         S             25
     D  W0VLMP         S              1
     D  W0CNNM         S             25
     D  W0BP02         S              1
     D  W0BPDT         S              1
     D  W0BCDT         S              1
     D  YL0009         S             93
     D  WZB001         S                   LIKE(COAIC3)
     D  WZB002         S                   LIKE(COC4NB)
     D  WZB003         S                   LIKE(COI1SX)
     D  W0EOFB         S              1
     D  WQKC01         S                   LIKE(COAIC3)
     D  WQKC02         S                   LIKE(COC4NB)
     D  WQKC03         S                   LIKE(COI1SX)
     D  W0CL1P         S              1
     D  W0CL00         S              1
     D  W0CL01         S              1
     D  W0CL02         S              1
     D  W0CP1P         S              1
     D  W0CP00         S              1
     D  W0CP01         S              1
     D  W0CP02         S              1
     D  W0CPDT         S              1
     D  W0CCDT         S              1
     D  WZC001         S                   LIKE(COAIC3)
     D  WZC002         S                   LIKE(COC4NB)
     D  WZC003         S                   LIKE(COI1SX)
     D  W0EOFC         S              1
     D  WQKD01         S                   LIKE(COAIC3)
     D  WQKD02         S                   LIKE(COC4NB)
     D  WQKD03         S                   LIKE(COI1SX)
     D  W0DL1P         S              1
     D  W0DL00         S              1
     D  W0DL01         S              1
     D  W0DL02         S              1
     D  W0DP1P         S              1
     D  W0DP00         S              1
     D  W0DP01         S              1
     D  W0DP02         S              1
     D  W0DPDT         S              1
     D  W0DCDT         S              1
     D  WZD001         S                   LIKE(COAIC3)
     D  WZD002         S                   LIKE(COC4NB)
     D  WZD003         S                   LIKE(COI1SX)
     D  W0EOFD         S              1
     D  WQKE01         S                   LIKE(COAIC3)
     D  WQKE02         S                   LIKE(COC4NB)
     D  WQKE03         S                   LIKE(COI1SX)
     D  W0EL1P         S              1
     D  W0EL00         S              1
     D  W0EL01         S              1
     D  W0EL02         S              1
     D  W0EP1P         S              1
     D  W0EP00         S              1
     D  W0EP01         S              1
     D  W0EP02         S              1
     D  W0EPDT         S              1
     D  W0ECDT         S              1
     D  WZE001         S                   LIKE(COAIC3)
     D  WZE002         S                   LIKE(COC4NB)
     D  WZE003         S                   LIKE(COI1SX)
     D  W0EOFE         S              1
     D  YL0010         S              5  0
     D  WQKF01         S                   LIKE(IEAIC3)
     D  WQKF02         S                   LIKE(IEC4NB)
     D  W0FL1P         S              1
     D  W0FL00         S              1
     D  W0FL01         S              1
     D  W0FP1P         S              1
     D  W0FP00         S              1
     D  W0FP01         S              1
     D  W0FPDT         S              1
     D  W0FCDT         S              1
     D  YL0011         S             93
     D  WZF001         S                   LIKE(IEAIC3)
     D  WZF002         S                   LIKE(IEC4NB)
     D  W0EOFF         S              1
     D  YL0012         S              3  0
     D  WL0032         S              7  0
     D  WL0033         S              2
     D  WL0034         S              3  0
     D  WQSQ01         S                   LIKE(AVBKC7)
     D  WQSQ02         S                   LIKE(AVI1SX)
     D  YL0013         S              3  0
     D  YL0014         S              1
     D  YL0015         S              3  0
     D  WUTMST         S              1
     D  WQKG01         S                   LIKE(WABKC7)
     D  WQKG02         S                   LIKE(WAI1SX)
     D  W0GL1P         S              1
     D  W0GL00         S              1
     D  W0GL01         S              1
     D  W0GP1P         S              1
     D  W0GP00         S              1
     D  W0GP01         S              1
     D  YL0016         S              5  0
     D  W0GPDT         S              1
     D  W0GCDT         S              1
     D  WUDLST         S              1
     D  WUGGST         S              1
     D  WZG001         S                   LIKE(WABKC7)
     D  WZG002         S                   LIKE(WAI1SX)
     D  W0EOFG         S              1
     D  WQSR01         S                   LIKE(B1KXCD)
     D  WQSR02         S                   LIKE(B1I1SX)
     D  YL0017         S              1
     D  YL0018         S              3  0
     D  WQKH01         S                   LIKE(WBKXCD)
     D  WQKH02         S                   LIKE(WBI1SX)
     D  W0HL1P         S              1
     D  W0HL00         S              1
     D  W0HL01         S              1
     D  W0HP1P         S              1
     D  W0HP00         S              1
     D  W0HP01         S              1
     D  YL0019         S              5  0
     D  YL0020         S              3  0
     D  W0HPDT         S              1
     D  W0HCDT         S              1
     D  WZH001         S                   LIKE(WBKXCD)
     D  WZH002         S                   LIKE(WBI1SX)
     D  W0EOFH         S              1
     D  WQKI01         S                   LIKE(FLRMNB)
     D  W0IL1P         S              1
     D  W0IL00         S              1
     D  W0IP1P         S              1
     D  W0IP00         S              1
     D  W0IPDT         S              1
     D  W0ICDT         S              1
     D  WZI001         S                   LIKE(FLRMNB)
     D  W0EOFI         S              1
     D  WUDLVA         S             11  2
     D  WUDQVA         S             11  2
     D  WN0001         S              1
     D  YN0004         S              1
     D  WUYJSX         S              1
     D  WQ0001         S              3  0
     D  WQ0002         S              1
     D  WQ0003         S              1
     D  W0CLPG         S             10
     D  WUJVVA         S             11  2
     D  WQ0004         S              1
     D  YL0021         S              1
     D  WQKJ01         S                   LIKE(WCAIC3)
     D  WQKJ02         S                   LIKE(WCC4NB)
     D  W0JL1P         S              1
     D  W0JL00         S              1
     D  W0JL01         S              1
     D  W0JL02         S              1
     D  W0JP1P         S              1
     D  W0JP00         S              1
     D  W0JP01         S              1
     D  W0JP02         S              1
     D  W0JPDT         S              1
     D  W0JCDT         S              1
     D  WUCPWG         S              9  1
     D  WUBAQT         S             11  2
     D  WUBWTM         S              6  0
     D  WUH9NX         S             11  2
     D  WUH8NX         S             11  2
     D  YL0022         S              1
     D  YL0023         S              1
     D  YL0024         S             14
     D  YN0005         S             10
     D  YN0006         S             30
     D  YN0007         S             30
     D  YN0008         S             30
     D  WQKK01         S                   LIKE(HQAIC3)
     D  WQKK02         S                   LIKE(HQC4NB)
     D  WQKK03         S                   LIKE(HQDPNB)
     D  WQKK04         S                   LIKE(HQUENB)
     D  W0KL1P         S              1
     D  W0KL00         S              1
     D  W0KL01         S              1
     D  W0KL02         S              1
     D  W0KL03         S              1
     D  W0KP1P         S              1
     D  W0KP00         S              1
     D  W0KP01         S              1
     D  W0KP02         S              1
     D  W0KP03         S              1
     D  W0KPDT         S              1
     D  W0KCDT         S              1
     D  WZK001         S                   LIKE(HQAIC3)
     D  WZK002         S                   LIKE(HQC4NB)
     D  WZK003         S                   LIKE(HQDPNB)
     D  WZK004         S                   LIKE(HQUENB)
     D  W0EOFK         S              1
     D  WQKL01         S                   LIKE(HOBKC7)
     D  W0LL1P         S              1
     D  W0LL00         S              1
     D  W0LL01         S              1
     D  W0LP1P         S              1
     D  W0LP00         S              1
     D  W0LP01         S              1
     D  W0LPDT         S              1
     D  W0LCDT         S              1
     D  WUB8ST         S              1
     D  WUBKPR         S              9  6
     D  WUSHSX         S              2
     D  WL0035         S              7  0
     D  WL0036         S              3
     D  WL0037         S              5  0
     D  WL0038         S              7  0
     D  WL0039         S              9  6
     D  WL0040         S              2
     D  WL0041         S              7  0
     D  WL0042         S              3
     D  WL0043         S              5  0
     D  WL0044         S              3  0
     D  WL0045         S              3  0
     D  WL0046         S              3  0
     D  WL0047         S              9  6
     D  WL0048         S              2
     D  WZL001         S                   LIKE(HOBKC7)
     D  WZL002         S                   LIKE(HOOJCD)
     D  W0EOFL         S              1
     D  YN0009         S             30
     D  YN0010         S              1
     D  YN0011         S              1
     D  YN0012         S              1
     D  YN0013         S              1
     D  YL0025         S              2
     D  YN0014         S              2
     D  YN0015         S              3
     D  YN0016         S              2
     D  YN0017         S              1
     D  YL0026         S              7  0
     D  WQKM01         S                   LIKE(CPAIC3)
     D  WQKM02         S                   LIKE(CPC4NB)
     D  WQKM03         S                   LIKE(CPDPNB)
     D  WQKM04         S                   LIKE(CPUENB)
     D  W0ML1P         S              1
     D  W0ML00         S              1
     D  W0ML01         S              1
     D  W0ML02         S              1
     D  W0ML03         S              1
     D  W0MP1P         S              1
     D  W0MP00         S              1
     D  W0MP01         S              1
     D  W0MP02         S              1
     D  W0MP03         S              1
     D  W0MPDT         S              1
     D  W0MCDT         S              1
     D  WZM001         S                   LIKE(CPAIC3)
     D  WZM002         S                   LIKE(CPC4NB)
     D  WZM003         S                   LIKE(CPDPNB)
     D  WZM004         S                   LIKE(CPUENB)
     D  W0EOFM         S              1
     D  WQKN01         S                   LIKE(N1AIC3)
     D  WQKN02         S                   LIKE(N1C4NB)
     D  WQKN03         S                   LIKE(N1DPNB)
     D  W0NL1P         S              1
     D  W0NL00         S              1
     D  W0NL01         S              1
     D  W0NL02         S              1
     D  W0NL03         S              1
     D  W0NP1P         S              1
     D  W0NP00         S              1
     D  W0NP01         S              1
     D  W0NP02         S              1
     D  W0NP03         S              1
     D  W0NPDT         S              1
     D  W0NCDT         S              1
     D  WZN001         S                   LIKE(N1AIC3)
     D  WZN002         S                   LIKE(N1C4NB)
     D  WZN003         S                   LIKE(N1DPNB)
     D  WZN004         S                   LIKE(N1UENB)
     D  W0EOFN         S              1
     D  WQKO01         S                   LIKE(GKAIC3)
     D  WQKO02         S                   LIKE(GKHGCD)
     D  W0OL1P         S              1
     D  W0OL00         S              1
     D  W0OL01         S              1
     D  W0OP1P         S              1
     D  W0OP00         S              1
     D  W0OP01         S              1
     D  W0OPDT         S              1
     D  W0OCDT         S              1
     D  WL0049         S              3
     D  WL0050         S             30
     D  WZO001         S                   LIKE(GKAIC3)
     D  WZO002         S                   LIKE(GKHGCD)
     D  W0EOFO         S              1
     D  WQKR01         S                   LIKE(GLAIC3)
     D  WQKR02         S                   LIKE(GLHGCD)
     D  W0RL1P         S              1
     D  W0RL00         S              1
     D  W0RL01         S              1
     D  W0RL02         S              1
     D  W0RP1P         S              1
     D  W0RP00         S              1
     D  W0RP01         S              1
     D  W0RP02         S              1
     D  W0RPDT         S              1
     D  W0RCDT         S              1
     D  WZR001         S                   LIKE(GLAIC3)
     D  WZR002         S                   LIKE(GLHGCD)
     D  WZR003         S                   LIKE(GLBKC7)
     D  W0EOFR         S              1
     D  WUQTOR         S              9  2
     D  WZJ001         S                   LIKE(WCAIC3)
     D  WZJ002         S                   LIKE(WCC4NB)
     D  WZJ003         S                   LIKE(WCDPNB)
     D  W0EOFJ         S              1
     D  WUTRAQ         S              9  2
     D  WUAYVA         S             11  2
     D  WZA001         S                   LIKE(BEAIC3)
     D  WZA002         S                   LIKE(BEC4NB)
     D  WZA003         S                   LIKE(BEBKC7)
     D  W0EOFA         S              1
     D  WUDJST         S              1
     D  WL0051         S              3  0
     D  WL0052         S              7  0
     D  WL0053         S              3
     D  WL0054         S              1
     D  WQSZ01         S                   LIKE(WCAIC3)
     D  WQSZ02         S                   LIKE(WCC4NB)
     D  WUAJCD         S              3
     D  WQTA01         S                   LIKE(WCAIC3)
     D  WQTA02         S                   LIKE(WCC4NB)
     D  WUGSTX         S            256
     D  YL0027         S              3
     D  WL0055         S              3
     D  WL0056         S              3
     D  YN0018         S              1
     D  WL0057         S              3
     D  WL0058         S             50
     D  WL0059         S              1
     D  WUVEST         S              1
     D  WUAGCD         S              2
     D  WUIHSX         S              1
     D  WQTD01         S                   LIKE(WERMNB)
     D  WQTD02         S                   LIKE(WEC4NB)
     D  WUTAST         S              1
     D  WQTE01         S                   LIKE(WCAIC3)
     D  WQTE02         S                   LIKE(WCC4NB)
     D  WL0060         S              3  0
     D  WL0061         S              7  0
     D  WL0062         S              3  0
     D  WL0063         S              3  0
     D  WL0064         S              1
     D  WQTF01         S                   LIKE(WCAIC3)
     D  WQTF02         S                   LIKE(WCC4NB)
     D  YL0028         S              3
     D  YL0029         S             20
     D  YL0030         S             25
     D  YL0031         S             30
     D  YL0032         S             15
     D  YL0033         S             20
     D  YL0034         S              7  0
     D  YL0035         S              7  0
     D  YL0036         S              7  0
     D  YL0037         S              3
     D  YL0038         S              1
     D  YL0039         S             12
     D  YL0040         S             35
     D  YL0041         S             75
     D  YL0042         S              1
     D  WQTJ01         S                   LIKE(OMAIC3)
     D  WQTJ02         S                   LIKE(OMC4NB)
     D  ZAPGMQ         S             10
     D  ZAPGRL         S              5
     D  ZAMSID         S              7
     D  ZAMSGF         S             10
     D  ZAMSTP         S              7
     D  YILE           S              1
     D  ZZFFL          S             10
     D  ZZFLB          S             10
     D  ZZFMB          S             10
     D  @1FFL          S             10
     D  @1FLB          S             10
     D  @1FMB          S             10
     D  ZZFQL          S             21
     D  W0PMT          S              1
     D UAD             S             34    DIM(6)                               Name/Address
     D #L7             S              1    DIM(7)
      /EJECT
      * Parameter declarations
     D P1PARM          DS
      * FLD: Order Header TRG
      * B :  Company Number
     D  P1AIC3                 1      2P 0
      * N :  Order Number
     D  P1C4NB                 3      6P 0
      * N :  Order Type_Sales
     D  P1JNCD                 7      8
      * N :  Comment Print Acknowledge
     D  P1GTST                 9      9
      * N :  Comment Print Inv_Cr_Memo
     D  P1GVST                10     10
      * N :  Comment Print Pick Slip
     D  P1GUST                11     11
      * N :  Header Status
     D  P1GWST                12     12
      * N :  Load ID
     D  P1RMNB                13     16P 0
      * N :  Shipping Method
     D  P1Q2CD                17     18
      * N :  Age Code
     D  P1RPCD                19     19
      * N :  Load Type
     D  P1VDST                20     20
      * N :  Block Order Flag
     D  P1BCST                21     21
      * N :  Order Certification Flag
     D  P1BDST                22     22
      * N :  Export Docs Go w_Driver
     D  P1FQSX                23     23
     D P2PARM          DS
      * FLD: *Arrays
      * N :  Warehouse Code
     D  P2AJCD                 1      3
      * N :  Application Code
     D  P2DNCD                 4      9
      * N :  Salesperson Code
     D  P2BCCD                10     12
      * N :  System Date Format
     D  P2B8NA                13     15
      * N :  User Profile Name
     D  P2AJVN                16     25
      * N :  Allow Multi_Company
     D  P2I6ST                26     26
      * N :  Default Printer
     D  P2MPNA                27     36
      * N :  Name
     D  P2ADTX                37     66
     D P3PARM          DS
      * FLD: Company Control
      * N :  Print Co Addr on Acknow
     D  P3C2ST                 1      1
     D P4PARM          DS
      * FLD: Company Name and Address
      * N :  Address Line 1
     D  P4ACNA                 1     30
      * N :  Address Line 2
     D  P4ADNA                31     60
      * N :  Address Line 3
     D  P4AENA                61     90
      * N :  City
     D  P4AJNA                91    110
      * N :  Zip Postal Code
     D  P4BTTX               111    121
      * N :  State Code
     D  P4BGCD               122    123
     D P5PARM          DS
      * FLD: *Arrays
      * N :  PRT Description
     D  P5G3TX                 1     25
      * N :  PRT Printer Device
     D  P5WRST                26     35
      * N :  PRT Hold Output Sts
     D  P5WSST                36     39
      * N :  PRT Save Output Sts
     D  P5WTST                40     43
      * N :  PRT Number of Copies
     D  P5DYNB                44     45  0
      * N :  PRT Night Queue Run Sts
     D  P5WUST                46     46
      * N :  PRT Night Queue
     D  P5BVVN                47     56
      * N :  Company Number Pass   USR
     D  P5AJAA                57     64P 5
      * N :  Customer Number Pass  USR
     D  P5AJNC                65     72P 5
      * N :  Date 1          PASS  USR
     D  P5AJAB                73     80P 5
      * N :  Date 2          PASS  USR
     D  P5AJAC                81     88P 5
      * N :  From Date Pass        USR
     D  P5AJAD                89     96P 5
      * N :  Thru Date Pass        USR
     D  P5AJAG                97    104P 5
      * N :  Order Number 1  PASS  USR
     D  P5AJAE               105    112P 5
      * N :  Order Number 2  PASS  USR
     D  P5AJAF               113    120P 5
      * N :  System Value Numeric
     D  P5M8NB               121    128P 5
     D P6PARM          DS
      * FLD: *Arrays
      * N :  USR Company Number
     D  P6FKNB                 1      2P 0
      * N :  USR Page number
     D  P6MSNB                 3      5P 0
      * N :  Invoice_Memo Number
     D  P6Q7NB                 6      9P 0
      * N :  Invoice_Memo Suffix
     D  P6OMST                10     11
     D P7PARM          DS
      * I :  Billing Activity Type
     D  P7OBST                 1      1
     D P8PARM          DS
      * FLD: Country Master
      * N :  Country Code
     D  P8KXCD                 1      6
      * N :  Country Description
     D  P8DATX                 7     36
     D P9PARM          DS
      * FLD: *Arrays
      * I :  USR Warehouse Code
     D  P9CPCD                 1      3
      * I :  USR CDE Parm 1
     D  P9VSCD                 4      6
      * I :  USR CDE Parm 2
     D  P9VTCD                 7      9
      * I :  USR CDE Parm 3
     D  P9VUCD                10     12
      * I :  USR CDE Parm 4
     D  P9VVCD                13     15
      * I :  USR CDE Parm 5
     D  P9VWCD                16     18
      * I :  USR CDE Parm 6
     D  P9VXCD                19     21
      * I :  USR CDE Parm 7
     D  P9VYCD                22     24
      * I :  USR CDE Parm 8
     D  P9VZCD                25     27
      * I :  USR CDE Parm 9
     D  P9V0CD                28     30
      * I :  USR Select/Omit Flag
     D  P9CYST                31     31
      * O :  Salesperson Email addr
     D  P9YAU1                32     81
     D                 DS
     D  ZAMSDA                 1    132
     I@AVCPG4
      * Customer Comment          Retrieval index
      * Renamed input format fields
     I              AVBKC7                      WABKC7
     I              AVI1SX                      WAI1SX
     I              AVM5NX                      WAM5NX
     I              AVXRTX                      WAXRTX
     I              AVUVST                      WAUVST
     I              AVUWST                      WAUWST
     I              AVUXST                      WAUXST
     I              AVVSST                      WAVSST
     I              AVAATM                      WAAATM
     I              AVAYNA                      WAAYNA
     I              AVA0NA                      WAA0NA
     I              AVAXDT                      WAAXDT
      *
     I@B1REED
      * Country Comment           Retrieval index
      * Renamed input format fields
     I              B1KXCD                      WBKXCD
     I              B1I1SX                      WBI1SX
     I              B1M5NX                      WBM5NX
     I              B1Q6NA                      WBQ6NA
     I              B1UVST                      WBUVST
     I              B1UWST                      WBUWST
     I              B1UXST                      WBUXST
     I              B1VSST                      WBVSST
     I              B1AATM                      WBAATM
     I              B1AYNA                      WBAYNA
     I              B1A0NA                      WBA0NA
     I              B1AXDT                      WBAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                      WCAIC3
     I              OMC4NB                      WCC4NB
     I              OMDPNB                      WCDPNB
     I              OMUENB                      WCUENB
     I              OMHGCD                      WCHGCD
     I              OMAJCD                      WCAJCD
     I              OMBKC7                      WCBKC7
     I              OMCFC7                      WCCFC7
     I              OMGMST                      WCGMST
     I              OMGNST                      WCGNST
     I              OMMAVA                      WCMAVA
     I              OMKDVA                      WCKDVA
     I              OML8VA                      WCL8VA
     I              OML9VA                      WCL9VA
     I              OMGTST                      WCGTST
     I              OMGVST                      WCGVST
     I              OMGUST                      WCGUST
     I              OMQFST                      WCQFST
     I              OMAYVA                      WCAYVA
     I              OMEXDT                      WCEXDT
     I              OMLQCD                      WCLQCD
     I              OMRDCD                      WCRDCD
     I              OMQ7CD                      WCQ7CD
     I              OMBZPR                      WCBZPR
     I              OML6NB                      WCL6NB
     I              OMU1ST                      WCU1ST
     I              OMGIDT                      WCGIDT
     I              OMCRCD                      WCCRCD
     I              OMAGCD                      WCAGCD
     I              OMRZST                      WCRZST
     I              OMR0ST                      WCR0ST
     I              OMR1ST                      WCR1ST
     I              OMG7NA                      WCG7NA
     I              OMG8NA                      WCG8NA
     I              OMRPCD                      WCRPCD
     I              OMVEST                      WCVEST
     I              OMVGST                      WCVGST
     I              OMAVST                      WCAVST
     I              OMU0ST                      WCU0ST
     I              OMRFCD                      WCRFCD
     I              OMFZST                      WCFZST
     I              OMR1NB                      WCR1NB
     I              OMAVQT                      WCAVQT
     I              OMD0WG                      WCD0WG
     I              OMCCQT                      WCCCQT
     I              OMAUWG                      WCAUWG
     I              OMCBQT                      WCCBQT
     I              OMATWG                      WCATWG
     I              OMAQCS                      WCAQCS
     I              OMAGCS                      WCAGCS
     I              OMAKPR                      WCAKPR
     I              OMALPR                      WCALPR
     I              OMAUPR                      WCAUPR
     I              OMAVWG                      WCAVWG
     I              OMA4WG                      WCA4WG
     I              OMA5DT                      WCA5DT
     I              OMAODT                      WCAODT
     I              OMGNDT                      WCGNDT
     I              OMAMST                      WCAMST
     I              OMANST                      WCANST
     I              OMVAST                      WCVAST
     I              OMRGNB                      WCRGNB
     I              OMRHNB                      WCRHNB
     I              OMRINB                      WCRINB
     I              OMRBCD                      WCRBCD
     I              OMHICD                      WCHICD
     I              OMRNCD                      WCRNCD
     I              OMROCD                      WCROCD
     I              OMCXDT                      WCCXDT
     I              OMAJVN                      WCAJVN
     I              OMKXCD                      WCKXCD
     I              OMJPCD                      WCJPCD
     I              OMCQCD                      WCCQCD
     I              OMR4CD                      WCR4CD
     I              OMZ1ST                      WCZ1ST
     I              OMZ3ST                      WCZ3ST
     I              OMZ4ST                      WCZ4ST
     I              OMDUPR                      WCDUPR
     I              OMB6VL                      WCB6VL
     I              OMA1AA                      WCA1AA
     I              OMFZSX                      WCFZSX
     I              OMF0SX                      WCF0SX
     I              OMF1SX                      WCF1SX
     I              OMF2SX                      WCF2SX
     I              OMF3SX                      WCF3SX
     I              OMF4SX                      WCF4SX
     I              OMF5SX                      WCF5SX
     I              OMF6SX                      WCF6SX
     I              OMF7SX                      WCF7SX
     I              OMNTDT                      WCNTDT
     I              OMNUDT                      WCNUDT
     I              OMNVDT                      WCNVDT
     I              OMNWDT                      WCNWDT
     I              OMNXDT                      WCNXDT
     I              OMBUTM                      WCBUTM
     I              OMBVTM                      WCBVTM
     I              OMBWTM                      WCBWTM
     I              OMBXTM                      WCBXTM
     I              OMBYTM                      WCBYTM
     I              OMH5NX                      WCH5NX
     I              OMH6NX                      WCH6NX
     I              OMH7NX                      WCH7NX
     I              OMH8NX                      WCH8NX
     I              OMH9NX                      WCH9NX
     I              OMDVPR                      WCDVPR
     I              OMDWPR                      WCDWPR
     I              OMDXPR                      WCDXPR
     I              OMDYPR                      WCDYPR
     I              OMDZPR                      WCDZPR
     I              OMGSPR                      WCGSPR
     I              OMGTPR                      WCGTPR
     I              OMGUPR                      WCGUPR
     I              OMHOST                      WCHOST
     I              OMHPST                      WCHPST
     I              OMIOST                      WCIOST
     I              OMPEWG                      WCPEWG
     I              OMRINY                      WCRINY
     I              OMTIDT                      WCTIDT
     I              OMTJDT                      WCTJDT
     I              OMH2ST                      WCH2ST
     I              OMH0ST                      WCH0ST
     I              OMH1ST                      WCH1ST
     I              OMTKDT                      WCTKDT
     I              OMTLDT                      WCTLDT
     I              OMTMDT                      WCTMDT
     I              OMUVST                      WCUVST
     I              OMUWST                      WCUWST
     I              OMUXST                      WCUXST
     I              OMAATM                      WCAATM
     I              OMAYNA                      WCAYNA
     I              OMA0NA                      WCA0NA
     I              OMAXDT                      WCAXDT
      *
     I@JEREWS
      * Sales Route               Active Records
      * Renamed input format fields
     I              JER4CD                      WDR4CD
     I              JEMZNA                      WDMZNA
     I              JEBCCD                      WDBCCD
     I              JEBFCD                      WDBFCD
     I              JEQ4CD                      WDQ4CD
     I              JEWOST                      WDWOST
     I              JER8CD                      WDR8CD
     I              JEUVST                      WDUVST
     I              JEUWST                      WDUWST
     I              JEUXST                      WDUXST
     I              JEVSST                      WDVSST
     I              JEAATM                      WDAATM
     I              JEAYNA                      WDAYNA
     I              JEA0NA                      WDA0NA
     I              JEAXDT                      WDAXDT
      *
     I@BFCPR0
      * Order Header TRG          Ld(d)/Ord
      * Renamed input format fields
     I              BEAIC3                      WEAIC3
     I              BEC4NB                      WEC4NB
     I              BEJNCD                      WEJNCD
     I              BEANC7                      WEANC7
     I              BEBKC7                      WEBKC7
     I              BEBRTX                      WEBRTX
     I              BEHMNA                      WEHMNA
     I              BEHONA                      WEHONA
     I              BEHPNA                      WEHPNA
     I              BEHNNA                      WEHNNA
     I              BEDBCD                      WEDBCD
     I              BECKTX                      WECKTX
     I              BEB0C7                      WEB0C7
     I              BEAETX                      WEAETX
     I              BEB1NA                      WEB1NA
     I              BEB3NA                      WEB3NA
     I              BEB4NA                      WEB4NA
     I              BEB2NA                      WEB2NA
     I              BEBHCD                      WEBHCD
     I              BEC8TX                      WEC8TX
     I              BEBCNA                      WEBCNA
     I              BEA0DT                      WEA0DT
     I              BEA5DT                      WEA5DT
     I              BEGNDT                      WEGNDT
     I              BEACDT                      WEACDT
     I              BEAQCD                      WEAQCD
     I              BEB6NA                      WEB6NA
     I              BEBYNA                      WEBYNA
     I              BEBZNA                      WEBZNA
     I              BEGTST                      WEGTST
     I              BEGVST                      WEGVST
     I              BEGUST                      WEGUST
     I              BEQFST                      WEQFST
     I              BECQCD                      WECQCD
     I              BEGJST                      WEGJST
     I              BEGWST                      WEGWST
     I              BEGXST                      WEGXST
     I              BEGYST                      WEGYST
     I              BEAODT                      WEAODT
     I              BEAIVN                      WEAIVN
     I              BECXDT                      WECXDT
     I              BEJZVA                      WEJZVA
     I              BEA1WG                      WEA1WG
     I              BEXIST                      WEXIST
     I              BEXJST                      WEXJST
     I              BEXKST                      WEXKST
     I              BEEIDT                      WEEIDT
     I              BEAFTM                      WEAFTM
     I              BEE8CD                      WEE8CD
     I              BEE9CD                      WEE9CD
     I              BERMNB                      WERMNB
     I              BETBNB                      WETBNB
     I              BER1NB                      WER1NB
     I              BEPJST                      WEPJST
     I              BEU0ST                      WEU0ST
     I              BEU1ST                      WEU1ST
     I              BEQ2CD                      WEQ2CD
     I              BEU2ST                      WEU2ST
     I              BEVEST                      WEVEST
     I              BEVFST                      WEVFST
     I              BEVGST                      WEVGST
     I              BERPCD                      WERPCD
     I              BERNNB                      WERNNB
     I              BEVDST                      WEVDST
     I              BEATIN                      WEATIN
     I              BEU4ST                      WEU4ST
     I              BEU5ST                      WEU5ST
     I              BERSRN                      WERSRN
     I              BEMHNA                      WEMHNA
     I              BEMINA                      WEMINA
     I              BEWBST                      WEWBST
     I              BER4CD                      WER4CD
     I              BEBFCD                      WEBFCD
     I              BEQ4CD                      WEQ4CD
     I              BET3NB                      WET3NB
     I              BESICD                      WESICD
     I              BECONB                      WECONB
     I              BECEST                      WECEST
     I              BEAWDT                      WEAWDT
     I              BEJPCD                      WEJPCD
     I              BEXUST                      WEXUST
     I              BEZ1ST                      WEZ1ST
     I              BEVRVA                      WEVRVA
     I              BEOBST                      WEOBST
     I              BEBCST                      WEBCST
     I              BEBDST                      WEBDST
     I              BEB7VL                      WEB7VL
     I              BEGASX                      WEGASX
     I              BEGBSX                      WEGBSX
     I              BEGCSX                      WEGCSX
     I              BEGDSX                      WEGDSX
     I              BEFNSX                      WEFNSX
     I              BEFOSX                      WEFOSX
     I              BEFPSX                      WEFPSX
     I              BEFQSX                      WEFQSX
     I              BEFRSX                      WEFRSX
     I              BEFSSX                      WEFSSX
     I              BEFTSX                      WEFTSX
     I              BEFUSX                      WEFUSX
     I              BEFVSX                      WEFVSX
     I              BEFWSX                      WEFWSX
     I              BEFXSX                      WEFXSX
     I              BEFYSX                      WEFYSX
     I              BENODT                      WENODT
     I              BENPDT                      WENPDT
     I              BENQDT                      WENQDT
     I              BENRDT                      WENRDT
     I              BENSDT                      WENSDT
     I              BEBPTM                      WEBPTM
     I              BEBQTM                      WEBQTM
     I              BEBRTM                      WEBRTM
     I              BEBSTM                      WEBSTM
     I              BEBTTM                      WEBTTM
     I              BEH0NX                      WEH0NX
     I              BEH1NX                      WEH1NX
     I              BEH2NX                      WEH2NX
     I              BEH3NX                      WEH3NX
     I              BEH4NX                      WEH4NX
     I              BEC0C7                      WEC0C7
     I              BEUVST                      WEUVST
     I              BEUWST                      WEUWST
     I              BEUXST                      WEUXST
     I              BEAATM                      WEAATM
     I              BEAYNA                      WEAYNA
     I              BEA0NA                      WEA0NA
     I              BEAXDT                      WEAXDT
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
     C     P1AIC3        PARM      P1AIC3        WP0001                         Company Number
     C     P7OBST        PARM                    WP0002                         Billing Activit
     C     P9CPCD        PARM                    WP0003                         USR Warehouse C
     C     P9VSCD        PARM                    WP0004                         USR CDE Parm 1
     C     P9VTCD        PARM                    WP0005                         USR CDE Parm 2
     C     P9VUCD        PARM                    WP0006                         USR CDE Parm 3
     C     P9VVCD        PARM                    WP0007                         USR CDE Parm 4
     C     P9VWCD        PARM                    WP0008                         USR CDE Parm 5
     C     P9VXCD        PARM                    WP0009                         USR CDE Parm 6
     C     P9VYCD        PARM                    WP0010                         USR CDE Parm 7
     C     P9VZCD        PARM                    WP0011                         USR CDE Parm 8
     C     P9V0CD        PARM                    WP0012                         USR CDE Parm 9
     C     P9CYST        PARM                    WP0013                         USR Select/Omit
     C                   PARM      P9YAU1        WP0014                         Salesperson Ema
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * PRT Acknowledgements   PF: Mainline
     C                   EXSR      A0MAIN
      * Print headers then End of report format
     C                   EXSR      Q0PRNT
     C                   WRITE     #LENDRPT
      * USER: On print of end of report format
      * Exit program
     C                   EXSR      ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR   A0MAIN        BEGSR
      *================================================================
      * PRT Acknowledgements   PF: Mainline
      *================================================================
      * Establish starting position
     C     *LOVAL        SETLL     @BFCPYX                                      *
      * Read first record with user selection
     C                   EXSR      A3READ
     C                   IF        W0EOFA <> '0'
     C                   ELSE
      * Request all headings
     C                   MOVEL     'Y'           W0AL1P                         First page
     C                   MOVEL     'Y'           W0AL00                         Company Number
     C                   MOVEL     'Y'           W0AL01                         Order Number
     C                   MOVEL     'Y'           W0AL02                         Ship To Custome
      * Set column headings flag
     C                   MOVE      'Y'           W0ACDT
      * Print report body
      * Prepare heading formats for printing
     C                   DOW       W0EOFA = '0'
     C                   EXSR      A1PHDR
      * Print report detail line
     C                   EXSR      A2PDTL
      * Read next record with user selection
     C                   EXSR      A3READ
      * Print totals
     C                   EXSR      A4PTOT
     C                   END                                                    WOD
     C                   END                                                    FI
      *================================================================
     CSR   A0EXIT        ENDSR
      /EJECT
     CSR   A1PHDR        BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
      * Signal that format is now ready to print
     C                   IF        W0AL1P = 'Y'
     C                   MOVE      'Y'           W0AP1P
     C                   END
      *
      * Signal that format is now ready to print
     C                   IF        W0AL00 = 'Y'
     C                   MOVE      'Y'           W0AP00
     C                   END
      *
      * Load key header format
     C                   IF        W0AL01 = 'Y'
     C                   EVAL      $CUFL2 = ' '                                 USR Flag 2
     C                   EVAL      $CD4ST = ' '                                 USR Flag 1
     C                   EVAL      $CD8NA = ' '                                 USR Company Add
     C                   EVAL      $CHJNA = ' '                                 USR Heading - 8
     C                   EVAL      $CD9NA = ' '                                 USR Company Add
     C                   EVAL      $CEANA = ' '                                 USR Company Add
     C                   EVAL      $CD4T1 = ' '                                 Company/Order N
     C                   MOVEL     BEJNCD        $CJNCD                         Order Type_Sale
     C                   EVAL      $CEBNA = ' '                                 USR Company Add
     C                   Z-ADD     BERMNB        $CRMNB                         Load ID
     C                   EVAL      $CT3CD = ' '                                 Warehouse Code
     C                   EVAL      $CECNA = ' '                                 USR Company Add
     C                   EVAL      $CKXCD = ' '                                 Country Code
     C                   Z-ADD     BEA0DT        $CA0DT                         Order Date
     C                   EVAL      $CD4NA = ' '                                 USR Comment 1
     C                   EVAL      $CD5NA = ' '                                 USR Comment 2
     C                   EVAL      $CD6NA = ' '                                 USR Comment 3
     C                   EVAL      $CHHNA = ' '                                 USR Comment 4
     C                   EVAL      $CJUNA = ' '                                 USR Description
     C                   Z-ADD     BEBKC7        $CBKC7                         Ship To Custome
     C                   Z-ADD     BEB0C7        $CB0C7                         Bill to Custome
     C                   EVAL      $CGINA = ' '                                 USR Compressed
     C                   EVAL      $CGNNA = ' '                                 USR Compressed
     C                   EVAL      $CGJNA = ' '                                 USR Compressed
     C                   EVAL      $CGONA = ' '                                 USR Compressed
     C                   EVAL      $CGKNA = ' '                                 USR Compressed
     C                   EVAL      $CGPNA = ' '                                 USR Compressed
     C                   EVAL      $CGLNA = ' '                                 USR Compressed
     C                   EVAL      $CGQNA = ' '                                 USR Compressed
     C                   EVAL      $CGMNA = ' '                                 USR Compressed
     C                   EVAL      $CGRNA = ' '                                 USR Compressed
     C                   EVAL      $CNWNA = ' '                                 USR Compressed
     C                   EVAL      $CNXNA = ' '                                 USR Compressed
     C                   EVAL      $CKYNA = ' '                                 USR Compressed
     C                   EVAL      $CCDTX = ' '                                 USR Telephone C
     C                   EVAL      $CDATX = ' '                                 Country Descrip
     C                   EVAL      $CDUTX = ' '                                 Fax Number
     C                   Z-ADD     BEAIC3        $CAIC3                         Company Number
     C                   MOVEL     BEBRTX        $CBRTX                         Ship To Name
     C                   MOVEL     BEHMNA        $CHMNA                         Ship To Address
     C                   MOVEL     BEHONA        $CHONA                         Ship To Address
     C                   MOVEL     BEHPNA        $CHPNA                         Ship To Address
     C                   MOVEL     BEHNNA        $CHNNA                         Ship To City
     C                   MOVEL     BEDBCD        $CDBCD                         Ship To State C
     C                   MOVEL     BECKTX        $CCKTX                         Ship To Zip_Pos
     C                   MOVEL     BEAETX        $CAETX                         Bill to Name
     C                   MOVEL     BEB1NA        $CB1NA                         Bill to Address
     C                   MOVEL     BEB3NA        $CB3NA                         Bill to Address
     C                   MOVEL     BEB4NA        $CB4NA                         Bill to Address
     C                   MOVEL     BEB2NA        $CB2NA                         Bill to City
     C                   MOVEL     BEBHCD        $CBHCD                         Bill to State C
     C                   MOVEL     BEC8TX        $CC8TX                         Bill to Zip_Pos
     C                   Z-ADD     BEGNDT        $CGNDT                         Actual Shipped
     C                   Z-ADD     BEAODT        $CAODT                         Scheduled Ship
     C                   Z-ADD     BEEIDT        $CEIDT                         Requested Deliv
     C                   MOVEL     BEQ2CD        $CQ2CD                         Shipping Method
     C                   MOVEL     BEU2ST        $CU2ST                         Export Status
     C                   MOVEL     BER4CD        $CR4CD                         Sales Route Cod
     C                   EVAL      $CMZNA = ' '                                 Sales Route Des
     C                   EVAL      $CP3TX = ' '                                 ED Remark Const
     C                   EVAL      $CP4TX = ' '                                 ED Remark Const
     C                   EVAL      $CPFTX = ' '                                 Text 1 Length U
     C                   EVAL      $CP5TX = ' '                                 ED Remark Const
     C                   EVAL      $CP6TX = ' '                                 ED Remark Const
     C                   EVAL      $CORNA = ' '                                 ED Shipping Mar
     C                   MOVEL     BEFXSX        $CFXSX                         HPB Ship to War
     C                   Z-ADD     BEC4NB        $CC4NB                         Order Number
     C                   EVAL      $CPUTX = ' '                                 ED Consignor Na
     C                   EVAL      $CRHTX = ' '                                 ED Consignee Na
     C                   EVAL      $CPVTX = ' '                                 ED Consignor Ad
     C                   EVAL      $CRITX = ' '                                 ED Consignee Ad
     C                   EVAL      $CPWTX = ' '                                 ED Consignor Ad
     C                   EVAL      $CRJTX = ' '                                 ED Consignee Ad
     C                   EVAL      $CRVTX = ' '                                 ED Consignor Ad
     C                   EVAL      $CSCTX = ' '                                 ED Consignee Ad
     C                   EVAL      $CPPU1 = ' '                                 ED Consignor Ad
     C                   EVAL      $CSDTX = ' '                                 ED Consignee Ad
     C                   EVAL      $CZ7AA = ' '                                 ED Consignor St
     C                   EVAL      $CPDU1 = ' '                                 ED Consignor Po
     C                   EVAL      $CZ8AA = ' '                                 ED Consignor Co
     C                   EVAL      $CAAAB = ' '                                 ED Consignee St
     C                   EVAL      $CPHU1 = ' '                                 ED Consignee Po
     C                   EVAL      $CABAB = ' '                                 ED Consignee Co
     C                   EVAL      $CPSU1 = ' '                                 Consignor Count
     C                   EVAL      $CPTU1 = ' '                                 Consignee Count
     C                   MOVEL     BEJPCD        $CJPCD                         Event Code
     C                   MOVEL     BEXUST        $CXUST                         Trans Contol AS
     C                   MOVEL     BEZ1ST        $CZ1ST                         Modified Flag
     C                   Z-ADD     BEVRVA        $CVRVA                         A_R order Value
     C                   MOVEL     BEOBST        $COBST                         Billing Activit
     C                   MOVEL     BEBCST        $CBCST                         Block Order Fla
     C                   MOVEL     BEBDST        $CBDST                         Order Certifica
     C                   Z-ADD     BEB7VL        $CB7VL                         Invoice Order V
     C                   MOVEL     BEGASX        $CGASX                         Process Sts for
     C                   MOVEL     BEGBSX        $CGBSX                         Order Conf Fax
     C                   MOVEL     BEGCSX        $CGCSX                         Manifest Fax St
     C                   MOVEL     BEGDSX        $CGDSX                         Invoice Fax Sts
     C                   MOVEL     BEFNSX        $CFNSX                         Transfer in Sto
     C                   MOVEL     BEFOSX        $CFOSX                         Email Cust On O
     C                   MOVEL     BEFPSX        $CFPSX                         Order Emailed
     C                   MOVEL     BEFQSX        $CFQSX                         Export Docs Go
     C                   MOVEL     BEFRSX        $CFRSX                         Shipping Temp C
     C                   MOVEL     BEFSSX        $CFSSX                         Broker Order St
     C                   MOVEL     BEFTSX        $CFTSX                         Air Freight Ord
     C                   MOVEL     BEFUSX        $CFUSX                         Order Requires
     C                   MOVEL     BEFVSX        $CFVSX                         OH Load Plan Re
     C                   MOVEL     BEFWSX        $CFWSX                         Export USDA App
     C                   MOVEL     BEFYSX        $CFYSX                         OH TF Exempt Co
     C                   Z-ADD     BENODT        $CNODT                         OH Appt Confirm
     C                   Z-ADD     BENPDT        $CNPDT                         JPN Invoice Iss
     C                   Z-ADD     BENQDT        $CNQDT                         Load Actual Shi
     C                   Z-ADD     BENRDT        $CNRDT                         Load BOL Comple
     C                   Z-ADD     BENSDT        $CNSDT                         Load Truck Depa
     C                   Z-ADD     BEBPTM        $CBPTM                         Maximum Gross W
     C                   Z-ADD     BEBQTM        $CBQTM                         Time of Origina
     C                   Z-ADD     BEBRTM        $CBRTM                         OH Appt Confirm
     C                   Z-ADD     BEBSTM        $CBSTM                         Load BOL Comple
     C                   Z-ADD     BEBTTM        $CBTTM                         Load Truck Depa
     C                   Z-ADD     BEH0NX        $CH0NX                         Act Frt Referen
     C                   Z-ADD     BEH1NX        $CH1NX                         Act Non_Ref Frt
     C                   Z-ADD     BEH2NX        $CH2NX                         OH Fuel Surchar
     C                   Z-ADD     BEH3NX        $CH3NX                         OH Total Non_Re
     C                   Z-ADD     BEH4NX        $CH4NX                         OH Total Ref Fr
     C                   Z-ADD     BEC0C7        $CC0C7                         Claim Number
      * Load related totals format
     C                   Z-ADD     BEAIC3        #KAIC3                         Company Number
     C                   MOVEL     BERPCD        #KRPCD                         Age Code
     C                   MOVEL     BEVFST        #KVFST                         Shrink Wrap
     C                   MOVEL     BEBCNA        #KBCNA                         Customer Purcha
     C                   EVAL      #KLMT1 = ' '                                 Delivery P_O  N
     C                   Z-ADD     BERMNB        #KRMNB                         Load ID
     C                   MOVEL     BEVEST        #KVEST                         Palletize
     C                   EVAL      #KLZSC = ' '                                 Pallet Type 1
     C                   EVAL      #KL0SC = ' '                                 Pallet Type 2
     C                   EVAL      #KL1SC = ' '                                 Pallet Type 3
     C                   EVAL      #KL2SC = ' '                                 Pallet Type 4
     C                   Z-ADD     BEA5DT        #KA5DT                         Requested Ship
     C                   MOVEL     BEFTSX        #KFTSX                         Air Freight Ord
     C                   MOVEL     BEVGST        #KVGST                         Slip Sheet
     C                   Z-ADD     BEAODT        #KAODT                         Scheduled Ship
     C                   MOVEL     BEVDST        #KVDST                         Load Type
     C                   Z-ADD     BERNNB        #KRNNB                         Reefer Temperat
     C                   Z-ADD     *ZERO         #KPCNX                         USR Temperature
     C                   MOVEL     BEFRSX        #KFRSX                         Shipping Temp C
     C                   Z-ADD     BEEIDT        #KEIDT                         Requested Deliv
     C                   Z-ADD     BEAFTM        #KAFTM                         Requested Deliv
     C                   MOVEL     BEBZNA        #KBZNA                         Carrier Code
     C                   Z-ADD     BEBKC7        #KBKC7                         Ship To Custome
     C                   Z-ADD     BEA0DT        #KA0DT                         Order Date
     C                   MOVEL     BEFNSX        #KFNSX                         Transfer in Sto
     C                   EVAL      #KJDST = ' '                                 USR Check Y/N S
     C                   Z-ADD     BETBNB        #KTBNB                         Absorbed Freigh
     C                   Z-ADD     BEBPTM        #KBPTM                         Maximum Gross W
     C                   EVAL      #KXTST = ' '                                 Status Unused 1
     C                   MOVEL     BEQ2CD        #KQ2CD                         Shipping Method
     C                   MOVEL     BEMHNA        #KMHNA                         Special Comment
     C                   EVAL      #KSTTX = ' '                                 USR Text 7
     C                   Z-ADD     BEGNDT        #KGNDT                         Actual Shipped
     C                   MOVEL     BEB6NA        #KB6NA                         Special Instruc
     C                   MOVEL     BEBYNA        #KBYNA                         Special Instruc
     C                   MOVEL     BEAIVN        #KAIVN                         User Original E
     C                   MOVEL     BEJPCD        #KJPCD                         Event Code
     C                   MOVEL     BEXUST        #KXUST                         Trans Contol AS
     C                   MOVEL     BEZ1ST        #KZ1ST                         Modified Flag
     C                   Z-ADD     BEVRVA        #KVRVA                         A_R order Value
     C                   MOVEL     BEOBST        #KOBST                         Billing Activit
     C                   MOVEL     BEBCST        #KBCST                         Block Order Fla
     C                   MOVEL     BEBDST        #KBDST                         Order Certifica
     C                   Z-ADD     BEB7VL        #KB7VL                         Invoice Order V
     C                   MOVEL     BEGASX        #KGASX                         Process Sts for
     C                   MOVEL     BEGBSX        #KGBSX                         Order Conf Fax
     C                   MOVEL     BEGCSX        #KGCSX                         Manifest Fax St
     C                   MOVEL     BEGDSX        #KGDSX                         Invoice Fax Sts
     C                   MOVEL     BEFOSX        #KFOSX                         Email Cust On O
     C                   MOVEL     BEFPSX        #KFPSX                         Order Emailed
     C                   MOVEL     BEFQSX        #KFQSX                         Export Docs Go
     C                   MOVEL     BEFSSX        #KFSSX                         Broker Order St
     C                   MOVEL     BEFUSX        #KFUSX                         Order Requires
     C                   MOVEL     BEFVSX        #KFVSX                         OH Load Plan Re
     C                   MOVEL     BEFWSX        #KFWSX                         Export USDA App
     C                   MOVEL     BEFXSX        #KFXSX                         HPB Ship to War
     C                   MOVEL     BEFYSX        #KFYSX                         OH TF Exempt Co
     C                   Z-ADD     BENODT        #KNODT                         OH Appt Confirm
     C                   Z-ADD     BENPDT        #KNPDT                         JPN Invoice Iss
     C                   Z-ADD     BENQDT        #KNQDT                         Load Actual Shi
     C                   Z-ADD     BENRDT        #KNRDT                         Load BOL Comple
     C                   Z-ADD     BENSDT        #KNSDT                         Load Truck Depa
     C                   Z-ADD     BEBQTM        #KBQTM                         Time of Origina
     C                   Z-ADD     BEBRTM        #KBRTM                         OH Appt Confirm
     C                   Z-ADD     BEBSTM        #KBSTM                         Load BOL Comple
     C                   Z-ADD     BEBTTM        #KBTTM                         Load Truck Depa
     C                   Z-ADD     BEH0NX        #KH0NX                         Act Frt Referen
     C                   Z-ADD     BEH1NX        #KH1NX                         Act Non_Ref Frt
     C                   Z-ADD     BEH2NX        #KH2NX                         OH Fuel Surchar
     C                   Z-ADD     BEH3NX        #KH3NX                         OH Total Non_Re
     C                   Z-ADD     BEH4NX        #KH4NX                         OH Total Ref Fr
     C                   Z-ADD     BEC0C7        #KC0C7                         Claim Number
      * USER: Process before print of Order Number format
      * CASE: CUR.Order Number NE PAR.Order Number
     C                   IF        $CC4NB <> P1C4NB
     C                   Z-ADD     *ZERO         P6MSNB                         USR Page number
     C                   Z-ADD     $CC4NB        P1C4NB                         Order Number
     C                   END                                                    *FI
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0AP01
     C                   END
      *
      * Signal that format is now ready to print
     C                   IF        W0AL02 = 'Y'
     C                   MOVE      'Y'           W0AP02
     C                   END
      *
      *================================================================
     CSR   A1EXIT        ENDSR
      /EJECT
     CSR   A2PDTL        BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                   Z-ADD     BEAIC3        $DAIC3                         Company Number
     C                   Z-ADD     BEC4NB        $DC4NB                         Order Number
     C                   MOVEL     BEJNCD        $DJNCD                         Order Type_Sale
     C                   EVAL      $DD8NA = ' '                                 USR Company Add
     C                   EVAL      $DCDTX = ' '                                 USR Telephone C
     C                   Z-ADD     *ZERO         $DMSNB                         USR Page number
     C                   EVAL      $DD9NA = ' '                                 USR Company Add
     C                   EVAL      $DHJNA = ' '                                 USR Heading - 8
     C                   Z-ADD     *ZERO         $DG4NB                         USR Reference n
     C                   Z-ADD     *ZERO         $DBQDT                         USR Date - ATR
     C                   MOVEL     BEGWST        $DGWST                         Header Status
     C                   EVAL      $DEANA = ' '                                 USR Company Add
     C                   EVAL      $DEBNA = ' '                                 USR Company Add
     C                   EVAL      $DD4NA = ' '                                 USR Comment 1
     C                   EVAL      $DECNA = ' '                                 USR Company Add
     C                   EVAL      $DD5NA = ' '                                 USR Comment 2
     C                   EVAL      $DD6NA = ' '                                 USR Comment 3
     C                   EVAL      $DHHNA = ' '                                 USR Comment 4
     C                   EVAL      $DJUNA = ' '                                 USR Description
     C                   EVAL      $DGINA = ' '                                 USR Compressed
     C                   EVAL      $DGNNA = ' '                                 USR Compressed
     C                   EVAL      $DGJNA = ' '                                 USR Compressed
     C                   EVAL      $DGONA = ' '                                 USR Compressed
     C                   EVAL      $DGKNA = ' '                                 USR Compressed
     C                   EVAL      $DGPNA = ' '                                 USR Compressed
     C                   EVAL      $DGLNA = ' '                                 USR Compressed
     C                   EVAL      $DGQNA = ' '                                 USR Compressed
     C                   EVAL      $DGMNA = ' '                                 USR Compressed
     C                   EVAL      $DGRNA = ' '                                 USR Compressed
     C                   Z-ADD     BEGNDT        $DGNDT                         Actual Shipped
     C                   Z-ADD     BEAODT        $DAODT                         Scheduled Ship
     C                   Z-ADD     BEEIDT        $DEIDT                         Requested Deliv
     C                   MOVEL     BEJPCD        $DJPCD                         Event Code
     C                   MOVEL     BEXUST        $DXUST                         Trans Contol AS
     C                   MOVEL     BEZ1ST        $DZ1ST                         Modified Flag
     C                   Z-ADD     BEVRVA        $DVRVA                         A_R order Value
     C                   MOVEL     BEOBST        $DOBST                         Billing Activit
     C                   MOVEL     BEBCST        $DBCST                         Block Order Fla
     C                   MOVEL     BEBDST        $DBDST                         Order Certifica
     C                   Z-ADD     BEB7VL        $DB7VL                         Invoice Order V
     C                   MOVEL     BEGASX        $DGASX                         Process Sts for
     C                   MOVEL     BEGBSX        $DGBSX                         Order Conf Fax
     C                   MOVEL     BEGCSX        $DGCSX                         Manifest Fax St
     C                   MOVEL     BEGDSX        $DGDSX                         Invoice Fax Sts
     C                   MOVEL     BEFNSX        $DFNSX                         Transfer in Sto
     C                   MOVEL     BEFOSX        $DFOSX                         Email Cust On O
     C                   MOVEL     BEFPSX        $DFPSX                         Order Emailed
     C                   MOVEL     BEFQSX        $DFQSX                         Export Docs Go
     C                   MOVEL     BEFRSX        $DFRSX                         Shipping Temp C
     C                   MOVEL     BEFSSX        $DFSSX                         Broker Order St
     C                   MOVEL     BEFTSX        $DFTSX                         Air Freight Ord
     C                   MOVEL     BEFUSX        $DFUSX                         Order Requires
     C                   MOVEL     BEFVSX        $DFVSX                         OH Load Plan Re
     C                   MOVEL     BEFWSX        $DFWSX                         Export USDA App
     C                   MOVEL     BEFXSX        $DFXSX                         HPB Ship to War
     C                   MOVEL     BEFYSX        $DFYSX                         OH TF Exempt Co
     C                   Z-ADD     BENODT        $DNODT                         OH Appt Confirm
     C                   Z-ADD     BENPDT        $DNPDT                         JPN Invoice Iss
     C                   Z-ADD     BENQDT        $DNQDT                         Load Actual Shi
     C                   Z-ADD     BENRDT        $DNRDT                         Load BOL Comple
     C                   Z-ADD     BENSDT        $DNSDT                         Load Truck Depa
     C                   Z-ADD     BEBPTM        $DBPTM                         Maximum Gross W
     C                   Z-ADD     BEBQTM        $DBQTM                         Time of Origina
     C                   Z-ADD     BEBRTM        $DBRTM                         OH Appt Confirm
     C                   Z-ADD     BEBSTM        $DBSTM                         Load BOL Comple
     C                   Z-ADD     BEBTTM        $DBTTM                         Load Truck Depa
     C                   Z-ADD     BEH0NX        $DH0NX                         Act Frt Referen
     C                   Z-ADD     BEH1NX        $DH1NX                         Act Non_Ref Frt
     C                   Z-ADD     BEH2NX        $DH2NX                         OH Fuel Surchar
     C                   Z-ADD     BEH3NX        $DH3NX                         OH Total Non_Re
     C                   Z-ADD     BEH4NX        $DH4NX                         OH Total Ref Fr
     C                   Z-ADD     BEC0C7        $DC0C7                         Claim Number
      * USER: Process before print of detail format
     C                   MOVEL     BEBCST        P1BCST                         Block Order Fla
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0APDT
      * Call print routine
     C                   EXSR      Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : PRT Hdr Comment 3/Lne PO
     C                   EXSR      UASUBR                                       Embedded PRTOBJ
      * Embedded PRTOBJ : PRT Hdr Comment 3/Lne PO
     C                   EXSR      UBSUBR                                       Embedded PRTOBJ
      * Embedded PRTOBJ : PRT Hdr Comment 3/Lne PO
     C                   EXSR      UCSUBR                                       Embedded PRTOBJ
      * Embedded PRTOBJ : PRT Hdr Comment 3/Lne PO
     C                   EXSR      UDSUBR                                       Embedded PRTOBJ
      * Embedded PRTOBJ : PRT Ship Inst 3/Line  PO
     C                   EXSR      UESUBR                                       Embedded PRTOBJ
      * Embedded PRTOBJ : Prt Cust Comment PL   PO
     C                   EXSR      UFSUBR                                       Embedded PRTOBJ
      * Embedded PRTOBJ : Prt Country Comment   PO
     C                   EXSR      UGSUBR                                       Embedded PRTOBJ
      * Embedded PRTOBJ : PRT All Orders on Load PO
     C                   EXSR      UHSUBR                                       Embedded PRTOBJ
      * Embedded PRTOBJ : PRT Detail-Acknowledge PO
     C                   EXSR      UISUBR                                       Embedded PRTOBJ
      *
      *================================================================
     CSR   A2EXIT        ENDSR
      /EJECT
     CSR   A3READ        BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C                   Z-ADD     BEAIC3        WZA001
     C                   Z-ADD     BEC4NB        WZA002
     C                   Z-ADD     BEBKC7        WZA003
      * Read next record
     C                   DOU       W0RSL = 'Y' OR
     C                             W0EOFA = '1'
     C                   READ      @BFCPYX                                90    *
      * Transfer error indicator to EOF flag
     C                   MOVEL     *IN90         W0EOFA
      * Quit if no record read
      * Select record unless user action states otherwise
     C                   IF        W0EOFA <> '1'
     C                   MOVEL     'Y'           W0RSL
      * USER: Record selection processing
      * Select passed warehouses
      * CASE: PAR.USR Select/Omit Flag is Select
      * Select only Order Detail records matching warehouse codes passed
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6ORc7ORc8ORc9ORc10
      *   |- c1    : PAR.USR Warehouse Code is Warehouse Code not Blank
      *   |- c2    : PAR.USR CDE Parm 1 is Warehouse Code not Blank
      *   |- c3    : PAR.USR CDE Parm 2 is Warehouse Code not Blank
      *   |- c4    : PAR.USR CDE Parm 3 is Warehouse Code not Blank
      *   |- c5    : PAR.USR CDE Parm 4 is Warehouse Code not Blank
      *   |- c6    : PAR.USR CDE Parm 5 is Warehouse Code not Blank
      *   |- c7    : PAR.USR CDE Parm 6 is Warehouse Code not Blank
      *   |- c8    : PAR.USR CDE Parm 7 is Warehouse Code not Blank
      *   |- c9    : PAR.USR CDE Parm 8 is Warehouse Code not Blank
      *   |- c10   : PAR.USR CDE Parm 9 is Warehouse Code not Blank
      *   '-
     C                   IF        P9CYST = 'S'
     C                   IF        P9CPCD <> ' ' OR
     C                             P9VSCD <> ' ' OR
     C                             P9VTCD <> ' ' OR
     C                             P9VUCD <> ' ' OR
     C                             P9VVCD <> ' ' OR
     C                             P9VWCD <> ' ' OR
     C                             P9VXCD <> ' ' OR
     C                             P9VYCD <> ' ' OR
     C                             P9VZCD <> ' ' OR
     C                             P9V0CD <> ' '
     C                   MOVEL     'N'           WUDJST                         Select Status
      * Check warehouse 1
      * CASE: PAR.USR Warehouse Code is Warehouse Code not Blank
      * RTV Check Warehouse    RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                   IF        P9CPCD <> ' '
     C                   Z-ADD     BEAIC3        WL0051                         Company Number
     C                   Z-ADD     BEC4NB        WL0052                         Order Number
     C                   MOVEL(P)  P9CPCD        WL0053                         Warehouse Code
     C                   MOVEL(P)  WUDJST        WL0054                         Select Status
     C                   EXSR      SZRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0054        WUDJST                         Select Status
     C                   END                                                    *FI
      * Check warehouse 2
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.USR CDE Parm 1 is Warehouse Code not Blank
      *   |- c2    : WRK.Select Status is no
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        P9VSCD <> ' '
     C                   IF        WUDJST = 'N'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
      * RTV Check Warehouse    RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                   IF        Y0CX01 = '1'
     C                   Z-ADD     BEAIC3        WL0051                         Company Number
     C                   Z-ADD     BEC4NB        WL0052                         Order Number
     C                   MOVEL(P)  P9VSCD        WL0053                         Warehouse Code
     C                   MOVEL(P)  WUDJST        WL0054                         Select Status
     C                   EXSR      SZRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0054        WUDJST                         Select Status
     C                   END                                                    *FI
      * Check warehouse 3
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.USR CDE Parm 2 is Warehouse Code not Blank
      *   |- c2    : WRK.Select Status is no
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        P9VTCD <> ' '
     C                   IF        WUDJST = 'N'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
      * RTV Check Warehouse    RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                   IF        Y0CX01 = '1'
     C                   Z-ADD     BEAIC3        WL0051                         Company Number
     C                   Z-ADD     BEC4NB        WL0052                         Order Number
     C                   MOVEL(P)  P9VTCD        WL0053                         Warehouse Code
     C                   MOVEL(P)  WUDJST        WL0054                         Select Status
     C                   EXSR      SZRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0054        WUDJST                         Select Status
     C                   END                                                    *FI
      * Check warehouse 4
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.USR CDE Parm 3 is Warehouse Code not Blank
      *   |- c2    : WRK.Select Status is no
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        P9VUCD <> ' '
     C                   IF        WUDJST = 'N'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
      * RTV Check Warehouse    RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                   IF        Y0CX01 = '1'
     C                   Z-ADD     BEAIC3        WL0051                         Company Number
     C                   Z-ADD     BEC4NB        WL0052                         Order Number
     C                   MOVEL(P)  P9VUCD        WL0053                         Warehouse Code
     C                   MOVEL(P)  WUDJST        WL0054                         Select Status
     C                   EXSR      SZRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0054        WUDJST                         Select Status
     C                   END                                                    *FI
      * Check warehouse 5
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.USR CDE Parm 4 is Warehouse Code not Blank
      *   |- c2    : WRK.Select Status is no
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        P9VVCD <> ' '
     C                   IF        WUDJST = 'N'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
      * RTV Check Warehouse    RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                   IF        Y0CX01 = '1'
     C                   Z-ADD     BEAIC3        WL0051                         Company Number
     C                   Z-ADD     BEC4NB        WL0052                         Order Number
     C                   MOVEL(P)  P9VVCD        WL0053                         Warehouse Code
     C                   MOVEL(P)  WUDJST        WL0054                         Select Status
     C                   EXSR      SZRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0054        WUDJST                         Select Status
     C                   END                                                    *FI
      * Check warehouse 6
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.USR CDE Parm 5 is Warehouse Code not Blank
      *   |- c2    : WRK.Select Status is no
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        P9VWCD <> ' '
     C                   IF        WUDJST = 'N'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
      * RTV Check Warehouse    RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                   IF        Y0CX01 = '1'
     C                   Z-ADD     BEAIC3        WL0051                         Company Number
     C                   Z-ADD     BEC4NB        WL0052                         Order Number
     C                   MOVEL(P)  P9VWCD        WL0053                         Warehouse Code
     C                   MOVEL(P)  WUDJST        WL0054                         Select Status
     C                   EXSR      SZRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0054        WUDJST                         Select Status
     C                   END                                                    *FI
      * Check warehouse 7
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.USR CDE Parm 6 is Warehouse Code not Blank
      *   |- c2    : WRK.Select Status is no
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        P9VXCD <> ' '
     C                   IF        WUDJST = 'N'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
      * RTV Check Warehouse    RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                   IF        Y0CX01 = '1'
     C                   Z-ADD     BEAIC3        WL0051                         Company Number
     C                   Z-ADD     BEC4NB        WL0052                         Order Number
     C                   MOVEL(P)  P9VXCD        WL0053                         Warehouse Code
     C                   MOVEL(P)  WUDJST        WL0054                         Select Status
     C                   EXSR      SZRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0054        WUDJST                         Select Status
     C                   END                                                    *FI
      * Check warehouse 8
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.USR CDE Parm 7 is Warehouse Code not Blank
      *   |- c2    : WRK.Select Status is no
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        P9VYCD <> ' '
     C                   IF        WUDJST = 'N'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
      * RTV Check Warehouse    RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                   IF        Y0CX01 = '1'
     C                   Z-ADD     BEAIC3        WL0051                         Company Number
     C                   Z-ADD     BEC4NB        WL0052                         Order Number
     C                   MOVEL(P)  P9VYCD        WL0053                         Warehouse Code
     C                   MOVEL(P)  WUDJST        WL0054                         Select Status
     C                   EXSR      SZRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0054        WUDJST                         Select Status
     C                   END                                                    *FI
      * Check warehouse 9
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.USR CDE Parm 8 is Warehouse Code not Blank
      *   |- c2    : WRK.Select Status is no
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        P9VZCD <> ' '
     C                   IF        WUDJST = 'N'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
      * RTV Check Warehouse    RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                   IF        Y0CX01 = '1'
     C                   Z-ADD     BEAIC3        WL0051                         Company Number
     C                   Z-ADD     BEC4NB        WL0052                         Order Number
     C                   MOVEL(P)  P9VZCD        WL0053                         Warehouse Code
     C                   MOVEL(P)  WUDJST        WL0054                         Select Status
     C                   EXSR      SZRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0054        WUDJST                         Select Status
     C                   END                                                    *FI
      * Check warehouse 10
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.USR CDE Parm 9 is Warehouse Code not Blank
      *   |- c2    : WRK.Select Status is no
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        P9V0CD <> ' '
     C                   IF        WUDJST = 'N'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
      * RTV Check Warehouse    RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                   IF        Y0CX01 = '1'
     C                   Z-ADD     BEAIC3        WL0051                         Company Number
     C                   Z-ADD     BEC4NB        WL0052                         Order Number
     C                   MOVEL(P)  P9V0CD        WL0053                         Warehouse Code
     C                   MOVEL(P)  WUDJST        WL0054                         Select Status
     C                   EXSR      SZRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0054        WUDJST                         Select Status
     C                   END                                                    *FI
      * If select status is no then do not select record
      * CASE: WRK.Select Status is no
     C                   IF        WUDJST = 'N'
     C                   MOVEL     'N'           W0RSL                          *Record selecte
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Omit passed warehouses
      * CASE: PAR.USR Select/Omit Flag is Omit
      * Omit any Order Detail records matching warehouse codes passed in
      * Get the warehouse from the first order detail record
      * C2748:  Changed RTV Warehouse Code RT to exclude Cancelled lines.
      * RTV Warehouse code     RT - PD Order Detail  * 
     C                   IF        P9CYST = 'O'
     C                   EXSR      TARVGN
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6ORc7ORc8ORc9ORc10
      *   |- c1    : PAR.USR Warehouse Code is Warehouse Code not Blank
      *   |- c2    : PAR.USR CDE Parm 1 is Warehouse Code not Blank
      *   |- c3    : PAR.USR CDE Parm 2 is Warehouse Code not Blank
      *   |- c4    : PAR.USR CDE Parm 3 is Warehouse Code not Blank
      *   |- c5    : PAR.USR CDE Parm 4 is Warehouse Code not Blank
      *   |- c6    : PAR.USR CDE Parm 5 is Warehouse Code not Blank
      *   |- c7    : PAR.USR CDE Parm 6 is Warehouse Code not Blank
      *   |- c8    : PAR.USR CDE Parm 7 is Warehouse Code not Blank
      *   |- c9    : PAR.USR CDE Parm 8 is Warehouse Code not Blank
      *   |- c10   : PAR.USR CDE Parm 9 is Warehouse Code not Blank
      *   '-
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6ORc7ORc8ORc9ORc10
      *   |- c1    : PAR.USR Warehouse Code EQ WRK.Warehouse Code
      *   |- c2    : PAR.USR CDE Parm 1 EQ WRK.Warehouse Code
      *   |- c3    : PAR.USR CDE Parm 2 EQ WRK.Warehouse Code
      *   |- c4    : PAR.USR CDE Parm 3 EQ WRK.Warehouse Code
      *   |- c5    : PAR.USR CDE Parm 4 EQ WRK.Warehouse Code
      *   |- c6    : PAR.USR CDE Parm 5 EQ WRK.Warehouse Code
      *   |- c7    : PAR.USR CDE Parm 6 EQ WRK.Warehouse Code
      *   |- c8    : PAR.USR CDE Parm 7 EQ WRK.Warehouse Code
      *   |- c9    : PAR.USR CDE Parm 8 EQ WRK.Warehouse Code
      *   |- c10   : PAR.USR CDE Parm 9 EQ WRK.Warehouse Code
      *   '-
     C                   IF        P9CPCD <> ' ' OR
     C                             P9VSCD <> ' ' OR
     C                             P9VTCD <> ' ' OR
     C                             P9VUCD <> ' ' OR
     C                             P9VVCD <> ' ' OR
     C                             P9VWCD <> ' ' OR
     C                             P9VXCD <> ' ' OR
     C                             P9VYCD <> ' ' OR
     C                             P9VZCD <> ' ' OR
     C                             P9V0CD <> ' '
     C                   IF        P9CPCD = WUAJCD OR
     C                             P9VSCD = WUAJCD OR
     C                             P9VTCD = WUAJCD OR
     C                             P9VUCD = WUAJCD OR
     C                             P9VVCD = WUAJCD OR
     C                             P9VWCD = WUAJCD OR
     C                             P9VXCD = WUAJCD OR
     C                             P9VYCD = WUAJCD OR
     C                             P9VZCD = WUAJCD OR
     C                             P9V0CD = WUAJCD
     C                   MOVEL     'N'           W0RSL                          *Record selecte
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Exclude cancelled orders
      * CASE: DB1.Header Status is Not eligible for acks.
     C                   IF        BEGWST = 'X'
     C                   MOVEL     'N'           W0RSL                          *Record selecte
     C                   END                                                    *FI
      * Exclude by billing activity type (Where came from)
      * CASE: PGM.*Record selected is *YES
      * Exclude by billing activity type
      * CASE: PAR.Billing Activity Type EQ WRK.BLANK
     C                   IF        W0RSL = 'Y'
      * (include only credit and debit memos)
      * Exclude invoice/transfer types
      * CASE: DB1.Billing Activity Type is Invoice or Transfer
     C                   IF        P7OBST = WUGSTX
     C                   IF        BEOBST = '1' OR
     C                             BEOBST = '4'
     C                   MOVEL     'N'           W0RSL                          *Record selecte
     C                   END                                                    *FI
     C                   ELSE
      * CASE: PAR.Billing Activity Type is Invoice
      * (include invoice and transfer)
      * Exclude Credit/Debit memo types
      * CASE: DB1.Billing Activity Type is Credit or Debit Memo
     C                   IF        P7OBST = '1'
     C                   IF        BEOBST = '2' OR
     C                             BEOBST = '3'
     C                   MOVEL     'N'           W0RSL                          *Record selecte
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
      * (include only credit OR debit memo)
      * Exclude non matching billing activity type
      * CASE: DB1.Billing Activity Type NE PAR.Billing Activity Type
     C                   IF        BEOBST <> P7OBST
     C                   MOVEL     'N'           W0RSL                          *Record selecte
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * S029516 - Added call to function to get Salesperson email address
      * CASE: PGM.*Record selected is *YES
      * Rtv Eml addr w/rte cd  IF
      * RTV Salesman Code      RT - Sales Route  * 
      * Move input parameters to subroutine local variables.
     C                   IF        W0RSL = 'Y'
     C                   MOVEL(P)  BER4CD        WL0055                         Sales Route Cod
     C                   EXSR      TBRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0056        YL0027                         Salesperson Cod
      * Rtv Email/EDI Sts 3    RT - Salesperson Electronic CM  * 
      * Move input parameters to subroutine local variables.
     C                   MOVEL(P)  YL0027        WL0057                         Salesperson Cod
     C                   EXSR      TCRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0058        P9YAU1                         Email Address
     C                   MOVEL(P)  WL0059        YN0018                         EDI Status 3
     C                   END                                                    *FI
     C                   END                                                    FI
     C                   END                                                    UOD
      *
      * Reset key level breaks
     C                   EVAL      W0AL00 = ' '                                 Company Number
     C                   EVAL      W0AL01 = ' '                                 Order Number
     C                   EVAL      W0AL02 = ' '                                 Ship To Custome
      * End of file - Signal all level breaks
     C                   IF        W0EOFA = '1'
     C                   MOVEL     'Y'           W0AL00                         Company Number
     C                   MOVEL     'Y'           W0AL01                         Order Number
     C                   MOVEL     'Y'           W0AL02                         Ship To Custome
     C                   ELSE
      * Next record - Detect level breaks
      * Set on level break indicator
     C                   IF        BEAIC3 <> WZA001
     C                   MOVEL     'Y'           W0AL00
     C                   END
      * Set on level break indicator
     C                   IF        BEC4NB <> WZA002 OR
     C                             W0AL00 = 'Y'
     C                   MOVEL     'Y'           W0AL01
     C                   END
      * Set on level break indicator
     C                   IF        BEBKC7 <> WZA003 OR
     C                             W0AL01 = 'Y'
     C                   MOVEL     'Y'           W0AL02
     C                   END
     C                   END
      *================================================================
     CSR   A3EXIT        ENDSR
      /EJECT
     CSR   A4PTOT        BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
      * Signal header format is no longer ready
     C                   IF        W0AL02 = 'Y'
     C                   EVAL      W0AP02 = ' '
     C                   END
      *
     C                   IF        W0AL01 = 'Y'
     C                   MOVEL     'Y'           W0PFM
      * USER: On print of Order Number format
     C                   Z-ADD     #KRNNB        #KPCNX                         USR Temperature
      * check shipping method
      * CASE: CUR.Shipping Method is Buyers Truck
     C                   IF        #KQ2CD = 'CT'
     C                   MOVEL     'Y'           #KJDST                         USR Check Y/N S
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'N'           #KJDST                         USR Check Y/N S
     C                   END                                                    *FI
      * Load "Order Certification" descriptor.
      * CASE: PAR.Order Certification Flag is Yes
     C                   IF        P1BDST = 'Y'
     C                   MOVEL     @CN(015)      #KSTTX                         USR Text 7
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      #KSTTX = ' '                                 USR Text 7
     C                   END                                                    *FI
      * OMS336 - Phase I
      * RTV Combo for P & T    RT - Order Header TRG  * 
     C                   EXSR      TDRVGN
     C                   MOVEL     'N'           #KXTST                         Status Unused 1
      * check combos   after 6/30/21  RMC W80897
      * CASE: WRK.Palletize             USR is not no
     C                   IF        WUIHSX = ' ' OR
     C                             WUIHSX = 'Y'
     C                   MOVEL     'Y'           #KXTST                         Status Unused 1
     C                   END                                                    *FI
      * ** Get booking number from OHE not Load Header   05/11/2007 LJB F
      * RTV OHE Ship fields    RT - Order Header Extension  * 
     C                   EXSR      TGRVGN
      * ** Retrieve delivery po from OHE file            01/15/2009 LJB F
      * RTV OHE Delivery PO #  RT - Order Header Extension  * 
     C                   EXSR      THRVGN
      * ** Retrieve Print Req Delv Tm on docs            02/16/2011 RMC E
      * Rtv Print Req Delv Tm RT - Company Customer EXT  * 
     C                   EXSR      TIRVGN
      * If Palletize is yes, get Pallet Type description
      * CASE: CUR.Palletize is yes
      * WI464 DN 03/31/22-Get Pallet Type from O.D. file. Order not shipp
      * Rtv Unique Pallet Type RT - Order Detail  * 
     C                   IF        #KVEST = 'Y'
     C                   EXSR      TJRVGN
     C                   END                                                    *FI
      * If we are already passed the nominated
      * Start line for this format
     C                   IF        W0PFM = 'Y'
      * Signal new page required
     C                   IF        @$CLN >= 73
     C                   MOVE      'Y'           W0NEWP
      * Start new page
     C                   EXSR      Q0PRNT
     C                   END
      * Convert fields to external form
      * Convert Requested Ship Date to display format
      * Convert date
     C     1000000       ADD       #KA5DT        XDINDT
     C                   EXSR      XDVC2T
     C                   Z-ADD     XDEXDT        VKA5DT
      * Convert Scheduled Ship Date to display format
      * Convert date
     C     1000000       ADD       #KAODT        XDINDT
     C                   EXSR      XDVC2T
     C                   Z-ADD     XDEXDT        VKAODT
      * Convert Requested Delivery Date to display format
      * Convert date
     C     1000000       ADD       #KEIDT        XDINDT
     C                   EXSR      XDVC2T
     C                   Z-ADD     XDEXDT        VKEIDT
      * Convert Order Date to display format
      * Convert date
     C     1000000       ADD       #KA0DT        XDINDT
     C                   EXSR      XDVC2T
     C                   Z-ADD     XDEXDT        VKA0DT
     C                   MOVEL     '0'           *IN79
     C                   IF        YL0042 = 'N'
     C                   MOVEL     '1'           *IN79
     C                   END                                                    *FI
     C                   MOVEL     '0'           *IN78
     C                   IF        WUU2ST = 'N'
     C                   MOVEL     '1'           *IN78
     C                   END                                                    *FI
     C                   MOVEL     '0'           *IN77
     C                   IF        P1FQSX = 'N'
     C                   MOVEL     '1'           *IN77
     C                   END                                                    *FI
      * Print format
     C                   WRITE     #KKEYTTL
     C                   END
      * Signal header format is no longer ready
     C                   EVAL      W0AP01 = ' '
     C                   END
      *
      * Signal header format is no longer ready
     C                   IF        W0AL00 = 'Y'
     C                   EVAL      W0AP00 = ' '
     C                   END
      *
     C                   IF        W0EOFA = '1'
     C                   END
      *
      *================================================================
     CSR   A4EXIT        ENDSR
      /EJECT
     CSR   B0MAIN        BEGSR
      *================================================================
      * PRT Hdr Comment 3/Lne PO: Mainline
      *================================================================
      * PRT Hdr Comment 3/Lne PO: Initialise
     C                   EXSR      ZBINIT
      * Declare restrictor key work fields
      * Define keylist
     C     KPSB          KLIST
     C                   KFLD                    WQKB01                         Company Number
     C                   KFLD                    WQKB02                         Order Number
     C                   KFLD                    WQKB03                         Comment Type
     C                   KFLD                    CODXNB                         Sequence Number
      * Define keylist
     C     KRSB          KLIST
     C                   KFLD                    WQKB01                         Company Number
     C                   KFLD                    WQKB02                         Order Number
     C                   KFLD                    WQKB03                         Comment Type
      * Setup key
     C                   Z-ADD     $DAIC3        WQKB01                         Company Number
     C                   Z-ADD     $DC4NB        WQKB02                         Order Number
     C                   MOVEL     'PS'          WQKB03                         Comment Type
     C                   Z-ADD     *ZERO         CODXNB                         Sequence Number
      * Establish starting position
     C     KPSB          SETLL     @COCPNU                                      *
      * Read first record with user selection
     C                   EXSR      B3READ
     C                   IF        W0EOFB <> '0'
     C                   ELSE
      * Request all headings
     C                   MOVEL     'Y'           W0BL1P                         First page
     C                   MOVEL     'Y'           W0BL00                         Company Number
     C                   MOVEL     'Y'           W0BL01                         Order Number
     C                   MOVEL     'Y'           W0BL02                         Comment Type
      * Set column headings flag
     C                   MOVE      'Y'           W0BCDT
      * Print report body
      * Prepare heading formats for printing
     C                   DOW       W0EOFB = '0'
     C                   EXSR      B1PHDR
      * Print report detail line
     C                   EXSR      B2PDTL
      * Read next record with user selection
     C                   EXSR      B3READ
      * Print totals
     C                   EXSR      B4PTOT
     C                   END                                                    WOD
     C                   END                                                    FI
      *================================================================
     CSR   B0EXIT        ENDSR
      /EJECT
     CSR   B1PHDR        BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
      * Signal that format is now ready to print
     C                   IF        W0BL1P = 'Y'
     C                   MOVE      'Y'           W0BP1P
     C                   END
      *
      * Signal that format is now ready to print
     C                   IF        W0BL00 = 'Y'
     C                   MOVE      'Y'           W0BP00
     C                   END
      *
      * Signal that format is now ready to print
     C                   IF        W0BL01 = 'Y'
     C                   MOVE      'Y'           W0BP01
     C                   END
      *
      * Load key header format
     C                   IF        W0BL02 = 'Y'
     C                   Z-ADD     COAIC3        $EAIC3                         Company Number
     C                   Z-ADD     COC4NB        $EC4NB                         Order Number
     C                   MOVEL     COI1SX        $EI1SX                         Comment Type
     C                   EVAL      $EHLTX = ' '                                 Condition Desc.
     C                   EVAL      $ESHTX = ' '                                 Text USR 40
      * Load related totals format
     C                   EVAL      $GOPT1 = ' '                                 Text 93 USR
     C                   Z-ADD     COAIC3        $GAIC3                         Company Number
     C                   Z-ADD     COC4NB        $GC4NB                         Order Number
     C                   MOVEL     COI1SX        $GI1SX                         Comment Type
      * USER: Process before print of Comment Type format
      * Get the text definition of the Comment type for Heading SAZ 2/8/0
      * CUR.Text USR 40 = Condition name of CUR.Comment Type
     C                   CALL      'CARVC2R'                            90      *
     C                   PARM                    W0RTN
     C                   PARM      1603273       Y2LSNO                         List number
     C                   PARM      $EI1SX        W0INVL                         Comment Type
     C                   PARM      ' '           W0VLMP                         Value mapped
     C     $ESHTX        PARM                    W0CNNM                         Text USR 40
      *
     C                   Z-ADD     1             ZQ
     C     $ESHTX        CAT(P)    @CN(014):ZQ   $ESHTX                         Text USR 40
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0BP02
     C                   END
      *
      *================================================================
     CSR   B1EXIT        ENDSR
      /EJECT
     CSR   B2PDTL        BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                   Z-ADD     COAIC3        $FAIC3                         Company Number
     C                   Z-ADD     COC4NB        $FC4NB                         Order Number
     C                   MOVEL     COI1SX        $FI1SX                         Comment Type
     C                   MOVEL     COG4NA        $FG4NA                         Comment Text
     C                   EVAL      $FOPT1 = ' '                                 Text 93 USR
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0BPDT
      * Call print routine
     C                   EXSR      Q0PRNT
      *
      *================================================================
     CSR   B2EXIT        ENDSR
      /EJECT
     CSR   B3READ        BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C                   Z-ADD     COAIC3        WZB001
     C                   Z-ADD     COC4NB        WZB002
     C                   MOVEL     COI1SX        WZB003
      * Read next record
     C                   DOU       W0RSL = 'Y' OR
     C                             W0EOFB = '1'
     C     KRSB          READE     @COCPNU                                90    *
      * Transfer error indicator to EOF flag
     C                   MOVEL     *IN90         W0EOFB
      * Quit if no record read
      * Select record unless user action states otherwise
     C                   IF        W0EOFB <> '1'
     C                   MOVEL     'Y'           W0RSL
     C                   END                                                    FI
     C                   END                                                    UOD
      *
      * Reset key level breaks
     C                   EVAL      W0BL00 = ' '                                 Company Number
     C                   EVAL      W0BL01 = ' '                                 Order Number
     C                   EVAL      W0BL02 = ' '                                 Comment Type
      * End of file - Signal all level breaks
     C                   IF        W0EOFB = '1'
     C                   MOVEL     'Y'           W0BL00                         Company Number
     C                   MOVEL     'Y'           W0BL01                         Order Number
     C                   MOVEL     'Y'           W0BL02                         Comment Type
     C                   ELSE
      * Next record - Detect level breaks
      * Set on level break indicator
     C                   IF        COAIC3 <> WZB001
     C                   MOVEL     'Y'           W0BL00
     C                   END
      * Set on level break indicator
     C                   IF        COC4NB <> WZB002 OR
     C                             W0BL00 = 'Y'
     C                   MOVEL     'Y'           W0BL01
     C                   END
      * Set on level break indicator
     C                   IF        COI1SX <> WZB003 OR
     C                             W0BL01 = 'Y'
     C                   MOVEL     'Y'           W0BL02
     C                   END
     C                   END
      *================================================================
     CSR   B3EXIT        ENDSR
      /EJECT
     CSR   B4PTOT        BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C                   IF        W0BL02 = 'Y'
     C                   MOVEL     'Y'           W0PFM
      * USER: On print of Comment Type format
      * CASE: LCL.Count USR is NE 3
     C                   IF        YL0008 <> 3
     C                   MOVEL     YL0009        $GOPT1                         Text 93 USR
     C                   Z-ADD     *ZERO         YL0008                         Count USR
     C                   EVAL      YL0009 = ' '                                 Text 93 USR
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'N'           W0PFM                          *Print format
     C                   END                                                    *FI
      * If there is not enough space on the
      * physical page for this format:
     C                   IF        W0PFM = 'Y'
     C     @$PGL         SUB       @$CLN         @$WRK
      * Signal new page required
     C                   IF        @$WRK <= 1
     C                   MOVE      'Y'           W0NEWP
      * Start new page
     C                   EXSR      Q0PRNT
     C                   END
      * Print format
     C                   WRITE     $GKEYTTL
     C                   END
      * Signal header format is no longer ready
     C                   EVAL      W0BP02 = ' '
     C                   END
      *
      * Signal header format is no longer ready
     C                   IF        W0BL01 = 'Y'
     C                   EVAL      W0BP01 = ' '
     C                   END
      *
      * Signal header format is no longer ready
     C                   IF        W0BL00 = 'Y'
     C                   EVAL      W0BP00 = ' '
     C                   END
      *
     C                   IF        W0EOFB = '1'
     C                   END
      *
      *================================================================
     CSR   B4EXIT        ENDSR
      /EJECT
     CSR   C0MAIN        BEGSR
      *================================================================
      * PRT Hdr Comment 3/Lne PO: Mainline
      *================================================================
      * PRT Hdr Comment 3/Lne PO: Initialise
     C                   EXSR      ZCINIT
      * Declare restrictor key work fields
      * Define keylist
     C     KPSC          KLIST
     C                   KFLD                    WQKC01                         Company Number
     C                   KFLD                    WQKC02                         Order Number
     C                   KFLD                    WQKC03                         Comment Type
     C                   KFLD                    CODXNB                         Sequence Number
      * Define keylist
     C     KRSC          KLIST
     C                   KFLD                    WQKC01                         Company Number
     C                   KFLD                    WQKC02                         Order Number
     C                   KFLD                    WQKC03                         Comment Type
      * Setup key
     C                   Z-ADD     $DAIC3        WQKC01                         Company Number
     C                   Z-ADD     $DC4NB        WQKC02                         Order Number
     C                   MOVEL     'PI'          WQKC03                         Comment Type
     C                   Z-ADD     *ZERO         CODXNB                         Sequence Number
      * Establish starting position
     C     KPSC          SETLL     @COCPNU                                      *
      * Read first record with user selection
     C                   EXSR      C3READ
     C                   IF        W0EOFC <> '0'
     C                   ELSE
      * Request all headings
     C                   MOVEL     'Y'           W0CL1P                         First page
     C                   MOVEL     'Y'           W0CL00                         Company Number
     C                   MOVEL     'Y'           W0CL01                         Order Number
     C                   MOVEL     'Y'           W0CL02                         Comment Type
      * Set column headings flag
     C                   MOVE      'Y'           W0CCDT
      * Print report body
      * Prepare heading formats for printing
     C                   DOW       W0EOFC = '0'
     C                   EXSR      C1PHDR
      * Print report detail line
     C                   EXSR      C2PDTL
      * Read next record with user selection
     C                   EXSR      C3READ
      * Print totals
     C                   EXSR      C4PTOT
     C                   END                                                    WOD
     C                   END                                                    FI
      *================================================================
     CSR   C0EXIT        ENDSR
      /EJECT
     CSR   C1PHDR        BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
      * Signal that format is now ready to print
     C                   IF        W0CL1P = 'Y'
     C                   MOVE      'Y'           W0CP1P
     C                   END
      *
      * Signal that format is now ready to print
     C                   IF        W0CL00 = 'Y'
     C                   MOVE      'Y'           W0CP00
     C                   END
      *
      * Signal that format is now ready to print
     C                   IF        W0CL01 = 'Y'
     C                   MOVE      'Y'           W0CP01
     C                   END
      *
      * Load key header format
     C                   IF        W0CL02 = 'Y'
     C                   Z-ADD     COAIC3        $HAIC3                         Company Number
     C                   Z-ADD     COC4NB        $HC4NB                         Order Number
     C                   MOVEL     COI1SX        $HI1SX                         Comment Type
     C                   EVAL      $HHLTX = ' '                                 Condition Desc.
     C                   EVAL      $HSHTX = ' '                                 Text USR 40
      * Load related totals format
     C                   EVAL      $JOPT1 = ' '                                 Text 93 USR
     C                   Z-ADD     COAIC3        $JAIC3                         Company Number
     C                   Z-ADD     COC4NB        $JC4NB                         Order Number
     C                   MOVEL     COI1SX        $JI1SX                         Comment Type
      * USER: Process before print of Comment Type format
      * Get the text definition of the Comment type for Heading SAZ 2/8/0
      * CUR.Text USR 40 = Condition name of CUR.Comment Type
     C                   CALL      'CARVC2R'                            90      *
     C                   PARM                    W0RTN
     C                   PARM      1603273       Y2LSNO                         List number
     C                   PARM      $HI1SX        W0INVL                         Comment Type
     C                   PARM      ' '           W0VLMP                         Value mapped
     C     $HSHTX        PARM                    W0CNNM                         Text USR 40
      *
     C                   Z-ADD     1             ZQ
     C     $HSHTX        CAT(P)    @CN(014):ZQ   $HSHTX                         Text USR 40
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0CP02
     C                   END
      *
      *================================================================
     CSR   C1EXIT        ENDSR
      /EJECT
     CSR   C2PDTL        BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                   Z-ADD     COAIC3        $IAIC3                         Company Number
     C                   Z-ADD     COC4NB        $IC4NB                         Order Number
     C                   MOVEL     COI1SX        $II1SX                         Comment Type
     C                   MOVEL     COG4NA        $IG4NA                         Comment Text
     C                   EVAL      $IOPT1 = ' '                                 Text 93 USR
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0CPDT
      * Call print routine
     C                   EXSR      Q0PRNT
      *
      *================================================================
     CSR   C2EXIT        ENDSR
      /EJECT
     CSR   C3READ        BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C                   Z-ADD     COAIC3        WZC001
     C                   Z-ADD     COC4NB        WZC002
     C                   MOVEL     COI1SX        WZC003
      * Read next record
     C                   DOU       W0RSL = 'Y' OR
     C                             W0EOFC = '1'
     C     KRSC          READE     @COCPNU                                90    *
      * Transfer error indicator to EOF flag
     C                   MOVEL     *IN90         W0EOFC
      * Quit if no record read
      * Select record unless user action states otherwise
     C                   IF        W0EOFC <> '1'
     C                   MOVEL     'Y'           W0RSL
     C                   END                                                    FI
     C                   END                                                    UOD
      *
      * Reset key level breaks
     C                   EVAL      W0CL00 = ' '                                 Company Number
     C                   EVAL      W0CL01 = ' '                                 Order Number
     C                   EVAL      W0CL02 = ' '                                 Comment Type
      * End of file - Signal all level breaks
     C                   IF        W0EOFC = '1'
     C                   MOVEL     'Y'           W0CL00                         Company Number
     C                   MOVEL     'Y'           W0CL01                         Order Number
     C                   MOVEL     'Y'           W0CL02                         Comment Type
     C                   ELSE
      * Next record - Detect level breaks
      * Set on level break indicator
     C                   IF        COAIC3 <> WZC001
     C                   MOVEL     'Y'           W0CL00
     C                   END
      * Set on level break indicator
     C                   IF        COC4NB <> WZC002 OR
     C                             W0CL00 = 'Y'
     C                   MOVEL     'Y'           W0CL01
     C                   END
      * Set on level break indicator
     C                   IF        COI1SX <> WZC003 OR
     C                             W0CL01 = 'Y'
     C                   MOVEL     'Y'           W0CL02
     C                   END
     C                   END
      *================================================================
     CSR   C3EXIT        ENDSR
      /EJECT
     CSR   C4PTOT        BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C                   IF        W0CL02 = 'Y'
     C                   MOVEL     'Y'           W0PFM
      * USER: On print of Comment Type format
      * CASE: LCL.Count USR is NE 3
     C                   IF        YL0008 <> 3
     C                   MOVEL     YL0009        $JOPT1                         Text 93 USR
     C                   Z-ADD     *ZERO         YL0008                         Count USR
     C                   EVAL      YL0009 = ' '                                 Text 93 USR
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'N'           W0PFM                          *Print format
     C                   END                                                    *FI
      * If there is not enough space on the
      * physical page for this format:
     C                   IF        W0PFM = 'Y'
     C     @$PGL         SUB       @$CLN         @$WRK
      * Signal new page required
     C                   IF        @$WRK <= 1
     C                   MOVE      'Y'           W0NEWP
      * Start new page
     C                   EXSR      Q0PRNT
     C                   END
      * Print format
     C                   WRITE     $JKEYTTL
     C                   END
      * Signal header format is no longer ready
     C                   EVAL      W0CP02 = ' '
     C                   END
      *
      * Signal header format is no longer ready
     C                   IF        W0CL01 = 'Y'
     C                   EVAL      W0CP01 = ' '
     C                   END
      *
      * Signal header format is no longer ready
     C                   IF        W0CL00 = 'Y'
     C                   EVAL      W0CP00 = ' '
     C                   END
      *
     C                   IF        W0EOFC = '1'
     C                   END
      *
      *================================================================
     CSR   C4EXIT        ENDSR
      /EJECT
     CSR   D0MAIN        BEGSR
      *================================================================
      * PRT Hdr Comment 3/Lne PO: Mainline
      *================================================================
      * PRT Hdr Comment 3/Lne PO: Initialise
     C                   EXSR      ZDINIT
      * Declare restrictor key work fields
      * Define keylist
     C     KPSD          KLIST
     C                   KFLD                    WQKD01                         Company Number
     C                   KFLD                    WQKD02                         Order Number
     C                   KFLD                    WQKD03                         Comment Type
     C                   KFLD                    CODXNB                         Sequence Number
      * Define keylist
     C     KRSD          KLIST
     C                   KFLD                    WQKD01                         Company Number
     C                   KFLD                    WQKD02                         Order Number
     C                   KFLD                    WQKD03                         Comment Type
      * Setup key
     C                   Z-ADD     $DAIC3        WQKD01                         Company Number
     C                   Z-ADD     $DC4NB        WQKD02                         Order Number
     C                   MOVEL     'BL'          WQKD03                         Comment Type
     C                   Z-ADD     *ZERO         CODXNB                         Sequence Number
      * Establish starting position
     C     KPSD          SETLL     @COCPNU                                      *
      * Read first record with user selection
     C                   EXSR      D3READ
     C                   IF        W0EOFD <> '0'
     C                   ELSE
      * Request all headings
     C                   MOVEL     'Y'           W0DL1P                         First page
     C                   MOVEL     'Y'           W0DL00                         Company Number
     C                   MOVEL     'Y'           W0DL01                         Order Number
     C                   MOVEL     'Y'           W0DL02                         Comment Type
      * Set column headings flag
     C                   MOVE      'Y'           W0DCDT
      * Print report body
      * Prepare heading formats for printing
     C                   DOW       W0EOFD = '0'
     C                   EXSR      D1PHDR
      * Print report detail line
     C                   EXSR      D2PDTL
      * Read next record with user selection
     C                   EXSR      D3READ
      * Print totals
     C                   EXSR      D4PTOT
     C                   END                                                    WOD
     C                   END                                                    FI
      *================================================================
     CSR   D0EXIT        ENDSR
      /EJECT
     CSR   D1PHDR        BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
      * Signal that format is now ready to print
     C                   IF        W0DL1P = 'Y'
     C                   MOVE      'Y'           W0DP1P
     C                   END
      *
      * Signal that format is now ready to print
     C                   IF        W0DL00 = 'Y'
     C                   MOVE      'Y'           W0DP00
     C                   END
      *
      * Signal that format is now ready to print
     C                   IF        W0DL01 = 'Y'
     C                   MOVE      'Y'           W0DP01
     C                   END
      *
      * Load key header format
     C                   IF        W0DL02 = 'Y'
     C                   Z-ADD     COAIC3        $KAIC3                         Company Number
     C                   Z-ADD     COC4NB        $KC4NB                         Order Number
     C                   MOVEL     COI1SX        $KI1SX                         Comment Type
     C                   EVAL      $KHLTX = ' '                                 Condition Desc.
     C                   EVAL      $KSHTX = ' '                                 Text USR 40
      * Load related totals format
     C                   EVAL      $MOPT1 = ' '                                 Text 93 USR
     C                   Z-ADD     COAIC3        $MAIC3                         Company Number
     C                   Z-ADD     COC4NB        $MC4NB                         Order Number
     C                   MOVEL     COI1SX        $MI1SX                         Comment Type
      * USER: Process before print of Comment Type format
      * Get the text definition of the Comment type for Heading SAZ 2/8/0
      * CUR.Text USR 40 = Condition name of CUR.Comment Type
     C                   CALL      'CARVC2R'                            90      *
     C                   PARM                    W0RTN
     C                   PARM      1603273       Y2LSNO                         List number
     C                   PARM      $KI1SX        W0INVL                         Comment Type
     C                   PARM      ' '           W0VLMP                         Value mapped
     C     $KSHTX        PARM                    W0CNNM                         Text USR 40
      *
     C                   Z-ADD     1             ZQ
     C     $KSHTX        CAT(P)    @CN(014):ZQ   $KSHTX                         Text USR 40
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0DP02
     C                   END
      *
      *================================================================
     CSR   D1EXIT        ENDSR
      /EJECT
     CSR   D2PDTL        BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                   Z-ADD     COAIC3        $LAIC3                         Company Number
     C                   Z-ADD     COC4NB        $LC4NB                         Order Number
     C                   MOVEL     COI1SX        $LI1SX                         Comment Type
     C                   MOVEL     COG4NA        $LG4NA                         Comment Text
     C                   EVAL      $LOPT1 = ' '                                 Text 93 USR
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0DPDT
      * Call print routine
     C                   EXSR      Q0PRNT
      *
      *================================================================
     CSR   D2EXIT        ENDSR
      /EJECT
     CSR   D3READ        BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C                   Z-ADD     COAIC3        WZD001
     C                   Z-ADD     COC4NB        WZD002
     C                   MOVEL     COI1SX        WZD003
      * Read next record
     C                   DOU       W0RSL = 'Y' OR
     C                             W0EOFD = '1'
     C     KRSD          READE     @COCPNU                                90    *
      * Transfer error indicator to EOF flag
     C                   MOVEL     *IN90         W0EOFD
      * Quit if no record read
      * Select record unless user action states otherwise
     C                   IF        W0EOFD <> '1'
     C                   MOVEL     'Y'           W0RSL
     C                   END                                                    FI
     C                   END                                                    UOD
      *
      * Reset key level breaks
     C                   EVAL      W0DL00 = ' '                                 Company Number
     C                   EVAL      W0DL01 = ' '                                 Order Number
     C                   EVAL      W0DL02 = ' '                                 Comment Type
      * End of file - Signal all level breaks
     C                   IF        W0EOFD = '1'
     C                   MOVEL     'Y'           W0DL00                         Company Number
     C                   MOVEL     'Y'           W0DL01                         Order Number
     C                   MOVEL     'Y'           W0DL02                         Comment Type
     C                   ELSE
      * Next record - Detect level breaks
      * Set on level break indicator
     C                   IF        COAIC3 <> WZD001
     C                   MOVEL     'Y'           W0DL00
     C                   END
      * Set on level break indicator
     C                   IF        COC4NB <> WZD002 OR
     C                             W0DL00 = 'Y'
     C                   MOVEL     'Y'           W0DL01
     C                   END
      * Set on level break indicator
     C                   IF        COI1SX <> WZD003 OR
     C                             W0DL01 = 'Y'
     C                   MOVEL     'Y'           W0DL02
     C                   END
     C                   END
      *================================================================
     CSR   D3EXIT        ENDSR
      /EJECT
     CSR   D4PTOT        BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C                   IF        W0DL02 = 'Y'
     C                   MOVEL     'Y'           W0PFM
      * USER: On print of Comment Type format
      * CASE: LCL.Count USR is NE 3
     C                   IF        YL0008 <> 3
     C                   MOVEL     YL0009        $MOPT1                         Text 93 USR
     C                   Z-ADD     *ZERO         YL0008                         Count USR
     C                   EVAL      YL0009 = ' '                                 Text 93 USR
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'N'           W0PFM                          *Print format
     C                   END                                                    *FI
      * If there is not enough space on the
      * physical page for this format:
     C                   IF        W0PFM = 'Y'
     C     @$PGL         SUB       @$CLN         @$WRK
      * Signal new page required
     C                   IF        @$WRK <= 1
     C                   MOVE      'Y'           W0NEWP
      * Start new page
     C                   EXSR      Q0PRNT
     C                   END
      * Print format
     C                   WRITE     $MKEYTTL
     C                   END
      * Signal header format is no longer ready
     C                   EVAL      W0DP02 = ' '
     C                   END
      *
      * Signal header format is no longer ready
     C                   IF        W0DL01 = 'Y'
     C                   EVAL      W0DP01 = ' '
     C                   END
      *
      * Signal header format is no longer ready
     C                   IF        W0DL00 = 'Y'
     C                   EVAL      W0DP00 = ' '
     C                   END
      *
     C                   IF        W0EOFD = '1'
     C                   END
      *
      *================================================================
     CSR   D4EXIT        ENDSR
      /EJECT
     CSR   E0MAIN        BEGSR
      *================================================================
      * PRT Hdr Comment 3/Lne PO: Mainline
      *================================================================
      * PRT Hdr Comment 3/Lne PO: Initialise
     C                   EXSR      ZEINIT
      * Declare restrictor key work fields
      * Define keylist
     C     KPSE          KLIST
     C                   KFLD                    WQKE01                         Company Number
     C                   KFLD                    WQKE02                         Order Number
     C                   KFLD                    WQKE03                         Comment Type
     C                   KFLD                    CODXNB                         Sequence Number
      * Define keylist
     C     KRSE          KLIST
     C                   KFLD                    WQKE01                         Company Number
     C                   KFLD                    WQKE02                         Order Number
     C                   KFLD                    WQKE03                         Comment Type
      * Setup key
     C                   Z-ADD     $DAIC3        WQKE01                         Company Number
     C                   Z-ADD     $DC4NB        WQKE02                         Order Number
     C                   MOVEL     'IN'          WQKE03                         Comment Type
     C                   Z-ADD     *ZERO         CODXNB                         Sequence Number
      * Establish starting position
     C     KPSE          SETLL     @COCPNU                                      *
      * Read first record with user selection
     C                   EXSR      E3READ
     C                   IF        W0EOFE <> '0'
     C                   ELSE
      * Request all headings
     C                   MOVEL     'Y'           W0EL1P                         First page
     C                   MOVEL     'Y'           W0EL00                         Company Number
     C                   MOVEL     'Y'           W0EL01                         Order Number
     C                   MOVEL     'Y'           W0EL02                         Comment Type
      * Set column headings flag
     C                   MOVE      'Y'           W0ECDT
      * Print report body
      * Prepare heading formats for printing
     C                   DOW       W0EOFE = '0'
     C                   EXSR      E1PHDR
      * Print report detail line
     C                   EXSR      E2PDTL
      * Read next record with user selection
     C                   EXSR      E3READ
      * Print totals
     C                   EXSR      E4PTOT
     C                   END                                                    WOD
     C                   END                                                    FI
      *================================================================
     CSR   E0EXIT        ENDSR
      /EJECT
     CSR   E1PHDR        BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
      * Signal that format is now ready to print
     C                   IF        W0EL1P = 'Y'
     C                   MOVE      'Y'           W0EP1P
     C                   END
      *
      * Signal that format is now ready to print
     C                   IF        W0EL00 = 'Y'
     C                   MOVE      'Y'           W0EP00
     C                   END
      *
      * Signal that format is now ready to print
     C                   IF        W0EL01 = 'Y'
     C                   MOVE      'Y'           W0EP01
     C                   END
      *
      * Load key header format
     C                   IF        W0EL02 = 'Y'
     C                   Z-ADD     COAIC3        $NAIC3                         Company Number
     C                   Z-ADD     COC4NB        $NC4NB                         Order Number
     C                   MOVEL     COI1SX        $NI1SX                         Comment Type
     C                   EVAL      $NHLTX = ' '                                 Condition Desc.
     C                   EVAL      $NSHTX = ' '                                 Text USR 40
      * Load related totals format
     C                   EVAL      $POPT1 = ' '                                 Text 93 USR
     C                   Z-ADD     COAIC3        $PAIC3                         Company Number
     C                   Z-ADD     COC4NB        $PC4NB                         Order Number
     C                   MOVEL     COI1SX        $PI1SX                         Comment Type
      * USER: Process before print of Comment Type format
      * Get the text definition of the Comment type for Heading SAZ 2/8/0
      * CUR.Text USR 40 = Condition name of CUR.Comment Type
     C                   CALL      'CARVC2R'                            90      *
     C                   PARM                    W0RTN
     C                   PARM      1603273       Y2LSNO                         List number
     C                   PARM      $NI1SX        W0INVL                         Comment Type
     C                   PARM      ' '           W0VLMP                         Value mapped
     C     $NSHTX        PARM                    W0CNNM                         Text USR 40
      *
     C                   Z-ADD     1             ZQ
     C     $NSHTX        CAT(P)    @CN(014):ZQ   $NSHTX                         Text USR 40
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0EP02
     C                   END
      *
      *================================================================
     CSR   E1EXIT        ENDSR
      /EJECT
     CSR   E2PDTL        BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                   Z-ADD     COAIC3        $OAIC3                         Company Number
     C                   Z-ADD     COC4NB        $OC4NB                         Order Number
     C                   MOVEL     COI1SX        $OI1SX                         Comment Type
     C                   MOVEL     COG4NA        $OG4NA                         Comment Text
     C                   EVAL      $OOPT1 = ' '                                 Text 93 USR
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0EPDT
      * Call print routine
     C                   EXSR      Q0PRNT
      *
      *================================================================
     CSR   E2EXIT        ENDSR
      /EJECT
     CSR   E3READ        BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C                   Z-ADD     COAIC3        WZE001
     C                   Z-ADD     COC4NB        WZE002
     C                   MOVEL     COI1SX        WZE003
      * Read next record
     C                   DOU       W0RSL = 'Y' OR
     C                             W0EOFE = '1'
     C     KRSE          READE     @COCPNU                                90    *
      * Transfer error indicator to EOF flag
     C                   MOVEL     *IN90         W0EOFE
      * Quit if no record read
      * Select record unless user action states otherwise
     C                   IF        W0EOFE <> '1'
     C                   MOVEL     'Y'           W0RSL
     C                   END                                                    FI
     C                   END                                                    UOD
      *
      * Reset key level breaks
     C                   EVAL      W0EL00 = ' '                                 Company Number
     C                   EVAL      W0EL01 = ' '                                 Order Number
     C                   EVAL      W0EL02 = ' '                                 Comment Type
      * End of file - Signal all level breaks
     C                   IF        W0EOFE = '1'
     C                   MOVEL     'Y'           W0EL00                         Company Number
     C                   MOVEL     'Y'           W0EL01                         Order Number
     C                   MOVEL     'Y'           W0EL02                         Comment Type
     C                   ELSE
      * Next record - Detect level breaks
      * Set on level break indicator
     C                   IF        COAIC3 <> WZE001
     C                   MOVEL     'Y'           W0EL00
     C                   END
      * Set on level break indicator
     C                   IF        COC4NB <> WZE002 OR
     C                             W0EL00 = 'Y'
     C                   MOVEL     'Y'           W0EL01
     C                   END
      * Set on level break indicator
     C                   IF        COI1SX <> WZE003 OR
     C                             W0EL01 = 'Y'
     C                   MOVEL     'Y'           W0EL02
     C                   END
     C                   END
      *================================================================
     CSR   E3EXIT        ENDSR
      /EJECT
     CSR   E4PTOT        BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C                   IF        W0EL02 = 'Y'
     C                   MOVEL     'Y'           W0PFM
      * USER: On print of Comment Type format
      * CASE: LCL.Count USR is NE 3
     C                   IF        YL0008 <> 3
     C                   MOVEL     YL0009        $POPT1                         Text 93 USR
     C                   Z-ADD     *ZERO         YL0008                         Count USR
     C                   EVAL      YL0009 = ' '                                 Text 93 USR
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'N'           W0PFM                          *Print format
     C                   END                                                    *FI
      * If there is not enough space on the
      * physical page for this format:
     C                   IF        W0PFM = 'Y'
     C     @$PGL         SUB       @$CLN         @$WRK
      * Signal new page required
     C                   IF        @$WRK <= 1
     C                   MOVE      'Y'           W0NEWP
      * Start new page
     C                   EXSR      Q0PRNT
     C                   END
      * Print format
     C                   WRITE     $PKEYTTL
     C                   END
      * Signal header format is no longer ready
     C                   EVAL      W0EP02 = ' '
     C                   END
      *
      * Signal header format is no longer ready
     C                   IF        W0EL01 = 'Y'
     C                   EVAL      W0EP01 = ' '
     C                   END
      *
      * Signal header format is no longer ready
     C                   IF        W0EL00 = 'Y'
     C                   EVAL      W0EP00 = ' '
     C                   END
      *
     C                   IF        W0EOFE = '1'
     C                   END
      *
      *================================================================
     CSR   E4EXIT        ENDSR
      /EJECT
     CSR   F0MAIN        BEGSR
      *================================================================
      * PRT Ship Inst 3/Line  PO: Mainline
      *================================================================
      * PRT Ship Inst 3/Line  PO: Initialise
     C                   EXSR      ZFINIT
      * Declare restrictor key work fields
      * Define keylist
     C     KRSF          KLIST
     C                   KFLD                    WQKF01                         Company Number
     C                   KFLD                    WQKF02                         Order Number
      * Setup key
     C                   Z-ADD     $DAIC3        WQKF01                         Company Number
     C                   Z-ADD     $DC4NB        WQKF02                         Order Number
      * Establish starting position
     C     KRSF          SETLL     @IECPSA                                      *
      * Read first record with user selection
     C                   EXSR      F3READ
     C                   IF        W0EOFF <> '0'
     C                   ELSE
      * Request all headings
     C                   MOVEL     'Y'           W0FL1P                         First page
     C                   MOVEL     'Y'           W0FL00                         Company Number
     C                   MOVEL     'Y'           W0FL01                         Order Number
      * Set column headings flag
     C                   MOVE      'Y'           W0FCDT
      * Print report body
      * Prepare heading formats for printing
     C                   DOW       W0EOFF = '0'
     C                   EXSR      F1PHDR
      * Print report detail line
     C                   EXSR      F2PDTL
      * Read next record with user selection
     C                   EXSR      F3READ
      * Print totals
     C                   EXSR      F4PTOT
     C                   END                                                    WOD
     C                   END                                                    FI
      *================================================================
     CSR   F0EXIT        ENDSR
      /EJECT
     CSR   F1PHDR        BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
      * Load related totals format
     C                   IF        W0FL1P = 'Y'
     C                   EVAL      $SOPT1 = ' '                                 Text 93 USR
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0FP1P
     C                   END
      *
      * Signal that format is now ready to print
     C                   IF        W0FL00 = 'Y'
     C                   MOVE      'Y'           W0FP00
     C                   END
      *
      * Load key header format
     C                   IF        W0FL01 = 'Y'
     C                   EVAL      $QBDST = ' '                                 Order Certifica
     C                   Z-ADD     IEAIC3        $QAIC3                         Company Number
     C                   Z-ADD     IEC4NB        $QC4NB                         Order Number
     C                   Z-ADD     IEDXNB        $QDXNB                         Sequence Number
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0FP01
     C                   END
      *
      *================================================================
     CSR   F1EXIT        ENDSR
      /EJECT
     CSR   F2PDTL        BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                   Z-ADD     IEAIC3        $RAIC3                         Company Number
     C                   Z-ADD     IEC4NB        $RC4NB                         Order Number
     C                   Z-ADD     IEDXNB        $RDXNB                         Sequence Number
     C                   MOVEL     IEMQNA        $RMQNA                         Shipping Instru
     C                   EVAL      $ROPT1 = ' '                                 Text 93 USR
     C                   MOVEL     IEUVST        $RUVST                         EDI Status 1
     C                   MOVEL     IEUWST        $RUWST                         EDI Status 2
     C                   MOVEL     IEUXST        $RUXST                         EDI Status 3
     C                   Z-ADD     IEAATM        $RAATM                         Job Time
     C                   MOVEL     IEAYNA        $RAYNA                         User Id
     C                   MOVEL     IEA0NA        $RA0NA                         Job Name
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0FPDT
      * Call print routine
     C                   EXSR      Q0PRNT
      *
      *================================================================
     CSR   F2EXIT        ENDSR
      /EJECT
     CSR   F3READ        BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C                   Z-ADD     IEAIC3        WZF001
     C                   Z-ADD     IEC4NB        WZF002
      * Read next record
     C                   DOU       W0RSL = 'Y' OR
     C                             W0EOFF = '1'
     C     KRSF          READE     @IECPSA                                90    *
      * Transfer error indicator to EOF flag
     C                   MOVEL     *IN90         W0EOFF
      * Quit if no record read
      * Select record unless user action states otherwise
     C                   IF        W0EOFF <> '1'
     C                   MOVEL     'Y'           W0RSL
     C                   END                                                    FI
     C                   END                                                    UOD
      *
      * Reset key level breaks
     C                   EVAL      W0FL00 = ' '                                 Company Number
     C                   EVAL      W0FL01 = ' '                                 Order Number
      * End of file - Signal all level breaks
     C                   IF        W0EOFF = '1'
     C                   MOVEL     'Y'           W0FL00                         Company Number
     C                   MOVEL     'Y'           W0FL01                         Order Number
     C                   ELSE
      * Next record - Detect level breaks
      * Set on level break indicator
     C                   IF        IEAIC3 <> WZF001
     C                   MOVEL     'Y'           W0FL00
     C                   END
      * Set on level break indicator
     C                   IF        IEC4NB <> WZF002 OR
     C                             W0FL00 = 'Y'
     C                   MOVEL     'Y'           W0FL01
     C                   END
     C                   END
      *================================================================
     CSR   F3EXIT        ENDSR
      /EJECT
     CSR   F4PTOT        BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
      * Signal header format is no longer ready
     C                   IF        W0FL01 = 'Y'
     C                   EVAL      W0FP01 = ' '
     C                   END
      *
      * Signal header format is no longer ready
     C                   IF        W0FL00 = 'Y'
     C                   EVAL      W0FP00 = ' '
     C                   END
      *
     C                   IF        W0EOFF = '1'
     C                   MOVEL     'Y'           W0PFM
      * USER: On print of final totals format
      * CASE: LCL.Count USR is NE 3
     C                   IF        YL0010 <> 3
     C                   MOVEL     YL0011        $SOPT1                         Text 93 USR
     C                   Z-ADD     *ZERO         YL0010                         Count USR
     C                   EVAL      YL0011 = ' '                                 Text 93 USR
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'N'           W0PFM                          *Print format
     C                   END                                                    *FI
      * If there is not enough space on the
      * physical page for this format:
     C                   IF        W0PFM = 'Y'
     C     @$PGL         SUB       @$CLN         @$WRK
      * Signal new page required
     C                   IF        @$WRK <= 1
     C                   MOVE      'Y'           W0NEWP
      * Start new page
     C                   EXSR      Q0PRNT
     C                   END
      * Print format
     C                   WRITE     $SFINTTL
     C                   END
     C                   END
      *
      *================================================================
     CSR   F4EXIT        ENDSR
      /EJECT
     CSR   G0MAIN        BEGSR
      *================================================================
      * Prt Cust Comment PL   PO: Mainline
      *================================================================
      * Prt Cust Comment PL   PO: Initialise
     C                   EXSR      ZGINIT
      * Declare restrictor key work fields
      * Define keylist
     C     KPSG          KLIST
     C                   KFLD                    WQKG01                         Ship To Custome
     C                   KFLD                    WQKG02                         Comment Type
     C                   KFLD                    WAM5NX                         Comment Sequenc
      * Define keylist
     C     KRSG          KLIST
     C                   KFLD                    WQKG01                         Ship To Custome
     C                   KFLD                    WQKG02                         Comment Type
      * Setup key
     C                   Z-ADD     BEBKC7        WQKG01                         Ship To Custome
     C                   MOVEL     'PI'          WQKG02                         Comment Type
     C                   Z-ADD     *ZERO         WAM5NX                         Comment Sequenc
      * Establish starting position
     C     KPSG          SETLL     @AVCPG4                                      *
      * Read first record with user selection
     C                   EXSR      G3READ
     C                   IF        W0EOFG <> '0'
     C                   ELSE
      * Request all headings
     C                   MOVEL     'Y'           W0GL1P                         First page
     C                   MOVEL     'Y'           W0GL00                         Ship To Custome
     C                   MOVEL     'Y'           W0GL01                         Comment Type
      * Set column headings flag
     C                   MOVE      'Y'           W0GCDT
      * Print report body
      * Prepare heading formats for printing
     C                   DOW       W0EOFG = '0'
     C                   EXSR      G1PHDR
      * Print report detail line
     C                   EXSR      G2PDTL
      * Read next record with user selection
     C                   EXSR      G3READ
      * Print totals
     C                   EXSR      G4PTOT
     C                   END                                                    WOD
     C                   END                                                    FI
      *================================================================
     CSR   G0EXIT        ENDSR
      /EJECT
     CSR   G1PHDR        BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
      * Signal that format is now ready to print
     C                   IF        W0GL1P = 'Y'
     C                   MOVE      'Y'           W0GP1P
     C                   END
      *
      * Signal that format is now ready to print
     C                   IF        W0GL00 = 'Y'
     C                   MOVE      'Y'           W0GP00
     C                   END
      *
      * Signal that format is now ready to print
     C                   IF        W0GL01 = 'Y'
     C                   MOVE      'Y'           W0GP01
     C                   END
      *
      *================================================================
     CSR   G1EXIT        ENDSR
      /EJECT
     CSR   G2PDTL        BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                   Z-ADD     WABKC7        $TBKC7                         Ship To Custome
     C                   MOVEL     WAI1SX        $TI1SX                         Comment Type
     C                   Z-ADD     WAM5NX        $TM5NX                         Comment Sequenc
     C                   MOVEL     WAXRTX        $TXRTX                         Customer Commen
     C                   MOVEL     WAUVST        $TUVST                         EDI Status 1
     C                   MOVEL     WAUWST        $TUWST                         EDI Status 2
     C                   MOVEL     WAUXST        $TUXST                         EDI Status 3
     C                   MOVEL     WAVSST        $TVSST                         Record Status
     C                   Z-ADD     WAAATM        $TAATM                         Job Time
     C                   MOVEL     WAAYNA        $TAYNA                         User Id
     C                   MOVEL     WAA0NA        $TA0NA                         Job Name
     C                   Z-ADD     WAAXDT        $TAXDT                         Job Date
      * USER: Process before print of detail format
      * CASE: LCL.First time flag 2     USR is Yes
     C                   IF        YL0014 = 'Y'
     C     W0FSUM        ADD       YL0013        YL0016                         USR Counter
      * CASE: LCL.USR Counter GE LCL.Page Length
      * SET W0PB03             US - /UT User Source  * 
     C                   IF        YL0016 >= YL0015
     C                   MOVEL     'Y'           W0BP03            1
     C                   ELSE
      * CASE: *OTHERWISE
      * SET W0PB03             US - /UT User Source  * 
     C                   MOVEL     'N'           W0BP03            1
     C                   END                                                    *FI
     C                   MOVEL     'N'           YL0014                         First time flag
     C                   END                                                    *FI
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0GPDT
      * Call print routine
     C                   EXSR      Q0PRNT
      * USER: Process after print of detail format
      * These fields are print control fields used in the previous PRTOBJ
      * to control the Header field print when overflow occurs.
      * Do first time for Order Break
      * CASE: WRK.USR First Time is Yes
     C                   IF        WUTMST = 'Y'
     C                   MOVEL     'N'           WUTMST                         USR First Time
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      WUDLST = ' '                                 USR Overflow
     C                   MOVEL     'N'           WUGGST                         USR Display fie
     C                   END                                                    *FI
      *
      *================================================================
     CSR   G2EXIT        ENDSR
      /EJECT
     CSR   G3READ        BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C                   Z-ADD     WABKC7        WZG001
     C                   MOVEL     WAI1SX        WZG002
      * Read next record
     C                   DOU       W0RSL = 'Y' OR
     C                             W0EOFG = '1'
     C     KRSG          READE     @AVCPG4                                90    *
      * Transfer error indicator to EOF flag
     C                   MOVEL     *IN90         W0EOFG
      * Quit if no record read
      * Select record unless user action states otherwise
     C                   IF        W0EOFG <> '1'
     C                   MOVEL     'Y'           W0RSL
     C                   END                                                    FI
     C                   END                                                    UOD
      *
      * Reset key level breaks
     C                   EVAL      W0GL00 = ' '                                 Ship To Custome
     C                   EVAL      W0GL01 = ' '                                 Comment Type
      * End of file - Signal all level breaks
     C                   IF        W0EOFG = '1'
     C                   MOVEL     'Y'           W0GL00                         Ship To Custome
     C                   MOVEL     'Y'           W0GL01                         Comment Type
     C                   ELSE
      * Next record - Detect level breaks
      * Set on level break indicator
     C                   IF        WABKC7 <> WZG001
     C                   MOVEL     'Y'           W0GL00
     C                   END
      * Set on level break indicator
     C                   IF        WAI1SX <> WZG002 OR
     C                             W0GL00 = 'Y'
     C                   MOVEL     'Y'           W0GL01
     C                   END
     C                   END
      *================================================================
     CSR   G3EXIT        ENDSR
      /EJECT
     CSR   G4PTOT        BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
      * Signal header format is no longer ready
     C                   IF        W0GL01 = 'Y'
     C                   EVAL      W0GP01 = ' '
     C                   END
      *
      * Signal header format is no longer ready
     C                   IF        W0GL00 = 'Y'
     C                   EVAL      W0GP00 = ' '
     C                   END
      *
     C                   IF        W0EOFG = '1'
     C                   END
      *
      *================================================================
     CSR   G4EXIT        ENDSR
      /EJECT
     CSR   H0MAIN        BEGSR
      *================================================================
      * Prt Country Comment   PO: Mainline
      *================================================================
      * Prt Country Comment   PO: Initialise
     C                   EXSR      ZHINIT
      * Declare restrictor key work fields
      * Define keylist
     C     KRSH          KLIST
     C                   KFLD                    WQKH01                         Country Code
     C                   KFLD                    WQKH02                         Comment Type
      * Setup key
     C                   MOVEL     YL0002        WQKH01                         Country Code
     C                   MOVEL     'PL'          WQKH02                         Comment Type
      * Establish starting position
     C     KRSH          SETLL     @B1REED                                      *
      * Read first record with user selection
     C                   EXSR      H3READ
     C                   IF        W0EOFH <> '0'
     C                   ELSE
      * Request all headings
     C                   MOVEL     'Y'           W0HL1P                         First page
     C                   MOVEL     'Y'           W0HL00                         Country Code
     C                   MOVEL     'Y'           W0HL01                         Comment Type
      * Set column headings flag
     C                   MOVE      'Y'           W0HCDT
      * Print report body
      * Prepare heading formats for printing
     C                   DOW       W0EOFH = '0'
     C                   EXSR      H1PHDR
      * Print report detail line
     C                   EXSR      H2PDTL
      * Read next record with user selection
     C                   EXSR      H3READ
      * Print totals
     C                   EXSR      H4PTOT
     C                   END                                                    WOD
     C                   END                                                    FI
      *================================================================
     CSR   H0EXIT        ENDSR
      /EJECT
     CSR   H1PHDR        BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
      * Signal that format is now ready to print
     C                   IF        W0HL1P = 'Y'
     C                   MOVE      'Y'           W0HP1P
     C                   END
      *
      * Signal that format is now ready to print
     C                   IF        W0HL00 = 'Y'
     C                   MOVE      'Y'           W0HP00
     C                   END
      *
      * Signal that format is now ready to print
     C                   IF        W0HL01 = 'Y'
     C                   MOVE      'Y'           W0HP01
     C                   END
      *
      *================================================================
     CSR   H1EXIT        ENDSR
      /EJECT
     CSR   H2PDTL        BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                   MOVEL     WBKXCD        $UKXCD                         Country Code
     C                   MOVEL     WBI1SX        $UI1SX                         Comment Type
     C                   Z-ADD     WBM5NX        $UM5NX                         Comment Sequenc
     C                   MOVEL     WBQ6NA        $UQ6NA                         Comment
     C                   MOVEL     WBUVST        $UUVST                         EDI Status 1
     C                   MOVEL     WBUWST        $UUWST                         EDI Status 2
     C                   MOVEL     WBUXST        $UUXST                         EDI Status 3
     C                   MOVEL     WBVSST        $UVSST                         Record Status
     C                   Z-ADD     WBAATM        $UAATM                         Job Time
     C                   MOVEL     WBAYNA        $UAYNA                         User Id
     C                   MOVEL     WBA0NA        $UA0NA                         Job Name
     C                   Z-ADD     WBAXDT        $UAXDT                         Job Date
      * USER: Process before print of detail format
      * CASE: LCL.First time flag 2     USR is Yes
     C                   IF        YL0017 = 'Y'
     C     W0FSUM        ADD       YL0020        YL0019                         USR Counter
      * CASE: LCL.USR Counter GE LCL.Page Length
      * SET W0PB03             US - /UT User Source  * 
     C                   IF        YL0019 >= YL0018
     C                   MOVEL     'Y'           W0BP03            1
     C                   ELSE
      * CASE: *OTHERWISE
      * SET W0PB03             US - /UT User Source  * 
     C                   MOVEL     'N'           W0BP03            1
     C                   END                                                    *FI
     C                   MOVEL     'N'           YL0017                         First time flag
     C                   END                                                    *FI
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0HPDT
      * Call print routine
     C                   EXSR      Q0PRNT
      * USER: Process after print of detail format
      * These fields are print control fields used in the previous PRTOBJ
      * to control the Header field print when overflow occurs.
      * Do first time for Order Break
      * CASE: WRK.USR First Time is Yes
     C                   IF        WUTMST = 'Y'
     C                   MOVEL     'N'           WUTMST                         USR First Time
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      WUDLST = ' '                                 USR Overflow
     C                   MOVEL     'N'           WUGGST                         USR Display fie
     C                   END                                                    *FI
      *
      *================================================================
     CSR   H2EXIT        ENDSR
      /EJECT
     CSR   H3READ        BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C                   MOVEL     WBKXCD        WZH001
     C                   MOVEL     WBI1SX        WZH002
      * Read next record
     C                   DOU       W0RSL = 'Y' OR
     C                             W0EOFH = '1'
     C     KRSH          READE     @B1REED                                90    *
      * Transfer error indicator to EOF flag
     C                   MOVEL     *IN90         W0EOFH
      * Quit if no record read
      * Select record unless user action states otherwise
     C                   IF        W0EOFH <> '1'
     C                   MOVEL     'Y'           W0RSL
     C                   END                                                    FI
     C                   END                                                    UOD
      *
      * Reset key level breaks
     C                   EVAL      W0HL00 = ' '                                 Country Code
     C                   EVAL      W0HL01 = ' '                                 Comment Type
      * End of file - Signal all level breaks
     C                   IF        W0EOFH = '1'
     C                   MOVEL     'Y'           W0HL00                         Country Code
     C                   MOVEL     'Y'           W0HL01                         Comment Type
     C                   ELSE
      * Next record - Detect level breaks
      * Set on level break indicator
     C                   IF        WBKXCD <> WZH001
     C                   MOVEL     'Y'           W0HL00
     C                   END
      * Set on level break indicator
     C                   IF        WBI1SX <> WZH002 OR
     C                             W0HL00 = 'Y'
     C                   MOVEL     'Y'           W0HL01
     C                   END
     C                   END
      *================================================================
     CSR   H3EXIT        ENDSR
      /EJECT
     CSR   H4PTOT        BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
      * Signal header format is no longer ready
     C                   IF        W0HL01 = 'Y'
     C                   EVAL      W0HP01 = ' '
     C                   END
      *
      * Signal header format is no longer ready
     C                   IF        W0HL00 = 'Y'
     C                   EVAL      W0HP00 = ' '
     C                   END
      *
     C                   IF        W0EOFH = '1'
     C                   END
      *
      *================================================================
     CSR   H4EXIT        ENDSR
      /EJECT
     CSR   I0MAIN        BEGSR
      *================================================================
      * PRT All Orders on Load PO: Mainline
      *================================================================
      * Declare restrictor key work fields
      * Define keylist
     C     KPSI          KLIST
     C                   KFLD                    WQKI01                         Load ID
     C                   KFLD                    FLRUNB                         Stop_Drop Seque
      * Define keylist
     C     KRSI          KLIST
     C                   KFLD                    WQKI01                         Load ID
      * Setup key
     C                   Z-ADD     BERMNB        WQKI01                         Load ID
     C                   Z-ADD     *ZERO         FLRUNB                         Stop_Drop Seque
      * Establish starting position
     C     KPSI          SETLL     @FLCPBW                                      *
      * Read first record with user selection
     C                   EXSR      I3READ
     C                   IF        W0EOFI <> '0'
     C                   ELSE
      * Request all headings
     C                   MOVEL     'Y'           W0IL1P                         First page
     C                   MOVEL     'Y'           W0IL00                         Load ID
      * Set column headings flag
     C                   MOVE      'Y'           W0ICDT
      * Print report body
      * Prepare heading formats for printing
     C                   DOW       W0EOFI = '0'
     C                   EXSR      I1PHDR
      * Print report detail line
     C                   EXSR      I2PDTL
      * Read next record with user selection
     C                   EXSR      I3READ
      * Print totals
     C                   EXSR      I4PTOT
     C                   END                                                    WOD
     C                   END                                                    FI
      *================================================================
     CSR   I0EXIT        ENDSR
      /EJECT
     CSR   I1PHDR        BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
      * Signal that format is now ready to print
     C                   IF        W0IL1P = 'Y'
     C                   MOVE      'Y'           W0IP1P
     C                   END
      *
      * Load key header format
     C                   IF        W0IL00 = 'Y'
     C                   EVAL      $VEZTX = ' '                                 USR Work Field
     C                   Z-ADD     FLAIC3        $VAIC3                         Company Number
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0IP00
     C                   END
      *
      *================================================================
     CSR   I1EXIT        ENDSR
      /EJECT
     CSR   I2PDTL        BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                   Z-ADD     FLAIC3        $WAIC3                         Company Number
     C                   Z-ADD     FLRMNB        $WRMNB                         Load ID
     C                   Z-ADD     FLRUNB        $WRUNB                         Stop_Drop Seque
     C                   Z-ADD     FLC4NB        $WC4NB                         Order Number
     C                   Z-ADD     FLRVNB        $WRVNB                         Stop_Drop
     C                   Z-ADD     FLKEDT        $WKEDT                         Estimated Arriv
     C                   Z-ADD     FLSXNB        $WSXNB                         Estimated Arriv
     C                   Z-ADD     FLKFDT        $WKFDT                         Appointment Con
     C                   Z-ADD     FLACTM        $WACTM                         Appointment Con
     C                   MOVEL     FLK5TX        $WK5TX                         Confirmation Ma
     C                   MOVEL     FLW5CD        $WW5CD                         Confirmation Nu
     C                   Z-ADD     FLEJDT        $WEJDT                         Actual Delivery
     C                   Z-ADD     FLAGTM        $WAGTM                         Actual Delivery
     C                   Z-ADD     FLKJDT        $WKJDT                         Scheduled Deliv
     C                   Z-ADD     FLATTM        $WATTM                         Scheduled Deliv
     C                   Z-ADD     FLHDDT        $WHDDT                         Deadline Depart
     C                   Z-ADD     FLAUTM        $WAUTM                         Deadline Depart
     C                   Z-ADD     FLKKDT        $WKKDT                         On Yard Date
     C                   Z-ADD     FLAVTM        $WAVTM                         On Yard Time
     C                   Z-ADD     FLZ4NB        $WZ4NB                         MPC Number
     C                   MOVEL     FLY7ST        $WY7ST                         Load Dtl On Tim
     C                   MOVEL     FLY2ST        $WY2ST                         On Time Addl Rs
     C                   MOVEL     FLWHTX        $WWHTX                         Seal Nbr 1
     C                   MOVEL     FLWITX        $WWITX                         Seal Nbr 2
     C                   MOVEL     FLWJTX        $WWJTX                         Seal Nbr 3
     C                   MOVEL     FLWKTX        $WWKTX                         Seal Nbr 4
     C                   MOVEL     FLWLTX        $WWLTX                         Seal Nbr 5
     C                   Z-ADD     FLN7DT        $WN7DT                         LD Carrier Appt
     C                   Z-ADD     FLN8DT        $WN8DT                         LD Unused Date
     C                   Z-ADD     FLN9DT        $WN9DT                         LD Unused Date
     C                   Z-ADD     FLB3TM        $WB3TM                         LD Carrier Appt
     C                   Z-ADD     FLB4TM        $WB4TM                         LD Unused Time
     C                   Z-ADD     FLB5TM        $WB5TM                         LD Unused Time
     C                   MOVEL     FLIASX        $WIASX                         Miles Error Sts
     C                   MOVEL     FLIBSX        $WIBSX                         LD Unused Sts 2
     C                   MOVEL     FLICSX        $WICSX                         HPB Transload S
     C                   MOVEL     FLWVTX        $WWVTX                         LD Cst Svc Trac
     C                   MOVEL     FLWWTX        $WWWTX                         Carrier Ref PRO
     C                   MOVEL     FLWXTX        $WWXTX                         Cust Assigned A
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0IPDT
      * Call print routine
     C                   EXSR      Q0PRNT
      *
      *================================================================
     CSR   I2EXIT        ENDSR
      /EJECT
     CSR   I3READ        BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C                   Z-ADD     FLRMNB        WZI001
      * Read next record
     C                   DOU       W0RSL = 'Y' OR
     C                             W0EOFI = '1'
     C     KRSI          READE     @FLCPBW                                90    *
      * Transfer error indicator to EOF flag
     C                   MOVEL     *IN90         W0EOFI
      * Quit if no record read
      * Select record unless user action states otherwise
     C                   IF        W0EOFI <> '1'
     C                   MOVEL     'Y'           W0RSL
     C                   END                                                    FI
     C                   END                                                    UOD
      *
      * Reset key level breaks
     C                   EVAL      W0IL00 = ' '                                 Load ID
      * End of file - Signal all level breaks
     C                   IF        W0EOFI = '1'
     C                   MOVEL     'Y'           W0IL00                         Load ID
     C                   ELSE
      * Next record - Detect level breaks
      * Set on level break indicator
     C                   IF        FLRMNB <> WZI001
     C                   MOVEL     'Y'           W0IL00
     C                   END
     C                   END
      *================================================================
     CSR   I3EXIT        ENDSR
      /EJECT
     CSR   I4PTOT        BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
      * Signal header format is no longer ready
     C                   IF        W0IL00 = 'Y'
     C                   EVAL      W0IP00 = ' '
     C                   END
      *
     C                   IF        W0EOFI = '1'
     C                   END
      *
      *================================================================
     CSR   I4EXIT        ENDSR
      /EJECT
     CSR   J0MAIN        BEGSR
      *================================================================
      * PRT Detail-Acknowledge PO: Mainline
      *================================================================
      * PRT Detail-Acknowledge PO: Initialise
     C                   EXSR      ZJINIT
      * Declare restrictor key work fields
      * Define keylist
     C     KPSJ          KLIST
     C                   KFLD                    WQKJ01                         Company Number
     C                   KFLD                    WQKJ02                         Order Number
     C                   KFLD                    WCDPNB                         Order Sequence
     C                   KFLD                    WCUENB                         Order Secondary
      * Define keylist
     C     KRSJ          KLIST
     C                   KFLD                    WQKJ01                         Company Number
     C                   KFLD                    WQKJ02                         Order Number
      * Setup key
     C                   Z-ADD     $DAIC3        WQKJ01                         Company Number
     C                   Z-ADD     $DC4NB        WQKJ02                         Order Number
     C                   Z-ADD     *ZERO         WCDPNB                         Order Sequence
     C                   Z-ADD     *ZERO         WCUENB                         Order Secondary
      * Establish starting position
     C     KPSJ          SETLL     @BGWKL1                                      *
      * Read first record with user selection
     C                   EXSR      J3READ
     C                   IF        W0EOFJ <> '0'
     C                   ELSE
      * Request all headings
     C                   MOVEL     'Y'           W0JL1P                         First page
     C                   MOVEL     'Y'           W0JL00                         Company Number
     C                   MOVEL     'Y'           W0JL01                         Order Number
     C                   MOVEL     'Y'           W0JL02                         Order Sequence
      * Set column headings flag
     C                   MOVE      'Y'           W0JCDT
      * Print report body
      * Prepare heading formats for printing
     C                   DOW       W0EOFJ = '0'
     C                   EXSR      J1PHDR
      * Print report detail line
     C                   EXSR      J2PDTL
      * Read next record with user selection
     C                   EXSR      J3READ
      * Print totals
     C                   EXSR      J4PTOT
     C                   END                                                    WOD
     C                   END                                                    FI
      *================================================================
     CSR   J0EXIT        ENDSR
      /EJECT
     CSR   J1PHDR        BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
      * USER: Process before print of first page format
      * Set Date Format - UT User Source  * 
     C                   IF        W0JL1P = 'Y'
     C                   MOVEL     P2B8NA        XDDTFM            3
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0JP1P
     C                   END
      *
      * Signal that format is now ready to print
     C                   IF        W0JL00 = 'Y'
     C                   MOVE      'Y'           W0JP00
     C                   END
      *
      * Load key header format
     C                   IF        W0JL01 = 'Y'
     C                   EVAL      $XI6TX = ' '                                 Description 14A
     C                   Z-ADD     WCAIC3        $XAIC3                         Company Number
     C                   Z-ADD     WCC4NB        $XC4NB                         Order Number
      * Load related totals format
     C                   Z-ADD     *ZERO         #JQTOR                         USR Quantity Or
     C                   Z-ADD     *ZERO         #JTRAQ                         USR Transaction
     C                   Z-ADD     *ZERO         #JCPWG                         USR Weight   9.
     C                   Z-ADD     *ZERO         #JJVVA                         USR Extended Am
     C                   Z-ADD     WCAIC3        #JAIC3                         Company Number
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0JP01
     C                   END
      *
      * Signal that format is now ready to print
     C                   IF        W0JL02 = 'Y'
     C                   MOVE      'Y'           W0JP02
     C                   END
      *
      *================================================================
     CSR   J1EXIT        ENDSR
      /EJECT
     CSR   J2PDTL        BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                   EVAL      $YLBST = ' '                                 Pack Dates or A
     C                   Z-ADD     WCAIC3        $YAIC3                         Company Number
     C                   Z-ADD     WCA1AA        $YA1AA                         Ham Group Numbe
     C                   MOVEL     WCF7SX        $YF7SX                         OD Price Type
     C                   Z-ADD     WCHGCD        $YHGCD                         Item Code
     C                   MOVEL     WCAJCD        $YAJCD                         Warehouse Code
     C                   MOVEL     WCVEST        $YVEST                         Palletize
     C                   MOVEL     WCF5SX        $YF5SX                         OD Pallet Type
     C                   MOVEL     WCVGST        $YVGST                         Slip Sheet
     C                   MOVEL     WCAGCD        $YAGCD                         U_M_Ordered
     C                   Z-ADD     *ZERO         $YQTOR                         USR Quantity Or
     C                   Z-ADD     *ZERO         $YTRAQ                         USR Transaction
     C                   Z-ADD     WCAKPR        $YAKPR                         Unit Price
     C                   Z-ADD     *ZERO         $YDTPR                         Unit Price (DSP
     C                   Z-ADD     *ZERO         $YCOWG                         USR Weight   9.
     C                   MOVEL     WCCRCD        $YCRCD                         U_M_Base Price
     C                   MOVEL     WCQ7CD        $YQ7CD                         Price Method Co
     C                   MOVEL     WCRDCD        $YRDCD                         Date Method Cod
     C                   Z-ADD     WCRINY        $YRINY                         Item Age Days
     C                   MOVEL     WCRPCD        $YRPCD                         Age Code
     C                   Z-ADD     WCAYVA        $YAYVA                         Extended Amount
     C                   MOVEL     WCG7NA        $YG7NA                         Order Desc_Line
     C                   Z-ADD     WCDWPR        $YDWPR                         OD Ceiling Pric
     C                   Z-ADD     WCBVTM        $YBVTM                         Price Code
     C                   EVAL      $YESNA = ' '                                 USR Description
     C                   Z-ADD     WCEXDT        $YEXDT                         Market Pricing
     C                   Z-ADD     WCTLDT        $YTLDT                         OD Market Endin
     C                   EVAL      $YCOAA = ' '                                 CIR Resource No
     C                   Z-ADD     WCC4NB        $YC4NB                         Order Number
     C                   Z-ADD     *ZERO         $YTNDT                         Production AgeD
     C                   Z-ADD     *ZERO         $YTODT                         Production AgeD
     C                   Z-ADD     WCDUPR        $YDUPR                         Invoice Unit Pr
     C                   Z-ADD     WCB6VL        $YB6VL                         Invoice Extende
     C                   MOVEL     WCFZSX        $YFZSX                         OD Adj Type Ove
     C                   MOVEL     WCF0SX        $YF0SX                         Affect Trade Fu
     C                   MOVEL     WCF1SX        $YF1SX                         Affect Commissi
     C                   MOVEL     WCF2SX        $YF2SX                         Affect Pricing
     C                   MOVEL     WCF3SX        $YF3SX                         Released by Use
     C                   MOVEL     WCF4SX        $YF4SX                         Ord TF Exempt C
     C                   MOVEL     WCF6SX        $YF6SX                         Production Ware
     C                   Z-ADD     WCNTDT        $YNTDT                         Warehouse Palle
     C                   Z-ADD     WCNUDT        $YNUDT                         Consumed Item C
     C                   Z-ADD     WCNVDT        $YNVDT                         Deadline Depart
     C                   Z-ADD     WCNWDT        $YNWDT                         OD Price Type R
     C                   Z-ADD     WCNXDT        $YNXDT                         OD Firm Date
     C                   Z-ADD     WCBUTM        $YBUTM                         Deadline Depart
     C                   Z-ADD     WCTIDT        $YTIDT                         Production Ovr
     C                   Z-ADD     WCTJDT        $YTJDT                         Production Ovr
     C                   Z-ADD     WCBWTM        $YBWTM                         Maximum Net Wei
     C                   Z-ADD     WCBXTM        $YBXTM                         Substitution Li
     C                   Z-ADD     WCBYTM        $YBYTM                         Max Qty to sche
     C                   Z-ADD     WCH5NX        $YH5NX                         Warehouse Palle
     C                   Z-ADD     WCH6NX        $YH6NX                         Warehouse Avg P
     C                   Z-ADD     WCH7NX        $YH7NX                         OD Item Target
     C                   Z-ADD     WCH8NX        $YH8NX                         OD Estimated Gr
     C                   Z-ADD     *ZERO         $YUPNB                         Min Carcass Wei
     C                   Z-ADD     *ZERO         $YUQNB                         Max Carcass Wei
     C                   Z-ADD     WCH9NX        $YH9NX                         OD Maximum Unit
     C                   Z-ADD     WCDVPR        $YDVPR                         Order Gate_Fina
     C                   Z-ADD     WCDXPR        $YDXPR                         OD Gate_Final P
     C                   Z-ADD     WCDYPR        $YDYPR                         OD Weighted Avg
     C                   Z-ADD     WCDZPR        $YDZPR                         OD Original Ord
     C                   Z-ADD     WCGSPR        $YGSPR                         OD Cancel Date
     C                   Z-ADD     WCGTPR        $YGTPR                         OD Unused Prc 7
     C                   Z-ADD     WCGUPR        $YGUPR                         OD Unused Prc 8
     C                   MOVEL     WCHOST        $YHOST                         OD MPR Sent to
     C                   MOVEL     WCHPST        $YHPST                         OD MPR Prc Read
     C                   MOVEL     WCIOST        $YIOST                         OD UnUsed Price
     C                   Z-ADD     WCPEWG        $YPEWG                         Weight Amount E
     C                   MOVEL     WCH2ST        $YH2ST                         OD Spot Buy
     C                   MOVEL     WCH0ST        $YH0ST                         OD Clm Full Ret
     C                   MOVEL     WCH1ST        $YH1ST                         Order Line Erro
     C                   Z-ADD     WCTKDT        $YTKDT                         OD Market Begin
     C                   Z-ADD     WCTMDT        $YTMDT                         OD Atch to Ord
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0JPDT
      * Call print routine
     C                   EXSR      Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : PRT ODA-Acknowledge   PO
     C                   EXSR      UJSUBR                                       Embedded PRTOBJ
      * Embedded PRTOBJ : PRT CA-Acknowledge    PO
     C                   EXSR      UKSUBR                                       Embedded PRTOBJ
      * Embedded PRTOBJ : Print Detail Comment
     C                   EXSR      ULSUBR                                       Embedded PRTOBJ
      * Embedded PRTOBJ : PRT Detail Financials  PO
     C                   EXSR      UMSUBR                                       Embedded PRTOBJ
      * Embedded PRTOBJ : Print Item Brokers
     C                   EXSR      UNSUBR                                       Embedded PRTOBJ
      * Embedded PRTOBJ : Print item/cust brokers
     C                   EXSR      UOSUBR                                       Embedded PRTOBJ
      * USER: Process after print of detail format
     C                   Z-ADD     *ZERO         $YCOWG                         USR Weight   9.
     C                   Z-ADD     *ZERO         WUQTOR                         USR Quantity Or
      *
      *================================================================
     CSR   J2EXIT        ENDSR
      /EJECT
     CSR   J3READ        BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C                   Z-ADD     WCAIC3        WZJ001
     C                   Z-ADD     WCC4NB        WZJ002
     C                   Z-ADD     WCDPNB        WZJ003
      * Read next record
     C                   DOU       W0RSL = 'Y' OR
     C                             W0EOFJ = '1'
     C     KRSJ          READE     @BGWKL1                                90    *
      * Transfer error indicator to EOF flag
     C                   MOVEL     *IN90         W0EOFJ
      * Quit if no record read
      * Select record unless user action states otherwise
     C                   IF        W0EOFJ <> '1'
     C                   MOVEL     'Y'           W0RSL
      * USER: Record selection processing
      * Bypass record if completed, cancelled or on hold
      * CASE: DB1.Detail Line Status is Not eligible for acks.
     C                   IF        WCGMST = 'X'
     C                   MOVEL     'N'           W0RSL                          *Record selecte
     C                   END                                                    *FI
     C                   END                                                    FI
     C                   END                                                    UOD
      *
      * Reset key level breaks
     C                   EVAL      W0JL00 = ' '                                 Company Number
     C                   EVAL      W0JL01 = ' '                                 Order Number
     C                   EVAL      W0JL02 = ' '                                 Order Sequence
      * End of file - Signal all level breaks
     C                   IF        W0EOFJ = '1'
     C                   MOVEL     'Y'           W0JL00                         Company Number
     C                   MOVEL     'Y'           W0JL01                         Order Number
     C                   MOVEL     'Y'           W0JL02                         Order Sequence
     C                   ELSE
      * Next record - Detect level breaks
      * Set on level break indicator
     C                   IF        WCAIC3 <> WZJ001
     C                   MOVEL     'Y'           W0JL00
     C                   END
      * Set on level break indicator
     C                   IF        WCC4NB <> WZJ002 OR
     C                             W0JL00 = 'Y'
     C                   MOVEL     'Y'           W0JL01
     C                   END
      * Set on level break indicator
     C                   IF        WCDPNB <> WZJ003 OR
     C                             W0JL01 = 'Y'
     C                   MOVEL     'Y'           W0JL02
     C                   END
     C                   END
      *================================================================
     CSR   J3EXIT        ENDSR
      /EJECT
     CSR   J4PTOT        BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
      * Signal header format is no longer ready
     C                   IF        W0JL02 = 'Y'
     C                   EVAL      W0JP02 = ' '
     C                   END
      *
     C                   IF        W0JL01 = 'Y'
     C                   MOVEL     'Y'           W0PFM
      * USER: On print of Order Number format
     C     WUJVVA        ADD       WUDLVA        #JJVVA                         USR Extended Am
     C                   ADD       WUDQVA        #JJVVA                         USR Extended Am
     C                   Z-ADD     WUCPWG        #JCPWG                         USR Weight   9.
     C                   Z-ADD     WUBAQT        #JQTOR                         USR Quantity Or
      * 04/22/19 DN S14890-Commented Out 'Qty Sched'.
      * If there is not enough space on the
      * physical page for this format:
     C                   IF        W0PFM = 'Y'
     C     @$PGL         SUB       @$CLN         @$WRK
      * Signal new page required
     C                   IF        @$WRK <= 3
     C                   MOVE      'Y'           W0NEWP
      * Start new page
     C                   EXSR      Q0PRNT
     C                   END
     C                   MOVEL     '0'           *IN79
     C                   IF        WN0001 = 'N'
     C                   MOVEL     '1'           *IN79
     C                   END                                                    *FI
      * Print format
     C                   WRITE     #JKEYTTL
     C                   END
      * Signal header format is no longer ready
     C                   EVAL      W0JP01 = ' '
      * USER: Process after print of Order Number format
     C                   Z-ADD     *ZERO         WUBAQT                         USR Quantity
     C                   Z-ADD     *ZERO         WUQTOR                         USR Quantity Or
      * 04/22/19 DN S14890-Commented Out 'Qty Sched'.
     C                   Z-ADD     *ZERO         WUTRAQ                         USR Transaction
     C                   Z-ADD     *ZERO         WUCPWG                         USR Weight   9.
     C                   Z-ADD     *ZERO         WUAYVA                         Extended Amount
     C                   Z-ADD     *ZERO         WUJVVA                         USR Extended Am
     C                   END
      *
      * Signal header format is no longer ready
     C                   IF        W0JL00 = 'Y'
     C                   EVAL      W0JP00 = ' '
     C                   END
      *
      * USER: On print of final totals format
      *    Accumulate final extended amount including frt & special chrge
     C                   IF        W0EOFJ = '1'
     C                   END
      *
      *================================================================
     CSR   J4EXIT        ENDSR
      /EJECT
     CSR   K0MAIN        BEGSR
      *================================================================
      * PRT ODA-Acknowledge   PO: Mainline
      *================================================================
      * Declare restrictor key work fields
      * Define keylist
     C     KRSK          KLIST
     C                   KFLD                    WQKK01                         Company Number
     C                   KFLD                    WQKK02                         Order Number
     C                   KFLD                    WQKK03                         Order Sequence
     C                   KFLD                    WQKK04                         Order Secondary
      * Setup key
     C                   Z-ADD     WCAIC3        WQKK01                         Company Number
     C                   Z-ADD     WCC4NB        WQKK02                         Order Number
     C                   Z-ADD     WCDPNB        WQKK03                         Order Sequence
     C                   Z-ADD     WCUENB        WQKK04                         Order Secondary
      * Establish starting position
     C     KRSK          SETLL     @HQCPLJ                                      *
      * Read first record with user selection
     C                   EXSR      K3READ
     C                   IF        W0EOFK <> '0'
     C                   ELSE
      * Request all headings
     C                   MOVEL     'Y'           W0KL1P                         First page
     C                   MOVEL     'Y'           W0KL00                         Company Number
     C                   MOVEL     'Y'           W0KL01                         Order Number
     C                   MOVEL     'Y'           W0KL02                         Order Sequence
     C                   MOVEL     'Y'           W0KL03                         Order Secondary
      * Set column headings flag
     C                   MOVE      'Y'           W0KCDT
      * Print report body
      * Prepare heading formats for printing
     C                   DOW       W0EOFK = '0'
     C                   EXSR      K1PHDR
      * Print report detail line
     C                   EXSR      K2PDTL
      * Read next record with user selection
     C                   EXSR      K3READ
      * Print totals
     C                   EXSR      K4PTOT
     C                   END                                                    WOD
     C                   END                                                    FI
      *================================================================
     CSR   K0EXIT        ENDSR
      /EJECT
     CSR   K1PHDR        BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
      * Signal that format is now ready to print
     C                   IF        W0KL1P = 'Y'
     C                   MOVE      'Y'           W0KP1P
     C                   END
      *
      * Signal that format is now ready to print
     C                   IF        W0KL00 = 'Y'
     C                   MOVE      'Y'           W0KP00
     C                   END
      *
      * Signal that format is now ready to print
     C                   IF        W0KL01 = 'Y'
     C                   MOVE      'Y'           W0KP01
     C                   END
      *
      * Signal that format is now ready to print
     C                   IF        W0KL02 = 'Y'
     C                   MOVE      'Y'           W0KP02
     C                   END
      *
      * Signal that format is now ready to print
     C                   IF        W0KL03 = 'Y'
     C                   MOVE      'Y'           W0KP03
     C                   END
      *
      *================================================================
     CSR   K1EXIT        ENDSR
      /EJECT
     CSR   K2PDTL        BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                   Z-ADD     HQAIC3        $ZAIC3                         Company Number
     C                   Z-ADD     HQC4NB        $ZC4NB                         Order Number
     C                   Z-ADD     HQDPNB        $ZDPNB                         Order Sequence
     C                   Z-ADD     HQUENB        $ZUENB                         Order Secondary
     C                   Z-ADD     HQDXNB        $ZDXNB                         Sequence Number
     C                   MOVEL     HQTINA        $ZTINA                         ODA Description
     C                   Z-ADD     HQBKPR        $ZBKPR                         Accrual Rate
     C                   Z-ADD     *ZERO         $ZDTPR                         Unit Price (DSP
     C                   EVAL      $ZYET1 = ' '                                 Accrual Rate Ty
     C                   MOVEL     HQSHSX        $ZSHSX                         Accrual Rate Ty
     C                   MOVEL     HQOKCD        $ZOKCD                         Accrual Type
     C                   MOVEL     HQDSCD        $ZDSCD                         G_L Sub Account
     C                   MOVEL     HQHAST        $ZHAST                         ODA Status 1
     C                   MOVEL     HQHBST        $ZHBST                         ODA Status 2
     C                   MOVEL     HQHCST        $ZHCST                         ODA Status 3
     C                   MOVEL     HQHDST        $ZHDST                         ODA Status 4
     C                   MOVEL     HQHEST        $ZHEST                         ODA Status 5
     C                   MOVEL     HQHFST        $ZHFST                         ODA Status 6
     C                   MOVEL     HQOJCD        $ZOJCD                         Accrual Code
     C                   MOVEL     HQL8AA        $ZL8AA                         Accrual Rate Co
     C                   MOVEL     HQVSST        $ZVSST                         Record Status
     C                   Z-ADD     HQMJDT        $ZMJDT                         Create Date
     C                   Z-ADD     HQBETM        $ZBETM                         Create Time
     C                   MOVEL     HQCCVN        $ZCCVN                         Create User
     C                   MOVEL     HQCDVN        $ZCDVN                         Create Program
     C                   Z-ADD     HQMKDT        $ZMKDT                         Change Date
     C                   Z-ADD     HQBFTM        $ZBFTM                         Change Time
     C                   MOVEL     HQCEVN        $ZCEVN                         Change User
     C                   MOVEL     HQCFVN        $ZCFVN                         Change Program
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0KPDT
      * Call print routine
     C                   EXSR      Q0PRNT
      *
      *================================================================
     CSR   K2EXIT        ENDSR
      /EJECT
     CSR   K3READ        BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C                   Z-ADD     HQAIC3        WZK001
     C                   Z-ADD     HQC4NB        WZK002
     C                   Z-ADD     HQDPNB        WZK003
     C                   Z-ADD     HQUENB        WZK004
      * Read next record
     C                   DOU       W0RSL = 'Y' OR
     C                             W0EOFK = '1'
     C     KRSK          READE     @HQCPLJ                                90    *
      * Transfer error indicator to EOF flag
     C                   MOVEL     *IN90         W0EOFK
      * Quit if no record read
      * Select record unless user action states otherwise
     C                   IF        W0EOFK <> '1'
     C                   MOVEL     'Y'           W0RSL
     C                   END                                                    FI
     C                   END                                                    UOD
      *
      * Reset key level breaks
     C                   EVAL      W0KL00 = ' '                                 Company Number
     C                   EVAL      W0KL01 = ' '                                 Order Number
     C                   EVAL      W0KL02 = ' '                                 Order Sequence
     C                   EVAL      W0KL03 = ' '                                 Order Secondary
      * End of file - Signal all level breaks
     C                   IF        W0EOFK = '1'
     C                   MOVEL     'Y'           W0KL00                         Company Number
     C                   MOVEL     'Y'           W0KL01                         Order Number
     C                   MOVEL     'Y'           W0KL02                         Order Sequence
     C                   MOVEL     'Y'           W0KL03                         Order Secondary
     C                   ELSE
      * Next record - Detect level breaks
      * Set on level break indicator
     C                   IF        HQAIC3 <> WZK001
     C                   MOVEL     'Y'           W0KL00
     C                   END
      * Set on level break indicator
     C                   IF        HQC4NB <> WZK002 OR
     C                             W0KL00 = 'Y'
     C                   MOVEL     'Y'           W0KL01
     C                   END
      * Set on level break indicator
     C                   IF        HQDPNB <> WZK003 OR
     C                             W0KL01 = 'Y'
     C                   MOVEL     'Y'           W0KL02
     C                   END
      * Set on level break indicator
     C                   IF        HQUENB <> WZK004 OR
     C                             W0KL02 = 'Y'
     C                   MOVEL     'Y'           W0KL03
     C                   END
     C                   END
      *================================================================
     CSR   K3EXIT        ENDSR
      /EJECT
     CSR   K4PTOT        BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
      * Signal header format is no longer ready
     C                   IF        W0KL03 = 'Y'
     C                   EVAL      W0KP03 = ' '
     C                   END
      *
      * Signal header format is no longer ready
     C                   IF        W0KL02 = 'Y'
     C                   EVAL      W0KP02 = ' '
     C                   END
      *
      * Signal header format is no longer ready
     C                   IF        W0KL01 = 'Y'
     C                   EVAL      W0KP01 = ' '
     C                   END
      *
      * Signal header format is no longer ready
     C                   IF        W0KL00 = 'Y'
     C                   EVAL      W0KP00 = ' '
     C                   END
      *
     C                   IF        W0EOFK = '1'
     C                   END
      *
      *================================================================
     CSR   K4EXIT        ENDSR
      /EJECT
     CSR   L0MAIN        BEGSR
      *================================================================
      * PRT CA-Acknowledge    PO: Mainline
      *================================================================
      * Declare restrictor key work fields
      * Define keylist
     C     KRSL          KLIST
     C                   KFLD                    WQKL01                         Ship To Custome
      * Setup key
     C                   Z-ADD     WCBKC7        WQKL01                         Ship To Custome
      * Establish starting position
     C     KRSL          SETLL     @HORELA                                      *
      * Read first record with user selection
     C                   EXSR      L3READ
     C                   IF        W0EOFL <> '0'
     C                   ELSE
      * Request all headings
     C                   MOVEL     'Y'           W0LL1P                         First page
     C                   MOVEL     'Y'           W0LL00                         Ship To Custome
     C                   MOVEL     'Y'           W0LL01                         Accrual Code
      * Set column headings flag
     C                   MOVE      'Y'           W0LCDT
      * Print report body
      * Prepare heading formats for printing
     C                   DOW       W0EOFL = '0'
     C                   EXSR      L1PHDR
      * Print report detail line
     C                   EXSR      L2PDTL
      * Read next record with user selection
     C                   EXSR      L3READ
      * Print totals
     C                   EXSR      L4PTOT
     C                   END                                                    WOD
     C                   END                                                    FI
      *================================================================
     CSR   L0EXIT        ENDSR
      /EJECT
     CSR   L1PHDR        BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
      * Signal that format is now ready to print
     C                   IF        W0LL1P = 'Y'
     C                   MOVE      'Y'           W0LP1P
     C                   END
      *
      * Signal that format is now ready to print
     C                   IF        W0LL00 = 'Y'
     C                   MOVE      'Y'           W0LP00
     C                   END
      *
      * Signal that format is now ready to print
     C                   IF        W0LL01 = 'Y'
     C                   MOVE      'Y'           W0LP01
     C                   END
      *
      *================================================================
     CSR   L1EXIT        ENDSR
      /EJECT
     CSR   L2PDTL        BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                   Z-ADD     HOBKC7        #ABKC7                         Ship To Custome
     C                   MOVEL     HOOJCD        #AOJCD                         Accrual Code
     C                   Z-ADD     HOGUNY        #AGUNY                         CAH Sequence No
     C                   Z-ADD     HOBFDT        #ABFDT                         Period Beginnin
     C                   EVAL      #AQZNA = ' '                                 Accrual Descrip
     C                   Z-ADD     *ZERO         #AUJNY                         Accrual Rate US
     C                   Z-ADD     HOA2DT        #AA2DT                         Period Ending D
     C                   Z-ADD     HOBKPR        #ABKPR                         Accrual Rate
     C                   EVAL      #AYET1 = ' '                                 Accrual Rate Ty
     C                   MOVEL     HOTTST        #ATTST                         All Products_Y_
     C                   MOVEL     HOSHSX        #ASHSX                         Accrual Rate Ty
     C                   MOVEL     HOQDSX        #AQDSX                         Comm Threshold
     C                   Z-ADD     HOPJDT        #APJDT                         CAH Unused Date
     C                   Z-ADD     HOPKDT        #APKDT                         CAH Unused Date
     C                   Z-ADD     HOECVL        #AECVL                         Comm Min Amt_Pe
     C                   MOVEL     HOQESX        #AQESX                         Comm Retroactiv
     C                   MOVEL     HOQFSX        #AQFSX                         Accrual Detail
     C                   MOVEL     HOHHAA        #AHHAA                         Broker Code
     C                   Z-ADD     HOHQVL        #AHQVL                         Max Accrual Amo
     C                   MOVEL     HOQGSX        #AQGSX                         Commission_Not
     C                   MOVEL     HOQHSX        #AQHSX                         CAH Unused Sts
     C                   MOVEL     HOQISX        #AQISX                         CAH Unused Sts
     C                   MOVEL     HOQJSX        #AQJSX                         CAH Unused Sts
     C                   MOVEL     HOUVST        #AUVST                         EDI Status 1
     C                   MOVEL     HOUWST        #AUWST                         EDI Status 2
     C                   MOVEL     HOUXST        #AUXST                         EDI Status 3
     C                   Z-ADD     HOAATM        #AAATM                         Job Time
     C                   MOVEL     HOAYNA        #AAYNA                         User Id
     C                   MOVEL     HOA0NA        #AA0NA                         Job Name
     C                   Z-ADD     HOAXDT        #AAXDT                         Job Date
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0LPDT
      * Call print routine
     C                   EXSR      Q0PRNT
      *
      *================================================================
     CSR   L2EXIT        ENDSR
      /EJECT
     CSR   L3READ        BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C                   Z-ADD     HOBKC7        WZL001
     C                   MOVEL     HOOJCD        WZL002
      * Read next record
     C                   DOU       W0RSL = 'Y' OR
     C                             W0EOFL = '1'
     C     KRSL          READE     @HORELA                                90    *
      * Transfer error indicator to EOF flag
     C                   MOVEL     *IN90         W0EOFL
      * Quit if no record read
      * Select record unless user action states otherwise
     C                   IF        W0EOFL <> '1'
     C                   MOVEL     'Y'           W0RSL
      * USER: Record selection processing
      * RTV Accrual Info       RT - Accrual Program  * 
     C                   EXSR      SXRVGN
      * SEL:  Allowances Only
      * CASE: LCL.Accrual Type is Allowance
     C                   IF        YL0025 = 'DA' OR
     C                             YL0025 = 'FA'
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'N'           W0RSL                          *Record selecte
     C                   END                                                    *FI
      * LCL.Ship Date USR
      * CASE: PAR.Actual Shipped Date is entered
     C                   IF        WCGNDT <> *ZERO
     C                   Z-ADD     WCGNDT        YL0026                         Ship Date USR
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     WCAODT        YL0026                         Ship Date USR
     C                   END                                                    *FI
      * SEL: Period Begin and End Date
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.Ship Date USR LT DB1.Period Beginning Date
      *   |- c2    : LCL.Ship Date USR GT DB1.Period Ending Date
      *   '-
     C                   IF        YL0026 < HOBFDT OR
     C                             YL0026 > HOA2DT
     C                   MOVEL     'N'           W0RSL                          *Record selecte
     C                   END                                                    *FI
     C                   END                                                    FI
     C                   END                                                    UOD
      *
      * Reset key level breaks
     C                   EVAL      W0LL00 = ' '                                 Ship To Custome
     C                   EVAL      W0LL01 = ' '                                 Accrual Code
      * End of file - Signal all level breaks
     C                   IF        W0EOFL = '1'
     C                   MOVEL     'Y'           W0LL00                         Ship To Custome
     C                   MOVEL     'Y'           W0LL01                         Accrual Code
     C                   ELSE
      * Next record - Detect level breaks
      * Set on level break indicator
     C                   IF        HOBKC7 <> WZL001
     C                   MOVEL     'Y'           W0LL00
     C                   END
      * Set on level break indicator
     C                   IF        HOOJCD <> WZL002 OR
     C                             W0LL00 = 'Y'
     C                   MOVEL     'Y'           W0LL01
     C                   END
     C                   END
      *================================================================
     CSR   L3EXIT        ENDSR
      /EJECT
     CSR   L4PTOT        BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
      * Signal header format is no longer ready
     C                   IF        W0LL01 = 'Y'
     C                   EVAL      W0LP01 = ' '
     C                   END
      *
      * Signal header format is no longer ready
     C                   IF        W0LL00 = 'Y'
     C                   EVAL      W0LP00 = ' '
     C                   END
      *
     C                   IF        W0EOFL = '1'
     C                   END
      *
      *================================================================
     CSR   L4EXIT        ENDSR
      /EJECT
     CSR   M0MAIN        BEGSR
      *================================================================
      * PRT Detail Comment     PO: Mainline
      *================================================================
      * Declare restrictor key work fields
      * Define keylist
     C     KPSM          KLIST
     C                   KFLD                    WQKM01                         Company Number
     C                   KFLD                    WQKM02                         Order Number
     C                   KFLD                    WQKM03                         Order Sequence
     C                   KFLD                    WQKM04                         Order Secondary
     C                   KFLD                    CPDXNB                         Sequence Number
      * Define keylist
     C     KRSM          KLIST
     C                   KFLD                    WQKM01                         Company Number
     C                   KFLD                    WQKM02                         Order Number
     C                   KFLD                    WQKM03                         Order Sequence
     C                   KFLD                    WQKM04                         Order Secondary
      * Setup key
     C                   Z-ADD     WCAIC3        WQKM01                         Company Number
     C                   Z-ADD     WCC4NB        WQKM02                         Order Number
     C                   Z-ADD     WCDPNB        WQKM03                         Order Sequence
     C                   Z-ADD     WCUENB        WQKM04                         Order Secondary
     C                   Z-ADD     *ZERO         CPDXNB                         Sequence Number
      * Establish starting position
     C     KPSM          SETLL     @CPCPOL                                      *
      * Read first record with user selection
     C                   EXSR      M3READ
     C                   IF        W0EOFM <> '0'
     C                   ELSE
      * Request all headings
     C                   MOVEL     'Y'           W0ML1P                         First page
     C                   MOVEL     'Y'           W0ML00                         Company Number
     C                   MOVEL     'Y'           W0ML01                         Order Number
     C                   MOVEL     'Y'           W0ML02                         Order Sequence
     C                   MOVEL     'Y'           W0ML03                         Order Secondary
      * Set column headings flag
     C                   MOVE      'Y'           W0MCDT
      * Print report body
      * Prepare heading formats for printing
     C                   DOW       W0EOFM = '0'
     C                   EXSR      M1PHDR
      * Print report detail line
     C                   EXSR      M2PDTL
      * Read next record with user selection
     C                   EXSR      M3READ
      * Print totals
     C                   EXSR      M4PTOT
     C                   END                                                    WOD
     C                   END                                                    FI
      *================================================================
     CSR   M0EXIT        ENDSR
      /EJECT
     CSR   M1PHDR        BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
      * Signal that format is now ready to print
     C                   IF        W0ML1P = 'Y'
     C                   MOVE      'Y'           W0MP1P
     C                   END
      *
      * Signal that format is now ready to print
     C                   IF        W0ML00 = 'Y'
     C                   MOVE      'Y'           W0MP00
     C                   END
      *
      * Signal that format is now ready to print
     C                   IF        W0ML01 = 'Y'
     C                   MOVE      'Y'           W0MP01
     C                   END
      *
      * Signal that format is now ready to print
     C                   IF        W0ML02 = 'Y'
     C                   MOVE      'Y'           W0MP02
     C                   END
      *
      * Load key header format
     C                   IF        W0ML03 = 'Y'
     C                   Z-ADD     CPAIC3        #BAIC3                         Company Number
     C                   Z-ADD     CPC4NB        #BC4NB                         Order Number
     C                   Z-ADD     CPDPNB        #BDPNB                         Order Sequence
     C                   Z-ADD     CPUENB        #BUENB                         Order Secondary
      * Load related totals format
     C                   Z-ADD     CPAIC3        #DAIC3                         Company Number
     C                   Z-ADD     CPC4NB        #DC4NB                         Order Number
     C                   Z-ADD     CPDPNB        #DDPNB                         Order Sequence
     C                   Z-ADD     CPUENB        #DUENB                         Order Secondary
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0MP03
     C                   END
      *
      *================================================================
     CSR   M1EXIT        ENDSR
      /EJECT
     CSR   M2PDTL        BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                   Z-ADD     CPAIC3        #CAIC3                         Company Number
     C                   Z-ADD     CPC4NB        #CC4NB                         Order Number
     C                   Z-ADD     CPDPNB        #CDPNB                         Order Sequence
     C                   Z-ADD     CPUENB        #CUENB                         Order Secondary
     C                   MOVEL     CPG4NA        #CG4NA                         Comment Text
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0MPDT
      * Call print routine
     C                   EXSR      Q0PRNT
      *
      *================================================================
     CSR   M2EXIT        ENDSR
      /EJECT
     CSR   M3READ        BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C                   Z-ADD     CPAIC3        WZM001
     C                   Z-ADD     CPC4NB        WZM002
     C                   Z-ADD     CPDPNB        WZM003
     C                   Z-ADD     CPUENB        WZM004
      * Read next record
     C                   DOU       W0RSL = 'Y' OR
     C                             W0EOFM = '1'
     C     KRSM          READE     @CPCPOL                                90    *
      * Transfer error indicator to EOF flag
     C                   MOVEL     *IN90         W0EOFM
      * Quit if no record read
      * Select record unless user action states otherwise
     C                   IF        W0EOFM <> '1'
     C                   MOVEL     'Y'           W0RSL
     C                   END                                                    FI
     C                   END                                                    UOD
      *
      * Reset key level breaks
     C                   EVAL      W0ML00 = ' '                                 Company Number
     C                   EVAL      W0ML01 = ' '                                 Order Number
     C                   EVAL      W0ML02 = ' '                                 Order Sequence
     C                   EVAL      W0ML03 = ' '                                 Order Secondary
      * End of file - Signal all level breaks
     C                   IF        W0EOFM = '1'
     C                   MOVEL     'Y'           W0ML00                         Company Number
     C                   MOVEL     'Y'           W0ML01                         Order Number
     C                   MOVEL     'Y'           W0ML02                         Order Sequence
     C                   MOVEL     'Y'           W0ML03                         Order Secondary
     C                   ELSE
      * Next record - Detect level breaks
      * Set on level break indicator
     C                   IF        CPAIC3 <> WZM001
     C                   MOVEL     'Y'           W0ML00
     C                   END
      * Set on level break indicator
     C                   IF        CPC4NB <> WZM002 OR
     C                             W0ML00 = 'Y'
     C                   MOVEL     'Y'           W0ML01
     C                   END
      * Set on level break indicator
     C                   IF        CPDPNB <> WZM003 OR
     C                             W0ML01 = 'Y'
     C                   MOVEL     'Y'           W0ML02
     C                   END
      * Set on level break indicator
     C                   IF        CPUENB <> WZM004 OR
     C                             W0ML02 = 'Y'
     C                   MOVEL     'Y'           W0ML03
     C                   END
     C                   END
      *================================================================
     CSR   M3EXIT        ENDSR
      /EJECT
     CSR   M4PTOT        BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
      * If there is not enough space on the
      * physical page for this format:
     C                   IF        W0ML03 = 'Y'
     C     @$PGL         SUB       @$CLN         @$WRK
      * Signal new page required
     C                   IF        @$WRK <= 2
     C                   MOVE      'Y'           W0NEWP
      * Start new page
     C                   EXSR      Q0PRNT
     C                   END
      * Print format
     C                   WRITE     #DKEYTTL
      * Signal header format is no longer ready
     C                   EVAL      W0MP03 = ' '
     C                   END
      *
      * Signal header format is no longer ready
     C                   IF        W0ML02 = 'Y'
     C                   EVAL      W0MP02 = ' '
     C                   END
      *
      * Signal header format is no longer ready
     C                   IF        W0ML01 = 'Y'
     C                   EVAL      W0MP01 = ' '
     C                   END
      *
      * Signal header format is no longer ready
     C                   IF        W0ML00 = 'Y'
     C                   EVAL      W0MP00 = ' '
     C                   END
      *
     C                   IF        W0EOFM = '1'
     C                   END
      *
      *================================================================
     CSR   M4EXIT        ENDSR
      /EJECT
     CSR   N0MAIN        BEGSR
      *================================================================
      * PRT Detail Financials  PO: Mainline
      *================================================================
      * Declare restrictor key work fields
      * Define keylist
     C     KRSN          KLIST
     C                   KFLD                    WQKN01                         Company Number
     C                   KFLD                    WQKN02                         Order Number
     C                   KFLD                    WQKN03                         Order Sequence
      * Setup key
     C                   Z-ADD     #JAIC3        WQKN01                         Company Number
     C                   Z-ADD     WCC4NB        WQKN02                         Order Number
     C                   Z-ADD     WCDPNB        WQKN03                         Order Sequence
      * Establish starting position
     C     KRSN          SETLL     @CRWKL1                                      *
      * Read first record with user selection
     C                   EXSR      N3READ
     C                   IF        W0EOFN <> '0'
     C                   ELSE
      * Request all headings
     C                   MOVEL     'Y'           W0NL1P                         First page
     C                   MOVEL     'Y'           W0NL00                         Company Number
     C                   MOVEL     'Y'           W0NL01                         Order Number
     C                   MOVEL     'Y'           W0NL02                         Order Sequence
     C                   MOVEL     'Y'           W0NL03                         Order Secondary
      * Set column headings flag
     C                   MOVE      'Y'           W0NCDT
      * Print report body
      * Prepare heading formats for printing
     C                   DOW       W0EOFN = '0'
     C                   EXSR      N1PHDR
      * Print report detail line
     C                   EXSR      N2PDTL
      * Read next record with user selection
     C                   EXSR      N3READ
      * Print totals
     C                   EXSR      N4PTOT
     C                   END                                                    WOD
     C                   END                                                    FI
      *================================================================
     CSR   N0EXIT        ENDSR
      /EJECT
     CSR   N1PHDR        BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
      * Signal that format is now ready to print
     C                   IF        W0NL1P = 'Y'
     C                   MOVE      'Y'           W0NP1P
     C                   END
      *
      * Signal that format is now ready to print
     C                   IF        W0NL00 = 'Y'
     C                   MOVE      'Y'           W0NP00
     C                   END
      *
      * Signal that format is now ready to print
     C                   IF        W0NL01 = 'Y'
     C                   MOVE      'Y'           W0NP01
     C                   END
      *
      * Signal that format is now ready to print
     C                   IF        W0NL02 = 'Y'
     C                   MOVE      'Y'           W0NP02
     C                   END
      *
      * Signal that format is now ready to print
     C                   IF        W0NL03 = 'Y'
     C                   MOVE      'Y'           W0NP03
     C                   END
      *
      *================================================================
     CSR   N1EXIT        ENDSR
      /EJECT
     CSR   N2PDTL        BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                   Z-ADD     N1AIC3        #EAIC3                         Company Number
     C                   Z-ADD     N1C4NB        #EC4NB                         Order Number
     C                   Z-ADD     N1DPNB        #EDPNB                         Order Sequence
     C                   Z-ADD     N1UENB        #EUENB                         Order Secondary
     C                   MOVEL     N1G4ST        #EG4ST                         Financial Type
     C                   MOVEL     N1G5NA        #EG5NA                         Financial Text
     C                   Z-ADD     N1SANB        #ESANB                         Special Charge
     C                   Z-ADD     N1BSVA        #EBSVA                         Transaction Amo
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0NPDT
      * Call print routine
     C                   EXSR      Q0PRNT
      *
      *================================================================
     CSR   N2EXIT        ENDSR
      /EJECT
     CSR   N3READ        BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C                   Z-ADD     N1AIC3        WZN001
     C                   Z-ADD     N1C4NB        WZN002
     C                   Z-ADD     N1DPNB        WZN003
     C                   Z-ADD     N1UENB        WZN004
      * Read next record
     C                   DOU       W0RSL = 'Y' OR
     C                             W0EOFN = '1'
     C     KRSN          READE     @CRWKL1                                90    *
      * Transfer error indicator to EOF flag
     C                   MOVEL     *IN90         W0EOFN
      * Quit if no record read
      * Select record unless user action states otherwise
     C                   IF        W0EOFN <> '1'
     C                   MOVEL     'Y'           W0RSL
     C                   END                                                    FI
     C                   END                                                    UOD
      *
      * Reset key level breaks
     C                   EVAL      W0NL00 = ' '                                 Company Number
     C                   EVAL      W0NL01 = ' '                                 Order Number
     C                   EVAL      W0NL02 = ' '                                 Order Sequence
     C                   EVAL      W0NL03 = ' '                                 Order Secondary
      * End of file - Signal all level breaks
     C                   IF        W0EOFN = '1'
     C                   MOVEL     'Y'           W0NL00                         Company Number
     C                   MOVEL     'Y'           W0NL01                         Order Number
     C                   MOVEL     'Y'           W0NL02                         Order Sequence
     C                   MOVEL     'Y'           W0NL03                         Order Secondary
     C                   ELSE
      * Next record - Detect level breaks
      * Set on level break indicator
     C                   IF        N1AIC3 <> WZN001
     C                   MOVEL     'Y'           W0NL00
     C                   END
      * Set on level break indicator
     C                   IF        N1C4NB <> WZN002 OR
     C                             W0NL00 = 'Y'
     C                   MOVEL     'Y'           W0NL01
     C                   END
      * Set on level break indicator
     C                   IF        N1DPNB <> WZN003 OR
     C                             W0NL01 = 'Y'
     C                   MOVEL     'Y'           W0NL02
     C                   END
      * Set on level break indicator
     C                   IF        N1UENB <> WZN004 OR
     C                             W0NL02 = 'Y'
     C                   MOVEL     'Y'           W0NL03
     C                   END
     C                   END
      *================================================================
     CSR   N3EXIT        ENDSR
      /EJECT
     CSR   N4PTOT        BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
      * Signal header format is no longer ready
     C                   IF        W0NL03 = 'Y'
     C                   EVAL      W0NP03 = ' '
     C                   END
      *
      * Signal header format is no longer ready
     C                   IF        W0NL02 = 'Y'
     C                   EVAL      W0NP02 = ' '
     C                   END
      *
      * Signal header format is no longer ready
     C                   IF        W0NL01 = 'Y'
     C                   EVAL      W0NP01 = ' '
     C                   END
      *
      * Signal header format is no longer ready
     C                   IF        W0NL00 = 'Y'
     C                   EVAL      W0NP00 = ' '
     C                   END
      *
     C                   IF        W0EOFN = '1'
     C                   END
      *
      *================================================================
     CSR   N4EXIT        ENDSR
      /EJECT
     CSR   O0MAIN        BEGSR
      *================================================================
      * PRT Item Brokers       PO: Mainline
      *================================================================
      * Declare restrictor key work fields
      * Define keylist
     C     KRSO          KLIST
     C                   KFLD                    WQKO01                         Company Number
     C                   KFLD                    WQKO02                         Item Code
      * Setup key
     C                   Z-ADD     $YAIC3        WQKO01                         Company Number
     C                   Z-ADD     $YHGCD        WQKO02                         Item Code
      * Establish starting position
     C     KRSO          SETLL     @GKCPGR                                      *
      * Read first record with user selection
     C                   EXSR      O3READ
     C                   IF        W0EOFO <> '0'
     C                   ELSE
      * Request all headings
     C                   MOVEL     'Y'           W0OL1P                         First page
     C                   MOVEL     'Y'           W0OL00                         Company Number
     C                   MOVEL     'Y'           W0OL01                         Item Code
      * Set column headings flag
     C                   MOVE      'Y'           W0OCDT
      * Print report body
      * Prepare heading formats for printing
     C                   DOW       W0EOFO = '0'
     C                   EXSR      O1PHDR
      * Print report detail line
     C                   EXSR      O2PDTL
      * Read next record with user selection
     C                   EXSR      O3READ
      * Print totals
     C                   EXSR      O4PTOT
     C                   END                                                    WOD
     C                   END                                                    FI
      *================================================================
     CSR   O0EXIT        ENDSR
      /EJECT
     CSR   O1PHDR        BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
      * Signal that format is now ready to print
     C                   IF        W0OL1P = 'Y'
     C                   MOVE      'Y'           W0OP1P
     C                   END
      *
      * Signal that format is now ready to print
     C                   IF        W0OL00 = 'Y'
     C                   MOVE      'Y'           W0OP00
     C                   END
      *
      * Signal that format is now ready to print
     C                   IF        W0OL01 = 'Y'
     C                   MOVE      'Y'           W0OP01
     C                   END
      *
      *================================================================
     CSR   O1EXIT        ENDSR
      /EJECT
     CSR   O2PDTL        BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                   Z-ADD     GKAIC3        #FAIC3                         Company Number
     C                   MOVEL     GKR4CD        #FR4CD                         Sales Route Cod
     C                   EVAL      #FC4TX = ' '                                 USR Salesperson
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0OPDT
      * Call print routine
     C                   EXSR      Q0PRNT
      *
      *================================================================
     CSR   O2EXIT        ENDSR
      /EJECT
     CSR   O3READ        BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C                   Z-ADD     GKAIC3        WZO001
     C                   Z-ADD     GKHGCD        WZO002
      * Read next record
     C                   DOU       W0RSL = 'Y' OR
     C                             W0EOFO = '1'
     C     KRSO          READE     @GKCPGR                                90    *
      * Transfer error indicator to EOF flag
     C                   MOVEL     *IN90         W0EOFO
      * Quit if no record read
      * Select record unless user action states otherwise
     C                   IF        W0EOFO <> '1'
     C                   MOVEL     'Y'           W0RSL
     C                   END                                                    FI
     C                   END                                                    UOD
      *
      * Reset key level breaks
     C                   EVAL      W0OL00 = ' '                                 Company Number
     C                   EVAL      W0OL01 = ' '                                 Item Code
      * End of file - Signal all level breaks
     C                   IF        W0EOFO = '1'
     C                   MOVEL     'Y'           W0OL00                         Company Number
     C                   MOVEL     'Y'           W0OL01                         Item Code
     C                   ELSE
      * Next record - Detect level breaks
      * Set on level break indicator
     C                   IF        GKAIC3 <> WZO001
     C                   MOVEL     'Y'           W0OL00
     C                   END
      * Set on level break indicator
     C                   IF        GKHGCD <> WZO002 OR
     C                             W0OL00 = 'Y'
     C                   MOVEL     'Y'           W0OL01
     C                   END
     C                   END
      *================================================================
     CSR   O3EXIT        ENDSR
      /EJECT
     CSR   O4PTOT        BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
      * Signal header format is no longer ready
     C                   IF        W0OL01 = 'Y'
     C                   EVAL      W0OP01 = ' '
     C                   END
      *
      * Signal header format is no longer ready
     C                   IF        W0OL00 = 'Y'
     C                   EVAL      W0OP00 = ' '
     C                   END
      *
     C                   IF        W0EOFO = '1'
     C                   END
      *
      *================================================================
     CSR   O4EXIT        ENDSR
      /EJECT
     CSR   Q0PRNT        BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                   EXSR      Q1FSEL
      * Calculate length of formats selected for printing
     C                   EXSR      Q2PLEN
      * Add column heading length to print length
     C                   ADD       W0COLN        W0FSUM
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C                   IF        W0NEWP <> 'Y'
     C                   IF        W0FSUM > W0OFL
     C                   MOVE      'Y'           W0NEWP
     C                   ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                   ADD       W0DTLN        W0FSUM
     C                   IF        W0FSUM > W0PGL
     C                   MOVE      'Y'           W0NEWP
     C                   END
     C                   END
     C                   END
      * Print Standard report header of PRT Acknowledgements   PF
      * If it is ready to print, then do so,
     C                   IF        W0NEWP = 'Y'
     C                   EXSR      Q3PTNP
     C                   END                                                    FI
      *
      * Print First Page Format of PRT Acknowledgements   PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0AP1P = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0AP1P = 'P'
     C                   EVALR     W0AP1P = ' '
      * Clear first page flag.
     C                   EVALR     W0AL1P = ' '
     C                   END                                                    FI
      * Print Company Number of PRT Acknowledgements   PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0AP00 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0AP00 = 'P'
     C                   EVALR     W0AP00 = ' '
     C                   END                                                    FI
      * Print Order Number of PRT Acknowledgements   PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C                   IF        W0AP01 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0AP01 = 'P'
     C                   MOVEL     'Y'           W0PFM
      * USER: On print of Order Number format
      *  Print first 8 positions of order type description
      * Rtv Order Types       RT - OP Order Types  * 
     C                   EXSR      SCRVGN
      * Set reference heading
      * CASE: WRK.Billing Activity Type is Credit Memo
     C                   IF        WUOBST = '2'
     C                   MOVEL     @CN(001)      $CHJNA                         USR Heading - 8
     C                   ELSE
      * CASE: WRK.Billing Activity Type is Debit Memo
     C                   IF        WUOBST = '3'
     C                   MOVEL     @CN(002)      $CHJNA                         USR Heading - 8
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     @CN(003)      $CHJNA                         USR Heading - 8
     C                   END                                                    *FI
     C                   END                                                    *FI
      * RTV Customer Telephone RT - Customer  * 
     C                   EXSR      SDRVGN
      * RTV Description        RT - PD Sales Route  * 
     C                   EXSR      SERVGN
      * RTV Fax number ff      RT - Customer  * 
     C                   EXSR      SFRVGN
      * 4/7/2004 slm Add concat of Company and Order number
      * 9/30/16 RMC Use CUR. context instead of DB1.  DB1 printed the nex
      *   number in the heading if a page 2 is printed!
     C                   EVAL      WUE6TX = ' '                                 Company Number
     C                   MOVEL     $CAIC3        WUE6TX                         Company Number
     C                   EVAL      WUE7TX = ' '                                 Order Number Al
     C                   MOVEL     $CC4NB        WUE7TX                         Order Number Al
     C                   Z-ADD     *ZEROS        ZQ
     C     WUE6TX        CAT(P)    '-':ZQ        WUABTX                         Alpha Search
     C                   Z-ADD     *ZEROS        ZQ
     C     WUABTX        CAT(P)    WUE7TX:ZQ     WUABTX                         Alpha Search
     C                   MOVEL     WUABTX        $CD4T1                         Company/Order N
      * RTV Prt. Address/Msg   RT - Company Control  * 
     C                   EXSR      SGRVGN
      * If prt Co Addr on Acknow is 'Y' then print Co. Address else defau
      * CASE: PAR.Print Co Addr on Acknow is yes
      * RTV Co Address & Phone RT - Company Name and Address  * 
     C                   IF        P3C2ST = 'Y'
     C                   EXSR      SHRVGN
      * RTV Comprs Nme/Add/CtryUS - /UT User Source  * Ship To Address
      * Use this function to compress name/address information
      *
      *
     C                   MOVEL     WUADTX        UUADTX                         Name
     C                   MOVEL     WUACNA        UUACNA                         Address 1
     C                   MOVEL     WUADNA        UUADNA                         Address 2
     C                   MOVEL     WUAENA        UUAENA                         Address 3
     C                   MOVEL     WUAJNA        UUAJNA                         City
     C                   MOVEL     WUBGCD        UUEINA                         State
     C                   MOVEL     WUBTTX        UUBTTX                         Zip
     C                   MOVEL     WUDATX        UUDATX                         Country
     C                   EXSR      UJ1UF
     C                   MOVEL     UAD(1)        $CD8NA
     C                   MOVEL     UAD(2)        $CD9NA
     C                   MOVEL     UAD(3)        $CEANA
     C                   MOVEL     UAD(4)        $CEBNA
     C                   MOVEL     UAD(5)        $CECNA
     C                   MOVEL     UAD(6)        WUKSTX
      *============================================================
      * UJ1UF - COMPRESS NAME/ADDRESS/COUNTRY INFORMATION
      *============================================================
      *
      * FILL OUTPUT ARRAY
     C                   Z-ADD     1             ZQ
     C     @CN(004)      CAT(P)    WUBVTX:ZQ     $CECNA                         USR Company Add
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      $CD8NA = ' '                                 USR Company Add
     C                   MOVEL     @CN(005)      $CD8NA                         USR Company Add
     C                   EVAL      $CD9NA = ' '                                 USR Company Add
     C                   MOVEL     @CN(006)      $CD9NA                         USR Company Add
     C                   EVAL      $CEANA = ' '                                 USR Company Add
     C                   MOVEL     @CN(007)      $CEANA                         USR Company Add
     C                   Z-ADD     2             ZQ
     C     @CN(008)      CAT(P)    @CN(009):ZQ   $CEBNA                         USR Company Add
     C                   EVAL      $CECNA = ' '                                 USR Company Add
     C                   MOVEL     @CN(010)      $CECNA                         USR Company Add
     C                   END                                                    *FI
     C                   Z-ADD     $CAIC3        P6FKNB                         USR Company Num
     C                   MOVEL     $CD4NA        WUD4NA                         USR Comment 1
     C                   MOVEL     $CD5NA        WUD5NA                         USR Comment 2
     C                   MOVEL     $CD6NA        WUD6NA                         USR Comment 3
     C                   MOVEL     $CHHNA        WUHHNA                         USR Comment 4
      * Check Export status
      * CASE: CUR.Export Status is yes
     C                   IF        $CU2ST = 'Y'
     C                   MOVEL     @CN(011)      $CJUNA                         USR Description
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      $CJUNA = ' '                                 USR Description
     C                   END                                                    *FI
     C                   MOVEL     $CU2ST        WUU2ST                         Export Status
     C                   EVAL      P8DATX = ' '                                 Country Descrip
      *      Compress Sold to and Ship to customer addresses
      * RTV Country Code       RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     $CBKC7        WL0001                         Ship To Custome
     C                   EXSR      SIRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0002        P8KXCD                         Country Code
      * Print country if not USA
      * CASE: PAR.Country Code is USA
     C                   IF        P8KXCD = 'USA'
     C                   MOVEL     'N'           WUD4ST                         USR Flag 1
      * ** 05/11/2007 LJB FP1101   Blank out country descr if USA
     C                   EVAL      P8DATX = ' '                                 Country Descrip
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'Y'           WUD4ST                         USR Flag 1
      * RTV Desc, Status       RT - Country  * 
      * Move input parameters to subroutine local variables.
     C                   MOVEL(P)  P8KXCD        WL0003                         Country Code
     C                   EXSR      SJRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0004        P8DATX                         Country Descrip
     C                   MOVEL(P)  WL0005        WUVSST                         Record Status
     C                   END                                                    *FI
     C                   MOVEL     $CBRTX        WUADTX                         Name
     C                   MOVEL     $CHMNA        WUACNA                         Address Line 1
     C                   MOVEL     $CHONA        WUADNA                         Address Line 2
     C                   MOVEL     $CHPNA        WUAENA                         Address Line 3
     C                   MOVEL     $CHNNA        WUAJNA                         City
     C                   MOVEL     $CDBCD        WUEINA                         State
     C                   MOVEL     $CCKTX        WUBTTX                         Zip Postal Code
     C                   MOVEL     P8DATX        WUDATX                         Country Descrip
     C                   EVAL      WUKSTX = ' '                                 USR Country Des
      * RTV Comprs Nme/Add/CtryUS - /UT User Source  * Ship To Address
     C                   MOVEL     WUADTX        UUADTX                         Name
     C                   MOVEL     WUACNA        UUACNA                         Address 1
     C                   MOVEL     WUADNA        UUADNA                         Address 2
     C                   MOVEL     WUAENA        UUAENA                         Address 3
     C                   MOVEL     WUAJNA        UUAJNA                         City
     C                   MOVEL     WUEINA        UUEINA                         State
     C                   MOVEL     WUBTTX        UUBTTX                         Zip
     C                   MOVEL     WUKSTX        UUDATX                         Country
     C                   EXSR      UJ1UF
     C                   MOVEL     UAD(1)        $CGINA
     C                   MOVEL     UAD(2)        $CGJNA
     C                   MOVEL     UAD(3)        $CGKNA
     C                   MOVEL     UAD(4)        $CGLNA
     C                   MOVEL     UAD(5)        $CGMNA
     C                   MOVEL     UAD(6)        $CNWNA
     C                   MOVEL     WUDATX        $CDATX                         Country Descrip
      * RTV Country Code       RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     $CB0C7        WL0001                         Ship To Custome
     C                   EXSR      SIRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0002        P8KXCD                         Country Code
      * Print country if not USA
      * CASE: PAR.Country Code is USA
     C                   IF        P8KXCD = 'USA'
     C                   MOVEL     'N'           WUUFL2                         USR Flag 2
      * ** 05/11/2007 LJB FP1101   Blank out country descr if USA
     C                   EVAL      P8DATX = ' '                                 Country Descrip
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'Y'           WUUFL2                         USR Flag 2
      * RTV Desc, Status       RT - OM Country  * 
      * Move input parameters to subroutine local variables.
     C                   MOVEL(P)  P8KXCD        WL0003                         Country Code
     C                   EXSR      SJRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0004        P8DATX                         Country Descrip
     C                   MOVEL(P)  WL0005        WUVSST                         Record Status
     C                   END                                                    *FI
     C                   MOVEL     $CAETX        WUADTX                         Name
     C                   MOVEL     $CB1NA        WUACNA                         Address Line 1
     C                   MOVEL     $CB3NA        WUADNA                         Address Line 2
     C                   MOVEL     $CB4NA        WUAENA                         Address Line 3
     C                   MOVEL     $CB2NA        WUAJNA                         City
     C                   MOVEL     $CBHCD        WUEINA                         State
     C                   MOVEL     $CC8TX        WUBTTX                         Zip Postal Code
     C                   MOVEL     P8DATX        WUDATX                         Country Descrip
     C                   EVAL      WUW4TX = ' '                                 Blank for 30
      * RTV Comprs Nme/Add/CtryUS - /UT User Source  * Ship To Address
     C                   MOVEL     WUADTX        UUADTX                         Name
     C                   MOVEL     WUACNA        UUACNA                         Address 1
     C                   MOVEL     WUADNA        UUADNA                         Address 2
     C                   MOVEL     WUAENA        UUAENA                         Address 3
     C                   MOVEL     WUAJNA        UUAJNA                         City
     C                   MOVEL     WUEINA        UUEINA                         State
     C                   MOVEL     WUBTTX        UUBTTX                         Zip
     C                   MOVEL     WUW4TX        UUDATX                         Country
     C                   EXSR      UJ1UF
     C                   MOVEL     UAD(1)        $CGNNA
     C                   MOVEL     UAD(2)        $CGONA
     C                   MOVEL     UAD(3)        $CGPNA
     C                   MOVEL     UAD(4)        $CGQNA
     C                   MOVEL     UAD(5)        $CGRNA
     C                   MOVEL     UAD(6)        $CNXNA
     C                   MOVEL     WUDATX        $CDATX                         Country Descrip
      * RTV 1st Warehouse/UOM  RT - Order Detail  * 
     C                   EXSR      SKRVGN
      * RTV Country Code only  RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     $CAIC3        WL0006                         Company Number
     C                   Z-ADD     $CC4NB        WL0007                         Order Number
     C                   EXSR      SLRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0008        YL0002                         Country Code
      * RMC oms026  5/4/6 for russian, use "E" document type
      * CASE: LCL.Country Code is Russia
      * R16637 DN 10/07/20-Replaced Function to Get Other Cnsgnr/Cnsgne I
      * Rtv Consignee/Consgnr2 RT - Export Doc Order Hdr  * 
      * Move input parameters to subroutine local variables.
     C                   IF        YL0002 = 'RUS'
     C                   Z-ADD     $CAIC3        WL0009                         Company Number
     C                   Z-ADD     $CC4NB        WL0010                         Order Number
     C                   MOVEL(P)  'E'           WL0011                         ED Export Docum
     C                   EXSR      SMRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0012        YL0003                         Country Code
     C                   MOVEL(P)  WL0013        $CPUTX                         ED Consignor Na
     C                   MOVEL(P)  WL0014        $CPVTX                         ED Consignor Ad
     C                   MOVEL(P)  WL0015        $CPWTX                         ED Consignor Ad
     C                   MOVEL(P)  WL0016        $CRVTX                         ED Consignor Ad
     C                   MOVEL(P)  WL0017        $CPPU1                         ED Consignor Ad
     C                   MOVEL(P)  WL0018        $CZ7AA                         ED Consignor St
     C                   MOVEL(P)  WL0019        $CPDU1                         ED Consignor Po
     C                   MOVEL(P)  WL0020        $CZ8AA                         ED Consignor Co
     C                   MOVEL(P)  WL0021        $CRHTX                         ED Consignee Na
     C                   MOVEL(P)  WL0022        $CRITX                         ED Consignee Ad
     C                   MOVEL(P)  WL0023        $CRJTX                         ED Consignee Ad
     C                   MOVEL(P)  WL0024        $CSCTX                         ED Consignee Ad
     C                   MOVEL(P)  WL0025        $CSDTX                         ED Consignee Ad
     C                   MOVEL(P)  WL0026        $CAAAB                         ED Consignee St
     C                   MOVEL(P)  WL0027        $CPHU1                         ED Consignee Po
     C                   MOVEL(P)  WL0028        $CABAB                         ED Consignee Co
     C                   MOVEL(P)  WL0029        $CORNA                         ED Shipping Mar
     C                   ELSE
      * CASE: *OTHERWISE
      * R16637 DN 10/07/20-Replaced Function to Get Other Cnsgnr/Cnsgne I
      * Rtv Consignee/Consgnr2 RT - Export Doc Order Hdr  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     $CAIC3        WL0009                         Company Number
     C                   Z-ADD     $CC4NB        WL0010                         Order Number
     C                   MOVEL(P)  'H'           WL0011                         ED Export Docum
     C                   EXSR      SMRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0012        YL0003                         Country Code
     C                   MOVEL(P)  WL0013        $CPUTX                         ED Consignor Na
     C                   MOVEL(P)  WL0014        $CPVTX                         ED Consignor Ad
     C                   MOVEL(P)  WL0015        $CPWTX                         ED Consignor Ad
     C                   MOVEL(P)  WL0016        $CRVTX                         ED Consignor Ad
     C                   MOVEL(P)  WL0017        $CPPU1                         ED Consignor Ad
     C                   MOVEL(P)  WL0018        $CZ7AA                         ED Consignor St
     C                   MOVEL(P)  WL0019        $CPDU1                         ED Consignor Po
     C                   MOVEL(P)  WL0020        $CZ8AA                         ED Consignor Co
     C                   MOVEL(P)  WL0021        $CRHTX                         ED Consignee Na
     C                   MOVEL(P)  WL0022        $CRITX                         ED Consignee Ad
     C                   MOVEL(P)  WL0023        $CRJTX                         ED Consignee Ad
     C                   MOVEL(P)  WL0024        $CSCTX                         ED Consignee Ad
     C                   MOVEL(P)  WL0025        $CSDTX                         ED Consignee Ad
     C                   MOVEL(P)  WL0026        $CAAAB                         ED Consignee St
     C                   MOVEL(P)  WL0027        $CPHU1                         ED Consignee Po
     C                   MOVEL(P)  WL0028        $CABAB                         ED Consignee Co
     C                   MOVEL(P)  WL0029        $CORNA                         ED Shipping Mar
     C                   END                                                    *FI
      * R16637 DN 10/07/20-Suppress Consignor/Consignee Blank Address Lin
      * CASE: *OTHERWISE
      * Rtv Live with PHIS    RT - Export Doc Defaults  * 
     C                   EXSR      SNRVGN
      * Fmt Suppress Addr LinesIF
      * CONSIGNOR: Format & Suppress Blank Address Lines.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.ED Consignor Addr 2 is Not Blank
      *   |- c2    : PAR.ED Consignor Addr 3 is Not Blank
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        $CPWTX <> ' '
     C                   IF        $CRVTX <> ' '
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
      * If Addr4/City is Entered then Concat State & Zip.
      * CASE: PAR.ED Consignor Addr 4 is Not Blank
     C                   IF        Y0CX01 = '1'
     C                   IF        $CPPU1 <> ' '
     C                   Z-ADD     1             ZQ
     C     $CPPU1        CAT(P)    $CZ7AA:ZQ     $CPPU1                         ED Consignor Ad
     C                   Z-ADD     1             ZQ
     C     $CPPU1        CAT(P)    $CPDU1:ZQ     $CPPU1                         ED Consignor Ad
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
      * Check Blank Address Lines to Suppress.
      * CASE: PAR.ED Consignor Addr 2 is eq blank
      * Shouldn't have too many scenarios with Addr 2 is blank.
     C                   IF        $CPWTX = ' '
     C                   MOVEL     $CRVTX        $CPWTX                         ED Consignor Ad
     C                   EVAL      $CRVTX = ' '                                 ED Consignor Ad
     C                   END                                                    *FI
      * Check Addr 4/City & Suppress Blank Address Line.
      * CASE: PAR.ED Consignor Addr 4 is eq blank
     C                   IF        $CPPU1 = ' '
     C                   ELSE
      * CASE: *OTHERWISE
      * Addr4/City is Entered, Concat State & Zip.
      * CASE: *OTHERWISE
     C                   Z-ADD     1             ZQ
     C     $CPPU1        CAT(P)    $CZ7AA:ZQ     $CPPU1                         ED Consignor Ad
     C                   Z-ADD     1             ZQ
     C     $CPPU1        CAT(P)    $CPDU1:ZQ     $CPPU1                         ED Consignor Ad
      * CASE: PAR.ED Consignor Addr 2 is Blank
     C                   IF        $CPWTX = ' '
     C                   MOVEL     $CPPU1        $CPWTX                         ED Consignor Ad
     C                   EVAL      $CPPU1 = ' '                                 ED Consignor Ad
     C                   ELSE
      * CASE: PAR.ED Consignor Addr 3 is Blank
     C                   IF        $CRVTX = ' '
     C                   MOVEL     $CPPU1        $CRVTX                         ED Consignor Ad
     C                   EVAL      $CPPU1 = ' '                                 ED Consignor Ad
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * CONSIGNEE: Format & Suppress Blank Address Lines.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.ED Consignee Addr 2 is Not Blank
      *   |- c2    : PAR.ED Consignee Addr 3 is Not Blank
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        $CRJTX <> ' '
     C                   IF        $CSCTX <> ' '
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
      * If Addr4/City is Entered then Concat State & Zip.
      * CASE: PAR.ED Consignee Addr 4 is Not Blank
     C                   IF        Y0CX01 = '1'
     C                   IF        $CSDTX <> ' '
     C                   Z-ADD     1             ZQ
     C     $CSDTX        CAT(P)    $CAAAB:ZQ     $CSDTX                         ED Consignee Ad
     C                   Z-ADD     1             ZQ
     C     $CSDTX        CAT(P)    $CPHU1:ZQ     $CSDTX                         ED Consignee Ad
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
      * Check Blank Address Lines to Suppress.
      * CASE: PAR.ED Consignee Addr 2 is eq blank
      * Shouldn't have too many scenarios with Addr 2 is blank.
     C                   IF        $CRJTX = ' '
     C                   MOVEL     $CSCTX        YL0005                         ED Consignee Ad
     C                   MOVEL     YL0005        $CRJTX                         ED Consignee Ad
     C                   EVAL      $CSCTX = ' '                                 ED Consignee Ad
     C                   MOVEL     YL0006        $CSCTX                         ED Consignee Ad
     C                   END                                                    *FI
      * Check Addr 4/City & Suppress Blank Address Line.
      * CASE: PAR.ED Consignee Addr 4 is eq blank
      * S17055 DN 04/06/21-Concat Consignee State & Zip if Entered.
      * CASE: PAR.ED Consignee Postal is Entered
     C                   IF        $CSDTX = ' '
      * Get State for Domestic Address Else Concat Only Zip Code.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.ED Consignee State is State code not Blanks
      *   |- c2    : PAR.ED Consignee State is Not International
      *   '-
     C                   IF        $CPHU1 <> ' '
     C                   MOVEL     '0'           Y0CX01
     C                   IF        $CAAAB <> ' '
     C                   IF        $CAAAB <> '.'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   EVAL      YL0007 = ' '                                 ED Consignee Ad
     C                   MOVEL     $CAAAB        YL0007                         ED Consignee Ad
     C                   Z-ADD     1             ZQ
     C     YL0007        CAT(P)    $CPHU1:ZQ     YL0007                         ED Consignee Ad
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      YL0007 = ' '                                 ED Consignee Ad
     C                   MOVEL     $CPHU1        YL0007                         ED Consignee Ad
     C                   END                                                    *FI
      * Concat State/Zip to Last Non Blank Address Line.
      * CASE: PAR.ED Consignee Addr 3 is Not Blank
     C                   IF        $CSCTX <> ' '
     C                   Z-ADD     1             ZQ
     C     $CSCTX        CAT(P)    YL0007:ZQ     $CSCTX                         ED Consignee Ad
     C                   ELSE
      * CASE: *OTHERWISE
      * Must Concat on Address 2 Line.
     C                   Z-ADD     1             ZQ
     C     $CRJTX        CAT(P)    YL0007:ZQ     $CRJTX                         ED Consignee Ad
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
      * Addr4/City is Entered, Concat State & Zip.
      * CASE: *OTHERWISE
     C                   Z-ADD     1             ZQ
     C     $CSDTX        CAT(P)    $CAAAB:ZQ     YL0007                         ED Consignee Ad
     C                   Z-ADD     1             ZQ
     C     YL0007        CAT(P)    $CPHU1:ZQ     YL0007                         ED Consignee Ad
      * CASE: PAR.ED Consignee Addr 2 is Blank
     C                   IF        $CRJTX = ' '
     C                   MOVEL     YL0007        $CRJTX                         ED Consignee Ad
     C                   EVAL      $CSDTX = ' '                                 ED Consignee Ad
     C                   MOVEL     YL0006        $CSDTX                         ED Consignee Ad
     C                   ELSE
      * CASE: PAR.ED Consignee Addr 3 is Blank
     C                   IF        $CSCTX = ' '
     C                   MOVEL     YL0007        $CSCTX                         ED Consignee Ad
     C                   EVAL      $CSDTX = ' '                                 ED Consignee Ad
     C                   MOVEL     YL0006        $CSDTX                         ED Consignee Ad
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Get Consignor Country Desc.
      * CASE: PAR.ED Consignor Country Code is Entered
      * Rtv Country Desc       RT - Country  * 
      * Move input parameters to subroutine local variables.
     C                   IF        $CZ8AA <> ' '
     C                   MOVEL(P)  $CZ8AA        WL0030                         Country Code
     C                   EXSR      SORVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0031        $CPSU1                         Country Descrip
      * Move Country Desc to Addr 3 or 4 if Blank.
      * CASE: PAR.ED Consignor Addr 3 is eq blank
     C                   IF        $CRVTX = ' '
     C                   EVAL      $CRVTX = ' '                                 ED Consignor Ad
     C                   MOVEL     $CPSU1        $CRVTX                         ED Consignor Ad
     C                   EVAL      $CPSU1 = ' '                                 Consignor Count
     C                   ELSE
      * CASE: PAR.ED Consignor Addr 4 is eq blank
     C                   IF        $CPPU1 = ' '
     C                   EVAL      $CPPU1 = ' '                                 ED Consignor Ad
     C                   MOVEL     $CPSU1        $CPPU1                         ED Consignor Ad
     C                   EVAL      $CPSU1 = ' '                                 Consignor Count
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Get Consignee Country Desc.
      * CASE: PAR.ED Consignee Country Code is Entered
      * Set 'THE PEOPLE'S REPUBLIC OF CHINA' Else Get Country Desc.
      * CASE: PAR.ED Consignee Country Code is China
     C                   IF        $CABAB <> ' '
     C                   IF        $CABAB = 'CHN'
     C                   Z-ADD     1             ZQ
     C     @CN(012)      CAT(P)    'CHINA':ZQ    $CPTU1                         Consignee Count
     C                   ELSE
      * CASE: *OTHERWISE
      * Rtv Country Desc       RT - Country  * 
      * Move input parameters to subroutine local variables.
     C                   MOVEL(P)  $CABAB        WL0030                         Country Code
     C                   EXSR      SORVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0031        $CPTU1                         Country Descrip
     C                   END                                                    *FI
      * Move Country Desc to Addr 3 or 4 if Blank.
      * CASE: PAR.ED Consignee Addr 3 is eq blank
     C                   IF        $CSCTX = ' '
     C                   EVAL      $CSCTX = ' '                                 ED Consignee Ad
     C                   MOVEL     $CPTU1        $CSCTX                         ED Consignee Ad
     C                   EVAL      $CPTU1 = ' '                                 Consignee Count
     C                   ELSE
      * CASE: PAR.ED Consignee Addr 4 is eq blank
     C                   IF        $CSDTX = ' '
     C                   EVAL      $CSDTX = ' '                                 ED Consignee Ad
     C                   MOVEL     $CPTU1        $CSDTX                         ED Consignee Ad
     C                   EVAL      $CPTU1 = ' '                                 Consignee Count
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * RMC E01457 07/18/2011 MEXico - print destination
      * CASE: LCL.Country Code is Mexico
      * Rtv Destination RemrksRT - Export Doc Order Hdr  * 
     C                   IF        YL0002 = 'MEX'
     C                   EXSR      SPRVGN
      * CASE: CUR.ED Remark Constant 2 is Blank
     C                   IF        $CP3TX = ' '
     C                   EVAL      $CP3TX = ' '                                 ED Remark Const
     C                   MOVEL     @CN(013)      $CP3TX                         ED Remark Const
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      $CP3TX = ' '                                 ED Remark Const
     C                   EVAL      $CP4TX = ' '                                 ED Remark Const
     C                   EVAL      $CP5TX = ' '                                 ED Remark Const
     C                   EVAL      $CP6TX = ' '                                 ED Remark Const
     C                   END                                                    *FI
     C                   MOVEL     YL0002        $CKXCD                         Country Code
      * Convert fields to external form
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C                   IF        W0PFM = 'Y'
     C                   IF        $CBKC7 <> 0
     C                   EVAL      WUEOCD = ' '                                 CD7 Ext Numeric
     C                   MOVEL     $CBKC7        WUEOCD                         CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                   MOVEA     WUEOCD        #L7                            EDIT ARRAY
     C                   Z-ADD     1             #E                3 0
     C                   MOVE      *IN61         UUIN61            1
     C                   SETOFF                                       61
     C                   DO        7
     C     #L7(#E)       IFEQ      '0'                                          ZERO VALUE
     C     *IN61         IFEQ      '0'
     C                   MOVE      ' '           #L7(#E)
     C                   ADD       1             #E
     C                   END
     C                   ELSE
     C                   SETON                                        61
     C                   END
     C                   END
     C                   MOVEA     #L7           WUEOCD
     C                   MOVE      UUIN61        *IN61
     C                   MOVEL     WUEOCD        VCBKC7                         CD7 Ext Numeric
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      VCBKC7 = ' '                                 CD7 Ext Numeric
     C                   END                                                    *FI
      * Convert Bill to Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C                   IF        $CB0C7 <> 0
     C                   EVAL      WUEOCD = ' '                                 CD7 Ext Numeric
     C                   MOVEL     $CB0C7        WUEOCD                         CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                   MOVEA     WUEOCD        #L7                            EDIT ARRAY
     C                   Z-ADD     1             #E                3 0
     C                   MOVE      *IN61         UUIN61            1
     C                   SETOFF                                       61
     C                   DO        7
     C     #L7(#E)       IFEQ      '0'                                          ZERO VALUE
     C     *IN61         IFEQ      '0'
     C                   MOVE      ' '           #L7(#E)
     C                   ADD       1             #E
     C                   END
     C                   ELSE
     C                   SETON                                        61
     C                   END
     C                   END
     C                   MOVEA     #L7           WUEOCD
     C                   MOVE      UUIN61        *IN61
     C                   MOVEL     WUEOCD        VCB0C7                         CD7 Ext Numeric
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      VCB0C7 = ' '                                 CD7 Ext Numeric
     C                   END                                                    *FI
     C                   MOVEL     '0'           *IN79
     C                   IF        YL0002 = ' '
     C                   MOVEL     '1'           *IN79
     C                   END                                                    *FI
     C                   MOVEL     '0'           *IN78
     C                   IF        WUD4NA = ' '
     C                   MOVEL     '1'           *IN78
     C                   END                                                    *FI
     C                   MOVEL     '0'           *IN77
     C                   IF        WUD5NA = ' '
     C                   MOVEL     '1'           *IN77
     C                   END                                                    *FI
     C                   MOVEL     '0'           *IN76
     C                   IF        WUD6NA = ' '
     C                   MOVEL     '1'           *IN76
     C                   END                                                    *FI
     C                   MOVEL     '0'           *IN75
     C                   IF        WUHHNA = ' '
     C                   MOVEL     '1'           *IN75
     C                   END                                                    *FI
     C                   MOVEL     '0'           *IN74
     C                   IF        WUD4ST = 'N'
     C                   MOVEL     '1'           *IN74
     C                   END                                                    *FI
     C                   MOVEL     '0'           *IN73
     C                   IF        WUUFL2 = 'N'
     C                   MOVEL     '1'           *IN73
     C                   END                                                    *FI
     C                   MOVEL     '0'           *IN72
     C                   IF        P1BCST = 'F'
     C                   MOVEL     '1'           *IN72
     C                   END                                                    *FI
     C                   MOVEL     '0'           *IN71
     C                   IF        WUU2ST = 'N'
     C                   MOVEL     '1'           *IN71
     C                   END                                                    *FI
      * Print format
     C                   WRITE     $CKEYHDR
      * Set column headings flag
     C                   MOVE      'Y'           W0ACDT
     C                   END                                                    FI
      *
      * Reset format print flag
     C                   MOVE      'P'           W0AP01
     C                   END                                                    FI
      * Print Ship To Customer of PRT Acknowledgements   PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0AP02 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0AP02 = 'P'
     C                   EVALR     W0AP02 = ' '
     C                   END                                                    FI
      * Print Detail line. of PRT Acknowledgements   PF
      * If new page then set column headings active
     C                   IF        W0NEWP = 'Y'
     C                   MOVE      'Y'           W0ACDT
     C                   END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * USER: On print of detail format
     C                   IF        W0APDT = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0APDT = 'P'
     C                   MOVEL     $DBDST        P1BDST                         Order Certifica
     C                   MOVEL     $DFQSX        P1FQSX                         Export Docs Go
      * Mention hidden format
     C   99
     CANN99              WRITE     $DDTLRCD
      * Reset format print flag
     C                   EVALR     W0APDT = ' '
     C                   END                                                    FI
      * Print First Page Format of PRT Hdr Comment 3/Lne PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0BP1P = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0BP1P = 'P'
     C                   EVALR     W0BP1P = ' '
      * Clear first page flag.
     C                   EVALR     W0BL1P = ' '
     C                   END                                                    FI
      * Print Company Number of PRT Hdr Comment 3/Lne PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0BP00 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0BP00 = 'P'
     C                   EVALR     W0BP00 = ' '
     C                   END                                                    FI
      * Print Order Number of PRT Hdr Comment 3/Lne PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0BP01 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0BP01 = 'P'
     C                   EVALR     W0BP01 = ' '
     C                   END                                                    FI
      * Print Comment Type of PRT Hdr Comment 3/Lne PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Print format
     C                   IF        W0BP02 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0BP02 = 'P'
     C                   WRITE     $EKEYHDR
      * Set column headings flag
     C                   MOVE      'Y'           W0BCDT
      *
      * Reset format print flag
     C                   EVALR     W0BP02 = ' '
     C                   END                                                    FI
      * Print Detail line. of PRT Hdr Comment 3/Lne PO
      * If new page then set column headings active
     C                   IF        W0NEWP = 'Y'
     C                   MOVE      'Y'           W0BCDT
     C                   END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C                   IF        W0BPDT = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0BPDT = 'P'
     C                   MOVEL     'Y'           W0PFM
      * USER: On print of detail format
     C                   Z-ADD     1             ZQ
     C     YL0009        CAT(P)    COG4NA:ZQ     YL0009                         Text 93 USR
     C                   ADD       1             YL0008                         Count USR
      * CASE: LCL.Count USR is Three
     C                   IF        YL0008 = 3
     C                   MOVEL     YL0009        $FOPT1                         Text 93 USR
     C                   Z-ADD     *ZERO         YL0008                         Count USR
     C                   EVAL      YL0009 = ' '                                 Text 93 USR
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'N'           W0PFM                          *Print format
     C                   END                                                    *FI
      * Print column headings if required
     C                   IF        W0PFM = 'Y'
     C                   IF        W0BCDT = 'Y'
     C                   WRITE     $FCOLHDG
      * Clear column headings control flag
     C                   EVALR     W0BCDT = ' '
     C                   END                                                    FI
      * Print format
     C                   WRITE     $FDTLRCD
     C                   END                                                    FI
      *
      * Reset format print flag
     C                   EVALR     W0BPDT = ' '
     C                   END                                                    FI
      * Print First Page Format of PRT Hdr Comment 3/Lne PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0CP1P = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0CP1P = 'P'
     C                   EVALR     W0CP1P = ' '
      * Clear first page flag.
     C                   EVALR     W0CL1P = ' '
     C                   END                                                    FI
      * Print Company Number of PRT Hdr Comment 3/Lne PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0CP00 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0CP00 = 'P'
     C                   EVALR     W0CP00 = ' '
     C                   END                                                    FI
      * Print Order Number of PRT Hdr Comment 3/Lne PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0CP01 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0CP01 = 'P'
     C                   EVALR     W0CP01 = ' '
     C                   END                                                    FI
      * Print Comment Type of PRT Hdr Comment 3/Lne PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Print format
     C                   IF        W0CP02 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0CP02 = 'P'
     C                   WRITE     $HKEYHDR
      * Set column headings flag
     C                   MOVE      'Y'           W0CCDT
      *
      * Reset format print flag
     C                   EVALR     W0CP02 = ' '
     C                   END                                                    FI
      * Print Detail line. of PRT Hdr Comment 3/Lne PO
      * If new page then set column headings active
     C                   IF        W0NEWP = 'Y'
     C                   MOVE      'Y'           W0CCDT
     C                   END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C                   IF        W0CPDT = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0CPDT = 'P'
     C                   MOVEL     'Y'           W0PFM
      * USER: On print of detail format
     C                   Z-ADD     1             ZQ
     C     YL0009        CAT(P)    COG4NA:ZQ     YL0009                         Text 93 USR
     C                   ADD       1             YL0008                         Count USR
      * CASE: LCL.Count USR is Three
     C                   IF        YL0008 = 3
     C                   MOVEL     YL0009        $IOPT1                         Text 93 USR
     C                   Z-ADD     *ZERO         YL0008                         Count USR
     C                   EVAL      YL0009 = ' '                                 Text 93 USR
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'N'           W0PFM                          *Print format
     C                   END                                                    *FI
      * Print column headings if required
     C                   IF        W0PFM = 'Y'
     C                   IF        W0CCDT = 'Y'
     C                   WRITE     $ICOLHDG
      * Clear column headings control flag
     C                   EVALR     W0CCDT = ' '
     C                   END                                                    FI
      * Print format
     C                   WRITE     $IDTLRCD
     C                   END                                                    FI
      *
      * Reset format print flag
     C                   EVALR     W0CPDT = ' '
     C                   END                                                    FI
      * Print First Page Format of PRT Hdr Comment 3/Lne PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0DP1P = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0DP1P = 'P'
     C                   EVALR     W0DP1P = ' '
      * Clear first page flag.
     C                   EVALR     W0DL1P = ' '
     C                   END                                                    FI
      * Print Company Number of PRT Hdr Comment 3/Lne PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0DP00 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0DP00 = 'P'
     C                   EVALR     W0DP00 = ' '
     C                   END                                                    FI
      * Print Order Number of PRT Hdr Comment 3/Lne PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0DP01 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0DP01 = 'P'
     C                   EVALR     W0DP01 = ' '
     C                   END                                                    FI
      * Print Comment Type of PRT Hdr Comment 3/Lne PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Print format
     C                   IF        W0DP02 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0DP02 = 'P'
     C                   WRITE     $KKEYHDR
      * Set column headings flag
     C                   MOVE      'Y'           W0DCDT
      *
      * Reset format print flag
     C                   EVALR     W0DP02 = ' '
     C                   END                                                    FI
      * Print Detail line. of PRT Hdr Comment 3/Lne PO
      * If new page then set column headings active
     C                   IF        W0NEWP = 'Y'
     C                   MOVE      'Y'           W0DCDT
     C                   END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C                   IF        W0DPDT = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0DPDT = 'P'
     C                   MOVEL     'Y'           W0PFM
      * USER: On print of detail format
     C                   Z-ADD     1             ZQ
     C     YL0009        CAT(P)    COG4NA:ZQ     YL0009                         Text 93 USR
     C                   ADD       1             YL0008                         Count USR
      * CASE: LCL.Count USR is Three
     C                   IF        YL0008 = 3
     C                   MOVEL     YL0009        $LOPT1                         Text 93 USR
     C                   Z-ADD     *ZERO         YL0008                         Count USR
     C                   EVAL      YL0009 = ' '                                 Text 93 USR
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'N'           W0PFM                          *Print format
     C                   END                                                    *FI
      * Print column headings if required
     C                   IF        W0PFM = 'Y'
     C                   IF        W0DCDT = 'Y'
     C                   WRITE     $LCOLHDG
      * Clear column headings control flag
     C                   EVALR     W0DCDT = ' '
     C                   END                                                    FI
      * Print format
     C                   WRITE     $LDTLRCD
     C                   END                                                    FI
      *
      * Reset format print flag
     C                   EVALR     W0DPDT = ' '
     C                   END                                                    FI
      * Print First Page Format of PRT Hdr Comment 3/Lne PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0EP1P = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0EP1P = 'P'
     C                   EVALR     W0EP1P = ' '
      * Clear first page flag.
     C                   EVALR     W0EL1P = ' '
     C                   END                                                    FI
      * Print Company Number of PRT Hdr Comment 3/Lne PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0EP00 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0EP00 = 'P'
     C                   EVALR     W0EP00 = ' '
     C                   END                                                    FI
      * Print Order Number of PRT Hdr Comment 3/Lne PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0EP01 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0EP01 = 'P'
     C                   EVALR     W0EP01 = ' '
     C                   END                                                    FI
      * Print Comment Type of PRT Hdr Comment 3/Lne PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Print format
     C                   IF        W0EP02 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0EP02 = 'P'
     C                   WRITE     $NKEYHDR
      * Set column headings flag
     C                   MOVE      'Y'           W0ECDT
      *
      * Reset format print flag
     C                   EVALR     W0EP02 = ' '
     C                   END                                                    FI
      * Print Detail line. of PRT Hdr Comment 3/Lne PO
      * If new page then set column headings active
     C                   IF        W0NEWP = 'Y'
     C                   MOVE      'Y'           W0ECDT
     C                   END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C                   IF        W0EPDT = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0EPDT = 'P'
     C                   MOVEL     'Y'           W0PFM
      * USER: On print of detail format
     C                   Z-ADD     1             ZQ
     C     YL0009        CAT(P)    COG4NA:ZQ     YL0009                         Text 93 USR
     C                   ADD       1             YL0008                         Count USR
      * CASE: LCL.Count USR is Three
     C                   IF        YL0008 = 3
     C                   MOVEL     YL0009        $OOPT1                         Text 93 USR
     C                   Z-ADD     *ZERO         YL0008                         Count USR
     C                   EVAL      YL0009 = ' '                                 Text 93 USR
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'N'           W0PFM                          *Print format
     C                   END                                                    *FI
      * Print column headings if required
     C                   IF        W0PFM = 'Y'
     C                   IF        W0ECDT = 'Y'
     C                   WRITE     $OCOLHDG
      * Clear column headings control flag
     C                   EVALR     W0ECDT = ' '
     C                   END                                                    FI
      * Print format
     C                   WRITE     $ODTLRCD
     C                   END                                                    FI
      *
      * Reset format print flag
     C                   EVALR     W0EPDT = ' '
     C                   END                                                    FI
      * Print First Page Format of PRT Ship Inst 3/Line  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0FP1P = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0FP1P = 'P'
     C                   EVALR     W0FP1P = ' '
      * Clear first page flag.
     C                   EVALR     W0FL1P = ' '
     C                   END                                                    FI
      * Print Company Number of PRT Ship Inst 3/Line  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0FP00 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0FP00 = 'P'
     C                   EVALR     W0FP00 = ' '
     C                   END                                                    FI
      * Print Order Number of PRT Ship Inst 3/Line  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Print format
     C                   IF        W0FP01 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0FP01 = 'P'
     C                   WRITE     $QKEYHDR
      * Set column headings flag
     C                   MOVE      'Y'           W0FCDT
      *
      * Reset format print flag
     C                   MOVE      'P'           W0FP01
     C                   END                                                    FI
      * Print Detail line. of PRT Ship Inst 3/Line  PO
      * If new page then set column headings active
     C                   IF        W0NEWP = 'Y'
     C                   MOVE      'Y'           W0FCDT
     C                   END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C                   IF        W0FPDT = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0FPDT = 'P'
     C                   MOVEL     'Y'           W0PFM
      * USER: On print of detail format
     C                   Z-ADD     1             ZQ
     C     YL0011        CAT(P)    IEMQNA:ZQ     YL0011                         Text 93 USR
     C                   ADD       1             YL0010                         Count USR
      * CASE: LCL.Count USR is Three
     C                   IF        YL0010 = 3
     C                   MOVEL     YL0011        $ROPT1                         Text 93 USR
     C                   Z-ADD     *ZERO         YL0010                         Count USR
     C                   EVAL      YL0011 = ' '                                 Text 93 USR
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'N'           W0PFM                          *Print format
     C                   END                                                    *FI
      * Print column headings if required
     C                   IF        W0PFM = 'Y'
     C                   IF        W0FCDT = 'Y'
     C                   WRITE     $RCOLHDG
      * Clear column headings control flag
     C                   EVALR     W0FCDT = ' '
     C                   END                                                    FI
      * Print format
     C                   WRITE     $RDTLRCD
     C                   END                                                    FI
      *
      * Reset format print flag
     C                   EVALR     W0FPDT = ' '
     C                   END                                                    FI
      * Print First Page Format of Prt Cust Comment PL   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0GP1P = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0GP1P = 'P'
     C                   EVALR     W0GP1P = ' '
      * Clear first page flag.
     C                   EVALR     W0GL1P = ' '
     C                   END                                                    FI
      * Print Ship To Customer of Prt Cust Comment PL   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0GP00 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0GP00 = 'P'
     C                   EVALR     W0GP00 = ' '
     C                   END                                                    FI
      * Print Comment Type of Prt Cust Comment PL   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0GP01 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0GP01 = 'P'
     C                   EVALR     W0GP01 = ' '
     C                   END                                                    FI
      * Print Detail line. of Prt Cust Comment PL   PO
      * If new page then set column headings active
     C                   IF        W0NEWP = 'Y'
     C                   MOVE      'Y'           W0GCDT
     C                   END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C                   IF        W0GPDT = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0GPDT = 'P'
     C                   MOVEL     '0'           *IN79
     C                   IF        WUTMST = 'N'
     C                   MOVEL     '1'           *IN79
     C                   END                                                    *FI
      * Print column headings if required
     C                   IF        W0GCDT = 'Y'
     C                   WRITE     $TCOLHDG
      * Clear column headings control flag
     C                   EVALR     W0GCDT = ' '
     C                   END                                                    FI
      * Print format
     C                   WRITE     $TDTLRCD
      *
      * Reset format print flag
     C                   EVALR     W0GPDT = ' '
     C                   END                                                    FI
      * Print First Page Format of Prt Country Comment   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0HP1P = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0HP1P = 'P'
     C                   EVALR     W0HP1P = ' '
      * Clear first page flag.
     C                   EVALR     W0HL1P = ' '
     C                   END                                                    FI
      * Print Country Code of Prt Country Comment   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0HP00 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0HP00 = 'P'
     C                   EVALR     W0HP00 = ' '
     C                   END                                                    FI
      * Print Comment Type of Prt Country Comment   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0HP01 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0HP01 = 'P'
     C                   EVALR     W0HP01 = ' '
     C                   END                                                    FI
      * Print Detail line. of Prt Country Comment   PO
      * If new page then set column headings active
     C                   IF        W0NEWP = 'Y'
     C                   MOVE      'Y'           W0HCDT
     C                   END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Print column headings if required
     C                   IF        W0HPDT = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0HPDT = 'P'
     C                   IF        W0HCDT = 'Y'
     C                   WRITE     $UCOLHDG
      * Clear column headings control flag
     C                   EVALR     W0HCDT = ' '
     C                   END                                                    FI
      * Print format
     C                   WRITE     $UDTLRCD
      *
      * Reset format print flag
     C                   EVALR     W0HPDT = ' '
     C                   END                                                    FI
      * Print First Page Format of PRT All Orders on Load PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0IP1P = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0IP1P = 'P'
     C                   EVALR     W0IP1P = ' '
      * Clear first page flag.
     C                   EVALR     W0IL1P = ' '
     C                   END                                                    FI
      * Print Load ID of PRT All Orders on Load PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Print format
     C                   IF        W0IP00 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0IP00 = 'P'
     C                   WRITE     $VKEYHDR
      * Set column headings flag
     C                   MOVE      'Y'           W0ICDT
      *
      * Reset format print flag
     C                   EVALR     W0IP00 = ' '
     C                   END                                                    FI
      * Print Detail line. of PRT All Orders on Load PO
      * If new page then set column headings active
     C                   IF        W0NEWP = 'Y'
     C                   MOVE      'Y'           W0ICDT
     C                   END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Convert fields to external form
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C                   IF        W0IPDT = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0IPDT = 'P'
     C                   IF        $WC4NB <> 0
     C                   EVAL      WUEOCD = ' '                                 CD7 Ext Numeric
     C                   MOVEL     $WC4NB        WUEOCD                         CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                   MOVEA     WUEOCD        #L7                            EDIT ARRAY
     C                   Z-ADD     1             #E                3 0
     C                   MOVE      *IN61         UUIN61            1
     C                   SETOFF                                       61
     C                   DO        7
     C     #L7(#E)       IFEQ      '0'                                          ZERO VALUE
     C     *IN61         IFEQ      '0'
     C                   MOVE      ' '           #L7(#E)
     C                   ADD       1             #E
     C                   END
     C                   ELSE
     C                   SETON                                        61
     C                   END
     C                   END
     C                   MOVEA     #L7           WUEOCD
     C                   MOVE      UUIN61        *IN61
     C                   MOVEL     WUEOCD        VWC4NB                         CD7 Ext Numeric
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      VWC4NB = ' '                                 CD7 Ext Numeric
     C                   END                                                    *FI
      * Print column headings if required
     C                   IF        W0ICDT = 'Y'
     C                   WRITE     $WCOLHDG
      * Clear column headings control flag
     C                   EVALR     W0ICDT = ' '
     C                   END                                                    FI
      * Print format
     C                   WRITE     $WDTLRCD
      *
      * Reset format print flag
     C                   EVALR     W0IPDT = ' '
     C                   END                                                    FI
      * Print First Page Format of PRT Detail-Acknowledge PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0JP1P = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0JP1P = 'P'
     C                   EVALR     W0JP1P = ' '
      * Clear first page flag.
     C                   EVALR     W0JL1P = ' '
     C                   END                                                    FI
      * Print Company Number of PRT Detail-Acknowledge PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0JP00 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0JP00 = 'P'
     C                   EVALR     W0JP00 = ' '
     C                   END                                                    FI
      * Print Order Number of PRT Detail-Acknowledge PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C                   IF        W0JP01 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0JP01 = 'P'
     C                   MOVEL     '0'           *IN79
     C                   IF        WN0001 = 'N'
     C                   MOVEL     '1'           *IN79
     C                   END                                                    *FI
      * Print format
     C                   WRITE     $XKEYHDR
      * Set column headings flag
     C                   MOVE      'Y'           W0JCDT
      *
      * Reset format print flag
     C                   MOVE      'P'           W0JP01
     C                   END                                                    FI
      * Print Order Sequence Number of PRT Detail-Acknowledge PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0JP02 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0JP02 = 'P'
     C                   EVALR     W0JP02 = ' '
     C                   END                                                    FI
      * Print Detail line. of PRT Detail-Acknowledge PO
      * If new page then set column headings active
     C                   IF        W0NEWP = 'Y'
     C                   MOVE      'Y'           W0JCDT
     C                   END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C                   IF        W0JPDT = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0JPDT = 'P'
     C                   MOVEL     'Y'           W0PFM
      * USER: On print of detail format
     C     WCAVWG        MULT(H)   WCAVQT        $YCOWG                         USR Weight   9.
     C                   Z-ADD     WCAVQT        $YQTOR                         USR Quantity Or
      * 04/22/19 DN S14890-Commented Out 'Qty Sched'.
     C                   MOVEL     WCG7NA        $YESNA                         USR Description
     C                   Z-ADD     $YAKPR        $YDTPR                         Unit Price (DSP
     C                   ADD       WCAYVA        WUJVVA                         USR Extended Am
     C                   ADD       $YCOWG        WUCPWG                         USR Weight   9.
     C                   ADD       $YQTOR        WUBAQT                         USR Quantity
      * 04/22/19 DN S14890-Commented Out 'Qty Sched'.
     C                   MOVEL     WCRPCD        $YRPCD                         Age Code
     C                   Z-ADD     WCBWTM        WUBWTM                         Maximum Net Wei
     C                   Z-ADD     WCH9NX        WUH9NX                         OD Maximum Unit
     C                   Z-ADD     WCH8NX        WUH8NX                         OD Estimated Gr
     C                   Z-ADD     WCH8NX        $YUPNB                         Min Carcass Wei
     C                   Z-ADD     WCH9NX        $YUQNB                         Max Carcass Wei
      * fp1309 add new calculation
      * fp1309 New rules were established to get the ack list
      * correct for outside warehouses or external warehouse
      * Changes per Sales Group and various parties
      * Due to needing  the pack dates to print on external warehouse
      * and only print these pack dates if the override dates were
      * entered by the users
      * at this time do not calculate the from and to dates
     C                   MOVEL     'A'           $YLBST                         Pack Dates or A
      * this is what we are currently doing is printing the age days
      * regardless of warehouse for external warehouse and the user
      * selected a range of dates
      * RTV Warehouse Location RT - Warehouse  * 
     C                   EXSR      SSRVGN
      * PACK Date
      * CASE: LCL.Warehouse Location is External
      * CASE: DB1.Production Ovr AgeDte Fr is Entered
     C                   IF        YL0022 = 'E'
     C                   IF        WCTIDT <> *ZERO
     C                   MOVEL     'P'           $YLBST                         Pack Dates or A
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Market Pricing Date
      * CASE: DB1.OD Market Begin Date is Entered
     C                   IF        WCTKDT <> *ZERO
     C                   Z-ADD     WCTKDT        $YEXDT                         Market Pricing
     C                   END                                                    *FI
     C                   EVAL      $YCOAA = ' '                                 CIR Resource No
     C                   MOVEL     'N'           YL0023                         Display Flag 1
      * Rtv Cust Item Ref     RT - Customer Item Reference  * 
     C                   EXSR      STRVGN
      * * Flag if customer item ref is not blanks             E004011
      * CASE: LCL.CIR Resource No is Not Entered
     C                   IF        YL0024 = ' '
     C                   MOVEL     'N'           YL0023                         Display Flag 1
     C                   EVAL      $YCOAA = ' '                                 CIR Resource No
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'Y'           YL0023                         Display Flag 1
     C                   MOVEL     YL0024        $YCOAA                         CIR Resource No
     C                   END                                                    *FI
      * Convert fields to external form
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C                   IF        W0PFM = 'Y'
     C                   IF        $YHGCD <> 0
     C                   EVAL      WUEOCD = ' '                                 CD7 Ext Numeric
     C                   MOVEL     $YHGCD        WUEOCD                         CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                   MOVEA     WUEOCD        #L7                            EDIT ARRAY
     C                   Z-ADD     1             #E                3 0
     C                   MOVE      *IN61         UUIN61            1
     C                   SETOFF                                       61
     C                   DO        7
     C     #L7(#E)       IFEQ      '0'                                          ZERO VALUE
     C     *IN61         IFEQ      '0'
     C                   MOVE      ' '           #L7(#E)
     C                   ADD       1             #E
     C                   END
     C                   ELSE
     C                   SETON                                        61
     C                   END
     C                   END
     C                   MOVEA     #L7           WUEOCD
     C                   MOVE      UUIN61        *IN61
     C                   MOVEL     WUEOCD        VYHGCD                         CD7 Ext Numeric
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      VYHGCD = ' '                                 CD7 Ext Numeric
     C                   END                                                    *FI
      * Convert Market Pricing Date to display format
      * Convert date
     C     1000000       ADD       $YEXDT        XDINDT
     C                   EXSR      XDVC2T
     C                   Z-ADD     XDEXDT        VYEXDT
      * Convert OD Market Ending Date to display format
      * Convert date
     C     1000000       ADD       $YTLDT        XDINDT
     C                   EXSR      XDVC2T
     C                   Z-ADD     XDEXDT        VYTLDT
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C     1000000       ADD       $YTIDT        XDINDT
     C                   EXSR      XDVC2T
     C                   Z-ADD     XDEXDT        VYTIDT
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C     1000000       ADD       $YTJDT        XDINDT
     C                   EXSR      XDVC2T
     C                   Z-ADD     XDEXDT        VYTJDT
     C                   MOVEL     '0'           *IN79
     C                   IF        WN0001 = 'N'
     C                   MOVEL     '1'           *IN79
     C                   END                                                    *FI
     C                   MOVEL     '0'           *IN78
     C                   IF        $YTIDT <> *ZERO
     C                   MOVEL     '1'           *IN78
     C                   END                                                    *FI
     C                   MOVEL     '0'           *IN77
     C                   IF        $YEXDT = *ZERO
     C                   MOVEL     '1'           *IN77
     C                   END                                                    *FI
     C                   MOVEL     '0'           *IN76
     C                   IF        $YTLDT = *ZERO
     C                   MOVEL     '1'           *IN76
     C                   END                                                    *FI
     C                   MOVEL     '0'           *IN75
     C                   IF        YL0023 = 'N'
     C                   MOVEL     '1'           *IN75
     C                   END                                                    *FI
     C                   MOVEL     '0'           *IN74
     C                   IF        $YLBST = 'A'
     C                   MOVEL     '1'           *IN74
     C                   END                                                    *FI
     C                   MOVEL     '0'           *IN73
     C                   IF        WUBWTM = *ZERO
     C                   MOVEL     '1'           *IN73
     C                   END                                                    *FI
      * Print column headings if required
     C                   IF        W0JCDT = 'Y'
     C                   WRITE     $YCOLHDG
      * Clear column headings control flag
     C                   EVALR     W0JCDT = ' '
     C                   END                                                    FI
      * Print format
     C                   WRITE     $YDTLRCD
     C                   END                                                    FI
      *
      * Reset format print flag
     C                   EVALR     W0JPDT = ' '
     C                   END                                                    FI
      * Print First Page Format of PRT ODA-Acknowledge   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0KP1P = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0KP1P = 'P'
     C                   EVALR     W0KP1P = ' '
      * Clear first page flag.
     C                   EVALR     W0KL1P = ' '
     C                   END                                                    FI
      * Print Company Number of PRT ODA-Acknowledge   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0KP00 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0KP00 = 'P'
     C                   EVALR     W0KP00 = ' '
     C                   END                                                    FI
      * Print Order Number of PRT ODA-Acknowledge   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0KP01 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0KP01 = 'P'
     C                   EVALR     W0KP01 = ' '
     C                   END                                                    FI
      * Print Order Sequence Number of PRT ODA-Acknowledge   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0KP02 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0KP02 = 'P'
     C                   EVALR     W0KP02 = ' '
     C                   END                                                    FI
      * Print Order Secondary Line Seq of PRT ODA-Acknowledge   PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0KP03 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0KP03 = 'P'
     C                   EVALR     W0KP03 = ' '
     C                   END                                                    FI
      * Print Detail line. of PRT ODA-Acknowledge   PO
      * If new page then set column headings active
     C                   IF        W0NEWP = 'Y'
     C                   MOVE      'Y'           W0KCDT
     C                   END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C                   IF        W0KPDT = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0KPDT = 'P'
     C                   MOVEL     'Y'           W0PFM
      * USER: On print of detail format
     C                   EVAL      $ZYET1 = ' '                                 Accrual Rate Ty
      * Accrual Rate Type DRV
      * PAR.Accrual Rate Type DRV = Condition name of PAR.Accrual Rate Ty
     C                   CALL      'CARVC2R'                            90      *
     C                   PARM                    W0RTN
     C                   PARM      1704721       Y2LSNO                         List number
     C                   PARM      $ZSHSX        W0INVL                         Accrual Rate Ty
     C                   PARM      ' '           W0VLMP                         Value mapped
     C     $ZYET1        PARM                    W0CNNM                         Accrual Rate Ty
      *
      * Print column headings if required
     C                   IF        W0PFM = 'Y'
     C                   IF        W0KCDT = 'Y'
     C                   WRITE     $ZCOLHDG
      * Clear column headings control flag
     C                   EVALR     W0KCDT = ' '
     C                   END                                                    FI
      * Print format
     C                   WRITE     $ZDTLRCD
     C                   END                                                    FI
      *
      * Reset format print flag
     C                   EVALR     W0KPDT = ' '
     C                   END                                                    FI
      * Print First Page Format of PRT CA-Acknowledge    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0LP1P = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0LP1P = 'P'
     C                   EVALR     W0LP1P = ' '
      * Clear first page flag.
     C                   EVALR     W0LL1P = ' '
     C                   END                                                    FI
      * Print Ship To Customer of PRT CA-Acknowledge    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0LP00 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0LP00 = 'P'
     C                   EVALR     W0LP00 = ' '
     C                   END                                                    FI
      * Print Accrual Code of PRT CA-Acknowledge    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0LP01 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0LP01 = 'P'
     C                   EVALR     W0LP01 = ' '
     C                   END                                                    FI
      * Print Detail line. of PRT CA-Acknowledge    PO
      * If new page then set column headings active
     C                   IF        W0NEWP = 'Y'
     C                   MOVE      'Y'           W0LCDT
     C                   END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C                   IF        W0LPDT = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0LPDT = 'P'
     C                   MOVEL     'Y'           W0PFM
      * USER: On print of detail format
      * If all products is Yes
      * CASE: DB1.All Products (Y/N) is Yes
     C                   IF        HOTTST = 'Y'
     C                   MOVEL     'Y'           WUB8ST                         Status - Y or N
     C                   Z-ADD     HOBKPR        WUBKPR                         Accrual Rate
     C                   MOVEL     HOSHSX        WUSHSX                         Accrual Rate Ty
     C                   END                                                    *FI
      * If all products flag is no/yes+exceptions, check for item exists
      * CASE: DB1.All Products (Y/N) is No
      * RTV: Accrual Rate
      * CASE: DB1.Accrual Detail Search is Item
     C                   IF        HOTTST = 'N'
      * RTV & Chk Rate Exists  RT - Customer Accrual Item  * 
      * Move input parameters to subroutine local variables.
     C                   IF        HOQFSX = 'I'
     C                   Z-ADD     HOBKC7        WL0035                         Ship To Custome
     C                   MOVEL(P)  HOOJCD        WL0036                         Accrual Code
     C                   Z-ADD     HOGUNY        WL0037                         CAH Sequence No
     C                   Z-ADD     $YHGCD        WL0038                         Item Code
     C                   EXSR      SURVGN
      * Move subroutine local variables to output parameters.
     C                   Z-ADD     WL0039        WUBKPR                         Accrual Rate
     C                   MOVEL(P)  WL0040        WUSHSX                         Accrual Rate Ty
     C                   ELSE
      * CASE: *OTHERWISE
      * RTV & Chk Rate Exists RT - Customer Accrual Str  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     HOBKC7        WL0041                         Ship To Custome
     C                   MOVEL(P)  HOOJCD        WL0042                         Accrual Code
     C                   Z-ADD     HOGUNY        WL0043                         CAH Sequence No
     C                   Z-ADD     WCRGNB        WL0044                         Item Structure
     C                   Z-ADD     WCRHNB        WL0045                         Item Structure
     C                   Z-ADD     WCRINB        WL0046                         Item Structure
     C                   EXSR      SVRVGN
      * Move subroutine local variables to output parameters.
     C                   Z-ADD     WL0047        WUBKPR                         Accrual Rate
     C                   MOVEL(P)  WL0048        WUSHSX                         Accrual Rate Ty
      * Check for item str type/group without the class  RMC 08/07/07
      * CASE: PGM.*Return code is *Normal
     C                   IF        W0RTN = ' '
     C                   ELSE
      * CASE: *OTHERWISE
      * RTV & Chk Rate Exists RT - Customer Accrual Str  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     HOBKC7        WL0041                         Ship To Custome
     C                   MOVEL(P)  HOOJCD        WL0042                         Accrual Code
     C                   Z-ADD     HOGUNY        WL0043                         CAH Sequence No
     C                   Z-ADD     WCRGNB        WL0044                         Item Structure
     C                   Z-ADD     WCRHNB        WL0045                         Item Structure
     C                   Z-ADD     *ZERO         WL0046                         Item Structure
     C                   EXSR      SVRVGN
      * Move subroutine local variables to output parameters.
     C                   Z-ADD     WL0047        WUBKPR                         Accrual Rate
     C                   MOVEL(P)  WL0048        WUSHSX                         Accrual Rate Ty
     C                   END                                                    *FI
     C                   END                                                    *FI
      * 05/09/08 PKD/SZ Only calculate the Accrual if Rate > 0
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : WRK.Accrual Rate is Entered
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        W0RTN = ' '
     C                   IF        WUBKPR <> *ZERO
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   MOVEL     'Y'           WUB8ST                         Status - Y or N
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
      * If Yes + Exc
      * CASE: DB1.All Products (Y/N) is Yes + Exceptions
      * RTV: Accrual Rate
      * CASE: DB1.Accrual Detail Search is Item
     C                   IF        HOTTST = 'X'
      * RTV & Chk Rate Exists  RT - Customer Accrual Item  * 
      * Move input parameters to subroutine local variables.
     C                   IF        HOQFSX = 'I'
     C                   Z-ADD     HOBKC7        WL0035                         Ship To Custome
     C                   MOVEL(P)  HOOJCD        WL0036                         Accrual Code
     C                   Z-ADD     HOGUNY        WL0037                         CAH Sequence No
     C                   Z-ADD     $YHGCD        WL0038                         Item Code
     C                   EXSR      SURVGN
      * Move subroutine local variables to output parameters.
     C                   Z-ADD     WL0039        WUBKPR                         Accrual Rate
     C                   MOVEL(P)  WL0040        WUSHSX                         Accrual Rate Ty
     C                   ELSE
      * CASE: *OTHERWISE
      * RTV & Chk Rate Exists RT - Customer Accrual Str  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     HOBKC7        WL0041                         Ship To Custome
     C                   MOVEL(P)  HOOJCD        WL0042                         Accrual Code
     C                   Z-ADD     HOGUNY        WL0043                         CAH Sequence No
     C                   Z-ADD     WCRGNB        WL0044                         Item Structure
     C                   Z-ADD     WCRHNB        WL0045                         Item Structure
     C                   Z-ADD     WCRINB        WL0046                         Item Structure
     C                   EXSR      SVRVGN
      * Move subroutine local variables to output parameters.
     C                   Z-ADD     WL0047        WUBKPR                         Accrual Rate
     C                   MOVEL(P)  WL0048        WUSHSX                         Accrual Rate Ty
      * Check for item str type/group without the class  RMC 08/07/07
      * CASE: PGM.*Return code is *Normal
     C                   IF        W0RTN = ' '
     C                   ELSE
      * CASE: *OTHERWISE
      * RTV & Chk Rate Exists RT - Customer Accrual Str  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     HOBKC7        WL0041                         Ship To Custome
     C                   MOVEL(P)  HOOJCD        WL0042                         Accrual Code
     C                   Z-ADD     HOGUNY        WL0043                         CAH Sequence No
     C                   Z-ADD     WCRGNB        WL0044                         Item Structure
     C                   Z-ADD     WCRHNB        WL0045                         Item Structure
     C                   Z-ADD     *ZERO         WL0046                         Item Structure
     C                   EXSR      SVRVGN
      * Move subroutine local variables to output parameters.
     C                   Z-ADD     WL0047        WUBKPR                         Accrual Rate
     C                   MOVEL(P)  WL0048        WUSHSX                         Accrual Rate Ty
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Calcualte only if Rate exists
      * CASE: PGM.*Return code is *Normal
     C                   IF        W0RTN = ' '
     C                   MOVEL     'Y'           WUB8ST                         Status - Y or N
      * 11/26/02 Exception may exist as 0 -- then dont calc accrual
      * CASE: WRK.Accrual Rate is equal to zero
     C                   IF        WUBKPR = *ZERO
     C                   MOVEL     'N'           WUB8ST                         Status - Y or N
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     HOBKPR        WUBKPR                         Accrual Rate
     C                   MOVEL     'Y'           WUB8ST                         Status - Y or N
     C                   MOVEL     HOSHSX        WUSHSX                         Accrual Rate Ty
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * PRINT FORMAT
      * CASE: WRK.Status - Y or N is yes
     C                   IF        WUB8ST = 'Y'
     C                   EVAL      #AQZNA = ' '                                 Accrual Descrip
      * Accrual Description DRV
      * RTV Accrual Descript   RT - Accrual Code Master  * 
     C                   EXSR      SWRVGN
     C                   Z-ADD     WUBKPR        #AUJNY                         Accrual Rate US
     C                   EVAL      #AYET1 = ' '                                 Accrual Rate Ty
      * Accrual Rate Type DRV
      * PAR.Accrual Rate Type DRV = Condition name of PAR.Accrual Rate Ty
     C                   CALL      'CARVC2R'                            90      *
     C                   PARM                    W0RTN
     C                   PARM      1704721       Y2LSNO                         List number
     C                   PARM      WUSHSX        W0INVL                         Accrual Rate Ty
     C                   PARM      ' '           W0VLMP                         Value mapped
     C     #AYET1        PARM                    W0CNNM                         Accrual Rate Ty
      *
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'N'           W0PFM                          *Print format
     C                   END                                                    *FI
      * Print column headings if required
     C                   IF        W0PFM = 'Y'
     C                   IF        W0LCDT = 'Y'
     C                   WRITE     #ACOLHDG
      * Clear column headings control flag
     C                   EVALR     W0LCDT = ' '
     C                   END                                                    FI
      * Print format
     C                   WRITE     #ADTLRCD
     C                   END                                                    FI
      *
      * Reset format print flag
     C                   EVALR     W0LPDT = ' '
     C                   END                                                    FI
      * Print First Page Format of PRT Detail Comment     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0MP1P = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0MP1P = 'P'
     C                   EVALR     W0MP1P = ' '
      * Clear first page flag.
     C                   EVALR     W0ML1P = ' '
     C                   END                                                    FI
      * Print Company Number of PRT Detail Comment     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0MP00 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0MP00 = 'P'
     C                   EVALR     W0MP00 = ' '
     C                   END                                                    FI
      * Print Order Number of PRT Detail Comment     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0MP01 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0MP01 = 'P'
     C                   EVALR     W0MP01 = ' '
     C                   END                                                    FI
      * Print Order Sequence Number of PRT Detail Comment     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0MP02 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0MP02 = 'P'
     C                   EVALR     W0MP02 = ' '
     C                   END                                                    FI
      * Print Order Secondary Line Seq of PRT Detail Comment     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Print format
     C                   IF        W0MP03 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0MP03 = 'P'
     C                   WRITE     #BKEYHDR
      * Set column headings flag
     C                   MOVE      'Y'           W0MCDT
      *
      * Reset format print flag
     C                   EVALR     W0MP03 = ' '
     C                   END                                                    FI
      * Print Detail line. of PRT Detail Comment     PO
      * If new page then set column headings active
     C                   IF        W0NEWP = 'Y'
     C                   MOVE      'Y'           W0MCDT
     C                   END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Print column headings if required
     C                   IF        W0MPDT = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0MPDT = 'P'
     C                   IF        W0MCDT = 'Y'
     C                   WRITE     #CCOLHDG
      * Clear column headings control flag
     C                   EVALR     W0MCDT = ' '
     C                   END                                                    FI
      * Print format
     C                   WRITE     #CDTLRCD
      *
      * Reset format print flag
     C                   EVALR     W0MPDT = ' '
     C                   END                                                    FI
      * Print First Page Format of PRT Detail Financials  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0NP1P = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0NP1P = 'P'
     C                   EVALR     W0NP1P = ' '
      * Clear first page flag.
     C                   EVALR     W0NL1P = ' '
     C                   END                                                    FI
      * Print Company Number of PRT Detail Financials  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0NP00 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0NP00 = 'P'
     C                   EVALR     W0NP00 = ' '
     C                   END                                                    FI
      * Print Order Number of PRT Detail Financials  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0NP01 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0NP01 = 'P'
     C                   EVALR     W0NP01 = ' '
     C                   END                                                    FI
      * Print Order Sequence Number of PRT Detail Financials  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0NP02 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0NP02 = 'P'
     C                   EVALR     W0NP02 = ' '
     C                   END                                                    FI
      * Print Order Secondary Line Seq of PRT Detail Financials  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0NP03 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0NP03 = 'P'
     C                   EVALR     W0NP03 = ' '
     C                   END                                                    FI
      * Print Detail line. of PRT Detail Financials  PO
      * If new page then set column headings active
     C                   IF        W0NEWP = 'Y'
     C                   MOVE      'Y'           W0NCDT
     C                   END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C                   IF        W0NPDT = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0NPDT = 'P'
     C                   MOVEL     'Y'           W0PFM
      * USER: On print of detail format
      * Accumulate totals based on financial type
      * CASE: CUR.Financial Type is Freight Charge
     C                   IF        #EG4ST = 'F'
     C                   ADD       #EBSVA        WUDLVA                         USR Freight Amo
     C                   ELSE
      * CASE: *OTHERWISE
     C                   ADD       #EBSVA        WUDQVA                         USR Spec. Charg
     C                   END                                                    *FI
      * Print column headings if required
     C                   IF        W0PFM = 'Y'
     C                   IF        W0NCDT = 'Y'
     C                   WRITE     #ECOLHDG
      * Clear column headings control flag
     C                   EVALR     W0NCDT = ' '
     C                   END                                                    FI
      * Print format
     C                   WRITE     #EDTLRCD
     C                   END                                                    FI
      *
      * Reset format print flag
     C                   EVALR     W0NPDT = ' '
     C                   END                                                    FI
      * Print First Page Format of PRT Item Brokers       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0OP1P = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0OP1P = 'P'
     C                   EVALR     W0OP1P = ' '
      * Clear first page flag.
     C                   EVALR     W0OL1P = ' '
     C                   END                                                    FI
      * Print Company Number of PRT Item Brokers       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0OP00 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0OP00 = 'P'
     C                   EVALR     W0OP00 = ' '
     C                   END                                                    FI
      * Print Item Code of PRT Item Brokers       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0OP01 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0OP01 = 'P'
     C                   EVALR     W0OP01 = ' '
     C                   END                                                    FI
      * Print Detail line. of PRT Item Brokers       PO
      * If new page then set column headings active
     C                   IF        W0NEWP = 'Y'
     C                   MOVE      'Y'           W0OCDT
     C                   END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C                   IF        W0OPDT = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0OPDT = 'P'
     C                   MOVEL     'Y'           W0PFM
      * USER: On print of detail format
      * RTV Salesperson Name   RT - Salesperson  * 
      * Move input parameters to subroutine local variables.
     C                   MOVEL(P)  #FR4CD        WL0049                         Salesperson Cod
     C                   EXSR      SYRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0049        #FR4CD                         Salesperson Cod
     C                   MOVEL(P)  WL0050        #FC4TX                         Salesperson Nam
      * Print column headings if required
     C                   IF        W0PFM = 'Y'
     C                   IF        W0OCDT = 'Y'
     C                   WRITE     #FCOLHDG
      * Clear column headings control flag
     C                   EVALR     W0OCDT = ' '
     C                   END                                                    FI
      * Print format
     C                   WRITE     #FDTLRCD
     C                   END                                                    FI
      *
      * Reset format print flag
     C                   EVALR     W0OPDT = ' '
     C                   END                                                    FI
      * Print First Page Format of PRT item/cust brokers  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0RP1P = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0RP1P = 'P'
     C                   EVALR     W0RP1P = ' '
      * Clear first page flag.
     C                   EVALR     W0RL1P = ' '
     C                   END                                                    FI
      * Print Company Number of PRT item/cust brokers  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0RP00 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0RP00 = 'P'
     C                   EVALR     W0RP00 = ' '
     C                   END                                                    FI
      * Print Item Code of PRT item/cust brokers  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Reset format print flag
     C                   IF        W0RP01 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0RP01 = 'P'
     C                   EVALR     W0RP01 = ' '
     C                   END                                                    FI
      * Print Ship To Customer of PRT item/cust brokers  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
      * Convert fields to external form
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C                   IF        W0RP02 = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0RP02 = 'P'
     C                   IF        #GBKC7 <> 0
     C                   EVAL      WUEOCD = ' '                                 CD7 Ext Numeric
     C                   MOVEL     #GBKC7        WUEOCD                         CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                   MOVEA     WUEOCD        #L7                            EDIT ARRAY
     C                   Z-ADD     1             #E                3 0
     C                   MOVE      *IN61         UUIN61            1
     C                   SETOFF                                       61
     C                   DO        7
     C     #L7(#E)       IFEQ      '0'                                          ZERO VALUE
     C     *IN61         IFEQ      '0'
     C                   MOVE      ' '           #L7(#E)
     C                   ADD       1             #E
     C                   END
     C                   ELSE
     C                   SETON                                        61
     C                   END
     C                   END
     C                   MOVEA     #L7           WUEOCD
     C                   MOVE      UUIN61        *IN61
     C                   MOVEL     WUEOCD        VGBKC7                         CD7 Ext Numeric
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      VGBKC7 = ' '                                 CD7 Ext Numeric
     C                   END                                                    *FI
      * Print format
     C                   WRITE     #GKEYHDR
      * Set column headings flag
     C                   MOVE      'Y'           W0RCDT
      *
      * Reset format print flag
     C                   EVALR     W0RP02 = ' '
     C                   END                                                    FI
      * Print Detail line. of PRT item/cust brokers  PO
      * If new page then set column headings active
     C                   IF        W0NEWP = 'Y'
     C                   MOVE      'Y'           W0RCDT
     C                   END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C                   IF        W0RPDT = 'Y' OR
     C                             W0NEWP = 'Y' AND
     C                             W0RPDT = 'P'
     C                   MOVEL     'Y'           W0PFM
      * USER: On print of detail format
      * RTV Salesperson Name   RT - Salesperson  * 
      * Move input parameters to subroutine local variables.
     C                   MOVEL(P)  #HR4CD        WL0049                         Salesperson Cod
     C                   EXSR      SYRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0049        #HR4CD                         Salesperson Cod
     C                   MOVEL(P)  WL0050        #HC4TX                         Salesperson Nam
      * Print column headings if required
     C                   IF        W0PFM = 'Y'
     C                   IF        W0RCDT = 'Y'
     C                   WRITE     #HCOLHDG
      * Clear column headings control flag
     C                   EVALR     W0RCDT = ' '
     C                   END                                                    FI
      * Print format
     C                   WRITE     #HDTLRCD
     C                   END                                                    FI
      *
      * Reset format print flag
     C                   EVALR     W0RPDT = ' '
     C                   END                                                    FI
      * Clear new page flag
     C                   EVALR     W0NEWP = ' '
      *================================================================
     CSR   Q0EXIT        ENDSR
      /EJECT
     CSR   Q1FSEL        BEGSR
      *================================================================
      * Format select
      *================================================================
     C                   EVAL      W0SKP = ' '
      * Cascade skip to new page requests upwards
     C                   IF        W0AP01 = 'Y'
     C                   MOVEL     'Y'           W0SKP
     C                   END
      * Request new page if required
     C                   IF        W0SKP = 'Y'
     C                   MOVE      'Y'           W0NEWP
     C                   END                                                    FI
      *================================================================
     CSR   Q1EXIT        ENDSR
      /EJECT
     CSR   Q2PLEN        BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C                   Z-ADD     @$CLN         W0FSUM
     C                   Z-ADD     *ZERO         W0DTLN
     C                   Z-ADD     *ZERO         W0COLN
      * * First Page Format of PRT Acknowledgements   PF
     C                   IF        W0AP1P = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Company Number of PRT Acknowledgements   PF
     C                   IF        W0AP00 = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Order Number of PRT Acknowledgements   PF
     C                   IF        W0AP01 = 'Y'
     C                   ADD       36            W0FSUM
     C                   END                                                    FI
      *
      * * Ship To Customer of PRT Acknowledgements   PF
     C                   IF        W0AP02 = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Detail line. of PRT Acknowledgements   PF
     C                   IF        W0APDT = 'Y'
     C                   Z-ADD     0             W0DTLN
     C                   IF        W0ACDT = 'Y'
     C                   Z-ADD     0             W0COLN
     C                   END                                                    FI
     C                   END                                                    FI
      *
      * * First Page Format of PRT Hdr Comment 3/Lne PO
     C                   IF        W0BP1P = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Company Number of PRT Hdr Comment 3/Lne PO
     C                   IF        W0BP00 = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Order Number of PRT Hdr Comment 3/Lne PO
     C                   IF        W0BP01 = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Comment Type of PRT Hdr Comment 3/Lne PO
     C                   IF        W0BP02 = 'Y'
     C                   ADD       2             W0FSUM
     C                   END                                                    FI
      *
      * * Detail line. of PRT Hdr Comment 3/Lne PO
     C                   IF        W0BPDT = 'Y'
     C                   Z-ADD     1             W0DTLN
     C                   IF        W0BCDT = 'Y'
     C                   Z-ADD     0             W0COLN
     C                   END                                                    FI
     C                   END                                                    FI
      *
      * * First Page Format of PRT Hdr Comment 3/Lne PO
     C                   IF        W0CP1P = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Company Number of PRT Hdr Comment 3/Lne PO
     C                   IF        W0CP00 = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Order Number of PRT Hdr Comment 3/Lne PO
     C                   IF        W0CP01 = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Comment Type of PRT Hdr Comment 3/Lne PO
     C                   IF        W0CP02 = 'Y'
     C                   ADD       2             W0FSUM
     C                   END                                                    FI
      *
      * * Detail line. of PRT Hdr Comment 3/Lne PO
     C                   IF        W0CPDT = 'Y'
     C                   Z-ADD     1             W0DTLN
     C                   IF        W0CCDT = 'Y'
     C                   Z-ADD     0             W0COLN
     C                   END                                                    FI
     C                   END                                                    FI
      *
      * * First Page Format of PRT Hdr Comment 3/Lne PO
     C                   IF        W0DP1P = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Company Number of PRT Hdr Comment 3/Lne PO
     C                   IF        W0DP00 = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Order Number of PRT Hdr Comment 3/Lne PO
     C                   IF        W0DP01 = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Comment Type of PRT Hdr Comment 3/Lne PO
     C                   IF        W0DP02 = 'Y'
     C                   ADD       2             W0FSUM
     C                   END                                                    FI
      *
      * * Detail line. of PRT Hdr Comment 3/Lne PO
     C                   IF        W0DPDT = 'Y'
     C                   Z-ADD     1             W0DTLN
     C                   IF        W0DCDT = 'Y'
     C                   Z-ADD     0             W0COLN
     C                   END                                                    FI
     C                   END                                                    FI
      *
      * * First Page Format of PRT Hdr Comment 3/Lne PO
     C                   IF        W0EP1P = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Company Number of PRT Hdr Comment 3/Lne PO
     C                   IF        W0EP00 = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Order Number of PRT Hdr Comment 3/Lne PO
     C                   IF        W0EP01 = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Comment Type of PRT Hdr Comment 3/Lne PO
     C                   IF        W0EP02 = 'Y'
     C                   ADD       2             W0FSUM
     C                   END                                                    FI
      *
      * * Detail line. of PRT Hdr Comment 3/Lne PO
     C                   IF        W0EPDT = 'Y'
     C                   Z-ADD     1             W0DTLN
     C                   IF        W0ECDT = 'Y'
     C                   Z-ADD     0             W0COLN
     C                   END                                                    FI
     C                   END                                                    FI
      *
      * * First Page Format of PRT Ship Inst 3/Line  PO
     C                   IF        W0FP1P = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Company Number of PRT Ship Inst 3/Line  PO
     C                   IF        W0FP00 = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Order Number of PRT Ship Inst 3/Line  PO
     C                   IF        W0FP01 = 'Y'
     C                   ADD       2             W0FSUM
     C                   END                                                    FI
      *
      * * Detail line. of PRT Ship Inst 3/Line  PO
     C                   IF        W0FPDT = 'Y'
     C                   Z-ADD     1             W0DTLN
     C                   IF        W0FCDT = 'Y'
     C                   Z-ADD     0             W0COLN
     C                   END                                                    FI
     C                   END                                                    FI
      *
      * * First Page Format of Prt Cust Comment PL   PO
     C                   IF        W0GP1P = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Ship To Customer of Prt Cust Comment PL   PO
     C                   IF        W0GP00 = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Comment Type of Prt Cust Comment PL   PO
     C                   IF        W0GP01 = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Detail line. of Prt Cust Comment PL   PO
     C                   IF        W0GPDT = 'Y'
     C                   Z-ADD     1             W0DTLN
     C                   IF        W0GCDT = 'Y'
     C                   Z-ADD     0             W0COLN
     C                   END                                                    FI
     C                   END                                                    FI
      *
      * * First Page Format of Prt Country Comment   PO
     C                   IF        W0HP1P = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Country Code of Prt Country Comment   PO
     C                   IF        W0HP00 = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Comment Type of Prt Country Comment   PO
     C                   IF        W0HP01 = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Detail line. of Prt Country Comment   PO
     C                   IF        W0HPDT = 'Y'
     C                   Z-ADD     1             W0DTLN
     C                   IF        W0HCDT = 'Y'
     C                   Z-ADD     0             W0COLN
     C                   END                                                    FI
     C                   END                                                    FI
      *
      * * First Page Format of PRT All Orders on Load PO
     C                   IF        W0IP1P = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Load ID of PRT All Orders on Load PO
     C                   IF        W0IP00 = 'Y'
     C                   ADD       1             W0FSUM
     C                   END                                                    FI
      *
      * * Detail line. of PRT All Orders on Load PO
     C                   IF        W0IPDT = 'Y'
     C                   Z-ADD     1             W0DTLN
     C                   IF        W0ICDT = 'Y'
     C                   Z-ADD     2             W0COLN
     C                   END                                                    FI
     C                   END                                                    FI
      *
      * * First Page Format of PRT Detail-Acknowledge PO
     C                   IF        W0JP1P = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Company Number of PRT Detail-Acknowledge PO
     C                   IF        W0JP00 = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Order Number of PRT Detail-Acknowledge PO
     C                   IF        W0JP01 = 'Y'
     C                   ADD       5             W0FSUM
     C                   END                                                    FI
      *
      * * Order Sequence Number of PRT Detail-Acknowledge PO
     C                   IF        W0JP02 = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Detail line. of PRT Detail-Acknowledge PO
     C                   IF        W0JPDT = 'Y'
     C                   Z-ADD     5             W0DTLN
     C                   IF        W0JCDT = 'Y'
     C                   Z-ADD     0             W0COLN
     C                   END                                                    FI
     C                   END                                                    FI
      *
      * * First Page Format of PRT ODA-Acknowledge   PO
     C                   IF        W0KP1P = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Company Number of PRT ODA-Acknowledge   PO
     C                   IF        W0KP00 = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Order Number of PRT ODA-Acknowledge   PO
     C                   IF        W0KP01 = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Order Sequence Number of PRT ODA-Acknowledge   PO
     C                   IF        W0KP02 = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Order Secondary Line Seq of PRT ODA-Acknowledge   PO
     C                   IF        W0KP03 = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Detail line. of PRT ODA-Acknowledge   PO
     C                   IF        W0KPDT = 'Y'
     C                   Z-ADD     1             W0DTLN
     C                   IF        W0KCDT = 'Y'
     C                   Z-ADD     0             W0COLN
     C                   END                                                    FI
     C                   END                                                    FI
      *
      * * First Page Format of PRT CA-Acknowledge    PO
     C                   IF        W0LP1P = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Ship To Customer of PRT CA-Acknowledge    PO
     C                   IF        W0LP00 = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Accrual Code of PRT CA-Acknowledge    PO
     C                   IF        W0LP01 = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Detail line. of PRT CA-Acknowledge    PO
     C                   IF        W0LPDT = 'Y'
     C                   Z-ADD     1             W0DTLN
     C                   IF        W0LCDT = 'Y'
     C                   Z-ADD     0             W0COLN
     C                   END                                                    FI
     C                   END                                                    FI
      *
      * * First Page Format of PRT Detail Comment     PO
     C                   IF        W0MP1P = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Company Number of PRT Detail Comment     PO
     C                   IF        W0MP00 = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Order Number of PRT Detail Comment     PO
     C                   IF        W0MP01 = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Order Sequence Number of PRT Detail Comment     PO
     C                   IF        W0MP02 = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Order Secondary Line Seq of PRT Detail Comment     PO
     C                   IF        W0MP03 = 'Y'
     C                   ADD       2             W0FSUM
     C                   END                                                    FI
      *
      * * Detail line. of PRT Detail Comment     PO
     C                   IF        W0MPDT = 'Y'
     C                   Z-ADD     1             W0DTLN
     C                   IF        W0MCDT = 'Y'
     C                   Z-ADD     0             W0COLN
     C                   END                                                    FI
     C                   END                                                    FI
      *
      * * First Page Format of PRT Detail Financials  PO
     C                   IF        W0NP1P = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Company Number of PRT Detail Financials  PO
     C                   IF        W0NP00 = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Order Number of PRT Detail Financials  PO
     C                   IF        W0NP01 = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Order Sequence Number of PRT Detail Financials  PO
     C                   IF        W0NP02 = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Order Secondary Line Seq of PRT Detail Financials  PO
     C                   IF        W0NP03 = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Detail line. of PRT Detail Financials  PO
     C                   IF        W0NPDT = 'Y'
     C                   Z-ADD     1             W0DTLN
     C                   IF        W0NCDT = 'Y'
     C                   Z-ADD     0             W0COLN
     C                   END                                                    FI
     C                   END                                                    FI
      *
      * * First Page Format of PRT Item Brokers       PO
     C                   IF        W0OP1P = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Company Number of PRT Item Brokers       PO
     C                   IF        W0OP00 = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Item Code of PRT Item Brokers       PO
     C                   IF        W0OP01 = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Detail line. of PRT Item Brokers       PO
     C                   IF        W0OPDT = 'Y'
     C                   Z-ADD     1             W0DTLN
     C                   IF        W0OCDT = 'Y'
     C                   Z-ADD     0             W0COLN
     C                   END                                                    FI
     C                   END                                                    FI
      *
      * * First Page Format of PRT item/cust brokers  PO
     C                   IF        W0RP1P = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Company Number of PRT item/cust brokers  PO
     C                   IF        W0RP00 = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Item Code of PRT item/cust brokers  PO
     C                   IF        W0RP01 = 'Y'
     C                   ADD       0             W0FSUM
     C                   END                                                    FI
      *
      * * Ship To Customer of PRT item/cust brokers  PO
     C                   IF        W0RP02 = 'Y'
     C                   ADD       2             W0FSUM
     C                   END                                                    FI
      *
      * * Detail line. of PRT item/cust brokers  PO
     C                   IF        W0RPDT = 'Y'
     C                   Z-ADD     1             W0DTLN
     C                   IF        W0RCDT = 'Y'
     C                   Z-ADD     0             W0COLN
     C                   END                                                    FI
     C                   END                                                    FI
      *
      *================================================================
     CSR   Q2EXIT        ENDSR
      /EJECT
     CSR   Q3PTNP        BEGSR
      *================================================================
      * Format select
      *================================================================
      * USER: Process top of page
      * Set Date Format        US - /UT User Source  * 
     C                   MOVEL     P2B8NA        XDDTFM            3
     C                   ADD       1             P6MSNB                         USR Page number
     C                   Z-ADD     P6MSNB        $BMSNB                         USR Page number
     C                   Z-ADD     ##JDT         $BBQDT                         USR Date - ATR
     C                   Z-ADD     ##JTM         $BWENB                         USR Time
      * Convert fields to external form
      * Convert USR Date - ATR to display format
      * Convert date
     C     1000000       ADD       $BBQDT        XDINDT
     C                   EXSR      XDVC2T
     C                   Z-ADD     XDEXDT        VBBQDT
     C                   WRITE     $APAGHDR
      * Clear page overflow indicator
     C                   SETOFF                                       97        *
      *================================================================
     CSR   Q3EXIT        ENDSR
      /EJECT
     CSR   R0MAIN        BEGSR
      *================================================================
      * PRT item/cust brokers  PO: Mainline
      *================================================================
      * Declare restrictor key work fields
      * Define keylist
     C     KRSR          KLIST
     C                   KFLD                    WQKR01                         Company Number
     C                   KFLD                    WQKR02                         Item Code
      * Setup key
     C                   Z-ADD     $YAIC3        WQKR01                         Company Number
     C                   Z-ADD     $YHGCD        WQKR02                         Item Code
      * Establish starting position
     C     KRSR          SETLL     @GLCPGU                                      *
      * Read first record with user selection
     C                   EXSR      R3READ
     C                   IF        W0EOFR <> '0'
     C                   ELSE
      * Request all headings
     C                   MOVEL     'Y'           W0RL1P                         First page
     C                   MOVEL     'Y'           W0RL00                         Company Number
     C                   MOVEL     'Y'           W0RL01                         Item Code
     C                   MOVEL     'Y'           W0RL02                         Ship To Custome
      * Set column headings flag
     C                   MOVE      'Y'           W0RCDT
      * Print report body
      * Prepare heading formats for printing
     C                   DOW       W0EOFR = '0'
     C                   EXSR      R1PHDR
      * Print report detail line
     C                   EXSR      R2PDTL
      * Read next record with user selection
     C                   EXSR      R3READ
      * Print totals
     C                   EXSR      R4PTOT
     C                   END                                                    WOD
     C                   END                                                    FI
      *================================================================
     CSR   R0EXIT        ENDSR
      /EJECT
     CSR   R1PHDR        BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
      * Signal that format is now ready to print
     C                   IF        W0RL1P = 'Y'
     C                   MOVE      'Y'           W0RP1P
     C                   END
      *
      * Signal that format is now ready to print
     C                   IF        W0RL00 = 'Y'
     C                   MOVE      'Y'           W0RP00
     C                   END
      *
      * Signal that format is now ready to print
     C                   IF        W0RL01 = 'Y'
     C                   MOVE      'Y'           W0RP01
     C                   END
      *
      * Load key header format
     C                   IF        W0RL02 = 'Y'
     C                   Z-ADD     GLAIC3        #GAIC3                         Company Number
     C                   Z-ADD     GLHGCD        #GHGCD                         Item Code
     C                   Z-ADD     GLBKC7        #GBKC7                         Ship To Custome
     C                   MOVEL     GLR4CD        #GR4CD                         Sales Route Cod
      * Load related totals format
     C                   Z-ADD     GLAIC3        #IAIC3                         Company Number
     C                   Z-ADD     GLHGCD        #IHGCD                         Item Code
     C                   Z-ADD     GLBKC7        #IBKC7                         Ship To Custome
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0RP02
     C                   END
      *
      *================================================================
     CSR   R1EXIT        ENDSR
      /EJECT
     CSR   R2PDTL        BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                   Z-ADD     GLAIC3        #HAIC3                         Company Number
     C                   MOVEL     GLR4CD        #HR4CD                         Sales Route Cod
     C                   EVAL      #HC4TX = ' '                                 USR Salesperson
      * Signal that format is now ready to print
     C                   MOVE      'Y'           W0RPDT
      * Call print routine
     C                   EXSR      Q0PRNT
      *
      *================================================================
     CSR   R2EXIT        ENDSR
      /EJECT
     CSR   R3READ        BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C                   Z-ADD     GLAIC3        WZR001
     C                   Z-ADD     GLHGCD        WZR002
     C                   Z-ADD     GLBKC7        WZR003
      * Read next record
     C                   DOU       W0RSL = 'Y' OR
     C                             W0EOFR = '1'
     C     KRSR          READE     @GLCPGU                                90    *
      * Transfer error indicator to EOF flag
     C                   MOVEL     *IN90         W0EOFR
      * Quit if no record read
      * Select record unless user action states otherwise
     C                   IF        W0EOFR <> '1'
     C                   MOVEL     'Y'           W0RSL
     C                   END                                                    FI
     C                   END                                                    UOD
      *
      * Reset key level breaks
     C                   EVAL      W0RL00 = ' '                                 Company Number
     C                   EVAL      W0RL01 = ' '                                 Item Code
     C                   EVAL      W0RL02 = ' '                                 Ship To Custome
      * End of file - Signal all level breaks
     C                   IF        W0EOFR = '1'
     C                   MOVEL     'Y'           W0RL00                         Company Number
     C                   MOVEL     'Y'           W0RL01                         Item Code
     C                   MOVEL     'Y'           W0RL02                         Ship To Custome
     C                   ELSE
      * Next record - Detect level breaks
      * Set on level break indicator
     C                   IF        GLAIC3 <> WZR001
     C                   MOVEL     'Y'           W0RL00
     C                   END
      * Set on level break indicator
     C                   IF        GLHGCD <> WZR002 OR
     C                             W0RL00 = 'Y'
     C                   MOVEL     'Y'           W0RL01
     C                   END
      * Set on level break indicator
     C                   IF        GLBKC7 <> WZR003 OR
     C                             W0RL01 = 'Y'
     C                   MOVEL     'Y'           W0RL02
     C                   END
     C                   END
      *================================================================
     CSR   R3EXIT        ENDSR
      /EJECT
     CSR   R4PTOT        BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
      * Mention hidden format
     C                   IF        W0RL02 = 'Y'
     C   99
     CANN99              WRITE     #IKEYTTL
      * Signal header format is no longer ready
     C                   EVAL      W0RP02 = ' '
     C                   END
      *
      * Signal header format is no longer ready
     C                   IF        W0RL01 = 'Y'
     C                   EVAL      W0RP01 = ' '
     C                   END
      *
      * Signal header format is no longer ready
     C                   IF        W0RL00 = 'Y'
     C                   EVAL      W0RP00 = ' '
     C                   END
      *
     C                   IF        W0EOFR = '1'
     C                   END
      *
      *================================================================
     CSR   R4EXIT        ENDSR
      /EJECT
     CSR   SARVGN        BEGSR
      *================================================================
      * RTV Model Profile      RT - User Profile Control  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSA         KLIST
     C                   KFLD                    DRAJVN                         User Profile Na
      * Setup key
     C                   MOVEL     P2AJVN        DRAJVN                         User Profile Na
      * Establish starting position
     C     KRSSA         CHAIN     @DRRETH                            90        *
      * Data record not found
     C   90              MOVEL     'USR0763'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     DRB8NA        P2B8NA                         System Date For
     C                   MOVEL     DRAHVN        WUAHVN                         Printer Device
     C                   MOVEL     DRI6ST        P2I6ST                         Allow Multi_Com
     C                   MOVEL     DRI7ST        WUI7ST                         Application WHS
     C                   MOVEL     DRMPNA        P2MPNA                         Default Printer
     C                   MOVEL     DRBCCD        P2BCCD                         Salesperson Cod
     C                   Z-ADD     DRAIC3        WUAIC3                         Company Number
     C                   MOVEL     DRDQCD        WUDQCD                         Enterprise Code
     C                   MOVEL     DRDRCD        WUDRCD                         Enterprise Code
     C                   MOVEL     DRAJCD        P2AJCD                         Warehouse Code
     C                   ENDIF
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   SBRVGN        BEGSR
      *================================================================
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSB         KLIST
     C                   KFLD                    JYAIC3                         Company Number
      * Setup key
     C                   Z-ADD     P1AIC3        JYAIC3                         Company Number
      * Establish starting position
     C     KRSSB         CHAIN     @JYRECE                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR2025'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      YL0001 = ' '                                 Company Organiz
     C                   GOTO      SBEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     JYYJSX        YL0001                         Company Organiz
     C                   ENDIF
      *================================================================
     CSR   SBEXIT        ENDSR
      /EJECT
     CSR   SCRVGN        BEGSR
      *================================================================
      * Rtv Order Types       RT - OP Order Types  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSC         KLIST
     C                   KFLD                    EXJNCD                         Order Type_Sale
      * Setup key
     C                   MOVEL     $CJNCD        EXJNCD                         Order Type_Sale
      * Establish starting position
     C     KRSSC         CHAIN     @EXREYP                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR1063'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      WUJVNA = ' '                                 Order Type Desc
     C                   EVAL      WUOAST = ' '                                 Processing Cycl
     C                   EVAL      WUOBST = ' '                                 Billing Activit
     C                   EVAL      WUOEST = ' '                                 Affect Inventor
     C                   EVAL      WUOFST = ' '                                 Affect Sales Do
     C                   EVAL      WUVBST = ' '                                 Affect Sales Pn
     C                   GOTO      SCEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     EXJVNA        WUJVNA                         Order Type Desc
     C                   MOVEL     EXOAST        WUOAST                         Processing Cycl
     C                   MOVEL     EXOBST        WUOBST                         Billing Activit
     C                   MOVEL     EXOEST        WUOEST                         Affect Inventor
     C                   MOVEL     EXOFST        WUOFST                         Affect Sales Do
     C                   MOVEL     EXVBST        WUVBST                         Affect Sales Pn
     C                   ENDIF
      *================================================================
     CSR   SCEXIT        ENDSR
      /EJECT
     CSR   SDRVGN        BEGSR
      *================================================================
      * RTV Customer Telephone RT - Customer  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSD         KLIST
     C                   KFLD                    BBBKC7                         Ship To Custome
      * Setup key
     C                   Z-ADD     $CBKC7        BBBKC7                         Ship To Custome
      * Establish starting position
     C     KRSSD         CHAIN     @BBREE9                            90        *
      * Data record not found
     C   90              MOVEL     'USR0170'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     BBBVTX        $CCDTX                         Telephone Numbe
     C                   ENDIF
      *================================================================
     CSR   SDEXIT        ENDSR
      /EJECT
     CSR   SERVGN        BEGSR
      *================================================================
      * RTV Description        RT - PD Sales Route  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSE         KLIST
     C                   KFLD                    JER4CD                         Sales Route Cod
      * Setup key
     C                   MOVEL     $CR4CD        JER4CD                         Sales Route Cod
      * Establish starting position
     C     KRSSE         CHAIN     @JEREWF                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR1800'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      $CMZNA = ' '                                 Sales Route Des
     C                   MOVEL     'Y2U0005'     W0RTN                          *Return code
     C                   GOTO      SEEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     JEMZNA        $CMZNA                         Sales Route Des
     C                   ENDIF
      *================================================================
     CSR   SEEXIT        ENDSR
      /EJECT
     CSR   SFRVGN        BEGSR
      *================================================================
      * RTV Fax number ff      RT - Customer  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSF         KLIST
     C                   KFLD                    BBBKC7                         Ship To Custome
      * Setup key
     C                   Z-ADD     $CBKC7        BBBKC7                         Ship To Custome
      * Establish starting position
     C     KRSSF         CHAIN     @BBREE9                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR0170'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      $CDUTX = ' '                                 Fax Number FF
     C                   GOTO      SFEXIT                                       *QUIT
     C                   GOTO      SFEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     BBBWTX        $CDUTX                         Fax Number FF
     C                   GOTO      SFEXIT                                       *QUIT
     C                   ENDIF
      *================================================================
     CSR   SFEXIT        ENDSR
      /EJECT
     CSR   SGRVGN        BEGSR
      *================================================================
      * RTV Prt. Address/Msg   RT - Company Control  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSG         KLIST
     C                   KFLD                    ASAIC3                         Company Number
      * Setup key
     C                   Z-ADD     $CAIC3        ASAIC3                         Company Number
      * Establish starting position
     C     KRSSG         CHAIN     @ASREGT                            90        *
      * Data record not found
     C   90              MOVEL     'USR0049'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     ASC2ST        P3C2ST                         Print Co Addr o
     C                   MOVEL     ASA8NA        $CD4NA                         Message Line 1
     C                   MOVEL     ASA9NA        $CD5NA                         Message Line 2
     C                   MOVEL     ASBANA        $CD6NA                         Message Line 3
     C                   MOVEL     ASBBNA        $CHHNA                         Message Line 4
     C                   ENDIF
      *================================================================
     CSR   SGEXIT        ENDSR
      /EJECT
     CSR   SHRVGN        BEGSR
      *================================================================
      * RTV Co Address & Phone RT - Company Name and Address  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSH         KLIST
     C                   KFLD                    ABAIC3                         Company Number
      * Setup key
     C                   Z-ADD     BEAIC3        ABAIC3                         Company Number
      * Establish starting position
     C     KRSSH         CHAIN     @ABREG3                            90        *
      * Data record not found
     C   90              MOVEL     'USR0003'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     ABADTX        WUADTX                         Name
     C                   MOVEL     ABACNA        WUACNA                         Address Line 1
     C                   MOVEL     ABADNA        WUADNA                         Address Line 2
     C                   MOVEL     ABAENA        WUAENA                         Address Line 3
     C                   MOVEL     ABAJNA        WUAJNA                         City
     C                   MOVEL     ABBTTX        WUBTTX                         Zip Postal Code
     C                   MOVEL     ABBVTX        WUBVTX                         Telephone Numbe
     C                   MOVEL     ABBGCD        WUBGCD                         State Code
     C                   ENDIF
      *================================================================
     CSR   SHEXIT        ENDSR
      /EJECT
     CSR   SIRVGN        BEGSR
      *================================================================
      * RTV Country Code       RT - Customer  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSI         KLIST
     C                   KFLD                    BBBKC7                         Ship To Custome
      * Setup key
     C                   Z-ADD     WL0001        BBBKC7                         Ship To Custome
      * Establish starting position
     C     KRSSI         CHAIN     @BBREE9                            90        *
      * Data record not found
     C   90              MOVEL     'USR0170'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     BBKXCD        WL0002                         Country Code
     C                   ENDIF
      *================================================================
     CSR   SIEXIT        ENDSR
      /EJECT
     CSR   SJRVGN        BEGSR
      *================================================================
      * RTV Desc, Status       RT - Country  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSJ         KLIST
     C                   KFLD                    E5KXCD                         Country Code
      * Setup key
     C                   MOVEL     WL0003        E5KXCD                         Country Code
      * Establish starting position
     C     KRSSJ         CHAIN     @E5REB8                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR1158'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      WL0004 = ' '                                 Country Descrip
     C                   EVAL      WL0005 = ' '                                 Record Status
     C                   GOTO      SJEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     E5DATX        WL0004                         Country Descrip
     C                   MOVEL     E5VSST        WL0005                         Record Status
     C                   ENDIF
      *================================================================
     CSR   SJEXIT        ENDSR
      /EJECT
     CSR   SKRVGN        BEGSR
      *================================================================
      * RTV 1st Warehouse/UOM  RT - Order Detail  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KPSSK         KLIST
     C                   KFLD                    WQSK01                         Company Number
     C                   KFLD                    WQSK02                         Order Number
     C                   KFLD                    OMDPNB                         Order Sequence
     C                   KFLD                    OMUENB                         Order Secondary
      * Define keylist
     C     KRSSK         KLIST
     C                   KFLD                    WQSK01                         Company Number
     C                   KFLD                    WQSK02                         Order Number
      * Setup key
     C                   Z-ADD     $CAIC3        WQSK01                         Company Number
     C                   Z-ADD     $CC4NB        WQSK02                         Order Number
     C                   Z-ADD     *ZERO         OMDPNB                         Order Sequence
     C                   Z-ADD     *ZERO         OMUENB                         Order Secondary
      * Establish starting position
     C     KPSSK         SETLL     @BGWKAE                                      *
     C     KRSSK         READE     @BGWKAE                                90    *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR1309'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      $CT3CD = ' '                                 Warehouse Code
     C                   GOTO      SKEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   DOW       NOT *IN90
     C                   MOVEL     OMAJCD        $CT3CD                         Warehouse Code
     C                   GOTO      SKEXIT                                       *QUIT
     C     KRSSK         READE     @BGWKAE                                90    *
     C                   ENDDO
      *================================================================
     CSR   SKEXIT        ENDSR
      /EJECT
     CSR   SLRVGN        BEGSR
      *================================================================
      * RTV Country Code only  RT - Order Detail  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSL         KLIST
     C                   KFLD                    WQSL01                         Company Number
     C                   KFLD                    WQSL02                         Order Number
      * Setup key
     C                   Z-ADD     WL0006        WQSL01                         Company Number
     C                   Z-ADD     WL0007        WQSL02                         Order Number
      * Establish starting position
     C     KRSSL         SETLL     @BGWKAE                                      *
     C     KRSSL         READE     @BGWKAE                                90    *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR1309'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      WL0008 = ' '                                 Country Code
     C                   GOTO      SLEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C                   DOW       NOT *IN90
      * PAR = DB1 By name
     C                   IF        OMGMST = 'L' OR
     C                             OMGMST = 'A' OR
     C                             OMGMST = 'C' OR
     C                             OMGMST = 'R' OR
     C                             OMGMST = 'E' OR
     C                             OMGMST = 'H' OR
     C                             OMGMST = 'I'
     C                   MOVEL     OMKXCD        WL0008                         Country Code
     C                   GOTO      SLEXIT                                       *QUIT
     C                   END                                                    *FI
     C     KRSSL         READE     @BGWKAE                                90    *
     C                   ENDDO
      *================================================================
     CSR   SLEXIT        ENDSR
      /EJECT
     CSR   SMRVGN        BEGSR
      *================================================================
      * Rtv Consignee/Consgnr2 RT - Export Doc Order Hdr  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * PAR = CON By name
     C                   EVAL      WL0012 = ' '                                 Country Code
     C                   EVAL      WL0013 = ' '                                 ED Consignor Na
     C                   EVAL      WL0014 = ' '                                 ED Consignor Ad
     C                   EVAL      WL0015 = ' '                                 ED Consignor Ad
     C                   EVAL      WL0016 = ' '                                 ED Consignor Ad
     C                   EVAL      WL0017 = ' '                                 ED Consignor Ad
     C                   EVAL      WL0018 = ' '                                 ED Consignor St
     C                   EVAL      WL0019 = ' '                                 ED Consignor Po
     C                   EVAL      WL0020 = ' '                                 ED Consignor Co
     C                   EVAL      WL0021 = ' '                                 ED Consignee Na
     C                   EVAL      WL0022 = ' '                                 ED Consignee Ad
     C                   EVAL      WL0023 = ' '                                 ED Consignee Ad
     C                   EVAL      WL0024 = ' '                                 ED Consignee Ad
     C                   EVAL      WL0025 = ' '                                 ED Consignee Ad
     C                   EVAL      WL0026 = ' '                                 ED Consignee St
     C                   EVAL      WL0027 = ' '                                 ED Consignee Po
     C                   EVAL      WL0028 = ' '                                 ED Consignee Co
     C                   EVAL      WL0029 = ' '                                 ED Shipping Mar
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSM         KLIST
     C                   KFLD                    WQSM01                         Company Number
     C                   KFLD                    WQSM02                         Order Number
     C                   KFLD                    WQSM03                         ED Export Docum
      * Setup key
     C                   Z-ADD     WL0009        WQSM01                         Company Number
     C                   Z-ADD     WL0010        WQSM02                         Order Number
     C                   MOVEL     WL0011        WQSM03                         ED Export Docum
      * Establish starting position
     C     KRSSM         SETLL     @MRREWT                                      *
     C     KRSSM         READE     @MRREWT                                90    *
      * Data record not found
     C   90              MOVEL     'USR2743'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   DOW       NOT *IN90
     C                   MOVEL     MRKXCD        WL0012                         Country Code
     C                   MOVEL     MRPUTX        WL0013                         ED Consignor Na
     C                   MOVEL     MRPVTX        WL0014                         ED Consignor Ad
     C                   MOVEL     MRPWTX        WL0015                         ED Consignor Ad
     C                   MOVEL     MRRVTX        WL0016                         ED Consignor Ad
     C                   MOVEL     MRPPU1        WL0017                         ED Consignor Ad
     C                   MOVEL     MRZ7AA        WL0018                         ED Consignor St
     C                   MOVEL     MRPDU1        WL0019                         ED Consignor Po
     C                   MOVEL     MRZ8AA        WL0020                         ED Consignor Co
     C                   MOVEL     MRRHTX        WL0021                         ED Consignee Na
     C                   MOVEL     MRRITX        WL0022                         ED Consignee Ad
     C                   MOVEL     MRRJTX        WL0023                         ED Consignee Ad
     C                   MOVEL     MRSCTX        WL0024                         ED Consignee Ad
     C                   MOVEL     MRSDTX        WL0025                         ED Consignee Ad
     C                   MOVEL     MRAAAB        WL0026                         ED Consignee St
     C                   MOVEL     MRPHU1        WL0027                         ED Consignee Po
     C                   MOVEL     MRABAB        WL0028                         ED Consignee Co
     C                   MOVEL     MRORNA        WL0029                         ED Shipping Mar
     C                   GOTO      SMEXIT                                       *QUIT
     C     KRSSM         READE     @MRREWT                                90    *
     C                   ENDDO
      *================================================================
     CSR   SMEXIT        ENDSR
      /EJECT
     CSR   SNRVGN        BEGSR
      *================================================================
      * Rtv Live with PHIS    RT - Export Doc Defaults  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * PAR = CON By name
     C                   EVAL      YL0004 = ' '                                 ED Live with PH
      * Define keylist
     C     KRSSN         KLIST
     C                   KFLD                    MMAIC3                         Company Number
     C                   KFLD                    MMDGSX                         ED Export Docum
     C                   KFLD                    MMKXCD                         Country Code
      * Setup key
     C                   Z-ADD     $CAIC3        MMAIC3                         Company Number
     C                   MOVEL     'A'           MMDGSX                         ED Export Docum
     C                   MOVEL     YL0003        MMKXCD                         Country Code
      * Establish starting position
     C     KRSSN         CHAIN     @MMREWN                            90        *
      * Data record not found
     C   90              MOVEL     'USR2733'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     MMC2SX        YL0004                         ED Live with PH
     C                   ENDIF
      *================================================================
     CSR   SNEXIT        ENDSR
      /EJECT
     CSR   SORVGN        BEGSR
      *================================================================
      * Rtv Country Desc       RT - Country  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * PAR = CON By name
     C                   EVAL      WL0031 = ' '                                 Country Descrip
      * Define keylist
     C     KRSSO         KLIST
     C                   KFLD                    E5KXCD                         Country Code
      * Setup key
     C                   MOVEL     WL0030        E5KXCD                         Country Code
      * Establish starting position
     C     KRSSO         CHAIN     @E5REB8                            90        *
      * Data record not found
     C   90              MOVEL     'USR1158'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     E5DATX        WL0031                         Country Descrip
     C                   ENDIF
      *================================================================
     CSR   SOEXIT        ENDSR
      /EJECT
     CSR   SPRVGN        BEGSR
      *================================================================
      * Rtv Destination RemrksRT - Export Doc Order Hdr  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSP         KLIST
     C                   KFLD                    WQSP01                         Company Number
     C                   KFLD                    WQSP02                         Order Number
     C                   KFLD                    WQSP03                         ED Export Docum
      * Setup key
     C                   Z-ADD     $CAIC3        WQSP01                         Company Number
     C                   Z-ADD     $CC4NB        WQSP02                         Order Number
     C                   MOVEL     'H'           WQSP03                         ED Export Docum
      * Establish starting position
     C     KRSSP         SETLL     @MRREWT                                      *
     C     KRSSP         READE     @MRREWT                                90    *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR2743'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      $CP3TX = ' '                                 ED Remark Const
     C                   EVAL      $CP4TX = ' '                                 ED Remark Const
     C                   EVAL      $CP5TX = ' '                                 ED Remark Const
     C                   EVAL      $CP6TX = ' '                                 ED Remark Const
     C                   GOTO      SPEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   DOW       NOT *IN90
     C                   MOVEL     MRP3TX        $CP3TX                         ED Remark Const
     C                   MOVEL     MRP4TX        $CP4TX                         ED Remark Const
     C                   MOVEL     MRP5TX        $CP5TX                         ED Remark Const
     C                   MOVEL     MRP6TX        $CP6TX                         ED Remark Const
     C                   GOTO      SPEXIT                                       *QUIT
     C     KRSSP         READE     @MRREWT                                90    *
     C                   ENDDO
      *================================================================
     CSR   SPEXIT        ENDSR
      /EJECT
     CSR   SQRVGN        BEGSR
      *================================================================
      * Rtv Record count      RT - Customer Comment  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSQ         KLIST
     C                   KFLD                    WQSQ01                         Ship To Custome
     C                   KFLD                    WQSQ02                         Comment Type
      * Setup key
     C                   Z-ADD     WL0032        WQSQ01                         Ship To Custome
     C                   MOVEL     WL0033        WQSQ02                         Comment Type
      * Establish starting position
     C     KRSSQ         SETLL     @AVCPG5                                      *
     C     KRSSQ         READE     @AVCPG5                                90    *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR2993'     W0RTN
      * USER: Processing if Data record not found
     C                   Z-ADD     0             WL0034                         USR Count
     C                   GOTO      SQEXIT
     C                   ENDIF
      *
      * USER: Process Data record
     C                   DOW       NOT *IN90
     C                   ADD       1             WL0034                         USR Count
     C     KRSSQ         READE     @AVCPG5                                90    *
     C                   ENDDO
      *================================================================
     CSR   SQEXIT        ENDSR
      /EJECT
     CSR   SRRVGN        BEGSR
      *================================================================
      * Rtv Record count      RT - Country Comment  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSR         KLIST
     C                   KFLD                    WQSR01                         Country Code
     C                   KFLD                    WQSR02                         Comment Type
      * Setup key
     C                   MOVEL     YL0002        WQSR01                         Country Code
     C                   MOVEL     'PL'          WQSR02                         Comment Type
      * Establish starting position
     C     KRSSR         SETLL     @B1REEF                                      *
     C     KRSSR         READE     @B1REEF                                90    *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR3594'     W0RTN
      * USER: Processing if Data record not found
     C                   Z-ADD     0             YL0012                         USR Count
     C                   GOTO      SREXIT
     C                   ENDIF
      *
      * USER: Process Data record
     C                   DOW       NOT *IN90
     C                   ADD       1             YL0012                         USR Count
     C     KRSSR         READE     @B1REEF                                90    *
     C                   ENDDO
      *================================================================
     CSR   SREXIT        ENDSR
      /EJECT
     CSR   SSRVGN        BEGSR
      *================================================================
      * RTV Warehouse Location RT - Warehouse  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSS         KLIST
     C                   KFLD                    ADAJCD                         Warehouse Code
      * Setup key
     C                   MOVEL     $YAJCD        ADAJCD                         Warehouse Code
      * Establish starting position
     C     KRSSS         CHAIN     @ADREAO                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR0007'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      YL0022 = ' '                                 Warehouse Locat
     C                   GOTO      SSEXIT                                       *QUIT
     C                   GOTO      SSEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     ADT0ST        YL0022                         Warehouse Locat
     C                   GOTO      SSEXIT                                       *QUIT
     C                   ENDIF
      *================================================================
     CSR   SSEXIT        ENDSR
      /EJECT
     CSR   STRVGN        BEGSR
      *================================================================
      * Rtv Cust Item Ref     RT - Customer Item Reference  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSST         KLIST
     C                   KFLD                    BIBKC7                         Ship To Custome
     C                   KFLD                    BIHGCD                         Item Code
      * Setup key
     C                   Z-ADD     WCBKC7        BIBKC7                         Ship To Custome
     C                   Z-ADD     $YHGCD        BIHGCD                         Item Code
      * Establish starting position
     C     KRSST         CHAIN     @BIREKY                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR3081'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      YL0024 = ' '                                 CIR Resource No
     C                   GOTO      STEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     BICOAA        YL0024                         CIR Resource No
     C                   ENDIF
      *================================================================
     CSR   STEXIT        ENDSR
      /EJECT
     CSR   SURVGN        BEGSR
      *================================================================
      * RTV & Chk Rate Exists  RT - Customer Accrual Item  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSU         KLIST
     C                   KFLD                    HPBKC7                         Ship To Custome
     C                   KFLD                    HPOJCD                         Accrual Code
     C                   KFLD                    HPGUNY                         CAH Sequence No
     C                   KFLD                    HPHGCD                         Item Code
      * Setup key
     C                   Z-ADD     WL0035        HPBKC7                         Ship To Custome
     C                   MOVEL     WL0036        HPOJCD                         Accrual Code
     C                   Z-ADD     WL0037        HPGUNY                         CAH Sequence No
     C                   Z-ADD     WL0038        HPHGCD                         Item Code
      * Establish starting position
     C     KRSSU         CHAIN     @HPRELD                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR1522'     W0RTN
      * USER: Processing if Data record not found
     C                   MOVEL     'Y2U0005'     W0RTN                          *Return code
      * PAR = CON By name
     C                   Z-ADD     *ZERO         WL0039                         Accrual Rate
     C                   EVAL      WL0040 = ' '                                 Accrual Rate Ty
     C                   GOTO      SUEXIT
     C                   ENDIF
      *
      * USER: Process Data record
     C                   IF        NOT *IN90
     C                   EVAL      W0RTN = ' '                                  *Return code
      * PAR = DB1 By name
     C                   Z-ADD     HPBKPR        WL0039                         Accrual Rate
     C                   MOVEL     HPSHSX        WL0040                         Accrual Rate Ty
     C                   ENDIF
      *================================================================
     CSR   SUEXIT        ENDSR
      /EJECT
     CSR   SVRVGN        BEGSR
      *================================================================
      * RTV & Chk Rate Exists RT - Customer Accrual Str  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSV         KLIST
     C                   KFLD                    C8BKC7                         Ship To Custome
     C                   KFLD                    C8OJCD                         Accrual Code
     C                   KFLD                    C8GUNY                         CAH Sequence No
     C                   KFLD                    C8RGNB                         Item Structure
     C                   KFLD                    C8RHNB                         Item Structure
     C                   KFLD                    C8RINB                         Item Structure
      * Setup key
     C                   Z-ADD     WL0041        C8BKC7                         Ship To Custome
     C                   MOVEL     WL0042        C8OJCD                         Accrual Code
     C                   Z-ADD     WL0043        C8GUNY                         CAH Sequence No
     C                   Z-ADD     WL0044        C8RGNB                         Item Structure
     C                   Z-ADD     WL0045        C8RHNB                         Item Structure
     C                   Z-ADD     WL0046        C8RINB                         Item Structure
      * Establish starting position
     C     KRSSV         CHAIN     @C8RES1                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR3294'     W0RTN
      * USER: Processing if Data record not found
     C                   MOVEL     'Y2U0005'     W0RTN                          *Return code
      * PAR = CON By name
     C                   Z-ADD     *ZERO         WL0047                         Accrual Rate
     C                   EVAL      WL0048 = ' '                                 Accrual Rate Ty
     C                   GOTO      SVEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   Z-ADD     C8BKPR        WL0047                         Accrual Rate
     C                   MOVEL     C8SHSX        WL0048                         Accrual Rate Ty
     C                   EVAL      W0RTN = ' '                                  *Return code
     C                   ENDIF
      *================================================================
     CSR   SVEXIT        ENDSR
      /EJECT
     CSR   SWRVGN        BEGSR
      *================================================================
      * RTV Accrual Descript   RT - Accrual Code Master  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSW         KLIST
     C                   KFLD                    HLOJCD                         Accrual Code
      * Setup key
     C                   MOVEL     #AOJCD        HLOJCD                         Accrual Code
      * Establish starting position
     C     KRSSW         CHAIN     @HLREK4                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR1514'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      #AQZNA = ' '                                 Accrual Descrip
     C                   MOVEL     'Y2U0005'     W0RTN                          *Return code
     C                   GOTO      SWEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     HLLENA        #AQZNA                         Accrual Descrip
     C                   ENDIF
      *================================================================
     CSR   SWEXIT        ENDSR
      /EJECT
     CSR   SXRVGN        BEGSR
      *================================================================
      * RTV Accrual Info       RT - Accrual Program  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSX         KLIST
     C                   KFLD                    HLOJCD                         Accrual Code
      * Setup key
     C                   MOVEL     HOOJCD        HLOJCD                         Accrual Code
      * Establish starting position
     C     KRSSX         CHAIN     @HLREK4                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR1514'     W0RTN
      * USER: Processing if Data record not found
     C                   MOVEL     'Y2U0005'     W0RTN                          *Return code
      * PAR = CON By name
     C                   EVAL      YL0025 = ' '                                 Accrual Type
     C                   GOTO      SXEXIT
     C                   ENDIF
      *
      * USER: Process Data record
     C                   IF        NOT *IN90
     C                   EVAL      W0RTN = ' '                                  *Return code
      * PAR = DB1 By name
     C                   MOVEL     HLOKCD        YL0025                         Accrual Type
     C                   ENDIF
      *================================================================
     CSR   SXEXIT        ENDSR
      /EJECT
     CSR   SYRVGN        BEGSR
      *================================================================
      * RTV Salesperson Name   RT - Salesperson  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSY         KLIST
     C                   KFLD                    APBCCD                         Salesperson Cod
      * Setup key
     C                   MOVEL     WL0049        APBCCD                         Salesperson Cod
      * Establish starting position
     C     KRSSY         CHAIN     @APREBU                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR0039'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      WL0049 = ' '                                 Salesperson Cod
     C                   EVAL      WL0050 = ' '                                 Salesperson Nam
     C                   MOVEL     'Y2U0005'     W0RTN                          *Return code
     C                   GOTO      SYEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     APBCCD        WL0049                         Salesperson Cod
     C                   MOVEL     APALTX        WL0050                         Salesperson Nam
     C                   ENDIF
      *================================================================
     CSR   SYEXIT        ENDSR
      /EJECT
     CSR   SZRVGN        BEGSR
      *================================================================
      * RTV Check Warehouse    RT - PD Order Detail  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSZ         KLIST
     C                   KFLD                    WQSZ01                         Company Number
     C                   KFLD                    WQSZ02                         Order Number
      * Setup key
     C                   Z-ADD     WL0051        WQSZ01                         Company Number
     C                   Z-ADD     WL0052        WQSZ02                         Order Number
      * Establish starting position
     C     KRSSZ         SETLL     @BGWKL1                                      *
     C     KRSSZ         READE     @BGWKL1                                90    *
      * Data record not found
     C   90              MOVEL     'USR1309'     W0RTN
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Cancelled
     C                   DOW       NOT *IN90
     C                   IF        WCGMST = 'X'
     C                   ELSE
      * CASE: DB1.Warehouse Code EQ PAR.Warehouse Code
     C                   IF        WCAJCD = WL0053
     C                   MOVEL     'Y'           WL0054                         Select Status
     C                   GOTO      SZEXIT                                       *QUIT
     C                   END                                                    *FI
     C                   END                                                    *FI
     C     KRSSZ         READE     @BGWKL1                                90    *
     C                   ENDDO
      *================================================================
     CSR   SZEXIT        ENDSR
      /EJECT
     CSR   TARVGN        BEGSR
      *================================================================
      * RTV Warehouse code     RT - PD Order Detail  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KPSTA         KLIST
     C                   KFLD                    WQTA01                         Company Number
     C                   KFLD                    WQTA02                         Order Number
     C                   KFLD                    WCDPNB                         Order Sequence
     C                   KFLD                    WCUENB                         Order Secondary
      * Define keylist
     C     KRSTA         KLIST
     C                   KFLD                    WQTA01                         Company Number
     C                   KFLD                    WQTA02                         Order Number
      * Setup key
     C                   Z-ADD     BEAIC3        WQTA01                         Company Number
     C                   Z-ADD     BEC4NB        WQTA02                         Order Number
     C                   Z-ADD     *ZERO         WCDPNB                         Order Sequence
     C                   Z-ADD     *ZERO         WCUENB                         Order Secondary
      * Establish starting position
     C     KPSTA         SETLL     @BGWKL1                                      *
     C     KRSTA         READE     @BGWKL1                                90    *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR1309'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      WUAJCD = ' '                                 Warehouse Code
     C                   GOTO      TAEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * C2748:  Changed RTV Warehouse Code RT to exclude Cancelled lines.
      * CASE: DB1.Detail Line Status is Cancelled
     C                   DOW       NOT *IN90
     C                   IF        WCGMST = 'X'
     C                   ELSE
      * CASE: *OTHERWISE
      * PAR = DB1 By name
     C                   MOVEL     WCAJCD        WUAJCD                         Warehouse Code
     C                   GOTO      TAEXIT                                       *QUIT
     C                   END                                                    *FI
     C     KRSTA         READE     @BGWKL1                                90    *
     C                   ENDDO
      *================================================================
     CSR   TAEXIT        ENDSR
      /EJECT
     CSR   TBRVGN        BEGSR
      *================================================================
      * RTV Salesman Code      RT - Sales Route  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSTB         KLIST
     C                   KFLD                    WDR4CD                         Sales Route Cod
      * Setup key
     C                   MOVEL     WL0055        WDR4CD                         Sales Route Cod
      * Establish starting position
     C     KRSTB         CHAIN     @JEREWS                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR1800'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      WL0056 = ' '                                 Salesperson Cod
     C                   GOTO      TBEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WDBCCD        WL0056                         Salesperson Cod
     C                   ENDIF
      *================================================================
     CSR   TBEXIT        ENDSR
      /EJECT
     CSR   TCRVGN        BEGSR
      *================================================================
      * Rtv Email/EDI Sts 3    RT - Salesperson Electronic CM  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSTC         KLIST
     C                   KFLD                    NFBCCD                         Salesperson Cod
      * Setup key
     C                   MOVEL     WL0057        NFBCCD                         Salesperson Cod
      * Establish starting position
     C     KRSTC         CHAIN     @NFREAW                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR2882'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      WL0058 = ' '                                 Email Address
     C                   EVAL      WL0059 = ' '                                 EDI Status 3
     C                   GOTO      TCEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     NFUGTX        WL0058                         Email Address
     C                   MOVEL     NFUXST        WL0059                         EDI Status 3
     C                   ENDIF
      *================================================================
     CSR   TCEXIT        ENDSR
      /EJECT
     CSR   TDRVGN        BEGSR
      *================================================================
      * RTV Combo for P & T    RT - Order Header TRG  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * 05/11/04 SLM PKTR01 Multi-Company Order Header TFG
      *                     Remove Co from Parms
     C                   EVAL      WUAGCD = ' '                                 U_M_Ordered
      * RMC added 6-30-21
     C                   EVAL      WUIHSX = ' '                                 Palletize
      * Declare restrictor key work fields
      * Define keylist
     C     KRSTD         KLIST
     C                   KFLD                    WQTD01                         Load ID
     C                   KFLD                    WQTD02                         Order Number
      * Setup key
     C                   Z-ADD     #KRMNB        WQTD01                         Load ID
     C                   Z-ADD     P1C4NB        WQTD02                         Order Number
      * Establish starting position
     C     KRSTD         SETLL     @BFCPR0                                      *
     C     KRSTD         READE     @BFCPR0                                90    *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR0176'     W0RTN
      * USER: Processing if Data record not found
     C                   GOTO      TDEXIT                                       *QUIT
     C                   GOTO      TDEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * RMC change par.palletize to BOTH .. was output - 6/30/21
      * CASE: PAR.U/M - Ordered is Mixed
     C                   DOW       NOT *IN90
     C                   IF        WUAGCD = 'MX'
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     WEVEST        WUVEST                         Palletize
      * RTV Combo for P & T    RT - Order Detail  * 
     C                   EXSR      TERVGN
     C                   END                                                    *FI
      * RMC after 6-30-21   check par.palletize
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Palletize is no
      *   |- c2    : PAR.U/M - Ordered is Combos
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        WUVEST = 'N'
     C                   IF        WUAGCD = 'CB'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   MOVEL     'N'           WUIHSX                         Palletize
     C                   ELSE
      * CASE: *OTHERWISE
      * RTV Pallet Flag/Combo  RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WEAIC3        WL0060                         Company Number
     C                   Z-ADD     WEC4NB        WL0061                         Order Number
     C                   Z-ADD     1             WL0062                         Order Sequence
     C                   Z-ADD     1             WL0063                         Order Secondary
     C                   EXSR      TFRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0064        WUIHSX                         Palletize
     C                   END                                                    *FI
     C     KRSTD         READE     @BFCPR0                                90    *
     C                   ENDDO
      *================================================================
     CSR   TDEXIT        ENDSR
      /EJECT
     CSR   TERVGN        BEGSR
      *================================================================
      * RTV Combo for P & T    RT - Order Detail  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
     C                   MOVEL     'Y'           WUTAST                         First Time Flag
      * Declare restrictor key work fields
      * Define keylist
     C     KPSTE         KLIST
     C                   KFLD                    WQTE01                         Company Number
     C                   KFLD                    WQTE02                         Order Number
     C                   KFLD                    WCDPNB                         Order Sequence
     C                   KFLD                    WCUENB                         Order Secondary
      * Define keylist
     C     KRSTE         KLIST
     C                   KFLD                    WQTE01                         Company Number
     C                   KFLD                    WQTE02                         Order Number
      * Setup key
     C                   Z-ADD     WEAIC3        WQTE01                         Company Number
     C                   Z-ADD     WEC4NB        WQTE02                         Order Number
     C                   Z-ADD     1             WCDPNB                         Order Sequence
     C                   Z-ADD     1             WCUENB                         Order Secondary
      * Establish starting position
     C     KPSTE         SETLL     @BGWKL1                                      *
     C     KRSTE         READE     @BGWKL1                                90    *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR1309'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      WUAGCD = ' '                                 U_M_Ordered
     C                   GOTO      TEEXIT                                       *QUIT
     C                   GOTO      TEEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Cancelled
     C                   DOW       NOT *IN90
     C                   IF        WCGMST = 'X'
     C                   ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.U/M - Ordered is Not Entered
     C                   IF        WUAGCD = ' '
     C                   MOVEL     WCAGCD        WUAGCD                         U_M_Ordered
     C                   ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.U/M - Ordered EQ PAR.U/M - Ordered
     C                   IF        WCAGCD = WUAGCD
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'MX'          WUAGCD                         U_M_Ordered
     C                   GOTO      TEEXIT                                       *QUIT
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C     KRSTE         READE     @BGWKL1                                90    *
     C                   ENDDO
      *================================================================
     CSR   TEEXIT        ENDSR
      /EJECT
     CSR   TFRVGN        BEGSR
      *================================================================
      * RTV Pallet Flag/Combo  RT - Order Detail  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
     C                   EVAL      WL0064 = ' '                                 Palletize
      * Declare restrictor key work fields
      * Define keylist
     C     KPSTF         KLIST
     C                   KFLD                    WQTF01                         Company Number
     C                   KFLD                    WQTF02                         Order Number
     C                   KFLD                    WCDPNB                         Order Sequence
     C                   KFLD                    WCUENB                         Order Secondary
      * Define keylist
     C     KRSTF         KLIST
     C                   KFLD                    WQTF01                         Company Number
     C                   KFLD                    WQTF02                         Order Number
      * Setup key
     C                   Z-ADD     WL0060        WQTF01                         Company Number
     C                   Z-ADD     WL0061        WQTF02                         Order Number
     C                   Z-ADD     WL0062        WCDPNB                         Order Sequence
     C                   Z-ADD     WL0063        WCUENB                         Order Secondary
      * Establish starting position
     C     KPSTF         SETLL     @BGWKL1                                      *
     C     KRSTF         READE     @BGWKL1                                90    *
      * Data record not found
     C   90              MOVEL     'USR1309'     W0RTN
      * USER: Process Data record
      * RMC added not Cancelled check 6-30-21
      * CASE: DB1.Detail Line Status is Not cancelled
     C                   DOW       NOT *IN90
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.U/M - Ordered is Combos
      *   |- c2    : DB1.Palletize is no
      *   '-
     C                   IF        WCGMST = 'L' OR
     C                             WCGMST = 'A' OR
     C                             WCGMST = 'C' OR
     C                             WCGMST = 'R' OR
     C                             WCGMST = 'E' OR
     C                             WCGMST = 'H' OR
     C                             WCGMST = 'I'
     C                   MOVEL     '0'           Y0CX01
     C                   IF        WCAGCD = 'CB'
     C                   IF        WCVEST = 'N'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   MOVEL     WCVEST        WL0064                         Palletize
     C                   GOTO      TFEXIT                                       *QUIT
     C                   END                                                    *FI
     C                   END                                                    *FI
     C     KRSTF         READE     @BGWKL1                                90    *
     C                   ENDDO
      *================================================================
     CSR   TFEXIT        ENDSR
      /EJECT
     CSR   TGRVGN        BEGSR
      *================================================================
      * RTV OHE Ship fields    RT - Order Header Extension  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSTG         KLIST
     C                   KFLD                    AMAIC3                         Company Number
     C                   KFLD                    AMC4NB                         Order Number
      * Setup key
     C                   Z-ADD     #KAIC3        AMAIC3                         Company Number
     C                   Z-ADD     P1C4NB        AMC4NB                         Order Number
      * Establish starting position
     C     KRSTG         CHAIN     @AMREJF                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR3697'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      YL0028 = ' '                                 Shipping Line
     C                   EVAL      YL0029 = ' '                                 Port Delv Termi
     C                   EVAL      YL0030 = ' '                                 OHE City
     C                   EVAL      YL0031 = ' '                                 OHE Vessel_Airl
     C                   EVAL      YL0032 = ' '                                 OHE Voyage_Flig
     C                   EVAL      #KMHNA = ' '                                 OHE Booking Num
     C                   EVAL      YL0033 = ' '                                 OHE Discharge P
     C                   Z-ADD     *ZERO         YL0034                         OHE Sail_Flight
     C                   Z-ADD     *ZERO         YL0035                         OHE Port Cut Da
     C                   Z-ADD     *ZERO         YL0036                         OHE Arrival Dat
     C                   EVAL      YL0037 = ' '                                 OHE Late Delive
     C                   EVAL      YL0038 = ' '                                 OHE Ship Status
     C                   EVAL      YL0039 = ' '                                 OHE Container N
     C                   EVAL      YL0040 = ' '                                 OHE Comment 1
     C                   EVAL      YL0041 = ' '                                 OHE Comment 2
     C                   GOTO      TGEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     AMXACD        YL0028                         Shipping Line
     C                   MOVEL     AMOANA        YL0029                         Port Delv Termi
     C                   MOVEL     AMHBAA        YL0030                         OHE City
     C                   MOVEL     AMJ0T1        YL0031                         OHE Vessel_Airl
     C                   MOVEL     AMGENY        YL0032                         OHE Voyage_Flig
     C                   MOVEL     AMJ1T1        #KMHNA                         OHE Booking Num
     C                   MOVEL     AMHCAA        YL0033                         OHE Discharge P
     C                   Z-ADD     AMQWDT        YL0034                         OHE Sail_Flight
     C                   Z-ADD     AMQXDT        YL0035                         OHE Port Cut Da
     C                   Z-ADD     AMQYDT        YL0036                         OHE Arrival Dat
     C                   MOVEL     AMHDAA        YL0037                         OHE Late Delive
     C                   MOVEL     AMCCTX        YL0038                         OHE Ship Status
     C                   MOVEL     AMJ2T1        YL0039                         OHE Container N
     C                   MOVEL     AMRLNA        YL0040                         OHE Comment 1
     C                   MOVEL     AMRMNA        YL0041                         OHE Comment 2
     C                   ENDIF
      *================================================================
     CSR   TGEXIT        ENDSR
      /EJECT
     CSR   THRVGN        BEGSR
      *================================================================
      * RTV OHE Delivery PO #  RT - Order Header Extension  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSTH         KLIST
     C                   KFLD                    AMAIC3                         Company Number
     C                   KFLD                    AMC4NB                         Order Number
      * Setup key
     C                   Z-ADD     #KAIC3        AMAIC3                         Company Number
     C                   Z-ADD     P1C4NB        AMC4NB                         Order Number
      * Establish starting position
     C     KRSTH         CHAIN     @AMREJF                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR3697'     W0RTN
      * USER: Processing if Data record not found
     C                   MOVEL     'Y2U0005'     W0RTN                          *Return code
      * PAR = CON By name
     C                   EVAL      #KLMT1 = ' '                                 Delivery P_O  N
     C                   GOTO      THEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     AMLMT1        #KLMT1                         Delivery P_O  N
     C                   GOTO      THEXIT                                       *QUIT
     C                   ENDIF
      *================================================================
     CSR   THEXIT        ENDSR
      /EJECT
     CSR   TIRVGN        BEGSR
      *================================================================
      * Rtv Print Req Delv Tm RT - Company Customer EXT  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSTI         KLIST
     C                   KFLD                    NIAIC3                         Company Number
     C                   KFLD                    NIBKC7                         Ship To Custome
      * Setup key
     C                   Z-ADD     #KAIC3        NIAIC3                         Company Number
     C                   Z-ADD     #KBKC7        NIBKC7                         Ship To Custome
      * Establish starting position
     C     KRSTI         CHAIN     @NIREBO                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR2904'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      YL0042 = ' '                                 Print Req Delv
     C                   GOTO      TIEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     NIHLST        YL0042                         Print Req Delv
     C                   ENDIF
      *================================================================
     CSR   TIEXIT        ENDSR
      /EJECT
     CSR   TJRVGN        BEGSR
      *================================================================
      * Rtv Unique Pallet Type RT - Order Detail  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * PAR = CON By name
     C                   EVAL      #KLZSC = ' '                                 Pallet Type 1
     C                   EVAL      #KL0SC = ' '                                 Pallet Type 2
     C                   EVAL      #KL1SC = ' '                                 Pallet Type 3
     C                   EVAL      #KL2SC = ' '                                 Pallet Type 4
      * Declare restrictor key work fields
      * Define keylist
     C     KPSTJ         KLIST
     C                   KFLD                    WQTJ01                         Company Number
     C                   KFLD                    WQTJ02                         Order Number
     C                   KFLD                    OMDPNB                         Order Sequence
     C                   KFLD                    OMUENB                         Order Secondary
      * Define keylist
     C     KRSTJ         KLIST
     C                   KFLD                    WQTJ01                         Company Number
     C                   KFLD                    WQTJ02                         Order Number
      * Setup key
     C                   Z-ADD     #KAIC3        WQTJ01                         Company Number
     C                   Z-ADD     P1C4NB        WQTJ02                         Order Number
     C                   Z-ADD     1             OMDPNB                         Order Sequence
     C                   Z-ADD     1             OMUENB                         Order Secondary
      * Establish starting position
     C     KPSTJ         SETLL     @BGWKAE                                      *
     C     KRSTJ         READE     @BGWKAE                                90    *
      * Data record not found
     C   90              MOVEL     'USR1309'     W0RTN
      * USER: Process Data record
      * Send Back Up to 4 Unique Pallet Types Only.
      * CASE:
      *  - NOTc1
      *   |- c1    : DB1.OD Pallet Type is None
      *   '-
     C                   DOW       NOT *IN90
     C                   MOVEL     '0'           Y0CX01
     C                   IF        OMF5SX = ' '
     C                   ELSE
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
      * NOTE: Per Rose, an Order shouldn't have more than 4 unique Pallet
      * Set Pallet Type 1.
      * CASE: PAR.Pallet Type 1 is None
     C                   IF        Y0CX01 = '1'
     C                   IF        #KLZSC = ' '
     C                   MOVEL     OMF5SX        #KLZSC                         Pallet Type 1
     C                   ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Pallet Type 1 EQ DB1.OD Pallet Type
     C                   IF        #KLZSC = OMF5SX
     C                   ELSE
      * CASE: *OTHERWISE
      * Set Pallet Type 2.
      * CASE: PAR.Pallet Type 2 is None
     C                   IF        #KL0SC = ' '
     C                   MOVEL     OMF5SX        #KL0SC                         Pallet Type 2
     C                   ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Pallet Type 2 EQ DB1.OD Pallet Type
     C                   IF        #KL0SC = OMF5SX
     C                   ELSE
      * CASE: *OTHERWISE
      * Set Pallet Type 3.
      * CASE: PAR.Pallet Type 3 is None
     C                   IF        #KL1SC = ' '
     C                   MOVEL     OMF5SX        #KL1SC                         Pallet Type 3
     C                   ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Pallet Type 3 EQ DB1.OD Pallet Type
     C                   IF        #KL1SC = OMF5SX
     C                   ELSE
      * CASE: *OTHERWISE
      * Set Pallet Type 4.
      * CASE: PAR.Pallet Type 4 is None
     C                   IF        #KL2SC = ' '
     C                   MOVEL     OMF5SX        #KL2SC                         Pallet Type 4
     C                   GOTO      TJEXIT                                       *QUIT
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C     KRSTJ         READE     @BGWKAE                                90    *
     C                   ENDDO
      *================================================================
     CSR   TJEXIT        ENDSR
      /EJECT
     CSR   UASUBR        BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Hdr Comment 3/Lne PO
      *================================================================
      * CASE: DB1.Comment Print Acknowledge is no
     C                   IF        BEGTST = 'N'
     C                   GOTO      UAEXIT                                       *QUIT
     C                   END                                                    *FI
      * PRT Hdr Comment 3/Lne PO: Mainline
     C                   EXSR      B0MAIN
      *================================================================
     CSR   UAEXIT        ENDSR
      /EJECT
     CSR   UBSUBR        BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Hdr Comment 3/Lne PO
      *================================================================
      * PRT Hdr Comment 3/Lne PO: Mainline
     C                   EXSR      C0MAIN
      *================================================================
     CSR   UBEXIT        ENDSR
      /EJECT
     CSR   UCSUBR        BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Hdr Comment 3/Lne PO
      *================================================================
      * PRT Hdr Comment 3/Lne PO: Mainline
     C                   EXSR      D0MAIN
      *================================================================
     CSR   UCEXIT        ENDSR
      /EJECT
     CSR   UDSUBR        BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Hdr Comment 3/Lne PO
      *================================================================
      * PRT Hdr Comment 3/Lne PO: Mainline
     C                   EXSR      E0MAIN
      *================================================================
     CSR   UDEXIT        ENDSR
      /EJECT
     CSR   UESUBR        BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Ship Inst 3/Line  PO
      *================================================================
      * PRT Ship Inst 3/Line  PO: Mainline
     C                   EXSR      F0MAIN
      *================================================================
     CSR   UEEXIT        ENDSR
      /EJECT
     CSR   UFSUBR        BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Cust Comment PL   PO
      *================================================================
      * Rtv Record count      RT - Customer Comment  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     BEBKC7        WL0032                         Ship To Custome
     C                   MOVEL(P)  'PI'          WL0033                         Comment Type
     C                   Z-ADD     YL0012        WL0034                         USR Count
     C                   EXSR      SQRVGN
      * Move subroutine local variables to output parameters.
     C                   Z-ADD     WL0034        YL0012                         USR Count
      * CASE: LCL.USR Count is EQ 0
     C                   IF        YL0012 = 0
     C                   GOTO      UFEXIT                                       *QUIT
     C                   END                                                    *FI
      * Prt Cust Comment PL   PO: Mainline
     C                   EXSR      G0MAIN
      *================================================================
     CSR   UFEXIT        ENDSR
      /EJECT
     CSR   UGSUBR        BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Country Comment   PO
      *================================================================
      * RTV Country Code only  RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     $DAIC3        WL0006                         Company Number
     C                   Z-ADD     $DC4NB        WL0007                         Order Number
     C                   EXSR      SLRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0008        YL0002                         Country Code
      * Rtv Record count      RT - Country Comment  * 
     C                   EXSR      SRRVGN
      * CASE: LCL.USR Count is EQ 0
     C                   IF        YL0012 = 0
     C                   GOTO      UGEXIT                                       *QUIT
     C                   END                                                    *FI
      * Prt Country Comment   PO: Mainline
     C                   EXSR      H0MAIN
      *================================================================
     CSR   UGEXIT        ENDSR
      /EJECT
     CSR   UHSUBR        BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT All Orders on Load PO
      *================================================================
      * PRT All Orders on Load PO: Mainline
     C                   EXSR      I0MAIN
      *================================================================
     CSR   UHEXIT        ENDSR
      /EJECT
     CSR   UISUBR        BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Detail-Acknowledge PO
      *================================================================
      *
     C                   EVAL      WN0001 = ' '                                 Display Flag
      *
      * PRT Detail-Acknowledge PO: Mainline
     C                   EXSR      J0MAIN
      *================================================================
     CSR   UIEXIT        ENDSR
     C     UJ1UF         BEGSR
     C     *LIKE         DEFINE    WUADTX        UUADTX
     C     *LIKE         DEFINE    WUACNA        UUACNA
     C     *LIKE         DEFINE    WUADNA        UUADNA
     C     *LIKE         DEFINE    WUAENA        UUAENA
     C     *LIKE         DEFINE    WUAJNA        UUAJNA
     C     *LIKE         DEFINE    WUBGCD        UUEINA
     C     *LIKE         DEFINE    WUBTTX        UUBTTX          - 1
     C     *LIKE         DEFINE    WUDATX        UUDATX
     C                   MOVE      *BLANK        UAD
     C                   Z-ADD     1             UX                2 0
     C                   MOVEL     UUADTX        UAD(UX)
     C                   ADD       1             UX
     C     UUACNA        IFNE      *BLANK
     C                   MOVEL     UUACNA        UAD(UX)
     C                   ADD       1             UX
     C                   END
     C     UUADNA        IFNE      *BLANK
     C                   MOVEL     UUADNA        UAD(UX)
     C                   ADD       1             UX
     C                   END
     C     UUAENA        IFNE      *BLANK
     C                   MOVEL     UUAENA        UAD(UX)
     C                   ADD       1             UX
     C                   END
     C                   MOVE      *BLANK        UUCSTZ           34
     C                   MOVEL     UUAJNA        UUCST            23
     C                   MOVE      UUEINA        UUCST
     C                   MOVEL     UUCST         UUCSTZ
     C                   MOVE      UUBTTX        UUCSTZ
     C                   MOVEL     UUCSTZ        UAD(UX)
     C     UUDATX        IFNE      *BLANK
     C                   ADD       1             UX
     C                   MOVEL     UUDATX        UAD(UX)
     C                   END
     C                   ENDSR
      /EJECT
     CSR   UJSUBR        BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT ODA-Acknowledge   PO
      *================================================================
      * PRT ODA-Acknowledge   PO: Mainline
     C                   EXSR      K0MAIN
      *================================================================
     CSR   UJEXIT        ENDSR
      /EJECT
     CSR   UKSUBR        BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT CA-Acknowledge    PO
      *================================================================
      * CASE: PAR.Company Organization is Not Seaboard
     C                   IF        YL0001 = 'D' OR
     C                             YL0001 = 'H'
     C                   GOTO      UKEXIT                                       *QUIT
     C                   END                                                    *FI
      * PRT CA-Acknowledge    PO: Mainline
     C                   EXSR      L0MAIN
      *================================================================
     CSR   UKEXIT        ENDSR
      /EJECT
     CSR   ULSUBR        BEGSR
      *================================================================
      * Embedded PRTOBJ : Print Detail Comment
      *================================================================
      * CASE: DB1.Comment Print Acknowledge is no
     C                   IF        WCGTST = 'N'
     C                   GOTO      ULEXIT                                       *QUIT
     C                   END                                                    *FI
      * PRT Detail Comment     PO: Mainline
     C                   EXSR      M0MAIN
      *================================================================
     CSR   ULEXIT        ENDSR
      /EJECT
     CSR   UMSUBR        BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Detail Financials  PO
      *================================================================
      * PRT Detail Financials  PO: Mainline
     C                   EXSR      N0MAIN
      *================================================================
     CSR   UMEXIT        ENDSR
      /EJECT
     CSR   UNSUBR        BEGSR
      *================================================================
      * Embedded PRTOBJ : Print Item Brokers
      *================================================================
      * PRT Item Brokers       PO: Mainline
     C                   EXSR      O0MAIN
      *================================================================
     CSR   UNEXIT        ENDSR
      /EJECT
     CSR   UOSUBR        BEGSR
      *================================================================
      * Embedded PRTOBJ : Print item/cust brokers
      *================================================================
      * PRT item/cust brokers  PO: Mainline
     C                   EXSR      R0MAIN
      *================================================================
     CSR   UOEXIT        ENDSR
      /EJECT
     CSR   XDVC2T        BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                   Z-ADD     0             XDEX01                         CC
     C                   IF        XDDTFM = 'DMY'
     C                   Z-ADD     XDINDD        XDEX02                         DD
     C                   Z-ADD     XDINMM        XDEX03                         MM
     C                   Z-ADD     XDINYY        XDEX04                         YY
     C                   ELSE
     C                   IF        XDDTFM = 'MDY'
     C                   Z-ADD     XDINMM        XDEX02                         MM
     C                   Z-ADD     XDINDD        XDEX03                         DD
     C                   Z-ADD     XDINYY        XDEX04                         YY
     C                   ELSE
      * YMD format
     C                   Z-ADD     XDINYY        XDEX02                         YY
     C                   Z-ADD     XDINMM        XDEX03                         MM
     C                   Z-ADD     XDINDD        XDEX04                         DD
     C                   END
     C                   END
      *================================================================
     CSR   XDVC2E        ENDSR
      /EJECT
     CSR   ZASNMS        BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C                   IF        ZAPGMQ = ' '
     C                   MOVEL     ##PGM         ZAPGMQ
     C                   END
     C                   CALL      'Y2SNMGC'
     C                   PARM                    ZAPGMQ                         Program queue
     C                   PARM                    ZAPGRL                         Rel queue
     C                   PARM                    ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   PARM                    ZAMSTP                         Message type
     C                   PARM      'Y'           YILE
      * Clear all fields for default mechanism next time
     C                   EVAL      ZAPGMQ = ' '
     C                   EVAL      ZAPGRL = ' '
     C                   EVAL      ZAMSID = ' '
     C                   EVAL      ZAMSGF = ' '
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSTP = ' '
      *================================================================
     CSR   ZAEXIT        ENDSR
      /EJECT
     CSR   ZBINIT        BEGSR
      *================================================================
      * PRT Hdr Comment 3/Lne PO: Initialise
      *================================================================
      * USER: Initialize program
     C                   Z-ADD     *ZERO         YL0008                         Count USR
      *================================================================
     CSR   ZBEXIT        ENDSR
      /EJECT
     CSR   ZCINIT        BEGSR
      *================================================================
      * PRT Hdr Comment 3/Lne PO: Initialise
      *================================================================
      * USER: Initialize program
     C                   Z-ADD     *ZERO         YL0008                         Count USR
      *================================================================
     CSR   ZCEXIT        ENDSR
      /EJECT
     CSR   ZDINIT        BEGSR
      *================================================================
      * PRT Hdr Comment 3/Lne PO: Initialise
      *================================================================
      * USER: Initialize program
     C                   Z-ADD     *ZERO         YL0008                         Count USR
      *================================================================
     CSR   ZDEXIT        ENDSR
      /EJECT
     CSR   ZEINIT        BEGSR
      *================================================================
      * PRT Hdr Comment 3/Lne PO: Initialise
      *================================================================
      * USER: Initialize program
     C                   Z-ADD     *ZERO         YL0008                         Count USR
      *================================================================
     CSR   ZEEXIT        ENDSR
      /EJECT
     CSR   ZFINIT        BEGSR
      *================================================================
      * PRT Ship Inst 3/Line  PO: Initialise
      *================================================================
      * USER: Initialize program
     C                   Z-ADD     *ZERO         YL0010                         Count USR
      *================================================================
     CSR   ZFEXIT        ENDSR
      /EJECT
     CSR   ZGINIT        BEGSR
      *================================================================
      * Prt Cust Comment PL   PO: Initialise
      *================================================================
      * USER: Initialize program
      * Rtv Record count      RT - Customer Comment  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     BEBKC7        WL0032                         Ship To Custome
     C                   MOVEL(P)  'PI'          WL0033                         Comment Type
     C                   Z-ADD     YL0013        WL0034                         USR Count
     C                   EXSR      SQRVGN
      * Move subroutine local variables to output parameters.
     C                   Z-ADD     WL0034        YL0013                         USR Count
     C                   MOVEL     'Y'           YL0014                         First time flag
     C                   Z-ADD     69            YL0015                         Page Length
     C                   MOVEL     'Y'           WUTMST                         USR First Time
      *================================================================
     CSR   ZGEXIT        ENDSR
      /EJECT
     CSR   ZHINIT        BEGSR
      *================================================================
      * Prt Country Comment   PO: Initialise
      *================================================================
      * USER: Initialize program
     C                   MOVEL     'Y'           YL0017                         First time flag
     C                   Z-ADD     69            YL0018                         Page Length
     C                   MOVEL     'Y'           WUTMST                         USR First Time
      *================================================================
     CSR   ZHEXIT        ENDSR
      /EJECT
     CSR   ZJINIT        BEGSR
      *================================================================
      * PRT Detail-Acknowledge PO: Initialise
      *================================================================
      * USER: Initialize program
      * Rtv Plant Co/Org      XF - Company Defaults Internal  * 
     C                   CALL      'PMOVXFR'                            90      Rtv Plant Co/Or
     C                   PARM      *BLANK        W0RTN
     C                   PARM      $DAIC3        WQ0001                         Company Number
     C                   PARM      *BLANK        WQ0002                         Plant Company S
     C     WUYJSX        PARM      *BLANK        WQ0003                         Company Organiz
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PMOVXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   Z-ADD     *ZERO         WUJVVA                         USR Extended Am
      * Rtv Field Security    XF - User Profile Control  * 
     C                   CALL      'PDL1XFR'                            90      Rtv Field Secur
     C                   PARM      *BLANK        W0RTN
     C     WN0001        PARM      *BLANK        WQ0004                         Display Flag
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDL1XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * WI464 DN 03/23/22-Added Country Codes ISO 3 Standard.
      * Asian Export
      * CASE:
      *  - c1 OR c2 OR c3 OR c4 OR c5 OR c6 OR c7 OR c8 OR c9
      *   |- c1    : PAR.Country Code is China
      *   |- c2    : PAR.Country Code is Hong Kong
      *   |- c3    : PAR.Country Code is Japan
      *   |- c4    : PAR.Country Code is Korea
      *   |- c5    : PAR.Country Code is Taiwan
      *   |- c6    : PAR.Country Code is Philippines
      *   |- c7    : PAR.Country Code is Vietnam
      *   |- c8    : PAR.Country Code is Taiwan - ISO 3
      *   |- c9    : PAR.Country Code is Vietnam - ISO 3
      *   '-
     C                   IF        YL0002 = 'CHN' OR
     C                             YL0002 = 'HKG' OR
     C                             YL0002 = 'JPN' OR
     C                             YL0002 = 'KOR' OR
     C                             YL0002 = 'TAI' OR
     C                             YL0002 = 'PHL' OR
     C                             YL0002 = 'VIE' OR
     C                             YL0002 = 'TWN' OR
     C                             YL0002 = 'VNM'
     C                   MOVEL     'A'           YL0021                         Export Country
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      YL0021 = ' '                                 Export Country
     C                   END                                                    *FI
      * Override Display flag if Air Frt Order or Asian Export
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Air Freight Order is yes
      *   |- c2    : LCL.Export Country Type USR is Asian
      *   '-
     C                   IF        $DFTSX = 'Y' OR
     C                             YL0021 = 'A'
     C                   MOVEL     'Y'           WN0001                         Display Flag
     C                   END                                                    *FI
      *================================================================
     CSR   ZJEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Reclaim resources of called programs
     C                   CALL      'Y2RCRSC'
      *
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      *
      * Clear all neither parameters
     C                   Z-ADD     *ZERO         P1C4NB                         Order Number
     C                   EVAL      P1JNCD = ' '                                 Order Type_Sale
     C                   EVAL      P1GTST = ' '                                 Comment Print A
     C                   EVAL      P1GVST = ' '                                 Comment Print I
     C                   EVAL      P1GUST = ' '                                 Comment Print P
     C                   EVAL      P1GWST = ' '                                 Header Status
     C                   Z-ADD     *ZERO         P1RMNB                         Load ID
     C                   EVAL      P1Q2CD = ' '                                 Shipping Method
     C                   EVAL      P1RPCD = ' '                                 Age Code
     C                   EVAL      P1VDST = ' '                                 Load Type
     C                   EVAL      P1BCST = ' '                                 Block Order Fla
     C                   EVAL      P1BDST = ' '                                 Order Certifica
     C                   EVAL      P1FQSX = ' '                                 Export Docs Go
      * Clear all neither parameters
     C                   EVAL      P2AJCD = ' '                                 Warehouse Code
     C                   EVAL      P2DNCD = ' '                                 Application Cod
     C                   EVAL      P2BCCD = ' '                                 Salesperson Cod
     C                   EVAL      P2B8NA = ' '                                 System Date For
     C                   EVAL      P2AJVN = ' '                                 User Profile Na
     C                   EVAL      P2I6ST = ' '                                 Allow Multi_Com
     C                   EVAL      P2MPNA = ' '                                 Default Printer
     C                   EVAL      P2ADTX = ' '                                 Name
      * Clear all neither parameters
     C                   EVAL      P3C2ST = ' '                                 Print Co Addr o
      * Clear all neither parameters
     C                   EVAL      P4ACNA = ' '                                 Address Line 1
     C                   EVAL      P4ADNA = ' '                                 Address Line 2
     C                   EVAL      P4AENA = ' '                                 Address Line 3
     C                   EVAL      P4AJNA = ' '                                 City
     C                   EVAL      P4BTTX = ' '                                 Zip Postal Code
     C                   EVAL      P4BGCD = ' '                                 State Code
      * Clear all neither parameters
     C                   EVAL      P5G3TX = ' '                                 PRT Description
     C                   EVAL      P5WRST = ' '                                 PRT Printer Dev
     C                   EVAL      P5WSST = ' '                                 PRT Hold Output
     C                   EVAL      P5WTST = ' '                                 PRT Save Output
     C                   Z-ADD     *ZERO         P5DYNB                         PRT Number of C
     C                   EVAL      P5WUST = ' '                                 PRT Night Queue
     C                   EVAL      P5BVVN = ' '                                 PRT Night Queue
     C                   Z-ADD     *ZERO         P5AJAA                         Company Number
     C                   Z-ADD     *ZERO         P5AJNC                         Customer Number
     C                   Z-ADD     *ZERO         P5AJAB                         Date 1
     C                   Z-ADD     *ZERO         P5AJAC                         Date 2
     C                   Z-ADD     *ZERO         P5AJAD                         From Date Pass
     C                   Z-ADD     *ZERO         P5AJAG                         Thru Date Pass
     C                   Z-ADD     *ZERO         P5AJAE                         Order Number 1
     C                   Z-ADD     *ZERO         P5AJAF                         Order Number 2
     C                   Z-ADD     *ZERO         P5M8NB                         System Value Nu
      * Clear all neither parameters
     C                   Z-ADD     *ZERO         P6FKNB                         USR Company Num
     C                   Z-ADD     *ZERO         P6MSNB                         USR Page number
     C                   Z-ADD     *ZERO         P6Q7NB                         Invoice_Memo Nu
     C                   EVAL      P6OMST = ' '                                 Invoice_Memo Su
      * Clear all neither parameters
     C                   EVAL      P8KXCD = ' '                                 Country Code
     C                   EVAL      P8DATX = ' '                                 Country Descrip
      *
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Define work field Printer Device Str
     C                   EVAL      WUAHVN = ' '
      * Define work field Application WHS Restrict
     C                   EVAL      WUI7ST = ' '
      * Define work field Company Number
     C                   Z-ADD     *ZERO         WUAIC3
      * Define work field Enterprise Code 1
     C                   EVAL      WUDQCD = ' '
      * Define work field Enterprise Code 2
     C                   EVAL      WUDRCD = ' '
      * Initialize KEY fields.
     C                   MOVEL     *LOVAL        BEAIC3                         Company Number
     C                   MOVEL     *LOVAL        BEC4NB                         Order Number
     C                   MOVEL     *LOVAL        BEBKC7                         Ship To Custome
      * Define work field Order Type Description
     C                   EVAL      WUJVNA = ' '
      * Define work field Processing Cycle Type
     C                   EVAL      WUOAST = ' '
      * Define work field Billing Activity Type
     C                   EVAL      WUOBST = ' '
      * Define work field Affect Inventory Default
     C                   EVAL      WUOEST = ' '
      * Define work field Affect Sales Doll Default
     C                   EVAL      WUOFST = ' '
      * Define work field Affect Sales Pnds Default
     C                   EVAL      WUVBST = ' '
      * Define work field Company Number Alpha
     C                   EVAL      WUE6TX = ' '
      * Define work field Order Number Alpha
     C                   EVAL      WUE7TX = ' '
      * Define work field Alpha Search
     C                   EVAL      WUABTX = ' '
      * Define work field Name
     C                   EVAL      WUADTX = ' '
      * Define work field Address Line 1
     C                   EVAL      WUACNA = ' '
      * Define work field Address Line 2
     C                   EVAL      WUADNA = ' '
      * Define work field Address Line 3
     C                   EVAL      WUAENA = ' '
      * Define work field City
     C                   EVAL      WUAJNA = ' '
      * Define work field Zip Postal Code
     C                   EVAL      WUBTTX = ' '
      * Define work field Telephone Number FF
     C                   EVAL      WUBVTX = ' '
      * Define work field State Code
     C                   EVAL      WUBGCD = ' '
      * Define work field Country Description
     C                   EVAL      WUDATX = ' '
      * Define work field USR Country Description
     C                   EVAL      WUKSTX = ' '
      * Define work field USR Comment 1
     C                   EVAL      WUD4NA = ' '
      * Define work field USR Comment 2
     C                   EVAL      WUD5NA = ' '
      * Define work field USR Comment 3
     C                   EVAL      WUD6NA = ' '
      * Define work field USR Comment 4
     C                   EVAL      WUHHNA = ' '
      * Define work field Export Status
     C                   EVAL      WUU2ST = ' '
      * Define work field USR Flag 1
     C                   EVAL      WUD4ST = ' '
      * Define work field Record Status
     C                   EVAL      WUVSST = ' '
      * Define work field State
     C                   EVAL      WUEINA = ' '
      * Define work field USR Flag 2
     C                   EVAL      WUUFL2 = ' '
      * Define work field Blank for 30          USR
     C                   EVAL      WUW4TX = ' '
      * Define work field CD7 Ext Numeric Key
     C                   EVAL      WUEOCD = ' '
      * Initialize KEY fields.
     C                   MOVEL     *LOVAL        COAIC3                         Company Number
     C                   MOVEL     *LOVAL        COC4NB                         Order Number
     C                   MOVEL     *LOVAL        COI1SX                         Comment Type
     C                   MOVEL     *LOVAL        CODXNB                         Sequence Number
      * Initialize KEY fields.
     C                   MOVEL     *LOVAL        COAIC3                         Company Number
     C                   MOVEL     *LOVAL        COC4NB                         Order Number
     C                   MOVEL     *LOVAL        COI1SX                         Comment Type
     C                   MOVEL     *LOVAL        CODXNB                         Sequence Number
      * Initialize KEY fields.
     C                   MOVEL     *LOVAL        COAIC3                         Company Number
     C                   MOVEL     *LOVAL        COC4NB                         Order Number
     C                   MOVEL     *LOVAL        COI1SX                         Comment Type
     C                   MOVEL     *LOVAL        CODXNB                         Sequence Number
      * Initialize KEY fields.
     C                   MOVEL     *LOVAL        COAIC3                         Company Number
     C                   MOVEL     *LOVAL        COC4NB                         Order Number
     C                   MOVEL     *LOVAL        COI1SX                         Comment Type
     C                   MOVEL     *LOVAL        CODXNB                         Sequence Number
      * Initialize KEY fields.
     C                   MOVEL     *LOVAL        IEAIC3                         Company Number
     C                   MOVEL     *LOVAL        IEC4NB                         Order Number
     C                   MOVEL     *LOVAL        IEDXNB                         Sequence Number
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WABKC7                         Ship To Custome
     C                   Z-ADD     *ZERO         WAM5NX                         Comment Sequenc
     C                   Z-ADD     *ZERO         WAAATM                         Job Time
     C                   Z-ADD     *ZERO         WAAXDT                         Job Date
      * Define work field USR First Time
     C                   EVAL      WUTMST = ' '
      * Initialize KEY fields.
     C                   MOVEL     *LOVAL        WABKC7                         Ship To Custome
     C                   MOVEL     *LOVAL        WAI1SX                         Comment Type
     C                   MOVEL     *LOVAL        WAM5NX                         Comment Sequenc
      * Define work field USR Overflow
     C                   EVAL      WUDLST = ' '
      * Define work field USR Display field
     C                   EVAL      WUGGST = ' '
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WBM5NX                         Comment Sequenc
     C                   Z-ADD     *ZERO         WBAATM                         Job Time
     C                   Z-ADD     *ZERO         WBAXDT                         Job Date
      * Initialize KEY fields.
     C                   MOVEL     *LOVAL        WBKXCD                         Country Code
     C                   MOVEL     *LOVAL        WBI1SX                         Comment Type
     C                   MOVEL     *LOVAL        WBM5NX                         Comment Sequenc
      * Initialize KEY fields.
     C                   MOVEL     *LOVAL        FLRMNB                         Load ID
     C                   MOVEL     *LOVAL        FLRUNB                         Stop_Drop Seque
      * Define work field USR Freight Amount 1
     C                   Z-ADD     *ZERO         WUDLVA
      * Define work field USR Spec. Charge Amount 1
     C                   Z-ADD     *ZERO         WUDQVA
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WCAIC3                         Company Number
     C                   Z-ADD     *ZERO         WCC4NB                         Order Number
     C                   Z-ADD     *ZERO         WCDPNB                         Order Sequence
     C                   Z-ADD     *ZERO         WCUENB                         Order Secondary
     C                   Z-ADD     *ZERO         WCHGCD                         Item Code
     C                   Z-ADD     *ZERO         WCBKC7                         Ship To Custome
     C                   Z-ADD     *ZERO         WCCFC7                         Order Group Cod
     C                   Z-ADD     *ZERO         WCMAVA                         Billing Detail
     C                   Z-ADD     *ZERO         WCKDVA                         Billing Detail
     C                   Z-ADD     *ZERO         WCL8VA                         Billing Detail
     C                   Z-ADD     *ZERO         WCL9VA                         Quantity to Sub
     C                   Z-ADD     *ZERO         WCAYVA                         Extended Amount
     C                   Z-ADD     *ZERO         WCEXDT                         Market Pricing
     C                   Z-ADD     *ZERO         WCBZPR                         Price Overage O
     C                   Z-ADD     *ZERO         WCL6NB                         Contract Number
     C                   Z-ADD     *ZERO         WCGIDT                         Pricing Date Us
     C                   Z-ADD     *ZERO         WCR1NB                         Rated Freight
     C                   Z-ADD     *ZERO         WCAVQT                         Quantity Ordere
     C                   Z-ADD     *ZERO         WCD0WG                         Weight Ordered
     C                   Z-ADD     *ZERO         WCCCQT                         Quantity Schedu
     C                   Z-ADD     *ZERO         WCAUWG                         Weight Schedule
     C                   Z-ADD     *ZERO         WCCBQT                         Quantity Shippe
     C                   Z-ADD     *ZERO         WCATWG                         Weight Shipped
     C                   Z-ADD     *ZERO         WCAQCS                         Unit Cost Prici
     C                   Z-ADD     *ZERO         WCAGCS                         Unit Cost Per P
     C                   Z-ADD     *ZERO         WCAKPR                         Unit Price
     C                   Z-ADD     *ZERO         WCALPR                         Unit Price_Cred
     C                   Z-ADD     *ZERO         WCAUPR                         Unit Price Orde
     C                   Z-ADD     *ZERO         WCAVWG                         Unit Weight Ord
     C                   Z-ADD     *ZERO         WCA4WG                         Tare Weight Tot
     C                   Z-ADD     *ZERO         WCA5DT                         Requested Ship
     C                   Z-ADD     *ZERO         WCAODT                         Scheduled Ship
     C                   Z-ADD     *ZERO         WCGNDT                         Actual Shipped
     C                   Z-ADD     *ZERO         WCRGNB                         Item Structure
     C                   Z-ADD     *ZERO         WCRHNB                         Item Structure
     C                   Z-ADD     *ZERO         WCRINB                         Item Structure
     C                   Z-ADD     *ZERO         WCCXDT                         Date of Origina
     C                   Z-ADD     *ZERO         WCDUPR                         Invoice Unit Pr
     C                   Z-ADD     *ZERO         WCB6VL                         Invoice Extende
     C                   Z-ADD     *ZERO         WCA1AA                         Ham Group Numbe
     C                   Z-ADD     *ZERO         WCNTDT                         Warehouse Palle
     C                   Z-ADD     *ZERO         WCNUDT                         Consumed Item C
     C                   Z-ADD     *ZERO         WCNVDT                         Deadline Depart
     C                   Z-ADD     *ZERO         WCNWDT                         OD Price Type R
     C                   Z-ADD     *ZERO         WCNXDT                         OD Firm Date
     C                   Z-ADD     *ZERO         WCBUTM                         Deadline Depart
     C                   Z-ADD     *ZERO         WCBVTM                         Price Code
     C                   Z-ADD     *ZERO         WCBWTM                         Maximum Net Wei
     C                   Z-ADD     *ZERO         WCBXTM                         Substitution Li
     C                   Z-ADD     *ZERO         WCBYTM                         Max Qty to sche
     C                   Z-ADD     *ZERO         WCH5NX                         Warehouse Palle
     C                   Z-ADD     *ZERO         WCH6NX                         Warehouse Avg P
     C                   Z-ADD     *ZERO         WCH7NX                         OD Item Target
     C                   Z-ADD     *ZERO         WCH8NX                         OD Estimated Gr
     C                   Z-ADD     *ZERO         WCH9NX                         OD Maximum Unit
     C                   Z-ADD     *ZERO         WCDVPR                         Order Gate_Fina
     C                   Z-ADD     *ZERO         WCDWPR                         OD Ceiling Pric
     C                   Z-ADD     *ZERO         WCDXPR                         OD Gate_Final P
     C                   Z-ADD     *ZERO         WCDYPR                         OD Weighted Avg
     C                   Z-ADD     *ZERO         WCDZPR                         OD Original Ord
     C                   Z-ADD     *ZERO         WCGSPR                         OD Cancel Date
     C                   Z-ADD     *ZERO         WCGTPR                         OD Unused Prc 7
     C                   Z-ADD     *ZERO         WCGUPR                         OD Unused Prc 8
     C                   Z-ADD     *ZERO         WCPEWG                         Weight Amount E
     C                   Z-ADD     *ZERO         WCRINY                         Item Age Days
     C                   Z-ADD     *ZERO         WCTIDT                         Production Ovr
     C                   Z-ADD     *ZERO         WCTJDT                         Production Ovr
     C                   Z-ADD     *ZERO         WCTKDT                         OD Market Begin
     C                   Z-ADD     *ZERO         WCTLDT                         OD Market Endin
     C                   Z-ADD     *ZERO         WCTMDT                         OD Atch to Ord
     C                   Z-ADD     *ZERO         WCAATM                         Job Time
     C                   Z-ADD     *ZERO         WCAXDT                         Job Date
      * Define work field Company Organization
     C                   EVAL      WUYJSX = ' '
      * Define work field USR Extended Amount S
     C                   Z-ADD     *ZERO         WUJVVA
      * Initialize KEY fields.
     C                   MOVEL     *LOVAL        WCAIC3                         Company Number
     C                   MOVEL     *LOVAL        WCC4NB                         Order Number
     C                   MOVEL     *LOVAL        WCDPNB                         Order Sequence
     C                   MOVEL     *LOVAL        WCUENB                         Order Secondary
      * Define work field USR Weight   9.1  2
     C                   Z-ADD     *ZERO         WUCPWG
      * Define work field USR Quantity
     C                   Z-ADD     *ZERO         WUBAQT
      * Define work field Maximum Net Weight
     C                   Z-ADD     *ZERO         WUBWTM
      * Define work field OD Maximum Unit Weight
     C                   Z-ADD     *ZERO         WUH9NX
      * Define work field OD Estimated Gross Weight
     C                   Z-ADD     *ZERO         WUH8NX
      * Initialize KEY fields.
     C                   MOVEL     *LOVAL        HQAIC3                         Company Number
     C                   MOVEL     *LOVAL        HQC4NB                         Order Number
     C                   MOVEL     *LOVAL        HQDPNB                         Order Sequence
     C                   MOVEL     *LOVAL        HQUENB                         Order Secondary
     C                   MOVEL     *LOVAL        HQDXNB                         Sequence Number
      * Initialize KEY fields.
     C                   MOVEL     *LOVAL        HOBKC7                         Ship To Custome
     C                   MOVEL     *LOVAL        HOOJCD                         Accrual Code
     C                   MOVEL     *LOVAL        HOGUNY                         CAH Sequence No
      * Define work field Status - Y or N
     C                   EVAL      WUB8ST = ' '
      * Define work field Accrual Rate
     C                   Z-ADD     *ZERO         WUBKPR
      * Define work field Accrual Rate Type
     C                   EVAL      WUSHSX = ' '
      * Initialize KEY fields.
     C                   MOVEL     *LOVAL        CPAIC3                         Company Number
     C                   MOVEL     *LOVAL        CPC4NB                         Order Number
     C                   MOVEL     *LOVAL        CPDPNB                         Order Sequence
     C                   MOVEL     *LOVAL        CPUENB                         Order Secondary
     C                   MOVEL     *LOVAL        CPDXNB                         Sequence Number
      * Initialize KEY fields.
     C                   MOVEL     *LOVAL        N1AIC3                         Company Number
     C                   MOVEL     *LOVAL        N1C4NB                         Order Number
     C                   MOVEL     *LOVAL        N1DPNB                         Order Sequence
     C                   MOVEL     *LOVAL        N1UENB                         Order Secondary
     C                   MOVEL     *LOVAL        N1DXNB                         Sequence Number
      * Initialize KEY fields.
     C                   MOVEL     *LOVAL        GKAIC3                         Company Number
     C                   MOVEL     *LOVAL        GKHGCD                         Item Code
     C                   MOVEL     *LOVAL        GKR4CD                         Sales Route Cod
      * Initialize KEY fields.
     C                   MOVEL     *LOVAL        GLAIC3                         Company Number
     C                   MOVEL     *LOVAL        GLHGCD                         Item Code
     C                   MOVEL     *LOVAL        GLBKC7                         Ship To Custome
     C                   MOVEL     *LOVAL        GLR4CD                         Sales Route Cod
      * Define work field USR Quantity Ordered
     C                   Z-ADD     *ZERO         WUQTOR
      * Define work field USR Transaction Qty 9.2
     C                   Z-ADD     *ZERO         WUTRAQ
      * Define work field Extended Amount
     C                   Z-ADD     *ZERO         WUAYVA
      * Define work field Select Status
     C                   EVAL      WUDJST = ' '
      * Define work field Warehouse Code
     C                   EVAL      WUAJCD = ' '
      * Define work field BLANK
     C                   EVAL      WUGSTX = ' '
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WDAATM                         Job Time
     C                   Z-ADD     *ZERO         WDAXDT                         Job Date
      * Define work field Palletize
     C                   EVAL      WUVEST = ' '
      * Define work field U_M_Ordered
     C                   EVAL      WUAGCD = ' '
      * Define work field Palletize             USR
     C                   EVAL      WUIHSX = ' '
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WEAIC3                         Company Number
     C                   Z-ADD     *ZERO         WEC4NB                         Order Number
     C                   Z-ADD     *ZERO         WEANC7                         AR Customer Num
     C                   Z-ADD     *ZERO         WEBKC7                         Ship To Custome
     C                   Z-ADD     *ZERO         WEB0C7                         Bill to Custome
     C                   Z-ADD     *ZERO         WEA0DT                         Order Date
     C                   Z-ADD     *ZERO         WEA5DT                         Requested Ship
     C                   Z-ADD     *ZERO         WEGNDT                         Actual Shipped
     C                   Z-ADD     *ZERO         WEACDT                         Cancel Date
     C                   Z-ADD     *ZERO         WEAODT                         Scheduled Ship
     C                   Z-ADD     *ZERO         WECXDT                         Date of Origina
     C                   Z-ADD     *ZERO         WEJZVA                         Order Value Tot
     C                   Z-ADD     *ZERO         WEA1WG                         Order Weight To
     C                   Z-ADD     *ZERO         WEEIDT                         Requested Deliv
     C                   Z-ADD     *ZERO         WEAFTM                         Requested Deliv
     C                   Z-ADD     *ZERO         WERMNB                         Load ID
     C                   Z-ADD     *ZERO         WETBNB                         Absorbed Freigh
     C                   Z-ADD     *ZERO         WER1NB                         Rated Freight
     C                   Z-ADD     *ZERO         WERNNB                         Reefer Temperat
     C                   Z-ADD     *ZERO         WEATIN                         Attach to Invoi
     C                   Z-ADD     *ZERO         WERSRN                         Resell Referenc
     C                   Z-ADD     *ZERO         WET3NB                         Attach to Order
     C                   Z-ADD     *ZERO         WECONB                         Invoice Number
     C                   Z-ADD     *ZERO         WEAWDT                         Invoice Date
     C                   Z-ADD     *ZERO         WEVRVA                         A_R order Value
     C                   Z-ADD     *ZERO         WEB7VL                         Invoice Order V
     C                   Z-ADD     *ZERO         WENODT                         OH Appt Confirm
     C                   Z-ADD     *ZERO         WENPDT                         JPN Invoice Iss
     C                   Z-ADD     *ZERO         WENQDT                         Load Actual Shi
     C                   Z-ADD     *ZERO         WENRDT                         Load BOL Comple
     C                   Z-ADD     *ZERO         WENSDT                         Load Truck Depa
     C                   Z-ADD     *ZERO         WEBPTM                         Maximum Gross W
     C                   Z-ADD     *ZERO         WEBQTM                         Time of Origina
     C                   Z-ADD     *ZERO         WEBRTM                         OH Appt Confirm
     C                   Z-ADD     *ZERO         WEBSTM                         Load BOL Comple
     C                   Z-ADD     *ZERO         WEBTTM                         Load Truck Depa
     C                   Z-ADD     *ZERO         WEH0NX                         Act Frt Referen
     C                   Z-ADD     *ZERO         WEH1NX                         Act Non_Ref Frt
     C                   Z-ADD     *ZERO         WEH2NX                         OH Fuel Surchar
     C                   Z-ADD     *ZERO         WEH3NX                         OH Total Non_Re
     C                   Z-ADD     *ZERO         WEH4NX                         OH Total Ref Fr
     C                   Z-ADD     *ZERO         WEC0C7                         Claim Number
     C                   Z-ADD     *ZERO         WEAATM                         Job Time
     C                   Z-ADD     *ZERO         WEAXDT                         Job Date
      * Define work field First Time Flag
     C                   EVAL      WUTAST = ' '
      * Move main file information to JOB context
     C                   MOVE      @1FFL         ZZFFL                          Main file name
     C                   MOVE      @1FLB         ZZFLB                          Main file lib
     C                   MOVE      @1FMB         ZZFMB                          Main file mbr
     C                   MOVE      ZZFFL         @1FFL
     C                   MOVE      ZZFLB         @1FLB
     C                   MOVE      ZZFMB         @1FMB
     C                   CALL      'Y2QLVNR'
     C                   PARM                    ZZFFL
     C                   PARM                    ZZFLB
     C                   PARM                    ZZFQL                          LIBRARY/FILE
      * Dummy move for compiler
     C                   MOVE      '0'           @CN#(1)
     C                   MOVEL     @CN(1)        @CN(1)
     C                   MOVEL     'N'           W0PMT
      * Define local variables for subroutine SIRVGN.
     C                   Z-ADD     *ZERO         WL0001
     C                   EVAL      WL0002 = ' '
      * Define local variables for subroutine SJRVGN.
     C                   EVAL      WL0003 = ' '
     C                   EVAL      WL0004 = ' '
     C                   EVAL      WL0005 = ' '
      * Define local variables for subroutine SLRVGN.
     C                   Z-ADD     *ZERO         WL0006
     C                   Z-ADD     *ZERO         WL0007
     C                   EVAL      WL0008 = ' '
      * Define local variables for subroutine SMRVGN.
     C                   Z-ADD     *ZERO         WL0009
     C                   Z-ADD     *ZERO         WL0010
     C                   EVAL      WL0011 = ' '
     C                   EVAL      WL0012 = ' '
     C                   EVAL      WL0013 = ' '
     C                   EVAL      WL0014 = ' '
     C                   EVAL      WL0015 = ' '
     C                   EVAL      WL0016 = ' '
     C                   EVAL      WL0017 = ' '
     C                   EVAL      WL0018 = ' '
     C                   EVAL      WL0019 = ' '
     C                   EVAL      WL0020 = ' '
     C                   EVAL      WL0021 = ' '
     C                   EVAL      WL0022 = ' '
     C                   EVAL      WL0023 = ' '
     C                   EVAL      WL0024 = ' '
     C                   EVAL      WL0025 = ' '
     C                   EVAL      WL0026 = ' '
     C                   EVAL      WL0027 = ' '
     C                   EVAL      WL0028 = ' '
     C                   EVAL      WL0029 = ' '
      * Define local variables for subroutine SORVGN.
     C                   EVAL      WL0030 = ' '
     C                   EVAL      WL0031 = ' '
      * Define local variables for subroutine SQRVGN.
     C                   Z-ADD     *ZERO         WL0032
     C                   EVAL      WL0033 = ' '
     C                   Z-ADD     *ZERO         WL0034
      * Define local variables for subroutine SURVGN.
     C                   Z-ADD     *ZERO         WL0035
     C                   EVAL      WL0036 = ' '
     C                   Z-ADD     *ZERO         WL0037
     C                   Z-ADD     *ZERO         WL0038
     C                   Z-ADD     *ZERO         WL0039
     C                   EVAL      WL0040 = ' '
      * Define local variables for subroutine SVRVGN.
     C                   Z-ADD     *ZERO         WL0041
     C                   EVAL      WL0042 = ' '
     C                   Z-ADD     *ZERO         WL0043
     C                   Z-ADD     *ZERO         WL0044
     C                   Z-ADD     *ZERO         WL0045
     C                   Z-ADD     *ZERO         WL0046
     C                   Z-ADD     *ZERO         WL0047
     C                   EVAL      WL0048 = ' '
      * Define local variables for subroutine SYRVGN.
     C                   EVAL      WL0049 = ' '
     C                   EVAL      WL0050 = ' '
      * Define local variables for subroutine SZRVGN.
     C                   Z-ADD     *ZERO         WL0051
     C                   Z-ADD     *ZERO         WL0052
     C                   EVAL      WL0053 = ' '
     C                   EVAL      WL0054 = ' '
      * Define local variables for subroutine TBRVGN.
     C                   EVAL      WL0055 = ' '
     C                   EVAL      WL0056 = ' '
      * Define local variables for subroutine TCRVGN.
     C                   EVAL      WL0057 = ' '
     C                   EVAL      WL0058 = ' '
     C                   EVAL      WL0059 = ' '
      * Define local variables for subroutine TFRVGN.
     C                   Z-ADD     *ZERO         WL0060
     C                   Z-ADD     *ZERO         WL0061
     C                   Z-ADD     *ZERO         WL0062
     C                   Z-ADD     *ZERO         WL0063
     C                   EVAL      WL0064 = ' '
      * Define null work field Plant Company Sts
     C                   EVAL      YN0001 = ' '
      * Define local work field Company Organization
     C                   EVAL      YL0001 = ' '
      * Define null work field Customer Name
     C                   EVAL      YN0002 = ' '
      * Define null work field U_M_Ordered
     C                   EVAL      YN0003 = ' '
      * Define local work field Country Code
     C                   EVAL      YL0002 = ' '
      * Define local work field Country Code          USR
     C                   EVAL      YL0003 = ' '
      * Define local work field ED Live with PHIS
     C                   EVAL      YL0004 = ' '
      * Define local work field ED Consignee Addr 3
     C                   EVAL      YL0005 = ' '
      * Define local work field USR Blank Field
     C                   EVAL      YL0006 = ' '
      * Define local work field ED Consignee Addr 4
     C                   EVAL      YL0007 = ' '
      * Define local work field Count USR
     C                   Z-ADD     *ZERO         YL0008
      * Define local work field Text 93 USR
     C                   EVAL      YL0009 = ' '
      * Define local work field Count USR
     C                   Z-ADD     *ZERO         YL0010
      * Define local work field Text 93 USR
     C                   EVAL      YL0011 = ' '
      * Define local work field USR Count
     C                   Z-ADD     *ZERO         YL0012
      * Define local work field USR Count
     C                   Z-ADD     *ZERO         YL0013
      * Define local work field First time flag 2     USR
     C                   EVAL      YL0014 = ' '
      * Define local work field Page Length
     C                   Z-ADD     *ZERO         YL0015
      * Define local work field USR Counter
     C                   Z-ADD     *ZERO         YL0016
      * Define local work field First time flag 2     USR
     C                   EVAL      YL0017 = ' '
      * Define local work field Page Length
     C                   Z-ADD     *ZERO         YL0018
      * Define local work field USR Counter
     C                   Z-ADD     *ZERO         YL0019
      * Define local work field USR Count
     C                   Z-ADD     *ZERO         YL0020
      * Define null work field Plant Company Sts
     C                   EVAL      YN0004 = ' '
      * Define local work field Export Country Type USR
     C                   EVAL      YL0021 = ' '
      * Define local work field Warehouse Location
     C                   EVAL      YL0022 = ' '
      * Define local work field Display Flag 1 USR
     C                   EVAL      YL0023 = ' '
      * Define local work field CIR Resource No
     C                   EVAL      YL0024 = ' '
      * Define null work field CIR Item No
     C                   EVAL      YN0005 = ' '
      * Define null work field CIR Description Line 1
     C                   EVAL      YN0006 = ' '
      * Define null work field CIR Description Line 2
     C                   EVAL      YN0007 = ' '
      * Define null work field CIR Description Line 3
     C                   EVAL      YN0008 = ' '
      * Define null work field Accrual Description
     C                   EVAL      YN0009 = ' '
      * Define null work field Automatic Accrual_Y_N
     C                   EVAL      YN0010 = ' '
      * Define null work field Print On Invoice_Y_N
     C                   EVAL      YN0011 = ' '
      * Define null work field Rate Usage
     C                   EVAL      YN0012 = ' '
      * Define null work field Add-on_Allowance
     C                   EVAL      YN0013 = ' '
      * Define local work field Accrual Type
     C                   EVAL      YL0025 = ' '
      * Define null work field Sub Ledger Code
     C                   EVAL      YN0014 = ' '
      * Define null work field Reverse Accrual Code
     C                   EVAL      YN0015 = ' '
      * Define null work field UOM Primary Dft
     C                   EVAL      YN0016 = ' '
      * Define null work field Affect Invoice Price
     C                   EVAL      YN0017 = ' '
      * Define local work field Ship Date USR
     C                   Z-ADD     *ZERO         YL0026
      * Define local work field Salesperson Code
     C                   EVAL      YL0027 = ' '
      * Define null work field EDI Status 3
     C                   EVAL      YN0018 = ' '
      * Define local work field Shipping Line
     C                   EVAL      YL0028 = ' '
      * Define local work field Port Delv Terminal
     C                   EVAL      YL0029 = ' '
      * Define local work field OHE City
     C                   EVAL      YL0030 = ' '
      * Define local work field OHE Vessel_Airline
     C                   EVAL      YL0031 = ' '
      * Define local work field OHE Voyage_Flight
     C                   EVAL      YL0032 = ' '
      * Define local work field OHE Discharge Port_Airprt
     C                   EVAL      YL0033 = ' '
      * Define local work field OHE Sail_Flight Date
     C                   Z-ADD     *ZERO         YL0034
      * Define local work field OHE Port Cut Date
     C                   Z-ADD     *ZERO         YL0035
      * Define local work field OHE Arrival Date
     C                   Z-ADD     *ZERO         YL0036
      * Define local work field OHE Late Delivery Code
     C                   EVAL      YL0037 = ' '
      * Define local work field OHE Ship Status
     C                   EVAL      YL0038 = ' '
      * Define local work field OHE Container Number
     C                   EVAL      YL0039 = ' '
      * Define local work field OHE Comment 1
     C                   EVAL      YL0040 = ' '
      * Define local work field OHE Comment 2
     C                   EVAL      YL0041 = ' '
      * Define local work field Print Req Delv Tm on Docs
     C                   EVAL      YL0042 = ' '
     C                   EVAL      W0PFM = ' '
     C                   Z-ADD     *ZERO         @$WRK
     C                   Z-ADD     *ZERO         @$HDL
     C                   Z-ADD     *ZERO         @$CLN
     C                   Z-ADD     *ZERO         @$PGN
      * Adjust page length and overflow as necessary
     C     @$PGL         SUB       2             W0PGL
     C                   IF        @$OFL >= W0PGL
     C     W0PGL         SUB       2             W0OFL
     C                   ELSE
     C                   Z-ADD     @$OFL         W0OFL
     C                   END
      * Clear overflow indicator
     C                   SETOFF                                       97
      * Request new page
     C                   MOVEL     'Y'           W0NEWP
      * USER: Initialize program
     C                   MOVEL     ##USR         P2AJVN                         User Profile Na
      * RTV Model Profile      RT - User Profile Control  * 
     C                   EXSR      SARVGN
     C                   Z-ADD     *ZERO         P6MSNB                         USR Page number
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
     C                   EXSR      SBRVGN
      * Obtain system date format
     C     *DTAARA       DEFINE    Y2DTFMA       XDDTFM
     C                   IN        XDDTFM
      *================================================================
     CSR   ZZEXIT        ENDSR
** @CN
00001 C.M. #
00002 D.M. #
00003 Invoice
00004 Phone:
00005 Seaboard Foods
00006 9000 W. 67th Street
00007 Suite 200
00008 Shawnee Mission, KS
00009 66202-3677
00010 Phone: 913-261-2600
00011 **EXPORT**
00012 THE PEOPLE'S REPUBLIC OF
00013 Destination:
00014 Comments
00015 CERTIFY
