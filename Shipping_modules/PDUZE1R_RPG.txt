     H/TITLE EDT Locked Order       E1 Edit record(1 screen)
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Maintain DBF file records, one at a time
     H* - Existing records may be updated or deleted
     H* - Key changes are not allowed
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Edit record(1 screen)
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 06/14/21  Time  : 13:53:58
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPDUZE1R#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: EDT Locked Order       E1 Edit record(1 screen)
      *
     FOPBFCPL1IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FCAAPREL2IF  E           K        DISK
      * RTV : Salesperson               Retrieval index       V
      *
     FPMAMREL1IF  E           K        DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FOMFLCPL5IF  E           K        DISK
      * RSQ : Load Detail               Co/Load/Order
      *
     FCAABREL4IF  E           K        DISK
      * RTV : Company Name and Address  Active records
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FOPEXREL2IF  E           K        DISK
      * RTV : Order Types               Active order Types
      *
     FCABBRELAIF  E           K        DISK
      * RTV : Customer                  Active Only
      *
     FCAACREL2IF  E           K        DISK
      * RTV : State                     Active only
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FCAAOREL2IF  E           K        DISK
      * RTV : Terms                     Retrieve Active Records
      *
     FOMFFREL3IF  E           K        DISK
      * RTV : Carrier                   Active records
      *
     FOPCXREL2IF  E           K        DISK
      * RTV : OP Reason Codes           Active Records Only
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADSREL1IF  E           K        DISK
      * RTV : Enterprise Master         Retrieval index       NV
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FPDJEREL2IF  E           K        DISK
      * RTV : Sales Route               Active Records
      *
     FCAALREL3IF  E           K        DISK
      * RTV : Manager Level             Active Only
      *
     FPDIFREL2IF  E           K        DISK
      * RTV : VP Level                  Active Only
      *
     FPDJHREL1IF  E           K        DISK
      * RTV : Internal Reason           Retrieval index
      *
     FOPEZREL1IF  E           K        DISK
      * RTV : Event Types               Retrieval index       NV
      *
     FPDMKCPL1IF  E           K        DISK
      * RTV : A/R Claim                 Retrieval index
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FCAEOREL2IF  E           K        DISK
      * RTV : Company Customer          Active Records         N
      *
     FOPBFCPHFIF  E           K        DISK
      * RSQ : Order Header TRG          Ship To cust/PO,not cncl
      *
     FCAAJREL3IF  E           K        DISK
      * RTV : Type Codes                Active Only
      *
     FPDJYREL2IF  E           K        DISK
      * RTV : Company Defaults Internal Active Records
      *
     FPMDACPLIIF  E           K        DISK
      * RSQ : COA Batch Header RIN      Co/Order/Seq
      *
     FPMDACPL1IF  E           K        DISK
      * RTV : COA Batch Header RIN      Retrieval index
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FOMFLCPL8IF  E           K        DISK
      * RSQ : Load Detail               Co/Order
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FOMFJCPL1UF  E           K        DISK
      * UPD : Load Header               Update index
      *
     FPMDACPL0UF  E           K        DISK
      * UPD : COA Batch Header RIN      Update index
      *
     FPMAMREL0UF  E           K        DISK                      A
      * UPD : Order Header Extension    Update index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     FOMFLCPL0UF  E           K        DISK
      * UPD : Load Detail               Update index
      *
     E                    J3          3  1
     E                    K3          3  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    J7          7  1
     E                    K7          7  1
      * RIGHT JUSTIFY INPUT FIELD
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    #L3         3  1
     E                    #L7         7  1
     E                    UCT        40  1               CENTER TABLE
      * KEY Screen: Field position and name array
     E                    W0BEG   2 002  5 0A
     E                    W0END   2 002  5 0A
     E                    W0NAM   2 002 10
      * DETAIL Screen: Field position and name array
     E                    W1BEG   7 030  5 0A
     E                    W1END   7 030  5 0A
     E                    W1NAM   7 030 10
      * Long constants
     E                    @CN#    1  06  6   @CN    25
     I@ABREUA
      * Company Name and Address  Active records
      * Renamed input format fields
     I              ABAIC3                          WAAIC3
     I              ABADTX                          WAADTX
     I              ABACNA                          WAACNA
     I              ABADNA                          WAADNA
     I              ABAENA                          WAAENA
     I              ABAJNA                          WAAJNA
     I              ABBTTX                          WABTTX
     I              ABBVTX                          WABVTX
     I              ABBWTX                          WABWTX
     I              ABA2NA                          WAA2NA
     I              ABABTX                          WAABTX
     I              ABBGCD                          WABGCD
     I              ABKXCD                          WAKXCD
     I              ABUVST                          WAUVST
     I              ABUWST                          WAUWST
     I              ABUXST                          WAUXST
     I              ABVSST                          WAVSST
     I              ABAATM                          WAAATM
     I              ABAYNA                          WAAYNA
     I              ABA0NA                          WAA0NA
     I              ABAXDT                          WAAXDT
      *
     I@BFCPCQ
      * Order Header TRG          Ship To cust/PO,not cncl
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     I@FJCPBO
      * Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WCRMNB
     I              FJAIC3                          WCAIC3
     I              FJAODT                          WCAODT
     I              FJPJST                          WCPJST
     I              FJPKST                          WCPKST
     I              FJRNNB                          WCRNNB
     I              FJDMTX                          WCDMTX
     I              FJDNTX                          WCDNTX
     I              FJDOTX                          WCDOTX
     I              FJWTTX                          WCWTTX
     I              FJWUTX                          WCWUTX
     I              FJRPNB                          WCRPNB
     I              FJFLAM                          WCFLAM
     I              FJXQST                          WCXQST
     I              FJRRNB                          WCRRNB
     I              FJDXTX                          WCDXTX
     I              FJDYTX                          WCDYTX
     I              FJSBNB                          WCSBNB
     I              FJBZNA                          WCBZNA
     I              FJRONB                          WCRONB
     I              FJSQNB                          WCSQNB
     I              FJR1NB                          WCR1NB
     I              FJVCST                          WCVCST
     I              FJVDST                          WCVDST
     I              FJSDNB                          WCSDNB
     I              FJPAOU                          WCPAOU
     I              FJDGWG                          WCDGWG
     I              FJSXNB                          WCSXNB
     I              FJHADT                          WCHADT
     I              FJAART                          WCAART
     I              FJDHWG                          WCDHWG
     I              FJDIWG                          WCDIWG
     I              FJAQDT                          WCAQDT
     I              FJS6NB                          WCS6NB
     I              FJT4NB                          WCT4NB
     I              FJPRTM                          WCPRTM
     I              FJNPSV                          WCNPSV
     I              FJJ8TX                          WCJ8TX
     I              FJTLMI                          WCTLMI
     I              FJJ9TX                          WCJ9TX
     I              FJQ2CD                          WCQ2CD
     I              FJVPCD                          WCVPCD
     I              FJDBCD                          WCDBCD
     I              FJGRWE                          WCGRWE
     I              FJXCCD                          WCXCCD
     I              FJU2ST                          WCU2ST
     I              FJF9DT                          WCF9DT
     I              FJONTM                          WCONTM
     I              FJJ4DT                          WCJ4DT
     I              FJTRTM                          WCTRTM
     I              FJJ5DT                          WCJ5DT
     I              FJSPTM                          WCSPTM
     I              FJJ6DT                          WCJ6DT
     I              FJLFTM                          WCLFTM
     I              FJJ7DT                          WCJ7DT
     I              FJBOTM                          WCBOTM
     I              FJJ8DT                          WCJ8DT
     I              FJBLTM                          WCBLTM
     I              FJKIDT                          WCKIDT
     I              FJASTM                          WCASTM
     I              FJKADT                          WCKADT
     I              FJAJCM                          WCAJCM
     I              FJXACD                          WCXACD
     I              FJOANA                          WCOANA
     I              FJK4TX                          WCK4TX
     I              FJVOAG                          WCVOAG
     I              FJKBDT                          WCKBDT
     I              FJNBBO                          WCNBBO
     I              FJW4CD                          WCW4CD
     I              FJEFDT                          WCEFDT
     I              FJCNTN                          WCCNTN
     I              FJKCDT                          WCKCDT
     I              FJTMIN                          WCTMIN
     I              FJKDDT                          WCKDDT
     I              FJVMNB                          WCVMNB
     I              FJOCFR                          WCOCFR
     I              FJKJDT                          WCKJDT
     I              FJATTM                          WCATTM
     I              FJOTRS                          WCOTRS
     I              FJRNST                          WCRNST
     I              FJBRBK                          WCBRBK
     I              FJEIDT                          WCEIDT
     I              FJRMST                          WCRMST
     I              FJAJCD                          WCAJCD
     I              FJKKDT                          WCKKDT
     I              FJAVTM                          WCAVTM
     I              FJKZDT                          WCKZDT
     I              FJAXTM                          WCAXTM
     I              FJLHOS                          WCLHOS
     I              FJLHOR                          WCLHOR
     I              FJWNTX                          WCWNTX
     I              FJOITX                          WCOITX
     I              FJOJTX                          WCOJTX
     I              FJLLDT                          WCLLDT
     I              FJLSHG                          WCLSHG
     I              FJYPST                          WCYPST
     I              FJK0DT                          WCK0DT
     I              FJAYTM                          WCAYTM
     I              FJKNNX                          WCKNNX
     I              FJICWG                          WCICWG
     I              FJIDWG                          WCIDWG
     I              FJH9SX                          WCH9SX
     I              FJWOTX                          WCWOTX
     I              FJK1DT                          WCK1DT
     I              FJAZTM                          WCAZTM
     I              FJK2DT                          WCK2DT
     I              FJA0TM                          WCA0TM
     I              FJROST                          WCROST
     I              FJRPST                          WCRPST
     I              FJRQST                          WCRQST
     I              FJRRST                          WCRRST
     I              FJZBVA                          WCZBVA
     I              FJWPTX                          WCWPTX
     I              FJWQTX                          WCWQTX
     I              FJWRTX                          WCWRTX
     I              FJWSTX                          WCWSTX
     I              FJRVSX                          WCRVSX
     I              FJRUSX                          WCRUSX
     I              FJRWSX                          WCRWSX
     I              FJRXSX                          WCRXSX
     I              FJRYSX                          WCRYSX
     I              FJRZSX                          WCRZSX
     I              FJR0SX                          WCR0SX
     I              FJR1SX                          WCR1SX
     I              FJR2SX                          WCR2SX
     I              FJR3SX                          WCR3SX
     I              FJR4SX                          WCR4SX
     I              FJPYDT                          WCPYDT
     I              FJCKTM                          WCCKTM
     I              FJPZDT                          WCPZDT
     I              FJCLTM                          WCCLTM
     I              FJP0DT                          WCP0DT
     I              FJCMTM                          WCCMTM
     I              FJP1DT                          WCP1DT
     I              FJCNTM                          WCCNTM
     I              FJP2DT                          WCP2DT
     I              FJCOTM                          WCCOTM
     I              FJP3DT                          WCP3DT
     I              FJCQTM                          WCCQTM
     I              FJUVST                          WCUVST
     I              FJUWST                          WCUWST
     I              FJUXST                          WCUXST
     I              FJAATM                          WCAATM
     I              FJAYNA                          WCAYNA
     I              FJA0NA                          WCA0NA
     I              FJAXDT                          WCAXDT
      *
     I@DACPP5
      * COA Batch Header RIN      Update index
      * Renamed input format fields
     I              DAAIC3                          WDAIC3
     I              DAL6T1                          WDL6T1
     I              DAI3NY                          WDI3NY
     I              DAJYNY                          WDJYNY
     I              DAQ1NY                          WDQ1NY
     I              DAMUT1                          WDMUT1
     I              DAJZNY                          WDJZNY
     I              DAJ0NY                          WDJ0NY
     I              DAJ2NY                          WDJ2NY
     I              DARIDT                          WDRIDT
     I              DAC5TM                          WDC5TM
     I              DAMVT1                          WDMVT1
     I              DAMWT1                          WDMWT1
     I              DARINT                          WDRINT
     I              DARJDT                          WDRJDT
     I              DAC6TM                          WDC6TM
     I              DAC4NB                          WDC4NB
     I              DADPNB                          WDDPNB
     I              DAUENB                          WDUENB
     I              DARZNB                          WDRZNB
     I              DANGT1                          WDNGT1
     I              DARMNB                          WDRMNB
     I              DARKDT                          WDRKDT
     I              DAC7TM                          WDC7TM
     I              DARINS                          WDRINS
     I              DAMXT1                          WDMXT1
     I              DAG3ST                          WDG3ST
     I              DAQWNY                          WDQWNY
     I              DAL0AA                          WDL0AA
     I              DAMAT1                          WDMAT1
     I              DATDNA                          WDTDNA
     I              DACWC3                          WDCWC3
     I              DAQXNY                          WDQXNY
     I              DAQZNY                          WDQZNY
     I              DAQ0NY                          WDQ0NY
     I              DALVTX                          WDLVTX
     I              DANYT1                          WDNYT1
     I              DAG5ST                          WDG5ST
     I              DAG7ST                          WDG7ST
     I              DATFDT                          WDTFDT
     I              DATGDT                          WDTGDT
     I              DAWIT1                          WDWIT1
     I              DAQYNY                          WDQYNY
     I              DAL7T1                          WDL7T1
     I              DAR8NY                          WDR8NY
     I              DAR0NY                          WDR0NY
     I              DAI7AA                          WDI7AA
     I              DAMXAA                          WDMXAA
     I              DAMSAA                          WDMSAA
     I              DAR7NY                          WDR7NY
     I              DAHEPR                          WDHEPR
     I              DAHFPR                          WDHFPR
     I              DAWVT1                          WDWVT1
     I              DAW0T1                          WDW0T1
     I              DAR5NY                          WDR5NY
     I              DAW1T1                          WDW1T1
     I              DAR6NY                          WDR6NY
     I              DAJ1ST                          WDJ1ST
     I              DAKHST                          WDKHST
     I              DATWDT                          WDTWDT
     I              DADUTM                          WDDUTM
     I              DAKGST                          WDKGST
     I              DATVDT                          WDTVDT
     I              DADTTM                          WDDTTM
     I              DAR9NY                          WDR9NY
     I              DASQNY                          WDSQNY
     I              DABHR3                          WDBHR3
     I              DASRNY                          WDSRNY
     I              DAW7T1                          WDW7T1
     I              DAW8T1                          WDW8T1
     I              DAT2DT                          WDT2DT
     I              DASXNY                          WDSXNY
     I              DASYNY                          WDSYNY
     I              DASZNY                          WDSZNY
     I              DAVSST                          WDVSST
     I              DAMJDT                          WDMJDT
     I              DABETM                          WDBETM
     I              DACCVN                          WDCCVN
     I              DACDVN                          WDCDVN
     I              DAMKDT                          WDMKDT
     I              DABFTM                          WDBFTM
     I              DACEVN                          WDCEVN
     I              DACFVN                          WDCFVN
      *
     I@DACPP6
      * COA Batch Header RIN      Retrieval index
      * Renamed input format fields
     I              DAAIC3                          WEAIC3
     I              DAL6T1                          WEL6T1
     I              DAI3NY                          WEI3NY
     I              DAJYNY                          WEJYNY
     I              DAQ1NY                          WEQ1NY
     I              DAMUT1                          WEMUT1
     I              DAJZNY                          WEJZNY
     I              DAJ0NY                          WEJ0NY
     I              DAJ2NY                          WEJ2NY
     I              DARIDT                          WERIDT
     I              DAC5TM                          WEC5TM
     I              DAMVT1                          WEMVT1
     I              DAMWT1                          WEMWT1
     I              DARINT                          WERINT
     I              DARJDT                          WERJDT
     I              DAC6TM                          WEC6TM
     I              DAC4NB                          WEC4NB
     I              DADPNB                          WEDPNB
     I              DAUENB                          WEUENB
     I              DARZNB                          WERZNB
     I              DANGT1                          WENGT1
     I              DARMNB                          WERMNB
     I              DARKDT                          WERKDT
     I              DAC7TM                          WEC7TM
     I              DARINS                          WERINS
     I              DAMXT1                          WEMXT1
     I              DAG3ST                          WEG3ST
     I              DAQWNY                          WEQWNY
     I              DAL0AA                          WEL0AA
     I              DAMAT1                          WEMAT1
     I              DATDNA                          WETDNA
     I              DACWC3                          WECWC3
     I              DAQXNY                          WEQXNY
     I              DAQZNY                          WEQZNY
     I              DAQ0NY                          WEQ0NY
     I              DALVTX                          WELVTX
     I              DANYT1                          WENYT1
     I              DAG5ST                          WEG5ST
     I              DAG7ST                          WEG7ST
     I              DATFDT                          WETFDT
     I              DATGDT                          WETGDT
     I              DAWIT1                          WEWIT1
     I              DAQYNY                          WEQYNY
     I              DAL7T1                          WEL7T1
     I              DAR8NY                          WER8NY
     I              DAR0NY                          WER0NY
     I              DAI7AA                          WEI7AA
     I              DAMXAA                          WEMXAA
     I              DAMSAA                          WEMSAA
     I              DAR7NY                          WER7NY
     I              DAHEPR                          WEHEPR
     I              DAHFPR                          WEHFPR
     I              DAWVT1                          WEWVT1
     I              DAW0T1                          WEW0T1
     I              DAR5NY                          WER5NY
     I              DAW1T1                          WEW1T1
     I              DAR6NY                          WER6NY
     I              DAJ1ST                          WEJ1ST
     I              DAKHST                          WEKHST
     I              DATWDT                          WETWDT
     I              DADUTM                          WEDUTM
     I              DAKGST                          WEKGST
     I              DATVDT                          WETVDT
     I              DADTTM                          WEDTTM
     I              DAR9NY                          WER9NY
     I              DASQNY                          WESQNY
     I              DABHR3                          WEBHR3
     I              DASRNY                          WESRNY
     I              DAW7T1                          WEW7T1
     I              DAW8T1                          WEW8T1
     I              DAT2DT                          WET2DT
     I              DASXNY                          WESXNY
     I              DASYNY                          WESYNY
     I              DASZNY                          WESZNY
     I              DAVSST                          WEVSST
     I              DAMJDT                          WEMJDT
     I              DABETM                          WEBETM
     I              DACCVN                          WECCVN
     I              DACDVN                          WECDVN
     I              DAMKDT                          WEMKDT
     I              DABFTM                          WEBFTM
     I              DACEVN                          WECEVN
     I              DACFVN                          WECFVN
      *
     I@AMREJE
      * Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                          WFAIC3
     I              AMC4NB                          WFC4NB
     I              AMRMNB                          WFRMNB
     I              AMRUNB                          WFRUNB
     I              AMXACD                          WFXACD
     I              AMOANA                          WFOANA
     I              AMHBAA                          WFHBAA
     I              AMJ0T1                          WFJ0T1
     I              AMGENY                          WFGENY
     I              AMJ1T1                          WFJ1T1
     I              AMHCAA                          WFHCAA
     I              AMQWDT                          WFQWDT
     I              AMQXDT                          WFQXDT
     I              AMQYDT                          WFQYDT
     I              AMHDAA                          WFHDAA
     I              AMCCTX                          WFCCTX
     I              AMJ2T1                          WFJ2T1
     I              AMRLNA                          WFRLNA
     I              AMRMNA                          WFRMNA
     I              AMGINY                          WFGINY
     I              AMGFNY                          WFGFNY
     I              AMGGNY                          WFGGNY
     I              AMGHNY                          WFGHNY
     I              AMHEVL                          WFHEVL
     I              AMHFVL                          WFHFVL
     I              AMHGVL                          WFHGVL
     I              AMQZDT                          WFQZDT
     I              AMQ0DT                          WFQ0DT
     I              AMQ1DT                          WFQ1DT
     I              AMQ2DT                          WFQ2DT
     I              AMC2TX                          WFC2TX
     I              AMC3TX                          WFC3TX
     I              AMC6TX                          WFC6TX
     I              AMCHTX                          WFCHTX
     I              AMCITX                          WFCITX
     I              AMCLTX                          WFCLTX
     I              AMB4TX                          WFB4TX
     I              AMCUTX                          WFCUTX
     I              AMCVTX                          WFCVTX
     I              AMB9TX                          WFB9TX
     I              AMJWSC                          WFJWSC
     I              AMITNY                          WFITNY
     I              AMLMT1                          WFLMT1
     I              AMLWAA                          WFLWAA
     I              AMFVST                          WFFVST
     I              AMF0ST                          WFF0ST
     I              AMF2ST                          WFF2ST
     I              AMF3ST                          WFF3ST
     I              AMJUSC                          WFJUSC
     I              AMJVSC                          WFJVSC
     I              AMV3T1                          WFV3T1
     I              AMV4T1                          WFV4T1
     I              AMV5T1                          WFV5T1
     I              AMV6T1                          WFV6T1
     I              AMV7T1                          WFV7T1
     I              AMV8T1                          WFV8T1
     I              AMV9T1                          WFV9T1
     I              AMWAT1                          WFWAT1
     I              AMWBT1                          WFWBT1
     I              AMWCT1                          WFWCT1
     I              AMWDT1                          WFWDT1
     I              AMQJNY                          WFQJNY
     I              AMQKNY                          WFQKNY
     I              AMQLNY                          WFQLNY
     I              AMP8NY                          WFP8NY
     I              AMP9NY                          WFP9NY
     I              AMQANY                          WFQANY
     I              AMQCNY                          WFQCNY
     I              AMQDNY                          WFQDNY
     I              AMQENY                          WFQENY
     I              AMQFNY                          WFQFNY
     I              AMQGNY                          WFQGNY
     I              AMQHNY                          WFQHNY
     I              AMQINY                          WFQINY
     I              AMQMNY                          WFQMNY
     I              AMMYU1                          WFMYU1
     I              AMJXSC                          WFJXSC
     I              AMJYSC                          WFJYSC
     I              AMJZSC                          WFJZSC
     I              AMJ0SC                          WFJ0SC
     I              AMMZU1                          WFMZU1
     I              AMM0U1                          WFM0U1
     I              AMM1U1                          WFM1U1
     I              AMM2U1                          WFM2U1
     I              AMM3U1                          WFM3U1
     I              AMW5DT                          WFW5DT
     I              AMW6DT                          WFW6DT
     I              AMUVST                          WFUVST
     I              AMUWST                          WFUWST
     I              AMUXST                          WFUXST
     I              AMVSST                          WFVSST
     I              AMAATM                          WFAATM
     I              AMAYNA                          WFAYNA
     I              AMA0NA                          WFA0NA
     I              AMAXDT                          WFAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WGAIC3
     I              OMC4NB                          WGC4NB
     I              OMDPNB                          WGDPNB
     I              OMUENB                          WGUENB
     I              OMHGCD                          WGHGCD
     I              OMAJCD                          WGAJCD
     I              OMBKC7                          WGBKC7
     I              OMCFC7                          WGCFC7
     I              OMGMST                          WGGMST
     I              OMGNST                          WGGNST
     I              OMMAVA                          WGMAVA
     I              OMKDVA                          WGKDVA
     I              OML8VA                          WGL8VA
     I              OML9VA                          WGL9VA
     I              OMGTST                          WGGTST
     I              OMGVST                          WGGVST
     I              OMGUST                          WGGUST
     I              OMQFST                          WGQFST
     I              OMAYVA                          WGAYVA
     I              OMEXDT                          WGEXDT
     I              OMLQCD                          WGLQCD
     I              OMRDCD                          WGRDCD
     I              OMQ7CD                          WGQ7CD
     I              OMBZPR                          WGBZPR
     I              OML6NB                          WGL6NB
     I              OMU1ST                          WGU1ST
     I              OMGIDT                          WGGIDT
     I              OMCRCD                          WGCRCD
     I              OMAGCD                          WGAGCD
     I              OMRZST                          WGRZST
     I              OMR0ST                          WGR0ST
     I              OMR1ST                          WGR1ST
     I              OMG7NA                          WGG7NA
     I              OMG8NA                          WGG8NA
     I              OMRPCD                          WGRPCD
     I              OMVEST                          WGVEST
     I              OMVGST                          WGVGST
     I              OMAVST                          WGAVST
     I              OMU0ST                          WGU0ST
     I              OMRFCD                          WGRFCD
     I              OMFZST                          WGFZST
     I              OMR1NB                          WGR1NB
     I              OMAVQT                          WGAVQT
     I              OMD0WG                          WGD0WG
     I              OMCCQT                          WGCCQT
     I              OMAUWG                          WGAUWG
     I              OMCBQT                          WGCBQT
     I              OMATWG                          WGATWG
     I              OMAQCS                          WGAQCS
     I              OMAGCS                          WGAGCS
     I              OMAKPR                          WGAKPR
     I              OMALPR                          WGALPR
     I              OMAUPR                          WGAUPR
     I              OMAVWG                          WGAVWG
     I              OMA4WG                          WGA4WG
     I              OMA5DT                          WGA5DT
     I              OMAODT                          WGAODT
     I              OMGNDT                          WGGNDT
     I              OMAMST                          WGAMST
     I              OMANST                          WGANST
     I              OMVAST                          WGVAST
     I              OMRGNB                          WGRGNB
     I              OMRHNB                          WGRHNB
     I              OMRINB                          WGRINB
     I              OMRBCD                          WGRBCD
     I              OMHICD                          WGHICD
     I              OMRNCD                          WGRNCD
     I              OMROCD                          WGROCD
     I              OMCXDT                          WGCXDT
     I              OMAJVN                          WGAJVN
     I              OMKXCD                          WGKXCD
     I              OMJPCD                          WGJPCD
     I              OMCQCD                          WGCQCD
     I              OMR4CD                          WGR4CD
     I              OMZ1ST                          WGZ1ST
     I              OMZ3ST                          WGZ3ST
     I              OMZ4ST                          WGZ4ST
     I              OMDUPR                          WGDUPR
     I              OMB6VL                          WGB6VL
     I              OMA1AA                          WGA1AA
     I              OMFZSX                          WGFZSX
     I              OMF0SX                          WGF0SX
     I              OMF1SX                          WGF1SX
     I              OMF2SX                          WGF2SX
     I              OMF3SX                          WGF3SX
     I              OMF4SX                          WGF4SX
     I              OMF5SX                          WGF5SX
     I              OMF6SX                          WGF6SX
     I              OMF7SX                          WGF7SX
     I              OMNTDT                          WGNTDT
     I              OMNUDT                          WGNUDT
     I              OMNVDT                          WGNVDT
     I              OMNWDT                          WGNWDT
     I              OMNXDT                          WGNXDT
     I              OMBUTM                          WGBUTM
     I              OMBVTM                          WGBVTM
     I              OMBWTM                          WGBWTM
     I              OMBXTM                          WGBXTM
     I              OMBYTM                          WGBYTM
     I              OMH5NX                          WGH5NX
     I              OMH6NX                          WGH6NX
     I              OMH7NX                          WGH7NX
     I              OMH8NX                          WGH8NX
     I              OMH9NX                          WGH9NX
     I              OMDVPR                          WGDVPR
     I              OMDWPR                          WGDWPR
     I              OMDXPR                          WGDXPR
     I              OMDYPR                          WGDYPR
     I              OMDZPR                          WGDZPR
     I              OMGSPR                          WGGSPR
     I              OMGTPR                          WGGTPR
     I              OMGUPR                          WGGUPR
     I              OMHOST                          WGHOST
     I              OMHPST                          WGHPST
     I              OMIOST                          WGIOST
     I              OMPEWG                          WGPEWG
     I              OMRINY                          WGRINY
     I              OMTIDT                          WGTIDT
     I              OMTJDT                          WGTJDT
     I              OMH2ST                          WGH2ST
     I              OMH0ST                          WGH0ST
     I              OMH1ST                          WGH1ST
     I              OMTKDT                          WGTKDT
     I              OMTLDT                          WGTLDT
     I              OMTMDT                          WGTMDT
     I              OMUVST                          WGUVST
     I              OMUWST                          WGUWST
     I              OMUXST                          WGUXST
     I              OMAATM                          WGAATM
     I              OMAYNA                          WGAYNA
     I              OMA0NA                          WGA0NA
     I              OMAXDT                          WGAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WHAIC3
     I              OMC4NB                          WHC4NB
     I              OMDPNB                          WHDPNB
     I              OMUENB                          WHUENB
     I              OMHGCD                          WHHGCD
     I              OMAJCD                          WHAJCD
     I              OMBKC7                          WHBKC7
     I              OMCFC7                          WHCFC7
     I              OMGMST                          WHGMST
     I              OMGNST                          WHGNST
     I              OMMAVA                          WHMAVA
     I              OMKDVA                          WHKDVA
     I              OML8VA                          WHL8VA
     I              OML9VA                          WHL9VA
     I              OMGTST                          WHGTST
     I              OMGVST                          WHGVST
     I              OMGUST                          WHGUST
     I              OMQFST                          WHQFST
     I              OMAYVA                          WHAYVA
     I              OMEXDT                          WHEXDT
     I              OMLQCD                          WHLQCD
     I              OMRDCD                          WHRDCD
     I              OMQ7CD                          WHQ7CD
     I              OMBZPR                          WHBZPR
     I              OML6NB                          WHL6NB
     I              OMU1ST                          WHU1ST
     I              OMGIDT                          WHGIDT
     I              OMCRCD                          WHCRCD
     I              OMAGCD                          WHAGCD
     I              OMRZST                          WHRZST
     I              OMR0ST                          WHR0ST
     I              OMR1ST                          WHR1ST
     I              OMG7NA                          WHG7NA
     I              OMG8NA                          WHG8NA
     I              OMRPCD                          WHRPCD
     I              OMVEST                          WHVEST
     I              OMVGST                          WHVGST
     I              OMAVST                          WHAVST
     I              OMU0ST                          WHU0ST
     I              OMRFCD                          WHRFCD
     I              OMFZST                          WHFZST
     I              OMR1NB                          WHR1NB
     I              OMAVQT                          WHAVQT
     I              OMD0WG                          WHD0WG
     I              OMCCQT                          WHCCQT
     I              OMAUWG                          WHAUWG
     I              OMCBQT                          WHCBQT
     I              OMATWG                          WHATWG
     I              OMAQCS                          WHAQCS
     I              OMAGCS                          WHAGCS
     I              OMAKPR                          WHAKPR
     I              OMALPR                          WHALPR
     I              OMAUPR                          WHAUPR
     I              OMAVWG                          WHAVWG
     I              OMA4WG                          WHA4WG
     I              OMA5DT                          WHA5DT
     I              OMAODT                          WHAODT
     I              OMGNDT                          WHGNDT
     I              OMAMST                          WHAMST
     I              OMANST                          WHANST
     I              OMVAST                          WHVAST
     I              OMRGNB                          WHRGNB
     I              OMRHNB                          WHRHNB
     I              OMRINB                          WHRINB
     I              OMRBCD                          WHRBCD
     I              OMHICD                          WHHICD
     I              OMRNCD                          WHRNCD
     I              OMROCD                          WHROCD
     I              OMCXDT                          WHCXDT
     I              OMAJVN                          WHAJVN
     I              OMKXCD                          WHKXCD
     I              OMJPCD                          WHJPCD
     I              OMCQCD                          WHCQCD
     I              OMR4CD                          WHR4CD
     I              OMZ1ST                          WHZ1ST
     I              OMZ3ST                          WHZ3ST
     I              OMZ4ST                          WHZ4ST
     I              OMDUPR                          WHDUPR
     I              OMB6VL                          WHB6VL
     I              OMA1AA                          WHA1AA
     I              OMFZSX                          WHFZSX
     I              OMF0SX                          WHF0SX
     I              OMF1SX                          WHF1SX
     I              OMF2SX                          WHF2SX
     I              OMF3SX                          WHF3SX
     I              OMF4SX                          WHF4SX
     I              OMF5SX                          WHF5SX
     I              OMF6SX                          WHF6SX
     I              OMF7SX                          WHF7SX
     I              OMNTDT                          WHNTDT
     I              OMNUDT                          WHNUDT
     I              OMNVDT                          WHNVDT
     I              OMNWDT                          WHNWDT
     I              OMNXDT                          WHNXDT
     I              OMBUTM                          WHBUTM
     I              OMBVTM                          WHBVTM
     I              OMBWTM                          WHBWTM
     I              OMBXTM                          WHBXTM
     I              OMBYTM                          WHBYTM
     I              OMH5NX                          WHH5NX
     I              OMH6NX                          WHH6NX
     I              OMH7NX                          WHH7NX
     I              OMH8NX                          WHH8NX
     I              OMH9NX                          WHH9NX
     I              OMDVPR                          WHDVPR
     I              OMDWPR                          WHDWPR
     I              OMDXPR                          WHDXPR
     I              OMDYPR                          WHDYPR
     I              OMDZPR                          WHDZPR
     I              OMGSPR                          WHGSPR
     I              OMGTPR                          WHGTPR
     I              OMGUPR                          WHGUPR
     I              OMHOST                          WHHOST
     I              OMHPST                          WHHPST
     I              OMIOST                          WHIOST
     I              OMPEWG                          WHPEWG
     I              OMRINY                          WHRINY
     I              OMTIDT                          WHTIDT
     I              OMTJDT                          WHTJDT
     I              OMH2ST                          WHH2ST
     I              OMH0ST                          WHH0ST
     I              OMH1ST                          WHH1ST
     I              OMTKDT                          WHTKDT
     I              OMTLDT                          WHTLDT
     I              OMTMDT                          WHTMDT
     I              OMUVST                          WHUVST
     I              OMUWST                          WHUWST
     I              OMUXST                          WHUXST
     I              OMAATM                          WHAATM
     I              OMAYNA                          WHAYNA
     I              OMA0NA                          WHA0NA
     I              OMAXDT                          WHAXDT
      *
     I@FLCPW9
      * Load Detail               Co/Order
      * Renamed input format fields
     I              FLRMNB                          WIRMNB
     I              FLRUNB                          WIRUNB
     I              FLRVNB                          WIRVNB
     I              FLDQTX                          WIDQTX
     I              FLRWNB                          WIRWNB
     I              FLRXNB                          WIRXNB
     I              FLSQNB                          WISQNB
     I              FLT0NB                          WIT0NB
     I              FLT1NB                          WIT1NB
     I              FLR1NB                          WIR1NB
     I              FLAIC3                          WIAIC3
     I              FLC4NB                          WIC4NB
     I              FLVCST                          WIVCST
     I              FLKEDT                          WIKEDT
     I              FLSXNB                          WISXNB
     I              FLKFDT                          WIKFDT
     I              FLACTM                          WIACTM
     I              FLK5TX                          WIK5TX
     I              FLW5CD                          WIW5CD
     I              FLEJDT                          WIEJDT
     I              FLAGTM                          WIAGTM
     I              FLKJDT                          WIKJDT
     I              FLATTM                          WIATTM
     I              FLHDDT                          WIHDDT
     I              FLAUTM                          WIAUTM
     I              FLKKDT                          WIKKDT
     I              FLAVTM                          WIAVTM
     I              FLZ4NB                          WIZ4NB
     I              FLY7ST                          WIY7ST
     I              FLY2ST                          WIY2ST
     I              FLWHTX                          WIWHTX
     I              FLWITX                          WIWITX
     I              FLWJTX                          WIWJTX
     I              FLWKTX                          WIWKTX
     I              FLWLTX                          WIWLTX
     I              FLN7DT                          WIN7DT
     I              FLN8DT                          WIN8DT
     I              FLN9DT                          WIN9DT
     I              FLB3TM                          WIB3TM
     I              FLB4TM                          WIB4TM
     I              FLB5TM                          WIB5TM
     I              FLIASX                          WIIASX
     I              FLIBSX                          WIIBSX
     I              FLICSX                          WIICSX
     I              FLWVTX                          WIWVTX
     I              FLWWTX                          WIWWTX
     I              FLWXTX                          WIWXTX
     I              FLUVST                          WIUVST
     I              FLUWST                          WIUWST
     I              FLUXST                          WIUXST
     I              FLAATM                          WIAATM
     I              FLAYNA                          WIAYNA
     I              FLA0NA                          WIA0NA
     I              FLAXDT                          WIAXDT
      *
     I@FLCPBM
      * Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WJRMNB
     I              FLRUNB                          WJRUNB
     I              FLRVNB                          WJRVNB
     I              FLDQTX                          WJDQTX
     I              FLRWNB                          WJRWNB
     I              FLRXNB                          WJRXNB
     I              FLSQNB                          WJSQNB
     I              FLT0NB                          WJT0NB
     I              FLT1NB                          WJT1NB
     I              FLR1NB                          WJR1NB
     I              FLAIC3                          WJAIC3
     I              FLC4NB                          WJC4NB
     I              FLVCST                          WJVCST
     I              FLKEDT                          WJKEDT
     I              FLSXNB                          WJSXNB
     I              FLKFDT                          WJKFDT
     I              FLACTM                          WJACTM
     I              FLK5TX                          WJK5TX
     I              FLW5CD                          WJW5CD
     I              FLEJDT                          WJEJDT
     I              FLAGTM                          WJAGTM
     I              FLKJDT                          WJKJDT
     I              FLATTM                          WJATTM
     I              FLHDDT                          WJHDDT
     I              FLAUTM                          WJAUTM
     I              FLKKDT                          WJKKDT
     I              FLAVTM                          WJAVTM
     I              FLZ4NB                          WJZ4NB
     I              FLY7ST                          WJY7ST
     I              FLY2ST                          WJY2ST
     I              FLWHTX                          WJWHTX
     I              FLWITX                          WJWITX
     I              FLWJTX                          WJWJTX
     I              FLWKTX                          WJWKTX
     I              FLWLTX                          WJWLTX
     I              FLN7DT                          WJN7DT
     I              FLN8DT                          WJN8DT
     I              FLN9DT                          WJN9DT
     I              FLB3TM                          WJB3TM
     I              FLB4TM                          WJB4TM
     I              FLB5TM                          WJB5TM
     I              FLIASX                          WJIASX
     I              FLIBSX                          WJIBSX
     I              FLICSX                          WJICSX
     I              FLWVTX                          WJWVTX
     I              FLWWTX                          WJWWTX
     I              FLWXTX                          WJWXTX
     I              FLUVST                          WJUVST
     I              FLUWST                          WJUWST
     I              FLUXST                          WJUXST
     I              FLAATM                          WJAATM
     I              FLAYNA                          WJAYNA
     I              FLA0NA                          WJA0NA
     I              FLAXDT                          WJAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     I@1DBRC    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Current/previous master file format fields for change control
      *
     I#1DBRC      DS                            779
      * Stored master file format fields
     I                                        1   1 #1DB1
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
     IYARDCS      DS                            779
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      * Outward parameters
     IPARC        DS                             82
      * RCD : Load Order Change Log     Retrieval index
      * N :  Sequence Number
     I                                    P   9  100PADXNB
      * I :  Load ID
     I                                    P  11  140PARMNB
      * I :  Stop/Drop
     I                                    P  15  170PARVNB
      * I :  Load Change Type
     I                                       18  23 PARVST
      * I :  Department Control Code
     I                                       24  26 PAUJST
      * I :  Change Log Prior Value
     I                                       27  38 PAMNTX
      * I :  Change Log New Value
     I                                       39  50 PAMOTX
      * I :  User Id
     I                                       51  60 PAAYNA
      * I :  Job Name
     I                                       61  70 PAA0NA
      * I :  Carrier Code
     I                                       71  73 PABZNA
      * N :  Carrier Broker Carrier Co
     I                                       74  76 PAXMCD
      * I :  Company Number
     I                                    P  77  780PAAIC3
      * I :  Order Number
     I                                    P  79  820PAC4NB
      *
     IQOMFJ1    E DSOMFJCPL1
      * UPD : Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WCRMNB
     I              FJAIC3                          WCAIC3
     I              FJAODT                          WCAODT
     I              FJPJST                          WCPJST
     I              FJPKST                          WCPKST
     I              FJRNNB                          WCRNNB
     I              FJDMTX                          WCDMTX
     I              FJDNTX                          WCDNTX
     I              FJDOTX                          WCDOTX
     I              FJWTTX                          WCWTTX
     I              FJWUTX                          WCWUTX
     I              FJRPNB                          WCRPNB
     I              FJFLAM                          WCFLAM
     I              FJXQST                          WCXQST
     I              FJRRNB                          WCRRNB
     I              FJDXTX                          WCDXTX
     I              FJDYTX                          WCDYTX
     I              FJSBNB                          WCSBNB
     I              FJBZNA                          WCBZNA
     I              FJRONB                          WCRONB
     I              FJSQNB                          WCSQNB
     I              FJR1NB                          WCR1NB
     I              FJVCST                          WCVCST
     I              FJVDST                          WCVDST
     I              FJSDNB                          WCSDNB
     I              FJPAOU                          WCPAOU
     I              FJDGWG                          WCDGWG
     I              FJSXNB                          WCSXNB
     I              FJHADT                          WCHADT
     I              FJAART                          WCAART
     I              FJDHWG                          WCDHWG
     I              FJDIWG                          WCDIWG
     I              FJAQDT                          WCAQDT
     I              FJS6NB                          WCS6NB
     I              FJT4NB                          WCT4NB
     I              FJPRTM                          WCPRTM
     I              FJNPSV                          WCNPSV
     I              FJJ8TX                          WCJ8TX
     I              FJTLMI                          WCTLMI
     I              FJJ9TX                          WCJ9TX
     I              FJQ2CD                          WCQ2CD
     I              FJVPCD                          WCVPCD
     I              FJDBCD                          WCDBCD
     I              FJGRWE                          WCGRWE
     I              FJXCCD                          WCXCCD
     I              FJU2ST                          WCU2ST
     I              FJF9DT                          WCF9DT
     I              FJONTM                          WCONTM
     I              FJJ4DT                          WCJ4DT
     I              FJTRTM                          WCTRTM
     I              FJJ5DT                          WCJ5DT
     I              FJSPTM                          WCSPTM
     I              FJJ6DT                          WCJ6DT
     I              FJLFTM                          WCLFTM
     I              FJJ7DT                          WCJ7DT
     I              FJBOTM                          WCBOTM
     I              FJJ8DT                          WCJ8DT
     I              FJBLTM                          WCBLTM
     I              FJKIDT                          WCKIDT
     I              FJASTM                          WCASTM
     I              FJKADT                          WCKADT
     I              FJAJCM                          WCAJCM
     I              FJXACD                          WCXACD
     I              FJOANA                          WCOANA
     I              FJK4TX                          WCK4TX
     I              FJVOAG                          WCVOAG
     I              FJKBDT                          WCKBDT
     I              FJNBBO                          WCNBBO
     I              FJW4CD                          WCW4CD
     I              FJEFDT                          WCEFDT
     I              FJCNTN                          WCCNTN
     I              FJKCDT                          WCKCDT
     I              FJTMIN                          WCTMIN
     I              FJKDDT                          WCKDDT
     I              FJVMNB                          WCVMNB
     I              FJOCFR                          WCOCFR
     I              FJKJDT                          WCKJDT
     I              FJATTM                          WCATTM
     I              FJOTRS                          WCOTRS
     I              FJRNST                          WCRNST
     I              FJBRBK                          WCBRBK
     I              FJEIDT                          WCEIDT
     I              FJRMST                          WCRMST
     I              FJAJCD                          WCAJCD
     I              FJKKDT                          WCKKDT
     I              FJAVTM                          WCAVTM
     I              FJKZDT                          WCKZDT
     I              FJAXTM                          WCAXTM
     I              FJLHOS                          WCLHOS
     I              FJLHOR                          WCLHOR
     I              FJWNTX                          WCWNTX
     I              FJOITX                          WCOITX
     I              FJOJTX                          WCOJTX
     I              FJLLDT                          WCLLDT
     I              FJLSHG                          WCLSHG
     I              FJYPST                          WCYPST
     I              FJK0DT                          WCK0DT
     I              FJAYTM                          WCAYTM
     I              FJKNNX                          WCKNNX
     I              FJICWG                          WCICWG
     I              FJIDWG                          WCIDWG
     I              FJH9SX                          WCH9SX
     I              FJWOTX                          WCWOTX
     I              FJK1DT                          WCK1DT
     I              FJAZTM                          WCAZTM
     I              FJK2DT                          WCK2DT
     I              FJA0TM                          WCA0TM
     I              FJROST                          WCROST
     I              FJRPST                          WCRPST
     I              FJRQST                          WCRQST
     I              FJRRST                          WCRRST
     I              FJZBVA                          WCZBVA
     I              FJWPTX                          WCWPTX
     I              FJWQTX                          WCWQTX
     I              FJWRTX                          WCWRTX
     I              FJWSTX                          WCWSTX
     I              FJRVSX                          WCRVSX
     I              FJRUSX                          WCRUSX
     I              FJRWSX                          WCRWSX
     I              FJRXSX                          WCRXSX
     I              FJRYSX                          WCRYSX
     I              FJRZSX                          WCRZSX
     I              FJR0SX                          WCR0SX
     I              FJR1SX                          WCR1SX
     I              FJR2SX                          WCR2SX
     I              FJR3SX                          WCR3SX
     I              FJR4SX                          WCR4SX
     I              FJPYDT                          WCPYDT
     I              FJCKTM                          WCCKTM
     I              FJPZDT                          WCPZDT
     I              FJCLTM                          WCCLTM
     I              FJP0DT                          WCP0DT
     I              FJCMTM                          WCCMTM
     I              FJP1DT                          WCP1DT
     I              FJCNTM                          WCCNTM
     I              FJP2DT                          WCP2DT
     I              FJCOTM                          WCCOTM
     I              FJP3DT                          WCP3DT
     I              FJCQTM                          WCCQTM
     I              FJUVST                          WCUVST
     I              FJUWST                          WCUWST
     I              FJUXST                          WCUXST
     I              FJAATM                          WCAATM
     I              FJAYNA                          WCAYNA
     I              FJA0NA                          WCA0NA
     I              FJAXDT                          WCAXDT
      *
     IYBRDCS      DS                            793
     IQPMDA1    E DSPMDACPL0
      * UPD : COA Batch Header RIN      Update index
      * Renamed input format fields
     I              DAAIC3                          WDAIC3
     I              DAL6T1                          WDL6T1
     I              DAI3NY                          WDI3NY
     I              DAJYNY                          WDJYNY
     I              DAQ1NY                          WDQ1NY
     I              DAMUT1                          WDMUT1
     I              DAJZNY                          WDJZNY
     I              DAJ0NY                          WDJ0NY
     I              DAJ2NY                          WDJ2NY
     I              DARIDT                          WDRIDT
     I              DAC5TM                          WDC5TM
     I              DAMVT1                          WDMVT1
     I              DAMWT1                          WDMWT1
     I              DARINT                          WDRINT
     I              DARJDT                          WDRJDT
     I              DAC6TM                          WDC6TM
     I              DAC4NB                          WDC4NB
     I              DADPNB                          WDDPNB
     I              DAUENB                          WDUENB
     I              DARZNB                          WDRZNB
     I              DANGT1                          WDNGT1
     I              DARMNB                          WDRMNB
     I              DARKDT                          WDRKDT
     I              DAC7TM                          WDC7TM
     I              DARINS                          WDRINS
     I              DAMXT1                          WDMXT1
     I              DAG3ST                          WDG3ST
     I              DAQWNY                          WDQWNY
     I              DAL0AA                          WDL0AA
     I              DAMAT1                          WDMAT1
     I              DATDNA                          WDTDNA
     I              DACWC3                          WDCWC3
     I              DAQXNY                          WDQXNY
     I              DAQZNY                          WDQZNY
     I              DAQ0NY                          WDQ0NY
     I              DALVTX                          WDLVTX
     I              DANYT1                          WDNYT1
     I              DAG5ST                          WDG5ST
     I              DAG7ST                          WDG7ST
     I              DATFDT                          WDTFDT
     I              DATGDT                          WDTGDT
     I              DAWIT1                          WDWIT1
     I              DAQYNY                          WDQYNY
     I              DAL7T1                          WDL7T1
     I              DAR8NY                          WDR8NY
     I              DAR0NY                          WDR0NY
     I              DAI7AA                          WDI7AA
     I              DAMXAA                          WDMXAA
     I              DAMSAA                          WDMSAA
     I              DAR7NY                          WDR7NY
     I              DAHEPR                          WDHEPR
     I              DAHFPR                          WDHFPR
     I              DAWVT1                          WDWVT1
     I              DAW0T1                          WDW0T1
     I              DAR5NY                          WDR5NY
     I              DAW1T1                          WDW1T1
     I              DAR6NY                          WDR6NY
     I              DAJ1ST                          WDJ1ST
     I              DAKHST                          WDKHST
     I              DATWDT                          WDTWDT
     I              DADUTM                          WDDUTM
     I              DAKGST                          WDKGST
     I              DATVDT                          WDTVDT
     I              DADTTM                          WDDTTM
     I              DAR9NY                          WDR9NY
     I              DASQNY                          WDSQNY
     I              DABHR3                          WDBHR3
     I              DASRNY                          WDSRNY
     I              DAW7T1                          WDW7T1
     I              DAW8T1                          WDW8T1
     I              DAT2DT                          WDT2DT
     I              DASXNY                          WDSXNY
     I              DASYNY                          WDSYNY
     I              DASZNY                          WDSZNY
     I              DAVSST                          WDVSST
     I              DAMJDT                          WDMJDT
     I              DABETM                          WDBETM
     I              DACCVN                          WDCCVN
     I              DACDVN                          WDCDVN
     I              DAMKDT                          WDMKDT
     I              DABFTM                          WDBFTM
     I              DACEVN                          WDCEVN
     I              DACFVN                          WDCFVN
      *
     IYCRDCS      DS                            563
      * Outward parameters
     IPBRC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PBAIC3
      * I :  Order Number
     I                                    P   3   60PBC4NB
      * I :  Order Type - Sales
     I                                        7   8 PBJNCD
      * I :  A/R Customer Number
     I                                    P   9  120PBANC7
      * I :  Ship To Customer
     I                                    P  13  160PBBKC7
      * I :  Ship To Name
     I                                       17  46 PBBRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PBHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PBHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PBHPNA
      * I :  Ship To City
     I                                      137 156 PBHNNA
      * I :  Ship To State Code
     I                                      157 158 PBDBCD
      * I :  Ship To Zip/Postal Code
     I                                      159 169 PBCKTX
      * I :  Bill to Customer
     I                                    P 170 1730PBB0C7
      * I :  Bill to Name
     I                                      174 203 PBAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PBB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PBB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PBB4NA
      * I :  Bill to City
     I                                      294 313 PBB2NA
      * I :  Bill to State Code
     I                                      314 315 PBBHCD
      * I :  Bill to Zip/Postal Code
     I                                      316 326 PBC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PBBCNA
      * I :  Order Date
     I                                    P 342 3450PBA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PBA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PBGNDT
      * I :  Cancel Date
     I                                    P 354 3570PBACDT
      * I :  Terms Code
     I                                      358 359 PBAQCD
      * I :  Special Instructions
     I                                      360 399 PBB6NA
      * I :  Special Instructions 2
     I                                      400 439 PBBYNA
      * I :  Carrier Code
     I                                      440 442 PBBZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PBGTST
      * I :  Comment Print Inv/Cr.Memo
     I                                      444 444 PBGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PBGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PBQFST
      * I :  Reason Code
     I                                      447 449 PBCQCD
      * I :  Order in Use
     I                                      450 450 PBGJST
      * I :  Header Status
     I                                      451 451 PBGWST
      * I :  Header Status Last
     I                                      452 452 PBGXST
      * I :  Order Type Print Status
     I                                      453 453 PBGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PBAODT
      * I :  User Original Entry
     I                                      458 467 PBAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PBCXDT
      * I :  Order Value Total
     I                                    P 472 4772PBJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PBA1WG
      * I :  Credit Hold
     I                                      484 484 PBXIST
      * I :  Production Hold
     I                                      485 485 PBXJST
      * I :  New Customer Hold
     I                                      486 486 PBXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PBEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PBAFTM
      * I :  Accounts Receiv. Ent 1
     I                                      494 497 PBE8CD
      * I :  Accounts Receiv. Ent 2
     I                                      498 509 PBE9CD
      * I :  Load ID
     I                                    P 510 5130PBRMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PBTBNB
      * I :  Rated Freight
     I                                    P 517 5222PBR1NB
      * I :  LTL Flag
     I                                      523 523 PBPJST
      * I :  Price Audit
     I                                      524 524 PBU0ST
      * I :  Price Status
     I                                      525 525 PBU1ST
      * I :  Shipping Method
     I                                      526 527 PBQ2CD
      * I :  Export Status
     I                                      528 528 PBU2ST
      * I :  Palletize
     I                                      529 529 PBVEST
      * I :  Shrink Wrap
     I                                      530 530 PBVFST
      * I :  Slip Sheet
     I                                      531 531 PBVGST
      * I :  Age Code
     I                                      532 532 PBRPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PBRNNB
      * I :  Load Type
     I                                      536 536 PBVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PBATIN
      * I :  Load Plan Order
     I                                      541 541 PBU4ST
      * I :  Print Pick Slip
     I                                      542 542 PBU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PBRSRN
      * I :  Special Comment 1
     I                                      547 576 PBMHNA
      * I :  Special Comment 2
     I                                      577 606 PBMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PBWBST
      * I :  Sales Route Code
     I                                      608 610 PBR4CD
      * I :  Manager Level Code
     I                                      611 612 PBBFCD
      * I :  VP Level Code
     I                                      613 615 PBQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PBT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PBSICD
      * I :  Invoice Number
     I                                    P 623 6260PBCONB
      * I :  Invoice Suffix
     I                                      627 628 PBCEST
      * I :  Invoice Date
     I                                    P 629 6320PBAWDT
      * I :  Event Code
     I                                      633 634 PBJPCD
      * I :  Trans Contol AS400/Plant
     I                                      635 635 PBXUST
      * I :  Modified Flag
     I                                      636 636 PBZ1ST
      * I :  A/R order Value Total
     I                                    P 637 6422PBVRVA
      * I :  Billing Activity Type
     I                                      643 643 PBOBST
      * I :  Block Order Flag
     I                                      644 644 PBBCST
      * I :  Order Certification Flag
     I                                      645 645 PBBDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PBB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PBGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PBGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PBGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PBGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PBFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PBFOSX
      * I :  Order Emailed
     I                                      658 658 PBFPSX
      * I :  Export Docs Go w/Driver
     I                                      659 659 PBFQSX
      * I :  Shipping Temp Code C/F
     I                                      660 660 PBFRSX
      * I :  Broker Order Status
     I                                      661 661 PBFSSX
      * I :  Air Freight Order
     I                                      662 662 PBFTSX
      * I :  Order Requires Review
     I                                      663 664 PBFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PBFVSX
      * I :  Export USDA Approved
     I                                      667 668 PBFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PBFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PBFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PBNODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PBNPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PBNQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PBNRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PBNSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PBBPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PBBQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PBBRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PBBSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PBBTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PBH0NX
      * I :  Act Non-Ref Frt Amount
     I                                    P 721 7262PBH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PBH2NX
      * I :  OH Total Non-Ref Frt Amt
     I                                    P 733 7382PBH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PBH4NX
      * I :  Claim Number
     I                                    P 745 7480PBC0C7
      * I :  EDI Status 1
     I                                      749 749 PBUVST
      * I :  EDI Status 2
     I                                      750 750 PBUWST
      * I :  EDI Status 3
     I                                      751 751 PBUXST
      * I :  Job Time
     I                                    P 752 7550PBAATM
      * I :  User Id
     I                                      756 765 PBAYNA
      * I :  Job Name
     I                                      766 775 PBA0NA
      * I :  Job Date
     I                                    P 776 7790PBAXDT
      *
     IQPMAM1    E DSPMAMREL0
      * UPD : Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                          WFAIC3
     I              AMC4NB                          WFC4NB
     I              AMRMNB                          WFRMNB
     I              AMRUNB                          WFRUNB
     I              AMXACD                          WFXACD
     I              AMOANA                          WFOANA
     I              AMHBAA                          WFHBAA
     I              AMJ0T1                          WFJ0T1
     I              AMGENY                          WFGENY
     I              AMJ1T1                          WFJ1T1
     I              AMHCAA                          WFHCAA
     I              AMQWDT                          WFQWDT
     I              AMQXDT                          WFQXDT
     I              AMQYDT                          WFQYDT
     I              AMHDAA                          WFHDAA
     I              AMCCTX                          WFCCTX
     I              AMJ2T1                          WFJ2T1
     I              AMRLNA                          WFRLNA
     I              AMRMNA                          WFRMNA
     I              AMGINY                          WFGINY
     I              AMGFNY                          WFGFNY
     I              AMGGNY                          WFGGNY
     I              AMGHNY                          WFGHNY
     I              AMHEVL                          WFHEVL
     I              AMHFVL                          WFHFVL
     I              AMHGVL                          WFHGVL
     I              AMQZDT                          WFQZDT
     I              AMQ0DT                          WFQ0DT
     I              AMQ1DT                          WFQ1DT
     I              AMQ2DT                          WFQ2DT
     I              AMC2TX                          WFC2TX
     I              AMC3TX                          WFC3TX
     I              AMC6TX                          WFC6TX
     I              AMCHTX                          WFCHTX
     I              AMCITX                          WFCITX
     I              AMCLTX                          WFCLTX
     I              AMB4TX                          WFB4TX
     I              AMCUTX                          WFCUTX
     I              AMCVTX                          WFCVTX
     I              AMB9TX                          WFB9TX
     I              AMJWSC                          WFJWSC
     I              AMITNY                          WFITNY
     I              AMLMT1                          WFLMT1
     I              AMLWAA                          WFLWAA
     I              AMFVST                          WFFVST
     I              AMF0ST                          WFF0ST
     I              AMF2ST                          WFF2ST
     I              AMF3ST                          WFF3ST
     I              AMJUSC                          WFJUSC
     I              AMJVSC                          WFJVSC
     I              AMV3T1                          WFV3T1
     I              AMV4T1                          WFV4T1
     I              AMV5T1                          WFV5T1
     I              AMV6T1                          WFV6T1
     I              AMV7T1                          WFV7T1
     I              AMV8T1                          WFV8T1
     I              AMV9T1                          WFV9T1
     I              AMWAT1                          WFWAT1
     I              AMWBT1                          WFWBT1
     I              AMWCT1                          WFWCT1
     I              AMWDT1                          WFWDT1
     I              AMQJNY                          WFQJNY
     I              AMQKNY                          WFQKNY
     I              AMQLNY                          WFQLNY
     I              AMP8NY                          WFP8NY
     I              AMP9NY                          WFP9NY
     I              AMQANY                          WFQANY
     I              AMQCNY                          WFQCNY
     I              AMQDNY                          WFQDNY
     I              AMQENY                          WFQENY
     I              AMQFNY                          WFQFNY
     I              AMQGNY                          WFQGNY
     I              AMQHNY                          WFQHNY
     I              AMQINY                          WFQINY
     I              AMQMNY                          WFQMNY
     I              AMMYU1                          WFMYU1
     I              AMJXSC                          WFJXSC
     I              AMJYSC                          WFJYSC
     I              AMJZSC                          WFJZSC
     I              AMJ0SC                          WFJ0SC
     I              AMMZU1                          WFMZU1
     I              AMM0U1                          WFM0U1
     I              AMM1U1                          WFM1U1
     I              AMM2U1                          WFM2U1
     I              AMM3U1                          WFM3U1
     I              AMW5DT                          WFW5DT
     I              AMW6DT                          WFW6DT
     I              AMUVST                          WFUVST
     I              AMUWST                          WFUWST
     I              AMUXST                          WFUXST
     I              AMVSST                          WFVSST
     I              AMAATM                          WFAATM
     I              AMAYNA                          WFAYNA
     I              AMA0NA                          WFA0NA
     I              AMAXDT                          WFAXDT
      *
     IYDRDCS      DS                            894
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WHAIC3
     I              OMC4NB                          WHC4NB
     I              OMDPNB                          WHDPNB
     I              OMUENB                          WHUENB
     I              OMHGCD                          WHHGCD
     I              OMAJCD                          WHAJCD
     I              OMBKC7                          WHBKC7
     I              OMCFC7                          WHCFC7
     I              OMGMST                          WHGMST
     I              OMGNST                          WHGNST
     I              OMMAVA                          WHMAVA
     I              OMKDVA                          WHKDVA
     I              OML8VA                          WHL8VA
     I              OML9VA                          WHL9VA
     I              OMGTST                          WHGTST
     I              OMGVST                          WHGVST
     I              OMGUST                          WHGUST
     I              OMQFST                          WHQFST
     I              OMAYVA                          WHAYVA
     I              OMEXDT                          WHEXDT
     I              OMLQCD                          WHLQCD
     I              OMRDCD                          WHRDCD
     I              OMQ7CD                          WHQ7CD
     I              OMBZPR                          WHBZPR
     I              OML6NB                          WHL6NB
     I              OMU1ST                          WHU1ST
     I              OMGIDT                          WHGIDT
     I              OMCRCD                          WHCRCD
     I              OMAGCD                          WHAGCD
     I              OMRZST                          WHRZST
     I              OMR0ST                          WHR0ST
     I              OMR1ST                          WHR1ST
     I              OMG7NA                          WHG7NA
     I              OMG8NA                          WHG8NA
     I              OMRPCD                          WHRPCD
     I              OMVEST                          WHVEST
     I              OMVGST                          WHVGST
     I              OMAVST                          WHAVST
     I              OMU0ST                          WHU0ST
     I              OMRFCD                          WHRFCD
     I              OMFZST                          WHFZST
     I              OMR1NB                          WHR1NB
     I              OMAVQT                          WHAVQT
     I              OMD0WG                          WHD0WG
     I              OMCCQT                          WHCCQT
     I              OMAUWG                          WHAUWG
     I              OMCBQT                          WHCBQT
     I              OMATWG                          WHATWG
     I              OMAQCS                          WHAQCS
     I              OMAGCS                          WHAGCS
     I              OMAKPR                          WHAKPR
     I              OMALPR                          WHALPR
     I              OMAUPR                          WHAUPR
     I              OMAVWG                          WHAVWG
     I              OMA4WG                          WHA4WG
     I              OMA5DT                          WHA5DT
     I              OMAODT                          WHAODT
     I              OMGNDT                          WHGNDT
     I              OMAMST                          WHAMST
     I              OMANST                          WHANST
     I              OMVAST                          WHVAST
     I              OMRGNB                          WHRGNB
     I              OMRHNB                          WHRHNB
     I              OMRINB                          WHRINB
     I              OMRBCD                          WHRBCD
     I              OMHICD                          WHHICD
     I              OMRNCD                          WHRNCD
     I              OMROCD                          WHROCD
     I              OMCXDT                          WHCXDT
     I              OMAJVN                          WHAJVN
     I              OMKXCD                          WHKXCD
     I              OMJPCD                          WHJPCD
     I              OMCQCD                          WHCQCD
     I              OMR4CD                          WHR4CD
     I              OMZ1ST                          WHZ1ST
     I              OMZ3ST                          WHZ3ST
     I              OMZ4ST                          WHZ4ST
     I              OMDUPR                          WHDUPR
     I              OMB6VL                          WHB6VL
     I              OMA1AA                          WHA1AA
     I              OMFZSX                          WHFZSX
     I              OMF0SX                          WHF0SX
     I              OMF1SX                          WHF1SX
     I              OMF2SX                          WHF2SX
     I              OMF3SX                          WHF3SX
     I              OMF4SX                          WHF4SX
     I              OMF5SX                          WHF5SX
     I              OMF6SX                          WHF6SX
     I              OMF7SX                          WHF7SX
     I              OMNTDT                          WHNTDT
     I              OMNUDT                          WHNUDT
     I              OMNVDT                          WHNVDT
     I              OMNWDT                          WHNWDT
     I              OMNXDT                          WHNXDT
     I              OMBUTM                          WHBUTM
     I              OMBVTM                          WHBVTM
     I              OMBWTM                          WHBWTM
     I              OMBXTM                          WHBXTM
     I              OMBYTM                          WHBYTM
     I              OMH5NX                          WHH5NX
     I              OMH6NX                          WHH6NX
     I              OMH7NX                          WHH7NX
     I              OMH8NX                          WHH8NX
     I              OMH9NX                          WHH9NX
     I              OMDVPR                          WHDVPR
     I              OMDWPR                          WHDWPR
     I              OMDXPR                          WHDXPR
     I              OMDYPR                          WHDYPR
     I              OMDZPR                          WHDZPR
     I              OMGSPR                          WHGSPR
     I              OMGTPR                          WHGTPR
     I              OMGUPR                          WHGUPR
     I              OMHOST                          WHHOST
     I              OMHPST                          WHHPST
     I              OMIOST                          WHIOST
     I              OMPEWG                          WHPEWG
     I              OMRINY                          WHRINY
     I              OMTIDT                          WHTIDT
     I              OMTJDT                          WHTJDT
     I              OMH2ST                          WHH2ST
     I              OMH0ST                          WHH0ST
     I              OMH1ST                          WHH1ST
     I              OMTKDT                          WHTKDT
     I              OMTLDT                          WHTLDT
     I              OMTMDT                          WHTMDT
     I              OMUVST                          WHUVST
     I              OMUWST                          WHUWST
     I              OMUXST                          WHUXST
     I              OMAATM                          WHAATM
     I              OMAYNA                          WHAYNA
     I              OMA0NA                          WHA0NA
     I              OMAXDT                          WHAXDT
      *
     IYERDCS      DS                            525
     IQOMFL1    E DSOMFLCPL0
      * UPD : Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WJRMNB
     I              FLRUNB                          WJRUNB
     I              FLRVNB                          WJRVNB
     I              FLDQTX                          WJDQTX
     I              FLRWNB                          WJRWNB
     I              FLRXNB                          WJRXNB
     I              FLSQNB                          WJSQNB
     I              FLT0NB                          WJT0NB
     I              FLT1NB                          WJT1NB
     I              FLR1NB                          WJR1NB
     I              FLAIC3                          WJAIC3
     I              FLC4NB                          WJC4NB
     I              FLVCST                          WJVCST
     I              FLKEDT                          WJKEDT
     I              FLSXNB                          WJSXNB
     I              FLKFDT                          WJKFDT
     I              FLACTM                          WJACTM
     I              FLK5TX                          WJK5TX
     I              FLW5CD                          WJW5CD
     I              FLEJDT                          WJEJDT
     I              FLAGTM                          WJAGTM
     I              FLKJDT                          WJKJDT
     I              FLATTM                          WJATTM
     I              FLHDDT                          WJHDDT
     I              FLAUTM                          WJAUTM
     I              FLKKDT                          WJKKDT
     I              FLAVTM                          WJAVTM
     I              FLZ4NB                          WJZ4NB
     I              FLY7ST                          WJY7ST
     I              FLY2ST                          WJY2ST
     I              FLWHTX                          WJWHTX
     I              FLWITX                          WJWITX
     I              FLWJTX                          WJWJTX
     I              FLWKTX                          WJWKTX
     I              FLWLTX                          WJWLTX
     I              FLN7DT                          WJN7DT
     I              FLN8DT                          WJN8DT
     I              FLN9DT                          WJN9DT
     I              FLB3TM                          WJB3TM
     I              FLB4TM                          WJB4TM
     I              FLB5TM                          WJB5TM
     I              FLIASX                          WJIASX
     I              FLIBSX                          WJIBSX
     I              FLICSX                          WJICSX
     I              FLWVTX                          WJWVTX
     I              FLWWTX                          WJWWTX
     I              FLWXTX                          WJWXTX
     I              FLUVST                          WJUVST
     I              FLUWST                          WJUWST
     I              FLUXST                          WJUXST
     I              FLAATM                          WJAATM
     I              FLAYNA                          WJAYNA
     I              FLA0NA                          WJA0NA
     I              FLAXDT                          WJAXDT
      *
     IYFRDCS      DS                            367
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Header TRG
      * I : RST Company Number
     I                                    P   1   20P1AIC3
      * I : RST Order Number
     I                                    P   3   60P1C4NB
      * N :  Customer Purchase Order #
     I                                        7  21 P1BCNA
      * N :  Load ID
     I                                    P  22  250P1RMNB
      * N :  Transfer in Storage Ind
     I                                       26  26 P1FNSX
     IP2PARM      DS
      * FLD: *Arrays
      * N :  Warehouse Code
     I                                        1   3 P2AJCD
      * N :  Application Code
     I                                        4   9 P2DNCD
      * N :  Salesperson Code
     I                                       10  12 P2BCCD
      * N :  Allow Multi-Company
     I                                       13  13 P2I6ST
     IP3PARM      DS
      * N :  Warehouse Location
     I                                        1   1 P3T0ST
     IP4PARM      DS
      * I :  Warehouse Code PASS   USR
     I                                        1   3 P4T3CD
     IP5PARM      DS
      * N :  P.O. Required Flag
     I                                        1   1 P5PPST
     IP6PARM      DS
      * N :  USR Display 1
     I                                        1   1 P6TIST
     IP7PARM      DS
      * N :  Live with TPM
     I                                        1   1 P7O1ST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'CD3 Non numeric data'
      * Message data for 'CD7 Non numeric data'
      * Message data for 'Transf/Storage & Warehous'
      * Warehouse Code
     I                                        1   3 ZA0001
      * Message data for 'P.O. Required'
      * Customer Purchase Order #
     I                                        1  15 ZA0002
      * Message data for 'PO # is duplicate-INF'
      * Customer Purchase Order #
     I                                        1  15 ZA0003
      * Message data for 'Notifiy Traff-Delv PO chg'
      * USR 15 Text           USR
     I                                        1  15 ZA0004
      * Message data for 'Type Code Not Found'
      * Type Code
     I                                        1   2 ZA0005
      * Message data for 'Type Code Not Found'
      * Type Code
     I                                        1   2 ZA0006
      * Message data for 'Spot Buy S/T/P Required'
      * Spot Buy  (Y/N)
     I                                        1   1 ZA0007
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0008
      * Application Code
     I                                       11  16 ZA0009
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0010
      * Application Code
     I                                       11  16 ZA0011
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P4T3CD    PARM           WP0003  3        Warehouse Code
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Check passed parameters
     C                     EXSR FACKPM
      * Perform once if all passed, else repeat
     C           W0RPT     DOUEQ'N'
      * Display and process key screen
     C                     EXSR BADSKY
     C                     END
      * Terminate program
     C                     EXSR ZXEXPG
      *****************************************************************
      /EJECT
     CSR         BADSKY    BEGSR
      *================================================================
      * Display and process key screen
      *================================================================
      * Bypass first display of key screen is possible
     C                     MOVEL'Y'       W0BYP   1
      * Initialize key screen
     C                     EXSR MDIZ#K
      * Signal start of transaction
     C                     MOVEL'Y'       W0TRN   1
     C           W0TRN     DOWEQ'Y'
     C           W0TRN     OREQ 'K'
      * Ensure transaction continues (if reset)
     C                     MOVEL'Y'       W0TRN   1
      * Conduct screen conversation
     C           W0TRN     DOWEQ'Y'
      * Convert internal to external form
     C                     EXSR MNCV#K
      * Is bypass key screen still viable?
     C           W0BYP     IFEQ 'Y'
     C           #1AIC3    IFEQ *ZERO                      Company Number
     C           #1C4NB    OREQ *ZERO                      Order Number
      * One or more key fields is blank
     C           *IN30     OREQ '1'
      * HOME: Reset screen fields
     C                     MOVEL'N'       W0BYP
     C                     END
     C                     END
      * Bypass key screen
     C           W0BYP     IFEQ 'N'
      * Display key screen
     C                     EXSR BBEXFM
     C                     END
      * Cancel key screen bypass
     C                     MOVEL'N'       W0BYP
      * Process response to key screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            BDHMKY
      * Process key screen input
     C                     CAS            BEPRKY
     C                     END
     C           W0TRN     DOWEQ'R'
     C                     MOVEL'Y'       W0TRN
     C                     EXSR BEPRKY
     C                     END
      *
     C                     END
     C                     END
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBEXFM    BEGSR
      *================================================================
      * Display key screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSAK
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDKEY
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1
      * Reset global error indicator
     C                     SETOF                         99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         BDHMKY    BEGSR
      *================================================================
      * Process HOME key
      *================================================================
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         BDEXIT    ENDSR
      /EJECT
     CSR         BEPRKY    BEGSR
      *================================================================
      * Process key screen input
      *================================================================
      * Initialise detail screen
     C                     EXSR MAIZ#1
      * Validate key fields
     C                     EXSR BFVLKY
     C           *IN99     CABEQ'1'       BEEXIT
     C           YPMTFD    CABNE*BLANKS   BEEXIT
      * Check for existing record
     C           KRTV      KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    BEAIC3
     C                     Z-ADD#1C4NB    BEC4NB
     C           KRTV      CHAIN@BECPFK              9091  *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     SETON                     993132*
     C                     GOTO BEEXIT
     C                     END                             FI 91
      *
      * If record does not exist, error
     C           *IN90     IFEQ '1'
     C                     SETON                     993132*
      * Send message 'Order Header TRG       NF'
     C                     MOVEL'USR0176' ZAMSID
     C                     EXSR ZASNMS
     C                     ELSE
     C                     EXSR MBFL#1
      * CALC: Detail screen function fields
     C                     MOVEL*BLANK    #DSQTX           Company Name DR
      * Company Name DRV
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0001           Company Number
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #DSQTX    P      Name
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Sales Route Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#1R4CD'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Active Salesperson SR - Salesperson  * 
     C                     CALL 'CABYSRR'              90  SEL Active Sale
     C                     PARM *BLANK    W0RTN   7
     C           #1R4CD    PARM #1R4CD    WQ0001  3        Salesperson Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CABYSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * F4=TYPE CODE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Type Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DBOCD'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Type Codes         SR - Type Codes  * 
     C                     CALL 'CABVSRR'              90  SEL Type Codes
     C                     PARM *BLANK    W0RTN   7
     C           #DBOCD    PARM #DBOCD    WQ0002  2        Type Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CABVSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9939  *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * USER: Initialize detail screen (existing record)
      * * Save original values. If changed, flag to send to MG  E004119
      * CASE: LCL.Company Organization is High Plains Biodiesel
     C           YL0001    IFEQ 'H'                        *IF
     C                     MOVEL@CN,001   #DSLTX           Text USR 20
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL@CN,002   #DSLTX           Text USR 20
     C                     END                             *FI
     C                     MOVEL*BLANK    #DSQTX           Company Name DR
      * Company Name DRV
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0001           Company Number
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #DSQTX    P      Name
      * rtv salesperson
      * CASE: DTL.Sales Route Code is entered
     C           #1R4CD    IFNE *BLANK                     *IF
      * RTV Salesperson        RT - Salesperson  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1R4CD    WL0003    P      Salesperson Cod
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    #DALTX    P      Salesperson Nam
      * 04/13/18 DN S12917-To Save Original Sales Route.
     C                     MOVEL#1R4CD    YL0002           Sales Route Cod
     C                     END                             *FI
      * transfer in storage
      * CASE: DTL.Transfer in Storage Ind is No
     C           #1FNSX    IFEQ 'N'                        *IF
     C                     MOVEL#1FNSX    P1FNSX           Transfer in Sto
     C                     END                             *FI
     C                     MOVEL#1FNSX    WUFNSX           Transfer in Sto
     C                     MOVEL#1JPCD    WUOIST           Event Type
      * DTL.Condition Desc. 1  USR = Condition name of WRK.Event Type
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1167951   Y2LSNO  70       List number
     C                     PARM WUOIST    W0INVL 25        Event Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHLTX    PARM           W0CNNM 25        Condition Desc.
      *
     C                     MOVEL*BLANK    WULMT1           Delivery P.O. N
     C                     MOVEL#DNLTX    WULMT1           Delivery P.O. N
      * RMC PFS017 Save to check for change  6/6/6
     C                     MOVELBEBCNA    P1BCNA           Customer Purcha
     C                     MOVELBEBCNA    WUBCNA           Customer Purcha
      * ** Rtv the Delivery P.O. from OHE file  AND HPB RIN Equiv Value 7
      * ** Rtv the appt fields too  9/16/11 e1714 rmc
      * RTV HPB Equiv/dlv po RT - Order Header Extension  * 
     C                     EXSR SCRVGN
     C                     MOVELYL0003    #DBOCD           Type Code
     C                     MOVELWULMT1    #DNLTX           USR 15 Text
     C                     MOVEL#DNLTX    YL0004           USR 15 Text
      * RTV Carr Appt Dt/Tm   RT - Load Detail  * 
     C                     EXSR SDRVGN
      * E2436 2/13/13 RMC Show OHE Type if company is 360/960/369
      * CASE:
      *  - c1ORc2ORc3
      *   |- c1    : LCL.Company Organization is Seaboard
      *   |- c2    : DB1.Company Number is HPB Biodiesel
      *   |- c3    : DB1.Company Number is St Joseph HPB Marketing
      *   '-
     C           YL0001    IFEQ 'S'                        *IF
     C           BEAIC3    OREQ 369                        *OR
     C           BEAIC3    OREQ 374                        *OR
     C                     MOVEL'Y'       P6TIST           USR Display 1
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       P6TIST           USR Display 1
     C                     END                             *FI
     C                     MOVELBEFVSX    #1FVSX           OH Load Plan Re
      * DTL.Condition Desc. 2  USR = Condition name of DTL.OH Load Plan R
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1575060   Y2LSNO  70       List number
     C                     PARM #1FVSX    W0INVL 25        OH Load Plan Re
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHMTX    PARM           W0CNNM 25        Condition Desc.
      *
      * RTV Ltr of Crdt - 1st  RT - Order Header Extension  * 
     C                     EXSR SERVGN
     C                     MOVELWUWDT1    #DAKU1           String 30
      * W77844 DN 06/12/21-Convert Old Spot Buy Flag Value to New Val: S,
      * Spot buy
      * CASE: DTL.OHE Spot Buy is Spot
     C           #DC3TX    IFEQ 'S'                        *IF
     C                     MOVEL'S'       #DSPOT           Spot Buy  (Y/N)
      * DTL.Spot Buy Text USR = Condition name of DTL.Spot Buy  (Y/N)
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 2090094   Y2LSNO  70       List number
     C                     PARM #DSPOT    W0INVL 25        Spot Buy  (Y/N)
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DQIU1    PARM           W0CNNM 25        Spot Buy Text U
      *
     C                     ELSE
      * CASE: DTL.OHE Spot Buy is Turn
     C           #DC3TX    IFEQ 'T'                        *IF
     C                     MOVEL'T'       #DSPOT           Spot Buy  (Y/N)
      * DTL.Spot Buy Text USR = Condition name of DTL.Spot Buy  (Y/N)
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 2090094   Y2LSNO  70       List number
     C                     PARM #DSPOT    W0INVL 25        Spot Buy  (Y/N)
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DQIU1    PARM           W0CNNM 25        Spot Buy Text U
      *
     C                     ELSE
      * CASE: DTL.OHE Spot Buy is Promo
     C           #DC3TX    IFEQ 'P'                        *IF
     C                     MOVEL'P'       #DSPOT           Spot Buy  (Y/N)
      * DTL.Spot Buy Text USR = Condition name of DTL.Spot Buy  (Y/N)
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 2090094   Y2LSNO  70       List number
     C                     PARM #DSPOT    W0INVL 25        Spot Buy  (Y/N)
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DQIU1    PARM           W0CNNM 25        Spot Buy Text U
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.Company Organization is Seaboard
     C           YL0001    IFEQ 'S'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'T'       #DSPOT           Spot Buy  (Y/N)
     C                     MOVEL*BLANK    #DC3TX           OHE Spot Buy
     C                     MOVEL'T'       #DC3TX           OHE Spot Buy
      * DTL.Spot Buy Text USR = Condition name of DTL.OHE Spot Buy
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1279264   Y2LSNO  70       List number
     C                     PARM #DC3TX    W0INVL 25        OHE Spot Buy
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DQIU1    PARM           W0CNNM 25        Spot Buy Text U
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      *
      *..................................................
     C   99                GOTO BEEXIT
      *
     C           YPMTFD    IFEQ *BLANK
      * No error: Display and process details
     C                     EXSR CADSDA
     C                     END
      *
      *================================================================
     CSR         BEEXIT    ENDSR
      /EJECT
     CSR         BFVLKY    BEGSR
      *================================================================
      * Validate key fields
      *================================================================
      * Validate Company Number and convert to internal.
      * CD3 Ext/Int
     C                     MOVELV1AIC3    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC3  3
     C                     MOVEA*BLANKS   K3
     C                     Z-ADD3         C       30
     C                     Z-ADD3         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUDMCD    J3
     C                     MOVE *BLANKS   W0RTN
     C                     DO   3
     C           J3,C      IFNE ' '
     C                     MOVEAJ3,C      K3,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK3        JUSTC3
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC3    TESTC   1
     C           TESTC     IFGT '?'
     C           TESTC     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC3     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC3    WUDMCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,003                    *IF
      * Setup message data for message
      * Send message 'CD3 Non numeric data'
     C                     MOVEL'USR0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #1AIC3           CD3 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUDMCD    #1AIC3           CD3 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Order Number and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV1C4NB    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,003                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #1C4NB           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #1C4NB           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
     C           YPMTFD    IFNE *BLANK
      * Select existing record
     C                     EXSR VACKRL
     C                     END
      * Check relations
      * Check reference to Company Name and Address
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9931  *
     C                     END
      * Company Number required
     C           #1AIC3    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Order Number required
     C           #1C4NB    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9932  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         BFEXIT    ENDSR
      /EJECT
     CSR         CADSDA    BEGSR
      *================================================================
      * Display and process detail screen
      *================================================================
      * Conduct detail screen conversation
      * - repeat until screen control flag is reset:
     C           W0TRN     DOWEQ'Y'
      * Convert internal to external form
     C                     EXSR MOCV#D
      * Display detail screen
     C                     EXSR CBEXFM
      * Process response to detail screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * Redisplay previous screen
     C   12                CAS            CCDSPV
      * HOME: Reset screen fields
     C   30                CAS            CCDSPV
      * Process detail screen input
     C                     CAS            CFPRSC
     C                     END
     C           W0TRN     IFEQ 'R'
     C           W0PMD     IFEQ 'ADD'
     C                     EXSR MAIZ#1
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         CBEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y1SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT2
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1
      * Reset global error indicator
     C                     SETOF                         99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CBEXIT    ENDSR
      /EJECT
     CSR         CCDSPV    BEGSR
      *================================================================
      * Redisplay previous screen
      *================================================================
     C   30                MOVEL'R'       W0TRN
     C   12                MOVEL'K'       W0TRN
      *================================================================
     CSR         CCEXIT    ENDSR
      /EJECT
     CSR         CFPRSC    BEGSR
      *================================================================
      * Validate record
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate details
     C                     EXSR DCVLDL
      * QUIT if error:
     C   99                GOTO CFEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       CFEXIT
      * Prompt for confirmation
     C                     EXSR EAPMCF
      * Quit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO CFEXIT
     C                     END
      * No error: update record
     C                     EXSR EBPR##
      *================================================================
     CSR         CFEXIT    ENDSR
      /EJECT
     CSR         DCVLDL    BEGSR
      *================================================================
      * Validate details
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
     C           YPMTFD    IFEQ *BLANKS
      * Initialise derived fields
     C                     EXSR MFIZ#2
     C                     END
      * Validate Transfer in Storage Ind
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1FNSX'  IFEQ YPMTFD
      * Transfer in Storage Ind
     C                     MOVEL#1FNSX    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHFNSX
     C                     SELEC
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD1         ZHFNSX
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD2         ZHFNSX
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD3         ZHFNSX
     C                     ENDSL
     C                     EXFMTZGFNSX
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHFNSX    WHEQ 1
     C                     MOVEL'Y'       W0INVL           Y
     C           ZHFNSX    WHEQ 2
     C                     MOVEL'N'       W0INVL           N
     C           ZHFNSX    WHEQ 3
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1FNSX
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Spot Buy  (Y/N)
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DSPOT'  IFEQ YPMTFD
      * Spot Buy  (Y/N)
     C                     MOVEL#DSPOT    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHSPOT
     C                     SELEC
     C           W0INVL    WHEQ 'S'                        S
     C                     Z-ADD1         ZHSPOT
     C           W0INVL    WHEQ 'T'                        T
     C                     Z-ADD2         ZHSPOT
     C           W0INVL    WHEQ 'P'                        P
     C                     Z-ADD3         ZHSPOT
     C                     ENDSL
     C                     EXFMTZGSPOT
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHSPOT    WHEQ 1
     C                     MOVEL'S'       W0INVL           S
     C           ZHSPOT    WHEQ 2
     C                     MOVEL'T'       W0INVL           T
     C           ZHSPOT    WHEQ 3
     C                     MOVEL'P'       W0INVL           P
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DSPOT
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate OH Appt Confirmation Dt
      * External date
     C                     Z-ADDV1NODT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9943  *
     C                     END
     C                     Z-ADDXDINDT    #1NODT
      * Validate OH Appt Confirmation Tm
     C                     Z-ADD#1BRTM    XTTIM
      * Check time
     C                     EXSR XTCKTM
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9944  *
     C                     END
      * Validate LD Carrier Appt Date
      * External date
     C                     Z-ADDVDN7DT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9945  *
     C                     END
     C                     Z-ADDXDINDT    #DN7DT
      * Validate LD Carrier Appt Time
     C                     Z-ADD#DB3TM    XTTIM
      * Check time
     C                     EXSR XTCKTM
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9946  *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate detail screen fields
      * RMC: F17=Export Docs
      * CASE: DTL.*CMD key is CF17
     C           *IN17     IFEQ '1'                        *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
      * CASE: DTL.Export Status is yes
     C           #1U2ST    IFEQ 'Y'                        *IF
      * RTV Country Code only  RT - Order Detail  * 
     C                     EXSR SFRVGN
     C                     MOVEL*BLANK    WUBYVN           Next Program Na
     C                     MOVEL'POIRXFR' WUBYVN           Next Program Na
      * DO WHILE: WRK.Next Program Name is Export Document Data
     C           WUBYVN    DOWEQ@CN,004                    *DOW
      * Edt Export Document   XF - Export Doc Order Hdr  * 
     C                     CALL 'POIRXFR'              90  Edt Export Docu
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0006  30       Company Number
     C                     PARM #1C4NB    WQ0007  70       Order Number
     C                     PARM WUKXCD    WQ0008  6        Country Code
     C           WUBYVN    PARM WUBYVN    WQ0009 10        Next Program Na
     C                     PARM P4T3CD    WQ0010  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POIRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *ITR
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Function key not allowed'
     C                     MOVEL'USR1833' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * F3=Exit without update
      * CASE: DTL.*CMD key is *Exit
     C           *IN03     IFEQ '1'                        *IF
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     END
      * Check relations
      * Check reference to Order Types
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Customer
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Customer
     C                     EXSR VECKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to State
     C                     EXSR VFCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Customer
     C                     EXSR VGCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to State
     C                     EXSR VHCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Calendar
     C                     EXSR VICKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Calendar
     C                     EXSR VJCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Calendar
     C                     EXSR VKCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Calendar
     C                     EXSR VLCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Terms
     C                     EXSR VMCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Carrier
     C                     EXSR VNCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to OP Reason Codes
     C                     EXSR VOCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Calendar
     C                     EXSR VPCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to User Profile Control
     C                     EXSR VQCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Calendar
     C                     EXSR VRCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Enterprise Master
     C                     EXSR VSCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Load Header
     C                     EXSR VTCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Sales Route
     C                     EXSR VUCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9931  *
     C                     END
      * Check reference to Manager Level
     C                     EXSR VVCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to VP Level
     C                     EXSR VWCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Order Header TRG
     C                     EXSR VXCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Internal Reason
     C                     EXSR VYCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Calendar
     C                     EXSR VZCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Event Types
     C                     EXSR WACKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to A/R Claim
     C                     EXSR WBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Detail screen function fields
     C                     MOVEL*BLANK    #DSQTX           Company Name DR
      * Company Name DRV
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0001           Company Number
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #DSQTX    P      Name
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Sales Route Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#1R4CD'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Active Salesperson SR - Salesperson  * 
     C                     CALL 'CABYSRR'              90  SEL Active Sale
     C                     PARM *BLANK    W0RTN   7
     C           #1R4CD    PARM #1R4CD    WQ0036  3        Salesperson Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CABYSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * F4=TYPE CODE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.Type Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DBOCD'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Type Codes         SR - Type Codes  * 
     C                     CALL 'CABVSRR'              90  SEL Type Codes
     C                     PARM *BLANK    W0RTN   7
     C           #DBOCD    PARM #DBOCD    WQ0037  2        Type Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CABVSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9939  *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate detail screen relations
      * Get Salesperson Name - 04/13/18 DN S12917
      * CASE: DTL.Sales Route Code is entered
     C           #1R4CD    IFNE *BLANK                     *IF
      * RTV Salesperson        RT - Salesperson  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1R4CD    WL0003    P      Salesperson Cod
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    #DALTX    P      Salesperson Nam
     C                     END                             *FI
      * Warehouse Edit for TIS Indicator
      * CASE: DTL.Transfer in Storage Ind is Yes
     C           #1FNSX    IFEQ 'Y'                        *IF
      * CASE: DTL.Transfer in Storage Ind EQ PAR.Transfer in Storage Ind
     C           #1FNSX    IFEQ P1FNSX                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * -----------------------------------------------------------------
      * RTV Warehouse Type     RT - Warehouse  * 
     C                     EXSR SGRVGN
      * CASE: LCL.Warehouse Type is Frozen
     C           YL0007    IFEQ 'FZ'                       *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVELP4T3CD    ZA0001           Warehouse Code
      * Send message 'Transf/Storage & Warehous'
     C                     MOVEL'USR2867' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * -----------------------------------------------------------------
     C                     END                             *FI
     C                     END                             *FI
      * validate PO# required
      * CASE: DTL.Customer Purchase Order # is Blank
     C           #1BCNA    IFEQ *BLANK                     *IF
      * RTV P.O. Required Flag RT - Company Customer  * 
     C                     EXSR SHRVGN
      * CASE: PAR.P.O. Required Flag is yes
     C           P5PPST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1BCNA    ZA0002           Customer Purcha
      * Send message 'P.O. Required'
     C                     MOVEL'USR1243' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    WUJ1TX           BLANK 1
      * Check for duplicate P.O # - if not changed as of 6/6/6 RMC
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DTL.Customer Purchase Order # NE WRK.BLANK 1
      *   |- c2    : DTL.Customer Purchase Order # NE PAR.Customer Purcha
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1BCNA    IFNE WUJ1TX                     *IF
     C           #1BCNA    IFNE P1BCNA                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Co,Cust,PO         RT - Order Header TRG  * 
     C                     EXSR SIRVGN
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ @CN,005                    *IF
      * informational message was getting lost; get error message 1st tim
      *     allow update
      * Setup message data for message
     C                     MOVEL#1BCNA    ZA0003           Customer Purcha
      * Send message 'PO # is duplicate-INF'
     C                     MOVEL'USR2869' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
      * Notify Traffic of Delvery PO# chg
      * CASE: LCL.USR 15 Text           USR NE DTL.USR 15 Text
     C           YL0004    IFNE #DNLTX                     *IF
      * CASE: LCL.Company Organization is Not HPB
     C           YL0001    IFEQ 'D'                        *IF
     C           YL0001    OREQ 'S'
      * Setup message data for message
     C                     MOVEL#DNLTX    ZA0004           USR 15 Text
      * Send message 'Notifiy Traff-Delv PO chg'
     C                     MOVEL'USR4102' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    WULMT1           Delivery P.O. N
     C                     MOVEL#DNLTX    WULMT1           Delivery P.O. N
      * Validate Type code for HPB  and foods
      * CASE:
      *  - c1ORc2
      *   |- c1    : LCL.Company Organization is High Plains Biodiesel
      *   |- c2    : LCL.Company Organization is Seaboard
      *   '-
     C           YL0001    IFEQ 'H'                        *IF
     C           YL0001    OREQ 'S'                        *OR
      * Validate
      * CASE: DTL.Type Code is Entered
     C           #DBOCD    IFNE *BLANK                     *IF
      * Val Type Codes         RT - Type Codes  * 
     C                     EXSR SJRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,006                    *IF
      * Setup message data for message
     C                     MOVEL#DBOCD    ZA0005           Type Code
      * Send message 'Type Code Not Found'
     C                     MOVEL'USR3388' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DBOCD    ZA0006           Type Code
      * Send message 'Type Code Not Found'
     C                     MOVEL'USR3388' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * W77844 DN 06/12/21-Convert Old Spot Buy Flag Value to New Val: S,
      * Spot buy                           W77844 DN 06/12/21-Use New Val
      * CASE: DTL.Spot Buy  (Y/N) is Spot
     C           #DSPOT    IFEQ 'S'                        *IF
     C                     MOVEL*BLANK    #DC3TX           OHE Spot Buy
     C                     MOVEL'S'       #DC3TX           OHE Spot Buy
      * DTL.Spot Buy Text USR = Condition name of DTL.OHE Spot Buy
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1279264   Y2LSNO  70       List number
     C                     PARM #DC3TX    W0INVL 25        OHE Spot Buy
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DQIU1    PARM           W0CNNM 25        Spot Buy Text U
      *
     C                     ELSE
      * CASE: DTL.Spot Buy  (Y/N) is Turn
     C           #DSPOT    IFEQ 'T'                        *IF
     C                     MOVEL*BLANK    #DC3TX           OHE Spot Buy
     C                     MOVEL'T'       #DC3TX           OHE Spot Buy
      * DTL.Spot Buy Text USR = Condition name of DTL.OHE Spot Buy
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1279264   Y2LSNO  70       List number
     C                     PARM #DC3TX    W0INVL 25        OHE Spot Buy
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DQIU1    PARM           W0CNNM 25        Spot Buy Text U
      *
     C                     ELSE
      * CASE: DTL.Spot Buy  (Y/N) is Promo
     C           #DSPOT    IFEQ 'P'                        *IF
     C                     MOVEL*BLANK    #DC3TX           OHE Spot Buy
     C                     MOVEL'P'       #DC3TX           OHE Spot Buy
      * DTL.Spot Buy Text USR = Condition name of DTL.OHE Spot Buy
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1279264   Y2LSNO  70       List number
     C                     PARM #DC3TX    W0INVL 25        OHE Spot Buy
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DQIU1    PARM           W0CNNM 25        Spot Buy Text U
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.Company Organization is Seaboard
     C           YL0001    IFEQ 'S'                        *IF
     C                     MOVEL*BLANK    #DC3TX           OHE Spot Buy
     C                     MOVEL*BLANK    #DQIU1           Spot Buy Text U
      * Setup message data for message
     C                     MOVEL#DSPOT    ZA0007           Spot Buy  (Y/N)
      * Send message 'Spot Buy S/T/P Required'
     C                     MOVEL'USR4747' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #DC3TX           OHE Spot Buy
     C                     MOVEL'T'       #DC3TX           OHE Spot Buy
      * DTL.Spot Buy Text USR = Condition name of DTL.OHE Spot Buy
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1279264   Y2LSNO  70       List number
     C                     PARM #DC3TX    W0INVL 25        OHE Spot Buy
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DQIU1    PARM           W0CNNM 25        Spot Buy Text U
      *
     C                     MOVEL'T'       #DSPOT           Spot Buy  (Y/N)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * letter of credit                                      E004119
      * CASE: DTL.String 30 is Not Blank
     C           #DAKU1    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    WUWDT1           Letter of Credi
     C                     MOVEL#DAKU1    WUWDT1           Letter of Credi
     C                     END                             *FI
     C                     MOVEL'CEO'     YL0008           Pricing Event C
     C                     END
      * Transfer in Storage Ind required
     C           #1FNSX    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9936  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         EAPMCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert internal to external form
     C                     EXSR MOCV#D
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Update screen time
     C                     TIME           ##TME
      * Refresh screen
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT2
     C                     WRITE#RCDDTL1
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO EAEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPR##    BEGSR
      *================================================================
      * Process record:
      *================================================================
      * Process update request
     C           W0PMD     CASNE'ADD'     EECHRQ
     C                     END
     C           W0RTN     IFEQ *BLANK
      * Restart program for next record
     C                     MOVEL'N'       W0TRN
     C                     END
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         EECHRQ    BEGSR
      *================================================================
      * Process update request
      *================================================================
      * USER: Change DBF record
      * CHG Locked Order       CH - Order Header TRG  * 
     C                     EXSR SKCHRC
     C           W0RTN     IFNE *BLANK
      * Data update error
      * Reset screen fields if changed record
     C           W0RTN     CASEQ'Y2U0007' MBFL#1
     C                     END
     C                     ELSE
     C           YARDC     IFEQ 'Y'
      * Send message '*Record changed'
     C                     MOVEL'Y2U0012' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *================================================================
     CSR         EEEXIT    ENDSR
      /EJECT
     CSR         FACKPM    BEGSR
      *================================================================
      * Check passed parameters
      *================================================================
      * Is full key present?
     C           P1AIC3    IFEQ *ZERO                      Company Number
     C           P1C4NB    OREQ *ZERO                      Order Number
      * Not every key field passed - loop program
     C                     MOVEL'Y'       W0RPT   1
     C                     ELSE
      * Full key passed, so single shot program
     C                     MOVEL'N'       W0RPT
     C                     END
      *================================================================
     CSR         FAEXIT    ENDSR
      /EJECT
     CSR         GADSAK    BEGSR
      *================================================================
      * Set key screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSAD    BEGSR
      *================================================================
      * Set detail screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      * Protect key fields on detail screen
     C                     SETON                     88    *
     C                     MOVEL'0'       *IN79
     C                     MOVEL'0'       *IN76
     C           P1AIC3    IFNE 369                        *IF
     C                     MOVEL'1'       *IN79
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C                     MOVEL'0'       *IN78
     C           P6TIST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN77
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN75
     C           P7O1ST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN75
     C                     END                             *FI
     C           W0RPT     IFEQ 'N'
      * Disable key screen - not applicable
     C                     SETOF                     87    *
     C                     ELSE
      * Enable key screen
     C                     SETON                     87    *
     C                     END
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise record - except for key fields and "neither" paramete
      *================================================================
     C                     MOVEL*BLANK    #1JNCD           Order Type - Sa
     C                     Z-ADD*ZERO     #1ANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     #1BKC7           Ship To Custome
     C                     MOVEL*BLANK    #1BRTX           Ship To Name
     C                     MOVEL*BLANK    #1HMNA           Ship To Address
     C                     MOVEL*BLANK    #1HONA           Ship To Address
     C                     MOVEL*BLANK    #1HPNA           Ship To Address
     C                     MOVEL*BLANK    #1HNNA           Ship To City
     C                     MOVEL*BLANK    #1DBCD           Ship To State C
     C                     MOVEL*BLANK    #1CKTX           Ship To Zip/Pos
     C                     Z-ADD*ZERO     #1B0C7           Bill to Custome
     C                     MOVEL*BLANK    #DAYTX           Customer Name
     C                     MOVEL*BLANK    #1AETX           Bill to Name
     C                     MOVEL*BLANK    #1B1NA           Bill to Address
     C                     MOVEL*BLANK    #1B3NA           Bill to Address
     C                     MOVEL*BLANK    #1B4NA           Bill to Address
     C                     MOVEL*BLANK    #1B2NA           Bill to City
     C                     MOVEL*BLANK    #1BHCD           Bill to State C
     C                     MOVEL*BLANK    #1C8TX           Bill to Zip/Pos
     C                     Z-ADD*ZERO     #1A0DT           Order Date
     C                     Z-ADD*ZERO     #1A5DT           Requested Ship
     C                     Z-ADD*ZERO     #1GNDT           Actual Shipped
     C                     Z-ADD*ZERO     #1ACDT           Cancel Date
     C                     MOVEL*BLANK    #1AQCD           Terms Code
     C                     MOVEL*BLANK    #1BZNA           Carrier Code
     C                     MOVEL*BLANK    #1GTST           Comment Print A
     C                     MOVEL*BLANK    #1GVST           Comment Print I
     C                     MOVEL*BLANK    #1GUST           Comment Print P
     C                     MOVEL*BLANK    #1QFST           Comment Print S
     C                     MOVEL*BLANK    #1CQCD           Reason Code
     C                     MOVEL*BLANK    #1GJST           Order in Use
     C                     MOVEL*BLANK    #1GWST           Header Status
     C                     MOVEL*BLANK    #1GXST           Header Status L
     C                     MOVEL*BLANK    #1GYST           Order Type Prin
     C                     Z-ADD*ZERO     #1AODT           Scheduled Ship
     C                     MOVEL*BLANK    #1AIVN           User Original E
     C                     Z-ADD*ZERO     #1CXDT           Date of Origina
     C                     Z-ADD*ZERO     #1JZVA           Order Value Tot
     C                     Z-ADD*ZERO     #1A1WG           Order Weight To
     C                     MOVEL*BLANK    #1XIST           Credit Hold
     C                     MOVEL*BLANK    #1XJST           Production Hold
     C                     MOVEL*BLANK    #1XKST           New Customer Ho
     C                     MOVEL*BLANK    #1E8CD           Accounts Receiv
     C                     MOVEL*BLANK    #1E9CD           Accounts Receiv
     C                     Z-ADD*ZERO     #1TBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     #1R1NB           Rated Freight
     C                     MOVEL*BLANK    #1PJST           LTL Flag
     C                     MOVEL*BLANK    #1U0ST           Price Audit
     C                     MOVEL*BLANK    #1U1ST           Price Status
     C                     MOVEL*BLANK    #1Q2CD           Shipping Method
     C                     MOVEL*BLANK    #1U2ST           Export Status
     C                     MOVEL*BLANK    #1VEST           Palletize
     C                     MOVEL*BLANK    #1VFST           Shrink Wrap
     C                     MOVEL*BLANK    #1VGST           Slip Sheet
     C                     MOVEL*BLANK    #1RPCD           Age Code
     C                     Z-ADD*ZERO     #1RNNB           Reefer Temperat
     C                     MOVEL*BLANK    #1VDST           Load Type
     C                     Z-ADD*ZERO     #1ATIN           Attach to Invoi
     C                     MOVEL*BLANK    #1U4ST           Load Plan Order
     C                     MOVEL*BLANK    #1U5ST           Print Pick Slip
     C                     Z-ADD*ZERO     #1RSRN           Resell Referenc
     C                     MOVEL*BLANK    #1MHNA           Special Comment
     C                     MOVEL*BLANK    #1MINA           Special Comment
     C                     MOVEL*BLANK    #1WBST           Affect Auto Acc
     C                     MOVEL*BLANK    #1BFCD           Manager Level C
     C                     MOVEL*BLANK    #1Q4CD           VP Level Code
     C                     Z-ADD*ZERO     #1T3NB           Attach to Order
     C                     MOVEL*BLANK    #1SICD           Reason for Pric
     C                     Z-ADD*ZERO     #1CONB           Invoice Number
     C                     MOVEL*BLANK    #1CEST           Invoice Suffix
     C                     Z-ADD*ZERO     #1AWDT           Invoice Date
     C                     MOVEL*BLANK    #1XUST           Trans Contol AS
     C                     MOVEL*BLANK    #1Z1ST           Modified Flag
     C                     Z-ADD*ZERO     #1VRVA           A/R order Value
     C                     MOVEL*BLANK    #1OBST           Billing Activit
     C                     MOVEL*BLANK    #1BCST           Block Order Fla
     C                     MOVEL*BLANK    #1BDST           Order Certifica
     C                     Z-ADD*ZERO     #1B7VL           Invoice Order V
     C                     MOVEL*BLANK    #1GASX           Process Sts for
     C                     MOVEL*BLANK    #1GBSX           Order Conf Fax
     C                     MOVEL*BLANK    #1GCSX           Manifest Fax St
     C                     MOVEL*BLANK    #1GDSX           Invoice Fax Sts
     C                     MOVEL*BLANK    #DC3TX           OHE Spot Buy
     C                     MOVEL*BLANK    #1FOSX           Email Cust On O
     C                     MOVEL*BLANK    #1FPSX           Order Emailed
     C                     MOVEL*BLANK    #1FQSX           Export Docs Go
     C                     MOVEL*BLANK    #1FRSX           Shipping Temp C
     C                     MOVEL*BLANK    #1FSSX           Broker Order St
     C                     MOVEL*BLANK    #1FTSX           Air Freight Ord
     C                     MOVEL*BLANK    #1FUSX           Order Requires
     C                     MOVEL*BLANK    #1FWSX           Export USDA App
     C                     MOVEL*BLANK    #1FXSX           HPB Ship to War
     C                     MOVEL*BLANK    #1FYSX           OH TF Exempt Co
     C                     Z-ADD*ZERO     #1NPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     #1NQDT           Load Actual Shi
     C                     Z-ADD*ZERO     #1NRDT           Load BOL Comple
     C                     Z-ADD*ZERO     #1NSDT           Load Truck Depa
     C                     Z-ADD*ZERO     #1BPTM           Maximum Gross W
     C                     Z-ADD*ZERO     #1BQTM           Time of Origina
     C                     Z-ADD*ZERO     #1BSTM           Load BOL Comple
     C                     Z-ADD*ZERO     #1BTTM           Load Truck Depa
     C                     Z-ADD*ZERO     #1H0NX           Act Frt Referen
     C                     Z-ADD*ZERO     #1H1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     #1H2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     #1H3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     #1H4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     #1C0C7           Claim Number
     C                     MOVEL*BLANK    #1UVST           EDI Status 1
     C                     MOVEL*BLANK    #1UWST           EDI Status 2
     C                     MOVEL*BLANK    #1UXST           EDI Status 3
     C                     Z-ADD*ZERO     #1AATM           Job Time
     C                     MOVEL*BLANK    #1AYNA           User Id
     C                     MOVEL*BLANK    #1A0NA           Job Name
     C                     Z-ADD*ZERO     #1AXDT           Job Date
     C                     MOVEL*BLANK    #DSQTX           Company Name DR
     C                     Z-ADD*ZERO     #1RMNB           Load ID
     C                     MOVEL*BLANK    #1JPCD           Event Code
     C                     MOVEL*BLANK    #DHLTX           Condition Desc.
     C                     MOVEL*BLANK    #1FVSX           OH Load Plan Re
     C                     MOVEL*BLANK    #DHMTX           Condition Desc.
     C                     Z-ADD*ZERO     #1EIDT           Requested Deliv
      * Clear external version also
     C                     Z-ADD*ZERO     V1EIDT
     C                     Z-ADD*ZERO     #1AFTM           Requested Deliv
     C                     MOVEL*BLANK    #1R4CD           Sales Route Cod
     C                     MOVEL*BLANK    #DALTX           Salesperson Nam
     C                     MOVEL*BLANK    #1BCNA           Customer Purcha
     C                     MOVEL*BLANK    #DNLTX           USR 15 Text
     C                     MOVEL*BLANK    #1B6NA           Special Instruc
     C                     MOVEL*BLANK    #1BYNA           Special Instruc
     C                     MOVEL*BLANK    #1FNSX           Transfer in Sto
     C                     MOVEL*BLANK    #DSPOT           Spot Buy  (Y/N)
     C                     MOVEL*BLANK    #DQIU1           Spot Buy Text U
     C                     Z-ADD*ZERO     #DHEVL           OHE HPB RIN Equ
     C                     MOVEL*BLANK    #DSLTX           Text USR 20
     C                     MOVEL*BLANK    #DBOCD           Type Code
     C                     Z-ADD*ZERO     #DHFVL           OHE HPB RIN Pri
     C                     MOVEL*BLANK    #DV5T1           OHE Appt Confir
     C                     MOVEL*BLANK    #DWBT1           OHE Appt Confir
     C                     Z-ADD*ZERO     #1NODT           OH Appt Confirm
      * Clear external version also
     C                     Z-ADD*ZERO     V1NODT
     C                     Z-ADD*ZERO     #1BRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     #DN7DT           LD Carrier Appt
      * Clear external version also
     C                     Z-ADD*ZERO     VDN7DT
     C                     Z-ADD*ZERO     #DB3TM           LD Carrier Appt
     C                     MOVEL*BLANK    #DAKU1           String 30
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @BECPFK fields to screen
      *================================================================
     C                     MOVELBEJNCD    #1JNCD           Order Type - Sa
     C                     Z-ADDBEANC7    #1ANC7           A/R Customer Nu
     C                     Z-ADDBEBKC7    #1BKC7           Ship To Custome
     C                     MOVELBEBRTX    #1BRTX           Ship To Name
     C                     MOVELBEHMNA    #1HMNA           Ship To Address
     C                     MOVELBEHONA    #1HONA           Ship To Address
     C                     MOVELBEHPNA    #1HPNA           Ship To Address
     C                     MOVELBEHNNA    #1HNNA           Ship To City
     C                     MOVELBEDBCD    #1DBCD           Ship To State C
     C                     MOVELBECKTX    #1CKTX           Ship To Zip/Pos
     C                     Z-ADDBEB0C7    #1B0C7           Bill to Custome
     C                     MOVELBEAETX    #1AETX           Bill to Name
     C                     MOVELBEB1NA    #1B1NA           Bill to Address
     C                     MOVELBEB3NA    #1B3NA           Bill to Address
     C                     MOVELBEB4NA    #1B4NA           Bill to Address
     C                     MOVELBEB2NA    #1B2NA           Bill to City
     C                     MOVELBEBHCD    #1BHCD           Bill to State C
     C                     MOVELBEC8TX    #1C8TX           Bill to Zip/Pos
     C                     Z-ADDBEA0DT    #1A0DT           Order Date
     C                     Z-ADDBEA5DT    #1A5DT           Requested Ship
     C                     Z-ADDBEGNDT    #1GNDT           Actual Shipped
     C                     Z-ADDBEACDT    #1ACDT           Cancel Date
     C                     MOVELBEAQCD    #1AQCD           Terms Code
     C                     MOVELBEBZNA    #1BZNA           Carrier Code
     C                     MOVELBEGTST    #1GTST           Comment Print A
     C                     MOVELBEGVST    #1GVST           Comment Print I
     C                     MOVELBEGUST    #1GUST           Comment Print P
     C                     MOVELBEQFST    #1QFST           Comment Print S
     C                     MOVELBECQCD    #1CQCD           Reason Code
     C                     MOVELBEGJST    #1GJST           Order in Use
     C                     MOVELBEGWST    #1GWST           Header Status
     C                     MOVELBEGXST    #1GXST           Header Status L
     C                     MOVELBEGYST    #1GYST           Order Type Prin
     C                     Z-ADDBEAODT    #1AODT           Scheduled Ship
     C                     MOVELBEAIVN    #1AIVN           User Original E
     C                     Z-ADDBECXDT    #1CXDT           Date of Origina
     C                     Z-ADDBEJZVA    #1JZVA           Order Value Tot
     C                     Z-ADDBEA1WG    #1A1WG           Order Weight To
     C                     MOVELBEXIST    #1XIST           Credit Hold
     C                     MOVELBEXJST    #1XJST           Production Hold
     C                     MOVELBEXKST    #1XKST           New Customer Ho
     C                     MOVELBEE8CD    #1E8CD           Accounts Receiv
     C                     MOVELBEE9CD    #1E9CD           Accounts Receiv
     C                     Z-ADDBETBNB    #1TBNB           Absorbed Freigh
     C                     Z-ADDBER1NB    #1R1NB           Rated Freight
     C                     MOVELBEPJST    #1PJST           LTL Flag
     C                     MOVELBEU0ST    #1U0ST           Price Audit
     C                     MOVELBEU1ST    #1U1ST           Price Status
     C                     MOVELBEQ2CD    #1Q2CD           Shipping Method
     C                     MOVELBEU2ST    #1U2ST           Export Status
     C                     MOVELBEVEST    #1VEST           Palletize
     C                     MOVELBEVFST    #1VFST           Shrink Wrap
     C                     MOVELBEVGST    #1VGST           Slip Sheet
     C                     MOVELBERPCD    #1RPCD           Age Code
     C                     Z-ADDBERNNB    #1RNNB           Reefer Temperat
     C                     MOVELBEVDST    #1VDST           Load Type
     C                     Z-ADDBEATIN    #1ATIN           Attach to Invoi
     C                     MOVELBEU4ST    #1U4ST           Load Plan Order
     C                     MOVELBEU5ST    #1U5ST           Print Pick Slip
     C                     Z-ADDBERSRN    #1RSRN           Resell Referenc
     C                     MOVELBEMHNA    #1MHNA           Special Comment
     C                     MOVELBEMINA    #1MINA           Special Comment
     C                     MOVELBEWBST    #1WBST           Affect Auto Acc
     C                     MOVELBEBFCD    #1BFCD           Manager Level C
     C                     MOVELBEQ4CD    #1Q4CD           VP Level Code
     C                     Z-ADDBET3NB    #1T3NB           Attach to Order
     C                     MOVELBESICD    #1SICD           Reason for Pric
     C                     Z-ADDBECONB    #1CONB           Invoice Number
     C                     MOVELBECEST    #1CEST           Invoice Suffix
     C                     Z-ADDBEAWDT    #1AWDT           Invoice Date
     C                     MOVELBEXUST    #1XUST           Trans Contol AS
     C                     MOVELBEZ1ST    #1Z1ST           Modified Flag
     C                     Z-ADDBEVRVA    #1VRVA           A/R order Value
     C                     MOVELBEOBST    #1OBST           Billing Activit
     C                     MOVELBEBCST    #1BCST           Block Order Fla
     C                     MOVELBEBDST    #1BDST           Order Certifica
     C                     Z-ADDBEB7VL    #1B7VL           Invoice Order V
     C                     MOVELBEGASX    #1GASX           Process Sts for
     C                     MOVELBEGBSX    #1GBSX           Order Conf Fax
     C                     MOVELBEGCSX    #1GCSX           Manifest Fax St
     C                     MOVELBEGDSX    #1GDSX           Invoice Fax Sts
     C                     MOVELBEFOSX    #1FOSX           Email Cust On O
     C                     MOVELBEFPSX    #1FPSX           Order Emailed
     C                     MOVELBEFQSX    #1FQSX           Export Docs Go
     C                     MOVELBEFRSX    #1FRSX           Shipping Temp C
     C                     MOVELBEFSSX    #1FSSX           Broker Order St
     C                     MOVELBEFTSX    #1FTSX           Air Freight Ord
     C                     MOVELBEFUSX    #1FUSX           Order Requires
     C                     MOVELBEFWSX    #1FWSX           Export USDA App
     C                     MOVELBEFXSX    #1FXSX           HPB Ship to War
     C                     MOVELBEFYSX    #1FYSX           OH TF Exempt Co
     C                     Z-ADDBENPDT    #1NPDT           JPN Invoice Iss
     C                     Z-ADDBENQDT    #1NQDT           Load Actual Shi
     C                     Z-ADDBENRDT    #1NRDT           Load BOL Comple
     C                     Z-ADDBENSDT    #1NSDT           Load Truck Depa
     C                     Z-ADDBEBPTM    #1BPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    #1BQTM           Time of Origina
     C                     Z-ADDBEBSTM    #1BSTM           Load BOL Comple
     C                     Z-ADDBEBTTM    #1BTTM           Load Truck Depa
     C                     Z-ADDBEH0NX    #1H0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    #1H1NX           Act Non-Ref Frt
     C                     Z-ADDBEH2NX    #1H2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    #1H3NX           OH Total Non-Re
     C                     Z-ADDBEH4NX    #1H4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    #1C0C7           Claim Number
     C                     MOVELBEUVST    #1UVST           EDI Status 1
     C                     MOVELBEUWST    #1UWST           EDI Status 2
     C                     MOVELBEUXST    #1UXST           EDI Status 3
     C                     Z-ADDBEAATM    #1AATM           Job Time
     C                     MOVELBEAYNA    #1AYNA           User Id
     C                     MOVELBEA0NA    #1A0NA           Job Name
     C                     Z-ADDBEAXDT    #1AXDT           Job Date
     C                     Z-ADDBEAIC3    #1AIC3           Company Number
     C                     Z-ADDBEC4NB    #1C4NB           Order Number
     C                     Z-ADDBERMNB    #1RMNB           Load ID
     C                     MOVELBEJPCD    #1JPCD           Event Code
     C                     MOVELBEFVSX    #1FVSX           OH Load Plan Re
     C                     Z-ADDBEEIDT    #1EIDT           Requested Deliv
     C                     Z-ADDBEAFTM    #1AFTM           Requested Deliv
     C                     MOVELBER4CD    #1R4CD           Sales Route Cod
     C                     MOVELBEBCNA    #1BCNA           Customer Purcha
     C                     MOVELBEB6NA    #1B6NA           Special Instruc
     C                     MOVELBEBYNA    #1BYNA           Special Instruc
     C                     MOVELBEFNSX    #1FNSX           Transfer in Sto
     C                     Z-ADDBENODT    #1NODT           OH Appt Confirm
     C                     Z-ADDBEBRTM    #1BRTM           OH Appt Confirm
      * Hold existing record image
     C                     MOVEL@1DBRC    #1DBRC
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MDIZ#K    BEGSR
      *================================================================
      * Initialize key screen
      *================================================================
     C                     Z-ADDP1AIC3    #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     Z-ADDP1C4NB    #1C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V1C4NB
      * Check reference to Company Name and Address
     C                     EXSR WCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9931  *
     C                     END
      *================================================================
     CSR         MDEXIT    ENDSR
      /EJECT
     CSR         MFIZ#2    BEGSR
      *================================================================
      * Initialise derived fields
      *================================================================
     C                     MOVEL*BLANK    #DSQTX           Company Name DR
      *================================================================
     CSR         MFEXIT    ENDSR
      /EJECT
     CSR         MNCV#K    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C4NB           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#D    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  #1EIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1EIDT
      * Convert OH Appt Confirmation Dt to display format
      * Convert date
     C           1000000   ADD  #1NODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1NODT
      * Convert LD Carrier Appt Date to display format
      * Convert date
     C           1000000   ADD  #DN7DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDN7DT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0001    ABAIC3           Company Number
      * Establish starting position
     C           KRSSA     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           Name
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    WL0002           Name
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Salesperson        RT - Salesperson  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           APBCCD           Salesperson Cod
      * Setup key
     C                     MOVELWL0003    APBCCD           Salesperson Cod
      * Establish starting position
     C           KRSSB     CHAIN@APREBU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0039' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0004           Salesperson Nam
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAPALTX    WL0004           Salesperson Nam
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV HPB Equiv/dlv po RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           AMAIC3           Company Number
     C                     KFLD           AMC4NB           Order Number
      * Setup key
     C                     Z-ADDBEAIC3    AMAIC3           Company Number
     C                     Z-ADDBEC4NB    AMC4NB           Order Number
      * Establish starting position
     C           KRSSC     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #DHEVL           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     #DHFVL           OHE HPB RIN Pri
     C                     MOVEL*BLANK    #DC3TX           OHE Spot Buy
     C                     MOVEL*BLANK    YL0003           OHE Override Ty
     C                     MOVEL*BLANK    WULMT1           Delivery P.O. N
     C                     MOVEL*BLANK    WULWAA           OHE Intended fo
     C                     MOVEL*BLANK    #DV5T1           OHE Appt Confir
     C                     MOVEL*BLANK    #DWBT1           OHE Appt Confir
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAMHEVL    #DHEVL           OHE HPB RIN Equ
     C                     Z-ADDAMHFVL    #DHFVL           OHE HPB RIN Pri
     C                     MOVELAMC3TX    #DC3TX           OHE Spot Buy
     C                     MOVELAMCHTX    YL0003           OHE Override Ty
     C                     MOVELAMLMT1    WULMT1           Delivery P.O. N
     C                     MOVELAMLWAA    WULWAA           OHE Intended fo
     C                     MOVELAMV5T1    #DV5T1           OHE Appt Confir
     C                     MOVELAMWBT1    #DWBT1           OHE Appt Confir
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Carr Appt Dt/Tm   RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQSD02           Load ID
     C           *LIKE     DEFN FLC4NB    WQSD03           Order Number
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD02           Load ID
     C                     KFLD           WQSD03           Order Number
      * Setup key
     C                     Z-ADDBERMNB    WQSD02           Load ID
     C                     Z-ADDBEC4NB    WQSD03           Order Number
      * Establish starting position
     C           KRSSD     SETLL@FLCPKF                    *
     C           KRSSD     READE@FLCPKF                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDFLN7DT    #DN7DT           Appointment Con
     C                     Z-ADDFLB3TM    #DB3TM           Appointment Con
     C                     GOTO SDEXIT                     *QUIT
     C           KRSSD     READE@FLCPKF                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Ltr of Crdt - 1st  RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           AMAIC3           Company Number
     C                     KFLD           AMC4NB           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    AMAIC3           Company Number
     C                     Z-ADDP1C4NB    AMC4NB           Order Number
      * Establish starting position
     C           KRSSE     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUWDT1           Letter of Credi
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * ** Pass back the first record found with a Letter of Credit
      * CASE: DB1.Letter of Credit Number is Not entered
     C           AMWDT1    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR = DB1 By name
     C                     MOVELAMWDT1    WUWDT1           Letter of Credi
     C                     GOTO SEEXIT                     *QUIT
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Country Code only  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSF01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSF02           Order Number
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQSF01           Company Number
     C                     Z-ADD#1C4NB    WQSF02           Order Number
      * Establish starting position
     C           KRSSF     SETLL@BGWKAE                    *
     C           KRSSF     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUKXCD           Country Code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           OMGMST    IFEQ 'L'                        *IF
     C           OMGMST    OREQ 'A'
     C           OMGMST    OREQ 'C'
     C           OMGMST    OREQ 'R'
     C           OMGMST    OREQ 'E'
     C           OMGMST    OREQ 'H'
     C           OMGMST    OREQ 'I'
      * PAR = DB1 By name
     C                     MOVELOMKXCD    WUKXCD           Country Code
     C                     GOTO SFEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSF     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Warehouse Type     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELP4T3CD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSG     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0007           Warehouse Type
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADWPST    YL0007           Warehouse Type
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV P.O. Required Flag RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           EOAIC3           Company Number
     C                     KFLD           EOBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1AIC3    EOAIC3           Company Number
     C                     Z-ADD#1BKC7    EOBKC7           Ship To Custome
      * Establish starting position
     C           KRSSH     CHAIN@EOREUB              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    P5PPST           P.O. Required F
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELEOPPST    P5PPST           P.O. Required F
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Co,Cust,PO         RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBBKC7    WQSI01           Ship To Custome
     C           *LIKE     DEFN WBBCNA    WQSI02           Customer Purcha
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Ship To Custome
     C                     KFLD           WQSI02           Customer Purcha
      * Setup key
     C                     Z-ADD#1BKC7    WQSI01           Ship To Custome
     C                     MOVEL#1BCNA    WQSI02           Customer Purcha
      * Establish starting position
     C           KRSSI     SETLL@BFCPCQ                    *
     C           KRSSI     READE@BFCPCQ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C           KRSSI     READE@BFCPCQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Val Type Codes         RT - Type Codes  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    W0RTN            *Return code
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           AJBOCD           Type Code
      * Setup key
     C                     MOVEL#DBOCD    AJBOCD           Type Code
      * Establish starting position
     C           KRSSJ     CHAIN@AJREVF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0026' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCHRC    BEGSR
      *================================================================
      * CHG Locked Order       CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0002  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0003  70       Ship To Custome
     C                     MOVEL*BLANK    WN0004 30        Ship To Name
     C                     MOVEL*BLANK    WN0005 30        Ship To Address
     C                     MOVEL*BLANK    WN0006 30        Ship To Address
     C                     MOVEL*BLANK    WN0007 30        Ship To Address
     C                     MOVEL*BLANK    WN0008 20        Ship To City
     C                     MOVEL*BLANK    WN0009  2        Ship To State C
     C                     MOVEL*BLANK    WN0010 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0011  70       Bill to Custome
     C                     MOVEL*BLANK    WN0012 30        Bill to Name
     C                     MOVEL*BLANK    WN0013 30        Bill to Address
     C                     MOVEL*BLANK    WN0014 30        Bill to Address
     C                     MOVEL*BLANK    WN0015 30        Bill to Address
     C                     MOVEL*BLANK    WN0016 20        Bill to City
     C                     MOVEL*BLANK    WN0017  2        Bill to State C
     C                     MOVEL*BLANK    WN0018 11        Bill to Zip/Pos
     C                     Z-ADD*ZERO     WN0019  70       Order Date
     C                     Z-ADD*ZERO     WN0020  70       Requested Ship
     C                     Z-ADD*ZERO     WN0021  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0022  70       Cancel Date
     C                     MOVEL*BLANK    WN0023  2        Terms Code
     C                     MOVEL*BLANK    WN0024  3        Carrier Code
     C                     MOVEL*BLANK    WN0025  1        Comment Print A
     C                     MOVEL*BLANK    WN0026  1        Comment Print I
     C                     MOVEL*BLANK    WN0027  1        Comment Print P
     C                     MOVEL*BLANK    WN0028  1        Comment Print S
     C                     MOVEL*BLANK    WN0029  3        Reason Code
     C                     MOVEL*BLANK    WN0030  1        Order in Use
     C                     MOVEL*BLANK    WN0031  1        Header Status
     C                     MOVEL*BLANK    WN0032  1        Header Status L
     C                     MOVEL*BLANK    WN0033  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0034  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0035 10        User Original E
     C                     Z-ADD*ZERO     WN0036  70       Date of Origina
     C                     Z-ADD*ZERO     WN0037 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0038 112       Order Weight To
     C                     MOVEL*BLANK    WN0039  1        Credit Hold
     C                     MOVEL*BLANK    WN0040  1        Production Hold
     C                     MOVEL*BLANK    WN0041  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0042  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0043  40       Requested Deliv
     C                     MOVEL*BLANK    WN0044  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0045 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0046  70       Load ID
     C                     Z-ADD*ZERO     WN0047 112       Rated Freight
     C                     MOVEL*BLANK    WN0048  1        LTL Flag
     C                     MOVEL*BLANK    WN0049  1        Price Audit
     C                     MOVEL*BLANK    WN0050  1        Price Status
     C                     MOVEL*BLANK    WN0051  2        Shipping Method
     C                     MOVEL*BLANK    WN0052  1        Export Status
     C                     MOVEL*BLANK    WN0053  1        Palletize
     C                     MOVEL*BLANK    WN0054  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0055  1        Slip Sheet
     C                     MOVEL*BLANK    WN0056  1        Age Code
     C                     Z-ADD*ZERO     WN0057  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0058  1        Load Type
     C                     Z-ADD*ZERO     WN0059  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0060  1        Load Plan Order
     C                     MOVEL*BLANK    WN0061  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0062  70       Resell Referenc
     C                     MOVEL*BLANK    WN0063 30        Special Comment
     C                     MOVEL*BLANK    WN0064 30        Special Comment
     C                     MOVEL*BLANK    WN0065  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0066  2        Manager Level C
     C                     MOVEL*BLANK    WN0067  3        VP Level Code
     C                     Z-ADD*ZERO     WN0068  70       Attach to Order
     C                     MOVEL*BLANK    WN0069  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0070  70       Invoice Number
     C                     MOVEL*BLANK    WN0071  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0072  70       Invoice Date
     C                     MOVEL*BLANK    WN0073  2        Event Code
     C                     MOVEL*BLANK    WN0074  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0075  1        Modified Flag
     C                     Z-ADD*ZERO     WN0076 112       A/R order Value
     C                     MOVEL*BLANK    WN0077  1        Billing Activit
     C                     MOVEL*BLANK    WN0078  1        Block Order Fla
     C                     MOVEL*BLANK    WN0079  1        Order Certifica
     C                     Z-ADD*ZERO     WN0080 112       Invoice Order V
     C                     MOVEL*BLANK    WN0081  1        Process Sts for
     C                     MOVEL*BLANK    WN0082  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0083  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0084  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0085  1        Email Cust On O
     C                     MOVEL*BLANK    WN0086  1        Order Emailed
     C                     MOVEL*BLANK    WN0087  1        Export Docs Go
     C                     MOVEL*BLANK    WN0088  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0089  1        Broker Order St
     C                     MOVEL*BLANK    WN0090  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0091  2        Order Requires
     C                     MOVEL*BLANK    WN0092  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0093  2        Export USDA App
     C                     MOVEL*BLANK    WN0094  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0095  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0096  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0097  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0098  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0099  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0100  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0101  60       Time of Origina
     C                     Z-ADD*ZERO     WN0102  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0103  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0104 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0105 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0106 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0107 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0108 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0109  70       Claim Number
     C                     MOVEL*BLANK    WN0110  1        EDI Status 1
     C                     MOVEL*BLANK    WN0111  1        EDI Status 2
     C                     MOVEL*BLANK    WN0112  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0113  60       Job Time
     C                     MOVEL*BLANK    WN0114 10        User Id
     C                     MOVEL*BLANK    WN0115 10        Job Name
     C                     Z-ADD*ZERO     WN0116  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADD#1AIC3    BEAIC3           Company Number
     C                     Z-ADD#1C4NB    BEC4NB           Order Number
      *
     C           KLCHSK    KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
     C           KLCHSK    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
      * Check for changed record
     C           #1DBRC    IFNE @1DBRC                     IF
     C                     MOVEL'Y2U0007' W0RTN   7
      * Send message '*Update not accepted'
     C                     MOVEL'Y2U0007' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     GOTO SKEXIT
     C                     ENDIF                           FI #1DBRC
      * Store record data for null update check
     C                     MOVE @1DBRC    YARDCS
      * USER: Processing after Data read
      * ** If PO# chgd, write log record & unaccept load   E00447
      * CASE: PAR.Customer Purchase Order # NE PAR.Purchase Order # 1 usr
     C           #1BCNA    IFNE P1BCNA                     *IF
      * ** par.Customer Purchase Order # is the new PO#
      * ** If PO# changed & order is on a load, write log   E00447
      * CASE: DB1.Load ID is NE Blank
     C           BERMNB    IFNE 0                          *IF
      * If shipped or buyers truck, crt log for Sales and don't unaccept
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Event Code is GE than Shipped
      *   |- c2    : DB1.Carrier Code is Buyer's Truck
      *   '-
     C           BEJPCD    IFGE '04'                       *IF
     C           BEBZNA    OREQ 'BUY'                      *OR
     C                     MOVEL'SLS'     YL0009           Department Cont
     C                     MOVEL'PO#CHG'  YL0010           Load Change Typ
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPARC
     C                     Z-ADDBERMNB    PARMNB           Load ID
     C                     Z-ADD*ZERO     PARVNB           Stop/Drop
     C                     MOVELYL0010    PARVST    P      Load Change Typ
     C                     MOVELYL0009    PAUJST    P      Department Cont
     C                     MOVELP1BCNA    PAMNTX    P      Change Log Prio
     C                     MOVEL#1BCNA    PAMOTX    P      Change Log New
     C                     MOVEL##USR     PAAYNA    P      User Id
     C                     MOVEL##PGM     PAA0NA    P      Job Name
     C                     MOVELBEBZNA    PABZNA    P      Carrier Code
     C                     Z-ADDBEAIC3    PAAIC3           Company Number
     C                     Z-ADDBEC4NB    PAC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'TRF'     YL0009           Department Cont
     C                     MOVEL'PO#CHG'  YL0010           Load Change Typ
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPARC
     C                     Z-ADDBERMNB    PARMNB           Load ID
     C                     Z-ADD*ZERO     PARVNB           Stop/Drop
     C                     MOVELYL0010    PARVST    P      Load Change Typ
     C                     MOVELYL0009    PAUJST    P      Department Cont
     C                     MOVELP1BCNA    PAMNTX    P      Change Log Prio
     C                     MOVEL#1BCNA    PAMOTX    P      Change Log New
     C                     MOVEL##USR     PAAYNA    P      User Id
     C                     MOVEL##PGM     PAA0NA    P      Job Name
     C                     MOVELBEBZNA    PABZNA    P      Carrier Code
     C                     Z-ADDBEAIC3    PAAIC3           Company Number
     C                     Z-ADDBEC4NB    PAC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
      * RTV Load Acceptance Sw RT - Load Header  * 
     C                     EXSR SLRVGN
      * ** Change to Unaccepted if load had already been accepted.  E0044
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Load Acceptance Flag is Load Accepted
      *   |- c2    : LCL.MG Created Load is Not MG Created Load
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0011    IFEQ 'A'                        *IF
     C           YL0012    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDBEAIC3    WL0005           Company Number
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0006    YL0013    P      Plant Company S
     C                     MOVELWL0007    YL0014    P      Company Organiz
      * CASE: LCL.Company Organization is High Plains Biodiesel
     C           YL0014    IFEQ 'H'                        *IF
      * E01507 RMC dont do for hpb 4/26/11
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Unaccept load if PO# chg on any of the orders
      * CHG Load Acceptance Sw CH - Load Header  * 
     C                     EXSR SNCHRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 2/18/13 Upd HPB Coa Batch RIn -- rail car no.
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDBEAIC3    WL0005           Company Number
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0006    YL0013    P      Plant Company S
     C                     MOVELWL0007    YL0014    P      Company Organiz
      * CASE: LCL.Company Organization is High Plains Biodiesel
     C           YL0014    IFEQ 'H'                        *IF
      * RTV Whse Acct Co      RT - Order Detail  * 
     C                     EXSR SORVGN
      * Rtv Upd Cust PO#      RT - COA Batch Header RIN  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0015    WL0008           Company Number
     C                     Z-ADDBEC4NB    WL0009           Order Number
     C                     MOVEL#1BCNA    WL0010    P      COA RIN Custome
     C                     Z-ADDBEAIC3    WL0011           Shipping Compan
     C                     EXSR SQRVGN
      * R6965 RMC 8/17/16 new HPB Plant
      * RTV Numeric Value      RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDBEAIC3    WL0019           Company Number
     C                     MOVEL'HPBPLT'  WL0020    P      Company Value C
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0021    YL0016           System Value Nu
      * New
      * CASE: LCL.Company Number     041405 is greater than zero
     C           YL0016    IFGT 0                          *IF
      * Rtv Upd Cust PO#      RT - COA Batch Header RIN  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0016    WL0008           Company Number
     C                     Z-ADDBEC4NB    WL0009           Order Number
     C                     MOVEL#1BCNA    WL0010    P      COA RIN Custome
     C                     Z-ADDBEAIC3    WL0011           Shipping Compan
     C                     EXSR SQRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Move non-key fields to @BECPFJ
     C                     MOVEL#1BCNA    BEBCNA    P      Customer Purcha
     C                     MOVEL#1B6NA    BEB6NA    P      Special Instruc
     C                     MOVEL#1BYNA    BEBYNA    P      Special Instruc
     C                     Z-ADD#1TBNB    BETBNB           Absorbed Freigh
     C                     MOVEL#1R4CD    BER4CD    P      Sales Route Cod
     C                     MOVEL#1FNSX    BEFNSX    P      Transfer in Sto
     C                     Z-ADD#1NODT    BENODT           OH Appt Confirm
     C                     Z-ADD#1BRTM    BEBRTM           OH Appt Confirm
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     BEAATM           Job Time
     C                     MOVEL##USR     BEAYNA           User Id
     C                     MOVEL##PGM     BEA0NA           Job Name
     C                     Z-ADD##JDT     BEAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - Order Header TRG  * 
     C                     CLEARPBRC
     C                     Z-ADDBEAIC3    PBAIC3           Company Number
     C                     Z-ADDBEC4NB    PBC4NB           Order Number
     C                     MOVELBEJNCD    PBJNCD    P      Order Type - Sa
     C                     Z-ADDBEANC7    PBANC7           A/R Customer Nu
     C                     Z-ADDBEBKC7    PBBKC7           Ship To Custome
     C                     MOVELBEBRTX    PBBRTX    P      Ship To Name
     C                     MOVELBEHMNA    PBHMNA    P      Ship To Address
     C                     MOVELBEHONA    PBHONA    P      Ship To Address
     C                     MOVELBEHPNA    PBHPNA    P      Ship To Address
     C                     MOVELBEHNNA    PBHNNA    P      Ship To City
     C                     MOVELBEDBCD    PBDBCD    P      Ship To State C
     C                     MOVELBECKTX    PBCKTX    P      Ship To Zip/Pos
     C                     Z-ADDBEB0C7    PBB0C7           Bill to Custome
     C                     MOVELBEAETX    PBAETX    P      Bill to Name
     C                     MOVELBEB1NA    PBB1NA    P      Bill to Address
     C                     MOVELBEB3NA    PBB3NA    P      Bill to Address
     C                     MOVELBEB4NA    PBB4NA    P      Bill to Address
     C                     MOVELBEB2NA    PBB2NA    P      Bill to City
     C                     MOVELBEBHCD    PBBHCD    P      Bill to State C
     C                     MOVELBEC8TX    PBC8TX    P      Bill to Zip/Pos
     C                     MOVELBEBCNA    PBBCNA    P      Customer Purcha
     C                     Z-ADDBEA0DT    PBA0DT           Order Date
     C                     Z-ADDBEA5DT    PBA5DT           Requested Ship
     C                     Z-ADDBEGNDT    PBGNDT           Actual Shipped
     C                     Z-ADDBEACDT    PBACDT           Cancel Date
     C                     MOVELBEAQCD    PBAQCD    P      Terms Code
     C                     MOVELBEB6NA    PBB6NA    P      Special Instruc
     C                     MOVELBEBYNA    PBBYNA    P      Special Instruc
     C                     MOVELBEBZNA    PBBZNA    P      Carrier Code
     C                     MOVELBEGTST    PBGTST    P      Comment Print A
     C                     MOVELBEGVST    PBGVST    P      Comment Print I
     C                     MOVELBEGUST    PBGUST    P      Comment Print P
     C                     MOVELBEQFST    PBQFST    P      Comment Print S
     C                     MOVELBECQCD    PBCQCD    P      Reason Code
     C                     MOVELBEGJST    PBGJST    P      Order in Use
     C                     MOVELBEGWST    PBGWST    P      Header Status
     C                     MOVELBEGXST    PBGXST    P      Header Status L
     C                     MOVELBEGYST    PBGYST    P      Order Type Prin
     C                     Z-ADDBEAODT    PBAODT           Scheduled Ship
     C                     MOVELBEAIVN    PBAIVN    P      User Original E
     C                     Z-ADDBECXDT    PBCXDT           Date of Origina
     C                     Z-ADDBEJZVA    PBJZVA           Order Value Tot
     C                     Z-ADDBEA1WG    PBA1WG           Order Weight To
     C                     MOVELBEXIST    PBXIST    P      Credit Hold
     C                     MOVELBEXJST    PBXJST    P      Production Hold
     C                     MOVELBEXKST    PBXKST    P      New Customer Ho
     C                     Z-ADDBEEIDT    PBEIDT           Requested Deliv
     C                     Z-ADDBEAFTM    PBAFTM           Requested Deliv
     C                     MOVELBEE8CD    PBE8CD    P      Accounts Receiv
     C                     MOVELBEE9CD    PBE9CD    P      Accounts Receiv
     C                     Z-ADDBERMNB    PBRMNB           Load ID
     C                     Z-ADDBETBNB    PBTBNB           Absorbed Freigh
     C                     Z-ADDBER1NB    PBR1NB           Rated Freight
     C                     MOVELBEPJST    PBPJST    P      LTL Flag
     C                     MOVELBEU0ST    PBU0ST    P      Price Audit
     C                     MOVELBEU1ST    PBU1ST    P      Price Status
     C                     MOVELBEQ2CD    PBQ2CD    P      Shipping Method
     C                     MOVELBEU2ST    PBU2ST    P      Export Status
     C                     MOVELBEVEST    PBVEST    P      Palletize
     C                     MOVELBEVFST    PBVFST    P      Shrink Wrap
     C                     MOVELBEVGST    PBVGST    P      Slip Sheet
     C                     MOVELBERPCD    PBRPCD    P      Age Code
     C                     Z-ADDBERNNB    PBRNNB           Reefer Temperat
     C                     MOVELBEVDST    PBVDST    P      Load Type
     C                     Z-ADDBEATIN    PBATIN           Attach to Invoi
     C                     MOVELBEU4ST    PBU4ST    P      Load Plan Order
     C                     MOVELBEU5ST    PBU5ST    P      Print Pick Slip
     C                     Z-ADDBERSRN    PBRSRN           Resell Referenc
     C                     MOVELBEMHNA    PBMHNA    P      Special Comment
     C                     MOVELBEMINA    PBMINA    P      Special Comment
     C                     MOVELBEWBST    PBWBST    P      Affect Auto Acc
     C                     MOVELBER4CD    PBR4CD    P      Sales Route Cod
     C                     MOVELBEBFCD    PBBFCD    P      Manager Level C
     C                     MOVELBEQ4CD    PBQ4CD    P      VP Level Code
     C                     Z-ADDBET3NB    PBT3NB           Attach to Order
     C                     MOVELBESICD    PBSICD    P      Reason for Pric
     C                     Z-ADDBECONB    PBCONB           Invoice Number
     C                     MOVELBECEST    PBCEST    P      Invoice Suffix
     C                     Z-ADDBEAWDT    PBAWDT           Invoice Date
     C                     MOVELBEJPCD    PBJPCD    P      Event Code
     C                     MOVELBEXUST    PBXUST    P      Trans Contol AS
     C                     MOVELBEZ1ST    PBZ1ST    P      Modified Flag
     C                     Z-ADDBEVRVA    PBVRVA           A/R order Value
     C                     MOVELBEOBST    PBOBST    P      Billing Activit
     C                     MOVELBEBCST    PBBCST    P      Block Order Fla
     C                     MOVELBEBDST    PBBDST    P      Order Certifica
     C                     Z-ADDBEB7VL    PBB7VL           Invoice Order V
     C                     MOVELBEGASX    PBGASX    P      Process Sts for
     C                     MOVELBEGBSX    PBGBSX    P      Order Conf Fax
     C                     MOVELBEGCSX    PBGCSX    P      Manifest Fax St
     C                     MOVELBEGDSX    PBGDSX    P      Invoice Fax Sts
     C                     MOVELBEFNSX    PBFNSX    P      Transfer in Sto
     C                     MOVELBEFOSX    PBFOSX    P      Email Cust On O
     C                     MOVELBEFPSX    PBFPSX    P      Order Emailed
     C                     MOVELBEFQSX    PBFQSX    P      Export Docs Go
     C                     MOVELBEFRSX    PBFRSX    P      Shipping Temp C
     C                     MOVELBEFSSX    PBFSSX    P      Broker Order St
     C                     MOVELBEFTSX    PBFTSX    P      Air Freight Ord
     C                     MOVELBEFUSX    PBFUSX    P      Order Requires
     C                     MOVELBEFVSX    PBFVSX    P      OH Load Plan Re
     C                     MOVELBEFWSX    PBFWSX    P      Export USDA App
     C                     MOVELBEFXSX    PBFXSX    P      HPB Ship to War
     C                     MOVELBEFYSX    PBFYSX    P      OH TF Exempt Co
     C                     Z-ADDBENODT    PBNODT           OH Appt Confirm
     C                     Z-ADDBENPDT    PBNPDT           JPN Invoice Iss
     C                     Z-ADDBENQDT    PBNQDT           Load Actual Shi
     C                     Z-ADDBENRDT    PBNRDT           Load BOL Comple
     C                     Z-ADDBENSDT    PBNSDT           Load Truck Depa
     C                     Z-ADDBEBPTM    PBBPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    PBBQTM           Time of Origina
     C                     Z-ADDBEBRTM    PBBRTM           OH Appt Confirm
     C                     Z-ADDBEBSTM    PBBSTM           Load BOL Comple
     C                     Z-ADDBEBTTM    PBBTTM           Load Truck Depa
     C                     Z-ADDBEH0NX    PBH0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    PBH1NX           Act Non-Ref Frt
     C                     Z-ADDBEH2NX    PBH2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    PBH3NX           OH Total Non-Re
     C                     Z-ADDBEH4NX    PBH4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    PBC0C7           Claim Number
     C                     MOVELBEUVST    PBUVST    P      EDI Status 1
     C                     MOVELBEUWST    PBUWST    P      EDI Status 2
     C                     MOVELBEUXST    PBUXST    P      EDI Status 3
     C                     Z-ADDBEAATM    PBAATM           Job Time
     C                     MOVELBEAYNA    PBAYNA    P      User Id
     C                     MOVELBEA0NA    PBA0NA    P      Job Name
     C                     Z-ADDBEAXDT    PBAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * Update saved record image
     C                     MOVEL@1DBRC    #1DBRC
      * DBF change successful
      * USER: Processing after Data update
      * ** If OHE record exists, update, else, add    FP1303
      * RTV OHE for Ord Entry RT - Order Header Extension  * 
     C                     EXSR SURVGN
      * ** Recompile for backhaul truck# size change          E002768
      * ** Letter of Credit added for Exports                 E002768
      * * Chg or Crt Order Header Extension
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,006                    *IF
      * 08/15/18 DN S13591-Set the Orig AFR from PAR.
      * 07/31/19 DN R15161-Replaced OHE CRTOBJ to Not Call CHGOBJ.
      * CRT Order Header Extsn CR - Order Header Extension  * 
     C                     EXSR SVCRRC
     C                     ELSE
      * CASE: *OTHERWISE
      * 08/15/18 DN S13591-Do NOT Clear the Orig AFR & Abs O/R Rsn in OHE
      * CHG OE Fields 2      CH - Order Header Extension  * 
     C                     EXSR SWCHRC
     C                     END                             *FI
      * 04/13/18 DN S12917-Update Order Detail if Sales Route Changes.
      * CASE: PAR.Sales Route Code NE PAR.Sales Route Code 2 USR
     C           #1R4CD    IFNE YL0002                     *IF
      * Upd Sales Route Code  RT - Order Detail  * 
     C                     EXSR SXRVGN
     C                     END                             *FI
      * E1714 12/02/11 RMC pass in ld carr appt date and upd if its been
      * ** 05/19/16   RMC E4119  remove live with tpm check
     C           #DB3TM    DIV  100       YL0032           Requested Deliv
      * RTV Chg LD APPT/CNFRM RT - Load Detail  * 
     C                     EXSR SZRVGN
      * CRT: TMS Order Header Trigger
      * CASE: PAR.Pricing Event Called From is TMS Update for Select
     C           YL0008    IFEQ 'OE'                       *IF
     C           YL0008    OREQ 'SWP'
     C           YL0008    OREQ 'CEO'
     C           YL0008    OREQ 'UWT'
      * CASE: DB1.OH Load Plan Ready is Yes
     C           BEFVSX    IFEQ 'Y'                        *IF
      * Rtv Crt OH Trigger    XF - TMS Order Header Trigger  * 
     C                     CALL 'PBWVXFR'              90  Rtv Crt OH Trig
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1C4NB    WQ0038  70       Order Number
     C                     PARM #1AIC3    WQ0039  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBWVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Load Acceptance Sw RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDBERMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSL     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0011           Load Acceptance
     C                     MOVEL*BLANK    YL0012           MG Created Load
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFJRMST    YL0011           Load Acceptance
     C                     MOVELFJRYSX    YL0012           MG Created Load
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           JYAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0005    JYAIC3           Company Number
      * Establish starting position
     C           KRSSM     CHAIN@JYRECE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2025' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0006           Plant Company S
     C                     MOVEL*BLANK    WL0007           Company Organiz
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELJYYISX    WL0006           Plant Company S
     C                     MOVELJYYJSX    WL0007           Company Organiz
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNCHRC    BEGSR
      *================================================================
      * CHG Load Acceptance Sw CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0117  30       Company Number
     C                     Z-ADD*ZERO     WN0118  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0119  1        LTL Flag
     C                     MOVEL*BLANK    WN0120  1        Load Status
     C                     Z-ADD*ZERO     WN0121  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0122 15        Seal 1
     C                     MOVEL*BLANK    WN0123 15        Seal 2
     C                     MOVEL*BLANK    WN0124 15        Seal 3
     C                     MOVEL*BLANK    WN0125 15        Seal 4
     C                     MOVEL*BLANK    WN0126 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0127  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0128 112       Flat Amount
     C                     MOVEL*BLANK    WN0129  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0130  50       Total Stops
     C                     MOVEL*BLANK    WN0131 20        Trailer Id
     C                     MOVEL*BLANK    WN0132  3        Transloader Car
     C                     Z-ADD*ZERO     WN0133  40       BOL Time
     C                     MOVEL*BLANK    WN0134  3        Carrier Code
     C                     MOVEL*BLANK    WN0135  7        Truck Size
     C                     Z-ADD*ZERO     WN0136  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0137 112       Rated Freight
     C                     MOVEL*BLANK    WN0138  1        Ship Status
     C                     MOVEL*BLANK    WN0139  1        Load Type
     C                     Z-ADD*ZERO     WN0140  50       Number Pallets
     C                     Z-ADD*ZERO     WN0141  50       Number Pallets
     C                     Z-ADD*ZERO     WN0142 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0143  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0144  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0145  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0146 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0147 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0148  70       Actual Departur
     C                     Z-ADD*ZERO     WN0149  40       Departure Time
     C                     Z-ADD*ZERO     WN0150  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0151  52       Product Tempera
     C                     Z-ADD*ZERO     WN0152  50       Number Spacers
     C                     MOVEL*BLANK    WN0153 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0154  70       Total Load Mile
     C                     MOVEL*BLANK    WN0155 12        Recorder ID
     C                     MOVEL*BLANK    WN0156  2        Shipping Method
     C                     MOVEL*BLANK    WN0157  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0158  2        Ship To State C
     C                     Z-ADD*ZERO     WN0159  70       Gross Weight
     C                     MOVEL*BLANK    WN0160  3        Carrier Broker
     C                     MOVEL*BLANK    WN0161  1        Export Status
     C                     Z-ADD*ZERO     WN0162  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0163  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0164  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0165  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0166  70       Spotted Date
     C                     Z-ADD*ZERO     WN0167  60       Spotted Time
     C                     Z-ADD*ZERO     WN0168  70       Load Finished D
     C                     Z-ADD*ZERO     WN0169  60       Load Finished T
     C                     Z-ADD*ZERO     WN0170  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0171  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0172  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0173  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0174  70       Truck Departure
     C                     Z-ADD*ZERO     WN0175  60       Truck Departure
     C                     Z-ADD*ZERO     WN0176  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0177  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0178  3        Shipping Line
     C                     MOVEL*BLANK    WN0179 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0180 30        Vessel Name
     C                     Z-ADD*ZERO     WN0181  50       Voyage
     C                     Z-ADD*ZERO     WN0182  70       Sail Date
     C                     MOVEL*BLANK    WN0183 12        Booking Number
     C                     MOVEL*BLANK    WN0184 20        Discharge Port
     C                     Z-ADD*ZERO     WN0185  70       Arrival Date
     C                     MOVEL*BLANK    WN0186 12        Container Numbe
     C                     Z-ADD*ZERO     WN0187  70       Date In
     C                     Z-ADD*ZERO     WN0188  60       Time In
     C                     Z-ADD*ZERO     WN0189  70       Date Out
     C                     Z-ADD*ZERO     WN0190  60       Time Out
     C                     Z-ADD*ZERO     WN0191 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0192  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0193  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0194  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0195  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0196  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0197  70       Requested Deliv
     C                     MOVEL*BLANK    WN0198  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0199  70       On Yard Date
     C                     Z-ADD*ZERO     WN0200  60       On Yard Time
     C                     Z-ADD*ZERO     WN0201  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0202  60       Deadline Depart
     C                     MOVEL*BLANK    WN0203  1        Load Held Over
     C                     MOVEL*BLANK    WN0204  1        Load Held Over
     C                     MOVEL*BLANK    WN0205 15        Load Held Over
     C                     MOVEL*BLANK    WN0206 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0207 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0208  70       Express Mail Da
     C                     MOVEL*BLANK    WN0209  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0210  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0211  70       Product Complet
     C                     Z-ADD*ZERO     WN0212  60       Product Complet
     C                     Z-ADD*ZERO     WN0213  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0214  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0215  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0216  1        Load Confirmed
     C                     MOVEL*BLANK    WN0217 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0218  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0219  60       Load Door 1
     C                     Z-ADD*ZERO     WN0220  70       Override Total
     C                     Z-ADD*ZERO     WN0221  60       Load Door 2
     C                     MOVEL*BLANK    WN0222  1        Partial Load
     C                     MOVEL*BLANK    WN0223  1        Load Confirmati
     C                     MOVEL*BLANK    WN0224  1        Export Load USD
     C                     MOVEL*BLANK    WN0225  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0226 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0227 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0228 15        Late Billing Em
     C                     MOVEL*BLANK    WN0229 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0230 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0231  1        Multi Company L
     C                     MOVEL*BLANK    WN0232  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0233  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0234  1        LH Power Only L
     C                     MOVEL*BLANK    WN0235  1        MG Created Load
     C                     MOVEL*BLANK    WN0236  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0237  2        Load U/M
     C                     MOVEL*BLANK    WN0238  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0239  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0240  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0241  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0242  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0243  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0244  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0245  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0246  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0247  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0248  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0249  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0250  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0251  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0252  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0253  60       LH Unused Time
     C                     MOVEL*BLANK    WN0254  1        EDI Status 1
     C                     MOVEL*BLANK    WN0255  1        EDI Status 2
     C                     MOVEL*BLANK    WN0256  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0257  60       Job Time
     C                     MOVEL*BLANK    WN0258 10        User Id
     C                     MOVEL*BLANK    WN0259 10        Job Name
     C                     Z-ADD*ZERO     WN0260  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDBERMNB    WCRMNB           Load ID
      *
     C           KLCHSN    KLIST
     C                     KFLD           WCRMNB           Load ID
     C           KLCHSN    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YBRDCS
      * Move non-key fields to @FJCPBO
     C                     MOVEL'U'       WCRMST    P      Load Acceptance
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WCAATM           Job Time
     C                     MOVEL##USR     WCAYNA           User Id
     C                     MOVEL##PGM     WCA0NA           Job Name
     C                     Z-ADD##JDT     WCAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Whse Acct Co      RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSO01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSO02           Order Number
      * Define keylist
     C           KPSSO     KLIST
     C                     KFLD           WQSO01           Company Number
     C                     KFLD           WQSO02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Company Number
     C                     KFLD           WQSO02           Order Number
      * Setup key
     C                     Z-ADDBEAIC3    WQSO01           Company Number
     C                     Z-ADDBEC4NB    WQSO02           Order Number
     C                     Z-ADD*ZERO     OMDPNB           Order Sequence
     C                     Z-ADD*ZERO     OMUENB           Order Secondary
      * Establish starting position
     C           KPSSO     SETLL@BGWKAE                    *
     C           KRSSO     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0015           Accounting Comp
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Acct Co          RT - Warehouse  * 
     C                     EXSR SPRVGN
     C                     GOTO SOEXIT                     *QUIT
     C           KRSSO     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Acct Co          RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELOMAJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSP     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0015           Accounting Comp
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDADBTC3    YL0015           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv Upd Cust PO#      RT - COA Batch Header RIN  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DAAIC3    WQSQ01           Company Number
     C           *LIKE     DEFN DAC4NB    WQSQ02           Order Number
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           Company Number
     C                     KFLD           WQSQ02           Order Number
      * Setup key
     C                     Z-ADDWL0008    WQSQ01           Company Number
     C                     Z-ADDWL0009    WQSQ02           Order Number
      * Establish starting position
     C           KRSSQ     SETLL@DACPHE                    *
     C           KRSSQ     READE@DACPHE                  90*
      * Data record not found
     C   90                MOVEL'USR3855' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Cust PO#          CH - COA Batch Header RIN  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDDAAIC3    WL0012           Company Number
     C                     MOVELDAL6T1    WL0013    P      COA ULSD Compan
     C                     Z-ADDDAI3NY    WL0014           COA Batch Numbe
     C                     Z-ADDDAJYNY    WL0015           COA Batch Heade
     C                     Z-ADDDAQ1NY    WL0016           COA Batch Hdr R
     C                     MOVELDAMUT1    WL0017    P      COA Batch Heade
     C                     MOVELWL0010    WL0018    P      COA RIN Custome
     C                     EXSR SRCHRC
      * RMC 4/13/20 chg to work for 374//373 too
      * Chg 369/374 BUY that matches the 361/373 SEL
      * Rtv Upd Cust PO f/BUY RT - COA Batch Header RIN  * 
     C                     EXSR SSRVGN
     C           KRSSQ     READE@DACPHE                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRCHRC    BEGSR
      *================================================================
      * Chg Cust PO#          CH - COA Batch Header RIN  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0261  80       COA RIN SSSSSSS
     C                     Z-ADD*ZERO     WN0262  80       COA RIN EEEEEEE
     C                     Z-ADD*ZERO     WN0263  80       COA RIN Volume
     C                     Z-ADD*ZERO     WN0264  70       COA RIN Transac
     C                     Z-ADD*ZERO     WN0265  60       COA RIN Transac
     C                     MOVEL*BLANK    WN0266 30        COA RIN Trans P
     C                     MOVEL*BLANK    WN0267  4        COA RIN Trans P
     C                     MOVEL*BLANK    WN0268  3        COA Retired RIN
     C                     Z-ADD*ZERO     WN0269  70       COA Retired RIN
     C                     Z-ADD*ZERO     WN0270  60       COA Retired RIN
     C                     Z-ADD*ZERO     WN0271  70       Order Number
     C                     Z-ADD*ZERO     WN0272  30       Order Sequence
     C                     Z-ADD*ZERO     WN0273  30       Order Secondary
     C                     Z-ADD*ZERO     WN0274  50       Case Sequence N
     C                     MOVEL*BLANK    WN0275 15        COA Rail Car
     C                     Z-ADD*ZERO     WN0276  70       Load ID
     C                     Z-ADD*ZERO     WN0277  70       COA Date of 1st
     C                     Z-ADD*ZERO     WN0278  60       COA RIN Unused
     C                     MOVEL*BLANK    WN0279  1        COA RIN Modifie
     C                     MOVEL*BLANK    WN0280 25        COA RIN Unused
     C                     MOVEL*BLANK    WN0281  1        COA RIN SoldFul
     C                     Z-ADD*ZERO     WN0282  80       COA RIN Gallons
     C                     MOVEL*BLANK    WN0283  3        COA Ship To War
     C                     MOVEL*BLANK    WN0284  1        COA RIN Type Fl
     C                     Z-ADD*ZERO     WN0285  30       COA Shipping Co
     C                     Z-ADD*ZERO     WN0286  70       COA Ref Load Id
     C                     Z-ADD*ZERO     WN0287  50       COA Reference B
     C                     Z-ADD*ZERO     WN0288  50       COA Reference B
     C                     MOVEL*BLANK    WN0289  2        RFS Compliance
     C                     MOVEL*BLANK    WN0290  4        RFS Report Year
     C                     MOVEL*BLANK    WN0291  1        COA RIN Int/Ext
     C                     MOVEL*BLANK    WN0292  2        COA BHR Unused
     C                     Z-ADD*ZERO     WN0293  70       COA BHR Net Gal
     C                     Z-ADD*ZERO     WN0294  70       COA BHR Unused
     C                     MOVEL*BLANK    WN0295 25        COA BHR Unused
     C                     Z-ADD*ZERO     WN0296  70       COA BHR Loadout
     C                     MOVEL*BLANK    WN0297  5        COA ULSD Facili
     C                     Z-ADD*ZERO     WN0298  70       COA Batch RIN V
     C                     Z-ADD*ZERO     WN0299  70       COA RIN Quantit
     C                     MOVEL*BLANK    WN0300  3        RFS Transaction
     C                     MOVEL*BLANK    WN0301  3        RFS Trans Reaso
     C                     MOVEL*BLANK    WN0302  1        RFS Fuel Code
     C                     Z-ADD*ZERO     WN0303  40       COA BHR RIN Gen
     C                     Z-ADD*ZERO     WN0304  72       COA BHR RIN Pri
     C                     Z-ADD*ZERO     WN0305  72       COA BHR Gallon
     C                     MOVEL*BLANK    WN0306 50        COA Transaction
     C                     MOVEL*BLANK    WN0307 25        COA RIN Support
     C                     Z-ADD*ZERO     WN0308  70       COA RIN Support
     C                     MOVEL*BLANK    WN0309 25        COA RIN Support
     C                     Z-ADD*ZERO     WN0310  70       COA RIN Support
     C                     MOVEL*BLANK    WN0311  1        COA BHR RFS Ver
     C                     MOVEL*BLANK    WN0312  1        COA GEN EMTS St
     C                     Z-ADD*ZERO     WN0313  70       COA GEN EMTS Da
     C                     Z-ADD*ZERO     WN0314  60       COA GEN EMTS Ti
     C                     MOVEL*BLANK    WN0315  1        COA RIN EMTS St
     C                     Z-ADD*ZERO     WN0316  70       COA RIN EMTS Da
     C                     Z-ADD*ZERO     WN0317  60       COA RIN EMTS Ti
     C                     Z-ADD*ZERO     WN0318  70       COA EMTS PTD Nb
     C                     Z-ADD*ZERO     WN0319  80       COA EMTS Batch
     C                     MOVEL*BLANK    WN0320  2        COA BHR Unused
     C                     Z-ADD*ZERO     WN0321  80       COA BHR Unused
     C                     MOVEL*BLANK    WN0322 40        COA EMTS Trans
     C                     MOVEL*BLANK    WN0323 10        COA EMTS Return
     C                     Z-ADD*ZERO     WN0324  70       COA BHR Unused
     C                     Z-ADD*ZERO     WN0325  21       COA BHR Equiv V
     C                     Z-ADD*ZERO     WN0326  70       COA BHR RINs to
     C                     Z-ADD*ZERO     WN0327  70       COA Unassgnd Tx
     C                     MOVEL*BLANK    WN0328  1        Record Status
     C                     Z-ADD*ZERO     WN0329  70       Create Date
     C                     Z-ADD*ZERO     WN0330  60       Create Time
     C                     MOVEL*BLANK    WN0331 10        Create User
     C                     MOVEL*BLANK    WN0332 10        Create Program
     C                     Z-ADD*ZERO     WN0333  70       Change Date
     C                     Z-ADD*ZERO     WN0334  60       Change Time
     C                     MOVEL*BLANK    WN0335 10        Change User
     C                     MOVEL*BLANK    WN0336 10        Change Program
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @DACPP5
     C                     Z-ADDWL0012    WDAIC3           Company Number
     C                     MOVELWL0013    WDL6T1    P      COA ULSD Compan
     C                     Z-ADDWL0014    WDI3NY           COA Batch Numbe
     C                     Z-ADDWL0015    WDJYNY           COA Batch Heade
     C                     Z-ADDWL0016    WDQ1NY           COA Batch Hdr R
      *
     C           KLCHSR    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDL6T1           COA ULSD Compan
     C                     KFLD           WDI3NY           COA Batch Numbe
     C                     KFLD           WDJYNY           COA Batch Heade
     C                     KFLD           WDQ1NY           COA Batch Hdr R
     C           KLCHSR    CHAIN@DACPP5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PMDACPL0'MDACP
     C                     MOVEL'@DACPP5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPMDA1    YCRDCS
      * Move non-key fields to @DACPP5
     C                     MOVELWL0017    WDMUT1    P      COA Batch Heade
     C                     MOVELWL0018    WDTDNA    P      COA RIN Custome
      *
      * Set PGM.*Record Data Changed flag
     C           QPMDA1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Chg Date/Time      IF
     C                     Z-ADD##JDT     WDMKDT           Change Date
     C                     Z-ADD##JTM     WDBFTM           Change Time
     C                     MOVEL##USR     WDCEVN           Change User
     C                     MOVEL##PGM     WDCFVN           Change Program
      * Set PGM.*Record Data Changed flag
     C           QPMDA1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@DACPP5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPMDACPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv Upd Cust PO f/BUY RT - COA Batch Header RIN  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQSS01           Company Number
     C           *LIKE     DEFN WEL6T1    WQSS02           COA ULSD Compan
     C           *LIKE     DEFN WEI3NY    WQSS03           COA Batch Numbe
     C           *LIKE     DEFN WEJYNY    WQSS04           COA Batch Heade
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           Company Number
     C                     KFLD           WQSS02           COA ULSD Compan
     C                     KFLD           WQSS03           COA Batch Numbe
     C                     KFLD           WQSS04           COA Batch Heade
      * Setup key
     C                     Z-ADDWL0011    WQSS01           Company Number
     C                     MOVELDAL6T1    WQSS02           COA ULSD Compan
     C                     Z-ADDDAI3NY    WQSS03           COA Batch Numbe
     C                     Z-ADDDAJYNY    WQSS04           COA Batch Heade
      * Establish starting position
     C           KRSSS     SETLL@DACPP6                    *
     C           KRSSS     READE@DACPP6                  90*
      * Data record not found
     C   90                MOVEL'USR3855' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.RFS Transaction Type is Buy
     C           WEI7AA    IFEQ 'BUY'                      *IF
      * Chg Cust PO#          CH - COA Batch Header RIN  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0012           Company Number
     C                     MOVELWEL6T1    WL0013    P      COA ULSD Compan
     C                     Z-ADDWEI3NY    WL0014           COA Batch Numbe
     C                     Z-ADDWEJYNY    WL0015           COA Batch Heade
     C                     Z-ADDWEQ1NY    WL0016           COA Batch Hdr R
     C                     MOVELWEMUT1    WL0017    P      COA Batch Heade
     C                     MOVELWL0010    WL0018    P      COA RIN Custome
     C                     EXSR SRCHRC
     C                     END                             *FI
     C           KRSSS     READE@DACPP6                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * RTV Numeric Value      RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           KMAIC3           Company Number
     C                     KFLD           KMV8CD           Company Value C
      * Setup key
     C                     Z-ADDWL0019    KMAIC3           Company Number
     C                     MOVELWL0020    KMV8CD           Company Value C
      * Establish starting position
     C           KRSST     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDKMM8NB    WL0021           System Value Nu
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * RTV OHE for Ord Entry RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           AMAIC3           Company Number
     C                     KFLD           AMC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    AMAIC3           Company Number
     C                     Z-ADD#1C4NB    AMC4NB           Order Number
      * Establish starting position
     C           KRSSU     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WULMT1           Delivery P.O. N
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAMLMT1    WULMT1           Delivery P.O. N
     C                     GOTO SUEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVCRRC    BEGSR
      *================================================================
      * CRT Order Header Extsn CR - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AMREJE
     C                     Z-ADDBEAIC3    WFAIC3           Company Number
     C                     Z-ADDBEC4NB    WFC4NB           Order Number
     C                     Z-ADDBERMNB    WFRMNB           Load ID
     C                     Z-ADD*ZERO     WFRUNB           Stop/Drop Seque
     C                     MOVEL*BLANK    WFXACD           Shipping Line
     C                     MOVEL*BLANK    WFOANA           Port Delv Termi
     C                     MOVEL*BLANK    WFHBAA           OHE City
     C                     MOVEL*BLANK    WFJ0T1           OHE Vessel/Airl
     C                     MOVEL*BLANK    WFGENY           OHE Voyage/Flig
     C                     MOVEL*BLANK    WFJ1T1           OHE Booking Num
     C                     MOVEL*BLANK    WFHCAA           OHE Discharge P
     C                     Z-ADD*ZERO     WFQWDT           OHE Sail/Flight
     C                     Z-ADD*ZERO     WFQXDT           OHE Port Cut Da
     C                     Z-ADD*ZERO     WFQYDT           OHE Arrival Dat
     C                     MOVEL*BLANK    WFHDAA           OHE Late Delive
     C                     MOVELYL0017    WFCCTX           OHE Ship Status
     C                     MOVEL*BLANK    WFJ2T1           OHE Container N
     C                     MOVEL*BLANK    WFRLNA           OHE Comment 1
     C                     MOVEL*BLANK    WFRMNA           OHE Comment 2
     C                     Z-ADD*ZERO     WFGINY           OHE Unused Numb
     C                     Z-ADD*ZERO     WFGFNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WFGGNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WFGHNY           OHE Unused Numb
     C                     Z-ADD#DHEVL    WFHEVL           OHE HPB RIN Equ
     C                     Z-ADD#DHFVL    WFHFVL           OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WFHGVL           Transload Termi
     C                     Z-ADD*ZERO     WFQZDT           OHE Est Arrv at
     C                     Z-ADD*ZERO     WFQ0DT           OHE Backhaul ET
     C                     Z-ADD*ZERO     WFQ1DT           OHE Port/Pier P
     C                     Z-ADD*ZERO     WFQ2DT           OHE Actual Ship
     C                     MOVELYL0018    WFC2TX           OHE Carrier SCA
     C                     MOVELYL0019    WFC3TX           OHE Spot Buy
     C                     MOVELYL0020    WFC6TX           OHE PO ACK Flag
     C                     MOVEL#DBOCD    WFCHTX           OHE Override Ty
     C                     MOVELYL0021    WFCITX           OHE Backhaul St
     C                     MOVELYL0022    WFCLTX           OHE Backhaul ET
     C                     MOVELYL0023    WFB4TX           OHE Load Haul T
     C                     MOVELYL0024    WFCUTX           OHE Backhaul Ca
     C                     MOVELYL0025    WFCVTX           OHE Bookings Co
     C                     MOVELYL0026    WFB9TX           OHE EDI Error R
     C                     MOVELYL0027    WFJWSC           OHE EDI Error R
     C                     Z-ADD*ZERO     WFITNY           HPB COA Batch N
     C                     MOVEL#DNLTX    WFLMT1           Delivery P.O. N
     C                     MOVEL*BLANK    WFLWAA           OHE Intended fo
     C                     MOVELYL0028    WFFVST           OHE EDI 943 Act
     C                     MOVELYL0029    WFF0ST           OHE EDI 944 Act
     C                     MOVELYL0030    WFF2ST           OHE EDI 940 Act
     C                     MOVELYL0031    WFF3ST           OHE EDI 945 Act
     C                     MOVELYL0027    WFJUSC           OHE EDI 856 Act
     C                     MOVELYL0027    WFJVSC           OHE EDI 824 Act
     C                     MOVEL*BLANK    WFV3T1           OHE Transload S
     C                     MOVEL*BLANK    WFV4T1           OHE Abs Rate Ov
     C                     MOVEL#DV5T1    WFV5T1           OHE Appt Confir
     C                     MOVEL*BLANK    WFV6T1           OHE Backhaul Co
     C                     MOVEL*BLANK    WFV7T1           OHE Backhaul Ch
     C                     MOVEL*BLANK    WFV8T1           OHE Transload C
     C                     MOVEL*BLANK    WFV9T1           OHE Pier Pass I
     C                     MOVEL*BLANK    WFWAT1           OHE Carrier Nm
     C                     MOVEL#DWBT1    WFWBT1           OHE Appt Confir
     C                     MOVEL*BLANK    WFWCT1           OHE Backhaul Co
     C                     MOVEL*BLANK    WFWDT1           Letter of Credi
     C                     Z-ADD*ZERO     WFQJNY           OHE Backhaul Re
     C                     Z-ADD*ZERO     WFQKNY           LD Stop/Drop
     C                     Z-ADD*ZERO     WFQLNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WFP8NY           OHE Pier Pass F
     C                     Z-ADD*ZERO     WFP9NY           OHE Port Check
     C                     Z-ADD*ZERO     WFQANY           OHE Port Cut Ti
     C                     Z-ADD*ZERO     WFQCNY           OHE Backhaul Tr
     C                     Z-ADD*ZERO     WFQDNY           OHE Load Sched
     C                     Z-ADD*ZERO     WFQENY           Original Appoin
     C                     Z-ADD*ZERO     WFQFNY           Original Appoin
     C                     Z-ADD*ZERO     WFQGNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WFQHNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WFQINY           OHE Unused Nume
     C                     Z-ADD#1TBNB    WFQMNY           OHE Orig ABS Fr
     C                     MOVELYL0027    WFMYU1           OHE Genset Numb
     C                     MOVELYL0027    WFJXSC           OHE Email BOL/S
     C                     MOVELYL0027    WFJYSC           OHE Unused Stat
     C                     MOVELYL0027    WFJZSC           OHE Unused Stat
     C                     MOVELYL0027    WFJ0SC           OHE Unused Stat
     C                     MOVELYL0027    WFMZU1           OHE Unused Text
     C                     MOVELYL0027    WFM0U1           OHE Unused Text
     C                     MOVELYL0027    WFM1U1           OHE Customer Ve
     C                     MOVELYL0027    WFM2U1           OHE Unused Text
     C                     MOVELYL0027    WFM3U1           OHE Unused Text
     C                     Z-ADD*ZERO     WFW5DT           OHE Unused Date
     C                     Z-ADD*ZERO     WFW6DT           OHE Unused Date
     C                     MOVELBEUVST    WFUVST           EDI Status 1
     C                     MOVELBEUWST    WFUWST           EDI Status 2
     C                     MOVELBEUXST    WFUXST           EDI Status 3
     C                     MOVEL'A'       WFVSST           Record Status
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##PGM     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp 2 IF
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##PGM     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
     C           KLCRSV    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFC4NB           Order Number
      * Check for duplicate primary key
     C           KLCRSV    SETLL@AMREJE                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3698' W0RTN   7
      * Send message 'Order Header Extension EX'
     C                     MOVEL'USR3698' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C                     WRITE@AMREJE                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
      * USER: Processing if Data update error
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWCHRC    BEGSR
      *================================================================
      * CHG OE Fields 2      CH - Order Header Extension  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0337  70       Load ID
     C                     Z-ADD*ZERO     WN0338  50       Stop/Drop Seque
     C                     MOVEL*BLANK    WN0339  3        Shipping Line
     C                     MOVEL*BLANK    WN0340 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0341 25        OHE City
     C                     MOVEL*BLANK    WN0342 30        OHE Vessel/Airl
     C                     MOVEL*BLANK    WN0343 15        OHE Voyage/Flig
     C                     MOVEL*BLANK    WN0344 15        OHE Booking Num
     C                     MOVEL*BLANK    WN0345 20        OHE Discharge P
     C                     Z-ADD*ZERO     WN0346  70       OHE Sail/Flight
     C                     Z-ADD*ZERO     WN0347  70       OHE Port Cut Da
     C                     Z-ADD*ZERO     WN0348  70       OHE Arrival Dat
     C                     MOVEL*BLANK    WN0349  3        OHE Late Delive
     C                     MOVEL*BLANK    WN0350  1        OHE Ship Status
     C                     MOVEL*BLANK    WN0351 12        OHE Container N
     C                     MOVEL*BLANK    WN0352 35        OHE Comment 1
     C                     MOVEL*BLANK    WN0353 75        OHE Comment 2
     C                     Z-ADD*ZERO     WN0354 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0355 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0356 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0357 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0358 112       Transload Termi
     C                     Z-ADD*ZERO     WN0359  70       OHE Est Arrv at
     C                     Z-ADD*ZERO     WN0360  70       OHE Backhaul ET
     C                     Z-ADD*ZERO     WN0361  70       OHE Port/Pier P
     C                     Z-ADD*ZERO     WN0362  70       OHE Actual Ship
     C                     MOVEL*BLANK    WN0363  4        OHE Carrier SCA
     C                     MOVEL*BLANK    WN0364  4        OHE PO ACK Flag
     C                     MOVEL*BLANK    WN0365  2        OHE Backhaul St
     C                     MOVEL*BLANK    WN0366  2        OHE Backhaul ET
     C                     MOVEL*BLANK    WN0367  3        OHE Load Haul T
     C                     MOVEL*BLANK    WN0368  3        OHE Backhaul Ca
     C                     MOVEL*BLANK    WN0369  3        OHE Bookings Co
     C                     MOVEL*BLANK    WN0370  5        OHE EDI Error R
     C                     MOVEL*BLANK    WN0371  5        OHE EDI Error R
     C                     Z-ADD*ZERO     WN0372  50       HPB COA Batch N
     C                     MOVEL*BLANK    WN0373  6        OHE EDI 943 Act
     C                     MOVEL*BLANK    WN0374  6        OHE EDI 944 Act
     C                     MOVEL*BLANK    WN0375  6        OHE EDI 940 Act
     C                     MOVEL*BLANK    WN0376  6        OHE EDI 945 Act
     C                     MOVEL*BLANK    WN0377  1        OHE EDI 856 Act
     C                     MOVEL*BLANK    WN0378  1        OHE EDI 824 Act
     C                     MOVEL*BLANK    WN0379 10        OHE Transload S
     C                     MOVEL*BLANK    WN0380 10        OHE Abs Rate Ov
     C                     MOVEL*BLANK    WN0381 15        OHE Backhaul Co
     C                     MOVEL*BLANK    WN0382 15        OHE Backhaul Ch
     C                     MOVEL*BLANK    WN0383 15        OHE Transload C
     C                     MOVEL*BLANK    WN0384 30        OHE Pier Pass I
     C                     MOVEL*BLANK    WN0385 30        OHE Carrier Nm
     C                     MOVEL*BLANK    WN0386 50        OHE Backhaul Co
     C                     Z-ADD*ZERO     WN0387  30       OHE Backhaul Re
     C                     Z-ADD*ZERO     WN0388  30       LD Stop/Drop
     C                     Z-ADD*ZERO     WN0389  30       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0390  52       OHE Pier Pass F
     C                     Z-ADD*ZERO     WN0391  52       OHE Port Check
     C                     Z-ADD*ZERO     WN0392  50       OHE Port Cut Ti
     C                     Z-ADD*ZERO     WN0393  60       OHE Backhaul Tr
     C                     Z-ADD*ZERO     WN0394  60       OHE Load Sched
     C                     Z-ADD*ZERO     WN0395  60       Original Appoin
     C                     Z-ADD*ZERO     WN0396  60       Original Appoin
     C                     Z-ADD*ZERO     WN0397  90       OHE PowerPro Lo
     C                     Z-ADD*ZERO     WN0398  90       OHE PowerPro Lo
     C                     Z-ADD*ZERO     WN0399  90       OHE Unused Nume
     C                     Z-ADD*ZERO     WN0400  96       OHE Orig ABS Fr
     C                     MOVEL*BLANK    WN0401 15        OHE Genset Numb
     C                     MOVEL*BLANK    WN0402  1        OHE Email BOL/S
     C                     MOVEL*BLANK    WN0403  1        OHE Unused Stat
     C                     MOVEL*BLANK    WN0404  2        OHE Unused Stat
     C                     MOVEL*BLANK    WN0405  2        OHE Unused Stat
     C                     MOVEL*BLANK    WN0406  5        OHE Unused Text
     C                     MOVEL*BLANK    WN0407  5        OHE Unused Text
     C                     MOVEL*BLANK    WN0408 15        OHE Customer Ve
     C                     MOVEL*BLANK    WN0409 15        OHE Unused Text
     C                     MOVEL*BLANK    WN0410 30        OHE Unused Text
     C                     Z-ADD*ZERO     WN0411  70       OHE Unused Date
     C                     Z-ADD*ZERO     WN0412  70       OHE Unused Date
     C                     MOVEL*BLANK    WN0413  1        EDI Status 1
     C                     MOVEL*BLANK    WN0414  1        EDI Status 2
     C                     MOVEL*BLANK    WN0415  1        EDI Status 3
     C                     MOVEL*BLANK    WN0416  1        Record Status
     C                     Z-ADD*ZERO     WN0417  60       Job Time
     C                     MOVEL*BLANK    WN0418 10        User Id
     C                     MOVEL*BLANK    WN0419 10        Job Name
     C                     Z-ADD*ZERO     WN0420  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @AMREJE
     C                     Z-ADDBEAIC3    WFAIC3           Company Number
     C                     Z-ADDBEC4NB    WFC4NB           Order Number
      *
     C           KLCHSW    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFC4NB           Order Number
     C           KLCHSW    CHAIN@AMREJE              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PMAMREL0'MDACP
     C                     MOVEL'@AMREJE' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SWEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPMAM1    YDRDCS
      * Move non-key fields to @AMREJE
     C                     Z-ADD#DHEVL    WFHEVL           OHE HPB RIN Equ
     C                     Z-ADD#DHFVL    WFHFVL           OHE HPB RIN Pri
     C                     MOVEL#DC3TX    WFC3TX    P      OHE Spot Buy
     C                     MOVEL#DBOCD    WFCHTX    P      OHE Override Ty
     C                     MOVEL#DNLTX    WFLMT1    P      Delivery P.O. N
     C                     MOVELWULWAA    WFLWAA    P      OHE Intended fo
     C                     MOVEL#DV5T1    WFV5T1    P      OHE Appt Confir
     C                     MOVEL#DWBT1    WFWBT1    P      OHE Appt Confir
     C                     MOVELWUWDT1    WFWDT1    P      Letter of Credi
      *
      * Set PGM.*Record Data Changed flag
     C           QPMAM1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     Z-ADD##JDT     WFAXDT           Job Date
     C                     MOVEL##PGM     WFA0NA           Job Name
     C                     MOVEL##USR     WFAYNA           User Id
      * Set PGM.*Record Data Changed flag
     C           QPMAM1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@AMREJE                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPMAMREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * Upd Sales Route Code  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAIC3    WQSX01           Company Number
     C           *LIKE     DEFN WGC4NB    WQSX02           Order Number
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WQSX01           Company Number
     C                     KFLD           WQSX02           Order Number
      * Setup key
     C                     Z-ADDBEAIC3    WQSX01           Company Number
     C                     Z-ADDBEC4NB    WQSX02           Order Number
      * Establish starting position
     C           KRSSX     SETLL@BGWKL1                    *
     C           KRSSX     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Sales Route Code  CH - Order Detail  * 
     C                     EXSR SYCHRC
     C           KRSSX     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYCHRC    BEGSR
      *================================================================
      * CHG Sales Route Code  CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0421  70       Item Code
     C                     MOVEL*BLANK    WN0422  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0423  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0424  70       Order Group Cod
     C                     MOVEL*BLANK    WN0425  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0426  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0427 112       Billing Detail
     C                     Z-ADD*ZERO     WN0428 112       Billing Detail
     C                     Z-ADD*ZERO     WN0429 112       Billing Detail
     C                     Z-ADD*ZERO     WN0430 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0431  1        Comment Print A
     C                     MOVEL*BLANK    WN0432  1        Comment Print I
     C                     MOVEL*BLANK    WN0433  1        Comment Print P
     C                     MOVEL*BLANK    WN0434  1        Comment Print S
     C                     Z-ADD*ZERO     WN0435 112       Extended Amount
     C                     Z-ADD*ZERO     WN0436  70       Market Pricing
     C                     MOVEL*BLANK    WN0437  3        Commodity Marke
     C                     MOVEL*BLANK    WN0438  3        Date Method Cod
     C                     MOVEL*BLANK    WN0439  3        Price Method Co
     C                     Z-ADD*ZERO     WN0440 114       Price Overage O
     C                     Z-ADD*ZERO     WN0441  70       Contract Number
     C                     MOVEL*BLANK    WN0442  1        Price Status
     C                     Z-ADD*ZERO     WN0443  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0444  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0445  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0446  1        Work Confirm St
     C                     MOVEL*BLANK    WN0447  1        Work Over/Short
     C                     MOVEL*BLANK    WN0448  1        OD Production P
     C                     MOVEL*BLANK    WN0449 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0450 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0451  1        Age Code
     C                     MOVEL*BLANK    WN0452  1        Palletize
     C                     MOVEL*BLANK    WN0453  1        Slip Sheet
     C                     MOVEL*BLANK    WN0454  1        Catch Weight St
     C                     MOVEL*BLANK    WN0455  1        Price Audit
     C                     MOVEL*BLANK    WN0456  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0457  1        Production Date
     C                     Z-ADD*ZERO     WN0458 112       Rated Freight
     C                     Z-ADD*ZERO     WN0459 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0460 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0461 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0462 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0463 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0464 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0465 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0466 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0467 114       Unit Price
     C                     Z-ADD*ZERO     WN0468 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0469 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0470 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0471 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0472  70       Requested Ship
     C                     Z-ADD*ZERO     WN0473  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0474  70       Actual Shipped
     C                     MOVEL*BLANK    WN0475  1        Affect Inventor
     C                     MOVEL*BLANK    WN0476  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0477  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0478  30       Item Structure
     C                     Z-ADD*ZERO     WN0479  30       Item Structure
     C                     Z-ADD*ZERO     WN0480  30       Item Structure
     C                     MOVEL*BLANK    WN0481  2        Item Level
     C                     MOVEL*BLANK    WN0482  2        Quality Level
     C                     MOVEL*BLANK    WN0483  2        Pricing Product
     C                     MOVEL*BLANK    WN0484  2        Season Product
     C                     Z-ADD*ZERO     WN0485  70       Date of Origina
     C                     MOVEL*BLANK    WN0486 10        User Profile Na
     C                     MOVEL*BLANK    WN0487  6        Country Code
     C                     MOVEL*BLANK    WN0488  2        Event Code
     C                     MOVEL*BLANK    WN0489  3        Reason Code
     C                     MOVEL*BLANK    WN0490  1        Modified Flag
     C                     MOVEL*BLANK    WN0491  1        Substituted Fla
     C                     MOVEL*BLANK    WN0492  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0493 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0494 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0495  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0496  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0497  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0498  1        Affect Commissi
     C                     MOVEL*BLANK    WN0499  1        Affect Pricing
     C                     MOVEL*BLANK    WN0500  1        Released by Use
     C                     MOVEL*BLANK    WN0501  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0502  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0503  3        Production Ware
     C                     MOVEL*BLANK    WN0504  3        OD Price Type
     C                     Z-ADD*ZERO     WN0505  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0506  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0507  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0508  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0509  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0510  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0511  60       Price Code
     C                     Z-ADD*ZERO     WN0512  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0513  60       Substitution Li
     C                     Z-ADD*ZERO     WN0514  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0515 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0516 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0517 112       OD Item Target
     C                     Z-ADD*ZERO     WN0518 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0519 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0520 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0521 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0522 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0523 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0524 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0525 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0526 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0527 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0528  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0529  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0530  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0531 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0532  40       Item Age Days
     C                     Z-ADD*ZERO     WN0533  70       Production Ovr
     C                     Z-ADD*ZERO     WN0534  70       Production Ovr
     C                     MOVEL*BLANK    WN0535  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0536  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0537  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0538  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0539  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0540  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0541  1        EDI Status 1
     C                     MOVEL*BLANK    WN0542  1        EDI Status 2
     C                     MOVEL*BLANK    WN0543  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0544  60       Job Time
     C                     MOVEL*BLANK    WN0545 10        User Id
     C                     MOVEL*BLANK    WN0546 10        Job Name
     C                     Z-ADD*ZERO     WN0547  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWGAIC3    WHAIC3           Company Number
     C                     Z-ADDWGC4NB    WHC4NB           Order Number
     C                     Z-ADDWGDPNB    WHDPNB           Order Sequence
     C                     Z-ADDWGUENB    WHUENB           Order Secondary
      *
     C           KLCHSY    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHC4NB           Order Number
     C                     KFLD           WHDPNB           Order Sequence
     C                     KFLD           WHUENB           Order Secondary
     C           KLCHSY    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SYEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YERDCS
      * Move non-key fields to @BGWKL0
     C                     MOVEL#1R4CD    WHR4CD    P      Sales Route Cod
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##JOB     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * RTV Chg LD APPT/CNFRM RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIAIC3    WQSZ01           Company Number
     C           *LIKE     DEFN WIC4NB    WQSZ02           Order Number
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WQSZ01           Company Number
     C                     KFLD           WQSZ02           Order Number
      * Setup key
     C                     Z-ADDBEAIC3    WQSZ01           Company Number
     C                     Z-ADDBEC4NB    WQSZ02           Order Number
      * Establish starting position
     C           KRSSZ     SETLL@FLCPW9                    *
     C           KRSSZ     READE@FLCPW9                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWIN7DT    YL0033           LD Carrier Appt
     C                     Z-ADDWIB3TM    YL0034           LD Carrier Appt
      * Upd Ld Carr Appt if Sls Appt is entered
      * CASE: PAR.LD Sls Appt Confirm Dt is Entered
     C           #1NODT    IFGT 0                          *IF
     C                     Z-ADD#DN7DT    YL0033           LD Carrier Appt
     C           YL0032    MULT 100       YL0034           LD Carrier Appt
     C                     END                             *FI
      * Blank out Ld Carr Appt if Sls Appt is now blank AND WAS entered b
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.LD Sls Appt Confirm Dt is Zero
      *   |- c2    : DB1.LD Sls Appt Confirm Dt is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1NODT    IFEQ 0                          *IF
     C           WIN8DT    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD*ZERO     YL0033           LD Carrier Appt
     C                     Z-ADD*ZERO     YL0034           LD Carrier Appt
     C                     END                             *FI
      * Chg LD APPT/CNFRM    CH - Load Detail  * 
     C                     EXSR TACHRC
     C           KRSSZ     READE@FLCPW9                  90*
     C                     ENDDO
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TACHRC    BEGSR
      *================================================================
      * Chg LD APPT/CNFRM    CH - Load Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0548 30        Comments for Pi
     C                     Z-ADD*ZERO     WN0549  50       Miles to next s
     C                     Z-ADD*ZERO     WN0550  72       Freight Charge
     C                     Z-ADD*ZERO     WN0551  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0552 112       Freight Misc. C
     C                     Z-ADD*ZERO     WN0553  72       Freight Stop Ch
     C                     Z-ADD*ZERO     WN0554 112       Rated Freight
     C                     Z-ADD*ZERO     WN0555  30       Company Number
     C                     Z-ADD*ZERO     WN0556  70       Order Number
     C                     MOVEL*BLANK    WN0557  1        Ship Status
     C                     Z-ADD*ZERO     WN0558  70       Estimated Arriv
     C                     Z-ADD*ZERO     WN0559  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0560  70       Appointment Con
     C                     Z-ADD*ZERO     WN0561  60       Appointment Con
     C                     Z-ADD*ZERO     WN0562  70       Actual Delivery
     C                     Z-ADD*ZERO     WN0563  60       Actual Delivery
     C                     Z-ADD*ZERO     WN0564  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0565  60       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0566  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0567  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0568  70       On Yard Date
     C                     Z-ADD*ZERO     WN0569  60       On Yard Time
     C                     Z-ADD*ZERO     WN0570  70       MPC Number
     C                     MOVEL*BLANK    WN0571  1        Load Dtl On Tim
     C                     MOVEL*BLANK    WN0572  1        On Time Add'l R
     C                     MOVEL*BLANK    WN0573 15        Seal Nbr 1
     C                     MOVEL*BLANK    WN0574 15        Seal Nbr 2
     C                     MOVEL*BLANK    WN0575 15        Seal Nbr 3
     C                     MOVEL*BLANK    WN0576 15        Seal Nbr 4
     C                     MOVEL*BLANK    WN0577 15        Seal Nbr 5
     C                     Z-ADD*ZERO     WN0578  70       LD Unused Date
     C                     Z-ADD*ZERO     WN0579  60       LD Unused Time
     C                     MOVEL*BLANK    WN0580  1        Miles Error Sts
     C                     MOVEL*BLANK    WN0581  1        LD Unused Sts 2
     C                     MOVEL*BLANK    WN0582  2        HPB Transload S
     C                     MOVEL*BLANK    WN0583 15        LD Cst Svc Trac
     C                     MOVEL*BLANK    WN0584 25        Carrier Ref PRO
     C                     MOVEL*BLANK    WN0585 25        Cust Assigned A
     C                     MOVEL*BLANK    WN0586  1        EDI Status 1
     C                     MOVEL*BLANK    WN0587  1        EDI Status 2
     C                     MOVEL*BLANK    WN0588  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0589  60       Job Time
     C                     MOVEL*BLANK    WN0590 10        User Id
     C                     MOVEL*BLANK    WN0591 10        Job Name
     C                     Z-ADD*ZERO     WN0592  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @FLCPBM
     C                     Z-ADDWIRMNB    WJRMNB           Load ID
     C                     Z-ADDWIRUNB    WJRUNB           Stop/Drop Seque
      *
     C           KLCHTA    KLIST
     C                     KFLD           WJRMNB           Load ID
     C                     KFLD           WJRUNB           Stop/Drop Seque
     C           KLCHTA    CHAIN@FLCPBM              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFLCPL0'MDACP
     C                     MOVEL'@FLCPBM' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TAEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFL1    YFRDCS
      * Move non-key fields to @FLCPBM
     C                     Z-ADDWIRVNB    WJRVNB           Stop/Drop
     C                     MOVEL#DWBT1    WJK5TX    P      Confirmation Ma
     C                     MOVEL#DV5T1    WJW5CD    P      Confirmation Nu
     C                     Z-ADDYL0033    WJN7DT           LD Carrier Appt
     C                     Z-ADD#1NODT    WJN8DT           LD Unused Date
     C                     Z-ADDYL0034    WJB3TM           LD Carrier Appt
     C                     Z-ADD#1BRTM    WJB4TM           LD Unused Time
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##JOB     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@FLCPBM                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFLCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0593    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSTB     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    P2I6ST           Allow Multi-Com
     C                     MOVELDRMPNA    WUG0TX           Default Printer
     C                     MOVELDRBCCD    P2BCCD           Salesperson Cod
     C                     Z-ADDDRAIC3    YL0035           Company Number
     C                     MOVELDRBUVN    WN0594           User Code Model
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - User Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0022    DTAJVN           User Profile Na
     C                     MOVELWL0023    DTDNCD           Application Cod
      * Establish starting position
     C           KRSTC     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0024           Company Number
     C                     MOVELDTAJCD    WL0025           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQTD01           Application Cod
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WQTD01           Application Cod
      * Setup key
     C                     MOVELP2DNCD    WQTD01           Application Cod
      * Establish starting position
     C           KRSTD     SETLL@DNRESF                    *
     C           KRSTD     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR TERVGN
     C                     END                             *FI
     C           KRSTD     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQTE01           Application Cod
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           WQTE01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQTE01           Application Cod
      * Establish starting position
     C           KRSTE     SETLL@DNRESF                    *
     C           KRSTE     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSTE     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Select existing record
      *================================================================
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C                     MOVELV1C4NB    WK1X02  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     C           WK1X02    OREQ '?'                        Order Number
     C           YPMTFD    OREQ '#1C4NB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1AIC3' defaulted for 'Company Number'.
      * Field '(KEY) #1C4NB' defaulted for 'Order Number'.
     C                     CALL 'PDPCSRR'              90  SEL Order
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0003  30       Company Number
     C           #1C4NB    PARM #1C4NB    WQ0004  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPCSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     993132*
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1C4NB    IFNE *ZERO                      Order Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Company Name and Address
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1AIC3' defaulted for 'Company Number'.
     C                     CALL 'CAAJSRR'              90  SEL Company by
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0005  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAAJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9931  *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AIC3    IFEQ *ZERO                      Company Number
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBWA    KLIST
     C                     KFLD           WAAIC3           Company Number
      * Setup key
     C                     Z-ADD#1AIC3    WAAIC3
     C           KLVBWA    CHAIN@ABREUA              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Company Name and Addre NF'
     C                     MOVEL'USR0003' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0003' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Order Types
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1JNCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Order Type - Sa
     C           YPMTFD    OREQ '#1JNCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1JNCD' defaulted for 'Order Type - Sales'.
     C                     CALL 'PDZ2SRR'              90  SEL OP Order Ty
     C                     PARM *BLANK    W0RTN   7
     C           #1JNCD    PARM #1JNCD    WQ0011  2        Order Type - Sa
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDZ2SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1JNCD    IFNE *BLANK                     Order Type - Sa
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1JNCD    IFEQ *BLANK                     Order Type - Sa
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCEX    KLIST
     C                     KFLD           EXJNCD           Order Type - Sa
      * Setup key
     C                     MOVEL#1JNCD    EXJNCD
     C           KLVCEX    CHAIN@EXRETY              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Order Types            NF'
     C                     MOVEL'USR1063' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1063' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to Customer
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1ANC7'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1ANC7' defaulted for 'A/R Customer Number'.
     C                     CALL 'PDCJSRR'              90  SEL Customer by
     C                     PARM *BLANK    W0RTN   7
     C           #1ANC7    PARM #1ANC7    WQ0012  70       Ship To Custome
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1ANC7    IFNE *ZERO                      Ship To Custome
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VDEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1ANC7    IFEQ *ZERO                      Ship To Custome
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDBB    KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1ANC7    BBBKC7
     C           KLVDBB    CHAIN@BBREWG              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VDEXIT
     C                     END
      * Send message 'Customer               NF'
     C                     MOVEL'USR0170' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0170' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         VECKRL    BEGSR
      *================================================================
      * Check reference to Customer
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1BKC7'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1BKC7' defaulted for 'Ship To Customer'.
     C                     CALL 'PDCJSRR'              90  SEL Customer by
     C                     PARM *BLANK    W0RTN   7
     C           #1BKC7    PARM #1BKC7    WQ0013  70       Ship To Custome
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1BKC7    IFNE *ZERO                      Ship To Custome
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VEEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1BKC7    IFEQ *ZERO                      Ship To Custome
     C                     GOTO VEEXIT
     C                     END
      *
     C           KLVEBB    KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1BKC7    BBBKC7
     C           KLVEBB    CHAIN@BBREWG              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VEEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VEEXIT
     C                     END
      * Send message 'Customer               NF'
     C                     MOVEL'USR0170' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0170' W0RTN
      *================================================================
     CSR         VEEXIT    ENDSR
      /EJECT
     CSR         VFCKRL    BEGSR
      *================================================================
      * Check reference to State
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DBCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        State Code
     C           YPMTFD    OREQ '#1DBCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1DBCD' defaulted for 'Ship To State Code'.
     C                     CALL 'CAAHSRR'              90  SEL State
     C                     PARM *BLANK    W0RTN   7
     C           #1DBCD    PARM #1DBCD    WQ0014  2        State Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAAHSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1DBCD    IFNE *BLANK                     State Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VFEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DBCD    IFEQ *BLANK                     State Code
     C                     GOTO VFEXIT
     C                     END
      *
     C           KLVFAC    KLIST
     C                     KFLD           ACBGCD           State Code
      * Setup key
     C                     MOVEL#1DBCD    ACBGCD
     C           KLVFAC    CHAIN@ACRET7              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VFEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VFEXIT
     C                     END
      * Send message 'State                  NF'
     C                     MOVEL'USR0005' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0005' W0RTN
      *================================================================
     CSR         VFEXIT    ENDSR
      /EJECT
     CSR         VGCKRL    BEGSR
      *================================================================
      * Check reference to Customer
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1B0C7'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1B0C7' defaulted for 'Bill to Customer'.
     C                     CALL 'PDCJSRR'              90  SEL Customer by
     C                     PARM *BLANK    W0RTN   7
     C           #1B0C7    PARM #1B0C7    WQ0015  70       Ship To Custome
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1B0C7    IFNE *ZERO                      Ship To Custome
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VGEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1B0C7    IFEQ *ZERO                      Ship To Custome
     C                     GOTO VGEXIT
     C                     END
      *
     C           KLVGBB    KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1B0C7    BBBKC7
     C           KLVGBB    CHAIN@BBREWG              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VGEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VGEXIT
     C                     END
      * Send message 'Customer               NF'
     C                     MOVEL'USR0170' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0170' W0RTN
      *================================================================
     CSR         VGEXIT    ENDSR
      /EJECT
     CSR         VHCKRL    BEGSR
      *================================================================
      * Check reference to State
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1BHCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        State Code
     C           YPMTFD    OREQ '#1BHCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1BHCD' defaulted for 'Bill to State Code'.
     C                     CALL 'CAAHSRR'              90  SEL State
     C                     PARM *BLANK    W0RTN   7
     C           #1BHCD    PARM #1BHCD    WQ0016  2        State Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAAHSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1BHCD    IFNE *BLANK                     State Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VHEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1BHCD    IFEQ *BLANK                     State Code
     C                     GOTO VHEXIT
     C                     END
      *
     C           KLVHAC    KLIST
     C                     KFLD           ACBGCD           State Code
      * Setup key
     C                     MOVEL#1BHCD    ACBGCD
     C           KLVHAC    CHAIN@ACRET7              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VHEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VHEXIT
     C                     END
      * Send message 'State                  NF'
     C                     MOVEL'USR0005' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0005' W0RTN
      *================================================================
     CSR         VHEXIT    ENDSR
      /EJECT
     CSR         VICKRL    BEGSR
      *================================================================
      * Check reference to Calendar
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1A0DT    IFEQ *ZERO                      Post to G/L Dat
     C                     GOTO VIEXIT
     C                     END
      *
     C           KLVIAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1A0DT    AFBCDT
     C           KLVIAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VIEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VIEXIT
     C                     END
      * Send message 'Calendar not found'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VIEXIT    ENDSR
      /EJECT
     CSR         VJCKRL    BEGSR
      *================================================================
      * Check reference to Calendar
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1A5DT    IFEQ *ZERO                      Post to G/L Dat
     C                     GOTO VJEXIT
     C                     END
      *
     C           KLVJAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1A5DT    AFBCDT
     C           KLVJAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VJEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VJEXIT
     C                     END
      * Send message 'Calendar not found'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VJEXIT    ENDSR
      /EJECT
     CSR         VKCKRL    BEGSR
      *================================================================
      * Check reference to Calendar
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1GNDT    IFEQ *ZERO                      Post to G/L Dat
     C                     GOTO VKEXIT
     C                     END
      *
     C           KLVKAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1GNDT    AFBCDT
     C           KLVKAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VKEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VKEXIT
     C                     END
      * Send message 'Calendar not found'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VKEXIT    ENDSR
      /EJECT
     CSR         VLCKRL    BEGSR
      *================================================================
      * Check reference to Calendar
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1ACDT    IFEQ *ZERO                      Post to G/L Dat
     C                     GOTO VLEXIT
     C                     END
      *
     C           KLVLAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1ACDT    AFBCDT
     C           KLVLAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VLEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VLEXIT
     C                     END
      * Send message 'Calendar not found'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VLEXIT    ENDSR
      /EJECT
     CSR         VMCKRL    BEGSR
      *================================================================
      * Check reference to Terms
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1AQCD    WK1X02  1
     C           WK1X02    IFEQ '?'                        Terms Code
     C           YPMTFD    OREQ '#1AQCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1AQCD' defaulted for 'Terms Code'.
     C                     CALL 'PDDMSRR'              90  SEL Active Term
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0017  30       Company Number
     C           #1AQCD    PARM #1AQCD    WQ0018  2        Terms Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDDMSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AQCD    IFNE *BLANK                     Terms Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VMEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AQCD    IFEQ *BLANK                     Terms Code
     C                     GOTO VMEXIT
     C                     END
      *
     C           KLVMAO    KLIST
     C                     KFLD           AOAIC3           Company Number
     C                     KFLD           AOAQCD           Terms Code
      * Setup key
     C                     Z-ADD#1AIC3    AOAIC3
     C                     MOVEL#1AQCD    AOAQCD
     C           KLVMAO    CHAIN@AOREU1              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VMEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VMEXIT
     C                     END
      * Send message 'Terms                  NF'
     C                     MOVEL'USR0037' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0037' W0RTN
      *================================================================
     CSR         VMEXIT    ENDSR
      /EJECT
     CSR         VNCKRL    BEGSR
      *================================================================
      * Check reference to Carrier
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1BZNA    WK1X01  1
     C           WK1X01    IFEQ '?'                        Carrier Code
     C           YPMTFD    OREQ '#1BZNA'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1BZNA' defaulted for 'Carrier Code'.
     C                     CALL 'OMY6SRR'              90  SEL Active Carr
     C                     PARM *BLANK    W0RTN   7
     C           #1BZNA    PARM #1BZNA    WQ0019  3        Carrier Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMY6SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1BZNA    IFNE *BLANK                     Carrier Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VNEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1BZNA    IFEQ *BLANK                     Carrier Code
     C                     GOTO VNEXIT
     C                     END
      *
     C           KLVNFF    KLIST
     C                     KFLD           FFBZNA           Carrier Code
      * Setup key
     C                     MOVEL#1BZNA    FFBZNA
     C           KLVNFF    CHAIN@FFREUG              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VNEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VNEXIT
     C                     END
      * Send message 'Carrier                NF'
     C                     MOVEL'USR1180' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1180' W0RTN
      *================================================================
     CSR         VNEXIT    ENDSR
      /EJECT
     CSR         VOCKRL    BEGSR
      *================================================================
      * Check reference to OP Reason Codes
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1CQCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Reason Code
     C           YPMTFD    OREQ '#1CQCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1CQCD' defaulted for 'Reason Code'.
     C                     CALL 'OPTNSRR'              90  SEL Order Reaso
     C                     PARM *BLANK    W0RTN   7
     C           #1CQCD    PARM #1CQCD    WQ0020  3        Reason Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OPTNSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1CQCD    IFNE *BLANK                     Reason Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VOEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1CQCD    IFEQ *BLANK                     Reason Code
     C                     GOTO VOEXIT
     C                     END
      *
     C           KLVOCX    KLIST
     C                     KFLD           CXCQCD           Reason Code
      * Setup key
     C                     MOVEL#1CQCD    CXCQCD
     C           KLVOCX    CHAIN@CXRET4              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VOEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VOEXIT
     C                     END
      * Send message 'OP Reason Codes        NF'
     C                     MOVEL'USR0504' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0504' W0RTN
      *================================================================
     CSR         VOEXIT    ENDSR
      /EJECT
     CSR         VPCKRL    BEGSR
      *================================================================
      * Check reference to Calendar
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1AODT    IFEQ *ZERO                      Post to G/L Dat
     C                     GOTO VPEXIT
     C                     END
      *
     C           KLVPAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1AODT    AFBCDT
     C           KLVPAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VPEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VPEXIT
     C                     END
      * Send message 'Calendar not found'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VPEXIT    ENDSR
      /EJECT
     CSR         VQCKRL    BEGSR
      *================================================================
      * Check reference to User Profile Control
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1AIVN    WK1X01  1
     C           WK1X01    IFEQ '?'                        User Profile Na
     C           YPMTFD    OREQ '#1AIVN'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIVN' defaulted for 'User Original Entry'.
     C                     CALL 'CAXPSRR'              90  SEL User Profil
     C                     PARM *BLANK    W0RTN   7
     C           #1AIVN    PARM #1AIVN    WQ0021 10        User Profile Na
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAXPSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AIVN    IFNE *BLANK                     User Profile Na
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VQEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AIVN    IFEQ *BLANK                     User Profile Na
     C                     GOTO VQEXIT
     C                     END
      *
     C           KLVQDR    KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVEL#1AIVN    DRAJVN
     C           KLVQDR    CHAIN@DRRETH              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VQEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VQEXIT
     C                     END
      * Send message 'User Profile Control   NF'
     C                     MOVEL'USR0763' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0763' W0RTN
      *================================================================
     CSR         VQEXIT    ENDSR
      /EJECT
     CSR         VRCKRL    BEGSR
      *================================================================
      * Check reference to Calendar
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1EIDT    IFEQ *ZERO                      Post to G/L Dat
     C                     GOTO VREXIT
     C                     END
      *
     C           KLVRAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1EIDT    AFBCDT
     C           KLVRAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VREXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VREXIT
     C                     END
      * Send message 'Calendar not found'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VREXIT    ENDSR
      /EJECT
     CSR         VSCKRL    BEGSR
      *================================================================
      * Check reference to Enterprise Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1E8CD    WK1X02  1
     C                     MOVEL#1E9CD    WK1X03  1
     C           WK1X02    IFEQ '?'                        Enterprise Code
     C           YPMTFD    OREQ '#1E8CD'
     C           WK1X03    OREQ '?'                        Enterprise Code
     C           YPMTFD    OREQ '#1E9CD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1E8CD' defaulted for 'Accounts Receiv. Ent 1'.
      * Field '(DTL) #1E9CD' defaulted for 'Accounts Receiv. Ent 2'.
     C                     CALL 'CAXTSRR'              90  SEL Enterprise
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0022  30       Company Number
     C           #1E8CD    PARM #1E8CD    WQ0023  4        Enterprise Code
     C           #1E9CD    PARM #1E9CD    WQ0024 12        Enterprise Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAXTSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1E8CD    IFNE *BLANK                     Enterprise Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1E9CD    IFNE *BLANK                     Enterprise Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X03    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VSEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1E8CD    IFEQ *BLANK                     Enterprise Code
     C           #1E9CD    ANDEQ*BLANK                     Enterprise Code
     C                     GOTO VSEXIT
     C                     END
      *
     C           KLVSDS    KLIST
     C                     KFLD           DSAIC3           Company Number
     C                     KFLD           DSDQCD           Enterprise Code
     C                     KFLD           DSDRCD           Enterprise Code
      * Setup key
     C                     Z-ADD#1AIC3    DSAIC3
     C                     MOVEL#1E8CD    DSDQCD
     C                     MOVEL#1E9CD    DSDRCD
     C           KLVSDS    CHAIN@DSRETN              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VSEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VSEXIT
     C                     END
      * Send message 'Enterprise Master      NF'
     C                     MOVEL'USR0765' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0765' W0RTN
      *================================================================
     CSR         VSEXIT    ENDSR
      /EJECT
     CSR         VTCKRL    BEGSR
      *================================================================
      * Check reference to Load Header
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1RMNB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1RMNB' defaulted for 'Load ID'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
     C                     CALL 'OMCPSRR'              90  SEL Load ID
     C                     PARM *BLANK    W0RTN   7
     C           #1RMNB    PARM #1RMNB    WQ0025  70       Load ID
     C           #1AIC3    PARM #1AIC3    WQ0026  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMCPSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1RMNB    IFNE *ZERO                      Load ID
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VTEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RMNB    IFEQ *ZERO                      Load ID
     C                     GOTO VTEXIT
     C                     END
      *
     C           KLVTFJ    KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    FJRMNB
     C           KLVTFJ    CHAIN@FJCPBN              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VTEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VTEXIT
     C                     END
      * Send message 'Load Header            NF'
     C                     MOVEL'USR1188' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1188' W0RTN
      *================================================================
     CSR         VTEXIT    ENDSR
      /EJECT
     CSR         VUCKRL    BEGSR
      *================================================================
      * Check reference to Sales Route
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1R4CD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Sales Route Cod
     C           YPMTFD    OREQ '#1R4CD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1R4CD' defaulted for 'Sales Route Code'.
     C                     CALL 'PDFWSRR'              90  SEL PD Sales Ro
     C                     PARM *BLANK    W0RTN   7
     C           #1R4CD    PARM #1R4CD    WQ0027  3        Sales Route Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDFWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9931  *
     C                     END
      *
     C           #1R4CD    IFNE *BLANK                     Sales Route Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VUEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1R4CD    IFEQ *BLANK                     Sales Route Cod
     C                     GOTO VUEXIT
     C                     END
      *
     C           KLVUJE    KLIST
     C                     KFLD           JER4CD           Sales Route Cod
      * Setup key
     C                     MOVEL#1R4CD    JER4CD
     C           KLVUJE    CHAIN@JEREWS              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VUEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VUEXIT
     C                     END
      * Send message 'Sales Route            NF'
     C                     MOVEL'USR1800' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1800' W0RTN
      *================================================================
     CSR         VUEXIT    ENDSR
      /EJECT
     CSR         VVCKRL    BEGSR
      *================================================================
      * Check reference to Manager Level
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1BFCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Manager Level C
     C           YPMTFD    OREQ '#1BFCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1BFCD' defaulted for 'Manager Level Code'.
     C                     CALL 'CABRSRR'              90  SEL Manager Lev
     C                     PARM *BLANK    W0RTN   7
     C           #1BFCD    PARM #1BFCD    WQ0028  2        Manager Level C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CABRSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1BFCD    IFNE *BLANK                     Manager Level C
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VVEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1BFCD    IFEQ *BLANK                     Manager Level C
     C                     GOTO VVEXIT
     C                     END
      *
     C           KLVVAL    KLIST
     C                     KFLD           ALBFCD           Manager Level C
      * Setup key
     C                     MOVEL#1BFCD    ALBFCD
     C           KLVVAL    CHAIN@ALREVE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VVEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VVEXIT
     C                     END
      * Send message 'Manager Level          NF'
     C                     MOVEL'USR0030' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0030' W0RTN
      *================================================================
     CSR         VVEXIT    ENDSR
      /EJECT
     CSR         VWCKRL    BEGSR
      *================================================================
      * Check reference to VP Level
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1Q4CD    WK1X01  1
     C           WK1X01    IFEQ '?'                        VP Level Code
     C           YPMTFD    OREQ '#1Q4CD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1Q4CD' defaulted for 'VP Level Code'.
     C                     CALL 'PDE0SRR'              90  SEL VP Level Ac
     C                     PARM *BLANK    W0RTN   7
     C           #1Q4CD    PARM #1Q4CD    WQ0029  3        VP Level Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDE0SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1Q4CD    IFNE *BLANK                     VP Level Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VWEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1Q4CD    IFEQ *BLANK                     VP Level Code
     C                     GOTO VWEXIT
     C                     END
      *
     C           KLVWIF    KLIST
     C                     KFLD           IFQ4CD           VP Level Code
      * Setup key
     C                     MOVEL#1Q4CD    IFQ4CD
     C           KLVWIF    CHAIN@IFREWB              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VWEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VWEXIT
     C                     END
      * Send message 'VP Level               NF'
     C                     MOVEL'USR1661' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1661' W0RTN
      *================================================================
     CSR         VWEXIT    ENDSR
      /EJECT
     CSR         VXCKRL    BEGSR
      *================================================================
      * Check reference to Order Header TRG
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1T3NB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1T3NB' defaulted for 'Attach to Order Number'.
     C                     CALL 'PDPCSRR'              90  SEL Order
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0030  30       Company Number
     C           #1T3NB    PARM #1T3NB    WQ0031  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPCSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1T3NB    IFNE *ZERO                      Order Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VXEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1T3NB    IFEQ *ZERO                      Order Number
     C                     GOTO VXEXIT
     C                     END
      *
     C           KLVXBE    KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    BEAIC3
     C                     Z-ADD#1T3NB    BEC4NB
     C           KLVXBE    CHAIN@BECPFK              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VXEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VXEXIT
     C                     END
      * Send message 'Order Header TRG       NF'
     C                     MOVEL'USR0176' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0176' W0RTN
      *================================================================
     CSR         VXEXIT    ENDSR
      /EJECT
     CSR         VYCKRL    BEGSR
      *================================================================
      * Check reference to Internal Reason
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1SICD    IFEQ *BLANK                     Internal Reason
     C                     GOTO VYEXIT
     C                     END
      *
     C           KLVYJH    KLIST
     C                     KFLD           JHSGCD           Internal Reason
      * Setup key
     C                     MOVEL#1SICD    JHSGCD
     C           KLVYJH    CHAIN@JHREXO              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VYEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VYEXIT
     C                     END
      * Send message 'Internal Reason        NF'
     C                     MOVEL'USR1835' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1835' W0RTN
      *================================================================
     CSR         VYEXIT    ENDSR
      /EJECT
     CSR         VZCKRL    BEGSR
      *================================================================
      * Check reference to Calendar
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1AWDT    IFEQ *ZERO                      Post to G/L Dat
     C                     GOTO VZEXIT
     C                     END
      *
     C           KLVZAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1AWDT    AFBCDT
     C           KLVZAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VZEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VZEXIT
     C                     END
      * Send message 'Calendar not found'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VZEXIT    ENDSR
      /EJECT
     CSR         WACKRL    BEGSR
      *================================================================
      * Check reference to Event Types
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1JPCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Event Code
     C           YPMTFD    OREQ '#1JPCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1JPCD' defaulted for 'Event Code'.
     C                     CALL 'PDEQSRR'              90  SEL Event Types
     C                     PARM *BLANK    W0RTN   7
     C           #1JPCD    PARM #1JPCD    WQ0032  2        Event Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEQSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1JPCD    IFNE *BLANK                     Event Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO WAEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1JPCD    IFEQ *BLANK                     Event Code
     C                     GOTO WAEXIT
     C                     END
      *
     C           KLWAEZ    KLIST
     C                     KFLD           EZJPCD           Event Code
      * Setup key
     C                     MOVEL#1JPCD    EZJPCD
     C           KLWAEZ    CHAIN@EZREYT              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO WAEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO WAEXIT
     C                     END
      * Send message 'Event Types            NF'
     C                     MOVEL'USR1076' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1076' W0RTN
      *================================================================
     CSR         WAEXIT    ENDSR
      /EJECT
     CSR         WBCKRL    BEGSR
      *================================================================
      * Check reference to A/R Claim
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1C0C7'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1C0C7' defaulted for 'Claim Number'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(LCL) YL0005' defaulted for 'Claim Company Number'.
      * Field '(LCL) YL0006' defaulted for 'Claim Ship to Customer'.
     C                     CALL 'PMCSSRR'              90  Sel A/R Claim
     C                     PARM *BLANK    W0RTN   7
     C           #1C0C7    PARM #1C0C7    WQ0033  70       Claim Number
     C           YL0005    PARM YL0005    WQ0034  30       Claim Company N
     C           YL0006    PARM YL0006    WQ0035  70       Claim Ship to C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCSSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1C0C7    IFNE *ZERO                      Claim Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO WBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1C0C7    IFEQ *ZERO                      Claim Number
     C                     GOTO WBEXIT
     C                     END
      *
     C           KLWBMK    KLIST
     C                     KFLD           MKC0C7           Claim Number
      * Setup key
     C                     Z-ADD#1C0C7    MKC0C7
     C           KLWBMK    CHAIN@MKCPWB              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO WBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO WBEXIT
     C                     END
      * Send message 'A/R Claim              NF'
     C                     MOVEL'USR2729' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR2729' W0RTN
      *================================================================
     CSR         WBEXIT    ENDSR
      /EJECT
     CSR         WCCKRL    BEGSR
      *================================================================
      * Check reference to Company Name and Address
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1AIC3' defaulted for 'Company Number'.
     C                     CALL 'CAAJSRR'              90  SEL Company by
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0040  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAAJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9931  *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO WCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AIC3    IFEQ *ZERO                      Company Number
     C                     GOTO WCEXIT
     C                     END
      *
     C           KLWCWA    KLIST
     C                     KFLD           WAAIC3           Company Number
      * Setup key
     C                     Z-ADD#1AIC3    WAAIC3
     C           KLWCWA    CHAIN@ABREUA              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO WCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO WCEXIT
     C                     END
      * Send message 'Company Name and Addre NF'
     C                     MOVEL'USR0003' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0003' W0RTN
      *================================================================
     CSR         WCEXIT    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         XTCKTM    BEGSR
      *================================================================
      * Validate time format
      *================================================================
      * If time is zero, do not check
     C           XTTIM     CABEQ*ZERO     XTCKTE
     C                     MOVEL*BLANK    W0RTN   7
     C           YPMTFD    CABNE*BLANK    XTCKTE
      *
      * Check hours in range 0 to 23
      * Check minutes in range 0 to 59
      * Check seconds in range 0 to 59
     C           XTHH      IFLT *ZERO
     C           XTHH      ORGT 23
     C           XTNN      ORLT *ZERO
     C           XTNN      ORGT 59
     C           XTSS      ORLT *ZERO
     C           XTSS      ORGT 59
      * Send error message
      * Send message '*Invalid time'
     C                     MOVEL'Y2U0019' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0019' W0RTN
     C                     END
      *================================================================
     CSR         XTCKTE    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y1SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y1EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C           @#DFMT    IFEQ '#RCDKEY'
      * KEY Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C                     ENDIF
     C           @#DFMT    IFEQ '#RCDDTL1'
      * DETAIL Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW1END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW1BEG,F
     C                     MOVELW1NAM,F   W0CFL
     C                     ENDIF
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           ZHCSRW    IFEQ 004
     C           ZHCSCL    ANDGE021
     C           ZHCSCL    ANDLE023
     C           @#DFMT    ANDEQ'#RCDKEY'
     C                     MOVEL'#1AIC3'  YPMTFD           Company Number
     C                     END
      *
     C           ZHCSRW    IFEQ 005
     C           ZHCSCL    ANDGE021
     C           ZHCSCL    ANDLE027
     C           @#DFMT    ANDEQ'#RCDKEY'
     C                     MOVEL'#1C4NB'  YPMTFD           Order Number
     C                     END
      *
     C           ZHCSRW    IFEQ 009
     C           ZHCSCL    ANDGE032
     C           ZHCSCL    ANDLE034
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1R4CD'  YPMTFD           Sales Route Cod
     C                     END
      *
     C           ZHCSRW    IFEQ 014
     C           ZHCSCL    ANDEQ032
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1FNSX'  YPMTFD           Transfer in Sto
     C                     END
      *
     C           ZHCSRW    IFEQ 015
     C           ZHCSCL    ANDEQ032
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DSPOT'  YPMTFD           Spot Buy  (Y/N)
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM 1         YYLGCT  50       # of grps
     C                     PARM W0GRP     YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel and exit from key screen
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1BCNA           Customer Purcha
     C                     Z-ADD*ZERO     P1RMNB           Load ID
     C                     MOVEL*BLANK    P1FNSX           Transfer in Sto
     C                     MOVEL*BLANK    P2AJCD           Warehouse Code
     C                     MOVEL*BLANK    P2DNCD           Application Cod
     C                     MOVEL*BLANK    P2BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P2I6ST           Allow Multi-Com
     C                     MOVEL*BLANK    P3T0ST           Warehouse Locat
     C                     MOVEL*BLANK    P5PPST           P.O. Required F
     C                     MOVEL*BLANK    P6TIST           USR Display 1
     C                     MOVEL*BLANK    P7O1ST           Live with TPM
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Transfer in Storage Ind
     C                     MOVEL*BLANK    WUFNSX  1
      * Define work field Event Type
     C                     MOVEL*BLANK    WUOIST  2
      * Define work field Delivery P.O. Number
     C                     MOVEL*BLANK    WULMT1 38
      * Define work field Customer Purchase Order #
     C                     MOVEL*BLANK    WUBCNA 15
      * Define work field OHE Intended for ExportCC
     C                     MOVEL*BLANK    WULWAA  6
      * Define work field Letter of Credit Number
     C                     MOVEL*BLANK    WUWDT1 50
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Country Code
     C                     MOVEL*BLANK    WUKXCD  6
      * Define work field Next Program Name
     C                     MOVEL*BLANK    WUBYVN 10
      * Define work field BLANK 1               USR
     C                     MOVEL*BLANK    WUJ1TX 25
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WBA0DT           Order Date
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBACDT           Cancel Date
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WBA1WG           Order Weight To
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WBRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WBT3NB           Attach to Order
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBAWDT           Invoice Date
     C                     Z-ADD*ZERO     WBVRVA           A/R order Value
     C                     Z-ADD*ZERO     WBB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WBNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WBNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WBNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WBNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WBNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WBBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WBBQTM           Time of Origina
     C                     Z-ADD*ZERO     WBBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WBBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WBBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WBH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WBH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WBH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WBH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WBH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WBC0C7           Claim Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WCRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WCFLAM           Flat Amount
     C                     Z-ADD*ZERO     WCRRNB           Total Stops
     C                     Z-ADD*ZERO     WCSBNB           BOL Time
     C                     Z-ADD*ZERO     WCSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCSDNB           Number Pallets
     C                     Z-ADD*ZERO     WCPAOU           Number Pallets
     C                     Z-ADD*ZERO     WCDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WCSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WCHADT           Actual Arrival
     C                     Z-ADD*ZERO     WCAART           Actual Arrival
     C                     Z-ADD*ZERO     WCDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WCDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WCAQDT           Actual Departur
     C                     Z-ADD*ZERO     WCS6NB           Departure Time
     C                     Z-ADD*ZERO     WCT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WCPRTM           Product Tempera
     C                     Z-ADD*ZERO     WCNPSV           Number Spacers
     C                     Z-ADD*ZERO     WCTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WCGRWE           Gross Weight
     C                     Z-ADD*ZERO     WCF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WCJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WCTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WCJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WCSPTM           Spotted Time
     C                     Z-ADD*ZERO     WCJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WCLFTM           Load Finished T
     C                     Z-ADD*ZERO     WCJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WCBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WCJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WCBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WCKIDT           Truck Departure
     C                     Z-ADD*ZERO     WCASTM           Truck Departure
     C                     Z-ADD*ZERO     WCKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WCAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WCVOAG           Voyage
     C                     Z-ADD*ZERO     WCKBDT           Sail Date
     C                     Z-ADD*ZERO     WCEFDT           Arrival Date
     C                     Z-ADD*ZERO     WCKCDT           Date In
     C                     Z-ADD*ZERO     WCTMIN           Time In
     C                     Z-ADD*ZERO     WCKDDT           Date Out
     C                     Z-ADD*ZERO     WCVMNB           Time Out
     C                     Z-ADD*ZERO     WCOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WCKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WCATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WCBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WCEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WCKKDT           On Yard Date
     C                     Z-ADD*ZERO     WCAVTM           On Yard Time
     C                     Z-ADD*ZERO     WCKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WCAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WCLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WCK0DT           Product Complet
     C                     Z-ADD*ZERO     WCAYTM           Product Complet
     C                     Z-ADD*ZERO     WCKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WCICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WCIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WCK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WCAZTM           Load Door 1
     C                     Z-ADD*ZERO     WCK2DT           Override Total
     C                     Z-ADD*ZERO     WCA0TM           Load Door 2
     C                     Z-ADD*ZERO     WCZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WCPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WCCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WCPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WCCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WCP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WCCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WCP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WCCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WCP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WCCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WCP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WCCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDI3NY           COA Batch Numbe
     C                     Z-ADD*ZERO     WDJYNY           COA Batch Heade
     C                     Z-ADD*ZERO     WDQ1NY           COA Batch Hdr R
     C                     Z-ADD*ZERO     WDJZNY           COA RIN SSSSSSS
     C                     Z-ADD*ZERO     WDJ0NY           COA RIN EEEEEEE
     C                     Z-ADD*ZERO     WDJ2NY           COA RIN Volume
     C                     Z-ADD*ZERO     WDRIDT           COA RIN Transac
     C                     Z-ADD*ZERO     WDC5TM           COA RIN Transac
     C                     Z-ADD*ZERO     WDRJDT           COA Retired RIN
     C                     Z-ADD*ZERO     WDC6TM           COA Retired RIN
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDDPNB           Order Sequence
     C                     Z-ADD*ZERO     WDUENB           Order Secondary
     C                     Z-ADD*ZERO     WDRZNB           Case Sequence N
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDRKDT           COA Date of 1st
     C                     Z-ADD*ZERO     WDC7TM           COA RIN Unused
     C                     Z-ADD*ZERO     WDQWNY           COA RIN Gallons
     C                     Z-ADD*ZERO     WDCWC3           COA Shipping Co
     C                     Z-ADD*ZERO     WDQXNY           COA Ref Load Id
     C                     Z-ADD*ZERO     WDQZNY           COA Reference B
     C                     Z-ADD*ZERO     WDQ0NY           COA Reference B
     C                     Z-ADD*ZERO     WDTFDT           COA BHR Net Gal
     C                     Z-ADD*ZERO     WDTGDT           COA BHR Unused
     C                     Z-ADD*ZERO     WDQYNY           COA BHR Loadout
     C                     Z-ADD*ZERO     WDR8NY           COA Batch RIN V
     C                     Z-ADD*ZERO     WDR0NY           COA RIN Quantit
     C                     Z-ADD*ZERO     WDR7NY           COA BHR RIN Gen
     C                     Z-ADD*ZERO     WDHEPR           COA BHR RIN Pri
     C                     Z-ADD*ZERO     WDHFPR           COA BHR Gallon
     C                     Z-ADD*ZERO     WDR5NY           COA RIN Support
     C                     Z-ADD*ZERO     WDR6NY           COA RIN Support
     C                     Z-ADD*ZERO     WDTWDT           COA GEN EMTS Da
     C                     Z-ADD*ZERO     WDDUTM           COA GEN EMTS Ti
     C                     Z-ADD*ZERO     WDTVDT           COA RIN EMTS Da
     C                     Z-ADD*ZERO     WDDTTM           COA RIN EMTS Ti
     C                     Z-ADD*ZERO     WDR9NY           COA EMTS PTD Nb
     C                     Z-ADD*ZERO     WDSQNY           COA EMTS Batch
     C                     Z-ADD*ZERO     WDSRNY           COA BHR Unused
     C                     Z-ADD*ZERO     WDT2DT           COA BHR Unused
     C                     Z-ADD*ZERO     WDSXNY           COA BHR Equiv V
     C                     Z-ADD*ZERO     WDSYNY           COA BHR RINs to
     C                     Z-ADD*ZERO     WDSZNY           COA Unassgnd Tx
     C                     Z-ADD*ZERO     WDMJDT           Create Date
     C                     Z-ADD*ZERO     WDBETM           Create Time
     C                     Z-ADD*ZERO     WDMKDT           Change Date
     C                     Z-ADD*ZERO     WDBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFC4NB           Order Number
     C                     Z-ADD*ZERO     WFRMNB           Load ID
     C                     Z-ADD*ZERO     WFRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WFQWDT           OHE Sail/Flight
     C                     Z-ADD*ZERO     WFQXDT           OHE Port Cut Da
     C                     Z-ADD*ZERO     WFQYDT           OHE Arrival Dat
     C                     Z-ADD*ZERO     WFGINY           OHE Unused Numb
     C                     Z-ADD*ZERO     WFGFNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WFGGNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WFGHNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WFHEVL           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WFHFVL           OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WFHGVL           Transload Termi
     C                     Z-ADD*ZERO     WFQZDT           OHE Est Arrv at
     C                     Z-ADD*ZERO     WFQ0DT           OHE Backhaul ET
     C                     Z-ADD*ZERO     WFQ1DT           OHE Port/Pier P
     C                     Z-ADD*ZERO     WFQ2DT           OHE Actual Ship
     C                     Z-ADD*ZERO     WFITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WFQJNY           OHE Backhaul Re
     C                     Z-ADD*ZERO     WFQKNY           LD Stop/Drop
     C                     Z-ADD*ZERO     WFQLNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WFP8NY           OHE Pier Pass F
     C                     Z-ADD*ZERO     WFP9NY           OHE Port Check
     C                     Z-ADD*ZERO     WFQANY           OHE Port Cut Ti
     C                     Z-ADD*ZERO     WFQCNY           OHE Backhaul Tr
     C                     Z-ADD*ZERO     WFQDNY           OHE Load Sched
     C                     Z-ADD*ZERO     WFQENY           Original Appoin
     C                     Z-ADD*ZERO     WFQFNY           Original Appoin
     C                     Z-ADD*ZERO     WFQGNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WFQHNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WFQINY           OHE Unused Nume
     C                     Z-ADD*ZERO     WFQMNY           OHE Orig ABS Fr
     C                     Z-ADD*ZERO     WFW5DT           OHE Unused Date
     C                     Z-ADD*ZERO     WFW6DT           OHE Unused Date
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGC4NB           Order Number
     C                     Z-ADD*ZERO     WGDPNB           Order Sequence
     C                     Z-ADD*ZERO     WGUENB           Order Secondary
     C                     Z-ADD*ZERO     WGHGCD           Item Code
     C                     Z-ADD*ZERO     WGBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WGCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WGMAVA           Billing Detail
     C                     Z-ADD*ZERO     WGKDVA           Billing Detail
     C                     Z-ADD*ZERO     WGL8VA           Billing Detail
     C                     Z-ADD*ZERO     WGL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WGAYVA           Extended Amount
     C                     Z-ADD*ZERO     WGEXDT           Market Pricing
     C                     Z-ADD*ZERO     WGBZPR           Price Overage O
     C                     Z-ADD*ZERO     WGL6NB           Contract Number
     C                     Z-ADD*ZERO     WGGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WGR1NB           Rated Freight
     C                     Z-ADD*ZERO     WGAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WGD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WGCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WGAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WGCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WGATWG           Weight Shipped
     C                     Z-ADD*ZERO     WGAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WGAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WGAKPR           Unit Price
     C                     Z-ADD*ZERO     WGALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WGAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WGAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WGA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WGA5DT           Requested Ship
     C                     Z-ADD*ZERO     WGAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WGGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WGRGNB           Item Structure
     C                     Z-ADD*ZERO     WGRHNB           Item Structure
     C                     Z-ADD*ZERO     WGRINB           Item Structure
     C                     Z-ADD*ZERO     WGCXDT           Date of Origina
     C                     Z-ADD*ZERO     WGDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WGB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WGA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WGNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WGNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WGNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WGNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WGNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WGBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WGBVTM           Price Code
     C                     Z-ADD*ZERO     WGBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WGBXTM           Substitution Li
     C                     Z-ADD*ZERO     WGBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WGH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WGH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WGH7NX           OD Item Target
     C                     Z-ADD*ZERO     WGH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WGH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WGDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WGDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WGDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WGDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WGDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WGGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WGGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WGGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WGPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WGRINY           Item Age Days
     C                     Z-ADD*ZERO     WGTIDT           Production Ovr
     C                     Z-ADD*ZERO     WGTJDT           Production Ovr
     C                     Z-ADD*ZERO     WGTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WGTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WGTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIRMNB           Load ID
     C                     Z-ADD*ZERO     WIRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WIRVNB           Stop/Drop
     C                     Z-ADD*ZERO     WIRWNB           Miles to next s
     C                     Z-ADD*ZERO     WIRXNB           Freight Charge
     C                     Z-ADD*ZERO     WISQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WIT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WIT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WIR1NB           Rated Freight
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIC4NB           Order Number
     C                     Z-ADD*ZERO     WIKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WISXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WIKFDT           Appointment Con
     C                     Z-ADD*ZERO     WIACTM           Appointment Con
     C                     Z-ADD*ZERO     WIEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WIAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WIKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WIATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WIHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WIAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WIKKDT           On Yard Date
     C                     Z-ADD*ZERO     WIAVTM           On Yard Time
     C                     Z-ADD*ZERO     WIZ4NB           MPC Number
     C                     Z-ADD*ZERO     WIN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WIN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WIN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WIB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WIB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WIB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Define work field Update Exception Status
     C                     MOVEL*BLANK    WUF6ST  1
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SARVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     MOVEL*BLANK    WL0002 30
      * Define local variables for subroutine SBRVGN.
     C                     MOVEL*BLANK    WL0003  3
     C                     MOVEL*BLANK    WL0004 30
      * Define local variables for subroutine SMRVGN.
     C                     Z-ADD*ZERO     WL0005  30
     C                     MOVEL*BLANK    WL0006  1
     C                     MOVEL*BLANK    WL0007  1
      * Define local variables for subroutine SQRVGN.
     C                     Z-ADD*ZERO     WL0008  30
     C                     Z-ADD*ZERO     WL0009  70
     C                     MOVEL*BLANK    WL0010 15
     C                     Z-ADD*ZERO     WL0011  30
      * Define local variables for subroutine SRCHRC.
     C                     Z-ADD*ZERO     WL0012  30
     C                     MOVEL*BLANK    WL0013  4
     C                     Z-ADD*ZERO     WL0014  50
     C                     Z-ADD*ZERO     WL0015  50
     C                     Z-ADD*ZERO     WL0016  50
     C                     MOVEL*BLANK    WL0017 38
     C                     MOVEL*BLANK    WL0018 15
      * Define local variables for subroutine STRVGN.
     C                     Z-ADD*ZERO     WL0019  30
     C                     MOVEL*BLANK    WL0020 10
     C                     Z-ADD*ZERO     WL0021 155
      * Define local variables for subroutine TCRVGN.
     C                     MOVEL*BLANK    WL0022 10
     C                     MOVEL*BLANK    WL0023  6
     C                     Z-ADD*ZERO     WL0024  30
     C                     MOVEL*BLANK    WL0025  3
      * Define local work field Company Organization
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Sales Route Code 2 USR
     C                     MOVEL*BLANK    YL0002  3
      * Define local work field OHE Override Type Code
     C                     MOVEL*BLANK    YL0003  2
      * Define local work field USR 15 Text           USR
     C                     MOVEL*BLANK    YL0004 15
      * Define local work field Claim Company Number
     C                     Z-ADD*ZERO     YL0005  30
      * Define local work field Claim Ship to Customer
     C                     Z-ADD*ZERO     YL0006  70
      * Define local work field Warehouse Type
     C                     MOVEL*BLANK    YL0007  2
      * Define local work field Pricing Event Called From
     C                     MOVEL*BLANK    YL0008  3
      * Define local work field Department Control Code
     C                     MOVEL*BLANK    YL0009  3
      * Define local work field Load Change Type
     C                     MOVEL*BLANK    YL0010  6
      * Define local work field Load Acceptance Flag
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field MG Created Load
     C                     MOVEL*BLANK    YL0012  1
      * Define local work field Plant Company Sts
     C                     MOVEL*BLANK    YL0013  1
      * Define local work field Company Organization
     C                     MOVEL*BLANK    YL0014  1
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0015  30
      * Define local work field Company Number     041405
     C                     Z-ADD*ZERO     YL0016  30
      * Define local work field OHE Ship Status
     C                     MOVEL*BLANK    YL0017  1
      * Define local work field OHE Carrier SCAC Code
     C                     MOVEL*BLANK    YL0018  4
      * Define local work field OHE Spot Buy
     C                     MOVEL*BLANK    YL0019  4
      * Define local work field OHE PO ACK Flag
     C                     MOVEL*BLANK    YL0020  4
      * Define local work field OHE Backhaul Status
     C                     MOVEL*BLANK    YL0021  2
      * Define local work field OHE Backhaul ETA AM/PM
     C                     MOVEL*BLANK    YL0022  2
      * Define local work field OHE Load Haul Type
     C                     MOVEL*BLANK    YL0023  3
      * Define local work field OHE Backhaul Carrier Code
     C                     MOVEL*BLANK    YL0024  3
      * Define local work field OHE Bookings Confirmed
     C                     MOVEL*BLANK    YL0025  3
      * Define local work field OHE EDI Error Reasons
     C                     MOVEL*BLANK    YL0026  5
      * Define local work field Blank 1 USR
     C                     MOVEL*BLANK    YL0027  1
      * Define local work field OHE EDI 943 Action
     C                     MOVEL*BLANK    YL0028  6
      * Define local work field OHE EDI 944 Action
     C                     MOVEL*BLANK    YL0029  6
      * Define local work field OHE EDI 940 Action
     C                     MOVEL*BLANK    YL0030  6
      * Define local work field OHE EDI 945 Action
     C                     MOVEL*BLANK    YL0031  6
      * Define local work field Requested Delivery Time
     C                     Z-ADD*ZERO     YL0032  40
      * Define local work field LD Carrier Appt Date
     C                     Z-ADD*ZERO     YL0033  70
      * Define local work field LD Carrier Appt Time
     C                     Z-ADD*ZERO     YL0034  60
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0035  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0036  3
      * Define local work field Plant Company Sts
     C                     MOVEL*BLANK    YL0037  1
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
      * Set to *CHANGE mode
     C                     MOVEL'CHG'     W0PMD   3
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
     C                     MOVEL*BLANK    P2DNCD           Application Cod
     C                     MOVEL'OMS'     P2DNCD           Application Cod
      *
     C                     MOVEL*BLANK    WN0593 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0593           User Profile Na
      *
     C                     MOVEL*BLANK    WN0594 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR TBRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,006                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0593    ZA0008           User Profile Na
     C                     MOVELP2DNCD    ZA0009           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0594    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0593    WL0022    P      User Profile Na
     C                     MOVELP2DNCD    WL0023    P      Application Cod
     C                     EXSR TCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0024    WUAIC3           Company Number
     C                     MOVELWL0025    YL0036    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0594    WL0022    P      User Profile Na
     C                     MOVELP2DNCD    WL0023    P      Application Cod
     C                     EXSR TCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0024    WUAIC3           Company Number
     C                     MOVELWL0025    YL0036    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0036    P2AJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0593    ZA0010           User Profile Na
     C                     MOVELP2DNCD    ZA0011           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0035    IFNE 0                          *IF
     C                     Z-ADDYL0035    WUAIC3           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0036    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           P2AJCD    PARM *BLANK    WQ0041  3        Warehouse Code
     C                     PARM YL0035    WQ0042  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR TDRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
     C                     MOVEL'N'       WUF6ST           Update Exceptio
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0005           Company Number
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0006    YL0037    P      Plant Company S
     C                     MOVELWL0007    YL0001    P      Company Organiz
      * EXC Rtv Status        XF - PFS Interface  * screen field control
     C                     CALL 'PBXNXFR'              90  EXC Rtv Status
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0043  30       PFS Company Num
     C                     PARM 'TMSLDP'  WQ0044  6        PFS Interface C
     C           P7O1ST    PARM *BLANK    WQ0045  1        PFS Carlisle Ac
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBXNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * 04/13/18 DN S12917-To Save Original Sales Route.
     C                     MOVEL*BLANK    YL0002           Sales Route Cod
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** KEY Screen: Field position and name array
0104501301
** W0END
0104701307
** W0NAM
V1AIC3    V1C4NB
** W1BEG
01056010650131201346015680157101602
01605018240183302336023450259202848
03104033600361603872038770438404399
04421046400489604911051520516105408
0541705664
** W1END
01058010940131801352015690158001603
01614018310183702338023740260602862
03143033990361603872038810439504418
04422046510490504940051570516805413
0542405693
** W1NAM
V1AIC3    #DSQTX    V1C4NB    #1RMNB    #1JPCD    #DHLTX    #1FVSX
#DHMTX    V1EIDT    #1AFTM    #1R4CD    #DALTX    #1BCNA    #DNLTX
#1B6NA    #1BYNA    #1FNSX    #DSPOT    #DQIU1    #DHEVL    #DSLTX
#DBOCD    #DHFVL    #DV5T1    #DWBT1    V1NODT    #1BRTM    VDN7DT
#DB3TM    #DAKU1
** @CN
00001 Override Type Code .
00002 Sales Channel . . .
00003 USR0752
00004 POIRXFR
00005 Y2U0003
00006 Y2U0005
