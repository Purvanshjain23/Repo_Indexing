     H/TITLE Prt Complete Txfr-HPB PF  Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by CA 2E release 8.5 (1351)
     H* Function type : Print file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 01/05/12  Time  : 16:50:52
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FOPBFCPH7IF  E           K        DISK
      * RSQ : Order Header TRG          Ready to Complete Xfer
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FOPEYCPL1IF  E           K        DISK
      * RTV : Order Events              Retrieval index       NV
      *
     FOPEYCPL9IF  E           K        DISK
      * RSQ : Order Events              Co/Order/Event Code
      *
     FPDJYREL2IF  E           K        DISK
      * RTV : Company Defaults Internal Active Records
      *
     FOPBFCPL8IF  E           K        DISK
      * RSQ : Order Header TRG          Load #/All orders
      *
     FOPEYCPL0IF  E           K        DISK                      A
      * UPD : Order Events              Update index
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FOMFJCPL1UF  E           K        DISK
      * UPD : Load Header               Update index
      *
     FPBBCPFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: Prt Complete Txfr-HPB PF  Print file
      *
     E                    UCT        40  1               CENTER TABLE
     E                    #L3         3  1
     E                    #L7         7  1
      * Long constants
     E                    @CN#    1  04  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                          WAAIC3
     I              OMC4NB                          WAC4NB
     I              OMDPNB                          WADPNB
     I              OMUENB                          WAUENB
     I              OMHGCD                          WAHGCD
     I              OMAJCD                          WAAJCD
     I              OMBKC7                          WABKC7
     I              OMCFC7                          WACFC7
     I              OMGMST                          WAGMST
     I              OMGNST                          WAGNST
     I              OMMAVA                          WAMAVA
     I              OMKDVA                          WAKDVA
     I              OML8VA                          WAL8VA
     I              OML9VA                          WAL9VA
     I              OMGTST                          WAGTST
     I              OMGVST                          WAGVST
     I              OMGUST                          WAGUST
     I              OMQFST                          WAQFST
     I              OMAYVA                          WAAYVA
     I              OMEXDT                          WAEXDT
     I              OMLQCD                          WALQCD
     I              OMRDCD                          WARDCD
     I              OMQ7CD                          WAQ7CD
     I              OMBZPR                          WABZPR
     I              OML6NB                          WAL6NB
     I              OMU1ST                          WAU1ST
     I              OMGIDT                          WAGIDT
     I              OMCRCD                          WACRCD
     I              OMAGCD                          WAAGCD
     I              OMRZST                          WARZST
     I              OMR0ST                          WAR0ST
     I              OMR1ST                          WAR1ST
     I              OMG7NA                          WAG7NA
     I              OMG8NA                          WAG8NA
     I              OMRPCD                          WARPCD
     I              OMVEST                          WAVEST
     I              OMVGST                          WAVGST
     I              OMAVST                          WAAVST
     I              OMU0ST                          WAU0ST
     I              OMRFCD                          WARFCD
     I              OMFZST                          WAFZST
     I              OMR1NB                          WAR1NB
     I              OMAVQT                          WAAVQT
     I              OMD0WG                          WAD0WG
     I              OMCCQT                          WACCQT
     I              OMAUWG                          WAAUWG
     I              OMCBQT                          WACBQT
     I              OMATWG                          WAATWG
     I              OMAQCS                          WAAQCS
     I              OMAGCS                          WAAGCS
     I              OMAKPR                          WAAKPR
     I              OMALPR                          WAALPR
     I              OMAUPR                          WAAUPR
     I              OMAVWG                          WAAVWG
     I              OMA4WG                          WAA4WG
     I              OMA5DT                          WAA5DT
     I              OMAODT                          WAAODT
     I              OMGNDT                          WAGNDT
     I              OMAMST                          WAAMST
     I              OMANST                          WAANST
     I              OMVAST                          WAVAST
     I              OMRGNB                          WARGNB
     I              OMRHNB                          WARHNB
     I              OMRINB                          WARINB
     I              OMRBCD                          WARBCD
     I              OMHICD                          WAHICD
     I              OMRNCD                          WARNCD
     I              OMROCD                          WAROCD
     I              OMCXDT                          WACXDT
     I              OMAJVN                          WAAJVN
     I              OMKXCD                          WAKXCD
     I              OMJPCD                          WAJPCD
     I              OMCQCD                          WACQCD
     I              OMR4CD                          WAR4CD
     I              OMZ1ST                          WAZ1ST
     I              OMZ3ST                          WAZ3ST
     I              OMZ4ST                          WAZ4ST
     I              OMDUPR                          WADUPR
     I              OMB6VL                          WAB6VL
     I              OMA1AA                          WAA1AA
     I              OMFZSX                          WAFZSX
     I              OMF0SX                          WAF0SX
     I              OMF1SX                          WAF1SX
     I              OMF2SX                          WAF2SX
     I              OMF3SX                          WAF3SX
     I              OMF4SX                          WAF4SX
     I              OMF5SX                          WAF5SX
     I              OMF6SX                          WAF6SX
     I              OMF7SX                          WAF7SX
     I              OMNTDT                          WANTDT
     I              OMNUDT                          WANUDT
     I              OMNVDT                          WANVDT
     I              OMNWDT                          WANWDT
     I              OMNXDT                          WANXDT
     I              OMBUTM                          WABUTM
     I              OMBVTM                          WABVTM
     I              OMBWTM                          WABWTM
     I              OMBXTM                          WABXTM
     I              OMBYTM                          WABYTM
     I              OMH5NX                          WAH5NX
     I              OMH6NX                          WAH6NX
     I              OMH7NX                          WAH7NX
     I              OMH8NX                          WAH8NX
     I              OMH9NX                          WAH9NX
     I              OMDVPR                          WADVPR
     I              OMDWPR                          WADWPR
     I              OMDXPR                          WADXPR
     I              OMDYPR                          WADYPR
     I              OMDZPR                          WADZPR
     I              OMGSPR                          WAGSPR
     I              OMGTPR                          WAGTPR
     I              OMGUPR                          WAGUPR
     I              OMHOST                          WAHOST
     I              OMHPST                          WAHPST
     I              OMIOST                          WAIOST
     I              OMPEWG                          WAPEWG
     I              OMRINY                          WARINY
     I              OMTIDT                          WATIDT
     I              OMTJDT                          WATJDT
     I              OMH2ST                          WAH2ST
     I              OMH0ST                          WAH0ST
     I              OMH1ST                          WAH1ST
     I              OMTKDT                          WATKDT
     I              OMTLDT                          WATLDT
     I              OMTMDT                          WATMDT
     I              OMUVST                          WAUVST
     I              OMUWST                          WAUWST
     I              OMUXST                          WAUXST
     I              OMAATM                          WAAATM
     I              OMAYNA                          WAAYNA
     I              OMA0NA                          WAA0NA
     I              OMAXDT                          WAAXDT
      *
     I@EYCPZE
      * Order Events              Co/Order/Event Code
      * Renamed input format fields
     I              EYAIC3                          WBAIC3
     I              EYC4NB                          WBC4NB
     I              EYQ2NB                          WBQ2NB
     I              EYJPCD                          WBJPCD
     I              EYAUC3                          WBAUC3
     I              EYQ7NB                          WBQ7NB
     I              EYOMST                          WBOMST
     I              EYD2DT                          WBD2DT
     I              EYONST                          WBONST
     I              EYOOST                          WBOOST
     I              EYOPST                          WBOPST
     I              EYAWC3                          WBAWC3
     I              EYQ8NB                          WBQ8NB
     I              EYQ9NB                          WBQ9NB
     I              EYBKC7                          WBBKC7
     I              EYUVST                          WBUVST
     I              EYUWST                          WBUWST
     I              EYUXST                          WBUXST
     I              EYAATM                          WBAATM
     I              EYAYNA                          WBAYNA
     I              EYA0NA                          WBA0NA
     I              EYAXDT                          WBAXDT
      *
     I@EYCPY3
      * Order Events              Update index
      * Renamed input format fields
     I              EYAIC3                          WCAIC3
     I              EYC4NB                          WCC4NB
     I              EYQ2NB                          WCQ2NB
     I              EYJPCD                          WCJPCD
     I              EYAUC3                          WCAUC3
     I              EYQ7NB                          WCQ7NB
     I              EYOMST                          WCOMST
     I              EYD2DT                          WCD2DT
     I              EYONST                          WCONST
     I              EYOOST                          WCOOST
     I              EYOPST                          WCOPST
     I              EYAWC3                          WCAWC3
     I              EYQ8NB                          WCQ8NB
     I              EYQ9NB                          WCQ9NB
     I              EYBKC7                          WCBKC7
     I              EYUVST                          WCUVST
     I              EYUWST                          WCUWST
     I              EYUXST                          WCUXST
     I              EYAATM                          WCAATM
     I              EYAYNA                          WCAYNA
     I              EYA0NA                          WCA0NA
     I              EYAXDT                          WCAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WDAIC3
     I              BEC4NB                          WDC4NB
     I              BEJNCD                          WDJNCD
     I              BEANC7                          WDANC7
     I              BEBKC7                          WDBKC7
     I              BEBRTX                          WDBRTX
     I              BEHMNA                          WDHMNA
     I              BEHONA                          WDHONA
     I              BEHPNA                          WDHPNA
     I              BEHNNA                          WDHNNA
     I              BEDBCD                          WDDBCD
     I              BECKTX                          WDCKTX
     I              BEB0C7                          WDB0C7
     I              BEAETX                          WDAETX
     I              BEB1NA                          WDB1NA
     I              BEB3NA                          WDB3NA
     I              BEB4NA                          WDB4NA
     I              BEB2NA                          WDB2NA
     I              BEBHCD                          WDBHCD
     I              BEC8TX                          WDC8TX
     I              BEBCNA                          WDBCNA
     I              BEA0DT                          WDA0DT
     I              BEA5DT                          WDA5DT
     I              BEGNDT                          WDGNDT
     I              BEACDT                          WDACDT
     I              BEAQCD                          WDAQCD
     I              BEB6NA                          WDB6NA
     I              BEBYNA                          WDBYNA
     I              BEBZNA                          WDBZNA
     I              BEGTST                          WDGTST
     I              BEGVST                          WDGVST
     I              BEGUST                          WDGUST
     I              BEQFST                          WDQFST
     I              BECQCD                          WDCQCD
     I              BEGJST                          WDGJST
     I              BEGWST                          WDGWST
     I              BEGXST                          WDGXST
     I              BEGYST                          WDGYST
     I              BEAODT                          WDAODT
     I              BEAIVN                          WDAIVN
     I              BECXDT                          WDCXDT
     I              BEJZVA                          WDJZVA
     I              BEA1WG                          WDA1WG
     I              BEXIST                          WDXIST
     I              BEXJST                          WDXJST
     I              BEXKST                          WDXKST
     I              BEEIDT                          WDEIDT
     I              BEAFTM                          WDAFTM
     I              BEE8CD                          WDE8CD
     I              BEE9CD                          WDE9CD
     I              BERMNB                          WDRMNB
     I              BETBNB                          WDTBNB
     I              BER1NB                          WDR1NB
     I              BEPJST                          WDPJST
     I              BEU0ST                          WDU0ST
     I              BEU1ST                          WDU1ST
     I              BEQ2CD                          WDQ2CD
     I              BEU2ST                          WDU2ST
     I              BEVEST                          WDVEST
     I              BEVFST                          WDVFST
     I              BEVGST                          WDVGST
     I              BERPCD                          WDRPCD
     I              BERNNB                          WDRNNB
     I              BEVDST                          WDVDST
     I              BEATIN                          WDATIN
     I              BEU4ST                          WDU4ST
     I              BEU5ST                          WDU5ST
     I              BERSRN                          WDRSRN
     I              BEMHNA                          WDMHNA
     I              BEMINA                          WDMINA
     I              BEWBST                          WDWBST
     I              BER4CD                          WDR4CD
     I              BEBFCD                          WDBFCD
     I              BEQ4CD                          WDQ4CD
     I              BET3NB                          WDT3NB
     I              BESICD                          WDSICD
     I              BECONB                          WDCONB
     I              BECEST                          WDCEST
     I              BEAWDT                          WDAWDT
     I              BEJPCD                          WDJPCD
     I              BEXUST                          WDXUST
     I              BEZ1ST                          WDZ1ST
     I              BEVRVA                          WDVRVA
     I              BEOBST                          WDOBST
     I              BEBCST                          WDBCST
     I              BEBDST                          WDBDST
     I              BEB7VL                          WDB7VL
     I              BEGASX                          WDGASX
     I              BEGBSX                          WDGBSX
     I              BEGCSX                          WDGCSX
     I              BEGDSX                          WDGDSX
     I              BEFNSX                          WDFNSX
     I              BEFOSX                          WDFOSX
     I              BEFPSX                          WDFPSX
     I              BEFQSX                          WDFQSX
     I              BEFRSX                          WDFRSX
     I              BEFSSX                          WDFSSX
     I              BEFTSX                          WDFTSX
     I              BEFUSX                          WDFUSX
     I              BEFVSX                          WDFVSX
     I              BEFWSX                          WDFWSX
     I              BEFXSX                          WDFXSX
     I              BEFYSX                          WDFYSX
     I              BENODT                          WDNODT
     I              BENPDT                          WDNPDT
     I              BENQDT                          WDNQDT
     I              BENRDT                          WDNRDT
     I              BENSDT                          WDNSDT
     I              BEBPTM                          WDBPTM
     I              BEBQTM                          WDBQTM
     I              BEBRTM                          WDBRTM
     I              BEBSTM                          WDBSTM
     I              BEBTTM                          WDBTTM
     I              BEH0NX                          WDH0NX
     I              BEH1NX                          WDH1NX
     I              BEH2NX                          WDH2NX
     I              BEH3NX                          WDH3NX
     I              BEH4NX                          WDH4NX
     I              BEC0C7                          WDC0C7
     I              BEUVST                          WDUVST
     I              BEUWST                          WDUWST
     I              BEUXST                          WDUXST
     I              BEAATM                          WDAATM
     I              BEAYNA                          WDAYNA
     I              BEA0NA                          WDA0NA
     I              BEAXDT                          WDAXDT
      *
     I@BFCPD9
      * Order Header TRG          Load #/All orders
      * Renamed input format fields
     I              BEAIC3                          WEAIC3
     I              BEC4NB                          WEC4NB
     I              BEJNCD                          WEJNCD
     I              BEANC7                          WEANC7
     I              BEBKC7                          WEBKC7
     I              BEBRTX                          WEBRTX
     I              BEHMNA                          WEHMNA
     I              BEHONA                          WEHONA
     I              BEHPNA                          WEHPNA
     I              BEHNNA                          WEHNNA
     I              BEDBCD                          WEDBCD
     I              BECKTX                          WECKTX
     I              BEB0C7                          WEB0C7
     I              BEAETX                          WEAETX
     I              BEB1NA                          WEB1NA
     I              BEB3NA                          WEB3NA
     I              BEB4NA                          WEB4NA
     I              BEB2NA                          WEB2NA
     I              BEBHCD                          WEBHCD
     I              BEC8TX                          WEC8TX
     I              BEBCNA                          WEBCNA
     I              BEA0DT                          WEA0DT
     I              BEA5DT                          WEA5DT
     I              BEGNDT                          WEGNDT
     I              BEACDT                          WEACDT
     I              BEAQCD                          WEAQCD
     I              BEB6NA                          WEB6NA
     I              BEBYNA                          WEBYNA
     I              BEBZNA                          WEBZNA
     I              BEGTST                          WEGTST
     I              BEGVST                          WEGVST
     I              BEGUST                          WEGUST
     I              BEQFST                          WEQFST
     I              BECQCD                          WECQCD
     I              BEGJST                          WEGJST
     I              BEGWST                          WEGWST
     I              BEGXST                          WEGXST
     I              BEGYST                          WEGYST
     I              BEAODT                          WEAODT
     I              BEAIVN                          WEAIVN
     I              BECXDT                          WECXDT
     I              BEJZVA                          WEJZVA
     I              BEA1WG                          WEA1WG
     I              BEXIST                          WEXIST
     I              BEXJST                          WEXJST
     I              BEXKST                          WEXKST
     I              BEEIDT                          WEEIDT
     I              BEAFTM                          WEAFTM
     I              BEE8CD                          WEE8CD
     I              BEE9CD                          WEE9CD
     I              BERMNB                          WERMNB
     I              BETBNB                          WETBNB
     I              BER1NB                          WER1NB
     I              BEPJST                          WEPJST
     I              BEU0ST                          WEU0ST
     I              BEU1ST                          WEU1ST
     I              BEQ2CD                          WEQ2CD
     I              BEU2ST                          WEU2ST
     I              BEVEST                          WEVEST
     I              BEVFST                          WEVFST
     I              BEVGST                          WEVGST
     I              BERPCD                          WERPCD
     I              BERNNB                          WERNNB
     I              BEVDST                          WEVDST
     I              BEATIN                          WEATIN
     I              BEU4ST                          WEU4ST
     I              BEU5ST                          WEU5ST
     I              BERSRN                          WERSRN
     I              BEMHNA                          WEMHNA
     I              BEMINA                          WEMINA
     I              BEWBST                          WEWBST
     I              BER4CD                          WER4CD
     I              BEBFCD                          WEBFCD
     I              BEQ4CD                          WEQ4CD
     I              BET3NB                          WET3NB
     I              BESICD                          WESICD
     I              BECONB                          WECONB
     I              BECEST                          WECEST
     I              BEAWDT                          WEAWDT
     I              BEJPCD                          WEJPCD
     I              BEXUST                          WEXUST
     I              BEZ1ST                          WEZ1ST
     I              BEVRVA                          WEVRVA
     I              BEOBST                          WEOBST
     I              BEBCST                          WEBCST
     I              BEBDST                          WEBDST
     I              BEB7VL                          WEB7VL
     I              BEGASX                          WEGASX
     I              BEGBSX                          WEGBSX
     I              BEGCSX                          WEGCSX
     I              BEGDSX                          WEGDSX
     I              BEFNSX                          WEFNSX
     I              BEFOSX                          WEFOSX
     I              BEFPSX                          WEFPSX
     I              BEFQSX                          WEFQSX
     I              BEFRSX                          WEFRSX
     I              BEFSSX                          WEFSSX
     I              BEFTSX                          WEFTSX
     I              BEFUSX                          WEFUSX
     I              BEFVSX                          WEFVSX
     I              BEFWSX                          WEFWSX
     I              BEFXSX                          WEFXSX
     I              BEFYSX                          WEFYSX
     I              BENODT                          WENODT
     I              BENPDT                          WENPDT
     I              BENQDT                          WENQDT
     I              BENRDT                          WENRDT
     I              BENSDT                          WENSDT
     I              BEBPTM                          WEBPTM
     I              BEBQTM                          WEBQTM
     I              BEBRTM                          WEBRTM
     I              BEBSTM                          WEBSTM
     I              BEBTTM                          WEBTTM
     I              BEH0NX                          WEH0NX
     I              BEH1NX                          WEH1NX
     I              BEH2NX                          WEH2NX
     I              BEH3NX                          WEH3NX
     I              BEH4NX                          WEH4NX
     I              BEC0C7                          WEC0C7
     I              BEUVST                          WEUVST
     I              BEUWST                          WEUWST
     I              BEUXST                          WEUXST
     I              BEAATM                          WEAATM
     I              BEAYNA                          WEAYNA
     I              BEA0NA                          WEA0NA
     I              BEAXDT                          WEAXDT
      *
     I@FJCPBO
      * Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WFRMNB
     I              FJAIC3                          WFAIC3
     I              FJAODT                          WFAODT
     I              FJPJST                          WFPJST
     I              FJPKST                          WFPKST
     I              FJRNNB                          WFRNNB
     I              FJDMTX                          WFDMTX
     I              FJDNTX                          WFDNTX
     I              FJDOTX                          WFDOTX
     I              FJWTTX                          WFWTTX
     I              FJWUTX                          WFWUTX
     I              FJRPNB                          WFRPNB
     I              FJFLAM                          WFFLAM
     I              FJXQST                          WFXQST
     I              FJRRNB                          WFRRNB
     I              FJDXTX                          WFDXTX
     I              FJDYTX                          WFDYTX
     I              FJSBNB                          WFSBNB
     I              FJBZNA                          WFBZNA
     I              FJRONB                          WFRONB
     I              FJSQNB                          WFSQNB
     I              FJR1NB                          WFR1NB
     I              FJVCST                          WFVCST
     I              FJVDST                          WFVDST
     I              FJSDNB                          WFSDNB
     I              FJPAOU                          WFPAOU
     I              FJDGWG                          WFDGWG
     I              FJSXNB                          WFSXNB
     I              FJHADT                          WFHADT
     I              FJAART                          WFAART
     I              FJDHWG                          WFDHWG
     I              FJDIWG                          WFDIWG
     I              FJAQDT                          WFAQDT
     I              FJS6NB                          WFS6NB
     I              FJT4NB                          WFT4NB
     I              FJPRTM                          WFPRTM
     I              FJNPSV                          WFNPSV
     I              FJJ8TX                          WFJ8TX
     I              FJTLMI                          WFTLMI
     I              FJJ9TX                          WFJ9TX
     I              FJQ2CD                          WFQ2CD
     I              FJVPCD                          WFVPCD
     I              FJDBCD                          WFDBCD
     I              FJGRWE                          WFGRWE
     I              FJXCCD                          WFXCCD
     I              FJU2ST                          WFU2ST
     I              FJF9DT                          WFF9DT
     I              FJONTM                          WFONTM
     I              FJJ4DT                          WFJ4DT
     I              FJTRTM                          WFTRTM
     I              FJJ5DT                          WFJ5DT
     I              FJSPTM                          WFSPTM
     I              FJJ6DT                          WFJ6DT
     I              FJLFTM                          WFLFTM
     I              FJJ7DT                          WFJ7DT
     I              FJBOTM                          WFBOTM
     I              FJJ8DT                          WFJ8DT
     I              FJBLTM                          WFBLTM
     I              FJKIDT                          WFKIDT
     I              FJASTM                          WFASTM
     I              FJKADT                          WFKADT
     I              FJAJCM                          WFAJCM
     I              FJXACD                          WFXACD
     I              FJOANA                          WFOANA
     I              FJK4TX                          WFK4TX
     I              FJVOAG                          WFVOAG
     I              FJKBDT                          WFKBDT
     I              FJNBBO                          WFNBBO
     I              FJW4CD                          WFW4CD
     I              FJEFDT                          WFEFDT
     I              FJCNTN                          WFCNTN
     I              FJKCDT                          WFKCDT
     I              FJTMIN                          WFTMIN
     I              FJKDDT                          WFKDDT
     I              FJVMNB                          WFVMNB
     I              FJOCFR                          WFOCFR
     I              FJKJDT                          WFKJDT
     I              FJATTM                          WFATTM
     I              FJOTRS                          WFOTRS
     I              FJRNST                          WFRNST
     I              FJBRBK                          WFBRBK
     I              FJEIDT                          WFEIDT
     I              FJRMST                          WFRMST
     I              FJAJCD                          WFAJCD
     I              FJKKDT                          WFKKDT
     I              FJAVTM                          WFAVTM
     I              FJKZDT                          WFKZDT
     I              FJAXTM                          WFAXTM
     I              FJLHOS                          WFLHOS
     I              FJLHOR                          WFLHOR
     I              FJWNTX                          WFWNTX
     I              FJOITX                          WFOITX
     I              FJOJTX                          WFOJTX
     I              FJLLDT                          WFLLDT
     I              FJLSHG                          WFLSHG
     I              FJYPST                          WFYPST
     I              FJK0DT                          WFK0DT
     I              FJAYTM                          WFAYTM
     I              FJKNNX                          WFKNNX
     I              FJICWG                          WFICWG
     I              FJIDWG                          WFIDWG
     I              FJH9SX                          WFH9SX
     I              FJWOTX                          WFWOTX
     I              FJK1DT                          WFK1DT
     I              FJAZTM                          WFAZTM
     I              FJK2DT                          WFK2DT
     I              FJA0TM                          WFA0TM
     I              FJROST                          WFROST
     I              FJRPST                          WFRPST
     I              FJRQST                          WFRQST
     I              FJRRST                          WFRRST
     I              FJZBVA                          WFZBVA
     I              FJWPTX                          WFWPTX
     I              FJWQTX                          WFWQTX
     I              FJWRTX                          WFWRTX
     I              FJWSTX                          WFWSTX
     I              FJRVSX                          WFRVSX
     I              FJRUSX                          WFRUSX
     I              FJRWSX                          WFRWSX
     I              FJRXSX                          WFRXSX
     I              FJRYSX                          WFRYSX
     I              FJRZSX                          WFRZSX
     I              FJR0SX                          WFR0SX
     I              FJR1SX                          WFR1SX
     I              FJR2SX                          WFR2SX
     I              FJR3SX                          WFR3SX
     I              FJR4SX                          WFR4SX
     I              FJPYDT                          WFPYDT
     I              FJCKTM                          WFCKTM
     I              FJPZDT                          WFPZDT
     I              FJCLTM                          WFCLTM
     I              FJP0DT                          WFP0DT
     I              FJCMTM                          WFCMTM
     I              FJP1DT                          WFP1DT
     I              FJCNTM                          WFCNTM
     I              FJP2DT                          WFP2DT
     I              FJCOTM                          WFCOTM
     I              FJP3DT                          WFP3DT
     I              FJCQTM                          WFCQTM
     I              FJUVST                          WFUVST
     I              FJUWST                          WFUWST
     I              FJUXST                          WFUXST
     I              FJAATM                          WFAATM
     I              FJAYNA                          WFAYNA
     I              FJA0NA                          WFA0NA
     I              FJAXDT                          WFAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IQOPEY1    E DSOPEYCPL0
      * UPD : Order Events              Update index
      * Renamed input format fields
     I              EYAIC3                          WCAIC3
     I              EYC4NB                          WCC4NB
     I              EYQ2NB                          WCQ2NB
     I              EYJPCD                          WCJPCD
     I              EYAUC3                          WCAUC3
     I              EYQ7NB                          WCQ7NB
     I              EYOMST                          WCOMST
     I              EYD2DT                          WCD2DT
     I              EYONST                          WCONST
     I              EYOOST                          WCOOST
     I              EYOPST                          WCOPST
     I              EYAWC3                          WCAWC3
     I              EYQ8NB                          WCQ8NB
     I              EYQ9NB                          WCQ9NB
     I              EYBKC7                          WCBKC7
     I              EYUVST                          WCUVST
     I              EYUWST                          WCUWST
     I              EYUXST                          WCUXST
     I              EYAATM                          WCAATM
     I              EYAYNA                          WCAYNA
     I              EYA0NA                          WCA0NA
     I              EYAXDT                          WCAXDT
      *
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WDAIC3
     I              BEC4NB                          WDC4NB
     I              BEJNCD                          WDJNCD
     I              BEANC7                          WDANC7
     I              BEBKC7                          WDBKC7
     I              BEBRTX                          WDBRTX
     I              BEHMNA                          WDHMNA
     I              BEHONA                          WDHONA
     I              BEHPNA                          WDHPNA
     I              BEHNNA                          WDHNNA
     I              BEDBCD                          WDDBCD
     I              BECKTX                          WDCKTX
     I              BEB0C7                          WDB0C7
     I              BEAETX                          WDAETX
     I              BEB1NA                          WDB1NA
     I              BEB3NA                          WDB3NA
     I              BEB4NA                          WDB4NA
     I              BEB2NA                          WDB2NA
     I              BEBHCD                          WDBHCD
     I              BEC8TX                          WDC8TX
     I              BEBCNA                          WDBCNA
     I              BEA0DT                          WDA0DT
     I              BEA5DT                          WDA5DT
     I              BEGNDT                          WDGNDT
     I              BEACDT                          WDACDT
     I              BEAQCD                          WDAQCD
     I              BEB6NA                          WDB6NA
     I              BEBYNA                          WDBYNA
     I              BEBZNA                          WDBZNA
     I              BEGTST                          WDGTST
     I              BEGVST                          WDGVST
     I              BEGUST                          WDGUST
     I              BEQFST                          WDQFST
     I              BECQCD                          WDCQCD
     I              BEGJST                          WDGJST
     I              BEGWST                          WDGWST
     I              BEGXST                          WDGXST
     I              BEGYST                          WDGYST
     I              BEAODT                          WDAODT
     I              BEAIVN                          WDAIVN
     I              BECXDT                          WDCXDT
     I              BEJZVA                          WDJZVA
     I              BEA1WG                          WDA1WG
     I              BEXIST                          WDXIST
     I              BEXJST                          WDXJST
     I              BEXKST                          WDXKST
     I              BEEIDT                          WDEIDT
     I              BEAFTM                          WDAFTM
     I              BEE8CD                          WDE8CD
     I              BEE9CD                          WDE9CD
     I              BERMNB                          WDRMNB
     I              BETBNB                          WDTBNB
     I              BER1NB                          WDR1NB
     I              BEPJST                          WDPJST
     I              BEU0ST                          WDU0ST
     I              BEU1ST                          WDU1ST
     I              BEQ2CD                          WDQ2CD
     I              BEU2ST                          WDU2ST
     I              BEVEST                          WDVEST
     I              BEVFST                          WDVFST
     I              BEVGST                          WDVGST
     I              BERPCD                          WDRPCD
     I              BERNNB                          WDRNNB
     I              BEVDST                          WDVDST
     I              BEATIN                          WDATIN
     I              BEU4ST                          WDU4ST
     I              BEU5ST                          WDU5ST
     I              BERSRN                          WDRSRN
     I              BEMHNA                          WDMHNA
     I              BEMINA                          WDMINA
     I              BEWBST                          WDWBST
     I              BER4CD                          WDR4CD
     I              BEBFCD                          WDBFCD
     I              BEQ4CD                          WDQ4CD
     I              BET3NB                          WDT3NB
     I              BESICD                          WDSICD
     I              BECONB                          WDCONB
     I              BECEST                          WDCEST
     I              BEAWDT                          WDAWDT
     I              BEJPCD                          WDJPCD
     I              BEXUST                          WDXUST
     I              BEZ1ST                          WDZ1ST
     I              BEVRVA                          WDVRVA
     I              BEOBST                          WDOBST
     I              BEBCST                          WDBCST
     I              BEBDST                          WDBDST
     I              BEB7VL                          WDB7VL
     I              BEGASX                          WDGASX
     I              BEGBSX                          WDGBSX
     I              BEGCSX                          WDGCSX
     I              BEGDSX                          WDGDSX
     I              BEFNSX                          WDFNSX
     I              BEFOSX                          WDFOSX
     I              BEFPSX                          WDFPSX
     I              BEFQSX                          WDFQSX
     I              BEFRSX                          WDFRSX
     I              BEFSSX                          WDFSSX
     I              BEFTSX                          WDFTSX
     I              BEFUSX                          WDFUSX
     I              BEFVSX                          WDFVSX
     I              BEFWSX                          WDFWSX
     I              BEFXSX                          WDFXSX
     I              BEFYSX                          WDFYSX
     I              BENODT                          WDNODT
     I              BENPDT                          WDNPDT
     I              BENQDT                          WDNQDT
     I              BENRDT                          WDNRDT
     I              BENSDT                          WDNSDT
     I              BEBPTM                          WDBPTM
     I              BEBQTM                          WDBQTM
     I              BEBRTM                          WDBRTM
     I              BEBSTM                          WDBSTM
     I              BEBTTM                          WDBTTM
     I              BEH0NX                          WDH0NX
     I              BEH1NX                          WDH1NX
     I              BEH2NX                          WDH2NX
     I              BEH3NX                          WDH3NX
     I              BEH4NX                          WDH4NX
     I              BEC0C7                          WDC0C7
     I              BEUVST                          WDUVST
     I              BEUWST                          WDUWST
     I              BEUXST                          WDUXST
     I              BEAATM                          WDAATM
     I              BEAYNA                          WDAYNA
     I              BEA0NA                          WDA0NA
     I              BEAXDT                          WDAXDT
      *
     IYARDCS      DS                            779
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      * Outward parameters
     IPARC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Order Number
     I                                    P   3   60PAC4NB
      * I :  Order Type - Sales
     I                                        7   8 PAJNCD
      * I :  A/R Customer Number
     I                                    P   9  120PAANC7
      * I :  Ship To Customer
     I                                    P  13  160PABKC7
      * I :  Ship To Name
     I                                       17  46 PABRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PAHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PAHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PAHPNA
      * I :  Ship To City
     I                                      137 156 PAHNNA
      * I :  Ship To State Code
     I                                      157 158 PADBCD
      * I :  Ship To Zip/Postal Code
     I                                      159 169 PACKTX
      * I :  Bill to Customer
     I                                    P 170 1730PAB0C7
      * I :  Bill to Name
     I                                      174 203 PAAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PAB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PAB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PAB4NA
      * I :  Bill to City
     I                                      294 313 PAB2NA
      * I :  Bill to State Code
     I                                      314 315 PABHCD
      * I :  Bill to Zip/Postal Code
     I                                      316 326 PAC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PABCNA
      * I :  Order Date
     I                                    P 342 3450PAA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PAA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PAGNDT
      * I :  Cancel Date
     I                                    P 354 3570PAACDT
      * I :  Terms Code
     I                                      358 359 PAAQCD
      * I :  Special Instructions
     I                                      360 399 PAB6NA
      * I :  Special Instructions 2
     I                                      400 439 PABYNA
      * I :  Carrier Code
     I                                      440 442 PABZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PAGTST
      * I :  Comment Print Inv/Cr.Memo
     I                                      444 444 PAGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PAGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PAQFST
      * I :  Reason Code
     I                                      447 449 PACQCD
      * I :  Order in Use
     I                                      450 450 PAGJST
      * I :  Header Status
     I                                      451 451 PAGWST
      * I :  Header Status Last
     I                                      452 452 PAGXST
      * I :  Order Type Print Status
     I                                      453 453 PAGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PAAODT
      * I :  User Original Entry
     I                                      458 467 PAAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PACXDT
      * I :  Order Value Total
     I                                    P 472 4772PAJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PAA1WG
      * I :  Credit Hold
     I                                      484 484 PAXIST
      * I :  Production Hold
     I                                      485 485 PAXJST
      * I :  New Customer Hold
     I                                      486 486 PAXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PAEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PAAFTM
      * I :  Accounts Receiv. Ent 1
     I                                      494 497 PAE8CD
      * I :  Accounts Receiv. Ent 2
     I                                      498 509 PAE9CD
      * I :  Load ID
     I                                    P 510 5130PARMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PATBNB
      * I :  Rated Freight
     I                                    P 517 5222PAR1NB
      * I :  LTL Flag
     I                                      523 523 PAPJST
      * I :  Price Audit
     I                                      524 524 PAU0ST
      * I :  Price Status
     I                                      525 525 PAU1ST
      * I :  Shipping Method
     I                                      526 527 PAQ2CD
      * I :  Export Status
     I                                      528 528 PAU2ST
      * I :  Palletize
     I                                      529 529 PAVEST
      * I :  Shrink Wrap
     I                                      530 530 PAVFST
      * I :  Slip Sheet
     I                                      531 531 PAVGST
      * I :  Age Code
     I                                      532 532 PARPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PARNNB
      * I :  Load Type
     I                                      536 536 PAVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PAATIN
      * I :  Load Plan Order
     I                                      541 541 PAU4ST
      * I :  Print Pick Slip
     I                                      542 542 PAU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PARSRN
      * I :  Special Comment 1
     I                                      547 576 PAMHNA
      * I :  Special Comment 2
     I                                      577 606 PAMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PAWBST
      * I :  Sales Route Code
     I                                      608 610 PAR4CD
      * I :  Manager Level Code
     I                                      611 612 PABFCD
      * I :  VP Level Code
     I                                      613 615 PAQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PAT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PASICD
      * I :  Invoice Number
     I                                    P 623 6260PACONB
      * I :  Invoice Suffix
     I                                      627 628 PACEST
      * I :  Invoice Date
     I                                    P 629 6320PAAWDT
      * I :  Event Code
     I                                      633 634 PAJPCD
      * I :  Trans Contol AS400/Plant
     I                                      635 635 PAXUST
      * I :  Modified Flag
     I                                      636 636 PAZ1ST
      * I :  A/R order Value Total
     I                                    P 637 6422PAVRVA
      * I :  Billing Activity Type
     I                                      643 643 PAOBST
      * I :  Block Order Flag
     I                                      644 644 PABCST
      * I :  Order Certification Flag
     I                                      645 645 PABDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PAB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PAGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PAGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PAGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PAGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PAFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PAFOSX
      * I :  Order Emailed
     I                                      658 658 PAFPSX
      * I :  Export Docs Go w/Driver
     I                                      659 659 PAFQSX
      * I :  Shipping Temp Code C/F
     I                                      660 660 PAFRSX
      * I :  Broker Order Status
     I                                      661 661 PAFSSX
      * I :  Air Freight Order
     I                                      662 662 PAFTSX
      * I :  Order Requires Review
     I                                      663 664 PAFUSX
      * I :  EDI Nistevo Select Sts
     I                                      665 666 PAFVSX
      * I :  Export USDA Approved
     I                                      667 668 PAFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PAFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PAFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PANODT
      * I :  OH Unused Date 2
     I                                    P 679 6820PANPDT
      * I :  OH Unused Date 3
     I                                    P 683 6860PANQDT
      * I :  OH Unused Date 4
     I                                    P 687 6900PANRDT
      * I :  OH Unused Date 5
     I                                    P 691 6940PANSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PABPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PABQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PABRTM
      * I :  OH Unused Time 4
     I                                    P 707 7100PABSTM
      * I :  OH Unused Time 5
     I                                    P 711 7140PABTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PAH0NX
      * I :  Act Non-Ref Frt Amount
     I                                    P 721 7262PAH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PAH2NX
      * I :  OH Total Non-Ref Frt Amt
     I                                    P 733 7382PAH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PAH4NX
      * I :  Claim Number
     I                                    P 745 7480PAC0C7
      * I :  EDI Status 1
     I                                      749 749 PAUVST
      * I :  EDI Status 2
     I                                      750 750 PAUWST
      * I :  EDI Status 3
     I                                      751 751 PAUXST
      * I :  Job Time
     I                                    P 752 7550PAAATM
      * I :  User Id
     I                                      756 765 PAAYNA
      * I :  Job Name
     I                                      766 775 PAA0NA
      * I :  Job Date
     I                                    P 776 7790PAAXDT
      *
     IQOMFJ1    E DSOMFJCPL1
      * UPD : Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WFRMNB
     I              FJAIC3                          WFAIC3
     I              FJAODT                          WFAODT
     I              FJPJST                          WFPJST
     I              FJPKST                          WFPKST
     I              FJRNNB                          WFRNNB
     I              FJDMTX                          WFDMTX
     I              FJDNTX                          WFDNTX
     I              FJDOTX                          WFDOTX
     I              FJWTTX                          WFWTTX
     I              FJWUTX                          WFWUTX
     I              FJRPNB                          WFRPNB
     I              FJFLAM                          WFFLAM
     I              FJXQST                          WFXQST
     I              FJRRNB                          WFRRNB
     I              FJDXTX                          WFDXTX
     I              FJDYTX                          WFDYTX
     I              FJSBNB                          WFSBNB
     I              FJBZNA                          WFBZNA
     I              FJRONB                          WFRONB
     I              FJSQNB                          WFSQNB
     I              FJR1NB                          WFR1NB
     I              FJVCST                          WFVCST
     I              FJVDST                          WFVDST
     I              FJSDNB                          WFSDNB
     I              FJPAOU                          WFPAOU
     I              FJDGWG                          WFDGWG
     I              FJSXNB                          WFSXNB
     I              FJHADT                          WFHADT
     I              FJAART                          WFAART
     I              FJDHWG                          WFDHWG
     I              FJDIWG                          WFDIWG
     I              FJAQDT                          WFAQDT
     I              FJS6NB                          WFS6NB
     I              FJT4NB                          WFT4NB
     I              FJPRTM                          WFPRTM
     I              FJNPSV                          WFNPSV
     I              FJJ8TX                          WFJ8TX
     I              FJTLMI                          WFTLMI
     I              FJJ9TX                          WFJ9TX
     I              FJQ2CD                          WFQ2CD
     I              FJVPCD                          WFVPCD
     I              FJDBCD                          WFDBCD
     I              FJGRWE                          WFGRWE
     I              FJXCCD                          WFXCCD
     I              FJU2ST                          WFU2ST
     I              FJF9DT                          WFF9DT
     I              FJONTM                          WFONTM
     I              FJJ4DT                          WFJ4DT
     I              FJTRTM                          WFTRTM
     I              FJJ5DT                          WFJ5DT
     I              FJSPTM                          WFSPTM
     I              FJJ6DT                          WFJ6DT
     I              FJLFTM                          WFLFTM
     I              FJJ7DT                          WFJ7DT
     I              FJBOTM                          WFBOTM
     I              FJJ8DT                          WFJ8DT
     I              FJBLTM                          WFBLTM
     I              FJKIDT                          WFKIDT
     I              FJASTM                          WFASTM
     I              FJKADT                          WFKADT
     I              FJAJCM                          WFAJCM
     I              FJXACD                          WFXACD
     I              FJOANA                          WFOANA
     I              FJK4TX                          WFK4TX
     I              FJVOAG                          WFVOAG
     I              FJKBDT                          WFKBDT
     I              FJNBBO                          WFNBBO
     I              FJW4CD                          WFW4CD
     I              FJEFDT                          WFEFDT
     I              FJCNTN                          WFCNTN
     I              FJKCDT                          WFKCDT
     I              FJTMIN                          WFTMIN
     I              FJKDDT                          WFKDDT
     I              FJVMNB                          WFVMNB
     I              FJOCFR                          WFOCFR
     I              FJKJDT                          WFKJDT
     I              FJATTM                          WFATTM
     I              FJOTRS                          WFOTRS
     I              FJRNST                          WFRNST
     I              FJBRBK                          WFBRBK
     I              FJEIDT                          WFEIDT
     I              FJRMST                          WFRMST
     I              FJAJCD                          WFAJCD
     I              FJKKDT                          WFKKDT
     I              FJAVTM                          WFAVTM
     I              FJKZDT                          WFKZDT
     I              FJAXTM                          WFAXTM
     I              FJLHOS                          WFLHOS
     I              FJLHOR                          WFLHOR
     I              FJWNTX                          WFWNTX
     I              FJOITX                          WFOITX
     I              FJOJTX                          WFOJTX
     I              FJLLDT                          WFLLDT
     I              FJLSHG                          WFLSHG
     I              FJYPST                          WFYPST
     I              FJK0DT                          WFK0DT
     I              FJAYTM                          WFAYTM
     I              FJKNNX                          WFKNNX
     I              FJICWG                          WFICWG
     I              FJIDWG                          WFIDWG
     I              FJH9SX                          WFH9SX
     I              FJWOTX                          WFWOTX
     I              FJK1DT                          WFK1DT
     I              FJAZTM                          WFAZTM
     I              FJK2DT                          WFK2DT
     I              FJA0TM                          WFA0TM
     I              FJROST                          WFROST
     I              FJRPST                          WFRPST
     I              FJRQST                          WFRQST
     I              FJRRST                          WFRRST
     I              FJZBVA                          WFZBVA
     I              FJWPTX                          WFWPTX
     I              FJWQTX                          WFWQTX
     I              FJWRTX                          WFWRTX
     I              FJWSTX                          WFWSTX
     I              FJRVSX                          WFRVSX
     I              FJRUSX                          WFRUSX
     I              FJRWSX                          WFRWSX
     I              FJRXSX                          WFRXSX
     I              FJRYSX                          WFRYSX
     I              FJRZSX                          WFRZSX
     I              FJR0SX                          WFR0SX
     I              FJR1SX                          WFR1SX
     I              FJR2SX                          WFR2SX
     I              FJR3SX                          WFR3SX
     I              FJR4SX                          WFR4SX
     I              FJPYDT                          WFPYDT
     I              FJCKTM                          WFCKTM
     I              FJPZDT                          WFPZDT
     I              FJCLTM                          WFCLTM
     I              FJP0DT                          WFP0DT
     I              FJCMTM                          WFCMTM
     I              FJP1DT                          WFP1DT
     I              FJCNTM                          WFCNTM
     I              FJP2DT                          WFP2DT
     I              FJCOTM                          WFCOTM
     I              FJP3DT                          WFP3DT
     I              FJCQTM                          WFCQTM
     I              FJUVST                          WFUVST
     I              FJUWST                          WFUWST
     I              FJUXST                          WFUXST
     I              FJAATM                          WFAATM
     I              FJAYNA                          WFAYNA
     I              FJA0NA                          WFA0NA
     I              FJAXDT                          WFAXDT
      *
     IYBRDCS      DS                            793
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Header TRG
      * I : RST Company Number
     I                                    P   1   20P1AIC3
      * I :  Order Number
     I                                    P   3   60P1C4NB
      * I :  Actual Shipped Date
     I                                    P   7  100P1GNDT
     IP2PARM      DS
      * FLD: Sales History
      * N :  Affect Inventory Status
     I                                        1   1 P2AMST
      * N :  Affect Sales Doll Status
     I                                        2   2 P2ANST
      * N :  Affect Sales Pnds Status
     I                                        3   3 P2VAST
      * N :  Accounting Year Code
     I                                    P   4   60P2ESNB
      * N :  Accounting Period Code
     I                                    P   7   80P2ETNB
      * N :  OM Week
     I                                    P   9  100P2BZNB
     IP3PARM      DS
      * N :  Quantity Billed
     I                                    P   1   62P3EXQT
     IP4PARM      DS
      * N :  Weight Billed
     I                                    P   1   62P4BYWG
     IP5PARM      DS
      * FLD: A/R Header
      * N :  Order Number Ref
     I                                    P   1   40P5CAC7
     IP6PARM      DS
      * N :  Invoiced Flag USR
     I                                        1   1 P6CVST
     IP7PARM      DS
      * N :  USR Process status
     I                                        1   1 P7FLST
     IP8PARM      DS
      * I :  Process Cust Types Usr
     I                                        1   2 P8YDSX
     IP9PARM      DS
      * FLD: *Arrays
      * N : MAP Warehouse Code
     I                                        1   3 P9AJCD
      * N : MAP Application Code
     I                                        4   9 P9DNCD
      * N : MAP Salesperson Code
     I                                       10  12 P9BCCD
      * N : MAP Allow Multi-Company
     I                                       13  13 P9I6ST
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P1GNDT    PARM           WP0003  70       Actual Shipped
     C           P8YDSX    PARM           WP0004  2        Process Cust Ty
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prt Complete Txfr-HPB PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$EENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * Prt Complete Txfr-HPB PF: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN BEAIC3    WQKA01           Company Number
      * Define keylist
     C           KRSA      KLIST
     C                     KFLD           WQKA01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQKA01           Company Number
      * Establish starting position
     C           KRSA      SETLL@BFCPH7                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        Company Number
     C                     MOVEL'Y'       W0AL01  1        Order Number
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDBEAIC3    $CAIC3           Company Number
     C                     MOVEL*BLANK    $CSQTX           Company Name DR
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDBEAIC3    $DAIC3           Company Number
     C                     Z-ADDBEC4NB    $DC4NB           Order Number
     C                     Z-ADDBERMNB    $DRMNB           Load ID
     C                     MOVELBEJNCD    $DJNCD           Order Type - Sa
     C                     Z-ADDBEANC7    $DANC7           A/R Customer Nu
     C                     Z-ADDBEBKC7    $DBKC7           Ship To Custome
     C                     MOVELBEBRTX    $DBRTX           Ship To Name
     C                     MOVELBEHMNA    $DHMNA           Ship To Address
     C                     MOVELBEHONA    $DHONA           Ship To Address
     C                     MOVELBEHPNA    $DHPNA           Ship To Address
     C                     MOVELBEHNNA    $DHNNA           Ship To City
     C                     MOVELBEDBCD    $DDBCD           Ship To State C
     C                     MOVELBECKTX    $DCKTX           Ship To Zip/Pos
     C                     Z-ADDBEB0C7    $DB0C7           Bill to Custome
     C                     MOVELBEAETX    $DAETX           Bill to Name
     C                     MOVELBEB1NA    $DB1NA           Bill to Address
     C                     MOVELBEB3NA    $DB3NA           Bill to Address
     C                     MOVELBEB4NA    $DB4NA           Bill to Address
     C                     MOVELBEB2NA    $DB2NA           Bill to City
     C                     MOVELBEBHCD    $DBHCD           Bill to State C
     C                     MOVELBEC8TX    $DC8TX           Bill to Zip/Pos
     C                     MOVELBEBCNA    $DBCNA           Customer Purcha
     C                     Z-ADDBEA0DT    $DA0DT           Order Date
     C                     Z-ADDBEA5DT    $DA5DT           Requested Ship
     C                     Z-ADDBEACDT    $DACDT           Cancel Date
     C                     MOVELBEAQCD    $DAQCD           Terms Code
     C                     MOVELBEB6NA    $DB6NA           Special Instruc
     C                     MOVELBEBYNA    $DBYNA           Special Instruc
     C                     MOVELBEBZNA    $DBZNA           Carrier Code
     C                     MOVELBEGTST    $DGTST           Comment Print A
     C                     MOVELBEGVST    $DGVST           Comment Print I
     C                     MOVELBEGUST    $DGUST           Comment Print P
     C                     MOVELBEQFST    $DQFST           Comment Print S
     C                     MOVELBECQCD    $DCQCD           Reason Code
     C                     MOVELBEGJST    $DGJST           Order in Use
     C                     MOVELBEGWST    $DGWST           Header Status
     C                     MOVELBEGXST    $DGXST           Header Status L
     C                     MOVELBEGYST    $DGYST           Order Type Prin
     C                     Z-ADDBEAODT    $DAODT           Scheduled Ship
     C                     Z-ADDBEGNDT    $DGNDT           Actual Shipped
     C                     MOVEL*BLANK    $DAJCD           Warehouse Code
     C                     MOVELBEAIVN    $DAIVN           User Original E
     C                     Z-ADDBECXDT    $DCXDT           Date of Origina
     C                     Z-ADDBEJZVA    $DJZVA           Order Value Tot
     C                     Z-ADDBEA1WG    $DA1WG           Order Weight To
     C                     MOVELBEXIST    $DXIST           Credit Hold
     C                     MOVELBEXJST    $DXJST           Production Hold
     C                     MOVELBEXKST    $DXKST           New Customer Ho
     C                     Z-ADDBEEIDT    $DEIDT           Requested Deliv
     C                     Z-ADDBEAFTM    $DAFTM           Requested Deliv
     C                     MOVELBEE8CD    $DE8CD           Accounts Receiv
     C                     MOVELBEE9CD    $DE9CD           Accounts Receiv
     C                     Z-ADDBETBNB    $DTBNB           Absorbed Freigh
     C                     Z-ADDBER1NB    $DR1NB           Rated Freight
     C                     MOVELBEPJST    $DPJST           LTL Flag
     C                     MOVELBEU0ST    $DU0ST           Price Audit
     C                     MOVELBEU1ST    $DU1ST           Price Status
     C                     MOVELBEQ2CD    $DQ2CD           Shipping Method
     C                     MOVELBEU2ST    $DU2ST           Export Status
     C                     MOVELBEVEST    $DVEST           Palletize
     C                     MOVELBEVFST    $DVFST           Shrink Wrap
     C                     MOVELBEVGST    $DVGST           Slip Sheet
     C                     MOVELBERPCD    $DRPCD           Age Code
     C                     Z-ADDBERNNB    $DRNNB           Reefer Temperat
     C                     MOVELBEVDST    $DVDST           Load Type
     C                     Z-ADDBEATIN    $DATIN           Attach to Invoi
     C                     MOVELBEU4ST    $DU4ST           Load Plan Order
     C                     MOVELBEU5ST    $DU5ST           Print Pick Slip
     C                     Z-ADDBERSRN    $DRSRN           Resell Referenc
     C                     MOVELBEMHNA    $DMHNA           Special Comment
     C                     MOVELBEMINA    $DMINA           Special Comment
     C                     MOVELBEWBST    $DWBST           Affect Auto Acc
     C                     MOVELBER4CD    $DR4CD           Sales Route Cod
     C                     MOVELBEBFCD    $DBFCD           Manager Level C
     C                     MOVELBEQ4CD    $DQ4CD           VP Level Code
     C                     Z-ADDBET3NB    $DT3NB           Attach to Order
     C                     MOVELBESICD    $DSICD           Reason for Pric
     C                     Z-ADDBECONB    $DCONB           Invoice Number
     C                     MOVELBECEST    $DCEST           Invoice Suffix
     C                     Z-ADDBEAWDT    $DAWDT           Invoice Date
     C                     MOVELBEJPCD    $DJPCD           Event Code
     C                     MOVELBEXUST    $DXUST           Trans Contol AS
     C                     MOVELBEZ1ST    $DZ1ST           Modified Flag
     C                     Z-ADDBEVRVA    $DVRVA           A/R order Value
     C                     MOVELBEOBST    $DOBST           Billing Activit
     C                     MOVELBEBCST    $DBCST           Block Order Fla
     C                     MOVELBEBDST    $DBDST           Order Certifica
     C                     Z-ADDBEB7VL    $DB7VL           Invoice Order V
     C                     MOVELBEGASX    $DGASX           Process Sts for
     C                     MOVELBEGBSX    $DGBSX           Order Conf Fax
     C                     MOVELBEGCSX    $DGCSX           Manifest Fax St
     C                     MOVELBEGDSX    $DGDSX           Invoice Fax Sts
     C                     MOVELBEFNSX    $DFNSX           Transfer in Sto
     C                     MOVELBEFOSX    $DFOSX           Email Cust On O
     C                     MOVELBEFPSX    $DFPSX           Order Emailed
     C                     MOVELBEFQSX    $DFQSX           Export Docs Go
     C                     MOVELBEFRSX    $DFRSX           Shipping Temp C
     C                     MOVELBEFSSX    $DFSSX           Broker Order St
     C                     MOVELBEFTSX    $DFTSX           Air Freight Ord
     C                     MOVELBEFUSX    $DFUSX           Order Requires
     C                     MOVELBEFVSX    $DFVSX           EDI Nistevo Sel
     C                     MOVELBEFWSX    $DFWSX           Export USDA App
     C                     MOVELBEFXSX    $DFXSX           HPB Ship to War
     C                     Z-ADD*ZERO     $DIWNX           Quantity Transf
     C                     MOVEL*BLANK    $DAGCD           U/M - Ordered
     C                     MOVELBEFYSX    $DFYSX           OH TF Exempt Co
     C                     Z-ADDBENODT    $DNODT           OH Appt Confirm
     C                     Z-ADDBENPDT    $DNPDT           OH Unused Date
     C                     Z-ADDBENQDT    $DNQDT           OH Unused Date
     C                     Z-ADDBENRDT    $DNRDT           OH Unused Date
     C                     Z-ADDBENSDT    $DNSDT           OH Unused Date
     C                     Z-ADDBEBPTM    $DBPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    $DBQTM           Time of Origina
     C                     Z-ADDBEBRTM    $DBRTM           OH Appt Confirm
     C                     Z-ADDBEBSTM    $DBSTM           OH Unused Time
     C                     Z-ADDBEBTTM    $DBTTM           OH Unused Time
     C                     Z-ADDBEH0NX    $DH0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    $DH1NX           Act Non-Ref Frt
     C                     Z-ADDBEH2NX    $DH2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    $DH3NX           OH Total Non-Re
     C                     Z-ADDBEH4NX    $DH4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    $DC0C7           Claim Number
     C                     MOVELBEUVST    $DUVST           EDI Status 1
     C                     MOVELBEUWST    $DUWST           EDI Status 2
     C                     MOVELBEUXST    $DUXST           EDI Status 3
     C                     Z-ADDBEAATM    $DAATM           Job Time
     C                     MOVELBEAYNA    $DAYNA           User Id
     C                     MOVELBEA0NA    $DA0NA           Job Name
     C                     Z-ADDBEAXDT    $DAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN BEAIC3    WZA001           Company Number
     C                     Z-ADDBEAIC3    WZA001
     C           *LIKE     DEFN BEC4NB    WZA002           Order Number
     C                     Z-ADDBEC4NB    WZA002
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C           KRSA      READE@BFCPH7                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Order Number is Greater then zero
      *   |- c2    : DB1.Order Number NE PAR.Order Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1C4NB    IFGT *ZERO                      *IF
     C           BEC4NB    IFNE P1C4NB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Actual Shipped Date is entered
      *   |- c2    : DB1.Actual Shipped Date GT PAR.Actual Shipped Date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1GNDT    IFNE *ZERO                      *IF
     C           BEGNDT    IFGT P1GNDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        Company Number
     C                     MOVEL*BLANK    W0AL01  1        Order Number
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        Company Number
     C                     MOVEL'Y'       W0AL01  1        Order Number
     C                     ELSE
      * Next record - Detect level breaks
     C           BEAIC3    IFNE WZA001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           BEC4NB    IFNE WZA002                     Order Number
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of Prt Complete Txfr-HPB PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of Prt Complete Txfr-HPB PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print Company Number of Prt Complete Txfr-HPB PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Company Number format
     C                     MOVEL*BLANK    $CSQTX           Company Name DR
      * Company Name DRV
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SDRVGN
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $CAIC3    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$CAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VCAIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VCAIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Print format
     C                     WRITE$CKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP00
     C                     END                             FI
      * Print Order Number of Prt Complete Txfr-HPB PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print Detail line. of Prt Complete Txfr-HPB PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
     C                     MOVEL'Y'       P7FLST           USR Process sta
      * Do not process if load status <> "S"
      * CASE: DB1.Load ID NE WRK.ZERO
     C           BERMNB    IFNE WUW0NB                     *IF
      * RTV Load Status        RT - Load Header  * 
     C                     EXSR SERVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL'N'       P7FLST           USR Process sta
     C                     ELSE
      * CASE: WRK.Load Status is Not Shipped
     C           WUPKST    IFEQ 'C'                        *IF
     C           WUPKST    OREQ 'E'
     C           WUPKST    OREQ 'I'
     C           WUPKST    OREQ 'L'
     C           WUPKST    OREQ 'U'
     C                     MOVEL'N'       P7FLST           USR Process sta
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * RTV EDI Status 1       RT - Load Header  * 
     C                     EXSR SFRVGN
      * Do not process if BOL not printed and the order is load planned
      * CASE: DB1.Load Plan Order is no
     C           BEU4ST    IFEQ 'N'                        *IF
     C                     ELSE
      * CASE: DB1.Modified Flag is Modified
     C           BEZ1ST    IFEQ 'M'                        *IF
     C                     ELSE
      * CASE: WRK.EDI Status 1 is Modified
     C           WUUVST    IFEQ 'M'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       P7FLST           USR Process sta
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * *********** RMC E00074 - 1/18/08 added this validation here.
      * Do Truck Departure validation if sts is Yes from company values
      * CASE: WRK.Status - Y or N is yes
     C           WUB8ST    IFEQ 'Y'                        *IF
      * RTV LdSts/DptDtTM/BOL RT - Load Header  * 
     C                     EXSR SGRVGN
      * Do not process if truck departure not entered
      * CASE: DB1.Load Plan Order is no
     C           BEU4ST    IFEQ 'N'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1ORc2
      *   |- c1    : WRK.Truck Departure Date is not entered
      *   |- c2    : WRK.Truck Departure Time is Not Entered
      *   '-
     C           WUKIDT    IFEQ *ZERO                      *IF
     C           WUASTM    OREQ *ZERO                      *OR
     C                     MOVEL'N'       P7FLST           USR Process sta
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * LCL.Scheduled Ship Date USR = JOB.*Job date + CON.-5 *DAYS
     C           ##JDT     ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-5        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL@CN,004   XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0001
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0001
     C                     END
      * OVERRIDE:  USR Process Status
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Scheduled Ship Date LT LCL.Scheduled Ship Date U
      *   |- c2    : WRK.Load Status is Shipped
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           BEAODT    IFLT YL0001                     *IF
     C           WUPKST    IFEQ 'S'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       P7FLST           USR Process sta
     C                     END                             *FI
      * *********** RMC E01814 - 1/04/12 added HPB Transfer Complete XF h
      * Only process completion if passed above edits
      * CASE: PAR.USR Process status is yes
     C           P7FLST    IFEQ 'Y'                        *IF
      * Process Shipping Detail
     C                     EXSR UASUBR                     Process Shippin
      * Change/Create A/R Summary Record
     C                     EXSR UBSUBR                     Change/Create A
      * RTV 1st Warehouse/UOM  RT - Order Detail  * 
     C                     EXSR SJRVGN
     C                     Z-ADDP3EXQT    $DIWNX           Quantity Transf
      * RTV Last Event Code    RT - Order Events  * 
     C                     EXSR SKRVGN
      * CRT History Event      RT - Order Events  * 
     C                     EXSR SLRVGN
      * Update Order Header Status and Event
      * NOTE:  Transfers are not really written to history
      * CHG for Invoice Post   CH - Order Header TRG  * 
     C                     EXSR SNCHRC
      * *** HPB Only - update "TRB" rcd with gallons transferred.   E1814
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
     C                     EXSR SORVGN
      * CASE: LCL.Company Organization is High Plains Biodiesel
     C           YL0005    IFEQ 'H'                        *IF
      * Exc Gen TRB Cmplt Txf XF - COA Batch Header RIN  * 
     C                     CALL 'PBBAXFR'              90  Exc Gen TRB Cmp
     C                     PARM *BLANK    W0RTN   7
     C                     PARM BEC4NB    WQ0028  70       Order Number
     C                     PARM BEAIC3    WQ0029  30       COA Shipping Co
     C                     PARM P8YDSX    WQ0030  2        Process Cust Ty
     C                     PARM BEGNDT    WQ0031  70       Actual Shipped
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBBAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * **** Read all Load Orders, if all orders have been Invoiced then
      * **** Update Load as Invoiced
      * RTV Ld Orders Invoiced RT - Order Header TRG  * 
     C                     EXSR SPRVGN
      * If all Load Orders have been Invoiced, then update load
      * CASE: PAR.Invoiced Flag USR is Invoiced
     C           P6CVST    IFEQ 'Y'                        *IF
      * CHG Load Status        CH - Load Header  * 
     C                     EXSR SQCHRC
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $DC4NB    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$DC4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VDC4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VDC4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $DBKC7    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$DBKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VDBKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VDBKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  $DAODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDAODT
      * Convert Actual Shipped Date to display format
      * Convert date
     C           1000000   ADD  $DGNDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDGNDT
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$DCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$DDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of Prt Complete Txfr-HPB PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of Prt Complete Txfr-HPB PF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  1         W0FSUM
     C                     END                             FI
      *
      * * Order Number of Prt Complete Txfr-HPB PF
     C           W0AP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Complete Txfr-HPB PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD4         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSA01           Application Cod
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSA01           Application Cod
     C                     MOVEL'OMS'     WQSA01           Application Cod
      * Establish starting position
     C           KRSSA     SETLL@DNRESF                    *
     C           KRSSA     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
     C           KRSSA     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSB01           Application Cod
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSB01           Application Cod
      * Establish starting position
     C           KRSSB     SETLL@DNRESF                    *
     C           KRSSB     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL@CN,001   W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSB     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Alpha Value        RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           KMAIC3           Company Number
     C                     KFLD           KMV8CD           Company Value C
      * Setup key
     C                     Z-ADDP1AIC3    KMAIC3           Company Number
     C                     MOVEL@CN,002   KMV8CD           Company Value C
      * Establish starting position
     C           KRSSC     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,001   W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELKMBXTX    WUB8ST           System Value Al
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADD$CAIC3    ABAIC3           Company Number
      * Establish starting position
     C           KRSSD     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $CSQTX           Name
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    $CSQTX           Name
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Load Status        RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDBERMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSE     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUPKST           Load Status
     C                     MOVEL@CN,001   W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL@CN,003   W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELFJPKST    WUPKST           Load Status
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV EDI Status 1       RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDBERMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSF     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUUVST           EDI Status 1
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFJUVST    WUUVST           EDI Status 1
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV LdSts/DptDtTM/BOL RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDBERMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSG     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUKIDT           Truck Departure
     C                     Z-ADD*ZERO     WUASTM           Truck Departure
     C                     MOVEL@CN,001   W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL@CN,003   W0RTN            *Return code
      * PAR = DB1 By name
     C                     Z-ADDFJKIDT    WUKIDT           Truck Departure
     C                     Z-ADDFJASTM    WUASTM           Truck Departure
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV OD Whs/ShpCo/AccCo RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSH01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSH02           Order Number
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           Order Number
      * Setup key
     C                     Z-ADDBEAIC3    WQSH01           Company Number
     C                     Z-ADDBEC4NB    WQSH02           Order Number
      * Establish starting position
     C           KRSSH     SETLL@BGWKL1                    *
     C           KRSSH     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           OMGMST    IFEQ 'L'                        *IF
     C           OMGMST    OREQ 'A'
     C           OMGMST    OREQ 'C'
     C           OMGMST    OREQ 'R'
     C           OMGMST    OREQ 'E'
     C           OMGMST    OREQ 'H'
     C           OMGMST    OREQ 'I'
      * RTV OD Whs/ShpCo/AccCo RT - Warehouse  * Retrieve object
     C                     EXSR SIRVGN
     C                     MOVELOMAJCD    YN0004           Warehouse Code
     C                     GOTO SHEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSH     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV OD Whs/ShpCo/AccCo RT - Warehouse  * Retrieve object
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELOMAJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSI     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0002           Shipping Compan
     C                     Z-ADD*ZERO     YL0003           Accounting Comp
     C                     MOVEL@CN,001   W0RTN            *Return code
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDADBWC3    YL0002           Shipping Compan
     C                     Z-ADDADBTC3    YL0003           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV 1st Warehouse/UOM  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSJ01           Company Number
     C           *LIKE     DEFN WAC4NB    WQSJ02           Order Number
      * Define keylist
     C           KPSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Order Number
     C                     KFLD           WADPNB           Order Sequence
     C                     KFLD           WAUENB           Order Secondary
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Order Number
      * Setup key
     C                     Z-ADDBEAIC3    WQSJ01           Company Number
     C                     Z-ADDBEC4NB    WQSJ02           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
      * Establish starting position
     C           KPSSJ     SETLL@BGWKAE                    *
     C           KRSSJ     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $DAJCD           Warehouse Code
     C                     MOVEL*BLANK    $DAGCD           U/M - Ordered
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAAJCD    $DAJCD           Warehouse Code
     C                     MOVELWAAGCD    $DAGCD           U/M - Ordered
     C                     GOTO SJEXIT                     *QUIT
     C           KRSSJ     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Last Event Code    RT - Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN EYAIC3    WQSK01           Company Number
     C           *LIKE     DEFN EYC4NB    WQSK02           Order Number
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Company Number
     C                     KFLD           WQSK02           Order Number
      * Setup key
     C                     Z-ADDBEAIC3    WQSK01           Company Number
     C                     Z-ADDBEC4NB    WQSK02           Order Number
      * Establish starting position
     C           KRSSK     SETLL@EYCPY2                    *
     C           KRSSK     READE@EYCPY2                  90*
      * Data record not found
     C   90                MOVEL'USR1074' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDEYQ2NB    WUNFNN           Event Number
     C                     MOVELEYJPCD    WUJPCD           Event Code
     C           KRSSK     READE@EYCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * CRT History Event      RT - Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSL01           Company Number
     C           *LIKE     DEFN WBC4NB    WQSL02           Order Number
     C           *LIKE     DEFN WBJPCD    WQSL03           Event Code
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Company Number
     C                     KFLD           WQSL02           Order Number
     C                     KFLD           WQSL03           Event Code
      * Setup key
     C                     Z-ADDBEAIC3    WQSL01           Company Number
     C                     Z-ADDBEC4NB    WQSL02           Order Number
     C                     MOVELWUJPCD    WQSL03           Event Code
      * Establish starting position
     C           KRSSL     SETLL@EYCPZE                    *
     C           KRSSL     READE@EYCPZE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1074' W0RTN   7
      * USER: Processing if Data record not found
      * CRT OP Order Events    CR - Order Events  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDBEAIC3    WL0001           Company Number
     C                     Z-ADDBEC4NB    WL0002           Order Number
     C                     Z-ADD1         WL0003           Event Number
     C                     MOVELWUJPCD    WL0004    P      Event Code
     C                     Z-ADDBEAIC3    WL0005           Invoice/Memo Co
     C                     Z-ADD*ZERO     WL0006           Invoice/Memo Nu
     C                     MOVEL*BLANK    WL0007           Invoice/Memo Su
     C                     Z-ADD##JDT     WL0008           Event Date
     C                     MOVEL'Y'       WL0009    P      Activity Comple
     C                     MOVEL'N'       WL0010    P      Activity Hold
     C                     MOVEL'Y'       WL0011    P      Post Cash Compl
     C                     Z-ADD*ZERO     WL0012           Cross Event Ref
     C                     Z-ADD*ZERO     WL0013           Cross Event Ref
     C                     Z-ADD*ZERO     WL0014           Cross Event Ref
     C                     Z-ADD*ZERO     WL0015           Ship To Custome
     C                     EXSR SMCRRC
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WBQ2NB    ADD  1         WUQ2NB           Event Number
      * CRT OP Order Events    CR - OP Order Events  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0001           Company Number
     C                     Z-ADDWBC4NB    WL0002           Order Number
     C                     Z-ADDWUQ2NB    WL0003           Event Number
     C                     MOVEL'07'      WL0004    P      Event Code
     C                     Z-ADDWBAIC3    WL0005           Invoice/Memo Co
     C                     Z-ADDWBQ7NB    WL0006           Invoice/Memo Nu
     C                     MOVELWBOMST    WL0007    P      Invoice/Memo Su
     C                     Z-ADD##JDT     WL0008           Event Date
     C                     MOVEL'N'       WL0009    P      Activity Comple
     C                     MOVEL'N'       WL0010    P      Activity Hold
     C                     MOVEL'N'       WL0011    P      Post Cash Compl
     C                     Z-ADD*ZERO     WL0012           Cross Event Ref
     C                     Z-ADD*ZERO     WL0013           Cross Event Ref
     C                     Z-ADD*ZERO     WL0014           Cross Event Ref
     C                     Z-ADDBEBKC7    WL0015           Ship To Custome
     C                     EXSR SMCRRC
     C                     GOTO SLEXIT                     *QUIT
     C           KRSSL     READE@EYCPZE                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCRRC    BEGSR
      *================================================================
      * CRT OP Order Events    CR - Order Events  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  1        EDI Status 1
     C                     MOVEL*BLANK    WN0002  1        EDI Status 2
     C                     MOVEL*BLANK    WN0003  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0004  60       Job Time
     C                     MOVEL*BLANK    WN0005 10        User Id
     C                     MOVEL*BLANK    WN0006 10        Job Name
     C                     Z-ADD*ZERO     WN0007  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @EYCPY3
     C                     Z-ADDWL0001    WCAIC3           Company Number
     C                     Z-ADDWL0002    WCC4NB           Order Number
     C                     Z-ADDWL0003    WCQ2NB           Event Number
     C                     MOVELWL0004    WCJPCD           Event Code
     C                     Z-ADDWL0005    WCAUC3           Invoice/Memo Co
     C                     Z-ADDWL0006    WCQ7NB           Invoice/Memo Nu
     C                     MOVELWL0007    WCOMST           Invoice/Memo Su
     C                     Z-ADDWL0008    WCD2DT           Event Date
     C                     MOVELWL0009    WCONST           Activity Comple
     C                     MOVELWL0010    WCOOST           Activity Hold
     C                     MOVELWL0011    WCOPST           Post Cash Compl
     C                     Z-ADDWL0012    WCAWC3           Cross Event Ref
     C                     Z-ADDWL0013    WCQ8NB           Cross Event Ref
     C                     Z-ADDWL0014    WCQ9NB           Cross Event Ref
     C                     Z-ADDWL0015    WCBKC7           Ship To Custome
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WCAATM           Job Time
     C                     MOVEL##USR     WCAYNA           User Id
     C                     MOVEL##JOB     WCA0NA           Job Name
     C                     Z-ADD##JDT     WCAXDT           Job Date
     C           KLCRSM    KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
     C                     KFLD           WCQ2NB           Event Number
      * Check for duplicate primary key
     C           KLCRSM    SETLL@EYCPY3                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1075' W0RTN   7
      * Send message 'Order Events           EX'
     C                     MOVEL'USR1075' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C                     WRITE@EYCPY3                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNCHRC    BEGSR
      *================================================================
      * CHG for Invoice Post   CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0008  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0009  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0010  70       Ship To Custome
     C                     MOVEL*BLANK    WN0011 30        Ship To Name
     C                     MOVEL*BLANK    WN0012 30        Ship To Address
     C                     MOVEL*BLANK    WN0013 30        Ship To Address
     C                     MOVEL*BLANK    WN0014 30        Ship To Address
     C                     MOVEL*BLANK    WN0015 20        Ship To City
     C                     MOVEL*BLANK    WN0016  2        Ship To State C
     C                     MOVEL*BLANK    WN0017 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0018  70       Bill to Custome
     C                     MOVEL*BLANK    WN0019 30        Bill to Name
     C                     MOVEL*BLANK    WN0020 30        Bill to Address
     C                     MOVEL*BLANK    WN0021 30        Bill to Address
     C                     MOVEL*BLANK    WN0022 30        Bill to Address
     C                     MOVEL*BLANK    WN0023 20        Bill to City
     C                     MOVEL*BLANK    WN0024  2        Bill to State C
     C                     MOVEL*BLANK    WN0025 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0026 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0027  70       Order Date
     C                     Z-ADD*ZERO     WN0028  70       Requested Ship
     C                     Z-ADD*ZERO     WN0029  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0030  70       Cancel Date
     C                     MOVEL*BLANK    WN0031  2        Terms Code
     C                     MOVEL*BLANK    WN0032 40        Special Instruc
     C                     MOVEL*BLANK    WN0033 40        Special Instruc
     C                     MOVEL*BLANK    WN0034  3        Carrier Code
     C                     MOVEL*BLANK    WN0035  1        Comment Print A
     C                     MOVEL*BLANK    WN0036  1        Comment Print I
     C                     MOVEL*BLANK    WN0037  1        Comment Print P
     C                     MOVEL*BLANK    WN0038  1        Comment Print S
     C                     MOVEL*BLANK    WN0039  3        Reason Code
     C                     MOVEL*BLANK    WN0040  1        Order in Use
     C                     MOVEL*BLANK    WN0041  1        Header Status L
     C                     Z-ADD*ZERO     WN0042  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0043 10        User Original E
     C                     Z-ADD*ZERO     WN0044  70       Date of Origina
     C                     Z-ADD*ZERO     WN0045 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0046 112       Order Weight To
     C                     MOVEL*BLANK    WN0047  1        Credit Hold
     C                     MOVEL*BLANK    WN0048  1        Production Hold
     C                     MOVEL*BLANK    WN0049  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0050  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0051  40       Requested Deliv
     C                     MOVEL*BLANK    WN0052  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0053 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0054  70       Load ID
     C                     Z-ADD*ZERO     WN0055  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0056 112       Rated Freight
     C                     MOVEL*BLANK    WN0057  1        LTL Flag
     C                     MOVEL*BLANK    WN0058  1        Price Audit
     C                     MOVEL*BLANK    WN0059  1        Price Status
     C                     MOVEL*BLANK    WN0060  2        Shipping Method
     C                     MOVEL*BLANK    WN0061  1        Export Status
     C                     MOVEL*BLANK    WN0062  1        Palletize
     C                     MOVEL*BLANK    WN0063  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0064  1        Slip Sheet
     C                     MOVEL*BLANK    WN0065  1        Age Code
     C                     Z-ADD*ZERO     WN0066  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0067  1        Load Type
     C                     Z-ADD*ZERO     WN0068  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0069  1        Load Plan Order
     C                     MOVEL*BLANK    WN0070  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0071  70       Resell Referenc
     C                     MOVEL*BLANK    WN0072 30        Special Comment
     C                     MOVEL*BLANK    WN0073 30        Special Comment
     C                     MOVEL*BLANK    WN0074  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0075  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0076  2        Manager Level C
     C                     MOVEL*BLANK    WN0077  3        VP Level Code
     C                     Z-ADD*ZERO     WN0078  70       Attach to Order
     C                     MOVEL*BLANK    WN0079  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0080  70       Invoice Number
     C                     MOVEL*BLANK    WN0081  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0082  70       Invoice Date
     C                     MOVEL*BLANK    WN0083  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0084  1        Modified Flag
     C                     Z-ADD*ZERO     WN0085 112       Invoice Order V
     C                     MOVEL*BLANK    WN0086  1        Process Sts for
     C                     MOVEL*BLANK    WN0087  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0088  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0089  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0090  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0091  1        Email Cust On O
     C                     MOVEL*BLANK    WN0092  1        Order Emailed
     C                     MOVEL*BLANK    WN0093  1        Export Docs Go
     C                     MOVEL*BLANK    WN0094  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0095  1        Broker Order St
     C                     MOVEL*BLANK    WN0096  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0097  2        Order Requires
     C                     MOVEL*BLANK    WN0098  2        EDI Nistevo Sel
     C                     MOVEL*BLANK    WN0099  2        Export USDA App
     C                     MOVEL*BLANK    WN0100  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0101  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0102  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0103  70       OH Unused Date
     C                     Z-ADD*ZERO     WN0104  70       OH Unused Date
     C                     Z-ADD*ZERO     WN0105  70       OH Unused Date
     C                     Z-ADD*ZERO     WN0106  70       OH Unused Date
     C                     Z-ADD*ZERO     WN0107  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0108  60       Time of Origina
     C                     Z-ADD*ZERO     WN0109  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0110  60       OH Unused Time
     C                     Z-ADD*ZERO     WN0111  60       OH Unused Time
     C                     Z-ADD*ZERO     WN0112 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0113 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0114 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0115 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0116 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0117  70       Claim Number
     C                     MOVEL*BLANK    WN0118  1        EDI Status 1
     C                     MOVEL*BLANK    WN0119  1        EDI Status 2
     C                     MOVEL*BLANK    WN0120  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0121  60       Job Time
     C                     MOVEL*BLANK    WN0122 10        User Id
     C                     MOVEL*BLANK    WN0123 10        Job Name
     C                     Z-ADD*ZERO     WN0124  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDBEAIC3    WDAIC3           Company Number
     C                     Z-ADDBEC4NB    WDC4NB           Order Number
      *
     C           KLCHSN    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
     C           KLCHSN    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YARDCS
      * USER: Processing after Data read
     C                     MOVELWDGWST    WN0041           Header Status L
      * Move non-key fields to @BECPFJ
     C                     MOVEL'C'       WDGWST    P      Header Status
     C                     MOVEL'Y'       WDGYST    P      Order Type Prin
     C                     MOVEL'07'      WDJPCD    P      Event Code
     C                     Z-ADDBEVRVA    WDVRVA           A/R order Value
     C                     MOVELBEOBST    WDOBST    P      Billing Activit
     C                     MOVELBEBCST    WDBCST    P      Block Order Fla
     C                     MOVELBEBDST    WDBDST    P      Order Certifica
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##PGM     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - Order Header TRG  * 
     C                     CLEARPARC
     C                     Z-ADDWDAIC3    PAAIC3           Company Number
     C                     Z-ADDWDC4NB    PAC4NB           Order Number
     C                     MOVELWDJNCD    PAJNCD    P      Order Type - Sa
     C                     Z-ADDWDANC7    PAANC7           A/R Customer Nu
     C                     Z-ADDWDBKC7    PABKC7           Ship To Custome
     C                     MOVELWDBRTX    PABRTX    P      Ship To Name
     C                     MOVELWDHMNA    PAHMNA    P      Ship To Address
     C                     MOVELWDHONA    PAHONA    P      Ship To Address
     C                     MOVELWDHPNA    PAHPNA    P      Ship To Address
     C                     MOVELWDHNNA    PAHNNA    P      Ship To City
     C                     MOVELWDDBCD    PADBCD    P      Ship To State C
     C                     MOVELWDCKTX    PACKTX    P      Ship To Zip/Pos
     C                     Z-ADDWDB0C7    PAB0C7           Bill to Custome
     C                     MOVELWDAETX    PAAETX    P      Bill to Name
     C                     MOVELWDB1NA    PAB1NA    P      Bill to Address
     C                     MOVELWDB3NA    PAB3NA    P      Bill to Address
     C                     MOVELWDB4NA    PAB4NA    P      Bill to Address
     C                     MOVELWDB2NA    PAB2NA    P      Bill to City
     C                     MOVELWDBHCD    PABHCD    P      Bill to State C
     C                     MOVELWDC8TX    PAC8TX    P      Bill to Zip/Pos
     C                     MOVELWDBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDWDA0DT    PAA0DT           Order Date
     C                     Z-ADDWDA5DT    PAA5DT           Requested Ship
     C                     Z-ADDWDGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDWDACDT    PAACDT           Cancel Date
     C                     MOVELWDAQCD    PAAQCD    P      Terms Code
     C                     MOVELWDB6NA    PAB6NA    P      Special Instruc
     C                     MOVELWDBYNA    PABYNA    P      Special Instruc
     C                     MOVELWDBZNA    PABZNA    P      Carrier Code
     C                     MOVELWDGTST    PAGTST    P      Comment Print A
     C                     MOVELWDGVST    PAGVST    P      Comment Print I
     C                     MOVELWDGUST    PAGUST    P      Comment Print P
     C                     MOVELWDQFST    PAQFST    P      Comment Print S
     C                     MOVELWDCQCD    PACQCD    P      Reason Code
     C                     MOVELWDGJST    PAGJST    P      Order in Use
     C                     MOVELWDGWST    PAGWST    P      Header Status
     C                     MOVELWDGXST    PAGXST    P      Header Status L
     C                     MOVELWDGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDWDAODT    PAAODT           Scheduled Ship
     C                     MOVELWDAIVN    PAAIVN    P      User Original E
     C                     Z-ADDWDCXDT    PACXDT           Date of Origina
     C                     Z-ADDWDJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDWDA1WG    PAA1WG           Order Weight To
     C                     MOVELWDXIST    PAXIST    P      Credit Hold
     C                     MOVELWDXJST    PAXJST    P      Production Hold
     C                     MOVELWDXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDWDEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDWDAFTM    PAAFTM           Requested Deliv
     C                     MOVELWDE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELWDE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDWDRMNB    PARMNB           Load ID
     C                     Z-ADDWDTBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDWDR1NB    PAR1NB           Rated Freight
     C                     MOVELWDPJST    PAPJST    P      LTL Flag
     C                     MOVELWDU0ST    PAU0ST    P      Price Audit
     C                     MOVELWDU1ST    PAU1ST    P      Price Status
     C                     MOVELWDQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELWDU2ST    PAU2ST    P      Export Status
     C                     MOVELWDVEST    PAVEST    P      Palletize
     C                     MOVELWDVFST    PAVFST    P      Shrink Wrap
     C                     MOVELWDVGST    PAVGST    P      Slip Sheet
     C                     MOVELWDRPCD    PARPCD    P      Age Code
     C                     Z-ADDWDRNNB    PARNNB           Reefer Temperat
     C                     MOVELWDVDST    PAVDST    P      Load Type
     C                     Z-ADDWDATIN    PAATIN           Attach to Invoi
     C                     MOVELWDU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELWDU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDWDRSRN    PARSRN           Resell Referenc
     C                     MOVELWDMHNA    PAMHNA    P      Special Comment
     C                     MOVELWDMINA    PAMINA    P      Special Comment
     C                     MOVELWDWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELWDR4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELWDBFCD    PABFCD    P      Manager Level C
     C                     MOVELWDQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDWDT3NB    PAT3NB           Attach to Order
     C                     MOVELWDSICD    PASICD    P      Reason for Pric
     C                     Z-ADDWDCONB    PACONB           Invoice Number
     C                     MOVELWDCEST    PACEST    P      Invoice Suffix
     C                     Z-ADDWDAWDT    PAAWDT           Invoice Date
     C                     MOVELWDJPCD    PAJPCD    P      Event Code
     C                     MOVELWDXUST    PAXUST    P      Trans Contol AS
     C                     MOVELWDZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDWDVRVA    PAVRVA           A/R order Value
     C                     MOVELWDOBST    PAOBST    P      Billing Activit
     C                     MOVELWDBCST    PABCST    P      Block Order Fla
     C                     MOVELWDBDST    PABDST    P      Order Certifica
     C                     Z-ADDWDB7VL    PAB7VL           Invoice Order V
     C                     MOVELWDGASX    PAGASX    P      Process Sts for
     C                     MOVELWDGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELWDGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELWDGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELWDFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELWDFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELWDFPSX    PAFPSX    P      Order Emailed
     C                     MOVELWDFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELWDFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELWDFSSX    PAFSSX    P      Broker Order St
     C                     MOVELWDFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELWDFUSX    PAFUSX    P      Order Requires
     C                     MOVELWDFVSX    PAFVSX    P      EDI Nistevo Sel
     C                     MOVELWDFWSX    PAFWSX    P      Export USDA App
     C                     MOVELWDFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELWDFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDWDNODT    PANODT           OH Appt Confirm
     C                     Z-ADDWDNPDT    PANPDT           OH Unused Date
     C                     Z-ADDWDNQDT    PANQDT           OH Unused Date
     C                     Z-ADDWDNRDT    PANRDT           OH Unused Date
     C                     Z-ADDWDNSDT    PANSDT           OH Unused Date
     C                     Z-ADDWDBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDWDBQTM    PABQTM           Time of Origina
     C                     Z-ADDWDBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDWDBSTM    PABSTM           OH Unused Time
     C                     Z-ADDWDBTTM    PABTTM           OH Unused Time
     C                     Z-ADDWDH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDWDH1NX    PAH1NX           Act Non-Ref Frt
     C                     Z-ADDWDH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDWDH3NX    PAH3NX           OH Total Non-Re
     C                     Z-ADDWDH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDWDC0C7    PAC0C7           Claim Number
     C                     MOVELWDUVST    PAUVST    P      EDI Status 1
     C                     MOVELWDUWST    PAUWST    P      EDI Status 2
     C                     MOVELWDUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDWDAATM    PAAATM           Job Time
     C                     MOVELWDAYNA    PAAYNA    P      User Id
     C                     MOVELWDA0NA    PAA0NA    P      Job Name
     C                     Z-ADDWDAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           JYAIC3           Company Number
      * Setup key
     C                     Z-ADDBEAIC3    JYAIC3           Company Number
      * Establish starting position
     C           KRSSO     CHAIN@JYRECE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2025' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0004           Plant Company S
     C                     MOVEL*BLANK    YL0005           Company Organiz
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELJYYISX    YL0004           Plant Company S
     C                     MOVELJYYJSX    YL0005           Company Organiz
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Ld Orders Invoiced RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/12/04 SLM PKTR01 Multi-Company - Function was changed
      *                                     to remove Company RST or Pos
     C                     MOVEL'Y'       P6CVST           Invoiced Flag U
      * Declare restrictor key work fields
     C           *LIKE     DEFN WERMNB    WQSP02           Load ID
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP02           Load ID
      * Setup key
     C                     Z-ADDBERMNB    WQSP02           Load ID
      * Establish starting position
     C           KRSSP     SETLL@BFCPD9                    *
     C           KRSSP     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - ((c1 AND c2) OR c3)
      *   |- c1    : DB1.Header Status is Complete
      *   |- c2    : DB1.Event Code is 07 Written to History
      *   |- c3    : DB1.Header Status is Cancelled
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WEGWST    IFEQ 'C'                        *IF
     C           WEJPCD    IFEQ '07'                       *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WEGWST    IFEQ 'X'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       P6CVST           Invoiced Flag U
     C                     GOTO SPEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSP     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCHRC    BEGSR
      *================================================================
      * CHG Load Status        CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0125  30       Company Number
     C                     MOVEL*BLANK    WN0126  1        LTL Flag
     C                     Z-ADD*ZERO     WN0127  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0128 15        Seal 1
     C                     MOVEL*BLANK    WN0129 15        Seal 2
     C                     MOVEL*BLANK    WN0130 15        Seal 3
     C                     MOVEL*BLANK    WN0131 15        Seal 1 Unused
     C                     MOVEL*BLANK    WN0132 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0133  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0134 112       Flat Amount
     C                     MOVEL*BLANK    WN0135  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0136  50       Total Stops
     C                     MOVEL*BLANK    WN0137 20        Trailer Id
     C                     MOVEL*BLANK    WN0138  3        Transloader Car
     C                     Z-ADD*ZERO     WN0139  40       BOL Time
     C                     MOVEL*BLANK    WN0140  3        Carrier Code
     C                     MOVEL*BLANK    WN0141  7        Truck Size
     C                     Z-ADD*ZERO     WN0142  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0143 112       Rated Freight
     C                     MOVEL*BLANK    WN0144  1        Ship Status
     C                     MOVEL*BLANK    WN0145  1        Load Type
     C                     Z-ADD*ZERO     WN0146  50       Number Pallets
     C                     Z-ADD*ZERO     WN0147  50       Number Pallets
     C                     Z-ADD*ZERO     WN0148 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0149  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0150  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0151  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0152 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0153 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0154  70       Actual Departur
     C                     Z-ADD*ZERO     WN0155  40       Departure Time
     C                     Z-ADD*ZERO     WN0156  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0157  52       Product Tempera
     C                     Z-ADD*ZERO     WN0158  50       Number Pallets
     C                     MOVEL*BLANK    WN0159 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0160  70       Total Load Mile
     C                     MOVEL*BLANK    WN0161 12        Recorder ID
     C                     MOVEL*BLANK    WN0162  2        Shipping Method
     C                     MOVEL*BLANK    WN0163  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0164  2        Ship To State C
     C                     Z-ADD*ZERO     WN0165  70       Gross Weight
     C                     MOVEL*BLANK    WN0166  3        Carrier Broker
     C                     MOVEL*BLANK    WN0167  1        Export Status
     C                     Z-ADD*ZERO     WN0168  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0169  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0170  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0171  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0172  70       Spotted Date
     C                     Z-ADD*ZERO     WN0173  60       Spotted Time
     C                     Z-ADD*ZERO     WN0174  70       Load Finished D
     C                     Z-ADD*ZERO     WN0175  60       Load Finished T
     C                     Z-ADD*ZERO     WN0176  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0177  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0178  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0179  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0180  70       Truck Departure
     C                     Z-ADD*ZERO     WN0181  60       Truck Departure
     C                     Z-ADD*ZERO     WN0182  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0183  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0184  3        Shipping Line
     C                     MOVEL*BLANK    WN0185 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0186 30        Vessel Name
     C                     Z-ADD*ZERO     WN0187  50       Voyage
     C                     Z-ADD*ZERO     WN0188  70       Sail Date
     C                     MOVEL*BLANK    WN0189 12        Booking Number
     C                     MOVEL*BLANK    WN0190 20        Discharge Port
     C                     Z-ADD*ZERO     WN0191  70       Arrival Date
     C                     MOVEL*BLANK    WN0192 12        Container Numbe
     C                     Z-ADD*ZERO     WN0193  70       Date In
     C                     Z-ADD*ZERO     WN0194  60       Time In
     C                     Z-ADD*ZERO     WN0195  70       Date Out
     C                     Z-ADD*ZERO     WN0196  60       Time Out
     C                     Z-ADD*ZERO     WN0197 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0198  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0199  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0200  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0201  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0202  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0203  70       Requested Deliv
     C                     MOVEL*BLANK    WN0204  1        Load Acceptance
     C                     MOVEL*BLANK    WN0205  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0206  70       On Yard Date
     C                     Z-ADD*ZERO     WN0207  60       On Yard Time
     C                     Z-ADD*ZERO     WN0208  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0209  60       Deadline Depart
     C                     MOVEL*BLANK    WN0210  1        Load Held Over
     C                     MOVEL*BLANK    WN0211  1        Load Held Over
     C                     MOVEL*BLANK    WN0212 15        Load Held Over
     C                     MOVEL*BLANK    WN0213 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0214 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0215  70       Express Mail Da
     C                     MOVEL*BLANK    WN0216  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0217  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0218  70       Product Complet
     C                     Z-ADD*ZERO     WN0219  60       Product Complet
     C                     Z-ADD*ZERO     WN0220  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0221  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0222  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0223  1        Load Confirmed
     C                     MOVEL*BLANK    WN0224 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0225  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0226  60       Load Door 1
     C                     Z-ADD*ZERO     WN0227  70       Override Total
     C                     Z-ADD*ZERO     WN0228  60       Load Door 2
     C                     MOVEL*BLANK    WN0229  1        Partial Load
     C                     MOVEL*BLANK    WN0230  1        Load Confirmati
     C                     MOVEL*BLANK    WN0231  1        Export Load USD
     C                     MOVEL*BLANK    WN0232  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0233 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0234 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0235 15        Late Billing Em
     C                     MOVEL*BLANK    WN0236 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0237 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0238  1        Multi Company L
     C                     MOVEL*BLANK    WN0239  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0240  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0241  1        LH Power Only L
     C                     MOVEL*BLANK    WN0242  1        LH Unused Sts 4
     C                     MOVEL*BLANK    WN0243  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0244  2        Load U/M
     C                     MOVEL*BLANK    WN0245  2        LH Unused Sts 7
     C                     MOVEL*BLANK    WN0246  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0247  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0248  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0249  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0250  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0251  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0252  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0253  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0254  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0255  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0256  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0257  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0258  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0259  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0260  60       LH Unused Time
     C                     MOVEL*BLANK    WN0261  1        EDI Status 1
     C                     MOVEL*BLANK    WN0262  1        EDI Status 2
     C                     MOVEL*BLANK    WN0263  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0264  60       Job Time
     C                     MOVEL*BLANK    WN0265 10        User Id
     C                     MOVEL*BLANK    WN0266 10        Job Name
     C                     Z-ADD*ZERO     WN0267  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDBERMNB    WFRMNB           Load ID
      *
     C           KLCHSQ    KLIST
     C                     KFLD           WFRMNB           Load ID
     C           KLCHSQ    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YBRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDBEAODT    WFAODT           Scheduled Ship
     C                     MOVEL'I'       WFPKST    P      Load Status
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##JOB     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Process Shipping Detail
      *================================================================
     C                     Z-ADD*ZERO     P3EXQT           Quantity Billed
     C                     Z-ADD*ZERO     P4BYWG           Weight Billed
      * This function updates Shipping Detail Status="C", Last Status
      *                       Event code to "07", G/L Update Status="N"
      *                       (not G/L Update Status - not in Detail file
      *                       & returns Order Total Qty & Weight Billed
      *                       & also affect inventory, sales $, sales # f
      * NOTE:  This is the same function used in Invoice Post program
      * UPD Invoice Post Dtl   XF - Order Detail  * 
     C                     CALL 'PDT4XFR'              90  UPD Invoice Pos
     C                     PARM *BLANK    W0RTN   7
     C                     PARM BEAIC3    WQ0001  30       Company Number
     C                     PARM BEC4NB    WQ0002  70       Order Number
     C           P2AMST    PARM *BLANK    WQ0003  1        Affect Inventor
     C           P2ANST    PARM *BLANK    WQ0004  1        Affect Sales Do
     C           P2VAST    PARM *BLANK    WQ0005  1        Affect Sales Pn
     C           P3EXQT    PARM P3EXQT    WQ0006 112       Quantity Billed
     C           P4BYWG    PARM P4BYWG    WQ0007 112       Weight Billed
     C                     PARM BECXDT    WQ0008  70       Date of Origina
     C                     PARM BEOBST    WQ0009  1        Billing Activit
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDT4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Change/Create A/R Summary Record
      *================================================================
      * 12/07/06 PKD PK0040 Use Accounting Company if there
      * RTV OD Whs/ShpCo/AccCo RT - Order Detail  * 
     C                     EXSR SHRVGN
      * CASE: LCL.Accounting Company is Equal to zero
     C           YL0003    IFEQ *ZERO                      *IF
      * EDT A/R Summary        XF - A/R Summary  * Accounting Company
     C                     CALL 'PDU4XFR'              90  EDT A/R Summary
     C                     PARM *BLANK    W0RTN   7
     C                     PARM BEAIC3    WQ0010  30       Company Number
     C                     PARM BEANC7    WQ0011  70       A/R Customer Nu
     C                     PARM BEA0DT    WQ0012  70       Order Date
     C                     PARM BEGNDT    WQ0013  70       Actual Shipped
     C                     PARM BEJZVA    WQ0014 112       Order Value Tot
     C                     PARM BEA1WG    WQ0015 112       Order Weight To
     C                     PARM BEVRVA    WQ0016 112       A/R order Value
     C                     PARM BEOBST    WQ0017  1        Billing Activit
     C                     PARM P2ANST    WQ0018  1        Affect Sales Do
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDU4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * EDT A/R Summary        XF - A/R Summary  * Accounting Company
     C                     CALL 'PDU4XFR'              90  EDT A/R Summary
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0003    WQ0019  30       Company Number
     C                     PARM BEANC7    WQ0020  70       A/R Customer Nu
     C                     PARM BEA0DT    WQ0021  70       Order Date
     C                     PARM BEGNDT    WQ0022  70       Actual Shipped
     C                     PARM BEJZVA    WQ0023 112       Order Value Tot
     C                     PARM BEA1WG    WQ0024 112       Order Weight To
     C                     PARM BEVRVA    WQ0025 112       A/R order Value
     C                     PARM BEOBST    WQ0026  1        Billing Activit
     C                     PARM P2ANST    WQ0027  1        Affect Sales Do
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDU4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2AMST           Affect Inventor
     C                     MOVEL*BLANK    P2ANST           Affect Sales Do
     C                     MOVEL*BLANK    P2VAST           Affect Sales Pn
     C                     Z-ADD*ZERO     P2ESNB           Accounting Year
     C                     Z-ADD*ZERO     P2ETNB           Accounting Peri
     C                     Z-ADD*ZERO     P2BZNB           OM Week
     C                     Z-ADD*ZERO     P3EXQT           Quantity Billed
     C                     Z-ADD*ZERO     P4BYWG           Weight Billed
     C                     Z-ADD*ZERO     P5CAC7           Order Number Re
     C                     MOVEL*BLANK    P6CVST           Invoiced Flag U
     C                     MOVEL*BLANK    P7FLST           USR Process sta
     C                     MOVEL*BLANK    P9AJCD           Warehouse Code
     C                     MOVEL*BLANK    P9DNCD           Application Cod
     C                     MOVEL*BLANK    P9BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P9I6ST           Allow Multi-Com
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Define work field Status - Y or N
     C                     MOVEL*BLANK    WUB8ST  1
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    BEAIC3           Company Number
     C                     MOVEL*LOVAL    BEC4NB           Order Number
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field Load Status
     C                     MOVEL*BLANK    WUPKST  1
      * Define work field EDI Status 1
     C                     MOVEL*BLANK    WUUVST  1
      * Define work field Truck Departure Date
     C                     Z-ADD*ZERO     WUKIDT  70
      * Define work field Truck Departure Time
     C                     Z-ADD*ZERO     WUASTM  60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WACFC7           Order Group Cod
     C                     Z-ADD*ZERO     WAMAVA           Billing Detail
     C                     Z-ADD*ZERO     WAKDVA           Billing Detail
     C                     Z-ADD*ZERO     WAL8VA           Billing Detail
     C                     Z-ADD*ZERO     WAL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WAAYVA           Extended Amount
     C                     Z-ADD*ZERO     WAEXDT           Market Pricing
     C                     Z-ADD*ZERO     WABZPR           Price Overage O
     C                     Z-ADD*ZERO     WAL6NB           Contract Number
     C                     Z-ADD*ZERO     WAGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WAAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WAD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WACCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WAAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WACBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WAATWG           Weight Shipped
     C                     Z-ADD*ZERO     WAAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WAAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WAAKPR           Unit Price
     C                     Z-ADD*ZERO     WAALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WAAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WAAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WAA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WADUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WAB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WAA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WANTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WANUDT           Consumed Item C
     C                     Z-ADD*ZERO     WANVDT           Deadline Depart
     C                     Z-ADD*ZERO     WANWDT           OD Price Type R
     C                     Z-ADD*ZERO     WANXDT           OD Unused Date
     C                     Z-ADD*ZERO     WABUTM           Deadline Depart
     C                     Z-ADD*ZERO     WABVTM           Price Code
     C                     Z-ADD*ZERO     WABWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WABXTM           Substitution Li
     C                     Z-ADD*ZERO     WABYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WAH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WAH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WAH7NX           OD Item Target
     C                     Z-ADD*ZERO     WAH8NX           OD Minimum Unit
     C                     Z-ADD*ZERO     WAH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WADVPR           Order Gate Pric
     C                     Z-ADD*ZERO     WADWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WADXPR           OD Unused Prc 3
     C                     Z-ADD*ZERO     WADYPR           OD Unused Prc 4
     C                     Z-ADD*ZERO     WADZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WAGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WAGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WAGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WAPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WARINY           Item Age Days
     C                     Z-ADD*ZERO     WATIDT           Production Ovr
     C                     Z-ADD*ZERO     WATJDT           Production Ovr
     C                     Z-ADD*ZERO     WATKDT           OD Market Begin
     C                     Z-ADD*ZERO     WATLDT           OD Market Endin
     C                     Z-ADD*ZERO     WATMDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Define work field Event Code
     C                     MOVEL*BLANK    WUJPCD  2
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBQ2NB           Event Number
     C                     Z-ADD*ZERO     WBAUC3           Invoice/Memo Co
     C                     Z-ADD*ZERO     WBQ7NB           Invoice/Memo Nu
     C                     Z-ADD*ZERO     WBD2DT           Event Date
     C                     Z-ADD*ZERO     WBAWC3           Cross Event Ref
     C                     Z-ADD*ZERO     WBQ8NB           Cross Event Ref
     C                     Z-ADD*ZERO     WBQ9NB           Cross Event Ref
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Clear all neither parameters
      * CRT OP Order Events    CR - Order Events  * 
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Event Number
     C                     Z-ADD*ZERO     WUQ2NB  50
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WDA0DT           Order Date
     C                     Z-ADD*ZERO     WDA5DT           Requested Ship
     C                     Z-ADD*ZERO     WDGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WDACDT           Cancel Date
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDCXDT           Date of Origina
     C                     Z-ADD*ZERO     WDJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WDA1WG           Order Weight To
     C                     Z-ADD*ZERO     WDEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WDAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WDATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WDRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WDT3NB           Attach to Order
     C                     Z-ADD*ZERO     WDCONB           Invoice Number
     C                     Z-ADD*ZERO     WDAWDT           Invoice Date
     C                     Z-ADD*ZERO     WDVRVA           A/R order Value
     C                     Z-ADD*ZERO     WDB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WDNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WDNPDT           OH Unused Date
     C                     Z-ADD*ZERO     WDNQDT           OH Unused Date
     C                     Z-ADD*ZERO     WDNRDT           OH Unused Date
     C                     Z-ADD*ZERO     WDNSDT           OH Unused Date
     C                     Z-ADD*ZERO     WDBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WDBQTM           Time of Origina
     C                     Z-ADD*ZERO     WDBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WDBSTM           OH Unused Time
     C                     Z-ADD*ZERO     WDBTTM           OH Unused Time
     C                     Z-ADD*ZERO     WDH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WDH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WDH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WDH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WDH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WDC0C7           Claim Number
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFRMNB           Load ID
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WFRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WFRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WFFLAM           Flat Amount
     C                     Z-ADD*ZERO     WFRRNB           Total Stops
     C                     Z-ADD*ZERO     WFSBNB           BOL Time
     C                     Z-ADD*ZERO     WFSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WFR1NB           Rated Freight
     C                     Z-ADD*ZERO     WFSDNB           Number Pallets
     C                     Z-ADD*ZERO     WFPAOU           Number Pallets
     C                     Z-ADD*ZERO     WFDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WFSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WFHADT           Actual Arrival
     C                     Z-ADD*ZERO     WFAART           Actual Arrival
     C                     Z-ADD*ZERO     WFDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WFDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WFAQDT           Actual Departur
     C                     Z-ADD*ZERO     WFS6NB           Departure Time
     C                     Z-ADD*ZERO     WFT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WFPRTM           Product Tempera
     C                     Z-ADD*ZERO     WFNPSV           Number Pallets
     C                     Z-ADD*ZERO     WFTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WFGRWE           Gross Weight
     C                     Z-ADD*ZERO     WFF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WFJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WFTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WFJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WFSPTM           Spotted Time
     C                     Z-ADD*ZERO     WFJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WFLFTM           Load Finished T
     C                     Z-ADD*ZERO     WFJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WFBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WFJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WFBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WFKIDT           Truck Departure
     C                     Z-ADD*ZERO     WFASTM           Truck Departure
     C                     Z-ADD*ZERO     WFKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WFAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WFVOAG           Voyage
     C                     Z-ADD*ZERO     WFKBDT           Sail Date
     C                     Z-ADD*ZERO     WFEFDT           Arrival Date
     C                     Z-ADD*ZERO     WFKCDT           Date In
     C                     Z-ADD*ZERO     WFTMIN           Time In
     C                     Z-ADD*ZERO     WFKDDT           Date Out
     C                     Z-ADD*ZERO     WFVMNB           Time Out
     C                     Z-ADD*ZERO     WFOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WFKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WFATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WFBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WFEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WFKKDT           On Yard Date
     C                     Z-ADD*ZERO     WFAVTM           On Yard Time
     C                     Z-ADD*ZERO     WFKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WFAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WFLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WFK0DT           Product Complet
     C                     Z-ADD*ZERO     WFAYTM           Product Complet
     C                     Z-ADD*ZERO     WFKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WFICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WFIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WFK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WFAZTM           Load Door 1
     C                     Z-ADD*ZERO     WFK2DT           Override Total
     C                     Z-ADD*ZERO     WFA0TM           Load Door 2
     C                     Z-ADD*ZERO     WFZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WFPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WFCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WFPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WFCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WFP0DT           LH Unused Date
     C                     Z-ADD*ZERO     WFCMTM           LH Unused Time
     C                     Z-ADD*ZERO     WFP1DT           LH Unused Date
     C                     Z-ADD*ZERO     WFCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WFP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WFCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WFP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WFCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SMCRRC.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     Z-ADD*ZERO     WL0003  50
     C                     MOVEL*BLANK    WL0004  2
     C                     Z-ADD*ZERO     WL0005  30
     C                     Z-ADD*ZERO     WL0006  70
     C                     MOVEL*BLANK    WL0007  2
     C                     Z-ADD*ZERO     WL0008  70
     C                     MOVEL*BLANK    WL0009  1
     C                     MOVEL*BLANK    WL0010  1
     C                     MOVEL*BLANK    WL0011  1
     C                     Z-ADD*ZERO     WL0012  30
     C                     Z-ADD*ZERO     WL0013  70
     C                     Z-ADD*ZERO     WL0014  50
     C                     Z-ADD*ZERO     WL0015  70
      * Define null work field Load Status
     C                     MOVEL*BLANK    YN0001  1
      * Define null work field BOL Complete Date
     C                     Z-ADD*ZERO     YN0002  70
      * Define null work field BOL Complete Time
     C                     Z-ADD*ZERO     YN0003  60
      * Define local work field Scheduled Ship Date USR
     C                     Z-ADD*ZERO     YL0001  70
      * Define null work field Warehouse Code
     C                     MOVEL*BLANK    YN0004  3
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0002  30
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0003  30
      * Define local work field Plant Company Sts
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field Company Organization
     C                     MOVEL*BLANK    YL0005  1
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * VAL Rtv & Ctr Prt Hdg  IF
      * SET Setup Prt Headings IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SARVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * Center Txt String 40 - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc to PrtCo US - /UT User Source  * 
     C                     MOVE WUDE40    $ACMP
      * S00074 - get company value for truck departure validation
      * RTV Alpha Value        RT - Company Values  * 
     C                     EXSR SCRVGN
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Y2U0005
00002 INVTRKDPTR
00003 Y2U0003
00004 1111111
