// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PNYKXFR
// ?Date: 14.08.2025 Time: 03:47:06
// ?------------------------------------------------------------------------------------------------

//?Execute user function

EXECUTE FUNCTION(Rtv Dtls for WSO EDI  RT) TYPE(RTVOBJ) FILE(OPBGWKP)           AC2023184;
PARAMETER(PAR.Company);
PARAMETER(PAR.Order_Number);
PARAMETER(PAR.Requested_Delivery_Date);
PARAMETER(PAR.EDI_SURROGATE_NUMBER);
{
 //?USER: Process Data record

 CASE;

 // IF DB1.Detail Line Status is Not cancelled
 IF DB1.Detail_Line_Status = 'L'/'A'/'C'/'R'/'E'/'H'/'I';

 // AND DB1.Quantity Ordered is Greater than zero
 AND DB1.Quantity_Ordered > *ZERO;

 //?6/10/10 Chk to see if there is a cross ref # for this item.
 EXECUTE FUNCTION(Rtv Cust Item Ref     RT) TYPE(RTVOBJ) FILE(POBIREP)           AC1631725;
 PARAMETER(DB1.Ship_To_Customer);
 PARAMETER(DB1.Item_Code);
 PARAMETER(LCL.CIR_Resource_No);
 PARAMETER(NLL.CIR_Item_No);
 PARAMETER(NLL.CIR_Description_Line_1);
 PARAMETER(NLL.CIR_Description_Line_2);
 PARAMETER(NLL.CIR_Description_Line_3);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 CASE;

 // IF PGM.*Return code is *Normal
 IF PGM.*Return_code = *BLANK;

 // LCL.UPC Code 1 = LCL.CIR Resource No
 LCL.Item_Meat_Cost_Group_Code = LCL.CIR_Resource_No;

 // LCL.LIN03 Product ID-UPC = CVTVAR(LCL.UPC Code 1)
 LCL.LIN03_Product_ID_UPC = CVTVAR(LCL.Item_Meat_Cost_Group_Code);

 // IF *OTHERWISE
 IF *OTHERWISE;

 EXECUTE FUNCTION(RTV Federal ID         RT) TYPE(RTVOBJ) FILE(CAABREP)          AC1379325;
 PARAMETER(*ZERO);
 PARAMETER(LCL.Federal_Tax_Id);
 {
  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 // LCL.USR Text 7            USR = LCL.Federal Tax Id.
 LCL.USR_Text_7_USR = LCL.Federal_Tax_Id;

 // LCL.Item Code 5.0 = DB1.Item Code
 LCL.Item_Code_5_0 = DB1.Item_Code;

 // LCL.Item Code 5A = CVTVAR(LCL.Item Code 5.0)
 LCL.Item_Code_5A = CVTVAR(LCL.Item_Code_5_0);

 // WRK.Item Meat Cost Group Code = CONCAT(LCL.USR Text 7            USR,LCL.Item Code 5A,CON.*ZERO)
 WRK.Item_Meat_Cost_Group_Code = LCL.USR_Text_7_USR + LCL.Item_Code_5A (*ZERO);

 // LCL.W0103 UPC Case Code = CVTVAR(WRK.UPC Code 1)
 LCL.W0403_UPC_Case_Code = CVTVAR(WRK.Item_Meat_Cost_Group_Code);

 ENDIF;

 //?Calculate the Oldest Prod Date allowed for product
 EXECUTE FUNCTION(RTV Type/Std Chil/Chil RT) TYPE(RTVOBJ) FILE(CAADREP)          AC1501268;
 PARAMETER(DB1.Warehouse_Code);
 PARAMETER(LCL.Warehouse_Type);
 PARAMETER(LCL.Warehouse_Std_Chill_Time);
 PARAMETER(LCL.Warehouse_Chill_Time);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 //?RMC 10/2/19 added S15557
 EXECUTE FUNCTION(RTV Warehouse Inv/Max RT) TYPE(RTVOBJ) FILE(CAADREP)           AC2049533;
 PARAMETER(DB1.Warehouse_Code);
 PARAMETER(NLL.WHS_Sched_Prod_Max_Days);
 PARAMETER(LCL.WHS_Inventory_Chill_Time);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 // Call program Rtv Age Information   XF.
 CALL PROGRAM(Rtv Age Information   XF) ('PNQCXFR');
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Ship_To_Customer);
 PARAMETER(LCL.Item_Age_Days_Fresh);
 PARAMETER(LCL.Item_Age_Days_Frozen);

 // LCL.Chill Time USR = CON.*ZERO
 LCL.Chill_Time_USR = *ZERO;

 CASE;

 // IF LCL.Warehouse Std Chill Time is yes
 IF LCL.Warehouse_Std_Chill_Time = 'Y';

 //?RMC 10/2/19 added S15557
 // LCL.Chill Time USR = LCL.WHS Inventory Chill Time
 LCL.Chill_Time_USR = LCL.WHS_Inventory_Chill_Time;

 // IF *OTHERWISE
 IF *OTHERWISE;

 // LCL.Chill Time USR = LCL.Fresh Chilling Time
 LCL.Chill_Time_USR = LCL.Fresh_Chilling_Time;

 ENDIF;

 //?Get the Order header
 // Call program CLC PA Age FrmToDates XF.
 CALL PROGRAM(CLC PA Age FrmToDates XF) ('PNO7XFR');
 PARAMETER(DB1.Company_Number);
 PARAMETER(LCL.Chill_Time_USR);
 PARAMETER(DB1.Scheduled_Ship_Date);
 PARAMETER(PAR.Requested_Delivery_Date);
 PARAMETER(DB1.Item_Age_Days);
 PARAMETER(LCL.Production_Ovr_AgeDte_Fr);
 PARAMETER(LCL.Production_Ovr_AgeDte_To);
 PARAMETER(LCL.Production_AgeDte_Fr);
 PARAMETER(LCL.Production_AgeDte_To);

 //?R11331 DN 02/01/18-Format Oldest Age Date.
 //?R15713 rmc 11/12/19 USE OVERRIDE AGE DATES IF THERE
 CASE;

 // IF DB1.Production Ovr AgeDte Fr is not entered
 IF DB1.Production_Ovr_AgeDte_Fr = *ZERO;

 // LCL.Production Date USR D8# = LCL.Production AgeDte Fr
 LCL.Production_Date_USR_D8# = LCL.Production_AgeDte_Fr;

 // IF *OTHERWISE
 IF *OTHERWISE;

 // LCL.Production Date USR D8# = DB1.Production Ovr AgeDte Fr
 LCL.Production_Date_USR_D8# = DB1.Production_Ovr_AgeDte_Fr;

 ENDIF;

 // LCL.N902 Oldest Age Date = CVTVAR(LCL.Production Date USR D8#)
 LCL.N902_Oldest_Age_Date = CVTVAR(LCL.Production_Date_USR_D8#);

 // LCL.N901 Oldest Age Date Qlfr = CND.ZZ
 LCL.N901_Oldest_Age_Date_Qlfr = 'ZZ';

 //?R11331 DN 01/25/18-Populate Newest Age Date Qlfr & Newest Age Date.
 CASE;

 // IF DB1.Production Ovr AgeDte To is not entered
 IF DB1.Production_Ovr_AgeDte_To = *ZERO;

 // LCL.Production Date USR D8# = LCL.Production AgeDte To
 LCL.Production_Date_USR_D8# = LCL.Production_AgeDte_To;

 // IF *OTHERWISE
 IF *OTHERWISE;

 // LCL.Production Date USR D8# = DB1.Production Ovr AgeDte To
 LCL.Production_Date_USR_D8# = DB1.Production_Ovr_AgeDte_To;

 ENDIF;

 // LCL.N902 Newest Age Date = CVTVAR(LCL.Production Date USR D8#)
 LCL.N902_Newest_Age_Date = CVTVAR(LCL.Production_Date_USR_D8#);

 // LCL.N901 Pallet Size Qlfr = WRK.BLANK
 LCL.N901_Pallet_Size_Qlfr = WRK.BLANK;

 // LCL.N902 Pallet Size = CON.*BLANK
 LCL.N902_Pallet_Size = *BLANK;

 // LCL.NTE01 Note Reference Code = WRK.BLANK
 LCL.NTE01_Note_Reference_Code = WRK.BLANK;

 // LCL.NTE02 Note = CON.*BLANK
 LCL.NTE02_Note = *BLANK;

 EXECUTE FUNCTION(Crt EDI WHS Ship Ord  CR) TYPE(CRTOBJ) FILE(ECP051)            AC2023124;
 PARAMETER(PAR.EDI_SURROGATE_NUMBER);
 PARAMETER(DB1.Order_Sequence_Number);
 PARAMETER(DB1.Quantity_Ordered);
 PARAMETER(DB1.U_M_Ordered);
 PARAMETER(LCL.W0403_UPC_Case_Code);
 PARAMETER('VN');
 PARAMETER(DB1.Item_Code);
 PARAMETER('PL');
 PARAMETER(DB1.Order_Sequence_Number);
 PARAMETER(LCL.N901_Oldest_Age_Date_Qlfr);
 PARAMETER(LCL.N902_Oldest_Age_Date);
 PARAMETER(LCL.N901_Pallet_Size_Qlfr);
 PARAMETER(LCL.N902_Pallet_Size);
 PARAMETER(LCL.NTE01_Note_Reference_Code);
 PARAMETER(LCL.NTE02_Note);
 PARAMETER('ZZ');
 PARAMETER(LCL.N902_Newest_Age_Date);
 PARAMETER(DB1.Order_Desc_Line_One);
 ENDIF;

}


