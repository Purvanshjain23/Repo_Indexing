     H/TITLE RTV Pricing: CIMSLV   XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.5 (1351)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISPPATE
     H* Date          : 07/02/10  Time  : 13:23:30
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPNF9REL2IF  E           K        DISK
      * RSQ : IP Cust Item Formula Dtl  ShpTo/Itm/FrmTyp
      *
     FPDIPREL5IF  E           K        DISK
      * RSQ : Market Date Method        Sys/DtTyp/Co/DtMth
      *
     FOMF0CPL2IF  E           K        DISK
      * RSQ : Commodity Mrkt Price      Market Date Descending
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     I@F9REF4
      * IP Cust Item Formula Dtl  ShpTo/Itm/FrmTyp
      * Renamed input format fields
     I              F9BKC7                          WABKC7
     I              F9HGCD                          WAHGCD
     I              F9RRNY                          WARRNY
     I              F9IUST                          WAIUST
     I              F9WNT1                          WAWNT1
     I              F9MPAA                          WAMPAA
     I              F9RSNY                          WARSNY
     I              F9GZPR                          WAGZPR
     I              F9GXPC                          WAGXPC
     I              F9GYPC                          WAGYPC
     I              F9VSST                          WAVSST
     I              F9MJDT                          WAMJDT
     I              F9BETM                          WABETM
     I              F9CCVN                          WACCVN
     I              F9CDVN                          WACDVN
     I              F9MKDT                          WAMKDT
     I              F9BFTM                          WABFTM
     I              F9CEVN                          WACEVN
     I              F9CFVN                          WACFVN
      *
     I@IPREHD
      * Market Date Method        Sys/DtTyp/Co/DtMth
      * Renamed input format fields
     I              IPAIC3                          WBAIC3
     I              IPRDCD                          WBRDCD
     I              IPMNNA                          WBMNNA
     I              IPRECD                          WBRECD
     I              IPCPRD                          WBCPRD
     I              IPQMNB                          WBQMNB
     I              IPU7ST                          WBU7ST
     I              IPCNOT                          WBCNOT
     I              IPU8ST                          WBU8ST
     I              IPCDOW                          WBCDOW
     I              IPBXST                          WBBXST
     I              IPUVST                          WBUVST
     I              IPUWST                          WBUWST
     I              IPUXST                          WBUXST
     I              IPAATM                          WBAATM
     I              IPAYNA                          WBAYNA
     I              IPA0NA                          WBA0NA
     I              IPAXDT                          WBAXDT
      *
     I@F0CPEP
      * Commodity Mrkt Price      Market Date Descending
      * Renamed input format fields
     I              F0LQCD                          WCLQCD
     I              F0LRCD                          WCLRCD
     I              F0EQDT                          WCEQDT
     I              F0A5PR                          WCA5PR
     I              F0B8PR                          WCB8PR
     I              F0UVST                          WCUVST
     I              F0UWST                          WCUWST
     I              F0UXST                          WCUXST
     I              F0VSST                          WCVSST
     I              F0AATM                          WCAATM
     I              F0AYNA                          WCAYNA
     I              F0A0NA                          WCA0NA
     I              F0AXDT                          WCAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WDAIC3
     I              BZHGCD                          WDHGCD
     I              BZAVNA                          WDAVNA
     I              BZAWNA                          WDAWNA
     I              BZL7NA                          WDL7NA
     I              BZL8NA                          WDL8NA
     I              BZL6NA                          WDL6NA
     I              BZMFNA                          WDMFNA
     I              BZADCD                          WDADCD
     I              BZAWPC                          WDAWPC
     I              BZLXST                          WDLXST
     I              BZAECD                          WDAECD
     I              BZAXPC                          WDAXPC
     I              BZLYST                          WDLYST
     I              BZAFCD                          WDAFCD
     I              BZAICD                          WDAICD
     I              BZAIWG                          WDAIWG
     I              BZHICD                          WDHICD
     I              BZRBCD                          WDRBCD
     I              BZFZST                          WDFZST
     I              BZAVST                          WDAVST
     I              BZCZWG                          WDCZWG
     I              BZC0WG                          WDC0WG
     I              BZURTN                          WDURTN
     I              BZAJC8                          WDAJC8
     I              BZRINB                          WDRINB
     I              BZRHNB                          WDRHNB
     I              BZRGNB                          WDRGNB
     I              BZLNCD                          WDLNCD
     I              BZTFNB                          WDTFNB
     I              BZN0CD                          WDN0CD
     I              BZX4ST                          WDX4ST
     I              BZTMVA                          WDTMVA
     I              BZTNVA                          WDTNVA
     I              BZBLPR                          WDBLPR
     I              BZBMPR                          WDBMPR
     I              BZLRCD                          WDLRCD
     I              BZU9ST                          WDU9ST
     I              BZCMCO                          WDCMCO
     I              BZQ1CD                          WDQ1CD
     I              BZQ8CD                          WDQ8CD
     I              BZCHTM                          WDCHTM
     I              BZQZCD                          WDQZCD
     I              BZXWST                          WDXWST
     I              BZXXST                          WDXXST
     I              BZVMST                          WDVMST
     I              BZSWGH                          WDSWGH
     I              BZPPHE                          WDPPHE
     I              BZR3CD                          WDR3CD
     I              BZSDCD                          WDSDCD
     I              BZICN1                          WDICN1
     I              BZSVCD                          WDSVCD
     I              BZICN2                          WDICN2
     I              BZSWCD                          WDSWCD
     I              BZV2NB                          WDV2NB
     I              BZSXCD                          WDSXCD
     I              BZITCN                          WDITCN
     I              BZSYCD                          WDSYCD
     I              BZITC5                          WDITC5
     I              BZSZCD                          WDSZCD
     I              BZICN6                          WDICN6
     I              BZS0CD                          WDS0CD
     I              BZICN7                          WDICN7
     I              BZS1CD                          WDS1CD
     I              BZICN8                          WDICN8
     I              BZS2CD                          WDS2CD
     I              BZICN9                          WDICN9
     I              BZS3CD                          WDS3CD
     I              BZICN0                          WDICN0
     I              BZS4CD                          WDS4CD
     I              BZSFNB                          WDSFNB
     I              BZA3WG                          WDA3WG
     I              BZSJNB                          WDSJNB
     I              BZLLCD                          WDLLCD
     I              BZLMCD                          WDLMCD
     I              BZP3ST                          WDP3ST
     I              BZSKNB                          WDSKNB
     I              BZSLNB                          WDSLNB
     I              BZSMNB                          WDSMNB
     I              BZP4ST                          WDP4ST
     I              BZCFNB                          WDCFNB
     I              BZCGNB                          WDCGNB
     I              BZILNB                          WDILNB
     I              BZCHNB                          WDCHNB
     I              BZCINB                          WDCINB
     I              BZCJNB                          WDCJNB
     I              BZCMNB                          WDCMNB
     I              BZCNNB                          WDCNNB
     I              BZCRNB                          WDCRNB
     I              BZCSNB                          WDCSNB
     I              BZCVNB                          WDCVNB
     I              BZCWNB                          WDCWNB
     I              BZCXNB                          WDCXNB
     I              BZCZNB                          WDCZNB
     I              BZC0NB                          WDC0NB
     I              BZN1CD                          WDN1CD
     I              BZB4NB                          WDB4NB
     I              BZB5NB                          WDB5NB
     I              BZX5ST                          WDX5ST
     I              BZX6ST                          WDX6ST
     I              BZX7ST                          WDX7ST
     I              BZPCCT                          WDPCCT
     I              BZBDNB                          WDBDNB
     I              BZBJNB                          WDBJNB
     I              BZSUST                          WDSUST
     I              BZSVST                          WDSVST
     I              BZSYST                          WDSYST
     I              BZSZST                          WDSZST
     I              BZS1ST                          WDS1ST
     I              BZXRCD                          WDXRCD
     I              BZXTCD                          WDXTCD
     I              BZXUCD                          WDXUCD
     I              BZF5WG                          WDF5WG
     I              BZF6WG                          WDF6WG
     I              BZF7WG                          WDF7WG
     I              BZBLNB                          WDBLNB
     I              BZBNNB                          WDBNNB
     I              BZS2ST                          WDS2ST
     I              BZS4ST                          WDS4ST
     I              BZS5ST                          WDS5ST
     I              BZS6ST                          WDS6ST
     I              BZS8ST                          WDS8ST
     I              BZS9ST                          WDS9ST
     I              BZTCST                          WDTCST
     I              BZTDST                          WDTDST
     I              BZUVST                          WDUVST
     I              BZUWST                          WDUWST
     I              BZUXST                          WDUXST
     I              BZVSST                          WDVSST
     I              BZAATM                          WDAATM
     I              BZAYNA                          WDAYNA
     I              BZA0NA                          WDA0NA
     I              BZAXDT                          WDAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Ship To Customer
     I                                    P   3   60P1BKC7
      * I :  Actual Shipped Date
     I                                    P   7  100P1GNDT
      * I :  Requested Delivery Date
     I                                    P  11  140P1EIDT
      * I :  Requested Ship Date
     I                                    P  15  180P1A5DT
      * I :  Item Code
     I                                    P  19  220P1HGCD
      * I :  Date of Orig. Entry Det.
     I                                    P  23  260P1D3DT
      * I :  Commodity Market Code
     I                                       27  29 P1LQCD
      * I :  Market Pricing Date
     I                                    P  30  330P1EXDT
      * B :  Price Status
     I                                       34  34 P1U1ST
      * I :  Date Method Code
     I                                       35  37 P1RDCD
      * B :  Pricing Date Used
     I                                    P  38  410P1GIDT
      * B :  Pricing Retrieved Amount
     I                                    P  42  474P1TPVA
      * I :  Event Called From
     I                                       48  49 P1SJCD
      * I :  Commodity Price Group
     I                                       50  56 P1LRCD
      * I :  Order Number
     I                                    P  57  600P1C4NB
      * I :  Order Sequence Number
     I                                    P  61  620P1DPNB
      * I :  Order Secondary Line Seq
     I                                    P  63  640P1UENB
      * I :  OD Market Begin Date
     I                                    P  65  680P1TKDT
      * I :  OD Market Ending Date
     I                                    P  69  720P1TLDT
     IP2PARM      DS
      * N :  Date Used for Calculation
     I                                    P   1   40P2GTDT
     IP3PARM      DS
      * B :  Error Return
     I                                        1   5 P3WZST
     IP4PARM      DS
      * FLD: Company Item
      * N :  U/M - Primary
     I                                        1   2 P4ADCD
      * N :  Conversion Factor 1
     I                                    P   3   74P4AWPC
      * N :  Operation Factor 1
     I                                        8   8 P4LXST
      * N :  U/M - Second
     I                                        9  10 P4AECD
      * N :  Conversion Factor 2
     I                                    P  11  154P4AXPC
      * N :  Operation Factor 2
     I                                       16  16 P4LYST
      * N :  U/M - Third
     I                                       17  18 P4AFCD
      * N :  U/M - Pricing
     I                                       19  20 P4AICD
      * N :  Unit Weight
     I                                    P  21  262P4AIWG
     IP5PARM      DS
      * N :  Price Adjustment Amount
     I                                    P   1   64P5LOVA
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1BKC7    PARM           WP0002  70       Ship To Custome
     C           P1GNDT    PARM           WP0003  70       Actual Shipped
     C           P1EIDT    PARM           WP0004  70       Requested Deliv
     C           P1A5DT    PARM           WP0005  70       Requested Ship
     C           P1HGCD    PARM           WP0006  70       Item Code
     C           P1D3DT    PARM           WP0007  70       Date of Orig. E
     C           P1LQCD    PARM           WP0008  3        Commodity Marke
     C           P1EXDT    PARM           WP0009  70       Market Pricing
     C           P1U1ST    PARM P1U1ST    WP0010  1        Price Status
     C           P1RDCD    PARM           WP0011  3        Date Method Cod
     C           P1GIDT    PARM P1GIDT    WP0012  70       Pricing Date Us
     C           P1TPVA    PARM P1TPVA    WP0013 114       Pricing Retriev
     C           P1SJCD    PARM           WP0014  2        Event Called Fr
     C           P1LRCD    PARM           WP0015  7        Commodity Price
     C           P1C4NB    PARM           WP0016  70       Order Number
     C           P1DPNB    PARM           WP0017  30       Order Sequence
     C           P1UENB    PARM           WP0018  30       Order Secondary
     C           P1TKDT    PARM           WP0019  70       OD Market Begin
     C           P1TLDT    PARM           WP0020  70       OD Market Endin
     C           P3WZST    PARM P3WZST    WP0021  5        Error Return
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * RTV Pricing: CIMSLV   XF
      * ----------- CIMSLV: Customer Item Muscle Value
      * CALC: Item Muscle Value
      * Clc Muscle Value      RT - IP Cust Item Formula Dtl  * 
     C                     EXSR SARVGN
      * ------------------------------------------------------
      * Convert Price to CWT
      * CASE: PAR.Pricing Retrieved Amount is Not Zeros
     C           P1TPVA    IFNE *ZERO                      *IF
      * CLC Convert Price - CW XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDKUXFR'              90  CLC Convert Pri
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0055  30       Company Number
     C                     PARM P1HGCD    WQ0056  70       Item Code
     C                     PARM P1TPVA    WQ0057 114       Unit Price
     C           P5LOVA    PARM *ZERO     WQ0058 114       Price Adjustmen
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDKUXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADDP5LOVA    P1TPVA           Pricing Retriev
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Clc Muscle Value      RT - IP Cust Item Formula Dtl  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  7        Commodity Price
     C                     Z-ADD*ZERO     WN0002 114       Price Adjustmen
     C                     Z-ADD*ZERO     WN0003  70       Date Used for C
     C                     MOVEL*BLANK    WN0004  2        U/M - Primary
     C                     MOVEL*BLANK    WN0005  2        U/M - Second
     C                     MOVEL*BLANK    WN0006  2        U/M - Third
     C                     MOVEL*BLANK    WN0007  2        U/M - Pricing
     C                     Z-ADD*ZERO     WN0008  94       Conversion Fact
     C                     Z-ADD*ZERO     WN0009  94       Conversion Fact
     C                     MOVEL*BLANK    WN0010  1        Operation Facto
     C                     MOVEL*BLANK    WN0011  1        Operation Facto
     C                     MOVEL*BLANK    WN0012  3        Default Commod
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WABKC7    WQSA01           Ship To Custome
     C           *LIKE     DEFN WAHGCD    WQSA02           Item Code
     C           *LIKE     DEFN WAIUST    WQSA03           CIFD Formula Va
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Ship To Custome
     C                     KFLD           WQSA02           Item Code
     C                     KFLD           WQSA03           CIFD Formula Va
      * Setup key
     C                     Z-ADDP1BKC7    WQSA01           Ship To Custome
     C                     Z-ADDP1HGCD    WQSA02           Item Code
     C                     MOVEL'M'       WQSA03           CIFD Formula Va
      * Establish starting position
     C           KRSSA     SETLL@F9REF4                    *
     C           KRSSA     READE@F9REF4                  90*
      * Data record not found
     C   90                MOVEL'USR4294' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * --- Muscle Value ---
      * Muscle Value = ((x1  + x2) * (x3 / x4) - x5) / (x5 / x6)
      * ((BseMktPrice + PrmDed) * (%ofMkt / 100) - CrdVal) / (Yld / 100)
      * RTV: Base Market Price
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.CIFD Commodity Market is Entered
      *   |- c2    : DB1.CIFD Commodity Price Grp is Not Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAMPAA    IFNE *BLANK                     *IF
     C           WARSNY    IFNE *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * --- Retrieve Base Market Price
      * CASE: PAR.Event Called From is All Values
     C           P1SJCD    IFEQ '02'                       *IF
     C           P1SJCD    OREQ '99'
     C           P1SJCD    OREQ '**'
     C           P1SJCD    OREQ 'AO'
     C           P1SJCD    OREQ 'AI'
      * --- Date Method Code Entered
      * CASE: PAR.Date Method Code is Entered
     C           P1RDCD    IFNE *BLANK                     *IF
      * CLC Date Method        XF - Market Date Method  * 
     C                     CALL 'PDLJXFR'              90  CLC Date Method
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0001  30       Company Number
     C                     PARM P1RDCD    WQ0002  3        Date Method Cod
     C                     PARM P1GNDT    WQ0003  70       Actual Shipped
     C                     PARM P1EIDT    WQ0004  70       Requested Deliv
     C                     PARM P1A5DT    WQ0005  70       Requested Ship
     C                     PARM P1D3DT    WQ0006  70       Date of Orig. E
     C                     PARM WAMPAA    WQ0007  3        Commodity Marke
     C                     PARM P1EXDT    WQ0008  70       Market Pricing
     C           P1U1ST    PARM P1U1ST    WQ0009  1        Price Status
     C           P1GIDT    PARM *ZERO     WQ0010  70       Pricing Date Us
     C           WN0002    PARM WN0002    WQ0011 114       Pricing Retriev
     C                     PARM P1SJCD    WQ0012  2        Event Called Fr
     C                     PARM WARSNY    WQ0013  7        Commodity Price
     C                     PARM P1TKDT    WQ0014  70       OD Market Begin
     C                     PARM P1TLDT    WQ0015  70       OD Market Endin
     C           WN0003    PARM WN0003    WQ0016  70       Date Used for C
     C           P3WZST    PARM *BLANK    WQ0017  5        Date Error Retu
     C                     PARM P1HGCD    WQ0018  70       Item Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDLJXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.OD Market Begin Date is Entered
      *   |- c2    : PAR.OD Market Ending Date is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1TKDT    IFNE *ZERO                      *IF
     C           P1TLDT    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Date Range Avg Cd RT - Market Date Method  * 
     C                     EXSR SBRVGN
      * CLC Date Method        XF - Market Date Method  * 
     C                     CALL 'PDLJXFR'              90  CLC Date Method
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0019  30       Company Number
     C                     PARM YL0001    WQ0020  3        Date Method Cod
     C                     PARM P1GNDT    WQ0021  70       Actual Shipped
     C                     PARM P1EIDT    WQ0022  70       Requested Deliv
     C                     PARM P1A5DT    WQ0023  70       Requested Ship
     C                     PARM P1D3DT    WQ0024  70       Date of Orig. E
     C                     PARM WAMPAA    WQ0025  3        Commodity Marke
     C                     PARM P1EXDT    WQ0026  70       Market Pricing
     C           P1U1ST    PARM P1U1ST    WQ0027  1        Price Status
     C           P1GIDT    PARM *ZERO     WQ0028  70       Pricing Date Us
     C           WN0002    PARM WN0002    WQ0029 114       Pricing Retriev
     C                     PARM P1SJCD    WQ0030  2        Event Called Fr
     C                     PARM WARSNY    WQ0031  7        Commodity Price
     C                     PARM P1TKDT    WQ0032  70       OD Market Begin
     C                     PARM P1TLDT    WQ0033  70       OD Market Endin
     C           WN0003    PARM WN0003    WQ0034  70       Date Used for C
     C           P3WZST    PARM *BLANK    WQ0035  5        Date Error Retu
     C                     PARM P1HGCD    WQ0036  70       Item Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDLJXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * *** Load Date used for calculation (to retrieve Market date)
      * CASE: PAR.Market Pricing Date is NE Zero
     C           P1EXDT    IFNE *ZERO                      *IF
     C                     Z-ADDP1EXDT    WN0003           Date Used for C
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Date Used for Calculation is not entered
     C           WN0003    IFEQ *ZERO                      *IF
      * CASE: PAR.Actual Shipped Date is entered
     C           P1GNDT    IFNE *ZERO                      *IF
     C                     Z-ADDP1GNDT    WN0003           Date Used for C
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP1A5DT    WN0003           Date Used for C
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Retrieve Base Market Price
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.CIFD Commodity Market is Entered
      *   |- c2    : DB1.CIFD Commodity Price Grp is Not Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAMPAA    IFNE *BLANK                     *IF
     C           WARSNY    IFNE *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWAMPAA    WL0001    P      Commodity Marke
     C                     MOVELWARSNY    WL0002    P      Commodity Price
     C                     Z-ADDWN0003    WL0003           Market Price Da
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0004    WN0002           Commodity Marke
     C                     Z-ADDWL0005    P1GIDT           USR Date Priced
      * Flag as Unpriced if Price Date doesn't match Market date entered
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Pricing Date Used NE PAR.Date Used for Calculati
      *   |- c2    : PGM.*Return code is *Record does not exist
      *   '-
     C           P1GIDT    IFNE WN0003                     *IF
     C           W0RTN     OREQ @CN,001                    *OR
     C                     MOVEL'U'       P1U1ST           Price Status
      * If no pricing record was found then flag as pricing error.
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL*BLANK    P3WZST           Error Return
     C                     MOVEL'MKT'     P3WZST           Error Return
     C                     END                             *FI
     C                     END                             *FI
      * If record not found use default commodity market from company/ite
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * RTV Item Pricing Info  RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0006           Company Number
     C                     Z-ADDWAHGCD    WL0007           Item Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0008    YN0001    P      U/M - Primary
     C                     Z-ADDWL0009    YN0002           Conversion Fact
     C                     MOVELWL0010    YN0003    P      Operation Facto
     C                     MOVELWL0011    YN0004    P      U/M - Second
     C                     Z-ADDWL0012    YN0005           Conversion Fact
     C                     MOVELWL0013    YN0006    P      Operation Facto
     C                     MOVELWL0014    YN0007    P      U/M - Third
     C                     MOVELWL0015    YN0008    P      U/M - Pricing
     C                     Z-ADDWL0016    YN0009           Unit Weight
     C                     MOVELWL0017    YN0010    P      Production Date
     C                     MOVELWL0018    YN0011    P      Catch Weight St
     C                     MOVELWL0019    WN0012    P      Default Commod
     C                     MOVELWL0020    WN0001    P      Commodity Price
      * CASE: DB1.CIFD Commodity Market NE PAR.Default Commod Mark basis
     C           WAMPAA    IFNE WN0012                     *IF
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0012    WL0001    P      Commodity Marke
     C                     MOVELWN0001    WL0002    P      Commodity Price
     C                     Z-ADDWN0003    WL0003           Market Price Da
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0004    WN0002           Commodity Marke
     C                     Z-ADDWL0005    P1GIDT           USR Date Priced
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0002           Price Adjustmen
     C                     END                             *FI
      * RTV Pricing: CICRDV   XF - Price Method Componant  * 
     C                     CALL 'PNQXXFR'              90  RTV Pricing: CI
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0037  30       Company Number
     C                     PARM WABKC7    WQ0038  70       Ship To Custome
     C                     PARM P1GNDT    WQ0039  70       Actual Shipped
     C                     PARM P1EIDT    WQ0040  70       Requested Deliv
     C                     PARM P1A5DT    WQ0041  70       Requested Ship
     C                     PARM WAHGCD    WQ0042  70       Item Code
     C                     PARM P1D3DT    WQ0043  70       Date of Orig. E
     C                     PARM P1LQCD    WQ0044  3        Commodity Marke
     C                     PARM P1EXDT    WQ0045  70       Market Pricing
     C           P1U1ST    PARM P1U1ST    WQ0046  1        Price Status
     C                     PARM P1RDCD    WQ0047  3        Date Method Cod
     C           P1GIDT    PARM P1GIDT    WQ0048  70       Pricing Date Us
     C           YL0002    PARM YL0002    WQ0049 114       Pricing Retriev
     C                     PARM P1SJCD    WQ0050  2        Event Called Fr
     C                     PARM WN0001    WQ0051  7        Commodity Price
     C                     PARM P1TKDT    WQ0052  70       OD Market Begin
     C                     PARM P1TLDT    WQ0053  70       OD Market Endin
     C           P3WZST    PARM *BLANK    WQ0054  5        Error Return
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNQXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Error Routine - Exit if Error
      * CASE: PAR.Error Return is All Entered Values
     C           P3WZST    IFEQ 'CFR'                      *IF
     C           P3WZST    OREQ 'CID'
     C           P3WZST    OREQ 'CIF'
     C           P3WZST    OREQ 'CIO'
     C           P3WZST    OREQ 'QPE'
     C           P3WZST    OREQ 'EXT'
     C           P3WZST    OREQ 'XPE'
     C           P3WZST    OREQ 'FPE'
     C           P3WZST    OREQ 'IOM'
     C           P3WZST    OREQ 'IOV'
     C           P3WZST    OREQ 'MPE'
     C           P3WZST    OREQ 'KPE'
     C           P3WZST    OREQ 'MKT'
     C           P3WZST    OREQ 'MSC'
     C           P3WZST    OREQ 'OVR'
     C           P3WZST    OREQ 'STR'
     C           P3WZST    OREQ 'SUB'
     C           P3WZST    OREQ 'TRC'
     C           P3WZST    OREQ 'WPA'
     C           P3WZST    OREQ 'RWB'
     C           P3WZST    OREQ 'ITERR'
     C           P3WZST    OREQ 'CRD'
     C           P3WZST    OREQ 'MSL'
     C                     MOVEL*BLANK    P3WZST           Error Return
     C                     MOVEL'CRD'     P3WZST           Error Return
     C                     ELSE
      * CASE: *OTHERWISE
      * Muscle Value
      * LCL.Numeric Value 1 USR =
      *    *COMPUTE (((x1 + x2) * (x3 / x4) - x5) / (x6 / x7))
      * x1    : PAR.Price Adjustment Amount
      * +     : PGM.*Synon (15,5) work field
      * x2    : DB1.CIFD Market Prem/Deduct
      * *     : PGM.*Synon (15,5) work field *Rounded
      * x3    : DB1.CIFD Percent of Market
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x4    : CON.100
      * -     : PGM.*Synon (15,5) work field
      * x5    : LCL.Componant Price
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x6    : DB1.CIFD Yield Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x7    : CON.100
     C           WN0002    ADD  WAGZPR    W0WB03           *Synon (15,5) w
     C           WAGXPC    DIV  100       W0WB04    H      *Synon (15,5) w
     C           W0WB03    MULT W0WB04    W0WB02    H      *Synon (15,5) w
     C           W0WB02    SUB  YL0002    W0WB01           *Synon (15,5) w
     C           WAGYPC    DIV  100       W0WB05    H      *Synon (15,5) w
     C           W0WB01    DIV  W0WB05    W0WB00    H      *Synon (15,5) w
     C                     Z-ADDW0WB00    YL0003           Numeric Value 1
     C           YL0003    MULT 1         WN0002    H      Price Adjustmen
      * --- Total Muscle Value ---
     C                     ADD  WN0002    P1TPVA           Pricing Retriev
     C                     END                             *FI
     C           KRSSA     READE@F9REF4                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Date Range Avg Cd RT - Market Date Method  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBBXST    WQSB01           System using Da
     C           *LIKE     DEFN WBRECD    WQSB02           CTL Date Type
     C           *LIKE     DEFN WBAIC3    WQSB03           Company Number
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           System using Da
     C                     KFLD           WQSB02           CTL Date Type
     C                     KFLD           WQSB03           Company Number
      * Setup key
     C                     MOVEL'O'       WQSB01           System using Da
     C                     MOVEL'R'       WQSB02           CTL Date Type
     C                     Z-ADDP1AIC3    WQSB03           Company Number
      * Establish starting position
     C           KRSSB     SETLL@IPREHD                    *
     C           KRSSB     READE@IPREHD                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1681' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           Date Method Cod
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBRDCD    YL0001           Date Method Cod
     C                     GOTO SBEXIT                     *QUIT
     C           KRSSB     READE@IPREHD                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCLQCD    WQSC01           Commodity Marke
     C           *LIKE     DEFN WCLRCD    WQSC02           Commodity Price
      * Define keylist
     C           KPSSC     KLIST
     C                     KFLD           WQSC01           Commodity Marke
     C                     KFLD           WQSC02           Commodity Price
     C                     KFLD           WCEQDT           Market Price Da
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Commodity Marke
     C                     KFLD           WQSC02           Commodity Price
      * Setup key
     C                     MOVELWL0001    WQSC01           Commodity Marke
     C                     MOVELWL0002    WQSC02           Commodity Price
     C                     Z-ADDWL0003    WCEQDT           Market Price Da
      * Establish starting position
     C           KPSSC     SETLL@F0CPEP                    *
     C           KRSSC     READE@F0CPEP                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1222' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,001   W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0004           Commodity Marke
     C                     Z-ADD*ZERO     WL0005           USR Date Priced
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWCA5PR    WL0004           Commodity Marke
     C                     Z-ADDWCEQDT    WL0005           USR Date Priced
     C                     GOTO SCEXIT                     *QUIT
     C           KRSSC     READE@F0CPEP                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Item Pricing Info  RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0006    WDAIC3           Company Number
     C                     Z-ADDWL0007    WDHGCD           Item Code
      * Establish starting position
     C           KRSSD     CHAIN@BZREJU              90    *
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDADCD    WL0008           U/M - Primary
     C                     Z-ADDWDAWPC    WL0009           Conversion Fact
     C                     MOVELWDLXST    WL0010           Operation Facto
     C                     MOVELWDAECD    WL0011           U/M - Second
     C                     Z-ADDWDAXPC    WL0012           Conversion Fact
     C                     MOVELWDLYST    WL0013           Operation Facto
     C                     MOVELWDAFCD    WL0014           U/M - Third
     C                     MOVELWDAICD    WL0015           U/M - Pricing
     C                     Z-ADDWDAIWG    WL0016           Unit Weight
     C                     MOVELWDFZST    WL0017           Production Date
     C                     MOVELWDAVST    WL0018           Catch Weight St
     C                     MOVELWDLNCD    WL0019           Default Commod
     C                     MOVELWDLRCD    WL0020           Commodity Price
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P2GTDT           Date Used for C
     C                     MOVEL*BLANK    P4ADCD           U/M - Primary
     C                     Z-ADD*ZERO     P4AWPC           Conversion Fact
     C                     MOVEL*BLANK    P4LXST           Operation Facto
     C                     MOVEL*BLANK    P4AECD           U/M - Second
     C                     Z-ADD*ZERO     P4AXPC           Conversion Fact
     C                     MOVEL*BLANK    P4LYST           Operation Facto
     C                     MOVEL*BLANK    P4AFCD           U/M - Third
     C                     MOVEL*BLANK    P4AICD           U/M - Pricing
     C                     Z-ADD*ZERO     P4AIWG           Unit Weight
     C                     Z-ADD*ZERO     P5LOVA           Price Adjustmen
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WARRNY           CIFD Sequence N
     C                     Z-ADD*ZERO     WAGZPR           CIFD Market Pre
     C                     Z-ADD*ZERO     WAGXPC           CIFD Percent of
     C                     Z-ADD*ZERO     WAGYPC           CIFD Yield Perc
     C                     Z-ADD*ZERO     WAMJDT           Create Date
     C                     Z-ADD*ZERO     WABETM           Create Time
     C                     Z-ADD*ZERO     WAMKDT           Change Date
     C                     Z-ADD*ZERO     WABFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBCPRD           CTL Prior Day
     C                     Z-ADD*ZERO     WBQMNB           CTL Prior Week
     C                     Z-ADD*ZERO     WBCNOT           CTL Number of T
     C                     Z-ADD*ZERO     WBCDOW           CTL Day of Week
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCEQDT           Market Price Da
     C                     Z-ADD*ZERO     WCA5PR           Commodity Marke
     C                     Z-ADD*ZERO     WCB8PR           Projected Marke
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WDAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WDAIWG           Unit Weight
     C                     Z-ADD*ZERO     WDCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WDC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WDURTN           Number Cases On
     C                     Z-ADD*ZERO     WDAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WDRINB           Item Structure
     C                     Z-ADD*ZERO     WDRHNB           Item Structure
     C                     Z-ADD*ZERO     WDRGNB           Item Structure
     C                     Z-ADD*ZERO     WDTFNB           Transportation
     C                     Z-ADD*ZERO     WDTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WDTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WDBLPR           Market Overage
     C                     Z-ADD*ZERO     WDBMPR           Standard Overag
     C                     Z-ADD*ZERO     WDCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WDCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WDSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WDPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WDICN1           Item Category N
     C                     Z-ADD*ZERO     WDICN2           Item Category N
     C                     Z-ADD*ZERO     WDV2NB           Item Category N
     C                     Z-ADD*ZERO     WDITCN           Item Category N
     C                     Z-ADD*ZERO     WDITC5           Item Category N
     C                     Z-ADD*ZERO     WDICN6           Item Category N
     C                     Z-ADD*ZERO     WDICN7           Item Category N
     C                     Z-ADD*ZERO     WDICN8           Item Category N
     C                     Z-ADD*ZERO     WDICN9           Item Category N
     C                     Z-ADD*ZERO     WDICN0           Item Category N
     C                     Z-ADD*ZERO     WDSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WDA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WDSJNB           Production Lead
     C                     Z-ADD*ZERO     WDSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WDSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WDSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WDCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WDCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WDILNB           PM % 2nds Facto
     C                     Z-ADD*ZERO     WDCHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WDCINB           PM Batch Size
     C                     Z-ADD*ZERO     WDCJNB           PM Lot Size
     C                     Z-ADD*ZERO     WDCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WDCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WDCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WDCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WDCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WDCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WDCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WDCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WDC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WDB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WDB5NB           PM Line Number
     C                     Z-ADD*ZERO     WDBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WDBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WDF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WDF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WDF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WDBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WDBNNB           Production Qty
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WB03 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB04 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB02 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB01 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB05 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB00 155       *Synon (15,5) w
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SCRVGN.
     C                     MOVEL*BLANK    WL0001  3
     C                     MOVEL*BLANK    WL0002  7
     C                     Z-ADD*ZERO     WL0003  70
     C                     Z-ADD*ZERO     WL0004 114
     C                     Z-ADD*ZERO     WL0005  70
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0006  30
     C                     Z-ADD*ZERO     WL0007  70
     C                     MOVEL*BLANK    WL0008  2
     C                     Z-ADD*ZERO     WL0009  94
     C                     MOVEL*BLANK    WL0010  1
     C                     MOVEL*BLANK    WL0011  2
     C                     Z-ADD*ZERO     WL0012  94
     C                     MOVEL*BLANK    WL0013  1
     C                     MOVEL*BLANK    WL0014  2
     C                     MOVEL*BLANK    WL0015  2
     C                     Z-ADD*ZERO     WL0016 112
     C                     MOVEL*BLANK    WL0017  1
     C                     MOVEL*BLANK    WL0018  1
     C                     MOVEL*BLANK    WL0019  3
     C                     MOVEL*BLANK    WL0020  7
      * Define local work field Date Method Code
     C                     MOVEL*BLANK    YL0001  3
      * Define null work field U/M - Primary
     C                     MOVEL*BLANK    YN0001  2
      * Define null work field Conversion Factor 1
     C                     Z-ADD*ZERO     YN0002  94
      * Define null work field Operation Factor 1
     C                     MOVEL*BLANK    YN0003  1
      * Define null work field U/M - Second
     C                     MOVEL*BLANK    YN0004  2
      * Define null work field Conversion Factor 2
     C                     Z-ADD*ZERO     YN0005  94
      * Define null work field Operation Factor 2
     C                     MOVEL*BLANK    YN0006  1
      * Define null work field U/M - Third
     C                     MOVEL*BLANK    YN0007  2
      * Define null work field U/M - Pricing
     C                     MOVEL*BLANK    YN0008  2
      * Define null work field Unit Weight
     C                     Z-ADD*ZERO     YN0009 112
      * Define null work field Production Date Control
     C                     MOVEL*BLANK    YN0010  1
      * Define null work field Catch Weight Status
     C                     MOVEL*BLANK    YN0011  1
      * Define local work field Componant Price
     C                     Z-ADD*ZERO     YL0002 114
      * Define local work field Numeric Value 1 USR
     C                     Z-ADD*ZERO     YL0003 155
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Y2U0005
