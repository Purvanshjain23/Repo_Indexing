// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PDS0PVR
// ?Date: 14.08.2025 Time: 03:29:41
// ?------------------------------------------------------------------------------------------------

//?USER: Initialize program

// WRK.First Time Flag = CND.Yes
WRK.First_Time_Flag = 'Y';

// PAR.Status Flag 12 Y/N = CND.No
PAR.Status_Flag_12_Y_N = 'N';

EXECUTE FUNCTION(Rtv Plant Co/Org      RT) TYPE(RTVOBJ) FILE(PDJYREP)           AC1826265;
PARAMETER(PAR.Company_Number);
PARAMETER(NLL.Plant_Company_Sts);
PARAMETER(LCL.Company_Organization);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


//?Load Planning is output if not Seaboard
CASE;

// IF LCL.Company Organization is Not Seaboard
IF LCL.Company_Organization = 'D'/'H';

// PAR.Status Flag 12 Y/N = CND.Yes
PAR.Status_Flag_12_Y_N = 'Y';

ENDIF;

//?T11489 DN 08/17/17-Initialize Salesperson Code & Name.
CASE;

// IF *OTHERWISE
IF *OTHERWISE;

// LCL.First Time Flag = CND.Yes
LCL.First_Time_Flag = 'Y';

// PAR.Salesperson Code = CON.*BLANK
PAR.Salesperson_Code = *BLANK;

// PAR.Salesperson Name = CON.*BLANK
PAR.Salesperson_Name = *BLANK;

ENDIF;

//?USER: Load screen

//?E2176 SLM 20130423  ACK Distribution list by warehouse
//?need warehouse to see if there is a warehouse dist list
//?RMC E2625 get country too
EXECUTE FUNCTION(RTV Chk DtlExists Info RT) TYPE(RTVOBJ) FILE(OPBGWKP)          AC2062446;
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Order_Number);
PARAMETER(WRK.Warehouse_Code);
PARAMETER(LCL.Country_Code);
{
 //?USER: Initialize routine

 MOVE *ALL (To: PAR From: CON);

 //?USER: Processing if Data record not found

 // PGM.*Return code = CND.*Record does not exist
 PGM.*Return_code = 'Y2U0005';

 //?USER: Process Data record

 // PGM.*Return code = CND.*Record already exists
 PGM.*Return_code = 'Y2U0003';

 MOVE *ALL (To: PAR From: DB1);

}


//?Japan
CASE;

// IF LCL.Country Code is Japan
IF LCL.Country_Code = 'JPN';

EXECUTE FUNCTION(RTV Warehouse Type     RT) TYPE(RTVOBJ) FILE(CAADREP)          AC1285482;
PARAMETER(WRK.Warehouse_Code);
PARAMETER(LCL.Warehouse_Type);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


EXECUTE FUNCTION(RTV Booking # f/ord   RT) TYPE(RTVOBJ) FILE(PMAMREP)           AC2069357;
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Order_Number);
PARAMETER(LCL.OHE_Booking_Number);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

 QUIT;

}


ENDIF;

//?MSG 'Order has no line items'
CASE;

// IF PGM.*Return code is *Record does not exist
IF PGM.*Return_code = 'Y2U0005';

// Send information message - 'Warning:  Order has no line items'
MESSAGE(USR2058 *INFO);

ENDIF;

EXECUTE FUNCTION(Rtv Whs Dist Email    RT) TYPE(RTVOBJ) FILE(PNGVREP)           AC2062676;
PARAMETER(WRK.Warehouse_Code);
PARAMETER('SL-ACKNOWL');
PARAMETER(WRK.Email_To_Whs);
{
 //?USER: Initialize routine

 // PAR.Email To Whs = CND.no
 PAR.Email_To_Whs = 'N';

 //?USER: Process Data record

 CASE;

 // IF DB1.Record Status is Active
 IF DB1.Record_Status = 'A';

 // PAR.Email To Whs = CND.yes
 PAR.Email_To_Whs = 'Y';

 QUIT;

 ENDIF;

}


//?First time
CASE;

// IF WRK.First Time Flag is Yes
IF WRK.First_Time_Flag = 'Y';

//?EMAIL to WHS
CASE;

// IF WRK.Email To Whs is yes
IF WRK.Email_To_Whs = 'Y';

// DTL.Status Flag 8  Y/N = CND.Yes
DTL.Status_Flag_8_Y_N = 'Y';

//?EMAIL to WHS
// IF *OTHERWISE
IF *OTHERWISE;

// DTL.Status Flag 8  Y/N = CND.No
DTL.Status_Flag_8_Y_N = 'N';

ENDIF;

// WRK.First Time Flag = CND.NO
WRK.First_Time_Flag = 'N';

ENDIF;

EXECUTE FUNCTION(RTV Block Order Flag  RT) TYPE(RTVOBJ) FILE(OPBFCPP)           AC1873478;
PARAMETER(DTL.Company_Number);
PARAMETER(DTL.Order_Number);
PARAMETER(DTL.Block_Order_Flag);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


// PAR.Status - Y or N = CND.no
PAR.Status_Y_or_N = 'N';

//?STATUS 8 = BLANK    MOVE N  (Email WHS)
CASE;

// IF DTL.Status Flag 8  Y/N is *Blank
IF DTL.Status_Flag_8_Y_N = *BLANK;

// DTL.Status Flag 8  Y/N = CND.No
DTL.Status_Flag_8_Y_N = 'N';

ENDIF;

// DTL.Status Flag 2  Y/N = CND.No
DTL.Status_Flag_2_Y_N = 'N';

// DTL.Status Flag 3  Y/N = CND.No
DTL.Status_Flag_3_Y_N = 'N';

// DTL.Status Flag 4  Y/N = CND.no
DTL.Status_Flag_4_Y_N = 'N';

// DTL.Display Flag 1 USR = CND.no
DTL.Display_Flag_1_USR = 'N';

//?E00255 12/01/08 LJB Fax ACK to Customer
// DTL.Status Flag 7  Y/N = CND.No
DTL.Status_Flag_7_Y_N = 'N';

//?Get Ready Rpt - Daily's???
CASE;

// IF PAR.Status Flag 5  Y/N is No
IF PAR.Status_Flag_5_Y_N = 'N';

// DTL.Status Flag 5  Y/N = CND.No
DTL.Status_Flag_5_Y_N = 'N';

//?Get Ready Rpt - Daily's???
// IF *OTHERWISE
IF *OTHERWISE;

EXECUTE FUNCTION(RTV Get Ready Rpt val  RT) TYPE(RTVOBJ) FILE(PPAQREP)          AC1830295;
PARAMETER(PAR.Company_Number);
PARAMETER('GR');

//?Set Status Flag 5  Y/N  if found in Company Document Defaults
CASE;

// IF PGM.*Return code is *Normal
IF PGM.*Return_code = *BLANK;

//?RMC DFT to Yes 10/31/07
// DTL.Status Flag 5  Y/N = CND.Yes
DTL.Status_Flag_5_Y_N = 'Y';

// DTL.Display Flag = CND.Yes
DTL.Display_Flag = 'Y';

//?Set Status Flag 5  Y/N  if found in Company Document Defaults
// IF *OTHERWISE
IF *OTHERWISE;

// DTL.Status Flag 5  Y/N = CND.No
DTL.Status_Flag_5_Y_N = 'N';

// DTL.Display Flag = CND.No
DTL.Display_Flag = 'N';

ENDIF;

ENDIF;

//?* Load Plan Ready will be a hidden field/unavailable  2386/4119
//?C2586  05/16/13 RMC Dft reg sls mgr email=Y if one is found
//?Dft reg sls mgr email
CASE;

// IF PAR.Print (Yes/No) USR is Blank
IF PAR.Print_Yes_No_USR = *BLANK;

//?Dft reg sls mgr email
// IF *OTHERWISE
IF *OTHERWISE;

EXECUTE FUNCTION(RTV Order/ShipState    RT) TYPE(RTVOBJ) FILE(OPBFCPP)          AC1718268;
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Order_Number);
PARAMETER(LCL.Ship_To_State_Code);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


EXECUTE FUNCTION(RTV Reg Sls Mgr FaxOnlyRT) TYPE(RTVOBJ) FILE(PDLWREP)          AC1718261;
PARAMETER(LCL.Ship_To_State_Code);
PARAMETER(LCL.Salesperson_Name);
PARAMETER(LCL.Fax_Phone_Number);
PARAMETER(LCL.Regional_Salesperson_Code);
{
 //?USER: Processing if Data record not found

 // PGM.*Return code = CND.Territory State        NF
 PGM.*Return_code = 'USR0650';

 //?USER: Process Data record

 // PAR.Salesperson Name = CON.*BLANK
 PAR.Salesperson_Name = *BLANK;

 // PAR.Fax Number FF = CON.*BLANK
 PAR.Fax_Number_FF = *BLANK;

 EXECUTE FUNCTION(RTV Reg Sls Mgr FaxOnlyRT) TYPE(RTVOBJ) FILE(PDLVREP)          AC1718262;
 PARAMETER(DB1.Territory_Code);
 PARAMETER(PAR.Regional_Salesperson_Code);
 {
  //?USER: Processing if Data record not found

  // PGM.*Return code = CND.*Record does not exist
  PGM.*Return_code = 'Y2U0005';

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

  // PGM.*Return code = CND.*Normal
  PGM.*Return_code = *BLANK;

  QUIT;

 }

 CASE;

 // IF PGM.*Return code is *Normal
 IF PGM.*Return_code = *BLANK;

 EXECUTE FUNCTION(RTV Reg Sls Mgr FaxOnlyRT) TYPE(RTVOBJ) FILE(CAAPREP)          AC1718263;
 PARAMETER(PAR.Regional_Salesperson_Code);
 PARAMETER(PAR.Salesperson_Name);
 PARAMETER(PAR.Fax_Number_FF);
 {
  //?USER: Processing if Data record not found

  // PGM.*Return code = CND.*Record does not exist
  PGM.*Return_code = 'Y2U0005';

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

  // PGM.*Return code = CND.*Normal
  PGM.*Return_code = *BLANK;

  QUIT;

 }

 // IF *OTHERWISE
 IF *OTHERWISE;

 QUIT;

 ENDIF;

}


// Call program Exc Rtv Reg Sls Email  XF.
CALL PROGRAM(Exc Rtv Reg Sls Email  XF) ('PBISXFR');
PARAMETER(LCL.Regional_Salesperson_Code);
PARAMETER(LCL.Email_Address);

CASE;

// IF LCL.Email Address is Entered
IF LCL.Email_Address <> *BLANK;

// OR LCL.Fax Phone Number is NE Blanks
OR LCL.Fax_Phone_Number <> *BLANK;

// DTL.Text USR 7 = LCL.Salesperson Name
DTL.Text_USR_7 = LCL.Salesperson_Name;

ENDIF;

ENDIF;

//?08/06/24 SP S312312-Start
// DTL.Email to Broker Usr = CND.No
DTL.Email_to_Broker_Usr = 'N';

EXECUTE FUNCTION(Rtv Ship to Broker Eml RT) TYPE(RTVOBJ) FILE(OMHOREP)          AC2230823;
PARAMETER(PAR.Ship_To_Customer);
PARAMETER(JOB.*Job_date);
PARAMETER(LCL.Broker_Code);
PARAMETER(NLL.Broker_Email_Address);
{
 //?USER: Initialize routine

 // PAR.Broker Code = CND.Not entered
 PAR.Broker_Code = *BLANK;

 // PAR.Broker Email Address = CND.Blank
 PAR.Broker_Email_Address = *BLANK;

 //?USER: Processing if Data record not found

 // PGM.*Return code = CND.*Record does not exist
 PGM.*Return_code = 'Y2U0005';

 //?USER: Process Data record

 CASE;

 // IF DB1.Period Beginning Date LE PAR.Date From             USR
 IF DB1.Period_Beginning_Date <= PAR.Date_From_USR;

 // AND DB1.Period Ending Date GE PAR.Date From             USR
 AND DB1.Period_Ending_Date >= PAR.Date_From_USR;

 CASE;

 // IF DB1.Broker Code is Entered
 IF DB1.Broker_Code <> *BLANK;

 EXECUTE FUNCTION(Rtv All details        RT) TYPE(RTVOBJ) FILE(POC5REP)          AC2232586;
 PARAMETER(DB1.Broker_Code);
 PARAMETER(NLL.Broker_Name);
 PARAMETER(NLL.Broker_Address_Line_1);
 PARAMETER(NLL.Broker_Address_Line_2);
 PARAMETER(NLL.Broker_City);
 PARAMETER(NLL.Broker_State);
 PARAMETER(NLL.Broker_Zip);
 PARAMETER(NLL.Broker_Office_Manager);
 PARAMETER(NLL.Broker_Telephone_Number);
 PARAMETER(NLL.Broker_Fax_Number);
 PARAMETER(LCL.Broker_Email_Address);
 PARAMETER(NLL.Broker_G_L_Vendor_Number);
 PARAMETER(NLL.Broker_unused_txt_1);
 PARAMETER(NLL.Broker_M3_Supplier);
 PARAMETER(NLL.Broker_EDI_Trade_Partner);
 PARAMETER(NLL.Broker_Fax_Email_Inv);
 PARAMETER(NLL.Broker_Fax_Email_Prc_Sht);
 PARAMETER(NLL.Payee_Type);
 PARAMETER(NLL.Broker_unused_sts_4);
 PARAMETER(NLL.Salesperson_Code);
 PARAMETER(NLL.EDI_Status_1);
 PARAMETER(NLL.EDI_Status_2);
 PARAMETER(NLL.EDI_Status_3);
 PARAMETER(LCL.Record_Status);
 {
  //?USER: Initialize routine

  MOVE *ALL (To: PAR From: CON);

  //?USER: Processing if Data record not found

  // PGM.*Return code = CND.*Record does not exist
  PGM.*Return_code = 'Y2U0005';

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 CASE;

 // IF LCL.Record Status is Active
 IF LCL.Record_Status = 'A';

 // PAR.Broker Code = DB1.Broker Code
 PAR.Broker_Code = DB1.Broker_Code;

 // PAR.Broker Email Address = LCL.Broker Email Address
 PAR.Broker_Email_Address = LCL.Broker_Email_Address;

 QUIT;

 ENDIF;

 ENDIF;

 ENDIF;

}


//?08/06/24 SP S312312-End
// DTL.Email to Salesperson Usr = CND.No
DTL.Email_to_Salesperson_Usr = 'N';

//?USER: Validate fields

// PGM.*Defer confirm = CND.Proceed to confirm
PGM.*Defer_confirm = 'N';

//?T11489 DN 08/17/17-Allow to Select a Regional Sales Manager.
CASE;

// IF DTL.Status Flag 3  Y/N is Yes
IF DTL.Status_Flag_3_Y_N = 'Y';

//?Prompt for Salesperson Code.
CASE;

// IF DTL.*CMD key is *Prompt
IF DTL.*CMD_key = '04';

// AND PGM.*Cursor field <IS> DTL.Salesperson Code
AND PGM.*Cursor_field = DTL.Salesperson_Code;

// Call program SEL Regional Sls Mgr 2 SR.
CALL PROGRAM(SEL Regional Sls Mgr 2 SR) ('PUECSRR');
PARAMETER(DTL.Salesperson_Code);
PARAMETER(PAR.Salesperson_Name);

// PAR.Salesperson Code = DTL.Salesperson Code
PAR.Salesperson_Code = DTL.Salesperson_Code;

ENDIF;

//?Validate Salesperson Code.
CASE;

// IF DTL.Salesperson Code is entered
IF DTL.Salesperson_Code <> *BLANK;

EXECUTE FUNCTION(RTV Regional Sls Mgr   RT) TYPE(RTVOBJ) FILE(CAAPREP)          AC2142312;
PARAMETER(DTL.Salesperson_Code);
PARAMETER(PAR.Salesperson_Name);
{
 //?USER: Initialize routine

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


//?Check Return Code.
CASE;

// IF PGM.*Return code is *Normal
IF PGM.*Return_code = *BLANK;

// PAR.Salesperson Code = DTL.Salesperson Code
PAR.Salesperson_Code = DTL.Salesperson_Code;

// DTL.Text USR 7 = PAR.Salesperson Name
DTL.Text_USR_7 = PAR.Salesperson_Name;

//?Defer Confrim If First Time Through.
CASE;

// IF LCL.First Time Flag is Yes
IF LCL.First_Time_Flag = 'Y';

// LCL.First Time Flag = CND.NO
LCL.First_Time_Flag = 'N';

// LCL.Salesperson Code = DTL.Salesperson Code
LCL.Salesperson_Code = DTL.Salesperson_Code;

// PGM.*Defer confirm = CND.Defer confirm
PGM.*Defer_confirm = 'Y';

ENDIF;

//?Defer Confrim If Salesperson Code Changes.
CASE;

// IF DTL.Salesperson Code NE LCL.Salesperson Code
IF DTL.Salesperson_Code <> LCL.Salesperson_Code;

// LCL.Salesperson Code = DTL.Salesperson Code
LCL.Salesperson_Code = DTL.Salesperson_Code;

// PGM.*Defer confirm = CND.Defer confirm
PGM.*Defer_confirm = 'Y';

ENDIF;

//?Check Return Code.
// IF *OTHERWISE
IF *OTHERWISE;

// LCL.Generic Message 80 USR = CONCAT(CON.Regional Sales Manager co,CON.de invalid.,CON.*ZERO)
LCL.Generic_Message_80_USR = 'Regional Sales Manager co' + 'de invalid.' (*ZERO);

// Send error message - '&1'
ERROR(USR4977);
MSGPARM(LCL.Generic_Message_80_USR);

ENDIF;

//?Validate Salesperson Code.
// IF *OTHERWISE
IF *OTHERWISE;

// LCL.Generic Message 80 USR = CONCAT(CON.Must select a Regional Sa,CON.les Manager.,CON.*ZERO)
LCL.Generic_Message_80_USR = 'Must select a Regional Sa' + 'les Manager.' (*ZERO);

// Send error message - '&1'
ERROR(USR4977);
MSGPARM(LCL.Generic_Message_80_USR);

ENDIF;

//?T11489 DN 08/17/17-Allow to Select a Regional Sales Manager.
// IF *OTHERWISE
IF *OTHERWISE;

// PAR.Salesperson Code = CON.*BLANK
PAR.Salesperson_Code = *BLANK;

// PAR.Salesperson Name = CON.*BLANK
PAR.Salesperson_Name = *BLANK;

ENDIF;

//?USER: Validate relations

CASE;

// IF DTL.Salesperson Code is not entered
IF DTL.Salesperson_Code = *BLANK;

// PGM.*Defer confirm = CND.Proceed to confirm
PGM.*Defer_confirm = 'N';

ENDIF;

//?USER: User defined action

//?Confirm Status
// PAR.Status - Y or N = DTL.Status - Y or N
PAR.Status_Y_or_N = DTL.Status_Y_or_N;

//?Print Acknowledgements
// PAR.Print (Yes/No) USR = DTL.Print (Yes/No) USR
PAR.Print_Yes_No_USR = DTL.Print_Yes_No_USR;

//?Fax Customer
// PAR.Status Flag 7  Y/N = DTL.Status Flag 7  Y/N
PAR.Status_Flag_7_Y_N = DTL.Status_Flag_7_Y_N;

//?Fax/Email Buyer
// PAR.Status Flag 2  Y/N = DTL.Status Flag 2  Y/N
PAR.Status_Flag_2_Y_N = DTL.Status_Flag_2_Y_N;

//?Email Region Manager
// PAR.Status Flag 3  Y/N = DTL.Status Flag 3  Y/N
PAR.Status_Flag_3_Y_N = DTL.Status_Flag_3_Y_N;

//?Email Warehouse
// PAR.Status Flag 8  Y/N = DTL.Status Flag 8  Y/N
PAR.Status_Flag_8_Y_N = DTL.Status_Flag_8_Y_N;

//?Get Ready rpt
// PAR.Status Flag 5  Y/N = DTL.Status Flag 5  Y/N
PAR.Status_Flag_5_Y_N = DTL.Status_Flag_5_Y_N;

//?08/06/24 SP S312312-Start
// PAR.Email to Broker Usr = DTL.Email to Broker Usr
PAR.Email_to_Broker_Usr = DTL.Email_to_Broker_Usr;

//?08/06/24 SP S312312-End
// PAR.Email to Salesperson Usr = DTL.Email to Salesperson Usr
PAR.Email_to_Salesperson_Usr = DTL.Email_to_Salesperson_Usr;

//?USER: Exit program processing

//?Confirm
CASE;

// IF PAR.Status - Y or N is blank
IF PAR.Status_Y_or_N = *BLANK;

// PAR.Status - Y or N = CND.no
PAR.Status_Y_or_N = 'N';

ENDIF;

//?Print Ack
CASE;

// IF PAR.Print (Yes/No) USR is Blank
IF PAR.Print_Yes_No_USR = *BLANK;

// PAR.Print (Yes/No) USR = CND.No
PAR.Print_Yes_No_USR = 'N';

ENDIF;

//?Fax/Email Buyer
CASE;

// IF PAR.Status Flag 2  Y/N is *Blank
IF PAR.Status_Flag_2_Y_N = *BLANK;

// PAR.Status Flag 2  Y/N = CND.No
PAR.Status_Flag_2_Y_N = 'N';

ENDIF;

//?3=Email Region Mgr
CASE;

// IF PAR.Status Flag 3  Y/N is *Blank
IF PAR.Status_Flag_3_Y_N = *BLANK;

// PAR.Status Flag 3  Y/N = CND.No
PAR.Status_Flag_3_Y_N = 'N';

ENDIF;

//?sts flg 4
CASE;

// IF PAR.Status Flag 4  Y/N is blank
IF PAR.Status_Flag_4_Y_N = *BLANK;

// PAR.Status Flag 4  Y/N = CND.no
PAR.Status_Flag_4_Y_N = 'N';

ENDIF;

//?5=Get Ready rpt
CASE;

// IF PAR.Status Flag 5  Y/N is *Blank
IF PAR.Status_Flag_5_Y_N = *BLANK;

// PAR.Status Flag 5  Y/N = CND.No
PAR.Status_Flag_5_Y_N = 'N';

ENDIF;

//?7=Fax Ack to cust, if blank, set to No
CASE;

// IF PAR.Status Flag 7  Y/N is *Blank
IF PAR.Status_Flag_7_Y_N = *BLANK;

// PAR.Status Flag 7  Y/N = CND.No
PAR.Status_Flag_7_Y_N = 'N';

ENDIF;

// PAR.Email to Warehouse Code = WRK.Warehouse Code
PAR.Email_to_Warehouse_Code = WRK.Warehouse_Code;

//?8=Email Ack to WHS - clear if *blank
CASE;

// IF PAR.Status Flag 8  Y/N is *Blank
IF PAR.Status_Flag_8_Y_N = *BLANK;

// PAR.Status Flag 8  Y/N = CND.No
PAR.Status_Flag_8_Y_N = 'N';

// PAR.Email to Warehouse Code = CON.*BLANK
PAR.Email_to_Warehouse_Code = *BLANK;

ENDIF;

//?if email - R16637 DN 12/21/20-Fix to Allow Email OA to Warehouse.
CASE;

// IF WRK.Email To Whs is no
IF WRK.Email_To_Whs = 'N';

// PAR.Status Flag 8  Y/N = CND.No
PAR.Status_Flag_8_Y_N = 'N';

// PAR.Email to Warehouse Code = CON.*BLANK
PAR.Email_to_Warehouse_Code = *BLANK;

ENDIF;

//?S312312 - Email Broker
CASE;

// IF PAR.Email to Broker Usr is *Blank
IF PAR.Email_to_Broker_Usr = *BLANK;

// PAR.Email to Broker Usr = CND.No
PAR.Email_to_Broker_Usr = 'N';

ENDIF;

//?S020798 - Set PAR as N if blank
CASE;

// IF PAR.Email to Salesperson Usr is *Blank
IF PAR.Email_to_Salesperson_Usr = *BLANK;

// PAR.Email to Salesperson Usr = CND.No
PAR.Email_to_Salesperson_Usr = 'N';

ENDIF;

