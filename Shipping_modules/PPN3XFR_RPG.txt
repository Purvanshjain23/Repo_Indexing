     H/TITLE PFS Inventory Adj     XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISJMIST
     H* Date          : 12/05/24  Time  : 23:54:00
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPPBGCPL2IF  E           K        DISK
      * RTV : PFS Inventory Adjustment  Not Processed
      *
     FPPBUREL1IF  E           K        DISK
      * RTV : PFS Interface             Retrieval index
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse Codes           Active records only
      *
     FCABZRELXIF  E           K        DISK
      * RSQ : Company Item              Active FinishGood/Wp
      *
     FCAB0RELJIF  E           K        DISK
      * RTV : Item Balance              Acitve records only
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FOMFNCPL8IF  E           K        DISK
      * RSQ : Manifest Detail           Co/Ord/Seq/Seq2/Srl#/LDt
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FPPBGCPL9IF  E           K        DISK
      * RSQ : PFS Inventory Adjustment  Co/Item/Serial/TrTyp,sel
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FPOB2CPLFIF  E           K        DISK
      * RSQ : Product Trace             Co/Srl#/LDte
      *
     FPPAAREL3IF  E           K        DISK
      * RSQ : Product Trace Line Scale  Co/ScaleID/Dte(d)
      *
     FPPABREL1IF  E           K        DISK
      * RTV : Product Trace Line        Retrieval index
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FPDL2REL0IF  E           K        DISK
      * RTV : Warehouse Location        Retrieval index
      *
     FPDL3REL0IF  E           K        DISK
      * RTV : Warehouse Location Type   Retrieval index
      *
     FPDL5CPL1IF  E           K        DISK
      * RTV : Item Lot Location         Retrieval index
      *
     FPDL7CPL2IF  E           K        DISK
      * RSQ : Item Lot Loc Trans        Co/Itm/Whs/Typ/Dte/Sq(d)
      *
     FCAB1REL0IF  E           K        DISK
      * RTV : Item Balance Detail       Retrieval index       NV
      *
     FOMFNCPL3IF  E           K        DISK
      * RSQ : Manifest Detail           Co/Ord/Seq/SecSq/Cs(d)
      *
     FPDL8CPL3IF  E           K        DISK
      * RSQ : Order Inv Allocation      Co/Ord/Seq/Seq2/ASeq(d)
      *
     FPDL8CPL8IF  E           K        DISK
      * RSQ : Order Inv Allocation      Co/Ord/Sq/Sq2/Srl#
      *
     FPOB2CPL0UF  E           K        DISK                      A
      * UPD : Product Trace             Update index
      *
     FPDL5CPL0UF  E           K        DISK                      A
      * UPD : Item Lot Location         Update index
      *
     FPDL7CPL0IF  E           K        DISK                      A
      * UPD : Item Lot Loc Trans        Update index
      *
     FCAB1REL1IF  E           K        DISK                      A
      * UPD : Item Balance Detail       Update index
      *
     FOMFNCPL0UF  E           K        DISK                      A
      * UPD : Manifest Detail           Update index
      *
     FPDL8CPL0UF  E           K        DISK                      A
      * UPD : Order Inv Allocation      Update index
      *
     FPPBGCPL0UF  E           K        DISK
      * UPD : PFS Inventory Adjustment  Update index
      *
     E                    #L7         7  1
      * Long constants
     E                    @CN#    1  21  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@BGCPAS
      * PFS Inventory Adjustment  Not Processed
      * Renamed input format fields
     I              BGY1NX                          WAY1NX
     I              BGC0NY                          WAC0NY
     I              BGAID8                          WAAID8
     I              BGAFTS                          WAAFTS
     I              BGBCNY                          WABCNY
     I              BGVLSX                          WAVLSX
     I              BGVMSX                          WAVMSX
     I              BGY2NX                          WAY2NX
     I              BGU4SX                          WAU4SX
     I              BGADNY                          WAADNY
     I              BGU1SX                          WAU1SX
     I              BGP7DT                          WAP7DT
     I              BGZ4NX                          WAZ4NX
     I              BGACNY                          WAACNY
     I              BGVKSX                          WAVKSX
     I              BGZ2NX                          WAZ2NX
     I              BGZ6NX                          WAZ6NX
     I              BGBDNY                          WABDNY
     I              BGABNY                          WAABNY
     I              BGBENY                          WABENY
     I              BGZ9NX                          WAZ9NX
     I              BGGBAA                          WAGBAA
     I              BGANNY                          WAANNY
     I              BGZPNX                          WAZPNX
     I              BGZXNX                          WAZXNX
     I              BGZYNX                          WAZYNX
     I              BGALNY                          WAALNY
     I              BGAGNY                          WAAGNY
     I              BGUWSX                          WAUWSX
     I              BGUXSX                          WAUXSX
     I              BGV3SX                          WAV3SX
     I              BGAHNY                          WAAHNY
     I              BGAINY                          WAAINY
     I              BGAJNY                          WAAJNY
     I              BGAKNY                          WAAKNY
      *
     I@BUREBI
      * PFS Interface             Retrieval index
      * Renamed input format fields
     I              BUY1NX                          WBY1NX
     I              BUGYAA                          WBGYAA
     I              BURENA                          WBRENA
     I              BUWSSX                          WBWSSX
     I              BUWUSX                          WBWUSX
     I              BUQEDT                          WBQEDT
     I              BUCUTM                          WBCUTM
     I              BUB0NY                          WBB0NY
     I              BUB1NY                          WBB1NY
     I              BUWXSX                          WBWXSX
     I              BUWVSX                          WBWVSX
     I              BUWWSX                          WBWWSX
     I              BUUWSX                          WBUWSX
     I              BUUXSX                          WBUXSX
     I              BUV3SX                          WBV3SX
     I              BUAHNY                          WBAHNY
     I              BUAINY                          WBAINY
     I              BUAJNY                          WBAJNY
     I              BUAKNY                          WBAKNY
      *
     I@ADRET1
      * Warehouse Codes           Active records only
      * Renamed input format fields
     I              ADAJCD                          WCAJCD
     I              ADF8NA                          WCF8NA
     I              ADACNA                          WCACNA
     I              ADADNA                          WCADNA
     I              ADAENA                          WCAENA
     I              ADAJNA                          WCAJNA
     I              ADBTTX                          WCBTTX
     I              ADAOCD                          WCAOCD
     I              ADBGCD                          WCBGCD
     I              ADVHST                          WCVHST
     I              ADMPNA                          WCMPNA
     I              ADWPST                          WCWPST
     I              ADXUST                          WCXUST
     I              ADT0ST                          WCT0ST
     I              ADT1ST                          WCT1ST
     I              ADDBNB                          WCDBNB
     I              ADT2ST                          WCT2ST
     I              ADT3ST                          WCT3ST
     I              ADT4ST                          WCT4ST
     I              ADT6ST                          WCT6ST
     I              ADBWC3                          WCBWC3
     I              ADBTC3                          WCBTC3
     I              ADBUC3                          WCBUC3
     I              ADBVC3                          WCBVC3
     I              ADFCAA                          WCFCAA
     I              ADRQSX                          WCRQSX
     I              ADRRSX                          WCRRSX
     I              ADRSSX                          WCRSSX
     I              ADRTSX                          WCRTSX
     I              ADT7ST                          WCT7ST
     I              ADT8ST                          WCT8ST
     I              ADRNSX                          WCRNSX
     I              ADROSX                          WCROSX
     I              ADRPSX                          WCRPSX
     I              ADUVST                          WCUVST
     I              ADUWST                          WCUWST
     I              ADUXST                          WCUXST
     I              ADVSST                          WCVSST
     I              ADAATM                          WCAATM
     I              ADAYNA                          WCAYNA
     I              ADA0NA                          WCA0NA
     I              ADAXDT                          WCAXDT
     I              ADQDSC                          WCQDSC
      *
     I@BZREJR
      * Company Item              Active FinishGood/Wp
      * Renamed input format fields
     I              BZAIC3                          WDAIC3
     I              BZHGCD                          WDHGCD
     I              BZAVNA                          WDAVNA
     I              BZAWNA                          WDAWNA
     I              BZL7NA                          WDL7NA
     I              BZL8NA                          WDL8NA
     I              BZL6NA                          WDL6NA
     I              BZMFNA                          WDMFNA
     I              BZADCD                          WDADCD
     I              BZAWPC                          WDAWPC
     I              BZLXST                          WDLXST
     I              BZAECD                          WDAECD
     I              BZAXPC                          WDAXPC
     I              BZLYST                          WDLYST
     I              BZAFCD                          WDAFCD
     I              BZAICD                          WDAICD
     I              BZAIWG                          WDAIWG
     I              BZHICD                          WDHICD
     I              BZRBCD                          WDRBCD
     I              BZFZST                          WDFZST
     I              BZAVST                          WDAVST
     I              BZCZWG                          WDCZWG
     I              BZC0WG                          WDC0WG
     I              BZURTN                          WDURTN
     I              BZAJC8                          WDAJC8
     I              BZRINB                          WDRINB
     I              BZRHNB                          WDRHNB
     I              BZRGNB                          WDRGNB
     I              BZLNCD                          WDLNCD
     I              BZTFNB                          WDTFNB
     I              BZN0CD                          WDN0CD
     I              BZX4ST                          WDX4ST
     I              BZTMVA                          WDTMVA
     I              BZTNVA                          WDTNVA
     I              BZBLPR                          WDBLPR
     I              BZBMPR                          WDBMPR
     I              BZLRCD                          WDLRCD
     I              BZU9ST                          WDU9ST
     I              BZCMCO                          WDCMCO
     I              BZQ1CD                          WDQ1CD
     I              BZQ8CD                          WDQ8CD
     I              BZCHTM                          WDCHTM
     I              BZQZCD                          WDQZCD
     I              BZXWST                          WDXWST
     I              BZXXST                          WDXXST
     I              BZVMST                          WDVMST
     I              BZSWGH                          WDSWGH
     I              BZPPHE                          WDPPHE
     I              BZR3CD                          WDR3CD
     I              BZSDCD                          WDSDCD
     I              BZICN1                          WDICN1
     I              BZSVCD                          WDSVCD
     I              BZICN2                          WDICN2
     I              BZSWCD                          WDSWCD
     I              BZV2NB                          WDV2NB
     I              BZSXCD                          WDSXCD
     I              BZITCN                          WDITCN
     I              BZSYCD                          WDSYCD
     I              BZITC5                          WDITC5
     I              BZSZCD                          WDSZCD
     I              BZICN6                          WDICN6
     I              BZS0CD                          WDS0CD
     I              BZICN7                          WDICN7
     I              BZS1CD                          WDS1CD
     I              BZICN8                          WDICN8
     I              BZS2CD                          WDS2CD
     I              BZICN9                          WDICN9
     I              BZS3CD                          WDS3CD
     I              BZICN0                          WDICN0
     I              BZS4CD                          WDS4CD
     I              BZSFNB                          WDSFNB
     I              BZA3WG                          WDA3WG
     I              BZSJNB                          WDSJNB
     I              BZLLCD                          WDLLCD
     I              BZLMCD                          WDLMCD
     I              BZP3ST                          WDP3ST
     I              BZSKNB                          WDSKNB
     I              BZSLNB                          WDSLNB
     I              BZSMNB                          WDSMNB
     I              BZP4ST                          WDP4ST
     I              BZCFNB                          WDCFNB
     I              BZCGNB                          WDCGNB
     I              BZILNB                          WDILNB
     I              BZCHNB                          WDCHNB
     I              BZCINB                          WDCINB
     I              BZCJNB                          WDCJNB
     I              BZCMNB                          WDCMNB
     I              BZCNNB                          WDCNNB
     I              BZCRNB                          WDCRNB
     I              BZCSNB                          WDCSNB
     I              BZCVNB                          WDCVNB
     I              BZCWNB                          WDCWNB
     I              BZCXNB                          WDCXNB
     I              BZCZNB                          WDCZNB
     I              BZC0NB                          WDC0NB
     I              BZN1CD                          WDN1CD
     I              BZB4NB                          WDB4NB
     I              BZB5NB                          WDB5NB
     I              BZX5ST                          WDX5ST
     I              BZX6ST                          WDX6ST
     I              BZX7ST                          WDX7ST
     I              BZPCCT                          WDPCCT
     I              BZBDNB                          WDBDNB
     I              BZBJNB                          WDBJNB
     I              BZSUST                          WDSUST
     I              BZSVST                          WDSVST
     I              BZSYST                          WDSYST
     I              BZSZST                          WDSZST
     I              BZS1ST                          WDS1ST
     I              BZXRCD                          WDXRCD
     I              BZXTCD                          WDXTCD
     I              BZXUCD                          WDXUCD
     I              BZF5WG                          WDF5WG
     I              BZF6WG                          WDF6WG
     I              BZF7WG                          WDF7WG
     I              BZBLNB                          WDBLNB
     I              BZBNNB                          WDBNNB
     I              BZS2ST                          WDS2ST
     I              BZS4ST                          WDS4ST
     I              BZS5ST                          WDS5ST
     I              BZS6ST                          WDS6ST
     I              BZS8ST                          WDS8ST
     I              BZS9ST                          WDS9ST
     I              BZTCST                          WDTCST
     I              BZTDST                          WDTDST
     I              BZUVST                          WDUVST
     I              BZUWST                          WDUWST
     I              BZUXST                          WDUXST
     I              BZVSST                          WDVSST
     I              BZAATM                          WDAATM
     I              BZAYNA                          WDAYNA
     I              BZA0NA                          WDA0NA
     I              BZAXDT                          WDAXDT
      *
     I@B0REYY
      * Item Balance              Acitve records only
      * Renamed input format fields
     I              B0AIC3                          WEAIC3
     I              B0HGCD                          WEHGCD
     I              B0AJCD                          WEAJCD
     I              B0AGCS                          WEAGCS
     I              B0AECS                          WEAECS
     I              B0BACS                          WEBACS
     I              B0BBCS                          WEBBCS
     I              B0CBPR                          WECBPR
     I              B0GUDT                          WEGUDT
     I              B0XYST                          WEXYST
     I              B0CTPR                          WECTPR
     I              B0G4DT                          WEG4DT
     I              B0BOWG                          WEBOWG
     I              B0DDQT                          WEDDQT
     I              B0DEQT                          WEDEQT
     I              B0DFQT                          WEDFQT
     I              B0HDQT                          WEHDQT
     I              B0HEQT                          WEHEQT
     I              B0AJQT                          WEAJQT
     I              B0AQQT                          WEAQQT
     I              B0AUQT                          WEAUQT
     I              B0EMQT                          WEEMQT
     I              B0DOQT                          WEDOQT
     I              B0ATNA                          WEATNA
     I              B0AKDT                          WEAKDT
     I              B0ANDT                          WEANDT
     I              B0IDVA                          WEIDVA
     I              B0JVST                          WEJVST
     I              B0BZPC                          WEBZPC
     I              B0DGQT                          WEDGQT
     I              B0DIDT                          WEDIDT
     I              B0ALCD                          WEALCD
     I              B0BFDY                          WEBFDY
     I              B0DJDT                          WEDJDT
     I              B0BGDY                          WEBGDY
     I              B0DKDT                          WEDKDT
     I              B0J2ST                          WEJ2ST
     I              B0DJQT                          WEDJQT
     I              B0BNWG                          WEBNWG
     I              B0DLDT                          WEDLDT
     I              B0DPQT                          WEDPQT
     I              B0DQQT                          WEDQQT
     I              B0DMDT                          WEDMDT
     I              B0M0ST                          WEM0ST
     I              B0J9ST                          WEJ9ST
     I              B0KBST                          WEKBST
     I              B0AKC8                          WEAKC8
     I              B0RINB                          WERINB
     I              B0RHNB                          WERHNB
     I              B0RGNB                          WERGNB
     I              B0UVST                          WEUVST
     I              B0UWST                          WEUWST
     I              B0UXST                          WEUXST
     I              B0VSST                          WEVSST
     I              B0AATM                          WEAATM
     I              B0AYNA                          WEAYNA
     I              B0A0NA                          WEA0NA
     I              B0AXDT                          WEAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WFAIC3
     I              BEC4NB                          WFC4NB
     I              BEJNCD                          WFJNCD
     I              BEANC7                          WFANC7
     I              BEBKC7                          WFBKC7
     I              BEBRTX                          WFBRTX
     I              BEHMNA                          WFHMNA
     I              BEHONA                          WFHONA
     I              BEHPNA                          WFHPNA
     I              BEHNNA                          WFHNNA
     I              BEDBCD                          WFDBCD
     I              BECKTX                          WFCKTX
     I              BEB0C7                          WFB0C7
     I              BEAETX                          WFAETX
     I              BEB1NA                          WFB1NA
     I              BEB3NA                          WFB3NA
     I              BEB4NA                          WFB4NA
     I              BEB2NA                          WFB2NA
     I              BEBHCD                          WFBHCD
     I              BEC8TX                          WFC8TX
     I              BEBCNA                          WFBCNA
     I              BEA0DT                          WFA0DT
     I              BEA5DT                          WFA5DT
     I              BEGNDT                          WFGNDT
     I              BEACDT                          WFACDT
     I              BEAQCD                          WFAQCD
     I              BEB6NA                          WFB6NA
     I              BEBYNA                          WFBYNA
     I              BEBZNA                          WFBZNA
     I              BEGTST                          WFGTST
     I              BEGVST                          WFGVST
     I              BEGUST                          WFGUST
     I              BEQFST                          WFQFST
     I              BECQCD                          WFCQCD
     I              BEGJST                          WFGJST
     I              BEGWST                          WFGWST
     I              BEGXST                          WFGXST
     I              BEGYST                          WFGYST
     I              BEAODT                          WFAODT
     I              BEAIVN                          WFAIVN
     I              BECXDT                          WFCXDT
     I              BEJZVA                          WFJZVA
     I              BEA1WG                          WFA1WG
     I              BEXIST                          WFXIST
     I              BEXJST                          WFXJST
     I              BEXKST                          WFXKST
     I              BEEIDT                          WFEIDT
     I              BEAFTM                          WFAFTM
     I              BEE8CD                          WFE8CD
     I              BEE9CD                          WFE9CD
     I              BERMNB                          WFRMNB
     I              BETBNB                          WFTBNB
     I              BER1NB                          WFR1NB
     I              BEPJST                          WFPJST
     I              BEU0ST                          WFU0ST
     I              BEU1ST                          WFU1ST
     I              BEQ2CD                          WFQ2CD
     I              BEU2ST                          WFU2ST
     I              BEVEST                          WFVEST
     I              BEVFST                          WFVFST
     I              BEVGST                          WFVGST
     I              BERPCD                          WFRPCD
     I              BERNNB                          WFRNNB
     I              BEVDST                          WFVDST
     I              BEATIN                          WFATIN
     I              BEU4ST                          WFU4ST
     I              BEU5ST                          WFU5ST
     I              BERSRN                          WFRSRN
     I              BEMHNA                          WFMHNA
     I              BEMINA                          WFMINA
     I              BEWBST                          WFWBST
     I              BER4CD                          WFR4CD
     I              BEBFCD                          WFBFCD
     I              BEQ4CD                          WFQ4CD
     I              BET3NB                          WFT3NB
     I              BESICD                          WFSICD
     I              BECONB                          WFCONB
     I              BECEST                          WFCEST
     I              BEAWDT                          WFAWDT
     I              BEJPCD                          WFJPCD
     I              BEXUST                          WFXUST
     I              BEZ1ST                          WFZ1ST
     I              BEVRVA                          WFVRVA
     I              BEOBST                          WFOBST
     I              BEBCST                          WFBCST
     I              BEBDST                          WFBDST
     I              BEB7VL                          WFB7VL
     I              BEGASX                          WFGASX
     I              BEGBSX                          WFGBSX
     I              BEGCSX                          WFGCSX
     I              BEGDSX                          WFGDSX
     I              BEFNSX                          WFFNSX
     I              BEFOSX                          WFFOSX
     I              BEFPSX                          WFFPSX
     I              BEFQSX                          WFFQSX
     I              BEFRSX                          WFFRSX
     I              BEFSSX                          WFFSSX
     I              BEFTSX                          WFFTSX
     I              BEFUSX                          WFFUSX
     I              BEFVSX                          WFFVSX
     I              BEFWSX                          WFFWSX
     I              BEFXSX                          WFFXSX
     I              BEFYSX                          WFFYSX
     I              BENODT                          WFNODT
     I              BENPDT                          WFNPDT
     I              BENQDT                          WFNQDT
     I              BENRDT                          WFNRDT
     I              BENSDT                          WFNSDT
     I              BEBPTM                          WFBPTM
     I              BEBQTM                          WFBQTM
     I              BEBRTM                          WFBRTM
     I              BEBSTM                          WFBSTM
     I              BEBTTM                          WFBTTM
     I              BEH0NX                          WFH0NX
     I              BEH1NX                          WFH1NX
     I              BEH2NX                          WFH2NX
     I              BEH3NX                          WFH3NX
     I              BEH4NX                          WFH4NX
     I              BEC0C7                          WFC0C7
     I              BEUVST                          WFUVST
     I              BEUWST                          WFUWST
     I              BEUXST                          WFUXST
     I              BEAATM                          WFAATM
     I              BEAYNA                          WFAYNA
     I              BEA0NA                          WFA0NA
     I              BEAXDT                          WFAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WGAIC3
     I              OMC4NB                          WGC4NB
     I              OMDPNB                          WGDPNB
     I              OMUENB                          WGUENB
     I              OMHGCD                          WGHGCD
     I              OMAJCD                          WGAJCD
     I              OMBKC7                          WGBKC7
     I              OMCFC7                          WGCFC7
     I              OMGMST                          WGGMST
     I              OMGNST                          WGGNST
     I              OMMAVA                          WGMAVA
     I              OMKDVA                          WGKDVA
     I              OML8VA                          WGL8VA
     I              OML9VA                          WGL9VA
     I              OMGTST                          WGGTST
     I              OMGVST                          WGGVST
     I              OMGUST                          WGGUST
     I              OMQFST                          WGQFST
     I              OMAYVA                          WGAYVA
     I              OMEXDT                          WGEXDT
     I              OMLQCD                          WGLQCD
     I              OMRDCD                          WGRDCD
     I              OMQ7CD                          WGQ7CD
     I              OMBZPR                          WGBZPR
     I              OML6NB                          WGL6NB
     I              OMU1ST                          WGU1ST
     I              OMGIDT                          WGGIDT
     I              OMCRCD                          WGCRCD
     I              OMAGCD                          WGAGCD
     I              OMRZST                          WGRZST
     I              OMR0ST                          WGR0ST
     I              OMR1ST                          WGR1ST
     I              OMG7NA                          WGG7NA
     I              OMG8NA                          WGG8NA
     I              OMRPCD                          WGRPCD
     I              OMVEST                          WGVEST
     I              OMVGST                          WGVGST
     I              OMAVST                          WGAVST
     I              OMU0ST                          WGU0ST
     I              OMRFCD                          WGRFCD
     I              OMFZST                          WGFZST
     I              OMR1NB                          WGR1NB
     I              OMAVQT                          WGAVQT
     I              OMD0WG                          WGD0WG
     I              OMCCQT                          WGCCQT
     I              OMAUWG                          WGAUWG
     I              OMCBQT                          WGCBQT
     I              OMATWG                          WGATWG
     I              OMAQCS                          WGAQCS
     I              OMAGCS                          WGAGCS
     I              OMAKPR                          WGAKPR
     I              OMALPR                          WGALPR
     I              OMAUPR                          WGAUPR
     I              OMAVWG                          WGAVWG
     I              OMA4WG                          WGA4WG
     I              OMA5DT                          WGA5DT
     I              OMAODT                          WGAODT
     I              OMGNDT                          WGGNDT
     I              OMAMST                          WGAMST
     I              OMANST                          WGANST
     I              OMVAST                          WGVAST
     I              OMRGNB                          WGRGNB
     I              OMRHNB                          WGRHNB
     I              OMRINB                          WGRINB
     I              OMRBCD                          WGRBCD
     I              OMHICD                          WGHICD
     I              OMRNCD                          WGRNCD
     I              OMROCD                          WGROCD
     I              OMCXDT                          WGCXDT
     I              OMAJVN                          WGAJVN
     I              OMKXCD                          WGKXCD
     I              OMJPCD                          WGJPCD
     I              OMCQCD                          WGCQCD
     I              OMR4CD                          WGR4CD
     I              OMZ1ST                          WGZ1ST
     I              OMZ3ST                          WGZ3ST
     I              OMZ4ST                          WGZ4ST
     I              OMDUPR                          WGDUPR
     I              OMB6VL                          WGB6VL
     I              OMA1AA                          WGA1AA
     I              OMFZSX                          WGFZSX
     I              OMF0SX                          WGF0SX
     I              OMF1SX                          WGF1SX
     I              OMF2SX                          WGF2SX
     I              OMF3SX                          WGF3SX
     I              OMF4SX                          WGF4SX
     I              OMF5SX                          WGF5SX
     I              OMF6SX                          WGF6SX
     I              OMF7SX                          WGF7SX
     I              OMNTDT                          WGNTDT
     I              OMNUDT                          WGNUDT
     I              OMNVDT                          WGNVDT
     I              OMNWDT                          WGNWDT
     I              OMNXDT                          WGNXDT
     I              OMBUTM                          WGBUTM
     I              OMBVTM                          WGBVTM
     I              OMBWTM                          WGBWTM
     I              OMBXTM                          WGBXTM
     I              OMBYTM                          WGBYTM
     I              OMH5NX                          WGH5NX
     I              OMH6NX                          WGH6NX
     I              OMH7NX                          WGH7NX
     I              OMH8NX                          WGH8NX
     I              OMH9NX                          WGH9NX
     I              OMDVPR                          WGDVPR
     I              OMDWPR                          WGDWPR
     I              OMDXPR                          WGDXPR
     I              OMDYPR                          WGDYPR
     I              OMDZPR                          WGDZPR
     I              OMGSPR                          WGGSPR
     I              OMGTPR                          WGGTPR
     I              OMGUPR                          WGGUPR
     I              OMHOST                          WGHOST
     I              OMHPST                          WGHPST
     I              OMIOST                          WGIOST
     I              OMPEWG                          WGPEWG
     I              OMRINY                          WGRINY
     I              OMTIDT                          WGTIDT
     I              OMTJDT                          WGTJDT
     I              OMH2ST                          WGH2ST
     I              OMH0ST                          WGH0ST
     I              OMH1ST                          WGH1ST
     I              OMTKDT                          WGTKDT
     I              OMTLDT                          WGTLDT
     I              OMTMDT                          WGTMDT
     I              OMUVST                          WGUVST
     I              OMUWST                          WGUWST
     I              OMUXST                          WGUXST
     I              OMAATM                          WGAATM
     I              OMAYNA                          WGAYNA
     I              OMA0NA                          WGA0NA
     I              OMAXDT                          WGAXDT
      *
     I@FNCPAZ
      * Manifest Detail           Co/Ord/Seq/Seq2/Srl#/LDt
      * Renamed input format fields
     I              FNAIC3                          WHAIC3
     I              FNC4NB                          WHC4NB
     I              FNDPNB                          WHDPNB
     I              FNUENB                          WHUENB
     I              FNRZNB                          WHRZNB
     I              FNFOQT                          WHFOQT
     I              FNR0NB                          WHR0NB
     I              FNPMST                          WHPMST
     I              FNK7DT                          WHK7DT
     I              FNPFNX                          WHPFNX
     I              FNHGCD                          WHHGCD
     I              FNAJCD                          WHAJCD
     I              FNELDT                          WHELDT
     I              FNN5WG                          WHN5WG
     I              FNRZNA                          WHRZNA
     I              FNH5NY                          WHH5NY
     I              FNH6NY                          WHH6NY
     I              FNH7NY                          WHH7NY
     I              FNGBTX                          WHGBTX
     I              FNN6WG                          WHN6WG
     I              FNN7WG                          WHN7WG
     I              FNGCTX                          WHGCTX
     I              FNGDTX                          WHGDTX
     I              FNRBDT                          WHRBDT
     I              FNITNY                          WHITNY
     I              FNIVNY                          WHIVNY
     I              FNIUNY                          WHIUNY
     I              FNIWNY                          WHIWNY
     I              FNIXNY                          WHIXNY
     I              FNIYNY                          WHIYNY
     I              FNUVST                          WHUVST
     I              FNUWST                          WHUWST
     I              FNUXST                          WHUXST
     I              FNVSST                          WHVSST
     I              FNAATM                          WHAATM
     I              FNAYNA                          WHAYNA
     I              FNA0NA                          WHA0NA
     I              FNAXDT                          WHAXDT
     I              FNLPNZ                          WHLPNZ
      *
     I@KMREHC
      * Company Values            Retrieval index
      * Renamed input format fields
     I              KMAIC3                          WIAIC3
     I              KMV8CD                          WIV8CD
     I              KMAUNA                          WIAUNA
     I              KMI5ST                          WII5ST
     I              KMBXTX                          WIBXTX
     I              KMM8NB                          WIM8NB
     I              KMUVST                          WIUVST
     I              KMUWST                          WIUWST
     I              KMUXST                          WIUXST
     I              KMVSST                          WIVSST
     I              KMAATM                          WIAATM
     I              KMAYNA                          WIAYNA
     I              KMA0NA                          WIA0NA
     I              KMAXDT                          WIAXDT
      *
     I@BGCPF0
      * PFS Inventory Adjustment  Co/Item/Serial/TrTyp,sel
      * Renamed input format fields
     I              BGY1NX                          WJY1NX
     I              BGC0NY                          WJC0NY
     I              BGAID8                          WJAID8
     I              BGAFTS                          WJAFTS
     I              BGBCNY                          WJBCNY
     I              BGVLSX                          WJVLSX
     I              BGVMSX                          WJVMSX
     I              BGY2NX                          WJY2NX
     I              BGU4SX                          WJU4SX
     I              BGADNY                          WJADNY
     I              BGU1SX                          WJU1SX
     I              BGP7DT                          WJP7DT
     I              BGZ4NX                          WJZ4NX
     I              BGACNY                          WJACNY
     I              BGVKSX                          WJVKSX
     I              BGZ2NX                          WJZ2NX
     I              BGZ6NX                          WJZ6NX
     I              BGBDNY                          WJBDNY
     I              BGABNY                          WJABNY
     I              BGBENY                          WJBENY
     I              BGZ9NX                          WJZ9NX
     I              BGGBAA                          WJGBAA
     I              BGANNY                          WJANNY
     I              BGZPNX                          WJZPNX
     I              BGZXNX                          WJZXNX
     I              BGZYNX                          WJZYNX
     I              BGALNY                          WJALNY
     I              BGAGNY                          WJAGNY
     I              BGUWSX                          WJUWSX
     I              BGUXSX                          WJUXSX
     I              BGV3SX                          WJV3SX
     I              BGAHNY                          WJAHNY
     I              BGAINY                          WJAINY
     I              BGAJNY                          WJAJNY
     I              BGAKNY                          WJAKNY
      *
     I@ADREAO
      * Warehouse Codes           Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WKAJCD
     I              ADF8NA                          WKF8NA
     I              ADACNA                          WKACNA
     I              ADADNA                          WKADNA
     I              ADAENA                          WKAENA
     I              ADAJNA                          WKAJNA
     I              ADBTTX                          WKBTTX
     I              ADAOCD                          WKAOCD
     I              ADBGCD                          WKBGCD
     I              ADVHST                          WKVHST
     I              ADMPNA                          WKMPNA
     I              ADWPST                          WKWPST
     I              ADXUST                          WKXUST
     I              ADT0ST                          WKT0ST
     I              ADT1ST                          WKT1ST
     I              ADDBNB                          WKDBNB
     I              ADT2ST                          WKT2ST
     I              ADT3ST                          WKT3ST
     I              ADT4ST                          WKT4ST
     I              ADT6ST                          WKT6ST
     I              ADBWC3                          WKBWC3
     I              ADBTC3                          WKBTC3
     I              ADBUC3                          WKBUC3
     I              ADBVC3                          WKBVC3
     I              ADFCAA                          WKFCAA
     I              ADRQSX                          WKRQSX
     I              ADRRSX                          WKRRSX
     I              ADRSSX                          WKRSSX
     I              ADRTSX                          WKRTSX
     I              ADT7ST                          WKT7ST
     I              ADT8ST                          WKT8ST
     I              ADRNSX                          WKRNSX
     I              ADROSX                          WKROSX
     I              ADRPSX                          WKRPSX
     I              ADUVST                          WKUVST
     I              ADUWST                          WKUWST
     I              ADUXST                          WKUXST
     I              ADVSST                          WKVSST
     I              ADAATM                          WKAATM
     I              ADAYNA                          WKAYNA
     I              ADA0NA                          WKA0NA
     I              ADAXDT                          WKAXDT
     I              ADQDSC                          WKQDSC
      *
     I@B2CPT3
      * Product Trace             Co/Srl#/LDte
      * Renamed input format fields
     I              B2AIC3                          WLAIC3
     I              B2PFNX                          WLPFNX
     I              B2AADX                          WLAADX
     I              B2B9TM                          WLB9TM
     I              B2ADDX                          WLADDX
     I              B2ABDX                          WLABDX
     I              B2CATM                          WLCATM
     I              B2MNSX                          WLMNSX
     I              B2JOWG                          WLJOWG
     I              B2JPWG                          WLJPWG
     I              B2MOSX                          WLMOSX
     I              B2DNAA                          WLDNAA
     I              B2PGNX                          WLPGNX
     I              B2BTT1                          WLBTT1
     I              B2D7C7                          WLD7C7
     I              B2PYNA                          WLPYNA
     I              B2PZNA                          WLPZNA
     I              B2MPSX                          WLMPSX
     I              B2CCT1                          WLCCT1
     I              B2PHNX                          WLPHNX
     I              B2MQSX                          WLMQSX
     I              B2DOAA                          WLDOAA
     I              B2BUT1                          WLBUT1
     I              B2DYAA                          WLDYAA
     I              B2BVT1                          WLBVT1
     I              B2DPAA                          WLDPAA
     I              B2DQAA                          WLDQAA
     I              B2BZT1                          WLBZT1
     I              B2BWT1                          WLBWT1
     I              B2DRAA                          WLDRAA
     I              B2B9T1                          WLB9T1
     I              B2DSAA                          WLDSAA
     I              B2B8T1                          WLB8T1
     I              B2D4AA                          WLD4AA
     I              B2EPAA                          WLEPAA
     I              B2EQAA                          WLEQAA
     I              B2ERAA                          WLERAA
     I              B2ESAA                          WLESAA
     I              B2PNSX                          WLPNSX
     I              B2UFNX                          WLUFNX
     I              B2UGNX                          WLUGNX
     I              B2UHNX                          WLUHNX
     I              B2AGDX                          WLAGDX
     I              B2CGTM                          WLCGTM
     I              B2POSX                          WLPOSX
     I              B2PPSX                          WLPPSX
     I              B2UINX                          WLUINX
     I              B2UJNX                          WLUJNX
     I              B2UKNX                          WLUKNX
     I              B2ULNX                          WLULNX
     I              B2PRSX                          WLPRSX
     I              B2PSSX                          WLPSSX
     I              B2AATM                          WLAATM
     I              B2AYNA                          WLAYNA
     I              B2A0NA                          WLA0NA
     I              B2AXDT                          WLAXDT
      *
     I@AARETD
      * Product Trace Line Scale  Co/ScaleID/Dte(d)
      * Renamed input format fields
     I              AAAIC3                          WMAIC3
     I              AAFAAA                          WMFAAA
     I              AAPUDT                          WMPUDT
     I              AAUXNX                          WMUXNX
     I              AAUVST                          WMUVST
     I              AAUWST                          WMUWST
     I              AAUXST                          WMUXST
     I              AAVSST                          WMVSST
     I              AAAATM                          WMAATM
     I              AAAYNA                          WMAYNA
     I              AAA0NA                          WMA0NA
     I              AAAXDT                          WMAXDT
      *
     I@ABRETA
      * Product Trace Line        Retrieval index
      * Renamed input format fields
     I              ABAIC3                          WOAIC3
     I              ABFAAA                          WOFAAA
     I              ABQQNA                          WOQQNA
     I              ABPINX                          WOPINX
     I              ABMUSX                          WOMUSX
     I              ABM9SX                          WOM9SX
     I              ABUVST                          WOUVST
     I              ABUWST                          WOUWST
     I              ABUXST                          WOUXST
     I              ABVSST                          WOVSST
     I              ABAATM                          WOAATM
     I              ABAYNA                          WOAYNA
     I              ABA0NA                          WOA0NA
     I              ABAXDT                          WOAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WRAIC3
     I              BZHGCD                          WRHGCD
     I              BZAVNA                          WRAVNA
     I              BZAWNA                          WRAWNA
     I              BZL7NA                          WRL7NA
     I              BZL8NA                          WRL8NA
     I              BZL6NA                          WRL6NA
     I              BZMFNA                          WRMFNA
     I              BZADCD                          WRADCD
     I              BZAWPC                          WRAWPC
     I              BZLXST                          WRLXST
     I              BZAECD                          WRAECD
     I              BZAXPC                          WRAXPC
     I              BZLYST                          WRLYST
     I              BZAFCD                          WRAFCD
     I              BZAICD                          WRAICD
     I              BZAIWG                          WRAIWG
     I              BZHICD                          WRHICD
     I              BZRBCD                          WRRBCD
     I              BZFZST                          WRFZST
     I              BZAVST                          WRAVST
     I              BZCZWG                          WRCZWG
     I              BZC0WG                          WRC0WG
     I              BZURTN                          WRURTN
     I              BZAJC8                          WRAJC8
     I              BZRINB                          WRRINB
     I              BZRHNB                          WRRHNB
     I              BZRGNB                          WRRGNB
     I              BZLNCD                          WRLNCD
     I              BZTFNB                          WRTFNB
     I              BZN0CD                          WRN0CD
     I              BZX4ST                          WRX4ST
     I              BZTMVA                          WRTMVA
     I              BZTNVA                          WRTNVA
     I              BZBLPR                          WRBLPR
     I              BZBMPR                          WRBMPR
     I              BZLRCD                          WRLRCD
     I              BZU9ST                          WRU9ST
     I              BZCMCO                          WRCMCO
     I              BZQ1CD                          WRQ1CD
     I              BZQ8CD                          WRQ8CD
     I              BZCHTM                          WRCHTM
     I              BZQZCD                          WRQZCD
     I              BZXWST                          WRXWST
     I              BZXXST                          WRXXST
     I              BZVMST                          WRVMST
     I              BZSWGH                          WRSWGH
     I              BZPPHE                          WRPPHE
     I              BZR3CD                          WRR3CD
     I              BZSDCD                          WRSDCD
     I              BZICN1                          WRICN1
     I              BZSVCD                          WRSVCD
     I              BZICN2                          WRICN2
     I              BZSWCD                          WRSWCD
     I              BZV2NB                          WRV2NB
     I              BZSXCD                          WRSXCD
     I              BZITCN                          WRITCN
     I              BZSYCD                          WRSYCD
     I              BZITC5                          WRITC5
     I              BZSZCD                          WRSZCD
     I              BZICN6                          WRICN6
     I              BZS0CD                          WRS0CD
     I              BZICN7                          WRICN7
     I              BZS1CD                          WRS1CD
     I              BZICN8                          WRICN8
     I              BZS2CD                          WRS2CD
     I              BZICN9                          WRICN9
     I              BZS3CD                          WRS3CD
     I              BZICN0                          WRICN0
     I              BZS4CD                          WRS4CD
     I              BZSFNB                          WRSFNB
     I              BZA3WG                          WRA3WG
     I              BZSJNB                          WRSJNB
     I              BZLLCD                          WRLLCD
     I              BZLMCD                          WRLMCD
     I              BZP3ST                          WRP3ST
     I              BZSKNB                          WRSKNB
     I              BZSLNB                          WRSLNB
     I              BZSMNB                          WRSMNB
     I              BZP4ST                          WRP4ST
     I              BZCFNB                          WRCFNB
     I              BZCGNB                          WRCGNB
     I              BZILNB                          WRILNB
     I              BZCHNB                          WRCHNB
     I              BZCINB                          WRCINB
     I              BZCJNB                          WRCJNB
     I              BZCMNB                          WRCMNB
     I              BZCNNB                          WRCNNB
     I              BZCRNB                          WRCRNB
     I              BZCSNB                          WRCSNB
     I              BZCVNB                          WRCVNB
     I              BZCWNB                          WRCWNB
     I              BZCXNB                          WRCXNB
     I              BZCZNB                          WRCZNB
     I              BZC0NB                          WRC0NB
     I              BZN1CD                          WRN1CD
     I              BZB4NB                          WRB4NB
     I              BZB5NB                          WRB5NB
     I              BZX5ST                          WRX5ST
     I              BZX6ST                          WRX6ST
     I              BZX7ST                          WRX7ST
     I              BZPCCT                          WRPCCT
     I              BZBDNB                          WRBDNB
     I              BZBJNB                          WRBJNB
     I              BZSUST                          WRSUST
     I              BZSVST                          WRSVST
     I              BZSYST                          WRSYST
     I              BZSZST                          WRSZST
     I              BZS1ST                          WRS1ST
     I              BZXRCD                          WRXRCD
     I              BZXTCD                          WRXTCD
     I              BZXUCD                          WRXUCD
     I              BZF5WG                          WRF5WG
     I              BZF6WG                          WRF6WG
     I              BZF7WG                          WRF7WG
     I              BZBLNB                          WRBLNB
     I              BZBNNB                          WRBNNB
     I              BZS2ST                          WRS2ST
     I              BZS4ST                          WRS4ST
     I              BZS5ST                          WRS5ST
     I              BZS6ST                          WRS6ST
     I              BZS8ST                          WRS8ST
     I              BZS9ST                          WRS9ST
     I              BZTCST                          WRTCST
     I              BZTDST                          WRTDST
     I              BZUVST                          WRUVST
     I              BZUWST                          WRUWST
     I              BZUXST                          WRUXST
     I              BZVSST                          WRVSST
     I              BZAATM                          WRAATM
     I              BZAYNA                          WRAYNA
     I              BZA0NA                          WRA0NA
     I              BZAXDT                          WRAXDT
      *
     I@B2CPMP
      * Product Trace             Update index
      * Renamed input format fields
     I              B2AIC3                          WSAIC3
     I              B2PFNX                          WSPFNX
     I              B2AADX                          WSAADX
     I              B2B9TM                          WSB9TM
     I              B2ADDX                          WSADDX
     I              B2ABDX                          WSABDX
     I              B2CATM                          WSCATM
     I              B2MNSX                          WSMNSX
     I              B2JOWG                          WSJOWG
     I              B2JPWG                          WSJPWG
     I              B2MOSX                          WSMOSX
     I              B2DNAA                          WSDNAA
     I              B2PGNX                          WSPGNX
     I              B2BTT1                          WSBTT1
     I              B2D7C7                          WSD7C7
     I              B2PYNA                          WSPYNA
     I              B2PZNA                          WSPZNA
     I              B2MPSX                          WSMPSX
     I              B2CCT1                          WSCCT1
     I              B2PHNX                          WSPHNX
     I              B2MQSX                          WSMQSX
     I              B2DOAA                          WSDOAA
     I              B2BUT1                          WSBUT1
     I              B2DYAA                          WSDYAA
     I              B2BVT1                          WSBVT1
     I              B2DPAA                          WSDPAA
     I              B2DQAA                          WSDQAA
     I              B2BZT1                          WSBZT1
     I              B2BWT1                          WSBWT1
     I              B2DRAA                          WSDRAA
     I              B2B9T1                          WSB9T1
     I              B2DSAA                          WSDSAA
     I              B2B8T1                          WSB8T1
     I              B2D4AA                          WSD4AA
     I              B2EPAA                          WSEPAA
     I              B2EQAA                          WSEQAA
     I              B2ERAA                          WSERAA
     I              B2ESAA                          WSESAA
     I              B2PNSX                          WSPNSX
     I              B2UFNX                          WSUFNX
     I              B2UGNX                          WSUGNX
     I              B2UHNX                          WSUHNX
     I              B2AGDX                          WSAGDX
     I              B2CGTM                          WSCGTM
     I              B2POSX                          WSPOSX
     I              B2PPSX                          WSPPSX
     I              B2UINX                          WSUINX
     I              B2UJNX                          WSUJNX
     I              B2UKNX                          WSUKNX
     I              B2ULNX                          WSULNX
     I              B2PRSX                          WSPRSX
     I              B2PSSX                          WSPSSX
     I              B2AATM                          WSAATM
     I              B2AYNA                          WSAYNA
     I              B2A0NA                          WSA0NA
     I              B2AXDT                          WSAXDT
      *
     I@L5CPSL
      * Item Lot Location         Update index
      * Renamed input format fields
     I              L5AIC3                          WTAIC3
     I              L5HGCD                          WTHGCD
     I              L5AJCD                          WTAJCD
     I              L5ELDT                          WTELDT
     I              L5LXNM                          WTLXNM
     I              L5YMCD                          WTYMCD
     I              L5YNCD                          WTYNCD
     I              L5J2QT                          WTJ2QT
     I              L5G5WG                          WTG5WG
     I              L5J3QT                          WTJ3QT
     I              L5G6WG                          WTG6WG
     I              L5J4QT                          WTJ4QT
     I              L5G7WG                          WTG7WG
     I              L5LODT                          WTLODT
     I              L5LPDT                          WTLPDT
     I              L5LQDT                          WTLQDT
     I              L5NBR                           WTNBR
     I              L5YTCD                          WTYTCD
     I              L5AMSX                          WTAMSX
     I              L5ASSX                          WTASSX
     I              L5ATSX                          WTATSX
     I              L5AUSX                          WTAUSX
     I              L5YSCD                          WTYSCD
     I              L5UVST                          WTUVST
     I              L5UWST                          WTUWST
     I              L5UXST                          WTUXST
     I              L5VSST                          WTVSST
     I              L5AATM                          WTAATM
     I              L5AYNA                          WTAYNA
     I              L5A0NA                          WTA0NA
     I              L5AXDT                          WTAXDT
      *
     I@L2RESM
      * Warehouse Location        Retrieval index
      * Renamed input format fields
     I              L2AJCD                          WVAJCD
     I              L2YMCD                          WVYMCD
     I              L2YPCD                          WVYPCD
     I              L2LCBY                          WVLCBY
     I              L2LCCT                          WVLCCT
     I              L2WLUS                          WVWLUS
     I              L2WUSD                          WVWUSD
     I              L2WLUN                          WVWLUN
     I              L2AGSX                          WVAGSX
     I              L2UVST                          WVUVST
     I              L2UWST                          WVUWST
     I              L2UXST                          WVUXST
     I              L2VSST                          WVVSST
     I              L2AATM                          WVAATM
     I              L2AYNA                          WVAYNA
     I              L2A0NA                          WVA0NA
     I              L2AXDT                          WVAXDT
      *
     I@L3RET8
      * Warehouse Location Type   Retrieval index
      * Renamed input format fields
     I              MEAGSX                          WWAGSX
     I              MEOPNA                          WWOPNA
     I              MESLTY                          WWSLTY
     I              MEAHSX                          WWAHSX
     I              MEAISX                          WWAISX
     I              MEUVST                          WWUVST
     I              MEUWST                          WWUWST
     I              MEUXST                          WWUXST
     I              MEVSST                          WWVSST
     I              MEAATM                          WWAATM
     I              MEAYNA                          WWAYNA
     I              MEA0NA                          WWA0NA
     I              MEAXDT                          WWAXDT
      *
     I@L5CPSV
      * Item Lot Location         Retrieval index
      * Renamed input format fields
     I              L5AIC3                          WXAIC3
     I              L5HGCD                          WXHGCD
     I              L5AJCD                          WXAJCD
     I              L5ELDT                          WXELDT
     I              L5LXNM                          WXLXNM
     I              L5YMCD                          WXYMCD
     I              L5YNCD                          WXYNCD
     I              L5J2QT                          WXJ2QT
     I              L5G5WG                          WXG5WG
     I              L5J3QT                          WXJ3QT
     I              L5G6WG                          WXG6WG
     I              L5J4QT                          WXJ4QT
     I              L5G7WG                          WXG7WG
     I              L5LODT                          WXLODT
     I              L5LPDT                          WXLPDT
     I              L5LQDT                          WXLQDT
     I              L5NBR                           WXNBR
     I              L5YTCD                          WXYTCD
     I              L5AMSX                          WXAMSX
     I              L5ASSX                          WXASSX
     I              L5ATSX                          WXATSX
     I              L5AUSX                          WXAUSX
     I              L5YSCD                          WXYSCD
     I              L5UVST                          WXUVST
     I              L5UWST                          WXUWST
     I              L5UXST                          WXUXST
     I              L5VSST                          WXVSST
     I              L5AATM                          WXAATM
     I              L5AYNA                          WXAYNA
     I              L5A0NA                          WXA0NA
     I              L5AXDT                          WXAXDT
      *
     I@L7CPUK
      * Item Lot Loc Trans        Co/Itm/Whs/Typ/Dte/Sq(d)
      * Renamed input format fields
     I              L7AIC3                          WYAIC3
     I              L7HGCD                          WYHGCD
     I              L7AJCD                          WYAJCD
     I              L7LTRT                          WYLTRT
     I              L7LRDT                          WYLRDT
     I              L7LLTS                          WYLLTS
     I              L7LSDT                          WYLSDT
     I              L7J5QT                          WYJ5QT
     I              L7G8WG                          WYG8WG
     I              L7LLTN                          WYLLTN
     I              L7YMCD                          WYYMCD
     I              L7LLCL                          WYLLCL
     I              L7BNAA                          WYBNAA
     I              L7LLTR                          WYLLTR
     I              L7Y2CD                          WYY2CD
     I              L7LLTL                          WYLLTL
     I              L7C4NB                          WYC4NB
     I              L7LOST                          WYLOST
     I              L7LLTU                          WYLLTU
     I              L7LLYT                          WYLLYT
     I              L7UVST                          WYUVST
     I              L7UWST                          WYUWST
     I              L7UXST                          WYUXST
     I              L7VSST                          WYVSST
     I              L7AATM                          WYAATM
     I              L7AYNA                          WYAYNA
     I              L7A0NA                          WYA0NA
     I              L7AXDT                          WYAXDT
      *
     I@L7CPS3
      * Item Lot Loc Trans        Update index
      * Renamed input format fields
     I              L7AIC3                          TAAIC3
     I              L7HGCD                          TAHGCD
     I              L7AJCD                          TAAJCD
     I              L7LTRT                          TALTRT
     I              L7LRDT                          TALRDT
     I              L7LLTS                          TALLTS
     I              L7LSDT                          TALSDT
     I              L7J5QT                          TAJ5QT
     I              L7G8WG                          TAG8WG
     I              L7LLTN                          TALLTN
     I              L7YMCD                          TAYMCD
     I              L7LLCL                          TALLCL
     I              L7BNAA                          TABNAA
     I              L7LLTR                          TALLTR
     I              L7Y2CD                          TAY2CD
     I              L7LLTL                          TALLTL
     I              L7C4NB                          TAC4NB
     I              L7LOST                          TALOST
     I              L7LLTU                          TALLTU
     I              L7LLYT                          TALLYT
     I              L7UVST                          TAUVST
     I              L7UWST                          TAUWST
     I              L7UXST                          TAUXST
     I              L7VSST                          TAVSST
     I              L7AATM                          TAAATM
     I              L7AYNA                          TAAYNA
     I              L7A0NA                          TAA0NA
     I              L7AXDT                          TAAXDT
      *
     I@B1REJ0
      * Item Balance Detail       Retrieval index       NV
      * Renamed input format fields
     I              B1AIC3                          TBAIC3
     I              B1HGCD                          TBHGCD
     I              B1AJCD                          TBAJCD
     I              B1ELDT                          TBELDT
     I              B1ABWG                          TBABWG
     I              B1AGQT                          TBAGQT
     I              B1AHQT                          TBAHQT
     I              B1AIQT                          TBAIQT
     I              B1CTST                          TBCTST
     I              B1ACWG                          TBACWG
     I              B1ARQT                          TBARQT
     I              B1ASQT                          TBASQT
     I              B1ATQT                          TBATQT
     I              B1HDQT                          TBHDQT
     I              B1HEQT                          TBHEQT
     I              B1F6ST                          TBF6ST
     I              B1BMWG                          TBBMWG
     I              B1DSQT                          TBDSQT
     I              B1DTQT                          TBDTQT
     I              B1DUQT                          TBDUQT
     I              B1DHDT                          TBDHDT
     I              B1AGCS                          TBAGCS
     I              B1AECS                          TBAECS
     I              B1IDVA                          TBIDVA
     I              B1K7DT                          TBK7DT
     I              B1RINB                          TBRINB
     I              B1RHNB                          TBRHNB
     I              B1RGNB                          TBRGNB
     I              B1UVST                          TBUVST
     I              B1UWST                          TBUWST
     I              B1UXST                          TBUXST
     I              B1VSST                          TBVSST
     I              B1AATM                          TBAATM
     I              B1AYNA                          TBAYNA
     I              B1A0NA                          TBA0NA
     I              B1AXDT                          TBAXDT
      *
     I@B1REJ1
      * Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          TCAIC3
     I              B1HGCD                          TCHGCD
     I              B1AJCD                          TCAJCD
     I              B1ELDT                          TCELDT
     I              B1ABWG                          TCABWG
     I              B1AGQT                          TCAGQT
     I              B1AHQT                          TCAHQT
     I              B1AIQT                          TCAIQT
     I              B1CTST                          TCCTST
     I              B1ACWG                          TCACWG
     I              B1ARQT                          TCARQT
     I              B1ASQT                          TCASQT
     I              B1ATQT                          TCATQT
     I              B1HDQT                          TCHDQT
     I              B1HEQT                          TCHEQT
     I              B1F6ST                          TCF6ST
     I              B1BMWG                          TCBMWG
     I              B1DSQT                          TCDSQT
     I              B1DTQT                          TCDTQT
     I              B1DUQT                          TCDUQT
     I              B1DHDT                          TCDHDT
     I              B1AGCS                          TCAGCS
     I              B1AECS                          TCAECS
     I              B1IDVA                          TCIDVA
     I              B1K7DT                          TCK7DT
     I              B1RINB                          TCRINB
     I              B1RHNB                          TCRHNB
     I              B1RGNB                          TCRGNB
     I              B1UVST                          TCUVST
     I              B1UWST                          TCUWST
     I              B1UXST                          TCUXST
     I              B1VSST                          TCVSST
     I              B1AATM                          TCAATM
     I              B1AYNA                          TCAYNA
     I              B1A0NA                          TCA0NA
     I              B1AXDT                          TCAXDT
      *
     I@FNCPUW
      * Manifest Detail           Co/Ord/Seq/SecSq/Cs(d)
      * Renamed input format fields
     I              FNAIC3                          TDAIC3
     I              FNC4NB                          TDC4NB
     I              FNDPNB                          TDDPNB
     I              FNUENB                          TDUENB
     I              FNRZNB                          TDRZNB
     I              FNFOQT                          TDFOQT
     I              FNR0NB                          TDR0NB
     I              FNPMST                          TDPMST
     I              FNK7DT                          TDK7DT
     I              FNPFNX                          TDPFNX
     I              FNHGCD                          TDHGCD
     I              FNAJCD                          TDAJCD
     I              FNELDT                          TDELDT
     I              FNN5WG                          TDN5WG
     I              FNRZNA                          TDRZNA
     I              FNH5NY                          TDH5NY
     I              FNH6NY                          TDH6NY
     I              FNH7NY                          TDH7NY
     I              FNGBTX                          TDGBTX
     I              FNN6WG                          TDN6WG
     I              FNN7WG                          TDN7WG
     I              FNGCTX                          TDGCTX
     I              FNGDTX                          TDGDTX
     I              FNRBDT                          TDRBDT
     I              FNITNY                          TDITNY
     I              FNIVNY                          TDIVNY
     I              FNIUNY                          TDIUNY
     I              FNIWNY                          TDIWNY
     I              FNIXNY                          TDIXNY
     I              FNIYNY                          TDIYNY
     I              FNUVST                          TDUVST
     I              FNUWST                          TDUWST
     I              FNUXST                          TDUXST
     I              FNVSST                          TDVSST
     I              FNAATM                          TDAATM
     I              FNAYNA                          TDAYNA
     I              FNA0NA                          TDA0NA
     I              FNAXDT                          TDAXDT
     I              FNLPNZ                          TDLPNZ
      *
     I@FNCPCS
      * Manifest Detail           Update index
      * Renamed input format fields
     I              FNAIC3                          TEAIC3
     I              FNC4NB                          TEC4NB
     I              FNDPNB                          TEDPNB
     I              FNUENB                          TEUENB
     I              FNRZNB                          TERZNB
     I              FNFOQT                          TEFOQT
     I              FNR0NB                          TER0NB
     I              FNPMST                          TEPMST
     I              FNK7DT                          TEK7DT
     I              FNPFNX                          TEPFNX
     I              FNHGCD                          TEHGCD
     I              FNAJCD                          TEAJCD
     I              FNELDT                          TEELDT
     I              FNN5WG                          TEN5WG
     I              FNRZNA                          TERZNA
     I              FNH5NY                          TEH5NY
     I              FNH6NY                          TEH6NY
     I              FNH7NY                          TEH7NY
     I              FNGBTX                          TEGBTX
     I              FNN6WG                          TEN6WG
     I              FNN7WG                          TEN7WG
     I              FNGCTX                          TEGCTX
     I              FNGDTX                          TEGDTX
     I              FNRBDT                          TERBDT
     I              FNITNY                          TEITNY
     I              FNIVNY                          TEIVNY
     I              FNIUNY                          TEIUNY
     I              FNIWNY                          TEIWNY
     I              FNIXNY                          TEIXNY
     I              FNIYNY                          TEIYNY
     I              FNUVST                          TEUVST
     I              FNUWST                          TEUWST
     I              FNUXST                          TEUXST
     I              FNVSST                          TEVSST
     I              FNAATM                          TEAATM
     I              FNAYNA                          TEAYNA
     I              FNA0NA                          TEA0NA
     I              FNAXDT                          TEAXDT
     I              FNLPNZ                          TELPNZ
      *
     I@L8CPTD
      * Order Inv Allocation      Co/Ord/Seq/Seq2/ASeq(d)
      * Renamed input format fields
     I              L8AIC3                          TFAIC3
     I              L8C4NB                          TFC4NB
     I              L8DPNB                          TFDPNB
     I              L8UENB                          TFUENB
     I              L8ALSW                          TFALSW
     I              L8J6QT                          TFJ6QT
     I              L8G9WG                          TFG9WG
     I              L8J9QT                          TFJ9QT
     I              L8HAWG                          TFHAWG
     I              L8IOSE                          TFIOSE
     I              L8OIMN                          TFOIMN
     I              L8SOAS                          TFSOAS
     I              L8ARSX                          TFARSX
     I              L8OTUS                          TFOTUS
     I              L8OTMP                          TFOTMP
     I              L8HGCD                          TFHGCD
     I              L8AJCD                          TFAJCD
     I              L8ELDT                          TFELDT
     I              L8LXNM                          TFLXNM
     I              L8YMCD                          TFYMCD
     I              L8YNCD                          TFYNCD
     I              L8UVST                          TFUVST
     I              L8UWST                          TFUWST
     I              L8UXST                          TFUXST
     I              L8VSST                          TFVSST
     I              L8AATM                          TFAATM
     I              L8AYNA                          TFAYNA
     I              L8A0NA                          TFA0NA
     I              L8AXDT                          TFAXDT
      *
     I@L8CPSX
      * Order Inv Allocation      Update index
      * Renamed input format fields
     I              L8AIC3                          TGAIC3
     I              L8C4NB                          TGC4NB
     I              L8DPNB                          TGDPNB
     I              L8UENB                          TGUENB
     I              L8ALSW                          TGALSW
     I              L8J6QT                          TGJ6QT
     I              L8G9WG                          TGG9WG
     I              L8J9QT                          TGJ9QT
     I              L8HAWG                          TGHAWG
     I              L8IOSE                          TGIOSE
     I              L8OIMN                          TGOIMN
     I              L8SOAS                          TGSOAS
     I              L8ARSX                          TGARSX
     I              L8OTUS                          TGOTUS
     I              L8OTMP                          TGOTMP
     I              L8HGCD                          TGHGCD
     I              L8AJCD                          TGAJCD
     I              L8ELDT                          TGELDT
     I              L8LXNM                          TGLXNM
     I              L8YMCD                          TGYMCD
     I              L8YNCD                          TGYNCD
     I              L8UVST                          TGUVST
     I              L8UWST                          TGUWST
     I              L8UXST                          TGUXST
     I              L8VSST                          TGVSST
     I              L8AATM                          TGAATM
     I              L8AYNA                          TGAYNA
     I              L8A0NA                          TGA0NA
     I              L8AXDT                          TGAXDT
      *
     I@L8CPDK
      * Order Inv Allocation      Co/Ord/Sq/Sq2/Srl#
      * Renamed input format fields
     I              L8AIC3                          THAIC3
     I              L8C4NB                          THC4NB
     I              L8DPNB                          THDPNB
     I              L8UENB                          THUENB
     I              L8ALSW                          THALSW
     I              L8J6QT                          THJ6QT
     I              L8G9WG                          THG9WG
     I              L8J9QT                          THJ9QT
     I              L8HAWG                          THHAWG
     I              L8IOSE                          THIOSE
     I              L8OIMN                          THOIMN
     I              L8SOAS                          THSOAS
     I              L8ARSX                          THARSX
     I              L8OTUS                          THOTUS
     I              L8OTMP                          THOTMP
     I              L8HGCD                          THHGCD
     I              L8AJCD                          THAJCD
     I              L8ELDT                          THELDT
     I              L8LXNM                          THLXNM
     I              L8YMCD                          THYMCD
     I              L8YNCD                          THYNCD
     I              L8UVST                          THUVST
     I              L8UWST                          THUWST
     I              L8UXST                          THUXST
     I              L8VSST                          THVSST
     I              L8AATM                          THAATM
     I              L8AYNA                          THAYNA
     I              L8A0NA                          THA0NA
     I              L8AXDT                          THAXDT
      *
     I@BGCPZF
      * PFS Inventory Adjustment  Update index
      * Renamed input format fields
     I              BGY1NX                          TIY1NX
     I              BGC0NY                          TIC0NY
     I              BGAID8                          TIAID8
     I              BGAFTS                          TIAFTS
     I              BGBCNY                          TIBCNY
     I              BGVLSX                          TIVLSX
     I              BGVMSX                          TIVMSX
     I              BGY2NX                          TIY2NX
     I              BGU4SX                          TIU4SX
     I              BGADNY                          TIADNY
     I              BGU1SX                          TIU1SX
     I              BGP7DT                          TIP7DT
     I              BGZ4NX                          TIZ4NX
     I              BGACNY                          TIACNY
     I              BGVKSX                          TIVKSX
     I              BGZ2NX                          TIZ2NX
     I              BGZ6NX                          TIZ6NX
     I              BGBDNY                          TIBDNY
     I              BGABNY                          TIABNY
     I              BGBENY                          TIBENY
     I              BGZ9NX                          TIZ9NX
     I              BGGBAA                          TIGBAA
     I              BGANNY                          TIANNY
     I              BGZPNX                          TIZPNX
     I              BGZXNX                          TIZXNX
     I              BGZYNX                          TIZYNX
     I              BGALNY                          TIALNY
     I              BGAGNY                          TIAGNY
     I              BGUWSX                          TIUWSX
     I              BGUXSX                          TIUXSX
     I              BGV3SX                          TIV3SX
     I              BGAHNY                          TIAHNY
     I              BGAINY                          TIAINY
     I              BGAJNY                          TIAJNY
     I              BGAKNY                          TIAKNY
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IQPOB21    E DSPOB2CPL0
      * UPD : Product Trace             Update index
      * Renamed input format fields
     I              B2AIC3                          WSAIC3
     I              B2PFNX                          WSPFNX
     I              B2AADX                          WSAADX
     I              B2B9TM                          WSB9TM
     I              B2ADDX                          WSADDX
     I              B2ABDX                          WSABDX
     I              B2CATM                          WSCATM
     I              B2MNSX                          WSMNSX
     I              B2JOWG                          WSJOWG
     I              B2JPWG                          WSJPWG
     I              B2MOSX                          WSMOSX
     I              B2DNAA                          WSDNAA
     I              B2PGNX                          WSPGNX
     I              B2BTT1                          WSBTT1
     I              B2D7C7                          WSD7C7
     I              B2PYNA                          WSPYNA
     I              B2PZNA                          WSPZNA
     I              B2MPSX                          WSMPSX
     I              B2CCT1                          WSCCT1
     I              B2PHNX                          WSPHNX
     I              B2MQSX                          WSMQSX
     I              B2DOAA                          WSDOAA
     I              B2BUT1                          WSBUT1
     I              B2DYAA                          WSDYAA
     I              B2BVT1                          WSBVT1
     I              B2DPAA                          WSDPAA
     I              B2DQAA                          WSDQAA
     I              B2BZT1                          WSBZT1
     I              B2BWT1                          WSBWT1
     I              B2DRAA                          WSDRAA
     I              B2B9T1                          WSB9T1
     I              B2DSAA                          WSDSAA
     I              B2B8T1                          WSB8T1
     I              B2D4AA                          WSD4AA
     I              B2EPAA                          WSEPAA
     I              B2EQAA                          WSEQAA
     I              B2ERAA                          WSERAA
     I              B2ESAA                          WSESAA
     I              B2PNSX                          WSPNSX
     I              B2UFNX                          WSUFNX
     I              B2UGNX                          WSUGNX
     I              B2UHNX                          WSUHNX
     I              B2AGDX                          WSAGDX
     I              B2CGTM                          WSCGTM
     I              B2POSX                          WSPOSX
     I              B2PPSX                          WSPPSX
     I              B2UINX                          WSUINX
     I              B2UJNX                          WSUJNX
     I              B2UKNX                          WSUKNX
     I              B2ULNX                          WSULNX
     I              B2PRSX                          WSPRSX
     I              B2PSSX                          WSPSSX
     I              B2AATM                          WSAATM
     I              B2AYNA                          WSAYNA
     I              B2A0NA                          WSA0NA
     I              B2AXDT                          WSAXDT
      *
     IQPDL51    E DSPDL5CPL0
      * UPD : Item Lot Location         Update index
      * Renamed input format fields
     I              L5AIC3                          WTAIC3
     I              L5HGCD                          WTHGCD
     I              L5AJCD                          WTAJCD
     I              L5ELDT                          WTELDT
     I              L5LXNM                          WTLXNM
     I              L5YMCD                          WTYMCD
     I              L5YNCD                          WTYNCD
     I              L5J2QT                          WTJ2QT
     I              L5G5WG                          WTG5WG
     I              L5J3QT                          WTJ3QT
     I              L5G6WG                          WTG6WG
     I              L5J4QT                          WTJ4QT
     I              L5G7WG                          WTG7WG
     I              L5LODT                          WTLODT
     I              L5LPDT                          WTLPDT
     I              L5LQDT                          WTLQDT
     I              L5NBR                           WTNBR
     I              L5YTCD                          WTYTCD
     I              L5AMSX                          WTAMSX
     I              L5ASSX                          WTASSX
     I              L5ATSX                          WTATSX
     I              L5AUSX                          WTAUSX
     I              L5YSCD                          WTYSCD
     I              L5UVST                          WTUVST
     I              L5UWST                          WTUWST
     I              L5UXST                          WTUXST
     I              L5VSST                          WTVSST
     I              L5AATM                          WTAATM
     I              L5AYNA                          WTAYNA
     I              L5A0NA                          WTA0NA
     I              L5AXDT                          WTAXDT
      *
     IYARDCS      DS                            111
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPDL71    E DSPDL7CPL0
      * UPD : Item Lot Loc Trans        Update index
      * Renamed input format fields
     I              L7AIC3                          TAAIC3
     I              L7HGCD                          TAHGCD
     I              L7AJCD                          TAAJCD
     I              L7LTRT                          TALTRT
     I              L7LRDT                          TALRDT
     I              L7LLTS                          TALLTS
     I              L7LSDT                          TALSDT
     I              L7J5QT                          TAJ5QT
     I              L7G8WG                          TAG8WG
     I              L7LLTN                          TALLTN
     I              L7YMCD                          TAYMCD
     I              L7LLCL                          TALLCL
     I              L7BNAA                          TABNAA
     I              L7LLTR                          TALLTR
     I              L7Y2CD                          TAY2CD
     I              L7LLTL                          TALLTL
     I              L7C4NB                          TAC4NB
     I              L7LOST                          TALOST
     I              L7LLTU                          TALLTU
     I              L7LLYT                          TALLYT
     I              L7UVST                          TAUVST
     I              L7UWST                          TAUWST
     I              L7UXST                          TAUXST
     I              L7VSST                          TAVSST
     I              L7AATM                          TAAATM
     I              L7AYNA                          TAAYNA
     I              L7A0NA                          TAA0NA
     I              L7AXDT                          TAAXDT
      *
     IQCAB11    E DSCAB1REL1
      * UPD : Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          TCAIC3
     I              B1HGCD                          TCHGCD
     I              B1AJCD                          TCAJCD
     I              B1ELDT                          TCELDT
     I              B1ABWG                          TCABWG
     I              B1AGQT                          TCAGQT
     I              B1AHQT                          TCAHQT
     I              B1AIQT                          TCAIQT
     I              B1CTST                          TCCTST
     I              B1ACWG                          TCACWG
     I              B1ARQT                          TCARQT
     I              B1ASQT                          TCASQT
     I              B1ATQT                          TCATQT
     I              B1HDQT                          TCHDQT
     I              B1HEQT                          TCHEQT
     I              B1F6ST                          TCF6ST
     I              B1BMWG                          TCBMWG
     I              B1DSQT                          TCDSQT
     I              B1DTQT                          TCDTQT
     I              B1DUQT                          TCDUQT
     I              B1DHDT                          TCDHDT
     I              B1AGCS                          TCAGCS
     I              B1AECS                          TCAECS
     I              B1IDVA                          TCIDVA
     I              B1K7DT                          TCK7DT
     I              B1RINB                          TCRINB
     I              B1RHNB                          TCRHNB
     I              B1RGNB                          TCRGNB
     I              B1UVST                          TCUVST
     I              B1UWST                          TCUWST
     I              B1UXST                          TCUXST
     I              B1VSST                          TCVSST
     I              B1AATM                          TCAATM
     I              B1AYNA                          TCAYNA
     I              B1A0NA                          TCA0NA
     I              B1AXDT                          TCAXDT
      *
     IYBRDCS      DS                            439
     IYCRDCS      DS                            111
     IQOMFN1    E DSOMFNCPL0
      * UPD : Manifest Detail           Update index
      * Renamed input format fields
     I              FNAIC3                          TEAIC3
     I              FNC4NB                          TEC4NB
     I              FNDPNB                          TEDPNB
     I              FNUENB                          TEUENB
     I              FNRZNB                          TERZNB
     I              FNFOQT                          TEFOQT
     I              FNR0NB                          TER0NB
     I              FNPMST                          TEPMST
     I              FNK7DT                          TEK7DT
     I              FNPFNX                          TEPFNX
     I              FNHGCD                          TEHGCD
     I              FNAJCD                          TEAJCD
     I              FNELDT                          TEELDT
     I              FNN5WG                          TEN5WG
     I              FNRZNA                          TERZNA
     I              FNH5NY                          TEH5NY
     I              FNH6NY                          TEH6NY
     I              FNH7NY                          TEH7NY
     I              FNGBTX                          TEGBTX
     I              FNN6WG                          TEN6WG
     I              FNN7WG                          TEN7WG
     I              FNGCTX                          TEGCTX
     I              FNGDTX                          TEGDTX
     I              FNRBDT                          TERBDT
     I              FNITNY                          TEITNY
     I              FNIVNY                          TEIVNY
     I              FNIUNY                          TEIUNY
     I              FNIWNY                          TEIWNY
     I              FNIXNY                          TEIXNY
     I              FNIYNY                          TEIYNY
     I              FNUVST                          TEUVST
     I              FNUWST                          TEUWST
     I              FNUXST                          TEUXST
     I              FNVSST                          TEVSST
     I              FNAATM                          TEAATM
     I              FNAYNA                          TEAYNA
     I              FNA0NA                          TEA0NA
     I              FNAXDT                          TEAXDT
     I              FNLPNZ                          TELPNZ
      *
     IQPDL81    E DSPDL8CPL0
      * UPD : Order Inv Allocation      Update index
      * Renamed input format fields
     I              L8AIC3                          TGAIC3
     I              L8C4NB                          TGC4NB
     I              L8DPNB                          TGDPNB
     I              L8UENB                          TGUENB
     I              L8ALSW                          TGALSW
     I              L8J6QT                          TGJ6QT
     I              L8G9WG                          TGG9WG
     I              L8J9QT                          TGJ9QT
     I              L8HAWG                          TGHAWG
     I              L8IOSE                          TGIOSE
     I              L8OIMN                          TGOIMN
     I              L8SOAS                          TGSOAS
     I              L8ARSX                          TGARSX
     I              L8OTUS                          TGOTUS
     I              L8OTMP                          TGOTMP
     I              L8HGCD                          TGHGCD
     I              L8AJCD                          TGAJCD
     I              L8ELDT                          TGELDT
     I              L8LXNM                          TGLXNM
     I              L8YMCD                          TGYMCD
     I              L8YNCD                          TGYNCD
     I              L8UVST                          TGUVST
     I              L8UWST                          TGUWST
     I              L8UXST                          TGUXST
     I              L8VSST                          TGVSST
     I              L8AATM                          TGAATM
     I              L8AYNA                          TGAYNA
     I              L8A0NA                          TGA0NA
     I              L8AXDT                          TGAXDT
      *
     IYDRDCS      DS                            439
     IQPPBG1    E DSPPBGCPL0
      * UPD : PFS Inventory Adjustment  Update index
      * Renamed input format fields
     I              BGY1NX                          TIY1NX
     I              BGC0NY                          TIC0NY
     I              BGAID8                          TIAID8
     I              BGAFTS                          TIAFTS
     I              BGBCNY                          TIBCNY
     I              BGVLSX                          TIVLSX
     I              BGVMSX                          TIVMSX
     I              BGY2NX                          TIY2NX
     I              BGU4SX                          TIU4SX
     I              BGADNY                          TIADNY
     I              BGU1SX                          TIU1SX
     I              BGP7DT                          TIP7DT
     I              BGZ4NX                          TIZ4NX
     I              BGACNY                          TIACNY
     I              BGVKSX                          TIVKSX
     I              BGZ2NX                          TIZ2NX
     I              BGZ6NX                          TIZ6NX
     I              BGBDNY                          TIBDNY
     I              BGABNY                          TIABNY
     I              BGBENY                          TIBENY
     I              BGZ9NX                          TIZ9NX
     I              BGGBAA                          TIGBAA
     I              BGANNY                          TIANNY
     I              BGZPNX                          TIZPNX
     I              BGZXNX                          TIZXNX
     I              BGZYNX                          TIZYNX
     I              BGALNY                          TIALNY
     I              BGAGNY                          TIAGNY
     I              BGUWSX                          TIUWSX
     I              BGUXSX                          TIUXSX
     I              BGV3SX                          TIV3SX
     I              BGAHNY                          TIAHNY
     I              BGAINY                          TIAINY
     I              BGAJNY                          TIAJNY
     I              BGAKNY                          TIAKNY
      *
     IYERDCS      DS                            204
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  PFS Inv Adj Prc Ship USR
     I                                        1   1 P1XASX
     IP2PARM      DS
      * I :  PFS Order Number
     I                                        1   70P2ZPNX
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'PFS Dup Case Manifested'
      * Order Number
     I                                        1   7 ZA0001
      * PT Serial Number
     I                                    P   8  120ZA0002
      * Message data for 'PFS Dup Case Manifested'
      * Order Number
     I                                        1   7 ZA0003
      * PT Serial Number
     I                                    P   8  120ZA0004
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1XASX    PARM           WP0001  1        PFS Inv Adj Prc
     C           P2ZPNX    PARM           WP0002  70       PFS Order Numbe
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * PFS Inventory Adj     XF
      * PFS Inventory Adj     RT - PFS Inventory Adjustment  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * PFS Inventory Adj     RT - PFS Inventory Adjustment  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  1        Production Date
     C                     Z-ADD*ZERO     WN0002  30       Company Number
     C                     MOVEL*BLANK    WN0003  3        Item Type Code
     C                     Z-ADD*ZERO     WN0004  52       Fresh Chilling
     C                     MOVEL*BLANK    WN0005  3        Default Warehou
     C                     MOVEL*BLANK    WN0006  3        Made to Order C
     C                     MOVEL*BLANK    WN0007  3        Item Category C
     C                     MOVEL*BLANK    WN0008  6        Primal Group Co
     C                     Z-ADD*ZERO     WN0009  10       PFS Process Sta
     C                     MOVEL*BLANK    WN0010  6        PFS Error Reaso
     C                     Z-ADD*ZERO     WN0011 114       Unit Cost Per P
     C                     MOVEL*BLANK    WN0012  3        Warehouse Code
     C                     MOVEL*BLANK    WN0013 30        Description
     C                     MOVEL*BLANK    WN0014  2        Inventory Trans
     C                     Z-ADD*ZERO     WN0015 112       Transaction Qua
     C                     Z-ADD*ZERO     WN0016 112       Transaction Wei
     C                     Z-ADD*ZERO     WN0017  70       Transaction Dat
     C                     MOVEL*BLANK    WN0018  3        Reason Code
     C                     Z-ADD*ZERO     WN0019  70       Item Code
     C                     Z-ADD*ZERO     WN0020  70       Production Date
     C                     MOVEL*BLANK    WN0021  1        Inventory Trans
     C                     MOVEL*BLANK    WN0022  1        Shift Number
     C                     Z-ADD*ZERO     WN0023  70       Label Date
     C                     Z-ADD*ZERO     WN0024  70       Partial Item Co
     C                     MOVEL*BLANK    WN0025  2        Yld Inv Balance
     C                     Z-ADD*ZERO     WN0026  80       PT Serial Numbe
     C                     Z-ADD*ZERO     WN0027  80       PT Prod Date YY
     C                     Z-ADD*ZERO     WN0028  60       PT Production T
     C                     MOVEL*BLANK    WN0029  1        PT Inventory St
     C                     Z-ADD*ZERO     WN0030  51       PT Net Weight
     C                     Z-ADD*ZERO     WN0031  51       PT Gross Weight
     C                     Z-ADD*ZERO     WN0032  70       PT Product Code
     C                     MOVEL*BLANK    WN0033  1        PT Shift Number
     C                     MOVEL*BLANK    WN0034  3        PT Warehouse ID
     C                     Z-ADD*ZERO     WN0035  70       PT Order Number
     C                     MOVEL*BLANK    WN0036 10        PT Pallet Numbe
     C                     Z-ADD*ZERO     WN0037  80       PT Offset Prod
     C                     Z-ADD*ZERO     WN0038  60       PT Offset Prod
     C                     MOVEL*BLANK    WN0039 32        PT Item Label L
     C                     MOVEL*BLANK    WN0040 32        PT Item Label L
     C                     MOVEL*BLANK    WN0041  2        PT Fresh/Frozen
     C                     Z-ADD*ZERO     WN0042  80       PT Label Date Y
     C                     MOVEL*BLANK    WN0043  9        PT Item Picture
     C                     MOVEL*BLANK    WN0044  3        PT Item Type Co
     C                     Z-ADD*ZERO     WN0045  30       PT Item Str Cla
     C                     Z-ADD*ZERO     WN0046  30       PT Item Str Gro
     C                     Z-ADD*ZERO     WN0047  30       PT Item Str Typ
     C                     MOVEL*BLANK    WN0048  1        PT Incl in Prod
     C                     MOVEL*BLANK    WN0049  1        Lot Tracking Fl
     C                     Z-ADD*ZERO     WN0050  30       Accounting Comp
     C                     MOVEL*BLANK    WN0051  4        Location Code
     C                     MOVEL*BLANK    WN0052  1        ILL Status
     C                     MOVEL*BLANK    WN0053  3        Inv Hold Reason
     C                     Z-ADD*ZERO     WN0054  50       ILL Item Qty On
     C                     Z-ADD*ZERO     WN0055 112       ILL Item Wgt On
     C                     Z-ADD*ZERO     WN0056  70       Order Number
     C                     MOVEL*BLANK    WN0057  1        Header Status
     C                     MOVEL*BLANK    WN0058  2        Order Type_Sale
     C                     MOVEL*BLANK    WN0059  1        Billing Activit
     C                     MOVEL*BLANK    WN0060  2        Event Code
     C                     Z-ADD*ZERO     WN0061  70       Ship To Custome
     C                     MOVEL*BLANK    WN0062  1        Trans Contol AS
     C                     Z-ADD*ZERO     WN0063  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0064  30       Order Sequence
     C                     Z-ADD*ZERO     WN0065  30       Order Secondary
     C                     MOVEL*BLANK    WN0066  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0067  2        LLT Transaction
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Establish starting position
     C           *LOVAL    SETLL@BGCPAS                    *
     C                     READ @BGCPAS                  90*
      * Data record not found
     C   90                MOVEL'USR3496' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0001           Production Date
     C                     Z-ADD*ZERO     WN0002           Company Number
     C                     MOVEL*BLANK    WN0003           Item Type Code
     C                     Z-ADD*ZERO     WN0004           Fresh Chilling
     C                     MOVEL*BLANK    WN0005           Default Warehou
     C                     MOVEL*BLANK    WN0006           Made to Order C
     C                     MOVEL*BLANK    WN0007           Item Category C
     C                     MOVEL*BLANK    WN0008           Primal Group Co
     C                     Z-ADD*ZERO     WN0009           PFS Process Sta
     C                     MOVEL*BLANK    WN0010           PFS Error Reaso
     C                     Z-ADD*ZERO     WN0011           Unit Cost Per P
     C                     MOVEL*BLANK    WN0012           Warehouse Code
     C                     MOVEL*BLANK    WN0013           Description
     C                     MOVEL*BLANK    WN0014           Inventory Trans
     C                     Z-ADD*ZERO     WN0015           Transaction Qua
     C                     Z-ADD*ZERO     WN0016           Transaction Wei
     C                     Z-ADD*ZERO     WN0017           Transaction Dat
     C                     MOVEL*BLANK    WN0018           Reason Code
     C                     Z-ADD*ZERO     WN0019           Item Code
     C                     Z-ADD*ZERO     WN0020           Production Date
     C                     MOVEL*BLANK    WN0021           Inventory Trans
     C                     MOVEL*BLANK    WN0022           Shift Number
     C                     Z-ADD*ZERO     WN0023           Label Date
     C                     Z-ADD*ZERO     WN0024           Partial Item Co
     C                     MOVEL*BLANK    WN0025           Yld Inv Balance
     C                     Z-ADD*ZERO     WN0026           PT Serial Numbe
     C                     Z-ADD*ZERO     WN0027           PT Prod Date YY
     C                     Z-ADD*ZERO     WN0028           PT Production T
     C                     MOVEL*BLANK    WN0029           PT Inventory St
     C                     Z-ADD*ZERO     WN0030           PT Net Weight
     C                     Z-ADD*ZERO     WN0031           PT Gross Weight
     C                     Z-ADD*ZERO     WN0032           PT Product Code
     C                     MOVEL*BLANK    WN0033           PT Shift Number
     C                     MOVEL*BLANK    WN0034           PT Warehouse ID
     C                     Z-ADD*ZERO     WN0035           PT Order Number
     C                     MOVEL*BLANK    WN0036           PT Pallet Numbe
     C                     Z-ADD*ZERO     WN0037           PT Offset Prod
     C                     Z-ADD*ZERO     WN0038           PT Offset Prod
     C                     MOVEL*BLANK    WN0039           PT Item Label L
     C                     MOVEL*BLANK    WN0040           PT Item Label L
     C                     MOVEL*BLANK    WN0041           PT Fresh/Frozen
     C                     Z-ADD*ZERO     WN0042           PT Label Date Y
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL*BLANK    WN0044           PT Item Type Co
     C                     Z-ADD*ZERO     WN0045           PT Item Str Cla
     C                     Z-ADD*ZERO     WN0046           PT Item Str Gro
     C                     Z-ADD*ZERO     WN0047           PT Item Str Typ
     C                     MOVEL*BLANK    WN0048           PT Incl in Prod
     C                     MOVEL*BLANK    WN0049           Lot Tracking Fl
     C                     Z-ADD*ZERO     WN0050           Accounting Comp
     C                     MOVEL*BLANK    WN0051           Location Code
     C                     MOVEL*BLANK    WN0052           ILL Status
     C                     MOVEL*BLANK    WN0053           Inv Hold Reason
     C                     Z-ADD*ZERO     WN0054           ILL Item Qty On
     C                     Z-ADD*ZERO     WN0055           ILL Item Wgt On
     C                     Z-ADD*ZERO     WN0056           Order Number
     C                     MOVEL*BLANK    WN0057           Header Status
     C                     MOVEL*BLANK    WN0058           Order Type_Sale
     C                     MOVEL*BLANK    WN0059           Billing Activit
     C                     MOVEL*BLANK    WN0060           Event Code
     C                     Z-ADD*ZERO     WN0061           Ship To Custome
     C                     MOVEL*BLANK    WN0062           Trans Contol AS
     C                     Z-ADD*ZERO     WN0063           Scheduled Ship
     C                     Z-ADD*ZERO     WN0064           Order Sequence
     C                     Z-ADD*ZERO     WN0065           Order Secondary
     C                     MOVEL*BLANK    WN0066           Detail Line Sta
     C                     MOVEL*BLANK    WN0067           LLT Transaction
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     Z-ADD*ZERO     WN0009           PFS Process Sta
     C                     MOVEL*BLANK    WN0010           PFS Error Reaso
      * ***** VALIDATION *****
     C                     EXSR UASUBR                     ***** VALIDATIO
      * ***** PROCESS RECORD *****
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Initialize
     C                     EXSR UCSUBR                     Initialize
      * ***** PRODUCTION & INVENTORY TRANSACTIONS *****
      * CASE:
      *  - c1 OR c2 OR c3 OR c4 OR c5
      *   |- c1    : DB1.PFS Transaction Type is Production Transactions
      *   |- c2    : DB1.PFS Transaction Type is Inventory Transactions
      *   |- c3    : DB1.PFS Transaction Type is Cycle Count Inv Adjust
      *   |- c4    : DB1.PFS Transaction Type is BP: Batch Label Print
      *   |- c5    : DB1.PFS Transaction Type is WT: Warehouse Transfer
      *   '-
     C           WAVLSX    IFEQ 'P04'                      *IF
     C           WAVLSX    OREQ 'P02'
     C           WAVLSX    OREQ 'P01'
     C           WAVLSX    OREQ 'P03'
     C           WAVLSX    OREQ 'P05'
     C           WAVLSX    OREQ 'I01'                      *OR
     C           WAVLSX    OREQ 'I02'
     C           WAVLSX    OREQ 'I04'
     C           WAVLSX    OREQ 'I03'
     C           WAVLSX    OREQ 'C02'                      *OR
     C           WAVLSX    OREQ 'C04'
     C           WAVLSX    OREQ 'C01'
     C           WAVLSX    OREQ 'B01'                      *OR
     C           WAVLSX    OREQ 'W01'                      *OR
      * CASE: DB1.PFS Transaction Type is PM: Production
     C           WAVLSX    IFEQ 'P01'                      *IF
      * PROCESS: Finished Goods, WIP, & Partial Production
      * CASE: Finished Goods or Work In Process
      *  - c1 OR c2 OR c3 OR c4 OR c5
      *   |- c1    : DB1.PFS Tracking Type is Finished Goods
      *   |- c2    : DB1.PFS Tracking Type is Export
      *   |- c3    : DB1.PFS Tracking Type is Casings
      *   |- c4    : DB1.PFS Tracking Type is Export 2
      *   |- c5    : DB1.PFS Tracking Type is Work In Process
      *   '-
     C           WAZ6NX    IFEQ 1                          *IF
     C           WAZ6NX    OREQ 2                          *OR
     C           WAZ6NX    OREQ 7                          *OR
     C           WAZ6NX    OREQ 8                          *OR
     C           WAZ6NX    OREQ 3                          *OR
      * CRT: Item Transaction Detail
     C                     MOVEL'R'       WN0021           Inventory Trans
     C                     MOVEL'RR'      WN0014           Inventory Trans
     C                     MOVEL*BLANK    WN0013           Description
     C                     MOVEL@CN,004   WN0013           Description
     C                     MOVEL'PRD'     WN0018           Reason Code
      * E3014 3.4.14  RMC  New Reason 10 = freezer transfer
      * CASE: DB1.PFS Inv Adj Reason Code is PFS: Freezer Transfer
     C           WAVMSX    IFEQ '10'                       *IF
     C                     MOVEL'RWZ'     WN0018           Reason Code
     C                     MOVEL*BLANK    WN0013           Description
     C                     MOVEL@CN,005   WN0013           Description
     C                     END                             *FI
      * Prc Create Dtl Receipt XF - Item Transaction Detail  * 
     C                     CALL 'CAALXFR'              90  Prc Create Dtl
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0002    WQ0010  30       Company Number
     C                     PARM WN0019    WQ0011  70       Item Code
     C                     PARM WN0012    WQ0012  3        Warehouse Code
     C                     PARM WN0021    WQ0013  1        Inventory Trans
     C                     PARM WN0014    WQ0014  2        Inventory Trans
     C                     PARM WN0017    WQ0015  70       Transaction Dat
     C                     PARM WN0020    WQ0016  70       Production Date
     C                     PARM WN0013    WQ0017 30        Description
     C                     PARM WN0015    WQ0018 112       Transaction Qua
     C                     PARM WN0016    WQ0019 112       Transaction Wei
     C                     PARM WN0018    WQ0020  3        Reason Code
     C                     PARM WN0022    WQ0021  1        Shift Number
     C                     PARM WN0023    WQ0022  70       Label Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAALXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * RMC E00475 dont crt if exists. in some instances we get the S01 1
      * 8/13/09    but still want to add the prod to inventory
     C                     Z-ADDWAZ2NX    WN0026           PT Serial Numbe
      * Val Prod Trc P01 rcd  RT - Product Trace  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0023           Company Number
     C                     Z-ADDWN0026    WL0024           PT Serial Numbe
     C                     Z-ADDWAZ4NX    WL0025           PT Label Date Y
     C                     EXSR SMRVGN
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ @CN,003                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * UPD:  Product Trace
      * CASE: PAR.Item Code is Scale Check Item 2222
     C           WN0019    IFEQ 2222                       *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWAZ2NX    WN0026           PT Serial Numbe
     C                     Z-ADDWAP7DT    WN0027           PT Prod Date YY
     C                     Z-ADDWAAFTS    WN0028           PT Production T
     C                     Z-ADDWAZ4NX    WN0042           PT Label Date Y
     C                     MOVEL'1'       WN0029           PT Inventory St
     C                     Z-ADDWAABNY    WN0030           PT Net Weight
     C                     Z-ADDWABENY    WN0031           PT Gross Weight
     C                     MOVELWAVKSX    WN0033           PT Shift Number
     C                     MOVELWAU4SX    WN0034           PT Warehouse ID
     C                     MOVELWAAGNY    WN0036           PT Pallet Numbe
     C                     Z-ADDWN0019    WN0032           PT Product Code
      * --- Offset Production Date & Time ---
     C                     MOVELWAZ2NX    YL0013           Text 10A USR
     C                     Z-ADD2         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00010
     C           ZQ        ORGT 00010
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0013:ZQ YL0014    P  90  Scale ID
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * Rtv Line/ID/Ofst p/Dt RT - Product Trace Line Scale  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0026           Company Number
     C                     MOVELYL0014    WL0027    P      Scale ID
     C                     Z-ADDWN0023    WL0028           Effective Label
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0029    YL0015           CS Scale Offset
     C                     MOVELWL0030    WN0048    P      CS Include in P
      * RMC 3/15/06 use par.pt prod date yyyymmdd instead of lcl.pt prod
     C                     Z-ADDWN0027    WN0037           PT Offset Prod
     C                     MULT -1        YL0015           CS Scale Offset
      * PAR.PT Offset Prod Time = PAR.PT Production Time + LCL.CS Scale O
     C                     Z-ADDWN0028    XTTIM
     C                     Z-ADD*ZERO     XASC    80
     C                     EXSR XTAD1
     C           60        MULT YL0015    XDWK1   80
     C                     ADD  XDWK1     XASC    80
     C                     EXSR XTCT1
     C                     Z-ADDXTTIM     WN0038
      * CASE: PAR.PT Offset Prod Time GT PAR.PT Production Time
     C           WN0038    IFGT WN0028                     *IF
      * PAR.PT Offset Prod Date = PAR.PT Offset Prod Date + CON.-1 *DAYS
     C           WN0037    SUB  18000000  XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-1        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111110' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0037
     C                     ELSE
     C           XDINDT    ADD  18000000  WN0037
     C                     END
     C                     END                             *FI
      * --- Item Picture Key ---
      * RTV Item Labels        RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0031           Company Number
     C                     Z-ADDWN0019    WL0032           Item Code
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0033    WUAVNA    P      Description Lin
     C                     MOVELWL0034    WN0039    P      Item Label Line
     C                     MOVELWL0035    WN0040    P      Item Label Line
     C                     Z-ADDWL0036    WN0045           Item Structure
     C                     Z-ADDWL0037    WN0046           Item Structure
     C                     Z-ADDWL0038    WN0047           Item Structure
     C                     MOVELWL0039    WN0044    P      Item Type Code
     C                     MOVELWL0040    WN0006    P      Made to Order C
     C                     MOVELWL0041    WN0007    P      Item Category C
     C                     MOVELWL0042    WN0008    P      Primal Group Co
      * Item Picture Key
      * CASE: PAR.Item Category Code 3 is Loint
     C           WN0007    IFEQ 'L61'                      *IF
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'LOINT'   WN0043           PT Item Picture
     C                     ELSE
      * CASE: *OTHERWISE
      * Item Picture Key
      * CASE: PAR.MTO Code is Entered
     C           WN0006    IFGT *BLANK                     *IF
      * PFN
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.MTO Code is PFN
      *   |- c2    : PAR.MTO Code is IWG
      *   '-
     C           WN0006    IFEQ 'PFN'                      *IF
     C           WN0006    OREQ 'IWG'                      *OR
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'PFN'     WN0043           PT Item Picture
     C                     END                             *FI
      * PFT
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.MTO Code is EHP
      *   |- c2    : PAR.MTO Code is KRG
      *   '-
     C           WN0006    IFEQ 'EHP'                      *IF
     C           WN0006    OREQ 'KRG'                      *OR
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'PFT'     WN0043           PT Item Picture
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5
      *   |- c1    : PAR.Primal Group Code is BUTT
      *   |- c2    : PAR.Primal Group Code is HAM
      *   |- c3    : PAR.Primal Group Code is LOIN
      *   |- c4    : PAR.Primal Group Code is PICNIC
      *   |- c5    : PAR.Primal Group Code is RIBS
      *   '-
     C           WN0008    IFEQ 'BUTT'                     *IF
     C           WN0008    OREQ 'HAM'                      *OR
     C           WN0008    OREQ 'LOIN'                     *OR
     C           WN0008    OREQ @CN,006                    *OR
     C           WN0008    OREQ 'RIBS'                     *OR
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVELWN0008    WN0043           PT Item Picture
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Primal Group Code is HAMC
     C           WN0008    IFEQ 'HAMC'                     *IF
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'HAM'     WN0043           PT Item Picture
     C                     ELSE
      * CASE: PAR.Primal Group Code is LOINC
     C           WN0008    IFEQ 'LOINC'                    *IF
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'LOIN'    WN0043           PT Item Picture
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'LOGO'    WN0043           PT Item Picture
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * RTV Warehouse Type     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0012    WL0043    P      Warehouse Code
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0044    WN0041    P      Warehouse Type
      * --- Create Product Trace Record ---
      * slm 01/10/2014 MTech Review Create Object
      * Crt Product Trace     CR - Product Trace  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0045           Company Number
     C                     Z-ADDWN0026    WL0046           PT Serial Numbe
     C                     Z-ADDWN0027    WL0047           PT Prod Date YY
     C                     Z-ADDWN0028    WL0048           PT Production T
     C                     Z-ADDWN0042    WL0049           PT Label Date Y
     C                     Z-ADDWN0037    WL0050           PT Offset Prod
     C                     Z-ADDWN0038    WL0051           PT Offset Prod
     C                     MOVELWN0029    WL0052    P      PT Inventory St
     C                     Z-ADDWN0030    WL0053           PT Net Weight
     C                     Z-ADDWN0031    WL0054           PT Gross Weight
     C                     MOVELWN0033    WL0055    P      PT Shift Number
     C                     MOVELWN0034    WL0056    P      PT Warehouse ID
     C                     Z-ADDWN0035    WL0057           PT Order Number
     C                     MOVELWN0036    WL0058    P      PT Pallet Numbe
     C                     Z-ADDWN0032    WL0059           PT Product Code
     C                     MOVELWN0039    WL0060    P      PT Item Label L
     C                     MOVELWN0040    WL0061    P      PT Item Label L
     C                     MOVELWN0041    WL0062    P      PT Fresh/Frozen
     C                     MOVELWN0043    WL0063    P      PT Item Picture
     C                     Z-ADD*ZERO     WL0064           PT Tattoo Numbe
     C                     MOVELWUOTTX    WL0065    P      PT Source Type
     C                     MOVEL*BLANK    WL0066           PT Source Code
     C                     MOVEL*BLANK    WL0067           PT Source Code
     C                     MOVEL*BLANK    WL0068           PT Producer/Cel
     C                     MOVEL*BLANK    WL0069           PT Producer/Cel
     C                     MOVEL*BLANK    WL0070           PT Producer/Far
     C                     MOVEL*BLANK    WL0071           PT Producer Loc
     C                     MOVEL*BLANK    WL0072           PT Producer/Far
     C                     MOVEL*BLANK    WL0073           PT Producer/Far
     C                     MOVELWUOTTX    WL0074    P      PT Producer/Far
     C                     MOVEL*BLANK    WL0075           PT Producer/Far
     C                     MOVEL*BLANK    WL0076           PT Genetic Code
     C                     MOVEL*BLANK    WL0077           PT Genetic Desc
     C                     MOVELWUOTTX    WL0078    P      PT Gender Code
     C                     MOVEL*BLANK    WL0079           PT Producer/Far
     C                     MOVEL*BLANK    WL0080           PT Producer/Far
     C                     MOVEL*BLANK    WL0081           PT Producer/Far
     C                     MOVEL*BLANK    WL0082           PT Producer/Far
     C                     MOVELWN0044    WL0083    P      PT Item Type Co
     C                     Z-ADDWN0045    WL0084           PT Item Str Cla
     C                     Z-ADDWN0046    WL0085           PT Item Str Gro
     C                     Z-ADDWN0047    WL0086           PT Item Str Typ
     C                     Z-ADD*ZERO     WL0087           PT WIP Dump/Pro
     C                     Z-ADD*ZERO     WL0088           PT WIP Dump/Pro
     C                     MOVELWUXKTX    WL0089    P      PT WIP Dump/Pro
     C                     MOVELWUOTTX    WL0090    P      PT WIP Used/Not
     C                     Z-ADD*ZERO     WL0091           PT From FG Seri
     C                     Z-ADD*ZERO     WL0092           PT To FG Serial
     C                     Z-ADD*ZERO     WL0093           PT Unused Nbr 3
     C                     Z-ADD*ZERO     WL0094           PT Unused Nbr 4
     C                     MOVELWN0048    WL0095    P      PT Incl in Prod
     C                     MOVELWUOTTX    WL0096    P      PT Unused Sts 4
     C                     Z-ADD*ZERO     WL0097           Job Time
     C                     MOVEL*BLANK    WL0098           User Id
     C                     MOVEL*BLANK    WL0099           Job Name
     C                     Z-ADD*ZERO     WL0100           Job Date
     C                     EXSR SRCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.PFS Tracking Type is Partial
     C           WAZ6NX    IFEQ 4                          *IF
      * CRT: Yld Partial Transaction
     C                     MOVEL'PT'      WN0025           Yld Inv Balance
      * Prc Crt Partial Rcpt  XF - Yld Partial Transaction  * 
     C                     CALL 'POVAXFR'              90  Prc Crt Partial
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0002    WQ0023  30       Company Number
     C                     PARM WN0017    WQ0024  70       Transaction Dat
     C                     PARM WN0024    WQ0025  70       Partial Item Co
     C                     PARM WN0019    WQ0026  70       Item Code
     C                     PARM WN0020    WQ0027  70       Production Date
     C                     PARM WN0022    WQ0028  1        Production Shif
     C                     PARM WN0015    WQ0029  70       Yld Transaction
     C                     PARM WN0016    WQ0030 112       Yld Transaction
     C                     PARM WN0025    WQ0031  2        Yld Inv Balance
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POVAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.PFS Transaction Type is PM: Return/Reject
     C           WAVLSX    IFEQ 'P03'                      *IF
      * ------ Reject Production ------
      * 02/16/2010 PKD Added creation of the Item Transaction Detail
      * 02/16/2010 PKD E000552 Added creation of the Item Transaction Det
      * PROCESS: WIP Reject
      * CASE: DB1.PFS Tracking Type is Work In Process
     C           WAZ6NX    IFEQ 3                          *IF
      * CRT: Item Transaction Detail
     C                     MOVEL'A'       WN0021           Inventory Trans
     C                     MOVEL*BLANK    WN0014           Inventory Trans
     C                     MOVEL'A'       WN0014           Inventory Trans
     C                     MOVEL*BLANK    WN0013           Description
     C                     MOVEL@CN,007   WN0013           Description
     C                     MOVEL'RRT'     WN0018           Reason Code
      * Prc Create Dtl Receipt XF - Item Transaction Detail  * 
     C                     CALL 'CAALXFR'              90  Prc Create Dtl
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0002    WQ0032  30       Company Number
     C                     PARM WN0019    WQ0033  70       Item Code
     C                     PARM WN0012    WQ0034  3        Warehouse Code
     C                     PARM WN0021    WQ0035  1        Inventory Trans
     C                     PARM WN0014    WQ0036  2        Inventory Trans
     C                     PARM WN0017    WQ0037  70       Transaction Dat
     C                     PARM WN0020    WQ0038  70       Production Date
     C                     PARM WN0013    WQ0039 30        Description
     C                     PARM WN0015    WQ0040 112       Transaction Qua
     C                     PARM WN0016    WQ0041 112       Transaction Wei
     C                     PARM WN0018    WQ0042  3        Reason Code
     C                     PARM WN0022    WQ0043  1        Shift Number
     C                     PARM WN0023    WQ0044  70       Label Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAALXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     MOVEL'RJ'      WN0025           Yld Inv Balance
      * Prc Crt Partial Rcpt  XF - Yld Partial Transaction  * 
     C                     CALL 'POVAXFR'              90  Prc Crt Partial
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0002    WQ0045  30       Company Number
     C                     PARM WN0017    WQ0046  70       Transaction Dat
     C                     PARM WN0024    WQ0047  70       Partial Item Co
     C                     PARM WN0019    WQ0048  70       Item Code
     C                     PARM WN0020    WQ0049  70       Production Date
     C                     PARM WN0022    WQ0050  1        Production Shif
     C                     PARM WN0015    WQ0051  70       Yld Transaction
     C                     PARM WN0016    WQ0052 112       Yld Transaction
     C                     PARM WN0025    WQ0053  2        Yld Inv Balance
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POVAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: PM: Issue or PM: Delete or PM: Rework
      *  - c1 OR c2 OR c3
      *   |- c1    : DB1.PFS Transaction Type is PM: Issue
      *   |- c2    : DB1.PFS Transaction Type is PM: Delete
      *   |- c3    : DB1.PFS Transaction Type is PM: Rework
      *   '-
     C           WAVLSX    IFEQ 'P02'                      *IF
     C           WAVLSX    OREQ 'P04'                      *OR
     C           WAVLSX    OREQ 'P05'                      *OR
     C           WABDNY    MULT -1        WN0015           Transaction Qua
     C           WAABNY    MULT -1        WN0016           Transaction Wei
      * PROCESS: Finished Goods, WIP, Partial, & Reject Issue
      * CASE: Finished Goods or Work In Process
      *  - c1 OR c2 OR c3 OR c4 OR c5
      *   |- c1    : DB1.PFS Tracking Type is Finished Goods
      *   |- c2    : DB1.PFS Tracking Type is Export
      *   |- c3    : DB1.PFS Tracking Type is Casings
      *   |- c4    : DB1.PFS Tracking Type is Export 2
      *   |- c5    : DB1.PFS Tracking Type is Work In Process
      *   '-
     C           WAZ6NX    IFEQ 1                          *IF
     C           WAZ6NX    OREQ 2                          *OR
     C           WAZ6NX    OREQ 7                          *OR
     C           WAZ6NX    OREQ 8                          *OR
     C           WAZ6NX    OREQ 3                          *OR
     C                     MOVEL'R'       WN0021           Inventory Trans
     C                     MOVEL'RR'      WN0014           Inventory Trans
      * Description & Reason
      * CASE: DB1.PFS Transaction Type is PM: Issue
     C           WAVLSX    IFEQ 'P02'                      *IF
     C                     MOVEL*BLANK    WN0013           Description
     C                     MOVEL@CN,008   WN0013           Description
     C                     MOVEL'ISS'     WN0018           Reason Code
     C                     ELSE
      * CASE: DB1.PFS Transaction Type is PM: Rework
     C           WAVLSX    IFEQ 'P05'                      *IF
      * Look at Reason codes too - added 02,09 3.14.18 RMC
      * CASE: DB1.PFS Inv Adj Reason Code is PFS: Freezer Transfer
     C           WAVMSX    IFEQ '10'                       *IF
      * E3014 New 3.4.14
     C                     MOVEL*BLANK    WN0013           Description
     C                     MOVEL@CN,005   WN0013           Description
     C                     MOVEL'RWZ'     WN0018           Reason Code
     C                     ELSE
      * CASE: DB1.PFS Inv Adj Reason Code is PFS: Rework
     C           WAVMSX    IFEQ '02'                       *IF
     C                     MOVEL*BLANK    WN0013           Description
     C                     MOVEL@CN,009   WN0013           Description
     C                     MOVEL'RWK'     WN0018           Reason Code
     C                     ELSE
      * CASE: DB1.PFS Inv Adj Reason Code is PFS: Rework Damage Box
     C           WAVMSX    IFEQ '09'                       *IF
     C                     MOVEL*BLANK    WN0013           Description
     C                     MOVEL@CN,010   WN0013           Description
     C                     MOVEL'DMG'     WN0018           Reason Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WN0013           Description
     C                     MOVEL@CN,011   WN0013           Description
     C                     MOVEL'DLR'     WN0018           Reason Code
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.PFS Transaction Type is PM: Delete
     C           WAVLSX    IFEQ 'P04'                      *IF
      * Check Reason also  3.14.18 RMC
      * CASE: DB1.PFS Inv Adj Reason Code is PFS: Rework
     C           WAVMSX    IFEQ '02'                       *IF
     C                     MOVEL*BLANK    WN0013           Description
     C                     MOVEL@CN,011   WN0013           Description
     C                     MOVEL'DLR'     WN0018           Reason Code
     C                     ELSE
      * CASE: DB1.PFS Inv Adj Reason Code is PFS: Rework Damage Box
     C           WAVMSX    IFEQ '09'                       *IF
     C                     MOVEL*BLANK    WN0013           Description
     C                     MOVEL@CN,012   WN0013           Description
     C                     MOVEL*BLANK    WN0018           Reason Code
     C                     MOVEL'BD'      WN0018           Reason Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WN0013           Description
     C                     MOVEL@CN,013   WN0013           Description
     C                     MOVEL'DEL'     WN0018           Reason Code
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Prc Create Dtl Receipt XF - Item Transaction Detail  * 
     C                     CALL 'CAALXFR'              90  Prc Create Dtl
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0002    WQ0054  30       Company Number
     C                     PARM WN0019    WQ0055  70       Item Code
     C                     PARM WN0012    WQ0056  3        Warehouse Code
     C                     PARM WN0021    WQ0057  1        Inventory Trans
     C                     PARM WN0014    WQ0058  2        Inventory Trans
     C                     PARM WN0017    WQ0059  70       Transaction Dat
     C                     PARM WN0020    WQ0060  70       Production Date
     C                     PARM WN0013    WQ0061 30        Description
     C                     PARM WN0015    WQ0062 112       Transaction Qua
     C                     PARM WN0016    WQ0063 112       Transaction Wei
     C                     PARM WN0018    WQ0064  3        Reason Code
     C                     PARM WN0022    WQ0065  1        Shift Number
     C                     PARM WN0023    WQ0066  70       Label Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAALXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: DB1.PFS Tracking Type is Partial
     C           WAZ6NX    IFEQ 4                          *IF
     C                     MOVEL'PT'      WN0025           Yld Inv Balance
      * Prc Crt Partial Rcpt  XF - Yld Partial Transaction  * 
     C                     CALL 'POVAXFR'              90  Prc Crt Partial
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0002    WQ0067  30       Company Number
     C                     PARM WN0017    WQ0068  70       Transaction Dat
     C                     PARM WN0024    WQ0069  70       Partial Item Co
     C                     PARM WN0019    WQ0070  70       Item Code
     C                     PARM WN0020    WQ0071  70       Production Date
     C                     PARM WN0022    WQ0072  1        Production Shif
     C                     PARM WN0015    WQ0073  70       Yld Transaction
     C                     PARM WN0016    WQ0074 112       Yld Transaction
     C                     PARM WN0025    WQ0075  2        Yld Inv Balance
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POVAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: DB1.PFS Tracking Type is Reject
     C           WAZ6NX    IFEQ 6                          *IF
     C                     MOVEL'RJ'      WN0025           Yld Inv Balance
      * Prc Crt Partial Rcpt  XF - Yld Partial Transaction  * 
     C                     CALL 'POVAXFR'              90  Prc Crt Partial
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0002    WQ0076  30       Company Number
     C                     PARM WN0017    WQ0077  70       Transaction Dat
     C                     PARM WN0024    WQ0078  70       Partial Item Co
     C                     PARM WN0019    WQ0079  70       Item Code
     C                     PARM WN0020    WQ0080  70       Production Date
     C                     PARM WN0022    WQ0081  1        Production Shif
     C                     PARM WN0015    WQ0082  70       Yld Transaction
     C                     PARM WN0016    WQ0083 112       Yld Transaction
     C                     PARM WN0025    WQ0084  2        Yld Inv Balance
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POVAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: IM: Delete, IM: UnDelete, CC: Delete, CC: Add, or
      *  - c1 OR c2 OR c3 OR c4 OR c5 OR c6 OR c7 OR c8 OR c9
      *   |- c1    : DB1.PFS Transaction Type is IM: Delete
      *   |- c2    : DB1.PFS Transaction Type is IM: Undelete
      *   |- c3    : DB1.PFS Transaction Type is CC: Delete
      *   |- c4    : DB1.PFS Transaction Type is CC: Add
      *   |- c5    : DB1.PFS Transaction Type is CC: Add-ProdDate = 0
      *   |- c6    : DB1.PFS Transaction Type is BP: Batch Label Print
      *   |- c7    : DB1.PFS Transaction Type is IM: Adjust @ Shiping
      *   |- c8    : DB1.PFS Transaction Type is IM: Adjust @ Production
      *   |- c9    : DB1.PFS Transaction Type is WT: Warehouse Transfer
      *   '-
     C           WAVLSX    IFEQ 'I01'                      *IF
     C           WAVLSX    OREQ 'I02'                      *OR
     C           WAVLSX    OREQ 'C01'                      *OR
     C           WAVLSX    OREQ 'C02'                      *OR
     C           WAVLSX    OREQ 'C04'                      *OR
     C           WAVLSX    OREQ 'B01'                      *OR
     C           WAVLSX    OREQ 'I03'                      *OR
     C           WAVLSX    OREQ 'I04'                      *OR
     C           WAVLSX    OREQ 'W01'                      *OR
      * ... BP: Batch Printing, WT: Warehouse Transfer
      * Transaction Quantity & Weight
      * CASE: DB1.PFS Transaction Type is Inventory Delete
     C           WAVLSX    IFEQ 'C01'                      *IF
     C           WAVLSX    OREQ 'I01'
     C           WAVLSX    OREQ 'I04'
     C           WAVLSX    OREQ 'W01'
     C           WABDNY    MULT -1        WN0015           Transaction Qua
     C           WAABNY    MULT -1        WN0016           Transaction Wei
     C                     ELSE
      * CASE: DB1.PFS Transaction Type is Inventory Add
     C           WAVLSX    IFEQ 'C02'                      *IF
     C           WAVLSX    OREQ 'C04'
     C           WAVLSX    OREQ 'I02'
     C           WAVLSX    OREQ 'B01'
     C           WAVLSX    OREQ 'I03'
     C                     Z-ADDWABDNY    WN0015           Transaction Qua
     C                     Z-ADDWAABNY    WN0016           Transaction Wei
     C                     END                             *FI
     C                     END                             *FI
      * Update Prod Trace for Batch labels too .... RMC 5/26/06
      * CASE: DB1.PFS Transaction Type is Batch Printing
     C           WAVLSX    IFEQ 'B01'                      *IF
      * UPD:  Product Trace
      * CASE: PAR.Item Code is Scale Check Item 2222
     C           WN0019    IFEQ 2222                       *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWAZ2NX    WN0026           PT Serial Numbe
     C                     Z-ADDWAP7DT    WN0027           PT Prod Date YY
     C                     Z-ADDWAAFTS    WN0028           PT Production T
     C                     Z-ADDWAZ4NX    WN0042           PT Label Date Y
     C                     MOVEL'1'       WN0029           PT Inventory St
     C                     Z-ADDWAABNY    WN0030           PT Net Weight
     C                     Z-ADDWABENY    WN0031           PT Gross Weight
     C                     MOVELWAVKSX    WN0033           PT Shift Number
     C                     MOVELWAU4SX    WN0034           PT Warehouse ID
     C                     MOVELWAAGNY    WN0036           PT Pallet Numbe
     C                     Z-ADDWN0019    WN0032           PT Product Code
      * --- Offset Production Date & Time ---
     C                     MOVELWAZ2NX    YL0013           Text 10A USR
     C                     Z-ADD2         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00010
     C           ZQ        ORGT 00010
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0013:ZQ YL0014    P  90  Scale ID
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * Rtv Line/ID/Ofst p/Dt RT - Product Trace Line Scale  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0026           Company Number
     C                     MOVELYL0014    WL0027    P      Scale ID
     C                     Z-ADDWN0023    WL0028           Effective Label
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0029    YL0015           CS Scale Offset
     C                     MOVELWL0030    WN0048    P      CS Include in P
      * RMC 3/15/06 use par.pt prod date yyyymmdd instead of lcl.pt prod
     C                     Z-ADDWN0027    WN0037           PT Offset Prod
     C                     MULT -1        YL0015           CS Scale Offset
      * PAR.PT Offset Prod Time = PAR.PT Production Time + LCL.CS Scale O
     C                     Z-ADDWN0028    XTTIM
     C                     Z-ADD*ZERO     XASC    80
     C                     EXSR XTAD1
     C           60        MULT YL0015    XDWK1   80
     C                     ADD  XDWK1     XASC    80
     C                     EXSR XTCT1
     C                     Z-ADDXTTIM     WN0038
      * CASE: PAR.PT Offset Prod Time GT PAR.PT Production Time
     C           WN0038    IFGT WN0028                     *IF
      * PAR.PT Offset Prod Date = PAR.PT Offset Prod Date + CON.-1 *DAYS
     C           WN0037    SUB  18000000  XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-1        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111110' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0037
     C                     ELSE
     C           XDINDT    ADD  18000000  WN0037
     C                     END
     C                     END                             *FI
      * --- Item Picture Key ---
      * RTV Item Labels        RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0031           Company Number
     C                     Z-ADDWN0019    WL0032           Item Code
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0033    WUAVNA    P      Description Lin
     C                     MOVELWL0034    WN0039    P      Item Label Line
     C                     MOVELWL0035    WN0040    P      Item Label Line
     C                     Z-ADDWL0036    WN0045           Item Structure
     C                     Z-ADDWL0037    WN0046           Item Structure
     C                     Z-ADDWL0038    WN0047           Item Structure
     C                     MOVELWL0039    WN0044    P      Item Type Code
     C                     MOVELWL0040    WN0006    P      Made to Order C
     C                     MOVELWL0041    WN0007    P      Item Category C
     C                     MOVELWL0042    WN0008    P      Primal Group Co
      * Item Picture Key
      * CASE: PAR.Item Category Code 3 is Loint
     C           WN0007    IFEQ 'L61'                      *IF
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'LOINT'   WN0043           PT Item Picture
     C                     ELSE
      * CASE: *OTHERWISE
      * Item Picture Key
      * CASE: PAR.MTO Code is Entered
     C           WN0006    IFGT *BLANK                     *IF
      * PFN
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.MTO Code is PFN
      *   |- c2    : PAR.MTO Code is IWG
      *   '-
     C           WN0006    IFEQ 'PFN'                      *IF
     C           WN0006    OREQ 'IWG'                      *OR
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'PFN'     WN0043           PT Item Picture
     C                     END                             *FI
      * PFT
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.MTO Code is EHP
      *   |- c2    : PAR.MTO Code is KRG
      *   '-
     C           WN0006    IFEQ 'EHP'                      *IF
     C           WN0006    OREQ 'KRG'                      *OR
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'PFT'     WN0043           PT Item Picture
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5
      *   |- c1    : PAR.Primal Group Code is BUTT
      *   |- c2    : PAR.Primal Group Code is HAM
      *   |- c3    : PAR.Primal Group Code is LOIN
      *   |- c4    : PAR.Primal Group Code is PICNIC
      *   |- c5    : PAR.Primal Group Code is RIBS
      *   '-
     C           WN0008    IFEQ 'BUTT'                     *IF
     C           WN0008    OREQ 'HAM'                      *OR
     C           WN0008    OREQ 'LOIN'                     *OR
     C           WN0008    OREQ @CN,006                    *OR
     C           WN0008    OREQ 'RIBS'                     *OR
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVELWN0008    WN0043           PT Item Picture
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Primal Group Code is HAMC
     C           WN0008    IFEQ 'HAMC'                     *IF
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'HAM'     WN0043           PT Item Picture
     C                     ELSE
      * CASE: PAR.Primal Group Code is LOINC
     C           WN0008    IFEQ 'LOINC'                    *IF
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'LOIN'    WN0043           PT Item Picture
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'LOGO'    WN0043           PT Item Picture
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * RTV Warehouse Type     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0012    WL0043    P      Warehouse Code
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0044    WN0041    P      Warehouse Type
      * --- Create Product Trace Record ---
      * Crt Product Trace     CR - Product Trace  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0045           Company Number
     C                     Z-ADDWN0026    WL0046           PT Serial Numbe
     C                     Z-ADDWN0027    WL0047           PT Prod Date YY
     C                     Z-ADDWN0028    WL0048           PT Production T
     C                     Z-ADDWN0042    WL0049           PT Label Date Y
     C                     Z-ADDWN0037    WL0050           PT Offset Prod
     C                     Z-ADDWN0038    WL0051           PT Offset Prod
     C                     MOVELWN0029    WL0052    P      PT Inventory St
     C                     Z-ADDWN0030    WL0053           PT Net Weight
     C                     Z-ADDWN0031    WL0054           PT Gross Weight
     C                     MOVELWN0033    WL0055    P      PT Shift Number
     C                     MOVELWN0034    WL0056    P      PT Warehouse ID
     C                     Z-ADDWN0035    WL0057           PT Order Number
     C                     MOVELWN0036    WL0058    P      PT Pallet Numbe
     C                     Z-ADDWN0032    WL0059           PT Product Code
     C                     MOVELWN0039    WL0060    P      PT Item Label L
     C                     MOVELWN0040    WL0061    P      PT Item Label L
     C                     MOVELWN0041    WL0062    P      PT Fresh/Frozen
     C                     MOVELWN0043    WL0063    P      PT Item Picture
     C                     Z-ADD*ZERO     WL0064           PT Tattoo Numbe
     C                     MOVELWUOTTX    WL0065    P      PT Source Type
     C                     MOVEL*BLANK    WL0066           PT Source Code
     C                     MOVEL*BLANK    WL0067           PT Source Code
     C                     MOVEL*BLANK    WL0068           PT Producer/Cel
     C                     MOVEL*BLANK    WL0069           PT Producer/Cel
     C                     MOVEL*BLANK    WL0070           PT Producer/Far
     C                     MOVEL*BLANK    WL0071           PT Producer Loc
     C                     MOVEL*BLANK    WL0072           PT Producer/Far
     C                     MOVEL*BLANK    WL0073           PT Producer/Far
     C                     MOVELWUOTTX    WL0074    P      PT Producer/Far
     C                     MOVEL*BLANK    WL0075           PT Producer/Far
     C                     MOVEL*BLANK    WL0076           PT Genetic Code
     C                     MOVEL*BLANK    WL0077           PT Genetic Desc
     C                     MOVELWUOTTX    WL0078    P      PT Gender Code
     C                     MOVEL*BLANK    WL0079           PT Producer/Far
     C                     MOVEL*BLANK    WL0080           PT Producer/Far
     C                     MOVEL*BLANK    WL0081           PT Producer/Far
     C                     MOVEL*BLANK    WL0082           PT Producer/Far
     C                     MOVELWN0044    WL0083    P      PT Item Type Co
     C                     Z-ADDWN0045    WL0084           PT Item Str Cla
     C                     Z-ADDWN0046    WL0085           PT Item Str Gro
     C                     Z-ADDWN0047    WL0086           PT Item Str Typ
     C                     Z-ADD*ZERO     WL0087           PT WIP Dump/Pro
     C                     Z-ADD*ZERO     WL0088           PT WIP Dump/Pro
     C                     MOVELWUXKTX    WL0089    P      PT WIP Dump/Pro
     C                     MOVELWUOTTX    WL0090    P      PT WIP Used/Not
     C                     Z-ADD*ZERO     WL0091           PT From FG Seri
     C                     Z-ADD*ZERO     WL0092           PT To FG Serial
     C                     Z-ADD*ZERO     WL0093           PT Unused Nbr 3
     C                     Z-ADD*ZERO     WL0094           PT Unused Nbr 4
     C                     MOVELWN0048    WL0095    P      PT Incl in Prod
     C                     MOVELWUOTTX    WL0096    P      PT Unused Sts 4
     C                     Z-ADD*ZERO     WL0097           Job Time
     C                     MOVEL*BLANK    WL0098           User Id
     C                     MOVEL*BLANK    WL0099           Job Name
     C                     Z-ADD*ZERO     WL0100           Job Date
     C                     EXSR SRCRRC
     C                     END                             *FI
     C                     END                             *FI
      * ----- Adjust Item Balance & Item Balance Detail -----
      * PROCESS: Finished Goods & WIP Delete
      * CASE: Finished Goods or Work In Process
      *  - c1 OR c2 OR c3 OR c4 OR c5
      *   |- c1    : DB1.PFS Tracking Type is Finished Goods
      *   |- c2    : DB1.PFS Tracking Type is Export
      *   |- c3    : DB1.PFS Tracking Type is Casings
      *   |- c4    : DB1.PFS Tracking Type is Export 2
      *   |- c5    : DB1.PFS Tracking Type is Work In Process
      *   '-
     C           WAZ6NX    IFEQ 1                          *IF
     C           WAZ6NX    OREQ 2                          *OR
     C           WAZ6NX    OREQ 7                          *OR
     C           WAZ6NX    OREQ 8                          *OR
     C           WAZ6NX    OREQ 3                          *OR
      * CRT: Item Transaction Detail
      * Inventory Trans. Type
      * CASE: DB1.PFS Transaction Type is WT: Warehouse Transfer
     C           WAVLSX    IFEQ 'W01'                      *IF
     C                     MOVEL'T'       WN0021           Inventory Trans
     C                     MOVEL'TW'      WN0014           Inventory Trans
     C                     MOVEL*BLANK    WN0013           Description
     C                     MOVEL@CN,014   WN0013           Description
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.PFS Inv Adj Reason Code is PFS: Rework
      *   |- c2    : DB1.PFS Inv Adj Reason Code is PFS: QA
      *   '-
     C           WAVMSX    IFEQ '02'                       *IF
     C           WAVMSX    OREQ '01'                       *OR
     C                     MOVEL'R'       WN0021           Inventory Trans
     C                     MOVEL'RR'      WN0014           Inventory Trans
     C                     MOVEL*BLANK    WN0013           Description
     C                     MOVEL@CN,009   WN0013           Description
     C                     ELSE
      * CASE: DB1.PFS Inv Adj Reason Code is PFS: Issue
     C           WAVMSX    IFEQ '07'                       *IF
     C                     MOVEL'R'       WN0021           Inventory Trans
     C                     MOVEL'RR'      WN0014           Inventory Trans
     C                     MOVEL*BLANK    WN0013           Description
     C                     MOVEL@CN,015   WN0013           Description
     C                     ELSE
      * CASE: DB1.PFS Inv Adj Reason Code is PFS: Rendering
     C           WAVMSX    IFEQ '03'                       *IF
     C                     MOVEL'A'       WN0021           Inventory Trans
     C                     MOVEL*BLANK    WN0014           Inventory Trans
     C                     MOVEL'A'       WN0014           Inventory Trans
     C                     MOVEL*BLANK    WN0013           Description
     C                     MOVEL@CN,016   WN0013           Description
     C                     ELSE
      * CASE: DB1.PFS Inv Adj Reason Code is PFS: Rework Damage Box
     C           WAVMSX    IFEQ '09'                       *IF
      * RMC Added 3/14/18 T12764   - change to R RR inv trans id per BJ/K
     C                     MOVEL'R'       WN0021           Inventory Trans
     C                     MOVEL'RR'      WN0014           Inventory Trans
     C                     MOVEL*BLANK    WN0013           Description
     C                     MOVEL@CN,012   WN0013           Description
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'A'       WN0021           Inventory Trans
     C                     MOVEL*BLANK    WN0014           Inventory Trans
     C                     MOVEL'A'       WN0014           Inventory Trans
     C                     MOVEL*BLANK    WN0013           Description
     C                     MOVEL@CN,017   WN0013           Description
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Reason Code
      * CASE: DB1.PFS Transaction Type is Batch Printing
     C           WAVLSX    IFEQ 'B01'                      *IF
     C                     MOVEL'BLP'     WN0018           Reason Code
     C                     ELSE
      * CASE: DB1.PFS Transaction Type is IM: Delete
     C           WAVLSX    IFEQ 'I01'                      *IF
      * Reason Code
      * CASE: DB1.PFS Inv Adj Reason Code is Rework
     C           WAVMSX    IFEQ '02'                       *IF
     C                     MOVEL'DLR'     WN0018           Reason Code
     C                     ELSE
      * CASE: DB1.PFS Inv Adj Reason Code is PFS: Rendering
     C           WAVMSX    IFEQ '03'                       *IF
     C                     MOVEL'DLT'     WN0018           Reason Code
     C                     ELSE
      * CASE: DB1.PFS Inv Adj Reason Code is PFS: Lost Box
     C           WAVMSX    IFEQ '04'                       *IF
     C                     MOVEL'DLB'     WN0018           Reason Code
     C                     ELSE
      * CASE: DB1.PFS Inv Adj Reason Code is PFS: EE's Sales/5YrAward
     C           WAVMSX    IFEQ '05'                       *IF
     C                     MOVEL'DLM'     WN0018           Reason Code
     C                     ELSE
      * CASE: DB1.PFS Inv Adj Reason Code is PFS: Adjustment
     C           WAVMSX    IFEQ '06'                       *IF
     C                     MOVEL'DLA'     WN0018           Reason Code
     C                     ELSE
      * CASE: DB1.PFS Inv Adj Reason Code is PFS: Issue
     C           WAVMSX    IFEQ '07'                       *IF
     C                     MOVEL'DLI'     WN0018           Reason Code
     C                     ELSE
      * CASE: DB1.PFS Inv Adj Reason Code is PFS: Cycle Count
     C           WAVMSX    IFEQ '08'                       *IF
     C                     MOVEL'DCC'     WN0018           Reason Code
     C                     ELSE
      * CASE: DB1.PFS Inv Adj Reason Code is PFS: QA
     C           WAVMSX    IFEQ '01'                       *IF
     C                     MOVEL'DQA'     WN0018           Reason Code
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.PFS Transaction Type is IM: Undelete
     C           WAVLSX    IFEQ 'I02'                      *IF
     C                     MOVEL'UDL'     WN0018           Reason Code
     C                     ELSE
      * CASE: DB1.PFS Transaction Type is IM: Adjust @ Shiping
     C           WAVLSX    IFEQ 'I03'                      *IF
     C                     MOVEL'ADD'     WN0018           Reason Code
     C                     ELSE
      * CASE: DB1.PFS Transaction Type is IM: Adjust @ Production
     C           WAVLSX    IFEQ 'I04'                      *IF
     C                     MOVEL'SAD'     WN0018           Reason Code
     C                     ELSE
      * CASE: DB1.PFS Transaction Type is Cycle Count Inv Adjust
     C           WAVLSX    IFEQ 'C02'                      *IF
     C           WAVLSX    OREQ 'C04'
     C           WAVLSX    OREQ 'C01'
     C                     MOVEL'CCA'     WN0018           Reason Code
     C                     ELSE
      * CASE: DB1.PFS Transaction Type is WT: Warehouse Transfer
     C           WAVLSX    IFEQ 'W01'                      *IF
     C                     MOVEL'TRF'     WN0018           Reason Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WN0018           Reason Code
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Prc Create Dtl Receipt XF - Item Transaction Detail  * 
     C                     CALL 'CAALXFR'              90  Prc Create Dtl
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0002    WQ0085  30       Company Number
     C                     PARM WN0019    WQ0086  70       Item Code
     C                     PARM WN0012    WQ0087  3        Warehouse Code
     C                     PARM WN0021    WQ0088  1        Inventory Trans
     C                     PARM WN0014    WQ0089  2        Inventory Trans
     C                     PARM WN0017    WQ0090  70       Transaction Dat
     C                     PARM WN0020    WQ0091  70       Production Date
     C                     PARM WN0013    WQ0092 30        Description
     C                     PARM WN0015    WQ0093 112       Transaction Qua
     C                     PARM WN0016    WQ0094 112       Transaction Wei
     C                     PARM WN0018    WQ0095  3        Reason Code
     C                     PARM WN0022    WQ0096  1        Shift Number
     C                     PARM WN0023    WQ0097  70       Label Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAALXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * TO Warehouse : ONLY CREATE TRANS IF TO WAREHOUSE IS VALID. RMC 5.
      * CASE: DB1.PFS Transaction Type is WT: Warehouse Transfer
     C           WAVLSX    IFEQ 'W01'                      *IF
      * RMC 5.5.2021 ADDED WHSE VALIDATION. INV WAREHOUSES WERE GETTING I
      * RTV Whse Descrip       RT - Warehouse  * 
     C                     EXSR SSRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Prc Create Dtl Receipt XF - Item Transaction Detail  * 
     C                     CALL 'CAALXFR'              90  Prc Create Dtl
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0002    WQ0098  30       Company Number
     C                     PARM WN0019    WQ0099  70       Item Code
     C                     PARM WAGBAA    WQ0100  3        Warehouse Code
     C                     PARM WN0021    WQ0101  1        Inventory Trans
     C                     PARM WN0014    WQ0102  2        Inventory Trans
     C                     PARM WN0017    WQ0103  70       Transaction Dat
     C                     PARM WN0020    WQ0104  70       Production Date
     C                     PARM WN0013    WQ0105 30        Description
     C                     PARM WABDNY    WQ0106 112       Transaction Qua
     C                     PARM WAABNY    WQ0107 112       Transaction Wei
     C                     PARM WN0018    WQ0108  3        Reason Code
     C                     PARM WN0022    WQ0109  1        Shift Number
     C                     PARM WN0023    WQ0110  70       Label Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAALXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ----- Adjust Located Quantity and Weight -----
      * PROCESS:  Lot Tracking = Y
      * CASE: DB1.PFS Transaction Type is Batch Printing
     C           WAVLSX    IFEQ 'B01'                      *IF
      * Decision made on 10/05/05---will receive a locate transaction for
      * batch label and add to located quantity.
     C                     ELSE
      * CASE: DB1.PFS Transaction Type is WT: Warehouse Transfer
     C           WAVLSX    IFEQ 'W01'                      *IF
      * Warehouse transfers will not adjust located because product
      * shouldn't be located yet.
     C                     ELSE
      * CASE: *OTHERWISE
      * PROCESS: Finished Goods
      * CASE: Finished Goods
      *  - c1 OR c2 OR c3 OR c4
      *   |- c1    : DB1.PFS Tracking Type is Finished Goods
      *   |- c2    : DB1.PFS Tracking Type is Export
      *   |- c3    : DB1.PFS Tracking Type is Casings
      *   |- c4    : DB1.PFS Tracking Type is Export 2
      *   '-
     C           WAZ6NX    IFEQ 1                          *IF
     C           WAZ6NX    OREQ 2                          *OR
     C           WAZ6NX    OREQ 7                          *OR
     C           WAZ6NX    OREQ 8                          *OR
      * CASE: PAR.Lot Tracking Flag is yes
     C           WN0049    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    WN0067           LLT Transaction
     C                     MOVEL'A'       WN0067           LLT Transaction
     C                     MOVEL'A'       WN0052           ILL Status
     C                     MOVEL*BLANK    WN0053           Inv Hold Reason
     C                     Z-ADDWN0015    WN0054           ILL Item Qty On
     C                     Z-ADDWN0016    WN0055           ILL Item Wgt On
      * PFS Item Loc/Crt Trn  CR - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0101           Company Number
     C                     Z-ADDWN0019    WL0102           Item Code
     C                     MOVELWN0012    WL0103    P      Warehouse Code
     C                     Z-ADDWN0020    WL0104           Production Date
     C                     Z-ADD*ZERO     WL0105           Lot Number
     C                     MOVELWN0051    WL0106    P      Location Code
     C                     Z-ADD*ZERO     WL0107           Location Level
     C                     Z-ADDWN0054    WL0108           ILL Item Qty On
     C                     Z-ADD*ZERO     WL0109           ILL Unit Weight
     C                     Z-ADD*ZERO     WL0110           ILL Co-Packer L
     C                     Z-ADDWN0055    WL0111           ILL Item Wgt On
     C                     Z-ADD*ZERO     WL0112           ILL Unused Qty
     C                     Z-ADD*ZERO     WL0113           ILL Unused Wgt
     C                     Z-ADD*ZERO     WL0114           ILL Avail Ship
     C                     Z-ADD*ZERO     WL0115           ILL Unused Date
     C                     Z-ADD*ZERO     WL0116           ILL Unused Date
     C                     Z-ADD*ZERO     WL0117           ILL Unused Nbr
     C                     MOVEL*BLANK    WL0118           ILL Customer Co
     C                     MOVELWN0052    WL0119    P      ILL Status
     C                     MOVELWUASSX    WL0120    P      ILL Unused Sts
     C                     MOVELWUATSX    WL0121    P      ILL Unused Sts
     C                     MOVELWUAUSX    WL0122    P      ILL Unused Sts
     C                     MOVELWN0053    WL0123    P      Inv Hold Reason
     C                     MOVELWUUVST    WL0124    P      EDI Status 1
     C                     MOVELWUUWST    WL0125    P      EDI Status 2
     C                     MOVELWUUXST    WL0126    P      EDI Status 3
     C                     MOVELWUVSST    WL0127    P      Record Status
     C                     Z-ADD*ZERO     WL0128           Job Time
     C                     MOVEL*BLANK    WL0129           User Id
     C                     MOVEL*BLANK    WL0130           Job Name
     C                     Z-ADD*ZERO     WL0131           Job Date
     C                     MOVELWN0067    WL0132    P      LLT Transaction
     C                     EXSR STCRRC
      * CRT:  Create Item Balance Detail record if one does not exist
      * Crt Item Balance Dtl  RT - Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0176           Company Number
     C                     Z-ADDWN0019    WL0177           Item Code
     C                     MOVELWN0012    WL0178    P      Warehouse Code
     C                     Z-ADDWN0020    WL0179           Production Date
     C                     EXSR TCRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ***** FREEZER TRANSACTIONS    *****
      * CASE: PAR.Lot Tracking Flag is yes
     C           WN0049    IFEQ 'Y'                        *IF
      * Process F01, F02, F03, F04, & C04
      * CASE: DB1.PFS Transaction Type is FM: Freezer Putaway
     C           WAVLSX    IFEQ 'F01'                      *IF
      * Add to Location for Receipt
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.PFS Warehouse Code is Entered
      *   |- c2    : DB1.PFS Location Code is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAU4SX    IFNE *BLANK                     *IF
     C           WAADNY    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL*BLANK    WN0067           LLT Transaction
     C                     MOVEL'R'       WN0067           LLT Transaction
     C                     Z-ADDWABDNY    WN0054           ILL Item Qty On
     C                     Z-ADDWAABNY    WN0055           ILL Item Wgt On
      * PFS Item Loc/Crt Trn  CR - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0101           Company Number
     C                     Z-ADDWN0019    WL0102           Item Code
     C                     MOVELWN0012    WL0103    P      Warehouse Code
     C                     Z-ADDWN0020    WL0104           Production Date
     C                     Z-ADD*ZERO     WL0105           Lot Number
     C                     MOVELWN0051    WL0106    P      Location Code
     C                     Z-ADD*ZERO     WL0107           Location Level
     C                     Z-ADDWN0054    WL0108           ILL Item Qty On
     C                     Z-ADD*ZERO     WL0109           ILL Unit Weight
     C                     Z-ADD*ZERO     WL0110           ILL Co-Packer L
     C                     Z-ADDWN0055    WL0111           ILL Item Wgt On
     C                     Z-ADD*ZERO     WL0112           ILL Unused Qty
     C                     Z-ADD*ZERO     WL0113           ILL Unused Wgt
     C                     Z-ADD*ZERO     WL0114           ILL Avail Ship
     C                     Z-ADD*ZERO     WL0115           ILL Unused Date
     C                     Z-ADD*ZERO     WL0116           ILL Unused Date
     C                     Z-ADD*ZERO     WL0117           ILL Unused Nbr
     C                     MOVEL*BLANK    WL0118           ILL Customer Co
     C                     MOVELWN0052    WL0119    P      ILL Status
     C                     MOVELWUASSX    WL0120    P      ILL Unused Sts
     C                     MOVELWUATSX    WL0121    P      ILL Unused Sts
     C                     MOVELWUAUSX    WL0122    P      ILL Unused Sts
     C                     MOVELWN0053    WL0123    P      Inv Hold Reason
     C                     MOVELWUUVST    WL0124    P      EDI Status 1
     C                     MOVELWUUWST    WL0125    P      EDI Status 2
     C                     MOVELWUUXST    WL0126    P      EDI Status 3
     C                     MOVELWUVSST    WL0127    P      Record Status
     C                     Z-ADD*ZERO     WL0128           Job Time
     C                     MOVEL*BLANK    WL0129           User Id
     C                     MOVEL*BLANK    WL0130           Job Name
     C                     Z-ADD*ZERO     WL0131           Job Date
     C                     MOVELWN0067    WL0132    P      LLT Transaction
     C                     EXSR STCRRC
      * CRT:  Create Item Balance Detail record if one does not exist
      * Crt Item Balance Dtl  RT - Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0176           Company Number
     C                     Z-ADDWN0019    WL0177           Item Code
     C                     MOVELWN0012    WL0178    P      Warehouse Code
     C                     Z-ADDWN0020    WL0179           Production Date
     C                     EXSR TCRVGN
      * UPD:  Product Trace Warehouse Code
     C                     Z-ADDWAZ4NX    WN0042           PT Label Date Y
     C                     Z-ADDWAZ2NX    WN0026           PT Serial Numbe
     C                     MOVELWAU4SX    WN0034           PT Warehouse ID
      * SLM MTECH Review Product Trace - WareHouse only
      * PFS Upd Warehouse     RT - Product Trace  * 
     C                     EXSR TFRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE:
      *  - c2 OR c3
      *   |- c2    : DB1.PFS Transaction Type is FM: Freezer ReLocate
      *   |- c3    : DB1.PFS Transaction Type is CC: Move to Current Loc
      *   '-
     C           WAVLSX    IFEQ 'F02'                      *IF
     C           WAVLSX    OREQ 'C03'                      *OR
      * **** check if quantity available in the location. ****
      * ----- Reduce From Location -----
     C                     MOVEL*BLANK    WN0067           LLT Transaction
     C                     MOVEL'T'       WN0067           LLT Transaction
     C                     MOVEL'A'       WN0052           ILL Status
     C                     MOVEL*BLANK    WN0053           Inv Hold Reason
     C           WABDNY    MULT -1        YL0021           ILL Item Qty On
     C           WAABNY    MULT -1        YL0022           ILL Item Wgt On
      * PFS Item Loc/Crt Trn  CR - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0101           Company Number
     C                     Z-ADDWN0019    WL0102           Item Code
     C                     MOVELWN0012    WL0103    P      Warehouse Code
     C                     Z-ADDWN0020    WL0104           Production Date
     C                     Z-ADD*ZERO     WL0105           Lot Number
     C                     MOVELWN0051    WL0106    P      Location Code
     C                     Z-ADD*ZERO     WL0107           Location Level
     C                     Z-ADDYL0021    WL0108           ILL Item Qty On
     C                     Z-ADD*ZERO     WL0109           ILL Unit Weight
     C                     Z-ADD*ZERO     WL0110           ILL Co-Packer L
     C                     Z-ADDYL0022    WL0111           ILL Item Wgt On
     C                     Z-ADD*ZERO     WL0112           ILL Unused Qty
     C                     Z-ADD*ZERO     WL0113           ILL Unused Wgt
     C                     Z-ADD*ZERO     WL0114           ILL Avail Ship
     C                     Z-ADD*ZERO     WL0115           ILL Unused Date
     C                     Z-ADD*ZERO     WL0116           ILL Unused Date
     C                     Z-ADD*ZERO     WL0117           ILL Unused Nbr
     C                     MOVEL*BLANK    WL0118           ILL Customer Co
     C                     MOVELWN0052    WL0119    P      ILL Status
     C                     MOVELWUASSX    WL0120    P      ILL Unused Sts
     C                     MOVELWUATSX    WL0121    P      ILL Unused Sts
     C                     MOVELWUAUSX    WL0122    P      ILL Unused Sts
     C                     MOVELWN0053    WL0123    P      Inv Hold Reason
     C                     MOVELWUUVST    WL0124    P      EDI Status 1
     C                     MOVELWUUWST    WL0125    P      EDI Status 2
     C                     MOVELWUUXST    WL0126    P      EDI Status 3
     C                     MOVELWUVSST    WL0127    P      Record Status
     C                     Z-ADD*ZERO     WL0128           Job Time
     C                     MOVEL*BLANK    WL0129           User Id
     C                     MOVEL*BLANK    WL0130           Job Name
     C                     Z-ADD*ZERO     WL0131           Job Date
     C                     MOVELWN0067    WL0132    P      LLT Transaction
     C                     EXSR STCRRC
      * --- Create Item Balance Detail record if one does not exist ---
      * Crt Item Balance Dtl  RT - Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0176           Company Number
     C                     Z-ADDWN0019    WL0177           Item Code
     C                     MOVELWN0012    WL0178    P      Warehouse Code
     C                     Z-ADDWN0020    WL0179           Production Date
     C                     EXSR TCRVGN
      * -----  Add to Location -----
      * Transfer Transaction
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.PFS To Warehouse Code is Entered
      *   |- c2    : DB1.PFS To Location Code is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAGBAA    IFNE *BLANK                     *IF
     C           WAANNY    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'RT'      WN0067           LLT Transaction
     C                     MOVELWAGBAA    YL0004           Warehouse Code
     C                     MOVELWAANNY    YL0023           Location Code
     C                     Z-ADDWABDNY    WN0054           ILL Item Qty On
     C                     Z-ADDWAABNY    WN0055           ILL Item Wgt On
      * PFS Item Loc/Crt Trn  CR - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0101           Company Number
     C                     Z-ADDWN0019    WL0102           Item Code
     C                     MOVELYL0004    WL0103    P      Warehouse Code
     C                     Z-ADDWN0020    WL0104           Production Date
     C                     Z-ADD*ZERO     WL0105           Lot Number
     C                     MOVELYL0023    WL0106    P      Location Code
     C                     Z-ADD*ZERO     WL0107           Location Level
     C                     Z-ADDWN0054    WL0108           ILL Item Qty On
     C                     Z-ADD*ZERO     WL0109           ILL Unit Weight
     C                     Z-ADD*ZERO     WL0110           ILL Co-Packer L
     C                     Z-ADDWN0055    WL0111           ILL Item Wgt On
     C                     Z-ADD*ZERO     WL0112           ILL Unused Qty
     C                     Z-ADD*ZERO     WL0113           ILL Unused Wgt
     C                     Z-ADD*ZERO     WL0114           ILL Avail Ship
     C                     Z-ADD*ZERO     WL0115           ILL Unused Date
     C                     Z-ADD*ZERO     WL0116           ILL Unused Date
     C                     Z-ADD*ZERO     WL0117           ILL Unused Nbr
     C                     MOVEL*BLANK    WL0118           ILL Customer Co
     C                     MOVELWN0052    WL0119    P      ILL Status
     C                     MOVELWUASSX    WL0120    P      ILL Unused Sts
     C                     MOVELWUATSX    WL0121    P      ILL Unused Sts
     C                     MOVELWUAUSX    WL0122    P      ILL Unused Sts
     C                     MOVELWN0053    WL0123    P      Inv Hold Reason
     C                     MOVELWUUVST    WL0124    P      EDI Status 1
     C                     MOVELWUUWST    WL0125    P      EDI Status 2
     C                     MOVELWUUXST    WL0126    P      EDI Status 3
     C                     MOVELWUVSST    WL0127    P      Record Status
     C                     Z-ADD*ZERO     WL0128           Job Time
     C                     MOVEL*BLANK    WL0129           User Id
     C                     MOVEL*BLANK    WL0130           Job Name
     C                     Z-ADD*ZERO     WL0131           Job Date
     C                     MOVELWN0067    WL0132    P      LLT Transaction
     C                     EXSR STCRRC
      * --- Create Item Balance Detail record if one does not exist ---
      * Crt Item Balance Dtl  RT - Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0176           Company Number
     C                     Z-ADDWN0019    WL0177           Item Code
     C                     MOVELYL0004    WL0178    P      Warehouse Code
     C                     Z-ADDWN0020    WL0179           Production Date
     C                     EXSR TCRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.PFS Transaction Type is FM: Freezer Hold
     C           WAVLSX    IFEQ 'F03'                      *IF
     C                     MOVEL'H'       WN0052           ILL Status
     C                     MOVEL*BLANK    WN0053           Inv Hold Reason
     C                     MOVELWAVMSX    WN0053           Inv Hold Reason
      * Upd Location Hold PFS RT - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0180           Company Number
     C                     Z-ADDWN0019    WL0181           Item Code
     C                     MOVELWN0012    WL0182    P      Warehouse Code
     C                     Z-ADDWN0020    WL0183           Production Date
     C                     Z-ADD*ZERO     WL0184           Lot Number
     C                     MOVELWN0051    WL0185    P      Location Code
     C                     Z-ADD*ZERO     WL0186           Location Level
     C                     MOVELWN0052    WL0187    P      ILL Status
     C                     MOVELWN0053    WL0188    P      Inv Hold Reason
     C                     EXSR THRVGN
     C                     ELSE
      * CASE: DB1.PFS Transaction Type is FM: Freezer Release Hold
     C           WAVLSX    IFEQ 'F04'                      *IF
     C                     MOVEL'A'       WN0052           ILL Status
     C                     MOVEL*BLANK    WN0053           Inv Hold Reason
      * Upd Location Hold PFS RT - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0180           Company Number
     C                     Z-ADDWN0019    WL0181           Item Code
     C                     MOVELWN0012    WL0182    P      Warehouse Code
     C                     Z-ADDWN0020    WL0183           Production Date
     C                     Z-ADD*ZERO     WL0184           Lot Number
     C                     MOVELWN0051    WL0185    P      Location Code
     C                     Z-ADD*ZERO     WL0186           Location Level
     C                     MOVELWN0052    WL0187    P      ILL Status
     C                     MOVELWN0053    WL0188    P      Inv Hold Reason
     C                     EXSR THRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ***** SHIPPING TRANSACTIONS   *****
      * CASE: Product Return | Co-Pack Receipt | Inter-Plant Tfr
      *  - c1 OR c2 OR c3 OR c4
      *   |- c1    : DB1.PFS Transaction Type is SM: Product Return
      *   |- c2    : DB1.PFS Transaction Type is SM: Receive Co-Pack Item
      *   |- c3    : DB1.PFS Transaction Type is SM: Inter-Plant Tranfer
      *   |- c4    : DB1.PFS Transaction Type is SM: Product Return WO/Or
      *   '-
     C           WAVLSX    IFEQ 'S04'                      *IF
     C           WAVLSX    OREQ 'S05'                      *OR
     C           WAVLSX    OREQ 'S06'                      *OR
     C           WAVLSX    OREQ 'S07'                      *OR
      * ----- Increase Item Balance & Item Balance Detail -----
      * PROCESS: Finished Goods
      * CASE: Finished Goods
      *  - c1 OR c2 OR c3 OR c4
      *   |- c1    : DB1.PFS Tracking Type is Finished Goods
      *   |- c2    : DB1.PFS Tracking Type is Export
      *   |- c3    : DB1.PFS Tracking Type is Casings
      *   |- c4    : DB1.PFS Tracking Type is Export 2
      *   '-
     C           WAZ6NX    IFEQ 1                          *IF
     C           WAZ6NX    OREQ 2                          *OR
     C           WAZ6NX    OREQ 7                          *OR
     C           WAZ6NX    OREQ 8                          *OR
      * CRT: Item Transaction Detail
      * Inventory Trans ID & Inventory Trans Type
      * CASE: DB1.PFS Transaction Type is SM: Inter-Plant Tranfer
     C           WAVLSX    IFEQ 'S06'                      *IF
     C                     MOVEL'T'       WN0021           Inventory Trans
     C                     MOVEL'TW'      WN0014           Inventory Trans
     C                     MOVELWAZPNX    YL0024           Order Alpha
     C                     Z-ADD1         ZQ      50
     C           @CN,018   CAT  YL0024:ZQ WN0013    P      Description
     C                     ELSE
      * CASE: DB1.PFS Transaction Type is SM: Receive Co-Pack Items
     C           WAVLSX    IFEQ 'S05'                      *IF
     C                     MOVEL'T'       WN0021           Inventory Trans
     C                     MOVEL'TW'      WN0014           Inventory Trans
     C                     Z-ADD1         ZQ      50
     C           @CN,019   CAT  ' ':ZQ    WN0013    P      Description
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'R'       WN0021           Inventory Trans
     C                     MOVEL*BLANK    WN0014           Inventory Trans
     C                     MOVEL'R'       WN0014           Inventory Trans
     C                     MOVEL*BLANK    WN0013           Description
     C                     MOVEL@CN,020   WN0013           Description
     C                     END                             *FI
     C                     END                             *FI
      * Reason Code
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : DB1.PFS Transaction Type is SM: Product Return
      *   |- c2    : DB1.PFS Transaction Type is SM: Receive Co-Pack Item
      *   |- c3    : DB1.PFS Transaction Type is SM: Product Return WO/Or
      *   '-
     C           WAVLSX    IFEQ 'S04'                      *IF
     C           WAVLSX    OREQ 'S05'                      *OR
     C           WAVLSX    OREQ 'S07'                      *OR
     C                     MOVEL'RET'     WN0018           Reason Code
     C                     ELSE
      * CASE: DB1.PFS Transaction Type is WT: Inter-Plant Transfer
     C           WAVLSX    IFEQ 'S06'                      *IF
     C                     MOVEL'TRF'     WN0018           Reason Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WN0018           Reason Code
     C                     END                             *FI
     C                     END                             *FI
      * Prc Create Dtl Receipt XF - Item Transaction Detail  * 
     C                     CALL 'CAALXFR'              90  Prc Create Dtl
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0002    WQ0113  30       Company Number
     C                     PARM WN0019    WQ0114  70       Item Code
     C                     PARM WN0012    WQ0115  3        Warehouse Code
     C                     PARM WN0021    WQ0116  1        Inventory Trans
     C                     PARM WN0014    WQ0117  2        Inventory Trans
     C                     PARM WN0017    WQ0118  70       Transaction Dat
     C                     PARM WN0020    WQ0119  70       Production Date
     C                     PARM WN0013    WQ0120 30        Description
     C                     PARM WN0015    WQ0121 112       Transaction Qua
     C                     PARM WN0016    WQ0122 112       Transaction Wei
     C                     PARM WN0018    WQ0123  3        Reason Code
     C                     PARM WN0022    WQ0124  1        Shift Number
     C                     PARM WN0023    WQ0125  70       Label Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAALXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: DB1.PFS Transaction Type is SM: Receive Co-Pack Items
     C           WAVLSX    IFEQ 'S05'                      *IF
      * UPD:  Product Trace
      * CASE: PAR.Item Code is Scale Check Item 2222
     C           WN0019    IFEQ 2222                       *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWAZ2NX    WN0026           PT Serial Numbe
     C                     Z-ADDWAP7DT    WN0027           PT Prod Date YY
     C                     Z-ADDWAAFTS    WN0028           PT Production T
     C                     Z-ADDWAZ4NX    WN0042           PT Label Date Y
     C                     MOVEL'1'       WN0029           PT Inventory St
     C                     Z-ADDWAABNY    WN0030           PT Net Weight
     C                     Z-ADDWABENY    WN0031           PT Gross Weight
     C                     MOVELWAVKSX    WN0033           PT Shift Number
     C                     MOVELWAU4SX    WN0034           PT Warehouse ID
     C                     MOVELWAAGNY    WN0036           PT Pallet Numbe
     C                     Z-ADDWAY2NX    WN0032           PT Product Code
      * --- Offset Production Date & Time ---
     C                     MOVELWAZ2NX    YL0025           Text USR 8
     C                     Z-ADD2         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0025:ZQ YL0014    P  90  Scale ID
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * Rtv Line/ID/Ofst p/Dt RT - Product Trace Line Scale  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0026           Company Number
     C                     MOVELYL0014    WL0027    P      Scale ID
     C                     Z-ADDWN0023    WL0028           Effective Label
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0029    YL0015           CS Scale Offset
     C                     MOVELWL0030    WN0048    P      CS Include in P
     C                     Z-ADDYL0026    WN0037           PT Offset Prod
     C                     MULT -1        YL0015           CS Scale Offset
      * PAR.PT Offset Prod Time = PAR.PT Production Time + LCL.CS Scale O
     C                     Z-ADDWN0028    XTTIM
     C                     Z-ADD*ZERO     XASC    80
     C                     EXSR XTAD1
     C           60        MULT YL0015    XDWK1   80
     C                     ADD  XDWK1     XASC    80
     C                     EXSR XTCT1
     C                     Z-ADDXTTIM     WN0038
      * CASE: PAR.PT Offset Prod Time GT PAR.PT Production Time
     C           WN0038    IFGT WN0028                     *IF
      * PAR.PT Offset Prod Date = PAR.PT Offset Prod Date + CON.-1 *DAYS
     C           WN0037    SUB  18000000  XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-1        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111110' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0037
     C                     ELSE
     C           XDINDT    ADD  18000000  WN0037
     C                     END
     C                     END                             *FI
      * --- Item Picture Key ---
      * RTV Item Labels        RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0031           Company Number
     C                     Z-ADDWN0019    WL0032           Item Code
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0033    WUAVNA    P      Description Lin
     C                     MOVELWL0034    WN0039    P      Item Label Line
     C                     MOVELWL0035    WN0040    P      Item Label Line
     C                     Z-ADDWL0036    WN0045           Item Structure
     C                     Z-ADDWL0037    WN0046           Item Structure
     C                     Z-ADDWL0038    WN0047           Item Structure
     C                     MOVELWL0039    WN0044    P      Item Type Code
     C                     MOVELWL0040    WN0006    P      Made to Order C
     C                     MOVELWL0041    WN0007    P      Item Category C
     C                     MOVELWL0042    WN0008    P      Primal Group Co
      * Item Picture Key
      * CASE: PAR.Item Category Code 3 is Loint
     C           WN0007    IFEQ 'L61'                      *IF
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'LOINT'   WN0043           PT Item Picture
     C                     ELSE
      * CASE: *OTHERWISE
      * Item Picture Key
      * CASE: PAR.MTO Code is Entered
     C           WN0006    IFGT *BLANK                     *IF
      * PFN
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.MTO Code is PFN
      *   |- c2    : PAR.MTO Code is IWG
      *   '-
     C           WN0006    IFEQ 'PFN'                      *IF
     C           WN0006    OREQ 'IWG'                      *OR
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'PFN'     WN0043           PT Item Picture
     C                     END                             *FI
      * PFT
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.MTO Code is EHP
      *   |- c2    : PAR.MTO Code is KRG
      *   '-
     C           WN0006    IFEQ 'EHP'                      *IF
     C           WN0006    OREQ 'KRG'                      *OR
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'PFT'     WN0043           PT Item Picture
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5
      *   |- c1    : PAR.Primal Group Code is BUTT
      *   |- c2    : PAR.Primal Group Code is HAM
      *   |- c3    : PAR.Primal Group Code is LOIN
      *   |- c4    : PAR.Primal Group Code is PICNIC
      *   |- c5    : PAR.Primal Group Code is RIBS
      *   '-
     C           WN0008    IFEQ 'BUTT'                     *IF
     C           WN0008    OREQ 'HAM'                      *OR
     C           WN0008    OREQ 'LOIN'                     *OR
     C           WN0008    OREQ @CN,006                    *OR
     C           WN0008    OREQ 'RIBS'                     *OR
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVELWN0008    WN0043           PT Item Picture
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Primal Group Code is HAMC
     C           WN0008    IFEQ 'HAMC'                     *IF
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'HAM'     WN0043           PT Item Picture
     C                     ELSE
      * CASE: PAR.Primal Group Code is LOINC
     C           WN0008    IFEQ 'LOINC'                    *IF
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'LOIN'    WN0043           PT Item Picture
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'LOGO'    WN0043           PT Item Picture
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * --- Create Product Trace Record ---
      * Crt Product Trace     CR - Product Trace  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0045           Company Number
     C                     Z-ADDWN0026    WL0046           PT Serial Numbe
     C                     Z-ADDWN0027    WL0047           PT Prod Date YY
     C                     Z-ADDWN0028    WL0048           PT Production T
     C                     Z-ADDWN0042    WL0049           PT Label Date Y
     C                     Z-ADDWN0037    WL0050           PT Offset Prod
     C                     Z-ADDWN0038    WL0051           PT Offset Prod
     C                     MOVELWN0029    WL0052    P      PT Inventory St
     C                     Z-ADDWN0030    WL0053           PT Net Weight
     C                     Z-ADDWN0031    WL0054           PT Gross Weight
     C                     MOVELWN0033    WL0055    P      PT Shift Number
     C                     MOVELWN0034    WL0056    P      PT Warehouse ID
     C                     Z-ADDWN0035    WL0057           PT Order Number
     C                     MOVELWN0036    WL0058    P      PT Pallet Numbe
     C                     Z-ADDWN0032    WL0059           PT Product Code
     C                     MOVELWN0039    WL0060    P      PT Item Label L
     C                     MOVELWN0040    WL0061    P      PT Item Label L
     C                     MOVELWN0041    WL0062    P      PT Fresh/Frozen
     C                     MOVELWN0043    WL0063    P      PT Item Picture
     C                     Z-ADD*ZERO     WL0064           PT Tattoo Numbe
     C                     MOVELWUOTTX    WL0065    P      PT Source Type
     C                     MOVEL*BLANK    WL0066           PT Source Code
     C                     MOVEL*BLANK    WL0067           PT Source Code
     C                     MOVEL*BLANK    WL0068           PT Producer/Cel
     C                     MOVEL*BLANK    WL0069           PT Producer/Cel
     C                     MOVEL*BLANK    WL0070           PT Producer/Far
     C                     MOVEL*BLANK    WL0071           PT Producer Loc
     C                     MOVEL*BLANK    WL0072           PT Producer/Far
     C                     MOVEL*BLANK    WL0073           PT Producer/Far
     C                     MOVELWUOTTX    WL0074    P      PT Producer/Far
     C                     MOVEL*BLANK    WL0075           PT Producer/Far
     C                     MOVEL*BLANK    WL0076           PT Genetic Code
     C                     MOVEL*BLANK    WL0077           PT Genetic Desc
     C                     MOVELWUOTTX    WL0078    P      PT Gender Code
     C                     MOVEL*BLANK    WL0079           PT Producer/Far
     C                     MOVEL*BLANK    WL0080           PT Producer/Far
     C                     MOVEL*BLANK    WL0081           PT Producer/Far
     C                     MOVEL*BLANK    WL0082           PT Producer/Far
     C                     MOVELWN0044    WL0083    P      PT Item Type Co
     C                     Z-ADDWN0045    WL0084           PT Item Str Cla
     C                     Z-ADDWN0046    WL0085           PT Item Str Gro
     C                     Z-ADDWN0047    WL0086           PT Item Str Typ
     C                     Z-ADD*ZERO     WL0087           PT WIP Dump/Pro
     C                     Z-ADD*ZERO     WL0088           PT WIP Dump/Pro
     C                     MOVELWUXKTX    WL0089    P      PT WIP Dump/Pro
     C                     MOVELWUOTTX    WL0090    P      PT WIP Used/Not
     C                     Z-ADD*ZERO     WL0091           PT From FG Seri
     C                     Z-ADD*ZERO     WL0092           PT To FG Serial
     C                     Z-ADD*ZERO     WL0093           PT Unused Nbr 3
     C                     Z-ADD*ZERO     WL0094           PT Unused Nbr 4
     C                     MOVELWN0048    WL0095    P      PT Incl in Prod
     C                     MOVELWUOTTX    WL0096    P      PT Unused Sts 4
     C                     Z-ADD*ZERO     WL0097           Job Time
     C                     MOVEL*BLANK    WL0098           User Id
     C                     MOVEL*BLANK    WL0099           Job Name
     C                     Z-ADD*ZERO     WL0100           Job Date
     C                     EXSR SRCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ----- Increase Located Quantity and Weight -----
      * The Freezer Putaway will increase the Location Inventory
     C                     ELSE
      * CASE: Ship Regular Order & Transfer Order
      *  - c1 OR c2
      *   |- c1    : DB1.PFS Transaction Type is SM: Ship Regular Order
      *   |- c2    : DB1.PFS Transaction Type is SM: Transfer Order
      *   '-
     C           WAVLSX    IFEQ 'S01'                      *IF
     C           WAVLSX    OREQ 'S02'                      *OR
      * PROCESS:  Ship
      * CASE: WRK.#Sequence Block is NULL
     C           WUZRST    IFEQ *BLANK                     *IF
     C                     Z-ADDWAZ2NX    WN0026           PT Serial Numbe
      * CRT:  Manifest Detail & Order Inv Allocation for Lot Tracking WHS
      *
     C                     Z-ADD*ZERO     WN0231  50       Case Sequence N
     C                     Z-ADD*ZERO     WN0232 112       Manifest Net We
     C                     MOVEL*BLANK    WN0233  1        EDI Status 1
     C                     MOVEL*BLANK    WN0234  1        EDI Status 2
     C                     MOVEL*BLANK    WN0235  1        EDI Status 3
     C                     MOVEL*BLANK    WN0236  1        Record Status
     C                     Z-ADD*ZERO     WN0237  60       Job Time
     C                     MOVEL*BLANK    WN0238 10        User Id
     C                     MOVEL*BLANK    WN0239 10        Job Name
     C                     Z-ADD*ZERO     WN0240  70       Job Date
      *
      * PFS Crt Manifest Dtl  IF
      * 05/20/10 Moved the Retrieve for ORD DTL Exist inside the XF
      * PFS Crt Order Detail  XF - Order Detail  * 
     C                     CALL 'PPN7XFR'              90  PFS Crt Order D
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0002    WQ0126  30       Company Number
     C                     PARM WN0056    WQ0127  70       Order Number
     C                     PARM WN0064    WQ0128  30       Order Sequence
     C                     PARM WN0065    WQ0129  30       Order Secondary
     C                     PARM WN0019    WQ0130  70       Item Code
     C                     PARM WN0012    WQ0131  3        Warehouse Code
     C                     PARM *BLANK    WQ0132  1        Work Over_Short
     C                     PARM *ZERO     WQ0133 112       Quantity Shippe
     C                     PARM *ZERO     WQ0134 112       Weight Shipped
     C                     PARM *ZERO     WQ0135  70       Actual Shipped
     C                     PARM WAZYNX    WQ0136  60       Substitution Li
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPN7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * PFS Val Dup Serial#   RT - Manifest Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0013           Company Number
     C                     Z-ADDWN0056    WL0014           Order Number
     C                     Z-ADDWN0064    WL0015           Order Sequence
     C                     Z-ADDWN0065    WL0016           Order Secondary
     C                     Z-ADDWN0026    WL0017           PT Serial Numbe
     C                     Z-ADDWN0023    WL0018           Label Date
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0019    YL0027    P      Record Found US
      * DUPLICATE CASE FOUND
      * CASE: LCL.Record Found USR is Record Found
     C           YL0027    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           WN0056    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVELWN0056    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0003           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0003           CD7 Ext Numeric
     C                     END                             *FI
     C                     Z-ADDWN0026    ZA0004           PT Serial Numbe
      * Retrieve message PFS Dup Case Manifested
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3596' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0028    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * RTV Alpha Value        RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0020           Company Number
     C                     MOVEL@CN,002   WL0021    P      Company Value C
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0022    YL0029    P      System Value Al
      * SND Pager Msg (MPLUS) UP - /UT User Programs  * 
     C                     CALL 'POMSUPC'              90  SND Pager Msg (
     C                     PARM YL0029    WQ0137 10        DL List ID
     C                     PARM YL0028    WQ0138132        Office Message
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMSUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Rtv Next Case Seq#    RT - Manifest Detail  * 
     C                     EXSR TJRVGN
      * R11974 DN 11/01/17-Calc/Update Net Weight in Kg (Kilograms).
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0232           Manifest Net We
      * CASE: PAR.Case Weight is NE *ZERO
     C           WAABNY    IFNE 0                          *IF
      * Clc Weight to Kilogram IF
      * Round Case Weight to 1 Decimal Place.
      * RMC 10/14/19 increase precision - DO NOT DO THIS  10/16/19 PER AA
     C           WAABNY    MULT .45359    YL0030           Net Weight Kg U
     C           YL0030    MULT 1         YL0031    H      Net Weight Kilo
     C                     Z-ADDYL0031    WN0232           Manifest Net We
     C                     END                             *FI
      * R11974 DN 11/01/17-Set Manifest Net Weight - Kg.
      * WI609_2 JM 12/05/24-Added New column Manifest Pallet Nbr 3PL
      * Crt Manifest Detail   CR - Manifest Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0189           Company Number
     C                     Z-ADDWN0056    WL0190           Order Number
     C                     Z-ADDWN0064    WL0191           Order Sequence
     C                     Z-ADDWN0065    WL0192           Order Secondary
     C                     Z-ADDWN0231    WL0193           Case Sequence N
     C                     Z-ADDWABDNY    WL0194           Case Quantity
     C                     Z-ADDWAABNY    WL0195           Case Weight
     C                     MOVEL*BLANK    WL0196           Inventory Updat
     C                     Z-ADDWN0023    WL0197           Label Date
     C                     Z-ADDWN0026    WL0198           PT Serial Numbe
     C                     Z-ADDWN0019    WL0199           Item Code
     C                     MOVELWN0012    WL0200    P      Warehouse Code
     C                     Z-ADDWN0020    WL0201           Production Date
     C                     Z-ADDWABENY    WL0202           Manifest Gross
     C                     MOVEL*BLANK    WL0203           Manifest Lot ID
     C                     Z-ADDWAZ9NX    WL0204           Manifest Total
     C                     Z-ADDWAALNY    WL0205           Manifest Co_Par
     C                     Z-ADDWAAGNY    WL0206           Manifest Pallet
     C                     MOVELWAVKSX    WL0207    P      Manifest Shift
     C                     Z-ADD*ZERO     WL0208           HPB Meter Net G
     C                     Z-ADDWN0232    WL0209           Manifest Net We
     C                     MOVELWUGCTX    WL0210    P      Manifest Unused
     C                     MOVELWUGDTX    WL0211    P      Manifest Unused
     C                     Z-ADD*ZERO     WL0212           Manifest Unused
     C                     Z-ADD*ZERO     WL0213           HPB COA Batch N
     C                     Z-ADD*ZERO     WL0214           HPB Meter Start
     C                     Z-ADD*ZERO     WL0215           HPB Meter Endin
     C                     Z-ADD*ZERO     WL0216           HPB Meter Total
     C                     Z-ADD*ZERO     WL0217           HPB Meter Net W
     C                     Z-ADD*ZERO     WL0218           HPB Density Ref
     C                     MOVELWN0233    WL0219    P      EDI Status 1
     C                     MOVELWN0234    WL0220    P      EDI Status 2
     C                     MOVELWN0235    WL0221    P      EDI Status 3
     C                     MOVELWN0236    WL0222    P      Record Status
     C                     Z-ADDWN0237    WL0223           Job Time
     C                     MOVELWN0238    WL0224    P      User Id
     C                     MOVELWN0239    WL0225    P      Job Name
     C                     Z-ADDWN0240    WL0226           Job Date
     C                     Z-ADD*ZERO     WL0227           Manifest Pallet
     C                     EXSR TKCRRC
      * ** Create Order Inv Allocation ***
      * CASE: PAR.Lot Tracking Flag is yes
     C           WN0049    IFEQ 'Y'                        *IF
      *
     C                     Z-ADD*ZERO     WN0241  50       Allocation Seq
      *
      * Crt Order Inv Alloc   IF
      * Rtv Next Seq Num      RT - Order Inv Allocation  * 
     C                     EXSR TLRVGN
      * Crt Order Inv Alloc   CR - Order Inv Allocation  * 
     C                     EXSR TMCRRC
     C                     END                             *FI
      * UPD:  Inventory Status and Order Number in Product Trace
     C                     Z-ADDWAZ4NX    WN0042           PT Label Date Y
     C                     Z-ADDWAZPNX    WN0035           PT Order Number
     C                     Z-ADDWAZ2NX    WN0026           PT Serial Numbe
      * Val Prod Trc P01 rcd  RT - Product Trace  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0050    WL0023           Company Number
     C                     Z-ADDWN0026    WL0024           PT Serial Numbe
     C                     Z-ADDWAZ4NX    WL0025           PT Label Date Y
     C                     EXSR SMRVGN
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ @CN,003                    *IF
      * Slm 01/10/2014 MTech Review Order number
      * Slm 01/10/2014 MTech Review Inventory Status
      * PFS Upd Ord/Inv Sts   RT - Product Trace  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0050    WL0228           Company Number
     C                     Z-ADDWN0026    WL0229           PT Serial Numbe
     C                     Z-ADDWN0042    WL0230           PT Label Date Y
     C                     MOVEL'3'       WL0231    P      PT Inventory St
     C                     Z-ADDWN0035    WL0232           PT Order Number
     C                     EXSR TNRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * UPD:  Product Trace ** Create with order # if not found 12/15/06
      * CASE: PAR.Item Code is Scale Check Item 2222
     C           WN0019    IFEQ 2222                       *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWAZ2NX    WN0026           PT Serial Numbe
     C                     Z-ADDWAP7DT    WN0027           PT Prod Date YY
     C                     Z-ADDWAAFTS    WN0028           PT Production T
     C                     Z-ADDWAZ4NX    WN0042           PT Label Date Y
     C                     MOVEL'3'       WN0029           PT Inventory St
     C                     Z-ADDWAABNY    WN0030           PT Net Weight
     C                     Z-ADDWABENY    WN0031           PT Gross Weight
     C                     MOVELWAVKSX    WN0033           PT Shift Number
     C                     MOVELWAU4SX    WN0034           PT Warehouse ID
     C                     MOVELWAAGNY    WN0036           PT Pallet Numbe
     C                     Z-ADDWN0019    WN0032           PT Product Code
      * --- Offset Production Date & Time ---
     C                     MOVELWAZ2NX    YL0013           Text 10A USR
     C                     Z-ADD2         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00010
     C           ZQ        ORGT 00010
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0013:ZQ YL0014    P  90  Scale ID
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * Rtv Line/ID/Ofst p/Dt RT - Product Trace Line Scale  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0026           Company Number
     C                     MOVELYL0014    WL0027    P      Scale ID
     C                     Z-ADDWN0023    WL0028           Effective Label
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0029    YL0015           CS Scale Offset
     C                     MOVELWL0030    WN0048    P      CS Include in P
      * RMC 3/15/06 use par.pt prod date yyyymmdd instead of lcl.pt prod
     C                     Z-ADDWN0027    WN0037           PT Offset Prod
     C                     MULT -1        YL0015           CS Scale Offset
      * PAR.PT Offset Prod Time = PAR.PT Production Time + LCL.CS Scale O
     C                     Z-ADDWN0028    XTTIM
     C                     Z-ADD*ZERO     XASC    80
     C                     EXSR XTAD1
     C           60        MULT YL0015    XDWK1   80
     C                     ADD  XDWK1     XASC    80
     C                     EXSR XTCT1
     C                     Z-ADDXTTIM     WN0038
      * CASE: PAR.PT Offset Prod Time GT PAR.PT Production Time
     C           WN0038    IFGT WN0028                     *IF
      * PAR.PT Offset Prod Date = PAR.PT Offset Prod Date + CON.-1 *DAYS
     C           WN0037    SUB  18000000  XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-1        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111110' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0037
     C                     ELSE
     C           XDINDT    ADD  18000000  WN0037
     C                     END
     C                     END                             *FI
      * --- Item Picture Key ---
      * RTV Item Labels        RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0031           Company Number
     C                     Z-ADDWN0019    WL0032           Item Code
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0033    WUAVNA    P      Description Lin
     C                     MOVELWL0034    WN0039    P      Item Label Line
     C                     MOVELWL0035    WN0040    P      Item Label Line
     C                     Z-ADDWL0036    WN0045           Item Structure
     C                     Z-ADDWL0037    WN0046           Item Structure
     C                     Z-ADDWL0038    WN0047           Item Structure
     C                     MOVELWL0039    WN0044    P      Item Type Code
     C                     MOVELWL0040    WN0006    P      Made to Order C
     C                     MOVELWL0041    WN0007    P      Item Category C
     C                     MOVELWL0042    WN0008    P      Primal Group Co
      * Item Picture Key
      * CASE: PAR.Item Category Code 3 is Loint
     C           WN0007    IFEQ 'L61'                      *IF
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'LOINT'   WN0043           PT Item Picture
     C                     ELSE
      * CASE: *OTHERWISE
      * Item Picture Key
      * CASE: PAR.MTO Code is Entered
     C           WN0006    IFGT *BLANK                     *IF
      * PFN
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.MTO Code is PFN
      *   |- c2    : PAR.MTO Code is IWG
      *   '-
     C           WN0006    IFEQ 'PFN'                      *IF
     C           WN0006    OREQ 'IWG'                      *OR
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'PFN'     WN0043           PT Item Picture
     C                     END                             *FI
      * PFT
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.MTO Code is EHP
      *   |- c2    : PAR.MTO Code is KRG
      *   '-
     C           WN0006    IFEQ 'EHP'                      *IF
     C           WN0006    OREQ 'KRG'                      *OR
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'PFT'     WN0043           PT Item Picture
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5
      *   |- c1    : PAR.Primal Group Code is BUTT
      *   |- c2    : PAR.Primal Group Code is HAM
      *   |- c3    : PAR.Primal Group Code is LOIN
      *   |- c4    : PAR.Primal Group Code is PICNIC
      *   |- c5    : PAR.Primal Group Code is RIBS
      *   '-
     C           WN0008    IFEQ 'BUTT'                     *IF
     C           WN0008    OREQ 'HAM'                      *OR
     C           WN0008    OREQ 'LOIN'                     *OR
     C           WN0008    OREQ @CN,006                    *OR
     C           WN0008    OREQ 'RIBS'                     *OR
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVELWN0008    WN0043           PT Item Picture
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Primal Group Code is HAMC
     C           WN0008    IFEQ 'HAMC'                     *IF
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'HAM'     WN0043           PT Item Picture
     C                     ELSE
      * CASE: PAR.Primal Group Code is LOINC
     C           WN0008    IFEQ 'LOINC'                    *IF
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'LOIN'    WN0043           PT Item Picture
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WN0043           PT Item Picture
     C                     MOVEL'LOGO'    WN0043           PT Item Picture
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * RTV Warehouse Type     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0012    WL0043    P      Warehouse Code
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0044    WN0041    P      Warehouse Type
      * --- Create Product Trace Record ---
      * Crt Product Trace     CR - Product Trace  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0050    WL0045           Company Number
     C                     Z-ADDWN0026    WL0046           PT Serial Numbe
     C                     Z-ADDWN0027    WL0047           PT Prod Date YY
     C                     Z-ADDWN0028    WL0048           PT Production T
     C                     Z-ADDWN0042    WL0049           PT Label Date Y
     C                     Z-ADDWN0037    WL0050           PT Offset Prod
     C                     Z-ADDWN0038    WL0051           PT Offset Prod
     C                     MOVELWN0029    WL0052    P      PT Inventory St
     C                     Z-ADDWN0030    WL0053           PT Net Weight
     C                     Z-ADDWN0031    WL0054           PT Gross Weight
     C                     MOVELWN0033    WL0055    P      PT Shift Number
     C                     MOVELWN0034    WL0056    P      PT Warehouse ID
     C                     Z-ADDWN0035    WL0057           PT Order Number
     C                     MOVELWN0036    WL0058    P      PT Pallet Numbe
     C                     Z-ADDWN0032    WL0059           PT Product Code
     C                     MOVELWN0039    WL0060    P      PT Item Label L
     C                     MOVELWN0040    WL0061    P      PT Item Label L
     C                     MOVELWN0041    WL0062    P      PT Fresh/Frozen
     C                     MOVELWN0043    WL0063    P      PT Item Picture
     C                     Z-ADD*ZERO     WL0064           PT Tattoo Numbe
     C                     MOVELWUOTTX    WL0065    P      PT Source Type
     C                     MOVEL*BLANK    WL0066           PT Source Code
     C                     MOVEL*BLANK    WL0067           PT Source Code
     C                     MOVEL*BLANK    WL0068           PT Producer/Cel
     C                     MOVEL*BLANK    WL0069           PT Producer/Cel
     C                     MOVEL*BLANK    WL0070           PT Producer/Far
     C                     MOVEL*BLANK    WL0071           PT Producer Loc
     C                     MOVEL*BLANK    WL0072           PT Producer/Far
     C                     MOVEL*BLANK    WL0073           PT Producer/Far
     C                     MOVELWUOTTX    WL0074    P      PT Producer/Far
     C                     MOVEL*BLANK    WL0075           PT Producer/Far
     C                     MOVEL*BLANK    WL0076           PT Genetic Code
     C                     MOVEL*BLANK    WL0077           PT Genetic Desc
     C                     MOVELWUOTTX    WL0078    P      PT Gender Code
     C                     MOVEL*BLANK    WL0079           PT Producer/Far
     C                     MOVEL*BLANK    WL0080           PT Producer/Far
     C                     MOVEL*BLANK    WL0081           PT Producer/Far
     C                     MOVEL*BLANK    WL0082           PT Producer/Far
     C                     MOVELWN0044    WL0083    P      PT Item Type Co
     C                     Z-ADDWN0045    WL0084           PT Item Str Cla
     C                     Z-ADDWN0046    WL0085           PT Item Str Gro
     C                     Z-ADDWN0047    WL0086           PT Item Str Typ
     C                     Z-ADD*ZERO     WL0087           PT WIP Dump/Pro
     C                     Z-ADD*ZERO     WL0088           PT WIP Dump/Pro
     C                     MOVELWUXKTX    WL0089    P      PT WIP Dump/Pro
     C                     MOVELWUOTTX    WL0090    P      PT WIP Used/Not
     C                     Z-ADD*ZERO     WL0091           PT From FG Seri
     C                     Z-ADD*ZERO     WL0092           PT To FG Serial
     C                     Z-ADD*ZERO     WL0093           PT Unused Nbr 3
     C                     Z-ADD*ZERO     WL0094           PT Unused Nbr 4
     C                     MOVELWN0048    WL0095    P      PT Incl in Prod
     C                     MOVELWUOTTX    WL0096    P      PT Unused Sts 4
     C                     Z-ADD*ZERO     WL0097           Job Time
     C                     MOVEL*BLANK    WL0098           User Id
     C                     MOVEL*BLANK    WL0099           Job Name
     C                     Z-ADD*ZERO     WL0100           Job Date
     C                     EXSR SRCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.PFS Transaction Type is SM: UnShip Reg/Tfr Ord
     C           WAVLSX    IFEQ 'S03'                      *IF
      * PROCESS:  Unship
      * CASE: WRK.#Sequence Block is NULL
     C           WUZRST    IFEQ *BLANK                     *IF
     C                     Z-ADDWAZ2NX    WN0026           PT Serial Numbe
      * DEL:  Manifest Detail
      * PFS Del Manifest Dtl  RT - Manifest Detail  * 
     C                     EXSR TPRVGN
      * UPD:  Inventory Status and Order Number in Product Trace
     C                     Z-ADDWAZ4NX    WN0042           PT Label Date Y
      * PFS Upd Ord/Inv Sts   RT - Product Trace  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0050    WL0228           Company Number
     C                     Z-ADDWN0026    WL0229           PT Serial Numbe
     C                     Z-ADDWN0042    WL0230           PT Label Date Y
     C                     MOVEL'1'       WL0231    P      PT Inventory St
     C                     Z-ADD*ZERO     WL0232           PT Order Number
     C                     EXSR TNRVGN
      * ----- Create Inv Trans Dtl & Update Inv Balance & Detail
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD1         WN0009           PFS Process Sta
     C                     END                             *FI
      * MARK PROCESSED: Inactive Transaction & Restoration In Progress
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.PFS Error Reason is Inactive Transaction
      *   |- c2    : PAR.PFS Error Reason is Restoration In Progress
      *   '-
     C           WN0010    IFEQ @CN,021                    *IF
     C           WN0010    OREQ 'RSTIP'                    *OR
     C                     Z-ADD1         WN0009           PFS Process Sta
     C                     END                             *FI
      * MARK PROCESSED: F02; C03
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.PFS Transaction Type is FM: Freezer ReLocate
      *   |- c2    : DB1.PFS Transaction Type is CC: Move to Current Loc
      *   '-
     C           WAVLSX    IFEQ 'F02'                      *IF
     C           WAVLSX    OREQ 'C03'                      *OR
     C                     Z-ADD1         WN0009           PFS Process Sta
     C                     END                             *FI
      * MARK PROCESSED: F03 QA Hold or F04 QA Hold
      * CASE:
      *  - (c1 AND c2) OR (c3 AND c4)
      *   |- c1    : DB1.PFS Transaction Type is FM: Freezer Hold
      *   |- c2    : DB1.PFS Inv Adj Reason Code is Q1 QA HOLD (Chill-tim
      *   |- c3    : DB1.PFS Transaction Type is FM: Freezer Release Hold
      *   |- c4    : DB1.PFS Inv Adj Reason Code is Q1 QA HOLD (Chill-tim
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAVLSX    IFEQ 'F03'                      *IF
     C           WAVMSX    IFEQ '6'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WAVLSX    IFEQ 'F04'                      *IF
     C           WAVMSX    IFEQ '6'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD1         WN0009           PFS Process Sta
     C                     END                             *FI
      * CASE: PAR.PFS Process Status is Not Processed
     C           WN0009    IFEQ 0                          *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg PrcSts/ErrRsn     CH - PFS Inventory Adjustment  * 
     C                     EXSR TTCHRC
     C                     END                             *FI
     C                     READ @BGCPAS                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Active Status     RT - PFS Interface  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBY1NX           PFS Company Num
     C                     KFLD           WBGYAA           PFS Interface C
      * Setup key
     C                     Z-ADDWL0001    WBY1NX           PFS Company Num
     C                     MOVELWL0002    WBGYAA           PFS Interface C
      * Establish starting position
     C           KRSSB     CHAIN@BUREBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3541' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0003           PFS AccuSort Ac
     C                     MOVEL*BLANK    WL0004           PFS Carlisle Ac
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBWSSX    WL0003           PFS AccuSort Ac
     C                     MOVELWBWUSX    WL0004           PFS Carlisle Ac
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Val WHS/Rtv ActCo PFS RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAJCD           Warehouse Code
      * Setup key
     C                     MOVELWN0012    WCAJCD           Warehouse Code
      * Establish starting position
     C           KRSSC     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCVHST    WN0049           Lot Tracking Fl
     C                     Z-ADDWCBTC3    WN0050           Accounting Comp
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Val Itm/Whs,FG/WP PFS RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSD01           Company Number
     C           *LIKE     DEFN WDHGCD    WQSD02           Item Code
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Item Code
      * Setup key
     C                     Z-ADDWL0005    WQSD01           Company Number
     C                     Z-ADDWL0006    WQSD02           Item Code
      * Establish starting position
     C           KRSSD     SETLL@BZREJR                    *
     C           KRSSD     READE@BZREJR                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0007           Production Date
     C                     Z-ADD*ZERO     WL0008           Item Structure
     C                     MOVEL*BLANK    WL0009           Item Type Code
     C                     MOVEL*BLANK    WL0010           Default Warehou
     C                     Z-ADD*ZERO     WL0011           Fresh Chilling
     C                     MOVEL*BLANK    WL0012           Primal Group Co
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDFZST    WL0007           Production Date
     C                     Z-ADDWDRGNB    WL0008           Item Structure
     C                     MOVELWDN0CD    WL0009           Item Type Code
     C                     MOVELWDQ1CD    WL0010           Default Warehou
     C                     Z-ADDWDCHTM    WL0011           Fresh Chilling
     C                     MOVELWDXRCD    WL0012           Primal Group Co
     C           KRSSD     READE@BZREJR                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Unit Cost Active   RT - Item Balance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEHGCD           Item Code
     C                     KFLD           WEAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWAY1NX    WEAIC3           Company Number
     C                     Z-ADDWAY2NX    WEHGCD           Item Code
     C                     MOVELWAU4SX    WEAJCD           Warehouse Code
      * Establish starting position
     C           KRSSE     CHAIN@B0REYY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0328' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0011           Unit Cost Per P
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWEAGCS    WN0011           Unit Cost Per P
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Order Info PFS    RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFC4NB           Order Number
      * Setup key
     C                     Z-ADDWN0002    WFAIC3           Company Number
     C                     Z-ADDWN0056    WFC4NB           Order Number
      * Establish starting position
     C           KRSSF     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFJNCD    WN0058           Order Type_Sale
     C                     Z-ADDWFBKC7    WN0061           Ship To Custome
     C                     MOVELWFGWST    WN0057           Header Status
     C                     Z-ADDWFAODT    WN0063           Scheduled Ship
     C                     MOVELWFJPCD    WN0060           Event Code
     C                     MOVELWFXUST    WN0062           Trans Contol AS
     C                     MOVELWFOBST    WN0059           Billing Activit
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Whse/DLS/Item     RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAIC3    WQSG01           Company Number
     C           *LIKE     DEFN WGC4NB    WQSG02           Order Number
      * Define keylist
     C           KPSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Order Number
     C                     KFLD           WGDPNB           Order Sequence
     C                     KFLD           WGUENB           Order Secondary
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Order Number
      * Setup key
     C                     Z-ADDWN0002    WQSG01           Company Number
     C                     Z-ADDWN0056    WQSG02           Order Number
     C                     Z-ADDWN0064    WGDPNB           Order Sequence
     C                     Z-ADDWN0065    WGUENB           Order Secondary
      * Establish starting position
     C           KPSSG     SETLL@BGWKL1                    *
     C           KRSSG     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0003           Item Code
     C                     MOVEL*BLANK    YL0004           Warehouse Code
     C                     MOVEL*BLANK    YL0005           Detail Line Sta
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * C2748:  Changed RTV Warehouse Code RT to exclude Cancelled lines.
      * CASE: DB1.Detail Line Status is Cancelled
     C           WGGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR = DB1 By name
     C                     Z-ADDWGHGCD    YL0003           Item Code
     C                     MOVELWGAJCD    YL0004           Warehouse Code
     C                     MOVELWGGMST    YL0005           Detail Line Sta
     C                     GOTO SGEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSG     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * PFS Val Dup Serial#   RT - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WL0019           Record Found US
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAIC3    WQSH01           Company Number
     C           *LIKE     DEFN WHC4NB    WQSH02           Order Number
     C           *LIKE     DEFN WHDPNB    WQSH03           Order Sequence
     C           *LIKE     DEFN WHUENB    WQSH04           Order Secondary
     C           *LIKE     DEFN WHPFNX    WQSH05           PT Serial Numbe
     C           *LIKE     DEFN WHK7DT    WQSH06           Label Date
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           Order Number
     C                     KFLD           WQSH03           Order Sequence
     C                     KFLD           WQSH04           Order Secondary
     C                     KFLD           WQSH05           PT Serial Numbe
     C                     KFLD           WQSH06           Label Date
      * Setup key
     C                     Z-ADDWL0013    WQSH01           Company Number
     C                     Z-ADDWL0014    WQSH02           Order Number
     C                     Z-ADDWL0015    WQSH03           Order Sequence
     C                     Z-ADDWL0016    WQSH04           Order Secondary
     C                     Z-ADDWL0017    WQSH05           PT Serial Numbe
     C                     Z-ADDWL0018    WQSH06           Label Date
      * Establish starting position
     C           KRSSH     SETLL@FNCPAZ                    *
     C           KRSSH     READE@FNCPAZ                  90*
      * Data record not found
     C   90                MOVEL'USR1196' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WL0019           Record Found US
     C           KRSSH     READE@FNCPAZ                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Alpha Value        RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIV8CD           Company Value C
      * Setup key
     C                     Z-ADDWL0020    WIAIC3           Company Number
     C                     MOVELWL0021    WIV8CD           Company Value C
      * Establish starting position
     C           KRSSI     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWIBXTX    WL0022           System Value Al
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Val Warehouse PFS     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WCAJCD           Warehouse Code
      * Setup key
     C                     MOVELWAGBAA    WCAJCD           Warehouse Code
      * Establish starting position
     C           KRSSJ     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCVHST    YL0009           Lot Tracking Fl
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Val DupCase for Issue RT - PFS Inventory Adjustment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJY1NX    WQSK01           PFS Company Num
     C           *LIKE     DEFN WJY2NX    WQSK02           PFS Item Code
     C           *LIKE     DEFN WJZ2NX    WQSK03           PFS Serial Numb
     C           *LIKE     DEFN WJZ4NX    WQSK04           PFS Label Date
     C           *LIKE     DEFN WJVLSX    WQSK05           PFS Transaction
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           PFS Company Num
     C                     KFLD           WQSK02           PFS Item Code
     C                     KFLD           WQSK03           PFS Serial Numb
     C                     KFLD           WQSK04           PFS Label Date
     C                     KFLD           WQSK05           PFS Transaction
      * Setup key
     C                     Z-ADDWAY1NX    WQSK01           PFS Company Num
     C                     Z-ADDWAY2NX    WQSK02           PFS Item Code
     C                     Z-ADDWAZ2NX    WQSK03           PFS Serial Numb
     C                     Z-ADDWAZ4NX    WQSK04           PFS Label Date
     C                     MOVEL'P02'     WQSK05           PFS Transaction
      * Establish starting position
     C           KRSSK     SETLL@BGCPF0                    *
     C           KRSSK     READE@BGCPF0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3496' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     GOTO SKEXIT                     *QUIT
     C           KRSSK     READE@BGCPF0                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Live w/CT LD/ORD  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WKAJCD           Warehouse Code
      * Setup key
     C                     MOVELWN0012    WKAJCD           Warehouse Code
      * Establish starting position
     C           KRSSL     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0010           WHS Live with C
     C                     MOVEL*BLANK    YL0011           WHS PFS Interfa
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWKRRSX    YL0010           WHS Live with C
     C                     MOVELWKRSSX    YL0011           WHS PFS Interfa
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Val Prod Trc P01 rcd  RT - Product Trace  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLAIC3    WQSM01           Company Number
     C           *LIKE     DEFN WLPFNX    WQSM02           PT Serial Numbe
     C           *LIKE     DEFN WLADDX    WQSM03           PT Label Date Y
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           PT Serial Numbe
     C                     KFLD           WQSM03           PT Label Date Y
      * Setup key
     C                     Z-ADDWL0023    WQSM01           Company Number
     C                     Z-ADDWL0024    WQSM02           PT Serial Numbe
     C                     Z-ADDWL0025    WQSM03           PT Label Date Y
      * Establish starting position
     C           KRSSM     SETLL@B2CPT3                    *
     C           KRSSM     READE@B2CPT3                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3144' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C           KRSSM     READE@B2CPT3                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Line/ID/Ofst p/Dt RT - Product Trace Line Scale  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMAIC3    WQSN01           Company Number
     C           *LIKE     DEFN WMUXNX    WQSN02           Scale ID
      * Define keylist
     C           KPSSN     KLIST
     C                     KFLD           WQSN01           Company Number
     C                     KFLD           WQSN02           Scale ID
     C                     KFLD           WMPUDT           Effective Label
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Company Number
     C                     KFLD           WQSN02           Scale ID
      * Setup key
     C                     Z-ADDWL0026    WQSN01           Company Number
     C                     MOVELWL0027    WQSN02           Scale ID
     C                     Z-ADDWL0028    WMPUDT           Effective Label
      * Establish starting position
     C           KPSSN     SETLL@AARETD                    *
     C           KRSSN     READE@AARETD                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3311' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD*ZERO     WL0029           CS Scale Offset
     C                     MOVEL'N'       WL0030           CS Include in P
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Prod Trace Offset RT - Product Trace Line  * 
     C                     EXSR SORVGN
     C                     GOTO SNEXIT                     *QUIT
     C           KRSSN     READE@AARETD                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Prod Trace Offset RT - Product Trace Line  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WOAIC3           Company Number
     C                     KFLD           WOFAAA           Line Code
      * Setup key
     C                     Z-ADDWMAIC3    WOAIC3           Company Number
     C                     MOVELWMFAAA    WOFAAA           Line Code
      * Establish starting position
     C           KRSSO     CHAIN@ABRETA              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3314' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0029           CS Scale Offset
     C                     MOVEL*BLANK    WL0030           CS Include in P
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWOPINX    WL0029           CS Scale Offset
     C                     MOVELWOMUSX    WL0030           CS Include in P
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Item Labels        RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WRAIC3           Company Number
     C                     KFLD           WRHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0031    WRAIC3           Company Number
     C                     Z-ADDWL0032    WRHGCD           Item Code
      * Establish starting position
     C           KRSSP     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0033           Description Lin
     C                     MOVEL*BLANK    WL0034           Item Label Line
     C                     MOVEL*BLANK    WL0035           Item Label Line
     C                     Z-ADD*ZERO     WL0036           Item Structure
     C                     Z-ADD*ZERO     WL0037           Item Structure
     C                     Z-ADD*ZERO     WL0038           Item Structure
     C                     MOVEL*BLANK    WL0039           Item Type Code
     C                     MOVEL*BLANK    WL0040           Made to Order C
     C                     MOVEL*BLANK    WL0041           Item Category C
     C                     MOVEL*BLANK    WL0042           Primal Group Co
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWRAVNA    WL0033           Description Lin
     C                     MOVELWRL7NA    WL0034           Item Label Line
     C                     MOVELWRL8NA    WL0035           Item Label Line
     C                     Z-ADDWRRINB    WL0036           Item Structure
     C                     Z-ADDWRRHNB    WL0037           Item Structure
     C                     Z-ADDWRRGNB    WL0038           Item Structure
     C                     MOVELWRN0CD    WL0039           Item Type Code
     C                     MOVELWRSVCD    WL0040           Made to Order C
     C                     MOVELWRSXCD    WL0041           Item Category C
     C                     MOVELWRXRCD    WL0042           Primal Group Co
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Warehouse Type     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WKAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0043    WKAJCD           Warehouse Code
      * Establish starting position
     C           KRSSQ     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0044           Warehouse Type
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWKWPST    WL0044           Warehouse Type
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRCRRC    BEGSR
      *================================================================
      * Crt Product Trace     CR - Product Trace  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B2CPMP
     C                     Z-ADDWL0045    WSAIC3           Company Number
     C                     Z-ADDWL0046    WSPFNX           PT Serial Numbe
     C                     Z-ADDWL0047    WSAADX           PT Prod Date YY
     C                     Z-ADDWL0048    WSB9TM           PT Production T
     C                     Z-ADDWL0049    WSADDX           PT Label Date Y
     C                     Z-ADDWL0050    WSABDX           PT Offset Prod
     C                     Z-ADDWL0051    WSCATM           PT Offset Prod
     C                     MOVELWL0052    WSMNSX           PT Inventory St
     C                     Z-ADDWL0053    WSJOWG           PT Net Weight
     C                     Z-ADDWL0054    WSJPWG           PT Gross Weight
     C                     MOVELWL0055    WSMOSX           PT Shift Number
     C                     MOVELWL0056    WSDNAA           PT Warehouse ID
     C                     Z-ADDWL0057    WSPGNX           PT Order Number
     C                     MOVELWL0058    WSBTT1           PT Pallet Numbe
     C                     Z-ADDWL0059    WSD7C7           PT Product Code
     C                     MOVELWL0060    WSPYNA           PT Item Label L
     C                     MOVELWL0061    WSPZNA           PT Item Label L
     C                     MOVELWL0062    WSMPSX           PT Fresh/Frozen
     C                     MOVELWL0063    WSCCT1           PT Item Picture
     C                     Z-ADDWL0064    WSPHNX           PT Tattoo Numbe
     C                     MOVELWL0065    WSMQSX           PT Source Type
     C                     MOVELWL0066    WSDOAA           PT Source Code
     C                     MOVELWL0067    WSBUT1           PT Source Code
     C                     MOVELWL0068    WSDYAA           PT Producer/Cel
     C                     MOVELWL0069    WSBVT1           PT Producer/Cel
     C                     MOVELWL0070    WSDPAA           PT Producer/Far
     C                     MOVELWL0071    WSDQAA           PT Producer Loc
     C                     MOVELWL0072    WSBZT1           PT Producer/Far
     C                     MOVELWL0073    WSBWT1           PT Producer/Far
     C                     MOVELWL0074    WSDRAA           PT Producer/Far
     C                     MOVELWL0075    WSB9T1           PT Producer/Far
     C                     MOVELWL0076    WSDSAA           PT Genetic Code
     C                     MOVELWL0077    WSB8T1           PT Genetic Desc
     C                     MOVELWL0078    WSD4AA           PT Gender Code
     C                     MOVELWL0079    WSEPAA           PT Producer/Far
     C                     MOVELWL0080    WSEQAA           PT Producer/Far
     C                     MOVELWL0081    WSERAA           PT Producer/Far
     C                     MOVELWL0082    WSESAA           PT Producer/Far
     C                     MOVELWL0083    WSPNSX           PT Item Type Co
     C                     Z-ADDWL0084    WSUFNX           PT Item Str Cla
     C                     Z-ADDWL0085    WSUGNX           PT Item Str Gro
     C                     Z-ADDWL0086    WSUHNX           PT Item Str Typ
     C                     Z-ADDWL0087    WSAGDX           PT WIP Dump/Pro
     C                     Z-ADDWL0088    WSCGTM           PT WIP Dump/Pro
     C                     MOVELWL0089    WSPOSX           PT WIP Dump/Pro
     C                     MOVELWL0090    WSPPSX           PT WIP Used/Not
     C                     Z-ADDWL0091    WSUINX           PT From FG Seri
     C                     Z-ADDWL0092    WSUJNX           PT To FG Serial
     C                     Z-ADDWL0093    WSUKNX           PT Unused Nbr 3
     C                     Z-ADDWL0094    WSULNX           PT Unused Nbr 4
     C                     MOVELWL0095    WSPRSX           PT Incl in Prod
     C                     MOVELWL0096    WSPSSX           PT Unused Sts 4
     C                     Z-ADDWL0097    WSAATM           Job Time
     C                     MOVELWL0098    WSAYNA           User Id
     C                     MOVELWL0099    WSA0NA           Job Name
     C                     Z-ADDWL0100    WSAXDT           Job Date
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WSAATM           Job Time
     C                     MOVEL##USR     WSAYNA           User Id
     C                     MOVEL##JOB     WSA0NA           Job Name
     C                     Z-ADD##JDT     WSAXDT           Job Date
     C           KLCRSR    KLIST
     C                     KFLD           WSAIC3           Company Number
     C                     KFLD           WSPFNX           PT Serial Numbe
     C                     KFLD           WSAADX           PT Prod Date YY
     C                     KFLD           WSB9TM           PT Production T
      * Check for duplicate primary key
     C           KLCRSR    SETLL@B2CPMP                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3145' W0RTN   7
      * Send message 'Product Trace          EX'
     C                     MOVEL'USR3145' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C                     WRITE@B2CPMP                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * RTV Whse Descrip       RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WCAJCD           Warehouse Code
      * Setup key
     C                     MOVELWAGBAA    WCAJCD           Warehouse Code
      * Establish starting position
     C           KRSSS     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWCF8NA    YN0004           Warehouse Descr
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STCRRC    BEGSR
      *================================================================
      * PFS Item Loc/Crt Trn  CR - Item Lot Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @L5CPSL
     C                     Z-ADDWL0101    WTAIC3           Company Number
     C                     Z-ADDWL0102    WTHGCD           Item Code
     C                     MOVELWL0103    WTAJCD           Warehouse Code
     C                     Z-ADDWL0104    WTELDT           Production Date
     C                     Z-ADDWL0105    WTLXNM           Lot Number
     C                     MOVELWL0106    WTYMCD           Location Code
     C                     Z-ADDWL0107    WTYNCD           Location Level
     C                     Z-ADDWL0108    WTJ2QT           ILL Item Qty On
     C                     Z-ADDWL0109    WTG5WG           ILL Unit Weight
     C                     Z-ADDWL0110    WTJ3QT           ILL Co-Packer L
     C                     Z-ADDWL0111    WTG6WG           ILL Item Wgt On
     C                     Z-ADDWL0112    WTJ4QT           ILL Unused Qty
     C                     Z-ADDWL0113    WTG7WG           ILL Unused Wgt
     C                     Z-ADDWL0114    WTLODT           ILL Avail Ship
     C                     Z-ADDWL0115    WTLPDT           ILL Unused Date
     C                     Z-ADDWL0116    WTLQDT           ILL Unused Date
     C                     Z-ADDWL0117    WTNBR            ILL Unused Nbr
     C                     MOVELWL0118    WTYTCD           ILL Customer Co
     C                     MOVELWL0119    WTAMSX           ILL Status
     C                     MOVELWL0120    WTASSX           ILL Unused Sts
     C                     MOVELWL0121    WTATSX           ILL Unused Sts
     C                     MOVELWL0122    WTAUSX           ILL Unused Sts
     C                     MOVELWL0123    WTYSCD           Inv Hold Reason
     C                     MOVELWL0124    WTUVST           EDI Status 1
     C                     MOVELWL0125    WTUWST           EDI Status 2
     C                     MOVELWL0126    WTUXST           EDI Status 3
     C                     MOVELWL0127    WTVSST           Record Status
     C                     Z-ADDWL0128    WTAATM           Job Time
     C                     MOVELWL0129    WTAYNA           User Id
     C                     MOVELWL0130    WTA0NA           Job Name
     C                     Z-ADDWL0131    WTAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WTVSST           Record Status
     C                     Z-ADD##JTM     WTAATM           Job Time
     C                     MOVEL##USR     WTAYNA           User Id
     C                     MOVEL##PGM     WTA0NA           Job Name
     C                     Z-ADD##JDT     WTAXDT           Job Date
     C                     MOVEL'A'       WTAMSX           ILL Status
      * CASE: DB1.ILL Avail Ship Date is Not Entered
     C           WTLODT    IFEQ 0                          *IF
      *
     C                     MOVEL*BLANK    WN0086  1        WLT Type Code
     C                     Z-ADD*ZERO     WN0087  52       WLT Type Chill
      *
      * Clc Loc Avail Shp Dte IF
      * Rtv Loc Type          RT - Warehouse Location  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWL0103    WL0133    P      Warehouse Code
     C                     MOVELWL0106    WL0134    P      Location Code
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0135    WN0086    P      WLT Type Code
      * Rtv Chill Time        RT - Warehouse Location Type  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0086    WL0136    P      WLT Type Code
     C                     EXSR SVRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0137    WN0087           WLT Type Chill
      * PAR.ILL Avail Ship Date = PAR.Production Date + PAR.WLT Type Chil
     C           WL0104    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN0087    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WTLODT
     C                     ELSE
     C           XDINDT    SUB  1000000   WTLODT
     C                     END
      * CASE: DB1.ILL Avail Ship Date GT JOB.*Job date
     C           WTLODT    IFGT ##JDT                      *IF
     C                     MOVEL'H'       WTAMSX           ILL Status
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DB1.ILL Unit Weight is Equal to zero
     C           WTG5WG    IFEQ 0                          *IF
      * RTV Unit Weight        RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0101    WL0138           Company Number
     C                     Z-ADDWL0102    WL0139           Item Code
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0140    WTG5WG           Unit Weight
     C                     MOVELWL0141    YL0016    P      Quality Level
     C                     END                             *FI
     C           KLCRST    KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTHGCD           Item Code
     C                     KFLD           WTAJCD           Warehouse Code
     C                     KFLD           WTELDT           Production Date
     C                     KFLD           WTLXNM           Lot Number
     C                     KFLD           WTYMCD           Location Code
     C                     KFLD           WTYNCD           Location Level
      * Check for duplicate primary key
     C           KLCRST    SETLL@L5CPSL                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2635' W0RTN   7
      * USER: Processing if Data record already exists
      * PFS Upd Qty On-Hand   RT - Item Lot Location  * 
     C                     EXSR SXRVGN
      *
     C                     Z-ADD*ZERO     WN0136  30       LLT Sequence Nu
     C                     MOVEL*BLANK    WN0137  1        EDI Status 1
     C                     MOVEL*BLANK    WN0138  1        EDI Status 2
     C                     MOVEL*BLANK    WN0139  1        EDI Status 3
     C                     MOVEL*BLANK    WN0140  1        Record Status
     C                     Z-ADD*ZERO     WN0141  60       Job Time
     C                     MOVEL*BLANK    WN0142 10        User Id
     C                     MOVEL*BLANK    WN0143 10        Job Name
     C                     Z-ADD*ZERO     WN0144  70       Job Date
      *
      * PFS Item Lot/Loc Trns IF
      * Rtv Next Seq #        RT - IC Item Lot/Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0101    WL0142           Company Number
     C                     Z-ADDWL0102    WL0143           Item Code
     C                     MOVELWL0103    WL0144    P      Warehouse Code
     C                     MOVELWL0132    WL0145    P      LLT Transaction
     C                     Z-ADD##JDT     WL0146           LLT Transaction
     C                     EXSR TARVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0147    WN0136           LLT Sequence Nu
      * Crt Item Lot/Loc Trns CR - Item Lot Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0101    WL0148           Company Number
     C                     Z-ADDWL0102    WL0149           Item Code
     C                     MOVELWL0103    WL0150    P      Warehouse Code
     C                     MOVELWL0132    WL0151    P      LLT Transaction
     C                     Z-ADD##JDT     WL0152           LLT Transaction
     C                     Z-ADDWN0136    WL0153           LLT Sequence Nu
     C                     Z-ADDWL0104    WL0154           LLT Production
     C                     Z-ADDWL0108    WL0155           LLT Transaction
     C                     Z-ADDWL0111    WL0156           LLT Transaction
     C                     Z-ADDWL0105    WL0157           LLT Lot Number
     C                     MOVELWL0106    WL0158    P      Location Code
     C                     Z-ADDWL0107    WL0159           LLT Location Le
     C                     MOVEL*BLANK    WL0160           Transfer Wareho
     C                     Z-ADD*ZERO     WL0161           LLT Transfer Lo
     C                     MOVEL*BLANK    WL0162           Transfer Locati
     C                     Z-ADD*ZERO     WL0163           LLT Transfer Lo
     C                     Z-ADD*ZERO     WL0164           Order Number
     C                     MOVEL'P'       WL0165    P      LLT Status
     C                     MOVELWULLTU    WL0166    P      LTT Unused Sts
     C                     MOVELWULLYT    WL0167    P      LTT Unused Sts
     C                     MOVELWN0137    WL0168    P      EDI Status 1
     C                     MOVELWN0138    WL0169    P      EDI Status 2
     C                     MOVELWN0139    WL0170    P      EDI Status 3
     C                     MOVELWN0140    WL0171    P      Record Status
     C                     Z-ADDWN0141    WL0172           Job Time
     C                     MOVELWN0142    WL0173    P      User Id
     C                     MOVELWN0143    WL0174    P      Job Name
     C                     Z-ADDWN0144    WL0175           Job Date
     C                     EXSR TBCRRC
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C                     WRITE@L5CPSL                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      *
     C                     Z-ADD*ZERO     WN0145  30       LLT Sequence Nu
     C                     MOVEL*BLANK    WN0146  1        EDI Status 1
     C                     MOVEL*BLANK    WN0147  1        EDI Status 2
     C                     MOVEL*BLANK    WN0148  1        EDI Status 3
     C                     MOVEL*BLANK    WN0149  1        Record Status
     C                     Z-ADD*ZERO     WN0150  60       Job Time
     C                     MOVEL*BLANK    WN0151 10        User Id
     C                     MOVEL*BLANK    WN0152 10        Job Name
     C                     Z-ADD*ZERO     WN0153  70       Job Date
      *
      * PFS Item Lot/Loc Trns IF
      * Rtv Next Seq #        RT - IC Item Lot/Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0101    WL0142           Company Number
     C                     Z-ADDWL0102    WL0143           Item Code
     C                     MOVELWL0103    WL0144    P      Warehouse Code
     C                     MOVELWL0132    WL0145    P      LLT Transaction
     C                     Z-ADD##JDT     WL0146           LLT Transaction
     C                     EXSR TARVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0147    WN0145           LLT Sequence Nu
      * Crt Item Lot/Loc Trns CR - Item Lot Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0101    WL0148           Company Number
     C                     Z-ADDWL0102    WL0149           Item Code
     C                     MOVELWL0103    WL0150    P      Warehouse Code
     C                     MOVELWL0132    WL0151    P      LLT Transaction
     C                     Z-ADD##JDT     WL0152           LLT Transaction
     C                     Z-ADDWN0145    WL0153           LLT Sequence Nu
     C                     Z-ADDWL0104    WL0154           LLT Production
     C                     Z-ADDWL0108    WL0155           LLT Transaction
     C                     Z-ADDWL0111    WL0156           LLT Transaction
     C                     Z-ADDWL0105    WL0157           LLT Lot Number
     C                     MOVELWL0106    WL0158    P      Location Code
     C                     Z-ADDWL0107    WL0159           LLT Location Le
     C                     MOVEL*BLANK    WL0160           Transfer Wareho
     C                     Z-ADD*ZERO     WL0161           LLT Transfer Lo
     C                     MOVEL*BLANK    WL0162           Transfer Locati
     C                     Z-ADD*ZERO     WL0163           LLT Transfer Lo
     C                     Z-ADD*ZERO     WL0164           Order Number
     C                     MOVEL'P'       WL0165    P      LLT Status
     C                     MOVELWULLTU    WL0166    P      LTT Unused Sts
     C                     MOVELWULLYT    WL0167    P      LTT Unused Sts
     C                     MOVELWN0146    WL0168    P      EDI Status 1
     C                     MOVELWN0147    WL0169    P      EDI Status 2
     C                     MOVELWN0148    WL0170    P      EDI Status 3
     C                     MOVELWN0149    WL0171    P      Record Status
     C                     Z-ADDWN0150    WL0172           Job Time
     C                     MOVELWN0151    WL0173    P      User Id
     C                     MOVELWN0152    WL0174    P      Job Name
     C                     Z-ADDWN0153    WL0175           Job Date
     C                     EXSR TBCRRC
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Rtv Loc Type          RT - Warehouse Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WVAJCD           Warehouse Code
     C                     KFLD           WVYMCD           Location Code
      * Setup key
     C                     MOVELWL0133    WVAJCD           Warehouse Code
     C                     MOVELWL0134    WVYMCD           Location Code
      * Establish starting position
     C           KRSSU     CHAIN@L2RESM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2628' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0135           WLT Type Code
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWVAGSX    WL0135           WLT Type Code
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Rtv Chill Time        RT - Warehouse Location Type  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WWAGSX           WLT Type Code
      * Setup key
     C                     MOVELWL0136    WWAGSX           WLT Type Code
      * Establish starting position
     C           KRSSV     CHAIN@L3RET8              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2660' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0137           WLT Type Chill
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWWSLTY    WL0137           WLT Type Chill
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * RTV Unit Weight        RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WRAIC3           Company Number
     C                     KFLD           WRHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0138    WRAIC3           Company Number
     C                     Z-ADDWL0139    WRHGCD           Item Code
      * Establish starting position
     C           KRSSW     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0140           Unit Weight
     C                     MOVEL*BLANK    WL0141           Quality Level
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWRAIWG    WL0140           Unit Weight
     C                     MOVELWRHICD    WL0141           Quality Level
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * PFS Upd Qty On-Hand   RT - Item Lot Location  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0088  50       ILL Item Qty On
     C                     Z-ADD*ZERO     WN0089 112       ILL Unit Weight
     C                     Z-ADD*ZERO     WN0090  50       ILL Co-Packer L
     C                     Z-ADD*ZERO     WN0091 112       ILL Item Wgt On
     C                     Z-ADD*ZERO     WN0092  50       ILL Unused Qty
     C                     Z-ADD*ZERO     WN0093 112       ILL Unused Wgt
     C                     Z-ADD*ZERO     WN0094  70       ILL Avail Ship
     C                     Z-ADD*ZERO     WN0095  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0096  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0097  72       ILL Unused Nbr
     C                     MOVEL*BLANK    WN0098  6        ILL Customer Co
     C                     MOVEL*BLANK    WN0099  1        ILL Status
     C                     MOVEL*BLANK    WN0100  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0101  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0102  2        ILL Unused Sts
     C                     MOVEL*BLANK    WN0103  3        Inv Hold Reason
     C                     MOVEL*BLANK    WN0104  1        EDI Status 1
     C                     MOVEL*BLANK    WN0105  1        EDI Status 2
     C                     MOVEL*BLANK    WN0106  1        EDI Status 3
     C                     MOVEL*BLANK    WN0107  1        Record Status
     C                     Z-ADD*ZERO     WN0108  60       Job Time
     C                     MOVEL*BLANK    WN0109 10        User Id
     C                     MOVEL*BLANK    WN0110 10        Job Name
     C                     Z-ADD*ZERO     WN0111  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WXAIC3           Company Number
     C                     KFLD           WXHGCD           Item Code
     C                     KFLD           WXAJCD           Warehouse Code
     C                     KFLD           WXELDT           Production Date
     C                     KFLD           WXLXNM           Lot Number
     C                     KFLD           WXYMCD           Location Code
     C                     KFLD           WXYNCD           Location Level
      * Setup key
     C                     Z-ADDWL0101    WXAIC3           Company Number
     C                     Z-ADDWL0102    WXHGCD           Item Code
     C                     MOVELWL0103    WXAJCD           Warehouse Code
     C                     Z-ADDWL0104    WXELDT           Production Date
     C                     Z-ADDWL0105    WXLXNM           Lot Number
     C                     MOVELWL0106    WXYMCD           Location Code
     C                     Z-ADDWL0107    WXYNCD           Location Level
      * Establish starting position
     C           KRSSX     CHAIN@L5CPSV              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2634' W0RTN   7
      * USER: Processing if Data record not found
      *
     C                     MOVEL*BLANK    WN0112  1        WLT Type Code
     C                     Z-ADD*ZERO     WN0113  52       WLT Type Chill
      *
      * Clc Loc Avail Shp Dte IF
      * Rtv Loc Type          RT - Warehouse Location  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWL0103    WL0133    P      Warehouse Code
     C                     MOVELWL0106    WL0134    P      Location Code
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0135    WN0112    P      WLT Type Code
      * Rtv Chill Time        RT - Warehouse Location Type  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0112    WL0136    P      WLT Type Code
     C                     EXSR SVRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0137    WN0113           WLT Type Chill
      * PAR.ILL Avail Ship Date = PAR.Production Date + PAR.WLT Type Chil
     C           WL0104    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN0113    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0094
     C                     ELSE
     C           XDINDT    SUB  1000000   WN0094
     C                     END
      * RTV Unit Weight        RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0101    WL0138           Company Number
     C                     Z-ADDWL0102    WL0139           Item Code
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0140    WN0089           Unit Weight
     C                     MOVELWL0141    YL0017    P      Quality Level
      * Crt Item Loc          CR - Item Lot Location  * 
     C                     EXSR SYCRRC
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WXJ2QT    ADD  WL0108    WN0088           ILL Item Qty On
     C           WXG6WG    ADD  WL0111    WN0091           ILL Item Wgt On
      * CASE: PAR.ILL Item Qty On-Hand is NE Zero
     C           WN0088    IFNE 0                          *IF
      * PFS Chg Qty/Wgt OnHnd CH - Item Lot Location  * 
     C                     EXSR SZCHRC
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYCRRC    BEGSR
      *================================================================
      * Crt Item Loc          CR - Item Lot Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @L5CPSL
     C                     Z-ADDWL0101    WTAIC3           Company Number
     C                     Z-ADDWL0102    WTHGCD           Item Code
     C                     MOVELWL0103    WTAJCD           Warehouse Code
     C                     Z-ADDWL0104    WTELDT           Production Date
     C                     Z-ADDWL0105    WTLXNM           Lot Number
     C                     MOVELWL0106    WTYMCD           Location Code
     C                     Z-ADDWL0107    WTYNCD           Location Level
     C                     Z-ADDWL0108    WTJ2QT           ILL Item Qty On
     C                     Z-ADDWN0089    WTG5WG           ILL Unit Weight
     C                     Z-ADDWN0090    WTJ3QT           ILL Co-Packer L
     C                     Z-ADDWN0091    WTG6WG           ILL Item Wgt On
     C                     Z-ADDWN0092    WTJ4QT           ILL Unused Qty
     C                     Z-ADDWN0093    WTG7WG           ILL Unused Wgt
     C                     Z-ADDWN0094    WTLODT           ILL Avail Ship
     C                     Z-ADDWN0095    WTLPDT           ILL Unused Date
     C                     Z-ADDWN0096    WTLQDT           ILL Unused Date
     C                     Z-ADDWN0097    WTNBR            ILL Unused Nbr
     C                     MOVELWN0098    WTYTCD           ILL Customer Co
     C                     MOVEL'A'       WTAMSX           ILL Status
     C                     MOVELWN0100    WTASSX           ILL Unused Sts
     C                     MOVELWN0101    WTATSX           ILL Unused Sts
     C                     MOVELWN0102    WTAUSX           ILL Unused Sts
     C                     MOVELWN0103    WTYSCD           Inv Hold Reason
     C                     MOVELWN0104    WTUVST           EDI Status 1
     C                     MOVELWN0105    WTUWST           EDI Status 2
     C                     MOVELWN0106    WTUXST           EDI Status 3
     C                     MOVELWN0107    WTVSST           Record Status
     C                     Z-ADDWN0108    WTAATM           Job Time
     C                     MOVELWN0109    WTAYNA           User Id
     C                     MOVELWN0110    WTA0NA           Job Name
     C                     Z-ADDWN0111    WTAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WTVSST           Record Status
     C                     Z-ADD##JTM     WTAATM           Job Time
     C                     MOVEL##USR     WTAYNA           User Id
     C                     MOVEL##PGM     WTA0NA           Job Name
     C                     Z-ADD##JDT     WTAXDT           Job Date
     C           KLCRSY    KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTHGCD           Item Code
     C                     KFLD           WTAJCD           Warehouse Code
     C                     KFLD           WTELDT           Production Date
     C                     KFLD           WTLXNM           Lot Number
     C                     KFLD           WTYMCD           Location Code
     C                     KFLD           WTYNCD           Location Level
      * Check for duplicate primary key
     C           KLCRSY    SETLL@L5CPSL                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2635' W0RTN   7
      * Send message 'Item Lot Location      EX'
     C                     MOVEL'USR2635' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C                     WRITE@L5CPSL                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZCHRC    BEGSR
      *================================================================
      * PFS Chg Qty/Wgt OnHnd CH - Item Lot Location  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0114 112       ILL Unit Weight
     C                     Z-ADD*ZERO     WN0115  50       ILL Co-Packer L
     C                     Z-ADD*ZERO     WN0116  50       ILL Unused Qty
     C                     Z-ADD*ZERO     WN0117 112       ILL Unused Wgt
     C                     Z-ADD*ZERO     WN0118  70       ILL Avail Ship
     C                     Z-ADD*ZERO     WN0119  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0120  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0121  72       ILL Unused Nbr
     C                     MOVEL*BLANK    WN0122  6        ILL Customer Co
     C                     MOVEL*BLANK    WN0123  1        ILL Status
     C                     MOVEL*BLANK    WN0124  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0125  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0126  2        ILL Unused Sts
     C                     MOVEL*BLANK    WN0127  3        Inv Hold Reason
     C                     MOVEL*BLANK    WN0128  1        EDI Status 1
     C                     MOVEL*BLANK    WN0129  1        EDI Status 2
     C                     MOVEL*BLANK    WN0130  1        EDI Status 3
     C                     MOVEL*BLANK    WN0131  1        Record Status
     C                     Z-ADD*ZERO     WN0132  60       Job Time
     C                     MOVEL*BLANK    WN0133 10        User Id
     C                     MOVEL*BLANK    WN0134 10        Job Name
     C                     Z-ADD*ZERO     WN0135  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @L5CPSL
     C                     Z-ADDWXAIC3    WTAIC3           Company Number
     C                     Z-ADDWXHGCD    WTHGCD           Item Code
     C                     MOVELWXAJCD    WTAJCD    P      Warehouse Code
     C                     Z-ADDWXELDT    WTELDT           Production Date
     C                     Z-ADDWXLXNM    WTLXNM           Lot Number
     C                     MOVELWXYMCD    WTYMCD    P      Location Code
     C                     Z-ADDWXYNCD    WTYNCD           Location Level
      *
     C           KLCHSZ    KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTHGCD           Item Code
     C                     KFLD           WTAJCD           Warehouse Code
     C                     KFLD           WTELDT           Production Date
     C                     KFLD           WTLXNM           Lot Number
     C                     KFLD           WTYMCD           Location Code
     C                     KFLD           WTYNCD           Location Level
     C           KLCHSZ    CHAIN@L5CPSL              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDL5CPL0'MDACP
     C                     MOVEL'@L5CPSL' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SZEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDL51    YARDCS
      * Move non-key fields to @L5CPSL
     C                     Z-ADDWN0088    WTJ2QT           ILL Item Qty On
     C                     Z-ADDWN0091    WTG6WG           ILL Item Wgt On
      *
      * Set PGM.*Record Data Changed flag
     C           QPDL51    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WTAATM           Job Time
     C                     MOVEL##USR     WTAYNA           User Id
     C                     MOVEL##PGM     WTA0NA           Job Name
     C                     Z-ADD##JDT     WTAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDL51    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@L5CPSL                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDL5CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * Rtv Next Seq #        RT - IC Item Lot/Loc Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WYAIC3    WQTA01           Company Number
     C           *LIKE     DEFN WYHGCD    WQTA02           Item Code
     C           *LIKE     DEFN WYAJCD    WQTA03           Warehouse Code
     C           *LIKE     DEFN WYLTRT    WQTA04           LLT Transaction
     C           *LIKE     DEFN WYLRDT    WQTA05           LLT Transaction
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA01           Company Number
     C                     KFLD           WQTA02           Item Code
     C                     KFLD           WQTA03           Warehouse Code
     C                     KFLD           WQTA04           LLT Transaction
     C                     KFLD           WQTA05           LLT Transaction
      * Setup key
     C                     Z-ADDWL0142    WQTA01           Company Number
     C                     Z-ADDWL0143    WQTA02           Item Code
     C                     MOVELWL0144    WQTA03           Warehouse Code
     C                     MOVELWL0145    WQTA04           LLT Transaction
     C                     Z-ADDWL0146    WQTA05           LLT Transaction
      * Establish starting position
     C           KRSTA     SETLL@L7CPUK                    *
     C           KRSTA     READE@L7CPUK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2638' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WL0147           LLT Sequence Nu
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WYLLTS    ADD  1         WL0147           LLT Sequence Nu
     C                     GOTO TAEXIT                     *QUIT
     C           KRSTA     READE@L7CPUK                  90*
     C                     ENDDO
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBCRRC    BEGSR
      *================================================================
      * Crt Item Lot/Loc Trns CR - Item Lot Loc Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @L7CPS3
     C                     Z-ADDWL0148    TAAIC3           Company Number
     C                     Z-ADDWL0149    TAHGCD           Item Code
     C                     MOVELWL0150    TAAJCD           Warehouse Code
     C                     MOVELWL0151    TALTRT           LLT Transaction
     C                     Z-ADDWL0152    TALRDT           LLT Transaction
     C                     Z-ADDWL0153    TALLTS           LLT Sequence Nu
     C                     Z-ADDWL0154    TALSDT           LLT Production
     C                     Z-ADDWL0155    TAJ5QT           LLT Transaction
     C                     Z-ADDWL0156    TAG8WG           LLT Transaction
     C                     Z-ADDWL0157    TALLTN           LLT Lot Number
     C                     MOVELWL0158    TAYMCD           Location Code
     C                     Z-ADDWL0159    TALLCL           LLT Location Le
     C                     MOVELWL0160    TABNAA           Transfer Wareho
     C                     Z-ADDWL0161    TALLTR           LLT Transfer Lo
     C                     MOVELWL0162    TAY2CD           Transfer Locati
     C                     Z-ADDWL0163    TALLTL           LLT Transfer Lo
     C                     Z-ADDWL0164    TAC4NB           Order Number
     C                     MOVELWL0165    TALOST           LLT Status
     C                     MOVELWL0166    TALLTU           LTT Unused Sts
     C                     MOVELWL0167    TALLYT           LTT Unused Sts
     C                     MOVELWL0168    TAUVST           EDI Status 1
     C                     MOVELWL0169    TAUWST           EDI Status 2
     C                     MOVELWL0170    TAUXST           EDI Status 3
     C                     MOVELWL0171    TAVSST           Record Status
     C                     Z-ADDWL0172    TAAATM           Job Time
     C                     MOVELWL0173    TAAYNA           User Id
     C                     MOVELWL0174    TAA0NA           Job Name
     C                     Z-ADDWL0175    TAAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       TAVSST           Record Status
     C                     Z-ADD##JTM     TAAATM           Job Time
     C                     MOVEL##USR     TAAYNA           User Id
     C                     MOVEL##PGM     TAA0NA           Job Name
     C                     Z-ADD##JDT     TAAXDT           Job Date
     C           KLCRTB    KLIST
     C                     KFLD           TAAIC3           Company Number
     C                     KFLD           TAHGCD           Item Code
     C                     KFLD           TAAJCD           Warehouse Code
     C                     KFLD           TALTRT           LLT Transaction
     C                     KFLD           TALRDT           LLT Transaction
     C                     KFLD           TALLTS           LLT Sequence Nu
      * Check for duplicate primary key
     C           KLCRTB    SETLL@L7CPS3                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2639' W0RTN   7
      * Send message 'Item Lot Loc Trans     EX'
     C                     MOVEL'USR2639' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C                     WRITE@L7CPS3                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * Crt Item Balance Dtl  RT - Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           TBAIC3           Company Number
     C                     KFLD           TBHGCD           Item Code
     C                     KFLD           TBAJCD           Warehouse Code
     C                     KFLD           TBELDT           Production Date
      * Setup key
     C                     Z-ADDWL0176    TBAIC3           Company Number
     C                     Z-ADDWL0177    TBHGCD           Item Code
     C                     MOVELWL0178    TBAJCD           Warehouse Code
     C                     Z-ADDWL0179    TBELDT           Production Date
      * Establish starting position
     C           KRSTC     CHAIN@B1REJ0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0330' W0RTN   7
      * USER: Processing if Data record not found
      * Rtv Item Typ/Grp/Cls  RT - Company Item  * 
     C                     EXSR TDRVGN
      * Crt Item Bal. Detail   CR - Item Balance Detail  * 
     C                     EXSR TECRRC
     C                     GOTO TCEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Rtv Item Typ/Grp/Cls  RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WRAIC3           Company Number
     C                     KFLD           WRHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0176    WRAIC3           Company Number
     C                     Z-ADDWL0177    WRHGCD           Item Code
      * Establish starting position
     C           KRSTD     CHAIN@BZREJU              90    *
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWRRINB    YL0018           Item Structure
     C                     Z-ADDWRRHNB    YL0019           Item Structure
     C                     Z-ADDWRRGNB    YL0020           Item Structure
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TECRRC    BEGSR
      *================================================================
      * Crt Item Bal. Detail   CR - Item Balance Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0154  60       Job Time
     C                     MOVEL*BLANK    WN0155 10        User Id
     C                     MOVEL*BLANK    WN0156 10        Job Name
     C                     Z-ADD*ZERO     WN0157  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1REJ1
     C                     Z-ADDWL0176    TCAIC3           Company Number
     C                     Z-ADDWL0177    TCHGCD           Item Code
     C                     MOVELWL0178    TCAJCD           Warehouse Code
     C                     Z-ADDWL0179    TCELDT           Production Date
     C                     Z-ADD*ZERO     TCABWG           Physical Count
     C                     Z-ADD*ZERO     TCAGQT           Physical Count
     C                     Z-ADD*ZERO     TCAHQT           Physical Count
     C                     Z-ADD*ZERO     TCAIQT           Physical Count
     C                     MOVEL*BLANK    TCCTST           Physical Count
     C                     Z-ADD*ZERO     TCACWG           Quantity on Han
     C                     Z-ADD*ZERO     TCARQT           Quantity on Han
     C                     Z-ADD*ZERO     TCASQT           Quantity on Han
     C                     Z-ADD*ZERO     TCATQT           Quantity on Han
     C                     Z-ADD*ZERO     TCHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     TCHEQT           Weight In Chill
     C                     MOVELWUF6ST    TCF6ST           Update Exceptio
     C                     Z-ADD*ZERO     TCBMWG           Physical Start
     C                     Z-ADD*ZERO     TCDSQT           Physical Start
     C                     Z-ADD*ZERO     TCDTQT           Physical Start
     C                     Z-ADD*ZERO     TCDUQT           Physical Start
     C                     Z-ADD*ZERO     TCDHDT           Physical Start
     C                     Z-ADD*ZERO     TCAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     TCAECS           Last Cost
     C                     Z-ADD*ZERO     TCIDVA           Value of On Han
     C                     Z-ADD*ZERO     TCK7DT           Label Date
     C                     Z-ADDYL0018    TCRINB           Item Structure
     C                     Z-ADDYL0019    TCRHNB           Item Structure
     C                     Z-ADDYL0020    TCRGNB           Item Structure
     C                     MOVELWUUVST    TCUVST           EDI Status 1
     C                     MOVELWUUWST    TCUWST           EDI Status 2
     C                     MOVELWUUXST    TCUXST           EDI Status 3
     C                     MOVEL'A'       TCVSST           Record Status
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     TCAATM           Job Time
     C                     MOVEL##USR     TCAYNA           User Id
     C                     MOVEL##JOB     TCA0NA           Job Name
     C                     Z-ADD##JDT     TCAXDT           Job Date
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           TCAXDT    PARM *ZERO     WQ0111 155       Current System
     C           TCAATM    PARM *ZERO     WQ0112 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C           KLCRTE    KLIST
     C                     KFLD           TCAIC3           Company Number
     C                     KFLD           TCHGCD           Item Code
     C                     KFLD           TCAJCD           Warehouse Code
     C                     KFLD           TCELDT           Production Date
      * Check for duplicate primary key
     C           KLCRTE    SETLL@B1REJ1                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0331' W0RTN   7
      * Send message 'Item Balance Detail    EX'
     C                     MOVEL'USR0331' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C                     WRITE@B1REJ1                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * PFS Upd Warehouse     RT - Product Trace  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLAIC3    WQTF01           Company Number
     C           *LIKE     DEFN WLPFNX    WQTF02           PT Serial Numbe
     C           *LIKE     DEFN WLADDX    WQTF03           PT Label Date Y
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           WQTF01           Company Number
     C                     KFLD           WQTF02           PT Serial Numbe
     C                     KFLD           WQTF03           PT Label Date Y
      * Setup key
     C                     Z-ADDWN0002    WQTF01           Company Number
     C                     Z-ADDWN0026    WQTF02           PT Serial Numbe
     C                     Z-ADDWN0042    WQTF03           PT Label Date Y
      * Establish starting position
     C           KRSTF     SETLL@B2CPT3                    *
     C           KRSTF     READE@B2CPT3                  90*
      * Data record not found
     C   90                MOVEL'USR3144' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.PT Warehouse ID Code NE DB1.PT Warehouse ID Code
     C           WN0034    IFNE WLDNAA                     *IF
      * Chg Warehouse Code    CH - Product Trace  * 
     C                     EXSR TGCHRC
     C                     END                             *FI
     C           KRSTF     READE@B2CPT3                  90*
     C                     ENDDO
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGCHRC    BEGSR
      *================================================================
      * Chg Warehouse Code    CH - Product Trace  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0158  80       PT Label Date Y
     C                     Z-ADD*ZERO     WN0159  80       PT Offset Prod
     C                     Z-ADD*ZERO     WN0160  60       PT Offset Prod
     C                     MOVEL*BLANK    WN0161  1        PT Inventory St
     C                     Z-ADD*ZERO     WN0162  51       PT Net Weight
     C                     Z-ADD*ZERO     WN0163  51       PT Gross Weight
     C                     MOVEL*BLANK    WN0164  1        PT Shift Number
     C                     Z-ADD*ZERO     WN0165  70       PT Order Number
     C                     MOVEL*BLANK    WN0166 10        PT Pallet Numbe
     C                     Z-ADD*ZERO     WN0167  70       PT Product Code
     C                     MOVEL*BLANK    WN0168 32        PT Item Label L
     C                     MOVEL*BLANK    WN0169 32        PT Item Label L
     C                     MOVEL*BLANK    WN0170  2        PT Fresh/Frozen
     C                     MOVEL*BLANK    WN0171  9        PT Item Picture
     C                     Z-ADD*ZERO     WN0172  50       PT Tattoo Numbe
     C                     MOVEL*BLANK    WN0173  1        PT Source Type
     C                     MOVEL*BLANK    WN0174  3        PT Source Code
     C                     MOVEL*BLANK    WN0175 25        PT Source Code
     C                     MOVEL*BLANK    WN0176  5        PT Producer/Cel
     C                     MOVEL*BLANK    WN0177 25        PT Producer/Cel
     C                     MOVEL*BLANK    WN0178  7        PT Producer/Far
     C                     MOVEL*BLANK    WN0179  6        PT Producer Loc
     C                     MOVEL*BLANK    WN0180 40        PT Producer/Far
     C                     MOVEL*BLANK    WN0181 40        PT Producer/Far
     C                     MOVEL*BLANK    WN0182  2        PT Producer/Far
     C                     MOVEL*BLANK    WN0183 20        PT Producer/Far
     C                     MOVEL*BLANK    WN0184  5        PT Genetic Code
     C                     MOVEL*BLANK    WN0185 25        PT Genetic Desc
     C                     MOVEL*BLANK    WN0186  1        PT Gender Code
     C                     MOVEL*BLANK    WN0187  7        PT Producer/Far
     C                     MOVEL*BLANK    WN0188  7        PT Producer/Far
     C                     MOVEL*BLANK    WN0189  7        PT Producer/Far
     C                     MOVEL*BLANK    WN0190  7        PT Producer/Far
     C                     MOVEL*BLANK    WN0191  3        PT Item Type Co
     C                     Z-ADD*ZERO     WN0192  30       PT Item Str Cla
     C                     Z-ADD*ZERO     WN0193  30       PT Item Str Gro
     C                     Z-ADD*ZERO     WN0194  30       PT Item Str Typ
     C                     Z-ADD*ZERO     WN0195  80       PT WIP Dump/Pro
     C                     Z-ADD*ZERO     WN0196  60       PT WIP Dump/Pro
     C                     MOVEL*BLANK    WN0197  1        PT WIP Dump/Pro
     C                     MOVEL*BLANK    WN0198  1        PT WIP Used/Not
     C                     Z-ADD*ZERO     WN0199  80       PT From FG Seri
     C                     Z-ADD*ZERO     WN0200  80       PT To FG Serial
     C                     Z-ADD*ZERO     WN0201  80       PT Unused Nbr 3
     C                     Z-ADD*ZERO     WN0202  70       PT Unused Nbr 4
     C                     MOVEL*BLANK    WN0203  1        PT Incl in Prod
     C                     MOVEL*BLANK    WN0204  1        PT Unused Sts 4
     C                     Z-ADD*ZERO     WN0205  60       Job Time
     C                     MOVEL*BLANK    WN0206 10        User Id
     C                     MOVEL*BLANK    WN0207 10        Job Name
     C                     Z-ADD*ZERO     WN0208  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @B2CPMP
     C                     Z-ADDWLAIC3    WSAIC3           Company Number
     C                     Z-ADDWLPFNX    WSPFNX           PT Serial Numbe
     C                     Z-ADDWLAADX    WSAADX           PT Prod Date YY
     C                     Z-ADDWLB9TM    WSB9TM           PT Production T
      *
     C           KLCHTG    KLIST
     C                     KFLD           WSAIC3           Company Number
     C                     KFLD           WSPFNX           PT Serial Numbe
     C                     KFLD           WSAADX           PT Prod Date YY
     C                     KFLD           WSB9TM           PT Production T
     C           KLCHTG    CHAIN@B2CPMP              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POB2CPL0'MDACP
     C                     MOVEL'@B2CPMP' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPOB21    YBRDCS
      * Move non-key fields to @B2CPMP
     C                     MOVELWN0034    WSDNAA    P      PT Warehouse ID
      *
      * Set PGM.*Record Data Changed flag
     C           QPOB21    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@B2CPMP                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPOB2CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * Upd Location Hold PFS RT - Item Lot Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           WXAIC3           Company Number
     C                     KFLD           WXHGCD           Item Code
     C                     KFLD           WXAJCD           Warehouse Code
     C                     KFLD           WXELDT           Production Date
     C                     KFLD           WXLXNM           Lot Number
     C                     KFLD           WXYMCD           Location Code
     C                     KFLD           WXYNCD           Location Level
      * Setup key
     C                     Z-ADDWL0180    WXAIC3           Company Number
     C                     Z-ADDWL0181    WXHGCD           Item Code
     C                     MOVELWL0182    WXAJCD           Warehouse Code
     C                     Z-ADDWL0183    WXELDT           Production Date
     C                     Z-ADDWL0184    WXLXNM           Lot Number
     C                     MOVELWL0185    WXYMCD           Location Code
     C                     Z-ADDWL0186    WXYNCD           Location Level
      * Establish starting position
     C           KRSTH     CHAIN@L5CPSV              90    *
      * Data record not found
     C   90                MOVEL'USR2634' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Location Hold PFS CH - Item Lot Location  * 
     C                     EXSR TICHRC
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TICHRC    BEGSR
      *================================================================
      * Chg Location Hold PFS CH - Item Lot Location  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0209  50       ILL Item Qty On
     C                     Z-ADD*ZERO     WN0210 112       ILL Unit Weight
     C                     Z-ADD*ZERO     WN0211  50       ILL Co-Packer L
     C                     Z-ADD*ZERO     WN0212 112       ILL Item Wgt On
     C                     Z-ADD*ZERO     WN0213  50       ILL Unused Qty
     C                     Z-ADD*ZERO     WN0214 112       ILL Unused Wgt
     C                     Z-ADD*ZERO     WN0215  70       ILL Avail Ship
     C                     Z-ADD*ZERO     WN0216  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0217  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0218  72       ILL Unused Nbr
     C                     MOVEL*BLANK    WN0219  6        ILL Customer Co
     C                     MOVEL*BLANK    WN0220  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0221  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0222  2        ILL Unused Sts
     C                     MOVEL*BLANK    WN0223  1        EDI Status 1
     C                     MOVEL*BLANK    WN0224  1        EDI Status 2
     C                     MOVEL*BLANK    WN0225  1        EDI Status 3
     C                     MOVEL*BLANK    WN0226  1        Record Status
     C                     Z-ADD*ZERO     WN0227  60       Job Time
     C                     MOVEL*BLANK    WN0228 10        User Id
     C                     MOVEL*BLANK    WN0229 10        Job Name
     C                     Z-ADD*ZERO     WN0230  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @L5CPSL
     C                     Z-ADDWXAIC3    WTAIC3           Company Number
     C                     Z-ADDWXHGCD    WTHGCD           Item Code
     C                     MOVELWXAJCD    WTAJCD    P      Warehouse Code
     C                     Z-ADDWXELDT    WTELDT           Production Date
     C                     Z-ADDWXLXNM    WTLXNM           Lot Number
     C                     MOVELWXYMCD    WTYMCD    P      Location Code
     C                     Z-ADDWXYNCD    WTYNCD           Location Level
      *
     C           KLCHTI    KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTHGCD           Item Code
     C                     KFLD           WTAJCD           Warehouse Code
     C                     KFLD           WTELDT           Production Date
     C                     KFLD           WTLXNM           Lot Number
     C                     KFLD           WTYMCD           Location Code
     C                     KFLD           WTYNCD           Location Level
     C           KLCHTI    CHAIN@L5CPSL              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDL5CPL0'MDACP
     C                     MOVEL'@L5CPSL' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDL51    YCRDCS
      * Move non-key fields to @L5CPSL
     C                     MOVELWL0187    WTAMSX    P      ILL Status
     C                     MOVELWL0188    WTYSCD    P      Inv Hold Reason
      *
      * Set PGM.*Record Data Changed flag
     C           QPDL51    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WTAATM           Job Time
     C                     MOVEL##USR     WTAYNA           User Id
     C                     MOVEL##PGM     WTA0NA           Job Name
     C                     Z-ADD##JDT     WTAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDL51    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@L5CPSL                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDL5CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * Rtv Next Case Seq#    RT - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TDAIC3    WQTJ01           Company Number
     C           *LIKE     DEFN TDC4NB    WQTJ02           Order Number
     C           *LIKE     DEFN TDDPNB    WQTJ03           Order Sequence
     C           *LIKE     DEFN TDUENB    WQTJ04           Order Secondary
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           WQTJ01           Company Number
     C                     KFLD           WQTJ02           Order Number
     C                     KFLD           WQTJ03           Order Sequence
     C                     KFLD           WQTJ04           Order Secondary
      * Setup key
     C                     Z-ADDWN0002    WQTJ01           Company Number
     C                     Z-ADDWN0056    WQTJ02           Order Number
     C                     Z-ADDWN0064    WQTJ03           Order Sequence
     C                     Z-ADDWN0065    WQTJ04           Order Secondary
      * Establish starting position
     C           KRSTJ     SETLL@FNCPUW                    *
     C           KRSTJ     READE@FNCPUW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1196' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WN0231           Case Sequence N
     C                     GOTO TJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           TDRZNB    ADD  1         WN0231           Case Sequence N
     C                     GOTO TJEXIT                     *QUIT
     C           KRSTJ     READE@FNCPUW                  90*
     C                     ENDDO
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKCRRC    BEGSR
      *================================================================
      * Crt Manifest Detail   CR - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FNCPCS
     C                     Z-ADDWL0189    TEAIC3           Company Number
     C                     Z-ADDWL0190    TEC4NB           Order Number
     C                     Z-ADDWL0191    TEDPNB           Order Sequence
     C                     Z-ADDWL0192    TEUENB           Order Secondary
     C                     Z-ADDWL0193    TERZNB           Case Sequence N
     C                     Z-ADDWL0194    TEFOQT           Case Quantity
     C                     Z-ADDWL0195    TER0NB           Case Weight
     C                     MOVELWL0196    TEPMST           Inventory Updat
     C                     Z-ADDWL0197    TEK7DT           Label Date
     C                     Z-ADDWL0198    TEPFNX           PT Serial Numbe
     C                     Z-ADDWL0199    TEHGCD           Item Code
     C                     MOVELWL0200    TEAJCD           Warehouse Code
     C                     Z-ADDWL0201    TEELDT           Production Date
     C                     Z-ADDWL0202    TEN5WG           Manifest Gross
     C                     MOVELWL0203    TERZNA           Manifest Lot ID
     C                     Z-ADDWL0204    TEH5NY           Manifest Total
     C                     Z-ADDWL0205    TEH6NY           Manifest Co_Par
     C                     Z-ADDWL0206    TEH7NY           Manifest Pallet
     C                     MOVELWL0207    TEGBTX           Manifest Shift
     C                     Z-ADDWL0208    TEN6WG           HPB Meter Net G
     C                     Z-ADDWL0209    TEN7WG           Manifest Net We
     C                     MOVELWL0210    TEGCTX           Manifest Unused
     C                     MOVELWL0211    TEGDTX           Manifest Unused
     C                     Z-ADDWL0212    TERBDT           Manifest Unused
     C                     Z-ADDWL0213    TEITNY           HPB COA Batch N
     C                     Z-ADDWL0214    TEIVNY           HPB Meter Start
     C                     Z-ADDWL0215    TEIUNY           HPB Meter Endin
     C                     Z-ADDWL0216    TEIWNY           HPB Meter Total
     C                     Z-ADDWL0217    TEIXNY           HPB Meter Net W
     C                     Z-ADDWL0218    TEIYNY           HPB Density Ref
     C                     MOVELWL0219    TEUVST           EDI Status 1
     C                     MOVELWL0220    TEUWST           EDI Status 2
     C                     MOVELWL0221    TEUXST           EDI Status 3
     C                     MOVELWL0222    TEVSST           Record Status
     C                     Z-ADDWL0223    TEAATM           Job Time
     C                     MOVELWL0224    TEAYNA           User Id
     C                     MOVELWL0225    TEA0NA           Job Name
     C                     Z-ADDWL0226    TEAXDT           Job Date
     C                     Z-ADDWL0227    TELPNZ           Manifest Pallet
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       TEVSST           Record Status
     C                     Z-ADD##JTM     TEAATM           Job Time
     C                     MOVEL##USR     TEAYNA           User Id
     C                     MOVEL##PGM     TEA0NA           Job Name
     C                     Z-ADD##JDT     TEAXDT           Job Date
     C           KLCRTK    KLIST
     C                     KFLD           TEAIC3           Company Number
     C                     KFLD           TEC4NB           Order Number
     C                     KFLD           TEDPNB           Order Sequence
     C                     KFLD           TEUENB           Order Secondary
     C                     KFLD           TERZNB           Case Sequence N
      * Check for duplicate primary key
     C           KLCRTK    SETLL@FNCPCS                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1197' W0RTN   7
      * Send message 'Manifest Detail        EX'
     C                     MOVEL'USR1197' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C                     WRITE@FNCPCS                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * Rtv Next Seq Num      RT - Order Inv Allocation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TFAIC3    WQTL01           Company Number
     C           *LIKE     DEFN TFC4NB    WQTL02           Order Number
     C           *LIKE     DEFN TFDPNB    WQTL03           Order Sequence
     C           *LIKE     DEFN TFUENB    WQTL04           Order Secondary
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           WQTL01           Company Number
     C                     KFLD           WQTL02           Order Number
     C                     KFLD           WQTL03           Order Sequence
     C                     KFLD           WQTL04           Order Secondary
      * Setup key
     C                     Z-ADDWN0002    WQTL01           Company Number
     C                     Z-ADDWN0056    WQTL02           Order Number
     C                     Z-ADDWN0064    WQTL03           Order Sequence
     C                     Z-ADDWN0065    WQTL04           Order Secondary
      * Establish starting position
     C           KRSTL     SETLL@L8CPTD                    *
     C           KRSTL     READE@L8CPTD                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2640' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WN0241           Allocation Seq
     C                     GOTO TLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           TFALSW    ADD  1         WN0241           Allocation Seq
     C                     GOTO TLEXIT                     *QUIT
     C           KRSTL     READE@L8CPTD                  90*
     C                     ENDDO
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMCRRC    BEGSR
      *================================================================
      * Crt Order Inv Alloc   CR - Order Inv Allocation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @L8CPSX
     C                     Z-ADDWN0002    TGAIC3           Company Number
     C                     Z-ADDWN0056    TGC4NB           Order Number
     C                     Z-ADDWN0064    TGDPNB           Order Sequence
     C                     Z-ADDWN0065    TGUENB           Order Secondary
     C                     Z-ADDWN0241    TGALSW           Allocation Seq
     C                     Z-ADDWABDNY    TGJ6QT           OIA Alloc_Shipp
     C                     Z-ADDWAABNY    TGG9WG           OIA Alloc_Shipp
     C                     Z-ADD*ZERO     TGJ9QT           OIA Co-Packer L
     C                     Z-ADDWN0026    TGHAWG           OIA Serial Numb
     C                     MOVEL'A'       TGIOSE           OIA Create Sts
     C                     MOVEL*BLANK    TGOIMN           OIA Modified St
     C                     MOVEL'A'       TGSOAS           OIA Allocation
     C                     MOVEL*BLANK    TGARSX           OIA Loc Pick St
     C                     MOVELWUOTUS    TGOTUS           OIA Unused Sts
     C                     MOVELWUOTMP    TGOTMP           OIA Unused Sts
     C                     Z-ADDWN0019    TGHGCD           Item Code
     C                     MOVELWN0012    TGAJCD           Warehouse Code
     C                     Z-ADDWN0020    TGELDT           Production Date
     C                     Z-ADD*ZERO     TGLXNM           Lot Number
     C                     MOVELWN0051    TGYMCD           Location Code
     C                     Z-ADD*ZERO     TGYNCD           Location Level
     C                     MOVELWN0233    TGUVST           EDI Status 1
     C                     MOVELWN0234    TGUWST           EDI Status 2
     C                     MOVELWN0235    TGUXST           EDI Status 3
     C                     MOVELWN0236    TGVSST           Record Status
     C                     Z-ADDWN0237    TGAATM           Job Time
     C                     MOVELWN0238    TGAYNA           User Id
     C                     MOVELWN0239    TGA0NA           Job Name
     C                     Z-ADDWN0240    TGAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       TGVSST           Record Status
     C                     Z-ADD##JTM     TGAATM           Job Time
     C                     MOVEL##USR     TGAYNA           User Id
     C                     MOVEL##PGM     TGA0NA           Job Name
     C                     Z-ADD##JDT     TGAXDT           Job Date
     C           KLCRTM    KLIST
     C                     KFLD           TGAIC3           Company Number
     C                     KFLD           TGC4NB           Order Number
     C                     KFLD           TGDPNB           Order Sequence
     C                     KFLD           TGUENB           Order Secondary
     C                     KFLD           TGALSW           Allocation Seq
      * Check for duplicate primary key
     C           KLCRTM    SETLL@L8CPSX                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2641' W0RTN   7
      * Send message 'Order Inv Allocation   EX'
     C                     MOVEL'USR2641' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C                     WRITE@L8CPSX                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNRVGN    BEGSR
      *================================================================
      * PFS Upd Ord/Inv Sts   RT - Product Trace  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLAIC3    WQTN01           Company Number
     C           *LIKE     DEFN WLPFNX    WQTN02           PT Serial Numbe
     C           *LIKE     DEFN WLADDX    WQTN03           PT Label Date Y
      * Define keylist
     C           KRSTN     KLIST
     C                     KFLD           WQTN01           Company Number
     C                     KFLD           WQTN02           PT Serial Numbe
     C                     KFLD           WQTN03           PT Label Date Y
      * Setup key
     C                     Z-ADDWL0228    WQTN01           Company Number
     C                     Z-ADDWL0229    WQTN02           PT Serial Numbe
     C                     Z-ADDWL0230    WQTN03           PT Label Date Y
      * Establish starting position
     C           KRSTN     SETLL@B2CPT3                    *
     C           KRSTN     READE@B2CPT3                  90*
      * Data record not found
     C   90                MOVEL'USR3144' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * slm 01/10/2014 MTech Review Product Trace
      * slm 01/10/2014 MTech Inventory Status, Order Number
      * Chg Order Number      CH - Product Trace  * 
     C                     EXSR TOCHRC
     C           KRSTN     READE@B2CPT3                  90*
     C                     ENDDO
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TOCHRC    BEGSR
      *================================================================
      * Chg Order Number      CH - Product Trace  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0242  80       PT Label Date Y
     C                     Z-ADD*ZERO     WN0243  80       PT Offset Prod
     C                     Z-ADD*ZERO     WN0244  60       PT Offset Prod
     C                     Z-ADD*ZERO     WN0245  51       PT Net Weight
     C                     Z-ADD*ZERO     WN0246  51       PT Gross Weight
     C                     MOVEL*BLANK    WN0247  1        PT Shift Number
     C                     MOVEL*BLANK    WN0248  3        PT Warehouse ID
     C                     MOVEL*BLANK    WN0249 10        PT Pallet Numbe
     C                     Z-ADD*ZERO     WN0250  70       PT Product Code
     C                     MOVEL*BLANK    WN0251 32        PT Item Label L
     C                     MOVEL*BLANK    WN0252 32        PT Item Label L
     C                     MOVEL*BLANK    WN0253  2        PT Fresh/Frozen
     C                     MOVEL*BLANK    WN0254  9        PT Item Picture
     C                     Z-ADD*ZERO     WN0255  50       PT Tattoo Numbe
     C                     MOVEL*BLANK    WN0256  1        PT Source Type
     C                     MOVEL*BLANK    WN0257  3        PT Source Code
     C                     MOVEL*BLANK    WN0258 25        PT Source Code
     C                     MOVEL*BLANK    WN0259  5        PT Producer/Cel
     C                     MOVEL*BLANK    WN0260 25        PT Producer/Cel
     C                     MOVEL*BLANK    WN0261  7        PT Producer/Far
     C                     MOVEL*BLANK    WN0262  6        PT Producer Loc
     C                     MOVEL*BLANK    WN0263 40        PT Producer/Far
     C                     MOVEL*BLANK    WN0264 40        PT Producer/Far
     C                     MOVEL*BLANK    WN0265  2        PT Producer/Far
     C                     MOVEL*BLANK    WN0266 20        PT Producer/Far
     C                     MOVEL*BLANK    WN0267  5        PT Genetic Code
     C                     MOVEL*BLANK    WN0268 25        PT Genetic Desc
     C                     MOVEL*BLANK    WN0269  1        PT Gender Code
     C                     MOVEL*BLANK    WN0270  7        PT Producer/Far
     C                     MOVEL*BLANK    WN0271  7        PT Producer/Far
     C                     MOVEL*BLANK    WN0272  7        PT Producer/Far
     C                     MOVEL*BLANK    WN0273  7        PT Producer/Far
     C                     MOVEL*BLANK    WN0274  3        PT Item Type Co
     C                     Z-ADD*ZERO     WN0275  30       PT Item Str Cla
     C                     Z-ADD*ZERO     WN0276  30       PT Item Str Gro
     C                     Z-ADD*ZERO     WN0277  30       PT Item Str Typ
     C                     Z-ADD*ZERO     WN0278  80       PT WIP Dump/Pro
     C                     Z-ADD*ZERO     WN0279  60       PT WIP Dump/Pro
     C                     MOVEL*BLANK    WN0280  1        PT WIP Dump/Pro
     C                     MOVEL*BLANK    WN0281  1        PT WIP Used/Not
     C                     Z-ADD*ZERO     WN0282  80       PT From FG Seri
     C                     Z-ADD*ZERO     WN0283  80       PT To FG Serial
     C                     Z-ADD*ZERO     WN0284  80       PT Unused Nbr 3
     C                     Z-ADD*ZERO     WN0285  70       PT Unused Nbr 4
     C                     MOVEL*BLANK    WN0286  1        PT Incl in Prod
     C                     MOVEL*BLANK    WN0287  1        PT Unused Sts 4
     C                     Z-ADD*ZERO     WN0288  60       Job Time
     C                     MOVEL*BLANK    WN0289 10        User Id
     C                     MOVEL*BLANK    WN0290 10        Job Name
     C                     Z-ADD*ZERO     WN0291  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @B2CPMP
     C                     Z-ADDWLAIC3    WSAIC3           Company Number
     C                     Z-ADDWLPFNX    WSPFNX           PT Serial Numbe
     C                     Z-ADDWLAADX    WSAADX           PT Prod Date YY
     C                     Z-ADDWLB9TM    WSB9TM           PT Production T
      *
     C           KLCHTO    KLIST
     C                     KFLD           WSAIC3           Company Number
     C                     KFLD           WSPFNX           PT Serial Numbe
     C                     KFLD           WSAADX           PT Prod Date YY
     C                     KFLD           WSB9TM           PT Production T
     C           KLCHTO    CHAIN@B2CPMP              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POB2CPL0'MDACP
     C                     MOVEL'@B2CPMP' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TOEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TOEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPOB21    YDRDCS
      * Move non-key fields to @B2CPMP
     C                     MOVELWL0231    WSMNSX    P      PT Inventory St
     C                     Z-ADDWL0232    WSPGNX           PT Order Number
      *
      * Set PGM.*Record Data Changed flag
     C           QPOB21    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@B2CPMP                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPOB2CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPRVGN    BEGSR
      *================================================================
      * PFS Del Manifest Dtl  RT - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAIC3    WQTP01           Company Number
     C           *LIKE     DEFN WHC4NB    WQTP02           Order Number
     C           *LIKE     DEFN WHDPNB    WQTP03           Order Sequence
     C           *LIKE     DEFN WHUENB    WQTP04           Order Secondary
     C           *LIKE     DEFN WHPFNX    WQTP05           PT Serial Numbe
     C           *LIKE     DEFN WHK7DT    WQTP06           Label Date
      * Define keylist
     C           KRSTP     KLIST
     C                     KFLD           WQTP01           Company Number
     C                     KFLD           WQTP02           Order Number
     C                     KFLD           WQTP03           Order Sequence
     C                     KFLD           WQTP04           Order Secondary
     C                     KFLD           WQTP05           PT Serial Numbe
     C                     KFLD           WQTP06           Label Date
      * Setup key
     C                     Z-ADDWN0002    WQTP01           Company Number
     C                     Z-ADDWN0056    WQTP02           Order Number
     C                     Z-ADDWN0064    WQTP03           Order Sequence
     C                     Z-ADDWN0065    WQTP04           Order Secondary
     C                     Z-ADDWN0026    WQTP05           PT Serial Numbe
     C                     Z-ADDWN0023    WQTP06           Label Date
      * Establish starting position
     C           KRSTP     SETLL@FNCPAZ                    *
     C           KRSTP     READE@FNCPAZ                  90*
      * Data record not found
     C   90                MOVEL'USR1196' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DLT OM Manifest Detail DL - Manifest Detail  * 
     C                     EXSR TQDLRC
      * CASE: PAR.Lot Tracking Flag is yes
     C           WN0049    IFEQ 'Y'                        *IF
      * PFS Del Order Inv Alc RT - Order Inv Allocation  * 
     C                     EXSR TRRVGN
     C                     END                             *FI
     C           KRSTP     READE@FNCPAZ                  90*
     C                     ENDDO
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQDLRC    BEGSR
      *================================================================
      * DLT OM Manifest Detail DL - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @FNCPCS
     C                     Z-ADDWHAIC3    TEAIC3           Company Number
     C                     Z-ADDWHC4NB    TEC4NB           Order Number
     C                     Z-ADDWHDPNB    TEDPNB           Order Sequence
     C                     Z-ADDWHUENB    TEUENB           Order Secondary
     C                     Z-ADDWHRZNB    TERZNB           Case Sequence N
      *
     C           KLDLTQ    KLIST
     C                     KFLD           TEAIC3           Company Number
     C                     KFLD           TEC4NB           Order Number
     C                     KFLD           TEDPNB           Order Sequence
     C                     KFLD           TEUENB           Order Secondary
     C                     KFLD           TERZNB           Case Sequence N
     C           KLDLTQ    CHAIN@FNCPCS              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFNCPL0'MDACP
     C                     MOVEL'@FNCPCS' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TQEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@FNCPCS                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRRVGN    BEGSR
      *================================================================
      * PFS Del Order Inv Alc RT - Order Inv Allocation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN THAIC3    WQTR01           Company Number
     C           *LIKE     DEFN THC4NB    WQTR02           Order Number
     C           *LIKE     DEFN THDPNB    WQTR03           Order Sequence
     C           *LIKE     DEFN THUENB    WQTR04           Order Secondary
     C           *LIKE     DEFN THHAWG    WQTR05           OIA Serial Numb
      * Define keylist
     C           KRSTR     KLIST
     C                     KFLD           WQTR01           Company Number
     C                     KFLD           WQTR02           Order Number
     C                     KFLD           WQTR03           Order Sequence
     C                     KFLD           WQTR04           Order Secondary
     C                     KFLD           WQTR05           OIA Serial Numb
      * Setup key
     C                     Z-ADDWHAIC3    WQTR01           Company Number
     C                     Z-ADDWHC4NB    WQTR02           Order Number
     C                     Z-ADDWHDPNB    WQTR03           Order Sequence
     C                     Z-ADDWHUENB    WQTR04           Order Secondary
     C                     Z-ADDWN0026    WQTR05           OIA Serial Numb
      * Establish starting position
     C           KRSTR     SETLL@L8CPDK                    *
     C           KRSTR     READE@L8CPDK                  90*
      * Data record not found
     C   90                MOVEL'USR2640' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del Order Inv Alloc   DL - Order Inv Allocation  * 
     C                     EXSR TSDLRC
     C           KRSTR     READE@L8CPDK                  90*
     C                     ENDDO
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         TSDLRC    BEGSR
      *================================================================
      * Del Order Inv Alloc   DL - Order Inv Allocation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @L8CPSX
     C                     Z-ADDTHAIC3    TGAIC3           Company Number
     C                     Z-ADDTHC4NB    TGC4NB           Order Number
     C                     Z-ADDTHDPNB    TGDPNB           Order Sequence
     C                     Z-ADDTHUENB    TGUENB           Order Secondary
     C                     Z-ADDTHALSW    TGALSW           Allocation Seq
      *
     C           KLDLTS    KLIST
     C                     KFLD           TGAIC3           Company Number
     C                     KFLD           TGC4NB           Order Number
     C                     KFLD           TGDPNB           Order Sequence
     C                     KFLD           TGUENB           Order Secondary
     C                     KFLD           TGALSW           Allocation Seq
     C           KLDLTS    CHAIN@L8CPSX              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDL8CPL0'MDACP
     C                     MOVEL'@L8CPSX' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TSEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TSEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@L8CPSX                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         TSEXIT    ENDSR
      /EJECT
     CSR         TTCHRC    BEGSR
      *================================================================
      * Chg PrcSts/ErrRsn     CH - PFS Inventory Adjustment  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0292  3        PFS Transaction
     C                     MOVEL*BLANK    WN0293  2        PFS Inv Adj Rea
     C                     Z-ADD*ZERO     WN0294  70       PFS Item Code
     C                     MOVEL*BLANK    WN0295  3        PFS From Wareho
     C                     Z-ADD*ZERO     WN0296  40       PFS Location Co
     C                     MOVEL*BLANK    WN0297 13        PFS Department
     C                     Z-ADD*ZERO     WN0298  80       PFS Production
     C                     Z-ADD*ZERO     WN0299  80       PFS Label Date
     C                     Z-ADD*ZERO     WN0300  80       PFS Receive Loc
     C                     MOVEL*BLANK    WN0301  1        PFS Shift
     C                     Z-ADD*ZERO     WN0302 100       PFS Serial Numb
     C                     Z-ADD*ZERO     WN0303  10       PFS Tracking Ty
     C                     Z-ADD*ZERO     WN0304  50       PFS Transaction
     C                     Z-ADD*ZERO     WN0305  82       PFS Transaction
     C                     Z-ADD*ZERO     WN0306  82       PFS Transaction
     C                     Z-ADD*ZERO     WN0307  82       PFS Total Tare
     C                     MOVEL*BLANK    WN0308  3        PFS To Warehous
     C                     Z-ADD*ZERO     WN0309  40       PFS To Location
     C                     Z-ADD*ZERO     WN0310  70       PFS Order Numbe
     C                     Z-ADD*ZERO     WN0311  30       PFS Order Line
     C                     Z-ADD*ZERO     WN0312  30       PFS Substitutio
     C                     Z-ADD*ZERO     WN0313  50       PFS Co-Pack Lot
     C                     Z-ADD*ZERO     WN0314  90       PFS Pallet Numb
     C                     MOVEL*BLANK    WN0315  1        PFS Record Stat
     C                     Z-ADD*ZERO     WN0316  80       PFS Create Date
     C                     Z-ADD*ZERO     WN0317  60       PFS Create Time
     C                     Z-ADD*ZERO     WN0318  80       PFS Change Date
     C                     Z-ADD*ZERO     WN0319  60       PFS Change Time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @BGCPZF
     C                     Z-ADDWAY1NX    TIY1NX           PFS Company Num
     C                     Z-ADDWAC0NY    TIC0NY           PFS Inv Adj Seq
     C                     Z-ADDWAAID8    TIAID8           PFS Transaction
     C                     Z-ADDWAAFTS    TIAFTS           PFS Transaction
     C                     Z-ADDWABCNY    TIBCNY           PFS Transaction
      *
     C           KLCHTT    KLIST
     C                     KFLD           TIY1NX           PFS Company Num
     C                     KFLD           TIC0NY           PFS Inv Adj Seq
     C                     KFLD           TIAID8           PFS Transaction
     C                     KFLD           TIAFTS           PFS Transaction
     C                     KFLD           TIBCNY           PFS Transaction
     C           KLCHTT    CHAIN@BGCPZF              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PPBGCPL0'MDACP
     C                     MOVEL'@BGCPZF' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TTEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TTEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPPBG1    YERDCS
      * Move non-key fields to @BGCPZF
     C                     Z-ADDWN0009    TIUXSX           PFS Process Sta
     C                     MOVELWN0010    TIV3SX    P      PFS Error Reaso
      *
      * Set PGM.*Record Data Changed flag
     C           QPPBG1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Change Stamp      IF
     C                     Z-ADD##JDT     TIAJNY           PFS Change Date
     C                     Z-ADD##JTM     TIAKNY           PFS Change Time
      * Set PGM.*Record Data Changed flag
     C           QPPBG1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@BGCPZF                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPPBGCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TTEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** VALIDATION *****
      *================================================================
     C                     Z-ADDWAY1NX    WN0002           Company Number
     C                     Z-ADDWAY2NX    WN0019           Item Code
     C                     MOVELWAU4SX    WN0012           Warehouse Code
      * VAL:  Transaction Type
      * CASE: DB1.PFS Transaction Type is *ALL values
     C           WAVLSX    IFEQ 'P04'                      *IF
     C           WAVLSX    OREQ 'P03'
     C           WAVLSX    OREQ 'P01'
     C           WAVLSX    OREQ 'P02'
     C           WAVLSX    OREQ 'S01'
     C           WAVLSX    OREQ 'S03'
     C           WAVLSX    OREQ 'S02'
     C           WAVLSX    OREQ 'S04'
     C           WAVLSX    OREQ 'S05'
     C           WAVLSX    OREQ 'I01'
     C           WAVLSX    OREQ 'I02'
     C           WAVLSX    OREQ 'F01'
     C           WAVLSX    OREQ 'F02'
     C           WAVLSX    OREQ 'F03'
     C           WAVLSX    OREQ 'F04'
     C           WAVLSX    OREQ 'C01'
     C           WAVLSX    OREQ 'C02'
     C           WAVLSX    OREQ 'C03'
     C           WAVLSX    OREQ 'C04'
     C           WAVLSX    OREQ 'B01'
     C           WAVLSX    OREQ 'R01'
     C           WAVLSX    OREQ 'I03'
     C           WAVLSX    OREQ 'I04'
     C           WAVLSX    OREQ 'W01'
     C           WAVLSX    OREQ 'P05'
     C           WAVLSX    OREQ 'S06'
     C           WAVLSX    OREQ 'S07'
      * UPL: Freezer Transactions
      * CASE: DB1.PFS Transaction Type is Freezer Transactions
     C           WAVLSX    IFEQ 'F03'                      *IF
     C           WAVLSX    OREQ 'F01'
     C           WAVLSX    OREQ 'F04'
     C           WAVLSX    OREQ 'F02'
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAY1NX    WL0001           PFS Company Num
     C                     MOVEL'FRZTRN'  WL0002    P      PFS Interface C
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0001    P      PFS AccuSort Ac
     C                     MOVELWL0004    YL0002    P      PFS Carlisle Ac
      * CASE: LCL.PFS Carlisle Active is No
     C           YL0002    IFEQ 'N'                        *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'INACTV'  WN0010           PFS Error Reaso
     C                     END                             *FI
      * CASE: 960 Duplicate F01-Freezer Putaway
      *  - c1 AND c2 AND c3 AND c4
      *   |- c1    : DB1.PFS Company Number is St. Joseph
      *   |- c2    : DB1.PFS Location Code is GT 3
      *   |- c3    : DB1.PFS Pallet Number is Entered
      *   |- c4    : DB1.PFS Transaction Type is FM: Freezer Putaway
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAY1NX    IFEQ 960                        *IF
     C           WAADNY    IFGT 3                          *IF
     C           WAAGNY    IFNE 0                          *IF
     C           WAVLSX    IFEQ 'F01'                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'DUPPUT'  WN0010           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
      * UPL: Inventory Transactions (Insight)
      * CASE: DB1.PFS Transaction Type is Inventory Transactions
     C           WAVLSX    IFEQ 'I01'                      *IF
     C           WAVLSX    OREQ 'I02'
     C           WAVLSX    OREQ 'I04'
     C           WAVLSX    OREQ 'I03'
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAY1NX    WL0001           PFS Company Num
     C                     MOVEL'INVTRN'  WL0002    P      PFS Interface C
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0001    P      PFS AccuSort Ac
     C                     MOVELWL0004    YL0002    P      PFS Carlisle Ac
      * CASE: LCL.PFS Carlisle Active is No
     C           YL0002    IFEQ 'N'                        *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'INACTV'  WN0010           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
      * UPL: Production Transactions (Informer)
      * CASE: DB1.PFS Transaction Type is Production Transactions
     C           WAVLSX    IFEQ 'P04'                      *IF
     C           WAVLSX    OREQ 'P02'
     C           WAVLSX    OREQ 'P01'
     C           WAVLSX    OREQ 'P03'
     C           WAVLSX    OREQ 'P05'
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAY1NX    WL0001           PFS Company Num
     C                     MOVEL'PRDTRN'  WL0002    P      PFS Interface C
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0001    P      PFS AccuSort Ac
     C                     MOVELWL0004    YL0002    P      PFS Carlisle Ac
      * CASE: LCL.PFS Carlisle Active is No
     C           YL0002    IFEQ 'N'                        *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'INACTV'  WN0010           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
      * UPL: Shipping Transactions
      * CASE: DB1.PFS Transaction Type is Shipping Transactions
     C           WAVLSX    IFEQ 'S01'                      *IF
     C           WAVLSX    OREQ 'S02'
     C           WAVLSX    OREQ 'S03'
     C           WAVLSX    OREQ 'S05'
     C           WAVLSX    OREQ 'S04'
     C           WAVLSX    OREQ 'S07'
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAY1NX    WL0001           PFS Company Num
     C                     MOVEL'SHPTRN'  WL0002    P      PFS Interface C
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0001    P      PFS AccuSort Ac
     C                     MOVELWL0004    YL0002    P      PFS Carlisle Ac
      * CASE: LCL.PFS Carlisle Active is No
     C           YL0002    IFEQ 'N'                        *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'INACTV'  WN0010           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
      * UPL: Batch Label Printing
      * CASE: DB1.PFS Transaction Type is Batch Printing
     C           WAVLSX    IFEQ 'B01'                      *IF
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAY1NX    WL0001           PFS Company Num
     C                     MOVEL'BTCPRT'  WL0002    P      PFS Interface C
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0001    P      PFS AccuSort Ac
     C                     MOVELWL0004    YL0002    P      PFS Carlisle Ac
      * CASE: LCL.PFS Carlisle Active is No
     C           YL0002    IFEQ 'N'                        *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'INACTV'  WN0010           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
      * UPL: Cycle Count
      * CASE: DB1.PFS Transaction Type is Cycle Count Transactions
     C           WAVLSX    IFEQ 'C02'                      *IF
     C           WAVLSX    OREQ 'C04'
     C           WAVLSX    OREQ 'C01'
     C           WAVLSX    OREQ 'C03'
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAY1NX    WL0001           PFS Company Num
     C                     MOVEL'CYCTRN'  WL0002    P      PFS Interface C
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0001    P      PFS AccuSort Ac
     C                     MOVELWL0004    YL0002    P      PFS Carlisle Ac
      * CASE: LCL.PFS Carlisle Active is No
     C           YL0002    IFEQ 'N'                        *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'INACTV'  WN0010           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
      * UPL: Warehouse Transfer
      * CASE: DB1.PFS Transaction Type is Warehouse Transfer
     C           WAVLSX    IFEQ 'W01'                      *IF
     C           WAVLSX    OREQ 'S06'
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAY1NX    WL0001           PFS Company Num
     C                     MOVEL'WHSTFR'  WL0002    P      PFS Interface C
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0001    P      PFS AccuSort Ac
     C                     MOVELWL0004    YL0002    P      PFS Carlisle Ac
      * CASE: LCL.PFS Carlisle Active is No
     C           YL0002    IFEQ 'N'                        *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'INACTV'  WN0010           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'TRNTYP'  WN0010           PFS Error Reaso
     C                     END                             *FI
      * VAL:  Production Transaction Tracking Type
      * CASE: DB1.PFS Transaction Type is Production Transactions
     C           WAVLSX    IFEQ 'P04'                      *IF
     C           WAVLSX    OREQ 'P02'
     C           WAVLSX    OREQ 'P01'
     C           WAVLSX    OREQ 'P03'
     C           WAVLSX    OREQ 'P05'
      * CASE: DB1.PFS Tracking Type is Entered
     C           WAZ6NX    IFNE 0                          *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'TRKTYP'  WN0010           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
      * Test Label
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.PFS Tracking Type is Test Label
      *   |- c2    : DB1.PFS Item Code is 2221 - 2223
      *   '-
     C           WAZ6NX    IFEQ 5                          *IF
     C           WAY2NX    ORGE 2221                       *OR
     C           WAY2NX    ANDLE2223
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'TSTLBL'  WN0010           PFS Error Reaso
     C                     END                             *FI
      * Val WHS/Rtv ActCo PFS RT - Warehouse  * 
     C                     EXSR SCRVGN
      * Warehouse Not Found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'WHSCDE'  WN0010           PFS Error Reaso
     C                     END                             *FI
      * Location Code & Receive/Located Date
      * CASE: PAR.Lot Tracking Flag is yes
     C           WN0049    IFEQ 'Y'                        *IF
      * CASE: DB1.PFS Transaction Type is BP: Batch Label Print
     C           WAVLSX    IFEQ 'B01'                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
     C                     END                             *FI
      * Val Itm/Whs,FG/WP PFS RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0005           Company Number
     C                     Z-ADDWN0019    WL0006           Item Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    WN0001    P      Production Date
     C                     Z-ADDWL0008    YN0001           Item Structure
     C                     MOVELWL0009    WN0003    P      Item Type Code
     C                     MOVELWL0010    WN0005    P      Default Warehou
     C                     Z-ADDWL0011    WN0004           Fresh Chilling
     C                     MOVELWL0012    WN0008    P      Primal Group Co
      * Item Code Not Found
      * CASE:
      *  - (c1 AND c3) OR c2
      *   |- c1    : PGM.*Return code is *Record does not exist
      *   |- c3    : DB1.PFS Transaction Type is Production Transactions
      *   |- c2    : PAR.Primal Group Code is Scale Check
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ @CN,001                    *IF
     C           WAVLSX    IFEQ 'P04'                      *IF
     C           WAVLSX    OREQ 'P02'
     C           WAVLSX    OREQ 'P01'
     C           WAVLSX    OREQ 'P03'
     C           WAVLSX    OREQ 'P05'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WN0008    IFEQ 'SCALE'                    *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'ITMCDE'  WN0010           PFS Error Reaso
     C                     ELSE
      * CASE: *OTHERWISE
      * VAL:  WIP Item Code
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Item Type Code is Finished Goods
      *   |- c2    : DB1.PFS Tracking Type is Work In Process
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0003    IFEQ 'FG'                       *IF
     C           WAZ6NX    IFEQ 3                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           WAY2NX    ADD  9000000   WN0019           Item Code
      * Val Itm/Whs,FG/WP PFS RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0005           Company Number
     C                     Z-ADDWN0019    WL0006           Item Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    WN0001    P      Production Date
     C                     Z-ADDWL0008    YN0001           Item Structure
     C                     MOVELWL0009    WN0003    P      Item Type Code
     C                     MOVELWL0010    WN0005    P      Default Warehou
     C                     Z-ADDWL0011    WN0004           Fresh Chilling
     C                     MOVELWL0012    WN0008    P      Primal Group Co
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'WIPCDE'  WN0010           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * RTV Unit Cost Active   RT - Item Balance  * 
     C                     EXSR SERVGN
      * Record not found instead of unit cost check  5.4.6 RMC PFS011
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'ITMBAL'  WN0010           PFS Error Reaso
     C                     END                             *FI
      * Shift Not Entered
      * CASE: DB1.PFS Shift is Not Entered
     C           WAVKSX    IFEQ *BLANK                     *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL*BLANK    WN0010           PFS Error Reaso
     C                     MOVEL'SHIFT'   WN0010           PFS Error Reaso
     C                     END                             *FI
      * 09/08/09 PKD E00475 Not using Production Date.  Label Date will
      *              be used as the Production Date.
      * Label Date Not Entered
      * CASE: PAR.Production Date Control is yes
     C           WN0001    IFEQ 'Y'                        *IF
      * CASE: DB1.PFS Transaction Type is Freezer Transactions
     C           WAVLSX    IFEQ 'F03'                      *IF
     C           WAVLSX    OREQ 'F01'
     C           WAVLSX    OREQ 'F04'
     C           WAVLSX    OREQ 'F02'
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.PFS Label Date is Not Entered
     C           WAZ4NX    IFEQ 0                          *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'LBLDTE'  WN0010           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 09/08/09 PKD E00475 Use Label Date for Production Date.
      * Production & Label Date
      * CASE: PAR.Production Date Control is yes
     C           WN0001    IFEQ 'Y'                        *IF
      * --- Production Date ---
      * Convert Production Date
      * CASE: DB1.PFS Production Date is Entered
     C           WAP7DT    IFNE 0                          *IF
      * 04/02/09 PKD Use IF instead of CL to convert date.
      *
     C                     Z-ADD*ZERO     WN0068  40       Year Code
     C                     Z-ADD*ZERO     WN0069  20       Month
     C                     Z-ADD*ZERO     WN0070  20       Day of Month US
     C                     MOVEL*BLANK    WN0071  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0072  2        Month (Char) US
     C                     MOVEL*BLANK    WN0073  2        Day   (Char) US
     C                     Z-ADD*ZERO     WN0074  20       Year  NBR USR
     C                     MOVEL*BLANK    WN0075  2        Year  (Char) US
     C                     MOVEL*BLANK    WN0076  7        Date (Alpha) US
      *
      * CVT *YYMD to *CYMD    IF
      * ** YEAR **
     C           WAP7DT    DIV  10000     WN0068           Year Code
     C                     Z-ADDWN0068    WN0074           Year  NBR USR
     C                     MOVELWN0074    WN0075           Year  (Char) US
      * ** MONTH **
     C           WAP7DT    DIV  100       WN0069           Month
     C                     MOVELWN0069    WN0072           Month (Char) US
      * ** DAY **
     C                     Z-ADDWAP7DT    WN0070           Day of Month US
     C                     MOVELWN0070    WN0073           Day   (Char) US
      * CENTURY+YEAR
      * CASE: PAR.Year Code is Twentieth Century
     C           WN0068    IFLE 1999                       *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           '0'       CAT  WN0075:ZQ WN0076    P      Date (Alpha) US
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           '1'       CAT  WN0075:ZQ WN0076    P      Date (Alpha) US
     C                     END                             *FI
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0076    CAT  WN0072:ZQ WN0076    P      Date (Alpha) US
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0076    CAT  WN0073:ZQ WN0076    P      Date (Alpha) US
     C                     MOVE WN0076    WN0020           Date
     C                     END                             *FI
      * --- Label Date ---
      * 04/02/09 PKD Use IF instead of CL to convert date.
      *
     C                     Z-ADD*ZERO     WN0077  40       Year Code
     C                     Z-ADD*ZERO     WN0078  20       Month
     C                     Z-ADD*ZERO     WN0079  20       Day of Month US
     C                     MOVEL*BLANK    WN0080  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0081  2        Month (Char) US
     C                     MOVEL*BLANK    WN0082  2        Day   (Char) US
     C                     Z-ADD*ZERO     WN0083  20       Year  NBR USR
     C                     MOVEL*BLANK    WN0084  2        Year  (Char) US
     C                     MOVEL*BLANK    WN0085  7        Date (Alpha) US
      *
      * CVT *YYMD to *CYMD    IF
      * ** YEAR **
     C           WAZ4NX    DIV  10000     WN0077           Year Code
     C                     Z-ADDWN0077    WN0083           Year  NBR USR
     C                     MOVELWN0083    WN0084           Year  (Char) US
      * ** MONTH **
     C           WAZ4NX    DIV  100       WN0078           Month
     C                     MOVELWN0078    WN0081           Month (Char) US
      * ** DAY **
     C                     Z-ADDWAZ4NX    WN0079           Day of Month US
     C                     MOVELWN0079    WN0082           Day   (Char) US
      * CENTURY+YEAR
      * CASE: PAR.Year Code is Twentieth Century
     C           WN0077    IFLE 1999                       *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           '0'       CAT  WN0084:ZQ WN0085    P      Date (Alpha) US
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           '1'       CAT  WN0084:ZQ WN0085    P      Date (Alpha) US
     C                     END                             *FI
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0085    CAT  WN0081:ZQ WN0085    P      Date (Alpha) US
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0085    CAT  WN0082:ZQ WN0085    P      Date (Alpha) US
     C                     MOVE WN0085    WN0023           Date
      * INIT: Production Date Not Entered
      * CASE: DB1.PFS Production Date is Not Entered
     C           WAP7DT    IFEQ 0                          *IF
     C                     Z-ADDWN0023    WN0020           Production Date
     C                     END                             *FI
      * INIT: Label Date Not Entered
      * CASE: DB1.PFS Label Date is Not Entered
     C           WAZ4NX    IFEQ 0                          *IF
     C                     Z-ADDWN0020    WN0023           Label Date
     C                     END                             *FI
      * 09/08/09 PKD E00475 Use Label Date for Production Date.
     C                     Z-ADDWN0023    WN0020           Production Date
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0020           Production Date
     C                     Z-ADD*ZERO     WN0023           Label Date
     C                     END                             *FI
      * VAL:  SM: Ship Regular Order, Ship Transfer Order, Unship
      * CASE: Order Shipping
      *  - c1 OR c2 OR c3
      *   |- c1    : DB1.PFS Transaction Type is SM: Ship Regular Order
      *   |- c2    : DB1.PFS Transaction Type is SM: Transfer Order
      *   |- c3    : DB1.PFS Transaction Type is SM: UnShip Reg/Tfr Ord
      *   '-
     C           WAVLSX    IFEQ 'S01'                      *IF
     C           WAVLSX    OREQ 'S02'                      *OR
     C           WAVLSX    OREQ 'S03'                      *OR
     C                     Z-ADDWAZPNX    WN0056           Order Number
      * RTV Order Info PFS    RT - Order Header TRG  * 
     C                     EXSR SFRVGN
      * VAL:  item type must be FG for shipping trans      RMC 2/25/08
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Item Type Code is Finished Good
      *   |- c2    : DB1.PFS Tracking Type is Finished Goods
      *   '-
     C           WN0003    IFEQ 'FG'                       *IF
     C           WAZ6NX    OREQ 1                          *OR
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.PFS Error Reason is No Error
     C           WN0010    IFEQ *BLANK                     *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'WIPCDE'  WN0010           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
      * VAL:  Order Number
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'ORDNUM'  WN0010           PFS Error Reaso
     C                     END                             *FI
      * ***  Performing no validation of Order Status at this time.
      *      The Shipping Upload will confirm the total are the same
      *      between Manifest Detail and PFS Ship Order Detail.
      * Get 1st not cancelled line item's whse    3/30/06 RMC
      * RTV Whse/DLS/Item     RT - Order Detail  * 
     C                     EXSR SGRVGN
      * RMC 11/8/17 this chk doesnt work with that rtv. so commenting it!
      * VAL:  Warehouse
      * CASE: LCL.Warehouse Code NE DB1.PFS Warehouse Code
     C           YL0004    IFNE WAU4SX                     *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'ORDWHS'  WN0010           PFS Error Reaso
      * CASE: PAR.Warehouse Code is Warehouse Code Blank
     C           WN0012    IFEQ *BLANK                     *IF
      * PFS Val Dup Serial#   RT - Manifest Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0013           Company Number
     C                     Z-ADDWN0056    WL0014           Order Number
     C                     Z-ADDWN0064    WL0015           Order Sequence
     C                     Z-ADDWN0065    WL0016           Order Secondary
     C                     Z-ADDWAZ2NX    WL0017           PT Serial Numbe
     C                     Z-ADDWN0023    WL0018           Label Date
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0019    YL0006    P      Record Found US
      * DUPLICATE CASE FOUND
      * CASE: LCL.Record Found USR is Record Found
     C           YL0006    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           WN0056    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVELWN0056    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0001           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0001           CD7 Ext Numeric
     C                     END                             *FI
     C                     Z-ADDWAZ2NX    ZA0002           PFS Serial Numb
      * Retrieve message PFS Dup Case Manifested
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3596' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0007    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * RTV Alpha Value        RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0020           Company Number
     C                     MOVEL@CN,002   WL0021    P      Company Value C
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0022    YL0008    P      System Value Al
      * SND Pager Msg (MPLUS) UP - /UT User Programs  * 
     C                     CALL 'POMSUPC'              90  SND Pager Msg (
     C                     PARM YL0008    WQ0001 10        DL List ID
     C                     PARM YL0007    WQ0002132        Office Message
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMSUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * If not duplicate, then move Order's Warehouse for processing
     C                     MOVELYL0004    WN0012           Warehouse Code
     C                     Z-ADD*ZERO     WN0009           PFS Process Sta
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * VAL:  SM: Transfer Order - Transfer To Warehouse
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.PFS Transaction Type is SM: Transfer Order
      *   |- c2    : PAR.Order Type - Sales is Transfer Order
      *   '-
     C           WAVLSX    IFEQ 'S02'                      *IF
     C           WN0058    OREQ 'TR'                       *OR
      * CASE: DB1.PFS To Warehouse Code is Not Entered
     C           WAGBAA    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Val Warehouse PFS     RT - Warehouse  * 
     C                     EXSR SJRVGN
      * Warehouse Not Found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'TFRWHS'  WN0010           PFS Error Reaso
     C                     END                             *FI
      * Location Code
      * CASE: LCL.Lot Tracking Flag is yes
     C           YL0009    IFEQ 'Y'                        *IF
      * Location Code
      * CASE: DB1.PFS To Location Code is Not Entered
     C           WAANNY    IFEQ 0                          *IF
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * VAL:  Warehouse Transfer To Warehouse
      * CASE: DB1.PFS Transaction Type is WT: Warehouse Transfer
     C           WAVLSX    IFEQ 'W01'                      *IF
      * CASE: DB1.PFS To Warehouse Code is Not Entered
     C           WAGBAA    IFEQ *BLANK                     *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'TFRWHS'  WN0010           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
      * RMC E00475 dont error this out. in some instances we get the S01
      * 8/13/09    but still want to add the prod to inventory
      * VAL:  Production P02 Issue- duplicate case   new RMC 4/13/06
      * CASE: DB1.PFS Transaction Type is PM: Issue
     C           WAVLSX    IFEQ 'P02'                      *IF
      * Val DupCase for Issue RT - PFS Inventory Adjustment  * 
     C                     EXSR SKRVGN
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ @CN,003                    *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'DUPCSE'  WN0010           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
      * VAL:  ACTIVE TRANSACTION TYPES
     C                     EXSR UBSUBR                     VAL:  ACTIVE TR
      * 10/20/06 PKD Changed to use WHS PFS Interface
      * Rtv Live w/CT LD/ORD  RT - Warehouse  * 
     C                     EXSR SLRVGN
      * VAL:  ACTIVE WAREHOUSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.WHS Live w/Carlisle is Yes
      *   |- c2    : PAR.Warehouse Code is Warehouse Code not Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0010    IFEQ 'Y'                        *IF
     C           WN0012    IFNE *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 10/20/06 PKD added the following condition
      * CASE: LCL.WHS PFS Interface is Upload/Both
     C           YL0011    IFEQ 'U'                        *IF
     C           YL0011    OREQ 'B'
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'INACTV'  WN0010           PFS Error Reaso
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'INACTV'  WN0010           PFS Error Reaso
     C                     END                             *FI
      * 11/04/08 PKD They are sending up zero for warehouse
      * VAL: Warehouse Code
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.PFS Warehouse Code is Not Entered
      *   |- c2    : DB1.PFS Warehouse Code is Not Valid
      *   '-
     C           WAU4SX    IFEQ *BLANK                     *IF
     C           WAU4SX    OREQ '0'                        *OR
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'WHSCDE'  WN0010           PFS Error Reaso
     C                     END                             *FI
      * ERROR:  DO NOT SELECT RECORD
      * CASE: PAR.PFS Process Status is Error
     C           WN0009    IFEQ 2                          *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
      * Non Ship Transactions --- Excluded in the Logical 01/03/13
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.PFS Inv Adj Prc Ship USR is Process Not Ship Tra
      *   |- c2    : DB1.PFS Transaction Type is Shipping Non Return Tran
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1XASX    IFEQ *BLANK                     *IF
     C           WAVLSX    IFEQ 'S01'                      *IF
     C           WAVLSX    OREQ 'S02'
     C           WAVLSX    OREQ 'S03'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Ship Transactions
      * CASE: PAR.PFS Inv Adj Prc Ship USR is Process Ship Trans
     C           P1XASX    IFEQ 'S'                        *IF
      * CASE: DB1.PFS Transaction Type is Not Shipping Trans
     C           WAVLSX    IFEQ 'B01'                      *IF
     C           WAVLSX    OREQ 'C02'
     C           WAVLSX    OREQ 'C04'
     C           WAVLSX    OREQ 'C01'
     C           WAVLSX    OREQ 'C03'
     C           WAVLSX    OREQ 'F03'
     C           WAVLSX    OREQ 'F01'
     C           WAVLSX    OREQ 'F04'
     C           WAVLSX    OREQ 'F02'
     C           WAVLSX    OREQ 'I01'
     C           WAVLSX    OREQ 'I02'
     C           WAVLSX    OREQ 'R01'
     C           WAVLSX    OREQ 'P04'
     C           WAVLSX    OREQ 'P02'
     C           WAVLSX    OREQ 'P01'
     C           WAVLSX    OREQ 'P03'
     C           WAVLSX    OREQ 'I04'
     C           WAVLSX    OREQ 'I03'
     C           WAVLSX    OREQ 'P05'
     C           WAVLSX    OREQ 'S04'
     C           WAVLSX    OREQ 'S07'
     C           WAVLSX    OREQ 'S05'
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.PFS Order Number NE PAR.PFS Order Number
     C           WAZPNX    IFNE P2ZPNX                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * OMT: F02, C03
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.PFS Transaction Type is FM: Freezer ReLocate
      *   |- c2    : DB1.PFS Transaction Type is CC: Move to Current Loc
      *   '-
     C           WAVLSX    IFEQ 'F02'                      *IF
     C           WAVLSX    OREQ 'C03'                      *OR
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * OMT: F03 QA Hold or F04 QA Hold
      * CASE:
      *  - (c1 AND c2) OR (c3 AND c4)
      *   |- c1    : DB1.PFS Transaction Type is FM: Freezer Hold
      *   |- c2    : DB1.PFS Inv Adj Reason Code is Q1 QA HOLD (Chill-tim
      *   |- c3    : DB1.PFS Transaction Type is FM: Freezer Release Hold
      *   |- c4    : DB1.PFS Inv Adj Reason Code is Q1 QA HOLD (Chill-tim
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAVLSX    IFEQ 'F03'                      *IF
     C           WAVMSX    IFEQ '6'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WAVLSX    IFEQ 'F04'                      *IF
     C           WAVMSX    IFEQ '6'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * OMT: Restoration In Progress (08/13/09 PKD E00475)(7/16/14 RMC ch
      * CASE: JOB.*Job time is Between 2:30am & 4:00am
     C           ##JTM     IFGE 023000                     *IF
     C           ##JTM     ANDLE040000
      * Exc Rtv Restore Sts   XF - PFS Inventory Restoration  * 
     C                     CALL 'PBRLXFR'              90  Exc Rtv Restore
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAY1NX    WQ0003  30       PFS Company Num
     C                     PARM WAAID8    WQ0004  80       PFS Transaction
     C                     PARM WAU4SX    WQ0005  3        PFS From Wareho
     C           YL0012    PARM *BLANK    WQ0006  1        In Progress Sts
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBRLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.In Progress Sts USR is yes
     C           YL0012    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
      * ERROR: Inventory Transactions Only
      * CASE: DB1.PFS Transaction Type is Ship/Unship Order
     C           WAVLSX    IFEQ 'S01'                      *IF
     C           WAVLSX    OREQ 'S02'
     C           WAVLSX    OREQ 'S03'
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WN0010           PFS Error Reaso
     C                     MOVEL'RSTIP'   WN0010           PFS Error Reaso
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Exc Restoration Sts   RT - Physical Count Control  * 
     C                     CALL 'PBRMXFR'              90  Exc Restoration
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0002    WQ0007  30       Company Number
     C                     PARM WN0012    WQ0008  3        Warehouse Code
     C           YL0012    PARM *BLANK    WQ0009  1        In Progress Sts
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBRMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.In Progress Sts USR is yes
     C           YL0012    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
      * ERROR: Inventory Transactions Only
      * CASE: DB1.PFS Transaction Type is Ship/Unship Order
     C           WAVLSX    IFEQ 'S01'                      *IF
     C           WAVLSX    OREQ 'S02'
     C           WAVLSX    OREQ 'S03'
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WN0010           PFS Error Reaso
     C                     MOVEL'RSTIP'   WN0010           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * VAL:  ACTIVE TRANSACTION TYPES
      *================================================================
      * UPL: Freezer Transactions
      * CASE: DB1.PFS Transaction Type is Freezer Transactions
     C           WAVLSX    IFEQ 'F03'                      *IF
     C           WAVLSX    OREQ 'F01'
     C           WAVLSX    OREQ 'F04'
     C           WAVLSX    OREQ 'F02'
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAY1NX    WL0001           PFS Company Num
     C                     MOVEL'FRZTRN'  WL0002    P      PFS Interface C
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0001    P      PFS AccuSort Ac
     C                     MOVELWL0004    YL0002    P      PFS Carlisle Ac
      * CASE: LCL.PFS Carlisle Active is No
     C           YL0002    IFEQ 'N'                        *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'INACTV'  WN0010           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
      * UPL: Inventory Transactions (Insight)
      * CASE: DB1.PFS Transaction Type is Inventory Transactions
     C           WAVLSX    IFEQ 'I01'                      *IF
     C           WAVLSX    OREQ 'I02'
     C           WAVLSX    OREQ 'I04'
     C           WAVLSX    OREQ 'I03'
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAY1NX    WL0001           PFS Company Num
     C                     MOVEL'INVTRN'  WL0002    P      PFS Interface C
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0001    P      PFS AccuSort Ac
     C                     MOVELWL0004    YL0002    P      PFS Carlisle Ac
      * CASE: LCL.PFS Carlisle Active is No
     C           YL0002    IFEQ 'N'                        *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'INACTV'  WN0010           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
      * UPL: Production Transactions (Informer)
      * CASE: DB1.PFS Transaction Type is Production Transactions
     C           WAVLSX    IFEQ 'P04'                      *IF
     C           WAVLSX    OREQ 'P02'
     C           WAVLSX    OREQ 'P01'
     C           WAVLSX    OREQ 'P03'
     C           WAVLSX    OREQ 'P05'
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAY1NX    WL0001           PFS Company Num
     C                     MOVEL'PRDTRN'  WL0002    P      PFS Interface C
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0001    P      PFS AccuSort Ac
     C                     MOVELWL0004    YL0002    P      PFS Carlisle Ac
      * CASE: LCL.PFS Carlisle Active is No
     C           YL0002    IFEQ 'N'                        *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'INACTV'  WN0010           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
      * UPL: Shipping Transactions
      * CASE: DB1.PFS Transaction Type is Shipping Transactions
     C           WAVLSX    IFEQ 'S01'                      *IF
     C           WAVLSX    OREQ 'S02'
     C           WAVLSX    OREQ 'S03'
     C           WAVLSX    OREQ 'S05'
     C           WAVLSX    OREQ 'S04'
     C           WAVLSX    OREQ 'S07'
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAY1NX    WL0001           PFS Company Num
     C                     MOVEL'SHPTRN'  WL0002    P      PFS Interface C
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0001    P      PFS AccuSort Ac
     C                     MOVELWL0004    YL0002    P      PFS Carlisle Ac
      * CASE: LCL.PFS Carlisle Active is No
     C           YL0002    IFEQ 'N'                        *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'INACTV'  WN0010           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
      * UPL: Batch Label Printing
      * CASE: DB1.PFS Transaction Type is Batch Printing
     C           WAVLSX    IFEQ 'B01'                      *IF
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAY1NX    WL0001           PFS Company Num
     C                     MOVEL'BTCPRT'  WL0002    P      PFS Interface C
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0001    P      PFS AccuSort Ac
     C                     MOVELWL0004    YL0002    P      PFS Carlisle Ac
      * CASE: LCL.PFS Carlisle Active is No
     C           YL0002    IFEQ 'N'                        *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'INACTV'  WN0010           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
      * UPL: Cycle Count
      * CASE: DB1.PFS Transaction Type is Cycle Count Transactions
     C           WAVLSX    IFEQ 'C02'                      *IF
     C           WAVLSX    OREQ 'C04'
     C           WAVLSX    OREQ 'C01'
     C           WAVLSX    OREQ 'C03'
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAY1NX    WL0001           PFS Company Num
     C                     MOVEL'CYCTRN'  WL0002    P      PFS Interface C
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0001    P      PFS AccuSort Ac
     C                     MOVELWL0004    YL0002    P      PFS Carlisle Ac
      * CASE: LCL.PFS Carlisle Active is No
     C           YL0002    IFEQ 'N'                        *IF
     C                     Z-ADD2         WN0009           PFS Process Sta
     C                     MOVEL'INACTV'  WN0010           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Initialize
      *================================================================
     C                     Z-ADDWN0019    WN0024           Partial Item Co
      * --- Transaction Date ---
     C                     Z-ADD##JDT     WN0017           Transaction Dat
      * ------------------------
     C                     MOVELWAVKSX    WN0022           Shift Number
     C                     Z-ADDWABDNY    WN0015           Transaction Qua
     C                     Z-ADDWAABNY    WN0016           Transaction Wei
      * LOT TRACKING WAREHOUES
      * CASE: PAR.Lot Tracking Flag is yes
     C           WN0049    IFEQ 'Y'                        *IF
      * ----- Location Code -----
      * 01/09/09 PKD Use Default Location of 7777 for all Freezer Invento
     C                     MOVEL'7777'    WN0051           Location Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANKS   WN0051           Location Code
     C                     END                             *FI
      * Ship/Unship Order
      * CASE: DB1.PFS Transaction Type is Ship/Unship Order
     C           WAVLSX    IFEQ 'S01'                      *IF
     C           WAVLSX    OREQ 'S02'
     C           WAVLSX    OREQ 'S03'
     C                     Z-ADDWAZPNX    WN0056           Order Number
     C                     Z-ADDWAZXNX    WN0064           Order Sequence
     C                     Z-ADD1         WN0065           Order Secondary
     C                     END                             *FI
      * ------------------------
     C                     MOVEL*BLANK    WN0018           Reason Code
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XTAD1     BEGSR
      *================================================================
      * Add TME to absolute time (seconds)
      *================================================================
     C           XTHH      MULT 3600      XDWK1   80
     C                     ADD  XDWK1     XASC
     C           XTNN      MULT 60        XDWK1
     C                     ADD  XDWK1     XASC
     C                     ADD  XTSS      XASC
      *================================================================
     CSR         XTAD1E    ENDSR
      /EJECT
     CSR         XTCT1     BEGSR
      *================================================================
      * Convert absolute time (seconds) to TME
      *================================================================
     C                     EXSR XTFCT
     C           XASC      DIV  60        XASC
     C                     MVR            XTSS
     C           XASC      DIV  60        XASC
     C                     MVR            XTNN
     C                     Z-ADDXASC      XTHH
      *================================================================
     CSR         XTCT1E    ENDSR
      /EJECT
     CSR         XTFCT     BEGSR
      *================================================================
      * Factorize absolute date (seconds) by 24 hours
      *================================================================
     C           XASC      IFGE 86400
     C                     DIV  86400     XASC    80
     C                     MVR            XASC
     C                     ELSE
     C           XASC      IFLE *ZERO
     C                     DIV  86400     XASC
     C                     MVR            XASC
     C           XASC      IFNE *ZERO
     C                     ADD  86400     XASC
     C                     END
     C                     END
     C                     END
      *================================================================
     CSR         XTFCTE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAY1NX           PFS Company Num
     C                     Z-ADD*ZERO     WAC0NY           PFS Inv Adj Seq
     C                     Z-ADD*ZERO     WAAID8           PFS Transaction
     C                     Z-ADD*ZERO     WAAFTS           PFS Transaction
     C                     Z-ADD*ZERO     WABCNY           PFS Transaction
     C                     Z-ADD*ZERO     WAY2NX           PFS Item Code
     C                     Z-ADD*ZERO     WAADNY           PFS Location Co
     C                     Z-ADD*ZERO     WAP7DT           PFS Production
     C                     Z-ADD*ZERO     WAZ4NX           PFS Label Date
     C                     Z-ADD*ZERO     WAACNY           PFS Receive Loc
     C                     Z-ADD*ZERO     WAZ2NX           PFS Serial Numb
     C                     Z-ADD*ZERO     WAZ6NX           PFS Tracking Ty
     C                     Z-ADD*ZERO     WABDNY           PFS Transaction
     C                     Z-ADD*ZERO     WAABNY           PFS Transaction
     C                     Z-ADD*ZERO     WABENY           PFS Transaction
     C                     Z-ADD*ZERO     WAZ9NX           PFS Total Tare
     C                     Z-ADD*ZERO     WAANNY           PFS To Location
     C                     Z-ADD*ZERO     WAZPNX           PFS Order Numbe
     C                     Z-ADD*ZERO     WAZXNX           PFS Order Line
     C                     Z-ADD*ZERO     WAZYNX           PFS Substitutio
     C                     Z-ADD*ZERO     WAALNY           PFS Co-Pack Lot
     C                     Z-ADD*ZERO     WAAGNY           PFS Pallet Numb
     C                     Z-ADD*ZERO     WAUXSX           PFS Process Sta
     C                     Z-ADD*ZERO     WAAHNY           PFS Create Date
     C                     Z-ADD*ZERO     WAAINY           PFS Create Time
     C                     Z-ADD*ZERO     WAAJNY           PFS Change Date
     C                     Z-ADD*ZERO     WAAKNY           PFS Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBY1NX           PFS Company Num
     C                     Z-ADD*ZERO     WBQEDT           PFS Last Update
     C                     Z-ADD*ZERO     WBCUTM           PFS Last Update
     C                     Z-ADD*ZERO     WBB0NY           PFS Hours Betwe
     C                     Z-ADD*ZERO     WBB1NY           PFS Minutes Btw
     C                     Z-ADD*ZERO     WBUXSX           PFS Process Sta
     C                     Z-ADD*ZERO     WBAHNY           PFS Create Date
     C                     Z-ADD*ZERO     WBAINY           PFS Create Time
     C                     Z-ADD*ZERO     WBAJNY           PFS Change Date
     C                     Z-ADD*ZERO     WBAKNY           PFS Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WCBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WCBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WCBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WCBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WDAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WDAIWG           Unit Weight
     C                     Z-ADD*ZERO     WDCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WDC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WDURTN           Number Cases On
     C                     Z-ADD*ZERO     WDAJC8           Vendor Item Def
     C                     Z-ADD*ZERO     WDRINB           Item Structure
     C                     Z-ADD*ZERO     WDRHNB           Item Structure
     C                     Z-ADD*ZERO     WDRGNB           Item Structure
     C                     Z-ADD*ZERO     WDTFNB           Transportation
     C                     Z-ADD*ZERO     WDTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WDTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WDBLPR           Market Overage
     C                     Z-ADD*ZERO     WDBMPR           Standard Overag
     C                     Z-ADD*ZERO     WDCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WDCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WDSWGH           Std Weight_Head
     C                     Z-ADD*ZERO     WDPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WDICN1           Item Category N
     C                     Z-ADD*ZERO     WDICN2           Item Category N
     C                     Z-ADD*ZERO     WDV2NB           Item Category N
     C                     Z-ADD*ZERO     WDITCN           Item Category N
     C                     Z-ADD*ZERO     WDITC5           Item Category N
     C                     Z-ADD*ZERO     WDICN6           Item Category N
     C                     Z-ADD*ZERO     WDICN7           Item Category N
     C                     Z-ADD*ZERO     WDICN8           Item Category N
     C                     Z-ADD*ZERO     WDICN9           Item Category N
     C                     Z-ADD*ZERO     WDICN0           Item Category N
     C                     Z-ADD*ZERO     WDSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WDA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WDSJNB           Production Lead
     C                     Z-ADD*ZERO     WDSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WDSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WDSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WDCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WDCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WDILNB           Packages per ca
     C                     Z-ADD*ZERO     WDCHNB           Use_Freeze_Sell
     C                     Z-ADD*ZERO     WDCINB           PM Batch Size
     C                     Z-ADD*ZERO     WDCJNB           Package Level s
     C                     Z-ADD*ZERO     WDCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WDCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WDCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WDCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WDCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WDCWNB           PM Std LBS Man
     C                     Z-ADD*ZERO     WDCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WDCZNB           PM Formula LBS
     C                     Z-ADD*ZERO     WDC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WDB4NB           PM Raw Material
     C                     Z-ADD*ZERO     WDB5NB           PM Line Number
     C                     Z-ADD*ZERO     WDBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WDBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WDF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WDF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WDF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WDBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WDBNNB           Production Qty
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEHGCD           Item Code
     C                     Z-ADD*ZERO     WEAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WEAECS           Last Cost
     C                     Z-ADD*ZERO     WEBACS           Cost per Primar
     C                     Z-ADD*ZERO     WEBBCS           Cost per Pricin
     C                     Z-ADD*ZERO     WECBPR           Revaluation Cos
     C                     Z-ADD*ZERO     WEGUDT           Revaluation Eff
     C                     Z-ADD*ZERO     WECTPR           Last Revaluatio
     C                     Z-ADD*ZERO     WEG4DT           Last Revaluatio
     C                     Z-ADD*ZERO     WEBOWG           On Hand Weight
     C                     Z-ADD*ZERO     WEDDQT           On Hand UOM1 Su
     C                     Z-ADD*ZERO     WEDEQT           On Hand UOM2 Su
     C                     Z-ADD*ZERO     WEDFQT           On Hand UOM3 Su
     C                     Z-ADD*ZERO     WEHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WEHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WEAJQT           Quantity Schedu
     C                     Z-ADD*ZERO     WEAQQT           Quantity on Sal
     C                     Z-ADD*ZERO     WEAUQT           Quantity on Pur
     C                     Z-ADD*ZERO     WEEMQT           Quantity on Tra
     C                     Z-ADD*ZERO     WEDOQT           Quantity Avail
     C                     Z-ADD*ZERO     WEAKDT           Date of Last Or
     C                     Z-ADD*ZERO     WEANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WEIDVA           Value of On Han
     C                     Z-ADD*ZERO     WEBZPC           Safety Allowanc
     C                     Z-ADD*ZERO     WEDGQT           Safety Allowanc
     C                     Z-ADD*ZERO     WEDIDT           Stock Out Date
     C                     Z-ADD*ZERO     WEBFDY           Lead Time Last
     C                     Z-ADD*ZERO     WEDJDT           Lead Time Date
     C                     Z-ADD*ZERO     WEBGDY           Lead Time Next
     C                     Z-ADD*ZERO     WEDKDT           Lead Time Date
     C                     Z-ADD*ZERO     WEDJQT           Usage Qty per C
     C                     Z-ADD*ZERO     WEBNWG           Usage Weight pe
     C                     Z-ADD*ZERO     WEDLDT           Inventory Manag
     C                     Z-ADD*ZERO     WEDPQT           Minimum Quantit
     C                     Z-ADD*ZERO     WEDQQT           Maximum Quantit
     C                     Z-ADD*ZERO     WEDMDT           Last Physical C
     C                     Z-ADD*ZERO     WEAKC8           Vendor Item_Whs
     C                     Z-ADD*ZERO     WERINB           Item Structure
     C                     Z-ADD*ZERO     WERHNB           Item Structure
     C                     Z-ADD*ZERO     WERGNB           Item Structure
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFC4NB           Order Number
     C                     Z-ADD*ZERO     WFANC7           AR Customer Num
     C                     Z-ADD*ZERO     WFBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WFB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WFA0DT           Order Date
     C                     Z-ADD*ZERO     WFA5DT           Requested Ship
     C                     Z-ADD*ZERO     WFGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WFACDT           Cancel Date
     C                     Z-ADD*ZERO     WFAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WFCXDT           Date of Origina
     C                     Z-ADD*ZERO     WFJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WFA1WG           Order Weight To
     C                     Z-ADD*ZERO     WFEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WFAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WFRMNB           Load ID
     C                     Z-ADD*ZERO     WFTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WFR1NB           Rated Freight
     C                     Z-ADD*ZERO     WFRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WFATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WFRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WFT3NB           Attach to Order
     C                     Z-ADD*ZERO     WFCONB           Invoice Number
     C                     Z-ADD*ZERO     WFAWDT           Invoice Date
     C                     Z-ADD*ZERO     WFVRVA           A_R order Value
     C                     Z-ADD*ZERO     WFB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WFNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WFNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WFNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WFNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WFNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WFBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WFBQTM           Time of Origina
     C                     Z-ADD*ZERO     WFBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WFBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WFBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WFH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WFH1NX           Act Non_Ref Frt
     C                     Z-ADD*ZERO     WFH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WFH3NX           OH Total Non_Re
     C                     Z-ADD*ZERO     WFH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WFC0C7           Claim Number
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGC4NB           Order Number
     C                     Z-ADD*ZERO     WGDPNB           Order Sequence
     C                     Z-ADD*ZERO     WGUENB           Order Secondary
     C                     Z-ADD*ZERO     WGHGCD           Item Code
     C                     Z-ADD*ZERO     WGBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WGCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WGMAVA           Billing Detail
     C                     Z-ADD*ZERO     WGKDVA           Billing Detail
     C                     Z-ADD*ZERO     WGL8VA           Billing Detail
     C                     Z-ADD*ZERO     WGL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WGAYVA           Extended Amount
     C                     Z-ADD*ZERO     WGEXDT           Market Pricing
     C                     Z-ADD*ZERO     WGBZPR           Price Overage O
     C                     Z-ADD*ZERO     WGL6NB           Contract Number
     C                     Z-ADD*ZERO     WGGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WGR1NB           Rated Freight
     C                     Z-ADD*ZERO     WGAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WGD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WGCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WGAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WGCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WGATWG           Weight Shipped
     C                     Z-ADD*ZERO     WGAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WGAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WGAKPR           Unit Price
     C                     Z-ADD*ZERO     WGALPR           Unit Price_Cred
     C                     Z-ADD*ZERO     WGAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WGAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WGA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WGA5DT           Requested Ship
     C                     Z-ADD*ZERO     WGAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WGGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WGRGNB           Item Structure
     C                     Z-ADD*ZERO     WGRHNB           Item Structure
     C                     Z-ADD*ZERO     WGRINB           Item Structure
     C                     Z-ADD*ZERO     WGCXDT           Date of Origina
     C                     Z-ADD*ZERO     WGDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WGB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WGA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WGNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WGNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WGNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WGNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WGNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WGBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WGBVTM           Price Code
     C                     Z-ADD*ZERO     WGBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WGBXTM           Substitution Li
     C                     Z-ADD*ZERO     WGBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WGH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WGH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WGH7NX           OD Item Target
     C                     Z-ADD*ZERO     WGH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WGH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WGDVPR           Order Gate_Fina
     C                     Z-ADD*ZERO     WGDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WGDXPR           OD Gate_Final P
     C                     Z-ADD*ZERO     WGDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WGDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WGGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WGGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WGGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WGPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WGRINY           Item Age Days
     C                     Z-ADD*ZERO     WGTIDT           Production Ovr
     C                     Z-ADD*ZERO     WGTJDT           Production Ovr
     C                     Z-ADD*ZERO     WGTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WGTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WGTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHC4NB           Order Number
     C                     Z-ADD*ZERO     WHDPNB           Order Sequence
     C                     Z-ADD*ZERO     WHUENB           Order Secondary
     C                     Z-ADD*ZERO     WHRZNB           Case Sequence N
     C                     Z-ADD*ZERO     WHFOQT           Case Quantity
     C                     Z-ADD*ZERO     WHR0NB           Case Weight
     C                     Z-ADD*ZERO     WHK7DT           Label Date
     C                     Z-ADD*ZERO     WHPFNX           PT Serial Numbe
     C                     Z-ADD*ZERO     WHHGCD           Item Code
     C                     Z-ADD*ZERO     WHELDT           Production Date
     C                     Z-ADD*ZERO     WHN5WG           Manifest Gross
     C                     Z-ADD*ZERO     WHH5NY           Manifest Total
     C                     Z-ADD*ZERO     WHH6NY           Manifest Co_Par
     C                     Z-ADD*ZERO     WHH7NY           Manifest Pallet
     C                     Z-ADD*ZERO     WHN6WG           HPB Meter Net G
     C                     Z-ADD*ZERO     WHN7WG           Manifest Net We
     C                     Z-ADD*ZERO     WHRBDT           Manifest Unused
     C                     Z-ADD*ZERO     WHITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WHIVNY           HPB Meter Start
     C                     Z-ADD*ZERO     WHIUNY           HPB Meter Endin
     C                     Z-ADD*ZERO     WHIWNY           HPB Meter Total
     C                     Z-ADD*ZERO     WHIXNY           HPB Meter Net W
     C                     Z-ADD*ZERO     WHIYNY           HPB Density Ref
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
     C                     Z-ADD*ZERO     WHLPNZ           Manifest Pallet
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIM8NB           System Value Nu
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLAIC3           Company Number
     C                     Z-ADD*ZERO     WLPFNX           PT Serial Numbe
     C                     Z-ADD*ZERO     WLAADX           PT Prod Date YY
     C                     Z-ADD*ZERO     WLB9TM           PT Production T
     C                     Z-ADD*ZERO     WLADDX           PT Label Date Y
     C                     Z-ADD*ZERO     WLABDX           PT Offset Prod
     C                     Z-ADD*ZERO     WLCATM           PT Offset Prod
     C                     Z-ADD*ZERO     WLJOWG           PT Net Weight
     C                     Z-ADD*ZERO     WLJPWG           PT Gross Weight
     C                     Z-ADD*ZERO     WLPGNX           PT Order Number
     C                     Z-ADD*ZERO     WLD7C7           PT Product Code
     C                     Z-ADD*ZERO     WLPHNX           PT Tattoo Numbe
     C                     Z-ADD*ZERO     WLUFNX           PT Item Str Cla
     C                     Z-ADD*ZERO     WLUGNX           PT Item Str Gro
     C                     Z-ADD*ZERO     WLUHNX           PT Item Str Typ
     C                     Z-ADD*ZERO     WLAGDX           PT WIP Dump/Pro
     C                     Z-ADD*ZERO     WLCGTM           PT WIP Dump/Pro
     C                     Z-ADD*ZERO     WLUINX           PT From FG Seri
     C                     Z-ADD*ZERO     WLUJNX           PT To FG Serial
     C                     Z-ADD*ZERO     WLUKNX           PT Unused Nbr 3
     C                     Z-ADD*ZERO     WLULNX           PT Unused Nbr 4
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMAIC3           Company Number
     C                     Z-ADD*ZERO     WMPUDT           Effective Label
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOAIC3           Company Number
     C                     Z-ADD*ZERO     WOPINX           CS Scale Offset
     C                     Z-ADD*ZERO     WOAATM           Job Time
     C                     Z-ADD*ZERO     WOAXDT           Job Date
      * Define work field Description Line One
     C                     MOVEL*BLANK    WUAVNA 30
      * Define work field Blank for 4           USR
     C                     MOVEL*BLANK    WUOTTX  4
      * Define work field Blank 6 USR
     C                     MOVEL*BLANK    WUXKTX  6
      * Define work field ILL Unused Sts 1
     C                     MOVEL*BLANK    WUASSX  1
      * Define work field ILL Unused Sts 2
     C                     MOVEL*BLANK    WUATSX  1
      * Define work field ILL Unused Sts 3
     C                     MOVEL*BLANK    WUAUSX  2
      * Define work field EDI Status 1
     C                     MOVEL*BLANK    WUUVST  1
      * Define work field EDI Status 2
     C                     MOVEL*BLANK    WUUWST  1
      * Define work field EDI Status 3
     C                     MOVEL*BLANK    WUUXST  1
      * Define work field Record Status
     C                     MOVEL*BLANK    WUVSST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WTAIC3           Company Number
     C                     Z-ADD*ZERO     WTHGCD           Item Code
     C                     Z-ADD*ZERO     WTELDT           Production Date
     C                     Z-ADD*ZERO     WTLXNM           Lot Number
     C                     Z-ADD*ZERO     WTYNCD           Location Level
     C                     Z-ADD*ZERO     WTJ2QT           ILL Item Qty On
     C                     Z-ADD*ZERO     WTG5WG           ILL Unit Weight
     C                     Z-ADD*ZERO     WTJ3QT           ILL Co-Packer L
     C                     Z-ADD*ZERO     WTG6WG           ILL Item Wgt On
     C                     Z-ADD*ZERO     WTJ4QT           ILL Unused Qty
     C                     Z-ADD*ZERO     WTG7WG           ILL Unused Wgt
     C                     Z-ADD*ZERO     WTLODT           ILL Avail Ship
     C                     Z-ADD*ZERO     WTLPDT           ILL Unused Date
     C                     Z-ADD*ZERO     WTLQDT           ILL Unused Date
     C                     Z-ADD*ZERO     WTNBR            ILL Unused Nbr
     C                     Z-ADD*ZERO     WTAATM           Job Time
     C                     Z-ADD*ZERO     WTAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WVLCBY           Location Bay
     C                     Z-ADD*ZERO     WVLCCT           Loc Unused Chil
     C                     Z-ADD*ZERO     WVAATM           Job Time
     C                     Z-ADD*ZERO     WVAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WWSLTY           WLT Type Chill
     C                     Z-ADD*ZERO     WWAATM           Job Time
     C                     Z-ADD*ZERO     WWAXDT           Job Date
      * Define work field LTT Unused Sts 1
     C                     MOVEL*BLANK    WULLTU  1
      * Define work field LTT Unused Sts 2
     C                     MOVEL*BLANK    WULLYT  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WYAIC3           Company Number
     C                     Z-ADD*ZERO     WYHGCD           Item Code
     C                     Z-ADD*ZERO     WYLRDT           LLT Transaction
     C                     Z-ADD*ZERO     WYLLTS           LLT Sequence Nu
     C                     Z-ADD*ZERO     WYLSDT           LLT Production
     C                     Z-ADD*ZERO     WYJ5QT           LLT Transaction
     C                     Z-ADD*ZERO     WYG8WG           LLT Transaction
     C                     Z-ADD*ZERO     WYLLTN           LLT Lot Number
     C                     Z-ADD*ZERO     WYLLCL           LLT Location Le
     C                     Z-ADD*ZERO     WYLLTR           LLT Transfer Lo
     C                     Z-ADD*ZERO     WYLLTL           LLT Transfer Lo
     C                     Z-ADD*ZERO     WYC4NB           Order Number
     C                     Z-ADD*ZERO     WYAATM           Job Time
     C                     Z-ADD*ZERO     WYAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TBAIC3           Company Number
     C                     Z-ADD*ZERO     TBHGCD           Item Code
     C                     Z-ADD*ZERO     TBELDT           Production Date
     C                     Z-ADD*ZERO     TBABWG           Physical Count
     C                     Z-ADD*ZERO     TBAGQT           Physical Count
     C                     Z-ADD*ZERO     TBAHQT           Physical Count
     C                     Z-ADD*ZERO     TBAIQT           Physical Count
     C                     Z-ADD*ZERO     TBACWG           Quantity on Han
     C                     Z-ADD*ZERO     TBARQT           Quantity on Han
     C                     Z-ADD*ZERO     TBASQT           Quantity on Han
     C                     Z-ADD*ZERO     TBATQT           Quantity on Han
     C                     Z-ADD*ZERO     TBHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     TBHEQT           Weight In Chill
     C                     Z-ADD*ZERO     TBBMWG           Physical Start
     C                     Z-ADD*ZERO     TBDSQT           Physical Start
     C                     Z-ADD*ZERO     TBDTQT           Physical Start
     C                     Z-ADD*ZERO     TBDUQT           Physical Start
     C                     Z-ADD*ZERO     TBDHDT           Physical Start
     C                     Z-ADD*ZERO     TBAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     TBAECS           Last Cost
     C                     Z-ADD*ZERO     TBIDVA           Value of On Han
     C                     Z-ADD*ZERO     TBK7DT           Label Date
     C                     Z-ADD*ZERO     TBRINB           Item Structure
     C                     Z-ADD*ZERO     TBRHNB           Item Structure
     C                     Z-ADD*ZERO     TBRGNB           Item Structure
     C                     Z-ADD*ZERO     TBAATM           Job Time
     C                     Z-ADD*ZERO     TBAXDT           Job Date
      * Define work field Update Exception Status
     C                     MOVEL*BLANK    WUF6ST  1
      * Clear all neither parameters
      * Crt Item Bal. Detail   CR - Item Balance Detail  * 
     C                     Z-ADD*ZERO     TCAATM           Job Time
     C                     Z-ADD*ZERO     TCAXDT           Job Date
      * Define work field #Sequence Block
     C                     MOVEL*BLANK    WUZRST  1
      * Define work field Manifest Unused Status 1A
     C                     MOVEL*BLANK    WUGCTX  1
      * Define work field Manifest Unused Status 2A
     C                     MOVEL*BLANK    WUGDTX  1
      * Define work field OIA Unused Sts 1
     C                     MOVEL*BLANK    WUOTUS  1
      * Define work field OIA Unused Sts 2
     C                     MOVEL*BLANK    WUOTMP  2
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TFAIC3           Company Number
     C                     Z-ADD*ZERO     TFC4NB           Order Number
     C                     Z-ADD*ZERO     TFDPNB           Order Sequence
     C                     Z-ADD*ZERO     TFUENB           Order Secondary
     C                     Z-ADD*ZERO     TFALSW           Allocation Seq
     C                     Z-ADD*ZERO     TFJ6QT           OIA Alloc_Shipp
     C                     Z-ADD*ZERO     TFG9WG           OIA Alloc_Shipp
     C                     Z-ADD*ZERO     TFJ9QT           OIA Co-Packer L
     C                     Z-ADD*ZERO     TFHAWG           OIA Serial Numb
     C                     Z-ADD*ZERO     TFHGCD           Item Code
     C                     Z-ADD*ZERO     TFELDT           Production Date
     C                     Z-ADD*ZERO     TFLXNM           Lot Number
     C                     Z-ADD*ZERO     TFYNCD           Location Level
     C                     Z-ADD*ZERO     TFAATM           Job Time
     C                     Z-ADD*ZERO     TFAXDT           Job Date
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     MOVEL*BLANK    WL0002  6
     C                     MOVEL*BLANK    WL0003  1
     C                     MOVEL*BLANK    WL0004  1
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0005  30
     C                     Z-ADD*ZERO     WL0006  70
     C                     MOVEL*BLANK    WL0007  1
     C                     Z-ADD*ZERO     WL0008  30
     C                     MOVEL*BLANK    WL0009  3
     C                     MOVEL*BLANK    WL0010  3
     C                     Z-ADD*ZERO     WL0011  52
     C                     MOVEL*BLANK    WL0012  6
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0013  30
     C                     Z-ADD*ZERO     WL0014  70
     C                     Z-ADD*ZERO     WL0015  30
     C                     Z-ADD*ZERO     WL0016  30
     C                     Z-ADD*ZERO     WL0017  80
     C                     Z-ADD*ZERO     WL0018  70
     C                     MOVEL*BLANK    WL0019  1
      * Define local variables for subroutine SIRVGN.
     C                     Z-ADD*ZERO     WL0020  30
     C                     MOVEL*BLANK    WL0021 10
     C                     MOVEL*BLANK    WL0022 40
      * Define local variables for subroutine SMRVGN.
     C                     Z-ADD*ZERO     WL0023  30
     C                     Z-ADD*ZERO     WL0024  80
     C                     Z-ADD*ZERO     WL0025  80
      * Define local variables for subroutine SNRVGN.
     C                     Z-ADD*ZERO     WL0026  30
     C                     MOVEL*BLANK    WL0027  2
     C                     Z-ADD*ZERO     WL0028  70
     C                     Z-ADD*ZERO     WL0029  30
     C                     MOVEL*BLANK    WL0030  1
      * Define local variables for subroutine SPRVGN.
     C                     Z-ADD*ZERO     WL0031  30
     C                     Z-ADD*ZERO     WL0032  70
     C                     MOVEL*BLANK    WL0033 30
     C                     MOVEL*BLANK    WL0034 32
     C                     MOVEL*BLANK    WL0035 32
     C                     Z-ADD*ZERO     WL0036  30
     C                     Z-ADD*ZERO     WL0037  30
     C                     Z-ADD*ZERO     WL0038  30
     C                     MOVEL*BLANK    WL0039  3
     C                     MOVEL*BLANK    WL0040  3
     C                     MOVEL*BLANK    WL0041  3
     C                     MOVEL*BLANK    WL0042  6
      * Define local variables for subroutine SQRVGN.
     C                     MOVEL*BLANK    WL0043  3
     C                     MOVEL*BLANK    WL0044  2
      * Define local variables for subroutine SRCRRC.
     C                     Z-ADD*ZERO     WL0045  30
     C                     Z-ADD*ZERO     WL0046  80
     C                     Z-ADD*ZERO     WL0047  80
     C                     Z-ADD*ZERO     WL0048  60
     C                     Z-ADD*ZERO     WL0049  80
     C                     Z-ADD*ZERO     WL0050  80
     C                     Z-ADD*ZERO     WL0051  60
     C                     MOVEL*BLANK    WL0052  1
     C                     Z-ADD*ZERO     WL0053  51
     C                     Z-ADD*ZERO     WL0054  51
     C                     MOVEL*BLANK    WL0055  1
     C                     MOVEL*BLANK    WL0056  3
     C                     Z-ADD*ZERO     WL0057  70
     C                     MOVEL*BLANK    WL0058 10
     C                     Z-ADD*ZERO     WL0059  70
     C                     MOVEL*BLANK    WL0060 32
     C                     MOVEL*BLANK    WL0061 32
     C                     MOVEL*BLANK    WL0062  2
     C                     MOVEL*BLANK    WL0063  9
     C                     Z-ADD*ZERO     WL0064  50
     C                     MOVEL*BLANK    WL0065  1
     C                     MOVEL*BLANK    WL0066  3
     C                     MOVEL*BLANK    WL0067 25
     C                     MOVEL*BLANK    WL0068  5
     C                     MOVEL*BLANK    WL0069 25
     C                     MOVEL*BLANK    WL0070  7
     C                     MOVEL*BLANK    WL0071  6
     C                     MOVEL*BLANK    WL0072 40
     C                     MOVEL*BLANK    WL0073 40
     C                     MOVEL*BLANK    WL0074  2
     C                     MOVEL*BLANK    WL0075 20
     C                     MOVEL*BLANK    WL0076  5
     C                     MOVEL*BLANK    WL0077 25
     C                     MOVEL*BLANK    WL0078  1
     C                     MOVEL*BLANK    WL0079  7
     C                     MOVEL*BLANK    WL0080  7
     C                     MOVEL*BLANK    WL0081  7
     C                     MOVEL*BLANK    WL0082  7
     C                     MOVEL*BLANK    WL0083  3
     C                     Z-ADD*ZERO     WL0084  30
     C                     Z-ADD*ZERO     WL0085  30
     C                     Z-ADD*ZERO     WL0086  30
     C                     Z-ADD*ZERO     WL0087  80
     C                     Z-ADD*ZERO     WL0088  60
     C                     MOVEL*BLANK    WL0089  1
     C                     MOVEL*BLANK    WL0090  1
     C                     Z-ADD*ZERO     WL0091  80
     C                     Z-ADD*ZERO     WL0092  80
     C                     Z-ADD*ZERO     WL0093  80
     C                     Z-ADD*ZERO     WL0094  70
     C                     MOVEL*BLANK    WL0095  1
     C                     MOVEL*BLANK    WL0096  1
     C                     Z-ADD*ZERO     WL0097  60
     C                     MOVEL*BLANK    WL0098 10
     C                     MOVEL*BLANK    WL0099 10
     C                     Z-ADD*ZERO     WL0100  70
      * Define local variables for subroutine STCRRC.
     C                     Z-ADD*ZERO     WL0101  30
     C                     Z-ADD*ZERO     WL0102  70
     C                     MOVEL*BLANK    WL0103  3
     C                     Z-ADD*ZERO     WL0104  70
     C                     Z-ADD*ZERO     WL0105  50
     C                     MOVEL*BLANK    WL0106  4
     C                     Z-ADD*ZERO     WL0107  20
     C                     Z-ADD*ZERO     WL0108  50
     C                     Z-ADD*ZERO     WL0109 112
     C                     Z-ADD*ZERO     WL0110  50
     C                     Z-ADD*ZERO     WL0111 112
     C                     Z-ADD*ZERO     WL0112  50
     C                     Z-ADD*ZERO     WL0113 112
     C                     Z-ADD*ZERO     WL0114  70
     C                     Z-ADD*ZERO     WL0115  70
     C                     Z-ADD*ZERO     WL0116  70
     C                     Z-ADD*ZERO     WL0117  72
     C                     MOVEL*BLANK    WL0118  6
     C                     MOVEL*BLANK    WL0119  1
     C                     MOVEL*BLANK    WL0120  1
     C                     MOVEL*BLANK    WL0121  1
     C                     MOVEL*BLANK    WL0122  2
     C                     MOVEL*BLANK    WL0123  3
     C                     MOVEL*BLANK    WL0124  1
     C                     MOVEL*BLANK    WL0125  1
     C                     MOVEL*BLANK    WL0126  1
     C                     MOVEL*BLANK    WL0127  1
     C                     Z-ADD*ZERO     WL0128  60
     C                     MOVEL*BLANK    WL0129 10
     C                     MOVEL*BLANK    WL0130 10
     C                     Z-ADD*ZERO     WL0131  70
     C                     MOVEL*BLANK    WL0132  2
      * Define local variables for subroutine SURVGN.
     C                     MOVEL*BLANK    WL0133  3
     C                     MOVEL*BLANK    WL0134  4
     C                     MOVEL*BLANK    WL0135  1
      * Define local variables for subroutine SVRVGN.
     C                     MOVEL*BLANK    WL0136  1
     C                     Z-ADD*ZERO     WL0137  52
      * Define local variables for subroutine SWRVGN.
     C                     Z-ADD*ZERO     WL0138  30
     C                     Z-ADD*ZERO     WL0139  70
     C                     Z-ADD*ZERO     WL0140 112
     C                     MOVEL*BLANK    WL0141  2
      * Define local variables for subroutine TARVGN.
     C                     Z-ADD*ZERO     WL0142  30
     C                     Z-ADD*ZERO     WL0143  70
     C                     MOVEL*BLANK    WL0144  3
     C                     MOVEL*BLANK    WL0145  2
     C                     Z-ADD*ZERO     WL0146  70
     C                     Z-ADD*ZERO     WL0147  30
      * Define local variables for subroutine TBCRRC.
     C                     Z-ADD*ZERO     WL0148  30
     C                     Z-ADD*ZERO     WL0149  70
     C                     MOVEL*BLANK    WL0150  3
     C                     MOVEL*BLANK    WL0151  2
     C                     Z-ADD*ZERO     WL0152  70
     C                     Z-ADD*ZERO     WL0153  30
     C                     Z-ADD*ZERO     WL0154  70
     C                     Z-ADD*ZERO     WL0155  50
     C                     Z-ADD*ZERO     WL0156 112
     C                     Z-ADD*ZERO     WL0157  50
     C                     MOVEL*BLANK    WL0158  4
     C                     Z-ADD*ZERO     WL0159  20
     C                     MOVEL*BLANK    WL0160  3
     C                     Z-ADD*ZERO     WL0161  50
     C                     MOVEL*BLANK    WL0162  4
     C                     Z-ADD*ZERO     WL0163  20
     C                     Z-ADD*ZERO     WL0164  70
     C                     MOVEL*BLANK    WL0165  1
     C                     MOVEL*BLANK    WL0166  1
     C                     MOVEL*BLANK    WL0167  1
     C                     MOVEL*BLANK    WL0168  1
     C                     MOVEL*BLANK    WL0169  1
     C                     MOVEL*BLANK    WL0170  1
     C                     MOVEL*BLANK    WL0171  1
     C                     Z-ADD*ZERO     WL0172  60
     C                     MOVEL*BLANK    WL0173 10
     C                     MOVEL*BLANK    WL0174 10
     C                     Z-ADD*ZERO     WL0175  70
      * Define local variables for subroutine TCRVGN.
     C                     Z-ADD*ZERO     WL0176  30
     C                     Z-ADD*ZERO     WL0177  70
     C                     MOVEL*BLANK    WL0178  3
     C                     Z-ADD*ZERO     WL0179  70
      * Define local variables for subroutine THRVGN.
     C                     Z-ADD*ZERO     WL0180  30
     C                     Z-ADD*ZERO     WL0181  70
     C                     MOVEL*BLANK    WL0182  3
     C                     Z-ADD*ZERO     WL0183  70
     C                     Z-ADD*ZERO     WL0184  50
     C                     MOVEL*BLANK    WL0185  4
     C                     Z-ADD*ZERO     WL0186  20
     C                     MOVEL*BLANK    WL0187  1
     C                     MOVEL*BLANK    WL0188  3
      * Define local variables for subroutine TKCRRC.
     C                     Z-ADD*ZERO     WL0189  30
     C                     Z-ADD*ZERO     WL0190  70
     C                     Z-ADD*ZERO     WL0191  30
     C                     Z-ADD*ZERO     WL0192  30
     C                     Z-ADD*ZERO     WL0193  50
     C                     Z-ADD*ZERO     WL0194  50
     C                     Z-ADD*ZERO     WL0195 112
     C                     MOVEL*BLANK    WL0196  1
     C                     Z-ADD*ZERO     WL0197  70
     C                     Z-ADD*ZERO     WL0198  80
     C                     Z-ADD*ZERO     WL0199  70
     C                     MOVEL*BLANK    WL0200  3
     C                     Z-ADD*ZERO     WL0201  70
     C                     Z-ADD*ZERO     WL0202 112
     C                     MOVEL*BLANK    WL0203 10
     C                     Z-ADD*ZERO     WL0204  82
     C                     Z-ADD*ZERO     WL0205  50
     C                     Z-ADD*ZERO     WL0206  90
     C                     MOVEL*BLANK    WL0207  1
     C                     Z-ADD*ZERO     WL0208 112
     C                     Z-ADD*ZERO     WL0209 112
     C                     MOVEL*BLANK    WL0210  1
     C                     MOVEL*BLANK    WL0211  1
     C                     Z-ADD*ZERO     WL0212  70
     C                     Z-ADD*ZERO     WL0213  50
     C                     Z-ADD*ZERO     WL0214  80
     C                     Z-ADD*ZERO     WL0215  80
     C                     Z-ADD*ZERO     WL0216  80
     C                     Z-ADD*ZERO     WL0217  80
     C                     Z-ADD*ZERO     WL0218  74
     C                     MOVEL*BLANK    WL0219  1
     C                     MOVEL*BLANK    WL0220  1
     C                     MOVEL*BLANK    WL0221  1
     C                     MOVEL*BLANK    WL0222  1
     C                     Z-ADD*ZERO     WL0223  60
     C                     MOVEL*BLANK    WL0224 10
     C                     MOVEL*BLANK    WL0225 10
     C                     Z-ADD*ZERO     WL0226  70
     C                     Z-ADD*ZERO     WL0227 200
      * Define local variables for subroutine TNRVGN.
     C                     Z-ADD*ZERO     WL0228  30
     C                     Z-ADD*ZERO     WL0229  80
     C                     Z-ADD*ZERO     WL0230  80
     C                     MOVEL*BLANK    WL0231  1
     C                     Z-ADD*ZERO     WL0232  70
      * Define local work field PFS AccuSort Active
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field PFS Carlisle Active
     C                     MOVEL*BLANK    YL0002  1
      * Define null work field Item Structure Type Code
     C                     Z-ADD*ZERO     YN0001  30
      * Define null work field Carrier Code
     C                     MOVEL*BLANK    YN0002  3
      * Define null work field Load ID
     C                     Z-ADD*ZERO     YN0003  70
      * Define local work field Item Code
     C                     Z-ADD*ZERO     YL0003  70
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0004  3
      * Define local work field Detail Line Status
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field Office Message USR
     C                     MOVEL*BLANK    YL0007132
      * Define local work field System Value Alpha
     C                     MOVEL*BLANK    YL0008 40
      * Define local work field Lot Tracking Flag
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field WHS Live with Carlisle
     C                     MOVEL*BLANK    YL0010  1
      * Define local work field WHS PFS Interface
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field In Progress Sts USR
     C                     MOVEL*BLANK    YL0012  1
      * Define local work field Text 10A USR
     C                     MOVEL*BLANK    YL0013 10
      * Define local work field Scale ID
     C                     MOVEL*BLANK    YL0014  2
      * Define local work field CS Scale Offset Minutes
     C                     Z-ADD*ZERO     YL0015  30
      * Define null work field Warehouse Description
     C                     MOVEL*BLANK    YN0004 30
      * Define local work field Quality Level
     C                     MOVEL*BLANK    YL0016  2
      * Define local work field Quality Level
     C                     MOVEL*BLANK    YL0017  2
      * Define local work field Item Structure Class Code
     C                     Z-ADD*ZERO     YL0018  30
      * Define local work field Item Structure Group Code
     C                     Z-ADD*ZERO     YL0019  30
      * Define local work field Item Structure Type Code
     C                     Z-ADD*ZERO     YL0020  30
      * Define local work field ILL Item Qty On Hand
     C                     Z-ADD*ZERO     YL0021  50
      * Define local work field ILL Item Wgt On Hand
     C                     Z-ADD*ZERO     YL0022 112
      * Define local work field Location Code
     C                     MOVEL*BLANK    YL0023  4
      * Define local work field Order Alpha
     C                     MOVEL*BLANK    YL0024  7
      * Define local work field Text USR 8
     C                     MOVEL*BLANK    YL0025  8
      * Define local work field PT Prod Date YYYYMMDD
     C                     Z-ADD*ZERO     YL0026  80
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0027  1
      * Define local work field Office Message USR
     C                     MOVEL*BLANK    YL0028132
      * Define local work field System Value Alpha
     C                     MOVEL*BLANK    YL0029 40
      * Define local work field Net Weight Kg USR 11.4
     C                     Z-ADD*ZERO     YL0030 114
      * Define local work field Net Weight Kilograms
     C                     Z-ADD*ZERO     YL0031  71
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Y2U0005
00002 PRKDUPCSE
00003 Y2U0003
00004 Plant Floor Production
00005 Rework for Freezer Txfr
00006 PICNIC
00007 Return/Reject
00008 Delete for Issue
00009 Rework
00010 Rework Damaged Box
00011 Delete for Rework
00012 Delete Rework Damage Box
00013 Delete from Inventory
00014 Warehouse Transfer
00015 Issue Rework
00016 Rendering
00017 Adjustment to Inventory
00018 Inter-Plant Tfr
00019 Co-Pack Receipt
00020 PFS: Misc Receipt
00021 INACTV
