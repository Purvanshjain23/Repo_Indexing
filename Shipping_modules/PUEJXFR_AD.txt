// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PUEJXFR
// ?Date: 14.08.2025 Time: 03:50:11
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?SR21655 DN 11/19/24-Exit Program if Between 3:30AM thru 3:50AM.
CASE;

// IF JOB.*Job time is Between 3:30am & 3:50am
IF JOB.*Job_time >= 033000;
AND JOB.*Job_time <= 035000;

RETURN;

ENDIF;

// Execute function EUS EDI 945 Data Dfn  US.
EXECUTE FUNCTION(EUS EDI 945 Data Dfn  US) TYPE(EXCUSRSRC) ('PUESUFR');
{
 * Declare EDI 945 Data Definitions
 D digits          C                   '0123456789'
}


//?WI517 DN 10/12/23-Setup Eradani's Environment Libraries.
// Call program Upd Setup Eradani Libs CL.
CALL PROGRAM(Upd Setup Eradani Libs CL) ('PVBFUPC');

//?WI517 DN 10/04/23-Added/Init 'Send Email f/Failed API U' Output Parm.
// LCL.Send Email f/Failed API U = CND.No
LCL.Send_Email_f_Failed_API_U = 'N';

EXECUTE FUNCTION(Rtv Upd EDI 945 Trsn   RT) TYPE(RTVOBJ) FILE(ECP057)           AC2142642;
PARAMETER(LCL.Send_Email_f_Failed_API_U);
{
 //?USER: Initialize routine

 //?WI517 DN 10/04/23-Initialize Flags.
 // PAR.Send Email f/Failed API U = CND.No
 PAR.Send_Email_f_Failed_API_U = 'N';

 // LCL.First Time Through USR = CND.Yes
 LCL.First_Time_Through_USR = 'Y';

 // LCL.SSCC Pallet ID Err Found = CND.Not Entered
 LCL.SSCC_Pallet_ID_Err_Found = *BLANK;

 // LCL.EDI SURROGATE NUMBER USR = CND.Not Entered
 LCL.EDI_SURROGATE_NUMBER_USR = *ZERO;

 //?USER: Process Data record

 //?Data Validation.
 CASE;

 // IF *OTHERWISE
 IF *OTHERWISE;

 //?***NOTE***
 //?When creating new values in 'EDI-Error Reason' field, assign
 //?up to 5 bytes only since 'OHE EDI Error Reasons' is 5 bytes.
 //?Initialize.
 CASE;

 // IF *OTHERWISE
 IF *OTHERWISE;

 // PAR.EDI-Error Reason = CND.Not Entered
 PAR.EDI_Error_Reason = *BLANK;

 //?WI609_2 JM 10/08/24-Initialize newly added paramters.
 // PAR.SSCC Pallet ID Valid USR = CND.Not Entered
 PAR.SSCC_Pallet_ID_Valid_USR = *BLANK;

 ENDIF;

 //?Validate Order Number.
 CASE;

 // IF DB1.W0602 Depositor Order Nbr is Equal to zeros
 IF DB1.W0602_Depositor_Order_Nbr = *ZERO;

 // PAR.EDI-Error Reason = CND.Order Number
 PAR.EDI_Error_Reason = 'ORDNM';

 //?Validate Order Number.
 // IF *OTHERWISE
 IF *OTHERWISE;

 //?R14364 DN 04/12/19-Added BTC #.
 EXECUTE FUNCTION(RTV Order Hdr EDI 945  RT) TYPE(RTVOBJ) FILE(OPBFCPP)          AC2142643;
 PARAMETER(DB1.W0602_Depositor_Order_Nbr);
 PARAMETER(LCL.Company_Number);
 PARAMETER(LCL.Ship_To_Customer);
 PARAMETER(LCL.Bill_to_Customer);
 PARAMETER(LCL.Carrier_Code);
 PARAMETER(LCL.Header_Status);
 PARAMETER(LCL.Scheduled_Ship_Date);
 PARAMETER(LCL.Load_ID);
 PARAMETER(PAR.Event_Code);
 {
  //?USER: Initialize routine

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 //?Order Found?
 CASE;

 // IF PGM.*Return code is *Normal
 IF PGM.*Return_code = *BLANK;

 //?Validate Order Header TRG;sched ship    dont check for PO
 CASE;

 // IF NOT LCL.Header Status is Available
 IF ! LCL.Header_Status = 'A';

 // AND NOT LCL.Header Status is Hold
 AND ! LCL.Header_Status = 'H';

 // PAR.EDI-Error Reason = CND.Order Header Sts
 PAR.EDI_Error_Reason = 'ORDST';

 //?Validate Order Header TRG;sched ship    dont check for PO
 // IF DB1.W0604 Shipment Num/BOL NE LCL.Load ID
 IF DB1.W0604_Shipment_Num_BOL <> LCL.Load_ID;

 // PAR.EDI-Error Reason = CND.Order Load
 PAR.EDI_Error_Reason = 'ORDLD';

 //?Validate Order Header TRG;sched ship    dont check for PO
 // IF *OTHERWISE
 IF *OTHERWISE;

 //?Validate Scheduled Ship Date.
 CASE;

 // IF DB1.W0603 Date is Not Entered
 IF DB1.W0603_Date_actual_ship = *BLANK;

 // PAR.EDI-Error Reason = CND.Order Ship Date
 PAR.EDI_Error_Reason = 'SHPDT';

 //?Validate Scheduled Ship Date.
 // IF *OTHERWISE
 IF *OTHERWISE;

 // Execute function Val Numeric Digit     US.
 EXECUTE FUNCTION(Val Numeric Digit     US) TYPE(EXCUSRSRC) ('PUD6UFR');
 PARAMETER(DB1.W0603_Date_actual_ship);
 PARAMETER(LCL.Validation_Pass_USR);
 {
  *
  c                   Monitor
  *
  c                   If        %check(digits : %trim(#IA2T1)) = 0
  * All Digit, Validation Pass.
  c                   eval      #OFASC = 'Y'
  c                   else
  * Non-Digit Found, Validation Fail.
  c                   eval      #OFASC = 'N'
  c                   endif
  *
  * Monitor Message RNX0105 - 'A character representation of a numeric value is in error.
  c                   On-Error  00105                                        Do Nothing
  *
  c                   EndMon
  *
 }

 //?Date Pass Digit Check?
 CASE;

 // IF LCL.Validation Pass USR is Yes
 IF LCL.Validation_Pass_USR = 'Y';

 // LCL.EDI 945 Shipng AdvHdr Dte = CVTVAR(DB1.W0603 Date)
 LCL.EDI_945_Shipng_AdvHdr_Dte = CVTVAR(DB1.W0603_Date_actual_ship);

 // LCL.Scheduled Ship Dte USR = LCL.Scheduled Ship Date + CON.-3 *DAYS
 LCL.Scheduled_Ship_Dte_USR = DATEINCR(LCL.Scheduled_Ship_Date '-3' 'DY' 1111111 'NONE'
 'N' 1);

 //?EDI 945 Hdr Date Cannot be < Sched Ship-3    OR Hdr Dte > SSD (+14 days).
 CASE;

 // IF LCL.Scheduled Ship Dte USR GT LCL.EDI 945 Shipng AdvHdr Dte
 IF LCL.Scheduled_Ship_Dte_USR > LCL.EDI_945_Shipng_AdvHdr_Dte;

 // PAR.EDI-Error Reason = CND.Order Ship Date
 PAR.EDI_Error_Reason = 'SHPDT';

 //?EDI 945 Hdr Date Cannot be < Sched Ship-3    OR Hdr Dte > SSD (+14 days).
 // IF *OTHERWISE
 IF *OTHERWISE;

 // LCL.Scheduled Ship Dte USR = LCL.Scheduled Ship Date + CON.17 *DAYS
 LCL.Scheduled_Ship_Dte_USR = DATEINCR(LCL.Scheduled_Ship_Date 17 'DY' 1111111 'NONE' 'N'
 1);

 CASE;

 // IF LCL.EDI 945 Shipng AdvHdr Dte GT LCL.Scheduled Ship Dte USR
 IF LCL.EDI_945_Shipng_AdvHdr_Dte > LCL.Scheduled_Ship_Dte_USR;

 // PAR.EDI-Error Reason = CND.Order Ship Date
 PAR.EDI_Error_Reason = 'SHPDT';

 ENDIF;

 ENDIF;

 //?Date Pass Digit Check?
 // IF *OTHERWISE
 IF *OTHERWISE;

 // PAR.EDI-Error Reason = CND.Order Ship Date
 PAR.EDI_Error_Reason = 'SHPDT';

 ENDIF;

 ENDIF;

 ENDIF;

 //?Order Found?
 // IF *OTHERWISE
 IF *OTHERWISE;

 // PAR.EDI-Error Reason = CND.Order Number
 PAR.EDI_Error_Reason = 'ORDNM';

 ENDIF;

 ENDIF;

 //?If Order Not in Error, Continue Validation.
 CASE;

 // IF PAR.EDI-Error Reason is Not Entered
 IF PAR.EDI_Error_Reason = *BLANK;

 //?Check Credit/Production Hold Status.
 CASE;

 // IF *OTHERWISE
 IF *OTHERWISE;

 EXECUTE FUNCTION(RTV Cr/Pr Hold        RT) TYPE(RTVOBJ) FILE(OPBFCPP)           AC1920451;
 PARAMETER(LCL.Company_Number);
 PARAMETER(DB1.W0602_Depositor_Order_Nbr);
 PARAMETER(NLL.Scheduled_Ship_Date);
 PARAMETER(LCL.Credit_Hold);
 PARAMETER(LCL.Production_Hold);
 {
  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 CASE;

 // IF LCL.Credit Hold is Yes
 IF LCL.Credit_Hold = 'Y';

 // AND LCL.Header Status is Hold
 AND LCL.Header_Status = 'H';

 // PAR.EDI-Error Reason = CND.Credit Hold
 PAR.EDI_Error_Reason = 'CRDHD';

 // IF *OTHERWISE
 IF *OTHERWISE;

 CASE;

 // IF LCL.Production Hold is Yes
 IF LCL.Production_Hold = 'Y';

 // PAR.EDI-Error Reason = CND.Product'n Hold
 PAR.EDI_Error_Reason = 'PRDHD';

 ENDIF;

 ENDIF;

 ENDIF;

 //?If Not in Error, Check Order Company Matches.
 CASE;

 // IF PAR.EDI-Error Reason is Not Entered
 IF PAR.EDI_Error_Reason = *BLANK;

 //?RMC 10-07-20 added acctng co
 EXECUTE FUNCTION(RTV Whse/Non Cancelled RT) TYPE(RTVOBJ) FILE(OPBGWKP)          AC1428700;
 PARAMETER(LCL.Company_Number);
 PARAMETER(DB1.W0602_Depositor_Order_Nbr);
 PARAMETER(1);
 PARAMETER(1);
 PARAMETER(LCL.Warehouse_Code);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  //?C2748:  Changed RTV Warehouse Code RT to exclude Cancelled lines.
  CASE;

  // IF DB1.Detail Line Status is Cancelled
  IF DB1.Detail_Line_Status = 'X';

  // IF *OTHERWISE
  IF *OTHERWISE;

  MOVE *ALL (To: PAR From: DB1);

  QUIT;

  ENDIF;

 }

 EXECUTE FUNCTION(Rtv Acct Co          RT) TYPE(RTVOBJ) FILE(CAADREP)            AC1802492;
 PARAMETER(LCL.Warehouse_Code);
 PARAMETER(LCL.Accounting_Company);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 EXECUTE FUNCTION(Val Order Company      RT) TYPE(RTVOBJ) FILE(ECP059)           AC2156940;
 PARAMETER('SF');
 PARAMETER(DB1.EDI_SURROGATE_NUMBER);
 PARAMETER(LCL.Company_Number);
 PARAMETER(LCL.Warehouse_Code);
 PARAMETER(PAR.EDI_Error_Reason);
 PARAMETER(LCL.Accounting_Company);
 {
  //?USER: Initialize routine

  // PAR.EDI-Error Reason = CND.Not Entered
  PAR.EDI_Error_Reason = *BLANK;

  //?USER: Process Data record

  CASE;

  // IF DB1.N104-ID CODE is Entered
  IF DB1.N104_ID_CODE <> *BLANK;

  // Execute function EUS Trim & Get Company US.
  EXECUTE FUNCTION(EUS Trim & Get Company US) TYPE(EXCUSRSRC) ('PUIIUFR');
  PARAMETER(DB1.N104_ID_CODE);
  PARAMETER(LCL.Company_Number);
  {
   d wktext          S             20a
   * Trim & Get Company Number.
   c                   evalR     wktext = %trim(#IDCDE)
   c                   move      wktext        #OAIC3
   *
  }

  //?9/21/21 RMC - if override exists, then get shipping co for order for comp
  EXECUTE FUNCTION(Rtv EDI Company # ovrd RT) TYPE(RTVOBJ) FILE(PNG0REP)          AC2197166;
  PARAMETER(PAR.Warehouse_Code);
  PARAMETER('WHSADV');
  PARAMETER(LCL.EDI_Company_#_940_846_947);
  {
   //?USER: Initialize routine

   MOVE *ALL (To: PAR From: CON);

   //?USER: Process Data record

   MOVE *ALL (To: PAR From: DB1);

  }

  CASE;

  // IF LCL.EDI Company # 940 846 947 is Entered
  IF LCL.EDI_Company_#_940_846_947 > 0;

  EXECUTE FUNCTION(RTV Shipping Co        RT) TYPE(RTVOBJ) FILE(CAADREP)          AC1695057;
  PARAMETER(PAR.Warehouse_Code);
  PARAMETER(LCL.Shipping_Company);
  {
   //?USER: Processing if Data record not found

   MOVE *ALL (To: PAR From: CON);

   //?USER: Process Data record

   MOVE *ALL (To: PAR From: DB1);

  }

  // LCL.Company Number = LCL.Shipping Company
  LCL.Company_Number = LCL.Shipping_Company;

  ENDIF;

  //?Company Mismatch Error.   added acctng co check 10-07-20
  CASE;

  // IF LCL.Company Number NE PAR.Company Number
  IF LCL.Company_Number <> PAR.Company_Number;

  // AND LCL.Company Number NE PAR.Accounting Company
  AND LCL.Company_Number <> PAR.Accounting_Company;

  // PAR.EDI-Error Reason = CND.Order Company Mismatch
  PAR.EDI_Error_Reason = 'ORCOM';

  ENDIF;

  // IF *OTHERWISE
  IF *OTHERWISE;

  // PAR.EDI-Error Reason = CND.Order Company Mismatch
  PAR.EDI_Error_Reason = 'ORCOM';

  ENDIF;

 }

 ENDIF;

 //?If Not in Error, Check Ship From Warehouse DUNS# Matches.
 CASE;

 // IF PAR.EDI-Error Reason is Not Entered
 IF PAR.EDI_Error_Reason = *BLANK;

 EXECUTE FUNCTION(Val From Whs DUNS#     RT) TYPE(RTVOBJ) FILE(ECP059)           AC2142744;
 PARAMETER('WH');
 PARAMETER(DB1.EDI_SURROGATE_NUMBER);
 PARAMETER(LCL.Company_Number);
 PARAMETER(DB1.W0602_Depositor_Order_Nbr);
 PARAMETER(PAR.EDI_Error_Reason);
 {
  //?USER: Initialize routine

  // PAR.EDI-Error Reason = CND.Not Entered
  PAR.EDI_Error_Reason = *BLANK;

  //?USER: Process Data record

  //?Verify Ship From Warehouse DUNS# Matches  QLFR = 9 or ZZ
  CASE;

  // IF DB1.N103-ID CODE QUALIFIER is Duns ID
  IF ( DB1.N103_ID_CODE_QUALIFIER = '9';

  // OR DB1.N103-ID CODE QUALIFIER is ZZ
  OR DB1.N103_ID_CODE_QUALIFIER = 'ZZ' );

  // AND DB1.N104-ID CODE is Entered
  AND DB1.N104_ID_CODE <> *BLANK;

  EXECUTE FUNCTION(RTV Whse/Non Cancelled RT) TYPE(RTVOBJ) FILE(OPBGWKP)          AC1428700;
  PARAMETER(PAR.Company_Number);
  PARAMETER(PAR.Order_Number);
  PARAMETER(1);
  PARAMETER(1);
  PARAMETER(LCL.Warehouse_Code);
  {
   //?USER: Processing if Data record not found

   MOVE *ALL (To: PAR From: CON);

   //?USER: Process Data record

   //?C2748:  Changed RTV Warehouse Code RT to exclude Cancelled lines.
   CASE;

   // IF DB1.Detail Line Status is Cancelled
   IF DB1.Detail_Line_Status = 'X';

   // IF *OTHERWISE
   IF *OTHERWISE;

   MOVE *ALL (To: PAR From: DB1);

   QUIT;

   ENDIF;

  }

  EXECUTE FUNCTION(Rtv WHS Interchg All  RT) TYPE(RTVOBJ) FILE(PNG0REP)           AC2138766;
  PARAMETER(LCL.Warehouse_Code);
  PARAMETER('WHSADV');
  PARAMETER(NLL.Class_Code);
  PARAMETER(NLL.EDI_Trading_Partner_No);
  PARAMETER(LCL.EDI_Whs_Duns_Number);
  PARAMETER(NLL.Record_Status);
  PARAMETER(NLL.Create_Date);
  PARAMETER(NLL.Create_Time);
  PARAMETER(NLL.Create_User);
  PARAMETER(NLL.Create_Program);
  PARAMETER(NLL.Change_Date);
  PARAMETER(NLL.Change_Time);
  PARAMETER(NLL.Change_User);
  PARAMETER(NLL.Change_Program);
  {
   //?USER: Initialize routine

   MOVE *ALL (To: PAR From: CON);

   //?USER: Process Data record

   MOVE *ALL (To: PAR From: DB1);

  }

  //?Error if DUNS# Mismatch.
  CASE;

  // IF DB1.N104-ID CODE NE LCL.EDI Whs Duns Number
  IF DB1.N104_ID_CODE <> LCL.EDI_Whs_Duns_Number;

  // PAR.EDI-Error Reason = CND.Order Ship Fm Whse
  PAR.EDI_Error_Reason = 'ORFWH';

  ENDIF;

  //?Verify Ship From Warehouse DUNS# Matches  QLFR = 9 or ZZ
  // IF *OTHERWISE
  IF *OTHERWISE;

  // PAR.EDI-Error Reason = CND.Order Warehouse
  PAR.EDI_Error_Reason = 'ORFWH';

  ENDIF;

 }

 ENDIF;

 //?If Not in Error, Check Ship To Customer or Customer DUNS #.
 CASE;

 // IF PAR.EDI-Error Reason is Not Entered
 IF PAR.EDI_Error_Reason = *BLANK;

 //?R14364 DN 04/12/19-Added BTC #.
 EXECUTE FUNCTION(Val Ship To Customer   RT) TYPE(RTVOBJ) FILE(ECP059)           AC2142662;
 PARAMETER('ST');
 PARAMETER(DB1.EDI_SURROGATE_NUMBER);
 PARAMETER(LCL.Ship_To_Customer);
 PARAMETER(LCL.Bill_to_Customer);
 PARAMETER(PAR.EDI_Error_Reason);
 {
  //?USER: Processing if Data record not found

  //?2/01/21 RMC R15305 Dont error if not found
  //?USER: Process Data record

  //?Validate Ship To Customer.
  CASE;

  // IF DB1.N103-ID CODE QUALIFIER is ZZ
  IF DB1.N103_ID_CODE_QUALIFIER = 'ZZ';

  // PAR.EDI-Error Reason = CND.Not Entered
  PAR.EDI_Error_Reason = *BLANK;

  CASE;

  // IF DB1.N104-ID CODE is Blank
  IF DB1.N104_ID_CODE = *BLANK;

  // PAR.EDI-Error Reason = CND.Order Customer mismatch
  PAR.EDI_Error_Reason = 'ORCST';

  // IF *OTHERWISE
  IF *OTHERWISE;

  //?R15161 DN 08/28/19-Validate Ship To Cust ID # is Numeric.
  // Execute function Val Numeric Digit     US.
  EXECUTE FUNCTION(Val Numeric Digit     US) TYPE(EXCUSRSRC) ('PUD6UFR');
  PARAMETER(DB1.N104_ID_CODE);
  PARAMETER(LCL.Validation_Pass_USR);
  {
   *
   c                   Monitor
   *
   c                   If        %check(digits : %trim(#IA2T1)) = 0
   * All Digit, Validation Pass.
   c                   eval      #OFASC = 'Y'
   c                   else
   * Non-Digit Found, Validation Fail.
   c                   eval      #OFASC = 'N'
   c                   endif
   *
   * Monitor Message RNX0105 - 'A character representation of a numeric value is in error.
   c                   On-Error  00105                                        Do Nothing
   *
   c                   EndMon
   *
  }

  //?Ship To Customer ID # Pass Digit Check?
  CASE;

  // IF LCL.Validation Pass USR is Yes
  IF LCL.Validation_Pass_USR = 'Y';

  // Execute function EUS TrimL Ship To Cust US.
  EXECUTE FUNCTION(EUS TrimL Ship To Cust US) TYPE(EXCUSRSRC) ('PUEKUFR');
  PARAMETER(DB1.N104_ID_CODE);
  PARAMETER(LCL.Ship_To_Customer_TXT);
  {
   * Trim Left Ship To Customer #.
   c                   eval      #OH4U1 = %triml(#IDCDE)
   *
  }

  // Execute function Cvt Ship To Cust Nbr   US.
  EXECUTE FUNCTION(Cvt Ship To Cust Nbr   US) TYPE(EXCUSRSRC) ('PUEVUFR');
  PARAMETER(LCL.Ship_To_Customer_TXT);
  PARAMETER(LCL.Ship_To_Customer);
  {
   * Trim Ship To Customer # and Convert to Numeric.
   c                   eval      #OBKC7 = %dec(%trim(#IH4U1) : 7:0)
   *
  }

  //?Error if Ship To Customer Mismatch.
  CASE;

  // IF PAR.Ship To Customer NE LCL.Ship To Customer
  IF PAR.Ship_To_Customer <> LCL.Ship_To_Customer;

  // PAR.EDI-Error Reason = CND.Order Customer mismatch
  PAR.EDI_Error_Reason = 'ORCST';

  ENDIF;

  //?Ship To Customer ID # Pass Digit Check?
  // IF *OTHERWISE
  IF *OTHERWISE;

  // PAR.EDI-Error Reason = CND.Order Customer Invalid
  PAR.EDI_Error_Reason = 'ORCSI';

  ENDIF;

  ENDIF;

  ENDIF;

  //?Validate Customer DUNS #.                     R14364 DN 04/12/19
  CASE;

  // IF DB1.N103-ID CODE QUALIFIER is Duns ID
  IF DB1.N103_ID_CODE_QUALIFIER = '9';

  // PAR.EDI-Error Reason = CND.Not Entered
  PAR.EDI_Error_Reason = *BLANK;

  CASE;

  // IF DB1.N104-ID CODE is Blank
  IF DB1.N104_ID_CODE = *BLANK;

  // PAR.EDI-Error Reason = CND.Order Customer mismatch
  PAR.EDI_Error_Reason = 'ORCST';

  // IF *OTHERWISE
  IF *OTHERWISE;

  // Execute function EUS TrimL Cust Duns #  US.
  EXECUTE FUNCTION(EUS TrimL Cust Duns #  US) TYPE(EXCUSRSRC) ('PUMEUFR');
  PARAMETER(DB1.N104_ID_CODE);
  PARAMETER(LCL.EDI_Cust_Duns_Number);
  {
   * Trim Left Customer Duns #.
   c                   eval      #OU5TX = %triml(#IDCDE)
   *
  }

  EXECUTE FUNCTION(Rtv All Values        RT) TYPE(RTVOBJ) FILE(PDNEREP)           AC1569834;
  PARAMETER(PAR.Bill_to_Customer);
  PARAMETER(NLL.Internet_Password);
  PARAMETER(NLL.Email_Address);
  PARAMETER(NLL.Email_User_ID);
  PARAMETER(NLL.EDI_Trading_Partner_No);
  PARAMETER(PAR.EDI_Cust_Duns_Number);
  PARAMETER(NLL.EDI_Warehouse_Store_No);
  PARAMETER(NLL.State_Tax_ID);
  PARAMETER(NLL.Cust_Shipping_Temp_C_F);
  PARAMETER(NLL.One_Invoice_Per_PO);
  PARAMETER(NLL.EDI_Advanced_Ship_Notice);
  {
   //?USER: Processing if Data record not found

   MOVE *ALL (To: PAR From: CON);

   //?USER: Process Data record

   MOVE *ALL (To: PAR From: DB1);

  }

  //?Error if Customer Duns # Mismatch.
  CASE;

  // IF PAR.EDI Cust Duns Number NE LCL.EDI Cust Duns Number
  IF PAR.EDI_Cust_Duns_Number <> LCL.EDI_Cust_Duns_Number;

  // PAR.EDI-Error Reason = CND.Order Customer mismatch
  PAR.EDI_Error_Reason = 'ORCST';

  ENDIF;

  ENDIF;

  ENDIF;

 }

 ENDIF;

 //?Validate OD for Close order only -- not for a pick sts
 CASE;

 // IF DB1.N902 Order Status is Closed Order
 IF DB1.N902_Order_Status = 'CO';

 //?If Not in Error, Check Order Detail Item Exist in EDI WHS Shipping Adv DTL
 CASE;

 // IF PAR.EDI-Error Reason is Not Entered
 IF PAR.EDI_Error_Reason = *BLANK;

 //?RMC 2/16/21 if Warehouse has Change line # = Y, then change it to match OD
 EXECUTE FUNCTION(Rtv Order Line Valid  RT) TYPE(RTVOBJ) FILE(PNG0REP)           AC2195052;
 PARAMETER(LCL.Warehouse_Code);
 PARAMETER('WHSADV');
 PARAMETER(LCL.EWI_Change_OD_Line_#);
 {
  //?USER: Initialize routine

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 EXECUTE FUNCTION(Val Item Exist in EDI  RT) TYPE(RTVOBJ) FILE(OPBGWKP)          AC2142779;
 PARAMETER(LCL.Company_Number);
 PARAMETER(DB1.W0602_Depositor_Order_Nbr);
 PARAMETER(DB1.EDI_SURROGATE_NUMBER);
 PARAMETER(PAR.EDI_Error_Reason);
 PARAMETER(LCL.EWI_Change_OD_Line_#);
 {
  //?USER: Initialize routine

  // PAR.EDI-Error Reason = CND.Order Dtl Not Found
  PAR.EDI_Error_Reason = 'ORDTN';

  //?USER: Process Data record

  //?Verify Items Exist in the EDI Detail File.
  CASE;

  // IF DB1.Detail Line Status is Not cancelled
  IF DB1.Detail_Line_Status = 'L'/'A'/'C'/'R'/'E'/'H'/'I';

  // Execute function Cvt Item Code to Char US.
  EXECUTE FUNCTION(Cvt Item Code to Char US) TYPE(EXCUSRSRC) ('PUEQUFR');
  PARAMETER(DB1.Item_Code);
  PARAMETER(LCL.W1208_Prod_ID_Code);
  {
   * Convert Item Code from Numeric to Character. Leading Zeros will be stripped.
   c                   eval      #OFIC7 = %char(#IHGCD)
   *
  }

  EXECUTE FUNCTION(Val Product Exist      RT) TYPE(RTVOBJ) FILE(ECP058)           AC2142788;
  PARAMETER(PAR.EDI_SURROGATE_NUMBER);
  PARAMETER(LCL.W1208_Prod_ID_Code);
  PARAMETER(DB1.Order_Sequence_Number);
  PARAMETER(PAR.EWI_Change_OD_Line_#);
  {
   //?USER: Process Data record

   //?RMC Chg line number in edi rcd to match our OD line number 2/16/21
   CASE;

   // IF PAR.EWI Change OD Line # is Yes-change line# to OD
   IF PAR.EWI_Change_OD_Line_# = 'Y';

   // Execute function EUS TrimL Order Line#  US.
   EXECUTE FUNCTION(EUS TrimL Order Line#  US) TYPE(EXCUSRSRC) ('PUEPUFR');
   PARAMETER(DB1.W1218_Ord_Line_Num);
   PARAMETER(LCL.Order_Sequence_Nbr_TXT);
   {
    * Trim Left Order Line Number.
    c                   eval      #OH5U1 = %triml(#IUCNY)
    *
   }

   // Execute function Val Numeric Digit     US.
   EXECUTE FUNCTION(Val Numeric Digit     US) TYPE(EXCUSRSRC) ('PUD6UFR');
   PARAMETER(LCL.Order_Sequence_Nbr_TXT);
   PARAMETER(LCL.Validation_Pass_USR);
   {
    *
    c                   Monitor
    *
    c                   If        %check(digits : %trim(#IA2T1)) = 0
    * All Digit, Validation Pass.
    c                   eval      #OFASC = 'Y'
    c                   else
    * Non-Digit Found, Validation Fail.
    c                   eval      #OFASC = 'N'
    c                   endif
    *
    * Monitor Message RNX0105 - 'A character representation of a numeric value is in error.
    c                   On-Error  00105                                        Do Nothing
    *
    c                   EndMon
    *
   }

   CASE;

   // IF LCL.Validation Pass USR is Yes
   IF LCL.Validation_Pass_USR = 'Y';

   // Execute function Cvt Order Line to Nbr  US.
   EXECUTE FUNCTION(Cvt Order Line to Nbr  US) TYPE(EXCUSRSRC) ('PUEUUFR');
   PARAMETER(LCL.Order_Sequence_Nbr_TXT);
   PARAMETER(LCL.Order_Sequence_Number);
   {
    * Trim Order Line # and Convert to Numeric.
    c                   eval      #ODPNB = %dec(%trim(#IH5U1) : 3:0)
    *
   }

   CASE;

   // IF LCL.Order Sequence Number NE PAR.Order Sequence Number
   IF LCL.Order_Sequence_Number <> PAR.Order_Sequence_Number;

   // LCL.W1218 Ord Line Num = CVTVAR(PAR.Order Sequence Number)
   LCL.W1218_Ord_Line_Num = CVTVAR(PAR.Order_Sequence_Number);

   EXECUTE FUNCTION(CHG WHS Ord Dtl Line# CH) TYPE(CHGOBJ) FILE(ECP058)            AC2195053;
   PARAMETER(DB1.EDI_SURROGATE_NUMBER);
   PARAMETER(DB1.LX01_Sequence_Number);
   PARAMETER(DB1.EDI_Pallet_Sequence_Nbr);
   PARAMETER(DB1.W1201_Ship_Order_Sts);
   PARAMETER(DB1.W1202_Quantity_Ordered);
   PARAMETER(DB1.W1203_Quantity_Shipped);
   PARAMETER(DB1.W1204_Quantity_Difference);
   PARAMETER(DB1.W1205_Unit_of_Measure);
   PARAMETER(DB1.W1206_UPC_Case_Code);
   PARAMETER(DB1.W1207_Prod_ID_Qlfr);
   PARAMETER(DB1.W1208_Prod_ID_Code);
   PARAMETER(DB1.W1209_Warehouse_Lot_Nbr);
   PARAMETER(DB1.W1210_Weight_Net);
   PARAMETER(DB1.W1211_Weight_Qualifier_Nt);
   PARAMETER(DB1.W1212_Weight_Unit_Code_Nt);
   PARAMETER(DB1.W1213_Weight_Gross);
   PARAMETER(DB1.W1214_Weight_Qualifier_Gr);
   PARAMETER(DB1.W1215_Weight_Unit_Code_Gr);
   PARAMETER(DB1.W1217_Ord_Line_Num_Qlfr);
   PARAMETER(LCL.W1218_Ord_Line_Num);
   ENDIF;

   ENDIF;

   ENDIF;

  }

  //?If Product Not Found, Try Leaving Leading 0 to see if ProdID Match.
  CASE;

  // IF PGM.*Return code is *Normal
  IF PGM.*Return_code = *BLANK;

  // PAR.EDI-Error Reason = CND.Not Entered
  PAR.EDI_Error_Reason = *BLANK;

  //?If Product Not Found, Try Leaving Leading 0 to see if ProdID Match.
  // IF *OTHERWISE
  IF *OTHERWISE;

  EXECUTE FUNCTION(Val Product Exist 2    RT) TYPE(RTVOBJ) FILE(ECP058)           AC2142908;
  PARAMETER(PAR.EDI_SURROGATE_NUMBER);
  PARAMETER(DB1.Item_Code);
  PARAMETER(PAR.EDI_Error_Reason);
  PARAMETER(DB1.Order_Sequence_Number);
  PARAMETER(PAR.EWI_Change_OD_Line_#);
  {
   //?USER: Initialize routine

   //?RMC need to Read all the records in case we are changing the seq to match
   //? our OD Sequence for the item, so removed the *quit
   // PAR.EDI-Error Reason = CND.Not Entered
   PAR.EDI_Error_Reason = *BLANK;

   //?USER: Processing if Data record not found

   // PAR.EDI-Error Reason = CND.Order Item Cde
   PAR.EDI_Error_Reason = 'ITEMN';

   //?USER: Process Data record

   //?Check Item Code Matches.
   CASE;

   // IF DB1.W1208 Prod ID Code is Entered
   IF DB1.W1208_Prod_ID_Code <> *BLANK;

   // Execute function Val Numeric Digit     US.
   EXECUTE FUNCTION(Val Numeric Digit     US) TYPE(EXCUSRSRC) ('PUD6UFR');
   PARAMETER(DB1.W1208_Prod_ID_Code);
   PARAMETER(LCL.Validation_Pass_USR);
   {
    *
    c                   Monitor
    *
    c                   If        %check(digits : %trim(#IA2T1)) = 0
    * All Digit, Validation Pass.
    c                   eval      #OFASC = 'Y'
    c                   else
    * Non-Digit Found, Validation Fail.
    c                   eval      #OFASC = 'N'
    c                   endif
    *
    * Monitor Message RNX0105 - 'A character representation of a numeric value is in error.
    c                   On-Error  00105                                        Do Nothing
    *
    c                   EndMon
    *
   }

   //?Item Code Pass Digit Check?
   CASE;

   // IF LCL.Validation Pass USR is Yes
   IF LCL.Validation_Pass_USR = 'Y';

   // Execute function EUS Cvt ItemCde to Nbr US.
   EXECUTE FUNCTION(EUS Cvt ItemCde to Nbr US) TYPE(EXCUSRSRC) ('PUIYUFR');
   PARAMETER(DB1.W1208_Prod_ID_Code);
   PARAMETER(LCL.Item_Code_USR);
   {
    * Trim Left Item Code & Suppress Leading Zero & Convert to Numeric
    c                   EVAL      #OB6C7 = %dec(%triml(#IFIC7):48:0)
    *
   }

   //?EDI WHS Shipping Adv DTL Item Code Matches Item Code in Order Detail?
   CASE;

   // IF LCL.Item Code USR EQ PAR.Item Code
   IF LCL.Item_Code_USR = PAR.Item_Code;

   //?Change EDI Seq to match OD Sequence if Flag set for warehouse
   CASE;

   // IF PAR.EWI Change OD Line # is Yes-change line# to OD
   IF PAR.EWI_Change_OD_Line_# = 'Y';

   // Execute function EUS TrimL Order Line#  US.
   EXECUTE FUNCTION(EUS TrimL Order Line#  US) TYPE(EXCUSRSRC) ('PUEPUFR');
   PARAMETER(DB1.W1218_Ord_Line_Num);
   PARAMETER(LCL.Order_Sequence_Nbr_TXT);
   {
    * Trim Left Order Line Number.
    c                   eval      #OH5U1 = %triml(#IUCNY)
    *
   }

   // Execute function Val Numeric Digit     US.
   EXECUTE FUNCTION(Val Numeric Digit     US) TYPE(EXCUSRSRC) ('PUD6UFR');
   PARAMETER(LCL.Order_Sequence_Nbr_TXT);
   PARAMETER(LCL.Validation_Pass_USR);
   {
    *
    c                   Monitor
    *
    c                   If        %check(digits : %trim(#IA2T1)) = 0
    * All Digit, Validation Pass.
    c                   eval      #OFASC = 'Y'
    c                   else
    * Non-Digit Found, Validation Fail.
    c                   eval      #OFASC = 'N'
    c                   endif
    *
    * Monitor Message RNX0105 - 'A character representation of a numeric value is in error.
    c                   On-Error  00105                                        Do Nothing
    *
    c                   EndMon
    *
   }

   CASE;

   // IF LCL.Validation Pass USR is Yes
   IF LCL.Validation_Pass_USR = 'Y';

   // Execute function Cvt Order Line to Nbr  US.
   EXECUTE FUNCTION(Cvt Order Line to Nbr  US) TYPE(EXCUSRSRC) ('PUEUUFR');
   PARAMETER(LCL.Order_Sequence_Nbr_TXT);
   PARAMETER(LCL.Order_Sequence_Number);
   {
    * Trim Order Line # and Convert to Numeric.
    c                   eval      #ODPNB = %dec(%trim(#IH5U1) : 3:0)
    *
   }

   CASE;

   // IF LCL.Order Sequence Number NE PAR.Order Sequence Number
   IF LCL.Order_Sequence_Number <> PAR.Order_Sequence_Number;

   // LCL.W1218 Ord Line Num = CVTVAR(PAR.Order Sequence Number)
   LCL.W1218_Ord_Line_Num = CVTVAR(PAR.Order_Sequence_Number);

   EXECUTE FUNCTION(CHG WHS Ord Dtl Line# CH) TYPE(CHGOBJ) FILE(ECP058)            AC2195053;
   PARAMETER(DB1.EDI_SURROGATE_NUMBER);
   PARAMETER(DB1.LX01_Sequence_Number);
   PARAMETER(DB1.EDI_Pallet_Sequence_Nbr);
   PARAMETER(DB1.W1201_Ship_Order_Sts);
   PARAMETER(DB1.W1202_Quantity_Ordered);
   PARAMETER(DB1.W1203_Quantity_Shipped);
   PARAMETER(DB1.W1204_Quantity_Difference);
   PARAMETER(DB1.W1205_Unit_of_Measure);
   PARAMETER(DB1.W1206_UPC_Case_Code);
   PARAMETER(DB1.W1207_Prod_ID_Qlfr);
   PARAMETER(DB1.W1208_Prod_ID_Code);
   PARAMETER(DB1.W1209_Warehouse_Lot_Nbr);
   PARAMETER(DB1.W1210_Weight_Net);
   PARAMETER(DB1.W1211_Weight_Qualifier_Nt);
   PARAMETER(DB1.W1212_Weight_Unit_Code_Nt);
   PARAMETER(DB1.W1213_Weight_Gross);
   PARAMETER(DB1.W1214_Weight_Qualifier_Gr);
   PARAMETER(DB1.W1215_Weight_Unit_Code_Gr);
   PARAMETER(DB1.W1217_Ord_Line_Num_Qlfr);
   PARAMETER(LCL.W1218_Ord_Line_Num);
   ENDIF;

   ENDIF;

   ENDIF;

   ENDIF;

   //?Item Code Pass Digit Check?
   // IF *OTHERWISE
   IF *OTHERWISE;

   // PAR.EDI-Error Reason = CND.Order Item Cde
   PAR.EDI_Error_Reason = 'ITEMN';

   ENDIF;

   //?Check Item Code Matches.
   // IF *OTHERWISE
   IF *OTHERWISE;

   // PAR.EDI-Error Reason = CND.Order Item Cde
   PAR.EDI_Error_Reason = 'ITEMN';

   ENDIF;

  }

  //?Quit if Error.
  CASE;

  // IF NOT PAR.EDI-Error Reason is Not Entered
  IF ! PAR.EDI_Error_Reason = *BLANK;

  QUIT;

  ENDIF;

  ENDIF;

  ENDIF;

 }

 ENDIF;

 //?If Not in Error, Check EDI Order Line#/Product Against Order Detail
 CASE;

 // IF PAR.EDI-Error Reason is Not Entered
 IF PAR.EDI_Error_Reason = *BLANK;

 EXECUTE FUNCTION(Val Ord Ln#/Prod/PrdDteRT) TYPE(RTVOBJ) FILE(ECP058)           AC2142745;
 PARAMETER(DB1.EDI_SURROGATE_NUMBER);
 PARAMETER(LCL.Company_Number);
 PARAMETER(DB1.W0602_Depositor_Order_Nbr);
 PARAMETER(PAR.EDI_Error_Reason);
 {
  //?USER: Initialize routine

  // PAR.EDI-Error Reason = CND.Not Entered
  PAR.EDI_Error_Reason = *BLANK;

  //?USER: Process Data record

  //?Validate Order Line# & Product Exist.
  CASE;

  // IF DB1.W1208 Prod ID Code is Entered
  IF DB1.W1208_Prod_ID_Code <> *BLANK;

  // AND DB1.W1218 Ord Line Num is Entered
  AND DB1.W1218_Ord_Line_Num <> *BLANK;

  //?Check Order Line Number Digits.
  CASE;

  // IF *OTHERWISE
  IF *OTHERWISE;

  // Execute function EUS TrimL Order Line#  US.
  EXECUTE FUNCTION(EUS TrimL Order Line#  US) TYPE(EXCUSRSRC) ('PUEPUFR');
  PARAMETER(DB1.W1218_Ord_Line_Num);
  PARAMETER(LCL.Order_Sequence_Nbr_TXT);
  {
   * Trim Left Order Line Number.
   c                   eval      #OH5U1 = %triml(#IUCNY)
   *
  }

  // Execute function Val Numeric Digit     US.
  EXECUTE FUNCTION(Val Numeric Digit     US) TYPE(EXCUSRSRC) ('PUD6UFR');
  PARAMETER(LCL.Order_Sequence_Nbr_TXT);
  PARAMETER(LCL.Validation_Pass_USR);
  {
   *
   c                   Monitor
   *
   c                   If        %check(digits : %trim(#IA2T1)) = 0
   * All Digit, Validation Pass.
   c                   eval      #OFASC = 'Y'
   c                   else
   * Non-Digit Found, Validation Fail.
   c                   eval      #OFASC = 'N'
   c                   endif
   *
   * Monitor Message RNX0105 - 'A character representation of a numeric value is in error.
   c                   On-Error  00105                                        Do Nothing
   *
   c                   EndMon
   *
  }

  CASE;

  // IF LCL.Validation Pass USR is Yes
  IF LCL.Validation_Pass_USR = 'Y';

  // Execute function Cvt Order Line to Nbr  US.
  EXECUTE FUNCTION(Cvt Order Line to Nbr  US) TYPE(EXCUSRSRC) ('PUEUUFR');
  PARAMETER(LCL.Order_Sequence_Nbr_TXT);
  PARAMETER(LCL.Order_Sequence_Number);
  {
   * Trim Order Line # and Convert to Numeric.
   c                   eval      #ODPNB = %dec(%trim(#IH5U1) : 3:0)
   *
  }

  // IF *OTHERWISE
  IF *OTHERWISE;

  // PAR.EDI-Error Reason = CND.Order Dtl Not Found
  PAR.EDI_Error_Reason = 'ORDTN';

  QUIT;

  ENDIF;

  ENDIF;

  //?Check Product Code Digits.
  CASE;

  // IF *OTHERWISE
  IF *OTHERWISE;

  // Execute function EUS TrimL Prod ID Code US.
  EXECUTE FUNCTION(EUS TrimL Prod ID Code US) TYPE(EXCUSRSRC) ('PUEOUFR');
  PARAMETER(DB1.W1208_Prod_ID_Code);
  PARAMETER(LCL.Item_Code_Txt);
  {
   * Trim Left Product ID.
   c                   eval      #OFYTX = %triml(#IFIC7)
   *
  }

  // Execute function Val Numeric Digit     US.
  EXECUTE FUNCTION(Val Numeric Digit     US) TYPE(EXCUSRSRC) ('PUD6UFR');
  PARAMETER(LCL.Item_Code_Txt);
  PARAMETER(LCL.Validation_Pass_USR);
  {
   *
   c                   Monitor
   *
   c                   If        %check(digits : %trim(#IA2T1)) = 0
   * All Digit, Validation Pass.
   c                   eval      #OFASC = 'Y'
   c                   else
   * Non-Digit Found, Validation Fail.
   c                   eval      #OFASC = 'N'
   c                   endif
   *
   * Monitor Message RNX0105 - 'A character representation of a numeric value is in error.
   c                   On-Error  00105                                        Do Nothing
   *
   c                   EndMon
   *
  }

  CASE;

  // IF LCL.Validation Pass USR is Yes
  IF LCL.Validation_Pass_USR = 'Y';

  // Execute function Cvt Item Code to Nbr   US.
  EXECUTE FUNCTION(Cvt Item Code to Nbr   US) TYPE(EXCUSRSRC) ('PUETUFR');
  PARAMETER(LCL.Item_Code_Txt);
  PARAMETER(LCL.Item_Code);
  {
   * Trim Item Code and Convert to Numeric.
   c                   eval      #OHGCD = %dec(%trim(#IFYTX) : 7:0)
   *
  }

  // IF *OTHERWISE
  IF *OTHERWISE;

  // PAR.EDI-Error Reason = CND.Order Dtl Not Found
  PAR.EDI_Error_Reason = 'ORDTN';

  QUIT;

  ENDIF;

  ENDIF;

  //?If No Error, Verify Order Line# / Item Exist.
  CASE;

  // IF *OTHERWISE
  IF *OTHERWISE;

  EXECUTE FUNCTION(Val Order Ln#/Prod EDI RT) TYPE(RTVOBJ) FILE(OPBGWKP)          AC2142776;
  PARAMETER(PAR.Company_Number);
  PARAMETER(PAR.Order_Number);
  PARAMETER(LCL.Order_Sequence_Number);
  PARAMETER(LCL.Item_Code);
  PARAMETER(PAR.EDI_Error_Reason);
  {
   //?USER: Initialize routine

   // PAR.EDI-Error Reason = CND.Not Entered
   PAR.EDI_Error_Reason = *BLANK;

   //?USER: Processing if Data record not found

   // PAR.EDI-Error Reason = CND.Order Dtl Not Found
   PAR.EDI_Error_Reason = 'ORDTN';

   //?USER: Process Data record

   CASE;

   // IF DB1.Detail Line Status is Not cancelled
   IF DB1.Detail_Line_Status = 'L'/'A'/'C'/'R'/'E'/'H'/'I';

   // AND DB1.Item Code EQ PAR.Item Code
   AND DB1.Item_Code = PAR.Item_Code;

   // IF *OTHERWISE
   IF *OTHERWISE;

   // PAR.EDI-Error Reason = CND.Order Dtl Error
   PAR.EDI_Error_Reason = 'ORDTE';

   ENDIF;

  }

  //?Quit If Error.
  CASE;

  // IF NOT PAR.EDI-Error Reason is Not Entered
  IF ! PAR.EDI_Error_Reason = *BLANK;

  QUIT;

  ENDIF;

  ENDIF;

  //?Validate Order Line# & Product Exist.
  // IF *OTHERWISE
  IF *OTHERWISE;

  // PAR.EDI-Error Reason = CND.Order Dtl Not Found
  PAR.EDI_Error_Reason = 'ORDTN';

  QUIT;

  ENDIF;

  //?SR10092 DN 03/05/24-Validate Production Date is a Valid Date.
  CASE;

  // IF DB1.W1209 Warehouse Lot Nbr is Entered
  IF DB1.W1209_Warehouse_Lot_Nbr > *BLANK;

  //?Expecting 'W1209 Warehouse Lot Nbr' is in MMDDYY format.
  // Execute function EUS TrimL Production DtUS.
  EXECUTE FUNCTION(EUS TrimL Production DtUS) TYPE(EXCUSRSRC) ('PVDYUFR');
  PARAMETER(DB1.W1209_Warehouse_Lot_Nbr);
  PARAMETER(LCL.Production_Date_MMDDYY_U);
  {
   * Trim Left W1209 Warehouse Lot Nbr (Production Date).
   c                   eval      #OW3U1 = %triml(#IX5T1)
   *
  }

  // Execute function Val Numeric Digit     US.
  EXECUTE FUNCTION(Val Numeric Digit     US) TYPE(EXCUSRSRC) ('PUD6UFR');
  PARAMETER(LCL.Production_Date_MMDDYY_U);
  PARAMETER(LCL.Validation_Pass_USR);
  {
   *
   c                   Monitor
   *
   c                   If        %check(digits : %trim(#IA2T1)) = 0
   * All Digit, Validation Pass.
   c                   eval      #OFASC = 'Y'
   c                   else
   * Non-Digit Found, Validation Fail.
   c                   eval      #OFASC = 'N'
   c                   endif
   *
   * Monitor Message RNX0105 - 'A character representation of a numeric value is in error.
   c                   On-Error  00105                                        Do Nothing
   *
   c                   EndMon
   *
  }

  //?Validate Production Date is a Valid Date.
  CASE;

  // IF LCL.Validation Pass USR is Yes
  IF LCL.Validation_Pass_USR = 'Y';

  // Execute function EUS Val Prod Dte *MDY US.
  EXECUTE FUNCTION(EUS Val Prod Dte *MDY US) TYPE(EXCUSRSRC) ('PVDZUFR');
  PARAMETER(LCL.Production_Date_MMDDYY_U);
  PARAMETER(LCL.Validation_Pass_USR);
  {
   * Check Production Date is a Valid Date.
   d wkmmddyy        S              6A
   *
   c                   eval      #OFASC = 'Y'
   c                   eval      wkmmddyy = %char(#IW3U1)                     Convert to Charc.
   /free
   test(de) *mdy0 wkmmddyy ;
   if %error() ;
   #OFASC = 'N' ;  // Invalid Date
   endif ;
   /end-free
   *
  }

  //?Invalid Date.
  CASE;

  // IF LCL.Validation Pass USR is No
  IF LCL.Validation_Pass_USR = 'N';

  // PAR.EDI-Error Reason = CND.Invalid Production Date
  PAR.EDI_Error_Reason = 'PRDDT';

  QUIT;

  ENDIF;

  //?Validate Production Date is a Valid Date.
  // IF *OTHERWISE
  IF *OTHERWISE;

  // PAR.EDI-Error Reason = CND.Invalid Production Date
  PAR.EDI_Error_Reason = 'PRDDT';

  QUIT;

  ENDIF;

  ENDIF;

 }

 ENDIF;

 //?If Not in Error, Check Pallet ID.
 CASE;

 // IF PAR.EDI-Error Reason is Not Entered
 IF PAR.EDI_Error_Reason = *BLANK;

 //?Don't validate Pallet ID.
 //?If Pallet ID is blank or non-numeric, set Pallet to blank & allow
 //?to create the Manifest Detail record.
 //?WI609_2 JM 10/08/24-Validate the SSCC Pallet ID is valid for NorAm 3PL
 CASE;

 // IF *OTHERWISE
 IF *OTHERWISE;

 EXECUTE FUNCTION(RTV Get 856 ASN for 3PLRT) TYPE(RTVOBJ) FILE(CAADREP)          AC2235035;
 PARAMETER(LCL.Warehouse_Code);
 PARAMETER(LCL.Crt_856_ASN_for_3PL_Whse);
 {
  //?USER: Initialize routine

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 //?Crt 856 ASN for 3PL Whse is Yes
 CASE;

 // IF LCL.Crt 856 ASN for 3PL Whse is Yes
 IF LCL.Crt_856_ASN_for_3PL_Whse = 'Y';

 EXECUTE FUNCTION(Rtv WHS Interchg All  RT) TYPE(RTVOBJ) FILE(PNG0REP)           AC2138766;
 PARAMETER(LCL.Warehouse_Code);
 PARAMETER('WHSADV');
 PARAMETER(NLL.Class_Code);
 PARAMETER(LCL.EDI_Trading_Partner_No);
 PARAMETER(NLL.EDI_Whs_Duns_Number);
 PARAMETER(NLL.Record_Status);
 PARAMETER(NLL.Create_Date);
 PARAMETER(NLL.Create_Time);
 PARAMETER(NLL.Create_User);
 PARAMETER(NLL.Create_Program);
 PARAMETER(NLL.Change_Date);
 PARAMETER(NLL.Change_Time);
 PARAMETER(LCL.Change_User);
 PARAMETER(LCL.Change_Program);
 {
  //?USER: Initialize routine

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 EXECUTE FUNCTION(RTV Get SSCC Pallet ID RT) TYPE(RTVOBJ) FILE(PVCKREP)          AC2235047;
 PARAMETER(LCL.EDI_Trading_Partner_No);
 PARAMETER(LCL.ESEND_Distribution_List);
 PARAMETER(LCL.Check_SSCC_Pallet_ID);
 PARAMETER(LCL.Record_Status);
 {
  //?USER: Initialize routine

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 //?Check SSCC Pallet ID is Yes
 CASE;

 // IF LCL.Check SSCC Pallet ID is Yes
 IF LCL.Check_SSCC_Pallet_ID = 'Y';

 // AND LCL.Record Status is Active
 AND LCL.Record_Status = 'A';

 EXECUTE FUNCTION(Val SSCC Pallet 4/945 RT) TYPE(RTVOBJ) FILE(ECP055)            AC2235048;
 PARAMETER(DB1.EDI_SURROGATE_NUMBER);
 PARAMETER(LCL.SSCC_Pallet_ID_Valid_USR);
 {
  //?USER: Initialize routine

  // PAR.SSCC Pallet ID Valid USR = CND.No
  PAR.SSCC_Pallet_ID_Valid_USR = 'N';

  //?USER: Process Data record

  CASE;

  // IF DB1.MAN02 Pallet Nb/Container is Entered
  IF DB1.MAN02_Pallet_Nb_Container <> *BLANK;

  // LCL.USR MAN02 Pallet Nbr Char = CND.Blank
  LCL.USR_MAN02_Pallet_Nbr_Char = *BLANK;

  // LCL.EDI unused text 30 = CON.*BLANK
  LCL.EDI_unused_text_30 = *BLANK;

  // LCL.USR MAN02 Pallet Nbr Char = SUBSTRING(DB1.MAN02 Pallet Nb/Container,CON.1,CON.20)
  LCL.USR_MAN02_Pallet_Nbr_Char = SUBSTRING(DB1.MAN02_Pallet_Nb_Container:1:20);

  // LCL.EDI unused text 30 = SUBSTRING(DB1.MAN02 Pallet Nb/Container,CON.21,CON.28)
  LCL.EDI_unused_text_30 = SUBSTRING(DB1.MAN02_Pallet_Nb_Container:21:28);

  CASE;

  // IF LCL.EDI unused text 30 is Entered
  IF LCL.EDI_unused_text_30 <> *BLANK;

  // PAR.SSCC Pallet ID Valid USR = CND.No
  PAR.SSCC_Pallet_ID_Valid_USR = 'N';

  QUIT;

  // IF *OTHERWISE
  IF *OTHERWISE;

  // Execute function RPG TESTN for digits.
  EXECUTE FUNCTION(RPG TESTN for digits) TYPE(EXCUSRSRC) ('PVHQUFR');
  PARAMETER(LCL.USR_MAN02_Pallet_Nbr_Char);
  PARAMETER(LCL.USR_Digit_Is_Valid);
  {
   ‚* WI609_2 JM 10/11/2024 - Added user source to check Digit
   C                   Eval      *In52 = *Off
   C                   TestN                   #BXXU1               52
   C                   Eval      #OQMSC = 'N'
   C                   If        *In52 = *On
   ‚* WI609_2 JM 10/11/2024 - All 20 digits should be present.
   ‚*                         1st 2 digits should be zero.
   C                   If        %Subst(#BXXU1:1:2) = '00'
   C                   Eval      #OQMSC = 'Y'
   C                   EndIf
   C                   EndIf
  }

  //?Check if Pallet ID is valid
  CASE;

  // IF LCL.USR Digit Is Valid is Yes
  IF LCL.USR_Digit_Is_Valid = 'Y';

  // LCL.SSCC Pallet ID Valid USR = CND.Yes
  LCL.SSCC_Pallet_ID_Valid_USR = 'Y';

  //?Check if Pallet ID is valid
  // IF *OTHERWISE
  IF *OTHERWISE;

  // PAR.SSCC Pallet ID Valid USR = CND.No
  PAR.SSCC_Pallet_ID_Valid_USR = 'N';

  QUIT;

  ENDIF;

  // PAR.SSCC Pallet ID Valid USR = LCL.SSCC Pallet ID Valid USR
  PAR.SSCC_Pallet_ID_Valid_USR = LCL.SSCC_Pallet_ID_Valid_USR;

  ENDIF;

  // IF *OTHERWISE
  IF *OTHERWISE;

  // PAR.SSCC Pallet ID Valid USR = CND.No
  PAR.SSCC_Pallet_ID_Valid_USR = 'N';

  QUIT;

  ENDIF;

 }

 // PAR.SSCC Pallet ID Valid USR = LCL.SSCC Pallet ID Valid USR
 PAR.SSCC_Pallet_ID_Valid_USR = LCL.SSCC_Pallet_ID_Valid_USR;

 //?Update the Order Header Extension file if SSCC Pallet ID Valid USR = No
 CASE;

 // IF LCL.SSCC Pallet ID Valid USR is No
 IF LCL.SSCC_Pallet_ID_Valid_USR = 'N';

 // LCL.SSCC Pallet ID Err Found = CND.Yes
 LCL.SSCC_Pallet_ID_Err_Found = 'Y';

 //?WI609_2 JM 12/26/24-Update lowest 1st time error surrogate.
 CASE;

 // IF LCL.EDI SURROGATE NUMBER USR is Not Entered
 IF LCL.EDI_SURROGATE_NUMBER_USR = *ZERO;

 // LCL.EDI SURROGATE NUMBER USR = DB1.EDI SURROGATE NUMBER
 LCL.EDI_SURROGATE_NUMBER_USR = DB1.EDI_SURROGATE_NUMBER;

 ENDIF;

 EXECUTE FUNCTION(Upd OHE EDI 945 Action RT) TYPE(RTVOBJ) FILE(PMAMREP)          AC2142925;
 PARAMETER(LCL.Company_Number);
 PARAMETER(DB1.W0602_Depositor_Order_Nbr);
 PARAMETER('SSCID');
 PARAMETER('R');
 PARAMETER(LCL.Load_ID);
 PARAMETER(LCL.EDI_945_Shipng_AdvHdr_Dte);
 {
  //?USER: Processing if Data record not found

  EXECUTE FUNCTION(CRT OHE EDI 945 Action CR) TYPE(CRTOBJ) FILE(PMAMREP)          AC2142926;
  PARAMETER(PAR.Company_Number);
  PARAMETER(PAR.Order_Number);
  PARAMETER(PAR.Load_ID);
  PARAMETER(PAR.Actual_Shipped_Date);
  PARAMETER(PAR.OHE_EDI_Error_Reasons);
  PARAMETER(PAR.OHE_EDI_945_Action);
  {
   //?USER: Processing before Data update

   // DB1.Record Status = CND.Active
   DB1.Record_Status = 'A';

   // DB1.Job Time = JOB.*Job time
   DB1.Job_Time = JOB.*Job_time;

   // DB1.Job Date = JOB.*Job date
   DB1.Job_Date = JOB.*Job_date;

   // DB1.Job Name = JOB.*PROGRAM
   DB1.Job_Name = JOB.*PROGRAM;

   // DB1.User Id = JOB.*USER
   DB1.User_Id = JOB.*USER;

  }

  //?USER: Process Data record

  EXECUTE FUNCTION(CHG OHE EDI 945 Action CH) TYPE(CHGOBJ) FILE(PMAMREP)          AC2142924;
  PARAMETER(DB1.Company_Number);
  PARAMETER(DB1.Order_Number);
  PARAMETER(PAR.OHE_EDI_Error_Reasons);
  PARAMETER(PAR.OHE_EDI_945_Action);
  {
   //?USER: Processing before Data update

   // DB1.Job Time = JOB.*Job time
   DB1.Job_Time = JOB.*Job_time;

   // DB1.Job Date = JOB.*Job date
   DB1.Job_Date = JOB.*Job_date;

   // DB1.Job Name = JOB.*PROGRAM
   DB1.Job_Name = JOB.*PROGRAM;

   // DB1.User Id = JOB.*USER
   DB1.User_Id = JOB.*USER;

  }

 }

 ENDIF;

 //?Check SSCC Pallet ID is Yes
 // IF *OTHERWISE
 IF *OTHERWISE;

 // LCL.SSCC Pallet ID Valid USR = CND.Not Entered
 LCL.SSCC_Pallet_ID_Valid_USR = *BLANK;

 // PAR.SSCC Pallet ID Valid USR = LCL.SSCC Pallet ID Valid USR
 PAR.SSCC_Pallet_ID_Valid_USR = LCL.SSCC_Pallet_ID_Valid_USR;

 ENDIF;

 ENDIF;

 ENDIF;

 ENDIF;

 //?Validate OD for Close order only -- not for a pick sts
 // IF *OTHERWISE
 IF *OTHERWISE;

 // PAR.EDI-Error Reason = CND.Order Sts-EDI
 PAR.EDI_Error_Reason = 'ORDED';

 ENDIF;

 ENDIF;

 ENDIF;

 //?All Validations Passed, Ship the Order Else Update Error in EDI HDR.
 CASE;

 // IF PAR.EDI-Error Reason is Not Entered
 IF PAR.EDI_Error_Reason = *BLANK;

 CASE;

 // IF DB1.N902 Order Status is Closed Order
 IF DB1.N902_Order_Status = 'CO';

 //?** Mark as Picked first
 EXECUTE FUNCTION(RTV Check Pick Event   RT) TYPE(RTVOBJ) FILE(OPEYCPP)          AC1198676;
 PARAMETER(LCL.Company_Number);
 PARAMETER(DB1.W0602_Depositor_Order_Nbr);
 PARAMETER('03');
 {
  //?USER: Processing if Data record not found

  // PGM.*Return code = CND.*Record does not exist
  PGM.*Return_code = 'Y2U0005';

  //?USER: Process Data record

  // PGM.*Return code = CND.*Normal
  PGM.*Return_code = *BLANK;

  QUIT;

 }

 //?Create Pick event if not there
 CASE;

 // IF PGM.*Return code is *Record does not exist
 IF PGM.*Return_code = 'Y2U0005';

 // PGM.*Return code = CND.*Normal
 PGM.*Return_code = *BLANK;

 EXECUTE FUNCTION(RTV Next Event Number  RT) TYPE(RTVOBJ) FILE(OPEYCPP)          AC1306444;
 PARAMETER(LCL.Company_Number);
 PARAMETER(DB1.W0602_Depositor_Order_Nbr);
 PARAMETER(PAR.Event_Number);
 {
  //?USER: Processing if Data record not found

  // PAR.Event Number = CON.1
  PAR.Event_Number = 1;

  //?USER: Process Data record

  // PAR.Event Number = DB1.Event Number
  PAR.Event_Number = DB1.Event_Number;

 }

 EXECUTE FUNCTION(CRT Create Pick Event  RT) TYPE(RTVOBJ) FILE(OPEYCPP)          AC1198687;
 PARAMETER(LCL.Company_Number);
 PARAMETER(DB1.W0602_Depositor_Order_Nbr);
 PARAMETER(PAR.Event_Number);
 {
  //?USER: Process Data record

  // WRK.Event Number = DB1.Event Number + CON.1
  WRK.Event_Number = DB1.Event_Number + 1;

  EXECUTE FUNCTION(CRT OP Order Events    CR) TYPE(CRTOBJ) FILE(OPEYCPP)          AC1170141;
  PARAMETER(DB1.Company_Number);
  PARAMETER(DB1.Order_Number);
  PARAMETER(WRK.Event_Number);
  PARAMETER('03');
  PARAMETER(DB1.Invoice_Memo_Company);
  PARAMETER(DB1.Invoice_Memo_Number);
  PARAMETER(DB1.Invoice_Memo_Suffix);
  PARAMETER(JOB.*Job_date);
  PARAMETER(DB1.Activity_Completion);
  PARAMETER(DB1.Activity_Hold);
  PARAMETER(DB1.Post_Cash_Complete);
  PARAMETER(DB1.Cross_Event_Ref_Comp);
  PARAMETER(DB1.Cross_Event_Ref_Order);
  PARAMETER(DB1.Cross_Event_Ref_Event);
  PARAMETER(DB1.Ship_To_Customer);
  {
   //?USER: Processing before Data update

   EXECUTE FUNCTION(Set Date/Time Stamp   IF) TYPE(EXCINTFUN)                      AC1142219;
   PARAMETER(DB1.Job_Time);
   PARAMETER(DB1.User_Id);
   PARAMETER(DB1.Job_Name);
   PARAMETER(DB1.Job_Date);
   {
    //?Execute internal function

    // PAR.Job Time = JOB.*Job time
    PAR.Job_Time = JOB.*Job_time;

    // PAR.User Id = JOB.*USER
    PAR.User_Id = JOB.*USER;

    // PAR.Job Name = JOB.*JOB
    PAR.Job_Name = JOB.*JOB;

    // PAR.Job Date = JOB.*Job date
    PAR.Job_Date = JOB.*Job_date;

   }

  }

  QUIT;

 }

 //?UPD:  Order Header Event Code
 CASE;

 // IF PAR.Event Code is Open Orders
 IF PAR.Event_Code < '04';

 EXECUTE FUNCTION(CHG Event Code    PFS RT) TYPE(RTVOBJ) FILE(OPBFCPP)           AC1735980;
 PARAMETER(LCL.Company_Number);
 PARAMETER(DB1.W0602_Depositor_Order_Nbr);
 PARAMETER('03');
 {
  //?USER: Process Data record

  EXECUTE FUNCTION(Chg Order Event        CH) TYPE(CHGOBJ) FILE(OPBFCPP)          AC1536110;
  PARAMETER(DB1.Company_Number);
  PARAMETER(DB1.Order_Number);
  PARAMETER(PAR.Event_Code);
  {
   //?USER: Processing before Data update

   EXECUTE FUNCTION(Set Date/Time Stamp.PgmIF) TYPE(EXCINTFUN)                     AC1425284;
   PARAMETER(DB1.Job_Time);
   PARAMETER(DB1.User_Id);
   PARAMETER(DB1.Job_Name);
   PARAMETER(DB1.Job_Date);
   {
    //?Execute internal function

    // PAR.Job Time = JOB.*Job time
    PAR.Job_Time = JOB.*Job_time;

    // PAR.User Id = JOB.*USER
    PAR.User_Id = JOB.*USER;

    // PAR.Job Name = JOB.*PROGRAM
    PAR.Job_Name = JOB.*PROGRAM;

    // PAR.Job Date = JOB.*Job date
    PAR.Job_Date = JOB.*Job_date;

   }

   // Call program TRG Order Hdr CHG Trig XT.
   CALL PROGRAM(TRG Order Hdr CHG Trig XT) ('PDW9XFR');
   PARAMETER(DB1.Company_Number);
   PARAMETER(DB1.Order_Number);
   PARAMETER(DB1.Order_Type_Sales);
   PARAMETER(DB1.AR_Customer_Number);
   PARAMETER(DB1.Ship_To_Customer);
   PARAMETER(DB1.Ship_To_Name);
   PARAMETER(DB1.Ship_To_Address_Line_1);
   PARAMETER(DB1.Ship_To_Address_Line_2);
   PARAMETER(DB1.Ship_To_Address_Line_3);
   PARAMETER(DB1.Ship_To_City);
   PARAMETER(DB1.Ship_To_State_Code);
   PARAMETER(DB1.Ship_To_Zip_Postal_Code);
   PARAMETER(DB1.Bill_to_Customer);
   PARAMETER(DB1.Bill_to_Name);
   PARAMETER(DB1.Bill_to_Address_Line_1);
   PARAMETER(DB1.Bill_to_Address_Line_2);
   PARAMETER(DB1.Bill_to_Address_Line_3);
   PARAMETER(DB1.Bill_to_City);
   PARAMETER(DB1.Bill_to_State_Code);
   PARAMETER(DB1.Bill_to_Zip_Postal_Code);
   PARAMETER(DB1.Customer_Purchase_Order_#);
   PARAMETER(DB1.Order_Date);
   PARAMETER(DB1.Requested_Ship_Date);
   PARAMETER(DB1.Actual_Shipped_Date);
   PARAMETER(DB1.Cancel_Date);
   PARAMETER(DB1.Terms_Code);
   PARAMETER(DB1.Special_Instructions);
   PARAMETER(DB1.Special_Instructions_2);
   PARAMETER(DB1.Carrier_Code);
   PARAMETER(DB1.Comment_Print_Acknowledge);
   PARAMETER(DB1.Comment_Print_Inv_Cr_Memo);
   PARAMETER(DB1.Comment_Print_Pick_Slip);
   PARAMETER(DB1.Comment_Print_Ship_Doc);
   PARAMETER(DB1.Reason_Code);
   PARAMETER(DB1.Order_in_Use);
   PARAMETER(DB1.Header_Status);
   PARAMETER(DB1.Header_Status_Last);
   PARAMETER(DB1.Order_Type_Print_Status);
   PARAMETER(DB1.Scheduled_Ship_Date);
   PARAMETER(DB1.User_Original_Entry);
   PARAMETER(DB1.Date_of_Original_Entry);
   PARAMETER(DB1.Order_Value_Total);
   PARAMETER(DB1.Order_Weight_Total);
   PARAMETER(DB1.Credit_Hold);
   PARAMETER(DB1.Production_Hold);
   PARAMETER(DB1.New_Customer_Hold);
   PARAMETER(DB1.Requested_Delivery_Date);
   PARAMETER(DB1.Requested_Delivery_Time);
   PARAMETER(DB1.Accounts_Receiv_Ent_1);
   PARAMETER(DB1.Accounts_Receiv_Ent_2);
   PARAMETER(DB1.Load_ID);
   PARAMETER(DB1.Absorbed_Freight_Rate_CWT);
   PARAMETER(DB1.Rated_Freight);
   PARAMETER(DB1.LTL_Flag);
   PARAMETER(DB1.Price_Audit);
   PARAMETER(DB1.Price_Status);
   PARAMETER(DB1.Shipping_Method);
   PARAMETER(DB1.Export_Status);
   PARAMETER(DB1.Palletize);
   PARAMETER(DB1.Shrink_Wrap);
   PARAMETER(DB1.Slip_Sheet);
   PARAMETER(DB1.Age_Code);
   PARAMETER(DB1.Reefer_Temperature);
   PARAMETER(DB1.Load_Type);
   PARAMETER(DB1.Attach_to_Invoice_Number);
   PARAMETER(DB1.Load_Plan_Order);
   PARAMETER(DB1.Print_Pick_Slip);
   PARAMETER(DB1.Resell_Reference_Number);
   PARAMETER(DB1.Special_Comment_1);
   PARAMETER(DB1.Special_Comment_2);
   PARAMETER(DB1.Affect_Auto_Accruals);
   PARAMETER(DB1.Sales_Route_Code);
   PARAMETER(DB1.Manager_Level_Code);
   PARAMETER(DB1.VP_Level_Code);
   PARAMETER(DB1.Attach_to_Order_Number);
   PARAMETER(DB1.Reason_for_Price_Audit);
   PARAMETER(DB1.Invoice_Number);
   PARAMETER(DB1.Invoice_Suffix);
   PARAMETER(DB1.Invoice_Date);
   PARAMETER(DB1.Event_Code);
   PARAMETER(DB1.Trans_Contol_AS400_Plant);
   PARAMETER(DB1.Modified_Flag);
   PARAMETER(DB1.A_R_order_Value_Total);
   PARAMETER(DB1.Billing_Activity_Type);
   PARAMETER(DB1.Block_Order_Flag);
   PARAMETER(DB1.Order_Certification_Flag);
   PARAMETER(DB1.Invoice_Order_Value_Tot);
   PARAMETER(DB1.Process_Sts_for_3C);
   PARAMETER(DB1.Order_Conf_Fax_Sts);
   PARAMETER(DB1.Manifest_Fax_Sts);
   PARAMETER(DB1.Invoice_Fax_Sts);
   PARAMETER(DB1.Transfer_in_Storage_Ind);
   PARAMETER(DB1.Email_Cust_On_Order_Ship);
   PARAMETER(DB1.Order_Emailed);
   PARAMETER(DB1.Export_Docs_Go_w_Driver);
   PARAMETER(DB1.Shipping_Temp_Code_C_F);
   PARAMETER(DB1.Broker_Order_Status);
   PARAMETER(DB1.Air_Freight_Order);
   PARAMETER(DB1.Order_Requires_Review);
   PARAMETER(DB1.OH_Load_Plan_Ready);
   PARAMETER(DB1.Export_USDA_Approved);
   PARAMETER(DB1.HPB_Ship_to_Warehouse);
   PARAMETER(DB1.OH_TF_Exempt_Code);
   PARAMETER(DB1.OH_Appt_Confirmation_Dt);
   PARAMETER(DB1.JPN_Invoice_Issuance_Date);
   PARAMETER(DB1.Load_Actual_Shipped_Date);
   PARAMETER(DB1.Load_BOL_Complete_Date);
   PARAMETER(DB1.Load_Truck_Departure_Date);
   PARAMETER(DB1.Maximum_Gross_Weight);
   PARAMETER(DB1.Time_of_Original_Entry);
   PARAMETER(DB1.OH_Appt_Confirmation_Tm);
   PARAMETER(DB1.Load_BOL_Complete_Time);
   PARAMETER(DB1.Load_Truck_Departure_Time);
   PARAMETER(DB1.Act_Frt_Reference_Amount);
   PARAMETER(DB1.Act_Non_Ref_Frt_Amount);
   PARAMETER(DB1.OH_Fuel_Surcharge_Amount);
   PARAMETER(DB1.OH_Total_Non_Ref_Frt_Amt);
   PARAMETER(DB1.OH_Total_Ref_Frt_Amt);
   PARAMETER(DB1.Claim_Number);
   PARAMETER(DB1.EDI_Status_1);
   PARAMETER(DB1.EDI_Status_2);
   PARAMETER(DB1.EDI_Status_3);
   PARAMETER(DB1.Job_Time);
   PARAMETER(DB1.User_Id);
   PARAMETER(DB1.Job_Name);
   PARAMETER(DB1.Job_Date);

  }

 }

 //?S00930 RMC 9/02/09 Crt chg log rcd for pick event
 // Call program CRT Load/Order Chg Log XF.
 CALL PROGRAM(CRT Load/Order Chg Log XF) ('PDADXFR');
 PARAMETER(LCL.Load_ID);
 PARAMETER(*ZERO);
 PARAMETER('PCKPRC');
 PARAMETER('SHP');
 PARAMETER(02);
 PARAMETER(03);
 PARAMETER(JOB.*USER);
 PARAMETER(JOB.*PROGRAM);
 PARAMETER(LCL.Carrier_Code);
 PARAMETER(LCL.Company_Number);
 PARAMETER(DB1.W0602_Depositor_Order_Nbr);

 ENDIF;

 ENDIF;

 //?** Process Close order
 EXECUTE FUNCTION(Crt Manifest Dtl fm EDIRT) TYPE(RTVOBJ) FILE(ECP058)           AC2142909;
 PARAMETER(DB1.EDI_SURROGATE_NUMBER);
 PARAMETER(LCL.Company_Number);
 PARAMETER(DB1.W0602_Depositor_Order_Nbr);
 PARAMETER(LCL.SSCC_Pallet_ID_Valid_USR);
 {
  //?USER: Initialize routine

  // LCL.Case Sequence Number = CON.*ZERO
  LCL.Case_Sequence_Number = 0;

  //?USER: Process Data record

  CASE;

  // IF DB1.W1208 Prod ID Code is Entered
  IF DB1.W1208_Prod_ID_Code <> *BLANK;

  // AND DB1.W1218 Ord Line Num is Entered
  AND DB1.W1218_Ord_Line_Num <> *BLANK;

  // AND DB1.W1203 Quantity Shipped is Greater than/equal 1
  AND DB1.W1203_Quantity_Shipped >= 1;

  //?also check quantity shipped>0
  //?Format / Populate Data.
  CASE;

  // IF *OTHERWISE
  IF *OTHERWISE;

  // Execute function EUS TrimL Order Line#  US.
  EXECUTE FUNCTION(EUS TrimL Order Line#  US) TYPE(EXCUSRSRC) ('PUEPUFR');
  PARAMETER(DB1.W1218_Ord_Line_Num);
  PARAMETER(LCL.Order_Sequence_Nbr_TXT);
  {
   * Trim Left Order Line Number.
   c                   eval      #OH5U1 = %triml(#IUCNY)
   *
  }

  // Execute function Cvt Order Line to Nbr  US.
  EXECUTE FUNCTION(Cvt Order Line to Nbr  US) TYPE(EXCUSRSRC) ('PUEUUFR');
  PARAMETER(LCL.Order_Sequence_Nbr_TXT);
  PARAMETER(PAR.Order_Sequence_Number);
  {
   * Trim Order Line # and Convert to Numeric.
   c                   eval      #ODPNB = %dec(%trim(#IH5U1) : 3:0)
   *
  }

  // PAR.Order Secondary Line Seq = CON.1
  PAR.Order_Secondary_Line_Seq = 1;

  // Execute function EUS TrimL Prod ID Code US.
  EXECUTE FUNCTION(EUS TrimL Prod ID Code US) TYPE(EXCUSRSRC) ('PUEOUFR');
  PARAMETER(DB1.W1208_Prod_ID_Code);
  PARAMETER(LCL.Item_Code_Txt);
  {
   * Trim Left Product ID.
   c                   eval      #OFYTX = %triml(#IFIC7)
   *
  }

  // Execute function Cvt Item Code to Nbr   US.
  EXECUTE FUNCTION(Cvt Item Code to Nbr   US) TYPE(EXCUSRSRC) ('PUETUFR');
  PARAMETER(LCL.Item_Code_Txt);
  PARAMETER(LCL.Item_Code);
  {
   * Trim Item Code and Convert to Numeric.
   c                   eval      #OHGCD = %dec(%trim(#IFYTX) : 7:0)
   *
  }

  //?Extract Pallet Number
  CASE;

  // IF *OTHERWISE
  IF *OTHERWISE;

  //?Get Pallet Number from EDI WHS Shipping Adv MAN (ECP055) file.
  //? qlfr = GM
  //?Pallet # will be set to 0 if Pallet is blank or non-numeric.
  // LCL.Manifest Pallet Number = CON.*ZERO
  LCL.Manifest_Pallet_Number = *ZERO;

  // LCL.Pallet ID USR = CON.*BLANK
  LCL.Pallet_ID_USR = *BLANK;

  EXECUTE FUNCTION(Rtv Pallet Number     RT) TYPE(RTVOBJ) FILE(ECP055)            AC2149230;
  PARAMETER(DB1.EDI_SURROGATE_NUMBER);
  PARAMETER(DB1.LX01_Sequence_Number);
  PARAMETER(LCL.MAN02_Pallet_Nb_Container);
  {
   //?USER: Processing if Data record not found

   MOVE *ALL (To: PAR From: CON);

   //?USER: Process Data record

   MOVE *ALL (To: PAR From: DB1);

  }

  // LCL.W0407 Pallet Number Txt U = LCL.MAN02 Pallet Nb/Container
  LCL.W0407_Pallet_Number_Txt_U = LCL.MAN02_Pallet_Nb_Container;

  CASE;

  // IF LCL.W0407 Pallet Number Txt U is Entered
  IF LCL.W0407_Pallet_Number_Txt_U <> *BLANK;

  // Execute function EUS TrimL Pallet ID    US.
  EXECUTE FUNCTION(EUS TrimL Pallet ID    US) TYPE(EXCUSRSRC) ('PUG4UFR');
  PARAMETER(LCL.W0407_Pallet_Number_Txt_U);
  PARAMETER(LCL.Pallet_ID_USR);
  {
   * Trim Left & Substring Out the Pallet ID.
   c                   eval      #OH3U1 = %subst(%triml(#IJHU1):11:9)
   *
  }

  ENDIF;

  CASE;

  // IF LCL.Pallet ID USR is NE Blanks
  IF LCL.Pallet_ID_USR <> *BLANK;

  // Execute function Val Numeric Digit     US.
  EXECUTE FUNCTION(Val Numeric Digit     US) TYPE(EXCUSRSRC) ('PUD6UFR');
  PARAMETER(LCL.Pallet_ID_USR);
  PARAMETER(LCL.Validation_Pass_USR);
  {
   *
   c                   Monitor
   *
   c                   If        %check(digits : %trim(#IA2T1)) = 0
   * All Digit, Validation Pass.
   c                   eval      #OFASC = 'Y'
   c                   else
   * Non-Digit Found, Validation Fail.
   c                   eval      #OFASC = 'N'
   c                   endif
   *
   * Monitor Message RNX0105 - 'A character representation of a numeric value is in error.
   c                   On-Error  00105                                        Do Nothing
   *
   c                   EndMon
   *
  }

  CASE;

  // IF LCL.Validation Pass USR is Yes
  IF LCL.Validation_Pass_USR = 'Y';

  // Execute function Cvt Pallet ID to Nbr   US.
  EXECUTE FUNCTION(Cvt Pallet ID to Nbr   US) TYPE(EXCUSRSRC) ('PUFBUFR');
  PARAMETER(LCL.Pallet_ID_USR);
  PARAMETER(LCL.Manifest_Pallet_Number);
  {
   * Trim Pallet ID and Convert to Numeric.
   c                   eval      #OH7NY = %dec(%trim(#IH3U1) : 9:0)
   *
  }

  ENDIF;

  ENDIF;

  //?WI609_2 JM 11/21/24-get Manifest Pallet Nbr 3PL
  CASE;

  // IF LCL.W0407 Pallet Number Txt U is Entered
  IF LCL.W0407_Pallet_Number_Txt_U <> *BLANK;

  // AND PAR.SSCC Pallet ID Valid USR is Yes
  AND PAR.SSCC_Pallet_ID_Valid_USR = 'Y';

  // LCL.Manifest Pallet Nbr 3PL = CVTVAR(LCL.W0407 Pallet Number Txt U)
  LCL.Manifest_Pallet_Nbr_3PL = CVTVAR(LCL.W0407_Pallet_Number_Txt_U);

  //?WI609_2 JM 11/21/24-get Manifest Pallet Nbr 3PL
  // IF *OTHERWISE
  IF *OTHERWISE;

  // LCL.Manifest Pallet Nbr 3PL = CND.Zero
  LCL.Manifest_Pallet_Nbr_3PL = *ZERO;

  ENDIF;

  ENDIF;

  EXECUTE FUNCTION(RTV Whse/Non Cancelled RT) TYPE(RTVOBJ) FILE(OPBGWKP)          AC1428700;
  PARAMETER(PAR.Company_Number);
  PARAMETER(PAR.Order_Number);
  PARAMETER(1);
  PARAMETER(1);
  PARAMETER(LCL.Warehouse_Code);
  {
   //?USER: Processing if Data record not found

   MOVE *ALL (To: PAR From: CON);

   //?USER: Process Data record

   //?C2748:  Changed RTV Warehouse Code RT to exclude Cancelled lines.
   CASE;

   // IF DB1.Detail Line Status is Cancelled
   IF DB1.Detail_Line_Status = 'X';

   // IF *OTHERWISE
   IF *OTHERWISE;

   MOVE *ALL (To: PAR From: DB1);

   QUIT;

   ENDIF;

  }

  EXECUTE FUNCTION(Rtv Last Ord/Case Seq  RT) TYPE(RTVOBJ) FILE(OMFNCPP)          AC1368391;
  PARAMETER(PAR.Company_Number);
  PARAMETER(PAR.Order_Number);
  PARAMETER(PAR.Order_Sequence_Number);
  PARAMETER(PAR.Order_Secondary_Line_Seq);
  PARAMETER(PAR.Case_Sequence_Number);
  {
   //?USER: Processing if Data record not found

   // PAR.Case Sequence Number = CON.*ZERO
   PAR.Case_Sequence_Number = 0;

   //?USER: Process Data record

   // PAR.Case Sequence Number = DB1.Case Sequence Number
   PAR.Case_Sequence_Number = DB1.Case_Sequence_Number;

   QUIT;

  }

  ENDIF;

  EXECUTE FUNCTION(Rtv Crt Manif Dtl 945  RT) TYPE(RTVOBJ) FILE(ECP056)           AC2154177;
  PARAMETER(DB1.EDI_SURROGATE_NUMBER);
  PARAMETER(DB1.LX01_Sequence_Number);
  PARAMETER(DB1.EDI_Pallet_Sequence_Nbr);
  PARAMETER(PAR.Company_Number);
  PARAMETER(PAR.Order_Number);
  PARAMETER(PAR.Order_Sequence_Number);
  PARAMETER(PAR.Order_Secondary_Line_Seq);
  PARAMETER(PAR.Case_Sequence_Number);
  PARAMETER(LCL.Item_Code);
  PARAMETER(LCL.Warehouse_Code);
  PARAMETER(LCL.Manifest_Pallet_Number);
  PARAMETER(LCL.Manifest_Pallet_Nbr_3PL);
  {
   //?USER: Processing if Data record not found

   // PGM.*Return code = CND.*Record does not exist
   PGM.*Return_code = 'Y2U0005';

   //?USER: Process Data record

   CASE;

   // IF DB1.N0901 Reference ID Qlfr is SERIAL NUMBER  (Seal nbr)
   IF ( DB1.N0901_Reference_ID_Qlfr = 'SN';

   // OR DB1.N0901 Reference ID Qlfr is Serial Number  SE
   OR DB1.N0901_Reference_ID_Qlfr = 'SE' );

   // AND DB1.N0902 Reference ID is Entered
   AND DB1.N0902_Reference_ID <> *BLANK;

   //?RMC Use SE for Noram, CP sends SN, but it should be SE
   // Execute function Val Numeric Digit     US.
   EXECUTE FUNCTION(Val Numeric Digit     US) TYPE(EXCUSRSRC) ('PUD6UFR');
   PARAMETER(DB1.N0902_Reference_ID);
   PARAMETER(LCL.Validation_Pass_USR);
   {
    *
    c                   Monitor
    *
    c                   If        %check(digits : %trim(#IA2T1)) = 0
    * All Digit, Validation Pass.
    c                   eval      #OFASC = 'Y'
    c                   else
    * Non-Digit Found, Validation Fail.
    c                   eval      #OFASC = 'N'
    c                   endif
    *
    * Monitor Message RNX0105 - 'A character representation of a numeric value is in error.
    c                   On-Error  00105                                        Do Nothing
    *
    c                   EndMon
    *
   }

   //?R11331 DN 09/27/18-Set Serial# to 0 if Non-Numeric.
   CASE;

   // IF LCL.Validation Pass USR is Yes
   IF LCL.Validation_Pass_USR = 'Y';

   // Execute function EUS TrimL Serial Nbr   US.
   EXECUTE FUNCTION(EUS TrimL Serial Nbr   US) TYPE(EXCUSRSRC) ('PUERUFR');
   PARAMETER(DB1.N0902_Reference_ID);
   PARAMETER(LCL.PT_Serial_Number_Txt_USR);
   {
    * Trim Left Serial Number.
    c                   eval      #OH6U1 = %triml(#IHGU1)
    *
   }

   // LCL.PT Serial Number = CVTVAR(LCL.PT Serial Number Txt USR)
   LCL.PT_Serial_Number = CVTVAR(LCL.PT_Serial_Number_Txt_USR);

   //?R11331 DN 09/27/18-Set Serial# to 0 if Non-Numeric.
   // IF *OTHERWISE
   IF *OTHERWISE;

   // LCL.PT Serial Number = CON.*ZERO
   LCL.PT_Serial_Number = *ZERO;

   ENDIF;

   // PAR.Case Sequence Number = PAR.Case Sequence Number + CON.1
   PAR.Case_Sequence_Number = PAR.Case_Sequence_Number + 1;

   // LCL.Production Date USR D8# = DB1.N904 Production Date
   LCL.Production_Date_USR_D8# = DB1.N904_Production_Date;

   // LCL.Production Date = LCL.Production Date USR D8#
   LCL.Production_Date = LCL.Production_Date_USR_D8#;

   EXECUTE FUNCTION(Crt Manifest Dtl fm EDICR) TYPE(CRTOBJ) FILE(OMFNCPP)          AC2142920;
   PARAMETER(PAR.Company_Number);
   PARAMETER(PAR.Order_Number);
   PARAMETER(PAR.Order_Sequence_Number);
   PARAMETER(PAR.Order_Secondary_Line_Seq);
   PARAMETER(PAR.Case_Sequence_Number);
   PARAMETER(1);
   PARAMETER(DB1.N903_Reference_ID_Wgt);
   PARAMETER(*BLANK);
   PARAMETER(LCL.Production_Date);
   PARAMETER(LCL.PT_Serial_Number);
   PARAMETER(PAR.Item_Code);
   PARAMETER(PAR.Warehouse_Code);
   PARAMETER(LCL.Production_Date);
   PARAMETER(DB1.N903_Reference_ID_Wgt);
   PARAMETER(*BLANK);
   PARAMETER(*ZERO);
   PARAMETER(PAR.Manifest_Pallet_Number);
   PARAMETER(PAR.Manifest_Pallet_Nbr_3PL);
   {
    //?USER: Processing before Data update

    EXECUTE FUNCTION(SET Record Stamp CRTOB IF) TYPE(EXCINTFUN)                     AC1282865;
    PARAMETER(DB1.Record_Status);
    PARAMETER(DB1.Job_Time);
    PARAMETER(DB1.User_Id);
    PARAMETER(DB1.Job_Name);
    PARAMETER(DB1.Job_Date);
    {
     //?Execute internal function

     // PAR.Record Status = CND.Active
     PAR.Record_Status = 'A';

     // PAR.Job Time = JOB.*Job time
     PAR.Job_Time = JOB.*Job_time;

     // PAR.User Id = JOB.*USER
     PAR.User_Id = JOB.*USER;

     // PAR.Job Name = JOB.*PROGRAM
     PAR.Job_Name = JOB.*PROGRAM;

     // PAR.Job Date = JOB.*Job date
     PAR.Job_Date = JOB.*Job_date;

    }

   }

   ENDIF;

  }

  //?If REF doesnt exist, then it isnt a Catch Weight item, create manifest
  CASE;

  // IF PGM.*Return code is *Record does not exist
  IF PGM.*Return_code = 'Y2U0005';

  // PAR.Case Sequence Number = PAR.Case Sequence Number + CON.1
  PAR.Case_Sequence_Number = PAR.Case_Sequence_Number + 1;

  // LCL.Date (Char-6) USR = DB1.W1209 Warehouse Lot Nbr
  LCL.Date_Char_6_USR = DB1.W1209_Warehouse_Lot_Nbr;

  // Execute function *Move-Right RP4.
  EXECUTE FUNCTION(*Move-Right RP4) TYPE(EXCUSRSRC) ('PUI6UFR');
  PARAMETER(LCL.Text_1_Length_USR);
  PARAMETER(LCL.Date_Char_6_USR);
  {
   C                   MOVE      #IPANA        #OO9NA
  }

  CASE;

  // IF LCL.Text 1 Length USR is *Blank
  IF LCL.Text_1_Length_USR = *BLANK;

  // LCL.Text USR 5 = DB1.W1209 Warehouse Lot Nbr
  LCL.Text_USR_5 = DB1.W1209_Warehouse_Lot_Nbr;

  // LCL.Date (Char-6) USR = CONCAT(CON.0,LCL.Text USR 5,CON.*ZERO)
  LCL.Date_Char_6_USR = '0' + LCL.Text_USR_5 (*ZERO);

  ENDIF;

  // LCL.Month/Day Alpha MMDD = LCL.Date (Char-6) USR
  LCL.Month_Day_Alpha_MMDD = LCL.Date_Char_6_USR;

  // LCL.Year  (Char) USR = SUBSTRING(LCL.Date (Char-6) USR,CON.5,CON.2)
  LCL.Year_Char_USR = SUBSTRING(LCL.Date_Char_6_USR:5:2);

  // LCL.Text 3 Length USR = CONCAT(CON.1,LCL.Year  (Char) USR,CON.*ZERO)
  LCL.Text_3_Length_USR = '1' + LCL.Year_Char_USR (*ZERO);

  // LCL.Date (Alpha) USR = CONCAT(LCL.Text 3 Length USR,LCL.Month/Day Alpha MMDD,CON.*ZERO)
  LCL.Date_Alpha_USR = LCL.Text_3_Length_USR + LCL.Month_Day_Alpha_MMDD (*ZERO);

  // LCL.Production Date = CVTVAR(LCL.Date (Alpha) USR)
  LCL.Production_Date = CVTVAR(LCL.Date_Alpha_USR);

  EXECUTE FUNCTION(Crt Manifest Dtl fm EDICR) TYPE(CRTOBJ) FILE(OMFNCPP)          AC2142920;
  PARAMETER(PAR.Company_Number);
  PARAMETER(PAR.Order_Number);
  PARAMETER(PAR.Order_Sequence_Number);
  PARAMETER(PAR.Order_Secondary_Line_Seq);
  PARAMETER(PAR.Case_Sequence_Number);
  PARAMETER(DB1.W1203_Quantity_Shipped);
  PARAMETER(DB1.W1210_Weight_Net);
  PARAMETER(*BLANK);
  PARAMETER(LCL.Production_Date);
  PARAMETER(*ZERO);
  PARAMETER(LCL.Item_Code);
  PARAMETER(LCL.Warehouse_Code);
  PARAMETER(LCL.Production_Date);
  PARAMETER(DB1.W1213_Weight_Gross);
  PARAMETER(*BLANK);
  PARAMETER(*ZERO);
  PARAMETER(LCL.Manifest_Pallet_Number);
  PARAMETER(LCL.Manifest_Pallet_Nbr_3PL);
  {
   //?USER: Processing before Data update

   EXECUTE FUNCTION(SET Record Stamp CRTOB IF) TYPE(EXCINTFUN)                     AC1282865;
   PARAMETER(DB1.Record_Status);
   PARAMETER(DB1.Job_Time);
   PARAMETER(DB1.User_Id);
   PARAMETER(DB1.Job_Name);
   PARAMETER(DB1.Job_Date);
   {
    //?Execute internal function

    // PAR.Record Status = CND.Active
    PAR.Record_Status = 'A';

    // PAR.Job Time = JOB.*Job time
    PAR.Job_Time = JOB.*Job_time;

    // PAR.User Id = JOB.*USER
    PAR.User_Id = JOB.*USER;

    // PAR.Job Name = JOB.*PROGRAM
    PAR.Job_Name = JOB.*PROGRAM;

    // PAR.Job Date = JOB.*Job date
    PAR.Job_Date = JOB.*Job_date;

   }

  }

  ENDIF;

  ENDIF;

 }

 //?Update Total Shipped Quantity/Weight in Order Detail.
 //?  * Read 2 different access paths over Order Detail to call existing
 //?   'RTV Chg for Confirm    RT - Order Detail' function.
 EXECUTE FUNCTION(RTV Proc for Confirm   RT) TYPE(RTVOBJ) FILE(OPBGWKP)          AC2142929;
 PARAMETER(LCL.Company_Number);
 PARAMETER(DB1.W0602_Depositor_Order_Nbr);
 {
  //?USER: Process Data record

  CASE;

  // IF DB1.Detail Line Status is Not cancelled
  IF DB1.Detail_Line_Status = 'L'/'A'/'C'/'R'/'E'/'H'/'I';

  EXECUTE FUNCTION(RTV Chg for Confirm    RT) TYPE(RTVOBJ) FILE(OPBGWKP)          AC1310188;
  PARAMETER(DB1.Company_Number);
  PARAMETER(DB1.Order_Number);
  PARAMETER(DB1.Order_Sequence_Number);
  PARAMETER(DB1.Order_Secondary_Line_Seq);
  PARAMETER(DB1.Item_Code);
  PARAMETER(LCL.USR_Case_Quantity);
  PARAMETER(LCL.USR_Case_Weight);
  PARAMETER(LCL.USR_Under_Min);
  PARAMETER(LCL.USR_Over_Max);
  PARAMETER(LCL.USR_Exit_Program);
  {
   //?USER: Initialize routine

   // PAR.USR Exit Program = CND.yes
   PAR.USR_Exit_Program = 'Y';

   // PAR.USR Over Max = CND.no
   PAR.USR_Over_Max = 'N';

   // PAR.USR Under Min = CND.no
   PAR.USR_Under_Min = 'N';

   //?USER: Process Data record

   EXECUTE FUNCTION(RTV Total Confirmed    RT) TYPE(RTVOBJ) FILE(OMFNCPP)          AC1310317;
   PARAMETER(DB1.Company_Number);
   PARAMETER(DB1.Order_Number);
   PARAMETER(DB1.Order_Sequence_Number);
   PARAMETER(DB1.Order_Secondary_Line_Seq);
   PARAMETER(*ZERO);
   PARAMETER(PAR.USR_Case_Quantity);
   PARAMETER(PAR.USR_Case_Weight);
   PARAMETER(PAR.HPB_Meter_Net_Gallon);
   PARAMETER(PAR.HPB_Meter_Net_Weight);
   {
    //?USER: Initialize routine

    // PAR.USR Case Quantity = CND.EQ *ZERO
    PAR.USR_Case_Quantity = *ZERO;

    // PAR.USR Case Weight = CND.EQ *ZERO
    PAR.USR_Case_Weight = *ZERO;

    // PAR.HPB Meter Net Gallon = CND.Equal to zero
    PAR.HPB_Meter_Net_Gallon = *ZERO;

    // PAR.HPB Meter Net Weight = CND.Not Entered
    PAR.HPB_Meter_Net_Weight = *ZERO;

    //?USER: Processing if Data record not found

    // PGM.*Return code = CND.*Record does not exist
    PGM.*Return_code = 'Y2U0005';

    //?USER: Process Data record

    // PAR.USR Case Quantity = DB1.Case Quantity + PAR.USR Case Quantity
    PAR.USR_Case_Quantity = DB1.Case_Quantity + PAR.USR_Case_Quantity;

    // PAR.USR Case Weight = DB1.Case Weight + PAR.USR Case Weight
    PAR.USR_Case_Weight = DB1.Case_Weight + PAR.USR_Case_Weight;

    //?Only HPB will have these   4/14/08
    // PAR.HPB Meter Net Gallon = DB1.HPB Meter Net Gallon + PAR.HPB Meter Net Gallon
    PAR.HPB_Meter_Net_Gallon = DB1.HPB_Meter_Net_Gallon + PAR.HPB_Meter_Net_Gallon;

    // PAR.HPB Meter Net Weight = DB1.HPB Meter Net Weight + PAR.HPB Meter Net Weight
    PAR.HPB_Meter_Net_Weight = DB1.HPB_Meter_Net_Weight + PAR.HPB_Meter_Net_Weight;

   }

   //?Check min/max from the item master
   // PAR.USR Min Weight = CND.Not Entered
   PAR.USR_Min_Weight = *ZERO;

   // PAR.USR Max Weight = CND.Not Entered
   PAR.USR_Max_Weight = *ZERO;

   EXECUTE FUNCTION(RTV Qty Min/Max        RT) TYPE(RTVOBJ) FILE(CABZREP)          AC1402211;
   PARAMETER(PAR.Company_Number);
   PARAMETER(PAR.Item_Code);
   PARAMETER(PAR.Minimum_Weight_Per_Case);
   PARAMETER(PAR.Maximum_Weight_Per_Case);
   {
    //?USER: Processing if Data record not found

    // PGM.*Return code = CND.*Record does not exist
    PGM.*Return_code = 'Y2U0005';

    //?USER: Process Data record

    MOVE *ALL (To: PAR From: DB1);

   }

   // PAR.USR Min Weight = PAR.Minimum Weight Per Case * PAR.USR Case Quantity *Rounde
   PAR.USR_Min_Weight = PAR.Minimum_Weight_Per_Case * PAR.USR_Case_Quantity 'H';

   // PAR.USR Max Weight = PAR.Maximum Weight Per Case * PAR.USR Case Quantity *Rounde
   PAR.USR_Max_Weight = PAR.Maximum_Weight_Per_Case * PAR.USR_Case_Quantity 'H';

   //?Weight entered as shipped is less than Minimum
   CASE;

   // IF PAR.USR Case Weight LT PAR.USR Min Weight
   IF PAR.USR_Case_Weight < PAR.USR_Min_Weight;

   // PAR.USR Under Min = CND.yes
   PAR.USR_Under_Min = 'Y';

   // PAR.USR Exit Program = CND.no
   PAR.USR_Exit_Program = 'N';

   //?Exit Prog. No  will set the program back to beginning
   ENDIF;

   //?Weight entered is greater than the maxiumum
   CASE;

   // IF PAR.USR Case Weight GT PAR.USR Max Weight
   IF PAR.USR_Case_Weight > PAR.USR_Max_Weight;

   // PAR.USR Over Max = CND.yes
   PAR.USR_Over_Max = 'Y';

   // PAR.USR Exit Program = CND.no
   PAR.USR_Exit_Program = 'N';

   //?Exit prog. no will set program back to beginning
   ENDIF;

   CASE;

   // IF PAR.USR Case Quantity GT DB1.Quantity Allocated
   IF PAR.USR_Case_Quantity > DB1.Quantity_Scheduled;

   // WRK.Work Over/Short Status = CND.Overage
   WRK.Work_Over_Short_Status = 'O';

   ENDIF;

   CASE;

   // IF PAR.USR Case Quantity LT DB1.Quantity Allocated
   IF PAR.USR_Case_Quantity < DB1.Quantity_Scheduled;

   // WRK.Work Over/Short Status = CND.Short
   WRK.Work_Over_Short_Status = 'S';

   ENDIF;

   // WRK.Detail Line Status = CND.Confirmed
   WRK.Detail_Line_Status = 'R';

   // WRK.Detail Line Status Last = DB1.Detail Line Status
   WRK.Detail_Line_Status_Last = DB1.Detail_Line_Status;

   //?FP1110 HPB ONLY 4/14/08 Output net gallons and net weight to Ord Dtl
   //?  if Warehouse is Req Meter Readings is YES.
   //?  Every other warehouse puts out the gross from manifest dtl
   EXECUTE FUNCTION(Rtv HPB fields        RT) TYPE(RTVOBJ) FILE(CAADREP)           AC1855470;
   PARAMETER(DB1.Warehouse_Code);
   PARAMETER(LCL.Production_Warehouse_Code);
   PARAMETER(LCL.Warehouse_Location);
   PARAMETER(LCL.WHS_Req_Meter_Reading_Shp);
   {
    //?USER: Processing if Data record not found

    MOVE *ALL (To: PAR From: CON);

    //?USER: Process Data record

    MOVE *ALL (To: PAR From: DB1);

   }

   CASE;

   // IF LCL.WHS Req Meter Reading Shp is Yes
   IF LCL.WHS_Req_Meter_Reading_Shp = 'Y';

   EXECUTE FUNCTION(CHG Confirmed Qty      CH) TYPE(CHGOBJ) FILE(OPBGWKP)          AC1314641;
   PARAMETER(DB1.Company_Number);
   PARAMETER(DB1.Order_Number);
   PARAMETER(DB1.Order_Sequence_Number);
   PARAMETER(DB1.Order_Secondary_Line_Seq);
   PARAMETER(WRK.Detail_Line_Status);
   PARAMETER(WRK.Detail_Line_Status_Last);
   PARAMETER('P');
   PARAMETER(WRK.Work_Over_Short_Status);
   PARAMETER(PAR.HPB_Meter_Net_Gallon);
   PARAMETER(PAR.HPB_Meter_Net_Weight);
   PARAMETER(DB1.Scheduled_Ship_Date);
   PARAMETER(DB1.Actual_Shipped_Date);
   PARAMETER(DB1.Modified_Flag);
   PARAMETER(DB1.Substituted_Flag);
   PARAMETER(DB1.OD_Schedule_Override_Sts);
   // IF *OTHERWISE
   IF *OTHERWISE;

   EXECUTE FUNCTION(CHG Confirmed Qty      CH) TYPE(CHGOBJ) FILE(OPBGWKP)          AC1314641;
   PARAMETER(DB1.Company_Number);
   PARAMETER(DB1.Order_Number);
   PARAMETER(DB1.Order_Sequence_Number);
   PARAMETER(DB1.Order_Secondary_Line_Seq);
   PARAMETER(WRK.Detail_Line_Status);
   PARAMETER(WRK.Detail_Line_Status_Last);
   PARAMETER('P');
   PARAMETER(WRK.Work_Over_Short_Status);
   PARAMETER(PAR.USR_Case_Quantity);
   PARAMETER(PAR.USR_Case_Weight);
   PARAMETER(DB1.Scheduled_Ship_Date);
   PARAMETER(DB1.Actual_Shipped_Date);
   PARAMETER(DB1.Modified_Flag);
   PARAMETER(DB1.Substituted_Flag);
   PARAMETER(DB1.OD_Schedule_Override_Sts);
   ENDIF;

  }

  ENDIF;

 }

 //?Update Actual Ship Date in OH
 // LCL.Actual Shipped Date = LCL.EDI 945 Shipng AdvHdr Dte
 LCL.Actual_Shipped_Date = LCL.EDI_945_Shipng_AdvHdr_Dte;

 EXECUTE FUNCTION(CHG Act Shp Dte + Dtl  IF) TYPE(EXCINTFUN)                     AC2062261;
 PARAMETER(LCL.Company_Number);
 PARAMETER(DB1.W0602_Depositor_Order_Nbr);
 PARAMETER(LCL.Actual_Shipped_Date);
 {
  //?Execute internal function

  EXECUTE FUNCTION(CHG Act Shp Dte + Dtl  RT) TYPE(RTVOBJ) FILE(OPBFCPP)          AC2062262;
  PARAMETER(PAR.Company_Number);
  PARAMETER(PAR.Order_Number);
  PARAMETER(PAR.Actual_Ship_Date_Usr);
  {
   //?USER: Process Data record

   //?Crt change log:
   // LCL.Change Log Prior Value = CVTVAR(DB1.Actual Shipped Date)
   LCL.Change_Log_Prior_Value = CVTVAR(DB1.Actual_Shipped_Date);

   // LCL.Change Log New Value = CVTVAR(PAR.Actual Ship Date Usr)
   LCL.Change_Log_New_Value = CVTVAR(PAR.Actual_Ship_Date_Usr);

   EXECUTE FUNCTION(CRT Load/Order Chg Log IF) TYPE(EXCINTFUN)                     AC1849953;
   PARAMETER(DB1.Load_ID);
   PARAMETER('ACTSHP');
   PARAMETER('ACC');
   PARAMETER(LCL.Change_Log_Prior_Value);
   PARAMETER(LCL.Change_Log_New_Value);
   PARAMETER(DB1.Company_Number);
   PARAMETER(DB1.Order_Number);
   {
    //?Execute internal function

    CASE;

    // IF PAR.Load ID is Blank
    IF PAR.Load_ID = *ZERO;

    EXECUTE FUNCTION(RTV Next Key f/crt dt RT) TYPE(RTVOBJ) FILE(PDLHCPP)           AC2052180;
    PARAMETER(JOB.*Job_date);
    PARAMETER(JOB.*Job_time);
    PARAMETER(LCL.Sequence_Number);
    {
     //?USER: Initialize routine

     // PAR.Sequence Number = CON.1
     PAR.Sequence_Number = 1;

     //?USER: Processing if Data record not found

     // PAR.Sequence Number = CON.1
     PAR.Sequence_Number = 1;

     QUIT;

     //?USER: Process Data record

     CASE;

     // IF DB1.Sequence Number is EQ 999
     IF DB1.Sequence_Number = 999;

     // IF *OTHERWISE
     IF *OTHERWISE;

     // PAR.Sequence Number = DB1.Sequence Number + CON.1
     PAR.Sequence_Number = DB1.Sequence_Number + 1;

     QUIT;

     ENDIF;

    }

    // IF *OTHERWISE
    IF *OTHERWISE;

    EXECUTE FUNCTION(RTV Next Key           RT) TYPE(RTVOBJ) FILE(PDLHCPP)          AC1485145;
    PARAMETER(PAR.Load_ID);
    PARAMETER(LCL.Sequence_Number);
    {
     //?USER: Initialize routine

     // PAR.Sequence Number = CON.1
     PAR.Sequence_Number = 1;

     //?USER: Processing if Data record not found

     // PAR.Sequence Number = CON.1
     PAR.Sequence_Number = 1;

     QUIT;

     //?USER: Process Data record

     CASE;

     // IF DB1.Sequence Number is EQ 999
     IF DB1.Sequence_Number = 999;

     // IF *OTHERWISE
     IF *OTHERWISE;

     // PAR.Sequence Number = DB1.Sequence Number + CON.1
     PAR.Sequence_Number = DB1.Sequence_Number + 1;

     QUIT;

     ENDIF;

    }

    ENDIF;

    //?Use system date/time to minimize dup record creation
    // Call program RTV System Date/Time   UP.
    CALL PROGRAM(RTV System Date/Time   UP) ('PDGFUPC');
    PARAMETER(LCL.Current_System_Date);
    PARAMETER(LCL.Current_System_Time);

    EXECUTE FUNCTION(CRT Load/Order Chg Log CR) TYPE(CRTOBJ) FILE(PDLHCPP)          AC1465744;
    PARAMETER(LCL.Current_System_Date);
    PARAMETER(LCL.Current_System_Time);
    PARAMETER(LCL.Sequence_Number);
    PARAMETER(PAR.Load_ID);
    PARAMETER(*ZERO);
    PARAMETER(PAR.Load_Change_Type);
    PARAMETER(PAR.Department_Control_Code);
    PARAMETER(PAR.Change_Log_Prior_Value);
    PARAMETER(PAR.Change_Log_New_Value);
    PARAMETER(JOB.*USER);
    PARAMETER(JOB.*PROGRAM);
    PARAMETER(*BLANK);
    PARAMETER(*BLANK);
    PARAMETER(PAR.Company_Number);
    PARAMETER(PAR.Order_Number);
    {
     //?USER: Processing if Data record already exists

     // PGM.*Return code = CND.*Record already exists
     PGM.*Return_code = 'Y2U0003';

     //?USER: Processing after Data update

     // PGM.*Return code = CND.*Normal
     PGM.*Return_code = *BLANK;

    }

    //?Add seconds until it can be added successfully
    CASE;

    // IF PGM.*Return code is *Record already exists
    IF PGM.*Return_code = 'Y2U0003';

    // LCL.Created Time = LCL.Current System Time
    LCL.Created_Time = LCL.Current_System_Time;

    // DOW PGM.*Return code is *Record already exists
    DOW PGM.*Return_code = 'Y2U0003';

    // LCL.Created Time = LCL.Created Time + CON.1 *SECONDS
    LCL.Created_Time = TIMEINCR(LCL.Created_Time 1 'SC');

    EXECUTE FUNCTION(CRT Load/Order Chg Log CR) TYPE(CRTOBJ) FILE(PDLHCPP)          AC1465744;
    PARAMETER(LCL.Current_System_Date);
    PARAMETER(LCL.Created_Time);
    PARAMETER(LCL.Sequence_Number);
    PARAMETER(PAR.Load_ID);
    PARAMETER(*ZERO);
    PARAMETER(PAR.Load_Change_Type);
    PARAMETER(PAR.Department_Control_Code);
    PARAMETER(PAR.Change_Log_Prior_Value);
    PARAMETER(PAR.Change_Log_New_Value);
    PARAMETER(JOB.*USER);
    PARAMETER(JOB.*PROGRAM);
    PARAMETER(*BLANK);
    PARAMETER(*BLANK);
    PARAMETER(PAR.Company_Number);
    PARAMETER(PAR.Order_Number);
    {
     //?USER: Processing if Data record already exists

     // PGM.*Return code = CND.*Record already exists
     PGM.*Return_code = 'Y2U0003';

     //?USER: Processing after Data update

     // PGM.*Return code = CND.*Normal
     PGM.*Return_code = *BLANK;

    }

    ENDDO;

    ENDIF;

   }

   EXECUTE FUNCTION(CHG Act Shp Dte + Dtl  CH) TYPE(CHGOBJ) FILE(OPBFCPP)          AC1410530;
   PARAMETER(DB1.Company_Number);
   PARAMETER(DB1.Order_Number);
   PARAMETER(PAR.Actual_Ship_Date_Usr);
   {
    //?USER: Processing before Data read

    EXECUTE FUNCTION(CHG All Act Ship Date  RT) TYPE(RTVOBJ) FILE(OPBGWKP)          AC1366580;
    PARAMETER(PAR.Company_Number);
    PARAMETER(PAR.Order_Number);
    PARAMETER(PAR.Actual_Shipped_Date);
    {
     //?USER: Process Data record

     CASE;

     // IF DB1.Detail Line Status is Cancelled
     IF DB1.Detail_Line_Status = 'X';

     // IF *OTHERWISE
     IF *OTHERWISE;

     EXECUTE FUNCTION(CHG Actual Ship Date   CH) TYPE(CHGOBJ) FILE(OPBGWKP)          AC1366581;
     PARAMETER(PAR.Company_Number);
     PARAMETER(PAR.Order_Number);
     PARAMETER(DB1.Order_Sequence_Number);
     PARAMETER(DB1.Order_Secondary_Line_Seq);
     PARAMETER(PAR.Actual_Shipped_Date);
     {
      //?USER: Processing before Data update

      EXECUTE FUNCTION(Set Date/Time Stamp   IF) TYPE(EXCINTFUN)                      AC1142219;
      PARAMETER(DB1.Job_Time);
      PARAMETER(DB1.User_Id);
      PARAMETER(DB1.Job_Name);
      PARAMETER(DB1.Job_Date);
      {
       //?Execute internal function

       // PAR.Job Time = JOB.*Job time
       PAR.Job_Time = JOB.*Job_time;

       // PAR.User Id = JOB.*USER
       PAR.User_Id = JOB.*USER;

       // PAR.Job Name = JOB.*JOB
       PAR.Job_Name = JOB.*JOB;

       // PAR.Job Date = JOB.*Job date
       PAR.Job_Date = JOB.*Job_date;

      }

     }

     ENDIF;

    }

    //?USER: Processing before Data update

    EXECUTE FUNCTION(Set Date/Time Stamp.PgmIF) TYPE(EXCINTFUN)                     AC1425284;
    PARAMETER(DB1.Job_Time);
    PARAMETER(DB1.User_Id);
    PARAMETER(DB1.Job_Name);
    PARAMETER(DB1.Job_Date);
    {
     //?Execute internal function

     // PAR.Job Time = JOB.*Job time
     PAR.Job_Time = JOB.*Job_time;

     // PAR.User Id = JOB.*USER
     PAR.User_Id = JOB.*USER;

     // PAR.Job Name = JOB.*PROGRAM
     PAR.Job_Name = JOB.*PROGRAM;

     // PAR.Job Date = JOB.*Job date
     PAR.Job_Date = JOB.*Job_date;

    }

    // Call program TRG Order Hdr CHG Trig XT.
    CALL PROGRAM(TRG Order Hdr CHG Trig XT) ('PDW9XFR');
    PARAMETER(DB1.Company_Number);
    PARAMETER(DB1.Order_Number);
    PARAMETER(DB1.Order_Type_Sales);
    PARAMETER(DB1.AR_Customer_Number);
    PARAMETER(DB1.Ship_To_Customer);
    PARAMETER(DB1.Ship_To_Name);
    PARAMETER(DB1.Ship_To_Address_Line_1);
    PARAMETER(DB1.Ship_To_Address_Line_2);
    PARAMETER(DB1.Ship_To_Address_Line_3);
    PARAMETER(DB1.Ship_To_City);
    PARAMETER(DB1.Ship_To_State_Code);
    PARAMETER(DB1.Ship_To_Zip_Postal_Code);
    PARAMETER(DB1.Bill_to_Customer);
    PARAMETER(DB1.Bill_to_Name);
    PARAMETER(DB1.Bill_to_Address_Line_1);
    PARAMETER(DB1.Bill_to_Address_Line_2);
    PARAMETER(DB1.Bill_to_Address_Line_3);
    PARAMETER(DB1.Bill_to_City);
    PARAMETER(DB1.Bill_to_State_Code);
    PARAMETER(DB1.Bill_to_Zip_Postal_Code);
    PARAMETER(DB1.Customer_Purchase_Order_#);
    PARAMETER(DB1.Order_Date);
    PARAMETER(DB1.Requested_Ship_Date);
    PARAMETER(DB1.Actual_Shipped_Date);
    PARAMETER(DB1.Cancel_Date);
    PARAMETER(DB1.Terms_Code);
    PARAMETER(DB1.Special_Instructions);
    PARAMETER(DB1.Special_Instructions_2);
    PARAMETER(DB1.Carrier_Code);
    PARAMETER(DB1.Comment_Print_Acknowledge);
    PARAMETER(DB1.Comment_Print_Inv_Cr_Memo);
    PARAMETER(DB1.Comment_Print_Pick_Slip);
    PARAMETER(DB1.Comment_Print_Ship_Doc);
    PARAMETER(DB1.Reason_Code);
    PARAMETER(DB1.Order_in_Use);
    PARAMETER(DB1.Header_Status);
    PARAMETER(DB1.Header_Status_Last);
    PARAMETER(DB1.Order_Type_Print_Status);
    PARAMETER(DB1.Scheduled_Ship_Date);
    PARAMETER(DB1.User_Original_Entry);
    PARAMETER(DB1.Date_of_Original_Entry);
    PARAMETER(DB1.Order_Value_Total);
    PARAMETER(DB1.Order_Weight_Total);
    PARAMETER(DB1.Credit_Hold);
    PARAMETER(DB1.Production_Hold);
    PARAMETER(DB1.New_Customer_Hold);
    PARAMETER(DB1.Requested_Delivery_Date);
    PARAMETER(DB1.Requested_Delivery_Time);
    PARAMETER(DB1.Accounts_Receiv_Ent_1);
    PARAMETER(DB1.Accounts_Receiv_Ent_2);
    PARAMETER(DB1.Load_ID);
    PARAMETER(DB1.Absorbed_Freight_Rate_CWT);
    PARAMETER(DB1.Rated_Freight);
    PARAMETER(DB1.LTL_Flag);
    PARAMETER(DB1.Price_Audit);
    PARAMETER(DB1.Price_Status);
    PARAMETER(DB1.Shipping_Method);
    PARAMETER(DB1.Export_Status);
    PARAMETER(DB1.Palletize);
    PARAMETER(DB1.Shrink_Wrap);
    PARAMETER(DB1.Slip_Sheet);
    PARAMETER(DB1.Age_Code);
    PARAMETER(DB1.Reefer_Temperature);
    PARAMETER(DB1.Load_Type);
    PARAMETER(DB1.Attach_to_Invoice_Number);
    PARAMETER(DB1.Load_Plan_Order);
    PARAMETER(DB1.Print_Pick_Slip);
    PARAMETER(DB1.Resell_Reference_Number);
    PARAMETER(DB1.Special_Comment_1);
    PARAMETER(DB1.Special_Comment_2);
    PARAMETER(DB1.Affect_Auto_Accruals);
    PARAMETER(DB1.Sales_Route_Code);
    PARAMETER(DB1.Manager_Level_Code);
    PARAMETER(DB1.VP_Level_Code);
    PARAMETER(DB1.Attach_to_Order_Number);
    PARAMETER(DB1.Reason_for_Price_Audit);
    PARAMETER(DB1.Invoice_Number);
    PARAMETER(DB1.Invoice_Suffix);
    PARAMETER(DB1.Invoice_Date);
    PARAMETER(DB1.Event_Code);
    PARAMETER(DB1.Trans_Contol_AS400_Plant);
    PARAMETER(DB1.Modified_Flag);
    PARAMETER(DB1.A_R_order_Value_Total);
    PARAMETER(DB1.Billing_Activity_Type);
    PARAMETER(DB1.Block_Order_Flag);
    PARAMETER(DB1.Order_Certification_Flag);
    PARAMETER(DB1.Invoice_Order_Value_Tot);
    PARAMETER(DB1.Process_Sts_for_3C);
    PARAMETER(DB1.Order_Conf_Fax_Sts);
    PARAMETER(DB1.Manifest_Fax_Sts);
    PARAMETER(DB1.Invoice_Fax_Sts);
    PARAMETER(DB1.Transfer_in_Storage_Ind);
    PARAMETER(DB1.Email_Cust_On_Order_Ship);
    PARAMETER(DB1.Order_Emailed);
    PARAMETER(DB1.Export_Docs_Go_w_Driver);
    PARAMETER(DB1.Shipping_Temp_Code_C_F);
    PARAMETER(DB1.Broker_Order_Status);
    PARAMETER(DB1.Air_Freight_Order);
    PARAMETER(DB1.Order_Requires_Review);
    PARAMETER(DB1.OH_Load_Plan_Ready);
    PARAMETER(DB1.Export_USDA_Approved);
    PARAMETER(DB1.HPB_Ship_to_Warehouse);
    PARAMETER(DB1.OH_TF_Exempt_Code);
    PARAMETER(DB1.OH_Appt_Confirmation_Dt);
    PARAMETER(DB1.JPN_Invoice_Issuance_Date);
    PARAMETER(DB1.Load_Actual_Shipped_Date);
    PARAMETER(DB1.Load_BOL_Complete_Date);
    PARAMETER(DB1.Load_Truck_Departure_Date);
    PARAMETER(DB1.Maximum_Gross_Weight);
    PARAMETER(DB1.Time_of_Original_Entry);
    PARAMETER(DB1.OH_Appt_Confirmation_Tm);
    PARAMETER(DB1.Load_BOL_Complete_Time);
    PARAMETER(DB1.Load_Truck_Departure_Time);
    PARAMETER(DB1.Act_Frt_Reference_Amount);
    PARAMETER(DB1.Act_Non_Ref_Frt_Amount);
    PARAMETER(DB1.OH_Fuel_Surcharge_Amount);
    PARAMETER(DB1.OH_Total_Non_Ref_Frt_Amt);
    PARAMETER(DB1.OH_Total_Ref_Frt_Amt);
    PARAMETER(DB1.Claim_Number);
    PARAMETER(DB1.EDI_Status_1);
    PARAMETER(DB1.EDI_Status_2);
    PARAMETER(DB1.EDI_Status_3);
    PARAMETER(DB1.Job_Time);
    PARAMETER(DB1.User_Id);
    PARAMETER(DB1.Job_Name);
    PARAMETER(DB1.Job_Date);

    //?USER: Processing after Data update

    EXECUTE FUNCTION(Upd Actual Ship Dt    RT) TYPE(RTVOBJ) FILE(OMFJCPP)           AC2044825;
    PARAMETER(DB1.Load_ID);
    PARAMETER(PAR.Actual_Shipped_Date);
    {
     //?USER: Process Data record

     EXECUTE FUNCTION(CHG Actual Ship Date  CH) TYPE(CHGOBJ) FILE(OMFJCPP)           AC2044828;
     PARAMETER(DB1.Load_ID);
     PARAMETER(PAR.Actual_Ship_Date);
     {
      //?USER: Processing before Data update

      // DB1.Job Time = JOB.*Job time
      DB1.Job_Time = JOB.*Job_time;

      // DB1.User Id = JOB.*USER
      DB1.User_Id = JOB.*USER;

      // DB1.Job Name = JOB.*JOB
      DB1.Job_Name = JOB.*JOB;

      // DB1.Job Date = JOB.*Job date
      DB1.Job_Date = JOB.*Job_date;

     }

    }

   }

  }

 }

 // WRK.Event Number = CND.Equal zero
 WRK.Event_Number = *ZERO;

 EXECUTE FUNCTION(RTV Next Event Number  RT) TYPE(RTVOBJ) FILE(OPEYCPP)          AC1306444;
 PARAMETER(LCL.Company_Number);
 PARAMETER(DB1.W0602_Depositor_Order_Nbr);
 PARAMETER(WRK.Event_Number);
 {
  //?USER: Processing if Data record not found

  // PAR.Event Number = CON.1
  PAR.Event_Number = 1;

  //?USER: Process Data record

  // PAR.Event Number = DB1.Event Number
  PAR.Event_Number = DB1.Event_Number;

 }

 // WRK.Event Number = WRK.Event Number + CON.1
 WRK.Event_Number = WRK.Event_Number + 1;

 EXECUTE FUNCTION(CRT OP Order Events    CR) TYPE(CRTOBJ) FILE(OPEYCPP)          AC1170141;
 PARAMETER(LCL.Company_Number);
 PARAMETER(DB1.W0602_Depositor_Order_Nbr);
 PARAMETER(WRK.Event_Number);
 PARAMETER('04');
 PARAMETER(*ZERO);
 PARAMETER(*ZERO);
 PARAMETER('IN');
 PARAMETER(JOB.*Job_date);
 PARAMETER('N');
 PARAMETER('N');
 PARAMETER('N');
 PARAMETER(*ZERO);
 PARAMETER(*ZERO);
 PARAMETER(*ZERO);
 PARAMETER(*ZERO);
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(Set Date/Time Stamp   IF) TYPE(EXCINTFUN)                      AC1142219;
  PARAMETER(DB1.Job_Time);
  PARAMETER(DB1.User_Id);
  PARAMETER(DB1.Job_Name);
  PARAMETER(DB1.Job_Date);
  {
   //?Execute internal function

   // PAR.Job Time = JOB.*Job time
   PAR.Job_Time = JOB.*Job_time;

   // PAR.User Id = JOB.*USER
   PAR.User_Id = JOB.*USER;

   // PAR.Job Name = JOB.*JOB
   PAR.Job_Name = JOB.*JOB;

   // PAR.Job Date = JOB.*Job date
   PAR.Job_Date = JOB.*Job_date;

  }

 }

 // PAR.Access Denied (Y/N) = CND.no
 PAR.Access_Denied_Y_N = 'N';

 //?WI517 DN 10/04/23-Added 'Called From Program' as Input Parm.
 //?- Added 'Send Email f/Failed API U' Output Parm.
 // Call program ADD Ready to Confirm   XF.
 CALL PROGRAM(ADD Ready to Confirm   XF) ('PDN2XFR');
 PARAMETER(LCL.Company_Number);
 PARAMETER(DB1.W0602_Depositor_Order_Nbr);
 PARAMETER(LCL.Actual_Shipped_Date);
 PARAMETER(PAR.Access_Denied_Y_N);
 PARAMETER(LCL.Scheduled_Ship_Date);
 PARAMETER('PUEJXFR');
 PARAMETER(LCL.Send_Email_f_Failed_API_U);
 PARAMETER(PAR.SSCC_Pallet_ID_Valid_USR);

 //?WI517 DN 10/04/23-Set 'Send Email f/Failed API U' for Failed API Call.
 CASE;

 // IF LCL.Send Email f/Failed API U is Yes
 IF LCL.Send_Email_f_Failed_API_U = 'Y';

 // AND LCL.First Time Through USR is Yes
 AND LCL.First_Time_Through_USR = 'Y';

 // LCL.First Time Through USR = CND.No
 LCL.First_Time_Through_USR = 'N';

 // PAR.Send Email f/Failed API U = CND.Yes
 PAR.Send_Email_f_Failed_API_U = 'Y';

 ENDIF;

 EXECUTE FUNCTION(CHG WHS Shipng Adv HDR CH) TYPE(CHGOBJ) FILE(ECP057)           AC2024398;
 PARAMETER(DB1.EDI_SURROGATE_NUMBER);
 PARAMETER(DB1.W0601_Reporting_Code);
 PARAMETER(DB1.W0602_Depositor_Order_Nbr);
 PARAMETER(DB1.W0603_Date_actual_ship);
 PARAMETER(DB1.W0604_Shipment_Num_BOL);
 PARAMETER(DB1.W0605_Agent_Shipment_Nbr);
 PARAMETER(DB1.W0606_Customer_PO);
 PARAMETER(DB1.N902_Order_Status);
 PARAMETER(DB1.W2701_Transportation_Type);
 PARAMETER(DB1.W2702_SCAC_Carrier_Code);
 PARAMETER(DB1.W0301_Quantity_Shipped);
 PARAMETER(DB1.W0302_Weight_Shipped);
 PARAMETER(DB1.W0303_Unit_of_Measure);
 PARAMETER(DB1.W6201_Actual_Depart_Date);
 PARAMETER(DB1.W6204_Actual_Depart_Time);
 PARAMETER(DB1.W6205_Actual_Depart_TmCD);
 PARAMETER(DB1.W6201_Request_Ship_Date);
 PARAMETER(DB1.W1002_Nbr_Pallets_Shipped);
 PARAMETER(DB1.N0902_Pallet_Type);
 PARAMETER('Y');
 PARAMETER(DB1.EDI_Error_Reason);
 //?WI609_2 JM 11/12/24-OHE is already updated for invalid pallet.
 CASE;

 // IF LCL.SSCC Pallet ID Valid USR is No
 IF LCL.SSCC_Pallet_ID_Valid_USR = 'N';

 //?WI609_2 JM 11/12/24-OHE is already updated for invalid pallet.
 // IF *OTHERWISE
 IF *OTHERWISE;

 EXECUTE FUNCTION(Upd OHE EDI 945 Action RT) TYPE(RTVOBJ) FILE(PMAMREP)          AC2142925;
 PARAMETER(LCL.Company_Number);
 PARAMETER(DB1.W0602_Depositor_Order_Nbr);
 PARAMETER(PAR.EDI_Error_Reason);
 PARAMETER('R');
 PARAMETER(LCL.Load_ID);
 PARAMETER(LCL.Actual_Shipped_Date);
 {
  //?USER: Processing if Data record not found

  EXECUTE FUNCTION(CRT OHE EDI 945 Action CR) TYPE(CRTOBJ) FILE(PMAMREP)          AC2142926;
  PARAMETER(PAR.Company_Number);
  PARAMETER(PAR.Order_Number);
  PARAMETER(PAR.Load_ID);
  PARAMETER(PAR.Actual_Shipped_Date);
  PARAMETER(PAR.OHE_EDI_Error_Reasons);
  PARAMETER(PAR.OHE_EDI_945_Action);
  {
   //?USER: Processing before Data update

   // DB1.Record Status = CND.Active
   DB1.Record_Status = 'A';

   // DB1.Job Time = JOB.*Job time
   DB1.Job_Time = JOB.*Job_time;

   // DB1.Job Date = JOB.*Job date
   DB1.Job_Date = JOB.*Job_date;

   // DB1.Job Name = JOB.*PROGRAM
   DB1.Job_Name = JOB.*PROGRAM;

   // DB1.User Id = JOB.*USER
   DB1.User_Id = JOB.*USER;

  }

  //?USER: Process Data record

  EXECUTE FUNCTION(CHG OHE EDI 945 Action CH) TYPE(CHGOBJ) FILE(PMAMREP)          AC2142924;
  PARAMETER(DB1.Company_Number);
  PARAMETER(DB1.Order_Number);
  PARAMETER(PAR.OHE_EDI_Error_Reasons);
  PARAMETER(PAR.OHE_EDI_945_Action);
  {
   //?USER: Processing before Data update

   // DB1.Job Time = JOB.*Job time
   DB1.Job_Time = JOB.*Job_time;

   // DB1.Job Date = JOB.*Job date
   DB1.Job_Date = JOB.*Job_date;

   // DB1.Job Name = JOB.*PROGRAM
   DB1.Job_Name = JOB.*PROGRAM;

   // DB1.User Id = JOB.*USER
   DB1.User_Id = JOB.*USER;

  }

 }

 ENDIF;

 EXECUTE FUNCTION(Upd BOL Complete Dt/Tm RT) TYPE(RTVOBJ) FILE(OMFJCPP)          AC2142928;
 PARAMETER(LCL.Load_ID);
 {
  //?USER: Process Data record

  CASE;

  // IF DB1.Load Status is Not Invoiced
  IF DB1.Load_Status = 'C'/'E'/'L'/'S'/'U';

  //?Only update BOL Complete Date/Time if the Load has been shipped
  CASE;

  // IF DB1.Load Status is Shipped
  IF DB1.Load_Status = 'S';

  // Call program RTV System Date/Time   UP.
  CALL PROGRAM(RTV System Date/Time   UP) ('PDGFUPC');
  PARAMETER(LCL.BOL_Complete_Date);
  PARAMETER(LCL.BOL_Complete_Time);

  CASE;

  // IF LCL.BOL Complete Date GT DB1.BOL Complete Date
  IF LCL.BOL_Complete_Date > DB1.BOL_Complete_Date;

  // OR LCL.BOL Complete Date EQ DB1.BOL Complete Date
  OR ( LCL.BOL_Complete_Date = DB1.BOL_Complete_Date;

  // AND LCL.BOL Complete Time GT DB1.BOL Complete Time
  AND LCL.BOL_Complete_Time > DB1.BOL_Complete_Time );

  //?use system date/time if > than whats there already
  // IF *OTHERWISE
  IF *OTHERWISE;

  // LCL.BOL Complete Date = DB1.BOL Complete Date
  LCL.BOL_Complete_Date = DB1.BOL_Complete_Date;

  // LCL.BOL Complete Time = DB1.BOL Complete Time
  LCL.BOL_Complete_Time = DB1.BOL_Complete_Time;

  ENDIF;

  //?Only update BOL Complete Date/Time if the Load has been shipped
  // IF *OTHERWISE
  IF *OTHERWISE;

  // LCL.BOL Complete Date = DB1.BOL Complete Date
  LCL.BOL_Complete_Date = DB1.BOL_Complete_Date;

  // LCL.BOL Complete Time = DB1.BOL Complete Time
  LCL.BOL_Complete_Time = DB1.BOL_Complete_Time;

  ENDIF;

  CASE;

  // IF DB1.Export Status is yes
  IF DB1.Export_Status = 'Y';

  // LCL.Export Load USDA-OK = CND.Yes
  LCL.Export_Load_USDA_OK = 'Y';

  // IF *OTHERWISE
  IF *OTHERWISE;

  // LCL.Export Load USDA-OK = CND.No
  LCL.Export_Load_USDA_OK = 'N';

  ENDIF;

  EXECUTE FUNCTION(CHG BOL Complete Dt/Tm CH) TYPE(CHGOBJ) FILE(OMFJCPP)          AC2142927;
  PARAMETER(DB1.Load_ID);
  PARAMETER(LCL.BOL_Complete_Date);
  PARAMETER(LCL.BOL_Complete_Time);
  PARAMETER(LCL.Export_Load_USDA_OK);
  PARAMETER('M');
  {
   //?USER: Processing before Data update

   EXECUTE FUNCTION(Set Date/Time Stamp.PgmIF) TYPE(EXCINTFUN)                     AC1425284;
   PARAMETER(DB1.Job_Time);
   PARAMETER(DB1.User_Id);
   PARAMETER(DB1.Job_Name);
   PARAMETER(DB1.Job_Date);
   {
    //?Execute internal function

    // PAR.Job Time = JOB.*Job time
    PAR.Job_Time = JOB.*Job_time;

    // PAR.User Id = JOB.*USER
    PAR.User_Id = JOB.*USER;

    // PAR.Job Name = JOB.*PROGRAM
    PAR.Job_Name = JOB.*PROGRAM;

    // PAR.Job Date = JOB.*Job date
    PAR.Job_Date = JOB.*Job_date;

   }

   //?USER: Processing after Data update

   CASE;

   // IF DB1.MG Created Load is Yes
   IF DB1.MG_Created_Load = 'Y';

   // Call program MG Crt Trgr per Load  XF.
   CALL PROGRAM(MG Crt Trgr per Load  XF) ('PBXJXFR');
   PARAMETER(DB1.Load_ID);

   ENDIF;

  }

  ENDIF;

 }

 // IF DB1.N902 Order Status is Picked Order
 IF DB1.N902_Order_Status = 'PO';

 //?UPD:  Order Header * Order Events
 CASE;

 // IF WRK.#Sequence Block is NULL
 IF WRK.#Sequence_Block = *BLANK;

 EXECUTE FUNCTION(RTV Check Pick Event   RT) TYPE(RTVOBJ) FILE(OPEYCPP)          AC1198676;
 PARAMETER(LCL.Company_Number);
 PARAMETER(DB1.W0602_Depositor_Order_Nbr);
 PARAMETER('03');
 {
  //?USER: Processing if Data record not found

  // PGM.*Return code = CND.*Record does not exist
  PGM.*Return_code = 'Y2U0005';

  //?USER: Process Data record

  // PGM.*Return code = CND.*Normal
  PGM.*Return_code = *BLANK;

  QUIT;

 }

 CASE;

 // IF PGM.*Return code is *Record does not exist
 IF PGM.*Return_code = 'Y2U0005';

 // PGM.*Return code = CND.*Normal
 PGM.*Return_code = *BLANK;

 EXECUTE FUNCTION(RTV Next Event Number  RT) TYPE(RTVOBJ) FILE(OPEYCPP)          AC1306444;
 PARAMETER(LCL.Company_Number);
 PARAMETER(DB1.W0602_Depositor_Order_Nbr);
 PARAMETER(PAR.Event_Number);
 {
  //?USER: Processing if Data record not found

  // PAR.Event Number = CON.1
  PAR.Event_Number = 1;

  //?USER: Process Data record

  // PAR.Event Number = DB1.Event Number
  PAR.Event_Number = DB1.Event_Number;

 }

 EXECUTE FUNCTION(CRT Create Pick Event  RT) TYPE(RTVOBJ) FILE(OPEYCPP)          AC1198687;
 PARAMETER(LCL.Company_Number);
 PARAMETER(DB1.W0602_Depositor_Order_Nbr);
 PARAMETER(PAR.Event_Number);
 {
  //?USER: Process Data record

  // WRK.Event Number = DB1.Event Number + CON.1
  WRK.Event_Number = DB1.Event_Number + 1;

  EXECUTE FUNCTION(CRT OP Order Events    CR) TYPE(CRTOBJ) FILE(OPEYCPP)          AC1170141;
  PARAMETER(DB1.Company_Number);
  PARAMETER(DB1.Order_Number);
  PARAMETER(WRK.Event_Number);
  PARAMETER('03');
  PARAMETER(DB1.Invoice_Memo_Company);
  PARAMETER(DB1.Invoice_Memo_Number);
  PARAMETER(DB1.Invoice_Memo_Suffix);
  PARAMETER(JOB.*Job_date);
  PARAMETER(DB1.Activity_Completion);
  PARAMETER(DB1.Activity_Hold);
  PARAMETER(DB1.Post_Cash_Complete);
  PARAMETER(DB1.Cross_Event_Ref_Comp);
  PARAMETER(DB1.Cross_Event_Ref_Order);
  PARAMETER(DB1.Cross_Event_Ref_Event);
  PARAMETER(DB1.Ship_To_Customer);
  {
   //?USER: Processing before Data update

   EXECUTE FUNCTION(Set Date/Time Stamp   IF) TYPE(EXCINTFUN)                      AC1142219;
   PARAMETER(DB1.Job_Time);
   PARAMETER(DB1.User_Id);
   PARAMETER(DB1.Job_Name);
   PARAMETER(DB1.Job_Date);
   {
    //?Execute internal function

    // PAR.Job Time = JOB.*Job time
    PAR.Job_Time = JOB.*Job_time;

    // PAR.User Id = JOB.*USER
    PAR.User_Id = JOB.*USER;

    // PAR.Job Name = JOB.*JOB
    PAR.Job_Name = JOB.*JOB;

    // PAR.Job Date = JOB.*Job date
    PAR.Job_Date = JOB.*Job_date;

   }

  }

  QUIT;

 }

 //?UPD:  Order Header Event Code
 CASE;

 // IF PAR.Event Code is Open Orders
 IF PAR.Event_Code < '04';

 EXECUTE FUNCTION(CHG Event Code    PFS RT) TYPE(RTVOBJ) FILE(OPBFCPP)           AC1735980;
 PARAMETER(LCL.Company_Number);
 PARAMETER(DB1.W0602_Depositor_Order_Nbr);
 PARAMETER('03');
 {
  //?USER: Process Data record

  EXECUTE FUNCTION(Chg Order Event        CH) TYPE(CHGOBJ) FILE(OPBFCPP)          AC1536110;
  PARAMETER(DB1.Company_Number);
  PARAMETER(DB1.Order_Number);
  PARAMETER(PAR.Event_Code);
  {
   //?USER: Processing before Data update

   EXECUTE FUNCTION(Set Date/Time Stamp.PgmIF) TYPE(EXCINTFUN)                     AC1425284;
   PARAMETER(DB1.Job_Time);
   PARAMETER(DB1.User_Id);
   PARAMETER(DB1.Job_Name);
   PARAMETER(DB1.Job_Date);
   {
    //?Execute internal function

    // PAR.Job Time = JOB.*Job time
    PAR.Job_Time = JOB.*Job_time;

    // PAR.User Id = JOB.*USER
    PAR.User_Id = JOB.*USER;

    // PAR.Job Name = JOB.*PROGRAM
    PAR.Job_Name = JOB.*PROGRAM;

    // PAR.Job Date = JOB.*Job date
    PAR.Job_Date = JOB.*Job_date;

   }

   // Call program TRG Order Hdr CHG Trig XT.
   CALL PROGRAM(TRG Order Hdr CHG Trig XT) ('PDW9XFR');
   PARAMETER(DB1.Company_Number);
   PARAMETER(DB1.Order_Number);
   PARAMETER(DB1.Order_Type_Sales);
   PARAMETER(DB1.AR_Customer_Number);
   PARAMETER(DB1.Ship_To_Customer);
   PARAMETER(DB1.Ship_To_Name);
   PARAMETER(DB1.Ship_To_Address_Line_1);
   PARAMETER(DB1.Ship_To_Address_Line_2);
   PARAMETER(DB1.Ship_To_Address_Line_3);
   PARAMETER(DB1.Ship_To_City);
   PARAMETER(DB1.Ship_To_State_Code);
   PARAMETER(DB1.Ship_To_Zip_Postal_Code);
   PARAMETER(DB1.Bill_to_Customer);
   PARAMETER(DB1.Bill_to_Name);
   PARAMETER(DB1.Bill_to_Address_Line_1);
   PARAMETER(DB1.Bill_to_Address_Line_2);
   PARAMETER(DB1.Bill_to_Address_Line_3);
   PARAMETER(DB1.Bill_to_City);
   PARAMETER(DB1.Bill_to_State_Code);
   PARAMETER(DB1.Bill_to_Zip_Postal_Code);
   PARAMETER(DB1.Customer_Purchase_Order_#);
   PARAMETER(DB1.Order_Date);
   PARAMETER(DB1.Requested_Ship_Date);
   PARAMETER(DB1.Actual_Shipped_Date);
   PARAMETER(DB1.Cancel_Date);
   PARAMETER(DB1.Terms_Code);
   PARAMETER(DB1.Special_Instructions);
   PARAMETER(DB1.Special_Instructions_2);
   PARAMETER(DB1.Carrier_Code);
   PARAMETER(DB1.Comment_Print_Acknowledge);
   PARAMETER(DB1.Comment_Print_Inv_Cr_Memo);
   PARAMETER(DB1.Comment_Print_Pick_Slip);
   PARAMETER(DB1.Comment_Print_Ship_Doc);
   PARAMETER(DB1.Reason_Code);
   PARAMETER(DB1.Order_in_Use);
   PARAMETER(DB1.Header_Status);
   PARAMETER(DB1.Header_Status_Last);
   PARAMETER(DB1.Order_Type_Print_Status);
   PARAMETER(DB1.Scheduled_Ship_Date);
   PARAMETER(DB1.User_Original_Entry);
   PARAMETER(DB1.Date_of_Original_Entry);
   PARAMETER(DB1.Order_Value_Total);
   PARAMETER(DB1.Order_Weight_Total);
   PARAMETER(DB1.Credit_Hold);
   PARAMETER(DB1.Production_Hold);
   PARAMETER(DB1.New_Customer_Hold);
   PARAMETER(DB1.Requested_Delivery_Date);
   PARAMETER(DB1.Requested_Delivery_Time);
   PARAMETER(DB1.Accounts_Receiv_Ent_1);
   PARAMETER(DB1.Accounts_Receiv_Ent_2);
   PARAMETER(DB1.Load_ID);
   PARAMETER(DB1.Absorbed_Freight_Rate_CWT);
   PARAMETER(DB1.Rated_Freight);
   PARAMETER(DB1.LTL_Flag);
   PARAMETER(DB1.Price_Audit);
   PARAMETER(DB1.Price_Status);
   PARAMETER(DB1.Shipping_Method);
   PARAMETER(DB1.Export_Status);
   PARAMETER(DB1.Palletize);
   PARAMETER(DB1.Shrink_Wrap);
   PARAMETER(DB1.Slip_Sheet);
   PARAMETER(DB1.Age_Code);
   PARAMETER(DB1.Reefer_Temperature);
   PARAMETER(DB1.Load_Type);
   PARAMETER(DB1.Attach_to_Invoice_Number);
   PARAMETER(DB1.Load_Plan_Order);
   PARAMETER(DB1.Print_Pick_Slip);
   PARAMETER(DB1.Resell_Reference_Number);
   PARAMETER(DB1.Special_Comment_1);
   PARAMETER(DB1.Special_Comment_2);
   PARAMETER(DB1.Affect_Auto_Accruals);
   PARAMETER(DB1.Sales_Route_Code);
   PARAMETER(DB1.Manager_Level_Code);
   PARAMETER(DB1.VP_Level_Code);
   PARAMETER(DB1.Attach_to_Order_Number);
   PARAMETER(DB1.Reason_for_Price_Audit);
   PARAMETER(DB1.Invoice_Number);
   PARAMETER(DB1.Invoice_Suffix);
   PARAMETER(DB1.Invoice_Date);
   PARAMETER(DB1.Event_Code);
   PARAMETER(DB1.Trans_Contol_AS400_Plant);
   PARAMETER(DB1.Modified_Flag);
   PARAMETER(DB1.A_R_order_Value_Total);
   PARAMETER(DB1.Billing_Activity_Type);
   PARAMETER(DB1.Block_Order_Flag);
   PARAMETER(DB1.Order_Certification_Flag);
   PARAMETER(DB1.Invoice_Order_Value_Tot);
   PARAMETER(DB1.Process_Sts_for_3C);
   PARAMETER(DB1.Order_Conf_Fax_Sts);
   PARAMETER(DB1.Manifest_Fax_Sts);
   PARAMETER(DB1.Invoice_Fax_Sts);
   PARAMETER(DB1.Transfer_in_Storage_Ind);
   PARAMETER(DB1.Email_Cust_On_Order_Ship);
   PARAMETER(DB1.Order_Emailed);
   PARAMETER(DB1.Export_Docs_Go_w_Driver);
   PARAMETER(DB1.Shipping_Temp_Code_C_F);
   PARAMETER(DB1.Broker_Order_Status);
   PARAMETER(DB1.Air_Freight_Order);
   PARAMETER(DB1.Order_Requires_Review);
   PARAMETER(DB1.OH_Load_Plan_Ready);
   PARAMETER(DB1.Export_USDA_Approved);
   PARAMETER(DB1.HPB_Ship_to_Warehouse);
   PARAMETER(DB1.OH_TF_Exempt_Code);
   PARAMETER(DB1.OH_Appt_Confirmation_Dt);
   PARAMETER(DB1.JPN_Invoice_Issuance_Date);
   PARAMETER(DB1.Load_Actual_Shipped_Date);
   PARAMETER(DB1.Load_BOL_Complete_Date);
   PARAMETER(DB1.Load_Truck_Departure_Date);
   PARAMETER(DB1.Maximum_Gross_Weight);
   PARAMETER(DB1.Time_of_Original_Entry);
   PARAMETER(DB1.OH_Appt_Confirmation_Tm);
   PARAMETER(DB1.Load_BOL_Complete_Time);
   PARAMETER(DB1.Load_Truck_Departure_Time);
   PARAMETER(DB1.Act_Frt_Reference_Amount);
   PARAMETER(DB1.Act_Non_Ref_Frt_Amount);
   PARAMETER(DB1.OH_Fuel_Surcharge_Amount);
   PARAMETER(DB1.OH_Total_Non_Ref_Frt_Amt);
   PARAMETER(DB1.OH_Total_Ref_Frt_Amt);
   PARAMETER(DB1.Claim_Number);
   PARAMETER(DB1.EDI_Status_1);
   PARAMETER(DB1.EDI_Status_2);
   PARAMETER(DB1.EDI_Status_3);
   PARAMETER(DB1.Job_Time);
   PARAMETER(DB1.User_Id);
   PARAMETER(DB1.Job_Name);
   PARAMETER(DB1.Job_Date);

  }

 }

 //?S00930 RMC 9/02/09 Crt chg log rcd for pick event
 // Call program CRT Load/Order Chg Log XF.
 CALL PROGRAM(CRT Load/Order Chg Log XF) ('PDADXFR');
 PARAMETER(LCL.Load_ID);
 PARAMETER(*ZERO);
 PARAMETER('PCKPRC');
 PARAMETER('SHP');
 PARAMETER(02);
 PARAMETER(03);
 PARAMETER(JOB.*USER);
 PARAMETER(JOB.*PROGRAM);
 PARAMETER(LCL.Carrier_Code);
 PARAMETER(LCL.Company_Number);
 PARAMETER(DB1.W0602_Depositor_Order_Nbr);

 ENDIF;

 ENDIF;

 ENDIF;

 EXECUTE FUNCTION(CHG WHS Shipng Adv HDR CH) TYPE(CHGOBJ) FILE(ECP057)           AC2024398;
 PARAMETER(DB1.EDI_SURROGATE_NUMBER);
 PARAMETER(DB1.W0601_Reporting_Code);
 PARAMETER(DB1.W0602_Depositor_Order_Nbr);
 PARAMETER(DB1.W0603_Date_actual_ship);
 PARAMETER(DB1.W0604_Shipment_Num_BOL);
 PARAMETER(DB1.W0605_Agent_Shipment_Nbr);
 PARAMETER(DB1.W0606_Customer_PO);
 PARAMETER(DB1.N902_Order_Status);
 PARAMETER(DB1.W2701_Transportation_Type);
 PARAMETER(DB1.W2702_SCAC_Carrier_Code);
 PARAMETER(DB1.W0301_Quantity_Shipped);
 PARAMETER(DB1.W0302_Weight_Shipped);
 PARAMETER(DB1.W0303_Unit_of_Measure);
 PARAMETER(DB1.W6201_Actual_Depart_Date);
 PARAMETER(DB1.W6204_Actual_Depart_Time);
 PARAMETER(DB1.W6205_Actual_Depart_TmCD);
 PARAMETER(DB1.W6201_Request_Ship_Date);
 PARAMETER(DB1.W1002_Nbr_Pallets_Shipped);
 PARAMETER(DB1.N0902_Pallet_Type);
 PARAMETER('Y');
 PARAMETER(DB1.EDI_Error_Reason);
 ENDIF;

 //?All Validations Passed, Ship the Order Else Update Error in EDI HDR.
 // IF *OTHERWISE
 IF *OTHERWISE;

 EXECUTE FUNCTION(CHG WHS Shipng Adv HDR CH) TYPE(CHGOBJ) FILE(ECP057)           AC2024398;
 PARAMETER(DB1.EDI_SURROGATE_NUMBER);
 PARAMETER(DB1.W0601_Reporting_Code);
 PARAMETER(DB1.W0602_Depositor_Order_Nbr);
 PARAMETER(DB1.W0603_Date_actual_ship);
 PARAMETER(DB1.W0604_Shipment_Num_BOL);
 PARAMETER(DB1.W0605_Agent_Shipment_Nbr);
 PARAMETER(DB1.W0606_Customer_PO);
 PARAMETER(DB1.N902_Order_Status);
 PARAMETER(DB1.W2701_Transportation_Type);
 PARAMETER(DB1.W2702_SCAC_Carrier_Code);
 PARAMETER(DB1.W0301_Quantity_Shipped);
 PARAMETER(DB1.W0302_Weight_Shipped);
 PARAMETER(DB1.W0303_Unit_of_Measure);
 PARAMETER(DB1.W6201_Actual_Depart_Date);
 PARAMETER(DB1.W6204_Actual_Depart_Time);
 PARAMETER(DB1.W6205_Actual_Depart_TmCD);
 PARAMETER(DB1.W6201_Request_Ship_Date);
 PARAMETER(DB1.W1002_Nbr_Pallets_Shipped);
 PARAMETER(DB1.N0902_Pallet_Type);
 PARAMETER('E');
 PARAMETER(PAR.EDI_Error_Reason);
 CASE;

 // IF PAR.EDI-Error Reason is Order Number
 IF PAR.EDI_Error_Reason = 'ORDNM';

 //?dont upd OHE for ord num error -- dont want to create a bogus ord number
 // IF *OTHERWISE
 IF *OTHERWISE;

 EXECUTE FUNCTION(Upd OHE EDI 945 Action RT) TYPE(RTVOBJ) FILE(PMAMREP)          AC2142925;
 PARAMETER(LCL.Company_Number);
 PARAMETER(DB1.W0602_Depositor_Order_Nbr);
 PARAMETER(PAR.EDI_Error_Reason);
 PARAMETER('E');
 PARAMETER(LCL.Load_ID);
 PARAMETER(LCL.Actual_Shipped_Date);
 {
  //?USER: Processing if Data record not found

  EXECUTE FUNCTION(CRT OHE EDI 945 Action CR) TYPE(CRTOBJ) FILE(PMAMREP)          AC2142926;
  PARAMETER(PAR.Company_Number);
  PARAMETER(PAR.Order_Number);
  PARAMETER(PAR.Load_ID);
  PARAMETER(PAR.Actual_Shipped_Date);
  PARAMETER(PAR.OHE_EDI_Error_Reasons);
  PARAMETER(PAR.OHE_EDI_945_Action);
  {
   //?USER: Processing before Data update

   // DB1.Record Status = CND.Active
   DB1.Record_Status = 'A';

   // DB1.Job Time = JOB.*Job time
   DB1.Job_Time = JOB.*Job_time;

   // DB1.Job Date = JOB.*Job date
   DB1.Job_Date = JOB.*Job_date;

   // DB1.Job Name = JOB.*PROGRAM
   DB1.Job_Name = JOB.*PROGRAM;

   // DB1.User Id = JOB.*USER
   DB1.User_Id = JOB.*USER;

  }

  //?USER: Process Data record

  EXECUTE FUNCTION(CHG OHE EDI 945 Action CH) TYPE(CHGOBJ) FILE(PMAMREP)          AC2142924;
  PARAMETER(DB1.Company_Number);
  PARAMETER(DB1.Order_Number);
  PARAMETER(PAR.OHE_EDI_Error_Reasons);
  PARAMETER(PAR.OHE_EDI_945_Action);
  {
   //?USER: Processing before Data update

   // DB1.Job Time = JOB.*Job time
   DB1.Job_Time = JOB.*Job_time;

   // DB1.Job Date = JOB.*Job date
   DB1.Job_Date = JOB.*Job_date;

   // DB1.Job Name = JOB.*PROGRAM
   DB1.Job_Name = JOB.*PROGRAM;

   // DB1.User Id = JOB.*USER
   DB1.User_Id = JOB.*USER;

  }

 }

 ENDIF;

 ENDIF;

 //?USER: Exit processing

 //?WI609_2 JM 12/26/24-Go ahead for email error logic if Error.
 CASE;

 // IF LCL.SSCC Pallet ID Err Found is Yes
 IF LCL.SSCC_Pallet_ID_Err_Found = 'Y';

 // PAR.SSCC Pallet ID Valid USR = CND.No
 PAR.SSCC_Pallet_ID_Valid_USR = 'N';

 ENDIF;

 //?WI609_2 JM 10/08/24
 CASE;

 // IF PAR.SSCC Pallet ID Valid USR is No
 IF PAR.SSCC_Pallet_ID_Valid_USR = 'N';

 // Call program EXC Pro Invalid Pallet XF.
 CALL PROGRAM(EXC Pro Invalid Pallet XF) ('PVHOXFR');
 PARAMETER(LCL.EDI_SURROGATE_NUMBER_USR);

 ENDIF;

}


//?WI517 DN 10/04/23-If 'Send Email f/Failed API U=Yes' Then Send Email.
CASE;

// IF LCL.Send Email f/Failed API U is Yes
IF LCL.Send_Email_f_Failed_API_U = 'Y';

// Call program Prc Eml Shipping & IT  XF.
CALL PROGRAM(Prc Eml Shipping & IT  XF) ('PVA9XFR');
PARAMETER('PUEJXFR');

ENDIF;

