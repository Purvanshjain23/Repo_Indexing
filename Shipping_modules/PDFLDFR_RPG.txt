     H/TITLE EDT Load Plan O.E.     DF Display file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Displays the records from DBF as a subfile
     H* - Loads the SFL from the DBF a page at a time
     H* - The DBF record at which the SFL display starts may be
     H*   controlled by positioning fields on the SFL header
     H* - Any key fields on the SFL header will be used as
     H*   positioning values
     H* - Any non-key fields on the SFL header will be used as
     H*   selection values: a maximum of W0SLM records will be
     H*   read from the DBF before giving up
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Display file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 04/09/21  Time  : 09:16:10
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPDFLDFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: EDT Load Plan O.E.     DF Display file
      *
     FOPBFCPL7IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RSQ : Order Header TRG          Allow for Load Planning
      *
     FOMFLCPL1IF  E           K        DISK
      * RTV : Load Detail               Retrieval index
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FOPBFCPL8IF  E           K        DISK
      * RSQ : Order Header TRG          Load #/All orders
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FOMFKREL0IF  E           K        DISK
      * RTV : Truck Size                Retrieval index
      *
     FPNFOREL1IF  E           K        DISK
      * RTV : User Application Whs      Retrieval index
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse                 Active records only
      *
     FPMAMREL1IF  E           K        DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FPDKGREL2IF  E           K        DISK
      * RSQ : Region Definition         Co, State, Region
      *
     FOPEYCPL9IF  E           K        DISK
      * RSQ : Order Events              Co/Order/Event Code
      *
     FCAACREL1IF  E           K        DISK
      * RTV : State                     Retrieval index       NV
      *
     FCAEOREL5IF  E           K        DISK
      * RSQ : Company Customer          Customer
      *
     FPDJYREL2IF  E           K        DISK
      * RTV : Company Defaults Internal Active Records
      *
     FPDKFREL2IF  E           K        DISK
      * RTV : Region                    Active Records
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOPBFCPLSIF  E           K        DISK
      * RSQ : Order Header TRG          Load ID/Open Orders
      *
     FOMFJCPLLIF  E           K        DISK
      * RSQ : Load Header               Load Only
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer                  Retrieval index       NV
      *
     FOMFLCPL2IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop/Order
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FPPBKCPL3IF  E           K        DISK
      * RSQ : PFS Ship Load/Order Sts   Load/Order Picked
      *
     FOPBFCPL6IF  E           K        DISK
      * RSQ : Order Header TRG          Load Exports
      *
     FOMFLCPL5IF  E           K        DISK
      * RSQ : Load Detail               Co/Load/Order
      *
     FOPEYCPL1IF  E           K        DISK
      * RTV : Order Events              Retrieval index       NV
      *
     FOPEYCPL5IF  E           K        DISK
      * RSQ : Order Events              Customer/Order/Event   N
      *
     FOPEYCPL7IF  E           K        DISK
      * RSQ : Order Events              Customer/Order/Event Cod
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FCAASREL2IF  E           K        DISK
      * RTV : Company Control           Retrieval index       NV
      *
     FOMFJCPL1UF  E           K        DISK                      A
      * UPD : Load Header               Update index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FOMFLCPL0UF  E           K        DISK                      A
      * UPD : Load Detail               Update index
      *
     FOPEYCPL0UF  E           K        DISK                      A
      * UPD : Order Events              Update index
      *
     FCAASREL0UF  E           K        DISK
      * UPD : Company Control           Update index
      *
     E                    J7          7  1
     E                    K7          7  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    J3          3  1
     E                    K3          3  1
      * RIGHT JUSTIFY INPUT FIELD
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    #L3         3  1
     E                    #L7         7  1
     E                    UCT        40  1               CENTER TABLE
      * Screen: Field position and name array
     E                    W0BEG   7 046  5 0A
     E                    W0END   7 046  5 0A
     E                    W0NAM   7 046 10
      * Long constants
     E                    @CN#    1  10  6   @CN    25
     E                    YK01      100 10  A            Load Planning S
      *
     E                    YK02      100 10  A            Load Planning S
      *
     I@BFCPD9
      * Order Header TRG          Load #/All orders
      * Renamed input format fields
     I              BEAIC3                          WAAIC3
     I              BEC4NB                          WAC4NB
     I              BEJNCD                          WAJNCD
     I              BEANC7                          WAANC7
     I              BEBKC7                          WABKC7
     I              BEBRTX                          WABRTX
     I              BEHMNA                          WAHMNA
     I              BEHONA                          WAHONA
     I              BEHPNA                          WAHPNA
     I              BEHNNA                          WAHNNA
     I              BEDBCD                          WADBCD
     I              BECKTX                          WACKTX
     I              BEB0C7                          WAB0C7
     I              BEAETX                          WAAETX
     I              BEB1NA                          WAB1NA
     I              BEB3NA                          WAB3NA
     I              BEB4NA                          WAB4NA
     I              BEB2NA                          WAB2NA
     I              BEBHCD                          WABHCD
     I              BEC8TX                          WAC8TX
     I              BEBCNA                          WABCNA
     I              BEA0DT                          WAA0DT
     I              BEA5DT                          WAA5DT
     I              BEGNDT                          WAGNDT
     I              BEACDT                          WAACDT
     I              BEAQCD                          WAAQCD
     I              BEB6NA                          WAB6NA
     I              BEBYNA                          WABYNA
     I              BEBZNA                          WABZNA
     I              BEGTST                          WAGTST
     I              BEGVST                          WAGVST
     I              BEGUST                          WAGUST
     I              BEQFST                          WAQFST
     I              BECQCD                          WACQCD
     I              BEGJST                          WAGJST
     I              BEGWST                          WAGWST
     I              BEGXST                          WAGXST
     I              BEGYST                          WAGYST
     I              BEAODT                          WAAODT
     I              BEAIVN                          WAAIVN
     I              BECXDT                          WACXDT
     I              BEJZVA                          WAJZVA
     I              BEA1WG                          WAA1WG
     I              BEXIST                          WAXIST
     I              BEXJST                          WAXJST
     I              BEXKST                          WAXKST
     I              BEEIDT                          WAEIDT
     I              BEAFTM                          WAAFTM
     I              BEE8CD                          WAE8CD
     I              BEE9CD                          WAE9CD
     I              BERMNB                          WARMNB
     I              BETBNB                          WATBNB
     I              BER1NB                          WAR1NB
     I              BEPJST                          WAPJST
     I              BEU0ST                          WAU0ST
     I              BEU1ST                          WAU1ST
     I              BEQ2CD                          WAQ2CD
     I              BEU2ST                          WAU2ST
     I              BEVEST                          WAVEST
     I              BEVFST                          WAVFST
     I              BEVGST                          WAVGST
     I              BERPCD                          WARPCD
     I              BERNNB                          WARNNB
     I              BEVDST                          WAVDST
     I              BEATIN                          WAATIN
     I              BEU4ST                          WAU4ST
     I              BEU5ST                          WAU5ST
     I              BERSRN                          WARSRN
     I              BEMHNA                          WAMHNA
     I              BEMINA                          WAMINA
     I              BEWBST                          WAWBST
     I              BER4CD                          WAR4CD
     I              BEBFCD                          WABFCD
     I              BEQ4CD                          WAQ4CD
     I              BET3NB                          WAT3NB
     I              BESICD                          WASICD
     I              BECONB                          WACONB
     I              BECEST                          WACEST
     I              BEAWDT                          WAAWDT
     I              BEJPCD                          WAJPCD
     I              BEXUST                          WAXUST
     I              BEZ1ST                          WAZ1ST
     I              BEVRVA                          WAVRVA
     I              BEOBST                          WAOBST
     I              BEBCST                          WABCST
     I              BEBDST                          WABDST
     I              BEB7VL                          WAB7VL
     I              BEGASX                          WAGASX
     I              BEGBSX                          WAGBSX
     I              BEGCSX                          WAGCSX
     I              BEGDSX                          WAGDSX
     I              BEFNSX                          WAFNSX
     I              BEFOSX                          WAFOSX
     I              BEFPSX                          WAFPSX
     I              BEFQSX                          WAFQSX
     I              BEFRSX                          WAFRSX
     I              BEFSSX                          WAFSSX
     I              BEFTSX                          WAFTSX
     I              BEFUSX                          WAFUSX
     I              BEFVSX                          WAFVSX
     I              BEFWSX                          WAFWSX
     I              BEFXSX                          WAFXSX
     I              BEFYSX                          WAFYSX
     I              BENODT                          WANODT
     I              BENPDT                          WANPDT
     I              BENQDT                          WANQDT
     I              BENRDT                          WANRDT
     I              BENSDT                          WANSDT
     I              BEBPTM                          WABPTM
     I              BEBQTM                          WABQTM
     I              BEBRTM                          WABRTM
     I              BEBSTM                          WABSTM
     I              BEBTTM                          WABTTM
     I              BEH0NX                          WAH0NX
     I              BEH1NX                          WAH1NX
     I              BEH2NX                          WAH2NX
     I              BEH3NX                          WAH3NX
     I              BEH4NX                          WAH4NX
     I              BEC0C7                          WAC0C7
     I              BEUVST                          WAUVST
     I              BEUWST                          WAUWST
     I              BEUXST                          WAUXST
     I              BEAATM                          WAAATM
     I              BEAYNA                          WAAYNA
     I              BEA0NA                          WAA0NA
     I              BEAXDT                          WAAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WCAJCD
     I              ADF8NA                          WCF8NA
     I              ADACNA                          WCACNA
     I              ADADNA                          WCADNA
     I              ADAENA                          WCAENA
     I              ADAJNA                          WCAJNA
     I              ADBTTX                          WCBTTX
     I              ADAOCD                          WCAOCD
     I              ADBGCD                          WCBGCD
     I              ADVHST                          WCVHST
     I              ADMPNA                          WCMPNA
     I              ADWPST                          WCWPST
     I              ADXUST                          WCXUST
     I              ADT0ST                          WCT0ST
     I              ADT1ST                          WCT1ST
     I              ADDBNB                          WCDBNB
     I              ADT2ST                          WCT2ST
     I              ADT3ST                          WCT3ST
     I              ADT4ST                          WCT4ST
     I              ADT6ST                          WCT6ST
     I              ADBWC3                          WCBWC3
     I              ADBTC3                          WCBTC3
     I              ADBUC3                          WCBUC3
     I              ADBVC3                          WCBVC3
     I              ADFCAA                          WCFCAA
     I              ADRQSX                          WCRQSX
     I              ADRRSX                          WCRRSX
     I              ADRSSX                          WCRSSX
     I              ADRTSX                          WCRTSX
     I              ADT7ST                          WCT7ST
     I              ADT8ST                          WCT8ST
     I              ADRNSX                          WCRNSX
     I              ADROSX                          WCROSX
     I              ADRPSX                          WCRPSX
     I              ADUVST                          WCUVST
     I              ADUWST                          WCUWST
     I              ADUXST                          WCUXST
     I              ADVSST                          WCVSST
     I              ADAATM                          WCAATM
     I              ADAYNA                          WCAYNA
     I              ADA0NA                          WCA0NA
     I              ADAXDT                          WCAXDT
      *
     I@FJCPBO
      * Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WDRMNB
     I              FJAIC3                          WDAIC3
     I              FJAODT                          WDAODT
     I              FJPJST                          WDPJST
     I              FJPKST                          WDPKST
     I              FJRNNB                          WDRNNB
     I              FJDMTX                          WDDMTX
     I              FJDNTX                          WDDNTX
     I              FJDOTX                          WDDOTX
     I              FJWTTX                          WDWTTX
     I              FJWUTX                          WDWUTX
     I              FJRPNB                          WDRPNB
     I              FJFLAM                          WDFLAM
     I              FJXQST                          WDXQST
     I              FJRRNB                          WDRRNB
     I              FJDXTX                          WDDXTX
     I              FJDYTX                          WDDYTX
     I              FJSBNB                          WDSBNB
     I              FJBZNA                          WDBZNA
     I              FJRONB                          WDRONB
     I              FJSQNB                          WDSQNB
     I              FJR1NB                          WDR1NB
     I              FJVCST                          WDVCST
     I              FJVDST                          WDVDST
     I              FJSDNB                          WDSDNB
     I              FJPAOU                          WDPAOU
     I              FJDGWG                          WDDGWG
     I              FJSXNB                          WDSXNB
     I              FJHADT                          WDHADT
     I              FJAART                          WDAART
     I              FJDHWG                          WDDHWG
     I              FJDIWG                          WDDIWG
     I              FJAQDT                          WDAQDT
     I              FJS6NB                          WDS6NB
     I              FJT4NB                          WDT4NB
     I              FJPRTM                          WDPRTM
     I              FJNPSV                          WDNPSV
     I              FJJ8TX                          WDJ8TX
     I              FJTLMI                          WDTLMI
     I              FJJ9TX                          WDJ9TX
     I              FJQ2CD                          WDQ2CD
     I              FJVPCD                          WDVPCD
     I              FJDBCD                          WDDBCD
     I              FJGRWE                          WDGRWE
     I              FJXCCD                          WDXCCD
     I              FJU2ST                          WDU2ST
     I              FJF9DT                          WDF9DT
     I              FJONTM                          WDONTM
     I              FJJ4DT                          WDJ4DT
     I              FJTRTM                          WDTRTM
     I              FJJ5DT                          WDJ5DT
     I              FJSPTM                          WDSPTM
     I              FJJ6DT                          WDJ6DT
     I              FJLFTM                          WDLFTM
     I              FJJ7DT                          WDJ7DT
     I              FJBOTM                          WDBOTM
     I              FJJ8DT                          WDJ8DT
     I              FJBLTM                          WDBLTM
     I              FJKIDT                          WDKIDT
     I              FJASTM                          WDASTM
     I              FJKADT                          WDKADT
     I              FJAJCM                          WDAJCM
     I              FJXACD                          WDXACD
     I              FJOANA                          WDOANA
     I              FJK4TX                          WDK4TX
     I              FJVOAG                          WDVOAG
     I              FJKBDT                          WDKBDT
     I              FJNBBO                          WDNBBO
     I              FJW4CD                          WDW4CD
     I              FJEFDT                          WDEFDT
     I              FJCNTN                          WDCNTN
     I              FJKCDT                          WDKCDT
     I              FJTMIN                          WDTMIN
     I              FJKDDT                          WDKDDT
     I              FJVMNB                          WDVMNB
     I              FJOCFR                          WDOCFR
     I              FJKJDT                          WDKJDT
     I              FJATTM                          WDATTM
     I              FJOTRS                          WDOTRS
     I              FJRNST                          WDRNST
     I              FJBRBK                          WDBRBK
     I              FJEIDT                          WDEIDT
     I              FJRMST                          WDRMST
     I              FJAJCD                          WDAJCD
     I              FJKKDT                          WDKKDT
     I              FJAVTM                          WDAVTM
     I              FJKZDT                          WDKZDT
     I              FJAXTM                          WDAXTM
     I              FJLHOS                          WDLHOS
     I              FJLHOR                          WDLHOR
     I              FJWNTX                          WDWNTX
     I              FJOITX                          WDOITX
     I              FJOJTX                          WDOJTX
     I              FJLLDT                          WDLLDT
     I              FJLSHG                          WDLSHG
     I              FJYPST                          WDYPST
     I              FJK0DT                          WDK0DT
     I              FJAYTM                          WDAYTM
     I              FJKNNX                          WDKNNX
     I              FJICWG                          WDICWG
     I              FJIDWG                          WDIDWG
     I              FJH9SX                          WDH9SX
     I              FJWOTX                          WDWOTX
     I              FJK1DT                          WDK1DT
     I              FJAZTM                          WDAZTM
     I              FJK2DT                          WDK2DT
     I              FJA0TM                          WDA0TM
     I              FJROST                          WDROST
     I              FJRPST                          WDRPST
     I              FJRQST                          WDRQST
     I              FJRRST                          WDRRST
     I              FJZBVA                          WDZBVA
     I              FJWPTX                          WDWPTX
     I              FJWQTX                          WDWQTX
     I              FJWRTX                          WDWRTX
     I              FJWSTX                          WDWSTX
     I              FJRVSX                          WDRVSX
     I              FJRUSX                          WDRUSX
     I              FJRWSX                          WDRWSX
     I              FJRXSX                          WDRXSX
     I              FJRYSX                          WDRYSX
     I              FJRZSX                          WDRZSX
     I              FJR0SX                          WDR0SX
     I              FJR1SX                          WDR1SX
     I              FJR2SX                          WDR2SX
     I              FJR3SX                          WDR3SX
     I              FJR4SX                          WDR4SX
     I              FJPYDT                          WDPYDT
     I              FJCKTM                          WDCKTM
     I              FJPZDT                          WDPZDT
     I              FJCLTM                          WDCLTM
     I              FJP0DT                          WDP0DT
     I              FJCMTM                          WDCMTM
     I              FJP1DT                          WDP1DT
     I              FJCNTM                          WDCNTM
     I              FJP2DT                          WDP2DT
     I              FJCOTM                          WDCOTM
     I              FJP3DT                          WDP3DT
     I              FJCQTM                          WDCQTM
     I              FJUVST                          WDUVST
     I              FJUWST                          WDUWST
     I              FJUXST                          WDUXST
     I              FJAATM                          WDAATM
     I              FJAYNA                          WDAYNA
     I              FJA0NA                          WDA0NA
     I              FJAXDT                          WDAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WEAIC3
     I              BEC4NB                          WEC4NB
     I              BEJNCD                          WEJNCD
     I              BEANC7                          WEANC7
     I              BEBKC7                          WEBKC7
     I              BEBRTX                          WEBRTX
     I              BEHMNA                          WEHMNA
     I              BEHONA                          WEHONA
     I              BEHPNA                          WEHPNA
     I              BEHNNA                          WEHNNA
     I              BEDBCD                          WEDBCD
     I              BECKTX                          WECKTX
     I              BEB0C7                          WEB0C7
     I              BEAETX                          WEAETX
     I              BEB1NA                          WEB1NA
     I              BEB3NA                          WEB3NA
     I              BEB4NA                          WEB4NA
     I              BEB2NA                          WEB2NA
     I              BEBHCD                          WEBHCD
     I              BEC8TX                          WEC8TX
     I              BEBCNA                          WEBCNA
     I              BEA0DT                          WEA0DT
     I              BEA5DT                          WEA5DT
     I              BEGNDT                          WEGNDT
     I              BEACDT                          WEACDT
     I              BEAQCD                          WEAQCD
     I              BEB6NA                          WEB6NA
     I              BEBYNA                          WEBYNA
     I              BEBZNA                          WEBZNA
     I              BEGTST                          WEGTST
     I              BEGVST                          WEGVST
     I              BEGUST                          WEGUST
     I              BEQFST                          WEQFST
     I              BECQCD                          WECQCD
     I              BEGJST                          WEGJST
     I              BEGWST                          WEGWST
     I              BEGXST                          WEGXST
     I              BEGYST                          WEGYST
     I              BEAODT                          WEAODT
     I              BEAIVN                          WEAIVN
     I              BECXDT                          WECXDT
     I              BEJZVA                          WEJZVA
     I              BEA1WG                          WEA1WG
     I              BEXIST                          WEXIST
     I              BEXJST                          WEXJST
     I              BEXKST                          WEXKST
     I              BEEIDT                          WEEIDT
     I              BEAFTM                          WEAFTM
     I              BEE8CD                          WEE8CD
     I              BEE9CD                          WEE9CD
     I              BERMNB                          WERMNB
     I              BETBNB                          WETBNB
     I              BER1NB                          WER1NB
     I              BEPJST                          WEPJST
     I              BEU0ST                          WEU0ST
     I              BEU1ST                          WEU1ST
     I              BEQ2CD                          WEQ2CD
     I              BEU2ST                          WEU2ST
     I              BEVEST                          WEVEST
     I              BEVFST                          WEVFST
     I              BEVGST                          WEVGST
     I              BERPCD                          WERPCD
     I              BERNNB                          WERNNB
     I              BEVDST                          WEVDST
     I              BEATIN                          WEATIN
     I              BEU4ST                          WEU4ST
     I              BEU5ST                          WEU5ST
     I              BERSRN                          WERSRN
     I              BEMHNA                          WEMHNA
     I              BEMINA                          WEMINA
     I              BEWBST                          WEWBST
     I              BER4CD                          WER4CD
     I              BEBFCD                          WEBFCD
     I              BEQ4CD                          WEQ4CD
     I              BET3NB                          WET3NB
     I              BESICD                          WESICD
     I              BECONB                          WECONB
     I              BECEST                          WECEST
     I              BEAWDT                          WEAWDT
     I              BEJPCD                          WEJPCD
     I              BEXUST                          WEXUST
     I              BEZ1ST                          WEZ1ST
     I              BEVRVA                          WEVRVA
     I              BEOBST                          WEOBST
     I              BEBCST                          WEBCST
     I              BEBDST                          WEBDST
     I              BEB7VL                          WEB7VL
     I              BEGASX                          WEGASX
     I              BEGBSX                          WEGBSX
     I              BEGCSX                          WEGCSX
     I              BEGDSX                          WEGDSX
     I              BEFNSX                          WEFNSX
     I              BEFOSX                          WEFOSX
     I              BEFPSX                          WEFPSX
     I              BEFQSX                          WEFQSX
     I              BEFRSX                          WEFRSX
     I              BEFSSX                          WEFSSX
     I              BEFTSX                          WEFTSX
     I              BEFUSX                          WEFUSX
     I              BEFVSX                          WEFVSX
     I              BEFWSX                          WEFWSX
     I              BEFXSX                          WEFXSX
     I              BEFYSX                          WEFYSX
     I              BENODT                          WENODT
     I              BENPDT                          WENPDT
     I              BENQDT                          WENQDT
     I              BENRDT                          WENRDT
     I              BENSDT                          WENSDT
     I              BEBPTM                          WEBPTM
     I              BEBQTM                          WEBQTM
     I              BEBRTM                          WEBRTM
     I              BEBSTM                          WEBSTM
     I              BEBTTM                          WEBTTM
     I              BEH0NX                          WEH0NX
     I              BEH1NX                          WEH1NX
     I              BEH2NX                          WEH2NX
     I              BEH3NX                          WEH3NX
     I              BEH4NX                          WEH4NX
     I              BEC0C7                          WEC0C7
     I              BEUVST                          WEUVST
     I              BEUWST                          WEUWST
     I              BEUXST                          WEUXST
     I              BEAATM                          WEAATM
     I              BEAYNA                          WEAYNA
     I              BEA0NA                          WEA0NA
     I              BEAXDT                          WEAXDT
      *
     I@BFCPZH
      * Order Header TRG          Load ID/Open Orders
      * Renamed input format fields
     I              BEAIC3                          WGAIC3
     I              BEC4NB                          WGC4NB
     I              BEJNCD                          WGJNCD
     I              BEANC7                          WGANC7
     I              BEBKC7                          WGBKC7
     I              BEBRTX                          WGBRTX
     I              BEHMNA                          WGHMNA
     I              BEHONA                          WGHONA
     I              BEHPNA                          WGHPNA
     I              BEHNNA                          WGHNNA
     I              BEDBCD                          WGDBCD
     I              BECKTX                          WGCKTX
     I              BEB0C7                          WGB0C7
     I              BEAETX                          WGAETX
     I              BEB1NA                          WGB1NA
     I              BEB3NA                          WGB3NA
     I              BEB4NA                          WGB4NA
     I              BEB2NA                          WGB2NA
     I              BEBHCD                          WGBHCD
     I              BEC8TX                          WGC8TX
     I              BEBCNA                          WGBCNA
     I              BEA0DT                          WGA0DT
     I              BEA5DT                          WGA5DT
     I              BEGNDT                          WGGNDT
     I              BEACDT                          WGACDT
     I              BEAQCD                          WGAQCD
     I              BEB6NA                          WGB6NA
     I              BEBYNA                          WGBYNA
     I              BEBZNA                          WGBZNA
     I              BEGTST                          WGGTST
     I              BEGVST                          WGGVST
     I              BEGUST                          WGGUST
     I              BEQFST                          WGQFST
     I              BECQCD                          WGCQCD
     I              BEGJST                          WGGJST
     I              BEGWST                          WGGWST
     I              BEGXST                          WGGXST
     I              BEGYST                          WGGYST
     I              BEAODT                          WGAODT
     I              BEAIVN                          WGAIVN
     I              BECXDT                          WGCXDT
     I              BEJZVA                          WGJZVA
     I              BEA1WG                          WGA1WG
     I              BEXIST                          WGXIST
     I              BEXJST                          WGXJST
     I              BEXKST                          WGXKST
     I              BEEIDT                          WGEIDT
     I              BEAFTM                          WGAFTM
     I              BEE8CD                          WGE8CD
     I              BEE9CD                          WGE9CD
     I              BERMNB                          WGRMNB
     I              BETBNB                          WGTBNB
     I              BER1NB                          WGR1NB
     I              BEPJST                          WGPJST
     I              BEU0ST                          WGU0ST
     I              BEU1ST                          WGU1ST
     I              BEQ2CD                          WGQ2CD
     I              BEU2ST                          WGU2ST
     I              BEVEST                          WGVEST
     I              BEVFST                          WGVFST
     I              BEVGST                          WGVGST
     I              BERPCD                          WGRPCD
     I              BERNNB                          WGRNNB
     I              BEVDST                          WGVDST
     I              BEATIN                          WGATIN
     I              BEU4ST                          WGU4ST
     I              BEU5ST                          WGU5ST
     I              BERSRN                          WGRSRN
     I              BEMHNA                          WGMHNA
     I              BEMINA                          WGMINA
     I              BEWBST                          WGWBST
     I              BER4CD                          WGR4CD
     I              BEBFCD                          WGBFCD
     I              BEQ4CD                          WGQ4CD
     I              BET3NB                          WGT3NB
     I              BESICD                          WGSICD
     I              BECONB                          WGCONB
     I              BECEST                          WGCEST
     I              BEAWDT                          WGAWDT
     I              BEJPCD                          WGJPCD
     I              BEXUST                          WGXUST
     I              BEZ1ST                          WGZ1ST
     I              BEVRVA                          WGVRVA
     I              BEOBST                          WGOBST
     I              BEBCST                          WGBCST
     I              BEBDST                          WGBDST
     I              BEB7VL                          WGB7VL
     I              BEGASX                          WGGASX
     I              BEGBSX                          WGGBSX
     I              BEGCSX                          WGGCSX
     I              BEGDSX                          WGGDSX
     I              BEFNSX                          WGFNSX
     I              BEFOSX                          WGFOSX
     I              BEFPSX                          WGFPSX
     I              BEFQSX                          WGFQSX
     I              BEFRSX                          WGFRSX
     I              BEFSSX                          WGFSSX
     I              BEFTSX                          WGFTSX
     I              BEFUSX                          WGFUSX
     I              BEFVSX                          WGFVSX
     I              BEFWSX                          WGFWSX
     I              BEFXSX                          WGFXSX
     I              BEFYSX                          WGFYSX
     I              BENODT                          WGNODT
     I              BENPDT                          WGNPDT
     I              BENQDT                          WGNQDT
     I              BENRDT                          WGNRDT
     I              BENSDT                          WGNSDT
     I              BEBPTM                          WGBPTM
     I              BEBQTM                          WGBQTM
     I              BEBRTM                          WGBRTM
     I              BEBSTM                          WGBSTM
     I              BEBTTM                          WGBTTM
     I              BEH0NX                          WGH0NX
     I              BEH1NX                          WGH1NX
     I              BEH2NX                          WGH2NX
     I              BEH3NX                          WGH3NX
     I              BEH4NX                          WGH4NX
     I              BEC0C7                          WGC0C7
     I              BEUVST                          WGUVST
     I              BEUWST                          WGUWST
     I              BEUXST                          WGUXST
     I              BEAATM                          WGAATM
     I              BEAYNA                          WGAYNA
     I              BEA0NA                          WGA0NA
     I              BEAXDT                          WGAXDT
      *
     I@FJCPSB
      * Load Header               Load Only
      * Renamed input format fields
     I              FJRMNB                          WHRMNB
     I              FJAIC3                          WHAIC3
     I              FJAODT                          WHAODT
     I              FJPJST                          WHPJST
     I              FJPKST                          WHPKST
     I              FJRNNB                          WHRNNB
     I              FJDMTX                          WHDMTX
     I              FJDNTX                          WHDNTX
     I              FJDOTX                          WHDOTX
     I              FJWTTX                          WHWTTX
     I              FJWUTX                          WHWUTX
     I              FJRPNB                          WHRPNB
     I              FJFLAM                          WHFLAM
     I              FJXQST                          WHXQST
     I              FJRRNB                          WHRRNB
     I              FJDXTX                          WHDXTX
     I              FJDYTX                          WHDYTX
     I              FJSBNB                          WHSBNB
     I              FJBZNA                          WHBZNA
     I              FJRONB                          WHRONB
     I              FJSQNB                          WHSQNB
     I              FJR1NB                          WHR1NB
     I              FJVCST                          WHVCST
     I              FJVDST                          WHVDST
     I              FJSDNB                          WHSDNB
     I              FJPAOU                          WHPAOU
     I              FJDGWG                          WHDGWG
     I              FJSXNB                          WHSXNB
     I              FJHADT                          WHHADT
     I              FJAART                          WHAART
     I              FJDHWG                          WHDHWG
     I              FJDIWG                          WHDIWG
     I              FJAQDT                          WHAQDT
     I              FJS6NB                          WHS6NB
     I              FJT4NB                          WHT4NB
     I              FJPRTM                          WHPRTM
     I              FJNPSV                          WHNPSV
     I              FJJ8TX                          WHJ8TX
     I              FJTLMI                          WHTLMI
     I              FJJ9TX                          WHJ9TX
     I              FJQ2CD                          WHQ2CD
     I              FJVPCD                          WHVPCD
     I              FJDBCD                          WHDBCD
     I              FJGRWE                          WHGRWE
     I              FJXCCD                          WHXCCD
     I              FJU2ST                          WHU2ST
     I              FJF9DT                          WHF9DT
     I              FJONTM                          WHONTM
     I              FJJ4DT                          WHJ4DT
     I              FJTRTM                          WHTRTM
     I              FJJ5DT                          WHJ5DT
     I              FJSPTM                          WHSPTM
     I              FJJ6DT                          WHJ6DT
     I              FJLFTM                          WHLFTM
     I              FJJ7DT                          WHJ7DT
     I              FJBOTM                          WHBOTM
     I              FJJ8DT                          WHJ8DT
     I              FJBLTM                          WHBLTM
     I              FJKIDT                          WHKIDT
     I              FJASTM                          WHASTM
     I              FJKADT                          WHKADT
     I              FJAJCM                          WHAJCM
     I              FJXACD                          WHXACD
     I              FJOANA                          WHOANA
     I              FJK4TX                          WHK4TX
     I              FJVOAG                          WHVOAG
     I              FJKBDT                          WHKBDT
     I              FJNBBO                          WHNBBO
     I              FJW4CD                          WHW4CD
     I              FJEFDT                          WHEFDT
     I              FJCNTN                          WHCNTN
     I              FJKCDT                          WHKCDT
     I              FJTMIN                          WHTMIN
     I              FJKDDT                          WHKDDT
     I              FJVMNB                          WHVMNB
     I              FJOCFR                          WHOCFR
     I              FJKJDT                          WHKJDT
     I              FJATTM                          WHATTM
     I              FJOTRS                          WHOTRS
     I              FJRNST                          WHRNST
     I              FJBRBK                          WHBRBK
     I              FJEIDT                          WHEIDT
     I              FJRMST                          WHRMST
     I              FJAJCD                          WHAJCD
     I              FJKKDT                          WHKKDT
     I              FJAVTM                          WHAVTM
     I              FJKZDT                          WHKZDT
     I              FJAXTM                          WHAXTM
     I              FJLHOS                          WHLHOS
     I              FJLHOR                          WHLHOR
     I              FJWNTX                          WHWNTX
     I              FJOITX                          WHOITX
     I              FJOJTX                          WHOJTX
     I              FJLLDT                          WHLLDT
     I              FJLSHG                          WHLSHG
     I              FJYPST                          WHYPST
     I              FJK0DT                          WHK0DT
     I              FJAYTM                          WHAYTM
     I              FJKNNX                          WHKNNX
     I              FJICWG                          WHICWG
     I              FJIDWG                          WHIDWG
     I              FJH9SX                          WHH9SX
     I              FJWOTX                          WHWOTX
     I              FJK1DT                          WHK1DT
     I              FJAZTM                          WHAZTM
     I              FJK2DT                          WHK2DT
     I              FJA0TM                          WHA0TM
     I              FJROST                          WHROST
     I              FJRPST                          WHRPST
     I              FJRQST                          WHRQST
     I              FJRRST                          WHRRST
     I              FJZBVA                          WHZBVA
     I              FJWPTX                          WHWPTX
     I              FJWQTX                          WHWQTX
     I              FJWRTX                          WHWRTX
     I              FJWSTX                          WHWSTX
     I              FJRVSX                          WHRVSX
     I              FJRUSX                          WHRUSX
     I              FJRWSX                          WHRWSX
     I              FJRXSX                          WHRXSX
     I              FJRYSX                          WHRYSX
     I              FJRZSX                          WHRZSX
     I              FJR0SX                          WHR0SX
     I              FJR1SX                          WHR1SX
     I              FJR2SX                          WHR2SX
     I              FJR3SX                          WHR3SX
     I              FJR4SX                          WHR4SX
     I              FJPYDT                          WHPYDT
     I              FJCKTM                          WHCKTM
     I              FJPZDT                          WHPZDT
     I              FJCLTM                          WHCLTM
     I              FJP0DT                          WHP0DT
     I              FJCMTM                          WHCMTM
     I              FJP1DT                          WHP1DT
     I              FJCNTM                          WHCNTM
     I              FJP2DT                          WHP2DT
     I              FJCOTM                          WHCOTM
     I              FJP3DT                          WHP3DT
     I              FJCQTM                          WHCQTM
     I              FJUVST                          WHUVST
     I              FJUWST                          WHUWST
     I              FJUXST                          WHUXST
     I              FJAATM                          WHAATM
     I              FJAYNA                          WHAYNA
     I              FJA0NA                          WHA0NA
     I              FJAXDT                          WHAXDT
      *
     I@FLCPEB
      * Load Detail               Load/Stop/Order
      * Renamed input format fields
     I              FLRMNB                          WIRMNB
     I              FLRUNB                          WIRUNB
     I              FLRVNB                          WIRVNB
     I              FLDQTX                          WIDQTX
     I              FLRWNB                          WIRWNB
     I              FLRXNB                          WIRXNB
     I              FLSQNB                          WISQNB
     I              FLT0NB                          WIT0NB
     I              FLT1NB                          WIT1NB
     I              FLR1NB                          WIR1NB
     I              FLAIC3                          WIAIC3
     I              FLC4NB                          WIC4NB
     I              FLVCST                          WIVCST
     I              FLKEDT                          WIKEDT
     I              FLSXNB                          WISXNB
     I              FLKFDT                          WIKFDT
     I              FLACTM                          WIACTM
     I              FLK5TX                          WIK5TX
     I              FLW5CD                          WIW5CD
     I              FLEJDT                          WIEJDT
     I              FLAGTM                          WIAGTM
     I              FLKJDT                          WIKJDT
     I              FLATTM                          WIATTM
     I              FLHDDT                          WIHDDT
     I              FLAUTM                          WIAUTM
     I              FLKKDT                          WIKKDT
     I              FLAVTM                          WIAVTM
     I              FLZ4NB                          WIZ4NB
     I              FLY7ST                          WIY7ST
     I              FLY2ST                          WIY2ST
     I              FLWHTX                          WIWHTX
     I              FLWITX                          WIWITX
     I              FLWJTX                          WIWJTX
     I              FLWKTX                          WIWKTX
     I              FLWLTX                          WIWLTX
     I              FLN7DT                          WIN7DT
     I              FLN8DT                          WIN8DT
     I              FLN9DT                          WIN9DT
     I              FLB3TM                          WIB3TM
     I              FLB4TM                          WIB4TM
     I              FLB5TM                          WIB5TM
     I              FLIASX                          WIIASX
     I              FLIBSX                          WIIBSX
     I              FLICSX                          WIICSX
     I              FLWVTX                          WIWVTX
     I              FLWWTX                          WIWWTX
     I              FLWXTX                          WIWXTX
     I              FLUVST                          WIUVST
     I              FLUWST                          WIUWST
     I              FLUXST                          WIUXST
     I              FLAATM                          WIAATM
     I              FLAYNA                          WIAYNA
     I              FLA0NA                          WIA0NA
     I              FLAXDT                          WIAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WJAIC3
     I              OMC4NB                          WJC4NB
     I              OMDPNB                          WJDPNB
     I              OMUENB                          WJUENB
     I              OMHGCD                          WJHGCD
     I              OMAJCD                          WJAJCD
     I              OMBKC7                          WJBKC7
     I              OMCFC7                          WJCFC7
     I              OMGMST                          WJGMST
     I              OMGNST                          WJGNST
     I              OMMAVA                          WJMAVA
     I              OMKDVA                          WJKDVA
     I              OML8VA                          WJL8VA
     I              OML9VA                          WJL9VA
     I              OMGTST                          WJGTST
     I              OMGVST                          WJGVST
     I              OMGUST                          WJGUST
     I              OMQFST                          WJQFST
     I              OMAYVA                          WJAYVA
     I              OMEXDT                          WJEXDT
     I              OMLQCD                          WJLQCD
     I              OMRDCD                          WJRDCD
     I              OMQ7CD                          WJQ7CD
     I              OMBZPR                          WJBZPR
     I              OML6NB                          WJL6NB
     I              OMU1ST                          WJU1ST
     I              OMGIDT                          WJGIDT
     I              OMCRCD                          WJCRCD
     I              OMAGCD                          WJAGCD
     I              OMRZST                          WJRZST
     I              OMR0ST                          WJR0ST
     I              OMR1ST                          WJR1ST
     I              OMG7NA                          WJG7NA
     I              OMG8NA                          WJG8NA
     I              OMRPCD                          WJRPCD
     I              OMVEST                          WJVEST
     I              OMVGST                          WJVGST
     I              OMAVST                          WJAVST
     I              OMU0ST                          WJU0ST
     I              OMRFCD                          WJRFCD
     I              OMFZST                          WJFZST
     I              OMR1NB                          WJR1NB
     I              OMAVQT                          WJAVQT
     I              OMD0WG                          WJD0WG
     I              OMCCQT                          WJCCQT
     I              OMAUWG                          WJAUWG
     I              OMCBQT                          WJCBQT
     I              OMATWG                          WJATWG
     I              OMAQCS                          WJAQCS
     I              OMAGCS                          WJAGCS
     I              OMAKPR                          WJAKPR
     I              OMALPR                          WJALPR
     I              OMAUPR                          WJAUPR
     I              OMAVWG                          WJAVWG
     I              OMA4WG                          WJA4WG
     I              OMA5DT                          WJA5DT
     I              OMAODT                          WJAODT
     I              OMGNDT                          WJGNDT
     I              OMAMST                          WJAMST
     I              OMANST                          WJANST
     I              OMVAST                          WJVAST
     I              OMRGNB                          WJRGNB
     I              OMRHNB                          WJRHNB
     I              OMRINB                          WJRINB
     I              OMRBCD                          WJRBCD
     I              OMHICD                          WJHICD
     I              OMRNCD                          WJRNCD
     I              OMROCD                          WJROCD
     I              OMCXDT                          WJCXDT
     I              OMAJVN                          WJAJVN
     I              OMKXCD                          WJKXCD
     I              OMJPCD                          WJJPCD
     I              OMCQCD                          WJCQCD
     I              OMR4CD                          WJR4CD
     I              OMZ1ST                          WJZ1ST
     I              OMZ3ST                          WJZ3ST
     I              OMZ4ST                          WJZ4ST
     I              OMDUPR                          WJDUPR
     I              OMB6VL                          WJB6VL
     I              OMA1AA                          WJA1AA
     I              OMFZSX                          WJFZSX
     I              OMF0SX                          WJF0SX
     I              OMF1SX                          WJF1SX
     I              OMF2SX                          WJF2SX
     I              OMF3SX                          WJF3SX
     I              OMF4SX                          WJF4SX
     I              OMF5SX                          WJF5SX
     I              OMF6SX                          WJF6SX
     I              OMF7SX                          WJF7SX
     I              OMNTDT                          WJNTDT
     I              OMNUDT                          WJNUDT
     I              OMNVDT                          WJNVDT
     I              OMNWDT                          WJNWDT
     I              OMNXDT                          WJNXDT
     I              OMBUTM                          WJBUTM
     I              OMBVTM                          WJBVTM
     I              OMBWTM                          WJBWTM
     I              OMBXTM                          WJBXTM
     I              OMBYTM                          WJBYTM
     I              OMH5NX                          WJH5NX
     I              OMH6NX                          WJH6NX
     I              OMH7NX                          WJH7NX
     I              OMH8NX                          WJH8NX
     I              OMH9NX                          WJH9NX
     I              OMDVPR                          WJDVPR
     I              OMDWPR                          WJDWPR
     I              OMDXPR                          WJDXPR
     I              OMDYPR                          WJDYPR
     I              OMDZPR                          WJDZPR
     I              OMGSPR                          WJGSPR
     I              OMGTPR                          WJGTPR
     I              OMGUPR                          WJGUPR
     I              OMHOST                          WJHOST
     I              OMHPST                          WJHPST
     I              OMIOST                          WJIOST
     I              OMPEWG                          WJPEWG
     I              OMRINY                          WJRINY
     I              OMTIDT                          WJTIDT
     I              OMTJDT                          WJTJDT
     I              OMH2ST                          WJH2ST
     I              OMH0ST                          WJH0ST
     I              OMH1ST                          WJH1ST
     I              OMTKDT                          WJTKDT
     I              OMTLDT                          WJTLDT
     I              OMTMDT                          WJTMDT
     I              OMUVST                          WJUVST
     I              OMUWST                          WJUWST
     I              OMUXST                          WJUXST
     I              OMAATM                          WJAATM
     I              OMAYNA                          WJAYNA
     I              OMA0NA                          WJA0NA
     I              OMAXDT                          WJAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WKAIC3
     I              OMC4NB                          WKC4NB
     I              OMDPNB                          WKDPNB
     I              OMUENB                          WKUENB
     I              OMHGCD                          WKHGCD
     I              OMAJCD                          WKAJCD
     I              OMBKC7                          WKBKC7
     I              OMCFC7                          WKCFC7
     I              OMGMST                          WKGMST
     I              OMGNST                          WKGNST
     I              OMMAVA                          WKMAVA
     I              OMKDVA                          WKKDVA
     I              OML8VA                          WKL8VA
     I              OML9VA                          WKL9VA
     I              OMGTST                          WKGTST
     I              OMGVST                          WKGVST
     I              OMGUST                          WKGUST
     I              OMQFST                          WKQFST
     I              OMAYVA                          WKAYVA
     I              OMEXDT                          WKEXDT
     I              OMLQCD                          WKLQCD
     I              OMRDCD                          WKRDCD
     I              OMQ7CD                          WKQ7CD
     I              OMBZPR                          WKBZPR
     I              OML6NB                          WKL6NB
     I              OMU1ST                          WKU1ST
     I              OMGIDT                          WKGIDT
     I              OMCRCD                          WKCRCD
     I              OMAGCD                          WKAGCD
     I              OMRZST                          WKRZST
     I              OMR0ST                          WKR0ST
     I              OMR1ST                          WKR1ST
     I              OMG7NA                          WKG7NA
     I              OMG8NA                          WKG8NA
     I              OMRPCD                          WKRPCD
     I              OMVEST                          WKVEST
     I              OMVGST                          WKVGST
     I              OMAVST                          WKAVST
     I              OMU0ST                          WKU0ST
     I              OMRFCD                          WKRFCD
     I              OMFZST                          WKFZST
     I              OMR1NB                          WKR1NB
     I              OMAVQT                          WKAVQT
     I              OMD0WG                          WKD0WG
     I              OMCCQT                          WKCCQT
     I              OMAUWG                          WKAUWG
     I              OMCBQT                          WKCBQT
     I              OMATWG                          WKATWG
     I              OMAQCS                          WKAQCS
     I              OMAGCS                          WKAGCS
     I              OMAKPR                          WKAKPR
     I              OMALPR                          WKALPR
     I              OMAUPR                          WKAUPR
     I              OMAVWG                          WKAVWG
     I              OMA4WG                          WKA4WG
     I              OMA5DT                          WKA5DT
     I              OMAODT                          WKAODT
     I              OMGNDT                          WKGNDT
     I              OMAMST                          WKAMST
     I              OMANST                          WKANST
     I              OMVAST                          WKVAST
     I              OMRGNB                          WKRGNB
     I              OMRHNB                          WKRHNB
     I              OMRINB                          WKRINB
     I              OMRBCD                          WKRBCD
     I              OMHICD                          WKHICD
     I              OMRNCD                          WKRNCD
     I              OMROCD                          WKROCD
     I              OMCXDT                          WKCXDT
     I              OMAJVN                          WKAJVN
     I              OMKXCD                          WKKXCD
     I              OMJPCD                          WKJPCD
     I              OMCQCD                          WKCQCD
     I              OMR4CD                          WKR4CD
     I              OMZ1ST                          WKZ1ST
     I              OMZ3ST                          WKZ3ST
     I              OMZ4ST                          WKZ4ST
     I              OMDUPR                          WKDUPR
     I              OMB6VL                          WKB6VL
     I              OMA1AA                          WKA1AA
     I              OMFZSX                          WKFZSX
     I              OMF0SX                          WKF0SX
     I              OMF1SX                          WKF1SX
     I              OMF2SX                          WKF2SX
     I              OMF3SX                          WKF3SX
     I              OMF4SX                          WKF4SX
     I              OMF5SX                          WKF5SX
     I              OMF6SX                          WKF6SX
     I              OMF7SX                          WKF7SX
     I              OMNTDT                          WKNTDT
     I              OMNUDT                          WKNUDT
     I              OMNVDT                          WKNVDT
     I              OMNWDT                          WKNWDT
     I              OMNXDT                          WKNXDT
     I              OMBUTM                          WKBUTM
     I              OMBVTM                          WKBVTM
     I              OMBWTM                          WKBWTM
     I              OMBXTM                          WKBXTM
     I              OMBYTM                          WKBYTM
     I              OMH5NX                          WKH5NX
     I              OMH6NX                          WKH6NX
     I              OMH7NX                          WKH7NX
     I              OMH8NX                          WKH8NX
     I              OMH9NX                          WKH9NX
     I              OMDVPR                          WKDVPR
     I              OMDWPR                          WKDWPR
     I              OMDXPR                          WKDXPR
     I              OMDYPR                          WKDYPR
     I              OMDZPR                          WKDZPR
     I              OMGSPR                          WKGSPR
     I              OMGTPR                          WKGTPR
     I              OMGUPR                          WKGUPR
     I              OMHOST                          WKHOST
     I              OMHPST                          WKHPST
     I              OMIOST                          WKIOST
     I              OMPEWG                          WKPEWG
     I              OMRINY                          WKRINY
     I              OMTIDT                          WKTIDT
     I              OMTJDT                          WKTJDT
     I              OMH2ST                          WKH2ST
     I              OMH0ST                          WKH0ST
     I              OMH1ST                          WKH1ST
     I              OMTKDT                          WKTKDT
     I              OMTLDT                          WKTLDT
     I              OMTMDT                          WKTMDT
     I              OMUVST                          WKUVST
     I              OMUWST                          WKUWST
     I              OMUXST                          WKUXST
     I              OMAATM                          WKAATM
     I              OMAYNA                          WKAYNA
     I              OMA0NA                          WKA0NA
     I              OMAXDT                          WKAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WLAIC3
     I              BEC4NB                          WLC4NB
     I              BEJNCD                          WLJNCD
     I              BEANC7                          WLANC7
     I              BEBKC7                          WLBKC7
     I              BEBRTX                          WLBRTX
     I              BEHMNA                          WLHMNA
     I              BEHONA                          WLHONA
     I              BEHPNA                          WLHPNA
     I              BEHNNA                          WLHNNA
     I              BEDBCD                          WLDBCD
     I              BECKTX                          WLCKTX
     I              BEB0C7                          WLB0C7
     I              BEAETX                          WLAETX
     I              BEB1NA                          WLB1NA
     I              BEB3NA                          WLB3NA
     I              BEB4NA                          WLB4NA
     I              BEB2NA                          WLB2NA
     I              BEBHCD                          WLBHCD
     I              BEC8TX                          WLC8TX
     I              BEBCNA                          WLBCNA
     I              BEA0DT                          WLA0DT
     I              BEA5DT                          WLA5DT
     I              BEGNDT                          WLGNDT
     I              BEACDT                          WLACDT
     I              BEAQCD                          WLAQCD
     I              BEB6NA                          WLB6NA
     I              BEBYNA                          WLBYNA
     I              BEBZNA                          WLBZNA
     I              BEGTST                          WLGTST
     I              BEGVST                          WLGVST
     I              BEGUST                          WLGUST
     I              BEQFST                          WLQFST
     I              BECQCD                          WLCQCD
     I              BEGJST                          WLGJST
     I              BEGWST                          WLGWST
     I              BEGXST                          WLGXST
     I              BEGYST                          WLGYST
     I              BEAODT                          WLAODT
     I              BEAIVN                          WLAIVN
     I              BECXDT                          WLCXDT
     I              BEJZVA                          WLJZVA
     I              BEA1WG                          WLA1WG
     I              BEXIST                          WLXIST
     I              BEXJST                          WLXJST
     I              BEXKST                          WLXKST
     I              BEEIDT                          WLEIDT
     I              BEAFTM                          WLAFTM
     I              BEE8CD                          WLE8CD
     I              BEE9CD                          WLE9CD
     I              BERMNB                          WLRMNB
     I              BETBNB                          WLTBNB
     I              BER1NB                          WLR1NB
     I              BEPJST                          WLPJST
     I              BEU0ST                          WLU0ST
     I              BEU1ST                          WLU1ST
     I              BEQ2CD                          WLQ2CD
     I              BEU2ST                          WLU2ST
     I              BEVEST                          WLVEST
     I              BEVFST                          WLVFST
     I              BEVGST                          WLVGST
     I              BERPCD                          WLRPCD
     I              BERNNB                          WLRNNB
     I              BEVDST                          WLVDST
     I              BEATIN                          WLATIN
     I              BEU4ST                          WLU4ST
     I              BEU5ST                          WLU5ST
     I              BERSRN                          WLRSRN
     I              BEMHNA                          WLMHNA
     I              BEMINA                          WLMINA
     I              BEWBST                          WLWBST
     I              BER4CD                          WLR4CD
     I              BEBFCD                          WLBFCD
     I              BEQ4CD                          WLQ4CD
     I              BET3NB                          WLT3NB
     I              BESICD                          WLSICD
     I              BECONB                          WLCONB
     I              BECEST                          WLCEST
     I              BEAWDT                          WLAWDT
     I              BEJPCD                          WLJPCD
     I              BEXUST                          WLXUST
     I              BEZ1ST                          WLZ1ST
     I              BEVRVA                          WLVRVA
     I              BEOBST                          WLOBST
     I              BEBCST                          WLBCST
     I              BEBDST                          WLBDST
     I              BEB7VL                          WLB7VL
     I              BEGASX                          WLGASX
     I              BEGBSX                          WLGBSX
     I              BEGCSX                          WLGCSX
     I              BEGDSX                          WLGDSX
     I              BEFNSX                          WLFNSX
     I              BEFOSX                          WLFOSX
     I              BEFPSX                          WLFPSX
     I              BEFQSX                          WLFQSX
     I              BEFRSX                          WLFRSX
     I              BEFSSX                          WLFSSX
     I              BEFTSX                          WLFTSX
     I              BEFUSX                          WLFUSX
     I              BEFVSX                          WLFVSX
     I              BEFWSX                          WLFWSX
     I              BEFXSX                          WLFXSX
     I              BEFYSX                          WLFYSX
     I              BENODT                          WLNODT
     I              BENPDT                          WLNPDT
     I              BENQDT                          WLNQDT
     I              BENRDT                          WLNRDT
     I              BENSDT                          WLNSDT
     I              BEBPTM                          WLBPTM
     I              BEBQTM                          WLBQTM
     I              BEBRTM                          WLBRTM
     I              BEBSTM                          WLBSTM
     I              BEBTTM                          WLBTTM
     I              BEH0NX                          WLH0NX
     I              BEH1NX                          WLH1NX
     I              BEH2NX                          WLH2NX
     I              BEH3NX                          WLH3NX
     I              BEH4NX                          WLH4NX
     I              BEC0C7                          WLC0C7
     I              BEUVST                          WLUVST
     I              BEUWST                          WLUWST
     I              BEUXST                          WLUXST
     I              BEAATM                          WLAATM
     I              BEAYNA                          WLAYNA
     I              BEA0NA                          WLA0NA
     I              BEAXDT                          WLAXDT
      *
     I@BFCPMC
      * Order Header TRG          Load Exports
      * Renamed input format fields
     I              BEAIC3                          WMAIC3
     I              BEC4NB                          WMC4NB
     I              BEJNCD                          WMJNCD
     I              BEANC7                          WMANC7
     I              BEBKC7                          WMBKC7
     I              BEBRTX                          WMBRTX
     I              BEHMNA                          WMHMNA
     I              BEHONA                          WMHONA
     I              BEHPNA                          WMHPNA
     I              BEHNNA                          WMHNNA
     I              BEDBCD                          WMDBCD
     I              BECKTX                          WMCKTX
     I              BEB0C7                          WMB0C7
     I              BEAETX                          WMAETX
     I              BEB1NA                          WMB1NA
     I              BEB3NA                          WMB3NA
     I              BEB4NA                          WMB4NA
     I              BEB2NA                          WMB2NA
     I              BEBHCD                          WMBHCD
     I              BEC8TX                          WMC8TX
     I              BEBCNA                          WMBCNA
     I              BEA0DT                          WMA0DT
     I              BEA5DT                          WMA5DT
     I              BEGNDT                          WMGNDT
     I              BEACDT                          WMACDT
     I              BEAQCD                          WMAQCD
     I              BEB6NA                          WMB6NA
     I              BEBYNA                          WMBYNA
     I              BEBZNA                          WMBZNA
     I              BEGTST                          WMGTST
     I              BEGVST                          WMGVST
     I              BEGUST                          WMGUST
     I              BEQFST                          WMQFST
     I              BECQCD                          WMCQCD
     I              BEGJST                          WMGJST
     I              BEGWST                          WMGWST
     I              BEGXST                          WMGXST
     I              BEGYST                          WMGYST
     I              BEAODT                          WMAODT
     I              BEAIVN                          WMAIVN
     I              BECXDT                          WMCXDT
     I              BEJZVA                          WMJZVA
     I              BEA1WG                          WMA1WG
     I              BEXIST                          WMXIST
     I              BEXJST                          WMXJST
     I              BEXKST                          WMXKST
     I              BEEIDT                          WMEIDT
     I              BEAFTM                          WMAFTM
     I              BEE8CD                          WME8CD
     I              BEE9CD                          WME9CD
     I              BERMNB                          WMRMNB
     I              BETBNB                          WMTBNB
     I              BER1NB                          WMR1NB
     I              BEPJST                          WMPJST
     I              BEU0ST                          WMU0ST
     I              BEU1ST                          WMU1ST
     I              BEQ2CD                          WMQ2CD
     I              BEU2ST                          WMU2ST
     I              BEVEST                          WMVEST
     I              BEVFST                          WMVFST
     I              BEVGST                          WMVGST
     I              BERPCD                          WMRPCD
     I              BERNNB                          WMRNNB
     I              BEVDST                          WMVDST
     I              BEATIN                          WMATIN
     I              BEU4ST                          WMU4ST
     I              BEU5ST                          WMU5ST
     I              BERSRN                          WMRSRN
     I              BEMHNA                          WMMHNA
     I              BEMINA                          WMMINA
     I              BEWBST                          WMWBST
     I              BER4CD                          WMR4CD
     I              BEBFCD                          WMBFCD
     I              BEQ4CD                          WMQ4CD
     I              BET3NB                          WMT3NB
     I              BESICD                          WMSICD
     I              BECONB                          WMCONB
     I              BECEST                          WMCEST
     I              BEAWDT                          WMAWDT
     I              BEJPCD                          WMJPCD
     I              BEXUST                          WMXUST
     I              BEZ1ST                          WMZ1ST
     I              BEVRVA                          WMVRVA
     I              BEOBST                          WMOBST
     I              BEBCST                          WMBCST
     I              BEBDST                          WMBDST
     I              BEB7VL                          WMB7VL
     I              BEGASX                          WMGASX
     I              BEGBSX                          WMGBSX
     I              BEGCSX                          WMGCSX
     I              BEGDSX                          WMGDSX
     I              BEFNSX                          WMFNSX
     I              BEFOSX                          WMFOSX
     I              BEFPSX                          WMFPSX
     I              BEFQSX                          WMFQSX
     I              BEFRSX                          WMFRSX
     I              BEFSSX                          WMFSSX
     I              BEFTSX                          WMFTSX
     I              BEFUSX                          WMFUSX
     I              BEFVSX                          WMFVSX
     I              BEFWSX                          WMFWSX
     I              BEFXSX                          WMFXSX
     I              BEFYSX                          WMFYSX
     I              BENODT                          WMNODT
     I              BENPDT                          WMNPDT
     I              BENQDT                          WMNQDT
     I              BENRDT                          WMNRDT
     I              BENSDT                          WMNSDT
     I              BEBPTM                          WMBPTM
     I              BEBQTM                          WMBQTM
     I              BEBRTM                          WMBRTM
     I              BEBSTM                          WMBSTM
     I              BEBTTM                          WMBTTM
     I              BEH0NX                          WMH0NX
     I              BEH1NX                          WMH1NX
     I              BEH2NX                          WMH2NX
     I              BEH3NX                          WMH3NX
     I              BEH4NX                          WMH4NX
     I              BEC0C7                          WMC0C7
     I              BEUVST                          WMUVST
     I              BEUWST                          WMUWST
     I              BEUXST                          WMUXST
     I              BEAATM                          WMAATM
     I              BEAYNA                          WMAYNA
     I              BEA0NA                          WMA0NA
     I              BEAXDT                          WMAXDT
      *
     I@FLCPKF
      * Load Detail               Co/Load/Order
      * Renamed input format fields
     I              FLRMNB                          WORMNB
     I              FLRUNB                          WORUNB
     I              FLRVNB                          WORVNB
     I              FLDQTX                          WODQTX
     I              FLRWNB                          WORWNB
     I              FLRXNB                          WORXNB
     I              FLSQNB                          WOSQNB
     I              FLT0NB                          WOT0NB
     I              FLT1NB                          WOT1NB
     I              FLR1NB                          WOR1NB
     I              FLAIC3                          WOAIC3
     I              FLC4NB                          WOC4NB
     I              FLVCST                          WOVCST
     I              FLKEDT                          WOKEDT
     I              FLSXNB                          WOSXNB
     I              FLKFDT                          WOKFDT
     I              FLACTM                          WOACTM
     I              FLK5TX                          WOK5TX
     I              FLW5CD                          WOW5CD
     I              FLEJDT                          WOEJDT
     I              FLAGTM                          WOAGTM
     I              FLKJDT                          WOKJDT
     I              FLATTM                          WOATTM
     I              FLHDDT                          WOHDDT
     I              FLAUTM                          WOAUTM
     I              FLKKDT                          WOKKDT
     I              FLAVTM                          WOAVTM
     I              FLZ4NB                          WOZ4NB
     I              FLY7ST                          WOY7ST
     I              FLY2ST                          WOY2ST
     I              FLWHTX                          WOWHTX
     I              FLWITX                          WOWITX
     I              FLWJTX                          WOWJTX
     I              FLWKTX                          WOWKTX
     I              FLWLTX                          WOWLTX
     I              FLN7DT                          WON7DT
     I              FLN8DT                          WON8DT
     I              FLN9DT                          WON9DT
     I              FLB3TM                          WOB3TM
     I              FLB4TM                          WOB4TM
     I              FLB5TM                          WOB5TM
     I              FLIASX                          WOIASX
     I              FLIBSX                          WOIBSX
     I              FLICSX                          WOICSX
     I              FLWVTX                          WOWVTX
     I              FLWWTX                          WOWWTX
     I              FLWXTX                          WOWXTX
     I              FLUVST                          WOUVST
     I              FLUWST                          WOUWST
     I              FLUXST                          WOUXST
     I              FLAATM                          WOAATM
     I              FLAYNA                          WOAYNA
     I              FLA0NA                          WOA0NA
     I              FLAXDT                          WOAXDT
      *
     I@FLCPBM
      * Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WRRMNB
     I              FLRUNB                          WRRUNB
     I              FLRVNB                          WRRVNB
     I              FLDQTX                          WRDQTX
     I              FLRWNB                          WRRWNB
     I              FLRXNB                          WRRXNB
     I              FLSQNB                          WRSQNB
     I              FLT0NB                          WRT0NB
     I              FLT1NB                          WRT1NB
     I              FLR1NB                          WRR1NB
     I              FLAIC3                          WRAIC3
     I              FLC4NB                          WRC4NB
     I              FLVCST                          WRVCST
     I              FLKEDT                          WRKEDT
     I              FLSXNB                          WRSXNB
     I              FLKFDT                          WRKFDT
     I              FLACTM                          WRACTM
     I              FLK5TX                          WRK5TX
     I              FLW5CD                          WRW5CD
     I              FLEJDT                          WREJDT
     I              FLAGTM                          WRAGTM
     I              FLKJDT                          WRKJDT
     I              FLATTM                          WRATTM
     I              FLHDDT                          WRHDDT
     I              FLAUTM                          WRAUTM
     I              FLKKDT                          WRKKDT
     I              FLAVTM                          WRAVTM
     I              FLZ4NB                          WRZ4NB
     I              FLY7ST                          WRY7ST
     I              FLY2ST                          WRY2ST
     I              FLWHTX                          WRWHTX
     I              FLWITX                          WRWITX
     I              FLWJTX                          WRWJTX
     I              FLWKTX                          WRWKTX
     I              FLWLTX                          WRWLTX
     I              FLN7DT                          WRN7DT
     I              FLN8DT                          WRN8DT
     I              FLN9DT                          WRN9DT
     I              FLB3TM                          WRB3TM
     I              FLB4TM                          WRB4TM
     I              FLB5TM                          WRB5TM
     I              FLIASX                          WRIASX
     I              FLIBSX                          WRIBSX
     I              FLICSX                          WRICSX
     I              FLWVTX                          WRWVTX
     I              FLWWTX                          WRWWTX
     I              FLWXTX                          WRWXTX
     I              FLUVST                          WRUVST
     I              FLUWST                          WRUWST
     I              FLUXST                          WRUXST
     I              FLAATM                          WRAATM
     I              FLAYNA                          WRAYNA
     I              FLA0NA                          WRA0NA
     I              FLAXDT                          WRAXDT
      *
     I@EYCPY2
      * Order Events              Retrieval index       NV
      * Renamed input format fields
     I              EYAIC3                          WSAIC3
     I              EYC4NB                          WSC4NB
     I              EYQ2NB                          WSQ2NB
     I              EYJPCD                          WSJPCD
     I              EYAUC3                          WSAUC3
     I              EYQ7NB                          WSQ7NB
     I              EYOMST                          WSOMST
     I              EYD2DT                          WSD2DT
     I              EYONST                          WSONST
     I              EYOOST                          WSOOST
     I              EYOPST                          WSOPST
     I              EYAWC3                          WSAWC3
     I              EYQ8NB                          WSQ8NB
     I              EYQ9NB                          WSQ9NB
     I              EYBKC7                          WSBKC7
     I              EYUVST                          WSUVST
     I              EYUWST                          WSUWST
     I              EYUXST                          WSUXST
     I              EYAATM                          WSAATM
     I              EYAYNA                          WSAYNA
     I              EYA0NA                          WSA0NA
     I              EYAXDT                          WSAXDT
      *
     I@EYCPZR
      * Order Events              Customer/Order/Event   N
      * Renamed input format fields
     I              EYAIC3                          WTAIC3
     I              EYC4NB                          WTC4NB
     I              EYQ2NB                          WTQ2NB
     I              EYJPCD                          WTJPCD
     I              EYAUC3                          WTAUC3
     I              EYQ7NB                          WTQ7NB
     I              EYOMST                          WTOMST
     I              EYD2DT                          WTD2DT
     I              EYONST                          WTONST
     I              EYOOST                          WTOOST
     I              EYOPST                          WTOPST
     I              EYAWC3                          WTAWC3
     I              EYQ8NB                          WTQ8NB
     I              EYQ9NB                          WTQ9NB
     I              EYBKC7                          WTBKC7
     I              EYUVST                          WTUVST
     I              EYUWST                          WTUWST
     I              EYUXST                          WTUXST
     I              EYAATM                          WTAATM
     I              EYAYNA                          WTAYNA
     I              EYA0NA                          WTA0NA
     I              EYAXDT                          WTAXDT
      *
     I@EYCPY3
      * Order Events              Update index
      * Renamed input format fields
     I              EYAIC3                          WVAIC3
     I              EYC4NB                          WVC4NB
     I              EYQ2NB                          WVQ2NB
     I              EYJPCD                          WVJPCD
     I              EYAUC3                          WVAUC3
     I              EYQ7NB                          WVQ7NB
     I              EYOMST                          WVOMST
     I              EYD2DT                          WVD2DT
     I              EYONST                          WVONST
     I              EYOOST                          WVOOST
     I              EYOPST                          WVOPST
     I              EYAWC3                          WVAWC3
     I              EYQ8NB                          WVQ8NB
     I              EYQ9NB                          WVQ9NB
     I              EYBKC7                          WVBKC7
     I              EYUVST                          WVUVST
     I              EYUWST                          WVUWST
     I              EYUXST                          WVUXST
     I              EYAATM                          WVAATM
     I              EYAYNA                          WVAYNA
     I              EYA0NA                          WVA0NA
     I              EYAXDT                          WVAXDT
      *
     I@EYCPEH
      * Order Events              Customer/Order/Event Cod
      * Renamed input format fields
     I              EYAIC3                          WWAIC3
     I              EYC4NB                          WWC4NB
     I              EYQ2NB                          WWQ2NB
     I              EYJPCD                          WWJPCD
     I              EYAUC3                          WWAUC3
     I              EYQ7NB                          WWQ7NB
     I              EYOMST                          WWOMST
     I              EYD2DT                          WWD2DT
     I              EYONST                          WWONST
     I              EYOOST                          WWOOST
     I              EYOPST                          WWOPST
     I              EYAWC3                          WWAWC3
     I              EYQ8NB                          WWQ8NB
     I              EYQ9NB                          WWQ9NB
     I              EYBKC7                          WWBKC7
     I              EYUVST                          WWUVST
     I              EYUWST                          WWUWST
     I              EYUXST                          WWUXST
     I              EYAATM                          WWAATM
     I              EYAYNA                          WWAYNA
     I              EYA0NA                          WWA0NA
     I              EYAXDT                          WWAXDT
      *
     I@ASRECB
      * Company Control           Update index
      * Renamed input format fields
     I              ASAIC3                          WXAIC3
     I              ASAXNB                          WXAXNB
     I              ASNGNB                          WXNGNB
     I              ASBZNB                          WXBZNB
     I              ASC5NB                          WXC5NB
     I              ASC3NB                          WXC3NB
     I              ASCYNB                          WXCYNB
     I              ASIONB                          WXIONB
     I              ASI6NB                          WXI6NB
     I              ASDCNB                          WXDCNB
     I              ASC7NB                          WXC7NB
     I              ASC2NB                          WXC2NB
     I              ASC1NB                          WXC1NB
     I              ASL8NB                          WXL8NB
     I              ASBANB                          WXBANB
     I              ASCHST                          WXCHST
     I              ASCKST                          WXCKST
     I              ASCIST                          WXCIST
     I              ASCGST                          WXCGST
     I              ASAIPC                          WXAIPC
     I              ASASPC                          WXASPC
     I              ASA2VA                          WXA2VA
     I              ASC2ST                          WXC2ST
     I              ASD8ST                          WXD8ST
     I              ASD7ST                          WXD7ST
     I              ASA8NA                          WXA8NA
     I              ASA9NA                          WXA9NA
     I              ASBANA                          WXBANA
     I              ASBBNA                          WXBBNA
     I              ASEUST                          WXEUST
     I              ASAADY                          WXAADY
     I              ASABDY                          WXABDY
     I              ASACDY                          WXACDY
     I              ASADDY                          WXADDY
     I              ASAEDY                          WXAEDY
     I              ASAFDY                          WXAFDY
     I              ASAGDY                          WXAGDY
     I              ASAHDY                          WXAHDY
     I              ASAENB                          WXAENB
     I              ASALNB                          WXALNB
     I              ASEVNB                          WXEVNB
     I              ASRPOP                          WXRPOP
     I              ASDWNB                          WXDWNB
     I              ASR3NB                          WXR3NB
     I              ASPNST                          WXPNST
     I              ASR4NB                          WXR4NB
     I              ASPOST                          WXPOST
     I              ASSCNB                          WXSCNB
     I              ASVIST                          WXVIST
     I              ASVJST                          WXVJST
     I              ASBVVN                          WXBVVN
     I              ASUVST                          WXUVST
     I              ASUWST                          WXUWST
     I              ASUXST                          WXUXST
     I              ASVSST                          WXVSST
     I              ASAATM                          WXAATM
     I              ASAYNA                          WXAYNA
     I              ASA0NA                          WXA0NA
     I              ASAXDT                          WXAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     IYD01        DS
     I                                        1   50YI0101
     I                                        6  100YI01
      *
     IYM01        DS                        100
     I                                        1   50WBRVNB
     I                                        6  120WBBKC7
      *
     IYW01        DS
     I                                        1   50XARVNB
     I                                        6  120XABKC7
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
     IQOMFJ1    E DSOMFJCPL1
      * UPD : Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WDRMNB
     I              FJAIC3                          WDAIC3
     I              FJAODT                          WDAODT
     I              FJPJST                          WDPJST
     I              FJPKST                          WDPKST
     I              FJRNNB                          WDRNNB
     I              FJDMTX                          WDDMTX
     I              FJDNTX                          WDDNTX
     I              FJDOTX                          WDDOTX
     I              FJWTTX                          WDWTTX
     I              FJWUTX                          WDWUTX
     I              FJRPNB                          WDRPNB
     I              FJFLAM                          WDFLAM
     I              FJXQST                          WDXQST
     I              FJRRNB                          WDRRNB
     I              FJDXTX                          WDDXTX
     I              FJDYTX                          WDDYTX
     I              FJSBNB                          WDSBNB
     I              FJBZNA                          WDBZNA
     I              FJRONB                          WDRONB
     I              FJSQNB                          WDSQNB
     I              FJR1NB                          WDR1NB
     I              FJVCST                          WDVCST
     I              FJVDST                          WDVDST
     I              FJSDNB                          WDSDNB
     I              FJPAOU                          WDPAOU
     I              FJDGWG                          WDDGWG
     I              FJSXNB                          WDSXNB
     I              FJHADT                          WDHADT
     I              FJAART                          WDAART
     I              FJDHWG                          WDDHWG
     I              FJDIWG                          WDDIWG
     I              FJAQDT                          WDAQDT
     I              FJS6NB                          WDS6NB
     I              FJT4NB                          WDT4NB
     I              FJPRTM                          WDPRTM
     I              FJNPSV                          WDNPSV
     I              FJJ8TX                          WDJ8TX
     I              FJTLMI                          WDTLMI
     I              FJJ9TX                          WDJ9TX
     I              FJQ2CD                          WDQ2CD
     I              FJVPCD                          WDVPCD
     I              FJDBCD                          WDDBCD
     I              FJGRWE                          WDGRWE
     I              FJXCCD                          WDXCCD
     I              FJU2ST                          WDU2ST
     I              FJF9DT                          WDF9DT
     I              FJONTM                          WDONTM
     I              FJJ4DT                          WDJ4DT
     I              FJTRTM                          WDTRTM
     I              FJJ5DT                          WDJ5DT
     I              FJSPTM                          WDSPTM
     I              FJJ6DT                          WDJ6DT
     I              FJLFTM                          WDLFTM
     I              FJJ7DT                          WDJ7DT
     I              FJBOTM                          WDBOTM
     I              FJJ8DT                          WDJ8DT
     I              FJBLTM                          WDBLTM
     I              FJKIDT                          WDKIDT
     I              FJASTM                          WDASTM
     I              FJKADT                          WDKADT
     I              FJAJCM                          WDAJCM
     I              FJXACD                          WDXACD
     I              FJOANA                          WDOANA
     I              FJK4TX                          WDK4TX
     I              FJVOAG                          WDVOAG
     I              FJKBDT                          WDKBDT
     I              FJNBBO                          WDNBBO
     I              FJW4CD                          WDW4CD
     I              FJEFDT                          WDEFDT
     I              FJCNTN                          WDCNTN
     I              FJKCDT                          WDKCDT
     I              FJTMIN                          WDTMIN
     I              FJKDDT                          WDKDDT
     I              FJVMNB                          WDVMNB
     I              FJOCFR                          WDOCFR
     I              FJKJDT                          WDKJDT
     I              FJATTM                          WDATTM
     I              FJOTRS                          WDOTRS
     I              FJRNST                          WDRNST
     I              FJBRBK                          WDBRBK
     I              FJEIDT                          WDEIDT
     I              FJRMST                          WDRMST
     I              FJAJCD                          WDAJCD
     I              FJKKDT                          WDKKDT
     I              FJAVTM                          WDAVTM
     I              FJKZDT                          WDKZDT
     I              FJAXTM                          WDAXTM
     I              FJLHOS                          WDLHOS
     I              FJLHOR                          WDLHOR
     I              FJWNTX                          WDWNTX
     I              FJOITX                          WDOITX
     I              FJOJTX                          WDOJTX
     I              FJLLDT                          WDLLDT
     I              FJLSHG                          WDLSHG
     I              FJYPST                          WDYPST
     I              FJK0DT                          WDK0DT
     I              FJAYTM                          WDAYTM
     I              FJKNNX                          WDKNNX
     I              FJICWG                          WDICWG
     I              FJIDWG                          WDIDWG
     I              FJH9SX                          WDH9SX
     I              FJWOTX                          WDWOTX
     I              FJK1DT                          WDK1DT
     I              FJAZTM                          WDAZTM
     I              FJK2DT                          WDK2DT
     I              FJA0TM                          WDA0TM
     I              FJROST                          WDROST
     I              FJRPST                          WDRPST
     I              FJRQST                          WDRQST
     I              FJRRST                          WDRRST
     I              FJZBVA                          WDZBVA
     I              FJWPTX                          WDWPTX
     I              FJWQTX                          WDWQTX
     I              FJWRTX                          WDWRTX
     I              FJWSTX                          WDWSTX
     I              FJRVSX                          WDRVSX
     I              FJRUSX                          WDRUSX
     I              FJRWSX                          WDRWSX
     I              FJRXSX                          WDRXSX
     I              FJRYSX                          WDRYSX
     I              FJRZSX                          WDRZSX
     I              FJR0SX                          WDR0SX
     I              FJR1SX                          WDR1SX
     I              FJR2SX                          WDR2SX
     I              FJR3SX                          WDR3SX
     I              FJR4SX                          WDR4SX
     I              FJPYDT                          WDPYDT
     I              FJCKTM                          WDCKTM
     I              FJPZDT                          WDPZDT
     I              FJCLTM                          WDCLTM
     I              FJP0DT                          WDP0DT
     I              FJCMTM                          WDCMTM
     I              FJP1DT                          WDP1DT
     I              FJCNTM                          WDCNTM
     I              FJP2DT                          WDP2DT
     I              FJCOTM                          WDCOTM
     I              FJP3DT                          WDP3DT
     I              FJCQTM                          WDCQTM
     I              FJUVST                          WDUVST
     I              FJUWST                          WDUWST
     I              FJUXST                          WDUXST
     I              FJAATM                          WDAATM
     I              FJAYNA                          WDAYNA
     I              FJA0NA                          WDA0NA
     I              FJAXDT                          WDAXDT
      *
     IYARDCS      DS                            793
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IYD02        DS
     I                                        1   50YI0201
     I                                        6  100YI02
      *
     IYM02        DS                        100
     I                                        1   50WFRVNB
     I                                        6  120WFEIDT
      *
     IYW02        DS
     I                                        1   50XBRVNB
     I                                        6  120XBEIDT
      *
      * Outward parameters
     IPARC        DS                              8
      * KEY : Order Header TRG          Load Id/Order Num
      * I : RST Load ID
     I                                    P   1   40PARMNB
      * I :  Order Number
     I                                    P   5   80PAC4NB
      *
      * Outward parameters
     IPBRC        DS                             11
      * KEY : Load Detail               Load/Stop/Order
      * I : RST Load ID
     I                                    P   1   40PBRMNB
      *
     IYBRDCS      DS                            793
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WKAIC3
     I              OMC4NB                          WKC4NB
     I              OMDPNB                          WKDPNB
     I              OMUENB                          WKUENB
     I              OMHGCD                          WKHGCD
     I              OMAJCD                          WKAJCD
     I              OMBKC7                          WKBKC7
     I              OMCFC7                          WKCFC7
     I              OMGMST                          WKGMST
     I              OMGNST                          WKGNST
     I              OMMAVA                          WKMAVA
     I              OMKDVA                          WKKDVA
     I              OML8VA                          WKL8VA
     I              OML9VA                          WKL9VA
     I              OMGTST                          WKGTST
     I              OMGVST                          WKGVST
     I              OMGUST                          WKGUST
     I              OMQFST                          WKQFST
     I              OMAYVA                          WKAYVA
     I              OMEXDT                          WKEXDT
     I              OMLQCD                          WKLQCD
     I              OMRDCD                          WKRDCD
     I              OMQ7CD                          WKQ7CD
     I              OMBZPR                          WKBZPR
     I              OML6NB                          WKL6NB
     I              OMU1ST                          WKU1ST
     I              OMGIDT                          WKGIDT
     I              OMCRCD                          WKCRCD
     I              OMAGCD                          WKAGCD
     I              OMRZST                          WKRZST
     I              OMR0ST                          WKR0ST
     I              OMR1ST                          WKR1ST
     I              OMG7NA                          WKG7NA
     I              OMG8NA                          WKG8NA
     I              OMRPCD                          WKRPCD
     I              OMVEST                          WKVEST
     I              OMVGST                          WKVGST
     I              OMAVST                          WKAVST
     I              OMU0ST                          WKU0ST
     I              OMRFCD                          WKRFCD
     I              OMFZST                          WKFZST
     I              OMR1NB                          WKR1NB
     I              OMAVQT                          WKAVQT
     I              OMD0WG                          WKD0WG
     I              OMCCQT                          WKCCQT
     I              OMAUWG                          WKAUWG
     I              OMCBQT                          WKCBQT
     I              OMATWG                          WKATWG
     I              OMAQCS                          WKAQCS
     I              OMAGCS                          WKAGCS
     I              OMAKPR                          WKAKPR
     I              OMALPR                          WKALPR
     I              OMAUPR                          WKAUPR
     I              OMAVWG                          WKAVWG
     I              OMA4WG                          WKA4WG
     I              OMA5DT                          WKA5DT
     I              OMAODT                          WKAODT
     I              OMGNDT                          WKGNDT
     I              OMAMST                          WKAMST
     I              OMANST                          WKANST
     I              OMVAST                          WKVAST
     I              OMRGNB                          WKRGNB
     I              OMRHNB                          WKRHNB
     I              OMRINB                          WKRINB
     I              OMRBCD                          WKRBCD
     I              OMHICD                          WKHICD
     I              OMRNCD                          WKRNCD
     I              OMROCD                          WKROCD
     I              OMCXDT                          WKCXDT
     I              OMAJVN                          WKAJVN
     I              OMKXCD                          WKKXCD
     I              OMJPCD                          WKJPCD
     I              OMCQCD                          WKCQCD
     I              OMR4CD                          WKR4CD
     I              OMZ1ST                          WKZ1ST
     I              OMZ3ST                          WKZ3ST
     I              OMZ4ST                          WKZ4ST
     I              OMDUPR                          WKDUPR
     I              OMB6VL                          WKB6VL
     I              OMA1AA                          WKA1AA
     I              OMFZSX                          WKFZSX
     I              OMF0SX                          WKF0SX
     I              OMF1SX                          WKF1SX
     I              OMF2SX                          WKF2SX
     I              OMF3SX                          WKF3SX
     I              OMF4SX                          WKF4SX
     I              OMF5SX                          WKF5SX
     I              OMF6SX                          WKF6SX
     I              OMF7SX                          WKF7SX
     I              OMNTDT                          WKNTDT
     I              OMNUDT                          WKNUDT
     I              OMNVDT                          WKNVDT
     I              OMNWDT                          WKNWDT
     I              OMNXDT                          WKNXDT
     I              OMBUTM                          WKBUTM
     I              OMBVTM                          WKBVTM
     I              OMBWTM                          WKBWTM
     I              OMBXTM                          WKBXTM
     I              OMBYTM                          WKBYTM
     I              OMH5NX                          WKH5NX
     I              OMH6NX                          WKH6NX
     I              OMH7NX                          WKH7NX
     I              OMH8NX                          WKH8NX
     I              OMH9NX                          WKH9NX
     I              OMDVPR                          WKDVPR
     I              OMDWPR                          WKDWPR
     I              OMDXPR                          WKDXPR
     I              OMDYPR                          WKDYPR
     I              OMDZPR                          WKDZPR
     I              OMGSPR                          WKGSPR
     I              OMGTPR                          WKGTPR
     I              OMGUPR                          WKGUPR
     I              OMHOST                          WKHOST
     I              OMHPST                          WKHPST
     I              OMIOST                          WKIOST
     I              OMPEWG                          WKPEWG
     I              OMRINY                          WKRINY
     I              OMTIDT                          WKTIDT
     I              OMTJDT                          WKTJDT
     I              OMH2ST                          WKH2ST
     I              OMH0ST                          WKH0ST
     I              OMH1ST                          WKH1ST
     I              OMTKDT                          WKTKDT
     I              OMTLDT                          WKTLDT
     I              OMTMDT                          WKTMDT
     I              OMUVST                          WKUVST
     I              OMUWST                          WKUWST
     I              OMUXST                          WKUXST
     I              OMAATM                          WKAATM
     I              OMAYNA                          WKAYNA
     I              OMA0NA                          WKA0NA
     I              OMAXDT                          WKAXDT
      *
     IYCRDCS      DS                            525
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WLAIC3
     I              BEC4NB                          WLC4NB
     I              BEJNCD                          WLJNCD
     I              BEANC7                          WLANC7
     I              BEBKC7                          WLBKC7
     I              BEBRTX                          WLBRTX
     I              BEHMNA                          WLHMNA
     I              BEHONA                          WLHONA
     I              BEHPNA                          WLHPNA
     I              BEHNNA                          WLHNNA
     I              BEDBCD                          WLDBCD
     I              BECKTX                          WLCKTX
     I              BEB0C7                          WLB0C7
     I              BEAETX                          WLAETX
     I              BEB1NA                          WLB1NA
     I              BEB3NA                          WLB3NA
     I              BEB4NA                          WLB4NA
     I              BEB2NA                          WLB2NA
     I              BEBHCD                          WLBHCD
     I              BEC8TX                          WLC8TX
     I              BEBCNA                          WLBCNA
     I              BEA0DT                          WLA0DT
     I              BEA5DT                          WLA5DT
     I              BEGNDT                          WLGNDT
     I              BEACDT                          WLACDT
     I              BEAQCD                          WLAQCD
     I              BEB6NA                          WLB6NA
     I              BEBYNA                          WLBYNA
     I              BEBZNA                          WLBZNA
     I              BEGTST                          WLGTST
     I              BEGVST                          WLGVST
     I              BEGUST                          WLGUST
     I              BEQFST                          WLQFST
     I              BECQCD                          WLCQCD
     I              BEGJST                          WLGJST
     I              BEGWST                          WLGWST
     I              BEGXST                          WLGXST
     I              BEGYST                          WLGYST
     I              BEAODT                          WLAODT
     I              BEAIVN                          WLAIVN
     I              BECXDT                          WLCXDT
     I              BEJZVA                          WLJZVA
     I              BEA1WG                          WLA1WG
     I              BEXIST                          WLXIST
     I              BEXJST                          WLXJST
     I              BEXKST                          WLXKST
     I              BEEIDT                          WLEIDT
     I              BEAFTM                          WLAFTM
     I              BEE8CD                          WLE8CD
     I              BEE9CD                          WLE9CD
     I              BERMNB                          WLRMNB
     I              BETBNB                          WLTBNB
     I              BER1NB                          WLR1NB
     I              BEPJST                          WLPJST
     I              BEU0ST                          WLU0ST
     I              BEU1ST                          WLU1ST
     I              BEQ2CD                          WLQ2CD
     I              BEU2ST                          WLU2ST
     I              BEVEST                          WLVEST
     I              BEVFST                          WLVFST
     I              BEVGST                          WLVGST
     I              BERPCD                          WLRPCD
     I              BERNNB                          WLRNNB
     I              BEVDST                          WLVDST
     I              BEATIN                          WLATIN
     I              BEU4ST                          WLU4ST
     I              BEU5ST                          WLU5ST
     I              BERSRN                          WLRSRN
     I              BEMHNA                          WLMHNA
     I              BEMINA                          WLMINA
     I              BEWBST                          WLWBST
     I              BER4CD                          WLR4CD
     I              BEBFCD                          WLBFCD
     I              BEQ4CD                          WLQ4CD
     I              BET3NB                          WLT3NB
     I              BESICD                          WLSICD
     I              BECONB                          WLCONB
     I              BECEST                          WLCEST
     I              BEAWDT                          WLAWDT
     I              BEJPCD                          WLJPCD
     I              BEXUST                          WLXUST
     I              BEZ1ST                          WLZ1ST
     I              BEVRVA                          WLVRVA
     I              BEOBST                          WLOBST
     I              BEBCST                          WLBCST
     I              BEBDST                          WLBDST
     I              BEB7VL                          WLB7VL
     I              BEGASX                          WLGASX
     I              BEGBSX                          WLGBSX
     I              BEGCSX                          WLGCSX
     I              BEGDSX                          WLGDSX
     I              BEFNSX                          WLFNSX
     I              BEFOSX                          WLFOSX
     I              BEFPSX                          WLFPSX
     I              BEFQSX                          WLFQSX
     I              BEFRSX                          WLFRSX
     I              BEFSSX                          WLFSSX
     I              BEFTSX                          WLFTSX
     I              BEFUSX                          WLFUSX
     I              BEFVSX                          WLFVSX
     I              BEFWSX                          WLFWSX
     I              BEFXSX                          WLFXSX
     I              BEFYSX                          WLFYSX
     I              BENODT                          WLNODT
     I              BENPDT                          WLNPDT
     I              BENQDT                          WLNQDT
     I              BENRDT                          WLNRDT
     I              BENSDT                          WLNSDT
     I              BEBPTM                          WLBPTM
     I              BEBQTM                          WLBQTM
     I              BEBRTM                          WLBRTM
     I              BEBSTM                          WLBSTM
     I              BEBTTM                          WLBTTM
     I              BEH0NX                          WLH0NX
     I              BEH1NX                          WLH1NX
     I              BEH2NX                          WLH2NX
     I              BEH3NX                          WLH3NX
     I              BEH4NX                          WLH4NX
     I              BEC0C7                          WLC0C7
     I              BEUVST                          WLUVST
     I              BEUWST                          WLUWST
     I              BEUXST                          WLUXST
     I              BEAATM                          WLAATM
     I              BEAYNA                          WLAYNA
     I              BEA0NA                          WLA0NA
     I              BEAXDT                          WLAXDT
      *
     IYDRDCS      DS                            779
      * Outward parameters
     IPCRC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PCAIC3
      * I :  Order Number
     I                                    P   3   60PCC4NB
      * I :  Order Type - Sales
     I                                        7   8 PCJNCD
      * I :  A/R Customer Number
     I                                    P   9  120PCANC7
      * I :  Ship To Customer
     I                                    P  13  160PCBKC7
      * I :  Ship To Name
     I                                       17  46 PCBRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PCHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PCHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PCHPNA
      * I :  Ship To City
     I                                      137 156 PCHNNA
      * I :  Ship To State Code
     I                                      157 158 PCDBCD
      * I :  Ship To Zip/Postal Code
     I                                      159 169 PCCKTX
      * I :  Bill to Customer
     I                                    P 170 1730PCB0C7
      * I :  Bill to Name
     I                                      174 203 PCAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PCB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PCB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PCB4NA
      * I :  Bill to City
     I                                      294 313 PCB2NA
      * I :  Bill to State Code
     I                                      314 315 PCBHCD
      * I :  Bill to Zip/Postal Code
     I                                      316 326 PCC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PCBCNA
      * I :  Order Date
     I                                    P 342 3450PCA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PCA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PCGNDT
      * I :  Cancel Date
     I                                    P 354 3570PCACDT
      * I :  Terms Code
     I                                      358 359 PCAQCD
      * I :  Special Instructions
     I                                      360 399 PCB6NA
      * I :  Special Instructions 2
     I                                      400 439 PCBYNA
      * I :  Carrier Code
     I                                      440 442 PCBZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PCGTST
      * I :  Comment Print Inv/Cr.Memo
     I                                      444 444 PCGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PCGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PCQFST
      * I :  Reason Code
     I                                      447 449 PCCQCD
      * I :  Order in Use
     I                                      450 450 PCGJST
      * I :  Header Status
     I                                      451 451 PCGWST
      * I :  Header Status Last
     I                                      452 452 PCGXST
      * I :  Order Type Print Status
     I                                      453 453 PCGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PCAODT
      * I :  User Original Entry
     I                                      458 467 PCAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PCCXDT
      * I :  Order Value Total
     I                                    P 472 4772PCJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PCA1WG
      * I :  Credit Hold
     I                                      484 484 PCXIST
      * I :  Production Hold
     I                                      485 485 PCXJST
      * I :  New Customer Hold
     I                                      486 486 PCXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PCEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PCAFTM
      * I :  Accounts Receiv. Ent 1
     I                                      494 497 PCE8CD
      * I :  Accounts Receiv. Ent 2
     I                                      498 509 PCE9CD
      * I :  Load ID
     I                                    P 510 5130PCRMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PCTBNB
      * I :  Rated Freight
     I                                    P 517 5222PCR1NB
      * I :  LTL Flag
     I                                      523 523 PCPJST
      * I :  Price Audit
     I                                      524 524 PCU0ST
      * I :  Price Status
     I                                      525 525 PCU1ST
      * I :  Shipping Method
     I                                      526 527 PCQ2CD
      * I :  Export Status
     I                                      528 528 PCU2ST
      * I :  Palletize
     I                                      529 529 PCVEST
      * I :  Shrink Wrap
     I                                      530 530 PCVFST
      * I :  Slip Sheet
     I                                      531 531 PCVGST
      * I :  Age Code
     I                                      532 532 PCRPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PCRNNB
      * I :  Load Type
     I                                      536 536 PCVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PCATIN
      * I :  Load Plan Order
     I                                      541 541 PCU4ST
      * I :  Print Pick Slip
     I                                      542 542 PCU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PCRSRN
      * I :  Special Comment 1
     I                                      547 576 PCMHNA
      * I :  Special Comment 2
     I                                      577 606 PCMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PCWBST
      * I :  Sales Route Code
     I                                      608 610 PCR4CD
      * I :  Manager Level Code
     I                                      611 612 PCBFCD
      * I :  VP Level Code
     I                                      613 615 PCQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PCT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PCSICD
      * I :  Invoice Number
     I                                    P 623 6260PCCONB
      * I :  Invoice Suffix
     I                                      627 628 PCCEST
      * I :  Invoice Date
     I                                    P 629 6320PCAWDT
      * I :  Event Code
     I                                      633 634 PCJPCD
      * I :  Trans Contol AS400/Plant
     I                                      635 635 PCXUST
      * I :  Modified Flag
     I                                      636 636 PCZ1ST
      * I :  A/R order Value Total
     I                                    P 637 6422PCVRVA
      * I :  Billing Activity Type
     I                                      643 643 PCOBST
      * I :  Block Order Flag
     I                                      644 644 PCBCST
      * I :  Order Certification Flag
     I                                      645 645 PCBDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PCB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PCGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PCGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PCGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PCGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PCFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PCFOSX
      * I :  Order Emailed
     I                                      658 658 PCFPSX
      * I :  Export Docs Go w/Driver
     I                                      659 659 PCFQSX
      * I :  Shipping Temp Code C/F
     I                                      660 660 PCFRSX
      * I :  Broker Order Status
     I                                      661 661 PCFSSX
      * I :  Air Freight Order
     I                                      662 662 PCFTSX
      * I :  Order Requires Review
     I                                      663 664 PCFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PCFVSX
      * I :  Export USDA Approved
     I                                      667 668 PCFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PCFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PCFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PCNODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PCNPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PCNQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PCNRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PCNSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PCBPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PCBQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PCBRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PCBSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PCBTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PCH0NX
      * I :  Act Non-Ref Frt Amount
     I                                    P 721 7262PCH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PCH2NX
      * I :  OH Total Non-Ref Frt Amt
     I                                    P 733 7382PCH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PCH4NX
      * I :  Claim Number
     I                                    P 745 7480PCC0C7
      * I :  EDI Status 1
     I                                      749 749 PCUVST
      * I :  EDI Status 2
     I                                      750 750 PCUWST
      * I :  EDI Status 3
     I                                      751 751 PCUXST
      * I :  Job Time
     I                                    P 752 7550PCAATM
      * I :  User Id
     I                                      756 765 PCAYNA
      * I :  Job Name
     I                                      766 775 PCA0NA
      * I :  Job Date
     I                                    P 776 7790PCAXDT
      *
      * Outward parameters
     IPDRC        DS                             82
      * RCD : Load Order Change Log     Retrieval index
      * N :  Sequence Number
     I                                    P   9  100PDDXNB
      * I :  Load ID
     I                                    P  11  140PDRMNB
      * I :  Stop/Drop
     I                                    P  15  170PDRVNB
      * I :  Load Change Type
     I                                       18  23 PDRVST
      * I :  Department Control Code
     I                                       24  26 PDUJST
      * I :  Change Log Prior Value
     I                                       27  38 PDMNTX
      * I :  Change Log New Value
     I                                       39  50 PDMOTX
      * I :  User Id
     I                                       51  60 PDAYNA
      * I :  Job Name
     I                                       61  70 PDA0NA
      * I :  Carrier Code
     I                                       71  73 PDBZNA
      * N :  Carrier Broker Carrier Co
     I                                       74  76 PDXMCD
      * I :  Company Number
     I                                    P  77  780PDAIC3
      * I :  Order Number
     I                                    P  79  820PDC4NB
      *
     IYERDCS      DS                            793
      * Outward parameters
     IPERC        DS                             11
      * KEY : Load Detail               Load/Stop/Order
      * I :  Load ID
     I                                    P   1   40PERMNB
      *
     IYFRDCS      DS                            793
     IYGRDCS      DS                            793
     IYHRDCS      DS                            793
     IYIRDCS      DS                            793
     IQOMFL1    E DSOMFLCPL0
      * UPD : Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WRRMNB
     I              FLRUNB                          WRRUNB
     I              FLRVNB                          WRRVNB
     I              FLDQTX                          WRDQTX
     I              FLRWNB                          WRRWNB
     I              FLRXNB                          WRRXNB
     I              FLSQNB                          WRSQNB
     I              FLT0NB                          WRT0NB
     I              FLT1NB                          WRT1NB
     I              FLR1NB                          WRR1NB
     I              FLAIC3                          WRAIC3
     I              FLC4NB                          WRC4NB
     I              FLVCST                          WRVCST
     I              FLKEDT                          WRKEDT
     I              FLSXNB                          WRSXNB
     I              FLKFDT                          WRKFDT
     I              FLACTM                          WRACTM
     I              FLK5TX                          WRK5TX
     I              FLW5CD                          WRW5CD
     I              FLEJDT                          WREJDT
     I              FLAGTM                          WRAGTM
     I              FLKJDT                          WRKJDT
     I              FLATTM                          WRATTM
     I              FLHDDT                          WRHDDT
     I              FLAUTM                          WRAUTM
     I              FLKKDT                          WRKKDT
     I              FLAVTM                          WRAVTM
     I              FLZ4NB                          WRZ4NB
     I              FLY7ST                          WRY7ST
     I              FLY2ST                          WRY2ST
     I              FLWHTX                          WRWHTX
     I              FLWITX                          WRWITX
     I              FLWJTX                          WRWJTX
     I              FLWKTX                          WRWKTX
     I              FLWLTX                          WRWLTX
     I              FLN7DT                          WRN7DT
     I              FLN8DT                          WRN8DT
     I              FLN9DT                          WRN9DT
     I              FLB3TM                          WRB3TM
     I              FLB4TM                          WRB4TM
     I              FLB5TM                          WRB5TM
     I              FLIASX                          WRIASX
     I              FLIBSX                          WRIBSX
     I              FLICSX                          WRICSX
     I              FLWVTX                          WRWVTX
     I              FLWWTX                          WRWWTX
     I              FLWXTX                          WRWXTX
     I              FLUVST                          WRUVST
     I              FLUWST                          WRUWST
     I              FLUXST                          WRUXST
     I              FLAATM                          WRAATM
     I              FLAYNA                          WRAYNA
     I              FLA0NA                          WRA0NA
     I              FLAXDT                          WRAXDT
      *
     IYJRDCS      DS                            367
     IYKRDCS      DS                            525
     IYLRDCS      DS                            793
     IYMRDCS      DS                            525
     IYNRDCS      DS                            779
     IYORDCS      DS                            793
     IQOPEY1    E DSOPEYCPL0
      * UPD : Order Events              Update index
      * Renamed input format fields
     I              EYAIC3                          WVAIC3
     I              EYC4NB                          WVC4NB
     I              EYQ2NB                          WVQ2NB
     I              EYJPCD                          WVJPCD
     I              EYAUC3                          WVAUC3
     I              EYQ7NB                          WVQ7NB
     I              EYOMST                          WVOMST
     I              EYD2DT                          WVD2DT
     I              EYONST                          WVONST
     I              EYOOST                          WVOOST
     I              EYOPST                          WVOPST
     I              EYAWC3                          WVAWC3
     I              EYQ8NB                          WVQ8NB
     I              EYQ9NB                          WVQ9NB
     I              EYBKC7                          WVBKC7
     I              EYUVST                          WVUVST
     I              EYUWST                          WVUWST
     I              EYUXST                          WVUXST
     I              EYAATM                          WVAATM
     I              EYAYNA                          WVAYNA
     I              EYA0NA                          WVA0NA
     I              EYAXDT                          WVAXDT
      *
     IYPRDCS      DS                            793
     IQCAAS1    E DSCAASREL0
      * UPD : Company Control           Update index
      * Renamed input format fields
     I              ASAIC3                          WXAIC3
     I              ASAXNB                          WXAXNB
     I              ASNGNB                          WXNGNB
     I              ASBZNB                          WXBZNB
     I              ASC5NB                          WXC5NB
     I              ASC3NB                          WXC3NB
     I              ASCYNB                          WXCYNB
     I              ASIONB                          WXIONB
     I              ASI6NB                          WXI6NB
     I              ASDCNB                          WXDCNB
     I              ASC7NB                          WXC7NB
     I              ASC2NB                          WXC2NB
     I              ASC1NB                          WXC1NB
     I              ASL8NB                          WXL8NB
     I              ASBANB                          WXBANB
     I              ASCHST                          WXCHST
     I              ASCKST                          WXCKST
     I              ASCIST                          WXCIST
     I              ASCGST                          WXCGST
     I              ASAIPC                          WXAIPC
     I              ASASPC                          WXASPC
     I              ASA2VA                          WXA2VA
     I              ASC2ST                          WXC2ST
     I              ASD8ST                          WXD8ST
     I              ASD7ST                          WXD7ST
     I              ASA8NA                          WXA8NA
     I              ASA9NA                          WXA9NA
     I              ASBANA                          WXBANA
     I              ASBBNA                          WXBBNA
     I              ASEUST                          WXEUST
     I              ASAADY                          WXAADY
     I              ASABDY                          WXABDY
     I              ASACDY                          WXACDY
     I              ASADDY                          WXADDY
     I              ASAEDY                          WXAEDY
     I              ASAFDY                          WXAFDY
     I              ASAGDY                          WXAGDY
     I              ASAHDY                          WXAHDY
     I              ASAENB                          WXAENB
     I              ASALNB                          WXALNB
     I              ASEVNB                          WXEVNB
     I              ASRPOP                          WXRPOP
     I              ASDWNB                          WXDWNB
     I              ASR3NB                          WXR3NB
     I              ASPNST                          WXPNST
     I              ASR4NB                          WXR4NB
     I              ASPOST                          WXPOST
     I              ASSCNB                          WXSCNB
     I              ASVIST                          WXVIST
     I              ASVJST                          WXVJST
     I              ASBVVN                          WXBVVN
     I              ASUVST                          WXUVST
     I              ASUWST                          WXUWST
     I              ASUXST                          WXUXST
     I              ASVSST                          WXVSST
     I              ASAATM                          WXAATM
     I              ASAYNA                          WXAYNA
     I              ASA0NA                          WXA0NA
     I              ASAXDT                          WXAXDT
      *
     IYQRDCS      DS                            278
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Header TRG
      * I : MAP Company Number
     I                                    P   1   20P1AIC3
      * N :  Order Number
     I                                    P   3   60P1C4NB
      * N :  Scheduled Ship Date
     I                                    P   7  100P1AODT
      * N :  Requested Delivery Date
     I                                    P  11  140P1EIDT
      * B : MAP Load ID
     I                                    P  15  180P1RMNB
     IP2PARM      DS
      * FLD: Load Header
      * N :  LTL Flag
     I                                        1   1 P2PJST
      * I : MAP Load Status
     I                                        2   2 P2PKST
      * N :  Reefer Temperature
     I                                    P   3   52P2RNNB
      * B : MAP Total Load Order Weight
     I                                    P   6   90P2RPNB
      * N :  Carrier Code
     I                                       10  12 P2BZNA
      * N : MAP Truck Size
     I                                       13  19 P2RONB
      * N :  Load Type
     I                                       20  20 P2VDST
      * N :  Load Carrier Pay Amt
     I                                    P  21  262P2DGWG
      * N :  Trailer IN Weight
     I                                    P  27  322P2DHWG
      * N :  Trailer OUT Weight
     I                                    P  33  382P2DIWG
      * N :  Shipping Method
     I                                       39  40 P2Q2CD
      * N :  Ship To State Code
     I                                       41  42 P2DBCD
      * N :  Export Status
     I                                       43  43 P2U2ST
      * N :  Override Total Load Miles
     I                                    P  44  470P2K2DT
     IP3PARM      DS
      * FLD: *Arrays
      * N :  Stop/Drop
     I                                    P   1   30P3RVNB
      * N :  USR Weight, 9.0
     I                                    P   4   80P3BUNB
      * N :  Auto Load Numbering?
     I                                        9   9 P3PNST
      * N :  Maximum pounds
     I                                    P  10  130P3RSNB
      * N :  Minimum pounds
     I                                    P  14  170P3TANB
      * N :  Display Flag
     I                                       18  18 P3QKST
      * N :  USR Update Flag
     I                                       19  19 P3R4ST
      * N : MAP Total Freight
     I                                    P  20  252P3RQNB
      * N :  USR Load ID
     I                                    P  26  290P3UCNB
      * I :  USR Order Number
     I                                    P  30  330P3MPNB
      * N :  Deadline Depart Date LH
     I                                    P  34  370P3NVDT
      * N :  Deadline Depart Time LH
     I                                    P  38  410P3BUTM
     IP4PARM      DS
      * FLD: *Arrays
     IP5PARM      DS
      * FLD: *Arrays
      * N :  Warehouse Code
     I                                        1   3 P5AJCD
      * N :  Application Code
     I                                        4   9 P5DNCD
      * N :  Salesperson Code
     I                                       10  12 P5BCCD
      * N :  System Date Format
     I                                       13  15 P5B8NA
      * N :  Allow Multi-Company
     I                                       16  16 P5I6ST
      * N :  Default Printer
     I                                       17  26 P5MPNA
      * N :  Access Limited Sts USR
     I                                       27  27 P5HHST
     IP6PARM      DS
      * N :  USR Check Y/N Status
     I                                        1   1 P6JDST
     IP7PARM      DS
      * N :  USR Weight Accumulated
     I                                    P   1   62P7CDWG
     IP8PARM      DS
      * N :  Weight Adjust
     I                                    P   1   40P8DTWG
     IP9PARM      DS
      * FLD: *Arrays
      * N :  Status - Y or N
     I                                        1   1 P9B8ST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'CD7 Non numeric data'
      * Message data for 'CD3 Non numeric data'
      * Message data for 'CD7 Non numeric data'
      * Message data for 'Auto load # not in effect'
      * Load ID
     I                                    P   1   40ZA0001
      * Message data for 'Load ID already exists'
      * Load ID
     I                                    P   1   40ZA0002
      * Message data for 'Load Type Must be Entered'
      * Load Type
     I                                        1   1 ZA0003
      * Message data for 'Invalid Company Number'
      * Company Number
     I                                        1   3 ZA0004
      * Message data for 'PD Region not found'
      * Company Number
     I                                        1   3 ZA0005
      * Region Code
     I                                        4   7 ZA0006
      * Message data for 'Warehouse Code Required'
      * Warehouse Code
     I                                        1   3 ZA0007
      * Message data for 'Access Denied: Warehouse'
      * User Profile Name
     I                                        1  10 ZA0008
      * Warehouse Code
     I                                       11  13 ZA0009
      * Message data for 'Warehouse              NF'
      * Warehouse Code
     I                                        1   3 ZA0010
      * Message data for 'Value Required (numeric)'
      * @Numeric 15.2
     I                                    P   1   82ZA0011
      * Message data for 'Stop Sequence Invalid'
      * Stop/Drop
     I                                    P   1   30ZA0012
      * Message data for 'Order nf matching ld strt'
      * Company Number
     I                                        1   3 ZA0013
      * Message data for 'This order cannot arrive'
      * USR Stop
     I                                    P   1   20ZA0014
      * Message data for 'Mileage To City NF'
      * Port City
     I                                        1  25 ZA0015
      * Sail Port State
     I                                       26  27 ZA0016
      * Message data for 'This order cannot arrive'
      * USR Stop
     I                                    P   1   20ZA0017
      * Message data for 'Load Locked Can't Change'
      * Load Status
     I                                        1   1 ZA0018
      * USR Stop
     I                                    P   2   30ZA0019
      * Message data for 'Load Type Mismatch'
      * *SFLSEL
     I                                        1   1 ZA0020
      * Stop/Drop
     I                                    P   2   40ZA0021
      * Message data for 'Shipping Method mismatch'
      * *SFLSEL
     I                                        1   1 ZA0022
      * Message data for 'Order in use'
      * Order Number
     I                                        1   7 ZA0023
      * Message data for 'Ship Date Not GE JobDate'
      * *SFLSEL
     I                                        1   1 ZA0024
      * Message data for 'Ord Schd Shp Dt NE LD Shp'
      * *SFLSEL
     I                                        1   1 ZA0025
      * Message data for 'Stop # not entered'
      * USR Stop
     I                                    P   1   20ZA0026
      * Message data for 'Customer mismatch'
      * *SFLSEL
     I                                        1   1 ZA0027
      * Message data for 'Customer mismatch'
      * *SFLSEL
     I                                        1   1 ZA0028
      * Message data for 'Load Locked Can't Delete'
      * Load Status
     I                                        1   1 ZA0029
      * USR Stop
     I                                    P   2   30ZA0030
      * Message data for 'Invalid option f/picked o'
      * *SFLSEL
     I                                        1   1 ZA0031
      * Message data for 'Order in use'
      * Order Number
     I                                        1   7 ZA0032
      * Message data for 'Order Not Assigned a load'
      * *SFLSEL
     I                                        1   1 ZA0033
      * Order Number
     I                                        2   8 ZA0034
      * Message data for 'Invalid Dt Chg-DDD/T err2'
      * Scheduled Delivery Time
     I                                    P   1   40ZA0035
      * Message data for 'Invalid Deadln Dt/Tm'
      * Requested Delivery Date
     I                                    P   1   40ZA0036
      * Message data for 'Load Created -Cur Dte'
      * Load ID
     I                                    P   1   40ZA0037
      * *USER
     I                                        5  14 ZA0038
      * Dsp Date (99/99/99)   USR
     I                                       15  22 ZA0039
      * Company Number CDE
     I                                    P  23  240ZA0040
      * Message data for 'Block Orders on Load'
      * *SFLSEL
     I                                        1   1 ZA0041
      * Load ID
     I                                    P   2   50ZA0042
      * Message data for 'Load cannot be combined'
      * *SFLSEL
     I                                        1   1 ZA0043
      * Load ID
     I                                    P   2   50ZA0044
      * Message data for 'Load Id can not be change'
      * Load ID
     I                                    P   1   40ZA0045
      * *SFLSEL
     I                                        5   5 ZA0046
      * Message data for 'Sched Ship Dt is after DD'
      * Load ID
     I                                    P   1   40ZA0047
      * Message data for 'Sched Ship Dt is after DD'
      * Load ID
     I                                    P   1   40ZA0048
      * Message data for 'Load Weight LT Minimum'
      * Load ID
     I                                    P   1   40ZA0049
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0050
      * Application Code
     I                                       11  16 ZA0051
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0052
      * Application Code
     I                                       11  16 ZA0053
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1RMNB    PARM P1RMNB    WP0002  70       Load ID
     C           P2PKST    PARM           WP0003  1        Load Status
     C           P2RPNB    PARM P2RPNB    WP0004  70       Total Load Orde
     C           P3MPNB    PARM           WP0005  70       USR Order Numbe
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise & load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END                             OD W0RSF
     C                     END                             OD *HIVAL
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise and load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
      * USER: Initialize subfile control
      * if load id passed = zero-Rtv next load id, else rtv stop number
      * CASE: PAR.Load ID is Blank
     C           P1RMNB    IFEQ *ZERO                      *IF
      * If auto = Y, retrieve next load #
      * CASE: PAR.Auto Load Numbering? is Yes
     C           P3PNST    IFEQ 'Y'                        *IF
      * CTL.Load ID = PAR.USR Load ID
     C                     Z-ADDP3UCNB    #2RMNB           Load ID
     C                     END                             *FI
      * RTV Co. Dflt Int All   XF - Company Defaults Internal  * 
     C                     CALL 'PDSTXFR'              90  RTV Co. Dflt In
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0001  30       Company Number
     C           WUG0TX    PARM *BLANK    WQ0002  2        Shipping Method
     C           WUVDST    PARM *BLANK    WQ0003  1        Load Type Dft
     C           WUG0TX    PARM *BLANK    WQ0004  1        LTL Flag Dft
     C           WUG0TX    PARM *BLANK    WQ0005  1        Export Status D
     C           WUG0TX    PARM *BLANK    WQ0006  1        Shrink Wrap Dft
     C           WUNFNN    PARM *ZERO     WQ0007  40       Departure Time
     C           WUG0TX    PARM *BLANK    WQ0008  6        Export Code Dft
     C           WUG0TX    PARM *BLANK    WQ0009  1        Allow Mult Whse
     C           WUG0TX    PARM *BLANK    WQ0010  1        Allow Multi Exp
     C           WUG0TX    PARM *BLANK    WQ0011  1        Slip Sheet Dft
     C           WUG0TX    PARM *BLANK    WQ0012  1        Palletize Dft
     C                     PARM *BLANK    WQ0013  1        Plant Company S
     C                     PARM *BLANK    WQ0014  1        Company Organiz
     C                     PARM *BLANK    WQ0015  1        CDI Valuation G
     C                     PARM *BLANK    WQ0016  1        CDI Unused Sts
     C                     PARM *BLANK    WQ0017  2        CDI Shipper
     C                     PARM *BLANK    WQ0018  2        CDI Produced by
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDSTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Stop/Drop Seq.    RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1RMNB    WL0001           Load ID
     C                     Z-ADDWURUNB    WL0002           Stop/Drop Seque
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0002    WURUNB           Stop/Drop Seque
     C                     END                             *FI
      * If auto number is yes or in change mode, make Load ID display onl
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Auto Load Numbering? is Yes
      *   |- c2    : PAR.Load ID is NE Blank
      *   '-
     C           P3PNST    IFEQ 'Y'                        *IF
     C           P1RMNB    ORNE *ZERO                      *OR
     C                     MOVEL'N'       P3QKST           Display Flag
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       P3QKST           Display Flag
     C                     END                             *FI
      * If change mode, update control fields with load header info
      * CASE: PAR.Load ID is NE Blank
     C           P1RMNB    IFNE *ZERO                      *IF
      * ** RTV Total Load Miles into WRK context, Override into PAR   E00
      * RTV Load for Load Plan RT - Load Header  * 
     C                     EXSR SBRVGN
      * ** Update CTL miles with correct value
      * CASE: PAR.Override Total Load Miles is Entered
     C           P2K2DT    IFNE *ZERO                      *IF
     C                     Z-ADDP2K2DT    #CTLMI           Total Load Mile
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWUTLMI    #CTLMI           Total Load Mile
     C                     END                             *FI
      * If any orders on load, cannot change load type
      * RTV Chk any ords on Ld RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0003           Load ID
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    P6JDST    P      USR Check Y/N S
     C                     ELSE
      * CASE: *OTHERWISE
      * Add Mode
     C                     MOVEL'E'       #PPKST           Load Status
     C                     END                             *FI
      * CTL.Status Description 2 = Condition name of CTL.Load Status
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1195931   Y2LSNO  70       List number
     C                     PARM #PPKST    W0INVL 25        Load Status
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #CNINA    PARM           W0CNNM 25        Status Descript
      *
      * Retrieve default Truck to edit weight
      * RTV Alpha Value        RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0005           Company Number
     C                     MOVEL'DFTTRUCK'WL0006    P      Company Value C
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    WUBXTX    P      System Value Al
     C                     MOVELWUBXTX    WURONB           Truck Size
      * Retrieve Truck weight
      * CASE: WRK.Truck Size is Entered
     C           WURONB    IFNE *BLANK                     *IF
      * Rtv Min & Max Pounds  RT - Truck Size  * 
     C                     EXSR SERVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     P3RSNB           Maximum pounds
     C                     Z-ADD*ZERO     P3TANB           Minimum pounds
     C                     END                             *FI
      * Edit gross weight
      * *----------------------------------------------------------------
      * RTV GrsWgt w/PltTr Ld RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0008           Load ID
     C                     Z-ADD*ZERO     WL0009           Stop/Drop Seque
     C                     Z-ADDP2DHWG    WL0010           USR Weight Accu
     C                     MOVEL#PPKST    WL0011    P      Load Status
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0010    P2DHWG           USR Weight Accu
      * *----------------------------------------------------------------
     C                     Z-ADDP2DHWG    #CDTWG           Weight Adjust
      * Maximum message
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.Weight Adjust GT PAR.Maximum pounds
      *   |- c2    : PAR.Maximum pounds NE WRK.ZERO
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CDTWG    IFGT P3RSNB                     *IF
     C           P3RSNB    IFNE WUW0NB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Send message 'Load Weight GT Maximum'
     C                     MOVEL'USR1261' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     Z-ADD*ZERO     WUBMNB           Total Weight Wo
      * First time processing
      * CASE: WRK.First Time Flag is Yes
     C           WUTAST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUTAST           First Time Flag
     C                     MOVELWUVDST    #2VDST           Load Type
     C                     MOVEL#2VDST    P2VDST           Load Type
     C                     MOVEL#CCUST    WUCUST           USR Shipping Me
     C                     Z-ADD#CHODT    #2AODT           Scheduled Ship
     C                     Z-ADD#CHODT    WUAODT           Scheduled Ship
     C                     MOVEL'N'       WUQ3ST           Status Flag 3
     C                     MOVEL'Y'       P9B8ST           Status - Y or N
     C                     Z-ADDP1AIC3    #CFKNB           USR Company Num
     C                     END                             *FI
      * CTL.Status Description = Condition name of CTL.Load Type
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1250409   Y2LSNO  70       List number
     C                     PARM #2VDST    W0INVL 25        Load Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #CHKNA    PARM           W0CNNM 25        Status Descript
      *
     C                     Z-ADD#CFKNB    WUFKNB           USR Company Num
      * 11/10/09 PKD E00519 Access by Warehouse
      * DEFAULT: CTL.Warehouse Code                           E00519
      * CASE: LCL.Application WHS Restrict is yes
     C           YL0007    IFEQ 'Y'                        *IF
      * CASE: CTL.Warehouse Code is Blanks
     C           #CAJCD    IFEQ *BLANK                     *IF
      * Rtv 1st Warehouse     RT - User Application Whs  * 
     C                     EXSR SHRVGN
     C                     END                             *FI
      * RTV WhsTyp/Ctrl/LdTyp RT - Warehouse  * 
     C                     EXSR SIRVGN
     C                     END                             *FI
     C                     MOVEL#CAJCD    YL0008           Warehouse Code
     C                     MOVEL#CXBCD    YL0009           Sail Port State
      * Rtv Plant Co/Org      XF - Company Defaults Internal  * 
     C                     CALL 'PMOVXFR'              90  Rtv Plant Co/Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0026  30       Company Number
     C                     PARM *BLANK    WQ0027  1        Plant Company S
     C           WUYJSX    PARM *BLANK    WQ0028  1        Company Organiz
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMOVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Position DBF file
     C           KPOS      KLIST
     C                     KFLD           BEAODT           Scheduled Ship
     C                     KFLD           BEC4NB           Order Number
     C                     KFLD           BEAIC3           Company Number
      * Setup key
     C                     Z-ADD#2AODT    BEAODT
     C                     Z-ADD#2C4NB    BEC4NB
     C                     Z-ADD#2AIC3    BEAIC3
     C           KPOS      SETLL@BFCPJB
     C                     READ @BFCPJB                8782*82=EOF
      * Save previous selector values
     C           *LIKE     DEFN #2BZNA    WZBZNA
     C                     MOVEL#2BZNA    WZBZNA           Carrier Code
     C           *LIKE     DEFN #2R1NB    WZR1NB
     C                     MOVEL#2R1NB    WZR1NB           Rated Freight
     C           *LIKE     DEFN #2JNCD    WZJNCD
     C                     MOVEL#2JNCD    WZJNCD           Order Type - Sa
     C           *LIKE     DEFN #2AETX    WZAETX
     C                     MOVEL#2AETX    WZAETX           Bill to Name
     C           *LIKE     DEFN #2B1NA    WZB1NA
     C                     MOVEL#2B1NA    WZB1NA           Bill to Address
     C           *LIKE     DEFN #2B3NA    WZB3NA
     C                     MOVEL#2B3NA    WZB3NA           Bill to Address
     C           *LIKE     DEFN #2B4NA    WZB4NA
     C                     MOVEL#2B4NA    WZB4NA           Bill to Address
     C           *LIKE     DEFN #2B2NA    WZB2NA
     C                     MOVEL#2B2NA    WZB2NA           Bill to City
     C           *LIKE     DEFN #2BHCD    WZBHCD
     C                     MOVEL#2BHCD    WZBHCD           Bill to State C
     C           *LIKE     DEFN #2C8TX    WZC8TX
     C                     MOVEL#2C8TX    WZC8TX           Bill to Zip/Pos
     C           *LIKE     DEFN #2A0DT    WZA0DT
     C                     MOVEL#2A0DT    WZA0DT           Order Date
     C           *LIKE     DEFN #2ACDT    WZACDT
     C                     MOVEL#2ACDT    WZACDT           Cancel Date
     C           *LIKE     DEFN #2AQCD    WZAQCD
     C                     MOVEL#2AQCD    WZAQCD           Terms Code
     C           *LIKE     DEFN #2BYNA    WZBYNA
     C                     MOVEL#2BYNA    WZBYNA           Special Instruc
     C           *LIKE     DEFN #2B6NA    WZB6NA
     C                     MOVEL#2B6NA    WZB6NA           Special Instruc
     C           *LIKE     DEFN #2GTST    WZGTST
     C                     MOVEL#2GTST    WZGTST           Comment Print A
     C           *LIKE     DEFN #2GVST    WZGVST
     C                     MOVEL#2GVST    WZGVST           Comment Print I
     C           *LIKE     DEFN #2GUST    WZGUST
     C                     MOVEL#2GUST    WZGUST           Comment Print P
     C           *LIKE     DEFN #2CQCD    WZCQCD
     C                     MOVEL#2CQCD    WZCQCD           Reason Code
     C           *LIKE     DEFN #2GJST    WZGJST
     C                     MOVEL#2GJST    WZGJST           Order in Use
     C           *LIKE     DEFN #2GXST    WZGXST
     C                     MOVEL#2GXST    WZGXST           Header Status L
     C           *LIKE     DEFN #2GYST    WZGYST
     C                     MOVEL#2GYST    WZGYST           Order Type Prin
     C           *LIKE     DEFN #2AIVN    WZAIVN
     C                     MOVEL#2AIVN    WZAIVN           User Original E
     C           *LIKE     DEFN #2CXDT    WZCXDT
     C                     MOVEL#2CXDT    WZCXDT           Date of Origina
     C           *LIKE     DEFN #2JZVA    WZJZVA
     C                     MOVEL#2JZVA    WZJZVA           Order Value Tot
     C           *LIKE     DEFN #2QFST    WZQFST
     C                     MOVEL#2QFST    WZQFST           Comment Print S
     C           *LIKE     DEFN #2E8CD    WZE8CD
     C                     MOVEL#2E8CD    WZE8CD           Accounts Receiv
     C           *LIKE     DEFN #2E9CD    WZE9CD
     C                     MOVEL#2E9CD    WZE9CD           Accounts Receiv
     C           *LIKE     DEFN #2TBNB    WZTBNB
     C                     MOVEL#2TBNB    WZTBNB           Absorbed Freigh
     C           *LIKE     DEFN #2AATM    WZAATM
     C                     MOVEL#2AATM    WZAATM           Job Time
     C           *LIKE     DEFN #2AYNA    WZAYNA
     C                     MOVEL#2AYNA    WZAYNA           User Id
     C           *LIKE     DEFN #2A0NA    WZA0NA
     C                     MOVEL#2A0NA    WZA0NA           Job Name
     C           *LIKE     DEFN #2AXDT    WZAXDT
     C                     MOVEL#2AXDT    WZAXDT           Job Date
     C           *LIKE     DEFN #2PJST    WZPJST
     C                     MOVEL#2PJST    WZPJST           LTL Flag
     C           *LIKE     DEFN #2RNNB    WZRNNB
     C                     MOVEL#2RNNB    WZRNNB           Reefer Temperat
     C           *LIKE     DEFN #2A5DT    WZA5DT
     C                     MOVEL#2A5DT    WZA5DT           Requested Ship
     C           *LIKE     DEFN #2A1WG    WZA1WG
     C                     MOVEL#2A1WG    WZA1WG           Order Weight To
     C           *LIKE     DEFN #2GWST    WZGWST
     C                     MOVEL#2GWST    WZGWST           Header Status
     C           *LIKE     DEFN #2Q2CD    WZQ2CD
     C                     MOVEL#2Q2CD    WZQ2CD           Shipping Method
     C           *LIKE     DEFN #2BCNA    WZBCNA
     C                     MOVEL#2BCNA    WZBCNA           Customer Purcha
     C           *LIKE     DEFN #2AIC3    WZAIC3
     C                     MOVEL#2AIC3    WZAIC3           Company Number
     C           *LIKE     DEFN #2RMNB    WZRMNB
     C                     MOVEL#2RMNB    WZRMNB           Load ID
     C           *LIKE     DEFN #2VDST    WZVDST
     C                     MOVEL#2VDST    WZVDST           Load Type
     C           *LIKE     DEFN #2C4NB    WZC4NB
     C                     MOVEL#2C4NB    WZC4NB           Order Number
     C           *LIKE     DEFN #2AODT    WZAODT
     C                     MOVEL#2AODT    WZAODT           Scheduled Ship
     C           *LIKE     DEFN #2AFTM    WZAFTM
     C                     MOVEL#2AFTM    WZAFTM           Requested Deliv
     C           *LIKE     DEFN #2BKC7    WZBKC7
     C                     MOVEL#2BKC7    WZBKC7           Ship To Custome
     C           *LIKE     DEFN #2HNNA    WZHNNA
     C                     MOVEL#2HNNA    WZHNNA           Ship To City
     C           *LIKE     DEFN #2DBCD    WZDBCD
     C                     MOVEL#2DBCD    WZDBCD           Ship To State C
      * Translate search mask for text field
     C                     MOVEL'QSYST'   WQB10X 10
     C                     MOVE 'RNTBL'   WQB10X
     C           *LIKE     DEFN #2BCNA    WQBCNA           Customer Purcha
     C                     CALL 'QDCXLATE'
      * Length
     C                     PARM 15        WQA5N   50
     C                     PARM #2BCNA    WQBCNA           Customer Purcha
     C                     PARM           WQB10X           QSYSTRNTBL
     C                     PARM 'QSYS'    WQC10X 10
      * Load subfile page
     C                     Z-ADD0         ##RROK  50
     C                     EXSR BBLDSF
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@BFCPJB                  90*
     C  N82                READ @BFCPJB                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVEL*ALL'0'   WKIND0  2
     C                     MOVEAWKIND0    *IN,45
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
      * Reset count of DBF records read
     C                     Z-ADD0         ##RRRD  90
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next SFL page until SFL page full, or
      * Scan limit reached
     C           *IN82     DOWEQ'0'                        DO
     C           ##RROK    ANDLT##SFLN
     C           ##RRRD    ANDLTW0SLM
      * Check selection fields - if fail, read next record
     C           #2AETX    IFNE *BLANK                     Bill to Name
     C           BEAETX    CABNE#2AETX    BB020            Bill to Name
     C                     END
     C           #2B1NA    IFNE *BLANK                     Bill to Address
     C           BEB1NA    CABNE#2B1NA    BB020            Bill to Address
     C                     END
     C           #2B3NA    IFNE *BLANK                     Bill to Address
     C           BEB3NA    CABNE#2B3NA    BB020            Bill to Address
     C                     END
     C           #2B4NA    IFNE *BLANK                     Bill to Address
     C           BEB4NA    CABNE#2B4NA    BB020            Bill to Address
     C                     END
     C           #2B2NA    IFNE *BLANK                     Bill to City
     C           BEB2NA    CABNE#2B2NA    BB020            Bill to City
     C                     END
     C           #2BHCD    IFNE *BLANK                     Bill to State C
     C           BEBHCD    CABNE#2BHCD    BB020            Bill to State C
     C                     END
     C           #2C8TX    IFNE *BLANK                     Bill to Zip/Pos
     C           BEC8TX    CABNE#2C8TX    BB020            Bill to Zip/Pos
     C                     END
     C           #2A0DT    IFNE *ZERO                      Order Date
     C           BEA0DT    CABNE#2A0DT    BB020            Order Date
     C                     END
     C           #2ACDT    IFNE *ZERO                      Cancel Date
     C           BEACDT    CABNE#2ACDT    BB020            Cancel Date
     C                     END
     C           #2AQCD    IFNE *BLANK                     Terms Code
     C           BEAQCD    CABNE#2AQCD    BB020            Terms Code
     C                     END
     C           #2BYNA    IFNE *BLANK                     Special Instruc
     C           BEBYNA    CABNE#2BYNA    BB020            Special Instruc
     C                     END
     C           #2B6NA    IFNE *BLANK                     Special Instruc
     C           BEB6NA    CABNE#2B6NA    BB020            Special Instruc
     C                     END
     C           #2GTST    IFNE *BLANK                     Comment Print A
     C           BEGTST    CABNE#2GTST    BB020            Comment Print A
     C                     END
     C           #2GVST    IFNE *BLANK                     Comment Print I
     C           BEGVST    CABNE#2GVST    BB020            Comment Print I
     C                     END
     C           #2GUST    IFNE *BLANK                     Comment Print P
     C           BEGUST    CABNE#2GUST    BB020            Comment Print P
     C                     END
     C           #2CQCD    IFNE *BLANK                     Reason Code
     C           BECQCD    CABNE#2CQCD    BB020            Reason Code
     C                     END
     C           #2GJST    IFNE *BLANK                     Order in Use
     C           BEGJST    CABNE#2GJST    BB020            Order in Use
     C                     END
     C           #2GXST    IFNE *BLANK                     Header Status L
     C           BEGXST    CABNE#2GXST    BB020            Header Status L
     C                     END
     C           #2GYST    IFNE *BLANK                     Order Type Prin
     C           BEGYST    CABNE#2GYST    BB020            Order Type Prin
     C                     END
     C           #2AIVN    IFNE *BLANK                     User Original E
     C           BEAIVN    CABNE#2AIVN    BB020            User Original E
     C                     END
     C           #2CXDT    IFNE *ZERO                      Date of Origina
     C           BECXDT    CABNE#2CXDT    BB020            Date of Origina
     C                     END
     C           #2JZVA    IFNE *ZERO                      Order Value Tot
     C           BEJZVA    CABNE#2JZVA    BB020            Order Value Tot
     C                     END
     C           #2QFST    IFNE *BLANK                     Comment Print S
     C           BEQFST    CABNE#2QFST    BB020            Comment Print S
     C                     END
     C           #2E8CD    IFNE *BLANK                     Accounts Receiv
     C           BEE8CD    CABNE#2E8CD    BB020            Accounts Receiv
     C                     END
     C           #2E9CD    IFNE *BLANK                     Accounts Receiv
     C           BEE9CD    CABNE#2E9CD    BB020            Accounts Receiv
     C                     END
     C           #2TBNB    IFNE *ZERO                      Absorbed Freigh
     C           BETBNB    CABNE#2TBNB    BB020            Absorbed Freigh
     C                     END
     C           #2AATM    IFNE *ZERO                      Job Time
     C           BEAATM    CABNE#2AATM    BB020            Job Time
     C                     END
     C           #2AYNA    IFNE *BLANK                     User Id
     C           BEAYNA    CABNE#2AYNA    BB020            User Id
     C                     END
     C           #2A0NA    IFNE *BLANK                     Job Name
     C           BEA0NA    CABNE#2A0NA    BB020            Job Name
     C                     END
     C           #2AXDT    IFNE *ZERO                      Job Date
     C           BEAXDT    CABNE#2AXDT    BB020            Job Date
     C                     END
     C           #2PJST    IFNE *BLANK                     LTL Flag
     C           BEPJST    CABNE#2PJST    BB020            LTL Flag
     C                     END
     C           #2RNNB    IFNE *ZERO                      Reefer Temperat
     C           BERNNB    CABNE#2RNNB    BB020            Reefer Temperat
     C                     END
     C           #2A5DT    IFNE *ZERO                      Requested Ship
     C           BEA5DT    CABNE#2A5DT    BB020            Requested Ship
     C                     END
     C           #2A1WG    IFNE *ZERO                      Order Weight To
     C           BEA1WG    CABGT#2A1WG    BB020            Order Weight To
     C                     END
     C           #2GWST    IFNE *BLANK                     Header Status
     C           BEGWST    CABNE#2GWST    BB020            Header Status
     C                     END
     C           #2Q2CD    IFNE *BLANK                     Shipping Method
     C           BEQ2CD    CABNE#2Q2CD    BB020            Shipping Method
     C                     END
     C           #2BCNA    IFNE *BLANK                     Customer Purcha
      * Scan for search string
     C                     CALL 'QCLSCAN'
     C                     PARM           BEBCNA           Customer Purcha
      * Length
     C                     PARM 15        WQA3N   30
      * Start
     C                     PARM 1         WQB3N   30
      * Mask
     C                     PARM           WQBCNA
      * Length
     C                     PARM 15        WQC3N   30
      * Translate
     C                     PARM '1'       WQD1    1
      * Trim
     C                     PARM '1'       WQE1    1
      * Wild
     C                     PARM '?'       WQF1    1
      * Result
     C                     PARM           WQG3N   30
     C           WQG3N     CABNE1         BB020
     C                     END
     C           #2AODT    IFEQ *ZERO                      Scheduled Ship
     C           #2C4NB    IFNE *ZERO                      Order Number
     C           BEC4NB    CABNE#2C4NB    BB020            Order Number
     C                     END
     C                     END
     C           #2AFTM    IFNE *ZERO                      Requested Deliv
     C           BEAFTM    CABNE#2AFTM    BB020            Requested Deliv
     C                     END
     C           #2BKC7    IFNE *ZERO                      Ship To Custome
     C           BEBKC7    CABNE#2BKC7    BB020            Ship To Custome
     C                     END
     C           #2HNNA    IFNE *BLANK                     Ship To City
     C           BEHNNA    CABNE#2HNNA    BB020            Ship To City
     C                     END
     C           #2DBCD    IFNE *BLANK                     Ship To State C
     C           BEDBCD    CABNE#2DBCD    BB020            Ship To State C
     C                     END
      * Load SFL fields
     C                     EXSR MBFL#1
     C                     MOVEL'Y'       W0RSL   1
      * Allow for possible *Set Cursor processing
     C                     ADD  1         ##RR
      * USER: Initialize subfile record from DBF record
     C                     MOVEL'N'       W0RSL            *Record selecte
      * RTV OHE Appt Cnfrm fld RT - Order Header Extension  * 
     C                     EXSR SJRVGN
      * RTV Type              RT - Order Header Extension  * 
     C                     EXSR SKRVGN
      * Get stop if this load
      * CASE: DB1.Load ID EQ CTL.Load ID
     C           BERMNB    IFEQ #2RMNB                     *IF
      * RTV Stop Number       RT - Load Detail          TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDBERMNB    WL0016           Load ID
     C                     Z-ADDBEC4NB    WL0018           Order Number
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0017    #RTENB           Stop/Drop
     C                     Z-ADDWL0019    WUNFNN           Appointment Con
     C                     Z-ADDWL0020    WUNFNN           Appointment Con
     C                     END                             *FI
      * RTV 1st Warehouse/UOM  RT - Order Detail  * 
     C                     EXSR SMRVGN
      * Record selection
     C                     EXSR UBSUBR                     Record selectio
      * If CTL assigned to load set, order must match
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Set up Assigned to load
      * CASE: DB1.Load ID EQ CTL.Load ID
     C           BERMNB    IFEQ #2RMNB                     *IF
     C                     MOVEL'Y'       #RQZST           USR Assigned Th
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #RQZST           USR Assigned Th
     C                     END                             *FI
      * CASE: CTL.USR Assigned This Load is Blank
     C           #CQZST    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: RCD.USR Assigned This Load NE CTL.USR Assigned This Load
     C           #RQZST    IFNE #CQZST                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * If Record selected
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * If CTL.Usr Company Number entered...     PKTR01 8/02/04
      * CASE:
      *  - c1ANDc2
      *   |- c1    : CTL.USR Company Number is not equal to zero
      *   |- c2    : CTL.USR Company Number NE DB1.Company Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CFKNB    IFNE *ZERO                      *IF
     C           #CFKNB    IFNE BEAIC3                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * SEL: CTL.Warehouse Code                                  E00519
      * CASE:
      *  - c1ANDc2
      *   |- c1    : CTL.Warehouse Code is Not Blanks
      *   |- c2    : CTL.Warehouse Code NE RCD.Warehouse Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CAJCD    IFNE *BLANK                     *IF
     C           #CAJCD    IFNE #RAJCD                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * RTV Region for State   RT - Region Definition  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0021           Company Number
     C                     MOVEL#1DBCD    WL0023    P      State Code
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0022    #RV1CD    P      Region Code
     C                     Z-ADDBEA1WG    #RYGNX           USR Weight, 5.0
      * If control weight is entered, select only weight LE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.USR Weight, 5.0 is NE Zeros
      *   |- c2    : RCD.USR Weight, 5.0 GT CTL.USR Weight, 5.0
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CYGNX    IFNE *ZERO                      *IF
     C           #RYGNX    IFGT #CYGNX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * If control region code is entered, then select regions equal to
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.Region Code is Entered
      *   |- c2    : RCD.Region Code NE CTL.Region Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CV1CD    IFNE *BLANK                     *IF
     C           #RV1CD    IFNE #CV1CD                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Mark Picked orders
     C                     EXSR UCSUBR                     Mark Picked ord
      * RTV State Description  RT - State  * 
     C                     EXSR SPRVGN
      * Load up stop customer array
      * CASE:
      *  - c1 AND c2
      *   |- c1    : RCD.USR Stop NE WRK.ZERO
      *   |- c2    : PGM.*Record selected is *YES
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #RTENB    IFNE WUW0NB                     *IF
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CRT Load Plan Stop Cst CR - *Arrays  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#RTENB    WL0024           Stop/Drop
     C                     Z-ADDBEBKC7    WL0025           Ship To Custome
     C                     EXSR SQCRRC
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     END                             *FI
      * RTV Shipping Co Dft    RT - Company Customer  * 
     C                     EXSR SRRVGN
      * RMC - 1/3/05 - (HI) the company if not the ship to's default co
      * CASE: WRK.Company Number     041743 NE RCD.Company Number
     C           WUBSC3    IFNE #1AIC3                     *IF
     C                     MOVEL'Y'       #RTIST           USR Display 1
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #RTIST           USR Display 1
     C                     END                             *FI
      * Rtv Delivery State    XF - Order Header Extension  * E00519
     C                     CALL 'PNMYXFR'              90  Rtv Delivery St
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0029  30       Company Number
     C                     PARM #1C4NB    WQ0030  70       Order Number
     C                     PARM #1DBCD    WQ0031  2        Ship To State C
     C           #RXBCD    PARM *BLANK    WQ0032  2        Sail Port State
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNMYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * SEL: CTL.Sail Port State                               E00519
      * CASE:
      *  - c1ANDc2
      *   |- c1    : CTL.Sail Port State is State code not Blanks
      *   |- c2    : CTL.Sail Port State NE RCD.Sail Port State
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CXBCD    IFNE *BLANK                     *IF
     C           #CXBCD    IFNE #RXBCD                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * If record is selected & assigned to load then accumulate weight
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Record selected is *YES
      *   |- c2    : RCD.USR Stop is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RSL     IFEQ 'Y'                        *IF
     C           #RTENB    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  #RBUNB    WUBMNB           Total Weight Wo
      * RMC -- 1/3/05 save to test that one order exists with the load st
      * CASE:
      *  - c2 AND c1
      *   |- c2    : RCD.Company Number EQ CTL.Company Number
      *   |- c1    : WRK.Status Flag 3  Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1AIC3    IFEQ #2AIC3                     *IF
     C           WUQ3ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUQ3ST           Status Flag 3
     C                     END                             *FI
      * 02/09/09 PKD S00660 Save the Earliest Deadline Departure Date
     C                     END                             *FI
     C                     MOVEL*BLANK    #RR4ST           USR Update Flag
      * RCD.Month/Day Display     USR = DB1.Requested Delivery Date
     C                     Z-ADDBEEIDT    #RMDDI           Month/Day Displ
     C                     SUB  1         ##RR
      * DBF record not selected
     C           W0RSL     CABNE'Y'       BB020
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Output to subfile
     C                     ADD  1         ##RR
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * Increment scan check count
     C                     ADD  1         ##RRRD
     C                     READ @BFCPJB                  82*82=EOF
     C                     END                             OD 1 - ##SFPG
      *................................................................
     C           BB900     TAG
      *................................................................
      * If no DBF records found, display error message
     C           ##RR      IFEQ *ZERO
     C           *IN82     ANDEQ'1'
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI ##RR = *ZERO
      *
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      * If scan limit reached, display error message
     C           ##RRRD    IFGE W0SLM
      * Send message '*Scan limit reached'
     C                     MOVEL'Y2U0017' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     ELSE
     C                     Z-ADD0         ##RROK
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
      * Set SFLFOLD/SFLDROP from JOB.*Subfile mode
     C                     MOVE ZZSFM     *IN02
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     SETOF                       8392*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate USR Shipping Method
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#CCUST    W0NSRQ  1        USR Shipping Me
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#CCUST'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1252129   Y2LSNO  70
     C           #CCUST    PARM #CCUST    W0EXVL 25        USR Shipping Me
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * Validate Load Type
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#2VDST    W0NSRQ  1        Load Type
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#2VDST'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1294937   Y2LSNO  70
     C           #2VDST    PARM #2VDST    W0EXVL 25        Load Type
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * Validate Order Number and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV2C4NB    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,002                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #2C4NB           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #2C4NB           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate USR Company Number and convert to internal.
      * CD3 Ext/Int
     C                     MOVELVCFKNB    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELVCFKNB    WUDMCD           CD3 Ext Numeric
      * CD3 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC3  3
     C                     MOVEA*BLANKS   K3
     C                     Z-ADD3         C       30
     C                     Z-ADD3         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUDMCD    J3
     C                     MOVE *BLANKS   W0RTN
     C                     DO   3
     C           J3,C      IFNE ' '
     C                     MOVEAJ3,C      K3,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK3        JUSTC3
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC3    TESTC   1
     C           TESTC     IFGT '?'
     C           TESTC     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC3     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC3    WUDMCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,002                    *IF
      * Setup message data for message
      * Send message 'CD3 Non numeric data'
     C                     MOVEL'USR0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #CFKNB           CD3 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUDMCD    #CFKNB           CD3 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Scheduled Ship Date
      * External date
     C                     Z-ADDV2AODT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9939  *
     C                     END
     C                     Z-ADDXDINDT    #2AODT
      * Validate Ship To Customer and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV2BKC7    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,002                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #2BKC7           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #2BKC7           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate USR Assigned This Load
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#CQZST'  IFEQ YPMTFD
      * USR Assigned This Load
     C                     MOVEL#CQZST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFQZST
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZFQZST
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZFQZST
     C                     ENDSL
     C                     EXFMTZEQZST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFQZST    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZFQZST    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #CQZST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      *................................................................
     C           YPMTFD    IFNE *BLANKS
     C           YPMRRN    ANDEQ*ZERO
     C                     GOTO DAEXIT
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Subfile control function fields
      * Prompt processing
      * CASE: CTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * Region code
      * CASE: PGM.*Cursor field <IS> CTL.Region Code
     C           W0CFL     IFEQ '#CV1CD'                   *IF
      * SEL Active Region      SR - PD Region  * 
     C                     CALL 'PDDOSRR'              90  SEL Active Regi
     C                     PARM *BLANK    W0RTN   7
     C           #2AIC3    PARM #2AIC3    WQ0033  30       Company Number
     C           #CV1CD    PARM #CV1CD    WQ0034  4        Region Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDDOSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9938  *
     C                     END
     C                     END                             *FI
      * Usr company number        PKTR01 08/02/04
      * CASE: PGM.*Cursor field <IS> CTL.USR Company Number
     C           W0CFL     IFEQ 'VCFKNB'                   *IF
      * SEL Company - plants   SR - Company Name and Address  * 
     C                     CALL 'PPF2SRR'              90  SEL Company - p
     C                     PARM *BLANK    W0RTN   7
     C           #CFKNB    PARM #CFKNB    WQ0035  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPF2SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9936  *
     C                     END
     C                     END                             *FI
      * SHIP TO CUSTOMER          PKTR01 08/02/04
      * CASE: PGM.*Cursor field <IS> CTL.Ship To Customer
     C           W0CFL     IFEQ 'V2BKC7'                   *IF
      * SEL Cust/ShpTo Flag 'Y'SR - Customer  * 
     C                     CALL 'PDYSSRR'              90  SEL Cust/ShpTo
     C                     PARM *BLANK    W0RTN   7
     C           #2BKC7    PARM #2BKC7    WQ0036  70       Ship To Custome
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYSSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9940  *
     C                     END
     C                     END                             *FI
      * SHIP TO state             PKTR01 08/02/04
      * CASE: PGM.*Cursor field <IS> CTL.Ship To State Code
     C           W0CFL     IFEQ '#2DBCD'                   *IF
      * SEL State              SR - State  * 
     C                     CALL 'CAAHSRR'              90  SEL State
     C                     PARM *BLANK    W0RTN   7
     C           #2DBCD    PARM #2DBCD    WQ0037  2        State Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAAHSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9941  *
     C                     END
     C                     END                             *FI
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * F20:Edit traffic comments
      * CASE: CTL.*CMD key is CF20
     C           *IN20     IFEQ '1'                        *IF
      * EDT PD Traffic Comment EF - PD Traffic Comments  * 
     C                     CALL 'PDCZEFR'              90  EDT PD Traffic
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2RMNB    WQ0038  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCZEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     END                             *FI
      * Must enter load # if auto numbering = no
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Auto Load Numbering? is No
      *   |- c2    : PAR.Load ID is Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3PNST    IFEQ 'N'                        *IF
     C           P1RMNB    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: CTL.Load ID is Blank
     C           #2RMNB    IFEQ *ZERO                      *IF
      * Setup message data for message
     C                     Z-ADD#2RMNB    ZA0001           Load ID
      * Send message 'Auto load # not in effect'
     C                     MOVEL'USR1249' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Val Load Exist        RT - OM Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0026           Load ID
     C                     EXSR SSRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     Z-ADD#2RMNB    ZA0002           Load ID
      * Send message 'Load ID already exists'
     C                     MOVEL'USR1251' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Load type cannot be blank
      * CASE: CTL.Load Type is Blank
     C           #2VDST    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#2VDST    ZA0003           Load Type
      * Send message 'Load Type Must be Entered'
     C                     MOVEL'USR1813' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     END                             *FI
      * 02/12/07 PKD Remove hard coding of Company Number.
      * Rtv Plant Co Status   RT - Company Defaults Internal  * 
     C                     EXSR STRVGN
      * Validate usr company    PKTR01
      * CASE:
      *  - c1ORc2
      *   |- c1    : CTL.USR Company Number is Equal to zero
      *   |- c2    : LCL.Plant Company Sts is Plant Company
      *   '-
     C           #CFKNB    IFEQ *ZERO                      *IF
     C           YL0013    OREQ 'P'                        *OR
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert USR Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #CFKNB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#CFKNB    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0004           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0004           CD3 Ext Numeric
     C                     END                             *FI
      * Send message 'Invalid Company Number'
     C                     MOVEL'USR1783' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9936  *
      *
     C                     END                             *FI
      * Validate region code
      * CASE: CTL.Region Code is Entered
     C           #CV1CD    IFNE *BLANK                     *IF
      * VAL Active Region      RT - PD Region  * 
     C                     EXSR SURVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0005           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0005           CD3 Ext Numeric
     C                     END                             *FI
     C                     MOVEL#CV1CD    ZA0006           Region Code
      * Send message 'PD Region not found'
     C                     MOVEL'USR2225' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9938  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD#CHODT    P1AODT           Scheduled Ship
      * RTV Load Total Weight  RT - Load Header  * 
     C                     EXSR SVRVGN
     C                     END
     C           YPMTFD    CABNE*BLANKS   DATAG1
      * Change of position specified
     C           WZRMNB    CASNE#2RMNB    FBRQRL
     C           WZVDST    CASNE#2VDST    FBRQRL
     C           WZC4NB    CASNE#2C4NB    FBRQRL
     C           WZAODT    CASNE#2AODT    FBRQRL
     C           WZBKC7    CASNE#2BKC7    FBRQRL
     C           WZDBCD    CASNE#2DBCD    FBRQRL
     C                     END
     C           DATAG1    TAG
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process subfile control (Pre-confirm)
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     MOVEL'N'       W0RSF            *Reload subfile
     C                     MOVEL#CCUST    P2Q2CD           Shipping Method
      * F4=Prompt
      * CASE: CTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * CTL.Warehouse Code
      * CASE: PGM.*Cursor field <IS> CTL.Warehouse Code
     C           W0CFL     IFEQ '#CAJCD'                   *IF
      * CASE: LCL.Application WHS Restrict is yes
     C           YL0007    IFEQ 'Y'                        *IF
      * Sel User Appl Whs     SR - User Application Whs  * 
     C                     CALL 'PNMMSRR'              90  Sel User Appl W
     C                     PARM *BLANK    W0RTN   7
     C                     PARM ##USR     WQ0039 10        User Profile Na
     C                     PARM 'O/P'     WQ0040  6        Application Cod
     C           #CAJCD    PARM #CAJCD    WQ0041  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNMMSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9937  *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * SEL Warehouse          SR - Warehouse  * 
     C                     CALL 'CAANSRR'              90  SEL Warehouse
     C                     PARM *BLANK    W0RTN   7
     C           #CAJCD    PARM #CAJCD    WQ0042  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAANSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9937  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Val Warehouse         IF
      * VAL: Warehouse Code
      * CASE: PAR.Application WHS Restrict is yes
     C           YL0007    IFEQ 'Y'                        *IF
      * CASE: PAR.Warehouse Code is Blanks
     C           #CAJCD    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#CAJCD    ZA0007           Warehouse Code
      * Send message 'Warehouse Code Required'
     C                     MOVEL'USR2015' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * Val App Whs Itm Acs   XF - User Profile Control  * 
     C                     CALL 'PNMOXFR'              90  Val App Whs Itm
     C                     PARM *BLANK    W0RTN   7
     C                     PARM ##USR     WQ0043 10        User Profile Na
     C                     PARM 'O/P'     WQ0044  6        Application Cod
     C                     PARM #CAJCD    WQ0045  3        Warehouse Code
     C                     PARM *ZERO     WQ0046  70       Item Code
     C           YL0014    PARM *BLANK    WQ0047  1        WHS/Item Access
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNMOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9937  *
     C                     END
      * CASE: LCL.WHS/Item Access Sts USR is Access Denied
     C           YL0014    IFEQ 'D'                        *IF
      * Setup message data for message
     C                     MOVEL##USR     ZA0008           *USER
     C                     MOVEL#CAJCD    ZA0009           Warehouse Code
      * Send message 'Access Denied: Warehouse'
     C                     MOVEL'USR2776' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Warehouse Code is Not Blanks
     C           #CAJCD    IFNE *BLANK                     *IF
      * Val Warehouse Exists   RT - Warehouse  * 
     C                     EXSR SWRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
      * Setup message data for message
     C                     MOVEL#CAJCD    ZA0010           Warehouse Code
      * Send message 'Warehouse              NF'
     C                     MOVEL'USR0007' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Reload if CTL positioners/selectors changed
      * CASE: CTL.Order Number NE WRK.Order Number
     C           #2C4NB    IFNE WUC4NB                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: CTL.USR Company Number NE WRK.USR Company Number
     C           #CFKNB    IFNE WUFKNB                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: CTL.Warehouse Code NE LCL.Warehouse Code
     C           #CAJCD    IFNE YL0008                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: CTL.USR Stop NE PAR.Stop/Drop
     C           #CTENB    IFNE P3RVNB                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: CTL.Scheduled Ship Date NE WRK.Scheduled Ship Date
     C           #2AODT    IFNE WUAODT                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: CTL.USR Assigned This Load NE WRK.USR Assigned This Load
     C           #CQZST    IFNE WUQZST                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: CTL.USR Weight, 5.0 NE WRK.USR Weight, 5.0
     C           #CYGNX    IFNE WUYGNX                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: CTL.LTL Flag NE PAR.LTL Flag
     C           #2PJST    IFNE P2PJST                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: CTL.Ship To State Code NE WRK.Ship To State Code
     C           #2DBCD    IFNE WUDBCD                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: CTL.Ship To Customer NE WRK.Ship To Customer
     C           #2BKC7    IFNE WUBKC7                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: CTL.Region Code NE WRK.Region Code
     C           #CV1CD    IFNE WUV1CD                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: CTL.Reefer Temperature NE WRK.Reefer Temperature
     C           #2RNNB    IFNE WURNNB                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: CTL.Header Status NE WRK.Header Status
     C           #2GWST    IFNE WUGWST                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: CTL.USR Shipping Method NE WRK.Shipping Method
     C           #CCUST    IFNE WUQ2CD                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: CTL.Customer Purchase Order # NE WRK.Customer Purchase Orde
     C           #2BCNA    IFNE WUBCNA                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: CTL.Load Type NE PAR.Load Type
     C           #2VDST    IFNE P2VDST                     *IF
      * ** E00118 03/12/2008
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Update "last" ctl fields
     C                     EXSR UDSUBR                     Update "last" c
      * CTL.Status Description = Condition name of CTL.Load Type
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1250409   Y2LSNO  70       List number
     C                     PARM #2VDST    W0INVL 25        Load Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #CHKNA    PARM           W0CNNM 25        Status Descript
      *
      * Update if CTL load type or CTL Shipping method changed
      * CASE:
      *  - c1 OR c2
      *   |- c1    : CTL.Load Type NE PAR.Load Type
      *   |- c2    : CTL.USR Shipping Method NE WRK.USR Shipping Method
      *   '-
     C           #2VDST    IFNE P2VDST                     *IF
     C           #CCUST    ORNE WUCUST                     *OR
      * PAR updated after update
      * VAL Load Exist        RT - OM Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0026           Load ID
     C                     EXSR SSRVGN
      * If load is found then change
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * RMC S00255 update carrier here too
      * CHG Ld Typ/Shp Mth/Alc CH - Load Header  * 
     C                     EXSR SXCHRC
     C                     END                             *FI
     C                     MOVEL#CCUST    WUCUST           USR Shipping Me
     C                     MOVEL#2VDST    P2VDST           Load Type
     C                     END                             *FI
      * OMS132:Dflt Bulk loads to Pounds allocation; regular loads to Mil
      * CASE: CTL.Load Type is Regular
     C           #2VDST    IFEQ 'R'                        *IF
     C                     MOVEL'M'       #CQ7ST           Allocate By Pou
     C                     ELSE
      * CASE: CTL.Load Type is Bulk
     C           #2VDST    IFEQ 'B'                        *IF
     C                     MOVEL'T'       #CQ7ST           Allocate By Pou
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'M'       #CQ7ST           Allocate By Pou
     C                     END                             *FI
     C                     END                             *FI
      * RTV Del All Stop Custs RT - *Arrays  * 
     C                     EXSR SYRVGN
      * Ensure that load id is entered
      * CASE: CTL.Load ID EQ WRK.ZERO
     C           #2RMNB    IFEQ WUW0NB                     *IF
      * Setup message data for message
     C                     Z-ADD#2RMNB    ZA0011           Load ID
      * Send message 'Value Required (numeric)'
     C                     MOVEL'USR1962' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
      * If add mode, make confirm yes
      * CASE: PAR.Load ID EQ WRK.ZERO
     C           P1RMNB    IFEQ WUW0NB                     *IF
     C                     MOVEL'N'       W0DCF            *Defer confirm
      * set confirm to yes so can create header without adding orders
     C                     END                             *FI
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * Reload subfile requested
     C           W0RSF     CABEQ'Y'       DAEXIT
     C                     END
     C           *IN81     IFEQ '1'
      * Process subfile records
     C                     EXSR DBPRSF
     C                     END
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * USER: Final processing (Pre-confirm)
      * Retrieve current stops for load and update *Array with Delivery D
      * RTV Stop/Drop & Order# RT - Load Detail  * 
     C                     EXSR TARVGN
      * Retrieve array to edit stop/delivery date sequence
     C                     Z-ADD*ZERO     WUEIDT           Requested Deliv
      * RTV Stops/Chk Dte Seq  RT - *Arrays  * 
     C                     EXSR TDRVGN
      * Check Error?
      * CASE: PGM.*Return code is Check Error
     C           W0RTN     IFEQ @CN,004                    *IF
      * Setup message data for message
     C                     Z-ADDP3RVNB    ZA0012           Stop/Drop
      * Send message 'Stop Sequence Invalid'
     C                     MOVEL'USR2372' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * RTV Del All Stops      RT - *Arrays  * 
     C                     EXSR TERVGN
      * RTV Deliv Dts for Edt  RT - Order Header TRG  * 
     C                     EXSR TGRVGN
      * TPA 10/03/07 - If add mode, CTL Gross weight is calc in subfile
      * Change mode so go to Load and then Order to get Gross weights
      * CASE: PAR.Load ID is Blank
     C           P1RMNB    IFEQ *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV GrsWgt w/PltTr Ld RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0008           Load ID
     C                     Z-ADD*ZERO     WL0009           Stop/Drop Seque
     C                     Z-ADDP2DHWG    WL0010           USR Weight Accu
     C                     MOVEL#PPKST    WL0011    P      Load Status
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0010    P2DHWG           USR Weight Accu
     C                     ADD  P2DHWG    P8DTWG           Weight Adjust
     C                     END                             *FI
     C           1         MULT P8DTWG    #CDTWG           Weight Adjust
     C                     Z-ADD*ZERO     P8DTWG           Weight Adjust
      * Maximum message
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.Weight Adjust GT PAR.Maximum pounds
      *   |- c2    : PAR.Maximum pounds NE WRK.ZERO
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CDTWG    IFGT P3RSNB                     *IF
     C           P3RSNB    IFNE WUW0NB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Send message 'Load Weight GT Maximum'
     C                     MOVEL'USR1261' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
      * * C0480 -- 6/16/15 do here as it was
      * PK0302 Perform Max Sched Ship Wt flag is Y & ship method is Truck
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Max Schd Shp Wt Edit Flg is Yes
      *   |- c2    : PAR.Shipping Method is Not Rail
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0015    IFEQ 'Y'                        *IF
     C           P2Q2CD    IFEQ 'CT'                       *IF
     C           P2Q2CD    OREQ 'PT'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: LCL.Order Weight Assigned is Greater than zero
     C           YL0016    IFGT *ZERO                      *IF
      * CASE: WRK.Company Organization is Seaboard
     C           WUYJSX    IFEQ 'S'                        *IF
      * ** Flag to update SSD if it is changed                E002102
      * SEL Sched Loads Cnfrm  PV - Load Header  * 
     C                     CALL 'POJSPVR'              90  SEL Sched Loads
     C                     PARM *BLANK    W0RTN   7
     C           P9B8ST    PARM P9B8ST    WQ0048  1        Status - Y or N
     C                     PARM #2RMNB    WQ0049  70       Load ID
     C                     PARM YL0017    WQ0050  70       Scheduled Ship
     C                     PARM P3NVDT    WQ0051  70       Deadline Depart
     C           WUN7CD    PARM WUN7CD    WQ0052  1        USR Return Code
     C           YL0018    PARM YL0018    WQ0053  70       Scheduled Ship
     C                     PARM YL0016    WQ0054 112       Order Weight As
     C                     PARM WUCBAA    WQ0055  3        Warehouse Code
     C                     PARM WUJFSX    WQ0056  2        Warehouse Type
     C           YL0019    PARM YL0019    WQ0057  2        Slot Type f/New
     C                     PARM YL0020    WQ0058 112       Boxes Total Qua
     C                     PARM P1EIDT    WQ0059  70       Req Delivery Da
     C                     PARM #2C4NB    WQ0060  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POJSPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993135*
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WUN7CD           USR Return Code
     C                     END                             *FI
      * CASE: WRK.USR Return Code is Exists
     C           WUN7CD    IFEQ 'E'                        *IF
     C                     MOVEL'Y'       WUECST           Error Status
     C                     MOVEL'Y'       WUTJST           USR Display 2
     C                     MOVEL*BLANK    WUTIST           USR Display 1
     C                     Z-ADD*ZERO     P3NVDT           Deadline Depart
     C                     Z-ADD*ZERO     P3BUTM           Deadline Depart
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL*BLANK    WUECST           Error Status
      * Determine if dates are in correct order on load
      * CASE: PAR.Shipping Method is Buyers Truck
     C           P2Q2CD    IFEQ 'CR'                       *IF
     C           P2Q2CD    OREQ 'CT'
     C                     ELSE
      * CASE: LCL.Scheduled Ship Date USR is Entered
     C           YL0018    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUT3CD           Warehouse Code
      * ** Change to use the XF instead of the RT             E00495
      * ** Use carrier appt date/time if entered, else RSD/T  E00495
      * CLC Must Ship/Load     XF - Order Header TRG  * 
     C                     CLEARPARC
     C                     Z-ADD#2RMNB    PARMNB           Load ID
     C                     Z-ADD*ZERO     PAC4NB           Order Number
      *
     C                     CALL 'PMQAXFR'              90  CLC Must Ship/L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Order Head
     C           WUB7SX    PARM *BLANK    WQ0061  3        Must Ship Error
     C           P5AJCD    PARM P5AJCD    WQ0062  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMQAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * CASE: WRK.Must Ship Error is No Error
     C           WUB7SX    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: WRK.Must Ship Error is Req Ship should =Must Shp
     C           WUB7SX    IFEQ 'RSD'                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Display program will log the deadline errors
      * DSP Must Ship Err/Load DF - Load Detail  * 
     C                     CLEARPBRC
     C                     Z-ADD#2RMNB    PBRMNB           Load ID
      *
     C                     CALL 'PDMBDFR'              90  DSP Must Ship E
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Load Detai
     C                     PARM YL0018    WQ0063  70       Scheduled Ship
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMBDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     MOVEL'N'       WUSTYN           USR Exit Progra
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       YL0021           First Order Ass
     C                     END                             *FI
     C                     END                             *FI
      * RMC 1/3/05 - Order not on load matching load start co
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Status Flag 3  Y/N is No
      *   |- c2    : LCL.Order Weight Assigned is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUQ3ST    IFEQ 'N'                        *IF
     C           YL0016    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0013           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0013           CD3 Ext Numeric
     C                     END                             *FI
      * Send message 'Order nf matching ld strt'
     C                     MOVEL'USR3403' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * If no errors, display assign message
      * CASE: WRK.USR Display 2 is Yes
     C           WUTJST    IFEQ 'Y'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Assign message
      * CASE: WRK.USR Display 1 is Yes
     C           WUTIST    IFEQ 'Y'                        *IF
      * Send message 'Assign load pending'
     C                     MOVEL'USR1258' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL*BLANK    WUTIST           USR Display 1
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.USR Display 1 is No
     C           WUTIST    IFEQ 'N'                        *IF
      * Setup message data for message
     C                     Z-ADDWUTENB    ZA0014           USR Stop
      * Send message 'This order cannot arrive'
     C                     MOVEL'USR2688' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     MOVEL*BLANK    WUTIST           USR Display 1
     C                     MOVEL'N'       P9B8ST           Status - Y or N
     C                     END                             *FI
     C                     END                             *FI
      * If error, quit processing
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPRCF
      * Exit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO DAEXIT
     C                     END
      * Process subfile (pass 2)
     C                     EXSR EAPRSF
      * If error during 2nd pass exit:
     C           *IN99     CABEQ'1'       DAEXIT
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
      * Process subfile record
     C                     EXSR DCPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Setof error indicators and SFLNXTCHG
     C                     MOVEAWKIND0    *IN,45
     C                     SETOF                     98    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C           YPMTFD    CABNE*BLANKS   DCEXIT
      * SFLNXTCHG
     C                     SETON                     84
      * USER: Process subfile record (Pre-confirm)
      * Ensure we're showing current order data
     C                     EXSR UESUBR                     Ensure we're sh
      * Clr Program Message Q  US - /UT User Source  * 
      * CLEAR MESSAGES FROM PROGRAM MESSAGE QUEUE.
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ           ALREADY DEFINED
     C                     PARM '*SAME'   ZAPGRL           ALREADY DEFINED
      * RESET FIRST MESSAGE ONLY FLAG.
     C                     MOVEL'Y'       ZAFSMS  1        ALREADY DEFINED
      * PK0302 --Set Fields to null on for Sched Wt Exceeded processing
      * CASE: LCL.First Order Assigned is yes
     C           YL0021    IFEQ 'Y'                        *IF
     C                     MOVELWUXKTX    YL0022           Slot Type f/loa
     C                     MOVELWUXKTX    YL0023           Warehouse Code
     C                     MOVELWUXKTX    YL0024           Warehouse Type
     C                     Z-ADD*ZERO     YL0016           Order Weight As
     C                     MOVEL'N'       YL0021           First Order Ass
     C                     END                             *FI
      * Checks
      * CASE: WRK.USR Display 1 is *blank
     C           WUTIST    IFEQ *BLANK                     *IF
      * Check shipping method
      * CASE: RCD.Shipping Method is Buyers Truck
     C           #1Q2CD    IFEQ 'CR'                       *IF
     C           #1Q2CD    OREQ 'CT'
     C                     MOVEL'Y'       WUTIST           USR Display 1
      * ** Default carrier code to BUY for collect shipments   FP1251
     C                     MOVEL'BUY'     #2BZNA           Carrier Code
     C                     MOVEL'BUY'     WUBZNA           Carrier Code
     C                     END                             *FI
      * ** (DDD/T will be zeros if no Miles Between Cities record)
      * Determining that order can arrive on time.
      * CASE:
      *  - c1ANDc2
      *   |- c1    : RCD.Shipping Method is Prepaid
      *   |- c2    : RCD.*SFLSEL is *Assign to Load
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1Q2CD    IFEQ 'PR'                       *IF
     C           #1Q2CD    OREQ 'PT'
     C           #1SEL     IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Deadln DepartDT/TM RT - OM Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0032           Load ID
     C                     EXSR TIRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0033    WUHDDT           Deadline Depart
     C                     Z-ADDWL0034    WUAUTM           Deadline Depart
      * ** Get country, if international, skip miles between cities test
      * RTV Country Code       RT - Customer  * 
     C                     EXSR TJRVGN
      * ** Retrieve the full city name to pass to the clc pgm    FP1251 2
      * RTV Ship To City/State RT - Order Header TRG  * 
     C                     EXSR TKRVGN
     C                     MOVEL*BLANK    WUT3CD           Warehouse Code
      * CLC Must Ship Date     XF - Order Header TRG  * 
     C                     CALL 'PDJBXFR'              90  CLC Must Ship D
     C                     PARM *BLANK    W0RTN   7
     C           WUB7SX    PARM *BLANK    WQ0064  3        Must Ship Error
     C                     PARM #1C4NB    WQ0065  70       Order Number
     C                     PARM #1A5DT    WQ0066  70       Requested Ship
     C                     PARM WUGUNA    WQ0067 20        Ship To City
     C                     PARM #1DBCD    WQ0068  2        Ship To State C
     C                     PARM #1AIC3    WQ0069  30       Company Number
     C                     PARM #1RMNB    WQ0070  70       Load ID
     C                     PARM #1AFTM    WQ0071  40       Requested Deliv
     C                     PARM #1AODT    WQ0072  70       Scheduled Ship
     C                     PARM #1EIDT    WQ0073  70       Requested Deliv
     C           WUT3CD    PARM WUT3CD    WQ0074  3        Warehouse Code
     C           WULYDT    PARM WULYDT    WQ0075  70       Must Ship Date
     C           WUA5TM    PARM WUA5TM    WQ0076  60       Must Ship Time
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDJBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Process date order error
      * CASE:
      *  - c1 OR c2 OR (c3 AND c4)
      *   |- c1    : WRK.Must Ship Error is No Error
      *   |- c2    : WRK.Must Ship Error is Req Ship should =Must Shp
      *   |- c3    : LCL.Country Code is Entered
      *   |- c4    : LCL.Country Code is Not USA
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUB7SX    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WUB7SX    IFEQ 'RSD'                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           YL0025    IFNE *BLANK                     *IF
     C           YL0025    IFNE 'USA'                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ** Requested Ship = Must Ship is not an error here.     FP1251
     C                     MOVEL'Y'       WUTIST           USR Display 1
     C                     MOVEL*BLANK    WUB7SX           Must Ship Error
     C                     ELSE
      * CASE: WRK.Must Ship Error is Miles to Next=Zeros
     C           WUB7SX    IFEQ 'MTN'                      *IF
      * ** DDD/T will be zeros if no Miles Between Cities record
      * ** as well as the Must Ship Date in wrk context.
      * ** Create the record - Total load miles will be set to zeros.
      * Setup message data for message
     C                     MOVELWUOKTX    ZA0015           Port City
     C                     MOVELWUXBCD    ZA0016           Sail Port State
      * Send message 'Mileage To City NF'
     C                     MOVEL'USR2834' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y'       WUTIST           USR Display 1
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     Z-ADD#RTENB    ZA0017           USR Stop
      * Send message 'This order cannot arrive'
     C                     MOVEL'USR2688' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9846  *
      *
     C                     MOVEL'N'       WUTIST           USR Display 1
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * PROCESS
      * CASE: WRK.USR Display 1 is Yes
     C           WUTIST    IFEQ 'Y'                        *IF
      * If assign to load request, display pending message
      * CASE: RCD.*SFLSEL is *Assign to Load
     C           #1SEL     IFEQ '1'                        *IF
     C                     MOVEL'N'       WUTJST           USR Display 2
      * If load is locked, cannot assign orders to it
      * CASE: CTL.Load Status is Locked thru Invoiced
     C           #PPKST    IFEQ 'I'                        *IF
     C           #PPKST    OREQ 'L'
     C           #PPKST    OREQ 'S'
      * Setup message data for message
     C                     MOVEL#PPKST    ZA0018           Load Status
     C                     Z-ADDWUTENB    ZA0019           USR Stop
      * Send message 'Load Locked Can't Change'
     C                     MOVEL'USR1268' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     MOVEL'Y'       WUTJST           USR Display 2
     C                     ELSE
      * CASE: RCD.Load ID is GT Zero
     C           #1RMNB    IFGT *ZERO                      *IF
      * Send message 'Order Already Assigned'
     C                     MOVEL'USR1267' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     MOVEL'Y'       WUTJST           USR Display 2
     C                     ELSE
      * CASE: RCD.Load Type NE CTL.Load Type
     C           #1VDST    IFNE #2VDST                     *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0020           *SFLSEL
     C                     Z-ADD#RTENB    ZA0021           USR Stop
      * Send message 'Load Type Mismatch'
     C                     MOVEL'USR1867' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     984546*
      *
     C                     MOVEL'Y'       WUTJST           USR Display 2
     C                     ELSE
      * CASE: Shipping method mismatch
      *  - c1 AND c2
      *   |- c1    : PAR.Shipping Method NE WRK.BLANK
      *   |- c2    : PAR.Shipping Method NE RCD.Shipping Method
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2Q2CD    IFNE WUGSTX                     *IF
     C           P2Q2CD    IFNE #1Q2CD                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0022           *SFLSEL
      * Send message 'Shipping Method mismatch'
     C                     MOVEL'USR2227' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9845  *
      *
     C                     MOVEL'Y'       WUTJST           USR Display 2
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : RCD.Order in Use is yes
      *   |- c2    : RCD.Order Number NE PAR.USR Order Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1GJST    IFEQ 'Y'                        *IF
     C           #1C4NB    IFNE P3MPNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0023           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0023           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order in use'
     C                     MOVEL'USR0508' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: New Load < Current Date  (Added 08/22/08 PKD)
      *  - c1 AND c2
      *   |- c1    : RCD.Scheduled Ship Date LT JOB.*Job date
      *   |- c2    : PAR.Scheduled Ship Date is not entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1AODT    IFLT ##JDT                      *IF
     C           P1AODT    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0024           *SFLSEL
      * Send message 'Ship Date Not GE JobDate'
     C                     MOVEL'USR4001' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9845  *
      *
     C                     MOVEL'Y'       WUTJST           USR Display 2
     C                     ELSE
      * CASE: Order Sched ship date NE Load Sched Ship Date
      *  - c1 AND c2
      *   |- c1    : PAR.Scheduled Ship Date is entered
      *   |- c2    : PAR.Scheduled Ship Date NE RCD.Scheduled Ship Date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1AODT    IFNE *ZERO                      *IF
     C           P1AODT    IFNE #1AODT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0025           *SFLSEL
      * Send message 'Ord Schd Shp Dt NE LD Shp'
     C                     MOVEL'USR2330' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9845  *
      *
     C                     MOVEL'Y'       WUTJST           USR Display 2
     C                     ELSE
      * CASE: RCD.USR Stop is Not Entered
     C           #RTENB    IFEQ *ZERO                      *IF
      * Setup message data for message
     C                     Z-ADD#RTENB    ZA0026           USR Stop
      * Send message 'Stop # not entered'
     C                     MOVEL'USR1256' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9846  *
      *
     C                     MOVEL'Y'       WUTJST           USR Display 2
     C                     ELSE
      * CASE: *OTHERWISE
      * Process
      * CASE: RCD.USR Stop NE WRK.ZERO
     C           #RTENB    IFNE WUW0NB                     *IF
     C                     MOVEL*BLANK    WUECST           Error Status
      * RTV Stop Customer      RT - Load Detail  * 
     C                     EXSR TLRVGN
      * Only 1 customer allowed per stop
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Customer Number       NBR NE RCD.Ship To Custome
      *   |- c2    : WRK.Customer Number       NBR NE WRK.ZERO
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUAJNB    IFNE #1BKC7                     *IF
     C           WUAJNB    IFNE WUW0NB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0027           *SFLSEL
      * Send message 'Customer mismatch'
     C                     MOVEL'USR1853' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9845  *
      *
     C                     MOVEL'Y'       WUECST           Error Status
     C                     ELSE
      * CASE: WRK.Customer Number       NBR EQ WRK.ZERO
     C           WUAJNB    IFEQ WUW0NB                     *IF
      * RTV Stop Customer      RT - *Arrays  * 
     C                     EXSR TNRVGN
      * Error if customer mismatch
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Customer Number       NBR NE WRK.ZERO
      *   |- c2    : WRK.Customer Number       NBR NE RCD.Ship To Custome
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUAJNB    IFNE WUW0NB                     *IF
     C           WUAJNB    IFNE #1BKC7                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0028           *SFLSEL
      * Send message 'Customer mismatch'
     C                     MOVEL'USR1853' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9845  *
      *
     C                     MOVEL'Y'       WUECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Shipping Method EQ WRK.BLANK
     C           P2Q2CD    IFEQ WUGSTX                     *IF
     C                     MOVEL#1Q2CD    P2Q2CD           Shipping Method
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * PK0302 Gather Data to perform Max Sched Ship Wt flag is Y & all T
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Max Schd Shp Wt Edit Flg is Yes
      *   |- c2    : RCD.Shipping Method is Not Rail
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0015    IFEQ 'Y'                        *IF
     C           #1Q2CD    IFEQ 'CT'                       *IF
     C           #1Q2CD    OREQ 'PT'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD*ZERO     YL0026           Boxes Day 1 Qua
      * RTV UM/Whs Code Lmt,Bx RT - Order Detail  * 
     C                     EXSR TORVGN
      * RTV Warehouse Type     RT - Warehouse  * 
     C                     EXSR TQRVGN
      * Fresh Orders on a Load make the Load FRESH.
      * CASE: WRK.Warehouse Type Assigned is Fresh
     C           WUJFSX    IFEQ 'FR'                       *IF
      * CASE:
      *  - c1ORc2
      *   |- c1    : LCL.Warehouse Type Assigned is Frozen
      *   |- c2    : LCL.Warehouse Type Assigned is Equal blank
      *   '-
     C           YL0024    IFEQ 'FZ'                       *IF
     C           YL0024    OREQ *BLANK                     *OR
     C                     MOVELWUJFSX    YL0024           Warehouse Type
     C                     MOVELWUCBAA    YL0023           Warehouse Code
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.Warehouse Type Assigned is Equal blank
     C           YL0024    IFEQ *BLANK                     *IF
     C                     MOVELWUJFSX    YL0024           Warehouse Type
     C                     MOVELWUCBAA    YL0023           Warehouse Code
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  #1A1WG    YL0016           Order Weight As
     C                     ADD  YL0026    YL0020           Boxes Total Qua
      * Clc Load Slot Type    IF
      * RMC E2706 9/11/13- No more MX, if MX and boxqty<BOXLOAD Comp valu
      *    then CB Else BX
      * Set UM based on Orders to be assgnd- Priority- CB,EX,BX,MX
      * CASE:
      *  - c1AND(c2ORc3)
      *   |- c1    : PAR.Slot Type f/New Ords USR is Combo
      *   |- c2    : PAR.Slot Type f/load USR is Combo
      *   |- c3    : PAR.Slot Type f/load USR EQ WRK.Blank 6 USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0019    IFEQ 'CB'                       *IF
     C                     MOVEL'0'       Y0CX02  1
     C           YL0022    IFEQ 'CB'                       *IF
     C           YL0022    OREQ WUXKTX                     *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'CB'      YL0022           Slot Type f/loa
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1ORc2ORc3
      *   |- c1    : PAR.Slot Type f/New Ords USR is Export
      *   |- c2    : PAR.Slot Type f/load USR is Export
      *   |- c3    : PAR.Export Status is yes
      *   '-
     C           YL0019    IFEQ 'EX'                       *IF
     C           YL0022    OREQ 'EX'                       *OR
     C           #1U2ST    OREQ 'Y'                        *OR
     C                     MOVEL'EX'      YL0022           Slot Type f/loa
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1AND(c2ORc3)
      *   |- c1    : PAR.Slot Type f/New Ords USR is Box
      *   |- c2    : PAR.Slot Type f/load USR is Box
      *   |- c3    : PAR.Slot Type f/load USR EQ WRK.Blank 6 USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0019    IFEQ 'BX'                       *IF
     C                     MOVEL'0'       Y0CX02  1
     C           YL0022    IFEQ 'BX'                       *IF
     C           YL0022    OREQ WUXKTX                     *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'BX'      YL0022           Slot Type f/loa
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'MX'      YL0022           Slot Type f/loa
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Slot Type f/load USR is Mixed
     C           YL0022    IFEQ 'MX'                       *IF
      *
     C                     MOVEL*BLANK    WN0145 10        User Code Model
      *
      * RTV Default Co No App IF
      * RTV Program Setup w/Co RT - User Profile Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##USR     WL0038    P      User Profile Na
     C                     EXSR TRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0039    YN0011    P      Allow Multi-Com
     C                     MOVELWL0040    YN0012    P      Default Printer
     C                     MOVELWL0041    YN0013    P      Salesperson Cod
     C                     Z-ADDWL0042    YL0030           Company Number
     C                     MOVELWL0043    WN0145    P      User Code Model
      * CASE: LCL.Company Number is Equal to zero
     C           YL0030    IFEQ 0                          *IF
      * CASE: PAR.User Code Model is equal to blank
     C           WN0145    IFEQ *BLANK                     *IF
      * RTV First Default Co  RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##USR     WL0044    P      User Profile Na
     C                     EXSR TSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0045    YL0029           Company Number
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV First Default Co  RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0145    WL0044    P      User Profile Na
     C                     EXSR TSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0045    YL0029           Company Number
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0030    YL0029           Company Number
     C                     END                             *FI
      * RTV Numeric Value      RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0029    WL0035           Company Number
     C                     MOVEL'BOXLOAD' WL0036    P      Company Value C
     C                     EXSR TPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0037    YL0031           System Value Nu
      * CASE: PAR.Boxes Total Quantity LT LCL.Box Load Min Box Qty USR
     C           YL0020    IFLT YL0031                     *IF
     C                     MOVEL'CB'      YL0022           Slot Type f/loa
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'BX'      YL0022           Slot Type f/loa
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD#1AODT    YL0017           Scheduled Ship
     C                     END                             *FI
      * RMC -- 1/3/05 save to test that one order exists with the load st
      * CASE:
      *  - c2 AND c1
      *   |- c2    : RCD.Company Number EQ CTL.Company Number
      *   |- c1    : WRK.Status Flag 3  Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1AIC3    IFEQ #2AIC3                     *IF
     C           WUQ3ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUQ3ST           Status Flag 3
     C                     END                             *FI
      * ****
      * CASE: WRK.Error Status is blank
     C           WUECST    IFEQ *BLANK                     *IF
     C                     ADD  #1A1WG    #PRPNB           Total Load Orde
     C                     ADD  #1A1WG    WUBMNB           Total Weight Wo
     C           #1TBNB    DIV  100       WUBHPC    H      USR Percent Wor
     C           #1A1WG    MULT WUBHPC    WUDLVA    H      USR Freight Amo
     C                     ADD  WUDLVA    #PRQNB           Total Freight
      * CRT Load Plan Stop Cst CR - *Arrays  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#RTENB    WL0024           Stop/Drop
     C                     Z-ADD#1BKC7    WL0025           Ship To Custome
     C                     EXSR SQCRRC
      * Update gross weight field for display
     C                     MOVEL'Y'       WUTIST           USR Display 1
      * If there is no scheduled ship date for the load, fill it in
      * CASE: PAR.Scheduled Ship Date EQ WRK.ZERO
     C           P1AODT    IFEQ WUW0NB                     *IF
     C                     Z-ADD#1AODT    P1AODT           Scheduled Ship
     C                     END                             *FI
      * Default:  Load Shipping Method with Order Shipping Method.
      * CASE: PAR.Shipping Method EQ WRK.BLANK
     C           P2Q2CD    IFEQ WUGSTX                     *IF
     C                     MOVEL#1Q2CD    P2Q2CD           Shipping Method
     C                     END                             *FI
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * If delete from load request, display pending message
      * CASE: RCD.*SFLSEL is *Delete from Load
     C           #1SEL     IFEQ '4'                        *IF
      * RMC PFS017 dont allow if order is picked.
      * PFS Val Order Picked  RT - PFS Ship Load/Order Sts  * 
     C                     EXSR TTRVGN
      * If load is locked, don't allow delete    OR Picked-RMC 6/14/06
      * CASE: CTL.Load Status is Lock
     C           #PPKST    IFEQ 'L'                        *IF
      * Setup message data for message
     C                     MOVEL#PPKST    ZA0029           Load Status
     C                     Z-ADDWUTENB    ZA0030           USR Stop
      * Send message 'Load Locked Can't Delete'
     C                     MOVEL'USR1269' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: WRK.Pick Status USR is Picked
     C           WUZMST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0031           *SFLSEL
      * Send message 'Invalid option f/picked o'
     C                     MOVEL'USR3633' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9845  *
      *
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : RCD.Order in Use is yes
      *   |- c2    : RCD.Order Number NE PAR.USR Order Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1GJST    IFEQ 'Y'                        *IF
     C           #1C4NB    IFNE P3MPNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0032           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0032           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order in use'
     C                     MOVEL'USR0508' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Stop Number       RT - Load Detail          TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0016           Load ID
     C                     Z-ADD#1C4NB    WL0018           Order Number
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0017    WURVNB           Stop/Drop
     C                     Z-ADDWL0019    WUNFNN           Appointment Con
     C                     Z-ADDWL0020    WUNFNN           Appointment Con
      * If order is not assigned to load, will not allow delete
      * CASE: RCD.Load ID is Blank
     C           #1RMNB    IFEQ *ZERO                      *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0033           *SFLSEL
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0034           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0034           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order Not Assigned a load'
     C                     MOVEL'USR1874' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9845  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  #1A1WG    #PRPNB           Total Load Orde
     C                     SUB  #1A1WG    WUBMNB           Total Weight Wo
     C           #1TBNB    DIV  100       WUBHPC    H      USR Percent Wor
     C           #1A1WG    MULT WUBHPC    WUDLVA    H      USR Freight Amo
     C                     SUB  WUDLVA    #PRQNB           Total Freight
      * Update gross weight field for display
      * Send message 'Delete From Load Pend'
     C                     MOVEL'USR1265' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     END                             *FI
      * 5=view order
      * CASE: RCD.*SFLSEL is *View Order
     C           #1SEL     IFEQ '5'                        *IF
      * Dsp Order Header      DF - OP Order Header  * 
     C                     CALL 'OMB5PVR'              90  Dsp Order Heade
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0077  30       Company Number
     C                     PARM #1C4NB    WQ0078  70       Order Number
     C                     PARM #1BCNA    WQ0079 15        Customer Purcha
     C                     PARM #1CXDT    WQ0080  70       Date of Origina
     C                     PARM #1AFTM    WQ0081  40       Requested Deliv
     C                     PARM P5DNCD    WQ0082  6        Application Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMB5PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * Load up stop customer array to check stop sequence per delivery d
      * CASE: RCD.USR Stop is Entered
     C           #RTENB    IFNE *ZERO                      *IF
      * CRT Load Stop Array    CR - *Arrays  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#RTENB    WL0030           Stop/Drop
     C                     Z-ADD#1EIDT    WL0031           Requested Deliv
     C                     EXSR TCCRRC
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     END                             *FI
      * Adjust Control Weight
      * CASE: RCD.USR Stop is Entered
     C           #RTENB    IFNE *ZERO                      *IF
      * TPA 10/03/07 - These need to be Gross and not Net weights.
     C                     Z-ADD*ZERO     YL0032           USR Weight Accu
      * ** Retrieve average pallet tare                   E000261
      * RTV Pallet/Tare        RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0012           Load ID
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0013    YN0014           Pallets Loaded
     C                     Z-ADDWL0014    YL0033           Avg Pallet Tare
     C                     Z-ADDWL0015    YN0015           Tot Pallet Tare
      * RTV Gross Wgt/Qty     XF - Order Detail  * 
     C                     CALL 'PQPQXFR'              90  RTV Gross Wgt/Q
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0083  30       Company Number
     C                     PARM #1C4NB    WQ0084  70       Order Number
     C                     PARM *ZERO     WQ0085  30       Order Sequence
     C                     PARM *ZERO     WQ0086  30       Order Secondary
     C           YL0032    PARM YL0032    WQ0087 112       USR Weight Accu
     C           YL0034    PARM YL0034    WQ0088 112       Order Quantity
     C                     PARM YL0033    WQ0089  92       Avg Pallet Tare
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PQPQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE: RCD.*SFLSEL is *Delete
     C           #1SEL     IFEQ '4'                        *IF
     C           #1SEL     OREQ ' 4'
     C                     SUB  YL0032    P8DTWG           Weight Adjust
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: RCD.USR Assigned This Load is No
     C           #RQZST    IFEQ 'N'                        *IF
     C                     ADD  YL0032    P8DTWG           Weight Adjust
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     END                             FI *IN98
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         DHPRCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
      * Set SFLFOLD/SFLDROP from JOB.*Subfile mode
     C                     MOVE ZZSFM     *IN02
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#SFLCTL
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         EAPRSF    BEGSR
      *================================================================
      * Update DBF from subfile
      *================================================================
      * USER: Process subfile control (Post-confirm)
      * Fill in shipping method
      * CASE: CTL.USR Shipping Method EQ WRK.BLANK
     C           #CCUST    IFEQ WUGSTX                     *IF
     C                     MOVELP2Q2CD    #CCUST           USR Shipping Me
      * CASE: CTL.USR Shipping Method is Collect
     C           #CCUST    IFEQ 'CR'                       *IF
     C           #CCUST    OREQ 'CT'
     C                     MOVEL'BUY'     #2BZNA           Carrier Code
     C                     MOVEL'BUY'     WUBZNA           Carrier Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RMC added 5/29/08
      * CASE: CTL.Carrier Code is Buyer's Truck
     C           #2BZNA    IFEQ 'BUY'                      *IF
     C                     MOVEL*BLANK    #2BZNA           Carrier Code
     C                     MOVEL*BLANK    WUBZNA           Carrier Code
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * VAL Load Exist        RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0026           Load ID
     C                     EXSR SSRVGN
      * If header doesn't exist, create it
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
      * CASE: WRK.Company Organization is Seaboard
     C           WUYJSX    IFEQ 'S'                        *IF
      * ** Default shag/ wash flags to "No" for Collect, else, "Yes"  E00
      * CASE: CTL.USR Shipping Method is Collect
     C           #CCUST    IFEQ 'CR'                       *IF
     C           #CCUST    OREQ 'CT'
     C                     MOVEL'N'       WULSHG           Load Shag Flag
     C                     MOVEL'N'       WUYPST           Load Wash Flag
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WULSHG           Load Shag Flag
     C                     MOVEL'Y'       WUYPST           Load Wash Flag
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WULSHG           Load Shag Flag
     C                     MOVEL'N'       WUYPST           Load Wash Flag
     C                     END                             *FI
      * CRT Load Header        CR - Load Header  * 
     C                     EXSR TUCRRC
     C                     Z-ADD#2RMNB    P1RMNB           Load ID
     C                     MOVEL'N'       P3QKST           Display Flag
     C                     MOVEL'Y'       YL0035           Load Create Sts
     C                     END                             *FI
      * ------------
      * Send message 'Processing'
     C                     MOVEL'USR2303' ZAMSID
     C                     MOVEL'*EXT '   ZAPGRL           Rel queue
     C                     MOVEL'*STATUS' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C           *IN81     IFEQ '1'
      * Process all modified subfile records
     C                     READC#SFLRCD                  92*
     C           *IN92     DOWEQ'0'
      * Process modified subfile record
     C                     EXSR EBPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END                             WOD *92
     C                     END                             FI *81
      * If any errors, cancel reload
     C           *IN99     IFEQ '1'
     C                     MOVEL'N'       W0RSF   1
     C                     END
      * USER: Final processing (Post-confirm)
      * PK0302 -- Change sched ship dt
      * CASE: LCL.Status Flag 4  Y/N is yes
     C           YL0036    IFEQ 'Y'                        *IF
      * CASE: LCL.Scheduled Ship Date USR is Entered
     C           YL0018    IFNE *ZERO                      *IF
      * Rtv/Chg Sched Shp Dt   RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0046           Load ID
     C                     Z-ADDYL0018    WL0047           Scheduled Ship
     C                     EXSR TVRVGN
     C                     MOVEL'SCHSHP'  WURVST           Load Change Typ
     C                     MOVEL'TRF'     WUUJST           Department Cont
     C                     MOVEL*BLANK    WUMNTX           Change Log Prio
     C                     MOVELP1AODT    WUMNTX           Change Log Prio
     C                     MOVEL*BLANK    WUMOTX           Change Log New
     C                     MOVELYL0018    WUMOTX           Change Log New
     C                     Z-ADDYL0018    #CHODT           Scheduled Ship
      * RTV Load for Date Chg  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0050           Load ID
     C                     Z-ADDYL0018    WL0051           Scheduled Ship
     C                     MOVELWURVST    WL0052    P      Load Change Typ
     C                     MOVELWUUJST    WL0053    P      Department Cont
     C                     MOVELWUMNTX    WL0054    P      Change Log Prio
     C                     MOVELWUMOTX    WL0055    P      Change Log New
     C                     MOVEL##USR     WL0056    P      *USER
     C                     MOVEL##PGM     WL0057    P      *PROGRAM
     C                     MOVEL#2BZNA    WL0058    P      Carrier Code
     C                     EXSR TXRVGN
     C                     Z-ADDYL0018    #2AODT           Scheduled Ship
     C                     Z-ADDYL0018    WUAODT           Scheduled Ship
     C                     END                             *FI
     C                     END                             *FI
      * Get load weight from orders on load
      * Rtv Sum Ld Abs.Frt/Wgt RT - Order Header TRG  * 
     C                     EXSR NBRVGN
      * If load weight > maximum pounds for truck, LTL for load is N else
      * CASE: CTL.Weight Adjust GE PAR.Maximum pounds
     C           #CDTWG    IFGE P3RSNB                     *IF
     C                     MOVEL'N'       WUPJST           LTL Flag
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUPJST           LTL Flag
     C                     END                             *FI
     C                     Z-ADD*ZERO     WURRNB           Total Stops
      * RTV No. of Stops      RT - Load Detail  * 
     C                     EXSR NCRVGN
      * RTV Export Ords for LD RT - Order Header TRG  * 
     C                     EXSR NDRVGN
      * Change export status to yes if export order found on load
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
     C                     MOVEL'N'       P2U2ST           Export Status
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       P2U2ST           Export Status
     C                     END                             *FI
      * RTV First Order Whse   RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0059           Load ID
     C                     Z-ADD*ZERO     WL0060           Stop/Drop
     C                     EXSR NERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0061    WUVPCD    P      Warehouse Code
      * CHG Ship Fr Whs,Multi CH - Load Header  * 
     C                     EXSR NHCHRC
      * ** We should be passing zeros to CLC Deadline Depart Date
      * calc deadline departure date/time if order was added
      * CASE: WRK.Load Added/Deleted     .U is *No
     C           WUFUST    IFEQ '0'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Use Web version of DDD/T calcs                     W288
     C                     MOVEL*BLANK    WULONA           USR Load Id ALp
     C                     MOVEL#2RMNB    WULONA           USR Load Id ALp
      * CLC Depart Date f/web  XF - Load Header  * 
     C                     CALL 'PNMAXFR'              90  CLC Depart Date
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WULONA    WQ0122  7        USR Load Id ALp
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNMAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * ** Deadline Departure Date/Time Restrictions          W288
     C                     EXSR UGSUBR                     ** Deadline Dep
      * RTV Default Load Seq  RT - Warehouse  * 
     C                     EXSR NIRVGN
      * Default Load Sequence = Yes?
      * CASE: LCL.Default Load Sequence is yes
     C           YL0043    IFEQ 'Y'                        *IF
     C                     Z-ADD1         YL0001           Schedule Sequen
     C                     END                             *FI
      * Calculate Total Load Miles
     C                     EXSR UHSUBR                     Calculate Total
      * ** Moved from before the calc routine to after.
      * ** Changed update to use wrk.total load miles     E00207
      * Calc Load U/M           -- RMC 4/17/14 e3067
     C                     EXSR UISUBR                     Calc Load U/M
      * CHG for Load Plan O.E. CH - Load Header  * 
     C                     EXSR NKCHRC
      * Change header; if in add mode, have already added it
      * ** Update ship to state for exports               E002128
      * CASE: PAR.Export Status is yes
     C           P2U2ST    IFEQ 'Y'                        *IF
      * RTV ExpOrd Info for LD XF - Order Header TRG  * 
     C                     CALL 'PMJMXFR'              90  RTV ExpOrd Info
     C                     PARM *BLANK    W0RTN   7
     C                     PARM *ZERO     WQ0160  70       Order Number
     C                     PARM *ZERO     WQ0161  70       Ship To Custome
     C                     PARM *BLANK    WQ0162 30        Ship To Name
     C                     PARM *BLANK    WQ0163 30        Ship To Address
     C                     PARM *BLANK    WQ0164 30        Ship To Address
     C                     PARM *BLANK    WQ0165 30        Ship To Address
     C                     PARM *BLANK    WQ0166 20        Ship To City
     C           P2DBCD    PARM *BLANK    WQ0167  2        Ship To State C
     C                     PARM *BLANK    WQ0168 11        Ship To Zip/Pos
     C                     PARM *BLANK    WQ0169  3        Carrier Code
     C                     PARM #2RMNB    WQ0170  70       Load ID
     C                     PARM *BLANK    WQ0171  1        Export Status
     C                     PARM *BLANK    WQ0172  1        Export Docs Go
     C                     PARM *BLANK    WQ0173  1        Air Freight Ord
     C                     PARM *BLANK    WQ0174  2        Export USDA App
     C                     PARM *ZERO     WQ0175  30       Company Number
     C                     PARM *ZERO     WQ0176  50       Stop/Drop Seque
     C                     PARM *BLANK    WQ0177  3        Shipping Line
     C                     PARM *BLANK    WQ0178 20        Port Delv Termi
     C                     PARM *BLANK    WQ0179 25        OHE City
     C                     PARM *BLANK    WQ0180 30        OHE Vessel/Airl
     C                     PARM *BLANK    WQ0181 15        OHE Voyage/Flig
     C                     PARM *BLANK    WQ0182 15        OHE Booking Num
     C                     PARM *BLANK    WQ0183 20        OHE Discharge P
     C                     PARM *ZERO     WQ0184  70       OHE Sail/Flight
     C                     PARM *ZERO     WQ0185  70       OHE Port Cut Da
     C                     PARM *ZERO     WQ0186  70       OHE Arrival Dat
     C                     PARM *BLANK    WQ0187  3        OHE Late Delive
     C                     PARM *BLANK    WQ0188  1        OHE Ship Status
     C                     PARM *BLANK    WQ0189 12        OHE Container N
     C                     PARM *BLANK    WQ0190 35        OHE Comment 1
     C                     PARM *BLANK    WQ0191 75        OHE Comment 2
     C                     PARM *BLANK    WQ0192 25        Port City
     C                     PARM *BLANK    WQ0193 25        Port Address Li
     C                     PARM *BLANK    WQ0194 25        Port Address Li
     C                     PARM *BLANK    WQ0195  2        Sail Port State
     C                     PARM *BLANK    WQ0196 11        Port Zip/Postal
     C                     PARM *ZERO     WQ0197 110       Port Phone Numb
     C                     PARM *BLANK    WQ0198 25        Port Fax Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMJMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * CHG Ship To St-Exports CH - Load Header  * 
     C                     EXSR NLCHRC
     C                     END                             *FI
     C                     MOVEL#CCUST    WUCUST           USR Shipping Me
     C                     MOVEL#2VDST    P2VDST           Load Type
      * Send message that the load was created for the current date.
      * CASE: LCL.Load Create Sts USR is yes
     C           YL0035    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    YL0045           Office Message
      *
     C                     MOVEL*BLANK    WN1130  8        Dsp Date (99/99
     C                     MOVEL*BLANK    WN1131 40        System Value Al
      *
      * SndMsg Ld Crt -Cur Dt IF
      * RTV Alpha Value        RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0005           Company Number
     C                     MOVEL'LOADMSG' WL0006    P      Company Value C
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    WN1131    P      System Value Al
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVELWN1131    WUCLAA           DL List ID
      * CASE: PAR.Scheduled Ship Date EQ JOB.*Job date
     C           #CHODT    IFEQ ##JDT                      *IF
      * Rtv Date Display Fmt  IF
     C                     MOVEL*BLANK    YL0046           Date (Alpha) US
     C                     MOVEL#CHODT    YL0046           Date (Alpha) US
      * 99/
     C                     Z-ADD2         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0046:ZQ YL0047    P  90  Date Component
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZEROS    ZQ      50
     C           YL0047    CAT  '/':ZQ    WN1130    P      Dsp Date (99/99
      * 99/99/
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0046:ZQ YL0047    P  90  Date Component
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZEROS    ZQ      50
     C           WN1130    CAT  YL0047:ZQ WN1130    P      Dsp Date (99/99
     C                     Z-ADD*ZEROS    ZQ      50
     C           WN1130    CAT  '/':ZQ    WN1130    P      Dsp Date (99/99
      * 99/99/99
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0046:ZQ YL0047    P  90  Date Component
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZEROS    ZQ      50
     C           WN1130    CAT  YL0047:ZQ WN1130    P      Dsp Date (99/99
      * Setup message data for message
     C                     Z-ADD#2RMNB    ZA0037           Load ID
     C                     MOVEL##USR     ZA0038           *USER
     C                     MOVELWN1130    ZA0039           Dsp Date (99/99
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0040           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0040           CD3 Ext Numeric
     C                     END                             *FI
      * Retrieve message Load Created -Cur Dte
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR2945' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0045    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * SND Pager Msg (MPLUS) UP - /UT User Programs  * 
     C                     CALL 'POMSUPC'              90  SND Pager Msg (
     C                     PARM WUCLAA    WQ0199 10        DL List ID
     C                     PARM YL0045    WQ0200132        Office Message
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMSUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * ***** Change log and comments
     C                     EXSR UJSUBR                     ***** Change lo
      * CASE: CTL.Company Number is not equal to zero
     C           #2AIC3    IFNE *ZERO                      *IF
      * ** Retrieve ESEND email list by company           E00328
      * Rtv Alpha Value       XF - Company Values  * 
     C                     CALL 'POMTXFR'              90  Rtv Alpha Value
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0201  30       Company Number
     C                     PARM @CN,005   WQ0202 10        Company Value C
     C           YL0048    PARM *BLANK    WQ0203 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.System Value Alpha is Not equal to Blank
     C           YL0048    IFNE *BLANK                     *IF
      * CASE: LCL.Office Message USR NE WRK.Blank for 30          USR
     C           YL0045    IFNE WUW4TX                     *IF
     C                     Z-ADD1         ZQ      50
     C           @CN,006   CAT  @CN,007:ZQYL0049    P      Subject Line US
      * CLP Exe ESNDMAIL Cmd   UP - /UT User Programs  * 
     C                     CALL 'PPW6UPC'              90  CLP Exe ESNDMAI
     C                     PARM YL0050    WQ0204  7        Return Code Usr
     C                     PARM YL0048    WQ0205 50        Email Address
     C                     PARM YL0049    WQ0206100        Subject Line US
     C                     PARM YL0045    WQ0207256        Pager Msg 256 U
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPW6UPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Auto Combine Load
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.Auto Combine Loads STS is yes
      *   |- c2    : CTL.Shipping Method is Collect
      *   '-
     C           YL0051    IFEQ 'Y'                        *IF
     C           #2Q2CD    OREQ 'CR'                       *OR
     C           #2Q2CD    OREQ 'CT'
      * Get latest updated version of Load Header
      * RTV WW Screen Fields   RT - Load Header  * 
     C                     EXSR NMRVGN
      * RTV Total Ld Mi/Sts    RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0062           Load ID
     C                     EXSR NNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0063    YN0067    P      Load Status
     C                     Z-ADDWL0064    YL0059           Total Load Mile
     C                     Z-ADDWL0065    P2K2DT           Override Total
      * Verify Ship From Warehouse present
      * CASE: LCL.Ship From Warehouse is Warehouse Code Blank
     C           YL0002    IFEQ *BLANK                     *IF
      * RTV First Order Whse   RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0059           Load ID
     C                     Z-ADD*ZERO     WL0060           Stop/Drop
     C                     EXSR NERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0061    YL0002    P      Warehouse Code
     C                     END                             *FI
      * Can load be combined?
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0063           Continue (Yes/N
      * Load Status = Entered?
      * CASE: CTL.Load Status is Entered
     C           #PPKST    IFEQ 'E'                        *IF
      * RTV Any Ord/Blk  on Ld RT - Order Header TRG  * 
     C                     EXSR NORVGN
      * Block order error/minimum load weight msg
      * CASE: LCL.Block Order Flag is Block Order
     C           YL0064    IFEQ 'B'                        *IF
      * Setup message data for message
     C                     MOVELYL0065    ZA0041           *SFLSEL
     C                     Z-ADD#2RMNB    ZA0042           Load ID
      * Send message 'Block Orders on Load'
     C                     MOVEL'USR2440' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     ELSE
      * CASE: PAR.USR Check Y/N Status is yes
     C           P6JDST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0063           Continue (Yes/N
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVELYL0065    ZA0043           *SFLSEL
     C                     Z-ADD#2RMNB    ZA0044           Load ID
      * Send message 'Load cannot be combined'
     C                     MOVEL'USR2198' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     Z-ADD#2RMNB    ZA0045           Load ID
     C                     MOVELYL0065    ZA0046           *SFLSEL
      * Send message 'Load Id can not be change'
     C                     MOVEL'USR1875' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
      * Combine Load if edits are passed
      * CASE: LCL.Continue (Yes/No) USR is Yes
     C           YL0063    IFEQ 'Y'                        *IF
      * Combine Load
      * CASE:
      *  - (c1 OR c2) OR (c3 AND c4)
      *   |- c1    : LCL.Max Schd Shp Wt Edit Flg is NO
      *   |- c2    : LCL.Shipping Method is Collect or Rail
      *   |- c3    : LCL.Max Schd Shp Wt Edit Flg is Yes
      *   |- c4    : LCL.Shipping Method is Not Rail
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0015    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           YL0060    IFEQ 'CR'                       *IF
     C           YL0060    OREQ 'CT'
     C           YL0060    OREQ 'PR'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           YL0015    IFEQ 'Y'                        *IF
     C           YL0060    IFEQ 'CT'                       *IF
     C           YL0060    OREQ 'PT'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CLC Deadline Date/Time XF - Load Detail  * 
     C                     CALL 'PMP9XFR'              90  CLC Deadline Da
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2RMNB    WQ0208  70       Load ID
     C           WUKZDT    PARM WUKZDT    WQ0209  70       Deadline Depart
     C           WUAXTM    PARM *ZERO     WQ0210  60       Deadline Depart
     C                     PARM *ZERO     WQ0211  70       Requested Deliv
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMP9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * OMS304
      * TPA 091907 - Only combine the load if it passes min weight test
      * If Load weight under min leave sts as 'E' else set to 'C'
      * CASE: PAR.USR Check Y/N Status is yes
     C           P6JDST    IFEQ 'Y'                        *IF
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Total Load Order Weight LT PAR.Minimum pounds
      *   |- c2    : PAR.Minimum pounds NE WRK.ZERO
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0054    IFLT P3TANB                     *IF
     C           P3TANB    IFNE WUW0NB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CHG Ld Sts/Dpt D/T Whs CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0066           Load ID
     C                     Z-ADDYL0052    WL0067           Scheduled Ship
     C                     MOVEL'E'       WL0068    P      Load Status
     C                     MOVELYL0002    WL0069    P      Ship From Wareh
     C                     Z-ADDWUKZDT    WL0070           Deadline Depart
     C                     Z-ADDWUAXTM    WL0071           Deadline Depart
     C                     EXSR NPCHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * CHG Ld Sts/Dpt D/T Whs CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0066           Load ID
     C                     Z-ADDYL0052    WL0067           Scheduled Ship
     C                     MOVEL'C'       WL0068    P      Load Status
     C                     MOVELYL0002    WL0069    P      Ship From Wareh
     C                     Z-ADDWUKZDT    WL0070           Deadline Depart
     C                     Z-ADDWUAXTM    WL0071           Deadline Depart
     C                     EXSR NPCHRC
      * 01/21/08 RMC  Create Change Log for Combine process - 1st order o
      * 06/26/08 RMC  Pass in 'cmblod' here  - E00180
      * RTV All Ords f/CMBLOD RT - Load Detail  * 
     C                     EXSR NQRVGN
     C                     END                             *FI
     C                     END                             *FI
      * CHG Deadline Date/Time RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0072           Load ID
     C                     Z-ADD*ZERO     WL0073           Stop/Drop Seque
     C                     Z-ADDWUKZDT    WL0074           Deadline Depart
     C                     Z-ADDWUAXTM    WL0075           Deadline Depart
     C                     EXSR NRRVGN
     C                     END                             *FI
      * Perform post combine routines?
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Max Schd Shp Wt Edit Flg is Yes
      *   |- c2    : LCL.Shipping Method is Not Rail
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0015    IFEQ 'Y'                        *IF
     C           YL0060    IFEQ 'CT'                       *IF
     C           YL0060    OREQ 'PT'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Can Load Arrive On time?       4/26/01 RMC
      * CASE: LCL.Scheduled Ship Date USR is Entered
     C           YL0018    IFNE *ZERO                      *IF
      * CASE: LCL.Scheduled Ship Date USR GT WRK.Deadline Departure Date
     C           YL0018    IFGT WUKZDT                     *IF
      * Setup message data for message
     C                     Z-ADD#2RMNB    ZA0047           Load ID
      * Send message 'Sched Ship Dt is after DD'
     C                     MOVEL'USR3046' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.Scheduled Ship Date GT WRK.Deadline Departure Date
     C           YL0052    IFGT WUKZDT                     *IF
      * Setup message data for message
     C                     Z-ADD#2RMNB    ZA0048           Load ID
      * Send message 'Sched Ship Dt is after DD'
     C                     MOVEL'USR3046' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
      * Load Weight LT Minimum information message
      * CASE: PAR.USR Check Y/N Status is yes
     C           P6JDST    IFEQ 'Y'                        *IF
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Total Load Order Weight LT PAR.Minimum pounds
      *   |- c2    : PAR.Minimum pounds NE WRK.ZERO
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0054    IFLT P3TANB                     *IF
     C           P3TANB    IFNE WUW0NB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     Z-ADD#2RMNB    ZA0049           Load ID
      * Send message 'Load Weight LT Minimum'
     C                     MOVEL'USR1262' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * If Collect (Buyer's) Truck, default Load Status to Unlock.  E0018
      * CASE: LCL.Shipping Method is Collect
     C           YL0060    IFEQ 'CR'                       *IF
     C           YL0060    OREQ 'CT'
      * Create Change Log for Unlock process - 1st order only
      * Pass Load Status back to the calling program
     C                     MOVEL'U'       YL0053           Load Status
      * CHG Ld Sts/Dpt D/T Whs CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0066           Load ID
     C                     Z-ADDYL0052    WL0067           Scheduled Ship
     C                     MOVELYL0053    WL0068    P      Load Status
     C                     MOVELYL0002    WL0069    P      Ship From Wareh
     C                     Z-ADDWUKZDT    WL0070           Deadline Depart
     C                     Z-ADDWUAXTM    WL0071           Deadline Depart
     C                     EXSR NPCHRC
      * RTV All Coll Ords-Accp RT - Load Detail  * 
     C                     EXSR NVRVGN
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPRSR    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,45
     C                     SETOF                     98
      * USER: Process subfile record (Post-confirm)
      * Process assign to load
      * CASE: RCD.*SFLSEL is *Assign to Load
     C           #1SEL     IFEQ '1'                        *IF
     C                     Z-ADDP1AODT    #CHODT           Scheduled Ship
     C                     ADD  1         WURUNB           Stop/Drop Seque
     C                     MOVEL'Y'       #RE6ST           USR Status (Y/N
      * ***** Determine Load Change Type *****
      * Val Stop Existance    RT - Load Detail  * 
     C                     EXSR NWRVGN
      * Load Change Type (Original -Purva 10/5/99)
      * CASE: LCL.Record Found USR is Record Not Found
     C           YL0066    IFEQ 'N'                        *IF
     C                     MOVEL'ADDSTP'  YL0067           Load Change Typ
      * VAL No Stops on Load  RT - Load Detail          TRG  * 
     C                     EXSR NXRVGN
      * CASE: LCL.Status - Y or N is no
     C           YL0068    IFEQ 'N'                        *IF
     C                     MOVEL'ADDORD'  YL0067           Load Change Typ
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'ADDORD'  YL0067           Load Change Typ
     C                     END                             *FI
      * **************************************
      * E01488 RMC 5/19/11 upd Appt conf fields (were going out -0-, blan
     C                     Z-ADD*ZERO     YL0069           LD Carrier Appt
     C                     Z-ADD*ZERO     YL0070           LD Carrier Appt
      * Output Carrier appt if appt conf was made on order before load ti
      * CASE: RCD.OH Appt Confirmation Dt is Entered
     C           #1NODT    IFGT *ZERO                      *IF
     C                     Z-ADD#1EIDT    YL0069           LD Carrier Appt
     C           100       MULT #1AFTM    YL0070           LD Carrier Appt
     C                     END                             *FI
      * CRT Load Detail        CR - Load Detail  * 
     C                     EXSR NYCRRC
      * ** Update OHE record with Load ID/Stop Seq if it exists  FP1303
      * VAL CHG OHE for ld pln XF - Order Header Extension  * 
     C                     CALL 'PMDMXFR'              90  VAL CHG OHE for
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0212  30       Company Number
     C                     PARM #1C4NB    WQ0213  70       Order Number
     C                     PARM #2RMNB    WQ0214  70       Load ID
     C                     PARM WURUNB    WQ0215  50       Stop/Drop Seque
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMDMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9831  *
     C                     END
      * If buyers truck, default carrier and trk size, and if PT and dft
     C                     EXSR UKSUBR                     If buyers truck
      * UPD Load Information   RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0086           Company Number
     C                     Z-ADD#1C4NB    WL0087           Order Number
     C                     MOVEL#2BZNA    WL0088    P      Carrier Code
     C                     Z-ADD#2RMNB    WL0089           Load ID
     C                     Z-ADD*ZERO     WL0090           Rated Freight
     C                     MOVEL'02'      WL0091    P      Event Code
     C                     EXSR OBRVGN
      * RTV 1st Export Order   RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0092           Load ID
     C                     Z-ADD1         WL0093           Stop/Drop
     C                     EXSR OFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0094    WUDLC7           Order Number
     C                     Z-ADDWL0095    YN0069           MPC Number
      * Rtv Min Temp Ld,shiptoRT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0097           Load ID
     C                     MOVELWUFRSX    WL0098    P      Shipping Temp C
     C                     Z-ADDWUPCNX    WL0099           USR Temperature
     C                     Z-ADDWUDLC7    WL0100           Order Number Sa
     C                     EXSR OHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0096    WUHNNA    P      Ship To City
     C                     MOVELWL0098    WUFRSX    P      Shipping Temp C
     C                     Z-ADDWL0099    WUPCNX           USR Temperature
      * Rtv 1st Ord Delv Date RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0101           Load ID
     C                     Z-ADD1         WL0102           Stop/Drop
     C                     EXSR OIRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0103    P1EIDT           Requested Deliv
      * CHG Temp & Req Dlv Dte CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0104           Load ID
     C                     Z-ADD#CHODT    WL0105           Scheduled Ship
     C                     Z-ADDWUPCNX    WL0106           Reefer Temperat
     C                     Z-ADD*ZERO     WL0107           Rated Freight
     C                     Z-ADDP1EIDT    WL0108           Requested Deliv
     C                     MOVELWUFRSX    WL0109    P      Shipping Temp C
     C                     EXSR OJCHRC
      * Crt Load Plan Event    RT - Order Events  * 
     C                     EXSR OKRVGN
      * OMS315/C4121: log add to load
      * CRT Load/Order Chg Log XF - Load/Order Change Log  * 
     C                     CLEARPDRC
     C                     Z-ADD#2RMNB    PDRMNB           Load ID
     C                     Z-ADD#RTENB    PDRVNB           Stop/Drop
     C                     MOVELYL0067    PDRVST    P      Load Change Typ
     C                     MOVEL'TRF'     PDUJST    P      Department Cont
     C                     MOVEL*BLANK    PDMNTX    P      Change Log Prio
     C                     MOVEL*BLANK    PDMOTX    P      Change Log New
     C                     MOVEL##USR     PDAYNA    P      User Id
     C                     MOVEL##PGM     PDA0NA    P      Job Name
     C                     MOVEL#1BZNA    PDBZNA    P      Carrier Code
     C                     Z-ADD#2AIC3    PDAIC3           Company Number
     C                     Z-ADD#1C4NB    PDC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983146*
     C                     END
      * Clr Program Message Q  US - /UT User Source  * 
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ           ALREADY DEFINED
     C                     PARM '*SAME'   ZAPGRL           ALREADY DEFINED
     C                     MOVEL'Y'       ZAFSMS  1        ALREADY DEFINED
      * *****************************************************************
      * *OMS273
      * *****************************************************************
      * Rtv 1st Ord Delv Date RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0101           Load ID
     C                     Z-ADD#RTENB    WL0102           Stop/Drop
     C                     EXSR OIRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0103    #1EIDT           Requested Deliv
     C                     MOVEL'1'       WUFUST           Load Added/Dele
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVEL'Y'       P3R4ST           USR Update Flag
     C                     END                             *FI
      * Process delete from load
      * CASE: RCD.*SFLSEL is *Delete from Load
     C           #1SEL     IFEQ '4'                        *IF
     C                     MOVEL'N'       #RE6ST           USR Status (Y/N
      * DLT Single Load Dtl   RT - Load Detail  * 
     C                     EXSR ONRVGN
      * Dlt Event by Event Cde RT - Order Events  * 
     C                     EXSR OPRVGN
      * RTV Latest Event/Date  RT - Order Events  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0110           Company Number
     C                     Z-ADD#1C4NB    WL0111           Order Number
     C                     Z-ADDWUQ2NB    WL0112           Event Number
     C                     Z-ADD#1BKC7    WL0116           Ship To Custome
     C                     EXSR OLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0112    WUQ2NB           Event Number
     C                     MOVELWL0113    #1JPCD    P      Event Code
     C                     Z-ADDWL0114    WUNFNN           Event Date
     C                     MOVELWL0115    WUG0TX    P      Activity Hold
      * UPD Load Information   RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0086           Company Number
     C                     Z-ADD#1C4NB    WL0087           Order Number
     C                     MOVEL*BLANK    WL0088           Carrier Code
     C                     Z-ADD*ZERO     WL0089           Load ID
     C                     Z-ADD*ZERO     WL0090           Rated Freight
     C                     MOVEL#1JPCD    WL0091    P      Event Code
     C                     EXSR OBRVGN
      * *------------------------------------------------------*
      * * 07/18/02 PKP When the Order is removed from the Load, change
      * *              the Deadline Departure Date and Time to zero.
      * CLC Deadln Depart Dt  XF - Order Header TRG  * 
     C                     CALL 'POSCXFR'              90  CLC Deadln Depa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0216  30       Company Number
     C                     PARM #1C4NB    WQ0217  70       Order Number
     C                     PARM #1HNNA    WQ0218 20        City
     C                     PARM #1DBCD    WQ0219  2        State Code
     C                     PARM #1EIDT    WQ0220  70       Requested Deliv
     C                     PARM #1AFTM    WQ0221  40       Requested Deliv
     C           YL0073    PARM *ZERO     WQ0222  70       Deadline Depart
     C           YL0074    PARM *ZERO     WQ0223  60       Deadline Depart
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POSCXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Upd Deadline Dte/Tme  RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0076           Company Number
     C                     Z-ADD#1C4NB    WL0077           Order Number
     C                     Z-ADDYL0073    WL0078           Deadline Depart
     C                     Z-ADDYL0074    WL0079           Deadline Depart
     C                     EXSR NTRVGN
      * *------------------------------------------------------*
      * OMS315/C4121:  add log entry for loads in E status
     C                     MOVEL*BLANK    WUMNTX           Change Log Prio
     C                     MOVEL#RTENB    WUMNTX           Change Log Prio
      * CRT Load/Order Chg Log XF - Load/Order Change Log  * 
     C                     CLEARPDRC
     C                     Z-ADD#2RMNB    PDRMNB           Load ID
     C                     Z-ADD#RTENB    PDRVNB           Stop/Drop
     C                     MOVEL'DELORD'  PDRVST    P      Load Change Typ
     C                     MOVEL'TRF'     PDUJST    P      Department Cont
     C                     MOVELWUMNTX    PDMNTX    P      Change Log Prio
     C                     MOVEL*BLANK    PDMOTX    P      Change Log New
     C                     MOVEL##USR     PDAYNA    P      User Id
     C                     MOVEL##PGM     PDA0NA    P      Job Name
     C                     MOVEL#1BZNA    PDBZNA    P      Carrier Code
     C                     Z-ADD#2AIC3    PDAIC3           Company Number
     C                     Z-ADD#1C4NB    PDC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983146*
     C                     END
     C                     MOVEL*BLANKS   WUMNTX           Change Log Prio
      * RTV 1st Export Order   RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0092           Load ID
     C                     Z-ADD1         WL0093           Stop/Drop
     C                     EXSR OFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0094    WUDLC7           Order Number
     C                     Z-ADDWL0095    YN0069           MPC Number
      * Rtv Min Temp Ld,shiptoRT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0097           Load ID
     C                     MOVELWUFRSX    WL0098    P      Shipping Temp C
     C                     Z-ADDWUPCNX    WL0099           USR Temperature
     C                     Z-ADDWUDLC7    WL0100           Order Number Sa
     C                     EXSR OHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0096    WUHNNA    P      Ship To City
     C                     MOVELWL0098    WUFRSX    P      Shipping Temp C
     C                     Z-ADDWL0099    WUPCNX           USR Temperature
      * Rtv 1st Ord Delv Date RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0101           Load ID
     C                     Z-ADD#RTENB    WL0102           Stop/Drop
     C                     EXSR OIRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0103    #1EIDT           Requested Deliv
      * CHG Temp & Req Dlv Dte CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0104           Load ID
     C                     Z-ADD#1AODT    WL0105           Scheduled Ship
     C                     Z-ADDWUPCNX    WL0106           Reefer Temperat
     C                     Z-ADD#1R1NB    WL0107           Rated Freight
     C                     Z-ADD#1EIDT    WL0108           Requested Deliv
     C                     MOVELWUFRSX    WL0109    P      Shipping Temp C
     C                     EXSR OJCHRC
      * RTV Chk any ords on Ld RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0003           Load ID
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    WUJDST    P      USR Check Y/N S
      * If no more orders on load check default carrier & clear schd shp
      * CASE: WRK.USR Check Y/N Status is Not Yes
     C           WUJDST    IFEQ *BLANK                     *IF
     C           WUJDST    OREQ 'N'
      * RTV Alpha Value        RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0005           Company Number
     C                     MOVEL@CN,008   WL0006    P      Company Value C
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    WUBXTX    P      System Value Al
     C                     MOVELWUBXTX    WUBZNA           Carrier Code
      * If carrier EQ default carrier,blank carrier/schd shp dt else just
      * CASE: CTL.Carrier Code EQ WRK.Carrier Code
     C           #2BZNA    IFEQ WUBZNA                     *IF
      * CHG Carrier/Schd Sp Dt CH - OM Load Header  * 
     C                     EXSR ORCHRC
     C                     MOVEL*BLANK    #2BZNA           Carrier Code
      * 9/4/2007 Slm FP1061 - WEB030 TRF-Misc Requests for WEB Page Chang
      *              Changes due to the Carrier is being changed
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPDRC
     C                     Z-ADD#1RMNB    PDRMNB           Load ID
     C                     Z-ADD*ZERO     PDRVNB           Stop/Drop
     C                     MOVEL'CARCHG'  PDRVST    P      Load Change Typ
     C                     MOVEL'TRF'     PDUJST    P      Department Cont
     C                     MOVELWUBZNA    PDMNTX    P      Change Log Prio
     C                     MOVEL#2BZNA    PDMOTX    P      Change Log New
     C                     MOVEL##USR     PDAYNA    P      User Id
     C                     MOVEL##PGM     PDA0NA    P      Job Name
     C                     MOVEL#2BZNA    PDBZNA    P      Carrier Code
     C                     Z-ADD#2AIC3    PDAIC3           Company Number
     C                     Z-ADD*ZERO     PDC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * CHG Schedule Ship Date CH - OM Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0048           Load ID
     C                     Z-ADD*ZERO     WL0049           Scheduled Ship
     C                     EXSR TWCHRC
     C                     END                             *FI
     C                     Z-ADD*ZERO     #CHODT           Scheduled Ship
     C                     END                             *FI
     C                     MOVEL'2'       WUFUST           Load Added/Dele
      * Clr Program Message Q  US - /UT User Source  * 
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ           ALREADY DEFINED
     C                     PARM '*SAME'   ZAPGRL           ALREADY DEFINED
     C                     MOVEL'Y'       ZAFSMS  1        ALREADY DEFINED
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVEL'Y'       P3R4ST           USR Update Flag
      * CRT: TMS Order Header Trigger
      * CASE: RCD.OH Load Plan Ready is Yes
     C           #1FVSX    IFEQ 'Y'                        *IF
      * Rtv Crt OH Trigger    XF - TMS Order Header Trigger  * 
     C                     CALL 'PBWVXFR'              90  Rtv Crt OH Trig
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1C4NB    WQ0224  70       Order Number
     C                     PARM #1AIC3    WQ0225  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBWVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C                     SETON                     84    SFLNXTCHG
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     GOTO EBEXIT
     C                     ELSE
      * SFLRCD valid
     C                     SETOF                     84    SFLNXTCHG
     C                     MOVEL*BLANK    #1SEL
     C                     END                             FI *IN98
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for Subfile record
      *================================================================
     C                     MOVEL'0'       *IN77
     C           #1RMNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C           #RTIST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
     C                     MOVEL'0'       *IN75
     C           #1NODT    IFGT *ZERO                      *IF
     C                     MOVEL'1'       *IN75
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSA2    BEGSR
      *================================================================
      * Set display attributes for Subfile control
      *================================================================
     C                     MOVEL'0'       *IN79
     C           P3QKST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           P6JDST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @BFCPJB fields to subfile
      *================================================================
     C                     MOVEL*BLANK    #1SEL
     C                     MOVELBEPJST    #1PJST           LTL Flag
     C                     MOVELBEBFCD    #1BFCD           Manager Level C
     C                     MOVELBEU0ST    #1U0ST           Price Audit
     C                     MOVELBEU1ST    #1U1ST           Price Status
     C                     MOVELBEU2ST    #1U2ST           Export Status
     C                     MOVELBEVEST    #1VEST           Palletize
     C                     MOVELBEVFST    #1VFST           Shrink Wrap
     C                     MOVELBEVGST    #1VGST           Slip Sheet
     C                     MOVELBERPCD    #1RPCD           Age Code
     C                     MOVELBEVDST    #1VDST           Load Type
     C                     Z-ADDBEATIN    #1ATIN           Attach to Invoi
     C                     MOVELBEU4ST    #1U4ST           Load Plan Order
     C                     MOVELBEU5ST    #1U5ST           Print Pick Slip
     C                     Z-ADDBERSRN    #1RSRN           Resell Referenc
     C                     MOVELBEMHNA    #1MHNA           Special Comment
     C                     MOVELBEMINA    #1MINA           Special Comment
     C                     MOVELBEWBST    #1WBST           Affect Auto Acc
     C                     MOVELBER4CD    #1R4CD           Sales Route Cod
     C                     MOVELBEJNCD    #1JNCD           Order Type - Sa
     C                     Z-ADDBEANC7    #1ANC7           A/R Customer Nu
     C                     MOVELBEHONA    #1HONA           Ship To Address
     C                     MOVELBEHPNA    #1HPNA           Ship To Address
     C                     MOVELBECKTX    #1CKTX           Ship To Zip/Pos
     C                     Z-ADDBEB0C7    #1B0C7           Bill to Custome
     C                     MOVELBEAETX    #1AETX           Bill to Name
     C                     MOVELBEB1NA    #1B1NA           Bill to Address
     C                     MOVELBEB3NA    #1B3NA           Bill to Address
     C                     MOVELBEB4NA    #1B4NA           Bill to Address
     C                     MOVELBEB2NA    #1B2NA           Bill to City
     C                     MOVELBEBHCD    #1BHCD           Bill to State C
     C                     MOVELBEC8TX    #1C8TX           Bill to Zip/Pos
     C                     Z-ADDBEA0DT    #1A0DT           Order Date
     C                     Z-ADDBEA5DT    #1A5DT           Requested Ship
     C                     Z-ADDBEGNDT    #1GNDT           Actual Shipped
     C                     Z-ADDBEA1WG    #1A1WG           Order Weight To
     C                     MOVELBEXIST    #1XIST           Credit Hold
     C                     MOVELBEXJST    #1XJST           Production Hold
     C                     MOVELBEXKST    #1XKST           New Customer Ho
     C                     Z-ADDBEEIDT    #1EIDT           Requested Deliv
     C                     Z-ADDBEACDT    #1ACDT           Cancel Date
     C                     MOVELBEAQCD    #1AQCD           Terms Code
     C                     MOVELBEBYNA    #1BYNA           Special Instruc
     C                     MOVELBEB6NA    #1B6NA           Special Instruc
     C                     MOVELBEBZNA    #1BZNA           Carrier Code
     C                     MOVELBEGTST    #1GTST           Comment Print A
     C                     MOVELBEGVST    #1GVST           Comment Print I
     C                     MOVELBEGUST    #1GUST           Comment Print P
     C                     MOVELBECQCD    #1CQCD           Reason Code
     C                     MOVELBEGJST    #1GJST           Order in Use
     C                     MOVELBEGXST    #1GXST           Header Status L
     C                     MOVELBEGYST    #1GYST           Order Type Prin
     C                     MOVELBEAIVN    #1AIVN           User Original E
     C                     Z-ADDBECXDT    #1CXDT           Date of Origina
     C                     Z-ADDBEJZVA    #1JZVA           Order Value Tot
     C                     MOVELBEHMNA    #1HMNA           Ship To Address
     C                     MOVELBEQFST    #1QFST           Comment Print S
     C                     MOVELBEE8CD    #1E8CD           Accounts Receiv
     C                     MOVELBEE9CD    #1E9CD           Accounts Receiv
     C                     MOVELBEQ4CD    #1Q4CD           VP Level Code
     C                     Z-ADDBET3NB    #1T3NB           Attach to Order
     C                     MOVELBESICD    #1SICD           Reason for Pric
     C                     Z-ADDBECONB    #1CONB           Invoice Number
     C                     MOVELBECEST    #1CEST           Invoice Suffix
     C                     Z-ADDBEAWDT    #1AWDT           Invoice Date
     C                     MOVELBEJPCD    #1JPCD           Event Code
     C                     MOVELBEXUST    #1XUST           Trans Contol AS
     C                     MOVELBEZ1ST    #1Z1ST           Modified Flag
     C                     Z-ADDBEVRVA    #1VRVA           A/R order Value
     C                     MOVELBEOBST    #1OBST           Billing Activit
     C                     MOVELBEBCST    #1BCST           Block Order Fla
     C                     MOVELBEBDST    #1BDST           Order Certifica
     C                     Z-ADDBEB7VL    #1B7VL           Invoice Order V
     C                     MOVELBEGASX    #1GASX           Process Sts for
     C                     MOVELBEGBSX    #1GBSX           Order Conf Fax
     C                     MOVELBEGCSX    #1GCSX           Manifest Fax St
     C                     MOVELBEGDSX    #1GDSX           Invoice Fax Sts
     C                     MOVELBEFNSX    #1FNSX           Transfer in Sto
     C                     MOVELBEFOSX    #1FOSX           Email Cust On O
     C                     MOVELBEFPSX    #1FPSX           Order Emailed
     C                     MOVELBEFQSX    #1FQSX           Export Docs Go
     C                     MOVELBEFSSX    #1FSSX           Broker Order St
     C                     MOVELBEFTSX    #1FTSX           Air Freight Ord
     C                     MOVELBEFUSX    #1FUSX           Order Requires
     C                     MOVELBEFVSX    #1FVSX           OH Load Plan Re
     C                     MOVELBEFWSX    #1FWSX           Export USDA App
     C                     MOVELBEFXSX    #1FXSX           HPB Ship to War
     C                     MOVELBEFYSX    #1FYSX           OH TF Exempt Co
     C                     Z-ADDBENODT    #1NODT           OH Appt Confirm
     C                     Z-ADDBENPDT    #1NPDT           JPN Invoice Iss
     C                     Z-ADDBENQDT    #1NQDT           Load Actual Shi
     C                     Z-ADDBENRDT    #1NRDT           Load BOL Comple
     C                     Z-ADDBENSDT    #1NSDT           Load Truck Depa
     C                     Z-ADDBEBPTM    #1BPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    #1BQTM           Time of Origina
     C                     Z-ADDBEBRTM    #1BRTM           OH Appt Confirm
     C                     Z-ADDBEBSTM    #1BSTM           Load BOL Comple
     C                     Z-ADDBEBTTM    #1BTTM           Load Truck Depa
     C                     Z-ADDBEH0NX    #1H0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    #1H1NX           Act Non-Ref Frt
     C                     Z-ADDBEH2NX    #1H2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    #1H3NX           OH Total Non-Re
     C                     Z-ADDBEH4NX    #1H4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    #1C0C7           Claim Number
     C                     MOVELBEUVST    #1UVST           EDI Status 1
     C                     MOVELBEUWST    #1UWST           EDI Status 2
     C                     MOVELBEUXST    #1UXST           EDI Status 3
     C                     Z-ADDBERMNB    #1RMNB           Load ID
     C                     Z-ADDBETBNB    #1TBNB           Absorbed Freigh
     C                     Z-ADDBER1NB    #1R1NB           Rated Freight
     C                     Z-ADDBEAATM    #1AATM           Job Time
     C                     MOVELBEAYNA    #1AYNA           User Id
     C                     MOVELBEA0NA    #1A0NA           Job Name
     C                     Z-ADDBEAXDT    #1AXDT           Job Date
     C                     Z-ADDBEC4NB    #1C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V1C4NB
     C                     Z-ADDBEAIC3    #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     Z-ADDBEAODT    #1AODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V1AODT
     C                     Z-ADDBEAFTM    #1AFTM           Requested Deliv
     C                     Z-ADDBEBKC7    #1BKC7           Ship To Custome
      * Clear external version also
     C                     MOVEL*BLANK    V1BKC7
     C                     MOVELBEHNNA    #1HNNA           Ship To City
     C                     MOVELBEDBCD    #1DBCD           Ship To State C
     C                     MOVELBEBCNA    #1BCNA           Customer Purcha
     C                     MOVELBEGWST    #1GWST           Header Status
     C                     Z-ADDBERNNB    #1RNNB           Reefer Temperat
     C                     MOVELBEFRSX    #1FRSX           Shipping Temp C
     C                     MOVELBEQ2CD    #1Q2CD           Shipping Method
     C                     MOVELBEBRTX    #1BRTX           Ship To Name
     C                     MOVEL*BLANK    #RR4ST           USR Update Flag
     C                     MOVEL*BLANK    #RE6ST           USR Status (Y/N
     C                     Z-ADD*ZERO     #RBUNB           USR Weight, 9.0
     C                     MOVEL*BLANK    #RLHNA           USR State Name
     C                     MOVEL*BLANK    #RWBT1           OHE Appt Confir
     C                     MOVEL*BLANK    #RV5T1           OHE Appt Confir
     C                     Z-ADD*ZERO     #RNVDT           Deadline Depart
     C                     Z-ADD*ZERO     #RBUTM           Deadline Depart
     C                     MOVEL*BLANK    #RTIST           USR Display 1
     C                     MOVEL*BLANK    #RELTX           USR Shortened I
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     Z-ADD*ZERO     #RTENB           USR Stop
     C                     MOVEL*BLANK    #RAJCD           Warehouse Code
     C                     MOVEL*BLANK    #RV1CD           Region Code
     C                     Z-ADD*ZERO     #RMDDI           Month/Day Displ
     C                     Z-ADD*ZERO     #RYGNX           USR Weight, 5.0
     C                     MOVEL*BLANK    #RQZST           USR Assigned Th
     C                     MOVEL*BLANK    #RLSNA           USR Picked
     C                     MOVEL*BLANK    #RXBCD           Sail Port State
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     MOVEL*BLANK    #CRMST           Load Acceptance
     C                     MOVELP2RONB    #PRONB           Truck Size
     C                     Z-ADD*ZERO     #CFLAM           Flat Amount
     C                     MOVEL*BLANK    #CQ7ST           Allocate By Pou
     C                     MOVEL*BLANK    #2BZNA           Carrier Code
     C                     Z-ADD*ZERO     #CTLMI           Total Load Mile
     C                     Z-ADDP3RQNB    #PRQNB           Total Freight
     C                     Z-ADD*ZERO     #2R1NB           Rated Freight
     C                     MOVEL*BLANK    #2JNCD           Order Type - Sa
     C                     MOVEL*BLANK    #2AETX           Bill to Name
     C                     MOVEL*BLANK    #2B1NA           Bill to Address
     C                     MOVEL*BLANK    #2B3NA           Bill to Address
     C                     MOVEL*BLANK    #2B4NA           Bill to Address
     C                     MOVEL*BLANK    #2B2NA           Bill to City
     C                     MOVEL*BLANK    #2BHCD           Bill to State C
     C                     MOVEL*BLANK    #2C8TX           Bill to Zip/Pos
     C                     Z-ADD*ZERO     #2A0DT           Order Date
     C                     Z-ADD*ZERO     #2ACDT           Cancel Date
     C                     MOVEL*BLANK    #2AQCD           Terms Code
     C                     MOVEL*BLANK    #2BYNA           Special Instruc
     C                     MOVEL*BLANK    #2B6NA           Special Instruc
     C                     MOVEL*BLANK    #2GTST           Comment Print A
     C                     MOVEL*BLANK    #2GVST           Comment Print I
     C                     MOVEL*BLANK    #2GUST           Comment Print P
     C                     MOVEL*BLANK    #2CQCD           Reason Code
     C                     MOVEL*BLANK    #2GJST           Order in Use
     C                     MOVEL*BLANK    #2GXST           Header Status L
     C                     MOVEL*BLANK    #2GYST           Order Type Prin
     C                     Z-ADDP2RPNB    #PRPNB           Total Load Orde
     C                     MOVEL*BLANK    #2AIVN           User Original E
     C                     Z-ADD*ZERO     #2CXDT           Date of Origina
     C                     Z-ADD*ZERO     #2JZVA           Order Value Tot
     C                     MOVEL*BLANK    #2QFST           Comment Print S
     C                     MOVEL*BLANK    #2E8CD           Accounts Receiv
     C                     MOVEL*BLANK    #2E9CD           Accounts Receiv
     C                     Z-ADD*ZERO     #2TBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     #2AATM           Job Time
     C                     MOVEL*BLANK    #2AYNA           User Id
     C                     MOVEL*BLANK    #2A0NA           Job Name
     C                     Z-ADD*ZERO     #2AXDT           Job Date
     C                     MOVEL*BLANK    #2PJST           LTL Flag
     C                     Z-ADD*ZERO     #2RNNB           Reefer Temperat
     C                     Z-ADD*ZERO     #2A5DT           Requested Ship
     C                     Z-ADD*ZERO     #CBUNB           USR Weight, 9.0
     C                     Z-ADD*ZERO     #2A1WG           Order Weight To
     C                     MOVEL*BLANK    #2GWST           Header Status
     C                     MOVEL*BLANK    #2Q2CD           Shipping Method
     C                     MOVEL*BLANK    #2BCNA           Customer Purcha
     C                     Z-ADDP1AIC3    #2AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V2AIC3
     C                     Z-ADDP1RMNB    #2RMNB           Load ID
     C                     MOVELP2PKST    #PPKST           Load Status
     C                     MOVEL*BLANK    #CNINA           Status Descript
     C                     MOVEL*BLANK    #CCUST           USR Shipping Me
     C                     Z-ADD*ZERO     #CHODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     VCHODT
     C                     MOVEL*BLANK    #2VDST           Load Type
     C                     MOVEL*BLANK    #CHKNA           Status Descript
     C                     Z-ADD*ZERO     #CDTWG           Weight Adjust
     C                     Z-ADD*ZERO     #CTENB           USR Stop
     C                     Z-ADD*ZERO     #2C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V2C4NB
     C                     Z-ADD*ZERO     #CFKNB           USR Company Num
      * Clear external version also
     C                     MOVEL*BLANK    VCFKNB
     C                     MOVEL*BLANK    #CAJCD           Warehouse Code
     C                     MOVEL*BLANK    #CV1CD           Region Code
     C                     Z-ADD*ZERO     #2AODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V2AODT
     C                     Z-ADD*ZERO     #CMDDI           Month/Day Displ
     C                     Z-ADD*ZERO     #2AFTM           Requested Deliv
     C                     Z-ADD*ZERO     #2BKC7           Ship To Custome
      * Clear external version also
     C                     MOVEL*BLANK    V2BKC7
     C                     MOVEL*BLANK    #2HNNA           Ship To City
     C                     MOVEL*BLANK    #2DBCD           Ship To State C
     C                     Z-ADD*ZERO     #CYGNX           USR Weight, 5.0
     C                     MOVEL*BLANK    #CQZST           USR Assigned Th
     C                     MOVEL*BLANK    #CXBCD           Sail Port State
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #1AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1AODT
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1BKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1BKC7           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V2AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Scheduled Ship Date USR to display format
      * Convert date
     C           1000000   ADD  #CHODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCHODT
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert USR Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #CFKNB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#CFKNB    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VCFKNB           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VCFKNB           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #2AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2AODT
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2BKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2BKC7           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         NACHRC    BEGSR
      *================================================================
      * CHG Sch Shp & Req Shp CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0442  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0443  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0444  70       Ship To Custome
     C                     MOVEL*BLANK    WN0445 30        Ship To Name
     C                     MOVEL*BLANK    WN0446 30        Ship To Address
     C                     MOVEL*BLANK    WN0447 30        Ship To Address
     C                     MOVEL*BLANK    WN0448 30        Ship To Address
     C                     MOVEL*BLANK    WN0449 20        Ship To City
     C                     MOVEL*BLANK    WN0450  2        Ship To State C
     C                     MOVEL*BLANK    WN0451 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0452  70       Bill to Custome
     C                     MOVEL*BLANK    WN0453 30        Bill to Name
     C                     MOVEL*BLANK    WN0454 30        Bill to Address
     C                     MOVEL*BLANK    WN0455 30        Bill to Address
     C                     MOVEL*BLANK    WN0456 30        Bill to Address
     C                     MOVEL*BLANK    WN0457 20        Bill to City
     C                     MOVEL*BLANK    WN0458  2        Bill to State C
     C                     MOVEL*BLANK    WN0459 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0460 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0461  70       Order Date
     C                     Z-ADD*ZERO     WN0462  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0463  70       Cancel Date
     C                     MOVEL*BLANK    WN0464  2        Terms Code
     C                     MOVEL*BLANK    WN0465 40        Special Instruc
     C                     MOVEL*BLANK    WN0466 40        Special Instruc
     C                     MOVEL*BLANK    WN0467  3        Carrier Code
     C                     MOVEL*BLANK    WN0468  1        Comment Print A
     C                     MOVEL*BLANK    WN0469  1        Comment Print I
     C                     MOVEL*BLANK    WN0470  1        Comment Print P
     C                     MOVEL*BLANK    WN0471  1        Comment Print S
     C                     MOVEL*BLANK    WN0472  3        Reason Code
     C                     MOVEL*BLANK    WN0473  1        Order in Use
     C                     MOVEL*BLANK    WN0474  1        Header Status
     C                     MOVEL*BLANK    WN0475  1        Header Status L
     C                     MOVEL*BLANK    WN0476  1        Order Type Prin
     C                     MOVEL*BLANK    WN0477 10        User Original E
     C                     Z-ADD*ZERO     WN0478  70       Date of Origina
     C                     Z-ADD*ZERO     WN0479 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0480 112       Order Weight To
     C                     MOVEL*BLANK    WN0481  1        Credit Hold
     C                     MOVEL*BLANK    WN0482  1        Production Hold
     C                     MOVEL*BLANK    WN0483  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0484  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0485  40       Requested Deliv
     C                     MOVEL*BLANK    WN0486  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0487 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0488  70       Load ID
     C                     Z-ADD*ZERO     WN0489  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0490 112       Rated Freight
     C                     MOVEL*BLANK    WN0491  1        LTL Flag
     C                     MOVEL*BLANK    WN0492  1        Price Audit
     C                     MOVEL*BLANK    WN0493  1        Price Status
     C                     MOVEL*BLANK    WN0494  2        Shipping Method
     C                     MOVEL*BLANK    WN0495  1        Export Status
     C                     MOVEL*BLANK    WN0496  1        Palletize
     C                     MOVEL*BLANK    WN0497  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0498  1        Slip Sheet
     C                     MOVEL*BLANK    WN0499  1        Age Code
     C                     Z-ADD*ZERO     WN0500  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0501  1        Load Type
     C                     Z-ADD*ZERO     WN0502  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0503  1        Load Plan Order
     C                     MOVEL*BLANK    WN0504  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0505  70       Resell Referenc
     C                     MOVEL*BLANK    WN0506 30        Special Comment
     C                     MOVEL*BLANK    WN0507 30        Special Comment
     C                     MOVEL*BLANK    WN0508  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0509  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0510  2        Manager Level C
     C                     MOVEL*BLANK    WN0511  3        VP Level Code
     C                     Z-ADD*ZERO     WN0512  70       Attach to Order
     C                     MOVEL*BLANK    WN0513  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0514  70       Invoice Number
     C                     MOVEL*BLANK    WN0515  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0516  70       Invoice Date
     C                     MOVEL*BLANK    WN0517  2        Event Code
     C                     MOVEL*BLANK    WN0518  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0519  1        Modified Flag
     C                     Z-ADD*ZERO     WN0520 112       A/R order Value
     C                     MOVEL*BLANK    WN0521  1        Billing Activit
     C                     MOVEL*BLANK    WN0522  1        Block Order Fla
     C                     MOVEL*BLANK    WN0523  1        Order Certifica
     C                     Z-ADD*ZERO     WN0524 112       Invoice Order V
     C                     MOVEL*BLANK    WN0525  1        Process Sts for
     C                     MOVEL*BLANK    WN0526  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0527  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0528  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0529  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0530  1        Email Cust On O
     C                     MOVEL*BLANK    WN0531  1        Order Emailed
     C                     MOVEL*BLANK    WN0532  1        Export Docs Go
     C                     MOVEL*BLANK    WN0533  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0534  1        Broker Order St
     C                     MOVEL*BLANK    WN0535  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0536  2        Order Requires
     C                     MOVEL*BLANK    WN0537  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0538  2        Export USDA App
     C                     MOVEL*BLANK    WN0539  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0540  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0541  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0542  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0543  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0544  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0545  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0546  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0547  60       Time of Origina
     C                     Z-ADD*ZERO     WN0548  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0549  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0550  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0551 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0552 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0553 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0554 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0555 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0556  70       Claim Number
     C                     MOVEL*BLANK    WN0557  1        EDI Status 1
     C                     MOVEL*BLANK    WN0558  1        EDI Status 2
     C                     MOVEL*BLANK    WN0559  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0560  60       Job Time
     C                     MOVEL*BLANK    WN0561 10        User Id
     C                     MOVEL*BLANK    WN0562 10        Job Name
     C                     Z-ADD*ZERO     WN0563  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWAAIC3    WLAIC3           Company Number
     C                     Z-ADDWAC4NB    WLC4NB           Order Number
      *
     C           KLCHNA    KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLC4NB           Order Number
     C           KLCHNA    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NAEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NAEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YDRDCS
      * USER: Processing after Data read
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WLAATM           Job Time
     C                     MOVEL##USR     WLAYNA           User Id
     C                     MOVEL##JOB     WLA0NA           Job Name
     C                     Z-ADD##JDT     WLAXDT           Job Date
      * Move non-key fields to @BECPFJ
     C                     Z-ADDWUA5DT    WLA5DT           Requested Ship
     C                     Z-ADDWL0051    WLAODT           Scheduled Ship
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WLAATM           Job Time
     C                     MOVEL##USR     WLAYNA           User Id
     C                     MOVEL##PGM     WLA0NA           Job Name
     C                     Z-ADD##JDT     WLAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPCRC
     C                     Z-ADDWLAIC3    PCAIC3           Company Number
     C                     Z-ADDWLC4NB    PCC4NB           Order Number
     C                     MOVELWLJNCD    PCJNCD    P      Order Type - Sa
     C                     Z-ADDWLANC7    PCANC7           A/R Customer Nu
     C                     Z-ADDWLBKC7    PCBKC7           Ship To Custome
     C                     MOVELWLBRTX    PCBRTX    P      Ship To Name
     C                     MOVELWLHMNA    PCHMNA    P      Ship To Address
     C                     MOVELWLHONA    PCHONA    P      Ship To Address
     C                     MOVELWLHPNA    PCHPNA    P      Ship To Address
     C                     MOVELWLHNNA    PCHNNA    P      Ship To City
     C                     MOVELWLDBCD    PCDBCD    P      Ship To State C
     C                     MOVELWLCKTX    PCCKTX    P      Ship To Zip/Pos
     C                     Z-ADDWLB0C7    PCB0C7           Bill to Custome
     C                     MOVELWLAETX    PCAETX    P      Bill to Name
     C                     MOVELWLB1NA    PCB1NA    P      Bill to Address
     C                     MOVELWLB3NA    PCB3NA    P      Bill to Address
     C                     MOVELWLB4NA    PCB4NA    P      Bill to Address
     C                     MOVELWLB2NA    PCB2NA    P      Bill to City
     C                     MOVELWLBHCD    PCBHCD    P      Bill to State C
     C                     MOVELWLC8TX    PCC8TX    P      Bill to Zip/Pos
     C                     MOVELWLBCNA    PCBCNA    P      Customer Purcha
     C                     Z-ADDWLA0DT    PCA0DT           Order Date
     C                     Z-ADDWLA5DT    PCA5DT           Requested Ship
     C                     Z-ADDWLGNDT    PCGNDT           Actual Shipped
     C                     Z-ADDWLACDT    PCACDT           Cancel Date
     C                     MOVELWLAQCD    PCAQCD    P      Terms Code
     C                     MOVELWLB6NA    PCB6NA    P      Special Instruc
     C                     MOVELWLBYNA    PCBYNA    P      Special Instruc
     C                     MOVELWLBZNA    PCBZNA    P      Carrier Code
     C                     MOVELWLGTST    PCGTST    P      Comment Print A
     C                     MOVELWLGVST    PCGVST    P      Comment Print I
     C                     MOVELWLGUST    PCGUST    P      Comment Print P
     C                     MOVELWLQFST    PCQFST    P      Comment Print S
     C                     MOVELWLCQCD    PCCQCD    P      Reason Code
     C                     MOVELWLGJST    PCGJST    P      Order in Use
     C                     MOVELWLGWST    PCGWST    P      Header Status
     C                     MOVELWLGXST    PCGXST    P      Header Status L
     C                     MOVELWLGYST    PCGYST    P      Order Type Prin
     C                     Z-ADDWLAODT    PCAODT           Scheduled Ship
     C                     MOVELWLAIVN    PCAIVN    P      User Original E
     C                     Z-ADDWLCXDT    PCCXDT           Date of Origina
     C                     Z-ADDWLJZVA    PCJZVA           Order Value Tot
     C                     Z-ADDWLA1WG    PCA1WG           Order Weight To
     C                     MOVELWLXIST    PCXIST    P      Credit Hold
     C                     MOVELWLXJST    PCXJST    P      Production Hold
     C                     MOVELWLXKST    PCXKST    P      New Customer Ho
     C                     Z-ADDWLEIDT    PCEIDT           Requested Deliv
     C                     Z-ADDWLAFTM    PCAFTM           Requested Deliv
     C                     MOVELWLE8CD    PCE8CD    P      Accounts Receiv
     C                     MOVELWLE9CD    PCE9CD    P      Accounts Receiv
     C                     Z-ADDWLRMNB    PCRMNB           Load ID
     C                     Z-ADDWLTBNB    PCTBNB           Absorbed Freigh
     C                     Z-ADDWLR1NB    PCR1NB           Rated Freight
     C                     MOVELWLPJST    PCPJST    P      LTL Flag
     C                     MOVELWLU0ST    PCU0ST    P      Price Audit
     C                     MOVELWLU1ST    PCU1ST    P      Price Status
     C                     MOVELWLQ2CD    PCQ2CD    P      Shipping Method
     C                     MOVELWLU2ST    PCU2ST    P      Export Status
     C                     MOVELWLVEST    PCVEST    P      Palletize
     C                     MOVELWLVFST    PCVFST    P      Shrink Wrap
     C                     MOVELWLVGST    PCVGST    P      Slip Sheet
     C                     MOVELWLRPCD    PCRPCD    P      Age Code
     C                     Z-ADDWLRNNB    PCRNNB           Reefer Temperat
     C                     MOVELWLVDST    PCVDST    P      Load Type
     C                     Z-ADDWLATIN    PCATIN           Attach to Invoi
     C                     MOVELWLU4ST    PCU4ST    P      Load Plan Order
     C                     MOVELWLU5ST    PCU5ST    P      Print Pick Slip
     C                     Z-ADDWLRSRN    PCRSRN           Resell Referenc
     C                     MOVELWLMHNA    PCMHNA    P      Special Comment
     C                     MOVELWLMINA    PCMINA    P      Special Comment
     C                     MOVELWLWBST    PCWBST    P      Affect Auto Acc
     C                     MOVELWLR4CD    PCR4CD    P      Sales Route Cod
     C                     MOVELWLBFCD    PCBFCD    P      Manager Level C
     C                     MOVELWLQ4CD    PCQ4CD    P      VP Level Code
     C                     Z-ADDWLT3NB    PCT3NB           Attach to Order
     C                     MOVELWLSICD    PCSICD    P      Reason for Pric
     C                     Z-ADDWLCONB    PCCONB           Invoice Number
     C                     MOVELWLCEST    PCCEST    P      Invoice Suffix
     C                     Z-ADDWLAWDT    PCAWDT           Invoice Date
     C                     MOVELWLJPCD    PCJPCD    P      Event Code
     C                     MOVELWLXUST    PCXUST    P      Trans Contol AS
     C                     MOVELWLZ1ST    PCZ1ST    P      Modified Flag
     C                     Z-ADDWLVRVA    PCVRVA           A/R order Value
     C                     MOVELWLOBST    PCOBST    P      Billing Activit
     C                     MOVELWLBCST    PCBCST    P      Block Order Fla
     C                     MOVELWLBDST    PCBDST    P      Order Certifica
     C                     Z-ADDWLB7VL    PCB7VL           Invoice Order V
     C                     MOVELWLGASX    PCGASX    P      Process Sts for
     C                     MOVELWLGBSX    PCGBSX    P      Order Conf Fax
     C                     MOVELWLGCSX    PCGCSX    P      Manifest Fax St
     C                     MOVELWLGDSX    PCGDSX    P      Invoice Fax Sts
     C                     MOVELWLFNSX    PCFNSX    P      Transfer in Sto
     C                     MOVELWLFOSX    PCFOSX    P      Email Cust On O
     C                     MOVELWLFPSX    PCFPSX    P      Order Emailed
     C                     MOVELWLFQSX    PCFQSX    P      Export Docs Go
     C                     MOVELWLFRSX    PCFRSX    P      Shipping Temp C
     C                     MOVELWLFSSX    PCFSSX    P      Broker Order St
     C                     MOVELWLFTSX    PCFTSX    P      Air Freight Ord
     C                     MOVELWLFUSX    PCFUSX    P      Order Requires
     C                     MOVELWLFVSX    PCFVSX    P      OH Load Plan Re
     C                     MOVELWLFWSX    PCFWSX    P      Export USDA App
     C                     MOVELWLFXSX    PCFXSX    P      HPB Ship to War
     C                     MOVELWLFYSX    PCFYSX    P      OH TF Exempt Co
     C                     Z-ADDWLNODT    PCNODT           OH Appt Confirm
     C                     Z-ADDWLNPDT    PCNPDT           JPN Invoice Iss
     C                     Z-ADDWLNQDT    PCNQDT           Load Actual Shi
     C                     Z-ADDWLNRDT    PCNRDT           Load BOL Comple
     C                     Z-ADDWLNSDT    PCNSDT           Load Truck Depa
     C                     Z-ADDWLBPTM    PCBPTM           Maximum Gross W
     C                     Z-ADDWLBQTM    PCBQTM           Time of Origina
     C                     Z-ADDWLBRTM    PCBRTM           OH Appt Confirm
     C                     Z-ADDWLBSTM    PCBSTM           Load BOL Comple
     C                     Z-ADDWLBTTM    PCBTTM           Load Truck Depa
     C                     Z-ADDWLH0NX    PCH0NX           Act Frt Referen
     C                     Z-ADDWLH1NX    PCH1NX           Act Non-Ref Frt
     C                     Z-ADDWLH2NX    PCH2NX           OH Fuel Surchar
     C                     Z-ADDWLH3NX    PCH3NX           OH Total Non-Re
     C                     Z-ADDWLH4NX    PCH4NX           OH Total Ref Fr
     C                     Z-ADDWLC0C7    PCC0C7           Claim Number
     C                     MOVELWLUVST    PCUVST    P      EDI Status 1
     C                     MOVELWLUWST    PCUWST    P      EDI Status 2
     C                     MOVELWLUXST    PCUXST    P      EDI Status 3
     C                     Z-ADDWLAATM    PCAATM           Job Time
     C                     MOVELWLAYNA    PCAYNA    P      User Id
     C                     MOVELWLA0NA    PCA0NA    P      Job Name
     C                     Z-ADDWLAXDT    PCAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NAEXIT    ENDSR
      /EJECT
     CSR         NBRVGN    BEGSR
      *================================================================
      * Rtv Sum Ld Abs.Frt/Wgt RT - Order Header TRG  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0564 112       Freight Amount
     C                     Z-ADD*ZERO     WN0565  74       USR Percent Wor
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
     C                     Z-ADD*ZERO     #PRQNB           Total Freight
     C                     Z-ADD*ZERO     #PRPNB           Weight Schedule
      * Declare restrictor key work fields
     C           *LIKE     DEFN WARMNB    WQNB02           Load ID
      * Define keylist
     C           KRSNB     KLIST
     C                     KFLD           WQNB02           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    WQNB02           Load ID
      * Establish starting position
     C           KRSNB     SETLL@BFCPD9                    *
     C           KRSNB     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WATBNB    DIV  100       WN0565    H      USR Percent Wor
     C           WAA1WG    MULT WN0565    WN0564    H      Freight Amount
     C                     ADD  WN0564    #PRQNB           Total Freight
     C                     ADD  WAA1WG    #PRPNB           Weight Schedule
     C           KRSNB     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         NBEXIT    ENDSR
      /EJECT
     CSR         NCRVGN    BEGSR
      *================================================================
      * RTV No. of Stops      RT - Load Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0566  30       USR Stop
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WN0566           USR Stop
     C                     MOVEL'N'       WURVSX           Multi Company L
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIRMNB    WQNC02           Load ID
      * Define keylist
     C           KRSNC     KLIST
     C                     KFLD           WQNC02           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    WQNC02           Load ID
      * Establish starting position
     C           KRSNC     SETLL@FLCPEB                    *
     C           KRSNC     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Stop/Drop NE PAR.USR Stop
     C           WIRVNB    IFNE WN0566                     *IF
     C                     ADD  1         WURRNB           Total Stops
     C                     Z-ADDWIRVNB    WN0566           USR Stop
     C                     END                             *FI
      * CASE: WRK.Company Number     041405 is Equal to zero
     C           WUBQC3    IFEQ 0                          *IF
     C                     Z-ADDWIAIC3    WUBQC3           Company Number
     C                     END                             *FI
      * Multi Company Load?               PKTR01 8/5/04
      * CASE: DB1.Company Number NE WRK.Company Number     041405
     C           WIAIC3    IFNE WUBQC3                     *IF
     C                     MOVEL'Y'       WURVSX           Multi Company L
     C                     END                             *FI
     C           KRSNC     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         NCEXIT    ENDSR
      /EJECT
     CSR         NDRVGN    BEGSR
      *================================================================
      * RTV Export Ords for LD RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMRMNB    WQND02           Load ID
      * Define keylist
     C           KRSND     KLIST
     C                     KFLD           WQND02           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    WQND02           Load ID
      * Establish starting position
     C           KRSND     SETLL@BFCPMC                    *
     C           KRSND     READE@BFCPMC                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO NDEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         NDEXIT    ENDSR
      /EJECT
     CSR         NERVGN    BEGSR
      *================================================================
      * RTV First Order Whse   RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIRMNB    WQNE02           Load ID
      * Define keylist
     C           KPSNE     KLIST
     C                     KFLD           WQNE02           Load ID
     C                     KFLD           WIRVNB           Stop/Drop
      * Define keylist
     C           KRSNE     KLIST
     C                     KFLD           WQNE02           Load ID
      * Setup key
     C                     Z-ADDWL0059    WQNE02           Load ID
     C                     Z-ADDWL0060    WIRVNB           Stop/Drop
      * Establish starting position
     C           KPSNE     SETLL@FLCPEB                    *
     C           KRSNE     READE@FLCPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO NEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
     C                     EXSR NFRVGN
     C                     GOTO NEEXIT                     *QUIT
     C           KRSNE     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         NEEXIT    ENDSR
      /EJECT
     CSR         NFRVGN    BEGSR
      *================================================================
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQNF01           Company Number
     C           *LIKE     DEFN OMC4NB    WQNF02           Order Number
      * Define keylist
     C           KPSNF     KLIST
     C                     KFLD           WQNF01           Company Number
     C                     KFLD           WQNF02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSNF     KLIST
     C                     KFLD           WQNF01           Company Number
     C                     KFLD           WQNF02           Order Number
      * Setup key
     C                     Z-ADDWIAIC3    WQNF01           Company Number
     C                     Z-ADDWIC4NB    WQNF02           Order Number
     C                     Z-ADD*ZERO     OMDPNB           Order Sequence
     C                     Z-ADD*ZERO     OMUENB           Order Secondary
      * Establish starting position
     C           KPSNF     SETLL@BGWKAE                    *
     C           KRSNF     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0061           Warehouse Code
     C                     MOVEL*BLANK    WUG0TX           Trans Contol AS
     C                     GOTO NFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Warehouse Control  RT - Warehouse  * 
     C                     EXSR NGRVGN
      * PAR = DB1 By name
     C                     MOVELOMAJCD    WL0061           Warehouse Code
     C                     GOTO NFEXIT                     *QUIT
     C           KRSNF     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         NFEXIT    ENDSR
      /EJECT
     CSR         NGRVGN    BEGSR
      *================================================================
      * RTV Warehouse Control  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNG     KLIST
     C                     KFLD           WCAJCD           Warehouse Code
      * Setup key
     C                     MOVELOMAJCD    WCAJCD           Warehouse Code
      * Establish starting position
     C           KRSNG     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUG0TX           Trans Contol AS
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO NGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCXUST    WUG0TX           Trans Contol AS
     C                     ENDIF
      *================================================================
     CSR         NGEXIT    ENDSR
      /EJECT
     CSR         NHCHRC    BEGSR
      *================================================================
      * CHG Ship Fr Whs,Multi CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0567  30       Company Number
     C                     Z-ADD*ZERO     WN0568  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0569  1        LTL Flag
     C                     MOVEL*BLANK    WN0570  1        Load Status
     C                     Z-ADD*ZERO     WN0571  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0572 15        Seal 1
     C                     MOVEL*BLANK    WN0573 15        Seal 2
     C                     MOVEL*BLANK    WN0574 15        Seal 3
     C                     MOVEL*BLANK    WN0575 15        Seal 4
     C                     MOVEL*BLANK    WN0576 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0577  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0578 112       Flat Amount
     C                     MOVEL*BLANK    WN0579  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0580  50       Total Stops
     C                     MOVEL*BLANK    WN0581 20        Trailer Id
     C                     MOVEL*BLANK    WN0582  3        Transloader Car
     C                     Z-ADD*ZERO     WN0583  40       BOL Time
     C                     MOVEL*BLANK    WN0584  3        Carrier Code
     C                     MOVEL*BLANK    WN0585  7        Truck Size
     C                     Z-ADD*ZERO     WN0586  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0587 112       Rated Freight
     C                     MOVEL*BLANK    WN0588  1        Ship Status
     C                     MOVEL*BLANK    WN0589  1        Load Type
     C                     Z-ADD*ZERO     WN0590  50       Number Pallets
     C                     Z-ADD*ZERO     WN0591  50       Number Pallets
     C                     Z-ADD*ZERO     WN0592 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0593  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0594  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0595  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0596 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0597 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0598  70       Actual Departur
     C                     Z-ADD*ZERO     WN0599  40       Departure Time
     C                     Z-ADD*ZERO     WN0600  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0601  52       Product Tempera
     C                     Z-ADD*ZERO     WN0602  50       Number Spacers
     C                     MOVEL*BLANK    WN0603 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0604  70       Total Load Mile
     C                     MOVEL*BLANK    WN0605 12        Recorder ID
     C                     MOVEL*BLANK    WN0606  2        Shipping Method
     C                     MOVEL*BLANK    WN0607  2        Ship To State C
     C                     Z-ADD*ZERO     WN0608  70       Gross Weight
     C                     MOVEL*BLANK    WN0609  3        Carrier Broker
     C                     MOVEL*BLANK    WN0610  1        Export Status
     C                     Z-ADD*ZERO     WN0611  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0612  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0613  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0614  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0615  70       Spotted Date
     C                     Z-ADD*ZERO     WN0616  60       Spotted Time
     C                     Z-ADD*ZERO     WN0617  70       Load Finished D
     C                     Z-ADD*ZERO     WN0618  60       Load Finished T
     C                     Z-ADD*ZERO     WN0619  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0620  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0621  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0622  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0623  70       Truck Departure
     C                     Z-ADD*ZERO     WN0624  60       Truck Departure
     C                     Z-ADD*ZERO     WN0625  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0626  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0627  3        Shipping Line
     C                     MOVEL*BLANK    WN0628 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0629 30        Vessel Name
     C                     Z-ADD*ZERO     WN0630  50       Voyage
     C                     Z-ADD*ZERO     WN0631  70       Sail Date
     C                     MOVEL*BLANK    WN0632 12        Booking Number
     C                     MOVEL*BLANK    WN0633 20        Discharge Port
     C                     Z-ADD*ZERO     WN0634  70       Arrival Date
     C                     MOVEL*BLANK    WN0635 12        Container Numbe
     C                     Z-ADD*ZERO     WN0636  70       Date In
     C                     Z-ADD*ZERO     WN0637  60       Time In
     C                     Z-ADD*ZERO     WN0638  70       Date Out
     C                     Z-ADD*ZERO     WN0639  60       Time Out
     C                     Z-ADD*ZERO     WN0640 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0641  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0642  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0643  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0644  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0645  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0646  70       Requested Deliv
     C                     MOVEL*BLANK    WN0647  1        Load Acceptance
     C                     MOVEL*BLANK    WN0648  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0649  70       On Yard Date
     C                     Z-ADD*ZERO     WN0650  60       On Yard Time
     C                     Z-ADD*ZERO     WN0651  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0652  60       Deadline Depart
     C                     MOVEL*BLANK    WN0653  1        Load Held Over
     C                     MOVEL*BLANK    WN0654  1        Load Held Over
     C                     MOVEL*BLANK    WN0655 15        Load Held Over
     C                     MOVEL*BLANK    WN0656 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0657 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0658  70       Express Mail Da
     C                     MOVEL*BLANK    WN0659  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0660  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0661  70       Product Complet
     C                     Z-ADD*ZERO     WN0662  60       Product Complet
     C                     Z-ADD*ZERO     WN0663  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0664  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0665  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0666  1        Load Confirmed
     C                     MOVEL*BLANK    WN0667 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0668  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0669  60       Load Door 1
     C                     Z-ADD*ZERO     WN0670  70       Override Total
     C                     Z-ADD*ZERO     WN0671  60       Load Door 2
     C                     MOVEL*BLANK    WN0672  1        Partial Load
     C                     MOVEL*BLANK    WN0673  1        Load Confirmati
     C                     MOVEL*BLANK    WN0674  1        Export Load USD
     C                     MOVEL*BLANK    WN0675  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0676 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0677 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0678 15        Late Billing Em
     C                     MOVEL*BLANK    WN0679 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0680 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0681  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0682  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0683  1        LH Power Only L
     C                     MOVEL*BLANK    WN0684  1        MG Created Load
     C                     MOVEL*BLANK    WN0685  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0686  2        Load U/M
     C                     MOVEL*BLANK    WN0687  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0688  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0689  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0690  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0691  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0692  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0693  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0694  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0695  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0696  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0697  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0698  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0699  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0700  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0701  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0702  60       LH Unused Time
     C                     MOVEL*BLANK    WN0703  1        EDI Status 1
     C                     MOVEL*BLANK    WN0704  1        EDI Status 2
     C                     MOVEL*BLANK    WN0705  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0706  60       Job Time
     C                     MOVEL*BLANK    WN0707 10        User Id
     C                     MOVEL*BLANK    WN0708 10        Job Name
     C                     Z-ADD*ZERO     WN0709  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADD#2RMNB    WDRMNB           Load ID
      *
     C           KLCHNH    KLIST
     C                     KFLD           WDRMNB           Load ID
     C           KLCHNH    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NHEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YERDCS
      * Move non-key fields to @FJCPBO
     C                     MOVELWUVPCD    WDVPCD    P      Ship From Wareh
     C                     MOVELWURVSX    WDRVSX    P      Multi Company L
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##PGM     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NHEXIT    ENDSR
      /EJECT
     CSR         NIRVGN    BEGSR
      *================================================================
      * RTV Default Load Seq  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0043           Default Load Se
      * Define keylist
     C           KRSNI     KLIST
     C                     KFLD           WCAJCD           Warehouse Code
      * Setup key
     C                     MOVELWUVPCD    WCAJCD           Warehouse Code
      * Establish starting position
     C           KRSNI     CHAIN@ADREAO              90    *
      * Data record not found
     C   90                MOVEL'USR0007' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCT4ST    YL0043           Default Load Se
     C                     ENDIF
      *================================================================
     CSR         NIEXIT    ENDSR
      /EJECT
     CSR         NJCHRC    BEGSR
      *================================================================
      * CHG Total Load Miles   CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0710  30       Company Number
     C                     Z-ADD*ZERO     WN0711  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0712  1        LTL Flag
     C                     MOVEL*BLANK    WN0713  1        Load Status
     C                     Z-ADD*ZERO     WN0714  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0715 15        Seal 1
     C                     MOVEL*BLANK    WN0716 15        Seal 2
     C                     MOVEL*BLANK    WN0717 15        Seal 3
     C                     MOVEL*BLANK    WN0718 15        Seal 4
     C                     MOVEL*BLANK    WN0719 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0720  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0721 112       Flat Amount
     C                     MOVEL*BLANK    WN0722  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0723  50       Total Stops
     C                     MOVEL*BLANK    WN0724 20        Trailer Id
     C                     MOVEL*BLANK    WN0725  3        Transloader Car
     C                     Z-ADD*ZERO     WN0726  40       BOL Time
     C                     MOVEL*BLANK    WN0727  3        Carrier Code
     C                     MOVEL*BLANK    WN0728  7        Truck Size
     C                     Z-ADD*ZERO     WN0729  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0730 112       Rated Freight
     C                     MOVEL*BLANK    WN0731  1        Ship Status
     C                     MOVEL*BLANK    WN0732  1        Load Type
     C                     Z-ADD*ZERO     WN0733  50       Number Pallets
     C                     Z-ADD*ZERO     WN0734  50       Number Pallets
     C                     Z-ADD*ZERO     WN0735 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0736  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0737  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0738  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0739 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0740 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0741  70       Actual Departur
     C                     Z-ADD*ZERO     WN0742  40       Departure Time
     C                     Z-ADD*ZERO     WN0743  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0744  52       Product Tempera
     C                     Z-ADD*ZERO     WN0745  50       Number Spacers
     C                     MOVEL*BLANK    WN0746 12        Car/Veh. Initia
     C                     MOVEL*BLANK    WN0747 12        Recorder ID
     C                     MOVEL*BLANK    WN0748  2        Shipping Method
     C                     MOVEL*BLANK    WN0749  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0750  2        Ship To State C
     C                     Z-ADD*ZERO     WN0751  70       Gross Weight
     C                     MOVEL*BLANK    WN0752  3        Carrier Broker
     C                     MOVEL*BLANK    WN0753  1        Export Status
     C                     Z-ADD*ZERO     WN0754  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0755  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0756  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0757  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0758  70       Spotted Date
     C                     Z-ADD*ZERO     WN0759  60       Spotted Time
     C                     Z-ADD*ZERO     WN0760  70       Load Finished D
     C                     Z-ADD*ZERO     WN0761  60       Load Finished T
     C                     Z-ADD*ZERO     WN0762  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0763  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0764  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0765  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0766  70       Truck Departure
     C                     Z-ADD*ZERO     WN0767  60       Truck Departure
     C                     Z-ADD*ZERO     WN0768  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0769  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0770  3        Shipping Line
     C                     MOVEL*BLANK    WN0771 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0772 30        Vessel Name
     C                     Z-ADD*ZERO     WN0773  50       Voyage
     C                     Z-ADD*ZERO     WN0774  70       Sail Date
     C                     MOVEL*BLANK    WN0775 12        Booking Number
     C                     MOVEL*BLANK    WN0776 20        Discharge Port
     C                     Z-ADD*ZERO     WN0777  70       Arrival Date
     C                     MOVEL*BLANK    WN0778 12        Container Numbe
     C                     Z-ADD*ZERO     WN0779  70       Date In
     C                     Z-ADD*ZERO     WN0780  60       Time In
     C                     Z-ADD*ZERO     WN0781  70       Date Out
     C                     Z-ADD*ZERO     WN0782  60       Time Out
     C                     Z-ADD*ZERO     WN0783 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0784  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0785  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0786  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0787  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0788  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0789  70       Requested Deliv
     C                     MOVEL*BLANK    WN0790  1        Load Acceptance
     C                     MOVEL*BLANK    WN0791  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0792  70       On Yard Date
     C                     Z-ADD*ZERO     WN0793  60       On Yard Time
     C                     Z-ADD*ZERO     WN0794  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0795  60       Deadline Depart
     C                     MOVEL*BLANK    WN0796  1        Load Held Over
     C                     MOVEL*BLANK    WN0797  1        Load Held Over
     C                     MOVEL*BLANK    WN0798 15        Load Held Over
     C                     MOVEL*BLANK    WN0799 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0800 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0801  70       Express Mail Da
     C                     MOVEL*BLANK    WN0802  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0803  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0804  70       Product Complet
     C                     Z-ADD*ZERO     WN0805  60       Product Complet
     C                     Z-ADD*ZERO     WN0806  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0807  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0808  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0809  1        Load Confirmed
     C                     MOVEL*BLANK    WN0810 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0811  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0812  60       Load Door 1
     C                     Z-ADD*ZERO     WN0813  60       Load Door 2
     C                     MOVEL*BLANK    WN0814  1        Partial Load
     C                     MOVEL*BLANK    WN0815  1        Load Confirmati
     C                     MOVEL*BLANK    WN0816  1        Export Load USD
     C                     MOVEL*BLANK    WN0817  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0818 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0819 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0820 15        Late Billing Em
     C                     MOVEL*BLANK    WN0821 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0822 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0823  1        Multi Company L
     C                     MOVEL*BLANK    WN0824  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0825  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0826  1        LH Power Only L
     C                     MOVEL*BLANK    WN0827  1        MG Created Load
     C                     MOVEL*BLANK    WN0828  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0829  2        Load U/M
     C                     MOVEL*BLANK    WN0830  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0831  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0832  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0833  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0834  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0835  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0836  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0837  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0838  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0839  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0840  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0841  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0842  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0843  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0844  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0845  60       LH Unused Time
     C                     MOVEL*BLANK    WN0846  1        EDI Status 1
     C                     MOVEL*BLANK    WN0847  1        EDI Status 2
     C                     MOVEL*BLANK    WN0848  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0849  60       Job Time
     C                     MOVEL*BLANK    WN0850 10        User Id
     C                     MOVEL*BLANK    WN0851 10        Job Name
     C                     Z-ADD*ZERO     WN0852  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADD#2RMNB    WDRMNB           Load ID
      *
     C           KLCHNJ    KLIST
     C                     KFLD           WDRMNB           Load ID
     C           KLCHNJ    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YFRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDWUTLMI    WDTLMI           Total Load Mile
     C                     Z-ADDP2K2DT    WDK2DT           Override Total
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##PGM     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NJEXIT    ENDSR
      /EJECT
     CSR         NKCHRC    BEGSR
      *================================================================
      * CHG for Load Plan O.E. CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0853  30       Company Number
     C                     Z-ADD*ZERO     WN0854  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0855  1        Load Status
     C                     Z-ADD*ZERO     WN0856  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0857 15        Seal 1
     C                     MOVEL*BLANK    WN0858 15        Seal 2
     C                     MOVEL*BLANK    WN0859 15        Seal 3
     C                     MOVEL*BLANK    WN0860 15        Seal 4
     C                     MOVEL*BLANK    WN0861 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0862 112       Flat Amount
     C                     MOVEL*BLANK    WN0863  1        Allocate Pounds
     C                     MOVEL*BLANK    WN0864 20        Trailer Id
     C                     MOVEL*BLANK    WN0865  3        Transloader Car
     C                     Z-ADD*ZERO     WN0866  40       BOL Time
     C                     MOVEL*BLANK    WN0867  7        Truck Size
     C                     Z-ADD*ZERO     WN0868  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0869 112       Rated Freight
     C                     MOVEL*BLANK    WN0870  1        Ship Status
     C                     Z-ADD*ZERO     WN0871  50       Number Pallets
     C                     Z-ADD*ZERO     WN0872  50       Number Pallets
     C                     Z-ADD*ZERO     WN0873 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0874  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0875  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0876  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0877 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0878 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0879  70       Actual Departur
     C                     Z-ADD*ZERO     WN0880  40       Departure Time
     C                     Z-ADD*ZERO     WN0881  52       Product Tempera
     C                     Z-ADD*ZERO     WN0882  50       Number Spacers
     C                     MOVEL*BLANK    WN0883 12        Car/Veh. Initia
     C                     MOVEL*BLANK    WN0884 12        Recorder ID
     C                     MOVEL*BLANK    WN0885  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0886  2        Ship To State C
     C                     Z-ADD*ZERO     WN0887  70       Gross Weight
     C                     Z-ADD*ZERO     WN0888  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0889  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0890  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0891  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0892  70       Spotted Date
     C                     Z-ADD*ZERO     WN0893  60       Spotted Time
     C                     Z-ADD*ZERO     WN0894  70       Load Finished D
     C                     Z-ADD*ZERO     WN0895  60       Load Finished T
     C                     Z-ADD*ZERO     WN0896  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0897  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0898  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0899  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0900  70       Truck Departure
     C                     Z-ADD*ZERO     WN0901  60       Truck Departure
     C                     Z-ADD*ZERO     WN0902  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0903  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0904  3        Shipping Line
     C                     MOVEL*BLANK    WN0905 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0906 30        Vessel Name
     C                     Z-ADD*ZERO     WN0907  50       Voyage
     C                     Z-ADD*ZERO     WN0908  70       Sail Date
     C                     MOVEL*BLANK    WN0909 12        Booking Number
     C                     MOVEL*BLANK    WN0910 20        Discharge Port
     C                     Z-ADD*ZERO     WN0911  70       Arrival Date
     C                     MOVEL*BLANK    WN0912 12        Container Numbe
     C                     Z-ADD*ZERO     WN0913  70       Date In
     C                     Z-ADD*ZERO     WN0914  60       Time In
     C                     Z-ADD*ZERO     WN0915  70       Date Out
     C                     Z-ADD*ZERO     WN0916  60       Time Out
     C                     Z-ADD*ZERO     WN0917 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0918  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0919  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0920  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0921  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0922  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0923  70       Requested Deliv
     C                     MOVEL*BLANK    WN0924  1        Load Acceptance
     C                     MOVEL*BLANK    WN0925  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0926  70       On Yard Date
     C                     Z-ADD*ZERO     WN0927  60       On Yard Time
     C                     Z-ADD*ZERO     WN0928  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0929  60       Deadline Depart
     C                     MOVEL*BLANK    WN0930  1        Load Held Over
     C                     MOVEL*BLANK    WN0931  1        Load Held Over
     C                     MOVEL*BLANK    WN0932 15        Load Held Over
     C                     MOVEL*BLANK    WN0933 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0934 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0935  70       Express Mail Da
     C                     MOVEL*BLANK    WN0936  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0937  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0938  70       Product Complet
     C                     Z-ADD*ZERO     WN0939  60       Product Complet
     C                     Z-ADD*ZERO     WN0940  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0941  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0942  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0943  1        Load Confirmed
     C                     MOVEL*BLANK    WN0944 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0945  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0946  60       Load Door 1
     C                     Z-ADD*ZERO     WN0947  60       Load Door 2
     C                     MOVEL*BLANK    WN0948  1        Partial Load
     C                     MOVEL*BLANK    WN0949  1        Load Confirmati
     C                     MOVEL*BLANK    WN0950  1        Export Load USD
     C                     MOVEL*BLANK    WN0951  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0952 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0953 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0954 15        Late Billing Em
     C                     MOVEL*BLANK    WN0955 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0956 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0957  1        Multi Company L
     C                     MOVEL*BLANK    WN0958  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0959  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0960  1        LH Power Only L
     C                     MOVEL*BLANK    WN0961  1        MG Created Load
     C                     MOVEL*BLANK    WN0962  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0963  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0964  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0965  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0966  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0967  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0968  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0969  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0970  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0971  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0972  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0973  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0974  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0975  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0976  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0977  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0978  60       LH Unused Time
     C                     MOVEL*BLANK    WN0979  1        EDI Status 1
     C                     MOVEL*BLANK    WN0980  1        EDI Status 2
     C                     MOVEL*BLANK    WN0981  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0982  60       Job Time
     C                     MOVEL*BLANK    WN0983 10        User Id
     C                     MOVEL*BLANK    WN0984 10        Job Name
     C                     Z-ADD*ZERO     WN0985  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADD#2RMNB    WDRMNB           Load ID
      *
     C           KLCHNK    KLIST
     C                     KFLD           WDRMNB           Load ID
     C           KLCHNK    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NKEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YGRDCS
      * Move non-key fields to @FJCPBO
     C                     MOVELWUPJST    WDPJST    P      LTL Flag
     C                     Z-ADD#PRPNB    WDRPNB           Total Load Orde
     C                     Z-ADDWURRNB    WDRRNB           Total Stops
     C                     MOVEL#2BZNA    WDBZNA    P      Carrier Code
     C                     MOVEL#2VDST    WDVDST    P      Load Type
     C                     Z-ADDYL0001    WDT4NB           Schedule Sequen
     C                     Z-ADDWUTLMI    WDTLMI           Total Load Mile
     C                     MOVEL#CCUST    WDQ2CD    P      Shipping Method
     C                     MOVELWUXCCD    WDXCCD    P      Carrier Broker
     C                     MOVELP2U2ST    WDU2ST    P      Export Status
     C                     Z-ADDP2K2DT    WDK2DT           Override Total
     C                     MOVELYL0044    WDR0SX    P      Load U/M
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WDAATM' defaulted for 'Job Time'.
      * Field '(DB1) WDAYNA' defaulted for 'User Id'.
      * Field '(DB1) WDA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WDAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##JOB     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NKEXIT    ENDSR
      /EJECT
     CSR         NLCHRC    BEGSR
      *================================================================
      * CHG Ship To St-Exports CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0986  30       Company Number
     C                     Z-ADD*ZERO     WN0987  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0988  1        LTL Flag
     C                     MOVEL*BLANK    WN0989  1        Load Status
     C                     Z-ADD*ZERO     WN0990  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0991 15        Seal 1
     C                     MOVEL*BLANK    WN0992 15        Seal 2
     C                     MOVEL*BLANK    WN0993 15        Seal 3
     C                     MOVEL*BLANK    WN0994 15        Seal 4
     C                     MOVEL*BLANK    WN0995 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0996  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0997 112       Flat Amount
     C                     MOVEL*BLANK    WN0998  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0999  50       Total Stops
     C                     MOVEL*BLANK    WN1000 20        Trailer Id
     C                     MOVEL*BLANK    WN1001  3        Transloader Car
     C                     Z-ADD*ZERO     WN1002  40       BOL Time
     C                     MOVEL*BLANK    WN1003  3        Carrier Code
     C                     MOVEL*BLANK    WN1004  7        Truck Size
     C                     Z-ADD*ZERO     WN1005  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN1006 112       Rated Freight
     C                     MOVEL*BLANK    WN1007  1        Ship Status
     C                     MOVEL*BLANK    WN1008  1        Load Type
     C                     Z-ADD*ZERO     WN1009  50       Number Pallets
     C                     Z-ADD*ZERO     WN1010  50       Number Pallets
     C                     Z-ADD*ZERO     WN1011 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN1012  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN1013  70       Actual Arrival
     C                     Z-ADD*ZERO     WN1014  40       Actual Arrival
     C                     Z-ADD*ZERO     WN1015 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN1016 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN1017  70       Actual Departur
     C                     Z-ADD*ZERO     WN1018  40       Departure Time
     C                     Z-ADD*ZERO     WN1019  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN1020  52       Product Tempera
     C                     Z-ADD*ZERO     WN1021  50       Number Spacers
     C                     MOVEL*BLANK    WN1022 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN1023  70       Total Load Mile
     C                     MOVEL*BLANK    WN1024 12        Recorder ID
     C                     MOVEL*BLANK    WN1025  2        Shipping Method
     C                     MOVEL*BLANK    WN1026  3        Ship From Wareh
     C                     Z-ADD*ZERO     WN1027  70       Gross Weight
     C                     MOVEL*BLANK    WN1028  3        Carrier Broker
     C                     MOVEL*BLANK    WN1029  1        Export Status
     C                     Z-ADD*ZERO     WN1030  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN1031  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN1032  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN1033  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN1034  70       Spotted Date
     C                     Z-ADD*ZERO     WN1035  60       Spotted Time
     C                     Z-ADD*ZERO     WN1036  70       Load Finished D
     C                     Z-ADD*ZERO     WN1037  60       Load Finished T
     C                     Z-ADD*ZERO     WN1038  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN1039  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN1040  70       BOL Received Da
     C                     Z-ADD*ZERO     WN1041  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN1042  70       Truck Departure
     C                     Z-ADD*ZERO     WN1043  60       Truck Departure
     C                     Z-ADD*ZERO     WN1044  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN1045  60       Adjusted Depart
     C                     MOVEL*BLANK    WN1046  3        Shipping Line
     C                     MOVEL*BLANK    WN1047 20        Port Delv Termi
     C                     MOVEL*BLANK    WN1048 30        Vessel Name
     C                     Z-ADD*ZERO     WN1049  50       Voyage
     C                     Z-ADD*ZERO     WN1050  70       Sail Date
     C                     MOVEL*BLANK    WN1051 12        Booking Number
     C                     MOVEL*BLANK    WN1052 20        Discharge Port
     C                     Z-ADD*ZERO     WN1053  70       Arrival Date
     C                     MOVEL*BLANK    WN1054 12        Container Numbe
     C                     Z-ADD*ZERO     WN1055  70       Date In
     C                     Z-ADD*ZERO     WN1056  60       Time In
     C                     Z-ADD*ZERO     WN1057  70       Date Out
     C                     Z-ADD*ZERO     WN1058  60       Time Out
     C                     Z-ADD*ZERO     WN1059 112       Load Total Frei
     C                     Z-ADD*ZERO     WN1060  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN1061  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN1062  1        LH Unused Sts
     C                     MOVEL*BLANK    WN1063  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN1064  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN1065  70       Requested Deliv
     C                     MOVEL*BLANK    WN1066  1        Load Acceptance
     C                     MOVEL*BLANK    WN1067  3        Warehouse Code
     C                     Z-ADD*ZERO     WN1068  70       On Yard Date
     C                     Z-ADD*ZERO     WN1069  60       On Yard Time
     C                     Z-ADD*ZERO     WN1070  70       Deadline Depart
     C                     Z-ADD*ZERO     WN1071  60       Deadline Depart
     C                     MOVEL*BLANK    WN1072  1        Load Held Over
     C                     MOVEL*BLANK    WN1073  1        Load Held Over
     C                     MOVEL*BLANK    WN1074 15        Load Held Over
     C                     MOVEL*BLANK    WN1075 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN1076 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN1077  70       Express Mail Da
     C                     MOVEL*BLANK    WN1078  1        Load Shag Flag
     C                     MOVEL*BLANK    WN1079  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN1080  70       Product Complet
     C                     Z-ADD*ZERO     WN1081  60       Product Complet
     C                     Z-ADD*ZERO     WN1082  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN1083  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN1084  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN1085  1        Load Confirmed
     C                     MOVEL*BLANK    WN1086 25        Load Confirmed
     C                     Z-ADD*ZERO     WN1087  70       Load Confirmati
     C                     Z-ADD*ZERO     WN1088  60       Load Door 1
     C                     Z-ADD*ZERO     WN1089  70       Override Total
     C                     Z-ADD*ZERO     WN1090  60       Load Door 2
     C                     MOVEL*BLANK    WN1091  1        Partial Load
     C                     MOVEL*BLANK    WN1092  1        Load Confirmati
     C                     MOVEL*BLANK    WN1093  1        Export Load USD
     C                     MOVEL*BLANK    WN1094  1        Late Delivery E
     C                     Z-ADD*ZERO     WN1095 112       Load Actual Fre
     C                     MOVEL*BLANK    WN1096 15        Hide on WW Load
     C                     MOVEL*BLANK    WN1097 15        Late Billing Em
     C                     MOVEL*BLANK    WN1098 25        Shipping Temp C
     C                     MOVEL*BLANK    WN1099 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN1100  1        Multi Company L
     C                     MOVEL*BLANK    WN1101  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN1102  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN1103  1        LH Power Only L
     C                     MOVEL*BLANK    WN1104  1        MG Created Load
     C                     MOVEL*BLANK    WN1105  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN1106  2        Load U/M
     C                     MOVEL*BLANK    WN1107  2        TPM Shipment St
     C                     MOVEL*BLANK    WN1108  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN1109  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN1110  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN1111  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN1112  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN1113  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN1114  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN1115  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN1116  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN1117  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN1118  60       LH Unused Time
     C                     Z-ADD*ZERO     WN1119  70       LH Unused Date
     C                     Z-ADD*ZERO     WN1120  60       LH Unused Time
     C                     Z-ADD*ZERO     WN1121  70       LH Unused Date
     C                     Z-ADD*ZERO     WN1122  60       LH Unused Time
     C                     MOVEL*BLANK    WN1123  1        EDI Status 1
     C                     MOVEL*BLANK    WN1124  1        EDI Status 2
     C                     MOVEL*BLANK    WN1125  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1126  60       Job Time
     C                     MOVEL*BLANK    WN1127 10        User Id
     C                     MOVEL*BLANK    WN1128 10        Job Name
     C                     Z-ADD*ZERO     WN1129  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YHRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADD#2RMNB    WDRMNB           Load ID
      *
     C           KLCHNL    KLIST
     C                     KFLD           WDRMNB           Load ID
     C           KLCHNL    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YHRDCS
      * USER: Processing after Data read
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##JOB     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * Move non-key fields to @FJCPBO
     C                     MOVELP2DBCD    WDDBCD    P      Ship To State C
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YHRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NLEXIT    ENDSR
      /EJECT
     CSR         NMRVGN    BEGSR
      *================================================================
      * RTV WW Screen Fields   RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNM     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSNM     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFJAODT    YL0052           Scheduled Ship
     C                     MOVELFJPKST    YL0053           Load Status
     C                     Z-ADDFJRPNB    YL0054           Total Load Orde
     C                     Z-ADDFJFLAM    YL0055           Flat Amount
     C                     MOVELFJBZNA    YL0056           Carrier Code
     C                     MOVELFJRONB    YL0057           Truck Size
     C                     MOVELFJVDST    YL0058           Load Type
     C                     Z-ADDFJTLMI    YL0059           Total Load Mile
     C                     MOVELFJQ2CD    YL0060           Shipping Method
     C                     MOVELFJVPCD    YL0002           Ship From Wareh
     C                     MOVELFJDBCD    YL0061           Ship To State C
     C                     MOVELFJRMST    YL0062           Load Acceptance
     C                     ENDIF
      *================================================================
     CSR         NMEXIT    ENDSR
      /EJECT
     CSR         NNRVGN    BEGSR
      *================================================================
      * RTV Total Ld Mi/Sts    RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNN     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDWL0062    FJRMNB           Load ID
      * Establish starting position
     C           KRSNN     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFJPKST    WL0063           Load Status
     C                     Z-ADDFJTLMI    WL0064           Total Load Mile
     C                     Z-ADDFJK2DT    WL0065           Override Total
     C                     ENDIF
      *================================================================
     CSR         NNEXIT    ENDSR
      /EJECT
     CSR         NORVGN    BEGSR
      *================================================================
      * RTV Any Ord/Blk  on Ld RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
     C                     MOVEL*BLANK    P6JDST           USR Check Y/N S
      * OMS203:  need to know if there are any Block orders on load
     C                     MOVEL'F'       YL0064           Block Order Fla
      * Declare restrictor key work fields
     C           *LIKE     DEFN WARMNB    WQNO02           Load ID
      * Define keylist
     C           KRSNO     KLIST
     C                     KFLD           WQNO02           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    WQNO02           Load ID
      * Establish starting position
     C           KRSNO     SETLL@BFCPD9                    *
     C           KRSNO     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       P6JDST           USR Check Y/N S
      * CASE: DB1.Block Order Flag is Block Order
     C           WABCST    IFEQ 'B'                        *IF
     C                     MOVELWABCST    YL0064           Block Order Fla
     C                     GOTO NOEXIT                     *QUIT
     C                     END                             *FI
     C           KRSNO     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         NOEXIT    ENDSR
      /EJECT
     CSR         NPCHRC    BEGSR
      *================================================================
      * CHG Ld Sts/Dpt D/T Whs CH - Load Header  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1132  30       Company Number
     C                     MOVEL*BLANK    WN1133  1        LTL Flag
     C                     Z-ADD*ZERO     WN1134  52       Reefer Temperat
     C                     MOVEL*BLANK    WN1135 15        Seal 1
     C                     MOVEL*BLANK    WN1136 15        Seal 2
     C                     MOVEL*BLANK    WN1137 15        Seal 3
     C                     MOVEL*BLANK    WN1138 15        Seal 4
     C                     MOVEL*BLANK    WN1139 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN1140  70       Total Load Orde
     C                     Z-ADD*ZERO     WN1141 112       Flat Amount
     C                     MOVEL*BLANK    WN1142  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN1143  50       Total Stops
     C                     MOVEL*BLANK    WN1144 20        Trailer Id
     C                     MOVEL*BLANK    WN1145  3        Transloader Car
     C                     Z-ADD*ZERO     WN1146  40       BOL Time
     C                     MOVEL*BLANK    WN1147  3        Carrier Code
     C                     MOVEL*BLANK    WN1148  7        Truck Size
     C                     Z-ADD*ZERO     WN1149  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN1150 112       Rated Freight
     C                     MOVEL*BLANK    WN1151  1        Ship Status
     C                     MOVEL*BLANK    WN1152  1        Load Type
     C                     Z-ADD*ZERO     WN1153  50       Number Pallets
     C                     Z-ADD*ZERO     WN1154  50       Number Pallets
     C                     Z-ADD*ZERO     WN1155 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN1156  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN1157  70       Actual Arrival
     C                     Z-ADD*ZERO     WN1158  40       Actual Arrival
     C                     Z-ADD*ZERO     WN1159 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN1160 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN1161  70       Actual Departur
     C                     Z-ADD*ZERO     WN1162  40       Departure Time
     C                     Z-ADD*ZERO     WN1163  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN1164  52       Product Tempera
     C                     Z-ADD*ZERO     WN1165  50       Number Spacers
     C                     MOVEL*BLANK    WN1166 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN1167  70       Total Load Mile
     C                     MOVEL*BLANK    WN1168 12        Recorder ID
     C                     MOVEL*BLANK    WN1169  2        Shipping Method
     C                     MOVEL*BLANK    WN1170  2        Ship To State C
     C                     Z-ADD*ZERO     WN1171  70       Gross Weight
     C                     MOVEL*BLANK    WN1172  3        Carrier Broker
     C                     MOVEL*BLANK    WN1173  1        Export Status
     C                     Z-ADD*ZERO     WN1174  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN1175  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN1176  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN1177  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN1178  70       Spotted Date
     C                     Z-ADD*ZERO     WN1179  60       Spotted Time
     C                     Z-ADD*ZERO     WN1180  70       Load Finished D
     C                     Z-ADD*ZERO     WN1181  60       Load Finished T
     C                     Z-ADD*ZERO     WN1182  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN1183  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN1184  70       BOL Received Da
     C                     Z-ADD*ZERO     WN1185  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN1186  70       Truck Departure
     C                     Z-ADD*ZERO     WN1187  60       Truck Departure
     C                     Z-ADD*ZERO     WN1188  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN1189  60       Adjusted Depart
     C                     MOVEL*BLANK    WN1190  3        Shipping Line
     C                     MOVEL*BLANK    WN1191 20        Port Delv Termi
     C                     MOVEL*BLANK    WN1192 30        Vessel Name
     C                     Z-ADD*ZERO     WN1193  50       Voyage
     C                     Z-ADD*ZERO     WN1194  70       Sail Date
     C                     MOVEL*BLANK    WN1195 12        Booking Number
     C                     MOVEL*BLANK    WN1196 20        Discharge Port
     C                     Z-ADD*ZERO     WN1197  70       Arrival Date
     C                     MOVEL*BLANK    WN1198 12        Container Numbe
     C                     Z-ADD*ZERO     WN1199  70       Date In
     C                     Z-ADD*ZERO     WN1200  60       Time In
     C                     Z-ADD*ZERO     WN1201  70       Date Out
     C                     Z-ADD*ZERO     WN1202  60       Time Out
     C                     Z-ADD*ZERO     WN1203 112       Load Total Frei
     C                     Z-ADD*ZERO     WN1204  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN1205  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN1206  1        LH Unused Sts
     C                     MOVEL*BLANK    WN1207  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN1208  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN1209  70       Requested Deliv
     C                     MOVEL*BLANK    WN1210  1        Load Acceptance
     C                     MOVEL*BLANK    WN1211  3        Warehouse Code
     C                     Z-ADD*ZERO     WN1212  70       On Yard Date
     C                     Z-ADD*ZERO     WN1213  60       On Yard Time
     C                     MOVEL*BLANK    WN1214  1        Load Held Over
     C                     MOVEL*BLANK    WN1215  1        Load Held Over
     C                     MOVEL*BLANK    WN1216 15        Load Held Over
     C                     MOVEL*BLANK    WN1217 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN1218 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN1219  70       Express Mail Da
     C                     MOVEL*BLANK    WN1220  1        Load Shag Flag
     C                     MOVEL*BLANK    WN1221  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN1222  70       Product Complet
     C                     Z-ADD*ZERO     WN1223  60       Product Complet
     C                     Z-ADD*ZERO     WN1224  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN1225  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN1226  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN1227  1        Load Confirmed
     C                     MOVEL*BLANK    WN1228 25        Load Confirmed
     C                     Z-ADD*ZERO     WN1229  70       Load Confirmati
     C                     Z-ADD*ZERO     WN1230  60       Load Door 1
     C                     Z-ADD*ZERO     WN1231  70       Override Total
     C                     Z-ADD*ZERO     WN1232  60       Load Door 2
     C                     MOVEL*BLANK    WN1233  1        Partial Load
     C                     MOVEL*BLANK    WN1234  1        Load Confirmati
     C                     MOVEL*BLANK    WN1235  1        Export Load USD
     C                     MOVEL*BLANK    WN1236  1        Late Delivery E
     C                     Z-ADD*ZERO     WN1237 112       Load Actual Fre
     C                     MOVEL*BLANK    WN1238 15        Hide on WW Load
     C                     MOVEL*BLANK    WN1239 15        Late Billing Em
     C                     MOVEL*BLANK    WN1240 25        Shipping Temp C
     C                     MOVEL*BLANK    WN1241 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN1242  1        Multi Company L
     C                     MOVEL*BLANK    WN1243  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN1244  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN1245  1        LH Power Only L
     C                     MOVEL*BLANK    WN1246  1        MG Created Load
     C                     MOVEL*BLANK    WN1247  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN1248  2        Load U/M
     C                     MOVEL*BLANK    WN1249  2        TPM Shipment St
     C                     MOVEL*BLANK    WN1250  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN1251  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN1252  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN1253  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN1254  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN1255  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN1256  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN1257  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN1258  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN1259  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN1260  60       LH Unused Time
     C                     Z-ADD*ZERO     WN1261  70       LH Unused Date
     C                     Z-ADD*ZERO     WN1262  60       LH Unused Time
     C                     Z-ADD*ZERO     WN1263  70       LH Unused Date
     C                     Z-ADD*ZERO     WN1264  60       LH Unused Time
     C                     MOVEL*BLANK    WN1265  1        EDI Status 1
     C                     MOVEL*BLANK    WN1266  1        EDI Status 2
     C                     MOVEL*BLANK    WN1267  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1268  60       Job Time
     C                     MOVEL*BLANK    WN1269 10        User Id
     C                     MOVEL*BLANK    WN1270 10        Job Name
     C                     Z-ADD*ZERO     WN1271  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YIRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWL0066    WDRMNB           Load ID
      *
     C           KLCHNP    KLIST
     C                     KFLD           WDRMNB           Load ID
     C           KLCHNP    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL009.
     C                     MOVEL'LBL009'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NPEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YIRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDWL0067    WDAODT           Scheduled Ship
     C                     MOVELWL0068    WDPKST    P      Load Status
     C                     MOVELWL0069    WDVPCD    P      Ship From Wareh
     C                     Z-ADDWL0070    WDKZDT           Deadline Depart
     C                     Z-ADDWL0071    WDAXTM           Deadline Depart
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##JOB     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YIRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NPEXIT    ENDSR
      /EJECT
     CSR         NQRVGN    BEGSR
      *================================================================
      * RTV All Ords f/CMBLOD RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WORMNB    WQNQ02           Load ID
      * Define keylist
     C           KRSNQ     KLIST
     C                     KFLD           WQNQ02           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    WQNQ02           Load ID
      * Establish starting position
     C           KRSNQ     SETLL@FLCPKF                    *
     C           KRSNQ     READE@FLCPKF                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * 01/21/08 RMC  Create Change Log for Combine process- 1st order on
      * 01/21/08 RMC  Use load chg type from Par instead of 'CMBLOD' alwa
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPDRC
     C                     Z-ADDWORMNB    PDRMNB           Load ID
     C                     Z-ADDWORVNB    PDRVNB           Stop/Drop
     C                     MOVEL'CMBLOD'  PDRVST    P      Load Change Typ
     C                     MOVEL'INT'     PDUJST    P      Department Cont
     C                     MOVEL'E'       PDMNTX    P      Change Log Prio
     C                     MOVEL'C'       PDMOTX    P      Change Log New
     C                     MOVEL##USR     PDAYNA    P      User Id
     C                     MOVEL##PGM     PDA0NA    P      Job Name
     C                     MOVEL*BLANK    PDBZNA    P      Carrier Code
     C                     Z-ADDWOAIC3    PDAIC3           Company Number
     C                     Z-ADDWOC4NB    PDC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     GOTO NQEXIT                     *QUIT
     C           KRSNQ     READE@FLCPKF                  90*
     C                     ENDDO
      *================================================================
     CSR         NQEXIT    ENDSR
      /EJECT
     CSR         NRRVGN    BEGSR
      *================================================================
      * CHG Deadline Date/Time RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQNR01           Load ID
      * Define keylist
     C           KPSNR     KLIST
     C                     KFLD           WQNR01           Load ID
     C                     KFLD           FLRUNB           Stop/Drop Seque
      * Define keylist
     C           KRSNR     KLIST
     C                     KFLD           WQNR01           Load ID
      * Setup key
     C                     Z-ADDWL0072    WQNR01           Load ID
     C                     Z-ADDWL0073    FLRUNB           Stop/Drop Seque
      * Establish starting position
     C           KPSNR     SETLL@FLCPBW                    *
     C           KRSNR     READE@FLCPBW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO NREXIT                     *QUIT
     C                     GOTO NREXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Deadline Date/Time CH - Load Detail  * 
     C                     EXSR NSCHRC
     C           KRSNR     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         NREXIT    ENDSR
      /EJECT
     CSR         NSCHRC    BEGSR
      *================================================================
      * CHG Deadline Date/Time CH - Load Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1272  50       Stop/Drop
     C                     MOVEL*BLANK    WN1273 30        Comments for Pi
     C                     Z-ADD*ZERO     WN1274  50       Miles to next s
     C                     Z-ADD*ZERO     WN1275  72       Freight Charge
     C                     Z-ADD*ZERO     WN1276  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN1277 112       Freight Misc. C
     C                     Z-ADD*ZERO     WN1278  72       Freight Stop Ch
     C                     Z-ADD*ZERO     WN1279 112       Rated Freight
     C                     Z-ADD*ZERO     WN1280  30       Company Number
     C                     Z-ADD*ZERO     WN1281  70       Order Number
     C                     MOVEL*BLANK    WN1282  1        Ship Status
     C                     Z-ADD*ZERO     WN1283  70       Estimated Arriv
     C                     Z-ADD*ZERO     WN1284  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN1285  70       Appointment Con
     C                     Z-ADD*ZERO     WN1286  60       Appointment Con
     C                     MOVEL*BLANK    WN1287 30        Confirmation Ma
     C                     MOVEL*BLANK    WN1288 10        Confirmation Nu
     C                     Z-ADD*ZERO     WN1289  70       Actual Delivery
     C                     Z-ADD*ZERO     WN1290  60       Actual Delivery
     C                     Z-ADD*ZERO     WN1291  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN1292  60       Scheduled Deliv
     C                     Z-ADD*ZERO     WN1293  70       On Yard Date
     C                     Z-ADD*ZERO     WN1294  60       On Yard Time
     C                     Z-ADD*ZERO     WN1295  70       MPC Number
     C                     MOVEL*BLANK    WN1296  1        Load Dtl On Tim
     C                     MOVEL*BLANK    WN1297  1        On Time Add'l R
     C                     MOVEL*BLANK    WN1298 15        Seal Nbr 1
     C                     MOVEL*BLANK    WN1299 15        Seal Nbr 2
     C                     MOVEL*BLANK    WN1300 15        Seal Nbr 3
     C                     MOVEL*BLANK    WN1301 15        Seal Nbr 4
     C                     MOVEL*BLANK    WN1302 15        Seal Nbr 5
     C                     Z-ADD*ZERO     WN1303  70       LD Carrier Appt
     C                     Z-ADD*ZERO     WN1304  70       LD Unused Date
     C                     Z-ADD*ZERO     WN1305  70       LD Unused Date
     C                     Z-ADD*ZERO     WN1306  60       LD Carrier Appt
     C                     Z-ADD*ZERO     WN1307  60       LD Unused Time
     C                     Z-ADD*ZERO     WN1308  60       LD Unused Time
     C                     MOVEL*BLANK    WN1309  1        Miles Error Sts
     C                     MOVEL*BLANK    WN1310  1        LD Unused Sts 2
     C                     MOVEL*BLANK    WN1311  2        HPB Transload S
     C                     MOVEL*BLANK    WN1312 15        LD Cst Svc Trac
     C                     MOVEL*BLANK    WN1313 25        Carrier Ref PRO
     C                     MOVEL*BLANK    WN1314 25        Cust Assigned A
     C                     MOVEL*BLANK    WN1315  1        EDI Status 1
     C                     MOVEL*BLANK    WN1316  1        EDI Status 2
     C                     MOVEL*BLANK    WN1317  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1318  60       Job Time
     C                     MOVEL*BLANK    WN1319 10        User Id
     C                     MOVEL*BLANK    WN1320 10        Job Name
     C                     Z-ADD*ZERO     WN1321  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YJRDC   1
      *
      * Move key fields to @FLCPBM
     C                     Z-ADDWL0072    WRRMNB           Load ID
     C                     Z-ADDFLRUNB    WRRUNB           Stop/Drop Seque
      *
     C           KLCHNS    KLIST
     C                     KFLD           WRRMNB           Load ID
     C                     KFLD           WRRUNB           Stop/Drop Seque
     C           KLCHNS    CHAIN@FLCPBM              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFLCPL0'MDACP
     C                     MOVEL'@FLCPBM' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL010.
     C                     MOVEL'LBL010'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NSEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NSEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFL1    YJRDCS
      * Move non-key fields to @FLCPBM
     C                     Z-ADDWL0074    WRHDDT           Deadline Depart
     C                     Z-ADDWL0075    WRAUTM           Deadline Depart
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WRAATM           Job Time
     C                     MOVEL##USR     WRAYNA           User Id
     C                     MOVEL##JOB     WRA0NA           Job Name
     C                     Z-ADD##JDT     WRAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YJRDC     IFEQ 'Y'
     C                     UPDAT@FLCPBM                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFLCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
      * Upd Deadline Dte/Tme  RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWRAIC3    WL0076           Company Number
     C                     Z-ADDWRC4NB    WL0077           Order Number
     C                     Z-ADDWRHDDT    WL0078           Deadline Depart
     C                     Z-ADDWRAUTM    WL0079           Deadline Depart
     C                     EXSR NTRVGN
     C                     ENDIF
      *================================================================
     CSR         NSEXIT    ENDSR
      /EJECT
     CSR         NTRVGN    BEGSR
      *================================================================
      * Upd Deadline Dte/Tme  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJAIC3    WQNT01           Company Number
     C           *LIKE     DEFN WJC4NB    WQNT02           Order Number
      * Define keylist
     C           KRSNT     KLIST
     C                     KFLD           WQNT01           Company Number
     C                     KFLD           WQNT02           Order Number
      * Setup key
     C                     Z-ADDWL0076    WQNT01           Company Number
     C                     Z-ADDWL0077    WQNT02           Order Number
      * Establish starting position
     C           KRSNT     SETLL@BGWKL1                    *
     C           KRSNT     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Deadline Dte/Tme  CH - Order Detail  * 
     C                     EXSR NUCHRC
     C           KRSNT     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         NTEXIT    ENDSR
      /EJECT
     CSR         NUCHRC    BEGSR
      *================================================================
      * Chg Deadline Dte/Tme  CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1322  70       Item Code
     C                     MOVEL*BLANK    WN1323  3        Warehouse Code
     C                     Z-ADD*ZERO     WN1324  70       Ship To Custome
     C                     Z-ADD*ZERO     WN1325  70       Order Group Cod
     C                     MOVEL*BLANK    WN1326  1        Detail Line Sta
     C                     MOVEL*BLANK    WN1327  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN1328 112       Billing Detail
     C                     Z-ADD*ZERO     WN1329 112       Billing Detail
     C                     Z-ADD*ZERO     WN1330 112       Billing Detail
     C                     Z-ADD*ZERO     WN1331 112       Quantity to Sub
     C                     MOVEL*BLANK    WN1332  1        Comment Print A
     C                     MOVEL*BLANK    WN1333  1        Comment Print I
     C                     MOVEL*BLANK    WN1334  1        Comment Print P
     C                     MOVEL*BLANK    WN1335  1        Comment Print S
     C                     Z-ADD*ZERO     WN1336 112       Extended Amount
     C                     Z-ADD*ZERO     WN1337  70       Market Pricing
     C                     MOVEL*BLANK    WN1338  3        Commodity Marke
     C                     MOVEL*BLANK    WN1339  3        Date Method Cod
     C                     MOVEL*BLANK    WN1340  3        Price Method Co
     C                     Z-ADD*ZERO     WN1341 114       Price Overage O
     C                     Z-ADD*ZERO     WN1342  70       Contract Number
     C                     MOVEL*BLANK    WN1343  1        Price Status
     C                     Z-ADD*ZERO     WN1344  70       Pricing Date Us
     C                     MOVEL*BLANK    WN1345  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN1346  2        U/M - Ordered
     C                     MOVEL*BLANK    WN1347  1        Work Confirm St
     C                     MOVEL*BLANK    WN1348  1        Work Over/Short
     C                     MOVEL*BLANK    WN1349  1        OD Production P
     C                     MOVEL*BLANK    WN1350 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN1351 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN1352  1        Age Code
     C                     MOVEL*BLANK    WN1353  1        Palletize
     C                     MOVEL*BLANK    WN1354  1        Slip Sheet
     C                     MOVEL*BLANK    WN1355  1        Catch Weight St
     C                     MOVEL*BLANK    WN1356  1        Price Audit
     C                     MOVEL*BLANK    WN1357  3        Price Audit Rea
     C                     MOVEL*BLANK    WN1358  1        Production Date
     C                     Z-ADD*ZERO     WN1359 112       Rated Freight
     C                     Z-ADD*ZERO     WN1360 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN1361 112       Weight Ordered
     C                     Z-ADD*ZERO     WN1362 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN1363 112       Weight Schedule
     C                     Z-ADD*ZERO     WN1364 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN1365 112       Weight Shipped
     C                     Z-ADD*ZERO     WN1366 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN1367 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN1368 114       Unit Price
     C                     Z-ADD*ZERO     WN1369 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN1370 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN1371 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN1372 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN1373  70       Requested Ship
     C                     Z-ADD*ZERO     WN1374  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN1375  70       Actual Shipped
     C                     MOVEL*BLANK    WN1376  1        Affect Inventor
     C                     MOVEL*BLANK    WN1377  1        Affect Sales Do
     C                     MOVEL*BLANK    WN1378  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN1379  30       Item Structure
     C                     Z-ADD*ZERO     WN1380  30       Item Structure
     C                     Z-ADD*ZERO     WN1381  30       Item Structure
     C                     MOVEL*BLANK    WN1382  2        Item Level
     C                     MOVEL*BLANK    WN1383  2        Quality Level
     C                     MOVEL*BLANK    WN1384  2        Pricing Product
     C                     MOVEL*BLANK    WN1385  2        Season Product
     C                     Z-ADD*ZERO     WN1386  70       Date of Origina
     C                     MOVEL*BLANK    WN1387 10        User Profile Na
     C                     MOVEL*BLANK    WN1388  6        Country Code
     C                     MOVEL*BLANK    WN1389  2        Event Code
     C                     MOVEL*BLANK    WN1390  3        Reason Code
     C                     MOVEL*BLANK    WN1391  3        Sales Route Cod
     C                     MOVEL*BLANK    WN1392  1        Modified Flag
     C                     MOVEL*BLANK    WN1393  1        Substituted Fla
     C                     MOVEL*BLANK    WN1394  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN1395 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN1396 112       Invoice Extende
     C                     Z-ADD*ZERO     WN1397  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN1398  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN1399  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN1400  1        Affect Commissi
     C                     MOVEL*BLANK    WN1401  1        Affect Pricing
     C                     MOVEL*BLANK    WN1402  1        Released by Use
     C                     MOVEL*BLANK    WN1403  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN1404  2        OD Pallet Type
     C                     MOVEL*BLANK    WN1405  3        Production Ware
     C                     MOVEL*BLANK    WN1406  3        OD Price Type
     C                     Z-ADD*ZERO     WN1407  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN1408  70       Consumed Item C
     C                     Z-ADD*ZERO     WN1409  70       OD Price Type R
     C                     Z-ADD*ZERO     WN1410  70       OD Firm Date
     C                     Z-ADD*ZERO     WN1411  60       Price Code
     C                     Z-ADD*ZERO     WN1412  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN1413  60       Substitution Li
     C                     Z-ADD*ZERO     WN1414  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN1415 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN1416 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN1417 112       OD Item Target
     C                     Z-ADD*ZERO     WN1418 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN1419 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN1420 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN1421 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN1422 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN1423 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN1424 114       OD Original Ord
     C                     Z-ADD*ZERO     WN1425 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN1426 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN1427 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN1428  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN1429  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN1430  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN1431 112       Weight Amount E
     C                     Z-ADD*ZERO     WN1432  40       Item Age Days
     C                     Z-ADD*ZERO     WN1433  70       Production Ovr
     C                     Z-ADD*ZERO     WN1434  70       Production Ovr
     C                     MOVEL*BLANK    WN1435  1        OD Spot Buy
     C                     MOVEL*BLANK    WN1436  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN1437  3        Order Line Erro
     C                     Z-ADD*ZERO     WN1438  70       OD Market Begin
     C                     Z-ADD*ZERO     WN1439  70       OD Market Endin
     C                     Z-ADD*ZERO     WN1440  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN1441  1        EDI Status 1
     C                     MOVEL*BLANK    WN1442  1        EDI Status 2
     C                     MOVEL*BLANK    WN1443  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1444  60       Job Time
     C                     MOVEL*BLANK    WN1445 10        User Id
     C                     MOVEL*BLANK    WN1446 10        Job Name
     C                     Z-ADD*ZERO     WN1447  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YKRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWJAIC3    WKAIC3           Company Number
     C                     Z-ADDWJC4NB    WKC4NB           Order Number
     C                     Z-ADDWJDPNB    WKDPNB           Order Sequence
     C                     Z-ADDWJUENB    WKUENB           Order Secondary
      *
     C           KLCHNU    KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKC4NB           Order Number
     C                     KFLD           WKDPNB           Order Sequence
     C                     KFLD           WKUENB           Order Secondary
     C           KLCHNU    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL011.
     C                     MOVEL'LBL011'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NUEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YKRDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDWL0078    WKNVDT           Deadline Depart
     C                     Z-ADDWL0079    WKBUTM           Deadline Depart
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WKAATM           Job Time
     C                     MOVEL##USR     WKAYNA           User Id
     C                     MOVEL##JOB     WKA0NA           Job Name
     C                     Z-ADD##JDT     WKAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YKRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NUEXIT    ENDSR
      /EJECT
     CSR         NVRVGN    BEGSR
      *================================================================
      * RTV All Coll Ords-Accp RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WORMNB    WQNV02           Load ID
      * Define keylist
     C           KRSNV     KLIST
     C                     KFLD           WQNV02           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    WQNV02           Load ID
      * Establish starting position
     C           KRSNV     SETLL@FLCPKF                    *
     C           KRSNV     READE@FLCPKF                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Use Load CHG Type from PAR. Load Status will be "U"nlock
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPDRC
     C                     Z-ADDWORMNB    PDRMNB           Load ID
     C                     Z-ADDWORVNB    PDRVNB           Stop/Drop
     C                     MOVEL'UNLOCK'  PDRVST    P      Load Change Typ
     C                     MOVEL'INT'     PDUJST    P      Department Cont
     C                     MOVEL'E'       PDMNTX    P      Change Log Prio
     C                     MOVEL'U'       PDMOTX    P      Change Log New
     C                     MOVEL##USR     PDAYNA    P      User Id
     C                     MOVEL##PGM     PDA0NA    P      Job Name
     C                     MOVEL*BLANK    PDBZNA    P      Carrier Code
     C                     Z-ADDWOAIC3    PDAIC3           Company Number
     C                     Z-ADDWOC4NB    PDC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     GOTO NVEXIT                     *QUIT
     C           KRSNV     READE@FLCPKF                  90*
     C                     ENDDO
      *================================================================
     CSR         NVEXIT    ENDSR
      /EJECT
     CSR         NWRVGN    BEGSR
      *================================================================
      * Val Stop Existance    RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIRMNB    WQNW02           Load ID
     C           *LIKE     DEFN WIRVNB    WQNW03           Stop/Drop
      * Define keylist
     C           KRSNW     KLIST
     C                     KFLD           WQNW02           Load ID
     C                     KFLD           WQNW03           Stop/Drop
      * Setup key
     C                     Z-ADD#2RMNB    WQNW02           Load ID
     C                     Z-ADD#RTENB    WQNW03           Stop/Drop
      * Establish starting position
     C           KRSNW     SETLL@FLCPEB                    *
     C           KRSNW     READE@FLCPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       YL0066           Record Found US
     C                     GOTO NWEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       YL0066           Record Found US
     C                     GOTO NWEXIT                     *QUIT
     C           KRSNW     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         NWEXIT    ENDSR
      /EJECT
     CSR         NXRVGN    BEGSR
      *================================================================
      * VAL No Stops on Load  RT - Load Detail          TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       YL0068           Status - Y or N
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIRMNB    WQNX02           Load ID
      * Define keylist
     C           KRSNX     KLIST
     C                     KFLD           WQNX02           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    WQNX02           Load ID
      * Establish starting position
     C           KRSNX     SETLL@FLCPEB                    *
     C           KRSNX     READE@FLCPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO NXEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       YL0068           Status - Y or N
     C                     GOTO NXEXIT                     *QUIT
     C           KRSNX     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         NXEXIT    ENDSR
      /EJECT
     CSR         NYCRRC    BEGSR
      *================================================================
      * CRT Load Detail        CR - Load Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN1448  1        EDI Status 1
     C                     MOVEL*BLANK    WN1449  1        EDI Status 2
     C                     MOVEL*BLANK    WN1450  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1451  60       Job Time
     C                     MOVEL*BLANK    WN1452 10        User Id
     C                     MOVEL*BLANK    WN1453 10        Job Name
     C                     Z-ADD*ZERO     WN1454  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FLCPBM
     C                     Z-ADD#2RMNB    WRRMNB           Load ID
     C                     Z-ADDWURUNB    WRRUNB           Stop/Drop Seque
     C                     Z-ADD#RTENB    WRRVNB           Stop/Drop
     C                     MOVEL*BLANK    WRDQTX           Comments for Pi
     C                     Z-ADD*ZERO     WRRWNB           Miles to next s
     C                     Z-ADD*ZERO     WRRXNB           Freight Charge
     C                     Z-ADD*ZERO     WRSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WRT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WRT1NB           Freight Stop Ch
     C                     Z-ADD#1R1NB    WRR1NB           Rated Freight
     C                     Z-ADD#1AIC3    WRAIC3           Company Number
     C                     Z-ADD#1C4NB    WRC4NB           Order Number
     C                     MOVEL'O'       WRVCST           Ship Status
     C                     Z-ADD*ZERO     WRKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WRSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WRKFDT           Appointment Con
     C                     Z-ADD*ZERO     WRACTM           Appointment Con
     C                     MOVEL#RWBT1    WRK5TX           Confirmation Ma
     C                     MOVEL#RV5T1    WRW5CD           Confirmation Nu
     C                     Z-ADD*ZERO     WREJDT           Actual Delivery
     C                     Z-ADD*ZERO     WRAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WRKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WRATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WRHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WRAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WRKKDT           On Yard Date
     C                     Z-ADD*ZERO     WRAVTM           On Yard Time
     C                     Z-ADD*ZERO     WRZ4NB           MPC Number
     C                     MOVELWUGSTX    WRY7ST           Load Dtl On Tim
     C                     MOVELWUGSTX    WRY2ST           On Time Add'l R
     C                     MOVEL*BLANK    WRWHTX           Seal Nbr 1
     C                     MOVEL*BLANK    WRWITX           Seal Nbr 2
     C                     MOVEL*BLANK    WRWJTX           Seal Nbr 3
     C                     MOVEL*BLANK    WRWKTX           Seal Nbr 4
     C                     MOVEL*BLANK    WRWLTX           Seal Nbr 5
     C                     Z-ADDYL0069    WRN7DT           LD Carrier Appt
     C                     Z-ADD#1NODT    WRN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WRN9DT           LD Unused Date
     C                     Z-ADDYL0070    WRB3TM           LD Carrier Appt
     C                     Z-ADD#1BRTM    WRB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WRB5TM           LD Unused Time
     C                     MOVELWUIASX    WRIASX           Miles Error Sts
     C                     MOVELWUIBSX    WRIBSX           LD Unused Sts 2
     C                     MOVELWUICSX    WRICSX           HPB Transload S
     C                     MOVEL*BLANK    WRWVTX           LD Cst Svc Trac
     C                     MOVEL*BLANK    WRWWTX           Carrier Ref PRO
     C                     MOVEL*BLANK    WRWXTX           Cust Assigned A
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WRAATM           Job Time
     C                     MOVEL##USR     WRAYNA           User Id
     C                     MOVEL##JOB     WRA0NA           Job Name
     C                     Z-ADD##JDT     WRAXDT           Job Date
     C           KLCRNY    KLIST
     C                     KFLD           WRRMNB           Load ID
     C                     KFLD           WRRUNB           Stop/Drop Seque
      * Check for duplicate primary key
     C           KLCRNY    SETLL@FLCPBM                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1193' W0RTN   7
      * Send message 'Load Detail            EX'
     C                     MOVEL'USR1193' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NYEXIT
     C                     ENDIF
      *
     C                     WRITE@FLCPBM                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NYEXIT    ENDSR
      /EJECT
     CSR         NZCHRC    BEGSR
      *================================================================
      * CHG Carrier/Truck Size CH - Load Header TRG  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1455  30       Company Number
     C                     Z-ADD*ZERO     WN1456  70       Scheduled Ship
     C                     MOVEL*BLANK    WN1457  1        LTL Flag
     C                     MOVEL*BLANK    WN1458  1        Load Status
     C                     Z-ADD*ZERO     WN1459  52       Reefer Temperat
     C                     MOVEL*BLANK    WN1460 15        Seal 1
     C                     MOVEL*BLANK    WN1461 15        Seal 2
     C                     MOVEL*BLANK    WN1462 15        Seal 3
     C                     MOVEL*BLANK    WN1463 15        Seal 4
     C                     MOVEL*BLANK    WN1464 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN1465  70       Total Load Orde
     C                     Z-ADD*ZERO     WN1466 112       Flat Amount
     C                     MOVEL*BLANK    WN1467  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN1468  50       Total Stops
     C                     MOVEL*BLANK    WN1469 20        Trailer Id
     C                     MOVEL*BLANK    WN1470  3        Transloader Car
     C                     Z-ADD*ZERO     WN1471  40       BOL Time
     C                     Z-ADD*ZERO     WN1472  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN1473 112       Rated Freight
     C                     MOVEL*BLANK    WN1474  1        Ship Status
     C                     MOVEL*BLANK    WN1475  1        Load Type
     C                     Z-ADD*ZERO     WN1476  50       Number Pallets
     C                     Z-ADD*ZERO     WN1477  50       Number Pallets
     C                     Z-ADD*ZERO     WN1478 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN1479  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN1480  70       Actual Arrival
     C                     Z-ADD*ZERO     WN1481  40       Actual Arrival
     C                     Z-ADD*ZERO     WN1482 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN1483 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN1484  70       Actual Departur
     C                     Z-ADD*ZERO     WN1485  40       Departure Time
     C                     Z-ADD*ZERO     WN1486  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN1487  52       Product Tempera
     C                     Z-ADD*ZERO     WN1488  50       Number Spacers
     C                     MOVEL*BLANK    WN1489 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN1490  70       Total Load Mile
     C                     MOVEL*BLANK    WN1491 12        Recorder ID
     C                     MOVEL*BLANK    WN1492  2        Shipping Method
     C                     MOVEL*BLANK    WN1493  3        Ship From Wareh
     C                     MOVEL*BLANK    WN1494  2        Ship To State C
     C                     Z-ADD*ZERO     WN1495  70       Gross Weight
     C                     MOVEL*BLANK    WN1496  1        Export Status
     C                     Z-ADD*ZERO     WN1497  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN1498  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN1499  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN1500  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN1501  70       Spotted Date
     C                     Z-ADD*ZERO     WN1502  60       Spotted Time
     C                     Z-ADD*ZERO     WN1503  70       Load Finished D
     C                     Z-ADD*ZERO     WN1504  60       Load Finished T
     C                     Z-ADD*ZERO     WN1505  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN1506  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN1507  70       BOL Received Da
     C                     Z-ADD*ZERO     WN1508  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN1509  70       Truck Departure
     C                     Z-ADD*ZERO     WN1510  60       Truck Departure
     C                     Z-ADD*ZERO     WN1511  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN1512  60       Adjusted Depart
     C                     MOVEL*BLANK    WN1513  3        Shipping Line
     C                     MOVEL*BLANK    WN1514 20        Port Delv Termi
     C                     MOVEL*BLANK    WN1515 30        Vessel Name
     C                     Z-ADD*ZERO     WN1516  50       Voyage
     C                     Z-ADD*ZERO     WN1517  70       Sail Date
     C                     MOVEL*BLANK    WN1518 12        Booking Number
     C                     MOVEL*BLANK    WN1519 20        Discharge Port
     C                     Z-ADD*ZERO     WN1520  70       Arrival Date
     C                     MOVEL*BLANK    WN1521 12        Container Numbe
     C                     Z-ADD*ZERO     WN1522  70       Date In
     C                     Z-ADD*ZERO     WN1523  60       Time In
     C                     Z-ADD*ZERO     WN1524  70       Date Out
     C                     Z-ADD*ZERO     WN1525  60       Time Out
     C                     Z-ADD*ZERO     WN1526 112       Load Total Frei
     C                     Z-ADD*ZERO     WN1527  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN1528  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN1529  1        LH Unused Sts
     C                     MOVEL*BLANK    WN1530  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN1531  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN1532  70       Requested Deliv
     C                     MOVEL*BLANK    WN1533  1        Load Acceptance
     C                     MOVEL*BLANK    WN1534  3        Warehouse Code
     C                     Z-ADD*ZERO     WN1535  70       On Yard Date
     C                     Z-ADD*ZERO     WN1536  60       On Yard Time
     C                     Z-ADD*ZERO     WN1537  70       Deadline Depart
     C                     Z-ADD*ZERO     WN1538  60       Deadline Depart
     C                     MOVEL*BLANK    WN1539  1        Load Held Over
     C                     MOVEL*BLANK    WN1540  1        Load Held Over
     C                     MOVEL*BLANK    WN1541 15        Load Held Over
     C                     MOVEL*BLANK    WN1542 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN1543 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN1544  70       Express Mail Da
     C                     MOVEL*BLANK    WN1545  1        Load Shag Flag
     C                     MOVEL*BLANK    WN1546  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN1547  70       Product Complet
     C                     Z-ADD*ZERO     WN1548  60       Product Complet
     C                     Z-ADD*ZERO     WN1549  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN1550  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN1551  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN1552  1        Load Confirmed
     C                     MOVEL*BLANK    WN1553 25        Load Confirmed
     C                     Z-ADD*ZERO     WN1554  70       Load Confirmati
     C                     Z-ADD*ZERO     WN1555  60       Load Door 1
     C                     Z-ADD*ZERO     WN1556  70       Override Total
     C                     Z-ADD*ZERO     WN1557  60       Load Door 2
     C                     MOVEL*BLANK    WN1558  1        Partial Load
     C                     MOVEL*BLANK    WN1559  1        Load Confirmati
     C                     MOVEL*BLANK    WN1560  1        Export Load USD
     C                     MOVEL*BLANK    WN1561  1        Late Delivery E
     C                     Z-ADD*ZERO     WN1562 112       Load Actual Fre
     C                     MOVEL*BLANK    WN1563 15        Hide on WW Load
     C                     MOVEL*BLANK    WN1564 15        Late Billing Em
     C                     MOVEL*BLANK    WN1565 25        Shipping Temp C
     C                     MOVEL*BLANK    WN1566 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN1567  1        Multi Company L
     C                     MOVEL*BLANK    WN1568  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN1569  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN1570  1        LH Power Only L
     C                     MOVEL*BLANK    WN1571  1        MG Created Load
     C                     MOVEL*BLANK    WN1572  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN1573  2        Load U/M
     C                     MOVEL*BLANK    WN1574  2        TPM Shipment St
     C                     MOVEL*BLANK    WN1575  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN1576  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN1577  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN1578  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN1579  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN1580  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN1581  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN1582  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN1583  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN1584  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN1585  60       LH Unused Time
     C                     Z-ADD*ZERO     WN1586  70       LH Unused Date
     C                     Z-ADD*ZERO     WN1587  60       LH Unused Time
     C                     Z-ADD*ZERO     WN1588  70       LH Unused Date
     C                     Z-ADD*ZERO     WN1589  60       LH Unused Time
     C                     MOVEL*BLANK    WN1590  1        EDI Status 1
     C                     MOVEL*BLANK    WN1591  1        EDI Status 2
     C                     MOVEL*BLANK    WN1592  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1593  60       Job Time
     C                     MOVEL*BLANK    WN1594 10        User Id
     C                     MOVEL*BLANK    WN1595 10        Job Name
     C                     Z-ADD*ZERO     WN1596  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YLRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWL0080    WDRMNB           Load ID
      *
     C           KLCHNZ    KLIST
     C                     KFLD           WDRMNB           Load ID
     C           KLCHNZ    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL012.
     C                     MOVEL'LBL012'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NZEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NZEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YLRDCS
      * Move non-key fields to @FJCPBO
     C                     MOVELWL0081    WDBZNA    P      Carrier Code
     C                     MOVELWL0082    WDRONB    P      Truck Size
     C                     MOVELWL0083    WDXCCD    P      Carrier Broker
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YLRDCS
     C           YLRDC     ANDNE'N'
     C                     MOVE 'Y'       YLRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##JOB     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YLRDCS
     C           YLRDC     ANDNE'N'
     C                     MOVE 'Y'       YLRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YLRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NZEXIT    ENDSR
      /EJECT
     CSR         OARVGN    BEGSR
      *================================================================
      * Rtv Carrier Dft      RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOA     KLIST
     C                     KFLD           WCAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0084    WCAJCD           Warehouse Code
      * Establish starting position
     C           KRSOA     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0085           Default Carrier
     C                     GOTO OAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCRNSX    WL0085           Default Carrier
     C                     ENDIF
      *================================================================
     CSR         OAEXIT    ENDSR
      /EJECT
     CSR         OBRVGN    BEGSR
      *================================================================
      * UPD Load Information   RT - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN1597  1        Header Status
     C                     MOVEL*BLANK    WN1598  1        Header Status L
     C                     Z-ADD*ZERO     WN1599 112       Order Weight To
     C                     MOVEL*BLANK    WN1600  1        Credit Hold
     C                     MOVEL*BLANK    WN1601  1        Production Hold
     C                     Z-ADD*ZERO     WN1602 112       Total Freight
     C                     Z-ADD*ZERO     WN1603  70       Total Load Orde
     C                     MOVEL*BLANK    WN1604  1        Affect Sales Do
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOB     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0086    WEAIC3           Company Number
     C                     Z-ADDWL0087    WEC4NB           Order Number
      * Establish starting position
     C           KRSOB     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * UPD Event: Ship Detail RT - Order Detail  * 
     C                     EXSR OCRVGN
      * Chg Load Information   CH - PD Order Header  * 
     C                     EXSR OECHRC
     C                     ENDIF
      *================================================================
     CSR         OBEXIT    ENDSR
      /EJECT
     CSR         OCRVGN    BEGSR
      *================================================================
      * UPD Event: Ship Detail RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQOC01           Company Number
     C           *LIKE     DEFN OMC4NB    WQOC02           Order Number
      * Define keylist
     C           KPSOC     KLIST
     C                     KFLD           WQOC01           Company Number
     C                     KFLD           WQOC02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSOC     KLIST
     C                     KFLD           WQOC01           Company Number
     C                     KFLD           WQOC02           Order Number
      * Setup key
     C                     Z-ADDWL0086    WQOC01           Company Number
     C                     Z-ADDWL0087    WQOC02           Order Number
     C                     Z-ADD*ZERO     OMDPNB           Order Sequence
     C                     Z-ADD*ZERO     OMUENB           Order Secondary
      * Establish starting position
     C           KPSOC     SETLL@BGWKAE                    *
     C           KRSOC     READE@BGWKAE                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Shipping Event     CH - PD Order Detail  * 
     C                     EXSR ODCHRC
     C           KRSOC     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         OCEXIT    ENDSR
      /EJECT
     CSR         ODCHRC    BEGSR
      *================================================================
      * CHG Shipping Event     CH - PD Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1605  70       Item Code
     C                     MOVEL*BLANK    WN1606  3        Warehouse Code
     C                     Z-ADD*ZERO     WN1607  70       Ship To Custome
     C                     Z-ADD*ZERO     WN1608  70       Order Group Cod
     C                     MOVEL*BLANK    WN1609  1        Detail Line Sta
     C                     MOVEL*BLANK    WN1610  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN1611 112       Billing Detail
     C                     Z-ADD*ZERO     WN1612 112       Billing Detail
     C                     Z-ADD*ZERO     WN1613 112       Billing Detail
     C                     Z-ADD*ZERO     WN1614 112       Quantity to Sub
     C                     MOVEL*BLANK    WN1615  1        Comment Print A
     C                     MOVEL*BLANK    WN1616  1        Comment Print I
     C                     MOVEL*BLANK    WN1617  1        Comment Print P
     C                     MOVEL*BLANK    WN1618  1        Comment Print S
     C                     Z-ADD*ZERO     WN1619 112       Extended Amount
     C                     Z-ADD*ZERO     WN1620  70       Market Pricing
     C                     MOVEL*BLANK    WN1621  3        Commodity Marke
     C                     MOVEL*BLANK    WN1622  3        Date Method Cod
     C                     MOVEL*BLANK    WN1623  3        Price Method Co
     C                     Z-ADD*ZERO     WN1624 114       Price Overage O
     C                     Z-ADD*ZERO     WN1625  70       Contract Number
     C                     MOVEL*BLANK    WN1626  1        Price Status
     C                     Z-ADD*ZERO     WN1627  70       Pricing Date Us
     C                     MOVEL*BLANK    WN1628  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN1629  2        U/M - Ordered
     C                     MOVEL*BLANK    WN1630  1        Work Confirm St
     C                     MOVEL*BLANK    WN1631  1        Work Over/Short
     C                     MOVEL*BLANK    WN1632  1        OD Production P
     C                     MOVEL*BLANK    WN1633 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN1634 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN1635  1        Age Code
     C                     MOVEL*BLANK    WN1636  1        Palletize
     C                     MOVEL*BLANK    WN1637  1        Slip Sheet
     C                     MOVEL*BLANK    WN1638  1        Catch Weight St
     C                     MOVEL*BLANK    WN1639  1        Price Audit
     C                     MOVEL*BLANK    WN1640  3        Price Audit Rea
     C                     MOVEL*BLANK    WN1641  1        Production Date
     C                     Z-ADD*ZERO     WN1642 112       Rated Freight
     C                     Z-ADD*ZERO     WN1643 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN1644 112       Weight Ordered
     C                     Z-ADD*ZERO     WN1645 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN1646 112       Weight Schedule
     C                     Z-ADD*ZERO     WN1647 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN1648 112       Weight Shipped
     C                     Z-ADD*ZERO     WN1649 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN1650 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN1651 114       Unit Price
     C                     Z-ADD*ZERO     WN1652 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN1653 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN1654 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN1655 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN1656  70       Requested Ship
     C                     Z-ADD*ZERO     WN1657  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN1658  70       Actual Shipped
     C                     MOVEL*BLANK    WN1659  1        Affect Inventor
     C                     MOVEL*BLANK    WN1660  1        Affect Sales Do
     C                     MOVEL*BLANK    WN1661  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN1662  30       Item Structure
     C                     Z-ADD*ZERO     WN1663  30       Item Structure
     C                     Z-ADD*ZERO     WN1664  30       Item Structure
     C                     MOVEL*BLANK    WN1665  2        Item Level
     C                     MOVEL*BLANK    WN1666  2        Quality Level
     C                     MOVEL*BLANK    WN1667  2        Pricing Product
     C                     MOVEL*BLANK    WN1668  2        Season Product
     C                     Z-ADD*ZERO     WN1669  70       Date of Origina
     C                     MOVEL*BLANK    WN1670 10        User Profile Na
     C                     MOVEL*BLANK    WN1671  6        Country Code
     C                     MOVEL*BLANK    WN1672  3        Reason Code
     C                     MOVEL*BLANK    WN1673  3        Sales Route Cod
     C                     MOVEL*BLANK    WN1674  1        Modified Flag
     C                     MOVEL*BLANK    WN1675  1        Substituted Fla
     C                     MOVEL*BLANK    WN1676  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN1677 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN1678 112       Invoice Extende
     C                     Z-ADD*ZERO     WN1679  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN1680  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN1681  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN1682  1        Affect Commissi
     C                     MOVEL*BLANK    WN1683  1        Affect Pricing
     C                     MOVEL*BLANK    WN1684  1        Released by Use
     C                     MOVEL*BLANK    WN1685  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN1686  2        OD Pallet Type
     C                     MOVEL*BLANK    WN1687  3        Production Ware
     C                     MOVEL*BLANK    WN1688  3        OD Price Type
     C                     Z-ADD*ZERO     WN1689  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN1690  70       Consumed Item C
     C                     Z-ADD*ZERO     WN1691  70       Deadline Depart
     C                     Z-ADD*ZERO     WN1692  70       OD Price Type R
     C                     Z-ADD*ZERO     WN1693  70       OD Firm Date
     C                     Z-ADD*ZERO     WN1694  60       Deadline Depart
     C                     Z-ADD*ZERO     WN1695  60       Price Code
     C                     Z-ADD*ZERO     WN1696  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN1697  60       Substitution Li
     C                     Z-ADD*ZERO     WN1698  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN1699 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN1700 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN1701 112       OD Item Target
     C                     Z-ADD*ZERO     WN1702 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN1703 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN1704 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN1705 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN1706 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN1707 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN1708 114       OD Original Ord
     C                     Z-ADD*ZERO     WN1709 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN1710 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN1711 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN1712  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN1713  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN1714  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN1715 112       Weight Amount E
     C                     Z-ADD*ZERO     WN1716  40       Item Age Days
     C                     Z-ADD*ZERO     WN1717  70       Production Ovr
     C                     Z-ADD*ZERO     WN1718  70       Production Ovr
     C                     MOVEL*BLANK    WN1719  1        OD Spot Buy
     C                     MOVEL*BLANK    WN1720  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN1721  3        Order Line Erro
     C                     Z-ADD*ZERO     WN1722  70       OD Market Begin
     C                     Z-ADD*ZERO     WN1723  70       OD Market Endin
     C                     Z-ADD*ZERO     WN1724  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN1725  1        EDI Status 1
     C                     MOVEL*BLANK    WN1726  1        EDI Status 2
     C                     MOVEL*BLANK    WN1727  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1728  60       Job Time
     C                     MOVEL*BLANK    WN1729 10        User Id
     C                     MOVEL*BLANK    WN1730 10        Job Name
     C                     Z-ADD*ZERO     WN1731  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YMRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDOMAIC3    WKAIC3           Company Number
     C                     Z-ADDOMC4NB    WKC4NB           Order Number
     C                     Z-ADDOMDPNB    WKDPNB           Order Sequence
     C                     Z-ADDOMUENB    WKUENB           Order Secondary
      *
     C           KLCHOD    KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKC4NB           Order Number
     C                     KFLD           WKDPNB           Order Sequence
     C                     KFLD           WKUENB           Order Secondary
     C           KLCHOD    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL013.
     C                     MOVEL'LBL013'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO ODEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO ODEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YMRDCS
      * Move non-key fields to @BGWKL0
     C                     MOVELWL0091    WKJPCD    P      Event Code
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YMRDCS
     C           YMRDC     ANDNE'N'
     C                     MOVE 'Y'       YMRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WKAATM           Job Time
     C                     MOVEL##USR     WKAYNA           User Id
     C                     MOVEL##JOB     WKA0NA           Job Name
     C                     Z-ADD##JDT     WKAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YMRDCS
     C           YMRDC     ANDNE'N'
     C                     MOVE 'Y'       YMRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YMRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         ODEXIT    ENDSR
      /EJECT
     CSR         OECHRC    BEGSR
      *================================================================
      * Chg Load Information   CH - PD Order Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN1732  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN1733  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN1734  70       Ship To Custome
     C                     MOVEL*BLANK    WN1735 30        Ship To Name
     C                     MOVEL*BLANK    WN1736 30        Ship To Address
     C                     MOVEL*BLANK    WN1737 30        Ship To Address
     C                     MOVEL*BLANK    WN1738 30        Ship To Address
     C                     MOVEL*BLANK    WN1739 20        Ship To City
     C                     MOVEL*BLANK    WN1740  2        Ship To State C
     C                     MOVEL*BLANK    WN1741 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN1742  70       Bill to Custome
     C                     MOVEL*BLANK    WN1743 30        Bill to Name
     C                     MOVEL*BLANK    WN1744 30        Bill to Address
     C                     MOVEL*BLANK    WN1745 30        Bill to Address
     C                     MOVEL*BLANK    WN1746 30        Bill to Address
     C                     MOVEL*BLANK    WN1747 20        Bill to City
     C                     MOVEL*BLANK    WN1748  2        Bill to State C
     C                     MOVEL*BLANK    WN1749 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN1750 15        Customer Purcha
     C                     Z-ADD*ZERO     WN1751  70       Order Date
     C                     Z-ADD*ZERO     WN1752  70       Requested Ship
     C                     Z-ADD*ZERO     WN1753  70       Actual Shipped
     C                     Z-ADD*ZERO     WN1754  70       Cancel Date
     C                     MOVEL*BLANK    WN1755  2        Terms Code
     C                     MOVEL*BLANK    WN1756 40        Special Instruc
     C                     MOVEL*BLANK    WN1757 40        Special Instruc
     C                     MOVEL*BLANK    WN1758  1        Comment Print A
     C                     MOVEL*BLANK    WN1759  1        Comment Print I
     C                     MOVEL*BLANK    WN1760  1        Comment Print P
     C                     MOVEL*BLANK    WN1761  1        Comment Print S
     C                     MOVEL*BLANK    WN1762  3        Reason Code
     C                     MOVEL*BLANK    WN1763  1        Order in Use
     C                     MOVEL*BLANK    WN1764  1        Header Status
     C                     MOVEL*BLANK    WN1765  1        Header Status L
     C                     MOVEL*BLANK    WN1766  1        Order Type Prin
     C                     Z-ADD*ZERO     WN1767  70       Scheduled Ship
     C                     MOVEL*BLANK    WN1768 10        User Original E
     C                     Z-ADD*ZERO     WN1769  70       Date of Origina
     C                     Z-ADD*ZERO     WN1770 112       Order Value Tot
     C                     Z-ADD*ZERO     WN1771 112       Order Weight To
     C                     MOVEL*BLANK    WN1772  1        Credit Hold
     C                     MOVEL*BLANK    WN1773  1        Production Hold
     C                     MOVEL*BLANK    WN1774  1        New Customer Ho
     C                     Z-ADD*ZERO     WN1775  70       Requested Deliv
     C                     Z-ADD*ZERO     WN1776  40       Requested Deliv
     C                     MOVEL*BLANK    WN1777  4        Accounts Receiv
     C                     MOVEL*BLANK    WN1778 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN1779  52       Absorbed Freigh
     C                     MOVEL*BLANK    WN1780  1        LTL Flag
     C                     MOVEL*BLANK    WN1781  1        Price Audit
     C                     MOVEL*BLANK    WN1782  1        Price Status
     C                     MOVEL*BLANK    WN1783  2        Shipping Method
     C                     MOVEL*BLANK    WN1784  1        Export Status
     C                     MOVEL*BLANK    WN1785  1        Palletize
     C                     MOVEL*BLANK    WN1786  1        Shrink Wrap
     C                     MOVEL*BLANK    WN1787  1        Slip Sheet
     C                     MOVEL*BLANK    WN1788  1        Age Code
     C                     Z-ADD*ZERO     WN1789  52       Reefer Temperat
     C                     MOVEL*BLANK    WN1790  1        Load Type
     C                     Z-ADD*ZERO     WN1791  70       Attach to Invoi
     C                     MOVEL*BLANK    WN1792  1        Load Plan Order
     C                     MOVEL*BLANK    WN1793  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN1794  70       Resell Referenc
     C                     MOVEL*BLANK    WN1795 30        Special Comment
     C                     MOVEL*BLANK    WN1796 30        Special Comment
     C                     MOVEL*BLANK    WN1797  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN1798  3        Sales Route Cod
     C                     MOVEL*BLANK    WN1799  2        Manager Level C
     C                     MOVEL*BLANK    WN1800  3        VP Level Code
     C                     Z-ADD*ZERO     WN1801  70       Attach to Order
     C                     MOVEL*BLANK    WN1802  3        Reason for Pric
     C                     Z-ADD*ZERO     WN1803  70       Invoice Number
     C                     MOVEL*BLANK    WN1804  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN1805  70       Invoice Date
     C                     MOVEL*BLANK    WN1806  1        Trans Contol AS
     C                     MOVEL*BLANK    WN1807  1        Modified Flag
     C                     Z-ADD*ZERO     WN1808 112       A/R order Value
     C                     MOVEL*BLANK    WN1809  1        Billing Activit
     C                     MOVEL*BLANK    WN1810  1        Block Order Fla
     C                     MOVEL*BLANK    WN1811  1        Order Certifica
     C                     Z-ADD*ZERO     WN1812 112       Invoice Order V
     C                     MOVEL*BLANK    WN1813  1        Process Sts for
     C                     MOVEL*BLANK    WN1814  1        Order Conf Fax
     C                     MOVEL*BLANK    WN1815  1        Manifest Fax St
     C                     MOVEL*BLANK    WN1816  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN1817  1        Transfer in Sto
     C                     MOVEL*BLANK    WN1818  1        Email Cust On O
     C                     MOVEL*BLANK    WN1819  1        Order Emailed
     C                     MOVEL*BLANK    WN1820  1        Export Docs Go
     C                     MOVEL*BLANK    WN1821  1        Shipping Temp C
     C                     MOVEL*BLANK    WN1822  1        Broker Order St
     C                     MOVEL*BLANK    WN1823  1        Air Freight Ord
     C                     MOVEL*BLANK    WN1824  2        Order Requires
     C                     MOVEL*BLANK    WN1825  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN1826  2        Export USDA App
     C                     MOVEL*BLANK    WN1827  3        HPB Ship to War
     C                     MOVEL*BLANK    WN1828  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN1829  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN1830  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN1831  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN1832  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN1833  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN1834  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN1835  60       Time of Origina
     C                     Z-ADD*ZERO     WN1836  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN1837  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN1838  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN1839 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN1840 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN1841 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN1842 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN1843 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN1844  70       Claim Number
     C                     MOVEL*BLANK    WN1845  1        EDI Status 1
     C                     MOVEL*BLANK    WN1846  1        EDI Status 2
     C                     MOVEL*BLANK    WN1847  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1848  60       Job Time
     C                     MOVEL*BLANK    WN1849 10        User Id
     C                     MOVEL*BLANK    WN1850 10        Job Name
     C                     Z-ADD*ZERO     WN1851  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YNRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWL0086    WLAIC3           Company Number
     C                     Z-ADDWL0087    WLC4NB           Order Number
      *
     C           KLCHOE    KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLC4NB           Order Number
     C           KLCHOE    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL014.
     C                     MOVEL'LBL014'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YNRDCS
      * Move non-key fields to @BECPFJ
     C                     MOVELWL0088    WLBZNA    P      Carrier Code
     C                     Z-ADDWL0089    WLRMNB           Load ID
     C                     Z-ADDWL0090    WLR1NB           Rated Freight
     C                     MOVELWL0091    WLJPCD    P      Event Code
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YNRDCS
     C           YNRDC     ANDNE'N'
     C                     MOVE 'Y'       YNRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WLAATM           Job Time
     C                     MOVEL##USR     WLAYNA           User Id
     C                     MOVEL##PGM     WLA0NA           Job Name
     C                     Z-ADD##JDT     WLAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPCRC
     C                     Z-ADDWLAIC3    PCAIC3           Company Number
     C                     Z-ADDWLC4NB    PCC4NB           Order Number
     C                     MOVELWLJNCD    PCJNCD    P      Order Type - Sa
     C                     Z-ADDWLANC7    PCANC7           A/R Customer Nu
     C                     Z-ADDWLBKC7    PCBKC7           Ship To Custome
     C                     MOVELWLBRTX    PCBRTX    P      Ship To Name
     C                     MOVELWLHMNA    PCHMNA    P      Ship To Address
     C                     MOVELWLHONA    PCHONA    P      Ship To Address
     C                     MOVELWLHPNA    PCHPNA    P      Ship To Address
     C                     MOVELWLHNNA    PCHNNA    P      Ship To City
     C                     MOVELWLDBCD    PCDBCD    P      Ship To State C
     C                     MOVELWLCKTX    PCCKTX    P      Ship To Zip/Pos
     C                     Z-ADDWLB0C7    PCB0C7           Bill to Custome
     C                     MOVELWLAETX    PCAETX    P      Bill to Name
     C                     MOVELWLB1NA    PCB1NA    P      Bill to Address
     C                     MOVELWLB3NA    PCB3NA    P      Bill to Address
     C                     MOVELWLB4NA    PCB4NA    P      Bill to Address
     C                     MOVELWLB2NA    PCB2NA    P      Bill to City
     C                     MOVELWLBHCD    PCBHCD    P      Bill to State C
     C                     MOVELWLC8TX    PCC8TX    P      Bill to Zip/Pos
     C                     MOVELWLBCNA    PCBCNA    P      Customer Purcha
     C                     Z-ADDWLA0DT    PCA0DT           Order Date
     C                     Z-ADDWLA5DT    PCA5DT           Requested Ship
     C                     Z-ADDWLGNDT    PCGNDT           Actual Shipped
     C                     Z-ADDWLACDT    PCACDT           Cancel Date
     C                     MOVELWLAQCD    PCAQCD    P      Terms Code
     C                     MOVELWLB6NA    PCB6NA    P      Special Instruc
     C                     MOVELWLBYNA    PCBYNA    P      Special Instruc
     C                     MOVELWLBZNA    PCBZNA    P      Carrier Code
     C                     MOVELWLGTST    PCGTST    P      Comment Print A
     C                     MOVELWLGVST    PCGVST    P      Comment Print I
     C                     MOVELWLGUST    PCGUST    P      Comment Print P
     C                     MOVELWLQFST    PCQFST    P      Comment Print S
     C                     MOVELWLCQCD    PCCQCD    P      Reason Code
     C                     MOVELWLGJST    PCGJST    P      Order in Use
     C                     MOVELWLGWST    PCGWST    P      Header Status
     C                     MOVELWLGXST    PCGXST    P      Header Status L
     C                     MOVELWLGYST    PCGYST    P      Order Type Prin
     C                     Z-ADDWLAODT    PCAODT           Scheduled Ship
     C                     MOVELWLAIVN    PCAIVN    P      User Original E
     C                     Z-ADDWLCXDT    PCCXDT           Date of Origina
     C                     Z-ADDWLJZVA    PCJZVA           Order Value Tot
     C                     Z-ADDWLA1WG    PCA1WG           Order Weight To
     C                     MOVELWLXIST    PCXIST    P      Credit Hold
     C                     MOVELWLXJST    PCXJST    P      Production Hold
     C                     MOVELWLXKST    PCXKST    P      New Customer Ho
     C                     Z-ADDWLEIDT    PCEIDT           Requested Deliv
     C                     Z-ADDWLAFTM    PCAFTM           Requested Deliv
     C                     MOVELWLE8CD    PCE8CD    P      Accounts Receiv
     C                     MOVELWLE9CD    PCE9CD    P      Accounts Receiv
     C                     Z-ADDWLRMNB    PCRMNB           Load ID
     C                     Z-ADDWLTBNB    PCTBNB           Absorbed Freigh
     C                     Z-ADDWLR1NB    PCR1NB           Rated Freight
     C                     MOVELWLPJST    PCPJST    P      LTL Flag
     C                     MOVELWLU0ST    PCU0ST    P      Price Audit
     C                     MOVELWLU1ST    PCU1ST    P      Price Status
     C                     MOVELWLQ2CD    PCQ2CD    P      Shipping Method
     C                     MOVELWLU2ST    PCU2ST    P      Export Status
     C                     MOVELWLVEST    PCVEST    P      Palletize
     C                     MOVELWLVFST    PCVFST    P      Shrink Wrap
     C                     MOVELWLVGST    PCVGST    P      Slip Sheet
     C                     MOVELWLRPCD    PCRPCD    P      Age Code
     C                     Z-ADDWLRNNB    PCRNNB           Reefer Temperat
     C                     MOVELWLVDST    PCVDST    P      Load Type
     C                     Z-ADDWLATIN    PCATIN           Attach to Invoi
     C                     MOVELWLU4ST    PCU4ST    P      Load Plan Order
     C                     MOVELWLU5ST    PCU5ST    P      Print Pick Slip
     C                     Z-ADDWLRSRN    PCRSRN           Resell Referenc
     C                     MOVELWLMHNA    PCMHNA    P      Special Comment
     C                     MOVELWLMINA    PCMINA    P      Special Comment
     C                     MOVELWLWBST    PCWBST    P      Affect Auto Acc
     C                     MOVELWLR4CD    PCR4CD    P      Sales Route Cod
     C                     MOVELWLBFCD    PCBFCD    P      Manager Level C
     C                     MOVELWLQ4CD    PCQ4CD    P      VP Level Code
     C                     Z-ADDWLT3NB    PCT3NB           Attach to Order
     C                     MOVELWLSICD    PCSICD    P      Reason for Pric
     C                     Z-ADDWLCONB    PCCONB           Invoice Number
     C                     MOVELWLCEST    PCCEST    P      Invoice Suffix
     C                     Z-ADDWLAWDT    PCAWDT           Invoice Date
     C                     MOVELWLJPCD    PCJPCD    P      Event Code
     C                     MOVELWLXUST    PCXUST    P      Trans Contol AS
     C                     MOVELWLZ1ST    PCZ1ST    P      Modified Flag
     C                     Z-ADDWLVRVA    PCVRVA           A/R order Value
     C                     MOVELWLOBST    PCOBST    P      Billing Activit
     C                     MOVELWLBCST    PCBCST    P      Block Order Fla
     C                     MOVELWLBDST    PCBDST    P      Order Certifica
     C                     Z-ADDWLB7VL    PCB7VL           Invoice Order V
     C                     MOVELWLGASX    PCGASX    P      Process Sts for
     C                     MOVELWLGBSX    PCGBSX    P      Order Conf Fax
     C                     MOVELWLGCSX    PCGCSX    P      Manifest Fax St
     C                     MOVELWLGDSX    PCGDSX    P      Invoice Fax Sts
     C                     MOVELWLFNSX    PCFNSX    P      Transfer in Sto
     C                     MOVELWLFOSX    PCFOSX    P      Email Cust On O
     C                     MOVELWLFPSX    PCFPSX    P      Order Emailed
     C                     MOVELWLFQSX    PCFQSX    P      Export Docs Go
     C                     MOVELWLFRSX    PCFRSX    P      Shipping Temp C
     C                     MOVELWLFSSX    PCFSSX    P      Broker Order St
     C                     MOVELWLFTSX    PCFTSX    P      Air Freight Ord
     C                     MOVELWLFUSX    PCFUSX    P      Order Requires
     C                     MOVELWLFVSX    PCFVSX    P      OH Load Plan Re
     C                     MOVELWLFWSX    PCFWSX    P      Export USDA App
     C                     MOVELWLFXSX    PCFXSX    P      HPB Ship to War
     C                     MOVELWLFYSX    PCFYSX    P      OH TF Exempt Co
     C                     Z-ADDWLNODT    PCNODT           OH Appt Confirm
     C                     Z-ADDWLNPDT    PCNPDT           JPN Invoice Iss
     C                     Z-ADDWLNQDT    PCNQDT           Load Actual Shi
     C                     Z-ADDWLNRDT    PCNRDT           Load BOL Comple
     C                     Z-ADDWLNSDT    PCNSDT           Load Truck Depa
     C                     Z-ADDWLBPTM    PCBPTM           Maximum Gross W
     C                     Z-ADDWLBQTM    PCBQTM           Time of Origina
     C                     Z-ADDWLBRTM    PCBRTM           OH Appt Confirm
     C                     Z-ADDWLBSTM    PCBSTM           Load BOL Comple
     C                     Z-ADDWLBTTM    PCBTTM           Load Truck Depa
     C                     Z-ADDWLH0NX    PCH0NX           Act Frt Referen
     C                     Z-ADDWLH1NX    PCH1NX           Act Non-Ref Frt
     C                     Z-ADDWLH2NX    PCH2NX           OH Fuel Surchar
     C                     Z-ADDWLH3NX    PCH3NX           OH Total Non-Re
     C                     Z-ADDWLH4NX    PCH4NX           OH Total Ref Fr
     C                     Z-ADDWLC0C7    PCC0C7           Claim Number
     C                     MOVELWLUVST    PCUVST    P      EDI Status 1
     C                     MOVELWLUWST    PCUWST    P      EDI Status 2
     C                     MOVELWLUXST    PCUXST    P      EDI Status 3
     C                     Z-ADDWLAATM    PCAATM           Job Time
     C                     MOVELWLAYNA    PCAYNA    P      User Id
     C                     MOVELWLA0NA    PCA0NA    P      Job Name
     C                     Z-ADDWLAXDT    PCAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YNRDCS
     C           YNRDC     ANDNE'N'
     C                     MOVE 'Y'       YNRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YNRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         OEEXIT    ENDSR
      /EJECT
     CSR         OFRVGN    BEGSR
      *================================================================
      * RTV 1st Export Order   RT - Load Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1852  70       Ship To Custome
     C                     MOVEL*BLANK    WN1853  1        Export Status
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIRMNB    WQOF02           Load ID
      * Define keylist
     C           KPSOF     KLIST
     C                     KFLD           WQOF02           Load ID
     C                     KFLD           WIRVNB           Stop/Drop
      * Define keylist
     C           KRSOF     KLIST
     C                     KFLD           WQOF02           Load ID
      * Setup key
     C                     Z-ADDWL0092    WQOF02           Load ID
     C                     Z-ADDWL0093    WIRVNB           Stop/Drop
      * Establish starting position
     C           KPSOF     SETLL@FLCPEB                    *
     C           KRSOF     READE@FLCPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0094           Order Number
     C                     Z-ADD*ZERO     WL0095           MPC Number
     C                     Z-ADD*ZERO     WN1852           Ship To Custome
     C                     MOVEL*BLANK    WN1853           Export Status
     C                     GOTO OFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * *** If Export Order, then Stop Search and Return Order #
      * RTV Exprt Sts/ShipCust RT - PD Order Header  * 
     C                     EXSR OGRVGN
      * CASE: PAR.Export Status is yes
     C           WN1853    IFEQ 'Y'                        *IF
      * PAR = DB1 By name
     C                     Z-ADDWIC4NB    WL0094           Order Number
     C                     Z-ADDWIZ4NB    WL0095           MPC Number
     C                     GOTO OFEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0094           Order Number
     C                     Z-ADD*ZERO     WL0095           MPC Number
     C                     Z-ADD*ZERO     WN1852           Ship To Custome
     C                     MOVEL*BLANK    WN1853           Export Status
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     END                             *FI
     C           KRSOF     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         OFEXIT    ENDSR
      /EJECT
     CSR         OGRVGN    BEGSR
      *================================================================
      * RTV Exprt Sts/ShipCust RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOG     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
      * Setup key
     C                     Z-ADDWIAIC3    WEAIC3           Company Number
     C                     Z-ADDWIC4NB    WEC4NB           Order Number
      * Establish starting position
     C           KRSOG     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN1852           Ship To Custome
     C                     MOVEL*BLANK    WN1853           Export Status
     C                     GOTO OGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWEBKC7    WN1852           Ship To Custome
     C                     MOVELWEU2ST    WN1853           Export Status
     C                     ENDIF
      *================================================================
     CSR         OGEXIT    ENDSR
      /EJECT
     CSR         OHRVGN    BEGSR
      *================================================================
      * Rtv Min Temp Ld,shiptoRT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
     C                     Z-ADD-99       WL0099           USR Temperature
     C                     MOVELWUOTTX    WL0098           Shipping Temp C
      * Declare restrictor key work fields
     C           *LIKE     DEFN WARMNB    WQOH02           Load ID
      * Define keylist
     C           KRSOH     KLIST
     C                     KFLD           WQOH02           Load ID
      * Setup key
     C                     Z-ADDWL0097    WQOH02           Load ID
      * Establish starting position
     C           KRSOH     SETLL@BFCPD9                    *
     C           KRSOH     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * **** new 7/19/02
      * If db1 doesnt match par, convert db1 temp to par temp C or F
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Shipping Temp Code C/F NE WRK.Blank for 4
      *   |- c2    : PAR.Shipping Temp Code C/F NE DB1.Shipping Temp Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0098    IFNE WUOTTX                     *IF
     C           WL0098    IFNE WAFRSX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: PAR.Shipping Temp Code C/F is Celsius
     C           WL0098    IFEQ 'C'                        *IF
      * Convert DB1 to Celsius
      * Compute Cels from Fahr
      * LCL.USR Temperature 3.1 =
      *    *COMPUTE (((x1 - x2) * x3) / x4)
      * x1    : DB1.Reefer Temperature
      * -     : PGM.*Synon (17,7) work field
      * x2    : CON.32
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.5
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x4    : CON.9
     C           WARNNB    SUB  32        W0WD02           *Synon (17,7) w
     C           W0WD02    MULT 5         W0WD01           *Synon (17,7) w
     C           W0WD01    DIV  9         W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0072           USR Temperature
     C                     ELSE
      * CASE: *OTHERWISE
      * Convert DB1 to Fahr
      * Compute Fahr from Cels
      * LCL.USR Temperature 3.1 =
      *    *COMPUTE (((x1 * x3) / x4) + x2)
      * x1    : DB1.Reefer Temperature
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.9
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x4    : CON.5
      * +     : PGM.*Synon (17,7) work field
      * x2    : CON.32
     C           WARNNB    MULT 9         W0WD02           *Synon (17,7) w
     C           W0WD02    DIV  5         W0WD01    H      *Synon (17,7) w
     C           W0WD01    ADD  32        W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0072           USR Temperature
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWARNNB    YL0072           USR Temperature
     C                     END                             *FI
      * CASE: LCL.USR Temperature 3.1 GT PAR.USR Temperature 3.1
     C           YL0072    IFGT WL0099                     *IF
     C                     Z-ADDWARNNB    WL0099           USR Temperature
     C                     MOVELWAFRSX    WL0098           Shipping Temp C
     C                     END                             *FI
      * Output 1st Ship to city for Discharge Port   2/13/04    RMC
      * CASE: DB1.Export Status is yes
     C           WAU2ST    IFEQ 'Y'                        *IF
      * CASE: DB1.Order Number EQ PAR.Order Number Saved USR
     C           WAC4NB    IFEQ WL0100                     *IF
     C                     MOVELWAHNNA    WL0096           Ship To City
     C                     END                             *FI
     C                     END                             *FI
     C           KRSOH     READE@BFCPD9                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: PAR.USR Temperature 3.1 is Low
     C           WL0099    IFEQ -99                        *IF
     C                     Z-ADD*ZERO     WL0099           USR Temperature
     C                     END                             *FI
      *================================================================
     CSR         OHEXIT    ENDSR
      /EJECT
     CSR         OIRVGN    BEGSR
      *================================================================
      * Rtv 1st Ord Delv Date RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIRMNB    WQOI02           Load ID
      * Define keylist
     C           KPSOI     KLIST
     C                     KFLD           WQOI02           Load ID
     C                     KFLD           WIRVNB           Stop/Drop
      * Define keylist
     C           KRSOI     KLIST
     C                     KFLD           WQOI02           Load ID
      * Setup key
     C                     Z-ADDWL0101    WQOI02           Load ID
     C                     Z-ADDWL0102    WIRVNB           Stop/Drop
      * Establish starting position
     C           KPSOI     SETLL@FLCPEB                    *
     C           KRSOI     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Delivery Date     RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWIAIC3    WL0027           Company Number
     C                     Z-ADDWIC4NB    WL0028           Order Number
     C                     EXSR TBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0029    WL0103           Requested Deliv
     C                     GOTO OIEXIT                     *QUIT
     C           KRSOI     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         OIEXIT    ENDSR
      /EJECT
     CSR         OJCHRC    BEGSR
      *================================================================
      * CHG Temp & Req Dlv Dte CH - Load Header  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1854  30       Company Number
     C                     MOVEL*BLANK    WN1855  1        LTL Flag
     C                     MOVEL*BLANK    WN1856  1        Load Status
     C                     MOVEL*BLANK    WN1857 15        Seal 1
     C                     MOVEL*BLANK    WN1858 15        Seal 2
     C                     MOVEL*BLANK    WN1859 15        Seal 3
     C                     MOVEL*BLANK    WN1860 15        Seal 4
     C                     MOVEL*BLANK    WN1861 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN1862  70       Total Load Orde
     C                     Z-ADD*ZERO     WN1863 112       Flat Amount
     C                     MOVEL*BLANK    WN1864  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN1865  50       Total Stops
     C                     MOVEL*BLANK    WN1866 20        Trailer Id
     C                     MOVEL*BLANK    WN1867  3        Transloader Car
     C                     Z-ADD*ZERO     WN1868  40       BOL Time
     C                     MOVEL*BLANK    WN1869  3        Carrier Code
     C                     MOVEL*BLANK    WN1870  7        Truck Size
     C                     Z-ADD*ZERO     WN1871  70       Ld Hdr/Ld Dtl U
     C                     MOVEL*BLANK    WN1872  1        Ship Status
     C                     MOVEL*BLANK    WN1873  1        Load Type
     C                     Z-ADD*ZERO     WN1874  50       Number Pallets
     C                     Z-ADD*ZERO     WN1875  50       Number Pallets
     C                     Z-ADD*ZERO     WN1876 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN1877  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN1878  70       Actual Arrival
     C                     Z-ADD*ZERO     WN1879  40       Actual Arrival
     C                     Z-ADD*ZERO     WN1880 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN1881 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN1882  70       Actual Departur
     C                     Z-ADD*ZERO     WN1883  40       Departure Time
     C                     Z-ADD*ZERO     WN1884  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN1885  52       Product Tempera
     C                     Z-ADD*ZERO     WN1886  50       Number Spacers
     C                     MOVEL*BLANK    WN1887 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN1888  70       Total Load Mile
     C                     MOVEL*BLANK    WN1889 12        Recorder ID
     C                     MOVEL*BLANK    WN1890  2        Shipping Method
     C                     MOVEL*BLANK    WN1891  3        Ship From Wareh
     C                     MOVEL*BLANK    WN1892  2        Ship To State C
     C                     Z-ADD*ZERO     WN1893  70       Gross Weight
     C                     MOVEL*BLANK    WN1894  3        Carrier Broker
     C                     MOVEL*BLANK    WN1895  1        Export Status
     C                     Z-ADD*ZERO     WN1896  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN1897  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN1898  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN1899  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN1900  70       Spotted Date
     C                     Z-ADD*ZERO     WN1901  60       Spotted Time
     C                     Z-ADD*ZERO     WN1902  70       Load Finished D
     C                     Z-ADD*ZERO     WN1903  60       Load Finished T
     C                     Z-ADD*ZERO     WN1904  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN1905  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN1906  70       BOL Received Da
     C                     Z-ADD*ZERO     WN1907  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN1908  70       Truck Departure
     C                     Z-ADD*ZERO     WN1909  60       Truck Departure
     C                     Z-ADD*ZERO     WN1910  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN1911  60       Adjusted Depart
     C                     MOVEL*BLANK    WN1912  3        Shipping Line
     C                     MOVEL*BLANK    WN1913 20        Port Delv Termi
     C                     MOVEL*BLANK    WN1914 30        Vessel Name
     C                     Z-ADD*ZERO     WN1915  50       Voyage
     C                     Z-ADD*ZERO     WN1916  70       Sail Date
     C                     MOVEL*BLANK    WN1917 12        Booking Number
     C                     MOVEL*BLANK    WN1918 20        Discharge Port
     C                     Z-ADD*ZERO     WN1919  70       Arrival Date
     C                     MOVEL*BLANK    WN1920 12        Container Numbe
     C                     Z-ADD*ZERO     WN1921  70       Date In
     C                     Z-ADD*ZERO     WN1922  60       Time In
     C                     Z-ADD*ZERO     WN1923  70       Date Out
     C                     Z-ADD*ZERO     WN1924  60       Time Out
     C                     Z-ADD*ZERO     WN1925 112       Load Total Frei
     C                     Z-ADD*ZERO     WN1926  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN1927  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN1928  1        LH Unused Sts
     C                     MOVEL*BLANK    WN1929  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN1930  70       Bring Back Mile
     C                     MOVEL*BLANK    WN1931  1        Load Acceptance
     C                     MOVEL*BLANK    WN1932  3        Warehouse Code
     C                     Z-ADD*ZERO     WN1933  70       On Yard Date
     C                     Z-ADD*ZERO     WN1934  60       On Yard Time
     C                     Z-ADD*ZERO     WN1935  70       Deadline Depart
     C                     Z-ADD*ZERO     WN1936  60       Deadline Depart
     C                     MOVEL*BLANK    WN1937  1        Load Held Over
     C                     MOVEL*BLANK    WN1938  1        Load Held Over
     C                     MOVEL*BLANK    WN1939 15        Load Held Over
     C                     MOVEL*BLANK    WN1940 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN1941 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN1942  70       Express Mail Da
     C                     MOVEL*BLANK    WN1943  1        Load Shag Flag
     C                     MOVEL*BLANK    WN1944  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN1945  70       Product Complet
     C                     Z-ADD*ZERO     WN1946  60       Product Complet
     C                     Z-ADD*ZERO     WN1947  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN1948  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN1949  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN1950  1        Load Confirmed
     C                     MOVEL*BLANK    WN1951 25        Load Confirmed
     C                     Z-ADD*ZERO     WN1952  70       Load Confirmati
     C                     Z-ADD*ZERO     WN1953  60       Load Door 1
     C                     Z-ADD*ZERO     WN1954  70       Override Total
     C                     Z-ADD*ZERO     WN1955  60       Load Door 2
     C                     MOVEL*BLANK    WN1956  1        Partial Load
     C                     MOVEL*BLANK    WN1957  1        Load Confirmati
     C                     MOVEL*BLANK    WN1958  1        Export Load USD
     C                     MOVEL*BLANK    WN1959  1        Late Delivery E
     C                     Z-ADD*ZERO     WN1960 112       Load Actual Fre
     C                     MOVEL*BLANK    WN1961 15        Hide on WW Load
     C                     MOVEL*BLANK    WN1962 15        Late Billing Em
     C                     MOVEL*BLANK    WN1963 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN1964  1        Multi Company L
     C                     MOVEL*BLANK    WN1965  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN1966  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN1967  1        LH Power Only L
     C                     MOVEL*BLANK    WN1968  1        MG Created Load
     C                     MOVEL*BLANK    WN1969  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN1970  2        Load U/M
     C                     MOVEL*BLANK    WN1971  2        TPM Shipment St
     C                     MOVEL*BLANK    WN1972  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN1973  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN1974  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN1975  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN1976  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN1977  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN1978  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN1979  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN1980  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN1981  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN1982  60       LH Unused Time
     C                     Z-ADD*ZERO     WN1983  70       LH Unused Date
     C                     Z-ADD*ZERO     WN1984  60       LH Unused Time
     C                     Z-ADD*ZERO     WN1985  70       LH Unused Date
     C                     Z-ADD*ZERO     WN1986  60       LH Unused Time
     C                     MOVEL*BLANK    WN1987  1        EDI Status 1
     C                     MOVEL*BLANK    WN1988  1        EDI Status 2
     C                     MOVEL*BLANK    WN1989  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1990  60       Job Time
     C                     MOVEL*BLANK    WN1991 10        User Id
     C                     MOVEL*BLANK    WN1992 10        Job Name
     C                     Z-ADD*ZERO     WN1993  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YORDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWL0104    WDRMNB           Load ID
      *
     C           KLCHOJ    KLIST
     C                     KFLD           WDRMNB           Load ID
     C           KLCHOJ    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL015.
     C                     MOVEL'LBL015'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YORDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDWL0105    WDAODT           Scheduled Ship
     C                     Z-ADDWL0106    WDRNNB           Reefer Temperat
     C                     Z-ADDWL0107    WDR1NB           Rated Freight
     C                     Z-ADDWL0108    WDEIDT           Requested Deliv
     C                     MOVELWL0109    WDWRTX    P      Shipping Temp C
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YORDCS
     C           YORDC     ANDNE'N'
     C                     MOVE 'Y'       YORDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##JOB     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YORDCS
     C           YORDC     ANDNE'N'
     C                     MOVE 'Y'       YORDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YORDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         OJEXIT    ENDSR
      /EJECT
     CSR         OKRVGN    BEGSR
      *================================================================
      * Crt Load Plan Event    RT - Order Events  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1994  50       Event Number
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WN1994           Event Number
      * RTV Latest Event/Date  RT - OP Order Events  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0110           Company Number
     C                     Z-ADD#1C4NB    WL0111           Order Number
     C                     Z-ADDWN1994    WL0112           Event Number
     C                     Z-ADDWUNFNN    WL0116           Ship To Custome
     C                     EXSR OLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0112    WN1994           Event Number
     C                     MOVELWL0113    WUG0TX    P      Event Code
     C                     Z-ADDWL0114    WUNFNN           Event Date
     C                     MOVELWL0115    WUG0TX    P      Activity Hold
      * Declare restrictor key work fields
     C           *LIKE     DEFN WSAIC3    WQOK01           Company Number
     C           *LIKE     DEFN WSC4NB    WQOK02           Order Number
      * Define keylist
     C           KRSOK     KLIST
     C                     KFLD           WQOK01           Company Number
     C                     KFLD           WQOK02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQOK01           Company Number
     C                     Z-ADD#1C4NB    WQOK02           Order Number
      * Establish starting position
     C           KRSOK     SETLL@EYCPY2                    *
     C           KRSOK     READE@EYCPY2                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1074' W0RTN   7
      * USER: Processing if Data record not found
     C                     ADD  1         WUQ2NB           Event Number
      * CRT OP Order Events    CR - Order Events  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0117           Company Number
     C                     Z-ADD#1C4NB    WL0118           Order Number
     C                     Z-ADDWUQ2NB    WL0119           Event Number
     C                     MOVEL'01'      WL0120    P      Event Code
     C                     Z-ADD#1AIC3    WL0121           Invoice/Memo Co
     C                     Z-ADD*ZERO     WL0122           Invoice/Memo Nu
     C                     MOVEL*BLANK    WL0123           Invoice/Memo Su
     C                     Z-ADD##JDT     WL0124           Event Date
     C                     MOVEL'Y'       WL0125    P      Activity Comple
     C                     MOVEL'N'       WL0126    P      Activity Hold
     C                     MOVEL'Y'       WL0127    P      Post Cash Compl
     C                     Z-ADD*ZERO     WL0128           Cross Event Ref
     C                     Z-ADD*ZERO     WL0129           Cross Event Ref
     C                     Z-ADD*ZERO     WL0130           Cross Event Ref
     C                     Z-ADD*ZERO     WL0131           Ship To Custome
     C                     EXSR OMCRRC
     C                     ADD  1         WUQ2NB           Event Number
      * CRT OP Order Events    CR - Order Events  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0117           Company Number
     C                     Z-ADD#1C4NB    WL0118           Order Number
     C                     Z-ADDWUQ2NB    WL0119           Event Number
     C                     MOVEL'02'      WL0120    P      Event Code
     C                     Z-ADD#1AIC3    WL0121           Invoice/Memo Co
     C                     Z-ADD*ZERO     WL0122           Invoice/Memo Nu
     C                     MOVEL*BLANK    WL0123           Invoice/Memo Su
     C                     Z-ADD##JDT     WL0124           Event Date
     C                     MOVEL'Y'       WL0125    P      Activity Comple
     C                     MOVEL'N'       WL0126    P      Activity Hold
     C                     MOVEL'Y'       WL0127    P      Post Cash Compl
     C                     Z-ADD*ZERO     WL0128           Cross Event Ref
     C                     Z-ADD*ZERO     WL0129           Cross Event Ref
     C                     Z-ADD*ZERO     WL0130           Cross Event Ref
     C                     Z-ADD*ZERO     WL0131           Ship To Custome
     C                     EXSR OMCRRC
     C                     GOTO OKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         WN1994           Event Number
      * CRT OP Order Events    CR - Order Events  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWSAIC3    WL0117           Company Number
     C                     Z-ADDWSC4NB    WL0118           Order Number
     C                     Z-ADDWN1994    WL0119           Event Number
     C                     MOVEL'02'      WL0120    P      Event Code
     C                     Z-ADDWSAUC3    WL0121           Invoice/Memo Co
     C                     Z-ADDWSQ7NB    WL0122           Invoice/Memo Nu
     C                     MOVELWSOMST    WL0123    P      Invoice/Memo Su
     C                     Z-ADD##JDT     WL0124           Event Date
     C                     MOVELWSONST    WL0125    P      Activity Comple
     C                     MOVELWSOOST    WL0126    P      Activity Hold
     C                     MOVELWSOPST    WL0127    P      Post Cash Compl
     C                     Z-ADDWSAWC3    WL0128           Cross Event Ref
     C                     Z-ADDWSQ8NB    WL0129           Cross Event Ref
     C                     Z-ADDWSQ9NB    WL0130           Cross Event Ref
     C                     Z-ADDWSBKC7    WL0131           Ship To Custome
     C                     EXSR OMCRRC
     C                     GOTO OKEXIT                     *QUIT
     C           KRSOK     READE@EYCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         OKEXIT    ENDSR
      /EJECT
     CSR         OLRVGN    BEGSR
      *================================================================
      * RTV Latest Event/Date  RT - OP Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WTAIC3    WQOL01           Company Number
     C           *LIKE     DEFN WTC4NB    WQOL02           Order Number
      * Define keylist
     C           KRSOL     KLIST
     C                     KFLD           WQOL01           Company Number
     C                     KFLD           WQOL02           Order Number
      * Setup key
     C                     Z-ADDWL0110    WQOL01           Company Number
     C                     Z-ADDWL0111    WQOL02           Order Number
      * Establish starting position
     C           KRSOL     SETLL@EYCPZR                    *
     C           KRSOL     READE@EYCPZR                  90*
      * Data record not found
     C   90                MOVEL'USR1074' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWTQ2NB    WL0112           Event Number
     C                     MOVELWTJPCD    WL0113           Event Code
     C                     Z-ADDWTD2DT    WL0114           Event Date
     C                     MOVELWTOOST    WL0115           Activity Hold
     C           KRSOL     READE@EYCPZR                  90*
     C                     ENDDO
      *================================================================
     CSR         OLEXIT    ENDSR
      /EJECT
     CSR         OMCRRC    BEGSR
      *================================================================
      * CRT OP Order Events    CR - Order Events  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN1995  1        EDI Status 1
     C                     MOVEL*BLANK    WN1996  1        EDI Status 2
     C                     MOVEL*BLANK    WN1997  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1998  60       Job Time
     C                     MOVEL*BLANK    WN1999 10        User Id
     C                     MOVEL*BLANK    WN2000 10        Job Name
     C                     Z-ADD*ZERO     WN2001  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @EYCPY3
     C                     Z-ADDWL0117    WVAIC3           Company Number
     C                     Z-ADDWL0118    WVC4NB           Order Number
     C                     Z-ADDWL0119    WVQ2NB           Event Number
     C                     MOVELWL0120    WVJPCD           Event Code
     C                     Z-ADDWL0121    WVAUC3           Invoice/Memo Co
     C                     Z-ADDWL0122    WVQ7NB           Invoice/Memo Nu
     C                     MOVELWL0123    WVOMST           Invoice/Memo Su
     C                     Z-ADDWL0124    WVD2DT           Event Date
     C                     MOVELWL0125    WVONST           Activity Comple
     C                     MOVELWL0126    WVOOST           Activity Hold
     C                     MOVELWL0127    WVOPST           Post Cash Compl
     C                     Z-ADDWL0128    WVAWC3           Cross Event Ref
     C                     Z-ADDWL0129    WVQ8NB           Cross Event Ref
     C                     Z-ADDWL0130    WVQ9NB           Cross Event Ref
     C                     Z-ADDWL0131    WVBKC7           Ship To Custome
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WVAATM           Job Time
     C                     MOVEL##USR     WVAYNA           User Id
     C                     MOVEL##JOB     WVA0NA           Job Name
     C                     Z-ADD##JDT     WVAXDT           Job Date
     C           KLCROM    KLIST
     C                     KFLD           WVAIC3           Company Number
     C                     KFLD           WVC4NB           Order Number
     C                     KFLD           WVQ2NB           Event Number
      * Check for duplicate primary key
     C           KLCROM    SETLL@EYCPY3                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1075' W0RTN   7
      * Send message 'Order Events           EX'
     C                     MOVEL'USR1075' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OMEXIT
     C                     ENDIF
      *
     C                     WRITE@EYCPY3                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OMEXIT    ENDSR
      /EJECT
     CSR         ONRVGN    BEGSR
      *================================================================
      * DLT Single Load Dtl   RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQON01           Load ID
      * Define keylist
     C           KRSON     KLIST
     C                     KFLD           WQON01           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    WQON01           Load ID
      * Establish starting position
     C           KRSON     SETLL@FLCPBW                    *
     C           KRSON     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Order Number EQ DB1.Order Number
     C           #1C4NB    IFEQ FLC4NB                     *IF
      * DLT Load Detail        DL - Load Detail  * 
     C                     EXSR OODLRC
     C                     GOTO ONEXIT                     *QUIT
     C                     END                             *FI
     C           KRSON     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         ONEXIT    ENDSR
      /EJECT
     CSR         OODLRC    BEGSR
      *================================================================
      * DLT Load Detail        DL - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @FLCPBM
     C                     Z-ADDFLRMNB    WRRMNB           Load ID
     C                     Z-ADDFLRUNB    WRRUNB           Stop/Drop Seque
      *
     C           KLDLOO    KLIST
     C                     KFLD           WRRMNB           Load ID
     C                     KFLD           WRRUNB           Stop/Drop Seque
     C           KLDLOO    CHAIN@FLCPBM              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFLCPL0'MDACP
     C                     MOVEL'@FLCPBM' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL016.
     C                     MOVEL'LBL016'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OOEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OOEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@FLCPBM                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         OOEXIT    ENDSR
      /EJECT
     CSR         OPRVGN    BEGSR
      *================================================================
      * Dlt Event by Event Cde RT - Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WWAIC3    WQOP01           Company Number
     C           *LIKE     DEFN WWC4NB    WQOP02           Order Number
     C           *LIKE     DEFN WWJPCD    WQOP03           Event Code
      * Define keylist
     C           KRSOP     KLIST
     C                     KFLD           WQOP01           Company Number
     C                     KFLD           WQOP02           Order Number
     C                     KFLD           WQOP03           Event Code
      * Setup key
     C                     Z-ADD#1AIC3    WQOP01           Company Number
     C                     Z-ADD#1C4NB    WQOP02           Order Number
     C                     MOVEL'02'      WQOP03           Event Code
      * Establish starting position
     C           KRSOP     SETLL@EYCPEH                    *
     C           KRSOP     READE@EYCPEH                  90*
      * Data record not found
     C   90                MOVEL'USR1074' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DLT OP Order Events    DL - Order Events  * 
     C                     EXSR OQDLRC
     C                     GOTO OPEXIT                     *QUIT
     C           KRSOP     READE@EYCPEH                  90*
     C                     ENDDO
      *================================================================
     CSR         OPEXIT    ENDSR
      /EJECT
     CSR         OQDLRC    BEGSR
      *================================================================
      * DLT OP Order Events    DL - Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @EYCPY3
     C                     Z-ADDWWAIC3    WVAIC3           Company Number
     C                     Z-ADDWWC4NB    WVC4NB           Order Number
     C                     Z-ADDWWQ2NB    WVQ2NB           Event Number
      *
     C           KLDLOQ    KLIST
     C                     KFLD           WVAIC3           Company Number
     C                     KFLD           WVC4NB           Order Number
     C                     KFLD           WVQ2NB           Event Number
     C           KLDLOQ    CHAIN@EYCPY3              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPEYCPL0'MDACP
     C                     MOVEL'@EYCPY3' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL017.
     C                     MOVEL'LBL017'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OQEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@EYCPY3                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         OQEXIT    ENDSR
      /EJECT
     CSR         ORCHRC    BEGSR
      *================================================================
      * CHG Carrier/Schd Sp Dt CH - OM Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN2002  30       Company Number
     C                     MOVEL*BLANK    WN2003  1        LTL Flag
     C                     MOVEL*BLANK    WN2004  1        Load Status
     C                     Z-ADD*ZERO     WN2005  52       Reefer Temperat
     C                     MOVEL*BLANK    WN2006 15        Seal 1
     C                     MOVEL*BLANK    WN2007 15        Seal 2
     C                     MOVEL*BLANK    WN2008 15        Seal 3
     C                     MOVEL*BLANK    WN2009 15        Seal 4
     C                     MOVEL*BLANK    WN2010 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN2011  70       Total Load Orde
     C                     Z-ADD*ZERO     WN2012 112       Flat Amount
     C                     MOVEL*BLANK    WN2013  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN2014  50       Total Stops
     C                     MOVEL*BLANK    WN2015 20        Trailer Id
     C                     MOVEL*BLANK    WN2016  3        Transloader Car
     C                     Z-ADD*ZERO     WN2017  40       BOL Time
     C                     MOVEL*BLANK    WN2018  7        Truck Size
     C                     Z-ADD*ZERO     WN2019  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN2020 112       Rated Freight
     C                     MOVEL*BLANK    WN2021  1        Ship Status
     C                     MOVEL*BLANK    WN2022  1        Load Type
     C                     Z-ADD*ZERO     WN2023  50       Number Pallets
     C                     Z-ADD*ZERO     WN2024  50       Number Pallets
     C                     Z-ADD*ZERO     WN2025 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN2026  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN2027  70       Actual Arrival
     C                     Z-ADD*ZERO     WN2028  40       Actual Arrival
     C                     Z-ADD*ZERO     WN2029 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN2030 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN2031  70       Actual Departur
     C                     Z-ADD*ZERO     WN2032  40       Departure Time
     C                     Z-ADD*ZERO     WN2033  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN2034  52       Product Tempera
     C                     Z-ADD*ZERO     WN2035  50       Number Spacers
     C                     MOVEL*BLANK    WN2036 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN2037  70       Total Load Mile
     C                     MOVEL*BLANK    WN2038 12        Recorder ID
     C                     MOVEL*BLANK    WN2039  2        Shipping Method
     C                     MOVEL*BLANK    WN2040  3        Ship From Wareh
     C                     MOVEL*BLANK    WN2041  2        Ship To State C
     C                     Z-ADD*ZERO     WN2042  70       Gross Weight
     C                     MOVEL*BLANK    WN2043  3        Carrier Broker
     C                     MOVEL*BLANK    WN2044  1        Export Status
     C                     Z-ADD*ZERO     WN2045  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN2046  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN2047  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN2048  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN2049  70       Spotted Date
     C                     Z-ADD*ZERO     WN2050  60       Spotted Time
     C                     Z-ADD*ZERO     WN2051  70       Load Finished D
     C                     Z-ADD*ZERO     WN2052  60       Load Finished T
     C                     Z-ADD*ZERO     WN2053  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN2054  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN2055  70       BOL Received Da
     C                     Z-ADD*ZERO     WN2056  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN2057  70       Truck Departure
     C                     Z-ADD*ZERO     WN2058  60       Truck Departure
     C                     Z-ADD*ZERO     WN2059  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN2060  60       Adjusted Depart
     C                     MOVEL*BLANK    WN2061  3        Shipping Line
     C                     MOVEL*BLANK    WN2062 20        Port Delv Termi
     C                     MOVEL*BLANK    WN2063 30        Vessel Name
     C                     Z-ADD*ZERO     WN2064  50       Voyage
     C                     Z-ADD*ZERO     WN2065  70       Sail Date
     C                     MOVEL*BLANK    WN2066 12        Booking Number
     C                     MOVEL*BLANK    WN2067 20        Discharge Port
     C                     Z-ADD*ZERO     WN2068  70       Arrival Date
     C                     MOVEL*BLANK    WN2069 12        Container Numbe
     C                     Z-ADD*ZERO     WN2070  70       Date In
     C                     Z-ADD*ZERO     WN2071  60       Time In
     C                     Z-ADD*ZERO     WN2072  70       Date Out
     C                     Z-ADD*ZERO     WN2073  60       Time Out
     C                     Z-ADD*ZERO     WN2074 112       Load Total Frei
     C                     Z-ADD*ZERO     WN2075  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN2076  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN2077  1        LH Unused Sts
     C                     MOVEL*BLANK    WN2078  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN2079  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN2080  70       Requested Deliv
     C                     MOVEL*BLANK    WN2081  1        Load Acceptance
     C                     MOVEL*BLANK    WN2082  3        Warehouse Code
     C                     Z-ADD*ZERO     WN2083  70       On Yard Date
     C                     Z-ADD*ZERO     WN2084  60       On Yard Time
     C                     Z-ADD*ZERO     WN2085  70       Deadline Depart
     C                     Z-ADD*ZERO     WN2086  60       Deadline Depart
     C                     MOVEL*BLANK    WN2087  1        Load Held Over
     C                     MOVEL*BLANK    WN2088  1        Load Held Over
     C                     MOVEL*BLANK    WN2089 15        Load Held Over
     C                     MOVEL*BLANK    WN2090 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN2091 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN2092  70       Express Mail Da
     C                     MOVEL*BLANK    WN2093  1        Load Shag Flag
     C                     MOVEL*BLANK    WN2094  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN2095  70       Product Complet
     C                     Z-ADD*ZERO     WN2096  60       Product Complet
     C                     Z-ADD*ZERO     WN2097  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN2098  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN2099  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN2100  1        Load Confirmed
     C                     MOVEL*BLANK    WN2101 25        Load Confirmed
     C                     Z-ADD*ZERO     WN2102  70       Load Confirmati
     C                     Z-ADD*ZERO     WN2103  60       Load Door 1
     C                     Z-ADD*ZERO     WN2104  70       Override Total
     C                     Z-ADD*ZERO     WN2105  60       Load Door 2
     C                     MOVEL*BLANK    WN2106  1        Partial Load
     C                     MOVEL*BLANK    WN2107  1        Load Confirmati
     C                     MOVEL*BLANK    WN2108  1        Export Load USD
     C                     MOVEL*BLANK    WN2109  1        Late Delivery E
     C                     Z-ADD*ZERO     WN2110 112       Load Actual Fre
     C                     MOVEL*BLANK    WN2111 15        Hide on WW Load
     C                     MOVEL*BLANK    WN2112 15        Late Billing Em
     C                     MOVEL*BLANK    WN2113 25        Shipping Temp C
     C                     MOVEL*BLANK    WN2114 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN2115  1        Multi Company L
     C                     MOVEL*BLANK    WN2116  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN2117  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN2118  1        LH Power Only L
     C                     MOVEL*BLANK    WN2119  1        MG Created Load
     C                     MOVEL*BLANK    WN2120  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN2121  2        Load U/M
     C                     MOVEL*BLANK    WN2122  2        TPM Shipment St
     C                     MOVEL*BLANK    WN2123  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN2124  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN2125  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN2126  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN2127  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN2128  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN2129  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN2130  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN2131  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN2132  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN2133  60       LH Unused Time
     C                     Z-ADD*ZERO     WN2134  70       LH Unused Date
     C                     Z-ADD*ZERO     WN2135  60       LH Unused Time
     C                     Z-ADD*ZERO     WN2136  70       LH Unused Date
     C                     Z-ADD*ZERO     WN2137  60       LH Unused Time
     C                     MOVEL*BLANK    WN2138  1        EDI Status 1
     C                     MOVEL*BLANK    WN2139  1        EDI Status 2
     C                     MOVEL*BLANK    WN2140  1        EDI Status 3
     C                     Z-ADD*ZERO     WN2141  60       Job Time
     C                     MOVEL*BLANK    WN2142 10        User Id
     C                     MOVEL*BLANK    WN2143 10        Job Name
     C                     Z-ADD*ZERO     WN2144  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YPRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADD#1RMNB    WDRMNB           Load ID
      *
     C           KLCHOR    KLIST
     C                     KFLD           WDRMNB           Load ID
     C           KLCHOR    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL018.
     C                     MOVEL'LBL018'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OREXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YPRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     MOVEL*BLANK    WDBZNA    P      Carrier Code
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YPRDCS
     C           YPRDC     ANDNE'N'
     C                     MOVE 'Y'       YPRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##JOB     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YPRDCS
     C           YPRDC     ANDNE'N'
     C                     MOVE 'Y'       YPRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YPRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         OREXIT    ENDSR
      /EJECT
     CSR         OSRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - User Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOS     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0132    DTAJVN           User Profile Na
     C                     MOVELWL0133    DTDNCD           Application Cod
      * Establish starting position
     C           KRSOS     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0134           Company Number
     C                     MOVELDTAJCD    WL0135           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         OSEXIT    ENDSR
      /EJECT
     CSR         OTRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQOT01           Application Cod
      * Define keylist
     C           KRSOT     KLIST
     C                     KFLD           WQOT01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQOT01           Application Cod
     C                     MOVEL'OMS'     WQOT01           Application Cod
      * Establish starting position
     C           KRSOT     SETLL@DNRESF                    *
     C           KRSOT     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR OURVGN
     C                     END                             *FI
     C           KRSOT     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         OTEXIT    ENDSR
      /EJECT
     CSR         OURVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQOU01           Application Cod
      * Define keylist
     C           KRSOU     KLIST
     C                     KFLD           WQOU01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQOU01           Application Cod
      * Establish starting position
     C           KRSOU     SETLL@DNRESF                    *
     C           KRSOU     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO OUEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSOU     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         OUEXIT    ENDSR
      /EJECT
     CSR         OVRVGN    BEGSR
      *================================================================
      * Rtv Load No. Status   RT - Company Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOV     KLIST
     C                     KFLD           ASAIC3           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    ASAIC3           Company Number
      * Establish starting position
     C           KRSOV     CHAIN@ASREGT              90    *
      * Data record not found
     C   90                MOVEL'USR0049' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELASPNST    P3PNST           Auto Load Numbe
     C                     ENDIF
      *================================================================
     CSR         OVEXIT    ENDSR
      /EJECT
     CSR         OWCHRC    BEGSR
      *================================================================
      * RTV Next Load No.      CH - Company Control  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN2147  40       Current Account
     C                     Z-ADD*ZERO     WN2148  20       Current Account
     C                     Z-ADD*ZERO     WN2149  30       OM Week
     C                     Z-ADD*ZERO     WN2150  70       Next Order Numb
     C                     Z-ADD*ZERO     WN2151  70       Next Invoice Nu
     C                     Z-ADD*ZERO     WN2152  70       Next Credit Mem
     C                     Z-ADD*ZERO     WN2153  70       Next Charge Bac
     C                     Z-ADD*ZERO     WN2154  70       Next On Acct Ca
     C                     Z-ADD*ZERO     WN2155  70       Next Voucher Nu
     C                     Z-ADD*ZERO     WN2156  70       Next Customer #
     C                     Z-ADD*ZERO     WN2157  70       Next Inventory
     C                     Z-ADD*ZERO     WN2158  80       Next PFS Batch
     C                     Z-ADD*ZERO     WN2159  70       Next Contract/P
     C                     Z-ADD*ZERO     WN2160  60       Next HPB Batch
     C                     MOVEL*BLANK    WN2161  1        Auto Order Numb
     C                     MOVEL*BLANK    WN2162  1        Auto Voucher Nu
     C                     MOVEL*BLANK    WN2163  1        Auto Customers
     C                     MOVEL*BLANK    WN2164  1        Auto Inv. Ref.
     C                     Z-ADD*ZERO     WN2165  52       Manual Price Ac
     C                     Z-ADD*ZERO     WN2166  52       CoPk/FdSrv ManP
     C                     Z-ADD*ZERO     WN2167 112       Late Charge Min
     C                     MOVEL*BLANK    WN2168  1        Print Co Addr o
     C                     MOVEL*BLANK    WN2169  1        Credit Hold Sta
     C                     MOVEL*BLANK    WN2170  1        Allocate Credit
     C                     MOVEL*BLANK    WN2171 30        Message Line 1
     C                     MOVEL*BLANK    WN2172 30        Message Line 2
     C                     MOVEL*BLANK    WN2173 30        Message Line 3
     C                     MOVEL*BLANK    WN2174 30        Message Line 4
     C                     MOVEL*BLANK    WN2175  1        Age by Trans or
     C                     Z-ADD*ZERO     WN2176  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN2177  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN2178  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN2179  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN2180  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN2181  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN2182  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN2183  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN2184  30       Retention Perio
     C                     Z-ADD*ZERO     WN2185  30       Retention Perio
     C                     Z-ADD*ZERO     WN2186  30       Retention Perio
     C                     Z-ADD*ZERO     WN2187  30       Retention Perio
     C                     Z-ADD*ZERO     WN2188  30       Retention Perio
     C                     Z-ADD*ZERO     WN2189  70       Next Load ID
     C                     MOVEL*BLANK    WN2190  1        Auto Load Numbe
     C                     Z-ADD*ZERO     WN2191  70       Next Item Numbe
     C                     MOVEL*BLANK    WN2192  1        G/L Posted Code
     C                     Z-ADD*ZERO     WN2193  30       Production Numb
     C                     MOVEL*BLANK    WN2194  1        Freight by Poun
     C                     MOVEL*BLANK    WN2195  1        Price Audit Act
     C                     MOVEL*BLANK    WN2196 10        PRT Night Queue
     C                     MOVEL*BLANK    WN2197  1        EDI Status 1
     C                     MOVEL*BLANK    WN2198  1        EDI Status 2
     C                     MOVEL*BLANK    WN2199  1        EDI Status 3
     C                     MOVEL*BLANK    WN2200  1        Record Status
     C                     Z-ADD*ZERO     WN2201  60       Job Time
     C                     MOVEL*BLANK    WN2202 10        User Id
     C                     MOVEL*BLANK    WN2203 10        Job Name
     C                     Z-ADD*ZERO     WN2204  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YQRDC   1
      *
      * Move key fields to @ASRECB
     C                     Z-ADD*ZERO     WXAIC3           Company Number
      *
     C           KLCHOW    KLIST
     C                     KFLD           WXAIC3           Company Number
     C           KLCHOW    CHAIN@ASRECB              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAASREL0'MDACP
     C                     MOVEL'@ASRECB' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL019.
     C                     MOVEL'LBL019'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OWEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OWEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAAS1    YQRDCS
      *
      * Set PGM.*Record Data Changed flag
     C           QCAAS1    IFNE YQRDCS
     C           YQRDC     ANDNE'N'
     C                     MOVE 'Y'       YQRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     MOVEL'Y'       YQRDC            *Record Data Ch
     C                     Z-ADDWXR3NB    P3UCNB           Load ID
     C                     ADD  1         WXR3NB           Next Load ID
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WXAATM' defaulted for 'Job Time'.
      * Field '(DB1) WXAYNA' defaulted for 'User Id'.
      * Field '(DB1) WXA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WXAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WXAATM           Job Time
     C                     MOVEL##USR     WXAYNA           User Id
     C                     MOVEL##JOB     WXA0NA           Job Name
     C                     Z-ADD##JDT     WXAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCAAS1    IFNE YQRDCS
     C           YQRDC     ANDNE'N'
     C                     MOVE 'Y'       YQRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YQRDC     IFEQ 'Y'
     C                     UPDAT@ASRECB                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAASREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         OWEXIT    ENDSR
      /EJECT
     CSR         OXRVGN    BEGSR
      *================================================================
      * RTV Appl Whs Restrict  RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOX     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVEL##USR     DRAJVN           User Profile Na
      * Establish starting position
     C           KRSOX     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0007           Application WHS
     C                     GOTO OXEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI7ST    YL0007           Application WHS
     C                     ENDIF
      *================================================================
     CSR         OXEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Stop/Drop Seq.    RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQSA01           Load ID
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Load ID
      * Setup key
     C                     Z-ADDWL0001    WQSA01           Load ID
      * Establish starting position
     C           KRSSA     SETLL@FLCPBW                    *
     C           KRSSA     READE@FLCPBW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Find the ending sequence number for the load
      * CASE: DB1.Stop/Drop Sequence Number GT PAR.Stop/Drop Sequence Num
     C           FLRUNB    IFGT WL0002                     *IF
     C                     Z-ADDFLRUNB    WL0002           Stop/Drop Seque
     C                     END                             *FI
     C           KRSSA     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Load for Load Plan RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSB     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #CHODT           Scheduled Ship
     C                     MOVEL*BLANK    #PPKST           Load Status
     C                     Z-ADD*ZERO     P2RNNB           Reefer Temperat
     C                     Z-ADD*ZERO     #PRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WUNFNN           Flat Amount
     C                     MOVEL*BLANK    #CQ7ST           Allocate Pounds
     C                     MOVEL*BLANK    #2BZNA           Carrier Code
     C                     MOVEL*BLANK    #PRONB           Truck Size
     C                     Z-ADD*ZERO     #2R1NB           Rated Freight
     C                     MOVEL*BLANK    WUVDST           Load Type
     C                     Z-ADD*ZERO     YL0001           Schedule Sequen
     C                     Z-ADD*ZERO     WUTLMI           Total Load Mile
     C                     MOVEL*BLANK    #CCUST           Shipping Method
     C                     MOVEL*BLANK    YL0002           Ship From Wareh
     C                     MOVEL*BLANK    WUG0TX           Ship To State C
     C                     MOVEL*BLANK    WUXCCD           Carrier Broker
     C                     MOVEL*BLANK    #CRMST           Load Acceptance
     C                     Z-ADD*ZERO     P2K2DT           Override Total
     C                     MOVEL*BLANK    WUWRTX           Shipping Temp C
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFJAODT    #CHODT           Scheduled Ship
     C                     MOVELFJPKST    #PPKST           Load Status
     C                     Z-ADDFJRNNB    P2RNNB           Reefer Temperat
     C                     Z-ADDFJRPNB    #PRPNB           Total Load Orde
     C                     Z-ADDFJFLAM    WUNFNN           Flat Amount
     C                     MOVELFJXQST    #CQ7ST           Allocate Pounds
     C                     MOVELFJBZNA    #2BZNA           Carrier Code
     C                     MOVELFJRONB    #PRONB           Truck Size
     C                     Z-ADDFJR1NB    #2R1NB           Rated Freight
     C                     MOVELFJVDST    WUVDST           Load Type
     C                     Z-ADDFJT4NB    YL0001           Schedule Sequen
     C                     Z-ADDFJTLMI    WUTLMI           Total Load Mile
     C                     MOVELFJQ2CD    #CCUST           Shipping Method
     C                     MOVELFJVPCD    YL0002           Ship From Wareh
     C                     MOVELFJDBCD    WUG0TX           Ship To State C
     C                     MOVELFJXCCD    WUXCCD           Carrier Broker
     C                     MOVELFJRMST    #CRMST           Load Acceptance
     C                     Z-ADDFJK2DT    P2K2DT           Override Total
     C                     MOVELFJWRTX    WUWRTX           Shipping Temp C
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Chk any ords on Ld RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
     C                     MOVEL*BLANK    WL0004           USR Check Y/N S
      * Declare restrictor key work fields
     C           *LIKE     DEFN WARMNB    WQSC02           Load ID
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC02           Load ID
      * Setup key
     C                     Z-ADDWL0003    WQSC02           Load ID
      * Establish starting position
     C           KRSSC     SETLL@BFCPD9                    *
     C           KRSSC     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WL0004           USR Check Y/N S
     C                     GOTO SCEXIT                     *QUIT
     C           KRSSC     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Alpha Value        RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           KMAIC3           Company Number
     C                     KFLD           KMV8CD           Company Value C
      * Setup key
     C                     Z-ADDWL0005    KMAIC3           Company Number
     C                     MOVELWL0006    KMV8CD           Company Value C
      * Establish starting position
     C           KRSSD     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELKMBXTX    WL0007           System Value Al
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Min & Max Pounds  RT - Truck Size  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           FKRONB           Truck Size
      * Setup key
     C                     MOVELWURONB    FKRONB           Truck Size
      * Establish starting position
     C           KRSSE     CHAIN@FKREBT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1190' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     P3RSNB           Maximum pounds
     C                     Z-ADD*ZERO     P3TANB           Minimum pounds
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFKRSNB    P3RSNB           Maximum pounds
     C                     Z-ADDFKTANB    P3TANB           Minimum pounds
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV GrsWgt w/PltTr Ld RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WL0010           USR Weight Accu
      * CASE: PAR.Load Status is Shipped or Invoiced
     C           WL0011    IFEQ 'I'                        *IF
     C           WL0011    OREQ 'S'
      * RTV Pallet/Tare        RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0008    WL0012           Load ID
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0013    YL0003           Pallets Loaded
     C                     Z-ADDWL0014    YL0004           Avg Pallet Tare
     C                     Z-ADDWL0015    YL0005           Tot Pallet Tare
     C                     END                             *FI
      * ***** Change log and comments
     C                     EXSR UASUBR                     ***** Change lo
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQSF01           Load ID
      * Define keylist
     C           KPSSF     KLIST
     C                     KFLD           WQSF01           Load ID
     C                     KFLD           FLRUNB           Stop/Drop Seque
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Load ID
      * Setup key
     C                     Z-ADDWL0008    WQSF01           Load ID
     C                     Z-ADDWL0009    FLRUNB           Stop/Drop Seque
      * Establish starting position
     C           KPSSF     SETLL@FLCPBW                    *
     C           KRSSF     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * 01/18/10 PKD E000261 SEND in LCL.Avg Pallet Tare
      * RTV Gross Wgt/Qty     XF - Order Detail  * 
     C                     CALL 'PQPQXFR'              90  RTV Gross Wgt/Q
     C                     PARM *BLANK    W0RTN   7
     C                     PARM FLAIC3    WQ0019  30       Company Number
     C                     PARM FLC4NB    WQ0020  70       Order Number
     C                     PARM *ZERO     WQ0021  30       Order Sequence
     C                     PARM *ZERO     WQ0022  30       Order Secondary
     C           WL0010    PARM WL0010    WQ0023 112       USR Weight Accu
     C           YL0006    PARM YL0006    WQ0024 112       Order Quantity
     C                     PARM YL0004    WQ0025  92       Avg Pallet Tare
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PQPQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C           KRSSF     READE@FLCPBW                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: PAR.Load Status is Shipped or Invoiced
     C           WL0011    IFEQ 'I'                        *IF
     C           WL0011    OREQ 'S'
      * RTV Pallet/Tare        RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLRMNB    WL0012           Load ID
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0013    YL0003           Pallets Loaded
     C                     Z-ADDWL0014    YL0004           Avg Pallet Tare
     C                     Z-ADDWL0015    YL0005           Tot Pallet Tare
     C                     ADD  YL0005    WL0010           USR Weight Accu
     C                     END                             *FI
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Pallet/Tare        RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDWL0012    FJRMNB           Load ID
      * Establish starting position
     C           KRSSG     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFJKNNX    WL0013           Pallets Loaded
     C                     Z-ADDFJICWG    WL0014           Avg Pallet Tare
     C                     Z-ADDFJIDWG    WL0015           Tot Pallet Tare
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv 1st Warehouse     RT - User Application Whs  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FOAJVN    WQSH01           User Profile Na
     C           *LIKE     DEFN FODNCD    WQSH02           Application Cod
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           User Profile Na
     C                     KFLD           WQSH02           Application Cod
      * Setup key
     C                     MOVEL##USR     WQSH01           User Profile Na
     C                     MOVE *BLANK    WQSH02           Application Cod
     C                     MOVEL'O/P'     WQSH02           Application Cod
      * Establish starting position
     C           KRSSH     SETLL@FOREDD                    *
     C           KRSSH     READE@FOREDD                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4200' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #CAJCD           Warehouse Code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFOAJCD    #CAJCD           Warehouse Code
     C                     GOTO SHEXIT                     *QUIT
     C           KRSSH     READE@FOREDD                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV WhsTyp/Ctrl/LdTyp RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#CAJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSI     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #2VDST           WHS Default Loa
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADT7ST    #2VDST           WHS Default Loa
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV OHE Appt Cnfrm fld RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           AMAIC3           Company Number
     C                     KFLD           AMC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    AMAIC3           Company Number
     C                     Z-ADD#1C4NB    AMC4NB           Order Number
      * Establish starting position
     C           KRSSJ     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #RV5T1           OHE Appt Confir
     C                     MOVEL*BLANK    #RWBT1           OHE Appt Confir
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAMV5T1    #RV5T1           OHE Appt Confir
     C                     MOVELAMWBT1    #RWBT1           OHE Appt Confir
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Type              RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           AMAIC3           Company Number
     C                     KFLD           AMC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    AMAIC3           Company Number
     C                     Z-ADD#1C4NB    AMC4NB           Order Number
      * Establish starting position
     C           KRSSK     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0010           OHE Override Ty
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAMCHTX    YL0010           OHE Override Ty
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Stop Number       RT - Load Detail          TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WL0017           Stop/Drop
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQSL01           Load ID
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Load ID
      * Setup key
     C                     Z-ADDWL0016    WQSL01           Load ID
      * Establish starting position
     C           KRSSL     SETLL@FLCPBW                    *
     C           KRSSL     READE@FLCPBW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0017           Stop/Drop
     C                     Z-ADD*ZERO     WL0019           Appointment Con
     C                     Z-ADD*ZERO     WL0020           Appointment Con
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * If order number is found, retrieve stop number
      * CASE: PAR.Order Number EQ DB1.Order Number
     C           WL0018    IFEQ FLC4NB                     *IF
     C                     Z-ADDFLRVNB    WL0017           Stop/Drop
      * PAR = DB1 By name
     C                     Z-ADDFLRVNB    WL0017           Stop/Drop
     C                     Z-ADDFLKFDT    WL0019           Appointment Con
     C                     Z-ADDFLACTM    WL0020           Appointment Con
     C                     GOTO SLEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSL     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV 1st Warehouse/UOM  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSM01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSM02           Order Number
      * Define keylist
     C           KPSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQSM01           Company Number
     C                     Z-ADD#1C4NB    WQSM02           Order Number
     C                     Z-ADD*ZERO     OMDPNB           Order Sequence
     C                     Z-ADD*ZERO     OMUENB           Order Secondary
      * Establish starting position
     C           KPSSM     SETLL@BGWKAE                    *
     C           KRSSM     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #RAJCD           Warehouse Code
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELOMAJCD    #RAJCD           Warehouse Code
     C                     GOTO SMEXIT                     *QUIT
     C           KRSSM     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Region for State   RT - Region Definition  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN KGAIC3    WQSN01           Company Number
     C           *LIKE     DEFN KGBGCD    WQSN02           State Code
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Company Number
     C                     KFLD           WQSN02           State Code
      * Setup key
     C                     Z-ADDWL0021    WQSN01           Company Number
     C                     MOVELWL0023    WQSN02           State Code
      * Establish starting position
     C           KRSSN     SETLL@KGREGY                    *
     C           KRSSN     READE@KGREGY                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2203' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELKGV1CD    WL0022           Region Code
     C                     GOTO SNEXIT                     *QUIT
     C           KRSSN     READE@KGREGY                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Check Pick Event   RT - OP Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN EYAIC3    WQSO01           Company Number
     C           *LIKE     DEFN EYC4NB    WQSO02           Order Number
     C           *LIKE     DEFN EYJPCD    WQSO03           Event Code
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Company Number
     C                     KFLD           WQSO02           Order Number
     C                     KFLD           WQSO03           Event Code
      * Setup key
     C                     Z-ADD#1AIC3    WQSO01           Company Number
     C                     Z-ADD#1C4NB    WQSO02           Order Number
     C                     MOVEL'03'      WQSO03           Event Code
      * Establish starting position
     C           KRSSO     SETLL@EYCPZE                    *
     C           KRSSO     READE@EYCPZE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1074' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SOEXIT                     *QUIT
     C           KRSSO     READE@EYCPZE                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV State Description  RT - State  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           ACBGCD           State Code
      * Setup key
     C                     MOVELBEDBCD    ACBGCD           State Code
      * Establish starting position
     C           KRSSP     CHAIN@ACREAH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0005' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #RLHNA           Description
     C                     MOVEL*BLANK    WUVSST           Record Status
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELACAUNA    #RLHNA           Description
     C                     MOVELACVSST    WUVSST           Record Status
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCRRC    BEGSR
      *================================================================
      * CRT Load Plan Stop Cst CR - *Arrays  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Array full, cannot add any more elements
     C           YL01      IFEQ 100
     C                     MOVEL'Y2U0036' W0RTN   7
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C                     Z-ADD*ZERO     XARVNB           Stop/Drop
     C                     Z-ADD*ZERO     XABKC7           Ship To Custome
      * Move all fields to Load Planning Stop Cust
     C                     Z-ADDWL0024    XARVNB           Stop/Drop
     C                     Z-ADDWL0025    XABKC7           Ship To Custome
      *
      * Move key fields to Load Planning Stop Cust
     C                     Z-ADDXARVNB    YI0101           Stop/Drop
      *
      * Check for duplicate primary key
      * Initialize internal index
     C                     Z-ADD*ZERO     YI01
      * Only search if key is not beyond range of current elements
     C           YL01      IFGT 0
     C           YK01,YL01 ANDGTYD01
      * Set search index to first element of array
     C                     Z-ADD1         Y       50
     C           YD01      LOKUPYK01,Y               90    Look for >
     C                     ELSE
     C                     SETOF                     90    *
     C                     ENDIF
     C           *IN90     IFEQ '1'
      * Move to data structure for comparison
     C                     MOVELYK01,Y    YD01
      * Compare
     C           YI0101    IFEQ XARVNB
      * Array element already exists
     C                     MOVEL'Y2U0003' W0RTN   7
      * USER: Processing if Data record already exists
     C                     GOTO SQEXIT                     *QUIT
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C                     ENDIF
      *
      * Insert after last used element
     C           YL01      ADD  1         Y       50
      * Check if element was a previously deleted element
     C           YK01,Y    IFNE *HIVAL
      * If so, reuse MODS index
     C                     MOVELYK01,Y    YD01
     C                     ELSE
      * If not, use element number as MODS index
     C                     Z-ADDY         YI01
     C                     ENDIF
      *
      * Create(insert) new element
      * Move key fields to Load Planning Stop Cust
     C                     Z-ADDXARVNB    YI0101           Stop/Drop
      *
     C                     MOVELYD01      YK01,Y
     C           YI01      OCUR YM01
      * Update MODS fields
     C                     Z-ADDXARVNB    WBRVNB           Stop/Drop
     C                     Z-ADDXABKC7    WBBKC7           Ship To Custome
      * Only sort if element is out of position
     C           YL01      IFGT 0
     C           YK01,YL01 ANDGTYD01
      * Adjust RTVOBJ index to reflect position of added/removed element
     C           YR01      IFGT 0
     C           YR01      ANDLE100
     C           YK01,YR01 ANDGTYD01
     C                     ADD  1         YR01    50
     C                     ENDIF
      * Sort array to place element in correct position
     C                     SORTAYK01
     C                     ENDIF
      * Adjust number of elements currently in array
     C                     ADD  1         YL01
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Shipping Co Dft    RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN EOBKC7    WQSR01           Ship To Custome
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           Ship To Custome
      * Setup key
     C                     Z-ADD#1BKC7    WQSR01           Ship To Custome
      * Establish starting position
     C           KRSSR     SETLL@EOREIQ                    *
     C           KRSSR     READE@EOREIQ                  90*
      * Data record not found
     C   90                MOVEL'USR1007' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Default Shipping Co Sts is Yes
     C           EOQ8ST    IFEQ 'Y'                        *IF
      * PAR = DB1 By name
     C                     Z-ADDEOAIC3    WUBSC3           Company Number
     C                     GOTO SREXIT                     *QUIT
     C                     END                             *FI
     C           KRSSR     READE@EOREIQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Val Load Exist        RT - OM Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDWL0026    FJRMNB           Load ID
      * Establish starting position
     C           KRSSS     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SSEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv Plant Co Status   RT - Company Defaults Internal  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           JYAIC3           Company Number
      * Setup key
     C                     Z-ADD#CFKNB    JYAIC3           Company Number
      * Establish starting position
     C           KRSST     CHAIN@JYRECE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2025' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0013           Plant Company S
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELJYYISX    YL0013           Plant Company S
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * VAL Active Region      RT - PD Region  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           KFAIC3           Company Number
     C                     KFLD           KFV1CD           Region Code
      * Setup key
     C                     Z-ADD#2AIC3    KFAIC3           Company Number
     C                     MOVEL#CV1CD    KFV1CD           Region Code
      * Establish starting position
     C           KRSSU     CHAIN@KFREGX              90    *
      * Data record not found
     C   90                MOVEL'USR2201' W0RTN   7
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * RTV Load Total Weight  RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSV     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFJRPNB    #PRPNB           Total Load Orde
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Val Warehouse Exists   RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WCAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#CAJCD    WCAJCD           Warehouse Code
      * Establish starting position
     C           KRSSW     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXCHRC    BEGSR
      *================================================================
      * CHG Ld Typ/Shp Mth/Alc CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  30       Company Number
     C                     Z-ADD*ZERO     WN0002  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0003  1        LTL Flag
     C                     MOVEL*BLANK    WN0004  1        Load Status
     C                     Z-ADD*ZERO     WN0005  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0006 15        Seal 1
     C                     MOVEL*BLANK    WN0007 15        Seal 2
     C                     MOVEL*BLANK    WN0008 15        Seal 3
     C                     MOVEL*BLANK    WN0009 15        Seal 4
     C                     MOVEL*BLANK    WN0010 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0011  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0012 112       Flat Amount
     C                     Z-ADD*ZERO     WN0013  50       Total Stops
     C                     MOVEL*BLANK    WN0014 20        Trailer Id
     C                     MOVEL*BLANK    WN0015  3        Transloader Car
     C                     Z-ADD*ZERO     WN0016  40       BOL Time
     C                     MOVEL*BLANK    WN0017  7        Truck Size
     C                     Z-ADD*ZERO     WN0018  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0019 112       Rated Freight
     C                     MOVEL*BLANK    WN0020  1        Ship Status
     C                     Z-ADD*ZERO     WN0021  50       Number Pallets
     C                     Z-ADD*ZERO     WN0022  50       Number Pallets
     C                     Z-ADD*ZERO     WN0023 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0024  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0025  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0026  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0027 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0028 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0029  70       Actual Departur
     C                     Z-ADD*ZERO     WN0030  40       Departure Time
     C                     Z-ADD*ZERO     WN0031  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0032  52       Product Tempera
     C                     Z-ADD*ZERO     WN0033  50       Number Spacers
     C                     MOVEL*BLANK    WN0034 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0035  70       Total Load Mile
     C                     MOVEL*BLANK    WN0036 12        Recorder ID
     C                     MOVEL*BLANK    WN0037  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0038  2        Ship To State C
     C                     Z-ADD*ZERO     WN0039  70       Gross Weight
     C                     MOVEL*BLANK    WN0040  3        Carrier Broker
     C                     MOVEL*BLANK    WN0041  1        Export Status
     C                     Z-ADD*ZERO     WN0042  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0043  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0044  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0045  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0046  70       Spotted Date
     C                     Z-ADD*ZERO     WN0047  60       Spotted Time
     C                     Z-ADD*ZERO     WN0048  70       Load Finished D
     C                     Z-ADD*ZERO     WN0049  60       Load Finished T
     C                     Z-ADD*ZERO     WN0050  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0051  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0052  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0053  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0054  70       Truck Departure
     C                     Z-ADD*ZERO     WN0055  60       Truck Departure
     C                     Z-ADD*ZERO     WN0056  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0057  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0058  3        Shipping Line
     C                     MOVEL*BLANK    WN0059 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0060 30        Vessel Name
     C                     Z-ADD*ZERO     WN0061  50       Voyage
     C                     Z-ADD*ZERO     WN0062  70       Sail Date
     C                     MOVEL*BLANK    WN0063 12        Booking Number
     C                     MOVEL*BLANK    WN0064 20        Discharge Port
     C                     Z-ADD*ZERO     WN0065  70       Arrival Date
     C                     MOVEL*BLANK    WN0066 12        Container Numbe
     C                     Z-ADD*ZERO     WN0067  70       Date In
     C                     Z-ADD*ZERO     WN0068  60       Time In
     C                     Z-ADD*ZERO     WN0069  70       Date Out
     C                     Z-ADD*ZERO     WN0070  60       Time Out
     C                     Z-ADD*ZERO     WN0071 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0072  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0073  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0074  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0075  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0076  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0077  70       Requested Deliv
     C                     MOVEL*BLANK    WN0078  1        Load Acceptance
     C                     MOVEL*BLANK    WN0079  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0080  70       On Yard Date
     C                     Z-ADD*ZERO     WN0081  60       On Yard Time
     C                     Z-ADD*ZERO     WN0082  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0083  60       Deadline Depart
     C                     MOVEL*BLANK    WN0084  1        Load Held Over
     C                     MOVEL*BLANK    WN0085  1        Load Held Over
     C                     MOVEL*BLANK    WN0086 15        Load Held Over
     C                     MOVEL*BLANK    WN0087 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0088 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0089  70       Express Mail Da
     C                     MOVEL*BLANK    WN0090  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0091  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0092  70       Product Complet
     C                     Z-ADD*ZERO     WN0093  60       Product Complet
     C                     Z-ADD*ZERO     WN0094  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0095  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0096  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0097  1        Load Confirmed
     C                     MOVEL*BLANK    WN0098 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0099  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0100  60       Load Door 1
     C                     Z-ADD*ZERO     WN0101  70       Override Total
     C                     Z-ADD*ZERO     WN0102  60       Load Door 2
     C                     MOVEL*BLANK    WN0103  1        Partial Load
     C                     MOVEL*BLANK    WN0104  1        Load Confirmati
     C                     MOVEL*BLANK    WN0105  1        Export Load USD
     C                     MOVEL*BLANK    WN0106  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0107 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0108 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0109 15        Late Billing Em
     C                     MOVEL*BLANK    WN0110 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0111 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0112  1        Multi Company L
     C                     MOVEL*BLANK    WN0113  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0114  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0115  1        LH Power Only L
     C                     MOVEL*BLANK    WN0116  1        MG Created Load
     C                     MOVEL*BLANK    WN0117  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0118  2        Load U/M
     C                     MOVEL*BLANK    WN0119  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0120  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0121  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0122  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0123  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0124  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0125  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0126  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0127  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0128  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0129  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0130  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0131  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0132  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0133  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0134  60       LH Unused Time
     C                     MOVEL*BLANK    WN0135  1        EDI Status 1
     C                     MOVEL*BLANK    WN0136  1        EDI Status 2
     C                     MOVEL*BLANK    WN0137  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0138  60       Job Time
     C                     MOVEL*BLANK    WN0139 10        User Id
     C                     MOVEL*BLANK    WN0140 10        Job Name
     C                     Z-ADD*ZERO     WN0141  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADD#2RMNB    WDRMNB           Load ID
      *
     C           KLCHSX    KLIST
     C                     KFLD           WDRMNB           Load ID
     C           KLCHSX    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SXEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YARDCS
      * Move non-key fields to @FJCPBO
     C                     MOVEL#CQ7ST    WDXQST    P      Allocate Pounds
     C                     MOVEL#2BZNA    WDBZNA    P      Carrier Code
     C                     MOVEL#2VDST    WDVDST    P      Load Type
     C                     MOVEL#CCUST    WDQ2CD    P      Shipping Method
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##JOB     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * RTV Del All Stop Custs RT - *Arrays  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD1         Y       50
     C           YL01      IFGT 0
     C                     MOVELYK01,Y    YD01
     C           YI01      OCUR YM01
     C                     ELSE
      * Array element not found
     C                     MOVEL'Y2U0005' W0RTN   7
     C                     ENDIF
      *
      * Sequence through qualified elements:
     C                     Z-ADDY         YR01    50
     C           YR01      DOWLEYL01
     C                     Z-ADDYR01      Y
     C                     MOVELYK01,Y    YD01
     C           YI01      OCUR YM01
      * USER: Process Data record
      * DEL Stop Cust          DL - *Arrays  * 
     C                     EXSR SZDLRC
     C                     ADD  1         YR01
     C                     ENDDO
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZDLRC    BEGSR
      *================================================================
      * DEL Stop Cust          DL - *Arrays  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to Load Planning Stop Cust
     C                     Z-ADDWBRVNB    YI0101           Stop/Drop
      *
      * Reset global index if not within range of current elements
     C           Y         IFGT YL01
     C                     Z-ADD1         Y
     C                     ENDIF
      * Only search if not already pointing to correct element
     C           Y         IFGT 0
     C           YD01      ANDNEYK01,Y
      * Initialize internal index
     C                     Z-ADD*ZERO     YI01
      * Only search if key is not beyond range of current elements
     C           YL01      IFGT 0
     C           YK01,YL01 ANDGTYD01
      * Set search index to first element of array
     C                     Z-ADD1         Y       50
     C           YD01      LOKUPYK01,Y               90    Look for >
     C                     ELSE
     C                     SETOF                     90    *
     C                     ENDIF
     C           *IN90     IFEQ '1'
      * Move to data structure for comparison
     C                     MOVELYK01,Y    YD01
      * Compare
     C           YI0101    IFNE WBRVNB
      *
     C                     SETOF                     90    *
     C                     ENDIF
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * Element not found in array
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     GOTO SZEXIT
     C                     ENDIF
     C                     ENDIF
      *
      * Adjust RTVOBJ index to reflect position of added/removed element
     C           YR01      IFGT 0
     C           YR01      ANDLE100
     C           YK01,YR01 ANDGEYD01
     C                     SUB  1         YR01    50
     C                     ENDIF
      *
      * Initialize keys in array but retain index to MODS for later reuse
     C                     Z-ADDYI01      YISAV   50
     C                     MOVEL*HIVAL    YD01
     C                     Z-ADDYISAV     YI01
     C                     MOVELYD01      YK01,Y
      * Sort array to compress out deleted element
     C                     SORTAYK01
      * Adjust number of elements currently in array
     C                     SUB  1         YL01
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * RTV Stop/Drop & Order# RT - Load Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0142  50       Stop/Drop
     C                     Z-ADD*ZERO     WN0143  70       Order Number
     C                     Z-ADD*ZERO     WN0144  70       Requested Deliv
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQTA01           Load ID
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA01           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    WQTA01           Load ID
      * Establish starting position
     C           KRSTA     SETLL@FLCPBW                    *
     C           KRSTA     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Delivery Date     RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0027           Company Number
     C                     Z-ADDFLC4NB    WL0028           Order Number
     C                     EXSR TBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0029    WN0144           Requested Deliv
      * CRT Load Stop Array    CR - *Arrays  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLRVNB    WL0030           Stop/Drop
     C                     Z-ADDWN0144    WL0031           Requested Deliv
     C                     EXSR TCCRRC
     C           KRSTA     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * Rtv Delivery Date     RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0027    WEAIC3           Company Number
     C                     Z-ADDWL0028    WEC4NB           Order Number
      * Establish starting position
     C           KRSTB     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0029           Requested Deliv
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWEEIDT    WL0029           Requested Deliv
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCCRRC    BEGSR
      *================================================================
      * CRT Load Stop Array    CR - *Arrays  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Array full, cannot add any more elements
     C           YL02      IFEQ 100
     C                     MOVEL'Y2U0036' W0RTN   7
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C                     Z-ADD*ZERO     XBRVNB           Stop/Drop
     C                     Z-ADD*ZERO     XBEIDT           Requested Deliv
      * Move all fields to Load Planning Stop/Date
     C                     Z-ADDWL0030    XBRVNB           Stop/Drop
     C                     Z-ADDWL0031    XBEIDT           Requested Deliv
      *
      * Move key fields to Load Planning Stop/Date
     C                     Z-ADDXBRVNB    YI0201           Stop/Drop
      *
      * Check for duplicate primary key
      * Initialize internal index
     C                     Z-ADD*ZERO     YI02
      * Only search if key is not beyond range of current elements
     C           YL02      IFGT 0
     C           YK02,YL02 ANDGTYD02
      * Set search index to first element of array
     C                     Z-ADD1         Y       50
     C           YD02      LOKUPYK02,Y               90    Look for >
     C                     ELSE
     C                     SETOF                     90    *
     C                     ENDIF
     C           *IN90     IFEQ '1'
      * Move to data structure for comparison
     C                     MOVELYK02,Y    YD02
      * Compare
     C           YI0201    IFEQ XBRVNB
      * Array element already exists
     C                     MOVEL'Y2U0003' W0RTN   7
      * USER: Processing if Data record already exists
     C                     GOTO TCEXIT                     *QUIT
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C                     ENDIF
      *
      * Insert after last used element
     C           YL02      ADD  1         Y       50
      * Check if element was a previously deleted element
     C           YK02,Y    IFNE *HIVAL
      * If so, reuse MODS index
     C                     MOVELYK02,Y    YD02
     C                     ELSE
      * If not, use element number as MODS index
     C                     Z-ADDY         YI02
     C                     ENDIF
      *
      * Create(insert) new element
      * Move key fields to Load Planning Stop/Date
     C                     Z-ADDXBRVNB    YI0201           Stop/Drop
      *
     C                     MOVELYD02      YK02,Y
     C           YI02      OCUR YM02
      * Update MODS fields
     C                     Z-ADDXBRVNB    WFRVNB           Stop/Drop
     C                     Z-ADDXBEIDT    WFEIDT           Requested Deliv
      * Only sort if element is out of position
     C           YL02      IFGT 0
     C           YK02,YL02 ANDGTYD02
      * Adjust RTVOBJ index to reflect position of added/removed element
     C           YR02      IFGT 0
     C           YR02      ANDLE100
     C           YK02,YR02 ANDGTYD02
     C                     ADD  1         YR02    50
     C                     ENDIF
      * Sort array to place element in correct position
     C                     SORTAYK02
     C                     ENDIF
      * Adjust number of elements currently in array
     C                     ADD  1         YL02
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * RTV Stops/Chk Dte Seq  RT - *Arrays  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C           YL02      IFGT 0
      * Set search index to first element of array
     C                     Z-ADD1         Y       50
     C                     MOVELYK02,Y    YD02
     C           YI02      OCUR YM02
      * Initialize internal index
     C                     MOVEL*LOVAL    YD02
      * Move key fields to Load Planning Stop/Date
     C                     Z-ADD1         YI0201           Stop/Drop
      *
      * Only search if key is not beyond range of current elements
     C           YK02,YL02 IFGT YD02
     C           YD02      LOKUPYK02,Y               90    Look for >
     C                     ELSE
     C                     SETOF                     90    *
     C                     ENDIF
     C                     ELSE
     C                     SETOF                     90    *
     C                     ENDIF
     C           *IN90     IFEQ '0'
      * Array element not found
     C                     MOVEL'Y2U0005' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '1'
      * Sequence through qualified elements:
     C                     Z-ADDY         YR02    50
     C           YR02      DOWLEYL02
     C                     Z-ADDYR02      Y
     C                     MOVELYK02,Y    YD02
     C           YI02      OCUR YM02
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: DB1.Scheduled Delivery Date LT WRK.Scheduled Delivery Date
     C           WFEIDT    IFLT WUEIDT                     *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL'CHKERR'  W0RTN            *Return code
     C                     GOTO TDEXIT                     *QUIT
     C                     END                             *FI
     C                     Z-ADDWFEIDT    WUEIDT           Requested Deliv
     C                     ADD  1         YR02
     C                     ENDDO
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * RTV Del All Stops      RT - *Arrays  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD1         Y       50
     C           YL02      IFGT 0
     C                     MOVELYK02,Y    YD02
     C           YI02      OCUR YM02
     C                     ELSE
      * Array element not found
     C                     MOVEL'Y2U0005' W0RTN   7
     C                     ENDIF
      *
      * Sequence through qualified elements:
     C                     Z-ADDY         YR02    50
     C           YR02      DOWLEYL02
     C                     Z-ADDYR02      Y
     C                     MOVELYK02,Y    YD02
     C           YI02      OCUR YM02
      * USER: Process Data record
      * DEL All Stops          DL - *Arrays  * 
     C                     EXSR TFDLRC
     C                     ADD  1         YR02
     C                     ENDDO
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFDLRC    BEGSR
      *================================================================
      * DEL All Stops          DL - *Arrays  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to Load Planning Stop/Date
     C                     Z-ADDWFRVNB    YI0201           Stop/Drop
      *
      * Reset global index if not within range of current elements
     C           Y         IFGT YL02
     C                     Z-ADD1         Y
     C                     ENDIF
      * Only search if not already pointing to correct element
     C           Y         IFGT 0
     C           YD02      ANDNEYK02,Y
      * Initialize internal index
     C                     Z-ADD*ZERO     YI02
      * Only search if key is not beyond range of current elements
     C           YL02      IFGT 0
     C           YK02,YL02 ANDGTYD02
      * Set search index to first element of array
     C                     Z-ADD1         Y       50
     C           YD02      LOKUPYK02,Y               90    Look for >
     C                     ELSE
     C                     SETOF                     90    *
     C                     ENDIF
     C           *IN90     IFEQ '1'
      * Move to data structure for comparison
     C                     MOVELYK02,Y    YD02
      * Compare
     C           YI0201    IFNE WFRVNB
      *
     C                     SETOF                     90    *
     C                     ENDIF
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * Element not found in array
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     GOTO TFEXIT
     C                     ENDIF
     C                     ENDIF
      *
      * Adjust RTVOBJ index to reflect position of added/removed element
     C           YR02      IFGT 0
     C           YR02      ANDLE100
     C           YK02,YR02 ANDGEYD02
     C                     SUB  1         YR02    50
     C                     ENDIF
      *
      * Initialize keys in array but retain index to MODS for later reuse
     C                     Z-ADDYI02      YISAV   50
     C                     MOVEL*HIVAL    YD02
     C                     Z-ADDYISAV     YI02
     C                     MOVELYD02      YK02,Y
      * Sort array to compress out deleted element
     C                     SORTAYK02
      * Adjust number of elements currently in array
     C                     SUB  1         YL02
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * RTV Deliv Dts for Edt  RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/12/04 SLM PKTR01 Multi-Company - Function was changed
      *                                     to remove Company RST or Pos
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGRMNB    WQTG02           Load ID
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           WQTG02           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    WQTG02           Load ID
      * Establish starting position
     C           KRSTG     SETLL@BFCPZH                    *
     C           KRSTG     READE@BFCPZH                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     P1EIDT           Requested Deliv
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWGEIDT    P1EIDT           Requested Deliv
     C           KRSTG     READE@BFCPZH                  90*
     C                     ENDDO
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * RTV All Header Fields  RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WEAIC3           Company Number
     C                     Z-ADD#1C4NB    WEC4NB           Order Number
      * Establish starting position
     C           KRSTH     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEJNCD    #1JNCD           Order Type - Sa
     C                     Z-ADDWEANC7    #1ANC7           A/R Customer Nu
     C                     Z-ADDWEBKC7    #1BKC7           Ship To Custome
     C                     MOVELWEBRTX    #1BRTX           Ship To Name
     C                     MOVELWEHMNA    #1HMNA           Ship To Address
     C                     MOVELWEHONA    #1HONA           Ship To Address
     C                     MOVELWEHPNA    #1HPNA           Ship To Address
     C                     MOVELWEHNNA    #1HNNA           Ship To City
     C                     MOVELWEDBCD    #1DBCD           Ship To State C
     C                     MOVELWECKTX    #1CKTX           Ship To Zip/Pos
     C                     Z-ADDWEB0C7    #1B0C7           Bill to Custome
     C                     MOVELWEAETX    #1AETX           Bill to Name
     C                     MOVELWEB1NA    #1B1NA           Bill to Address
     C                     MOVELWEB3NA    #1B3NA           Bill to Address
     C                     MOVELWEB4NA    #1B4NA           Bill to Address
     C                     MOVELWEB2NA    #1B2NA           Bill to City
     C                     MOVELWEBHCD    #1BHCD           Bill to State C
     C                     MOVELWEC8TX    #1C8TX           Bill to Zip/Pos
     C                     MOVELWEBCNA    #1BCNA           Customer Purcha
     C                     Z-ADDWEA0DT    #1A0DT           Order Date
     C                     Z-ADDWEA5DT    #1A5DT           Requested Ship
     C                     Z-ADDWEGNDT    #1GNDT           Actual Shipped
     C                     Z-ADDWEACDT    #1ACDT           Cancel Date
     C                     MOVELWEAQCD    #1AQCD           Terms Code
     C                     MOVELWEB6NA    #1B6NA           Special Instruc
     C                     MOVELWEBYNA    #1BYNA           Special Instruc
     C                     MOVELWEBZNA    #1BZNA           Carrier Code
     C                     MOVELWEGTST    #1GTST           Comment Print A
     C                     MOVELWEGVST    #1GVST           Comment Print I
     C                     MOVELWEGUST    #1GUST           Comment Print P
     C                     MOVELWEQFST    #1QFST           Comment Print S
     C                     MOVELWECQCD    #1CQCD           Reason Code
     C                     MOVELWEGJST    #1GJST           Order in Use
     C                     MOVELWEGWST    #1GWST           Header Status
     C                     MOVELWEGXST    #1GXST           Header Status L
     C                     MOVELWEGYST    #1GYST           Order Type Prin
     C                     Z-ADDWEAODT    #1AODT           Scheduled Ship
     C                     MOVELWEAIVN    #1AIVN           User Original E
     C                     Z-ADDWECXDT    #1CXDT           Date of Origina
     C                     Z-ADDWEJZVA    #1JZVA           Order Value Tot
     C                     Z-ADDWEA1WG    #1A1WG           Order Weight To
     C                     MOVELWEXIST    #1XIST           Credit Hold
     C                     MOVELWEXJST    #1XJST           Production Hold
     C                     MOVELWEXKST    #1XKST           New Customer Ho
     C                     Z-ADDWEEIDT    #1EIDT           Requested Deliv
     C                     Z-ADDWEAFTM    #1AFTM           Requested Deliv
     C                     MOVELWEE8CD    #1E8CD           Accounts Receiv
     C                     MOVELWEE9CD    #1E9CD           Accounts Receiv
     C                     Z-ADDWERMNB    #1RMNB           Load ID
     C                     Z-ADDWETBNB    #1TBNB           Absorbed Freigh
     C                     Z-ADDWER1NB    #1R1NB           Rated Freight
     C                     MOVELWEPJST    #1PJST           LTL Flag
     C                     MOVELWEU0ST    #1U0ST           Price Audit
     C                     MOVELWEU1ST    #1U1ST           Price Status
     C                     MOVELWEQ2CD    #1Q2CD           Shipping Method
     C                     MOVELWEU2ST    #1U2ST           Export Status
     C                     MOVELWEVEST    #1VEST           Palletize
     C                     MOVELWEVFST    #1VFST           Shrink Wrap
     C                     MOVELWEVGST    #1VGST           Slip Sheet
     C                     MOVELWERPCD    #1RPCD           Age Code
     C                     Z-ADDWERNNB    #1RNNB           Reefer Temperat
     C                     MOVELWEVDST    #1VDST           Load Type
     C                     Z-ADDWEATIN    #1ATIN           Attach to Invoi
     C                     MOVELWEU4ST    #1U4ST           Load Plan Order
     C                     MOVELWEU5ST    #1U5ST           Print Pick Slip
     C                     Z-ADDWERSRN    #1RSRN           Resell Referenc
     C                     MOVELWEMHNA    #1MHNA           Special Comment
     C                     MOVELWEMINA    #1MINA           Special Comment
     C                     MOVELWEWBST    #1WBST           Affect Auto Acc
     C                     MOVELWER4CD    #1R4CD           Sales Route Cod
     C                     MOVELWEBFCD    #1BFCD           Manager Level C
     C                     MOVELWEQ4CD    #1Q4CD           VP Level Code
     C                     Z-ADDWET3NB    #1T3NB           Attach to Order
     C                     MOVELWESICD    #1SICD           Reason for Pric
     C                     Z-ADDWECONB    #1CONB           Invoice Number
     C                     MOVELWECEST    #1CEST           Invoice Suffix
     C                     Z-ADDWEAWDT    #1AWDT           Invoice Date
     C                     MOVELWEJPCD    #1JPCD           Event Code
     C                     MOVELWEXUST    #1XUST           Trans Contol AS
     C                     MOVELWEZ1ST    #1Z1ST           Modified Flag
     C                     Z-ADDWEVRVA    #1VRVA           A/R order Value
     C                     MOVELWEOBST    #1OBST           Billing Activit
     C                     MOVELWEBCST    #1BCST           Block Order Fla
     C                     MOVELWEBDST    #1BDST           Order Certifica
     C                     MOVELWEUVST    #1UVST           EDI Status 1
     C                     MOVELWEUWST    #1UWST           EDI Status 2
     C                     MOVELWEUXST    #1UXST           EDI Status 3
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * RTV Deadln DepartDT/TM RT - OM Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHRMNB    WQTI02           Load ID
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           WQTI02           Load ID
      * Setup key
     C                     Z-ADDWL0032    WQTI02           Load ID
      * Establish starting position
     C           KRSTI     SETLL@FJCPSB                    *
     C           KRSTI     READE@FJCPSB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0033           Deadline Depart
     C                     Z-ADD*ZERO     WL0034           Deadline Depart
     C                     GOTO TIEXIT                     *QUIT
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWHKZDT    WL0033           Deadline Depart
     C                     Z-ADDWHAXTM    WL0034           Deadline Depart
     C                     GOTO TIEXIT                     *QUIT
     C           KRSTI     READE@FJCPSB                  90*
     C                     ENDDO
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * RTV Country Code       RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1BKC7    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSTJ     CHAIN@BBREE9              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBKXCD    YL0025           Country Code
     C                     ENDIF
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKRVGN    BEGSR
      *================================================================
      * RTV Ship To City/State RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTK     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WEAIC3           Company Number
     C                     Z-ADD#1C4NB    WEC4NB           Order Number
      * Establish starting position
     C           KRSTK     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEHNNA    WUGUNA           Ship To City
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * RTV Stop Customer      RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIRMNB    WQTL02           Load ID
     C           *LIKE     DEFN WIRVNB    WQTL03           Stop/Drop
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           WQTL02           Load ID
     C                     KFLD           WQTL03           Stop/Drop
      * Setup key
     C                     Z-ADD#2RMNB    WQTL02           Load ID
     C                     Z-ADD#RTENB    WQTL03           Stop/Drop
      * Establish starting position
     C           KRSTL     SETLL@FLCPEB                    *
     C           KRSTL     READE@FLCPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD*ZERO     WUAJNB           Customer Number
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Customer Number    RT - Order Header TRG  * 
     C                     EXSR TMRVGN
     C           KRSTL     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMRVGN    BEGSR
      *================================================================
      * Rtv Customer Number    RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTM     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
      * Setup key
     C                     Z-ADDWIAIC3    WEAIC3           Company Number
     C                     Z-ADDWIC4NB    WEC4NB           Order Number
      * Establish starting position
     C           KRSTM     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUAJNB           Ship To Custome
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWEBKC7    WUAJNB           Ship To Custome
     C                     ENDIF
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNRVGN    BEGSR
      *================================================================
      * RTV Stop Customer      RT - *Arrays  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C           YL01      IFGT 0
      * Set search index to first element of array
     C                     Z-ADD1         Y       50
     C                     MOVELYK01,Y    YD01
     C           YI01      OCUR YM01
      * Initialize internal index
     C                     MOVEL*LOVAL    YD01
      * Move key fields to Load Planning Stop Cust
     C                     Z-ADD#RTENB    YI0101           Stop/Drop
      *
      * Only search if key is not beyond range of current elements
     C           YK01,YL01 IFGT YD01
     C           YD01      LOKUPYK01,Y               90    Look for >
     C                     ELSE
     C                     SETOF                     90    *
     C                     ENDIF
     C                     ELSE
     C                     SETOF                     90    *
     C                     ENDIF
     C           *IN90     IFEQ '1'
      * Move to data structure for comparison
     C                     MOVELYK01,Y    YD01
      * Compare
     C           YI0101    IFNE #RTENB
      *
     C                     SETOF                     90    *
     C                     ENDIF
     C                     ENDIF
     C           *IN90     IFEQ '0'
      * Array element not found
     C                     MOVEL'Y2U0005' W0RTN   7
     C                     ENDIF
      *
     C           *IN90     IFEQ '1'
     C           YI01      OCUR YM01
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBBKC7    WUAJNB           Ship To Custome
     C                     GOTO TNEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TORVGN    BEGSR
      *================================================================
      * RTV UM/Whs Code Lmt,Bx RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WUTAST           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJAIC3    WQTO01           Company Number
     C           *LIKE     DEFN WJC4NB    WQTO02           Order Number
      * Define keylist
     C           KPSTO     KLIST
     C                     KFLD           WQTO01           Company Number
     C                     KFLD           WQTO02           Order Number
     C                     KFLD           WJDPNB           Order Sequence
     C                     KFLD           WJUENB           Order Secondary
      * Define keylist
     C           KRSTO     KLIST
     C                     KFLD           WQTO01           Company Number
     C                     KFLD           WQTO02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQTO01           Company Number
     C                     Z-ADD#1C4NB    WQTO02           Order Number
     C                     Z-ADD1         WJDPNB           Order Sequence
     C                     Z-ADD1         WJUENB           Order Secondary
      * Establish starting position
     C           KPSTO     SETLL@BGWKL1                    *
     C           KRSTO     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUCBAA           Warehouse Code
     C                     MOVEL*BLANK    YL0019           USR Unit of Mea
     C                     Z-ADD*ZERO     YL0026           Boxes Total Qua
     C                     Z-ADD*ZERO     WUH8WG           USR Weight   9.
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO TOEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PF3280 -- add "Cases" to the case-stmt
     C                     MOVELWJAJCD    WUCBAA           Warehouse Code
      * CASE:
      *  - c1ORc2ORc3ORc4
      *   |- c1    : DB1.U/M - Ordered is Combos
      *   |- c2    : DB1.U/M - Ordered is EQ Boxes
      *   |- c3    : DB1.U/M - Ordered is Mixed
      *   |- c4    : DB1.U/M - Ordered is Cases
      *   '-
     C           WJAGCD    IFEQ 'CB'                       *IF
     C           WJAGCD    OREQ 'BX'                       *OR
     C           WJAGCD    OREQ 'MX'                       *OR
     C           WJAGCD    OREQ 'CS'                       *OR
      * CASE: DB1.Detail Line Status is Cancelled
     C           WJGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * S17054 DN 04/09/21-Beyond this point, changed all 'U/M - Ordered'
      *   to reference LCL Context instead of DB1.
      * S17054 DN 04/09/21-Count Type 'Cases' (CS) as 'Boxes' (BX).
      * CASE: *OTHERWISE
     C                     MOVELWJAGCD    YL0027           U/M - Ordered
      * CASE: LCL.U/M - Ordered is Cases
     C           YL0027    IFEQ 'CS'                       *IF
     C                     MOVEL'BX'      YL0027           U/M - Ordered
     C                     END                             *FI
      * Accumulate the Box Quantity for slotting consideration 6/12/01
      * CASE: LCL.U/M - Ordered is EQ Boxes
     C           YL0027    IFEQ 'BX'                       *IF
     C                     ADD  WJAVQT    YL0026           Boxes Total Qua
     C                     END                             *FI
     C                     ADD  WJAUWG    WUH8WG           USR Weight   9.
      * CASE: PAR.USR Unit of Measure is *Blank
     C           YL0019    IFEQ *BLANK                     *IF
     C                     MOVELYL0027    YL0019           USR Unit of Mea
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.U/M - Ordered EQ PAR.USR Unit of Measure
     C           YL0027    IFEQ YL0019                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'MX'      WUAGCD           U/M - Ordered
     C                     MOVELWUAGCD    YL0019           USR Unit of Mea
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTO     READE@BGWKL1                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: PAR.USR Unit of Measure is Mixed
     C           YL0019    IFEQ 'MX'                       *IF
      * RTV Numeric Value      RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0035           Company Number
     C                     MOVEL'BOXLOAD' WL0036    P      Company Value C
     C                     EXSR TPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0037    YL0028           System Value Nu
      * CASE: PAR.Boxes Total Quantity LT LCL.Box Load Min Box Qty USR
     C           YL0026    IFLT YL0028                     *IF
     C                     MOVEL'CB'      YL0019           USR Unit of Mea
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'BX'      YL0019           USR Unit of Mea
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPRVGN    BEGSR
      *================================================================
      * RTV Numeric Value      RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTP     KLIST
     C                     KFLD           KMAIC3           Company Number
     C                     KFLD           KMV8CD           Company Value C
      * Setup key
     C                     Z-ADDWL0035    KMAIC3           Company Number
     C                     MOVELWL0036    KMV8CD           Company Value C
      * Establish starting position
     C           KRSTP     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDKMM8NB    WL0037           System Value Nu
     C                     ENDIF
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQRVGN    BEGSR
      *================================================================
      * RTV Warehouse Type     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTQ     KLIST
     C                     KFLD           WCAJCD           Warehouse Code
      * Setup key
     C                     MOVELWUCBAA    WCAJCD           Warehouse Code
      * Establish starting position
     C           KRSTQ     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUJFSX           Warehouse Type
     C                     GOTO TQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCWPST    WUJFSX           Warehouse Type
     C                     ENDIF
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTR     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWL0038    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSTR     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    WL0039           Allow Multi-Com
     C                     MOVELDRMPNA    WL0040           Default Printer
     C                     MOVELDRBCCD    WL0041           Salesperson Cod
     C                     Z-ADDDRAIC3    WL0042           Company Number
     C                     MOVELDRBUVN    WL0043           User Code Model
     C                     ENDIF
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         TSRVGN    BEGSR
      *================================================================
      * RTV First Default Co  RT - Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DTAJVN    WQTS01           User Profile Na
      * Define keylist
     C           KRSTS     KLIST
     C                     KFLD           WQTS01           User Profile Na
      * Setup key
     C                     MOVELWL0044    WQTS01           User Profile Na
      * Establish starting position
     C           KRSTS     SETLL@DTRETE                    *
     C           KRSTS     READE@DTRETE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0767' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0045           Company Number
     C                     GOTO TSEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0045           Company Number
     C                     GOTO TSEXIT                     *QUIT
     C           KRSTS     READE@DTRETE                  90*
     C                     ENDDO
      *================================================================
     CSR         TSEXIT    ENDSR
      /EJECT
     CSR         TTRVGN    BEGSR
      *================================================================
      * PFS Val Order Picked  RT - PFS Ship Load/Order Sts  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BKZGNX    WQTT01           PFS Load ID
      * Define keylist
     C           KRSTT     KLIST
     C                     KFLD           WQTT01           PFS Load ID
      * Setup key
     C                     Z-ADD#2RMNB    WQTT01           PFS Load ID
      * Establish starting position
     C           KRSTT     SETLL@BKCPEK                    *
     C           KRSTT     READE@BKCPEK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3504' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WUZMST           Pick Status USR
     C                     GOTO TTEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUZMST           Pick Status USR
     C                     GOTO TTEXIT                     *QUIT
     C           KRSTT     READE@BKCPEK                  90*
     C                     ENDDO
      *================================================================
     CSR         TTEXIT    ENDSR
      /EJECT
     CSR         TUCRRC    BEGSR
      *================================================================
      * CRT Load Header        CR - Load Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0146  1        Load Held Over
     C                     MOVEL*BLANK    WN0147  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0148  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0149  1        LH Power Only L
     C                     MOVEL*BLANK    WN0150  1        MG Created Load
     C                     MOVEL*BLANK    WN0151  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0152  2        Load U/M
     C                     MOVEL*BLANK    WN0153  2        LH Unused Sts 8
     C                     Z-ADD*ZERO     WN0154  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0155  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0156  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0157  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0158  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0159  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0160  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0161  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0162  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0163  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0164  60       LH Unused Time
     C                     MOVEL*BLANK    WN0165  1        EDI Status 1
     C                     MOVEL*BLANK    WN0166  1        EDI Status 2
     C                     MOVEL*BLANK    WN0167  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0168  60       Job Time
     C                     MOVEL*BLANK    WN0169 10        User Id
     C                     MOVEL*BLANK    WN0170 10        Job Name
     C                     Z-ADD*ZERO     WN0171  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FJCPBO
     C                     Z-ADD#2RMNB    WDRMNB           Load ID
     C                     Z-ADD#2AIC3    WDAIC3           Company Number
     C                     Z-ADD#CHODT    WDAODT           Scheduled Ship
     C                     MOVELWUPJST    WDPJST           LTL Flag
     C                     MOVEL'E'       WDPKST           Load Status
     C                     Z-ADD*ZERO     WDRNNB           Reefer Temperat
     C                     MOVEL*BLANK    WDDMTX           Seal 1
     C                     MOVEL*BLANK    WDDNTX           Seal 2
     C                     MOVEL*BLANK    WDDOTX           Seal 3
     C                     MOVEL*BLANK    WDWTTX           Seal 4
     C                     MOVEL*BLANK    WDWUTX           Seal 2 Unused
     C                     Z-ADD#PRPNB    WDRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WDFLAM           Flat Amount
     C                     MOVEL#CQ7ST    WDXQST           Allocate Pounds
     C                     Z-ADD*ZERO     WDRRNB           Total Stops
     C                     MOVEL*BLANK    WDDXTX           Trailer Id
     C                     MOVEL*BLANK    WDDYTX           Transloader Car
     C                     Z-ADD*ZERO     WDSBNB           BOL Time
     C                     MOVEL#2BZNA    WDBZNA           Carrier Code
     C                     MOVEL#PRONB    WDRONB           Truck Size
     C                     Z-ADD*ZERO     WDSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     MOVEL'O'       WDVCST           Ship Status
     C                     MOVEL#2VDST    WDVDST           Load Type
     C                     Z-ADD*ZERO     WDSDNB           Number Pallets
     C                     Z-ADD*ZERO     WDPAOU           Number Pallets
     C                     Z-ADD*ZERO     WDDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WDSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WDHADT           Actual Arrival
     C                     Z-ADD*ZERO     WDAART           Actual Arrival
     C                     Z-ADD*ZERO     WDDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WDDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WDAQDT           Actual Departur
     C                     Z-ADD*ZERO     WDS6NB           Departure Time
     C                     Z-ADD*ZERO     WDT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WDPRTM           Product Tempera
     C                     Z-ADD*ZERO     WDNPSV           Number Spacers
     C                     MOVEL*BLANK    WDJ8TX           Car/Veh. Initia
     C                     Z-ADD*ZERO     WDTLMI           Total Load Mile
     C                     MOVEL*BLANK    WDJ9TX           Recorder ID
     C                     MOVEL#CCUST    WDQ2CD           Shipping Method
     C                     MOVEL*BLANK    WDVPCD           Ship From Wareh
     C                     MOVEL*BLANK    WDDBCD           Ship To State C
     C                     Z-ADD*ZERO     WDGRWE           Gross Weight
     C                     MOVEL*BLANK    WDXCCD           Carrier Broker
     C                     MOVEL*BLANK    WDU2ST           Export Status
     C                     Z-ADD*ZERO     WDF9DT           Actual Ship Dat
     C                     MOVEL*BLANK    WDONTM           On Time - (Y/N)
     C                     Z-ADD*ZERO     WDJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WDTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WDJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WDSPTM           Spotted Time
     C                     Z-ADD*ZERO     WDJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WDLFTM           Load Finished T
     C                     Z-ADD*ZERO     WDJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WDBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WDJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WDBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WDKIDT           Truck Departure
     C                     Z-ADD*ZERO     WDASTM           Truck Departure
     C                     Z-ADD*ZERO     WDKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WDAJCM           Adjusted Depart
     C                     MOVEL*BLANK    WDXACD           Shipping Line
     C                     MOVEL*BLANK    WDOANA           Port Delv Termi
     C                     MOVEL*BLANK    WDK4TX           Vessel Name
     C                     Z-ADD*ZERO     WDVOAG           Voyage
     C                     Z-ADD*ZERO     WDKBDT           Sail Date
     C                     MOVEL*BLANK    WDNBBO           Booking Number
     C                     MOVEL*BLANK    WDW4CD           Discharge Port
     C                     Z-ADD*ZERO     WDEFDT           Arrival Date
     C                     MOVEL*BLANK    WDCNTN           Container Numbe
     C                     Z-ADD*ZERO     WDKCDT           Date In
     C                     Z-ADD*ZERO     WDTMIN           Time In
     C                     Z-ADD*ZERO     WDKDDT           Date Out
     C                     Z-ADD*ZERO     WDVMNB           Time Out
     C                     Z-ADD*ZERO     WDOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WDKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WDATTM           Scheduled Deliv
     C                     MOVELWUGSTX    WDOTRS           LH Unused Sts
     C                     MOVELWUGSTX    WDRNST           LH Carrier Paym
     C                     Z-ADD*ZERO     WDBRBK           Bring Back Mile
     C                     Z-ADDP1EIDT    WDEIDT           Requested Deliv
     C                     MOVEL'A'       WDRMST           Load Acceptance
     C                     MOVEL*BLANK    WDAJCD           Warehouse Code
     C                     Z-ADD*ZERO     WDKKDT           On Yard Date
     C                     Z-ADD*ZERO     WDAVTM           On Yard Time
     C                     Z-ADD*ZERO     WDKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WDAXTM           Deadline Depart
     C                     MOVELWUGSTX    WDLHOS           Load Held Over
     C                     MOVEL*BLANK    WDWNTX           Load Held Over
     C                     MOVEL*BLANK    WDOITX           Ocean BOL Numbe
     C                     MOVEL*BLANK    WDOJTX           Express Mail Nu
     C                     Z-ADD*ZERO     WDLLDT           Express Mail Da
     C                     MOVELWULSHG    WDLSHG           Load Shag Flag
     C                     MOVELWUYPST    WDYPST           Load Wash Flag
     C                     Z-ADD*ZERO     WDK0DT           Product Complet
     C                     Z-ADD*ZERO     WDAYTM           Product Complet
     C                     Z-ADD*ZERO     WDKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WDICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WDIDWG           Tot Pallet Tare
     C                     MOVEL'N'       WDH9SX           Load Confirmed
     C                     MOVEL*BLANK    WDWOTX           Load Confirmed
     C                     Z-ADD*ZERO     WDK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WDAZTM           Load Door 1
     C                     Z-ADD*ZERO     WDK2DT           Override Total
     C                     Z-ADD*ZERO     WDA0TM           Load Door 2
     C                     MOVELWUGSTX    WDROST           Partial Load
     C                     MOVELWUGSTX    WDRPST           Load Confirmati
     C                     MOVEL'N'       WDRQST           Export Load USD
     C                     MOVELWUGSTX    WDRRST           Late Delivery E
     C                     Z-ADD*ZERO     WDZBVA           Load Actual Fre
     C                     MOVEL*BLANK    WDWPTX           Hide on WW Load
     C                     MOVEL*BLANK    WDWQTX           Late Billing Em
     C                     MOVEL*BLANK    WDWRTX           Shipping Temp C
     C                     MOVEL*BLANK    WDWSTX           LH Held Over Rs
     C                     MOVEL'N'       WDRVSX           Multi Company L
     C                     MOVELWUUAT1    WDR1SX           TPM Shipment St
     C                     MOVEL*BLANK    WDR3SX           LH On-Time Reas
     C                     MOVEL*BLANK    WDR4SX           LH Held Over Re
     C                     Z-ADD*ZERO     WDP1DT           TPM Planned Shi
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##JOB     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * ***** Change Log and Comments
     C                     EXSR UFSUBR                     ***** Change Lo
     C           KLCRTU    KLIST
     C                     KFLD           WDRMNB           Load ID
      * Check for duplicate primary key
     C           KLCRTU    SETLL@FJCPBO                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1189' W0RTN   7
      * Send message 'Load Header            EX'
     C                     MOVEL'USR1189' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TUEXIT
     C                     ENDIF
      *
     C                     WRITE@FJCPBO                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TUEXIT    ENDSR
      /EJECT
     CSR         TVRVGN    BEGSR
      *================================================================
      * Rtv/Chg Sched Shp Dt   RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTV     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDWL0046    FJRMNB           Load ID
      * Establish starting position
     C           KRSTV     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CHG Schedule Ship Date CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFJRMNB    WL0048           Load ID
     C                     Z-ADDWL0047    WL0049           Scheduled Ship
     C                     EXSR TWCHRC
     C                     ENDIF
      *================================================================
     CSR         TVEXIT    ENDSR
      /EJECT
     CSR         TWCHRC    BEGSR
      *================================================================
      * CHG Schedule Ship Date CH - Load Header  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0172  30       Company Number
     C                     MOVEL*BLANK    WN0173  1        LTL Flag
     C                     MOVEL*BLANK    WN0174  1        Load Status
     C                     Z-ADD*ZERO     WN0175  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0176 15        Seal 1
     C                     MOVEL*BLANK    WN0177 15        Seal 2
     C                     MOVEL*BLANK    WN0178 15        Seal 3
     C                     MOVEL*BLANK    WN0179 15        Seal 4
     C                     MOVEL*BLANK    WN0180 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0181  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0182 112       Flat Amount
     C                     MOVEL*BLANK    WN0183  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0184  50       Total Stops
     C                     MOVEL*BLANK    WN0185 20        Trailer Id
     C                     MOVEL*BLANK    WN0186  3        Transloader Car
     C                     Z-ADD*ZERO     WN0187  40       BOL Time
     C                     MOVEL*BLANK    WN0188  3        Carrier Code
     C                     MOVEL*BLANK    WN0189  7        Truck Size
     C                     Z-ADD*ZERO     WN0190  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0191 112       Rated Freight
     C                     MOVEL*BLANK    WN0192  1        Ship Status
     C                     MOVEL*BLANK    WN0193  1        Load Type
     C                     Z-ADD*ZERO     WN0194  50       Number Pallets
     C                     Z-ADD*ZERO     WN0195  50       Number Pallets
     C                     Z-ADD*ZERO     WN0196 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0197  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0198  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0199  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0200 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0201 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0202  70       Actual Departur
     C                     Z-ADD*ZERO     WN0203  40       Departure Time
     C                     Z-ADD*ZERO     WN0204  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0205  52       Product Tempera
     C                     Z-ADD*ZERO     WN0206  50       Number Spacers
     C                     MOVEL*BLANK    WN0207 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0208  70       Total Load Mile
     C                     MOVEL*BLANK    WN0209 12        Recorder ID
     C                     MOVEL*BLANK    WN0210  2        Shipping Method
     C                     MOVEL*BLANK    WN0211  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0212  2        Ship To State C
     C                     Z-ADD*ZERO     WN0213  70       Gross Weight
     C                     MOVEL*BLANK    WN0214  3        Carrier Broker
     C                     MOVEL*BLANK    WN0215  1        Export Status
     C                     Z-ADD*ZERO     WN0216  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0217  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0218  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0219  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0220  70       Spotted Date
     C                     Z-ADD*ZERO     WN0221  60       Spotted Time
     C                     Z-ADD*ZERO     WN0222  70       Load Finished D
     C                     Z-ADD*ZERO     WN0223  60       Load Finished T
     C                     Z-ADD*ZERO     WN0224  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0225  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0226  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0227  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0228  70       Truck Departure
     C                     Z-ADD*ZERO     WN0229  60       Truck Departure
     C                     Z-ADD*ZERO     WN0230  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0231  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0232  3        Shipping Line
     C                     MOVEL*BLANK    WN0233 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0234 30        Vessel Name
     C                     Z-ADD*ZERO     WN0235  50       Voyage
     C                     Z-ADD*ZERO     WN0236  70       Sail Date
     C                     MOVEL*BLANK    WN0237 12        Booking Number
     C                     MOVEL*BLANK    WN0238 20        Discharge Port
     C                     Z-ADD*ZERO     WN0239  70       Arrival Date
     C                     MOVEL*BLANK    WN0240 12        Container Numbe
     C                     Z-ADD*ZERO     WN0241  70       Date In
     C                     Z-ADD*ZERO     WN0242  60       Time In
     C                     Z-ADD*ZERO     WN0243  70       Date Out
     C                     Z-ADD*ZERO     WN0244  60       Time Out
     C                     Z-ADD*ZERO     WN0245 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0246  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0247  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0248  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0249  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0250  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0251  70       Requested Deliv
     C                     MOVEL*BLANK    WN0252  1        Load Acceptance
     C                     MOVEL*BLANK    WN0253  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0254  70       On Yard Date
     C                     Z-ADD*ZERO     WN0255  60       On Yard Time
     C                     Z-ADD*ZERO     WN0256  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0257  60       Deadline Depart
     C                     MOVEL*BLANK    WN0258  1        Load Held Over
     C                     MOVEL*BLANK    WN0259  1        Load Held Over
     C                     MOVEL*BLANK    WN0260 15        Load Held Over
     C                     MOVEL*BLANK    WN0261 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0262 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0263  70       Express Mail Da
     C                     MOVEL*BLANK    WN0264  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0265  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0266  70       Product Complet
     C                     Z-ADD*ZERO     WN0267  60       Product Complet
     C                     Z-ADD*ZERO     WN0268  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0269  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0270  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0271  1        Load Confirmed
     C                     MOVEL*BLANK    WN0272 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0273  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0274  60       Load Door 1
     C                     Z-ADD*ZERO     WN0275  70       Override Total
     C                     Z-ADD*ZERO     WN0276  60       Load Door 2
     C                     MOVEL*BLANK    WN0277  1        Partial Load
     C                     MOVEL*BLANK    WN0278  1        Load Confirmati
     C                     MOVEL*BLANK    WN0279  1        Export Load USD
     C                     MOVEL*BLANK    WN0280  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0281 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0282 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0283 15        Late Billing Em
     C                     MOVEL*BLANK    WN0284 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0285 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0286  1        Multi Company L
     C                     MOVEL*BLANK    WN0287  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0288  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0289  1        LH Power Only L
     C                     MOVEL*BLANK    WN0290  1        MG Created Load
     C                     MOVEL*BLANK    WN0291  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0292  2        Load U/M
     C                     MOVEL*BLANK    WN0293  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0294  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0295  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0296  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0297  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0298  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0299  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0300  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0301  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0302  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0303  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0304  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0305  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0306  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0307  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0308  60       LH Unused Time
     C                     MOVEL*BLANK    WN0309  1        EDI Status 1
     C                     MOVEL*BLANK    WN0310  1        EDI Status 2
     C                     MOVEL*BLANK    WN0311  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0312  60       Job Time
     C                     MOVEL*BLANK    WN0313 10        User Id
     C                     MOVEL*BLANK    WN0314 10        Job Name
     C                     Z-ADD*ZERO     WN0315  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWL0048    WDRMNB           Load ID
      *
     C           KLCHTW    KLIST
     C                     KFLD           WDRMNB           Load ID
     C           KLCHTW    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TWEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TWEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YBRDCS
      * USER: Processing after Data read
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##JOB     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * Move non-key fields to @FJCPBO
     C                     Z-ADDWL0049    WDAODT           Scheduled Ship
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TWEXIT    ENDSR
      /EJECT
     CSR         TXRVGN    BEGSR
      *================================================================
      * RTV Load for Date Chg  RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
      * 06/09/2015 PKD/JH E4122 Changed RTV to include Hdr Sts=A|H|L for
      *                         changing the Requested Ship Date.
      * Declare restrictor key work fields
     C           *LIKE     DEFN WARMNB    WQTX02           Load ID
      * Define keylist
     C           KRSTX     KLIST
     C                     KFLD           WQTX02           Load ID
      * Setup key
     C                     Z-ADDWL0050    WQTX02           Load ID
      * Establish starting position
     C           KRSTX     SETLL@BFCPD9                    *
     C           KRSTX     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * 06/09/2015 PKD/JH e4122 Save Requested Ship Date for Change Log.
     C                     Z-ADDWAA5DT    YL0037           Requested Ship
      * 06/09/2015 E4122 Change Req Ship Date for Header Sts=E|A|H|L
      * CASE: DB1.Header Status is Avail/Alloc/Enter/Hold
     C           WAGWST    IFEQ 'L'                        *IF
     C           WAGWST    OREQ 'A'
     C           WAGWST    OREQ 'E'
     C           WAGWST    OREQ 'H'
     C                     Z-ADDWL0051    WUA5DT           Requested Ship
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWAA5DT    WUA5DT           Requested Ship
     C                     END                             *FI
      * 06/17/2015 Added Deallocate/Allocate process before change to OD.
      * RTV Orders for Dt Chg RT - Order Detail  * 
     C                     EXSR TYRVGN
      * CHG Sch Shp & Req Shp CH - Order Header TRG  * 
     C                     EXSR NACHRC
      * CRT Load/Order Chg Log XF - Load Order Change Log  * Sched Ship D
     C                     CLEARPDRC
     C                     Z-ADDWL0050    PDRMNB           Load ID
     C                     Z-ADD*ZERO     PDRVNB           Stop/Drop
     C                     MOVELWL0052    PDRVST    P      Load Change Typ
     C                     MOVELWL0053    PDUJST    P      Department Cont
     C                     MOVELWL0054    PDMNTX    P      Change Log Prio
     C                     MOVELWL0055    PDMOTX    P      Change Log New
     C                     MOVELWL0056    PDAYNA    P      User Id
     C                     MOVELWL0057    PDA0NA    P      Job Name
     C                     MOVELWL0058    PDBZNA    P      Carrier Code
     C                     Z-ADDWAAIC3    PDAIC3           Company Number
     C                     Z-ADDWAC4NB    PDC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * 06/09/2015 PKD/JH E4122 Added Change Log for Requested Ship Date
     C                     MOVEL*BLANK    YL0040           Change Log Prio
     C                     MOVELYL0037    YL0040           Change Log Prio
     C                     MOVEL*BLANK    YL0041           Change Log New
     C                     MOVELWUA5DT    YL0041           Change Log New
      * CRT Load/Order Chg Log XF - Load Order Change Log  * Request Ship
     C                     CLEARPDRC
     C                     Z-ADDWL0050    PDRMNB           Load ID
     C                     Z-ADD*ZERO     PDRVNB           Stop/Drop
     C                     MOVEL'RQSSHP'  PDRVST    P      Load Change Typ
     C                     MOVELWL0053    PDUJST    P      Department Cont
     C                     MOVELYL0040    PDMNTX    P      Change Log Prio
     C                     MOVELYL0041    PDMOTX    P      Change Log New
     C                     MOVELWL0056    PDAYNA    P      User Id
     C                     MOVELWL0057    PDA0NA    P      Job Name
     C                     MOVELWL0058    PDBZNA    P      Carrier Code
     C                     Z-ADDWAAIC3    PDAIC3           Company Number
     C                     Z-ADDWAC4NB    PDC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C           KRSTX     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         TXEXIT    ENDSR
      /EJECT
     CSR         TYRVGN    BEGSR
      *================================================================
      * RTV Orders for Dt Chg RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 06/09/2015 PKD/JH E4122 Added Deallocate and Allocate Process
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJAIC3    WQTY01           Company Number
     C           *LIKE     DEFN WJC4NB    WQTY02           Order Number
      * Define keylist
     C           KPSTY     KLIST
     C                     KFLD           WQTY01           Company Number
     C                     KFLD           WQTY02           Order Number
     C                     KFLD           WJDPNB           Order Sequence
     C                     KFLD           WJUENB           Order Secondary
      * Define keylist
     C           KRSTY     KLIST
     C                     KFLD           WQTY01           Company Number
     C                     KFLD           WQTY02           Order Number
      * Setup key
     C                     Z-ADDWAAIC3    WQTY01           Company Number
     C                     Z-ADDWAC4NB    WQTY02           Order Number
     C                     Z-ADD1         WJDPNB           Order Sequence
     C                     Z-ADD1         WJUENB           Order Secondary
      * Establish starting position
     C           KPSTY     SETLL@BGWKL1                    *
     C           KRSTY     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DEALLOCATE
     C                     Z-ADDWJCCQT    YL0038           Quantity Schedu
     C                     Z-ADDWJAUWG    YL0039           Weight Schedule
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WJAIC3    WQ0090  30       Company Number
     C                     PARM WJC4NB    WQ0091  70       Order Number
     C                     PARM WJDPNB    WQ0092  30       Order Sequence
     C                     PARM WJUENB    WQ0093  30       Order Secondary
     C                     PARM WJHGCD    WQ0094  70       Item Code
     C                     PARM WJAJCD    WQ0095  3        Warehouse Code
     C                     PARM WJA5DT    WQ0096  70       Ship Date USR
     C                     PARM *ZERO     WQ0097 112       Quantity Ordere
     C                     PARM *ZERO     WQ0098 112       Weight Ordered
     C           YL0038    PARM YL0038    WQ0099 112       Quantity Schedu
     C           YL0039    PARM YL0039    WQ0100 112       Weight Schedule
     C                     PARM 'OD'      WQ0101  2        ATS Adj Type US
     C                     PARM ##PGM     WQ0102 10        PSAA Program Na
     C                     PARM WJRINY    WQ0103  40       Item Age Days
     C                     PARM WJTIDT    WQ0104  70       Production Ovr
     C                     PARM WJTJDT    WQ0105  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * ALLOCATE
     C                     Z-ADD*ZERO     YL0038           Quantity Schedu
     C                     Z-ADD*ZERO     YL0039           Weight Schedule
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WJAIC3    WQ0106  30       Company Number
     C                     PARM WJC4NB    WQ0107  70       Order Number
     C                     PARM WJDPNB    WQ0108  30       Order Sequence
     C                     PARM WJUENB    WQ0109  30       Order Secondary
     C                     PARM WJHGCD    WQ0110  70       Item Code
     C                     PARM WJAJCD    WQ0111  3        Warehouse Code
     C                     PARM WUA5DT    WQ0112  70       Ship Date USR
     C                     PARM WJAVQT    WQ0113 112       Quantity Ordere
     C                     PARM WJD0WG    WQ0114 112       Weight Ordered
     C           YL0038    PARM YL0038    WQ0115 112       Quantity Schedu
     C           YL0039    PARM YL0039    WQ0116 112       Weight Schedule
     C                     PARM 'OA'      WQ0117  2        ATS Adj Type US
     C                     PARM ##PGM     WQ0118 10        PSAA Program Na
     C                     PARM WJRINY    WQ0119  40       Item Age Days
     C                     PARM WJTIDT    WQ0120  70       Production Ovr
     C                     PARM WJTJDT    WQ0121  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Chg SchShip/ReqShp Dt CH - Order Detail  * 
     C                     EXSR TZCHRC
     C           KRSTY     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         TYEXIT    ENDSR
      /EJECT
     CSR         TZCHRC    BEGSR
      *================================================================
      * Chg SchShip/ReqShp Dt CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0316  70       Item Code
     C                     MOVEL*BLANK    WN0317  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0318  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0319  70       Order Group Cod
     C                     MOVEL*BLANK    WN0320  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0321  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0322 112       Billing Detail
     C                     Z-ADD*ZERO     WN0323 112       Billing Detail
     C                     Z-ADD*ZERO     WN0324 112       Billing Detail
     C                     Z-ADD*ZERO     WN0325 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0326  1        Comment Print A
     C                     MOVEL*BLANK    WN0327  1        Comment Print I
     C                     MOVEL*BLANK    WN0328  1        Comment Print P
     C                     MOVEL*BLANK    WN0329  1        Comment Print S
     C                     Z-ADD*ZERO     WN0330 112       Extended Amount
     C                     Z-ADD*ZERO     WN0331  70       Market Pricing
     C                     MOVEL*BLANK    WN0332  3        Commodity Marke
     C                     MOVEL*BLANK    WN0333  3        Date Method Cod
     C                     MOVEL*BLANK    WN0334  3        Price Method Co
     C                     Z-ADD*ZERO     WN0335 114       Price Overage O
     C                     Z-ADD*ZERO     WN0336  70       Contract Number
     C                     MOVEL*BLANK    WN0337  1        Price Status
     C                     Z-ADD*ZERO     WN0338  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0339  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0340  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0341  1        Work Confirm St
     C                     MOVEL*BLANK    WN0342  1        Work Over/Short
     C                     MOVEL*BLANK    WN0343  1        OD Production P
     C                     MOVEL*BLANK    WN0344 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0345 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0346  1        Age Code
     C                     MOVEL*BLANK    WN0347  1        Palletize
     C                     MOVEL*BLANK    WN0348  1        Slip Sheet
     C                     MOVEL*BLANK    WN0349  1        Catch Weight St
     C                     MOVEL*BLANK    WN0350  1        Price Audit
     C                     MOVEL*BLANK    WN0351  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0352  1        Production Date
     C                     Z-ADD*ZERO     WN0353 112       Rated Freight
     C                     Z-ADD*ZERO     WN0354 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0355 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0356 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0357 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0358 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0359 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0360 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0361 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0362 114       Unit Price
     C                     Z-ADD*ZERO     WN0363 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0364 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0365 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0366 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0367  70       Actual Shipped
     C                     MOVEL*BLANK    WN0368  1        Affect Inventor
     C                     MOVEL*BLANK    WN0369  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0370  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0371  30       Item Structure
     C                     Z-ADD*ZERO     WN0372  30       Item Structure
     C                     Z-ADD*ZERO     WN0373  30       Item Structure
     C                     MOVEL*BLANK    WN0374  2        Item Level
     C                     MOVEL*BLANK    WN0375  2        Quality Level
     C                     MOVEL*BLANK    WN0376  2        Pricing Product
     C                     MOVEL*BLANK    WN0377  2        Season Product
     C                     Z-ADD*ZERO     WN0378  70       Date of Origina
     C                     MOVEL*BLANK    WN0379 10        User Profile Na
     C                     MOVEL*BLANK    WN0380  6        Country Code
     C                     MOVEL*BLANK    WN0381  2        Event Code
     C                     MOVEL*BLANK    WN0382  3        Reason Code
     C                     MOVEL*BLANK    WN0383  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0384  1        Modified Flag
     C                     MOVEL*BLANK    WN0385  1        Substituted Fla
     C                     MOVEL*BLANK    WN0386  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0387 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0388 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0389  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0390  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0391  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0392  1        Affect Commissi
     C                     MOVEL*BLANK    WN0393  1        Affect Pricing
     C                     MOVEL*BLANK    WN0394  1        Released by Use
     C                     MOVEL*BLANK    WN0395  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0396  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0397  3        Production Ware
     C                     MOVEL*BLANK    WN0398  3        OD Price Type
     C                     Z-ADD*ZERO     WN0399  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0400  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0401  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0402  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0403  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0404  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0405  60       Price Code
     C                     Z-ADD*ZERO     WN0406  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0407  60       Substitution Li
     C                     Z-ADD*ZERO     WN0408  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0409 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0410 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0411 112       OD Item Target
     C                     Z-ADD*ZERO     WN0412 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0413 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0414 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0415 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0416 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0417 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0418 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0419 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0420 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0421 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0422  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0423  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0424  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0425 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0426  40       Item Age Days
     C                     Z-ADD*ZERO     WN0427  70       Production Ovr
     C                     Z-ADD*ZERO     WN0428  70       Production Ovr
     C                     MOVEL*BLANK    WN0429  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0430  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0431  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0432  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0433  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0434  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0435  1        EDI Status 1
     C                     MOVEL*BLANK    WN0436  1        EDI Status 2
     C                     MOVEL*BLANK    WN0437  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0438  60       Job Time
     C                     MOVEL*BLANK    WN0439 10        User Id
     C                     MOVEL*BLANK    WN0440 10        Job Name
     C                     Z-ADD*ZERO     WN0441  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWJAIC3    WKAIC3           Company Number
     C                     Z-ADDWJC4NB    WKC4NB           Order Number
     C                     Z-ADDWJDPNB    WKDPNB           Order Sequence
     C                     Z-ADDWJUENB    WKUENB           Order Secondary
      *
     C           KLCHTZ    KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKC4NB           Order Number
     C                     KFLD           WKDPNB           Order Sequence
     C                     KFLD           WKUENB           Order Secondary
     C           KLCHTZ    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TZEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TZEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YCRDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDWUA5DT    WKA5DT           Requested Ship
     C                     Z-ADDWL0051    WKAODT           Scheduled Ship
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WKAATM           Job Time
     C                     MOVEL##USR     WKAYNA           User Id
     C                     MOVEL##PGM     WKA0NA           Job Name
     C                     Z-ADD##JDT     WKAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TZEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** Change log and comments
      *================================================================
      * ** 01/18/2010 PKD E000261 Pass the Average Pallet Tare
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Record selection
      *================================================================
      * CASE: PAR.Load ID is NE Blank
     C           P1RMNB    IFNE *ZERO                      *IF
      * Select orders matching load id
      * CASE: CTL.Load ID EQ DB1.Load ID
     C           #2RMNB    IFEQ BERMNB                     *IF
      * CASE: CTL.USR Stop NE WRK.ZERO
     C           #CTENB    IFNE WUW0NB                     *IF
      * CASE: RCD.USR Stop GE CTL.USR Stop
     C           #RTENB    IFGE #CTENB                     *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.Load ID EQ WRK.ZERO
     C           BERMNB    IFEQ WUW0NB                     *IF
      * Only select if no CTL stop entered
      * CASE: CTL.USR Stop EQ WRK.ZERO
     C           #CTENB    IFEQ WUW0NB                     *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Select orders not on load - exclude Confirm,Complete,Cancel;multi
      * CASE: DB1.Load ID is Blank
     C           BERMNB    IFEQ *ZERO                      *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * CASE: CTL.USR Stop NE WRK.ZERO
     C           #CTENB    IFNE WUW0NB                     *IF
      * (should only select orders with a stop assigned)
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Exclude Confirmed,Complete,Cancelled.
      * CASE: DB1.Header Status is Conf/Comp/Canc
     C           BEGWST    IFEQ 'X'                        *IF
     C           BEGWST    OREQ 'C'
     C           BEGWST    OREQ 'R'
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Exclude orders set for non-load plan
      * CASE: DB1.Load Plan Order is no
     C           BEU4ST    IFEQ 'N'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Exclude orders with mismatching load types
      * CASE:
      *  - c2 AND c1
      *   |- c2    : CTL.Load Type is Bulk or Regular
      *   |- c1    : DB1.Load Type NE CTL.Load Type
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #2VDST    IFEQ 'B'                        *IF
     C           #2VDST    OREQ 'R'
     C           BEVDST    IFNE #2VDST                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Exclude Block Orders
      * CASE: DB1.Block Order Flag is Block Order
     C           BEBCST    IFEQ 'B'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * If TMSLDP is live for domestic only, only allow ES stay on as400
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.PFS Carlisle Active is Yes
      *   |- c2    : LCL.PFS AccuSort Active is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0011    IFEQ 'Y'                        *IF
     C           YL0012    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: LCL.OHE Override Type Code is ES
     C           YL0010    IFEQ 'ES'                       *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Mark Picked orders
      *================================================================
     C                     MOVEL*BLANK    #RLSNA           USR Picked
      * RTV Check Pick Event   RT - OP Order Events  * 
     C                     EXSR SORVGN
      * If Order has been picked, then mark as picked
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL@CN,001   #RLSNA           USR Picked
     C                     END                             *FI
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Update "last" ctl fields
      *================================================================
     C                     Z-ADD#2C4NB    WUC4NB           Order Number
     C                     Z-ADD#CFKNB    WUFKNB           USR Company Num
     C                     Z-ADD#CTENB    P3RVNB           Stop/Drop
     C                     Z-ADD#2AODT    WUAODT           Scheduled Ship
     C                     MOVEL#CQZST    WUQZST           USR Assigned Th
     C                     Z-ADD#CYGNX    WUYGNX           USR Weight, 5.0
     C                     Z-ADD#CBUNB    P3BUNB           USR Weight, 9.0
     C                     MOVEL#2PJST    P2PJST           LTL Flag
     C                     Z-ADD#2BKC7    WUBKC7           Ship To Custome
     C                     MOVEL#2DBCD    WUDBCD           Ship To State C
     C                     MOVEL#CV1CD    WUV1CD           Region Code
     C                     Z-ADD#2RNNB    WURNNB           Reefer Temperat
     C                     MOVEL#2GWST    WUGWST           Header Status
     C                     MOVEL#CCUST    WUQ2CD           Shipping Method
      * ** Default carrier to BUY if ship method is Collect
      * CASE: CTL.USR Shipping Method is Collect
     C           #CCUST    IFEQ 'CR'                       *IF
     C           #CCUST    OREQ 'CT'
     C                     MOVEL'BUY'     #2BZNA           Carrier Code
     C                     MOVEL'BUY'     WUBZNA           Carrier Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RMC added 5/29/08
      * CASE: CTL.Carrier Code is Buyer's Truck
     C           #2BZNA    IFEQ 'BUY'                      *IF
     C                     MOVEL*BLANK    #2BZNA           Carrier Code
     C                     MOVEL*BLANK    WUBZNA           Carrier Code
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL#2BCNA    WUBCNA           Customer Purcha
      * ** E00118 LJB 03/12/2008
     C                     MOVEL#2VDST    WUVDST           Load Type
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Ensure we're showing current order data
      *================================================================
      * RTV All Header Fields  RT - Order Header TRG  * 
     C                     EXSR THRVGN
      * RTV Region for State   RT - Region Definition  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0021           Company Number
     C                     MOVEL#1DBCD    WL0023    P      State Code
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0022    #RV1CD    P      Region Code
     C                     Z-ADD#1A1WG    #RBUNB           USR Weight, 9.0
      * 02/09/09 PKD S00660 Do not allow change of Scheduled Ship Date
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * ** 06/28/2006 LJB TRF011
      * ** Added 3 char LH On-Time Reason Code as an input parm to
      * ** replace the 1 char On Time Reason parm
      * *****
      * ** 09/19/2006 LJB PK0036
      * ** Added 3 char LH Heldover Reason Code as an input parm to
      * ** replace the 1 char Held Over Reason parm
      * *****
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * ** Deadline Departure Date/Time Restrictions          W288
      *================================================================
      * RTV Co. Dflt Int All   XF - Company Defaults Internal  * 
     C                     CALL 'PDSTXFR'              90  RTV Co. Dflt In
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0123  30       Company Number
     C                     PARM *BLANK    WQ0124  2        Shipping Method
     C                     PARM *BLANK    WQ0125  1        Load Type Dft
     C                     PARM *BLANK    WQ0126  1        LTL Flag Dft
     C                     PARM *BLANK    WQ0127  1        Export Status D
     C                     PARM *BLANK    WQ0128  1        Shrink Wrap Dft
     C                     PARM *ZERO     WQ0129  40       Departure Time
     C                     PARM *BLANK    WQ0130  6        Export Code Dft
     C                     PARM *BLANK    WQ0131  1        Allow Mult Whse
     C                     PARM *BLANK    WQ0132  1        Allow Multi Exp
     C                     PARM *BLANK    WQ0133  1        Slip Sheet Dft
     C                     PARM *BLANK    WQ0134  1        Palletize Dft
     C                     PARM *BLANK    WQ0135  1        Plant Company S
     C           YL0042    PARM *BLANK    WQ0136  1        Company Organiz
     C                     PARM *BLANK    WQ0137  1        CDI Valuation G
     C                     PARM *BLANK    WQ0138  1        CDI Unused Sts
     C                     PARM *BLANK    WQ0139  2        CDI Shipper
     C                     PARM *BLANK    WQ0140  2        CDI Produced by
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDSTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Seaboard only
      * CASE: LCL.Company Organization is Seaboard
     C           YL0042    IFEQ 'S'                        *IF
      * ** Retrieve the hours that Shipping is restricted from loading
      * RTV Dock Unavail Range XF - Warehouse Control  * 
     C                     CALL 'PNNIXFR'              90  RTV Dock Unavai
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUVPCD    WQ0141  3        Warehouse Code
     C           WUDPTM    PARM *ZERO     WQ0142  60       Dock Unavail St
     C           WUDQTM    PARM *ZERO     WQ0143  60       Dock Unavail En
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNNIXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * ** Retrieve Deadline Departure Date/Time from Load Header
      * RTV Deadln DepartDT/TM RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0032           Load ID
     C                     EXSR TIRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0033    WUNVDT           Deadline Depart
     C                     Z-ADDWL0034    WUBUTM           Deadline Depart
      * ** Validate if hours are entered for a warehouse
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
      *       skip - not an error if no record
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Dock Unavail Start Time is Zeros
      *   |- c2    : WRK.Dock Unavail End Time is Zeros
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUDPTM    IFEQ *ZERO                      *IF
     C           WUDQTM    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      *       skip - not an error if times are zeros
     C                     ELSE
      * CASE: *OTHERWISE
      * ** If SSD = DDD the enforce the Restricted Time Range   W288
      * CASE: WRK.Deadline Depart Date LH EQ CTL.Scheduled Ship Date USR
     C           WUNVDT    IFEQ #CHODT                     *IF
      * ** Error if DDT is during restriced hours             W288
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Deadline Depart Time LH GE WRK.Dock Unavail Star
      *   |- c2    : WRK.Deadline Depart Time LH LE WRK.Dock Unavail End
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUBUTM    IFGE WUDPTM                     *IF
     C           WUBUTM    IFLE WUDQTM                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Convert Scheduled Ship Date USR to display format
      * Convert date
     C           1000000   ADD  #CHODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0035
      * Send message 'Invalid Dt Chg-DDD/T err2'
     C                     MOVEL'USR4223' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
      * Edt Load/Orders        DF - Order Header TRG  * 
     C                     CALL 'PDLTDFR'              90  Edt Load/Orders
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2C4NB    WQ0144  70       Order Number
     C                     PARM #2RMNB    WQ0145  70       Load ID
     C                     PARM #CHODT    WQ0146  70       Scheduled Ship
     C                     PARM WUADTX    WQ0147 30        Name
     C                     PARM P5HHST    WQ0148  1        Access Limited
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDLTDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993531*
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ** Error if date puts DDD/T in the past. Truck will not have
      * ** time to load and leave. Send an error message.
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           WUSDTE    PARM *ZERO     WQ0149 155       Current System
     C           WUZHNB    PARM *ZERO     WQ0150 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * ** Error if DDD = Today & DDT is before system time   W288
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Deadline Depart Date LH EQ WRK.Current System Da
      *   |- c2    : WRK.Deadline Depart Time LH LE WRK.Current System Ti
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUNVDT    IFEQ WUSDTE                     *IF
     C           WUBUTM    IFLE WUZHNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Convert Scheduled Ship Date USR to display format
      * Convert date
     C           1000000   ADD  YL0018    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0036
      * Send message 'Invalid Deadln Dt/Tm'
     C                     MOVEL'USR4233' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
      * Edt Load/Orders        DF - Order Header TRG  * 
     C                     CALL 'PDLTDFR'              90  Edt Load/Orders
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2C4NB    WQ0151  70       Order Number
     C                     PARM #2RMNB    WQ0152  70       Load ID
     C                     PARM YL0018    WQ0153  70       Scheduled Ship
     C                     PARM WUADTX    WQ0154 30        Name
     C                     PARM P5HHST    WQ0155  1        Access Limited
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDLTDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993531*
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Calculate Total Load Miles
      *================================================================
      * ** 11/20/2007 LJB FP1251 Total Load Miles = zeros if no
      * ** Miles Between Cities record exists
      * ** Include Override miles in the change routine    E00207
      * CLC Total Load Miles   XF - Load Detail  * 
     C                     CLEARPERC
     C                     Z-ADD#2RMNB    PERMNB           Load ID
      *
     C                     CALL 'PDW3XFR'              90  CLC Total Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PERC             KEY: Load Detai
     C           WUTLMI    PARM WUTLMI    WQ0156  70       Total Load Mile
     C           P2K2DT    PARM P2K2DT    WQ0157  70       Override Total
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * CHG Total Load Miles   CH - Load Header  * 
     C                     EXSR NJCHRC
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * Calc Load U/M           -- RMC 4/17/14 e3067
      *================================================================
      * ** All boxes=BX, All combos=CB, Any mix of the two=MX   E00239 11
      * RTV UM/Whs Code,BX Qty XF - Order Header TRG  * 
     C                     CALL 'PPYXXFR'              90  RTV UM/Whs Code
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2RMNB    WQ0158  70       Load ID
     C           YL0044    PARM *BLANK    WQ0159  2        Load U/M
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPYXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * ***** Change log and comments
      *================================================================
      * ** 06/10/2009 LJB E00328 Pass the formatted message back to
      * ** the calling program to be used by ESEND
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         UKSUBR    BEGSR
      *================================================================
      * If buyers truck, default carrier and trk size, and if PT and dft
      *================================================================
      * CASE: CTL.USR Shipping Method is Buyers Truck
     C           #CCUST    IFEQ 'CR'                       *IF
     C           #CCUST    OREQ 'CT'
      * 9/4/2007 Slm FP1061 - WEB030 TRF-Misc Requests for WEB Page Chang
      *     if changes to carrier or sched ship date, write log record
      * Change to Carrier
      * Default Carrier
      * CASE: CTL.Carrier Code EQ WRK.BLANK
     C           #2BZNA    IFEQ WUGSTX                     *IF
     C                     MOVEL'BUY'     #2BZNA           Carrier Code
     C                     MOVEL#2BZNA    WUXCCD           Carrier Broker
     C                     END                             *FI
      * Default Truck Size
      * CASE: CTL.Load Type is Regular
     C           #2VDST    IFEQ 'R'                        *IF
     C                     MOVEL*BLANK    #PRONB           Truck Size
     C                     MOVEL'T'       #PRONB           Truck Size
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: CTL.Load Type is Bulk
     C           #2VDST    IFEQ 'B'                        *IF
     C                     MOVEL*BLANK    #PRONB           Truck Size
     C                     MOVEL'B'       #PRONB           Truck Size
     C                     END                             *FI
     C                     END                             *FI
      * CHG Carrier/Truck Size CH - Load Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0080           Load ID
     C                     MOVEL#2BZNA    WL0081    P      Carrier Code
     C                     MOVEL#PRONB    WL0082    P      Truck Size
     C                     MOVEL#2BZNA    WL0083    P      Carrier Broker
     C                     EXSR NZCHRC
      * Output the Load Header changes to Load order change log
     C                     EXSR ULSUBR                     Output the Load
     C                     ELSE
      * CASE: *OTHERWISE
      * RMC Added 5/29/08
      * CASE: CTL.Carrier Code is Buyer's Truck
     C           #2BZNA    IFEQ 'BUY'                      *IF
     C                     MOVEL*BLANK    #2BZNA           Carrier Code
     C                     MOVEL*BLANK    WUXCCD           Carrier Broker
     C                     END                             *FI
      * RMC added 3/08/11  E01325 default carrier from whs for "OR" type
      * CASE: CTL.Carrier Code is not entered
     C           #2BZNA    IFEQ *BLANK                     *IF
      * Rtv Carrier Dft      RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#RAJCD    WL0084    P      Warehouse Code
     C                     EXSR OARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0085    YL0071    P      Default Carrier
      * CASE: LCL.Default Carrier Code is Entered
     C           YL0071    IFNE *BLANK                     *IF
      * CASE: RCD.Order Type - Sales is Regular Order
     C           #1JNCD    IFEQ 'OR'                       *IF
     C                     MOVELYL0071    #2BZNA           Carrier Code
     C                     MOVELYL0071    WUBZNA           Carrier Code
      * Default Truck Size
      * CASE: CTL.Load Type is Regular
     C           #2VDST    IFEQ 'R'                        *IF
     C                     MOVEL*BLANK    #PRONB           Truck Size
     C                     MOVEL'T'       #PRONB           Truck Size
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: CTL.Load Type is Bulk
     C           #2VDST    IFEQ 'B'                        *IF
     C                     MOVEL*BLANK    #PRONB           Truck Size
     C                     MOVEL'B'       #PRONB           Truck Size
     C                     END                             *FI
     C                     END                             *FI
      * CHG Carrier/Truck Size CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0080           Load ID
     C                     MOVEL#2BZNA    WL0081    P      Carrier Code
     C                     MOVEL#PRONB    WL0082    P      Truck Size
     C                     MOVEL#2BZNA    WL0083    P      Carrier Broker
     C                     EXSR NZCHRC
      * Output the Load Header changes to Load order change log
     C                     EXSR UMSUBR                     Output the Load
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UKEXIT    ENDSR
      /EJECT
     CSR         ULSUBR    BEGSR
      *================================================================
      * Output the Load Header changes to Load order change log
      *================================================================
      * Change to Carrier
     C                     MOVEL'CARCHG'  WURVST           Load Change Typ
     C                     MOVEL'TRF'     WUUJST           Department Cont
     C                     MOVEL*BLANKS   WULHT1           Change Log Prio
     C                     MOVEL*BLANK    WULKT1           Change Log New
     C                     MOVEL#2BZNA    WULKT1           Change Log New
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPDRC
     C                     Z-ADD#2RMNB    PDRMNB           Load ID
     C                     Z-ADD*ZERO     PDRVNB           Stop/Drop
     C                     MOVELWURVST    PDRVST    P      Load Change Typ
     C                     MOVELWUUJST    PDUJST    P      Department Cont
     C                     MOVELWULHT1    PDMNTX    P      Change Log Prio
     C                     MOVELWULKT1    PDMOTX    P      Change Log New
     C                     MOVEL##USR     PDAYNA    P      User Id
     C                     MOVEL##PGM     PDA0NA    P      Job Name
     C                     MOVEL#2BZNA    PDBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PDAIC3           Company Number
     C                     Z-ADD*ZERO     PDC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9831  *
     C                     END
      *================================================================
     CSR         ULEXIT    ENDSR
      /EJECT
     CSR         UMSUBR    BEGSR
      *================================================================
      * Output the Load Header changes to Load order change log
      *================================================================
      * Change to Carrier
     C                     MOVEL'CARCHG'  WURVST           Load Change Typ
     C                     MOVEL'TRF'     WUUJST           Department Cont
     C                     MOVEL*BLANKS   WULHT1           Change Log Prio
     C                     MOVEL*BLANK    WULKT1           Change Log New
     C                     MOVEL#2BZNA    WULKT1           Change Log New
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPDRC
     C                     Z-ADD#2RMNB    PDRMNB           Load ID
     C                     Z-ADD*ZERO     PDRVNB           Stop/Drop
     C                     MOVELWURVST    PDRVST    P      Load Change Typ
     C                     MOVELWUUJST    PDUJST    P      Department Cont
     C                     MOVELWULHT1    PDMNTX    P      Change Log Prio
     C                     MOVELWULKT1    PDMOTX    P      Change Log New
     C                     MOVEL##USR     PDAYNA    P      User Id
     C                     MOVEL##PGM     PDA0NA    P      Job Name
     C                     MOVEL#2BZNA    PDBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PDAIC3           Company Number
     C                     Z-ADD*ZERO     PDC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9831  *
     C                     END
      *================================================================
     CSR         UMEXIT    ENDSR
      /EJECT
     CSR         UNSUBR    BEGSR
      *================================================================
      * Change Log
      *================================================================
      * E00519 Access by WHS  IF
      * ---------- November 2009 PKD ----------
      * *****  WW Cust/Order Inq O.E.  *****
      * - Do not allow Transfer Co if Application WHS Restrict = Y.
      * ***** Edit Order Header ***** -TESTED 11/10/09
      * -  Added validation on Warehouse Code.  If Application WHS Restri
      * is Yes, then only the Warehouse Code for O/P Application Code
      * are allowed.  If the Application WHS Restrict is No, then the
      * User is allowed access to all Active Warehouses.
      * -  Changed the F4=Prompt to only display the Warehouses the
      * User has access to if the Application WHS Restrict is Yes.
      * ***** Edit Order Detail Lines & Copy Order Template ***** TESTED
      * -  Added validation for Item Code. For each application and
      * Warehouse, addtional access control is defined for TF Exempt Code
      * Users that are restricted by Warehouse, they may also be restrict
      * on the Items they are able to sell.
      * -  Added validation on Order TF Exempt Code.  If the Customer is
      * is Exempt, then they can only sell Exempt Product. (E00505)
      * ***** Edit Load Plan Order Entry *****
      * -  Added WHS Code to the Control Context and Record Context.
      * For Users that are Application WHS Restrict = Yes,
      * the CTL.Warehouse Code will be restricted to the
      * Warehouses that they have access to.
      * -  CTL.Warehouse Code will be required for Users with
      * Application Warehouse Controlled.
      * -  Added Delivery State Code (Sail Port State) to the screen.
      * It will default to the Ship To State Code.  It will be overriden
      * to the Sail Port State if the Shipping Line and Port Delivery
      * Terminal are entered in the Order Header Extent.
      * -  Added subfile select for WHS and Delv ST.
      * ***** Edit Load Plan *****
      * -  For Users that are Application WHS Restrict = Yes,
      * the CTL.Warehouse Code will be restricted to the
      * Warehouses that they have access to.
      * -  CTL.Warehouse Code will be required for Users with
      * Application Warehouse Controlled.
      * -  CTL.USR Load Type---Default from the CTL.USR Warehosue Code
      * for users that are Application WHS Restrict.
      * ***** Display Change Log/Accept Load (PDAOXFR) *****
      * -  Deletes will not be accepted by Application WHS Restricted
      * users because we do not know the Warehouse that was on the Load.
      * -  If Application WHS Restrict is Yes, then only select the load
      * for acceptance if at least one order on the load has a warehouse
      * where the user has access.
      * -  Reverse imaged Warehouse Code on the Display. The Users with
      * Application WHS Restrict of No will be able to see all Loads.
      * ***** Edit Load Plan *****
      * - Added Warehouse Code to the Control and Detail Context with
      * appropriate validations.
      * ***** Work With Load Confirmation *****
      * - Added Warehouse Code as a parameter from the Work With Load
      * Plan All screen for selection of the Loads to Display on the
      * screen.  Added selection for Warehouse Code if one passed in.
      * If the Load is not to be selected due to not matching the Whs,
      * a record is created for the load in the array (exception array).
      * - Added Warehouse Code to the Subfile.
      * ***** Order Status Report Prompt *****
      * - Added Warehouse Code restriction on the prompt.
      * ***** Work With Orders Price Audit/Maintenance *****
      * - Added Warehouse Code restriction.
      * ***** Work With Orders - Edit Ship Date  *****
      * - Added Warehouse Code restriction.
      *   Load Accounting for the Plant and Load Balancing.
      * - Changed 'RTV UM/Whs Code Lmt,Bx RT - Order Detail'.
      *================================================================
     CSR         UNEXIT    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C           ZINPOS    IFGE 03584
     C           ZINPOS    ANDLE05632
      * Cursor in the subfile record area
      * Reset cursor position to the basic (first) record for lookup
     C           W0CRW     SUB  14        W0CSRR  50
     C           ZZSFM     IFEQ '0'
     C                     DIV  02        W0CSRR
     C                     MVR            ZINPOS
     C                     ELSE
     C                     Z-ADD0         ZINPOS
     C                     ENDIF
     C                     ADD  14        ZINPOS
     C                     MULT 256       ZINPOS
     C                     ADD  W0CCL     ZINPOS
      * Calculate rrn of the cursor position
     C                     ADD  ##SFRC    W0CSRR
     C                     ENDIF
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C           W0CFL     IFEQ *BLANK
     C                     Z-ADD0         W0CSRR
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD14        ZHSTRW  40
     C                     Z-ADD21        ZHNDRW  40
     C           ZZSFM     IFEQ '0'
     C                     Z-ADD2         ZHRLEN  40
     C                     ELSE
     C                     Z-ADD1         ZHRLEN
     C                     ENDIF
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
     C                     END
      *
     C           ZHCSRW    IFEQ 005
     C           ZHCSCL    ANDGE018
     C           ZHCSCL    ANDLE019
     C           @#DFMT    ANDEQ'#SFLCTL'
     C           *IN78     ANDEQ'0'
     C                     MOVEL'#CCUST'  YPMTFD           USR Shipping Me
     C                     END
      *
     C           ZHCSRW    IFEQ 006
     C           ZHCSCL    ANDEQ018
     C           @#DFMT    ANDEQ'#SFLCTL'
     C           *IN78     ANDEQ'0'
     C                     MOVEL'#2VDST'  YPMTFD           Load Type
     C                     END
      *
     C           ZHCSRW    IFEQ 013
     C           ZHCSCL    ANDEQ013
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#CQZST'  YPMTFD           USR Assigned Th
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM 'PDFLDFRH'W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1C4NB           Order Number
     C                     Z-ADD*ZERO     P1AODT           Scheduled Ship
     C                     Z-ADD*ZERO     P1EIDT           Requested Deliv
     C                     MOVEL*BLANK    P2PJST           LTL Flag
     C                     Z-ADD*ZERO     P2RNNB           Reefer Temperat
     C                     MOVEL*BLANK    P2BZNA           Carrier Code
     C                     MOVEL*BLANK    P2RONB           Truck Size
     C                     MOVEL*BLANK    P2VDST           Load Type
     C                     Z-ADD*ZERO     P2DGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     P2DHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     P2DIWG           Trailer OUT Wei
     C                     MOVEL*BLANK    P2Q2CD           Shipping Method
     C                     MOVEL*BLANK    P2DBCD           Ship To State C
     C                     MOVEL*BLANK    P2U2ST           Export Status
     C                     Z-ADD*ZERO     P2K2DT           Override Total
     C                     Z-ADD*ZERO     P3RVNB           Stop/Drop
     C                     Z-ADD*ZERO     P3BUNB           USR Weight, 9.0
     C                     MOVEL*BLANK    P3PNST           Auto Load Numbe
     C                     Z-ADD*ZERO     P3RSNB           Maximum pounds
     C                     Z-ADD*ZERO     P3TANB           Minimum pounds
     C                     MOVEL*BLANK    P3QKST           Display Flag
     C                     MOVEL*BLANK    P3R4ST           USR Update Flag
     C                     Z-ADD*ZERO     P3RQNB           Total Freight
     C                     Z-ADD*ZERO     P3UCNB           USR Load ID
     C                     Z-ADD*ZERO     P3NVDT           Deadline Depart
     C                     Z-ADD*ZERO     P3BUTM           Deadline Depart
     C                     MOVEL*BLANK    P5AJCD           Warehouse Code
     C                     MOVEL*BLANK    P5DNCD           Application Cod
     C                     MOVEL*BLANK    P5BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P5B8NA           System Date For
     C                     MOVEL*BLANK    P5I6ST           Allow Multi-Com
     C                     MOVEL*BLANK    P5MPNA           Default Printer
     C                     MOVEL*BLANK    P5HHST           Access Limited
     C                     MOVEL*BLANK    P6JDST           USR Check Y/N S
     C                     Z-ADD*ZERO     P7CDWG           USR Weight Accu
     C                     Z-ADD*ZERO     P8DTWG           Weight Adjust
     C                     MOVEL*BLANK    P9B8ST           Status - Y or N
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Define work field Load Type
     C                     MOVEL*BLANK    WUVDST  1
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Define work field Stop/Drop Sequence Number
     C                     Z-ADD*ZERO     WURUNB  50
      * Define work field Total Load Miles
     C                     Z-ADD*ZERO     WUTLMI  70
      * Define work field Carrier Broker
     C                     MOVEL*BLANK    WUXCCD  3
      * Define work field Shipping Temp C/F txt
     C                     MOVEL*BLANK    WUWRTX 25
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WAA0DT           Order Date
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WAACDT           Cancel Date
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WAJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WAA1WG           Order Weight To
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WATBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WAATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WARSRN           Resell Referenc
     C                     Z-ADD*ZERO     WAT3NB           Attach to Order
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WAAWDT           Invoice Date
     C                     Z-ADD*ZERO     WAVRVA           A/R order Value
     C                     Z-ADD*ZERO     WAB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WANODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WANPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WANQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WANRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WANSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WABPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WABQTM           Time of Origina
     C                     Z-ADD*ZERO     WABRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WABSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WABTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WAH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WAH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WAH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WAH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WAH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field System Value Alpha
     C                     MOVEL*BLANK    WUBXTX 40
      * Define work field Truck Size
     C                     MOVEL*BLANK    WURONB  7
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Total Weight Work
     C                     Z-ADD*ZERO     WUBMNB 130
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      * Define work field USR Shipping Method
     C                     MOVEL*BLANK    WUCUST  2
      * Define work field Scheduled Ship Date
     C                     Z-ADD*ZERO     WUAODT  70
      * Define work field Status Flag 3  Y/N
     C                     MOVEL*BLANK    WUQ3ST  1
      * Define work field USR Company Number
     C                     Z-ADD*ZERO     WUFKNB  30
      * Define work field Company Organization
     C                     MOVEL*BLANK    WUYJSX  1
      * Define work field Record Status
     C                     MOVEL*BLANK    WUVSST  1
      *
     C           W0ICL     IFEQ 'Y'
      * Initialize array variables
     C                     MOVEA*HIVAL    YK01
      * Initialize last used element number
     C                     Z-ADD0         YL01    50
     C                     Z-ADD1         Y       50
     C                     ENDIF
      *
      * Define work field Company Number     041743
     C                     Z-ADD*ZERO     WUBSC3  30
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WCBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WCBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WCBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WCBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field Order Number
     C                     Z-ADD*ZERO     WUC4NB  70
      * Define work field USR Assigned This Load
     C                     MOVEL*BLANK    WUQZST  1
      * Define work field USR Weight, 5.0
     C                     Z-ADD*ZERO     WUYGNX  50
      * Define work field Ship To State Code
     C                     MOVEL*BLANK    WUDBCD  2
      * Define work field Ship To Customer
     C                     Z-ADD*ZERO     WUBKC7  70
      * Define work field Region Code
     C                     MOVEL*BLANK    WUV1CD  4
      * Define work field Reefer Temperature
     C                     Z-ADD*ZERO     WURNNB  52
      * Define work field Header Status
     C                     MOVEL*BLANK    WUGWST  1
      * Define work field Shipping Method
     C                     MOVEL*BLANK    WUQ2CD  2
      * Define work field Customer Purchase Order #
     C                     MOVEL*BLANK    WUBCNA 15
      * Define work field Carrier Code
     C                     MOVEL*BLANK    WUBZNA  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WDRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WDFLAM           Flat Amount
     C                     Z-ADD*ZERO     WDRRNB           Total Stops
     C                     Z-ADD*ZERO     WDSBNB           BOL Time
     C                     Z-ADD*ZERO     WDSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDSDNB           Number Pallets
     C                     Z-ADD*ZERO     WDPAOU           Number Pallets
     C                     Z-ADD*ZERO     WDDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WDSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WDHADT           Actual Arrival
     C                     Z-ADD*ZERO     WDAART           Actual Arrival
     C                     Z-ADD*ZERO     WDDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WDDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WDAQDT           Actual Departur
     C                     Z-ADD*ZERO     WDS6NB           Departure Time
     C                     Z-ADD*ZERO     WDT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WDPRTM           Product Tempera
     C                     Z-ADD*ZERO     WDNPSV           Number Spacers
     C                     Z-ADD*ZERO     WDTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WDGRWE           Gross Weight
     C                     Z-ADD*ZERO     WDF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WDJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WDTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WDJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WDSPTM           Spotted Time
     C                     Z-ADD*ZERO     WDJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WDLFTM           Load Finished T
     C                     Z-ADD*ZERO     WDJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WDBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WDJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WDBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WDKIDT           Truck Departure
     C                     Z-ADD*ZERO     WDASTM           Truck Departure
     C                     Z-ADD*ZERO     WDKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WDAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WDVOAG           Voyage
     C                     Z-ADD*ZERO     WDKBDT           Sail Date
     C                     Z-ADD*ZERO     WDEFDT           Arrival Date
     C                     Z-ADD*ZERO     WDKCDT           Date In
     C                     Z-ADD*ZERO     WDTMIN           Time In
     C                     Z-ADD*ZERO     WDKDDT           Date Out
     C                     Z-ADD*ZERO     WDVMNB           Time Out
     C                     Z-ADD*ZERO     WDOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WDKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WDATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WDBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WDEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WDKKDT           On Yard Date
     C                     Z-ADD*ZERO     WDAVTM           On Yard Time
     C                     Z-ADD*ZERO     WDKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WDAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WDLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WDK0DT           Product Complet
     C                     Z-ADD*ZERO     WDAYTM           Product Complet
     C                     Z-ADD*ZERO     WDKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WDICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WDIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WDK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WDAZTM           Load Door 1
     C                     Z-ADD*ZERO     WDK2DT           Override Total
     C                     Z-ADD*ZERO     WDA0TM           Load Door 2
     C                     Z-ADD*ZERO     WDZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WDPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WDCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WDPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WDCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WDP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WDCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WDP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WDCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WDP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WDCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WDP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WDCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      *
     C           W0ICL     IFEQ 'Y'
      * Initialize array variables
     C                     MOVEA*HIVAL    YK02
      * Initialize last used element number
     C                     Z-ADD0         YL02    50
     C                     ENDIF
      *
      * Define work field Requested Delivery Date
     C                     Z-ADD*ZERO     WUEIDT  70
      * Define work field USR Return Code
     C                     MOVEL*BLANK    WUN7CD  1
      * Define work field Warehouse Code Assigned
     C                     MOVEL*BLANK    WUCBAA  3
      * Define work field Warehouse Type Assigned
     C                     MOVEL*BLANK    WUJFSX  2
      * Define work field Error Status
     C                     MOVEL*BLANK    WUECST  1
      * Define work field USR Display 2
     C                     MOVEL*BLANK    WUTJST  1
      * Define work field USR Display 1
     C                     MOVEL*BLANK    WUTIST  1
      * Define work field Warehouse Code PASS   USR
     C                     MOVEL*BLANK    WUT3CD  3
      * Define work field Must Ship Error
     C                     MOVEL*BLANK    WUB7SX  3
      * Define work field USR Exit Program
     C                     MOVEL*BLANK    WUSTYN  1
      * Define work field USR Stop
     C                     Z-ADD*ZERO     WUTENB  30
      * Define work field Blank 6 USR
     C                     MOVEL*BLANK    WUXKTX  6
      * Define work field Deadline Depart DT    HDR
     C                     Z-ADD*ZERO     WUHDDT  70
      * Define work field Deadline Depart Time  HDR
     C                     Z-ADD*ZERO     WUAUTM  60
      * Define work field USR City
     C                     MOVEL*BLANK    WUGUNA 20
      * Define work field Must Ship Date        USR
     C                     Z-ADD*ZERO     WULYDT  70
      * Define work field Must Ship Time        USR
     C                     Z-ADD*ZERO     WUA5TM  60
      * Define work field Port City
     C                     MOVEL*BLANK    WUOKTX 25
      * Define work field Sail Port State
     C                     MOVEL*BLANK    WUXBCD  2
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define work field Customer Number       NBR
     C                     Z-ADD*ZERO     WUAJNB  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIRMNB           Load ID
     C                     Z-ADD*ZERO     WIRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WIRVNB           Stop/Drop
     C                     Z-ADD*ZERO     WIRWNB           Miles to next s
     C                     Z-ADD*ZERO     WIRXNB           Freight Charge
     C                     Z-ADD*ZERO     WISQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WIT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WIT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WIR1NB           Rated Freight
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIC4NB           Order Number
     C                     Z-ADD*ZERO     WIKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WISXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WIKFDT           Appointment Con
     C                     Z-ADD*ZERO     WIACTM           Appointment Con
     C                     Z-ADD*ZERO     WIEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WIAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WIKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WIATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WIHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WIAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WIKKDT           On Yard Date
     C                     Z-ADD*ZERO     WIAVTM           On Yard Time
     C                     Z-ADD*ZERO     WIZ4NB           MPC Number
     C                     Z-ADD*ZERO     WIN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WIN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WIN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WIB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WIB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WIB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Define work field USR Weight   9.1  3
     C                     Z-ADD*ZERO     WUH8WG  91
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJC4NB           Order Number
     C                     Z-ADD*ZERO     WJDPNB           Order Sequence
     C                     Z-ADD*ZERO     WJUENB           Order Secondary
     C                     Z-ADD*ZERO     WJHGCD           Item Code
     C                     Z-ADD*ZERO     WJBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WJCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WJMAVA           Billing Detail
     C                     Z-ADD*ZERO     WJKDVA           Billing Detail
     C                     Z-ADD*ZERO     WJL8VA           Billing Detail
     C                     Z-ADD*ZERO     WJL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WJAYVA           Extended Amount
     C                     Z-ADD*ZERO     WJEXDT           Market Pricing
     C                     Z-ADD*ZERO     WJBZPR           Price Overage O
     C                     Z-ADD*ZERO     WJL6NB           Contract Number
     C                     Z-ADD*ZERO     WJGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WJR1NB           Rated Freight
     C                     Z-ADD*ZERO     WJAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WJD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WJCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WJAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WJCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WJATWG           Weight Shipped
     C                     Z-ADD*ZERO     WJAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WJAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WJAKPR           Unit Price
     C                     Z-ADD*ZERO     WJALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WJAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WJAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WJA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WJA5DT           Requested Ship
     C                     Z-ADD*ZERO     WJAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WJGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WJRGNB           Item Structure
     C                     Z-ADD*ZERO     WJRHNB           Item Structure
     C                     Z-ADD*ZERO     WJRINB           Item Structure
     C                     Z-ADD*ZERO     WJCXDT           Date of Origina
     C                     Z-ADD*ZERO     WJDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WJB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WJA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WJNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WJNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WJNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WJNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WJNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WJBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WJBVTM           Price Code
     C                     Z-ADD*ZERO     WJBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WJBXTM           Substitution Li
     C                     Z-ADD*ZERO     WJBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WJH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WJH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WJH7NX           OD Item Target
     C                     Z-ADD*ZERO     WJH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WJH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WJDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WJDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WJDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WJDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WJDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WJGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WJGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WJGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WJPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WJRINY           Item Age Days
     C                     Z-ADD*ZERO     WJTIDT           Production Ovr
     C                     Z-ADD*ZERO     WJTJDT           Production Ovr
     C                     Z-ADD*ZERO     WJTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WJTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WJTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Define work field U/M - Ordered
     C                     MOVEL*BLANK    WUAGCD  2
      * Define work field USR Percent Work, 7.4
     C                     Z-ADD*ZERO     WUBHPC  74
      * Define work field USR Freight Amount 1
     C                     Z-ADD*ZERO     WUDLVA 112
      * Define work field Pick Status USR
     C                     MOVEL*BLANK    WUZMST  1
      * Define work field Stop/Drop
     C                     Z-ADD*ZERO     WURVNB  50
      * Define work field Load Shag Flag
     C                     MOVEL*BLANK    WULSHG  1
      * Define work field Load Wash Flag
     C                     MOVEL*BLANK    WUYPST  1
      * Define work field LTL Flag
     C                     MOVEL*BLANK    WUPJST  1
      * Define work field Blank for 3          USR
     C                     MOVEL*BLANK    WUUAT1  3
      * Define work field Load Change Type
     C                     MOVEL*BLANK    WURVST  6
      * Define work field Department Control Code
     C                     MOVEL*BLANK    WUUJST  3
      * Define work field Change Log Prior Value
     C                     MOVEL*BLANK    WUMNTX 12
      * Define work field Change Log New Value
     C                     MOVEL*BLANK    WUMOTX 12
      * Define work field Requested Ship Date
     C                     Z-ADD*ZERO     WUA5DT  70
      * Define work field Total Stops
     C                     Z-ADD*ZERO     WURRNB  50
      * Define work field Multi Company Load
     C                     MOVEL*BLANK    WURVSX  1
      * Define work field Company Number     041405
     C                     Z-ADD*ZERO     WUBQC3  30
      * Define work field Ship From Warehouse
     C                     MOVEL*BLANK    WUVPCD  3
      * Define work field Load Added/Deleted     .U
     C                     MOVEL*BLANK    WUFUST  1
      * Define work field USR Load Id ALpha
     C                     MOVEL*BLANK    WULONA  7
      * Define work field Dock Unavail Start Time
     C                     Z-ADD*ZERO     WUDPTM  60
      * Define work field Dock Unavail End Time
     C                     Z-ADD*ZERO     WUDQTM  60
      * Define work field Deadline Depart Date LH
     C                     Z-ADD*ZERO     WUNVDT  70
      * Define work field Deadline Depart Time LH
     C                     Z-ADD*ZERO     WUBUTM  60
      * Define work field Name
     C                     MOVEL*BLANK    WUADTX 30
      * Define work field Current System Date
     C                     Z-ADD*ZERO     WUSDTE 155
      * Define work field Current System Time
     C                     Z-ADD*ZERO     WUZHNB 155
      * Define work field DL List ID
     C                     MOVEL*BLANK    WUCLAA 10
      * Define work field Blank for 30          USR
     C                     MOVEL*BLANK    WUW4TX 30
      * Define work field Deadline Departure Date
     C                     Z-ADD*ZERO     WUKZDT  70
      * Define work field Deadline Departure Time
     C                     Z-ADD*ZERO     WUAXTM  60
      * Define work field Miles Error Sts
     C                     MOVEL*BLANK    WUIASX  1
      * Define work field LD Unused Sts 2
     C                     MOVEL*BLANK    WUIBSX  1
      * Define work field HPB Transload Station
     C                     MOVEL*BLANK    WUICSX  2
      * Clear all neither parameters
      * CRT Load Detail        CR - Load Detail  * 
     C                     Z-ADD*ZERO     WRAATM           Job Time
     C                     Z-ADD*ZERO     WRAXDT           Job Date
      * Define work field Change Log Prior Val Usr1
     C                     MOVEL*BLANK    WULHT1 12
      * Define work field Change Log New VL Usr 2
     C                     MOVEL*BLANK    WULKT1 12
      * Define work field Order Number Saved USR
     C                     Z-ADD*ZERO     WUDLC7  70
      * Define work field Ship To City
     C                     MOVEL*BLANK    WUHNNA 20
      * Define work field Shipping Temp Code C/F
     C                     MOVEL*BLANK    WUFRSX  1
      * Define work field USR Temperature 3.1
     C                     Z-ADD*ZERO     WUPCNX  31
      * Define work field Blank for 4           USR
     C                     MOVEL*BLANK    WUOTTX  4
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WSAIC3           Company Number
     C                     Z-ADD*ZERO     WSC4NB           Order Number
     C                     Z-ADD*ZERO     WSQ2NB           Event Number
     C                     Z-ADD*ZERO     WSAUC3           Invoice/Memo Co
     C                     Z-ADD*ZERO     WSQ7NB           Invoice/Memo Nu
     C                     Z-ADD*ZERO     WSD2DT           Event Date
     C                     Z-ADD*ZERO     WSAWC3           Cross Event Ref
     C                     Z-ADD*ZERO     WSQ8NB           Cross Event Ref
     C                     Z-ADD*ZERO     WSQ9NB           Cross Event Ref
     C                     Z-ADD*ZERO     WSBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WSAATM           Job Time
     C                     Z-ADD*ZERO     WSAXDT           Job Date
      * Define work field Event Number
     C                     Z-ADD*ZERO     WUQ2NB  50
      * Clear all neither parameters
      * CRT OP Order Events    CR - Order Events  * 
     C                     Z-ADD*ZERO     WVAATM           Job Time
     C                     Z-ADD*ZERO     WVAXDT           Job Date
      * Define work field USR Check Y/N Status
     C                     MOVEL*BLANK    WUJDST  1
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WXAIC3           Company Number
     C                     Z-ADD*ZERO     WXAXNB           Current Account
     C                     Z-ADD*ZERO     WXNGNB           Current Account
     C                     Z-ADD*ZERO     WXBZNB           OM Week
     C                     Z-ADD*ZERO     WXC5NB           Next Order Numb
     C                     Z-ADD*ZERO     WXC3NB           Next Invoice Nu
     C                     Z-ADD*ZERO     WXCYNB           Next Credit Mem
     C                     Z-ADD*ZERO     WXIONB           Next Charge Bac
     C                     Z-ADD*ZERO     WXI6NB           Next On Acct Ca
     C                     Z-ADD*ZERO     WXDCNB           Next Voucher Nu
     C                     Z-ADD*ZERO     WXC7NB           Next Customer #
     C                     Z-ADD*ZERO     WXC2NB           Next Inventory
     C                     Z-ADD*ZERO     WXC1NB           Next PFS Batch
     C                     Z-ADD*ZERO     WXL8NB           Next Contract/P
     C                     Z-ADD*ZERO     WXBANB           Next HPB Batch
     C                     Z-ADD*ZERO     WXAIPC           Manual Price Ac
     C                     Z-ADD*ZERO     WXASPC           CoPk/FdSrv ManP
     C                     Z-ADD*ZERO     WXA2VA           Late Charge Min
     C                     Z-ADD*ZERO     WXAADY           A/P Aging Days
     C                     Z-ADD*ZERO     WXABDY           A/P Aging Days
     C                     Z-ADD*ZERO     WXACDY           A/P Aging Days
     C                     Z-ADD*ZERO     WXADDY           A/P Aging Days
     C                     Z-ADD*ZERO     WXAEDY           A/R Aging Days
     C                     Z-ADD*ZERO     WXAFDY           A/R Aging Days
     C                     Z-ADD*ZERO     WXAGDY           A/R Aging Days
     C                     Z-ADD*ZERO     WXAHDY           A/R Aging Days
     C                     Z-ADD*ZERO     WXAENB           Retention Perio
     C                     Z-ADD*ZERO     WXALNB           Retention Perio
     C                     Z-ADD*ZERO     WXEVNB           Retention Perio
     C                     Z-ADD*ZERO     WXRPOP           Retention Perio
     C                     Z-ADD*ZERO     WXDWNB           Retention Perio
     C                     Z-ADD*ZERO     WXR3NB           Next Load ID
     C                     Z-ADD*ZERO     WXR4NB           Next Item Numbe
     C                     Z-ADD*ZERO     WXSCNB           Production Numb
     C                     Z-ADD*ZERO     WXAATM           Job Time
     C                     Z-ADD*ZERO     WXAXDT           Job Date
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SARVGN.
     C                     Z-ADD*ZERO     WL0001  70
     C                     Z-ADD*ZERO     WL0002  50
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0003  70
     C                     MOVEL*BLANK    WL0004  1
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0005  30
     C                     MOVEL*BLANK    WL0006 10
     C                     MOVEL*BLANK    WL0007 40
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0008  70
     C                     Z-ADD*ZERO     WL0009  50
     C                     Z-ADD*ZERO     WL0010 112
     C                     MOVEL*BLANK    WL0011  1
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0012  70
     C                     Z-ADD*ZERO     WL0013  50
     C                     Z-ADD*ZERO     WL0014  92
     C                     Z-ADD*ZERO     WL0015  92
      * Define local variables for subroutine SLRVGN.
     C                     Z-ADD*ZERO     WL0016  70
     C                     Z-ADD*ZERO     WL0017  50
     C                     Z-ADD*ZERO     WL0018  70
     C                     Z-ADD*ZERO     WL0019  70
     C                     Z-ADD*ZERO     WL0020  60
      * Define local variables for subroutine SNRVGN.
     C                     Z-ADD*ZERO     WL0021  30
     C                     MOVEL*BLANK    WL0022  4
     C                     MOVEL*BLANK    WL0023  2
      * Define local variables for subroutine SQCRRC.
     C                     Z-ADD*ZERO     WL0024  50
     C                     Z-ADD*ZERO     WL0025  70
      * Define local variables for subroutine SSRVGN.
     C                     Z-ADD*ZERO     WL0026  70
      * Define local variables for subroutine TBRVGN.
     C                     Z-ADD*ZERO     WL0027  30
     C                     Z-ADD*ZERO     WL0028  70
     C                     Z-ADD*ZERO     WL0029  70
      * Define local variables for subroutine TCCRRC.
     C                     Z-ADD*ZERO     WL0030  50
     C                     Z-ADD*ZERO     WL0031  70
      * Define local variables for subroutine TIRVGN.
     C                     Z-ADD*ZERO     WL0032  70
     C                     Z-ADD*ZERO     WL0033  70
     C                     Z-ADD*ZERO     WL0034  60
      * Define local variables for subroutine TPRVGN.
     C                     Z-ADD*ZERO     WL0035  30
     C                     MOVEL*BLANK    WL0036 10
     C                     Z-ADD*ZERO     WL0037 155
      * Define local variables for subroutine TRRVGN.
     C                     MOVEL*BLANK    WL0038 10
     C                     MOVEL*BLANK    WL0039  1
     C                     MOVEL*BLANK    WL0040 10
     C                     MOVEL*BLANK    WL0041  3
     C                     Z-ADD*ZERO     WL0042  30
     C                     MOVEL*BLANK    WL0043 10
      * Define local variables for subroutine TSRVGN.
     C                     MOVEL*BLANK    WL0044 10
     C                     Z-ADD*ZERO     WL0045  30
      * Define local variables for subroutine TVRVGN.
     C                     Z-ADD*ZERO     WL0046  70
     C                     Z-ADD*ZERO     WL0047  70
      * Define local variables for subroutine TWCHRC.
     C                     Z-ADD*ZERO     WL0048  70
     C                     Z-ADD*ZERO     WL0049  70
      * Define local variables for subroutine TXRVGN.
     C                     Z-ADD*ZERO     WL0050  70
     C                     Z-ADD*ZERO     WL0051  70
     C                     MOVEL*BLANK    WL0052  6
     C                     MOVEL*BLANK    WL0053  3
     C                     MOVEL*BLANK    WL0054 12
     C                     MOVEL*BLANK    WL0055 12
     C                     MOVEL*BLANK    WL0056 10
     C                     MOVEL*BLANK    WL0057 10
     C                     MOVEL*BLANK    WL0058  3
      * Define local variables for subroutine NERVGN.
     C                     Z-ADD*ZERO     WL0059  70
     C                     Z-ADD*ZERO     WL0060  50
     C                     MOVEL*BLANK    WL0061  3
      * Define local variables for subroutine NNRVGN.
     C                     Z-ADD*ZERO     WL0062  70
     C                     MOVEL*BLANK    WL0063  1
     C                     Z-ADD*ZERO     WL0064  70
     C                     Z-ADD*ZERO     WL0065  70
      * Define local variables for subroutine NPCHRC.
     C                     Z-ADD*ZERO     WL0066  70
     C                     Z-ADD*ZERO     WL0067  70
     C                     MOVEL*BLANK    WL0068  1
     C                     MOVEL*BLANK    WL0069  3
     C                     Z-ADD*ZERO     WL0070  70
     C                     Z-ADD*ZERO     WL0071  60
      * Define local variables for subroutine NRRVGN.
     C                     Z-ADD*ZERO     WL0072  70
     C                     Z-ADD*ZERO     WL0073  50
     C                     Z-ADD*ZERO     WL0074  70
     C                     Z-ADD*ZERO     WL0075  60
      * Define local variables for subroutine NTRVGN.
     C                     Z-ADD*ZERO     WL0076  30
     C                     Z-ADD*ZERO     WL0077  70
     C                     Z-ADD*ZERO     WL0078  70
     C                     Z-ADD*ZERO     WL0079  60
      * Define local variables for subroutine NZCHRC.
     C                     Z-ADD*ZERO     WL0080  70
     C                     MOVEL*BLANK    WL0081  3
     C                     MOVEL*BLANK    WL0082  7
     C                     MOVEL*BLANK    WL0083  3
      * Define local variables for subroutine OARVGN.
     C                     MOVEL*BLANK    WL0084  3
     C                     MOVEL*BLANK    WL0085  3
      * Define local variables for subroutine OBRVGN.
     C                     Z-ADD*ZERO     WL0086  30
     C                     Z-ADD*ZERO     WL0087  70
     C                     MOVEL*BLANK    WL0088  3
     C                     Z-ADD*ZERO     WL0089  70
     C                     Z-ADD*ZERO     WL0090 112
     C                     MOVEL*BLANK    WL0091  2
      * Define local variables for subroutine OFRVGN.
     C                     Z-ADD*ZERO     WL0092  70
     C                     Z-ADD*ZERO     WL0093  50
     C                     Z-ADD*ZERO     WL0094  70
     C                     Z-ADD*ZERO     WL0095  70
      * Define local variables for subroutine OHRVGN.
     C                     MOVEL*BLANK    WL0096 20
     C                     Z-ADD*ZERO     WL0097  70
     C                     MOVEL*BLANK    WL0098  1
     C                     Z-ADD*ZERO     WL0099  31
     C                     Z-ADD*ZERO     WL0100  70
      * Define local variables for subroutine OIRVGN.
     C                     Z-ADD*ZERO     WL0101  70
     C                     Z-ADD*ZERO     WL0102  50
     C                     Z-ADD*ZERO     WL0103  70
      * Define local variables for subroutine OJCHRC.
     C                     Z-ADD*ZERO     WL0104  70
     C                     Z-ADD*ZERO     WL0105  70
     C                     Z-ADD*ZERO     WL0106  52
     C                     Z-ADD*ZERO     WL0107 112
     C                     Z-ADD*ZERO     WL0108  70
     C                     MOVEL*BLANK    WL0109 25
      * Define local variables for subroutine OLRVGN.
     C                     Z-ADD*ZERO     WL0110  30
     C                     Z-ADD*ZERO     WL0111  70
     C                     Z-ADD*ZERO     WL0112  50
     C                     MOVEL*BLANK    WL0113  2
     C                     Z-ADD*ZERO     WL0114  70
     C                     MOVEL*BLANK    WL0115  1
     C                     Z-ADD*ZERO     WL0116  70
      * Define local variables for subroutine OMCRRC.
     C                     Z-ADD*ZERO     WL0117  30
     C                     Z-ADD*ZERO     WL0118  70
     C                     Z-ADD*ZERO     WL0119  50
     C                     MOVEL*BLANK    WL0120  2
     C                     Z-ADD*ZERO     WL0121  30
     C                     Z-ADD*ZERO     WL0122  70
     C                     MOVEL*BLANK    WL0123  2
     C                     Z-ADD*ZERO     WL0124  70
     C                     MOVEL*BLANK    WL0125  1
     C                     MOVEL*BLANK    WL0126  1
     C                     MOVEL*BLANK    WL0127  1
     C                     Z-ADD*ZERO     WL0128  30
     C                     Z-ADD*ZERO     WL0129  70
     C                     Z-ADD*ZERO     WL0130  50
     C                     Z-ADD*ZERO     WL0131  70
      * Define local variables for subroutine OSRVGN.
     C                     MOVEL*BLANK    WL0132 10
     C                     MOVEL*BLANK    WL0133  6
     C                     Z-ADD*ZERO     WL0134  30
     C                     MOVEL*BLANK    WL0135  3
      * Define null work field Plant Company Sts
     C                     MOVEL*BLANK    YN0001  1
      * Define null work field Company Organization
     C                     MOVEL*BLANK    YN0002  1
      * Define null work field CDI Valuation Grouping
     C                     MOVEL*BLANK    YN0003  1
      * Define null work field CDI Unused Sts 3
     C                     MOVEL*BLANK    YN0004  1
      * Define null work field CDI Shipper
     C                     MOVEL*BLANK    YN0005  2
      * Define null work field CDI Produced by co
     C                     MOVEL*BLANK    YN0006  2
      * Define local work field Schedule Sequence Number
     C                     Z-ADD*ZERO     YL0001  50
      * Define local work field Ship From Warehouse
     C                     MOVEL*BLANK    YL0002  3
      * Define local work field Pallets Loaded
     C                     Z-ADD*ZERO     YL0003  50
      * Define local work field Avg Pallet Tare
     C                     Z-ADD*ZERO     YL0004  92
      * Define local work field Tot Pallet Tare
     C                     Z-ADD*ZERO     YL0005  92
      * Define local work field Order Quantity
     C                     Z-ADD*ZERO     YL0006 112
      * Define local work field Application WHS Restrict
     C                     MOVEL*BLANK    YL0007  1
      * Define null work field Warehouse Type
     C                     MOVEL*BLANK    YN0007  2
      * Define null work field Trans Contol AS400/Plant
     C                     MOVEL*BLANK    YN0008  1
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0008  3
      * Define local work field Sail Port State
     C                     MOVEL*BLANK    YL0009  2
      * Define local work field OHE Override Type Code
     C                     MOVEL*BLANK    YL0010  2
      * Define null work field U/M - Ordered
     C                     MOVEL*BLANK    YN0009  2
      * Define local work field PFS Carlisle Active
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field PFS AccuSort Active
     C                     MOVEL*BLANK    YL0012  1
      * Define local work field Plant Company Sts
     C                     MOVEL*BLANK    YL0013  1
      * Define local work field WHS/Item Access Sts USR
     C                     MOVEL*BLANK    YL0014  1
      * Define local work field Max Schd Shp Wt Edit Flg
     C                     MOVEL*BLANK    YL0015  1
      * Define local work field Order Weight Assigned
     C                     Z-ADD*ZERO     YL0016 112
      * Define local work field Scheduled Ship Dt Assgnd
     C                     Z-ADD*ZERO     YL0017  70
      * Define local work field Scheduled Ship Date USR
     C                     Z-ADD*ZERO     YL0018  70
      * Define local work field Slot Type f/New Ords USR
     C                     MOVEL*BLANK    YL0019  2
      * Define local work field Boxes Total Quantity
     C                     Z-ADD*ZERO     YL0020 112
      * Define local work field First Order Assigned
     C                     MOVEL*BLANK    YL0021  1
      * Define local work field Slot Type f/load USR
     C                     MOVEL*BLANK    YL0022  2
      * Define local work field Warehouse Code Assigned
     C                     MOVEL*BLANK    YL0023  3
      * Define local work field Warehouse Type Assigned
     C                     MOVEL*BLANK    YL0024  2
      * Define local work field Country Code
     C                     MOVEL*BLANK    YL0025  6
      * Define null work field Ship To State Code
     C                     MOVEL*BLANK    YN0010  2
      * Define local work field Boxes Day 1 Quantity
     C                     Z-ADD*ZERO     YL0026 112
      * Define local work field U/M - Ordered
     C                     MOVEL*BLANK    YL0027  2
      * Define local work field Box Load Min Box Qty USR
     C                     Z-ADD*ZERO     YL0028  50
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0029  30
      * Define null work field Allow Multi-Company
     C                     MOVEL*BLANK    YN0011  1
      * Define null work field Default Printer
     C                     MOVEL*BLANK    YN0012 10
      * Define null work field Salesperson Code
     C                     MOVEL*BLANK    YN0013  3
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0030  30
      * Define local work field Box Load Min Box Qty USR
     C                     Z-ADD*ZERO     YL0031  50
      * Define local work field USR Weight Accumulated
     C                     Z-ADD*ZERO     YL0032 112
      * Define null work field Pallets Loaded
     C                     Z-ADD*ZERO     YN0014  50
      * Define local work field Avg Pallet Tare
     C                     Z-ADD*ZERO     YL0033  92
      * Define null work field Tot Pallet Tare
     C                     Z-ADD*ZERO     YN0015  92
      * Define local work field Order Quantity
     C                     Z-ADD*ZERO     YL0034 112
      * Define local work field Load Create Sts USR
     C                     MOVEL*BLANK    YL0035  1
      * Define local work field Status Flag 4  Y/N
     C                     MOVEL*BLANK    YL0036  1
      * Define local work field Requested Ship Date
     C                     Z-ADD*ZERO     YL0037  70
      * Define local work field Quantity Scheduled
     C                     Z-ADD*ZERO     YL0038 112
      * Define local work field Weight Scheduled
     C                     Z-ADD*ZERO     YL0039 112
      * Define local work field Change Log Prior Value
     C                     MOVEL*BLANK    YL0040 12
      * Define local work field Change Log New Value
     C                     MOVEL*BLANK    YL0041 12
      * Define null work field Shipping Method Dft
     C                     MOVEL*BLANK    YN0016  2
      * Define null work field Load Type Dft
     C                     MOVEL*BLANK    YN0017  1
      * Define null work field LTL Flag Dft
     C                     MOVEL*BLANK    YN0018  1
      * Define null work field Export Status Dft
     C                     MOVEL*BLANK    YN0019  1
      * Define null work field Shrink Wrap Dft
     C                     MOVEL*BLANK    YN0020  1
      * Define null work field Departure Time DFT
     C                     Z-ADD*ZERO     YN0021  40
      * Define null work field Export Code Dft
     C                     MOVEL*BLANK    YN0022  6
      * Define null work field Allow Mult Whse to Order
     C                     MOVEL*BLANK    YN0023  1
      * Define null work field Allow Multi Export On Ord
     C                     MOVEL*BLANK    YN0024  1
      * Define null work field Slip Sheet Dft
     C                     MOVEL*BLANK    YN0025  1
      * Define null work field Palletize Dft
     C                     MOVEL*BLANK    YN0026  1
      * Define local work field Company Organization
     C                     MOVEL*BLANK    YL0042  1
      * Define local work field Default Load Sequence
     C                     MOVEL*BLANK    YL0043  1
      * Define local work field Load U/M
     C                     MOVEL*BLANK    YL0044  2
      * Define null work field Order Number
     C                     Z-ADD*ZERO     YN0027  70
      * Define null work field Ship To Customer
     C                     Z-ADD*ZERO     YN0028  70
      * Define null work field Ship To Name
     C                     MOVEL*BLANK    YN0029 30
      * Define null work field Ship To Address Line 1
     C                     MOVEL*BLANK    YN0030 30
      * Define null work field Ship To Address Line 2
     C                     MOVEL*BLANK    YN0031 30
      * Define null work field Ship To Address Line 3
     C                     MOVEL*BLANK    YN0032 30
      * Define null work field Ship To City
     C                     MOVEL*BLANK    YN0033 20
      * Define null work field Ship To Zip/Postal Code
     C                     MOVEL*BLANK    YN0034 11
      * Define null work field Carrier Code
     C                     MOVEL*BLANK    YN0035  3
      * Define null work field Export Status
     C                     MOVEL*BLANK    YN0036  1
      * Define null work field Export Docs Go w/Driver
     C                     MOVEL*BLANK    YN0037  1
      * Define null work field Air Freight Order
     C                     MOVEL*BLANK    YN0038  1
      * Define null work field Export USDA Approved
     C                     MOVEL*BLANK    YN0039  2
      * Define null work field Company Number
     C                     Z-ADD*ZERO     YN0040  30
      * Define null work field Stop/Drop Sequence Number
     C                     Z-ADD*ZERO     YN0041  50
      * Define null work field Shipping Line
     C                     MOVEL*BLANK    YN0042  3
      * Define null work field Port Delv Terminal
     C                     MOVEL*BLANK    YN0043 20
      * Define null work field OHE City
     C                     MOVEL*BLANK    YN0044 25
      * Define null work field OHE Vessel/Airline
     C                     MOVEL*BLANK    YN0045 30
      * Define null work field OHE Voyage/Flight
     C                     MOVEL*BLANK    YN0046 15
      * Define null work field OHE Booking Number
     C                     MOVEL*BLANK    YN0047 15
      * Define null work field OHE Discharge Port/Airprt
     C                     MOVEL*BLANK    YN0048 20
      * Define null work field OHE Sail/Flight Date
     C                     Z-ADD*ZERO     YN0049  70
      * Define null work field OHE Port Cut Date
     C                     Z-ADD*ZERO     YN0050  70
      * Define null work field OHE Arrival Date
     C                     Z-ADD*ZERO     YN0051  70
      * Define null work field OHE Late Delivery Code
     C                     MOVEL*BLANK    YN0052  3
      * Define null work field OHE Ship Status
     C                     MOVEL*BLANK    YN0053  1
      * Define null work field OHE Container Number
     C                     MOVEL*BLANK    YN0054 12
      * Define null work field OHE Comment 1
     C                     MOVEL*BLANK    YN0055 35
      * Define null work field OHE Comment 2
     C                     MOVEL*BLANK    YN0056 75
      * Define null work field Port City
     C                     MOVEL*BLANK    YN0057 25
      * Define null work field Port Address Line 1
     C                     MOVEL*BLANK    YN0058 25
      * Define null work field Port Address Line 2
     C                     MOVEL*BLANK    YN0059 25
      * Define null work field Sail Port State
     C                     MOVEL*BLANK    YN0060  2
      * Define null work field Port Zip/Postal Code
     C                     MOVEL*BLANK    YN0061 11
      * Define null work field Port Phone Number
     C                     Z-ADD*ZERO     YN0062 110
      * Define null work field Port Fax Number
     C                     MOVEL*BLANK    YN0063 25
      * Define local work field Office Message USR
     C                     MOVEL*BLANK    YL0045132
      * Define local work field Date (Alpha) USR
     C                     MOVEL*BLANK    YL0046  7
      * Define local work field Date Component Alpha  USR
     C                     MOVEL*BLANK    YL0047  2
      * Define local work field System Value Alpha
     C                     MOVEL*BLANK    YL0048 40
      * Define local work field Subject Line USR
     C                     MOVEL*BLANK    YL0049100
      * Define local work field Return Code Usr
     C                     MOVEL*BLANK    YL0050  7
      * Define local work field Auto Combine Loads STS
     C                     MOVEL*BLANK    YL0051  1
      * Define local work field Scheduled Ship Date
     C                     Z-ADD*ZERO     YL0052  70
      * Define local work field Load Status
     C                     MOVEL*BLANK    YL0053  1
      * Define local work field Total Load Order Weight
     C                     Z-ADD*ZERO     YL0054  70
      * Define local work field Flat Amount
     C                     Z-ADD*ZERO     YL0055 112
      * Define null work field Allocate Pounds/Miles
     C                     MOVEL*BLANK    YN0064  1
      * Define null work field Trailer Id
     C                     MOVEL*BLANK    YN0065 20
      * Define local work field Carrier Code
     C                     MOVEL*BLANK    YL0056  3
      * Define local work field Truck Size
     C                     MOVEL*BLANK    YL0057  7
      * Define local work field Load Type
     C                     MOVEL*BLANK    YL0058  1
      * Define null work field Schedule Sequence Number
     C                     Z-ADD*ZERO     YN0066  50
      * Define local work field Total Load Miles
     C                     Z-ADD*ZERO     YL0059  70
      * Define local work field Shipping Method
     C                     MOVEL*BLANK    YL0060  2
      * Define local work field Ship To State Code
     C                     MOVEL*BLANK    YL0061  2
      * Define local work field Load Acceptance Flag
     C                     MOVEL*BLANK    YL0062  1
      * Define null work field Load Status
     C                     MOVEL*BLANK    YN0067  1
      * Define local work field Continue (Yes/No) USR
     C                     MOVEL*BLANK    YL0063  1
      * Define local work field Block Order Flag
     C                     MOVEL*BLANK    YL0064  1
      * Define local work field *SFLSEL
     C                     MOVEL*BLANK    YL0065  1
      * Define null work field Requested Delivery Date
     C                     Z-ADD*ZERO     YN0068  70
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0066  1
      * Define local work field Load Change Type
     C                     MOVEL*BLANK    YL0067  6
      * Define local work field Status - Y or N
     C                     MOVEL*BLANK    YL0068  1
      * Define local work field LD Carrier Appt Date
     C                     Z-ADD*ZERO     YL0069  70
      * Define local work field LD Carrier Appt Time
     C                     Z-ADD*ZERO     YL0070  60
      * Define local work field Default Carrier Code
     C                     MOVEL*BLANK    YL0071  3
      * Define null work field MPC Number
     C                     Z-ADD*ZERO     YN0069  70
      * Define local work field USR Temperature 3.1
     C                     Z-ADD*ZERO     YL0072  31
      * Define local work field Deadline Depart DT    HDR
     C                     Z-ADD*ZERO     YL0073  70
      * Define local work field Deadline Depart Time  HDR
     C                     Z-ADD*ZERO     YL0074  60
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0075  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0076  3
      * Define local work field Order Number Saved USR
     C                     Z-ADD*ZERO     YL0077  70
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     Z-ADD08        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * Change Log
     C                     EXSR UNSUBR                     Change Log
     C                     Z-ADD9999999   W0SLM            *Scan limit
     C                     MOVEL*BLANK    P5DNCD           Application Cod
     C                     MOVEL'OMS'     P5DNCD           Application Cod
      *
     C                     MOVEL*BLANK    WN2145 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN2145           User Profile Na
      *
     C                     MOVEL*BLANK    WN2146 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN2145    WL0038    P      User Profile Na
     C                     EXSR TRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0039    P5I6ST    P      Allow Multi-Com
     C                     MOVELWL0040    P5MPNA    P      Default Printer
     C                     MOVELWL0041    P5BCCD    P      Salesperson Cod
     C                     Z-ADDWL0042    YL0075           Company Number
     C                     MOVELWL0043    WN2146    P      User Code Model
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN2145    ZA0050           User Profile Na
     C                     MOVEL'OMS'     ZA0051           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN2146    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN2145    WL0132    P      User Profile Na
     C                     MOVEL'OMS'     WL0133    P      Application Cod
     C                     EXSR OSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0134    WUAIC3           Company Number
     C                     MOVELWL0135    YL0076    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN2146    WL0132    P      User Profile Na
     C                     MOVEL'OMS'     WL0133    P      Application Cod
     C                     EXSR OSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0134    WUAIC3           Company Number
     C                     MOVELWL0135    YL0076    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0076    P5AJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN2145    ZA0052           User Profile Na
     C                     MOVEL'OMS'     ZA0053           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0075    IFNE 0                          *IF
     C                     Z-ADDYL0075    WUAIC3           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0076    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           P5AJCD    PARM *BLANK    WQ0226  3        Warehouse Code
     C                     PARM YL0075    WQ0227  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR OTRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
     C                     MOVEL*BLANK    P3R4ST           USR Update Flag
     C                     MOVEL*BLANK    WUQZST           USR Assigned Th
      * Rtv Load No. Status   RT - Company Control  * 
     C                     EXSR OVRVGN
      * If load id passed = 0 (add mode), get next load id for auto load
      * CASE: PAR.Load ID is Blank
     C           P1RMNB    IFEQ *ZERO                      *IF
      * If auto = Y, retrieve next load #
      * CASE: PAR.Auto Load Numbering? is Yes
     C           P3PNST    IFEQ 'Y'                        *IF
      * RMC - get next load from '000' company rcd     1/3/05
      * RTV Next Load No.      CH - Company Control  * 
     C                     EXSR OWCHRC
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Stop/Drop Seq.    RT - OM Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1RMNB    WL0001           Load ID
     C                     Z-ADDWURUNB    WL0002           Stop/Drop Seque
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0002    WURUNB           Stop/Drop Seque
     C                     END                             *FI
     C                     Z-ADD*ZERO     WUC4NB           Order Number
     C                     Z-ADD*ZERO     WUA5DT           Requested Ship
     C                     MOVEL'Y'       WUTAST           First Time Flag
     C                     MOVEL'N'       YL0035           Load Create Sts
      * PK0302
      * Get Company Value to determine if the Max Sched Ship Wt edit is d
      * RTV Alpha Value        RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0005           Company Number
     C                     MOVEL@CN,009   WL0006    P      Company Value C
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    YL0015    P      System Value Al
      * ** Set status flag 4 y/n to *Yes instead of blanks    E002102
     C                     MOVEL'Y'       YL0036           Status Flag 4
     C                     MOVEL'Y'       YL0021           First Order Ass
     C                     Z-ADD*ZERO     YL0077           Order Number Sa
     C                     MOVEL'1'       ZZSFM            *Subfile mode
      * RTV Alpha Value        RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0005           Company Number
     C                     MOVEL@CN,010   WL0006    P      Company Value C
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    YL0051    P      System Value Al
      * RTV Appl Whs Restrict  RT - User Profile Control  * 
     C                     EXSR OXRVGN
      * ** Set flag to require DDD/T test against Warehouse Control file
     C                     MOVEL'Y'       P5HHST           Access Limited
      * EXC Rtv Status        XF - PFS Interface  * 
     C                     CALL 'PBXNXFR'              90  EXC Rtv Status
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0228  30       PFS Company Num
     C                     PARM 'TMSLDP'  WQ0229  6        PFS Interface C
     C           YL0011    PARM *BLANK    WQ0230  1        PFS Carlisle Ac
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBXNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * EXC Rtv Status-AS     XF - PFS Interface  * 
     C                     CALL 'PBX2XFR'              90  EXC Rtv Status-
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0231  30       PFS Company Num
     C                     PARM 'TMSLDP'  WQ0232  6        PFS Interface C
     C           YL0012    PARM *BLANK    WQ0233  1        PFS AccuSort Ac
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBX2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** W0BEG
01042010630109001092012980134601554
01558016020205003076030800308803092
03096031010311003116031220313003142
03146033410339803586035880359203600
03604036080361303622036280363403642
03654036580385303859038750388003883
03891038930389603910
** W0END
01044010690109001103012990135301554
01569016080212703078030860309003094
03099031080311403120031280314003143
03150033410339903586035900359803602
03606036110362003626036320364003652
03655036620385303873038780388003889
03891038940390803911
** W0NAM
V2AIC3    #2RMNB    #PPKST    #CNINA    #CCUST    VCHODT    #2VDST
#CHKNA    #CDTWG    #2ST1     #CTENB    V2C4NB    VCFKNB    #CAJCD
#CV1CD    V2AODT    #CMDDI    #2AFTM    V2BKC7    #2HNNA    #2DBCD
#CYGNX    #CQZST    #CXBCD    #1SEL     #RTENB    V1C4NB    V1AIC3
#RAJCD    #RV1CD    V1AODT    #RMDDI    #1AFTM    V1BKC7    #1HNNA
#1DBCD    #RYGNX    #RQZST    #1BCNA    #RLSNA    #1GWST    #1RNNB
#1FRSX    #1Q2CD    #1BRTX    #RXBCD
** @CN
00001 Picked
00002 USR0752
00003 Y2U0005
00004 CHKERR
00005 LOADADDONS
00006 Same Day Load Add-Ons
00007 Notification Alert
00008 DFTCARRIER
00009 MAXFLAG
00010 AUTOCMBLD
