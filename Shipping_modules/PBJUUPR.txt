/********************************************************************/
/*                                                                  */
/*  SYNOPSIS  - PRINT TRAFFIC CARD                                  */
/*  SYSTEM    - ORDER MANAGEMENT SYSTEM                             */
/*  PROGRAM   - PRINT TRAFFIC CARD                                  */
/*  DATE      - 08/21/13                                            */
/*                                                                  */
/********************************************************************/

 PBJUUPR:    PGM        PARM(&OUTQ &HOLD &SAVE &NQSTAT &NIGHTQ +
                          &COMPN &SDATEN &LOADN &COPYN &WHSE1 +
                          &WHSE2 &BLKNBN)
/*------------------------------------------------------------------*/
/* INCOMING PARMS                                                   */
/*------------------------------------------------------------------*/
        DCL    &COMPN      *DEC    (15 5)
        DCL    &LOADN      *DEC    (15 5)
        DCL    &COPYN      *DEC    (15 5)
        DCL    &SDATEN     *DEC    (15 5)
        DCL    &BLKNBN     *DEC    (15 5)

        DCL    &GUY        *DEC    (3 0)
        DCL    &COMP       *DEC    (3 0)
        DCL    &LOAD       *DEC    (7 0)
        DCL    &OUTQ       *CHAR   (10)
        DCL    &HOLD       *CHAR   (4)
        DCL    &SAVE       *CHAR   (4)
        DCL    &COPY       *DEC    (2 0)
        DCL    &NQSTAT     *CHAR   (1)
        DCL    &NIGHTQ     *CHAR   (10)
        DCL    &WHSE1      *CHAR   (3)
        DCL    &WHSE2      *CHAR   (3)
        DCL    &SDATE      *DEC   (7 0)  /* SCHEDULE SHIP DATE            */
        DCL    &BLKNB      *DEC   (5 0)  /*NUMBER OF BLANK CARDS TO PRINT */

/*----------------------------------------------------------------- */
/* PARMS FOR THE RETRIEVE OVERLAY PARAMETERS PROGRAM                */
/*----------------------------------------------------------------- */
             DCL        VAR(&TYPE) TYPE(*CHAR) LEN(2)
             DCL        VAR(&DEPT) TYPE(*CHAR) LEN(6)
             DCL        VAR(&OVERLAY) TYPE(*CHAR) LEN(8)
             DCL        VAR(&CDDPGM) TYPE(*CHAR) LEN(10)
             DCL        VAR(&CDDFILE) TYPE(*CHAR) LEN(10)
             DCL        VAR(&ADDLOBJ) TYPE(*CHAR) LEN(10)
             DCL        VAR(&SENDPHONE) TYPE(*CHAR) LEN(10)
             DCL        VAR(&SENDFAX) TYPE(*CHAR) LEN(10)
             DCL        VAR(&OVOUTQ) TYPE(*CHAR) LEN(10)
             DCL        VAR(&OVHOLD) TYPE(*CHAR) LEN(4)
             DCL        VAR(&OVSAVE) TYPE(*CHAR) LEN(4)
             DCL        VAR(&HOLD) TYPE(*CHAR) LEN(4)
             DCL        VAR(&SAVE) TYPE(*CHAR) LEN(4)
             DCL        VAR(&DRAWER) TYPE(*DEC) LEN(3 0)
             DCL        VAR(&PRTDEVTYPE) TYPE(*CHAR) LEN(10)
             DCL        VAR(&LENGTH) TYPE(*DEC) LEN(3 0)
             DCL        VAR(&WIDTH) TYPE(*DEC) LEN(3 0)
             DCL        VAR(&CPI) TYPE(*DEC) LEN(3 1)
             DCL        VAR(&LPI) TYPE(*DEC) LEN(2 0)
             DCL        VAR(&OVERFLOW) TYPE(*DEC) LEN(3 0)
             DCL        VAR(&ROTATE) TYPE(*CHAR) LEN(5)
             DCL        VAR(&COMMENT1) TYPE(*CHAR) LEN(50)
             DCL        VAR(&COMMENT2) TYPE(*CHAR) LEN(50)
             DCL        VAR(&COMMENT3) TYPE(*CHAR) LEN(50)
             DCL        VAR(&COMMENT4) TYPE(*CHAR) LEN(50)
             DCL        VAR(&COMMENT5) TYPE(*CHAR) LEN(50)
             DCL        VAR(&RECSTS) TYPE(*CHAR) LEN(1)

/*------------------------------------------------------------------*/
/* CHANGE VARIABLES FOR USE IN PROGRAM                              */
/*------------------------------------------------------------------*/
             CHGVAR     VAR(&COMP)    VALUE(&COMPN)
             CHGVAR     VAR(&LOAD)    VALUE(&LOADN)
             CHGVAR     VAR(&COPY)    VALUE(&COPYN)
             CHGVAR     VAR(&SDATE)   VALUE(&SDATEN)
             CHGVAR     VAR(&BLKNB)   VALUE(&BLKNBN)

/*------------------------------------------------------------------*/
/* CALL THE GENERIC RETRIEVE COMPANY DOCUMENT DEFAULTS PROGRAM.     */
/* COMPANY, TYPE, DEPARTMENT, AND OVERLAY NAME ARE INPUT RESTRICTED,*/
/* THE REST ARE OUTPUT PARMS.                                       */
/*------------------------------------------------------------------*/
             CHGVAR     VAR(&GUY)     VALUE(360)
             CHGVAR     VAR(&TYPE)    VALUE('OV')
             CHGVAR     VAR(&DEPT)    VALUE('TRAFF ')
             CHGVAR     VAR(&OVERLAY) VALUE('TRAFCARD')

             CALL       PGM(PMG9XFR) PARM(' ' &GUY &TYPE &DEPT +
                          &OVERLAY &CDDPGM &CDDFILE &ADDLOBJ +
                          &SENDPHONE &SENDFAX &OVOUTQ &OVHOLD +
                          &OVSAVE &DRAWER &PRTDEVTYPE &LENGTH +
                          &WIDTH &LPI &CPI &OVERFLOW &ROTATE +
                          &COMMENT1 &COMMENT2 &COMMENT3 &COMMENT4 +
                          &COMMENT5 &RECSTS)

             IF         COND(&OUTQ *EQ '     ') THEN(CHGVAR +
                          VAR(&OUTQ) VALUE(&OVOUTQ))
             IF         COND(&SAVE *EQ '     ') THEN(CHGVAR +
                          VAR(&SAVE) VALUE(&OVSAVE))
             IF         COND(&HOLD *EQ '     ') THEN(CHGVAR +
                          VAR(&HOLD) VALUE(&OVHOLD))

             OVRPRTF    FILE(&CDDFILE) DEVTYPE(&PRTDEVTYPE) +
                          PAGESIZE(&LENGTH &WIDTH) LPI(&LPI) +
                          CPI(&CPI) OVRFLW(&OVERFLOW) +
                          DRAWER(&DRAWER) PAGRTT(&ROTATE) +
                          FRONTOVL(&OVERLAY 0 2.5) OUTQ(&OUTQ) +
                          FORMTYPE(*STD) COPIES(&COPY) HOLD(&HOLD) +
                          SAVE(&SAVE)

/*********************************************************************/
/*   CALL PRINT PROGRAM                                              */
/*********************************************************************/

             CALL       PGM(PBJSPFR) PARM(' ' &COMP &SDATE &LOAD +
                          &WHSE1 &WHSE2 &BLKNB)

 END:        ENDPGM

