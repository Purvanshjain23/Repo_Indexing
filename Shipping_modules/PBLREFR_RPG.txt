     H/TITLE EDT Assign Booking InfoEF Edit file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Maintain database file using subfile display
     H* - Existing records may be updated
     H* - Key changes are not allowed
     H* - New records cannot be added
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Edit file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 08/09/19  Time  : 08:41:29
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPBLREFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: EDT Assign Booking InfoEF Edit file
      *
     FOMFJCPL4IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RSQ : Load Header               RSQ SchShp/Carrier
      *
     FOPBGWKLXIF  E           K        DISK
      * RSQ : Order Detail              Co/Order/Whs
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FOMFFREL0IF  E           K        DISK
      * RTV : Carrier                   Retrieval index
      *
     FOPBFCPNLIF  E           K        DISK
      * RSQ : Order Header TRG          Load ID/Ship To/Order
      *
     FCAEOREL5IF  E           K        DISK
      * RSQ : Company Customer          Customer
      *
     FOPBFCPLGIF  E           K        DISK
      * RSQ : Order Header TRG          Load Id/Order Num
      *
     FPMAMREL2IF  E           K        DISK
      * RSQ : Order Header Extension    Load ID/Order#/Co#
      *
     FPDLYREL1IF  E           K        DISK
      * RTV : Trailer                   Retrieval index
      *
     FOMFJCPMOIF  E           K        DISK
      * RSQ : Load Header               Trailer/Carrier/Load
      *
     FOMFLCPL1IF  E           K        DISK
      * RTV : Load Detail               Retrieval index
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FOPBFCPL8IF  E           K        DISK
      * RSQ : Order Header TRG          Load #/All orders
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FPDLYREL0UF  E           K        DISK                      A
      * UPD : Trailer                   Update index
      *
     FOMFJCPL1UF  E           K        DISK
      * UPD : Load Header               Update index
      *
     FPMAMREL0UF  E           K        DISK
      * UPD : Order Header Extension    Update index
      *
     FOMFLCPL0UF  E           K        DISK
      * UPD : Load Detail               Update index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * Long constants
     E                    @CN#    1  08  6   @CN    25
     I@BFCPRQ
      * Order Header TRG          Load Id/Order Num
      * Renamed input format fields
     I              BEAIC3                          WAAIC3
     I              BEC4NB                          WAC4NB
     I              BEJNCD                          WAJNCD
     I              BEANC7                          WAANC7
     I              BEBKC7                          WABKC7
     I              BEBRTX                          WABRTX
     I              BEHMNA                          WAHMNA
     I              BEHONA                          WAHONA
     I              BEHPNA                          WAHPNA
     I              BEHNNA                          WAHNNA
     I              BEDBCD                          WADBCD
     I              BECKTX                          WACKTX
     I              BEB0C7                          WAB0C7
     I              BEAETX                          WAAETX
     I              BEB1NA                          WAB1NA
     I              BEB3NA                          WAB3NA
     I              BEB4NA                          WAB4NA
     I              BEB2NA                          WAB2NA
     I              BEBHCD                          WABHCD
     I              BEC8TX                          WAC8TX
     I              BEBCNA                          WABCNA
     I              BEA0DT                          WAA0DT
     I              BEA5DT                          WAA5DT
     I              BEGNDT                          WAGNDT
     I              BEACDT                          WAACDT
     I              BEAQCD                          WAAQCD
     I              BEB6NA                          WAB6NA
     I              BEBYNA                          WABYNA
     I              BEBZNA                          WABZNA
     I              BEGTST                          WAGTST
     I              BEGVST                          WAGVST
     I              BEGUST                          WAGUST
     I              BEQFST                          WAQFST
     I              BECQCD                          WACQCD
     I              BEGJST                          WAGJST
     I              BEGWST                          WAGWST
     I              BEGXST                          WAGXST
     I              BEGYST                          WAGYST
     I              BEAODT                          WAAODT
     I              BEAIVN                          WAAIVN
     I              BECXDT                          WACXDT
     I              BEJZVA                          WAJZVA
     I              BEA1WG                          WAA1WG
     I              BEXIST                          WAXIST
     I              BEXJST                          WAXJST
     I              BEXKST                          WAXKST
     I              BEEIDT                          WAEIDT
     I              BEAFTM                          WAAFTM
     I              BEE8CD                          WAE8CD
     I              BEE9CD                          WAE9CD
     I              BERMNB                          WARMNB
     I              BETBNB                          WATBNB
     I              BER1NB                          WAR1NB
     I              BEPJST                          WAPJST
     I              BEU0ST                          WAU0ST
     I              BEU1ST                          WAU1ST
     I              BEQ2CD                          WAQ2CD
     I              BEU2ST                          WAU2ST
     I              BEVEST                          WAVEST
     I              BEVFST                          WAVFST
     I              BEVGST                          WAVGST
     I              BERPCD                          WARPCD
     I              BERNNB                          WARNNB
     I              BEVDST                          WAVDST
     I              BEATIN                          WAATIN
     I              BEU4ST                          WAU4ST
     I              BEU5ST                          WAU5ST
     I              BERSRN                          WARSRN
     I              BEMHNA                          WAMHNA
     I              BEMINA                          WAMINA
     I              BEWBST                          WAWBST
     I              BER4CD                          WAR4CD
     I              BEBFCD                          WABFCD
     I              BEQ4CD                          WAQ4CD
     I              BET3NB                          WAT3NB
     I              BESICD                          WASICD
     I              BECONB                          WACONB
     I              BECEST                          WACEST
     I              BEAWDT                          WAAWDT
     I              BEJPCD                          WAJPCD
     I              BEXUST                          WAXUST
     I              BEZ1ST                          WAZ1ST
     I              BEVRVA                          WAVRVA
     I              BEOBST                          WAOBST
     I              BEBCST                          WABCST
     I              BEBDST                          WABDST
     I              BEB7VL                          WAB7VL
     I              BEGASX                          WAGASX
     I              BEGBSX                          WAGBSX
     I              BEGCSX                          WAGCSX
     I              BEGDSX                          WAGDSX
     I              BEFNSX                          WAFNSX
     I              BEFOSX                          WAFOSX
     I              BEFPSX                          WAFPSX
     I              BEFQSX                          WAFQSX
     I              BEFRSX                          WAFRSX
     I              BEFSSX                          WAFSSX
     I              BEFTSX                          WAFTSX
     I              BEFUSX                          WAFUSX
     I              BEFVSX                          WAFVSX
     I              BEFWSX                          WAFWSX
     I              BEFXSX                          WAFXSX
     I              BEFYSX                          WAFYSX
     I              BENODT                          WANODT
     I              BENPDT                          WANPDT
     I              BENQDT                          WANQDT
     I              BENRDT                          WANRDT
     I              BENSDT                          WANSDT
     I              BEBPTM                          WABPTM
     I              BEBQTM                          WABQTM
     I              BEBRTM                          WABRTM
     I              BEBSTM                          WABSTM
     I              BEBTTM                          WABTTM
     I              BEH0NX                          WAH0NX
     I              BEH1NX                          WAH1NX
     I              BEH2NX                          WAH2NX
     I              BEH3NX                          WAH3NX
     I              BEH4NX                          WAH4NX
     I              BEC0C7                          WAC0C7
     I              BEUVST                          WAUVST
     I              BEUWST                          WAUWST
     I              BEUXST                          WAUXST
     I              BEAATM                          WAAATM
     I              BEAYNA                          WAAYNA
     I              BEA0NA                          WAA0NA
     I              BEAXDT                          WAAXDT
      *
     I@LYRER2
      * Trailer                   Update index
      * Renamed input format fields
     I              LYBZNA                          WBBZNA
     I              LYDXTX                          WBDXTX
     I              LYAIC3                          WBAIC3
     I              LYVDST                          WBVDST
     I              LYX3ST                          WBX3ST
     I              LYXGST                          WBXGST
     I              LYSTOY                          WBSTOY
     I              LYKKDT                          WBKKDT
     I              LYAVTM                          WBAVTM
     I              LYSTAS                          WBSTAS
     I              LYXRST                          WBXRST
     I              LYX7CD                          WBX7CD
     I              LYGXTX                          WBGXTX
     I              LYXTST                          WBXTST
     I              LYXVST                          WBXVST
     I              LYSTU3                          WBSTU3
     I              LYSTU4                          WBSTU4
     I              LYSTU5                          WBSTU5
     I              LYLCDT                          WBLCDT
     I              LYLDDT                          WBLDDT
     I              LYLEDT                          WBLEDT
     I              LYLFDT                          WBLFDT
     I              LYLGDT                          WBLGDT
     I              LYUVST                          WBUVST
     I              LYUWST                          WBUWST
     I              LYUXST                          WBUXST
     I              LYVSST                          WBVSST
     I              LYAATM                          WBAATM
     I              LYAYNA                          WBAYNA
     I              LYA0NA                          WBA0NA
     I              LYAXDT                          WBAXDT
      *
     I@FJCPMJ
      * Load Header               Trailer/Carrier/Load
      * Renamed input format fields
     I              FJRMNB                          WCRMNB
     I              FJAIC3                          WCAIC3
     I              FJAODT                          WCAODT
     I              FJPJST                          WCPJST
     I              FJPKST                          WCPKST
     I              FJRNNB                          WCRNNB
     I              FJDMTX                          WCDMTX
     I              FJDNTX                          WCDNTX
     I              FJDOTX                          WCDOTX
     I              FJWTTX                          WCWTTX
     I              FJWUTX                          WCWUTX
     I              FJRPNB                          WCRPNB
     I              FJFLAM                          WCFLAM
     I              FJXQST                          WCXQST
     I              FJRRNB                          WCRRNB
     I              FJDXTX                          WCDXTX
     I              FJDYTX                          WCDYTX
     I              FJSBNB                          WCSBNB
     I              FJBZNA                          WCBZNA
     I              FJRONB                          WCRONB
     I              FJSQNB                          WCSQNB
     I              FJR1NB                          WCR1NB
     I              FJVCST                          WCVCST
     I              FJVDST                          WCVDST
     I              FJSDNB                          WCSDNB
     I              FJPAOU                          WCPAOU
     I              FJDGWG                          WCDGWG
     I              FJSXNB                          WCSXNB
     I              FJHADT                          WCHADT
     I              FJAART                          WCAART
     I              FJDHWG                          WCDHWG
     I              FJDIWG                          WCDIWG
     I              FJAQDT                          WCAQDT
     I              FJS6NB                          WCS6NB
     I              FJT4NB                          WCT4NB
     I              FJPRTM                          WCPRTM
     I              FJNPSV                          WCNPSV
     I              FJJ8TX                          WCJ8TX
     I              FJTLMI                          WCTLMI
     I              FJJ9TX                          WCJ9TX
     I              FJQ2CD                          WCQ2CD
     I              FJVPCD                          WCVPCD
     I              FJDBCD                          WCDBCD
     I              FJGRWE                          WCGRWE
     I              FJXCCD                          WCXCCD
     I              FJU2ST                          WCU2ST
     I              FJF9DT                          WCF9DT
     I              FJONTM                          WCONTM
     I              FJJ4DT                          WCJ4DT
     I              FJTRTM                          WCTRTM
     I              FJJ5DT                          WCJ5DT
     I              FJSPTM                          WCSPTM
     I              FJJ6DT                          WCJ6DT
     I              FJLFTM                          WCLFTM
     I              FJJ7DT                          WCJ7DT
     I              FJBOTM                          WCBOTM
     I              FJJ8DT                          WCJ8DT
     I              FJBLTM                          WCBLTM
     I              FJKIDT                          WCKIDT
     I              FJASTM                          WCASTM
     I              FJKADT                          WCKADT
     I              FJAJCM                          WCAJCM
     I              FJXACD                          WCXACD
     I              FJOANA                          WCOANA
     I              FJK4TX                          WCK4TX
     I              FJVOAG                          WCVOAG
     I              FJKBDT                          WCKBDT
     I              FJNBBO                          WCNBBO
     I              FJW4CD                          WCW4CD
     I              FJEFDT                          WCEFDT
     I              FJCNTN                          WCCNTN
     I              FJKCDT                          WCKCDT
     I              FJTMIN                          WCTMIN
     I              FJKDDT                          WCKDDT
     I              FJVMNB                          WCVMNB
     I              FJOCFR                          WCOCFR
     I              FJKJDT                          WCKJDT
     I              FJATTM                          WCATTM
     I              FJOTRS                          WCOTRS
     I              FJRNST                          WCRNST
     I              FJBRBK                          WCBRBK
     I              FJEIDT                          WCEIDT
     I              FJRMST                          WCRMST
     I              FJAJCD                          WCAJCD
     I              FJKKDT                          WCKKDT
     I              FJAVTM                          WCAVTM
     I              FJKZDT                          WCKZDT
     I              FJAXTM                          WCAXTM
     I              FJLHOS                          WCLHOS
     I              FJLHOR                          WCLHOR
     I              FJWNTX                          WCWNTX
     I              FJOITX                          WCOITX
     I              FJOJTX                          WCOJTX
     I              FJLLDT                          WCLLDT
     I              FJLSHG                          WCLSHG
     I              FJYPST                          WCYPST
     I              FJK0DT                          WCK0DT
     I              FJAYTM                          WCAYTM
     I              FJKNNX                          WCKNNX
     I              FJICWG                          WCICWG
     I              FJIDWG                          WCIDWG
     I              FJH9SX                          WCH9SX
     I              FJWOTX                          WCWOTX
     I              FJK1DT                          WCK1DT
     I              FJAZTM                          WCAZTM
     I              FJK2DT                          WCK2DT
     I              FJA0TM                          WCA0TM
     I              FJROST                          WCROST
     I              FJRPST                          WCRPST
     I              FJRQST                          WCRQST
     I              FJRRST                          WCRRST
     I              FJZBVA                          WCZBVA
     I              FJWPTX                          WCWPTX
     I              FJWQTX                          WCWQTX
     I              FJWRTX                          WCWRTX
     I              FJWSTX                          WCWSTX
     I              FJRVSX                          WCRVSX
     I              FJRUSX                          WCRUSX
     I              FJRWSX                          WCRWSX
     I              FJRXSX                          WCRXSX
     I              FJRYSX                          WCRYSX
     I              FJRZSX                          WCRZSX
     I              FJR0SX                          WCR0SX
     I              FJR1SX                          WCR1SX
     I              FJR2SX                          WCR2SX
     I              FJR3SX                          WCR3SX
     I              FJR4SX                          WCR4SX
     I              FJPYDT                          WCPYDT
     I              FJCKTM                          WCCKTM
     I              FJPZDT                          WCPZDT
     I              FJCLTM                          WCCLTM
     I              FJP0DT                          WCP0DT
     I              FJCMTM                          WCCMTM
     I              FJP1DT                          WCP1DT
     I              FJCNTM                          WCCNTM
     I              FJP2DT                          WCP2DT
     I              FJCOTM                          WCCOTM
     I              FJP3DT                          WCP3DT
     I              FJCQTM                          WCCQTM
     I              FJUVST                          WCUVST
     I              FJUWST                          WCUWST
     I              FJUXST                          WCUXST
     I              FJAATM                          WCAATM
     I              FJAYNA                          WCAYNA
     I              FJA0NA                          WCA0NA
     I              FJAXDT                          WCAXDT
      *
     I@AMREJE
      * Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                          WDAIC3
     I              AMC4NB                          WDC4NB
     I              AMRMNB                          WDRMNB
     I              AMRUNB                          WDRUNB
     I              AMXACD                          WDXACD
     I              AMOANA                          WDOANA
     I              AMHBAA                          WDHBAA
     I              AMJ0T1                          WDJ0T1
     I              AMGENY                          WDGENY
     I              AMJ1T1                          WDJ1T1
     I              AMHCAA                          WDHCAA
     I              AMQWDT                          WDQWDT
     I              AMQXDT                          WDQXDT
     I              AMQYDT                          WDQYDT
     I              AMHDAA                          WDHDAA
     I              AMCCTX                          WDCCTX
     I              AMJ2T1                          WDJ2T1
     I              AMRLNA                          WDRLNA
     I              AMRMNA                          WDRMNA
     I              AMGINY                          WDGINY
     I              AMGFNY                          WDGFNY
     I              AMGGNY                          WDGGNY
     I              AMGHNY                          WDGHNY
     I              AMHEVL                          WDHEVL
     I              AMHFVL                          WDHFVL
     I              AMHGVL                          WDHGVL
     I              AMQZDT                          WDQZDT
     I              AMQ0DT                          WDQ0DT
     I              AMQ1DT                          WDQ1DT
     I              AMQ2DT                          WDQ2DT
     I              AMC2TX                          WDC2TX
     I              AMC3TX                          WDC3TX
     I              AMC6TX                          WDC6TX
     I              AMCHTX                          WDCHTX
     I              AMCITX                          WDCITX
     I              AMCLTX                          WDCLTX
     I              AMB4TX                          WDB4TX
     I              AMCUTX                          WDCUTX
     I              AMCVTX                          WDCVTX
     I              AMB9TX                          WDB9TX
     I              AMJWSC                          WDJWSC
     I              AMITNY                          WDITNY
     I              AMLMT1                          WDLMT1
     I              AMLWAA                          WDLWAA
     I              AMFVST                          WDFVST
     I              AMF0ST                          WDF0ST
     I              AMF2ST                          WDF2ST
     I              AMF3ST                          WDF3ST
     I              AMJUSC                          WDJUSC
     I              AMJVSC                          WDJVSC
     I              AMV3T1                          WDV3T1
     I              AMV4T1                          WDV4T1
     I              AMV5T1                          WDV5T1
     I              AMV6T1                          WDV6T1
     I              AMV7T1                          WDV7T1
     I              AMV8T1                          WDV8T1
     I              AMV9T1                          WDV9T1
     I              AMWAT1                          WDWAT1
     I              AMWBT1                          WDWBT1
     I              AMWCT1                          WDWCT1
     I              AMWDT1                          WDWDT1
     I              AMQJNY                          WDQJNY
     I              AMQKNY                          WDQKNY
     I              AMQLNY                          WDQLNY
     I              AMP8NY                          WDP8NY
     I              AMP9NY                          WDP9NY
     I              AMQANY                          WDQANY
     I              AMQCNY                          WDQCNY
     I              AMQDNY                          WDQDNY
     I              AMQENY                          WDQENY
     I              AMQFNY                          WDQFNY
     I              AMQGNY                          WDQGNY
     I              AMQHNY                          WDQHNY
     I              AMQINY                          WDQINY
     I              AMQMNY                          WDQMNY
     I              AMMYU1                          WDMYU1
     I              AMJXSC                          WDJXSC
     I              AMJYSC                          WDJYSC
     I              AMJZSC                          WDJZSC
     I              AMJ0SC                          WDJ0SC
     I              AMMZU1                          WDMZU1
     I              AMM0U1                          WDM0U1
     I              AMM1U1                          WDM1U1
     I              AMM2U1                          WDM2U1
     I              AMM3U1                          WDM3U1
     I              AMW5DT                          WDW5DT
     I              AMW6DT                          WDW6DT
     I              AMUVST                          WDUVST
     I              AMUWST                          WDUWST
     I              AMUXST                          WDUXST
     I              AMVSST                          WDVSST
     I              AMAATM                          WDAATM
     I              AMAYNA                          WDAYNA
     I              AMA0NA                          WDA0NA
     I              AMAXDT                          WDAXDT
      *
     I@FLCPBM
      * Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WERMNB
     I              FLRUNB                          WERUNB
     I              FLRVNB                          WERVNB
     I              FLDQTX                          WEDQTX
     I              FLRWNB                          WERWNB
     I              FLRXNB                          WERXNB
     I              FLSQNB                          WESQNB
     I              FLT0NB                          WET0NB
     I              FLT1NB                          WET1NB
     I              FLR1NB                          WER1NB
     I              FLAIC3                          WEAIC3
     I              FLC4NB                          WEC4NB
     I              FLVCST                          WEVCST
     I              FLKEDT                          WEKEDT
     I              FLSXNB                          WESXNB
     I              FLKFDT                          WEKFDT
     I              FLACTM                          WEACTM
     I              FLK5TX                          WEK5TX
     I              FLW5CD                          WEW5CD
     I              FLEJDT                          WEEJDT
     I              FLAGTM                          WEAGTM
     I              FLKJDT                          WEKJDT
     I              FLATTM                          WEATTM
     I              FLHDDT                          WEHDDT
     I              FLAUTM                          WEAUTM
     I              FLKKDT                          WEKKDT
     I              FLAVTM                          WEAVTM
     I              FLZ4NB                          WEZ4NB
     I              FLY7ST                          WEY7ST
     I              FLY2ST                          WEY2ST
     I              FLWHTX                          WEWHTX
     I              FLWITX                          WEWITX
     I              FLWJTX                          WEWJTX
     I              FLWKTX                          WEWKTX
     I              FLWLTX                          WEWLTX
     I              FLN7DT                          WEN7DT
     I              FLN8DT                          WEN8DT
     I              FLN9DT                          WEN9DT
     I              FLB3TM                          WEB3TM
     I              FLB4TM                          WEB4TM
     I              FLB5TM                          WEB5TM
     I              FLIASX                          WEIASX
     I              FLIBSX                          WEIBSX
     I              FLICSX                          WEICSX
     I              FLWVTX                          WEWVTX
     I              FLWWTX                          WEWWTX
     I              FLWXTX                          WEWXTX
     I              FLUVST                          WEUVST
     I              FLUWST                          WEUWST
     I              FLUXST                          WEUXST
     I              FLAATM                          WEAATM
     I              FLAYNA                          WEAYNA
     I              FLA0NA                          WEA0NA
     I              FLAXDT                          WEAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WFAIC3
     I              OMC4NB                          WFC4NB
     I              OMDPNB                          WFDPNB
     I              OMUENB                          WFUENB
     I              OMHGCD                          WFHGCD
     I              OMAJCD                          WFAJCD
     I              OMBKC7                          WFBKC7
     I              OMCFC7                          WFCFC7
     I              OMGMST                          WFGMST
     I              OMGNST                          WFGNST
     I              OMMAVA                          WFMAVA
     I              OMKDVA                          WFKDVA
     I              OML8VA                          WFL8VA
     I              OML9VA                          WFL9VA
     I              OMGTST                          WFGTST
     I              OMGVST                          WFGVST
     I              OMGUST                          WFGUST
     I              OMQFST                          WFQFST
     I              OMAYVA                          WFAYVA
     I              OMEXDT                          WFEXDT
     I              OMLQCD                          WFLQCD
     I              OMRDCD                          WFRDCD
     I              OMQ7CD                          WFQ7CD
     I              OMBZPR                          WFBZPR
     I              OML6NB                          WFL6NB
     I              OMU1ST                          WFU1ST
     I              OMGIDT                          WFGIDT
     I              OMCRCD                          WFCRCD
     I              OMAGCD                          WFAGCD
     I              OMRZST                          WFRZST
     I              OMR0ST                          WFR0ST
     I              OMR1ST                          WFR1ST
     I              OMG7NA                          WFG7NA
     I              OMG8NA                          WFG8NA
     I              OMRPCD                          WFRPCD
     I              OMVEST                          WFVEST
     I              OMVGST                          WFVGST
     I              OMAVST                          WFAVST
     I              OMU0ST                          WFU0ST
     I              OMRFCD                          WFRFCD
     I              OMFZST                          WFFZST
     I              OMR1NB                          WFR1NB
     I              OMAVQT                          WFAVQT
     I              OMD0WG                          WFD0WG
     I              OMCCQT                          WFCCQT
     I              OMAUWG                          WFAUWG
     I              OMCBQT                          WFCBQT
     I              OMATWG                          WFATWG
     I              OMAQCS                          WFAQCS
     I              OMAGCS                          WFAGCS
     I              OMAKPR                          WFAKPR
     I              OMALPR                          WFALPR
     I              OMAUPR                          WFAUPR
     I              OMAVWG                          WFAVWG
     I              OMA4WG                          WFA4WG
     I              OMA5DT                          WFA5DT
     I              OMAODT                          WFAODT
     I              OMGNDT                          WFGNDT
     I              OMAMST                          WFAMST
     I              OMANST                          WFANST
     I              OMVAST                          WFVAST
     I              OMRGNB                          WFRGNB
     I              OMRHNB                          WFRHNB
     I              OMRINB                          WFRINB
     I              OMRBCD                          WFRBCD
     I              OMHICD                          WFHICD
     I              OMRNCD                          WFRNCD
     I              OMROCD                          WFROCD
     I              OMCXDT                          WFCXDT
     I              OMAJVN                          WFAJVN
     I              OMKXCD                          WFKXCD
     I              OMJPCD                          WFJPCD
     I              OMCQCD                          WFCQCD
     I              OMR4CD                          WFR4CD
     I              OMZ1ST                          WFZ1ST
     I              OMZ3ST                          WFZ3ST
     I              OMZ4ST                          WFZ4ST
     I              OMDUPR                          WFDUPR
     I              OMB6VL                          WFB6VL
     I              OMA1AA                          WFA1AA
     I              OMFZSX                          WFFZSX
     I              OMF0SX                          WFF0SX
     I              OMF1SX                          WFF1SX
     I              OMF2SX                          WFF2SX
     I              OMF3SX                          WFF3SX
     I              OMF4SX                          WFF4SX
     I              OMF5SX                          WFF5SX
     I              OMF6SX                          WFF6SX
     I              OMF7SX                          WFF7SX
     I              OMNTDT                          WFNTDT
     I              OMNUDT                          WFNUDT
     I              OMNVDT                          WFNVDT
     I              OMNWDT                          WFNWDT
     I              OMNXDT                          WFNXDT
     I              OMBUTM                          WFBUTM
     I              OMBVTM                          WFBVTM
     I              OMBWTM                          WFBWTM
     I              OMBXTM                          WFBXTM
     I              OMBYTM                          WFBYTM
     I              OMH5NX                          WFH5NX
     I              OMH6NX                          WFH6NX
     I              OMH7NX                          WFH7NX
     I              OMH8NX                          WFH8NX
     I              OMH9NX                          WFH9NX
     I              OMDVPR                          WFDVPR
     I              OMDWPR                          WFDWPR
     I              OMDXPR                          WFDXPR
     I              OMDYPR                          WFDYPR
     I              OMDZPR                          WFDZPR
     I              OMGSPR                          WFGSPR
     I              OMGTPR                          WFGTPR
     I              OMGUPR                          WFGUPR
     I              OMHOST                          WFHOST
     I              OMHPST                          WFHPST
     I              OMIOST                          WFIOST
     I              OMPEWG                          WFPEWG
     I              OMRINY                          WFRINY
     I              OMTIDT                          WFTIDT
     I              OMTJDT                          WFTJDT
     I              OMH2ST                          WFH2ST
     I              OMH0ST                          WFH0ST
     I              OMH1ST                          WFH1ST
     I              OMTKDT                          WFTKDT
     I              OMTLDT                          WFTLDT
     I              OMTMDT                          WFTMDT
     I              OMUVST                          WFUVST
     I              OMUWST                          WFUWST
     I              OMUXST                          WFUXST
     I              OMAATM                          WFAATM
     I              OMAYNA                          WFAYNA
     I              OMA0NA                          WFA0NA
     I              OMAXDT                          WFAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WGAIC3
     I              OMC4NB                          WGC4NB
     I              OMDPNB                          WGDPNB
     I              OMUENB                          WGUENB
     I              OMHGCD                          WGHGCD
     I              OMAJCD                          WGAJCD
     I              OMBKC7                          WGBKC7
     I              OMCFC7                          WGCFC7
     I              OMGMST                          WGGMST
     I              OMGNST                          WGGNST
     I              OMMAVA                          WGMAVA
     I              OMKDVA                          WGKDVA
     I              OML8VA                          WGL8VA
     I              OML9VA                          WGL9VA
     I              OMGTST                          WGGTST
     I              OMGVST                          WGGVST
     I              OMGUST                          WGGUST
     I              OMQFST                          WGQFST
     I              OMAYVA                          WGAYVA
     I              OMEXDT                          WGEXDT
     I              OMLQCD                          WGLQCD
     I              OMRDCD                          WGRDCD
     I              OMQ7CD                          WGQ7CD
     I              OMBZPR                          WGBZPR
     I              OML6NB                          WGL6NB
     I              OMU1ST                          WGU1ST
     I              OMGIDT                          WGGIDT
     I              OMCRCD                          WGCRCD
     I              OMAGCD                          WGAGCD
     I              OMRZST                          WGRZST
     I              OMR0ST                          WGR0ST
     I              OMR1ST                          WGR1ST
     I              OMG7NA                          WGG7NA
     I              OMG8NA                          WGG8NA
     I              OMRPCD                          WGRPCD
     I              OMVEST                          WGVEST
     I              OMVGST                          WGVGST
     I              OMAVST                          WGAVST
     I              OMU0ST                          WGU0ST
     I              OMRFCD                          WGRFCD
     I              OMFZST                          WGFZST
     I              OMR1NB                          WGR1NB
     I              OMAVQT                          WGAVQT
     I              OMD0WG                          WGD0WG
     I              OMCCQT                          WGCCQT
     I              OMAUWG                          WGAUWG
     I              OMCBQT                          WGCBQT
     I              OMATWG                          WGATWG
     I              OMAQCS                          WGAQCS
     I              OMAGCS                          WGAGCS
     I              OMAKPR                          WGAKPR
     I              OMALPR                          WGALPR
     I              OMAUPR                          WGAUPR
     I              OMAVWG                          WGAVWG
     I              OMA4WG                          WGA4WG
     I              OMA5DT                          WGA5DT
     I              OMAODT                          WGAODT
     I              OMGNDT                          WGGNDT
     I              OMAMST                          WGAMST
     I              OMANST                          WGANST
     I              OMVAST                          WGVAST
     I              OMRGNB                          WGRGNB
     I              OMRHNB                          WGRHNB
     I              OMRINB                          WGRINB
     I              OMRBCD                          WGRBCD
     I              OMHICD                          WGHICD
     I              OMRNCD                          WGRNCD
     I              OMROCD                          WGROCD
     I              OMCXDT                          WGCXDT
     I              OMAJVN                          WGAJVN
     I              OMKXCD                          WGKXCD
     I              OMJPCD                          WGJPCD
     I              OMCQCD                          WGCQCD
     I              OMR4CD                          WGR4CD
     I              OMZ1ST                          WGZ1ST
     I              OMZ3ST                          WGZ3ST
     I              OMZ4ST                          WGZ4ST
     I              OMDUPR                          WGDUPR
     I              OMB6VL                          WGB6VL
     I              OMA1AA                          WGA1AA
     I              OMFZSX                          WGFZSX
     I              OMF0SX                          WGF0SX
     I              OMF1SX                          WGF1SX
     I              OMF2SX                          WGF2SX
     I              OMF3SX                          WGF3SX
     I              OMF4SX                          WGF4SX
     I              OMF5SX                          WGF5SX
     I              OMF6SX                          WGF6SX
     I              OMF7SX                          WGF7SX
     I              OMNTDT                          WGNTDT
     I              OMNUDT                          WGNUDT
     I              OMNVDT                          WGNVDT
     I              OMNWDT                          WGNWDT
     I              OMNXDT                          WGNXDT
     I              OMBUTM                          WGBUTM
     I              OMBVTM                          WGBVTM
     I              OMBWTM                          WGBWTM
     I              OMBXTM                          WGBXTM
     I              OMBYTM                          WGBYTM
     I              OMH5NX                          WGH5NX
     I              OMH6NX                          WGH6NX
     I              OMH7NX                          WGH7NX
     I              OMH8NX                          WGH8NX
     I              OMH9NX                          WGH9NX
     I              OMDVPR                          WGDVPR
     I              OMDWPR                          WGDWPR
     I              OMDXPR                          WGDXPR
     I              OMDYPR                          WGDYPR
     I              OMDZPR                          WGDZPR
     I              OMGSPR                          WGGSPR
     I              OMGTPR                          WGGTPR
     I              OMGUPR                          WGGUPR
     I              OMHOST                          WGHOST
     I              OMHPST                          WGHPST
     I              OMIOST                          WGIOST
     I              OMPEWG                          WGPEWG
     I              OMRINY                          WGRINY
     I              OMTIDT                          WGTIDT
     I              OMTJDT                          WGTJDT
     I              OMH2ST                          WGH2ST
     I              OMH0ST                          WGH0ST
     I              OMH1ST                          WGH1ST
     I              OMTKDT                          WGTKDT
     I              OMTLDT                          WGTLDT
     I              OMTMDT                          WGTMDT
     I              OMUVST                          WGUVST
     I              OMUWST                          WGUWST
     I              OMUXST                          WGUXST
     I              OMAATM                          WGAATM
     I              OMAYNA                          WGAYNA
     I              OMA0NA                          WGA0NA
     I              OMAXDT                          WGAXDT
      *
     I@BFCPD9
      * Order Header TRG          Load #/All orders
      * Renamed input format fields
     I              BEAIC3                          WHAIC3
     I              BEC4NB                          WHC4NB
     I              BEJNCD                          WHJNCD
     I              BEANC7                          WHANC7
     I              BEBKC7                          WHBKC7
     I              BEBRTX                          WHBRTX
     I              BEHMNA                          WHHMNA
     I              BEHONA                          WHHONA
     I              BEHPNA                          WHHPNA
     I              BEHNNA                          WHHNNA
     I              BEDBCD                          WHDBCD
     I              BECKTX                          WHCKTX
     I              BEB0C7                          WHB0C7
     I              BEAETX                          WHAETX
     I              BEB1NA                          WHB1NA
     I              BEB3NA                          WHB3NA
     I              BEB4NA                          WHB4NA
     I              BEB2NA                          WHB2NA
     I              BEBHCD                          WHBHCD
     I              BEC8TX                          WHC8TX
     I              BEBCNA                          WHBCNA
     I              BEA0DT                          WHA0DT
     I              BEA5DT                          WHA5DT
     I              BEGNDT                          WHGNDT
     I              BEACDT                          WHACDT
     I              BEAQCD                          WHAQCD
     I              BEB6NA                          WHB6NA
     I              BEBYNA                          WHBYNA
     I              BEBZNA                          WHBZNA
     I              BEGTST                          WHGTST
     I              BEGVST                          WHGVST
     I              BEGUST                          WHGUST
     I              BEQFST                          WHQFST
     I              BECQCD                          WHCQCD
     I              BEGJST                          WHGJST
     I              BEGWST                          WHGWST
     I              BEGXST                          WHGXST
     I              BEGYST                          WHGYST
     I              BEAODT                          WHAODT
     I              BEAIVN                          WHAIVN
     I              BECXDT                          WHCXDT
     I              BEJZVA                          WHJZVA
     I              BEA1WG                          WHA1WG
     I              BEXIST                          WHXIST
     I              BEXJST                          WHXJST
     I              BEXKST                          WHXKST
     I              BEEIDT                          WHEIDT
     I              BEAFTM                          WHAFTM
     I              BEE8CD                          WHE8CD
     I              BEE9CD                          WHE9CD
     I              BERMNB                          WHRMNB
     I              BETBNB                          WHTBNB
     I              BER1NB                          WHR1NB
     I              BEPJST                          WHPJST
     I              BEU0ST                          WHU0ST
     I              BEU1ST                          WHU1ST
     I              BEQ2CD                          WHQ2CD
     I              BEU2ST                          WHU2ST
     I              BEVEST                          WHVEST
     I              BEVFST                          WHVFST
     I              BEVGST                          WHVGST
     I              BERPCD                          WHRPCD
     I              BERNNB                          WHRNNB
     I              BEVDST                          WHVDST
     I              BEATIN                          WHATIN
     I              BEU4ST                          WHU4ST
     I              BEU5ST                          WHU5ST
     I              BERSRN                          WHRSRN
     I              BEMHNA                          WHMHNA
     I              BEMINA                          WHMINA
     I              BEWBST                          WHWBST
     I              BER4CD                          WHR4CD
     I              BEBFCD                          WHBFCD
     I              BEQ4CD                          WHQ4CD
     I              BET3NB                          WHT3NB
     I              BESICD                          WHSICD
     I              BECONB                          WHCONB
     I              BECEST                          WHCEST
     I              BEAWDT                          WHAWDT
     I              BEJPCD                          WHJPCD
     I              BEXUST                          WHXUST
     I              BEZ1ST                          WHZ1ST
     I              BEVRVA                          WHVRVA
     I              BEOBST                          WHOBST
     I              BEBCST                          WHBCST
     I              BEBDST                          WHBDST
     I              BEB7VL                          WHB7VL
     I              BEGASX                          WHGASX
     I              BEGBSX                          WHGBSX
     I              BEGCSX                          WHGCSX
     I              BEGDSX                          WHGDSX
     I              BEFNSX                          WHFNSX
     I              BEFOSX                          WHFOSX
     I              BEFPSX                          WHFPSX
     I              BEFQSX                          WHFQSX
     I              BEFRSX                          WHFRSX
     I              BEFSSX                          WHFSSX
     I              BEFTSX                          WHFTSX
     I              BEFUSX                          WHFUSX
     I              BEFVSX                          WHFVSX
     I              BEFWSX                          WHFWSX
     I              BEFXSX                          WHFXSX
     I              BEFYSX                          WHFYSX
     I              BENODT                          WHNODT
     I              BENPDT                          WHNPDT
     I              BENQDT                          WHNQDT
     I              BENRDT                          WHNRDT
     I              BENSDT                          WHNSDT
     I              BEBPTM                          WHBPTM
     I              BEBQTM                          WHBQTM
     I              BEBRTM                          WHBRTM
     I              BEBSTM                          WHBSTM
     I              BEBTTM                          WHBTTM
     I              BEH0NX                          WHH0NX
     I              BEH1NX                          WHH1NX
     I              BEH2NX                          WHH2NX
     I              BEH3NX                          WHH3NX
     I              BEH4NX                          WHH4NX
     I              BEC0C7                          WHC0C7
     I              BEUVST                          WHUVST
     I              BEUWST                          WHUWST
     I              BEUXST                          WHUXST
     I              BEAATM                          WHAATM
     I              BEAYNA                          WHAYNA
     I              BEA0NA                          WHA0NA
     I              BEAXDT                          WHAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WIAIC3
     I              BEC4NB                          WIC4NB
     I              BEJNCD                          WIJNCD
     I              BEANC7                          WIANC7
     I              BEBKC7                          WIBKC7
     I              BEBRTX                          WIBRTX
     I              BEHMNA                          WIHMNA
     I              BEHONA                          WIHONA
     I              BEHPNA                          WIHPNA
     I              BEHNNA                          WIHNNA
     I              BEDBCD                          WIDBCD
     I              BECKTX                          WICKTX
     I              BEB0C7                          WIB0C7
     I              BEAETX                          WIAETX
     I              BEB1NA                          WIB1NA
     I              BEB3NA                          WIB3NA
     I              BEB4NA                          WIB4NA
     I              BEB2NA                          WIB2NA
     I              BEBHCD                          WIBHCD
     I              BEC8TX                          WIC8TX
     I              BEBCNA                          WIBCNA
     I              BEA0DT                          WIA0DT
     I              BEA5DT                          WIA5DT
     I              BEGNDT                          WIGNDT
     I              BEACDT                          WIACDT
     I              BEAQCD                          WIAQCD
     I              BEB6NA                          WIB6NA
     I              BEBYNA                          WIBYNA
     I              BEBZNA                          WIBZNA
     I              BEGTST                          WIGTST
     I              BEGVST                          WIGVST
     I              BEGUST                          WIGUST
     I              BEQFST                          WIQFST
     I              BECQCD                          WICQCD
     I              BEGJST                          WIGJST
     I              BEGWST                          WIGWST
     I              BEGXST                          WIGXST
     I              BEGYST                          WIGYST
     I              BEAODT                          WIAODT
     I              BEAIVN                          WIAIVN
     I              BECXDT                          WICXDT
     I              BEJZVA                          WIJZVA
     I              BEA1WG                          WIA1WG
     I              BEXIST                          WIXIST
     I              BEXJST                          WIXJST
     I              BEXKST                          WIXKST
     I              BEEIDT                          WIEIDT
     I              BEAFTM                          WIAFTM
     I              BEE8CD                          WIE8CD
     I              BEE9CD                          WIE9CD
     I              BERMNB                          WIRMNB
     I              BETBNB                          WITBNB
     I              BER1NB                          WIR1NB
     I              BEPJST                          WIPJST
     I              BEU0ST                          WIU0ST
     I              BEU1ST                          WIU1ST
     I              BEQ2CD                          WIQ2CD
     I              BEU2ST                          WIU2ST
     I              BEVEST                          WIVEST
     I              BEVFST                          WIVFST
     I              BEVGST                          WIVGST
     I              BERPCD                          WIRPCD
     I              BERNNB                          WIRNNB
     I              BEVDST                          WIVDST
     I              BEATIN                          WIATIN
     I              BEU4ST                          WIU4ST
     I              BEU5ST                          WIU5ST
     I              BERSRN                          WIRSRN
     I              BEMHNA                          WIMHNA
     I              BEMINA                          WIMINA
     I              BEWBST                          WIWBST
     I              BER4CD                          WIR4CD
     I              BEBFCD                          WIBFCD
     I              BEQ4CD                          WIQ4CD
     I              BET3NB                          WIT3NB
     I              BESICD                          WISICD
     I              BECONB                          WICONB
     I              BECEST                          WICEST
     I              BEAWDT                          WIAWDT
     I              BEJPCD                          WIJPCD
     I              BEXUST                          WIXUST
     I              BEZ1ST                          WIZ1ST
     I              BEVRVA                          WIVRVA
     I              BEOBST                          WIOBST
     I              BEBCST                          WIBCST
     I              BEBDST                          WIBDST
     I              BEB7VL                          WIB7VL
     I              BEGASX                          WIGASX
     I              BEGBSX                          WIGBSX
     I              BEGCSX                          WIGCSX
     I              BEGDSX                          WIGDSX
     I              BEFNSX                          WIFNSX
     I              BEFOSX                          WIFOSX
     I              BEFPSX                          WIFPSX
     I              BEFQSX                          WIFQSX
     I              BEFRSX                          WIFRSX
     I              BEFSSX                          WIFSSX
     I              BEFTSX                          WIFTSX
     I              BEFUSX                          WIFUSX
     I              BEFVSX                          WIFVSX
     I              BEFWSX                          WIFWSX
     I              BEFXSX                          WIFXSX
     I              BEFYSX                          WIFYSX
     I              BENODT                          WINODT
     I              BENPDT                          WINPDT
     I              BENQDT                          WINQDT
     I              BENRDT                          WINRDT
     I              BENSDT                          WINSDT
     I              BEBPTM                          WIBPTM
     I              BEBQTM                          WIBQTM
     I              BEBRTM                          WIBRTM
     I              BEBSTM                          WIBSTM
     I              BEBTTM                          WIBTTM
     I              BEH0NX                          WIH0NX
     I              BEH1NX                          WIH1NX
     I              BEH2NX                          WIH2NX
     I              BEH3NX                          WIH3NX
     I              BEH4NX                          WIH4NX
     I              BEC0C7                          WIC0C7
     I              BEUVST                          WIUVST
     I              BEUWST                          WIUWST
     I              BEUXST                          WIUXST
     I              BEAATM                          WIAATM
     I              BEAYNA                          WIAYNA
     I              BEA0NA                          WIA0NA
     I              BEAXDT                          WIAXDT
      *
     I@FJCPBN
      * Load Header               Retrieval index
      * Renamed input format fields
     I              FJRMNB                          WJRMNB
     I              FJAIC3                          WJAIC3
     I              FJAODT                          WJAODT
     I              FJPJST                          WJPJST
     I              FJPKST                          WJPKST
     I              FJRNNB                          WJRNNB
     I              FJDMTX                          WJDMTX
     I              FJDNTX                          WJDNTX
     I              FJDOTX                          WJDOTX
     I              FJWTTX                          WJWTTX
     I              FJWUTX                          WJWUTX
     I              FJRPNB                          WJRPNB
     I              FJFLAM                          WJFLAM
     I              FJXQST                          WJXQST
     I              FJRRNB                          WJRRNB
     I              FJDXTX                          WJDXTX
     I              FJDYTX                          WJDYTX
     I              FJSBNB                          WJSBNB
     I              FJBZNA                          WJBZNA
     I              FJRONB                          WJRONB
     I              FJSQNB                          WJSQNB
     I              FJR1NB                          WJR1NB
     I              FJVCST                          WJVCST
     I              FJVDST                          WJVDST
     I              FJSDNB                          WJSDNB
     I              FJPAOU                          WJPAOU
     I              FJDGWG                          WJDGWG
     I              FJSXNB                          WJSXNB
     I              FJHADT                          WJHADT
     I              FJAART                          WJAART
     I              FJDHWG                          WJDHWG
     I              FJDIWG                          WJDIWG
     I              FJAQDT                          WJAQDT
     I              FJS6NB                          WJS6NB
     I              FJT4NB                          WJT4NB
     I              FJPRTM                          WJPRTM
     I              FJNPSV                          WJNPSV
     I              FJJ8TX                          WJJ8TX
     I              FJTLMI                          WJTLMI
     I              FJJ9TX                          WJJ9TX
     I              FJQ2CD                          WJQ2CD
     I              FJVPCD                          WJVPCD
     I              FJDBCD                          WJDBCD
     I              FJGRWE                          WJGRWE
     I              FJXCCD                          WJXCCD
     I              FJU2ST                          WJU2ST
     I              FJF9DT                          WJF9DT
     I              FJONTM                          WJONTM
     I              FJJ4DT                          WJJ4DT
     I              FJTRTM                          WJTRTM
     I              FJJ5DT                          WJJ5DT
     I              FJSPTM                          WJSPTM
     I              FJJ6DT                          WJJ6DT
     I              FJLFTM                          WJLFTM
     I              FJJ7DT                          WJJ7DT
     I              FJBOTM                          WJBOTM
     I              FJJ8DT                          WJJ8DT
     I              FJBLTM                          WJBLTM
     I              FJKIDT                          WJKIDT
     I              FJASTM                          WJASTM
     I              FJKADT                          WJKADT
     I              FJAJCM                          WJAJCM
     I              FJXACD                          WJXACD
     I              FJOANA                          WJOANA
     I              FJK4TX                          WJK4TX
     I              FJVOAG                          WJVOAG
     I              FJKBDT                          WJKBDT
     I              FJNBBO                          WJNBBO
     I              FJW4CD                          WJW4CD
     I              FJEFDT                          WJEFDT
     I              FJCNTN                          WJCNTN
     I              FJKCDT                          WJKCDT
     I              FJTMIN                          WJTMIN
     I              FJKDDT                          WJKDDT
     I              FJVMNB                          WJVMNB
     I              FJOCFR                          WJOCFR
     I              FJKJDT                          WJKJDT
     I              FJATTM                          WJATTM
     I              FJOTRS                          WJOTRS
     I              FJRNST                          WJRNST
     I              FJBRBK                          WJBRBK
     I              FJEIDT                          WJEIDT
     I              FJRMST                          WJRMST
     I              FJAJCD                          WJAJCD
     I              FJKKDT                          WJKKDT
     I              FJAVTM                          WJAVTM
     I              FJKZDT                          WJKZDT
     I              FJAXTM                          WJAXTM
     I              FJLHOS                          WJLHOS
     I              FJLHOR                          WJLHOR
     I              FJWNTX                          WJWNTX
     I              FJOITX                          WJOITX
     I              FJOJTX                          WJOJTX
     I              FJLLDT                          WJLLDT
     I              FJLSHG                          WJLSHG
     I              FJYPST                          WJYPST
     I              FJK0DT                          WJK0DT
     I              FJAYTM                          WJAYTM
     I              FJKNNX                          WJKNNX
     I              FJICWG                          WJICWG
     I              FJIDWG                          WJIDWG
     I              FJH9SX                          WJH9SX
     I              FJWOTX                          WJWOTX
     I              FJK1DT                          WJK1DT
     I              FJAZTM                          WJAZTM
     I              FJK2DT                          WJK2DT
     I              FJA0TM                          WJA0TM
     I              FJROST                          WJROST
     I              FJRPST                          WJRPST
     I              FJRQST                          WJRQST
     I              FJRRST                          WJRRST
     I              FJZBVA                          WJZBVA
     I              FJWPTX                          WJWPTX
     I              FJWQTX                          WJWQTX
     I              FJWRTX                          WJWRTX
     I              FJWSTX                          WJWSTX
     I              FJRVSX                          WJRVSX
     I              FJRUSX                          WJRUSX
     I              FJRWSX                          WJRWSX
     I              FJRXSX                          WJRXSX
     I              FJRYSX                          WJRYSX
     I              FJRZSX                          WJRZSX
     I              FJR0SX                          WJR0SX
     I              FJR1SX                          WJR1SX
     I              FJR2SX                          WJR2SX
     I              FJR3SX                          WJR3SX
     I              FJR4SX                          WJR4SX
     I              FJPYDT                          WJPYDT
     I              FJCKTM                          WJCKTM
     I              FJPZDT                          WJPZDT
     I              FJCLTM                          WJCLTM
     I              FJP0DT                          WJP0DT
     I              FJCMTM                          WJCMTM
     I              FJP1DT                          WJP1DT
     I              FJCNTM                          WJCNTM
     I              FJP2DT                          WJP2DT
     I              FJCOTM                          WJCOTM
     I              FJP3DT                          WJP3DT
     I              FJCQTM                          WJCQTM
     I              FJUVST                          WJUVST
     I              FJUWST                          WJUWST
     I              FJUXST                          WJUXST
     I              FJAATM                          WJAATM
     I              FJAYNA                          WJAYNA
     I              FJA0NA                          WJA0NA
     I              FJAXDT                          WJAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     I@1DBRC    E DSOMFJCPL1
      * UPD : Load Header               Update index
      * Current/previous master file format fields for change control
      *
     IQPDLY1    E DSPDLYREL0
      * UPD : Trailer                   Update index
      * Renamed input format fields
     I              LYBZNA                          WBBZNA
     I              LYDXTX                          WBDXTX
     I              LYAIC3                          WBAIC3
     I              LYVDST                          WBVDST
     I              LYX3ST                          WBX3ST
     I              LYXGST                          WBXGST
     I              LYSTOY                          WBSTOY
     I              LYKKDT                          WBKKDT
     I              LYAVTM                          WBAVTM
     I              LYSTAS                          WBSTAS
     I              LYXRST                          WBXRST
     I              LYX7CD                          WBX7CD
     I              LYGXTX                          WBGXTX
     I              LYXTST                          WBXTST
     I              LYXVST                          WBXVST
     I              LYSTU3                          WBSTU3
     I              LYSTU4                          WBSTU4
     I              LYSTU5                          WBSTU5
     I              LYLCDT                          WBLCDT
     I              LYLDDT                          WBLDDT
     I              LYLEDT                          WBLEDT
     I              LYLFDT                          WBLFDT
     I              LYLGDT                          WBLGDT
     I              LYUVST                          WBUVST
     I              LYUWST                          WBUWST
     I              LYUXST                          WBUXST
     I              LYVSST                          WBVSST
     I              LYAATM                          WBAATM
     I              LYAYNA                          WBAYNA
     I              LYA0NA                          WBA0NA
     I              LYAXDT                          WBAXDT
      *
      * Outward parameters
     IPARC        DS                             82
      * RCD : Load Order Change Log     Retrieval index
      * N :  Sequence Number
     I                                    P   9  100PADXNB
      * I :  Load ID
     I                                    P  11  140PARMNB
      * I :  Stop/Drop
     I                                    P  15  170PARVNB
      * I :  Load Change Type
     I                                       18  23 PARVST
      * I :  Department Control Code
     I                                       24  26 PAUJST
      * I :  Change Log Prior Value
     I                                       27  38 PAMNTX
      * I :  Change Log New Value
     I                                       39  50 PAMOTX
      * I :  User Id
     I                                       51  60 PAAYNA
      * I :  Job Name
     I                                       61  70 PAA0NA
      * I :  Carrier Code
     I                                       71  73 PABZNA
      * N :  Carrier Broker Carrier Co
     I                                       74  76 PAXMCD
      * I :  Company Number
     I                                    P  77  780PAAIC3
      * I :  Order Number
     I                                    P  79  820PAC4NB
      *
     IYARDCS      DS                            793
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPMAM1    E DSPMAMREL0
      * UPD : Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                          WDAIC3
     I              AMC4NB                          WDC4NB
     I              AMRMNB                          WDRMNB
     I              AMRUNB                          WDRUNB
     I              AMXACD                          WDXACD
     I              AMOANA                          WDOANA
     I              AMHBAA                          WDHBAA
     I              AMJ0T1                          WDJ0T1
     I              AMGENY                          WDGENY
     I              AMJ1T1                          WDJ1T1
     I              AMHCAA                          WDHCAA
     I              AMQWDT                          WDQWDT
     I              AMQXDT                          WDQXDT
     I              AMQYDT                          WDQYDT
     I              AMHDAA                          WDHDAA
     I              AMCCTX                          WDCCTX
     I              AMJ2T1                          WDJ2T1
     I              AMRLNA                          WDRLNA
     I              AMRMNA                          WDRMNA
     I              AMGINY                          WDGINY
     I              AMGFNY                          WDGFNY
     I              AMGGNY                          WDGGNY
     I              AMGHNY                          WDGHNY
     I              AMHEVL                          WDHEVL
     I              AMHFVL                          WDHFVL
     I              AMHGVL                          WDHGVL
     I              AMQZDT                          WDQZDT
     I              AMQ0DT                          WDQ0DT
     I              AMQ1DT                          WDQ1DT
     I              AMQ2DT                          WDQ2DT
     I              AMC2TX                          WDC2TX
     I              AMC3TX                          WDC3TX
     I              AMC6TX                          WDC6TX
     I              AMCHTX                          WDCHTX
     I              AMCITX                          WDCITX
     I              AMCLTX                          WDCLTX
     I              AMB4TX                          WDB4TX
     I              AMCUTX                          WDCUTX
     I              AMCVTX                          WDCVTX
     I              AMB9TX                          WDB9TX
     I              AMJWSC                          WDJWSC
     I              AMITNY                          WDITNY
     I              AMLMT1                          WDLMT1
     I              AMLWAA                          WDLWAA
     I              AMFVST                          WDFVST
     I              AMF0ST                          WDF0ST
     I              AMF2ST                          WDF2ST
     I              AMF3ST                          WDF3ST
     I              AMJUSC                          WDJUSC
     I              AMJVSC                          WDJVSC
     I              AMV3T1                          WDV3T1
     I              AMV4T1                          WDV4T1
     I              AMV5T1                          WDV5T1
     I              AMV6T1                          WDV6T1
     I              AMV7T1                          WDV7T1
     I              AMV8T1                          WDV8T1
     I              AMV9T1                          WDV9T1
     I              AMWAT1                          WDWAT1
     I              AMWBT1                          WDWBT1
     I              AMWCT1                          WDWCT1
     I              AMWDT1                          WDWDT1
     I              AMQJNY                          WDQJNY
     I              AMQKNY                          WDQKNY
     I              AMQLNY                          WDQLNY
     I              AMP8NY                          WDP8NY
     I              AMP9NY                          WDP9NY
     I              AMQANY                          WDQANY
     I              AMQCNY                          WDQCNY
     I              AMQDNY                          WDQDNY
     I              AMQENY                          WDQENY
     I              AMQFNY                          WDQFNY
     I              AMQGNY                          WDQGNY
     I              AMQHNY                          WDQHNY
     I              AMQINY                          WDQINY
     I              AMQMNY                          WDQMNY
     I              AMMYU1                          WDMYU1
     I              AMJXSC                          WDJXSC
     I              AMJYSC                          WDJYSC
     I              AMJZSC                          WDJZSC
     I              AMJ0SC                          WDJ0SC
     I              AMMZU1                          WDMZU1
     I              AMM0U1                          WDM0U1
     I              AMM1U1                          WDM1U1
     I              AMM2U1                          WDM2U1
     I              AMM3U1                          WDM3U1
     I              AMW5DT                          WDW5DT
     I              AMW6DT                          WDW6DT
     I              AMUVST                          WDUVST
     I              AMUWST                          WDUWST
     I              AMUXST                          WDUXST
     I              AMVSST                          WDVSST
     I              AMAATM                          WDAATM
     I              AMAYNA                          WDAYNA
     I              AMA0NA                          WDA0NA
     I              AMAXDT                          WDAXDT
      *
     IYBRDCS      DS                            894
      * Outward parameters
     IPBRC        DS                             11
      * KEY : Load Detail               Load/Stop/Order
      * I :  Load ID
     I                                    P   1   40PBRMNB
      *
     IYCRDCS      DS                            793
     IQOMFL1    E DSOMFLCPL0
      * UPD : Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WERMNB
     I              FLRUNB                          WERUNB
     I              FLRVNB                          WERVNB
     I              FLDQTX                          WEDQTX
     I              FLRWNB                          WERWNB
     I              FLRXNB                          WERXNB
     I              FLSQNB                          WESQNB
     I              FLT0NB                          WET0NB
     I              FLT1NB                          WET1NB
     I              FLR1NB                          WER1NB
     I              FLAIC3                          WEAIC3
     I              FLC4NB                          WEC4NB
     I              FLVCST                          WEVCST
     I              FLKEDT                          WEKEDT
     I              FLSXNB                          WESXNB
     I              FLKFDT                          WEKFDT
     I              FLACTM                          WEACTM
     I              FLK5TX                          WEK5TX
     I              FLW5CD                          WEW5CD
     I              FLEJDT                          WEEJDT
     I              FLAGTM                          WEAGTM
     I              FLKJDT                          WEKJDT
     I              FLATTM                          WEATTM
     I              FLHDDT                          WEHDDT
     I              FLAUTM                          WEAUTM
     I              FLKKDT                          WEKKDT
     I              FLAVTM                          WEAVTM
     I              FLZ4NB                          WEZ4NB
     I              FLY7ST                          WEY7ST
     I              FLY2ST                          WEY2ST
     I              FLWHTX                          WEWHTX
     I              FLWITX                          WEWITX
     I              FLWJTX                          WEWJTX
     I              FLWKTX                          WEWKTX
     I              FLWLTX                          WEWLTX
     I              FLN7DT                          WEN7DT
     I              FLN8DT                          WEN8DT
     I              FLN9DT                          WEN9DT
     I              FLB3TM                          WEB3TM
     I              FLB4TM                          WEB4TM
     I              FLB5TM                          WEB5TM
     I              FLIASX                          WEIASX
     I              FLIBSX                          WEIBSX
     I              FLICSX                          WEICSX
     I              FLWVTX                          WEWVTX
     I              FLWWTX                          WEWWTX
     I              FLWXTX                          WEWXTX
     I              FLUVST                          WEUVST
     I              FLUWST                          WEUWST
     I              FLUXST                          WEUXST
     I              FLAATM                          WEAATM
     I              FLAYNA                          WEAYNA
     I              FLA0NA                          WEA0NA
     I              FLAXDT                          WEAXDT
      *
     IYDRDCS      DS                            367
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WGAIC3
     I              OMC4NB                          WGC4NB
     I              OMDPNB                          WGDPNB
     I              OMUENB                          WGUENB
     I              OMHGCD                          WGHGCD
     I              OMAJCD                          WGAJCD
     I              OMBKC7                          WGBKC7
     I              OMCFC7                          WGCFC7
     I              OMGMST                          WGGMST
     I              OMGNST                          WGGNST
     I              OMMAVA                          WGMAVA
     I              OMKDVA                          WGKDVA
     I              OML8VA                          WGL8VA
     I              OML9VA                          WGL9VA
     I              OMGTST                          WGGTST
     I              OMGVST                          WGGVST
     I              OMGUST                          WGGUST
     I              OMQFST                          WGQFST
     I              OMAYVA                          WGAYVA
     I              OMEXDT                          WGEXDT
     I              OMLQCD                          WGLQCD
     I              OMRDCD                          WGRDCD
     I              OMQ7CD                          WGQ7CD
     I              OMBZPR                          WGBZPR
     I              OML6NB                          WGL6NB
     I              OMU1ST                          WGU1ST
     I              OMGIDT                          WGGIDT
     I              OMCRCD                          WGCRCD
     I              OMAGCD                          WGAGCD
     I              OMRZST                          WGRZST
     I              OMR0ST                          WGR0ST
     I              OMR1ST                          WGR1ST
     I              OMG7NA                          WGG7NA
     I              OMG8NA                          WGG8NA
     I              OMRPCD                          WGRPCD
     I              OMVEST                          WGVEST
     I              OMVGST                          WGVGST
     I              OMAVST                          WGAVST
     I              OMU0ST                          WGU0ST
     I              OMRFCD                          WGRFCD
     I              OMFZST                          WGFZST
     I              OMR1NB                          WGR1NB
     I              OMAVQT                          WGAVQT
     I              OMD0WG                          WGD0WG
     I              OMCCQT                          WGCCQT
     I              OMAUWG                          WGAUWG
     I              OMCBQT                          WGCBQT
     I              OMATWG                          WGATWG
     I              OMAQCS                          WGAQCS
     I              OMAGCS                          WGAGCS
     I              OMAKPR                          WGAKPR
     I              OMALPR                          WGALPR
     I              OMAUPR                          WGAUPR
     I              OMAVWG                          WGAVWG
     I              OMA4WG                          WGA4WG
     I              OMA5DT                          WGA5DT
     I              OMAODT                          WGAODT
     I              OMGNDT                          WGGNDT
     I              OMAMST                          WGAMST
     I              OMANST                          WGANST
     I              OMVAST                          WGVAST
     I              OMRGNB                          WGRGNB
     I              OMRHNB                          WGRHNB
     I              OMRINB                          WGRINB
     I              OMRBCD                          WGRBCD
     I              OMHICD                          WGHICD
     I              OMRNCD                          WGRNCD
     I              OMROCD                          WGROCD
     I              OMCXDT                          WGCXDT
     I              OMAJVN                          WGAJVN
     I              OMKXCD                          WGKXCD
     I              OMJPCD                          WGJPCD
     I              OMCQCD                          WGCQCD
     I              OMR4CD                          WGR4CD
     I              OMZ1ST                          WGZ1ST
     I              OMZ3ST                          WGZ3ST
     I              OMZ4ST                          WGZ4ST
     I              OMDUPR                          WGDUPR
     I              OMB6VL                          WGB6VL
     I              OMA1AA                          WGA1AA
     I              OMFZSX                          WGFZSX
     I              OMF0SX                          WGF0SX
     I              OMF1SX                          WGF1SX
     I              OMF2SX                          WGF2SX
     I              OMF3SX                          WGF3SX
     I              OMF4SX                          WGF4SX
     I              OMF5SX                          WGF5SX
     I              OMF6SX                          WGF6SX
     I              OMF7SX                          WGF7SX
     I              OMNTDT                          WGNTDT
     I              OMNUDT                          WGNUDT
     I              OMNVDT                          WGNVDT
     I              OMNWDT                          WGNWDT
     I              OMNXDT                          WGNXDT
     I              OMBUTM                          WGBUTM
     I              OMBVTM                          WGBVTM
     I              OMBWTM                          WGBWTM
     I              OMBXTM                          WGBXTM
     I              OMBYTM                          WGBYTM
     I              OMH5NX                          WGH5NX
     I              OMH6NX                          WGH6NX
     I              OMH7NX                          WGH7NX
     I              OMH8NX                          WGH8NX
     I              OMH9NX                          WGH9NX
     I              OMDVPR                          WGDVPR
     I              OMDWPR                          WGDWPR
     I              OMDXPR                          WGDXPR
     I              OMDYPR                          WGDYPR
     I              OMDZPR                          WGDZPR
     I              OMGSPR                          WGGSPR
     I              OMGTPR                          WGGTPR
     I              OMGUPR                          WGGUPR
     I              OMHOST                          WGHOST
     I              OMHPST                          WGHPST
     I              OMIOST                          WGIOST
     I              OMPEWG                          WGPEWG
     I              OMRINY                          WGRINY
     I              OMTIDT                          WGTIDT
     I              OMTJDT                          WGTJDT
     I              OMH2ST                          WGH2ST
     I              OMH0ST                          WGH0ST
     I              OMH1ST                          WGH1ST
     I              OMTKDT                          WGTKDT
     I              OMTLDT                          WGTLDT
     I              OMTMDT                          WGTMDT
     I              OMUVST                          WGUVST
     I              OMUWST                          WGUWST
     I              OMUXST                          WGUXST
     I              OMAATM                          WGAATM
     I              OMAYNA                          WGAYNA
     I              OMA0NA                          WGA0NA
     I              OMAXDT                          WGAXDT
      *
     IYERDCS      DS                            525
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WIAIC3
     I              BEC4NB                          WIC4NB
     I              BEJNCD                          WIJNCD
     I              BEANC7                          WIANC7
     I              BEBKC7                          WIBKC7
     I              BEBRTX                          WIBRTX
     I              BEHMNA                          WIHMNA
     I              BEHONA                          WIHONA
     I              BEHPNA                          WIHPNA
     I              BEHNNA                          WIHNNA
     I              BEDBCD                          WIDBCD
     I              BECKTX                          WICKTX
     I              BEB0C7                          WIB0C7
     I              BEAETX                          WIAETX
     I              BEB1NA                          WIB1NA
     I              BEB3NA                          WIB3NA
     I              BEB4NA                          WIB4NA
     I              BEB2NA                          WIB2NA
     I              BEBHCD                          WIBHCD
     I              BEC8TX                          WIC8TX
     I              BEBCNA                          WIBCNA
     I              BEA0DT                          WIA0DT
     I              BEA5DT                          WIA5DT
     I              BEGNDT                          WIGNDT
     I              BEACDT                          WIACDT
     I              BEAQCD                          WIAQCD
     I              BEB6NA                          WIB6NA
     I              BEBYNA                          WIBYNA
     I              BEBZNA                          WIBZNA
     I              BEGTST                          WIGTST
     I              BEGVST                          WIGVST
     I              BEGUST                          WIGUST
     I              BEQFST                          WIQFST
     I              BECQCD                          WICQCD
     I              BEGJST                          WIGJST
     I              BEGWST                          WIGWST
     I              BEGXST                          WIGXST
     I              BEGYST                          WIGYST
     I              BEAODT                          WIAODT
     I              BEAIVN                          WIAIVN
     I              BECXDT                          WICXDT
     I              BEJZVA                          WIJZVA
     I              BEA1WG                          WIA1WG
     I              BEXIST                          WIXIST
     I              BEXJST                          WIXJST
     I              BEXKST                          WIXKST
     I              BEEIDT                          WIEIDT
     I              BEAFTM                          WIAFTM
     I              BEE8CD                          WIE8CD
     I              BEE9CD                          WIE9CD
     I              BERMNB                          WIRMNB
     I              BETBNB                          WITBNB
     I              BER1NB                          WIR1NB
     I              BEPJST                          WIPJST
     I              BEU0ST                          WIU0ST
     I              BEU1ST                          WIU1ST
     I              BEQ2CD                          WIQ2CD
     I              BEU2ST                          WIU2ST
     I              BEVEST                          WIVEST
     I              BEVFST                          WIVFST
     I              BEVGST                          WIVGST
     I              BERPCD                          WIRPCD
     I              BERNNB                          WIRNNB
     I              BEVDST                          WIVDST
     I              BEATIN                          WIATIN
     I              BEU4ST                          WIU4ST
     I              BEU5ST                          WIU5ST
     I              BERSRN                          WIRSRN
     I              BEMHNA                          WIMHNA
     I              BEMINA                          WIMINA
     I              BEWBST                          WIWBST
     I              BER4CD                          WIR4CD
     I              BEBFCD                          WIBFCD
     I              BEQ4CD                          WIQ4CD
     I              BET3NB                          WIT3NB
     I              BESICD                          WISICD
     I              BECONB                          WICONB
     I              BECEST                          WICEST
     I              BEAWDT                          WIAWDT
     I              BEJPCD                          WIJPCD
     I              BEXUST                          WIXUST
     I              BEZ1ST                          WIZ1ST
     I              BEVRVA                          WIVRVA
     I              BEOBST                          WIOBST
     I              BEBCST                          WIBCST
     I              BEBDST                          WIBDST
     I              BEB7VL                          WIB7VL
     I              BEGASX                          WIGASX
     I              BEGBSX                          WIGBSX
     I              BEGCSX                          WIGCSX
     I              BEGDSX                          WIGDSX
     I              BEFNSX                          WIFNSX
     I              BEFOSX                          WIFOSX
     I              BEFPSX                          WIFPSX
     I              BEFQSX                          WIFQSX
     I              BEFRSX                          WIFRSX
     I              BEFSSX                          WIFSSX
     I              BEFTSX                          WIFTSX
     I              BEFUSX                          WIFUSX
     I              BEFVSX                          WIFVSX
     I              BEFWSX                          WIFWSX
     I              BEFXSX                          WIFXSX
     I              BEFYSX                          WIFYSX
     I              BENODT                          WINODT
     I              BENPDT                          WINPDT
     I              BENQDT                          WINQDT
     I              BENRDT                          WINRDT
     I              BENSDT                          WINSDT
     I              BEBPTM                          WIBPTM
     I              BEBQTM                          WIBQTM
     I              BEBRTM                          WIBRTM
     I              BEBSTM                          WIBSTM
     I              BEBTTM                          WIBTTM
     I              BEH0NX                          WIH0NX
     I              BEH1NX                          WIH1NX
     I              BEH2NX                          WIH2NX
     I              BEH3NX                          WIH3NX
     I              BEH4NX                          WIH4NX
     I              BEC0C7                          WIC0C7
     I              BEUVST                          WIUVST
     I              BEUWST                          WIUWST
     I              BEUXST                          WIUXST
     I              BEAATM                          WIAATM
     I              BEAYNA                          WIAYNA
     I              BEA0NA                          WIA0NA
     I              BEAXDT                          WIAXDT
      *
     IYFRDCS      DS                            779
      * Outward parameters
     IPCRC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PCAIC3
      * I :  Order Number
     I                                    P   3   60PCC4NB
      * I :  Order Type - Sales
     I                                        7   8 PCJNCD
      * I :  A/R Customer Number
     I                                    P   9  120PCANC7
      * I :  Ship To Customer
     I                                    P  13  160PCBKC7
      * I :  Ship To Name
     I                                       17  46 PCBRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PCHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PCHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PCHPNA
      * I :  Ship To City
     I                                      137 156 PCHNNA
      * I :  Ship To State Code
     I                                      157 158 PCDBCD
      * I :  Ship To Zip/Postal Code
     I                                      159 169 PCCKTX
      * I :  Bill to Customer
     I                                    P 170 1730PCB0C7
      * I :  Bill to Name
     I                                      174 203 PCAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PCB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PCB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PCB4NA
      * I :  Bill to City
     I                                      294 313 PCB2NA
      * I :  Bill to State Code
     I                                      314 315 PCBHCD
      * I :  Bill to Zip/Postal Code
     I                                      316 326 PCC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PCBCNA
      * I :  Order Date
     I                                    P 342 3450PCA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PCA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PCGNDT
      * I :  Cancel Date
     I                                    P 354 3570PCACDT
      * I :  Terms Code
     I                                      358 359 PCAQCD
      * I :  Special Instructions
     I                                      360 399 PCB6NA
      * I :  Special Instructions 2
     I                                      400 439 PCBYNA
      * I :  Carrier Code
     I                                      440 442 PCBZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PCGTST
      * I :  Comment Print Inv/Cr.Memo
     I                                      444 444 PCGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PCGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PCQFST
      * I :  Reason Code
     I                                      447 449 PCCQCD
      * I :  Order in Use
     I                                      450 450 PCGJST
      * I :  Header Status
     I                                      451 451 PCGWST
      * I :  Header Status Last
     I                                      452 452 PCGXST
      * I :  Order Type Print Status
     I                                      453 453 PCGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PCAODT
      * I :  User Original Entry
     I                                      458 467 PCAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PCCXDT
      * I :  Order Value Total
     I                                    P 472 4772PCJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PCA1WG
      * I :  Credit Hold
     I                                      484 484 PCXIST
      * I :  Production Hold
     I                                      485 485 PCXJST
      * I :  New Customer Hold
     I                                      486 486 PCXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PCEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PCAFTM
      * I :  Accounts Receiv. Ent 1
     I                                      494 497 PCE8CD
      * I :  Accounts Receiv. Ent 2
     I                                      498 509 PCE9CD
      * I :  Load ID
     I                                    P 510 5130PCRMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PCTBNB
      * I :  Rated Freight
     I                                    P 517 5222PCR1NB
      * I :  LTL Flag
     I                                      523 523 PCPJST
      * I :  Price Audit
     I                                      524 524 PCU0ST
      * I :  Price Status
     I                                      525 525 PCU1ST
      * I :  Shipping Method
     I                                      526 527 PCQ2CD
      * I :  Export Status
     I                                      528 528 PCU2ST
      * I :  Palletize
     I                                      529 529 PCVEST
      * I :  Shrink Wrap
     I                                      530 530 PCVFST
      * I :  Slip Sheet
     I                                      531 531 PCVGST
      * I :  Age Code
     I                                      532 532 PCRPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PCRNNB
      * I :  Load Type
     I                                      536 536 PCVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PCATIN
      * I :  Load Plan Order
     I                                      541 541 PCU4ST
      * I :  Print Pick Slip
     I                                      542 542 PCU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PCRSRN
      * I :  Special Comment 1
     I                                      547 576 PCMHNA
      * I :  Special Comment 2
     I                                      577 606 PCMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PCWBST
      * I :  Sales Route Code
     I                                      608 610 PCR4CD
      * I :  Manager Level Code
     I                                      611 612 PCBFCD
      * I :  VP Level Code
     I                                      613 615 PCQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PCT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PCSICD
      * I :  Invoice Number
     I                                    P 623 6260PCCONB
      * I :  Invoice Suffix
     I                                      627 628 PCCEST
      * I :  Invoice Date
     I                                    P 629 6320PCAWDT
      * I :  Event Code
     I                                      633 634 PCJPCD
      * I :  Trans Contol AS400/Plant
     I                                      635 635 PCXUST
      * I :  Modified Flag
     I                                      636 636 PCZ1ST
      * I :  A/R order Value Total
     I                                    P 637 6422PCVRVA
      * I :  Billing Activity Type
     I                                      643 643 PCOBST
      * I :  Block Order Flag
     I                                      644 644 PCBCST
      * I :  Order Certification Flag
     I                                      645 645 PCBDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PCB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PCGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PCGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PCGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PCGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PCFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PCFOSX
      * I :  Order Emailed
     I                                      658 658 PCFPSX
      * I :  Export Docs Go w/Driver
     I                                      659 659 PCFQSX
      * I :  Shipping Temp Code C/F
     I                                      660 660 PCFRSX
      * I :  Broker Order Status
     I                                      661 661 PCFSSX
      * I :  Air Freight Order
     I                                      662 662 PCFTSX
      * I :  Order Requires Review
     I                                      663 664 PCFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PCFVSX
      * I :  Export USDA Approved
     I                                      667 668 PCFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PCFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PCFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PCNODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PCNPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PCNQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PCNRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PCNSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PCBPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PCBQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PCBRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PCBSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PCBTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PCH0NX
      * I :  Act Non-Ref Frt Amount
     I                                    P 721 7262PCH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PCH2NX
      * I :  OH Total Non-Ref Frt Amt
     I                                    P 733 7382PCH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PCH4NX
      * I :  Claim Number
     I                                    P 745 7480PCC0C7
      * I :  EDI Status 1
     I                                      749 749 PCUVST
      * I :  EDI Status 2
     I                                      750 750 PCUWST
      * I :  EDI Status 3
     I                                      751 751 PCUXST
      * I :  Job Time
     I                                    P 752 7550PCAATM
      * I :  User Id
     I                                      756 765 PCAYNA
      * I :  Job Name
     I                                      766 775 PCA0NA
      * I :  Job Date
     I                                    P 776 7790PCAXDT
      *
     IYGRDCS      DS                            129
     IYHRDCS      DS                            793
     IYIRDCS      DS                            793
     IYJRDCS      DS                            367
     IYKRDCS      DS                            525
     IYLRDCS      DS                            779
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * N :  Warehouse Code
     I                                        1   3 P1AJCD
      * N :  Application Code
     I                                        4   9 P1DNCD
      * N :  Salesperson Code
     I                                       10  12 P1BCCD
      * N :  Allow Multi-Company
     I                                       13  13 P1I6ST
      * N :  Allow Multi Warehouse
     I                                       14  14 P1I8ST
      * N :  Default Printer
     I                                       15  24 P1MPNA
     IP2PARM      DS
      * FLD: Order Header Extension
      * I :  Company Number
     I                                    P   1   20P2AIC3
      * I :  Order Number
     I                                    P   3   60P2C4NB
      * I :  Load ID
     I                                    P   7  100P2RMNB
      * I :  Shipping Line
     I                                       11  13 P2XACD
      * I :  Port Delv Terminal
     I                                       14  33 P2OANA
      * I :  OHE City
     I                                       34  58 P2HBAA
      * I :  OHE Vessel/Airline
     I                                       59  88 P2J0T1
      * I :  OHE Voyage/Flight
     I                                       89 103 P2GENY
      * I :  OHE Booking Number
     I                                      104 118 P2J1T1
      * I :  OHE Discharge Port/Airprt
     I                                      119 138 P2HCAA
      * I :  OHE Sail/Flight Date
     I                                    P 139 1420P2QWDT
      * I :  OHE Arrival Date
     I                                    P 143 1460P2QYDT
      * I :  OHE Ship Status
     I                                      147 147 P2CCTX
      * I :  OHE Load Haul Type
     I                                      148 150 P2B4TX
     IP3PARM      DS
      * FLD: Load Header
      * I : MAP Scheduled Ship Date
     I                                    P   1   40P3AODT
      * I :  Carrier Code
     I                                        5   7 P3BZNA
     IP4PARM      DS
      * I :  Scheduled Ship Date USR
     I                                    P   1   40P4HODT
     IP5PARM      DS
      * I :  Include Sts
     I                                        1   1 P5SNSX
     IP6PARM      DS
      * I :  Warehouse Type
     I                                        1   2 P6WPST
     IP7PARM      DS
      * I :  Type Code
     I                                        1   2 P7BOCD
     IP8PARM      DS
      * B :  Record Activity Sts USR
     I                                        1   1 P8BTST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Carrier doesn't exists'
      * Carrier Code
     I                                        1   3 ZA0001
      * Message data for 'Carrier req to enter trlr'
      * Carrier Code
     I                                        1   3 ZA0002
      * Message data for 'Trailer is already assgnd'
      * Trailer ID USR
     I                                        1  12 ZA0003
      * USR Load Assigned
     I                                    P  13  160ZA0004
      * Message data for 'Load type must match load'
      * Load Type
     I                                        1   1 ZA0005
      * USR Load Type
     I                                        2   2 ZA0006
      * Trailer ID USR
     I                                        3  14 ZA0007
      * Message data for 'Trailer is not Available.'
      * Trailer ID USR
     I                                        1  12 ZA0008
      * Message data for 'Trailer is Sbd owned.'
      * Trailer ID USR
     I                                        1  12 ZA0009
      * Message data for 'Trailer is not On Yard.'
      * Trailer ID USR
     I                                        1  12 ZA0010
      * Message data for 'Trailer Co#<>Ld Str Co#'
      * Trailer ID USR
     I                                        1  12 ZA0011
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0012
      * Application Code
     I                                       11  16 ZA0013
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0014
      * Application Code
     I                                       11  16 ZA0015
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P2AIC3    PARM           WP0001  30       Company Number
     C           P2C4NB    PARM           WP0002  70       Order Number
     C           P2RMNB    PARM           WP0003  70       Load ID
     C           P2XACD    PARM           WP0004  3        Shipping Line
     C           P2OANA    PARM           WP0005 20        Port Delv Termi
     C           P2HBAA    PARM           WP0006 25        OHE City
     C           P2J0T1    PARM           WP0007 30        OHE Vessel/Airl
     C           P2GENY    PARM           WP0008 15        OHE Voyage/Flig
     C           P2J1T1    PARM           WP0009 15        OHE Booking Num
     C           P2HCAA    PARM           WP0010 20        OHE Discharge P
     C           P2QWDT    PARM           WP0011  70       OHE Sail/Flight
     C           P2QYDT    PARM           WP0012  70       OHE Arrival Dat
     C           P2CCTX    PARM           WP0013  1        OHE Ship Status
     C           P2B4TX    PARM           WP0014  3        OHE Load Haul T
     C           P3AODT    PARM           WP0015  70       Scheduled Ship
     C           P3BZNA    PARM           WP0016  3        Carrier Code
     C           P4HODT    PARM           WP0017  70       Scheduled Ship
     C           P5SNSX    PARM           WP0018  1        Include Sts
     C           P6WPST    PARM           WP0019  2        Warehouse Type
     C           P7BOCD    PARM           WP0020  2        Type Code
     C           P8BTST    PARM P8BTST    WP0021  1        Record Activity
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise and load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END
     C                     END
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise & load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
     C           YPMTFD    IFEQ *BLANKS
      * USER: Initialize subfile header
      * Update CTL fields from PAR
     C                     EXSR UASUBR                     Update CTL fiel
      * * Retrieve warehouse code from order detail
      * Rtv Warehouse wo/Quit RT - Order Detail  * 
     C                     EXSR SARVGN
      * RTV Warehouse Type     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP1AJCD    WL0001    P      Warehouse Code
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #CWPST    P      Warehouse Type
      * Retrieve Warehouse type description
      * CASE: CTL.Warehouse Type is Frozen
     C           #CWPST    IFEQ 'FZ'                       *IF
     C                     MOVEL@CN,004   #CI6TX           Description 14A
     C                     ELSE
      * CASE: CTL.Warehouse Type is Fresh
     C           #CWPST    IFEQ 'FR'                       *IF
     C                     MOVEL@CN,005   #CI6TX           Description 14A
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #CI6TX           Description 14A
     C                     END                             *FI
     C                     END                             *FI
      * * Retrieve Shipping Line name
      * RTV Carrier Name       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#2BZNA    WL0003    P      Carrier Code
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    #CEET1    P      Name
     C                     MOVELWL0005    YN0001    P      Record Status
     C                     END
      *................................................................
      * Position file
     C           KPOS      KLIST
     C                     KFLD           FJAODT           Scheduled Ship
     C                     KFLD           FJBZNA           Carrier Code
      * Setup key
     C                     Z-ADD#2AODT    FJAODT
     C                     MOVEL#2BZNA    FJBZNA
      * 82=EOF
     C           KPOS      SETLL@FJCPL9              82    *
      * 82=EOF
     C  N82                READ @FJCPL9                9182*
      * Load subfile page
     C                     EXSR BBLDSF
      *................................................................
      * If no records found, display error message
     C   82      ##RR      IFEQ *ZERO                      IF
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
      *
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
     C                     SETOF                     84    No SFLNXTCHG
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@FJCPL9                  90*
     C  N82                READ @FJCPL9                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVE *ALL'0'   WKIND0  4
     C                     MOVE *ALL'1'   WKIND1  4
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
     C                     Z-ADD*ZERO     ##RROK  50
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next subfile page
     C  N82      ##RROK    DOWLT##SFLN                     DO
     C                     ADD  1         ##RR
     C                     MOVEAWKIND0    *IN,31
     C                     SETOF                     87    *
      * Clear subfile fields
     C                     EXSR MAIZ#1
      * Load SFL fields
     C                     EXSR MBFL#1
      * Record will be selected unless overridden
     C                     MOVEL'Y'       W0RSL   1
      * USER: Initialize subfile record (existing record)
     C                     Z-ADD1         YL0001           Order Number
      * Select by date range
      * CASE:
      *  - (c1 OR c2)
      *   |- c1    : DB1.Scheduled Ship Date LT PAR.Scheduled Ship Date
      *   |- c2    : DB1.Scheduled Ship Date GT PAR.Scheduled Ship Date U
      *   '-
     C           FJAODT    IFLT P3AODT                     *IF
     C           FJAODT    ORGT P4HODT                     *OR
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Select Exports only
      * CASE: DB1.Export Status is Not Yes
     C           FJU2ST    IFEQ *BLANK                     *IF
     C           FJU2ST    OREQ 'N'
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Select Warehouse Type only
      * CASE: PAR.Warehouse Type NE WRK.Blank for 3          USR
     C           P6WPST    IFNE WUUAT1                     *IF
      * RTV Warehouse Type     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELFJVPCD    WL0001    P      Warehouse Code
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YL0002    P      Warehouse Type
      * CASE: LCL.Warehouse Type NE PAR.Warehouse Type
     C           YL0002    IFNE P6WPST                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Select Type Code only
      * CASE: PAR.Type Code is Entered
     C           P7BOCD    IFNE *BLANK                     *IF
     C                     Z-ADD*ZERO     WUBKC7           Ship To Custome
      * RTV Type Cd by Ord     RT - Order Header TRG  * 
     C                     EXSR SDRVGN
      * CASE: LCL.Record Selected       USR is Not Yes
     C           YL0003    IFEQ *BLANK                     *IF
     C           YL0003    OREQ 'N'
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Select Company matches ctl.company
      * CASE: DB1.Company Number NE CTL.Company
     C           FJAIC3    IFNE #CBNC3                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Select Booked or Unbooked, unless "All" is requested
      * CASE: PAR.Include Sts is Not All Booking
     C           P5SNSX    IFEQ 'B'                        *IF
     C           P5SNSX    OREQ 'U'
      * VAL Bkg#/Cntnr by Load RT - Order Header Extension  * 
     C                     EXSR SGRVGN
      * Booked Only
      * CASE: PAR.Include Sts is Booked Only
     C           P5SNSX    IFEQ 'B'                        *IF
      * CASE: LCL.Record Found USR is Record Not Found
     C           YL0005    IFEQ 'N'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Unbooked Only
      * CASE: PAR.Include Sts is Unbooked Only
     C           P5SNSX    IFEQ 'U'                        *IF
      * CASE: LCL.Record Found USR is Record Found
     C           YL0005    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Skip Shipped or Invoiced loads
      * CASE: DB1.Load Status is Shipped or Invoiced
     C           FJPKST    IFEQ 'I'                        *IF
     C           FJPKST    OREQ 'S'
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Skip Buyers Truck
      * CASE: RCD.Carrier Code is Buyer's Truck
     C           #1BZNA    IFEQ 'BUY'                      *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Update subfile record
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * RTV Warehouse Type     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELFJVPCD    WL0001    P      Warehouse Code
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #RWPST    P      Warehouse Type
      * RCD = DB1 By name
     C                     Z-ADDFJAODT    #1AODT           Scheduled Ship
     C                     Z-ADDFJRMNB    #1RMNB           Load ID
     C                     MOVELFJBZNA    #1BZNA           Carrier Code
     C                     Z-ADDFJAIC3    #1AIC3           Company Number
     C                     MOVELFJPJST    #1PJST           LTL Flag
     C                     MOVELFJPKST    #1PKST           Load Status
     C                     Z-ADDFJRNNB    #1RNNB           Reefer Temperat
     C                     MOVELFJDMTX    #1DMTX           Seal 1
     C                     MOVELFJDNTX    #1DNTX           Seal 2
     C                     MOVELFJDOTX    #1DOTX           Seal 3
     C                     MOVELFJWTTX    #1WTTX           Seal 4
     C                     MOVELFJWUTX    #1WUTX           Seal 2 Unused
     C                     Z-ADDFJRPNB    #1RPNB           Total Load Orde
     C                     Z-ADDFJFLAM    #1FLAM           Flat Amount
     C                     MOVELFJXQST    #1XQST           Allocate Pounds
     C                     Z-ADDFJRRNB    #1RRNB           Total Stops
     C                     MOVELFJDXTX    #1DXTX           Trailer Id
     C                     MOVELFJDYTX    #1DYTX           Transloader Car
     C                     Z-ADDFJSBNB    #1SBNB           BOL Time
     C                     MOVELFJRONB    #1RONB           Truck Size
     C                     Z-ADDFJSQNB    #1SQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADDFJR1NB    #1R1NB           Rated Freight
     C                     MOVELFJVCST    #1VCST           Ship Status
     C                     MOVELFJVDST    #1VDST           Load Type
     C                     Z-ADDFJSDNB    #1SDNB           Number Pallets
     C                     Z-ADDFJPAOU    #1PAOU           Number Pallets
     C                     Z-ADDFJDGWG    #1DGWG           Load Carrier Pa
     C                     Z-ADDFJSXNB    #1SXNB           Estimated Arriv
     C                     Z-ADDFJHADT    #1HADT           Actual Arrival
     C                     Z-ADDFJAART    #1AART           Actual Arrival
     C                     Z-ADDFJDHWG    #1DHWG           Trailer IN Weig
     C                     Z-ADDFJDIWG    #1DIWG           Trailer OUT Wei
     C                     Z-ADDFJAQDT    #1AQDT           Actual Departur
     C                     Z-ADDFJS6NB    #1S6NB           Departure Time
     C                     Z-ADDFJT4NB    #1T4NB           Schedule Sequen
     C                     Z-ADDFJPRTM    #1PRTM           Product Tempera
     C                     Z-ADDFJNPSV    #1NPSV           Number Spacers
     C                     MOVELFJJ8TX    #1J8TX           Car/Veh. Initia
     C                     Z-ADDFJTLMI    #1TLMI           Total Load Mile
     C                     MOVELFJJ9TX    #1J9TX           Recorder ID
     C                     MOVELFJQ2CD    #1Q2CD           Shipping Method
     C                     MOVELFJVPCD    #1VPCD           Ship From Wareh
     C                     MOVELFJDBCD    #1DBCD           Ship To State C
     C                     Z-ADDFJGRWE    #1GRWE           Gross Weight
     C                     MOVELFJXCCD    #1XCCD           Carrier Broker
     C                     MOVELFJU2ST    #1U2ST           Export Status
     C                     Z-ADDFJF9DT    #1F9DT           Actual Ship Dat
     C                     MOVELFJONTM    #1ONTM           On Time - (Y/N)
     C                     Z-ADDFJJ4DT    #1J4DT           Truck Ready Dat
     C                     Z-ADDFJTRTM    #1TRTM           Truck Ready Tim
     C                     Z-ADDFJJ5DT    #1J5DT           Spotted Date
     C                     Z-ADDFJSPTM    #1SPTM           Spotted Time
     C                     Z-ADDFJJ6DT    #1J6DT           Load Finished D
     C                     Z-ADDFJLFTM    #1LFTM           Load Finished T
     C                     Z-ADDFJJ7DT    #1J7DT           BOL Complete Da
     C                     Z-ADDFJBOTM    #1BOTM           BOL Complete Ti
     C                     Z-ADDFJJ8DT    #1J8DT           BOL Received Da
     C                     Z-ADDFJBLTM    #1BLTM           BOL Received Ti
     C                     Z-ADDFJKIDT    #1KIDT           Truck Departure
     C                     Z-ADDFJASTM    #1ASTM           Truck Departure
     C                     Z-ADDFJKADT    #1KADT           Adjusted Depart
     C                     Z-ADDFJAJCM    #1AJCM           Adjusted Depart
     C                     MOVELFJXACD    #1XACD           Shipping Line
     C                     MOVELFJOANA    #1OANA           Port Delv Termi
     C                     MOVELFJK4TX    #1K4TX           Vessel Name
     C                     Z-ADDFJVOAG    #1VOAG           Voyage
     C                     Z-ADDFJKBDT    #1KBDT           Sail Date
     C                     MOVELFJNBBO    #1NBBO           Booking Number
     C                     MOVELFJW4CD    #1W4CD           Discharge Port
     C                     Z-ADDFJEFDT    #1EFDT           Arrival Date
     C                     MOVELFJCNTN    #1CNTN           Container Numbe
     C                     Z-ADDFJKCDT    #1KCDT           Date In
     C                     Z-ADDFJTMIN    #1TMIN           Time In
     C                     Z-ADDFJKDDT    #1KDDT           Date Out
     C                     Z-ADDFJVMNB    #1VMNB           Time Out
     C                     Z-ADDFJOCFR    #1OCFR           Load Total Frei
     C                     Z-ADDFJKJDT    #1KJDT           Scheduled Deliv
     C                     Z-ADDFJATTM    #1ATTM           Scheduled Deliv
     C                     MOVELFJOTRS    #1OTRS           LH Unused Sts
     C                     MOVELFJRNST    #1RNST           LH Carrier Paym
     C                     Z-ADDFJBRBK    #1BRBK           Bring Back Mile
     C                     Z-ADDFJEIDT    #1EIDT           Requested Deliv
     C                     MOVELFJRMST    #1RMST           Load Acceptance
     C                     MOVELFJAJCD    #1AJCD           Warehouse Code
     C                     Z-ADDFJKKDT    #1KKDT           On Yard Date
     C                     Z-ADDFJAVTM    #1AVTM           On Yard Time
     C                     Z-ADDFJKZDT    #1KZDT           Deadline Depart
     C                     Z-ADDFJAXTM    #1AXTM           Deadline Depart
     C                     MOVELFJLHOS    #1LHOS           Load Held Over
     C                     MOVELFJLHOR    #1LHOR           Load Held Over
     C                     MOVELFJWNTX    #1WNTX           Load Held Over
     C                     MOVELFJOITX    #1OITX           Ocean BOL Numbe
     C                     MOVELFJOJTX    #1OJTX           Express Mail Nu
     C                     Z-ADDFJLLDT    #1LLDT           Express Mail Da
     C                     MOVELFJLSHG    #1LSHG           Load Shag Flag
     C                     MOVELFJYPST    #1YPST           Load Wash Flag
     C                     Z-ADDFJK0DT    #1K0DT           Product Complet
     C                     Z-ADDFJAYTM    #1AYTM           Product Complet
     C                     Z-ADDFJKNNX    #1KNNX           Pallets Loaded
     C                     Z-ADDFJICWG    #1ICWG           Avg Pallet Tare
     C                     Z-ADDFJIDWG    #1IDWG           Tot Pallet Tare
     C                     MOVELFJH9SX    #1H9SX           Load Confirmed
     C                     MOVELFJWOTX    #1WOTX           Load Confirmed
     C                     Z-ADDFJK1DT    #1K1DT           Load Confirmati
     C                     Z-ADDFJAZTM    #1AZTM           Load Door 1
     C                     Z-ADDFJK2DT    #1K2DT           Override Total
     C                     Z-ADDFJA0TM    #1A0TM           Load Door 2
     C                     MOVELFJROST    #1ROST           Partial Load
     C                     MOVELFJRPST    #1RPST           Load Confirmati
     C                     MOVELFJRQST    #1RQST           Export Load USD
     C                     MOVELFJRRST    #1RRST           Late Delivery E
     C                     Z-ADDFJZBVA    #1ZBVA           Load Actual Fre
     C                     MOVELFJWPTX    #1WPTX           Hide on WW Load
     C                     MOVELFJWQTX    #1WQTX           Late Billing Em
     C                     MOVELFJWRTX    #1WRTX           Shipping Temp C
     C                     MOVELFJWSTX    #1WSTX           LH Held Over Rs
     C                     MOVELFJRVSX    #1RVSX           Multi Company L
     C                     MOVELFJRUSX    #1RUSX           Fax Sent to SSI
     C                     MOVELFJRWSX    #1RWSX           Schedule Pos Lo
     C                     MOVELFJRXSX    #1RXSX           LH Power Only L
     C                     MOVELFJRYSX    #1RYSX           MG Created Load
     C                     MOVELFJRZSX    #1RZSX           LH Unused Sts 5
     C                     MOVELFJR0SX    #1R0SX           Load U/M
     C                     MOVELFJR1SX    #1R1SX           TPM Shipment St
     C                     MOVELFJR2SX    #1R2SX           LH Unused Sts 8
     C                     MOVELFJR3SX    #1R3SX           LH On-Time Reas
     C                     MOVELFJR4SX    #1R4SX           LH Held Over Re
     C                     Z-ADDFJPYDT    #1PYDT           LH Carrier Paid
     C                     Z-ADDFJCKTM    #1CKTM           LH Carrier Paid
     C                     Z-ADDFJPZDT    #1PZDT           LH Last Combo P
     C                     Z-ADDFJCLTM    #1CLTM           LH Last Combo P
     C                     Z-ADDFJP0DT    #1P0DT           LPT Load Plan S
     C                     Z-ADDFJCMTM    #1CMTM           LPT Load Plan S
     C                     Z-ADDFJP1DT    #1P1DT           TPM Planned Shi
     C                     Z-ADDFJCNTM    #1CNTM           LH Unused Time
     C                     Z-ADDFJP2DT    #1P2DT           LH Unused Date
     C                     Z-ADDFJCOTM    #1COTM           LH Unused Time
     C                     Z-ADDFJP3DT    #1P3DT           LH Unused Date
     C                     Z-ADDFJCQTM    #1CQTM           LH Unused Time
     C                     MOVELFJUVST    #1UVST           EDI Status 1
     C                     MOVELFJUWST    #1UWST           EDI Status 2
     C                     MOVELFJUXST    #1UXST           EDI Status 3
     C                     Z-ADDFJAATM    #1AATM           Job Time
     C                     MOVELFJAYNA    #1AYNA           User Id
     C                     MOVELFJA0NA    #1A0NA           Job Name
     C                     Z-ADDFJAXDT    #1AXDT           Job Date
      * * Save Carrier Code in hidden field to check if it has changed
      * CASE:
      *  - c1 OR c2
      *   |- c1    : RCD.Carrier Code Usr is not entered
      *   |- c2    : RCD.Carrier Code is not entered
      *   '-
     C           #RH8AA    IFEQ *BLANK                     *IF
     C           #1BZNA    OREQ *BLANK                     *OR
     C                     MOVELFJBZNA    #RH8AA           Carrier Code Us
     C                     MOVELFJBZNA    #1BZNA           Carrier Code
     C                     END                             *FI
      * R15161 DN 7/17/19-Replaced Booking Number usr 1 w/ 'OHE Booking N
      * RTV Book info by load  RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0001    WL0008           Order Number
     C                     Z-ADD#1RMNB    WL0009           Load ID
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0008    YL0001           Order Number
     C                     MOVELWL0010    #RJ0T1    P      OHE Vessel/Airl
     C                     MOVELWL0011    #RGENY    P      OHE Voyage/Flig
     C                     MOVELWL0012    #RM4U1    P      OHE Booking Num
     C                     MOVELWL0013    #RBDU1    P      OHE Container N
     C                     MOVEL*BLANK    #RMUTX           Trailer Id
     C                     MOVEL#RBDU1    #RMUTX           Trailer Id
     C                     MOVELFJDXTX    #1DXTX           Trailer Id
      * R15161 DN 7/17/19-Commented Out, No Purpose.
     C                     MOVELP7BOCD    #RBOCD           Type Code
     C                     END                             *FI
      * If record dropped...
     C                     SUB  1         ##RR
     C           W0RSL     CABNE'Y'       BB020
     C                     ADD  1         ##RR
      * Validate subfile record and calculate derived fields
     C                     EXSR DFV2RC
      * Output to subfile
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * 82=EOF
     C                     READ @FJCPL9                  82*
     C  N82                END
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Subfile control function fields
      * RTV Carrier Name       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#2BZNA    WL0003    P      Carrier Code
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    #CEET1    P      Name
     C                     MOVELWL0005    YN0001    P      Record Status
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate subfile control
      * Warning if no Booking fields contain data
      * CASE:
      *  - c1 AND c2 AND c3 AND c4 AND c5 AND c6 AND c7 AND c8
      *   |- c1    : CTL.OHE Booking Number is Not Entered
      *   |- c2    : CTL.Carrier Code is not entered
      *   |- c3    : CTL.OHE Vessel/Airline is blanks
      *   |- c4    : CTL.OHE Voyage/Flight is Zeros
      *   |- c5    : CTL.Shipping Line is not entered
      *   |- c6    : CTL.Delivery Terminal USR is Not Entered
      *   |- c7    : CTL.OHE Discharge Port/Airprt is Blank
      *   |- c8    : CTL.OHE City is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CJ1T1    IFEQ *BLANK                     *IF
     C           #2BZNA    IFEQ *BLANK                     *IF
     C           #CJ0T1    IFEQ *BLANK                     *IF
     C           #CGENY    IFEQ '*ZERO'                    *IF
     C           #CXACD    IFEQ *BLANK                     *IF
     C           #CAWAA    IFEQ *BLANK                     *IF
     C           #CHCAA    IFEQ *BLANK                     *IF
     C           #CHBAA    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Send message 'No info to assign to load'
     C                     MOVEL'USR4688' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
      * Exit without update
      * CASE: CTL.*CMD key is *Exit
     C           *IN03     IFEQ '1'                        *IF
     C                     MOVEL*BLANK    P8BTST           Record Activity
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     END
      * Quit if reload requested
     C           W0RSF     CABEQ'Y'       DAEXIT
      *
     C   81                DO
      * No data entered as yet
     C                     MOVEL'N'       WKIPIN  1
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Process subfile records
     C                     EXSR DBPRSF
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * If data entered
     C           WKIPIN    IFEQ 'Y'
      * Prompt for confirmation
     C                     EXSR DHPRCF
      * Exit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO DAEXIT
     C                     END
      * Update DBF from subfile
     C                     EXSR EAPRSF
      * If error during update, exit:
     C           *IN99     CABEQ'1'       DAEXIT
     C                     END                             WKIPIN
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process command keys
      * R15161 DN 08/09/19-Commented Out. Does Not Work Nor PBL2UPC is no
     C                     END
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
     C                     EXSR DCPRSR
     C                     SETOF                     87    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,31
      * No errors
     C                     SETOF                     98
      * Data entered
     C                     MOVEL'Y'       WKIPIN
      * SFLNXTCHG
     C                     SETON                     84
      * Validate subfile record
     C                     EXSR DEV1RC
      * If SFLRCD invalid, note the fact
     C   98N99             Z-ADD##RR      ##SFRC     99    *
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         DEV1RC    BEGSR
      *================================================================
      * Validate subfile record
      *================================================================
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate subfile record fields
      * Carrier must be valid if entered
      * CASE: RCD.Carrier Code is entered
     C           #1BZNA    IFNE *BLANK                     *IF
      * Val Carrier           RT - Carrier  * 
     C                     EXSR SIRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,006                    *IF
      * Setup message data for message
     C                     MOVEL#1BZNA    ZA0001           Carrier Code
      * Send message 'Carrier doesn't exists'
     C                     MOVEL'USR1252' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9832  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Carrier required to enter a container number
      * CASE:
      *  - c1 AND c2
      *   |- c1    : RCD.Carrier Code is not entered
      *   |- c2    : RCD.Container Number usr 1 is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1BZNA    IFEQ *BLANK                     *IF
     C           #RBDU1    IFNE *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#1BZNA    ZA0002           Carrier Code
      * Send message 'Carrier req to enter trlr'
     C                     MOVEL'USR2668' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9832  *
      *
     C                     END                             *FI
      * Validate Carrier/Trailer-Container. Create new if needed
      * CASE:
      *  - c1 AND c2
      *   |- c1    : RCD.Container Number usr 1 is Entered
      *   |- c2    : RCD.Carrier Code is entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #RBDU1    IFNE *BLANK                     *IF
     C           #1BZNA    IFNE *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Trailer            RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1BZNA    WL0014    P      Carrier Code
     C                     MOVEL#RBDU1    WL0015    P      Trailer Id
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0016    YN0002           Company Number
     C                     MOVELWL0017    YL0006    P      Load Type
     C                     MOVELWL0018    YL0007    P      Trailer Type
     C                     MOVELWL0019    YL0008    P      Seaboard Owned
     C                     MOVELWL0020    YL0009    P      On Yard Status
     C                     Z-ADDWL0021    YL0010           On Yard Date
     C                     Z-ADDWL0022    YL0011           On Yard Time
     C                     MOVELWL0023    YL0012    P      Assigned Status
     C                     MOVELWL0024    YL0013    P      Available Statu
     C                     MOVELWL0025    YL0014    P      Not Available R
     C                     MOVELWL0026    YL0015    P      Comment Line
     C                     MOVELWL0027    YN0001    P      Record Status
      * Create if Trailer does not exist
      * CASE: LCL.USR Load Type is Blank
     C           YL0006    IFEQ *BLANK                     *IF
      * Send message 'Trailer will be created'
     C                     MOVEL'USR2667' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
      * * Populate container fields
     C                     MOVEL'Y'       YL0012           Assigned Status
     C                     MOVEL'R'       YL0007           Trailer Type
     C                     MOVEL'Y'       YL0009           On Yard Status
     C                     Z-ADD##JDT     YL0010           On Yard Date
     C                     Z-ADD##JTM     YL0011           On Yard Time
     C                     MOVEL'N'       YL0013           Available Statu
      * default load type, if blanks
      * CASE: RCD.Load Type is Blank
     C           #1VDST    IFEQ *BLANK                     *IF
     C                     MOVEL'R'       YL0016           Load Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#1VDST    YL0016           Load Type
     C                     END                             *FI
      * Crt PD Trailer         CR - Trailer  * 
     C                     EXSR SKCRRC
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPARC
     C                     Z-ADD#1RMNB    PARMNB           Load ID
     C                     Z-ADD*ZERO     PARVNB           Stop/Drop
     C                     MOVEL'ASNTRL'  PARVST    P      Load Change Typ
     C                     MOVEL'TRF'     PAUJST    P      Department Cont
     C                     MOVEL*BLANK    PAMNTX    P      Change Log Prio
     C                     MOVEL#RBDU1    PAMOTX    P      Change Log New
     C                     MOVEL##USR     PAAYNA    P      User Id
     C                     MOVEL##PGM     PAA0NA    P      Job Name
     C                     MOVEL#1BZNA    PABZNA    P      Carrier Code
     C                     Z-ADD#CBNC3    PAAIC3           Company Number
     C                     Z-ADD*ZERO     PAC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983432*
     C                     END
      * * Save container in case it changes later on
     C                     MOVEL#RBDU1    WUJ2T1           OHE Container N
      * ** Retrieve fields for newly added Trailer
      * Rtv Trailer            RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1BZNA    WL0014    P      Carrier Code
     C                     MOVEL#RBDU1    WL0015    P      Trailer Id
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0016    YL0022           Company Number
     C                     MOVELWL0017    YL0006    P      Load Type
     C                     MOVELWL0018    YL0007    P      Trailer Type
     C                     MOVELWL0019    YL0008    P      Seaboard Owned
     C                     MOVELWL0020    YL0009    P      On Yard Status
     C                     Z-ADDWL0021    YL0010           On Yard Date
     C                     Z-ADDWL0022    YL0011           On Yard Time
     C                     MOVELWL0023    YL0012    P      Assigned Status
     C                     MOVELWL0024    YL0013    P      Available Statu
     C                     MOVELWL0025    YL0014    P      Not Available R
     C                     MOVELWL0026    YL0015    P      Comment Line
     C                     MOVELWL0027    YL0023    P      Record Status
     C                     END                             *FI
      * Clear usr load id
     C                     Z-ADD*ZERO     YL0024           Load ID USR
     C                     Z-ADD#1RMNB    YL0025           Load Id 2
      * VAL Trailer assignmnt RT - Load Header  * 
     C                     EXSR SLRVGN
      * * Skip error checks if trailer is assigned to rcd.load id
      * CASE: LCL.Load Id 3 is NE Blank
     C           YL0026    IFNE *ZERO                      *IF
      * load, carrier, trailer tests
      * CASE: LCL.Load Status is Shipped or Invoiced
     C           YL0027    IFEQ 'I'                        *IF
     C           YL0027    OREQ 'S'
      * ** No error if Load HDR is Shipped or Invoiced
     C                     ELSE
      * CASE: PGM.*Return code is Trailer already assigned
     C           W0RTN     IFEQ @CN,007                    *IF
      * ** Trailer exists in Order Header Extension file
      * Setup message data for message
     C                     MOVEL#RBDU1    ZA0003           Container Numbe
     C                     Z-ADDYL0026    ZA0004           Load Id 3
      * Send message 'Trailer is already assgnd'
     C                     MOVEL'USR2618' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9834  *
      *
     C                     ELSE
      * CASE: PGM.*Return code is Trailer Available to assn
     C           W0RTN     IFEQ @CN,008                    *IF
      * ** OKAY if:
      * ** Trailer exists but w/diff carrier or it doesn't exist
      * ** in either the OHE or Load Header file
     C                     ELSE
      * CASE: LCL.USR Load Type NE RCD.Load Type
     C           YL0006    IFNE #1VDST                     *IF
      * * Error message moved up above Info messages
      * Setup message data for message
     C                     MOVEL#1VDST    ZA0005           Load Type
     C                     MOVELYL0006    ZA0006           USR Load Type
     C                     MOVEL#RBDU1    ZA0007           Container Numbe
      * Send message 'Load type must match load'
     C                     MOVEL'USR2613' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9834  *
      *
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Available Status is Not Yes
      *   |- c2    : LCL.Load Id 3 NE RCD.Load ID
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0013    IFEQ *BLANK                     *IF
     C           YL0013    OREQ 'N'
     C           YL0026    IFNE #1RMNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#RBDU1    ZA0008           Container Numbe
      * Send message 'Trailer is not Available.'
     C                     MOVEL'USR2616' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: LCL.Seaboard Owned Status is yes
     C           YL0008    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#RBDU1    ZA0009           Container Numbe
      * Send message 'Trailer is Sbd owned.'
     C                     MOVEL'USR2617' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: LCL.On Yard Date is not entered
     C           YL0010    IFEQ *ZERO                      *IF
      * Setup message data for message
     C                     MOVEL#RBDU1    ZA0010           Container Numbe
      * Send message 'Trailer is not On Yard.'
     C                     MOVEL'USR2619' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: LCL.Company Number NE CTL.Company
     C           YL0022    IFNE #CBNC3                     *IF
      * * Info error moved to bottom of list of tests
      * Setup message data for message
     C                     MOVEL#RBDU1    ZA0011           Container Numbe
      * Send message 'Trailer Co#<>Ld Str Co#'
     C                     MOVEL'USR3902' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * Validate subfile record relations
     C                     EXSR DFV2RC
      *================================================================
     CSR         DEEXIT    ENDSR
      /EJECT
     CSR         DFV2RC    BEGSR
      *================================================================
      * Validate subfile record relations
      *================================================================
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate subfile record relations
      * CASE: RCD.*SFLSEL is *Select
     C           #1SEL     IFEQ '1'                        *IF
     C           #1SEL     OREQ ' 1'
      * R15161 DN 7/17/19-Replaced Booking Number usr 1 parm w/ OHE Booki
      *   Dropped Booking Number parm, no purpose.
      * CHG LH, OHE, OH        CH - Load Header  * 
     C                     EXSR SMCHRC
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         DFEXIT    ENDSR
      /EJECT
     CSR         DHPRCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'Y'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#SFLCTL
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         EAPRSF    BEGSR
      *================================================================
      * Update DBF from subfile
      *================================================================
      * Initialise subfile reload flag
     C                     MOVEL'N'       W0RSF
      * Process all modified subfile records
     C                     READC#SFLRCD                  92*
     C           *IN92     DOWEQ'0'
      * Process modified subfile record
     C                     EXSR EBPRSR
     C                     MOVEL*BLANK    #1SEL
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      * If any errors, cancel reload
     C           *IN99     IFEQ '1'
     C                     MOVEL'N'       W0RSF   1
     C                     END
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPRSR    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,31
     C                     SETOF                     98
      *
      * Process change request
     C                     EXSR EECHRQ
      * If error occurred on update, note the fact
     C           *IN98     IFEQ '1'
     C           *IN99     IFEQ '0'
     C                     Z-ADD##RR      ##SFRC     99    *
     C                     END
     C                     ELSE
      * USER: Extra processing after DBF update
     C                     MOVEL#1BZNA    #RH8AA           Carrier Code Us
     C                     MOVEL'A'       P8BTST           Record Activity
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         EECHRQ    BEGSR
      *================================================================
      * Process update request
      *================================================================
      * USER: Change DBF record
      * CHG LH, OHE, OH        CH - Load Header  * 
     C                     EXSR TACHRC
     C           W0RTN     IFNE *BLANK
      * Data update error
      * Screen errors
     C                     MOVEAWKIND1    *IN,31
      * Format error
     C                     SETON                     98    *
      * Enable entry
     C                     SETOF                     87    *
      * SFLNXTCHG
     C                     SETON                     84    *
      * Reset subfile record if changed record
     C           W0RTN     CASEQ'Y2U0007' MBFL#1           IF
     C                     END
     C                     ELSE
      * DBF update successful
      * Enable entry
     C                     SETOF                     87    *
      * No SFLNXTCHG
     C                     SETOF                     84    *
     C                     END
      *================================================================
     CSR         EEEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for Subfile record
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      * Protect keys if change mode or updated record
     C                     SETON                     88    *
     C   89N87             SETOF                     88    *
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSA2    BEGSR
      *================================================================
      * Set display attributes for Subfile control
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise subfile record
      *================================================================
      * Previous values
     C                     MOVEL*BLANK    #1DBRC
     C                     Z-ADDP3AODT    #1AODT           Scheduled Ship
     C                     MOVEL*BLANK    #RH8AA           Carrier Code Us
     C                     MOVEL*BLANK    #RBCU1           Booking Number
     C                     MOVEL*BLANK    #RBEU1           Booking Number
     C                     MOVEL*BLANK    #RMUTX           Trailer Id
     C                     Z-ADD*ZERO     #1AIC3           Company Number
     C                     MOVEL*BLANK    #1PJST           LTL Flag
     C                     MOVEL*BLANK    #1PKST           Load Status
     C                     Z-ADD*ZERO     #1RNNB           Reefer Temperat
     C                     MOVEL*BLANK    #1DMTX           Seal 1
     C                     MOVEL*BLANK    #1DNTX           Seal 2
     C                     MOVEL*BLANK    #1DOTX           Seal 3
     C                     MOVEL*BLANK    #1WTTX           Seal 4
     C                     MOVEL*BLANK    #1WUTX           Seal 2 Unused
     C                     Z-ADD*ZERO     #1RPNB           Total Load Orde
     C                     Z-ADD*ZERO     #1FLAM           Flat Amount
     C                     MOVEL*BLANK    #1XQST           Allocate Pounds
     C                     Z-ADD*ZERO     #1RRNB           Total Stops
     C                     MOVEL*BLANK    #1DXTX           Trailer Id
     C                     MOVEL*BLANK    #1DYTX           Transloader Car
     C                     Z-ADD*ZERO     #1SBNB           BOL Time
     C                     MOVEL*BLANK    #1RONB           Truck Size
     C                     Z-ADD*ZERO     #1SQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     #1R1NB           Rated Freight
     C                     MOVEL*BLANK    #1VCST           Ship Status
     C                     MOVEL*BLANK    #1VDST           Load Type
     C                     Z-ADD*ZERO     #1SDNB           Number Pallets
     C                     Z-ADD*ZERO     #1PAOU           Number Pallets
     C                     Z-ADD*ZERO     #1DGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     #1SXNB           Estimated Arriv
     C                     Z-ADD*ZERO     #1HADT           Actual Arrival
     C                     Z-ADD*ZERO     #1AART           Actual Arrival
     C                     Z-ADD*ZERO     #1DHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     #1DIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     #1AQDT           Actual Departur
     C                     Z-ADD*ZERO     #1S6NB           Departure Time
     C                     Z-ADD*ZERO     #1T4NB           Schedule Sequen
     C                     Z-ADD*ZERO     #1PRTM           Product Tempera
     C                     Z-ADD*ZERO     #1NPSV           Number Spacers
     C                     MOVEL*BLANK    #1J8TX           Car/Veh. Initia
     C                     Z-ADD*ZERO     #1TLMI           Total Load Mile
     C                     MOVEL*BLANK    #1J9TX           Recorder ID
     C                     MOVEL*BLANK    #1Q2CD           Shipping Method
     C                     MOVEL*BLANK    #1VPCD           Ship From Wareh
     C                     MOVEL*BLANK    #1DBCD           Ship To State C
     C                     Z-ADD*ZERO     #1GRWE           Gross Weight
     C                     MOVEL*BLANK    #1XCCD           Carrier Broker
     C                     MOVEL*BLANK    #1U2ST           Export Status
     C                     Z-ADD*ZERO     #1F9DT           Actual Ship Dat
     C                     MOVEL*BLANK    #1ONTM           On Time - (Y/N)
     C                     Z-ADD*ZERO     #1J4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     #1TRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     #1J5DT           Spotted Date
     C                     Z-ADD*ZERO     #1SPTM           Spotted Time
     C                     Z-ADD*ZERO     #1J6DT           Load Finished D
     C                     Z-ADD*ZERO     #1LFTM           Load Finished T
     C                     Z-ADD*ZERO     #1J7DT           BOL Complete Da
     C                     Z-ADD*ZERO     #1BOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     #1J8DT           BOL Received Da
     C                     Z-ADD*ZERO     #1BLTM           BOL Received Ti
     C                     Z-ADD*ZERO     #1KIDT           Truck Departure
     C                     Z-ADD*ZERO     #1ASTM           Truck Departure
     C                     Z-ADD*ZERO     #1KADT           Adjusted Depart
     C                     Z-ADD*ZERO     #1AJCM           Adjusted Depart
     C                     MOVEL*BLANK    #1XACD           Shipping Line
     C                     MOVEL*BLANK    #1OANA           Port Delv Termi
     C                     MOVEL*BLANK    #1K4TX           Vessel Name
     C                     Z-ADD*ZERO     #1VOAG           Voyage
     C                     Z-ADD*ZERO     #1KBDT           Sail Date
     C                     MOVEL*BLANK    #1NBBO           Booking Number
     C                     MOVEL*BLANK    #1W4CD           Discharge Port
     C                     Z-ADD*ZERO     #1EFDT           Arrival Date
     C                     MOVEL*BLANK    #1CNTN           Container Numbe
     C                     Z-ADD*ZERO     #1KCDT           Date In
     C                     Z-ADD*ZERO     #1TMIN           Time In
     C                     Z-ADD*ZERO     #1KDDT           Date Out
     C                     Z-ADD*ZERO     #1VMNB           Time Out
     C                     Z-ADD*ZERO     #1OCFR           Load Total Frei
     C                     Z-ADD*ZERO     #1KJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     #1ATTM           Scheduled Deliv
     C                     MOVEL*BLANK    #1OTRS           LH Unused Sts
     C                     MOVEL*BLANK    #1RNST           LH Carrier Paym
     C                     Z-ADD*ZERO     #1BRBK           Bring Back Mile
     C                     Z-ADD*ZERO     #1EIDT           Requested Deliv
     C                     MOVEL*BLANK    #1RMST           Load Acceptance
     C                     MOVEL*BLANK    #1AJCD           Warehouse Code
     C                     Z-ADD*ZERO     #1KKDT           On Yard Date
     C                     Z-ADD*ZERO     #1AVTM           On Yard Time
     C                     Z-ADD*ZERO     #1KZDT           Deadline Depart
     C                     Z-ADD*ZERO     #1AXTM           Deadline Depart
     C                     MOVEL*BLANK    #1LHOS           Load Held Over
     C                     MOVEL*BLANK    #1LHOR           Load Held Over
     C                     MOVEL*BLANK    #1WNTX           Load Held Over
     C                     MOVEL*BLANK    #1OITX           Ocean BOL Numbe
     C                     MOVEL*BLANK    #1OJTX           Express Mail Nu
     C                     Z-ADD*ZERO     #1LLDT           Express Mail Da
     C                     MOVEL*BLANK    #1LSHG           Load Shag Flag
     C                     MOVEL*BLANK    #1YPST           Load Wash Flag
     C                     Z-ADD*ZERO     #1K0DT           Product Complet
     C                     Z-ADD*ZERO     #1AYTM           Product Complet
     C                     Z-ADD*ZERO     #1KNNX           Pallets Loaded
     C                     Z-ADD*ZERO     #1ICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     #1IDWG           Tot Pallet Tare
     C                     MOVEL*BLANK    #1H9SX           Load Confirmed
     C                     MOVEL*BLANK    #1WOTX           Load Confirmed
     C                     Z-ADD*ZERO     #1K1DT           Load Confirmati
     C                     Z-ADD*ZERO     #1AZTM           Load Door 1
     C                     Z-ADD*ZERO     #1K2DT           Override Total
     C                     Z-ADD*ZERO     #1A0TM           Load Door 2
     C                     MOVEL*BLANK    #1ROST           Partial Load
     C                     MOVEL*BLANK    #1RPST           Load Confirmati
     C                     MOVEL*BLANK    #1RQST           Export Load USD
     C                     MOVEL*BLANK    #1RRST           Late Delivery E
     C                     Z-ADD*ZERO     #1ZBVA           Load Actual Fre
     C                     MOVEL*BLANK    #1WPTX           Hide on WW Load
     C                     MOVEL*BLANK    #1WQTX           Late Billing Em
     C                     MOVEL*BLANK    #1WRTX           Shipping Temp C
     C                     MOVEL*BLANK    #1WSTX           LH Held Over Rs
     C                     MOVEL*BLANK    #1RVSX           Multi Company L
     C                     MOVEL*BLANK    #1RUSX           Fax Sent to SSI
     C                     MOVEL*BLANK    #1RWSX           Schedule Pos Lo
     C                     MOVEL*BLANK    #1RXSX           LH Power Only L
     C                     MOVEL*BLANK    #1RYSX           MG Created Load
     C                     MOVEL*BLANK    #1RZSX           LH Unused Sts 5
     C                     MOVEL*BLANK    #1R0SX           Load U/M
     C                     MOVEL*BLANK    #1R1SX           TPM Shipment St
     C                     MOVEL*BLANK    #1R2SX           LH Unused Sts 8
     C                     MOVEL*BLANK    #1R3SX           LH On-Time Reas
     C                     MOVEL*BLANK    #1R4SX           LH Held Over Re
     C                     Z-ADD*ZERO     #1PYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     #1CKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     #1PZDT           LH Last Combo P
     C                     Z-ADD*ZERO     #1CLTM           LH Last Combo P
     C                     Z-ADD*ZERO     #1P0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     #1CMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     #1P1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     #1CNTM           LH Unused Time
     C                     Z-ADD*ZERO     #1P2DT           LH Unused Date
     C                     Z-ADD*ZERO     #1COTM           LH Unused Time
     C                     Z-ADD*ZERO     #1P3DT           LH Unused Date
     C                     Z-ADD*ZERO     #1CQTM           LH Unused Time
     C                     MOVEL*BLANK    #1UVST           EDI Status 1
     C                     MOVEL*BLANK    #1UWST           EDI Status 2
     C                     MOVEL*BLANK    #1UXST           EDI Status 3
     C                     Z-ADD*ZERO     #1AATM           Job Time
     C                     MOVEL*BLANK    #1AYNA           User Id
     C                     MOVEL*BLANK    #1A0NA           Job Name
     C                     Z-ADD*ZERO     #1AXDT           Job Date
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     Z-ADD*ZERO     #1RMNB           Load ID
     C                     MOVEL*BLANK    #1BZNA           Carrier Code
     C                     MOVEL*BLANK    #RM4U1           OHE Booking Num
     C                     MOVEL*BLANK    #RBDU1           Container Numbe
     C                     MOVEL*BLANK    #RJ0T1           OHE Vessel/Airl
     C                     MOVEL*BLANK    #RGENY           OHE Voyage/Flig
     C                     MOVEL*BLANK    #RWPST           Warehouse Type
     C                     MOVEL*BLANK    #RBOCD           Type Code
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @FJCPL9 fields to subfile
      *================================================================
     C                     Z-ADDFJAODT    #1AODT           Scheduled Ship
     C                     Z-ADDFJAIC3    #1AIC3           Company Number
     C                     MOVELFJPJST    #1PJST           LTL Flag
     C                     MOVELFJPKST    #1PKST           Load Status
     C                     Z-ADDFJRNNB    #1RNNB           Reefer Temperat
     C                     MOVELFJDMTX    #1DMTX           Seal 1
     C                     MOVELFJDNTX    #1DNTX           Seal 2
     C                     MOVELFJDOTX    #1DOTX           Seal 3
     C                     MOVELFJWTTX    #1WTTX           Seal 4
     C                     MOVELFJWUTX    #1WUTX           Seal 2 Unused
     C                     Z-ADDFJRPNB    #1RPNB           Total Load Orde
     C                     Z-ADDFJFLAM    #1FLAM           Flat Amount
     C                     MOVELFJXQST    #1XQST           Allocate Pounds
     C                     Z-ADDFJRRNB    #1RRNB           Total Stops
     C                     MOVELFJDXTX    #1DXTX           Trailer Id
     C                     MOVELFJDYTX    #1DYTX           Transloader Car
     C                     Z-ADDFJSBNB    #1SBNB           BOL Time
     C                     MOVELFJRONB    #1RONB           Truck Size
     C                     Z-ADDFJSQNB    #1SQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADDFJR1NB    #1R1NB           Rated Freight
     C                     MOVELFJVCST    #1VCST           Ship Status
     C                     MOVELFJVDST    #1VDST           Load Type
     C                     Z-ADDFJSDNB    #1SDNB           Number Pallets
     C                     Z-ADDFJPAOU    #1PAOU           Number Pallets
     C                     Z-ADDFJDGWG    #1DGWG           Load Carrier Pa
     C                     Z-ADDFJSXNB    #1SXNB           Estimated Arriv
     C                     Z-ADDFJHADT    #1HADT           Actual Arrival
     C                     Z-ADDFJAART    #1AART           Actual Arrival
     C                     Z-ADDFJDHWG    #1DHWG           Trailer IN Weig
     C                     Z-ADDFJDIWG    #1DIWG           Trailer OUT Wei
     C                     Z-ADDFJAQDT    #1AQDT           Actual Departur
     C                     Z-ADDFJS6NB    #1S6NB           Departure Time
     C                     Z-ADDFJT4NB    #1T4NB           Schedule Sequen
     C                     Z-ADDFJPRTM    #1PRTM           Product Tempera
     C                     Z-ADDFJNPSV    #1NPSV           Number Spacers
     C                     MOVELFJJ8TX    #1J8TX           Car/Veh. Initia
     C                     Z-ADDFJTLMI    #1TLMI           Total Load Mile
     C                     MOVELFJJ9TX    #1J9TX           Recorder ID
     C                     MOVELFJQ2CD    #1Q2CD           Shipping Method
     C                     MOVELFJVPCD    #1VPCD           Ship From Wareh
     C                     MOVELFJDBCD    #1DBCD           Ship To State C
     C                     Z-ADDFJGRWE    #1GRWE           Gross Weight
     C                     MOVELFJXCCD    #1XCCD           Carrier Broker
     C                     MOVELFJU2ST    #1U2ST           Export Status
     C                     Z-ADDFJF9DT    #1F9DT           Actual Ship Dat
     C                     MOVELFJONTM    #1ONTM           On Time - (Y/N)
     C                     Z-ADDFJJ4DT    #1J4DT           Truck Ready Dat
     C                     Z-ADDFJTRTM    #1TRTM           Truck Ready Tim
     C                     Z-ADDFJJ5DT    #1J5DT           Spotted Date
     C                     Z-ADDFJSPTM    #1SPTM           Spotted Time
     C                     Z-ADDFJJ6DT    #1J6DT           Load Finished D
     C                     Z-ADDFJLFTM    #1LFTM           Load Finished T
     C                     Z-ADDFJJ7DT    #1J7DT           BOL Complete Da
     C                     Z-ADDFJBOTM    #1BOTM           BOL Complete Ti
     C                     Z-ADDFJJ8DT    #1J8DT           BOL Received Da
     C                     Z-ADDFJBLTM    #1BLTM           BOL Received Ti
     C                     Z-ADDFJKIDT    #1KIDT           Truck Departure
     C                     Z-ADDFJASTM    #1ASTM           Truck Departure
     C                     Z-ADDFJKADT    #1KADT           Adjusted Depart
     C                     Z-ADDFJAJCM    #1AJCM           Adjusted Depart
     C                     MOVELFJXACD    #1XACD           Shipping Line
     C                     MOVELFJOANA    #1OANA           Port Delv Termi
     C                     MOVELFJK4TX    #1K4TX           Vessel Name
     C                     Z-ADDFJVOAG    #1VOAG           Voyage
     C                     Z-ADDFJKBDT    #1KBDT           Sail Date
     C                     MOVELFJNBBO    #1NBBO           Booking Number
     C                     MOVELFJW4CD    #1W4CD           Discharge Port
     C                     Z-ADDFJEFDT    #1EFDT           Arrival Date
     C                     MOVELFJCNTN    #1CNTN           Container Numbe
     C                     Z-ADDFJKCDT    #1KCDT           Date In
     C                     Z-ADDFJTMIN    #1TMIN           Time In
     C                     Z-ADDFJKDDT    #1KDDT           Date Out
     C                     Z-ADDFJVMNB    #1VMNB           Time Out
     C                     Z-ADDFJOCFR    #1OCFR           Load Total Frei
     C                     Z-ADDFJKJDT    #1KJDT           Scheduled Deliv
     C                     Z-ADDFJATTM    #1ATTM           Scheduled Deliv
     C                     MOVELFJOTRS    #1OTRS           LH Unused Sts
     C                     MOVELFJRNST    #1RNST           LH Carrier Paym
     C                     Z-ADDFJBRBK    #1BRBK           Bring Back Mile
     C                     Z-ADDFJEIDT    #1EIDT           Requested Deliv
     C                     MOVELFJRMST    #1RMST           Load Acceptance
     C                     MOVELFJAJCD    #1AJCD           Warehouse Code
     C                     Z-ADDFJKKDT    #1KKDT           On Yard Date
     C                     Z-ADDFJAVTM    #1AVTM           On Yard Time
     C                     Z-ADDFJKZDT    #1KZDT           Deadline Depart
     C                     Z-ADDFJAXTM    #1AXTM           Deadline Depart
     C                     MOVELFJLHOS    #1LHOS           Load Held Over
     C                     MOVELFJLHOR    #1LHOR           Load Held Over
     C                     MOVELFJWNTX    #1WNTX           Load Held Over
     C                     MOVELFJOITX    #1OITX           Ocean BOL Numbe
     C                     MOVELFJOJTX    #1OJTX           Express Mail Nu
     C                     Z-ADDFJLLDT    #1LLDT           Express Mail Da
     C                     MOVELFJLSHG    #1LSHG           Load Shag Flag
     C                     MOVELFJYPST    #1YPST           Load Wash Flag
     C                     Z-ADDFJK0DT    #1K0DT           Product Complet
     C                     Z-ADDFJAYTM    #1AYTM           Product Complet
     C                     Z-ADDFJKNNX    #1KNNX           Pallets Loaded
     C                     Z-ADDFJICWG    #1ICWG           Avg Pallet Tare
     C                     Z-ADDFJIDWG    #1IDWG           Tot Pallet Tare
     C                     MOVELFJH9SX    #1H9SX           Load Confirmed
     C                     MOVELFJWOTX    #1WOTX           Load Confirmed
     C                     Z-ADDFJK1DT    #1K1DT           Load Confirmati
     C                     Z-ADDFJAZTM    #1AZTM           Load Door 1
     C                     Z-ADDFJK2DT    #1K2DT           Override Total
     C                     Z-ADDFJA0TM    #1A0TM           Load Door 2
     C                     MOVELFJROST    #1ROST           Partial Load
     C                     MOVELFJRPST    #1RPST           Load Confirmati
     C                     MOVELFJRQST    #1RQST           Export Load USD
     C                     MOVELFJRRST    #1RRST           Late Delivery E
     C                     Z-ADDFJZBVA    #1ZBVA           Load Actual Fre
     C                     MOVELFJWPTX    #1WPTX           Hide on WW Load
     C                     MOVELFJWQTX    #1WQTX           Late Billing Em
     C                     MOVELFJWRTX    #1WRTX           Shipping Temp C
     C                     MOVELFJWSTX    #1WSTX           LH Held Over Rs
     C                     MOVELFJRVSX    #1RVSX           Multi Company L
     C                     MOVELFJRUSX    #1RUSX           Fax Sent to SSI
     C                     MOVELFJRWSX    #1RWSX           Schedule Pos Lo
     C                     MOVELFJRXSX    #1RXSX           LH Power Only L
     C                     MOVELFJRYSX    #1RYSX           MG Created Load
     C                     MOVELFJRZSX    #1RZSX           LH Unused Sts 5
     C                     MOVELFJR0SX    #1R0SX           Load U/M
     C                     MOVELFJR1SX    #1R1SX           TPM Shipment St
     C                     MOVELFJR2SX    #1R2SX           LH Unused Sts 8
     C                     MOVELFJR3SX    #1R3SX           LH On-Time Reas
     C                     MOVELFJR4SX    #1R4SX           LH Held Over Re
     C                     Z-ADDFJPYDT    #1PYDT           LH Carrier Paid
     C                     Z-ADDFJCKTM    #1CKTM           LH Carrier Paid
     C                     Z-ADDFJPZDT    #1PZDT           LH Last Combo P
     C                     Z-ADDFJCLTM    #1CLTM           LH Last Combo P
     C                     Z-ADDFJP0DT    #1P0DT           LPT Load Plan S
     C                     Z-ADDFJCMTM    #1CMTM           LPT Load Plan S
     C                     Z-ADDFJP1DT    #1P1DT           TPM Planned Shi
     C                     Z-ADDFJCNTM    #1CNTM           LH Unused Time
     C                     Z-ADDFJP2DT    #1P2DT           LH Unused Date
     C                     Z-ADDFJCOTM    #1COTM           LH Unused Time
     C                     Z-ADDFJP3DT    #1P3DT           LH Unused Date
     C                     Z-ADDFJCQTM    #1CQTM           LH Unused Time
     C                     MOVELFJUVST    #1UVST           EDI Status 1
     C                     MOVELFJUWST    #1UWST           EDI Status 2
     C                     MOVELFJUXST    #1UXST           EDI Status 3
     C                     Z-ADDFJAATM    #1AATM           Job Time
     C                     MOVELFJAYNA    #1AYNA           User Id
     C                     MOVELFJA0NA    #1A0NA           Job Name
     C                     Z-ADDFJAXDT    #1AXDT           Job Date
     C                     Z-ADDFJRMNB    #1RMNB           Load ID
     C                     MOVELFJBZNA    #1BZNA           Carrier Code
      * Hold current record image for change detection
     C                     MOVEL@1DBRC    #1DBRC
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     Z-ADDP3AODT    #2AODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V2AODT
     C                     Z-ADD*ZERO     #CHODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     VCHODT
     C                     Z-ADD*ZERO     #CBNC3           Company
      * Clear external version also
     C                     MOVEL*BLANK    VCBNC3
     C                     Z-ADD*ZERO     #CLOID           Load ID USR
     C                     MOVEL*BLANK    #2BZNA           Carrier Code
     C                     MOVEL*BLANK    #CJ1T1           OHE Booking Num
     C                     MOVEL*BLANK    #CJ0T1           OHE Vessel/Airl
     C                     MOVEL*BLANK    #CGENY           OHE Voyage/Flig
     C                     MOVEL*BLANK    #CBOCD           Type Code
     C                     MOVEL*BLANK    #CXACD           Shipping Line
     C                     MOVEL*BLANK    #CEET1           Description 21A
     C                     MOVEL*BLANK    #CAWAA           Delivery Termin
     C                     MOVEL*BLANK    #CHCAA           OHE Discharge P
     C                     MOVEL*BLANK    #CHBAA           OHE City
     C                     MOVEL*BLANK    #CB4TX           OHE Load Haul T
     C                     MOVEL*BLANK    #CWPST           Warehouse Type
     C                     MOVEL*BLANK    #CI6TX           Description 14A
     C                     MOVEL*BLANK    #CNLTX           USR 15 Text
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #2AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2AODT
      * Convert Scheduled Ship Date USR to display format
      * Convert date
     C           1000000   ADD  #CHODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCHODT
      * Convert Company to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #CBNC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#CBNC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VCBNC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VCBNC3           CD3 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Warehouse wo/Quit RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSA01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSA02           Order Number
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WQSA02           Order Number
      * Setup key
     C                     Z-ADDP2AIC3    WQSA01           Company Number
     C                     Z-ADDP2C4NB    WQSA02           Order Number
      * Establish starting position
     C           KRSSA     SETLL@BGWKDA                    *
     C           KRSSA     READE@BGWKDA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    P1AJCD           Warehouse Code
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Cancelled
     C           OMGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELOMAJCD    P1AJCD           Warehouse Code
     C                     END                             *FI
     C           KRSSA     READE@BGWKDA                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Warehouse Type     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0001    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSB     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           Warehouse Type
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADWPST    WL0002           Warehouse Type
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Carrier Name       RT - Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           FFBZNA           Carrier Code
      * Setup key
     C                     MOVELWL0003    FFBZNA           Carrier Code
      * Establish starting position
     C           KRSSC     CHAIN@FFREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0004           Name
     C                     MOVEL*BLANK    WL0005           Record Status
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFFADTX    WL0004           Name
     C                     MOVELFFVSST    WL0005           Record Status
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Type Cd by Ord     RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BERMNB    WQSD01           Load ID
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSD01           Load ID
      * Establish starting position
     C           KRSSD     SETLL@BFCPR4                    *
     C           KRSSD     READE@BFCPR4                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Ship To Customer is not equal to zero
     C           WUBKC7    IFNE 0                          *IF
      * Validate type code for selected customer
      * CASE: DB1.Ship To Customer EQ PAR.Ship To Customer
     C           BEBKC7    IFEQ WUBKC7                     *IF
      * RTV Type Code by Cust  RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDBEBKC7    WL0006           Ship To Custome
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    YL0004    P      Type Code
      * CASE: LCL.Type Code NE PAR.Trans Type 1 PASS     USR
     C           YL0004    IFNE P7BOCD                     *IF
     C                     MOVEL'N'       YL0003           Record Selected
     C                     GOTO SDEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       YL0003           Record Selected
     C                     GOTO SDEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Ship To Customer is equal to zero
     C           WUBKC7    IFEQ 0                          *IF
     C                     MOVEL'N'       YL0003           Record Selected
      * Rtv Cust&CType-LdOrd  RT - Order Header TRG  * 
     C                     EXSR SFRVGN
      * Flag if at least 1 order on the load has matching type code
      * CASE: PAR.Record Selected       USR is yes
     C           YL0003    IFEQ 'Y'                        *IF
     C                     GOTO SDEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSD     READE@BFCPR4                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Type Code by Cust  RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN EOBKC7    WQSE01           Ship To Custome
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Ship To Custome
      * Setup key
     C                     Z-ADDWL0006    WQSE01           Ship To Custome
      * Establish starting position
     C           KRSSE     SETLL@EOREIQ                    *
     C           KRSSE     READE@EOREIQ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0007           Type Code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELEOBOCD    WL0007           Type Code
     C           KRSSE     READE@EOREIQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Cust&CType-LdOrd  RT - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  2        Type Code
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WARMNB    WQSF02           Load ID
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF02           Load ID
      * Setup key
     C                     Z-ADDBERMNB    WQSF02           Load ID
      * Establish starting position
     C           KRSSF     SETLL@BFCPRQ                    *
     C           KRSSF     READE@BFCPRQ                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Type Code by Cust  RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWABKC7    WL0006           Ship To Custome
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    WN0001    P      Type Code
      * CASE: PAR.Type Code EQ PAR.Trans Type 1 PASS     USR
     C           WN0001    IFEQ P7BOCD                     *IF
     C                     MOVEL'Y'       YL0003           Record Selected
     C                     GOTO SFEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSF     READE@BFCPRQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * VAL Bkg#/Cntnr by Load RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       YL0005           Record Found US
      * Declare restrictor key work fields
     C           *LIKE     DEFN AMRMNB    WQSG01           Load ID
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSG01           Load ID
      * Establish starting position
     C           KRSSG     SETLL@AMREJM                    *
     C           KRSSG     READE@AMREJM                  90*
      * Data record not found
     C   90                MOVEL'USR3697' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.OHE Booking Number is Not Entered
     C           AMJ1T1    IFEQ *BLANK                     *IF
     C                     MOVEL'N'       YL0005           Record Found US
     C                     GOTO SGEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       YL0005           Record Found US
     C                     END                             *FI
     C           KRSSG     READE@AMREJM                  90*
     C                     ENDDO
      * USER: Exit processing
      * This is not an error
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,006                    *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     END                             *FI
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Book info by load  RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN AMRMNB    WQSH01           Load ID
      * Define keylist
     C           KPSSH     KLIST
     C                     KFLD           WQSH01           Load ID
     C                     KFLD           AMC4NB           Order Number
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Load ID
      * Setup key
     C                     Z-ADDWL0009    WQSH01           Load ID
     C                     Z-ADDWL0008    AMC4NB           Order Number
      * Establish starting position
     C           KPSSH     SETLL@AMREJM                    *
     C           KRSSH     READE@AMREJM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAMC4NB    WL0008           Order Number
     C                     MOVELAMJ0T1    WL0010           OHE Vessel/Airl
     C                     MOVELAMGENY    WL0011           OHE Voyage/Flig
     C                     MOVELAMJ1T1    WL0012           OHE Booking Num
     C                     MOVELAMJ2T1    WL0013           OHE Container N
     C           KRSSH     READE@AMREJM                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Val Carrier           RT - Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           FFBZNA           Carrier Code
      * Setup key
     C                     MOVEL#1BZNA    FFBZNA           Carrier Code
      * Establish starting position
     C           KRSSI     CHAIN@FFREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Trailer            RT - Trailer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           LYBZNA           Carrier Code
     C                     KFLD           LYDXTX           Trailer Id
      * Setup key
     C                     MOVELWL0014    LYBZNA           Carrier Code
     C                     MOVELWL0015    LYDXTX           Trailer Id
      * Establish starting position
     C           KRSSJ     CHAIN@LYRER3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2598' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0016           Company Number
     C                     MOVEL*BLANK    WL0017           Load Type
     C                     MOVEL*BLANK    WL0018           Trailer Type
     C                     MOVEL*BLANK    WL0019           Seaboard Owned
     C                     MOVEL*BLANK    WL0020           On Yard Status
     C                     Z-ADD*ZERO     WL0021           On Yard Date
     C                     Z-ADD*ZERO     WL0022           On Yard Time
     C                     MOVEL*BLANK    WL0023           Assigned Status
     C                     MOVEL*BLANK    WL0024           Available Statu
     C                     MOVEL*BLANK    WL0025           Not Available R
     C                     MOVEL*BLANK    WL0026           Comment Line
     C                     MOVEL*BLANK    WL0027           Record Status
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDLYAIC3    WL0016           Company Number
     C                     MOVELLYVDST    WL0017           Load Type
     C                     MOVELLYX3ST    WL0018           Trailer Type
     C                     MOVELLYXGST    WL0019           Seaboard Owned
     C                     MOVELLYSTOY    WL0020           On Yard Status
     C                     Z-ADDLYKKDT    WL0021           On Yard Date
     C                     Z-ADDLYAVTM    WL0022           On Yard Time
     C                     MOVELLYSTAS    WL0023           Assigned Status
     C                     MOVELLYXRST    WL0024           Available Statu
     C                     MOVELLYX7CD    WL0025           Not Available R
     C                     MOVELLYGXTX    WL0026           Comment Line
     C                     MOVELLYVSST    WL0027           Record Status
     C                     GOTO SJEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCRRC    BEGSR
      *================================================================
      * Crt PD Trailer         CR - Trailer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @LYRER2
     C                     MOVEL#1BZNA    WBBZNA           Carrier Code
     C                     MOVEL#RBDU1    WBDXTX           Trailer Id
     C                     Z-ADD#CBNC3    WBAIC3           Company Number
     C                     MOVELYL0016    WBVDST           Load Type
     C                     MOVELYL0007    WBX3ST           Trailer Type
     C                     MOVEL'N'       WBXGST           Seaboard Owned
     C                     MOVELYL0009    WBSTOY           On Yard Status
     C                     Z-ADDYL0010    WBKKDT           On Yard Date
     C                     Z-ADDYL0011    WBAVTM           On Yard Time
     C                     MOVELYL0012    WBSTAS           Assigned Status
     C                     MOVELYL0013    WBXRST           Available Statu
     C                     MOVEL*BLANK    WBX7CD           Not Available R
     C                     MOVEL*BLANK    WBGXTX           Comment Line
     C                     MOVELYL0017    WBXTST           Status Unused 1
     C                     MOVELYL0018    WBXVST           Status Unused 2
     C                     MOVELYL0019    WBSTU3           Status Unused 3
     C                     MOVELYL0020    WBSTU4           Status Unused 4
     C                     MOVELYL0021    WBSTU5           Status Unused 5
     C                     Z-ADD*ZERO     WBLCDT           Date Unused 1
     C                     Z-ADD*ZERO     WBLDDT           Date Unused 2
     C                     Z-ADD*ZERO     WBLEDT           Date Unused 3
     C                     Z-ADD*ZERO     WBLFDT           Date Unused 4
     C                     Z-ADD*ZERO     WBLGDT           Date Unused 5
     C                     MOVEL#1UVST    WBUVST           EDI Status 1
     C                     MOVEL#1UWST    WBUWST           EDI Status 2
     C                     MOVEL#1UXST    WBUXST           EDI Status 3
     C                     MOVEL'A'       WBVSST           Record Status
     C                     Z-ADD#1AATM    WBAATM           Job Time
     C                     MOVEL#1AYNA    WBAYNA           User Id
     C                     MOVEL#1A0NA    WBA0NA           Job Name
     C                     Z-ADD#1AXDT    WBAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WBVSST           Record Status
     C                     Z-ADD##JTM     WBAATM           Job Time
     C                     MOVEL##USR     WBAYNA           User Id
     C                     MOVEL##PGM     WBA0NA           Job Name
     C                     Z-ADD##JDT     WBAXDT           Job Date
     C           KLCRSK    KLIST
     C                     KFLD           WBBZNA           Carrier Code
     C                     KFLD           WBDXTX           Trailer Id
      * Check for duplicate primary key
     C           KLCRSK    SETLL@LYRER2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2599' W0RTN   7
      * Send message 'Trailer                EX'
     C                     MOVEL'USR2599' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C                     WRITE@LYRER2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * VAL Trailer assignmnt RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ***** Changes and comments
     C                     EXSR UBSUBR                     ***** Changes a
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCDXTX    WQSL01           Trailer Id
     C           *LIKE     DEFN WCBZNA    WQSL02           Carrier Code
      * Define keylist
     C           KPSSL     KLIST
     C                     KFLD           WQSL01           Trailer Id
     C                     KFLD           WQSL02           Carrier Code
     C                     KFLD           WCRMNB           Load ID
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Trailer Id
     C                     KFLD           WQSL02           Carrier Code
      * Setup key
     C                     MOVEL#RBDU1    WQSL01           Trailer Id
     C                     MOVEL#1BZNA    WQSL02           Carrier Code
     C                     Z-ADD*ZERO     WCRMNB           Load ID
      * Establish starting position
     C           KPSSL     SETLL@FJCPMJ                    *
     C           KRSSL     READE@FJCPMJ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'TRLRAVL' W0RTN            *Return code
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Load ID NE PAR.Load Id 2
     C           WCRMNB    IFNE YL0025                     *IF
      * CASE: DB1.Load Status is Prior to Shipped
     C           WCPKST    IFEQ 'C'                        *IF
     C           WCPKST    OREQ 'E'
     C           WCPKST    OREQ 'L'
     C           WCPKST    OREQ 'U'
     C                     MOVEL'TRLRASN' W0RTN            *Return code
      * PAR.USR Load ID = DB1.Load ID
     C                     Z-ADDWCRMNB    YL0026           USR Load ID
     C                     GOTO SLEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSL     READE@FJCPMJ                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCHRC    BEGSR
      *================================================================
      * CHG LH, OHE, OH        CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0002  30       Company Number
     C                     MOVEL*BLANK    WN0003 15        Seal 4
     C                     MOVEL*BLANK    WN0004 15        Seal 2 Unused
     C                     MOVEL*BLANK    WN0005  2        Shipping Method
     C                     MOVEL*BLANK    WN0006  3        Shipping Line
     C                     MOVEL*BLANK    WN0007 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0008 30        Vessel Name
     C                     Z-ADD*ZERO     WN0009  50       Voyage
     C                     Z-ADD*ZERO     WN0010  70       Sail Date
     C                     MOVEL*BLANK    WN0011 12        Booking Number
     C                     MOVEL*BLANK    WN0012 20        Discharge Port
     C                     Z-ADD*ZERO     WN0013  70       Arrival Date
     C                     MOVEL*BLANK    WN0014 12        Container Numbe
     C                     Z-ADD*ZERO     WN0015  60       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0016  60       Job Time
     C                     MOVEL*BLANK    WN0017 10        User Id
     C                     MOVEL*BLANK    WN0018 10        Job Name
     C                     Z-ADD*ZERO     WN0019  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADD#1RMNB    FJRMNB           Load ID
      *
     C           KLCHSM    KLIST
     C                     KFLD           FJRMNB           Load ID
     C           KLCHSM    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE @1DBRC    YARDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADD#1AODT    FJAODT           Scheduled Ship
     C                     MOVEL#1PJST    FJPJST    P      LTL Flag
     C                     MOVEL#1PKST    FJPKST    P      Load Status
     C                     Z-ADD#1RNNB    FJRNNB           Reefer Temperat
     C                     MOVEL#1DMTX    FJDMTX    P      Seal 1
     C                     MOVEL#1DNTX    FJDNTX    P      Seal 2
     C                     MOVEL#1DOTX    FJDOTX    P      Seal 3
     C                     Z-ADD#1RPNB    FJRPNB           Total Load Orde
     C                     Z-ADD#1FLAM    FJFLAM           Flat Amount
     C                     MOVEL#1XQST    FJXQST    P      Allocate Pounds
     C                     Z-ADD#1RRNB    FJRRNB           Total Stops
     C                     MOVEL#RBDU1    FJDXTX    P      Trailer Id
     C                     MOVEL#1DYTX    FJDYTX    P      Transloader Car
     C                     Z-ADD#1SBNB    FJSBNB           BOL Time
     C                     MOVEL#1BZNA    FJBZNA    P      Carrier Code
     C                     MOVEL#1RONB    FJRONB    P      Truck Size
     C                     Z-ADD#1SQNB    FJSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD#1R1NB    FJR1NB           Rated Freight
     C                     MOVEL#1VCST    FJVCST    P      Ship Status
     C                     MOVEL#1VDST    FJVDST    P      Load Type
     C                     Z-ADD#1SDNB    FJSDNB           Number Pallets
     C                     Z-ADD#1PAOU    FJPAOU           Number Pallets
     C                     Z-ADD#1DGWG    FJDGWG           Load Carrier Pa
     C                     Z-ADD#1SXNB    FJSXNB           Estimated Arriv
     C                     Z-ADD#1HADT    FJHADT           Actual Arrival
     C                     Z-ADD#1AART    FJAART           Actual Arrival
     C                     Z-ADD#1DHWG    FJDHWG           Trailer IN Weig
     C                     Z-ADD#1DIWG    FJDIWG           Trailer OUT Wei
     C                     Z-ADD#1AQDT    FJAQDT           Actual Departur
     C                     Z-ADD#1S6NB    FJS6NB           Departure Time
     C                     Z-ADD#1T4NB    FJT4NB           Schedule Sequen
     C                     Z-ADD#1PRTM    FJPRTM           Product Tempera
     C                     Z-ADD#1NPSV    FJNPSV           Number Spacers
     C                     MOVEL#1J8TX    FJJ8TX    P      Car/Veh. Initia
     C                     Z-ADD#1TLMI    FJTLMI           Total Load Mile
     C                     MOVEL#1J9TX    FJJ9TX    P      Recorder ID
     C                     MOVEL#1VPCD    FJVPCD    P      Ship From Wareh
     C                     MOVEL#1DBCD    FJDBCD    P      Ship To State C
     C                     Z-ADD#1GRWE    FJGRWE           Gross Weight
     C                     MOVEL#1BZNA    FJXCCD    P      Carrier Broker
     C                     MOVEL#1U2ST    FJU2ST    P      Export Status
     C                     Z-ADD#1F9DT    FJF9DT           Actual Ship Dat
     C                     MOVEL#1ONTM    FJONTM    P      On Time - (Y/N)
     C                     Z-ADD#1J4DT    FJJ4DT           Truck Ready Dat
     C                     Z-ADD#1TRTM    FJTRTM           Truck Ready Tim
     C                     Z-ADD#1J5DT    FJJ5DT           Spotted Date
     C                     Z-ADD#1SPTM    FJSPTM           Spotted Time
     C                     Z-ADD#1J6DT    FJJ6DT           Load Finished D
     C                     Z-ADD#1LFTM    FJLFTM           Load Finished T
     C                     Z-ADD#1J7DT    FJJ7DT           BOL Complete Da
     C                     Z-ADD#1BOTM    FJBOTM           BOL Complete Ti
     C                     Z-ADD#1J8DT    FJJ8DT           BOL Received Da
     C                     Z-ADD#1BLTM    FJBLTM           BOL Received Ti
     C                     Z-ADD#1KIDT    FJKIDT           Truck Departure
     C                     Z-ADD#1ASTM    FJASTM           Truck Departure
     C                     Z-ADD#1KADT    FJKADT           Adjusted Depart
     C                     Z-ADD#1AJCM    FJAJCM           Adjusted Depart
     C                     Z-ADD#1KCDT    FJKCDT           Date In
     C                     Z-ADD#1TMIN    FJTMIN           Time In
     C                     Z-ADD#1KDDT    FJKDDT           Date Out
     C                     Z-ADD#1VMNB    FJVMNB           Time Out
     C                     Z-ADD#1OCFR    FJOCFR           Load Total Frei
     C                     Z-ADD#1KJDT    FJKJDT           Scheduled Deliv
     C                     MOVEL#1OTRS    FJOTRS    P      LH Unused Sts
     C                     MOVEL#1RNST    FJRNST    P      LH Carrier Paym
     C                     Z-ADD#1BRBK    FJBRBK           Bring Back Mile
     C                     Z-ADD#1EIDT    FJEIDT           Requested Deliv
     C                     MOVEL#1RMST    FJRMST    P      Load Acceptance
     C                     MOVEL#1AJCD    FJAJCD    P      Warehouse Code
     C                     Z-ADD#1KKDT    FJKKDT           On Yard Date
     C                     Z-ADD#1AVTM    FJAVTM           On Yard Time
     C                     Z-ADD#1KZDT    FJKZDT           Deadline Depart
     C                     Z-ADD#1AXTM    FJAXTM           Deadline Depart
     C                     MOVEL#1LHOS    FJLHOS    P      Load Held Over
     C                     MOVEL#1LHOR    FJLHOR    P      Load Held Over
     C                     MOVEL#1WNTX    FJWNTX    P      Load Held Over
     C                     MOVEL#1OITX    FJOITX    P      Ocean BOL Numbe
     C                     MOVEL#1OJTX    FJOJTX    P      Express Mail Nu
     C                     Z-ADD#1LLDT    FJLLDT           Express Mail Da
     C                     MOVEL#1LSHG    FJLSHG    P      Load Shag Flag
     C                     MOVEL#1YPST    FJYPST    P      Load Wash Flag
     C                     Z-ADD#1K0DT    FJK0DT           Product Complet
     C                     Z-ADD#1AYTM    FJAYTM           Product Complet
     C                     Z-ADD#1KNNX    FJKNNX           Pallets Loaded
     C                     Z-ADD#1ICWG    FJICWG           Avg Pallet Tare
     C                     Z-ADD#1IDWG    FJIDWG           Tot Pallet Tare
     C                     MOVEL#1H9SX    FJH9SX    P      Load Confirmed
     C                     MOVEL#1WOTX    FJWOTX    P      Load Confirmed
     C                     Z-ADD#1K1DT    FJK1DT           Load Confirmati
     C                     Z-ADD#1AZTM    FJAZTM           Load Door 1
     C                     Z-ADD#1K2DT    FJK2DT           Override Total
     C                     Z-ADD#1A0TM    FJA0TM           Load Door 2
     C                     MOVEL#1ROST    FJROST    P      Partial Load
     C                     MOVEL#1RPST    FJRPST    P      Load Confirmati
     C                     MOVEL#1RQST    FJRQST    P      Export Load USD
     C                     MOVEL#1RRST    FJRRST    P      Late Delivery E
     C                     Z-ADD#1ZBVA    FJZBVA           Load Actual Fre
     C                     MOVEL#1WPTX    FJWPTX    P      Hide on WW Load
     C                     MOVEL#1WQTX    FJWQTX    P      Late Billing Em
     C                     MOVEL#1WRTX    FJWRTX    P      Shipping Temp C
     C                     MOVEL#1WSTX    FJWSTX    P      LH Held Over Rs
     C                     MOVEL#1RVSX    FJRVSX    P      Multi Company L
     C                     MOVEL#1RUSX    FJRUSX    P      Fax Sent to SSI
     C                     MOVEL#1RWSX    FJRWSX    P      Schedule Pos Lo
     C                     MOVEL#1RXSX    FJRXSX    P      LH Power Only L
     C                     MOVEL#1RYSX    FJRYSX    P      MG Created Load
     C                     MOVEL#1RZSX    FJRZSX    P      LH Unused Sts 5
     C                     MOVEL#1R0SX    FJR0SX    P      Load U/M
     C                     MOVEL#1R1SX    FJR1SX    P      TPM Shipment St
     C                     MOVEL#1R2SX    FJR2SX    P      LH Unused Sts 8
     C                     MOVEL#1R3SX    FJR3SX    P      LH On-Time Reas
     C                     MOVEL#1R4SX    FJR4SX    P      LH Held Over Re
     C                     Z-ADD#1PYDT    FJPYDT           LH Carrier Paid
     C                     Z-ADD#1CKTM    FJCKTM           LH Carrier Paid
     C                     Z-ADD#1PZDT    FJPZDT           LH Last Combo P
     C                     Z-ADD#1CLTM    FJCLTM           LH Last Combo P
     C                     Z-ADD#1P0DT    FJP0DT           LPT Load Plan S
     C                     Z-ADD#1CMTM    FJCMTM           LPT Load Plan S
     C                     Z-ADD#1P1DT    FJP1DT           TPM Planned Shi
     C                     Z-ADD#1CNTM    FJCNTM           LH Unused Time
     C                     Z-ADD#1P2DT    FJP2DT           LH Unused Date
     C                     Z-ADD#1COTM    FJCOTM           LH Unused Time
     C                     Z-ADD#1P3DT    FJP3DT           LH Unused Date
     C                     Z-ADD#1CQTM    FJCQTM           LH Unused Time
     C                     MOVEL#1UVST    FJUVST    P      EDI Status 1
     C                     MOVEL#1UWST    FJUWST    P      EDI Status 2
     C                     MOVEL#1UXST    FJUXST    P      EDI Status 3
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     FJAATM           Job Time
     C                     MOVEL##USR     FJAYNA           User Id
     C                     MOVEL##JOB     FJA0NA           Job Name
     C                     Z-ADD##JDT     FJAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * Move @FJCPBO fields back
     C                     MOVELFJXCCD    #1BZNA           Carrier Broker
      *
      * DBF change successful
      * USER: Processing after Data update
      * R15161 DN 07/17/19-Replaced Voyage with OHE Voyage/Flight &
      *   Booking Number with OHE Booking Number.
      * RTV Chg Bkg by Load    RT - Order Header Extension  * 
     C                     EXSR SNRVGN
      * CASE: PAR.Carrier Code NE PAR.Carrier Code Usr
     C           #1BZNA    IFNE #RH8AA                     *IF
     C                     MOVEL*BLANK    YL0030           Load Confirmati
     C                     MOVEL*BLANK    YL0031           Load Confirmed
     C                     Z-ADD0         YL0032           Load Confirmati
     C                     MOVEL*BLANK    YL0033           Load Confirmed
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#1RPST    YL0030           Load Confirmati
     C                     MOVEL#1WOTX    YL0031           Load Confirmed
     C                     Z-ADD#1K1DT    YL0032           Load Confirmati
     C                     MOVEL#1H9SX    YL0033           Load Confirmed
     C                     END                             *FI
      * ** Re-Calculate the total load miles using the updated sail port
      * ** city. Update the load header.
      * ** Total Load Miles will be zeros if any leg of the journey
      * ** is missing a Miles Between Cities record.
      * ** Include Override Total Load Miles. If entered, they will
      * ** take precedence
      * CLC Total Load Miles   XF - Load Detail  * 
     C                     CLEARPBRC
     C                     Z-ADD#1RMNB    PBRMNB           Load ID
      *
     C                     CALL 'PDW3XFR'              90  CLC Total Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Load Detai
     C           WUTLMI    PARM WUTLMI    WQ0001  70       Total Load Mile
     C           WUK2DT    PARM WUK2DT    WQ0002  70       Override Total
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CHG Total Load Miles   XF - Load Header  * 
     C                     CALL 'PMFSXFR'              90  CHG Total Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0003  70       Load ID
     C                     PARM WUTLMI    WQ0004  70       Total Load Mile
     C                     PARM WUK2DT    WQ0005  70       Override Total
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMFSXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CLC Deadline Date/Time XF - Load Detail  * 
     C                     CALL 'PMP9XFR'              90  CLC Deadline Da
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0006  70       Load ID
     C           YL0034    PARM YL0034    WQ0007  70       Deadline Depart
     C           YL0035    PARM *ZERO     WQ0008  60       Deadline Depart
     C           YL0036    PARM *ZERO     WQ0009  70       Requested Deliv
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMP9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CHG Deadline Dep D/T   CH - Load Header  * 
     C                     EXSR SPCHRC
      * CHG Deadline Date/Time RT - Load Detail  * 
     C                     EXSR SQRVGN
      * ** Fax load confirmation to Ship Line &/or Carrier, if entered
      * ** Only fax confirmation if Carrier is assigned to the load
      * CASE: PAR.Carrier Code is entered
     C           #1BZNA    IFNE *BLANK                     *IF
      * If carrier broker is blank, default broker
      * CASE: PAR.Carrier Broker is not entered
     C           #1BZNA    IFEQ *BLANK                     *IF
     C                     MOVEL#1BZNA    #1BZNA           Carrier Broker
     C                     END                             *FI
      * Update order header with changed carrier, flag to fax booking con
      * CASE: PAR.Carrier Code Usr NE PAR.Carrier Code
     C           #RH8AA    IFNE #1BZNA                     *IF
      * Chg Carrier           RT - Order Header TRG  * 
     C                     EXSR SURVGN
     C                     END                             *FI
      * ** wrk.status-Y or N is to control faxing to PowerPro in the
      * ** case of a carrier change.
     C                     MOVEL'Y'       WUB8ST           Status - Y or N
     C                     MOVEL##JOB     WUB2VN           Job Name CDE
      * PMT Fax Load Confirmtn PV - Load Header  * 
     C                     CALL 'POICPVR'              90  PMT Fax Load Co
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0010  70       Load ID
     C                     PARM WN0002    WQ0011  30       Company Number
     C                     PARM #1DYTX    WQ0012  3        Transloader Car
     C                     PARM #1BZNA    WQ0013  3        Carrier Code
     C                     PARM #CXACD    WQ0014  3        Shipping Line
     C                     PARM WUC2TX    WQ0015  4        OHE Carrier SCA
     C           WUB8ST    PARM WUB8ST    WQ0016  1        Status - Y or N
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POICPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9832  *
     C                     END
      * * Carrier Code = original carrier, Carrier Code usr = rcd.cc (cha
      * ** If Fax to Carrier is "Y" then check SSI/PowerPro also
      * CASE: WRK.Status - Y or N is yes
     C           WUB8ST    IFEQ 'Y'                        *IF
      * ** Only send to SSI if SSI download flag is set to Yes
      * RTV SSI Carrier flag   RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1BZNA    WL0123    P      Carrier Code
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0124    WUUNUS    P      SSI Download Fl
      * ** Handle deletes for SSI Carriers
      * CASE: WRK.SSI Download Flag is Yes, Download to SSI
     C           WUUNUS    IFEQ 'Y'                        *IF
      * RTV SSI Fax'd Flag     RT - Load Header  * 
     C                     EXSR SXRVGN
      * ** Carrier is new or changed to SBD
      * CASE: WRK.Fax Sent to SSI Carrier is Not Fax'd to Carrier
     C           WURUSX    IFEQ *BLANK                     *IF
     C           WURUSX    OREQ 'N'
     C                     MOVEL'00'      WUAHST           SSI Add, Chg, D
      * BLD SSI Download       XF - SSI Control  * 
     C                     CALL 'PNPNXFR'              90  BLD SSI Downloa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0017  70       Load ID
     C                     PARM #1BZNA    WQ0018  3        Carrier Code
     C                     PARM WUAHST    WQ0019  2        SSI Add, Chg, D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNPNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9832  *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'04'      WUAHST           SSI Add, Chg, D
      * BLD SSI Download       XF - SSI Control  * 
     C                     CALL 'PNPNXFR'              90  BLD SSI Downloa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0020  70       Load ID
     C                     PARM #1BZNA    WQ0021  3        Carrier Code
     C                     PARM WUAHST    WQ0022  2        SSI Add, Chg, D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNPNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9832  *
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : WRK.SSI Download Flag is No
      *   |- c2    : WRK.SSI Download Flag is Not Entered
      *   '-
     C           WUUNUS    IFEQ 'N'                        *IF
     C           WUUNUS    OREQ *BLANK                     *OR
      * ** If old carrier is SBD, send a delete record to SSI
      * ** New/Changes for SBD will be sent from the Accept Screen
      * RTV SSI Carrier flag   RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#RH8AA    WL0123    P      Carrier Code
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0124    WUUNUS    P      SSI Download Fl
      * ** Only send to SSI if SSI download flag is set to Yes
      * CASE: WRK.SSI Download Flag is Yes, Download to SSI
     C           WUUNUS    IFEQ 'Y'                        *IF
      * ** Only send "Delete" record if a fax was previously sent
      * CASE: WRK.Fax Sent to SSI Carrier is Yes, Fax'd to Carrier
     C           WURUSX    IFEQ 'Y'                        *IF
      * ** Carrier was changed from SBD to someone else
     C                     MOVEL'01'      WUAHST           SSI Add, Chg, D
      * BLD SSI Download       XF - SSI Control  * 
     C                     CALL 'PNPNXFR'              90  BLD SSI Downloa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0023  70       Load ID
     C                     PARM #RH8AA    WQ0024  3        Carrier Code
     C                     PARM WUAHST    WQ0025  2        SSI Add, Chg, D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNPNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Update the original Assigned trailer if load has been re-assigned
      * CASE:
      *  - (c1 AND c2) OR c3
      *   |- c1    : PAR.Container Number usr 1 NE PAR.Trailer Id
      *   |- c2    : PAR.Container Number usr 1 NE WRK.Blank for 12
      *   |- c3    : PAR.Carrier Code NE PAR.Carrier Code Usr
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #RBDU1    IFNE #1DXTX                     *IF
     C           #RBDU1    IFNE WUS3TX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           #1BZNA    IFNE #RH8AA                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * IF trailer was changed, update original to Assigned = N
      * Rtv/Chg Orig Trailer   RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#RH8AA    WL0125    P      Carrier Code
     C                     MOVEL#1DXTX    WL0126    P      Trailer Id
     C                     MOVEL'N'       WL0127    P      Assigned Status
     C                     MOVEL'Y'       WL0128    P      Available Statu
     C                     EXSR SYRVGN
     C                     END                             *FI
      * Update the (new/changed) Trailer/Container if assigned
      * CASE: PAR.Container Number usr 1 NE WRK.Blank for 12          USR
     C           #RBDU1    IFNE WUS3TX                     *IF
      * Rtv/Chg Orig Trailer   RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1BZNA    WL0125    P      Carrier Code
     C                     MOVEL#RBDU1    WL0126    P      Trailer Id
     C                     MOVEL'Y'       WL0127    P      Assigned Status
     C                     MOVEL'N'       WL0128    P      Available Statu
     C                     EXSR SYRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Chg Bkg by Load    RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN AMRMNB    WQSN01           Load ID
      * Define keylist
     C           KPSSN     KLIST
     C                     KFLD           WQSN01           Load ID
     C                     KFLD           AMC4NB           Order Number
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSN01           Load ID
     C                     Z-ADD1         AMC4NB           Order Number
      * Establish starting position
     C           KPSSN     SETLL@AMREJM                    *
     C           KRSSN     READE@AMREJM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Update export order header extension record
      * CASE: DB1.Load ID EQ PAR.Load ID
     C           AMRMNB    IFEQ #1RMNB                     *IF
      * R15161 DN 07/17/19-Replaced Booking Number w/ OHE Booking Number.
      * Update booking # from # entered on the screen, including blanks
      * CASE: DB1.OHE Booking Number NE PAR.OHE Booking Number
     C           AMJ1T1    IFNE #RM4U1                     *IF
     C                     MOVEL#RM4U1    YL0028           OHE Booking Num
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELAMJ1T1    YL0028           OHE Booking Num
     C                     END                             *FI
      * Update container # from # entered on the screen, including blanks
      * CASE: DB1.OHE Container Number NE PAR.Container Number
     C           AMJ2T1    IFNE #RBDU1                     *IF
     C                     MOVEL#RBDU1    YL0029           OHE Container N
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELAMJ2T1    YL0029           OHE Container N
     C                     END                             *FI
      * R15161 DN 07/17/19-Replaced Voyage with OHE Voyage/Flight.
      * CHG Existing OHE       CH - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDAMAIC3    WL0028           Company Number
     C                     Z-ADDAMC4NB    WL0029           Order Number
     C                     Z-ADD#1RMNB    WL0030           Load ID
     C                     Z-ADDAMRUNB    WL0031           Stop/Drop Seque
     C                     MOVEL#CXACD    WL0032    P      Shipping Line
     C                     MOVEL#CAWAA    WL0033    P      Port Delv Termi
     C                     MOVEL#CHBAA    WL0034    P      OHE City
     C                     MOVEL#CJ0T1    WL0035    P      OHE Vessel/Airl
     C                     MOVEL#CGENY    WL0036    P      OHE Voyage/Flig
     C                     MOVELYL0028    WL0037    P      OHE Booking Num
     C                     MOVEL#CHCAA    WL0038    P      OHE Discharge P
     C                     Z-ADDP2QWDT    WL0039           OHE Sail/Flight
     C                     Z-ADDAMQXDT    WL0040           OHE Port Cut Da
     C                     Z-ADDP2QYDT    WL0041           OHE Arrival Dat
     C                     MOVELAMHDAA    WL0042    P      OHE Late Delive
     C                     MOVEL#1VCST    WL0043    P      OHE Ship Status
     C                     MOVELYL0029    WL0044    P      OHE Container N
     C                     MOVELAMRLNA    WL0045    P      OHE Comment 1
     C                     MOVELAMRMNA    WL0046    P      OHE Comment 2
     C                     Z-ADDAMGINY    WL0047           OHE Unused Numb
     C                     Z-ADDAMGFNY    WL0048           OHE Unused Numb
     C                     Z-ADDAMGGNY    WL0049           OHE Unused Numb
     C                     Z-ADDAMGHNY    WL0050           OHE Unused Numb
     C                     Z-ADDAMHEVL    WL0051           OHE HPB RIN Equ
     C                     Z-ADDAMHFVL    WL0052           OHE HPB RIN Pri
     C                     Z-ADDAMHGVL    WL0053           Transload Termi
     C                     Z-ADDAMQZDT    WL0054           OHE Est Arrv at
     C                     Z-ADDAMQ0DT    WL0055           OHE Backhaul ET
     C                     Z-ADDAMQ1DT    WL0056           OHE Port/Pier P
     C                     Z-ADDAMQ2DT    WL0057           OHE Actual Ship
     C                     MOVELAMC2TX    WL0058    P      OHE Carrier SCA
     C                     MOVELAMC3TX    WL0059    P      OHE Spot Buy
     C                     MOVELAMC6TX    WL0060    P      OHE PO ACK Flag
     C                     MOVELAMCHTX    WL0061    P      OHE Override Ty
     C                     MOVELAMCITX    WL0062    P      OHE Backhaul St
     C                     MOVELAMCLTX    WL0063    P      OHE Backhaul ET
     C                     MOVEL#CB4TX    WL0064    P      OHE Load Haul T
     C                     MOVELAMCUTX    WL0065    P      OHE Backhaul Ca
     C                     MOVELAMCVTX    WL0066    P      OHE Bookings Co
     C                     MOVELAMB9TX    WL0067    P      OHE EDI Error R
     C                     MOVELAMJWSC    WL0068    P      OHE EDI Error R
     C                     Z-ADDAMITNY    WL0069           HPB COA Batch N
     C                     MOVELAMLMT1    WL0070    P      Delivery P.O. N
     C                     MOVELAMLWAA    WL0071    P      OHE Intended fo
     C                     MOVELAMFVST    WL0072    P      OHE EDI 943 Act
     C                     MOVELAMF0ST    WL0073    P      OHE EDI 944 Act
     C                     MOVELAMF2ST    WL0074    P      OHE EDI 940 Act
     C                     MOVELAMF3ST    WL0075    P      OHE EDI 945 Act
     C                     MOVELAMJUSC    WL0076    P      OHE EDI 856 Act
     C                     MOVELAMJVSC    WL0077    P      OHE EDI 824 Act
     C                     MOVELAMV3T1    WL0078    P      OHE Transload S
     C                     MOVELAMV4T1    WL0079    P      OHE Abs Rate Ov
     C                     MOVELAMV5T1    WL0080    P      OHE Appt Confir
     C                     MOVELAMV6T1    WL0081    P      OHE Backhaul Co
     C                     MOVELAMV7T1    WL0082    P      OHE Backhaul Ch
     C                     MOVELAMV8T1    WL0083    P      OHE Transload C
     C                     MOVELAMV9T1    WL0084    P      OHE Pier Pass I
     C                     MOVELAMWAT1    WL0085    P      OHE Carrier Nm
     C                     MOVELAMWBT1    WL0086    P      OHE Appt Confir
     C                     MOVELAMWCT1    WL0087    P      OHE Backhaul Co
     C                     MOVELAMWDT1    WL0088    P      Letter of Credi
     C                     Z-ADDAMQJNY    WL0089           OHE Backhaul Re
     C                     Z-ADDAMQKNY    WL0090           LD Stop/Drop
     C                     Z-ADDAMQLNY    WL0091           OHE Unused Numb
     C                     Z-ADDAMP8NY    WL0092           OHE Pier Pass F
     C                     Z-ADDAMP9NY    WL0093           OHE Port Check
     C                     Z-ADDAMQANY    WL0094           OHE Port Cut Ti
     C                     Z-ADDAMQCNY    WL0095           OHE Backhaul Tr
     C                     Z-ADDAMQDNY    WL0096           OHE Load Sched
     C                     Z-ADDAMQENY    WL0097           Original Appoin
     C                     Z-ADDAMQFNY    WL0098           Original Appoin
     C                     Z-ADDAMQGNY    WL0099           OHE PowerPro Lo
     C                     Z-ADDAMQHNY    WL0100           OHE PowerPro Lo
     C                     Z-ADDAMQINY    WL0101           OHE Unused Nume
     C                     Z-ADDAMQMNY    WL0102           OHE Orig ABS Fr
     C                     MOVELAMMYU1    WL0103    P      OHE Genset Numb
     C                     MOVELAMJXSC    WL0104    P      OHE Unused Stat
     C                     MOVELAMJYSC    WL0105    P      OHE Unused Stat
     C                     MOVELAMJZSC    WL0106    P      OHE Unused Stat
     C                     MOVELAMJ0SC    WL0107    P      OHE Unused Stat
     C                     MOVELAMMZU1    WL0108    P      OHE Unused Text
     C                     MOVELAMM0U1    WL0109    P      OHE Unused Text
     C                     MOVELAMM1U1    WL0110    P      OHE Unused Text
     C                     MOVELAMM2U1    WL0111    P      OHE Unused Text
     C                     MOVELAMM3U1    WL0112    P      OHE Unused Text
     C                     Z-ADDAMW5DT    WL0113           OHE Unused Date
     C                     Z-ADDAMW6DT    WL0114           OHE Unused Date
     C                     MOVELAMUVST    WL0115    P      EDI Status 1
     C                     MOVELAMUWST    WL0116    P      EDI Status 2
     C                     MOVELAMUXST    WL0117    P      EDI Status 3
     C                     MOVELAMVSST    WL0118    P      Record Status
     C                     Z-ADDAMAATM    WL0119           Job Time
     C                     MOVELAMAYNA    WL0120    P      User Id
     C                     MOVELAMA0NA    WL0121    P      Job Name
     C                     Z-ADDAMAXDT    WL0122           Job Date
     C                     EXSR SOCHRC
     C                     END                             *FI
     C           KRSSN     READE@AMREJM                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCHRC    BEGSR
      *================================================================
      * CHG Existing OHE       CH - Order Header Extension  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @AMREJE
     C                     Z-ADDWL0028    WDAIC3           Company Number
     C                     Z-ADDWL0029    WDC4NB           Order Number
      *
     C           KLCHSO    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
     C           KLCHSO    CHAIN@AMREJE              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C           W0RTN     IFNE *BLANK                     IF
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PMAMREL0'MDACP
     C                     MOVEL'@AMREJE' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     ENDIF
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPMAM1    YBRDCS
      * Move non-key fields to @AMREJE
     C                     Z-ADDWL0030    WDRMNB           Load ID
     C                     Z-ADDWL0031    WDRUNB           Stop/Drop Seque
     C                     MOVELWL0032    WDXACD    P      Shipping Line
     C                     MOVELWL0033    WDOANA    P      Port Delv Termi
     C                     MOVELWL0034    WDHBAA    P      OHE City
     C                     MOVELWL0035    WDJ0T1    P      OHE Vessel/Airl
     C                     MOVELWL0036    WDGENY    P      OHE Voyage/Flig
     C                     MOVELWL0037    WDJ1T1    P      OHE Booking Num
     C                     MOVELWL0038    WDHCAA    P      OHE Discharge P
     C                     Z-ADDWL0039    WDQWDT           OHE Sail/Flight
     C                     Z-ADDWL0040    WDQXDT           OHE Port Cut Da
     C                     Z-ADDWL0041    WDQYDT           OHE Arrival Dat
     C                     MOVELWL0042    WDHDAA    P      OHE Late Delive
     C                     MOVELWL0043    WDCCTX    P      OHE Ship Status
     C                     MOVELWL0044    WDJ2T1    P      OHE Container N
     C                     MOVELWL0045    WDRLNA    P      OHE Comment 1
     C                     MOVELWL0046    WDRMNA    P      OHE Comment 2
     C                     Z-ADDWL0047    WDGINY           OHE Unused Numb
     C                     Z-ADDWL0048    WDGFNY           OHE Unused Numb
     C                     Z-ADDWL0049    WDGGNY           OHE Unused Numb
     C                     Z-ADDWL0050    WDGHNY           OHE Unused Numb
     C                     Z-ADDWL0051    WDHEVL           OHE HPB RIN Equ
     C                     Z-ADDWL0052    WDHFVL           OHE HPB RIN Pri
     C                     Z-ADDWL0053    WDHGVL           Transload Termi
     C                     Z-ADDWL0054    WDQZDT           OHE Est Arrv at
     C                     Z-ADDWL0055    WDQ0DT           OHE Backhaul ET
     C                     Z-ADDWL0056    WDQ1DT           OHE Port/Pier P
     C                     Z-ADDWL0057    WDQ2DT           OHE Actual Ship
     C                     MOVELWL0058    WDC2TX    P      OHE Carrier SCA
     C                     MOVELWL0059    WDC3TX    P      OHE Spot Buy
     C                     MOVELWL0060    WDC6TX    P      OHE PO ACK Flag
     C                     MOVELWL0061    WDCHTX    P      OHE Override Ty
     C                     MOVELWL0062    WDCITX    P      OHE Backhaul St
     C                     MOVELWL0063    WDCLTX    P      OHE Backhaul ET
     C                     MOVELWL0064    WDB4TX    P      OHE Load Haul T
     C                     MOVELWL0065    WDCUTX    P      OHE Backhaul Ca
     C                     MOVELWL0066    WDCVTX    P      OHE Bookings Co
     C                     MOVELWL0067    WDB9TX    P      OHE EDI Error R
     C                     MOVELWL0068    WDJWSC    P      OHE EDI Error R
     C                     Z-ADDWL0069    WDITNY           HPB COA Batch N
     C                     MOVELWL0070    WDLMT1    P      Delivery P.O. N
     C                     MOVELWL0071    WDLWAA    P      OHE Intended fo
     C                     MOVELWL0072    WDFVST    P      OHE EDI 943 Act
     C                     MOVELWL0073    WDF0ST    P      OHE EDI 944 Act
     C                     MOVELWL0074    WDF2ST    P      OHE EDI 940 Act
     C                     MOVELWL0075    WDF3ST    P      OHE EDI 945 Act
     C                     MOVELWL0076    WDJUSC    P      OHE EDI 856 Act
     C                     MOVELWL0077    WDJVSC    P      OHE EDI 824 Act
     C                     MOVELWL0078    WDV3T1    P      OHE Transload S
     C                     MOVELWL0079    WDV4T1    P      OHE Abs Rate Ov
     C                     MOVELWL0080    WDV5T1    P      OHE Appt Confir
     C                     MOVELWL0081    WDV6T1    P      OHE Backhaul Co
     C                     MOVELWL0082    WDV7T1    P      OHE Backhaul Ch
     C                     MOVELWL0083    WDV8T1    P      OHE Transload C
     C                     MOVELWL0084    WDV9T1    P      OHE Pier Pass I
     C                     MOVELWL0085    WDWAT1    P      OHE Carrier Nm
     C                     MOVELWL0086    WDWBT1    P      OHE Appt Confir
     C                     MOVELWL0087    WDWCT1    P      OHE Backhaul Co
     C                     MOVELWL0088    WDWDT1    P      Letter of Credi
     C                     Z-ADDWL0089    WDQJNY           OHE Backhaul Re
     C                     Z-ADDWL0090    WDQKNY           LD Stop/Drop
     C                     Z-ADDWL0091    WDQLNY           OHE Unused Numb
     C                     Z-ADDWL0092    WDP8NY           OHE Pier Pass F
     C                     Z-ADDWL0093    WDP9NY           OHE Port Check
     C                     Z-ADDWL0094    WDQANY           OHE Port Cut Ti
     C                     Z-ADDWL0095    WDQCNY           OHE Backhaul Tr
     C                     Z-ADDWL0096    WDQDNY           OHE Load Sched
     C                     Z-ADDWL0097    WDQENY           Original Appoin
     C                     Z-ADDWL0098    WDQFNY           Original Appoin
     C                     Z-ADDWL0099    WDQGNY           OHE PowerPro Lo
     C                     Z-ADDWL0100    WDQHNY           OHE PowerPro Lo
     C                     Z-ADDWL0101    WDQINY           OHE Unused Nume
     C                     Z-ADDWL0102    WDQMNY           OHE Orig ABS Fr
     C                     MOVELWL0103    WDMYU1    P      OHE Genset Numb
     C                     MOVELWL0104    WDJXSC    P      OHE Unused Stat
     C                     MOVELWL0105    WDJYSC    P      OHE Unused Stat
     C                     MOVELWL0106    WDJZSC    P      OHE Unused Stat
     C                     MOVELWL0107    WDJ0SC    P      OHE Unused Stat
     C                     MOVELWL0108    WDMZU1    P      OHE Unused Text
     C                     MOVELWL0109    WDM0U1    P      OHE Unused Text
     C                     MOVELWL0110    WDM1U1    P      OHE Unused Text
     C                     MOVELWL0111    WDM2U1    P      OHE Unused Text
     C                     MOVELWL0112    WDM3U1    P      OHE Unused Text
     C                     Z-ADDWL0113    WDW5DT           OHE Unused Date
     C                     Z-ADDWL0114    WDW6DT           OHE Unused Date
     C                     MOVELWL0115    WDUVST    P      EDI Status 1
     C                     MOVELWL0116    WDUWST    P      EDI Status 2
     C                     MOVELWL0117    WDUXST    P      EDI Status 3
     C                     MOVELWL0118    WDVSST    P      Record Status
     C                     Z-ADDWL0119    WDAATM           Job Time
     C                     MOVELWL0120    WDAYNA    P      User Id
     C                     MOVELWL0121    WDA0NA    P      Job Name
     C                     Z-ADDWL0122    WDAXDT           Job Date
      *
      * Set PGM.*Record Data Changed flag
     C           QPMAM1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     Z-ADD##JDT     WDAXDT           Job Date
     C                     MOVEL##PGM     WDA0NA           Job Name
     C                     MOVEL##USR     WDAYNA           User Id
      * Set PGM.*Record Data Changed flag
     C           QPMAM1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@AMREJE                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPMAMREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCHRC    BEGSR
      *================================================================
      * CHG Deadline Dep D/T   CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0020  30       Company Number
     C                     Z-ADD*ZERO     WN0021  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0022  1        LTL Flag
     C                     MOVEL*BLANK    WN0023  1        Load Status
     C                     Z-ADD*ZERO     WN0024  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0025 15        Seal 1
     C                     MOVEL*BLANK    WN0026 15        Seal 2
     C                     MOVEL*BLANK    WN0027 15        Seal 3
     C                     MOVEL*BLANK    WN0028 15        Seal 4
     C                     MOVEL*BLANK    WN0029 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0030  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0031 112       Flat Amount
     C                     MOVEL*BLANK    WN0032  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0033  50       Total Stops
     C                     MOVEL*BLANK    WN0034 20        Trailer Id
     C                     MOVEL*BLANK    WN0035  3        Transloader Car
     C                     Z-ADD*ZERO     WN0036  40       BOL Time
     C                     MOVEL*BLANK    WN0037  3        Carrier Code
     C                     MOVEL*BLANK    WN0038  7        Truck Size
     C                     Z-ADD*ZERO     WN0039  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0040 112       Rated Freight
     C                     MOVEL*BLANK    WN0041  1        Ship Status
     C                     MOVEL*BLANK    WN0042  1        Load Type
     C                     Z-ADD*ZERO     WN0043  50       Number Pallets
     C                     Z-ADD*ZERO     WN0044  50       Number Pallets
     C                     Z-ADD*ZERO     WN0045 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0046  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0047  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0048  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0049 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0050 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0051  70       Actual Departur
     C                     Z-ADD*ZERO     WN0052  40       Departure Time
     C                     Z-ADD*ZERO     WN0053  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0054  52       Product Tempera
     C                     Z-ADD*ZERO     WN0055  50       Number Spacers
     C                     MOVEL*BLANK    WN0056 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0057  70       Total Load Mile
     C                     MOVEL*BLANK    WN0058 12        Recorder ID
     C                     MOVEL*BLANK    WN0059  2        Shipping Method
     C                     MOVEL*BLANK    WN0060  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0061  2        Ship To State C
     C                     Z-ADD*ZERO     WN0062  70       Gross Weight
     C                     MOVEL*BLANK    WN0063  3        Carrier Broker
     C                     MOVEL*BLANK    WN0064  1        Export Status
     C                     Z-ADD*ZERO     WN0065  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0066  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0067  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0068  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0069  70       Spotted Date
     C                     Z-ADD*ZERO     WN0070  60       Spotted Time
     C                     Z-ADD*ZERO     WN0071  70       Load Finished D
     C                     Z-ADD*ZERO     WN0072  60       Load Finished T
     C                     Z-ADD*ZERO     WN0073  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0074  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0075  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0076  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0077  70       Truck Departure
     C                     Z-ADD*ZERO     WN0078  60       Truck Departure
     C                     Z-ADD*ZERO     WN0079  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0080  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0081  3        Shipping Line
     C                     MOVEL*BLANK    WN0082 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0083 30        Vessel Name
     C                     Z-ADD*ZERO     WN0084  50       Voyage
     C                     Z-ADD*ZERO     WN0085  70       Sail Date
     C                     MOVEL*BLANK    WN0086 12        Booking Number
     C                     MOVEL*BLANK    WN0087 20        Discharge Port
     C                     Z-ADD*ZERO     WN0088  70       Arrival Date
     C                     MOVEL*BLANK    WN0089 12        Container Numbe
     C                     Z-ADD*ZERO     WN0090  70       Date In
     C                     Z-ADD*ZERO     WN0091  60       Time In
     C                     Z-ADD*ZERO     WN0092  70       Date Out
     C                     Z-ADD*ZERO     WN0093  60       Time Out
     C                     Z-ADD*ZERO     WN0094 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0095  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0096  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0097  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0098  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0099  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0100  70       Requested Deliv
     C                     MOVEL*BLANK    WN0101  1        Load Acceptance
     C                     MOVEL*BLANK    WN0102  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0103  70       On Yard Date
     C                     Z-ADD*ZERO     WN0104  60       On Yard Time
     C                     MOVEL*BLANK    WN0105  1        Load Held Over
     C                     MOVEL*BLANK    WN0106  1        Load Held Over
     C                     MOVEL*BLANK    WN0107 15        Load Held Over
     C                     MOVEL*BLANK    WN0108 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0109 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0110  70       Express Mail Da
     C                     MOVEL*BLANK    WN0111  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0112  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0113  70       Product Complet
     C                     Z-ADD*ZERO     WN0114  60       Product Complet
     C                     Z-ADD*ZERO     WN0115  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0116  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0117  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0118  1        Load Confirmed
     C                     MOVEL*BLANK    WN0119 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0120  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0121  60       Load Door 1
     C                     Z-ADD*ZERO     WN0122  70       Override Total
     C                     Z-ADD*ZERO     WN0123  60       Load Door 2
     C                     MOVEL*BLANK    WN0124  1        Partial Load
     C                     MOVEL*BLANK    WN0125  1        Load Confirmati
     C                     MOVEL*BLANK    WN0126  1        Export Load USD
     C                     MOVEL*BLANK    WN0127  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0128 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0129 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0130 15        Late Billing Em
     C                     MOVEL*BLANK    WN0131 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0132 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0133  1        Multi Company L
     C                     MOVEL*BLANK    WN0134  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0135  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0136  1        LH Power Only L
     C                     MOVEL*BLANK    WN0137  1        MG Created Load
     C                     MOVEL*BLANK    WN0138  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0139  2        Load U/M
     C                     MOVEL*BLANK    WN0140  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0141  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0142  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0143  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0144  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0145  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0146  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0147  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0148  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0149  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0150  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0151  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0152  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0153  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0154  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0155  60       LH Unused Time
     C                     MOVEL*BLANK    WN0156  1        EDI Status 1
     C                     MOVEL*BLANK    WN0157  1        EDI Status 2
     C                     MOVEL*BLANK    WN0158  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0159  60       Job Time
     C                     MOVEL*BLANK    WN0160 10        User Id
     C                     MOVEL*BLANK    WN0161 10        Job Name
     C                     Z-ADD*ZERO     WN0162  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADD#1RMNB    FJRMNB           Load ID
      *
     C           KLCHSP    KLIST
     C                     KFLD           FJRMNB           Load ID
     C           KLCHSP    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE @1DBRC    YCRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDYL0034    FJKZDT           Deadline Depart
     C                     Z-ADDYL0035    FJAXTM           Deadline Depart
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     FJAATM           Job Time
     C                     MOVEL##USR     FJAYNA           User Id
     C                     MOVEL##JOB     FJA0NA           Job Name
     C                     Z-ADD##JDT     FJAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * CHG Deadline Date/Time RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQSQ01           Load ID
      * Define keylist
     C           KPSSQ     KLIST
     C                     KFLD           WQSQ01           Load ID
     C                     KFLD           FLRUNB           Stop/Drop Seque
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSQ01           Load ID
     C                     Z-ADD0         FLRUNB           Stop/Drop Seque
      * Establish starting position
     C           KPSSQ     SETLL@FLCPBW                    *
     C           KRSSQ     READE@FLCPBW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SQEXIT                     *QUIT
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Deadline Date/Time CH - Load Detail  * 
     C                     EXSR SRCHRC
     C           KRSSQ     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRCHRC    BEGSR
      *================================================================
      * CHG Deadline Date/Time CH - Load Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0163  50       Stop/Drop
     C                     MOVEL*BLANK    WN0164 30        Comments for Pi
     C                     Z-ADD*ZERO     WN0165  50       Miles to next s
     C                     Z-ADD*ZERO     WN0166  72       Freight Charge
     C                     Z-ADD*ZERO     WN0167  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0168 112       Freight Misc. C
     C                     Z-ADD*ZERO     WN0169  72       Freight Stop Ch
     C                     Z-ADD*ZERO     WN0170 112       Rated Freight
     C                     Z-ADD*ZERO     WN0171  30       Company Number
     C                     Z-ADD*ZERO     WN0172  70       Order Number
     C                     MOVEL*BLANK    WN0173  1        Ship Status
     C                     Z-ADD*ZERO     WN0174  70       Estimated Arriv
     C                     Z-ADD*ZERO     WN0175  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0176  70       Appointment Con
     C                     Z-ADD*ZERO     WN0177  60       Appointment Con
     C                     MOVEL*BLANK    WN0178 30        Confirmation Ma
     C                     MOVEL*BLANK    WN0179 10        Confirmation Nu
     C                     Z-ADD*ZERO     WN0180  70       Actual Delivery
     C                     Z-ADD*ZERO     WN0181  60       Actual Delivery
     C                     Z-ADD*ZERO     WN0182  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0183  60       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0184  70       On Yard Date
     C                     Z-ADD*ZERO     WN0185  60       On Yard Time
     C                     Z-ADD*ZERO     WN0186  70       MPC Number
     C                     MOVEL*BLANK    WN0187  1        Load Dtl On Tim
     C                     MOVEL*BLANK    WN0188  1        On Time Add'l R
     C                     MOVEL*BLANK    WN0189 15        Seal Nbr 1
     C                     MOVEL*BLANK    WN0190 15        Seal Nbr 2
     C                     MOVEL*BLANK    WN0191 15        Seal Nbr 3
     C                     MOVEL*BLANK    WN0192 15        Seal Nbr 4
     C                     MOVEL*BLANK    WN0193 15        Seal Nbr 5
     C                     Z-ADD*ZERO     WN0194  70       LD Carrier Appt
     C                     Z-ADD*ZERO     WN0195  70       LD Unused Date
     C                     Z-ADD*ZERO     WN0196  70       LD Unused Date
     C                     Z-ADD*ZERO     WN0197  60       LD Carrier Appt
     C                     Z-ADD*ZERO     WN0198  60       LD Unused Time
     C                     Z-ADD*ZERO     WN0199  60       LD Unused Time
     C                     MOVEL*BLANK    WN0200  1        Miles Error Sts
     C                     MOVEL*BLANK    WN0201  1        LD Unused Sts 2
     C                     MOVEL*BLANK    WN0202  2        HPB Transload S
     C                     MOVEL*BLANK    WN0203 15        LD Cst Svc Trac
     C                     MOVEL*BLANK    WN0204 25        LD Unused Txt 2
     C                     MOVEL*BLANK    WN0205 25        LD Unused Txt 3
     C                     MOVEL*BLANK    WN0206  1        EDI Status 1
     C                     MOVEL*BLANK    WN0207  1        EDI Status 2
     C                     MOVEL*BLANK    WN0208  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0209  60       Job Time
     C                     MOVEL*BLANK    WN0210 10        User Id
     C                     MOVEL*BLANK    WN0211 10        Job Name
     C                     Z-ADD*ZERO     WN0212  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @FLCPBM
     C                     Z-ADD#1RMNB    WERMNB           Load ID
     C                     Z-ADDFLRUNB    WERUNB           Stop/Drop Seque
      *
     C           KLCHSR    KLIST
     C                     KFLD           WERMNB           Load ID
     C                     KFLD           WERUNB           Stop/Drop Seque
     C           KLCHSR    CHAIN@FLCPBM              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFLCPL0'MDACP
     C                     MOVEL'@FLCPBM' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFL1    YDRDCS
      * Move non-key fields to @FLCPBM
     C                     Z-ADDYL0034    WEHDDT           Deadline Depart
     C                     Z-ADDYL0035    WEAUTM           Deadline Depart
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##JOB     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@FLCPBM                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFLCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
      * Upd Deadline Dte/Tme  RT - Order Detail  * 
     C                     EXSR SSRVGN
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Upd Deadline Dte/Tme  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSS01           Company Number
     C           *LIKE     DEFN WFC4NB    WQSS02           Order Number
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           Company Number
     C                     KFLD           WQSS02           Order Number
      * Setup key
     C                     Z-ADDWEAIC3    WQSS01           Company Number
     C                     Z-ADDWEC4NB    WQSS02           Order Number
      * Establish starting position
     C           KRSSS     SETLL@BGWKL1                    *
     C           KRSSS     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Deadline Dte/Tme  CH - Order Detail  * 
     C                     EXSR STCHRC
     C           KRSSS     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STCHRC    BEGSR
      *================================================================
      * Chg Deadline Dte/Tme  CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0213  70       Item Code
     C                     MOVEL*BLANK    WN0214  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0215  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0216  70       Order Group Cod
     C                     MOVEL*BLANK    WN0217  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0218  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0219 112       Billing Detail
     C                     Z-ADD*ZERO     WN0220 112       Billing Detail
     C                     Z-ADD*ZERO     WN0221 112       Billing Detail
     C                     Z-ADD*ZERO     WN0222 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0223  1        Comment Print A
     C                     MOVEL*BLANK    WN0224  1        Comment Print I
     C                     MOVEL*BLANK    WN0225  1        Comment Print P
     C                     MOVEL*BLANK    WN0226  1        Comment Print S
     C                     Z-ADD*ZERO     WN0227 112       Extended Amount
     C                     Z-ADD*ZERO     WN0228  70       Market Pricing
     C                     MOVEL*BLANK    WN0229  3        Commodity Marke
     C                     MOVEL*BLANK    WN0230  3        Date Method Cod
     C                     MOVEL*BLANK    WN0231  3        Price Method Co
     C                     Z-ADD*ZERO     WN0232 114       Price Overage O
     C                     Z-ADD*ZERO     WN0233  70       Contract Number
     C                     MOVEL*BLANK    WN0234  1        Price Status
     C                     Z-ADD*ZERO     WN0235  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0236  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0237  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0238  1        Work Confirm St
     C                     MOVEL*BLANK    WN0239  1        Work Over/Short
     C                     MOVEL*BLANK    WN0240  1        OD Production P
     C                     MOVEL*BLANK    WN0241 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0242 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0243  1        Age Code
     C                     MOVEL*BLANK    WN0244  1        Palletize
     C                     MOVEL*BLANK    WN0245  1        Slip Sheet
     C                     MOVEL*BLANK    WN0246  1        Catch Weight St
     C                     MOVEL*BLANK    WN0247  1        Price Audit
     C                     MOVEL*BLANK    WN0248  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0249  1        Production Date
     C                     Z-ADD*ZERO     WN0250 112       Rated Freight
     C                     Z-ADD*ZERO     WN0251 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0252 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0253 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0254 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0255 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0256 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0257 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0258 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0259 114       Unit Price
     C                     Z-ADD*ZERO     WN0260 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0261 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0262 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0263 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0264  70       Requested Ship
     C                     Z-ADD*ZERO     WN0265  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0266  70       Actual Shipped
     C                     MOVEL*BLANK    WN0267  1        Affect Inventor
     C                     MOVEL*BLANK    WN0268  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0269  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0270  30       Item Structure
     C                     Z-ADD*ZERO     WN0271  30       Item Structure
     C                     Z-ADD*ZERO     WN0272  30       Item Structure
     C                     MOVEL*BLANK    WN0273  2        Item Level
     C                     MOVEL*BLANK    WN0274  2        Quality Level
     C                     MOVEL*BLANK    WN0275  2        Pricing Product
     C                     MOVEL*BLANK    WN0276  2        Season Product
     C                     Z-ADD*ZERO     WN0277  70       Date of Origina
     C                     MOVEL*BLANK    WN0278 10        User Profile Na
     C                     MOVEL*BLANK    WN0279  6        Country Code
     C                     MOVEL*BLANK    WN0280  2        Event Code
     C                     MOVEL*BLANK    WN0281  3        Reason Code
     C                     MOVEL*BLANK    WN0282  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0283  1        Modified Flag
     C                     MOVEL*BLANK    WN0284  1        Substituted Fla
     C                     MOVEL*BLANK    WN0285  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0286 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0287 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0288  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0289  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0290  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0291  1        Affect Commissi
     C                     MOVEL*BLANK    WN0292  1        Affect Pricing
     C                     MOVEL*BLANK    WN0293  1        Released by Use
     C                     MOVEL*BLANK    WN0294  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0295  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0296  3        Production Ware
     C                     MOVEL*BLANK    WN0297  3        OD Price Type
     C                     Z-ADD*ZERO     WN0298  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0299  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0300  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0301  70       OD Unused Date
     C                     Z-ADD*ZERO     WN0302  60       Price Code
     C                     Z-ADD*ZERO     WN0303  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0304  60       Substitution Li
     C                     Z-ADD*ZERO     WN0305  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0306 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0307 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0308 112       OD Item Target
     C                     Z-ADD*ZERO     WN0309 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0310 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0311 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0312 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0313 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0314 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0315 114       OD Unused Prc 5
     C                     Z-ADD*ZERO     WN0316 114       OD Unused Prc 6
     C                     Z-ADD*ZERO     WN0317 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0318 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0319  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0320  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0321  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0322 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0323  40       Item Age Days
     C                     Z-ADD*ZERO     WN0324  70       Production Ovr
     C                     Z-ADD*ZERO     WN0325  70       Production Ovr
     C                     MOVEL*BLANK    WN0326  1        OD UnUsed Statu
     C                     MOVEL*BLANK    WN0327  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0328  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0329  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0330  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0331  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0332  1        EDI Status 1
     C                     MOVEL*BLANK    WN0333  1        EDI Status 2
     C                     MOVEL*BLANK    WN0334  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0335  60       Job Time
     C                     MOVEL*BLANK    WN0336 10        User Id
     C                     MOVEL*BLANK    WN0337 10        Job Name
     C                     Z-ADD*ZERO     WN0338  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWFAIC3    WGAIC3           Company Number
     C                     Z-ADDWFC4NB    WGC4NB           Order Number
     C                     Z-ADDWFDPNB    WGDPNB           Order Sequence
     C                     Z-ADDWFUENB    WGUENB           Order Secondary
      *
     C           KLCHST    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
     C                     KFLD           WGDPNB           Order Sequence
     C                     KFLD           WGUENB           Order Secondary
     C           KLCHST    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO STEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YERDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDWEHDDT    WGNVDT           Deadline Depart
     C                     Z-ADDWEAUTM    WGBUTM           Deadline Depart
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##JOB     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Chg Carrier           RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/13/04 SLM PKTR01 Multi-Company - Function was changed
      *                                    to remove Company RST or Pos
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHRMNB    WQSU02           Load ID
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WQSU02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSU02           Load ID
      * Establish starting position
     C           KRSSU     SETLL@BFCPD9                    *
     C           KRSSU     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Load Information   CH - Order Header TRG  * 
     C                     EXSR SVCHRC
     C           KRSSU     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVCHRC    BEGSR
      *================================================================
      * Chg Load Information   CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0339  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0340  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0341  70       Ship To Custome
     C                     MOVEL*BLANK    WN0342 30        Ship To Name
     C                     MOVEL*BLANK    WN0343 30        Ship To Address
     C                     MOVEL*BLANK    WN0344 30        Ship To Address
     C                     MOVEL*BLANK    WN0345 30        Ship To Address
     C                     MOVEL*BLANK    WN0346 20        Ship To City
     C                     MOVEL*BLANK    WN0347  2        Ship To State C
     C                     MOVEL*BLANK    WN0348 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0349  70       Bill to Custome
     C                     MOVEL*BLANK    WN0350 30        Bill to Name
     C                     MOVEL*BLANK    WN0351 30        Bill to Address
     C                     MOVEL*BLANK    WN0352 30        Bill to Address
     C                     MOVEL*BLANK    WN0353 30        Bill to Address
     C                     MOVEL*BLANK    WN0354 20        Bill to City
     C                     MOVEL*BLANK    WN0355  2        Bill to State C
     C                     MOVEL*BLANK    WN0356 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0357 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0358  70       Order Date
     C                     Z-ADD*ZERO     WN0359  70       Requested Ship
     C                     Z-ADD*ZERO     WN0360  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0361  70       Cancel Date
     C                     MOVEL*BLANK    WN0362  2        Terms Code
     C                     MOVEL*BLANK    WN0363 40        Special Instruc
     C                     MOVEL*BLANK    WN0364 40        Special Instruc
     C                     MOVEL*BLANK    WN0365  1        Comment Print A
     C                     MOVEL*BLANK    WN0366  1        Comment Print I
     C                     MOVEL*BLANK    WN0367  1        Comment Print P
     C                     MOVEL*BLANK    WN0368  1        Comment Print S
     C                     MOVEL*BLANK    WN0369  3        Reason Code
     C                     MOVEL*BLANK    WN0370  1        Order in Use
     C                     MOVEL*BLANK    WN0371  1        Header Status
     C                     MOVEL*BLANK    WN0372  1        Header Status L
     C                     MOVEL*BLANK    WN0373  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0374  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0375 10        User Original E
     C                     Z-ADD*ZERO     WN0376  70       Date of Origina
     C                     Z-ADD*ZERO     WN0377 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0378 112       Order Weight To
     C                     MOVEL*BLANK    WN0379  1        Credit Hold
     C                     MOVEL*BLANK    WN0380  1        Production Hold
     C                     MOVEL*BLANK    WN0381  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0382  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0383  40       Requested Deliv
     C                     MOVEL*BLANK    WN0384  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0385 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0386  52       Absorbed Freigh
     C                     MOVEL*BLANK    WN0387  1        LTL Flag
     C                     MOVEL*BLANK    WN0388  1        Price Audit
     C                     MOVEL*BLANK    WN0389  1        Price Status
     C                     MOVEL*BLANK    WN0390  2        Shipping Method
     C                     MOVEL*BLANK    WN0391  1        Export Status
     C                     MOVEL*BLANK    WN0392  1        Palletize
     C                     MOVEL*BLANK    WN0393  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0394  1        Slip Sheet
     C                     MOVEL*BLANK    WN0395  1        Age Code
     C                     Z-ADD*ZERO     WN0396  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0397  1        Load Type
     C                     Z-ADD*ZERO     WN0398  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0399  1        Load Plan Order
     C                     MOVEL*BLANK    WN0400  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0401  70       Resell Referenc
     C                     MOVEL*BLANK    WN0402 30        Special Comment
     C                     MOVEL*BLANK    WN0403 30        Special Comment
     C                     MOVEL*BLANK    WN0404  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0405  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0406  2        Manager Level C
     C                     MOVEL*BLANK    WN0407  3        VP Level Code
     C                     Z-ADD*ZERO     WN0408  70       Attach to Order
     C                     MOVEL*BLANK    WN0409  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0410  70       Invoice Number
     C                     MOVEL*BLANK    WN0411  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0412  70       Invoice Date
     C                     MOVEL*BLANK    WN0413  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0414  1        Modified Flag
     C                     Z-ADD*ZERO     WN0415 112       A/R order Value
     C                     MOVEL*BLANK    WN0416  1        Billing Activit
     C                     MOVEL*BLANK    WN0417  1        Block Order Fla
     C                     MOVEL*BLANK    WN0418  1        Order Certifica
     C                     Z-ADD*ZERO     WN0419 112       Invoice Order V
     C                     MOVEL*BLANK    WN0420  1        Process Sts for
     C                     MOVEL*BLANK    WN0421  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0422  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0423  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0424  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0425  1        Email Cust On O
     C                     MOVEL*BLANK    WN0426  1        Order Emailed
     C                     MOVEL*BLANK    WN0427  1        Export Docs Go
     C                     MOVEL*BLANK    WN0428  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0429  1        Broker Order St
     C                     MOVEL*BLANK    WN0430  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0431  2        Order Requires
     C                     MOVEL*BLANK    WN0432  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0433  2        Export USDA App
     C                     MOVEL*BLANK    WN0434  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0435  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0436  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0437  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0438  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0439  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0440  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0441  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0442  60       Time of Origina
     C                     Z-ADD*ZERO     WN0443  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0444  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0445  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0446 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0447 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0448 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0449 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0450 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0451  70       Claim Number
     C                     MOVEL*BLANK    WN0452  1        EDI Status 1
     C                     MOVEL*BLANK    WN0453  1        EDI Status 2
     C                     MOVEL*BLANK    WN0454  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0455  60       Job Time
     C                     MOVEL*BLANK    WN0456 10        User Id
     C                     MOVEL*BLANK    WN0457 10        Job Name
     C                     Z-ADD*ZERO     WN0458  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWHAIC3    WIAIC3           Company Number
     C                     Z-ADDWHC4NB    WIC4NB           Order Number
      *
     C           KLCHSV    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIC4NB           Order Number
     C           KLCHSV    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SVEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YFRDCS
      * Move non-key fields to @BECPFJ
     C                     MOVEL#1BZNA    WIBZNA    P      Carrier Code
     C                     Z-ADDWHRMNB    WIRMNB           Load ID
     C                     Z-ADDWHR1NB    WIR1NB           Rated Freight
     C                     MOVELWHJPCD    WIJPCD    P      Event Code
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WIAATM           Job Time
     C                     MOVEL##USR     WIAYNA           User Id
     C                     MOVEL##PGM     WIA0NA           Job Name
     C                     Z-ADD##JDT     WIAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPCRC
     C                     Z-ADDWIAIC3    PCAIC3           Company Number
     C                     Z-ADDWIC4NB    PCC4NB           Order Number
     C                     MOVELWIJNCD    PCJNCD    P      Order Type - Sa
     C                     Z-ADDWIANC7    PCANC7           A/R Customer Nu
     C                     Z-ADDWIBKC7    PCBKC7           Ship To Custome
     C                     MOVELWIBRTX    PCBRTX    P      Ship To Name
     C                     MOVELWIHMNA    PCHMNA    P      Ship To Address
     C                     MOVELWIHONA    PCHONA    P      Ship To Address
     C                     MOVELWIHPNA    PCHPNA    P      Ship To Address
     C                     MOVELWIHNNA    PCHNNA    P      Ship To City
     C                     MOVELWIDBCD    PCDBCD    P      Ship To State C
     C                     MOVELWICKTX    PCCKTX    P      Ship To Zip/Pos
     C                     Z-ADDWIB0C7    PCB0C7           Bill to Custome
     C                     MOVELWIAETX    PCAETX    P      Bill to Name
     C                     MOVELWIB1NA    PCB1NA    P      Bill to Address
     C                     MOVELWIB3NA    PCB3NA    P      Bill to Address
     C                     MOVELWIB4NA    PCB4NA    P      Bill to Address
     C                     MOVELWIB2NA    PCB2NA    P      Bill to City
     C                     MOVELWIBHCD    PCBHCD    P      Bill to State C
     C                     MOVELWIC8TX    PCC8TX    P      Bill to Zip/Pos
     C                     MOVELWIBCNA    PCBCNA    P      Customer Purcha
     C                     Z-ADDWIA0DT    PCA0DT           Order Date
     C                     Z-ADDWIA5DT    PCA5DT           Requested Ship
     C                     Z-ADDWIGNDT    PCGNDT           Actual Shipped
     C                     Z-ADDWIACDT    PCACDT           Cancel Date
     C                     MOVELWIAQCD    PCAQCD    P      Terms Code
     C                     MOVELWIB6NA    PCB6NA    P      Special Instruc
     C                     MOVELWIBYNA    PCBYNA    P      Special Instruc
     C                     MOVELWIBZNA    PCBZNA    P      Carrier Code
     C                     MOVELWIGTST    PCGTST    P      Comment Print A
     C                     MOVELWIGVST    PCGVST    P      Comment Print I
     C                     MOVELWIGUST    PCGUST    P      Comment Print P
     C                     MOVELWIQFST    PCQFST    P      Comment Print S
     C                     MOVELWICQCD    PCCQCD    P      Reason Code
     C                     MOVELWIGJST    PCGJST    P      Order in Use
     C                     MOVELWIGWST    PCGWST    P      Header Status
     C                     MOVELWIGXST    PCGXST    P      Header Status L
     C                     MOVELWIGYST    PCGYST    P      Order Type Prin
     C                     Z-ADDWIAODT    PCAODT           Scheduled Ship
     C                     MOVELWIAIVN    PCAIVN    P      User Original E
     C                     Z-ADDWICXDT    PCCXDT           Date of Origina
     C                     Z-ADDWIJZVA    PCJZVA           Order Value Tot
     C                     Z-ADDWIA1WG    PCA1WG           Order Weight To
     C                     MOVELWIXIST    PCXIST    P      Credit Hold
     C                     MOVELWIXJST    PCXJST    P      Production Hold
     C                     MOVELWIXKST    PCXKST    P      New Customer Ho
     C                     Z-ADDWIEIDT    PCEIDT           Requested Deliv
     C                     Z-ADDWIAFTM    PCAFTM           Requested Deliv
     C                     MOVELWIE8CD    PCE8CD    P      Accounts Receiv
     C                     MOVELWIE9CD    PCE9CD    P      Accounts Receiv
     C                     Z-ADDWIRMNB    PCRMNB           Load ID
     C                     Z-ADDWITBNB    PCTBNB           Absorbed Freigh
     C                     Z-ADDWIR1NB    PCR1NB           Rated Freight
     C                     MOVELWIPJST    PCPJST    P      LTL Flag
     C                     MOVELWIU0ST    PCU0ST    P      Price Audit
     C                     MOVELWIU1ST    PCU1ST    P      Price Status
     C                     MOVELWIQ2CD    PCQ2CD    P      Shipping Method
     C                     MOVELWIU2ST    PCU2ST    P      Export Status
     C                     MOVELWIVEST    PCVEST    P      Palletize
     C                     MOVELWIVFST    PCVFST    P      Shrink Wrap
     C                     MOVELWIVGST    PCVGST    P      Slip Sheet
     C                     MOVELWIRPCD    PCRPCD    P      Age Code
     C                     Z-ADDWIRNNB    PCRNNB           Reefer Temperat
     C                     MOVELWIVDST    PCVDST    P      Load Type
     C                     Z-ADDWIATIN    PCATIN           Attach to Invoi
     C                     MOVELWIU4ST    PCU4ST    P      Load Plan Order
     C                     MOVELWIU5ST    PCU5ST    P      Print Pick Slip
     C                     Z-ADDWIRSRN    PCRSRN           Resell Referenc
     C                     MOVELWIMHNA    PCMHNA    P      Special Comment
     C                     MOVELWIMINA    PCMINA    P      Special Comment
     C                     MOVELWIWBST    PCWBST    P      Affect Auto Acc
     C                     MOVELWIR4CD    PCR4CD    P      Sales Route Cod
     C                     MOVELWIBFCD    PCBFCD    P      Manager Level C
     C                     MOVELWIQ4CD    PCQ4CD    P      VP Level Code
     C                     Z-ADDWIT3NB    PCT3NB           Attach to Order
     C                     MOVELWISICD    PCSICD    P      Reason for Pric
     C                     Z-ADDWICONB    PCCONB           Invoice Number
     C                     MOVELWICEST    PCCEST    P      Invoice Suffix
     C                     Z-ADDWIAWDT    PCAWDT           Invoice Date
     C                     MOVELWIJPCD    PCJPCD    P      Event Code
     C                     MOVELWIXUST    PCXUST    P      Trans Contol AS
     C                     MOVELWIZ1ST    PCZ1ST    P      Modified Flag
     C                     Z-ADDWIVRVA    PCVRVA           A/R order Value
     C                     MOVELWIOBST    PCOBST    P      Billing Activit
     C                     MOVELWIBCST    PCBCST    P      Block Order Fla
     C                     MOVELWIBDST    PCBDST    P      Order Certifica
     C                     Z-ADDWIB7VL    PCB7VL           Invoice Order V
     C                     MOVELWIGASX    PCGASX    P      Process Sts for
     C                     MOVELWIGBSX    PCGBSX    P      Order Conf Fax
     C                     MOVELWIGCSX    PCGCSX    P      Manifest Fax St
     C                     MOVELWIGDSX    PCGDSX    P      Invoice Fax Sts
     C                     MOVELWIFNSX    PCFNSX    P      Transfer in Sto
     C                     MOVELWIFOSX    PCFOSX    P      Email Cust On O
     C                     MOVELWIFPSX    PCFPSX    P      Order Emailed
     C                     MOVELWIFQSX    PCFQSX    P      Export Docs Go
     C                     MOVELWIFRSX    PCFRSX    P      Shipping Temp C
     C                     MOVELWIFSSX    PCFSSX    P      Broker Order St
     C                     MOVELWIFTSX    PCFTSX    P      Air Freight Ord
     C                     MOVELWIFUSX    PCFUSX    P      Order Requires
     C                     MOVELWIFVSX    PCFVSX    P      OH Load Plan Re
     C                     MOVELWIFWSX    PCFWSX    P      Export USDA App
     C                     MOVELWIFXSX    PCFXSX    P      HPB Ship to War
     C                     MOVELWIFYSX    PCFYSX    P      OH TF Exempt Co
     C                     Z-ADDWINODT    PCNODT           OH Appt Confirm
     C                     Z-ADDWINPDT    PCNPDT           JPN Invoice Iss
     C                     Z-ADDWINQDT    PCNQDT           Load Actual Shi
     C                     Z-ADDWINRDT    PCNRDT           Load BOL Comple
     C                     Z-ADDWINSDT    PCNSDT           Load Truck Depa
     C                     Z-ADDWIBPTM    PCBPTM           Maximum Gross W
     C                     Z-ADDWIBQTM    PCBQTM           Time of Origina
     C                     Z-ADDWIBRTM    PCBRTM           OH Appt Confirm
     C                     Z-ADDWIBSTM    PCBSTM           Load BOL Comple
     C                     Z-ADDWIBTTM    PCBTTM           Load Truck Depa
     C                     Z-ADDWIH0NX    PCH0NX           Act Frt Referen
     C                     Z-ADDWIH1NX    PCH1NX           Act Non-Ref Frt
     C                     Z-ADDWIH2NX    PCH2NX           OH Fuel Surchar
     C                     Z-ADDWIH3NX    PCH3NX           OH Total Non-Re
     C                     Z-ADDWIH4NX    PCH4NX           OH Total Ref Fr
     C                     Z-ADDWIC0C7    PCC0C7           Claim Number
     C                     MOVELWIUVST    PCUVST    P      EDI Status 1
     C                     MOVELWIUWST    PCUWST    P      EDI Status 2
     C                     MOVELWIUXST    PCUXST    P      EDI Status 3
     C                     Z-ADDWIAATM    PCAATM           Job Time
     C                     MOVELWIAYNA    PCAYNA    P      User Id
     C                     MOVELWIA0NA    PCA0NA    P      Job Name
     C                     Z-ADDWIAXDT    PCAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * RTV SSI Carrier flag   RT - Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           FFBZNA           Carrier Code
      * Setup key
     C                     MOVELWL0123    FFBZNA           Carrier Code
      * Establish starting position
     C           KRSSW     CHAIN@FFREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0124           SSI Download Fl
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFFUNUS    WL0124           SSI Download Fl
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV SSI Fax'd Flag     RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WJRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WJRMNB           Load ID
      * Establish starting position
     C           KRSSX     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWJRUSX    WURUSX           Fax Sent to SSI
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * Rtv/Chg Orig Trailer   RT - Trailer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           LYBZNA           Carrier Code
     C                     KFLD           LYDXTX           Trailer Id
      * Setup key
     C                     MOVELWL0125    LYBZNA           Carrier Code
     C                     MOVELWL0126    LYDXTX           Trailer Id
      * Establish starting position
     C           KRSSY     CHAIN@LYRER3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2598' W0RTN   7
      * USER: Processing if Data record not found
      * ** Not an error if no record exists.       E001558
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg PD Trailer         CH - Trailer  * 
     C                     EXSR SZCHRC
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZCHRC    BEGSR
      *================================================================
      * Chg PD Trailer         CH - Trailer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @LYRER2
     C                     MOVELLYBZNA    WBBZNA    P      Carrier Code
     C                     MOVELLYDXTX    WBDXTX    P      Trailer Id
      *
     C           KLCHSZ    KLIST
     C                     KFLD           WBBZNA           Carrier Code
     C                     KFLD           WBDXTX           Trailer Id
     C           KLCHSZ    CHAIN@LYRER2              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDLYREL0'MDACP
     C                     MOVEL'@LYRER2' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SZEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDLY1    YGRDCS
      * Move non-key fields to @LYRER2
     C                     Z-ADDLYAIC3    WBAIC3           Company Number
     C                     MOVELLYVDST    WBVDST    P      Load Type
     C                     MOVELLYX3ST    WBX3ST    P      Trailer Type
     C                     MOVELLYXGST    WBXGST    P      Seaboard Owned
     C                     MOVELLYSTOY    WBSTOY    P      On Yard Status
     C                     Z-ADDLYKKDT    WBKKDT           On Yard Date
     C                     Z-ADDLYAVTM    WBAVTM           On Yard Time
     C                     MOVELWL0127    WBSTAS    P      Assigned Status
     C                     MOVELWL0128    WBXRST    P      Available Statu
     C                     MOVELLYX7CD    WBX7CD    P      Not Available R
     C                     MOVELLYGXTX    WBGXTX    P      Comment Line
     C                     MOVELLYXTST    WBXTST    P      Status Unused 1
     C                     MOVELLYXVST    WBXVST    P      Status Unused 2
     C                     MOVELLYSTU3    WBSTU3    P      Status Unused 3
     C                     MOVELLYSTU4    WBSTU4    P      Status Unused 4
     C                     MOVELLYSTU5    WBSTU5    P      Status Unused 5
     C                     Z-ADDLYLCDT    WBLCDT           Date Unused 1
     C                     Z-ADDLYLDDT    WBLDDT           Date Unused 2
     C                     Z-ADDLYLEDT    WBLEDT           Date Unused 3
     C                     Z-ADDLYLFDT    WBLFDT           Date Unused 4
     C                     Z-ADDLYLGDT    WBLGDT           Date Unused 5
     C                     MOVELLYUVST    WBUVST    P      EDI Status 1
     C                     MOVELLYUWST    WBUWST    P      EDI Status 2
     C                     MOVELLYUXST    WBUXST    P      EDI Status 3
     C                     MOVELLYVSST    WBVSST    P      Record Status
     C                     Z-ADDLYAATM    WBAATM           Job Time
     C                     MOVELLYAYNA    WBAYNA    P      User Id
     C                     MOVELLYA0NA    WBA0NA    P      Job Name
     C                     Z-ADDLYAXDT    WBAXDT           Job Date
      *
      * Set PGM.*Record Data Changed flag
     C           QPDLY1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WBAATM           Job Time
     C                     MOVEL##USR     WBAYNA           User Id
     C                     MOVEL##PGM     WBA0NA           Job Name
     C                     Z-ADD##JDT     WBAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDLY1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@LYRER2                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDLYREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TACHRC    BEGSR
      *================================================================
      * CHG LH, OHE, OH        CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0459  30       Company Number
     C                     MOVEL*BLANK    WN0460 15        Seal 4
     C                     MOVEL*BLANK    WN0461 15        Seal 2 Unused
     C                     MOVEL*BLANK    WN0462  2        Shipping Method
     C                     MOVEL*BLANK    WN0463  3        Shipping Line
     C                     MOVEL*BLANK    WN0464 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0465 30        Vessel Name
     C                     Z-ADD*ZERO     WN0466  50       Voyage
     C                     Z-ADD*ZERO     WN0467  70       Sail Date
     C                     MOVEL*BLANK    WN0468 12        Booking Number
     C                     MOVEL*BLANK    WN0469 20        Discharge Port
     C                     Z-ADD*ZERO     WN0470  70       Arrival Date
     C                     MOVEL*BLANK    WN0471 12        Container Numbe
     C                     Z-ADD*ZERO     WN0472  60       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0473  60       Job Time
     C                     MOVEL*BLANK    WN0474 10        User Id
     C                     MOVEL*BLANK    WN0475 10        Job Name
     C                     Z-ADD*ZERO     WN0476  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YHRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADD#1RMNB    FJRMNB           Load ID
      *
     C           KLCHTA    KLIST
     C                     KFLD           FJRMNB           Load ID
     C           KLCHTA    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TAEXIT
     C                     ENDIF
      *
      * Check for changed record
     C           #1DBRC    IFNE @1DBRC                     IF
     C                     MOVEL'Y2U0007' W0RTN   7
      * Send message '*Update not accepted'
     C                     MOVEL'Y2U0007' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     GOTO TAEXIT
     C                     ENDIF                           FI #1DBRC
      * Store record data for null update check
     C                     MOVE @1DBRC    YHRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADD#1AODT    FJAODT           Scheduled Ship
     C                     MOVEL#1PJST    FJPJST    P      LTL Flag
     C                     MOVEL#1PKST    FJPKST    P      Load Status
     C                     Z-ADD#1RNNB    FJRNNB           Reefer Temperat
     C                     MOVEL#1DMTX    FJDMTX    P      Seal 1
     C                     MOVEL#1DNTX    FJDNTX    P      Seal 2
     C                     MOVEL#1DOTX    FJDOTX    P      Seal 3
     C                     Z-ADD#1RPNB    FJRPNB           Total Load Orde
     C                     Z-ADD#1FLAM    FJFLAM           Flat Amount
     C                     MOVEL#1XQST    FJXQST    P      Allocate Pounds
     C                     Z-ADD#1RRNB    FJRRNB           Total Stops
     C                     MOVEL#RBDU1    FJDXTX    P      Trailer Id
     C                     MOVEL#1DYTX    FJDYTX    P      Transloader Car
     C                     Z-ADD#1SBNB    FJSBNB           BOL Time
     C                     MOVEL#1BZNA    FJBZNA    P      Carrier Code
     C                     MOVEL#1RONB    FJRONB    P      Truck Size
     C                     Z-ADD#1SQNB    FJSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD#1R1NB    FJR1NB           Rated Freight
     C                     MOVEL#1VCST    FJVCST    P      Ship Status
     C                     MOVEL#1VDST    FJVDST    P      Load Type
     C                     Z-ADD#1SDNB    FJSDNB           Number Pallets
     C                     Z-ADD#1PAOU    FJPAOU           Number Pallets
     C                     Z-ADD#1DGWG    FJDGWG           Load Carrier Pa
     C                     Z-ADD#1SXNB    FJSXNB           Estimated Arriv
     C                     Z-ADD#1HADT    FJHADT           Actual Arrival
     C                     Z-ADD#1AART    FJAART           Actual Arrival
     C                     Z-ADD#1DHWG    FJDHWG           Trailer IN Weig
     C                     Z-ADD#1DIWG    FJDIWG           Trailer OUT Wei
     C                     Z-ADD#1AQDT    FJAQDT           Actual Departur
     C                     Z-ADD#1S6NB    FJS6NB           Departure Time
     C                     Z-ADD#1T4NB    FJT4NB           Schedule Sequen
     C                     Z-ADD#1PRTM    FJPRTM           Product Tempera
     C                     Z-ADD#1NPSV    FJNPSV           Number Spacers
     C                     MOVEL#1J8TX    FJJ8TX    P      Car/Veh. Initia
     C                     Z-ADD#1TLMI    FJTLMI           Total Load Mile
     C                     MOVEL#1J9TX    FJJ9TX    P      Recorder ID
     C                     MOVEL#1VPCD    FJVPCD    P      Ship From Wareh
     C                     MOVEL#1DBCD    FJDBCD    P      Ship To State C
     C                     Z-ADD#1GRWE    FJGRWE           Gross Weight
     C                     MOVEL#1XCCD    FJXCCD    P      Carrier Broker
     C                     MOVEL#1U2ST    FJU2ST    P      Export Status
     C                     Z-ADD#1F9DT    FJF9DT           Actual Ship Dat
     C                     MOVEL#1ONTM    FJONTM    P      On Time - (Y/N)
     C                     Z-ADD#1J4DT    FJJ4DT           Truck Ready Dat
     C                     Z-ADD#1TRTM    FJTRTM           Truck Ready Tim
     C                     Z-ADD#1J5DT    FJJ5DT           Spotted Date
     C                     Z-ADD#1SPTM    FJSPTM           Spotted Time
     C                     Z-ADD#1J6DT    FJJ6DT           Load Finished D
     C                     Z-ADD#1LFTM    FJLFTM           Load Finished T
     C                     Z-ADD#1J7DT    FJJ7DT           BOL Complete Da
     C                     Z-ADD#1BOTM    FJBOTM           BOL Complete Ti
     C                     Z-ADD#1J8DT    FJJ8DT           BOL Received Da
     C                     Z-ADD#1BLTM    FJBLTM           BOL Received Ti
     C                     Z-ADD#1KIDT    FJKIDT           Truck Departure
     C                     Z-ADD#1ASTM    FJASTM           Truck Departure
     C                     Z-ADD#1KADT    FJKADT           Adjusted Depart
     C                     Z-ADD#1AJCM    FJAJCM           Adjusted Depart
     C                     Z-ADD#1KCDT    FJKCDT           Date In
     C                     Z-ADD#1TMIN    FJTMIN           Time In
     C                     Z-ADD#1KDDT    FJKDDT           Date Out
     C                     Z-ADD#1VMNB    FJVMNB           Time Out
     C                     Z-ADD#1OCFR    FJOCFR           Load Total Frei
     C                     Z-ADD#1KJDT    FJKJDT           Scheduled Deliv
     C                     MOVEL#1OTRS    FJOTRS    P      LH Unused Sts
     C                     MOVEL#1RNST    FJRNST    P      LH Carrier Paym
     C                     Z-ADD#1BRBK    FJBRBK           Bring Back Mile
     C                     Z-ADD#1EIDT    FJEIDT           Requested Deliv
     C                     MOVEL#1RMST    FJRMST    P      Load Acceptance
     C                     MOVEL#1AJCD    FJAJCD    P      Warehouse Code
     C                     Z-ADD#1KKDT    FJKKDT           On Yard Date
     C                     Z-ADD#1AVTM    FJAVTM           On Yard Time
     C                     Z-ADD#1KZDT    FJKZDT           Deadline Depart
     C                     Z-ADD#1AXTM    FJAXTM           Deadline Depart
     C                     MOVEL#1LHOS    FJLHOS    P      Load Held Over
     C                     MOVEL#1LHOR    FJLHOR    P      Load Held Over
     C                     MOVEL#1WNTX    FJWNTX    P      Load Held Over
     C                     MOVEL#1OITX    FJOITX    P      Ocean BOL Numbe
     C                     MOVEL#1OJTX    FJOJTX    P      Express Mail Nu
     C                     Z-ADD#1LLDT    FJLLDT           Express Mail Da
     C                     MOVEL#1LSHG    FJLSHG    P      Load Shag Flag
     C                     MOVEL#1YPST    FJYPST    P      Load Wash Flag
     C                     Z-ADD#1K0DT    FJK0DT           Product Complet
     C                     Z-ADD#1AYTM    FJAYTM           Product Complet
     C                     Z-ADD#1KNNX    FJKNNX           Pallets Loaded
     C                     Z-ADD#1ICWG    FJICWG           Avg Pallet Tare
     C                     Z-ADD#1IDWG    FJIDWG           Tot Pallet Tare
     C                     MOVEL#1H9SX    FJH9SX    P      Load Confirmed
     C                     MOVEL#1WOTX    FJWOTX    P      Load Confirmed
     C                     Z-ADD#1K1DT    FJK1DT           Load Confirmati
     C                     Z-ADD#1AZTM    FJAZTM           Load Door 1
     C                     Z-ADD#1K2DT    FJK2DT           Override Total
     C                     Z-ADD#1A0TM    FJA0TM           Load Door 2
     C                     MOVEL#1ROST    FJROST    P      Partial Load
     C                     MOVEL#1RPST    FJRPST    P      Load Confirmati
     C                     MOVEL#1RQST    FJRQST    P      Export Load USD
     C                     MOVEL#1RRST    FJRRST    P      Late Delivery E
     C                     Z-ADD#1ZBVA    FJZBVA           Load Actual Fre
     C                     MOVEL#1WPTX    FJWPTX    P      Hide on WW Load
     C                     MOVEL#1WQTX    FJWQTX    P      Late Billing Em
     C                     MOVEL#1WRTX    FJWRTX    P      Shipping Temp C
     C                     MOVEL#1WSTX    FJWSTX    P      LH Held Over Rs
     C                     MOVEL#1RVSX    FJRVSX    P      Multi Company L
     C                     MOVEL#1RUSX    FJRUSX    P      Fax Sent to SSI
     C                     MOVEL#1RWSX    FJRWSX    P      Schedule Pos Lo
     C                     MOVEL#1RXSX    FJRXSX    P      LH Power Only L
     C                     MOVEL#1RYSX    FJRYSX    P      MG Created Load
     C                     MOVEL#1RZSX    FJRZSX    P      LH Unused Sts 5
     C                     MOVEL#1R0SX    FJR0SX    P      Load U/M
     C                     MOVEL#1R1SX    FJR1SX    P      TPM Shipment St
     C                     MOVEL#1R2SX    FJR2SX    P      LH Unused Sts 8
     C                     MOVEL#1R3SX    FJR3SX    P      LH On-Time Reas
     C                     MOVEL#1R4SX    FJR4SX    P      LH Held Over Re
     C                     Z-ADD#1PYDT    FJPYDT           LH Carrier Paid
     C                     Z-ADD#1CKTM    FJCKTM           LH Carrier Paid
     C                     Z-ADD#1PZDT    FJPZDT           LH Last Combo P
     C                     Z-ADD#1CLTM    FJCLTM           LH Last Combo P
     C                     Z-ADD#1P0DT    FJP0DT           LPT Load Plan S
     C                     Z-ADD#1CMTM    FJCMTM           LPT Load Plan S
     C                     Z-ADD#1P1DT    FJP1DT           TPM Planned Shi
     C                     Z-ADD#1CNTM    FJCNTM           LH Unused Time
     C                     Z-ADD#1P2DT    FJP2DT           LH Unused Date
     C                     Z-ADD#1COTM    FJCOTM           LH Unused Time
     C                     Z-ADD#1P3DT    FJP3DT           LH Unused Date
     C                     Z-ADD#1CQTM    FJCQTM           LH Unused Time
     C                     MOVEL#1UVST    FJUVST    P      EDI Status 1
     C                     MOVEL#1UWST    FJUWST    P      EDI Status 2
     C                     MOVEL#1UXST    FJUXST    P      EDI Status 3
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     FJAATM           Job Time
     C                     MOVEL##USR     FJAYNA           User Id
     C                     MOVEL##JOB     FJA0NA           Job Name
     C                     Z-ADD##JDT     FJAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YHRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * Move @FJCPBO fields back
     C                     MOVELFJXCCD    #1XCCD           Carrier Broker
      *
      * Update saved record image
     C                     MOVEL@1DBRC    #1DBRC
      * DBF change successful
      * USER: Processing after Data update
      * R15161 DN 07/17/19-Replaced Voyage with OHE Voyage/Flight &
      *   Booking Number with OHE Booking Number.
      * RTV Chg Bkg by Load    RT - Order Header Extension  * 
     C                     EXSR TBRVGN
      * CASE: PAR.Carrier Code NE PAR.Carrier Code Usr
     C           #1BZNA    IFNE #RH8AA                     *IF
     C                     MOVEL*BLANK    YL0030           Load Confirmati
     C                     MOVEL*BLANK    YL0031           Load Confirmed
     C                     Z-ADD0         YL0032           Load Confirmati
     C                     MOVEL*BLANK    YL0033           Load Confirmed
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#1RPST    YL0030           Load Confirmati
     C                     MOVEL#1WOTX    YL0031           Load Confirmed
     C                     Z-ADD#1K1DT    YL0032           Load Confirmati
     C                     MOVEL#1H9SX    YL0033           Load Confirmed
     C                     END                             *FI
      * ** Re-Calculate the total load miles using the updated sail port
      * ** city. Update the load header.
      * ** Total Load Miles will be zeros if any leg of the journey
      * ** is missing a Miles Between Cities record.
      * ** Include Override Total Load Miles. If entered, they will
      * ** take precedence
      * CLC Total Load Miles   XF - Load Detail  * 
     C                     CLEARPBRC
     C                     Z-ADD#1RMNB    PBRMNB           Load ID
      *
     C                     CALL 'PDW3XFR'              90  CLC Total Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Load Detai
     C           WUTLMI    PARM WUTLMI    WQ0026  70       Total Load Mile
     C           WUK2DT    PARM WUK2DT    WQ0027  70       Override Total
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CHG Total Load Miles   XF - Load Header  * 
     C                     CALL 'PMFSXFR'              90  CHG Total Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0028  70       Load ID
     C                     PARM WUTLMI    WQ0029  70       Total Load Mile
     C                     PARM WUK2DT    WQ0030  70       Override Total
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMFSXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CLC Deadline Date/Time XF - Load Detail  * 
     C                     CALL 'PMP9XFR'              90  CLC Deadline Da
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0031  70       Load ID
     C           YL0034    PARM YL0034    WQ0032  70       Deadline Depart
     C           YL0035    PARM *ZERO     WQ0033  60       Deadline Depart
     C           YL0036    PARM *ZERO     WQ0034  70       Requested Deliv
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMP9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CHG Deadline Dep D/T   CH - Load Header  * 
     C                     EXSR TCCHRC
      * CHG Deadline Date/Time RT - Load Detail  * 
     C                     EXSR TDRVGN
      * ** Fax load confirmation to Ship Line &/or Carrier, if entered
      * ** Only fax confirmation if Carrier is assigned to the load
      * CASE: PAR.Carrier Code is entered
     C           #1BZNA    IFNE *BLANK                     *IF
      * If carrier broker is blank, default broker
      * CASE: PAR.Carrier Broker is not entered
     C           #1XCCD    IFEQ *BLANK                     *IF
     C                     MOVEL#1BZNA    #1XCCD           Carrier Broker
     C                     END                             *FI
      * Update order header with changed carrier, flag to fax booking con
      * CASE: PAR.Carrier Code Usr NE PAR.Carrier Code
     C           #RH8AA    IFNE #1BZNA                     *IF
      * Chg Carrier           RT - Order Header TRG  * 
     C                     EXSR THRVGN
     C                     END                             *FI
      * ** wrk.status-Y or N is to control faxing to PowerPro in the
      * ** case of a carrier change.
     C                     MOVEL'Y'       WUB8ST           Status - Y or N
     C                     MOVEL##JOB     WUB2VN           Job Name CDE
      * PMT Fax Load Confirmtn PV - Load Header  * 
     C                     CALL 'POICPVR'              90  PMT Fax Load Co
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0035  70       Load ID
     C                     PARM WN0459    WQ0036  30       Company Number
     C                     PARM #1DYTX    WQ0037  3        Transloader Car
     C                     PARM #1BZNA    WQ0038  3        Carrier Code
     C                     PARM #CXACD    WQ0039  3        Shipping Line
     C                     PARM WUC2TX    WQ0040  4        OHE Carrier SCA
     C           WUB8ST    PARM WUB8ST    WQ0041  1        Status - Y or N
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POICPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9832  *
     C                     END
      * * Carrier Code = original carrier, Carrier Code usr = rcd.cc (cha
      * ** If Fax to Carrier is "Y" then check SSI/PowerPro also
      * CASE: WRK.Status - Y or N is yes
     C           WUB8ST    IFEQ 'Y'                        *IF
      * ** Only send to SSI if SSI download flag is set to Yes
      * RTV SSI Carrier flag   RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1BZNA    WL0123    P      Carrier Code
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0124    WUUNUS    P      SSI Download Fl
      * ** Handle deletes for SSI Carriers
      * CASE: WRK.SSI Download Flag is Yes, Download to SSI
     C           WUUNUS    IFEQ 'Y'                        *IF
      * RTV SSI Fax'd Flag     RT - Load Header  * 
     C                     EXSR TJRVGN
      * ** Carrier is new or changed to SBD
      * CASE: WRK.Fax Sent to SSI Carrier is Not Fax'd to Carrier
     C           WURUSX    IFEQ *BLANK                     *IF
     C           WURUSX    OREQ 'N'
     C                     MOVEL'00'      WUAHST           SSI Add, Chg, D
      * BLD SSI Download       XF - SSI Control  * 
     C                     CALL 'PNPNXFR'              90  BLD SSI Downloa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0042  70       Load ID
     C                     PARM #1BZNA    WQ0043  3        Carrier Code
     C                     PARM WUAHST    WQ0044  2        SSI Add, Chg, D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNPNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9832  *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'04'      WUAHST           SSI Add, Chg, D
      * BLD SSI Download       XF - SSI Control  * 
     C                     CALL 'PNPNXFR'              90  BLD SSI Downloa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0045  70       Load ID
     C                     PARM #1BZNA    WQ0046  3        Carrier Code
     C                     PARM WUAHST    WQ0047  2        SSI Add, Chg, D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNPNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9832  *
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : WRK.SSI Download Flag is No
      *   |- c2    : WRK.SSI Download Flag is Not Entered
      *   '-
     C           WUUNUS    IFEQ 'N'                        *IF
     C           WUUNUS    OREQ *BLANK                     *OR
      * ** If old carrier is SBD, send a delete record to SSI
      * ** New/Changes for SBD will be sent from the Accept Screen
      * RTV SSI Carrier flag   RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#RH8AA    WL0123    P      Carrier Code
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0124    WUUNUS    P      SSI Download Fl
      * ** Only send to SSI if SSI download flag is set to Yes
      * CASE: WRK.SSI Download Flag is Yes, Download to SSI
     C           WUUNUS    IFEQ 'Y'                        *IF
      * ** Only send "Delete" record if a fax was previously sent
      * CASE: WRK.Fax Sent to SSI Carrier is Yes, Fax'd to Carrier
     C           WURUSX    IFEQ 'Y'                        *IF
      * ** Carrier was changed from SBD to someone else
     C                     MOVEL'01'      WUAHST           SSI Add, Chg, D
      * BLD SSI Download       XF - SSI Control  * 
     C                     CALL 'PNPNXFR'              90  BLD SSI Downloa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0048  70       Load ID
     C                     PARM #RH8AA    WQ0049  3        Carrier Code
     C                     PARM WUAHST    WQ0050  2        SSI Add, Chg, D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNPNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Update the original Assigned trailer if load has been re-assigned
      * CASE:
      *  - (c1 AND c2) OR c3
      *   |- c1    : PAR.Container Number usr 1 NE PAR.Trailer Id
      *   |- c2    : PAR.Container Number usr 1 NE WRK.Blank for 12
      *   |- c3    : PAR.Carrier Code NE PAR.Carrier Code Usr
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #RBDU1    IFNE #1DXTX                     *IF
     C           #RBDU1    IFNE WUS3TX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           #1BZNA    IFNE #RH8AA                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * IF trailer was changed, update original to Assigned = N
      * Rtv/Chg Orig Trailer   RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#RH8AA    WL0125    P      Carrier Code
     C                     MOVEL#1DXTX    WL0126    P      Trailer Id
     C                     MOVEL'N'       WL0127    P      Assigned Status
     C                     MOVEL'Y'       WL0128    P      Available Statu
     C                     EXSR SYRVGN
     C                     END                             *FI
      * Update the (new/changed) Trailer/Container if assigned
      * CASE: PAR.Container Number usr 1 NE WRK.Blank for 12          USR
     C           #RBDU1    IFNE WUS3TX                     *IF
      * Rtv/Chg Orig Trailer   RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1BZNA    WL0125    P      Carrier Code
     C                     MOVEL#RBDU1    WL0126    P      Trailer Id
     C                     MOVEL'Y'       WL0127    P      Assigned Status
     C                     MOVEL'N'       WL0128    P      Available Statu
     C                     EXSR SYRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * RTV Chg Bkg by Load    RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN AMRMNB    WQTB01           Load ID
      * Define keylist
     C           KPSTB     KLIST
     C                     KFLD           WQTB01           Load ID
     C                     KFLD           AMC4NB           Order Number
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WQTB01           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQTB01           Load ID
     C                     Z-ADD1         AMC4NB           Order Number
      * Establish starting position
     C           KPSTB     SETLL@AMREJM                    *
     C           KRSTB     READE@AMREJM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Update export order header extension record
      * CASE: DB1.Load ID EQ PAR.Load ID
     C           AMRMNB    IFEQ #1RMNB                     *IF
      * R15161 DN 07/17/19-Replaced Booking Number w/ OHE Booking Number.
      * Update booking # from # entered on the screen, including blanks
      * CASE: DB1.OHE Booking Number NE PAR.OHE Booking Number
     C           AMJ1T1    IFNE #RM4U1                     *IF
     C                     MOVEL#RM4U1    YL0028           OHE Booking Num
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELAMJ1T1    YL0028           OHE Booking Num
     C                     END                             *FI
      * Update container # from # entered on the screen, including blanks
      * CASE: DB1.OHE Container Number NE PAR.Container Number
     C           AMJ2T1    IFNE #RBDU1                     *IF
     C                     MOVEL#RBDU1    YL0029           OHE Container N
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELAMJ2T1    YL0029           OHE Container N
     C                     END                             *FI
      * R15161 DN 07/17/19-Replaced Voyage with OHE Voyage/Flight.
      * CHG Existing OHE       CH - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDAMAIC3    WL0028           Company Number
     C                     Z-ADDAMC4NB    WL0029           Order Number
     C                     Z-ADD#1RMNB    WL0030           Load ID
     C                     Z-ADDAMRUNB    WL0031           Stop/Drop Seque
     C                     MOVEL#CXACD    WL0032    P      Shipping Line
     C                     MOVEL#CAWAA    WL0033    P      Port Delv Termi
     C                     MOVEL#CHBAA    WL0034    P      OHE City
     C                     MOVEL#CJ0T1    WL0035    P      OHE Vessel/Airl
     C                     MOVEL#CGENY    WL0036    P      OHE Voyage/Flig
     C                     MOVELYL0028    WL0037    P      OHE Booking Num
     C                     MOVEL#CHCAA    WL0038    P      OHE Discharge P
     C                     Z-ADDP2QWDT    WL0039           OHE Sail/Flight
     C                     Z-ADDAMQXDT    WL0040           OHE Port Cut Da
     C                     Z-ADDP2QYDT    WL0041           OHE Arrival Dat
     C                     MOVELAMHDAA    WL0042    P      OHE Late Delive
     C                     MOVEL#1VCST    WL0043    P      OHE Ship Status
     C                     MOVELYL0029    WL0044    P      OHE Container N
     C                     MOVELAMRLNA    WL0045    P      OHE Comment 1
     C                     MOVELAMRMNA    WL0046    P      OHE Comment 2
     C                     Z-ADDAMGINY    WL0047           OHE Unused Numb
     C                     Z-ADDAMGFNY    WL0048           OHE Unused Numb
     C                     Z-ADDAMGGNY    WL0049           OHE Unused Numb
     C                     Z-ADDAMGHNY    WL0050           OHE Unused Numb
     C                     Z-ADDAMHEVL    WL0051           OHE HPB RIN Equ
     C                     Z-ADDAMHFVL    WL0052           OHE HPB RIN Pri
     C                     Z-ADDAMHGVL    WL0053           Transload Termi
     C                     Z-ADDAMQZDT    WL0054           OHE Est Arrv at
     C                     Z-ADDAMQ0DT    WL0055           OHE Backhaul ET
     C                     Z-ADDAMQ1DT    WL0056           OHE Port/Pier P
     C                     Z-ADDAMQ2DT    WL0057           OHE Actual Ship
     C                     MOVELAMC2TX    WL0058    P      OHE Carrier SCA
     C                     MOVELAMC3TX    WL0059    P      OHE Spot Buy
     C                     MOVELAMC6TX    WL0060    P      OHE PO ACK Flag
     C                     MOVELAMCHTX    WL0061    P      OHE Override Ty
     C                     MOVELAMCITX    WL0062    P      OHE Backhaul St
     C                     MOVELAMCLTX    WL0063    P      OHE Backhaul ET
     C                     MOVEL#CB4TX    WL0064    P      OHE Load Haul T
     C                     MOVELAMCUTX    WL0065    P      OHE Backhaul Ca
     C                     MOVELAMCVTX    WL0066    P      OHE Bookings Co
     C                     MOVELAMB9TX    WL0067    P      OHE EDI Error R
     C                     MOVELAMJWSC    WL0068    P      OHE EDI Error R
     C                     Z-ADDAMITNY    WL0069           HPB COA Batch N
     C                     MOVELAMLMT1    WL0070    P      Delivery P.O. N
     C                     MOVELAMLWAA    WL0071    P      OHE Intended fo
     C                     MOVELAMFVST    WL0072    P      OHE EDI 943 Act
     C                     MOVELAMF0ST    WL0073    P      OHE EDI 944 Act
     C                     MOVELAMF2ST    WL0074    P      OHE EDI 940 Act
     C                     MOVELAMF3ST    WL0075    P      OHE EDI 945 Act
     C                     MOVELAMJUSC    WL0076    P      OHE EDI 856 Act
     C                     MOVELAMJVSC    WL0077    P      OHE EDI 824 Act
     C                     MOVELAMV3T1    WL0078    P      OHE Transload S
     C                     MOVELAMV4T1    WL0079    P      OHE Abs Rate Ov
     C                     MOVELAMV5T1    WL0080    P      OHE Appt Confir
     C                     MOVELAMV6T1    WL0081    P      OHE Backhaul Co
     C                     MOVELAMV7T1    WL0082    P      OHE Backhaul Ch
     C                     MOVELAMV8T1    WL0083    P      OHE Transload C
     C                     MOVELAMV9T1    WL0084    P      OHE Pier Pass I
     C                     MOVELAMWAT1    WL0085    P      OHE Carrier Nm
     C                     MOVELAMWBT1    WL0086    P      OHE Appt Confir
     C                     MOVELAMWCT1    WL0087    P      OHE Backhaul Co
     C                     MOVELAMWDT1    WL0088    P      Letter of Credi
     C                     Z-ADDAMQJNY    WL0089           OHE Backhaul Re
     C                     Z-ADDAMQKNY    WL0090           LD Stop/Drop
     C                     Z-ADDAMQLNY    WL0091           OHE Unused Numb
     C                     Z-ADDAMP8NY    WL0092           OHE Pier Pass F
     C                     Z-ADDAMP9NY    WL0093           OHE Port Check
     C                     Z-ADDAMQANY    WL0094           OHE Port Cut Ti
     C                     Z-ADDAMQCNY    WL0095           OHE Backhaul Tr
     C                     Z-ADDAMQDNY    WL0096           OHE Load Sched
     C                     Z-ADDAMQENY    WL0097           Original Appoin
     C                     Z-ADDAMQFNY    WL0098           Original Appoin
     C                     Z-ADDAMQGNY    WL0099           OHE PowerPro Lo
     C                     Z-ADDAMQHNY    WL0100           OHE PowerPro Lo
     C                     Z-ADDAMQINY    WL0101           OHE Unused Nume
     C                     Z-ADDAMQMNY    WL0102           OHE Orig ABS Fr
     C                     MOVELAMMYU1    WL0103    P      OHE Genset Numb
     C                     MOVELAMJXSC    WL0104    P      OHE Unused Stat
     C                     MOVELAMJYSC    WL0105    P      OHE Unused Stat
     C                     MOVELAMJZSC    WL0106    P      OHE Unused Stat
     C                     MOVELAMJ0SC    WL0107    P      OHE Unused Stat
     C                     MOVELAMMZU1    WL0108    P      OHE Unused Text
     C                     MOVELAMM0U1    WL0109    P      OHE Unused Text
     C                     MOVELAMM1U1    WL0110    P      OHE Unused Text
     C                     MOVELAMM2U1    WL0111    P      OHE Unused Text
     C                     MOVELAMM3U1    WL0112    P      OHE Unused Text
     C                     Z-ADDAMW5DT    WL0113           OHE Unused Date
     C                     Z-ADDAMW6DT    WL0114           OHE Unused Date
     C                     MOVELAMUVST    WL0115    P      EDI Status 1
     C                     MOVELAMUWST    WL0116    P      EDI Status 2
     C                     MOVELAMUXST    WL0117    P      EDI Status 3
     C                     MOVELAMVSST    WL0118    P      Record Status
     C                     Z-ADDAMAATM    WL0119           Job Time
     C                     MOVELAMAYNA    WL0120    P      User Id
     C                     MOVELAMA0NA    WL0121    P      Job Name
     C                     Z-ADDAMAXDT    WL0122           Job Date
     C                     EXSR SOCHRC
     C                     END                             *FI
     C           KRSTB     READE@AMREJM                  90*
     C                     ENDDO
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCCHRC    BEGSR
      *================================================================
      * CHG Deadline Dep D/T   CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0477  30       Company Number
     C                     Z-ADD*ZERO     WN0478  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0479  1        LTL Flag
     C                     MOVEL*BLANK    WN0480  1        Load Status
     C                     Z-ADD*ZERO     WN0481  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0482 15        Seal 1
     C                     MOVEL*BLANK    WN0483 15        Seal 2
     C                     MOVEL*BLANK    WN0484 15        Seal 3
     C                     MOVEL*BLANK    WN0485 15        Seal 4
     C                     MOVEL*BLANK    WN0486 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0487  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0488 112       Flat Amount
     C                     MOVEL*BLANK    WN0489  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0490  50       Total Stops
     C                     MOVEL*BLANK    WN0491 20        Trailer Id
     C                     MOVEL*BLANK    WN0492  3        Transloader Car
     C                     Z-ADD*ZERO     WN0493  40       BOL Time
     C                     MOVEL*BLANK    WN0494  3        Carrier Code
     C                     MOVEL*BLANK    WN0495  7        Truck Size
     C                     Z-ADD*ZERO     WN0496  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0497 112       Rated Freight
     C                     MOVEL*BLANK    WN0498  1        Ship Status
     C                     MOVEL*BLANK    WN0499  1        Load Type
     C                     Z-ADD*ZERO     WN0500  50       Number Pallets
     C                     Z-ADD*ZERO     WN0501  50       Number Pallets
     C                     Z-ADD*ZERO     WN0502 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0503  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0504  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0505  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0506 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0507 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0508  70       Actual Departur
     C                     Z-ADD*ZERO     WN0509  40       Departure Time
     C                     Z-ADD*ZERO     WN0510  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0511  52       Product Tempera
     C                     Z-ADD*ZERO     WN0512  50       Number Spacers
     C                     MOVEL*BLANK    WN0513 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0514  70       Total Load Mile
     C                     MOVEL*BLANK    WN0515 12        Recorder ID
     C                     MOVEL*BLANK    WN0516  2        Shipping Method
     C                     MOVEL*BLANK    WN0517  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0518  2        Ship To State C
     C                     Z-ADD*ZERO     WN0519  70       Gross Weight
     C                     MOVEL*BLANK    WN0520  3        Carrier Broker
     C                     MOVEL*BLANK    WN0521  1        Export Status
     C                     Z-ADD*ZERO     WN0522  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0523  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0524  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0525  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0526  70       Spotted Date
     C                     Z-ADD*ZERO     WN0527  60       Spotted Time
     C                     Z-ADD*ZERO     WN0528  70       Load Finished D
     C                     Z-ADD*ZERO     WN0529  60       Load Finished T
     C                     Z-ADD*ZERO     WN0530  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0531  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0532  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0533  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0534  70       Truck Departure
     C                     Z-ADD*ZERO     WN0535  60       Truck Departure
     C                     Z-ADD*ZERO     WN0536  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0537  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0538  3        Shipping Line
     C                     MOVEL*BLANK    WN0539 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0540 30        Vessel Name
     C                     Z-ADD*ZERO     WN0541  50       Voyage
     C                     Z-ADD*ZERO     WN0542  70       Sail Date
     C                     MOVEL*BLANK    WN0543 12        Booking Number
     C                     MOVEL*BLANK    WN0544 20        Discharge Port
     C                     Z-ADD*ZERO     WN0545  70       Arrival Date
     C                     MOVEL*BLANK    WN0546 12        Container Numbe
     C                     Z-ADD*ZERO     WN0547  70       Date In
     C                     Z-ADD*ZERO     WN0548  60       Time In
     C                     Z-ADD*ZERO     WN0549  70       Date Out
     C                     Z-ADD*ZERO     WN0550  60       Time Out
     C                     Z-ADD*ZERO     WN0551 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0552  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0553  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0554  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0555  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0556  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0557  70       Requested Deliv
     C                     MOVEL*BLANK    WN0558  1        Load Acceptance
     C                     MOVEL*BLANK    WN0559  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0560  70       On Yard Date
     C                     Z-ADD*ZERO     WN0561  60       On Yard Time
     C                     MOVEL*BLANK    WN0562  1        Load Held Over
     C                     MOVEL*BLANK    WN0563  1        Load Held Over
     C                     MOVEL*BLANK    WN0564 15        Load Held Over
     C                     MOVEL*BLANK    WN0565 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0566 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0567  70       Express Mail Da
     C                     MOVEL*BLANK    WN0568  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0569  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0570  70       Product Complet
     C                     Z-ADD*ZERO     WN0571  60       Product Complet
     C                     Z-ADD*ZERO     WN0572  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0573  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0574  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0575  1        Load Confirmed
     C                     MOVEL*BLANK    WN0576 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0577  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0578  60       Load Door 1
     C                     Z-ADD*ZERO     WN0579  70       Override Total
     C                     Z-ADD*ZERO     WN0580  60       Load Door 2
     C                     MOVEL*BLANK    WN0581  1        Partial Load
     C                     MOVEL*BLANK    WN0582  1        Load Confirmati
     C                     MOVEL*BLANK    WN0583  1        Export Load USD
     C                     MOVEL*BLANK    WN0584  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0585 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0586 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0587 15        Late Billing Em
     C                     MOVEL*BLANK    WN0588 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0589 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0590  1        Multi Company L
     C                     MOVEL*BLANK    WN0591  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0592  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0593  1        LH Power Only L
     C                     MOVEL*BLANK    WN0594  1        MG Created Load
     C                     MOVEL*BLANK    WN0595  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0596  2        Load U/M
     C                     MOVEL*BLANK    WN0597  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0598  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0599  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0600  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0601  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0602  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0603  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0604  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0605  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0606  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0607  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0608  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0609  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0610  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0611  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0612  60       LH Unused Time
     C                     MOVEL*BLANK    WN0613  1        EDI Status 1
     C                     MOVEL*BLANK    WN0614  1        EDI Status 2
     C                     MOVEL*BLANK    WN0615  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0616  60       Job Time
     C                     MOVEL*BLANK    WN0617 10        User Id
     C                     MOVEL*BLANK    WN0618 10        Job Name
     C                     Z-ADD*ZERO     WN0619  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YIRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADD#1RMNB    FJRMNB           Load ID
      *
     C           KLCHTC    KLIST
     C                     KFLD           FJRMNB           Load ID
     C           KLCHTC    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL009.
     C                     MOVEL'LBL009'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE @1DBRC    YIRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDYL0034    FJKZDT           Deadline Depart
     C                     Z-ADDYL0035    FJAXTM           Deadline Depart
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     FJAATM           Job Time
     C                     MOVEL##USR     FJAYNA           User Id
     C                     MOVEL##JOB     FJA0NA           Job Name
     C                     Z-ADD##JDT     FJAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YIRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * CHG Deadline Date/Time RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQTD01           Load ID
      * Define keylist
     C           KPSTD     KLIST
     C                     KFLD           WQTD01           Load ID
     C                     KFLD           FLRUNB           Stop/Drop Seque
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WQTD01           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQTD01           Load ID
     C                     Z-ADD0         FLRUNB           Stop/Drop Seque
      * Establish starting position
     C           KPSTD     SETLL@FLCPBW                    *
     C           KRSTD     READE@FLCPBW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TDEXIT                     *QUIT
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Deadline Date/Time CH - Load Detail  * 
     C                     EXSR TECHRC
     C           KRSTD     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TECHRC    BEGSR
      *================================================================
      * CHG Deadline Date/Time CH - Load Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0620  50       Stop/Drop
     C                     MOVEL*BLANK    WN0621 30        Comments for Pi
     C                     Z-ADD*ZERO     WN0622  50       Miles to next s
     C                     Z-ADD*ZERO     WN0623  72       Freight Charge
     C                     Z-ADD*ZERO     WN0624  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0625 112       Freight Misc. C
     C                     Z-ADD*ZERO     WN0626  72       Freight Stop Ch
     C                     Z-ADD*ZERO     WN0627 112       Rated Freight
     C                     Z-ADD*ZERO     WN0628  30       Company Number
     C                     Z-ADD*ZERO     WN0629  70       Order Number
     C                     MOVEL*BLANK    WN0630  1        Ship Status
     C                     Z-ADD*ZERO     WN0631  70       Estimated Arriv
     C                     Z-ADD*ZERO     WN0632  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0633  70       Appointment Con
     C                     Z-ADD*ZERO     WN0634  60       Appointment Con
     C                     MOVEL*BLANK    WN0635 30        Confirmation Ma
     C                     MOVEL*BLANK    WN0636 10        Confirmation Nu
     C                     Z-ADD*ZERO     WN0637  70       Actual Delivery
     C                     Z-ADD*ZERO     WN0638  60       Actual Delivery
     C                     Z-ADD*ZERO     WN0639  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0640  60       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0641  70       On Yard Date
     C                     Z-ADD*ZERO     WN0642  60       On Yard Time
     C                     Z-ADD*ZERO     WN0643  70       MPC Number
     C                     MOVEL*BLANK    WN0644  1        Load Dtl On Tim
     C                     MOVEL*BLANK    WN0645  1        On Time Add'l R
     C                     MOVEL*BLANK    WN0646 15        Seal Nbr 1
     C                     MOVEL*BLANK    WN0647 15        Seal Nbr 2
     C                     MOVEL*BLANK    WN0648 15        Seal Nbr 3
     C                     MOVEL*BLANK    WN0649 15        Seal Nbr 4
     C                     MOVEL*BLANK    WN0650 15        Seal Nbr 5
     C                     Z-ADD*ZERO     WN0651  70       LD Carrier Appt
     C                     Z-ADD*ZERO     WN0652  70       LD Unused Date
     C                     Z-ADD*ZERO     WN0653  70       LD Unused Date
     C                     Z-ADD*ZERO     WN0654  60       LD Carrier Appt
     C                     Z-ADD*ZERO     WN0655  60       LD Unused Time
     C                     Z-ADD*ZERO     WN0656  60       LD Unused Time
     C                     MOVEL*BLANK    WN0657  1        Miles Error Sts
     C                     MOVEL*BLANK    WN0658  1        LD Unused Sts 2
     C                     MOVEL*BLANK    WN0659  2        HPB Transload S
     C                     MOVEL*BLANK    WN0660 15        LD Cst Svc Trac
     C                     MOVEL*BLANK    WN0661 25        LD Unused Txt 2
     C                     MOVEL*BLANK    WN0662 25        LD Unused Txt 3
     C                     MOVEL*BLANK    WN0663  1        EDI Status 1
     C                     MOVEL*BLANK    WN0664  1        EDI Status 2
     C                     MOVEL*BLANK    WN0665  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0666  60       Job Time
     C                     MOVEL*BLANK    WN0667 10        User Id
     C                     MOVEL*BLANK    WN0668 10        Job Name
     C                     Z-ADD*ZERO     WN0669  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YJRDC   1
      *
      * Move key fields to @FLCPBM
     C                     Z-ADD#1RMNB    WERMNB           Load ID
     C                     Z-ADDFLRUNB    WERUNB           Stop/Drop Seque
      *
     C           KLCHTE    KLIST
     C                     KFLD           WERMNB           Load ID
     C                     KFLD           WERUNB           Stop/Drop Seque
     C           KLCHTE    CHAIN@FLCPBM              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFLCPL0'MDACP
     C                     MOVEL'@FLCPBM' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL010.
     C                     MOVEL'LBL010'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFL1    YJRDCS
      * Move non-key fields to @FLCPBM
     C                     Z-ADDYL0034    WEHDDT           Deadline Depart
     C                     Z-ADDYL0035    WEAUTM           Deadline Depart
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##JOB     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YJRDC     IFEQ 'Y'
     C                     UPDAT@FLCPBM                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFLCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
      * Upd Deadline Dte/Tme  RT - Order Detail  * 
     C                     EXSR TFRVGN
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * Upd Deadline Dte/Tme  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQTF01           Company Number
     C           *LIKE     DEFN WFC4NB    WQTF02           Order Number
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           WQTF01           Company Number
     C                     KFLD           WQTF02           Order Number
      * Setup key
     C                     Z-ADDWEAIC3    WQTF01           Company Number
     C                     Z-ADDWEC4NB    WQTF02           Order Number
      * Establish starting position
     C           KRSTF     SETLL@BGWKL1                    *
     C           KRSTF     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Deadline Dte/Tme  CH - Order Detail  * 
     C                     EXSR TGCHRC
     C           KRSTF     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGCHRC    BEGSR
      *================================================================
      * Chg Deadline Dte/Tme  CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0670  70       Item Code
     C                     MOVEL*BLANK    WN0671  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0672  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0673  70       Order Group Cod
     C                     MOVEL*BLANK    WN0674  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0675  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0676 112       Billing Detail
     C                     Z-ADD*ZERO     WN0677 112       Billing Detail
     C                     Z-ADD*ZERO     WN0678 112       Billing Detail
     C                     Z-ADD*ZERO     WN0679 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0680  1        Comment Print A
     C                     MOVEL*BLANK    WN0681  1        Comment Print I
     C                     MOVEL*BLANK    WN0682  1        Comment Print P
     C                     MOVEL*BLANK    WN0683  1        Comment Print S
     C                     Z-ADD*ZERO     WN0684 112       Extended Amount
     C                     Z-ADD*ZERO     WN0685  70       Market Pricing
     C                     MOVEL*BLANK    WN0686  3        Commodity Marke
     C                     MOVEL*BLANK    WN0687  3        Date Method Cod
     C                     MOVEL*BLANK    WN0688  3        Price Method Co
     C                     Z-ADD*ZERO     WN0689 114       Price Overage O
     C                     Z-ADD*ZERO     WN0690  70       Contract Number
     C                     MOVEL*BLANK    WN0691  1        Price Status
     C                     Z-ADD*ZERO     WN0692  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0693  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0694  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0695  1        Work Confirm St
     C                     MOVEL*BLANK    WN0696  1        Work Over/Short
     C                     MOVEL*BLANK    WN0697  1        OD Production P
     C                     MOVEL*BLANK    WN0698 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0699 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0700  1        Age Code
     C                     MOVEL*BLANK    WN0701  1        Palletize
     C                     MOVEL*BLANK    WN0702  1        Slip Sheet
     C                     MOVEL*BLANK    WN0703  1        Catch Weight St
     C                     MOVEL*BLANK    WN0704  1        Price Audit
     C                     MOVEL*BLANK    WN0705  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0706  1        Production Date
     C                     Z-ADD*ZERO     WN0707 112       Rated Freight
     C                     Z-ADD*ZERO     WN0708 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0709 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0710 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0711 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0712 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0713 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0714 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0715 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0716 114       Unit Price
     C                     Z-ADD*ZERO     WN0717 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0718 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0719 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0720 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0721  70       Requested Ship
     C                     Z-ADD*ZERO     WN0722  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0723  70       Actual Shipped
     C                     MOVEL*BLANK    WN0724  1        Affect Inventor
     C                     MOVEL*BLANK    WN0725  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0726  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0727  30       Item Structure
     C                     Z-ADD*ZERO     WN0728  30       Item Structure
     C                     Z-ADD*ZERO     WN0729  30       Item Structure
     C                     MOVEL*BLANK    WN0730  2        Item Level
     C                     MOVEL*BLANK    WN0731  2        Quality Level
     C                     MOVEL*BLANK    WN0732  2        Pricing Product
     C                     MOVEL*BLANK    WN0733  2        Season Product
     C                     Z-ADD*ZERO     WN0734  70       Date of Origina
     C                     MOVEL*BLANK    WN0735 10        User Profile Na
     C                     MOVEL*BLANK    WN0736  6        Country Code
     C                     MOVEL*BLANK    WN0737  2        Event Code
     C                     MOVEL*BLANK    WN0738  3        Reason Code
     C                     MOVEL*BLANK    WN0739  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0740  1        Modified Flag
     C                     MOVEL*BLANK    WN0741  1        Substituted Fla
     C                     MOVEL*BLANK    WN0742  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0743 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0744 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0745  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0746  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0747  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0748  1        Affect Commissi
     C                     MOVEL*BLANK    WN0749  1        Affect Pricing
     C                     MOVEL*BLANK    WN0750  1        Released by Use
     C                     MOVEL*BLANK    WN0751  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0752  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0753  3        Production Ware
     C                     MOVEL*BLANK    WN0754  3        OD Price Type
     C                     Z-ADD*ZERO     WN0755  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0756  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0757  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0758  70       OD Unused Date
     C                     Z-ADD*ZERO     WN0759  60       Price Code
     C                     Z-ADD*ZERO     WN0760  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0761  60       Substitution Li
     C                     Z-ADD*ZERO     WN0762  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0763 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0764 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0765 112       OD Item Target
     C                     Z-ADD*ZERO     WN0766 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0767 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0768 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0769 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0770 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0771 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0772 114       OD Unused Prc 5
     C                     Z-ADD*ZERO     WN0773 114       OD Unused Prc 6
     C                     Z-ADD*ZERO     WN0774 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0775 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0776  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0777  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0778  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0779 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0780  40       Item Age Days
     C                     Z-ADD*ZERO     WN0781  70       Production Ovr
     C                     Z-ADD*ZERO     WN0782  70       Production Ovr
     C                     MOVEL*BLANK    WN0783  1        OD UnUsed Statu
     C                     MOVEL*BLANK    WN0784  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0785  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0786  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0787  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0788  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0789  1        EDI Status 1
     C                     MOVEL*BLANK    WN0790  1        EDI Status 2
     C                     MOVEL*BLANK    WN0791  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0792  60       Job Time
     C                     MOVEL*BLANK    WN0793 10        User Id
     C                     MOVEL*BLANK    WN0794 10        Job Name
     C                     Z-ADD*ZERO     WN0795  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YKRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWFAIC3    WGAIC3           Company Number
     C                     Z-ADDWFC4NB    WGC4NB           Order Number
     C                     Z-ADDWFDPNB    WGDPNB           Order Sequence
     C                     Z-ADDWFUENB    WGUENB           Order Secondary
      *
     C           KLCHTG    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
     C                     KFLD           WGDPNB           Order Sequence
     C                     KFLD           WGUENB           Order Secondary
     C           KLCHTG    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL011.
     C                     MOVEL'LBL011'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YKRDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDWEHDDT    WGNVDT           Deadline Depart
     C                     Z-ADDWEAUTM    WGBUTM           Deadline Depart
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##JOB     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YKRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * Chg Carrier           RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/13/04 SLM PKTR01 Multi-Company - Function was changed
      *                                    to remove Company RST or Pos
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHRMNB    WQTH02           Load ID
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           WQTH02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQTH02           Load ID
      * Establish starting position
     C           KRSTH     SETLL@BFCPD9                    *
     C           KRSTH     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Load Information   CH - Order Header TRG  * 
     C                     EXSR TICHRC
     C           KRSTH     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TICHRC    BEGSR
      *================================================================
      * Chg Load Information   CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0796  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0797  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0798  70       Ship To Custome
     C                     MOVEL*BLANK    WN0799 30        Ship To Name
     C                     MOVEL*BLANK    WN0800 30        Ship To Address
     C                     MOVEL*BLANK    WN0801 30        Ship To Address
     C                     MOVEL*BLANK    WN0802 30        Ship To Address
     C                     MOVEL*BLANK    WN0803 20        Ship To City
     C                     MOVEL*BLANK    WN0804  2        Ship To State C
     C                     MOVEL*BLANK    WN0805 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0806  70       Bill to Custome
     C                     MOVEL*BLANK    WN0807 30        Bill to Name
     C                     MOVEL*BLANK    WN0808 30        Bill to Address
     C                     MOVEL*BLANK    WN0809 30        Bill to Address
     C                     MOVEL*BLANK    WN0810 30        Bill to Address
     C                     MOVEL*BLANK    WN0811 20        Bill to City
     C                     MOVEL*BLANK    WN0812  2        Bill to State C
     C                     MOVEL*BLANK    WN0813 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0814 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0815  70       Order Date
     C                     Z-ADD*ZERO     WN0816  70       Requested Ship
     C                     Z-ADD*ZERO     WN0817  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0818  70       Cancel Date
     C                     MOVEL*BLANK    WN0819  2        Terms Code
     C                     MOVEL*BLANK    WN0820 40        Special Instruc
     C                     MOVEL*BLANK    WN0821 40        Special Instruc
     C                     MOVEL*BLANK    WN0822  1        Comment Print A
     C                     MOVEL*BLANK    WN0823  1        Comment Print I
     C                     MOVEL*BLANK    WN0824  1        Comment Print P
     C                     MOVEL*BLANK    WN0825  1        Comment Print S
     C                     MOVEL*BLANK    WN0826  3        Reason Code
     C                     MOVEL*BLANK    WN0827  1        Order in Use
     C                     MOVEL*BLANK    WN0828  1        Header Status
     C                     MOVEL*BLANK    WN0829  1        Header Status L
     C                     MOVEL*BLANK    WN0830  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0831  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0832 10        User Original E
     C                     Z-ADD*ZERO     WN0833  70       Date of Origina
     C                     Z-ADD*ZERO     WN0834 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0835 112       Order Weight To
     C                     MOVEL*BLANK    WN0836  1        Credit Hold
     C                     MOVEL*BLANK    WN0837  1        Production Hold
     C                     MOVEL*BLANK    WN0838  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0839  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0840  40       Requested Deliv
     C                     MOVEL*BLANK    WN0841  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0842 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0843  52       Absorbed Freigh
     C                     MOVEL*BLANK    WN0844  1        LTL Flag
     C                     MOVEL*BLANK    WN0845  1        Price Audit
     C                     MOVEL*BLANK    WN0846  1        Price Status
     C                     MOVEL*BLANK    WN0847  2        Shipping Method
     C                     MOVEL*BLANK    WN0848  1        Export Status
     C                     MOVEL*BLANK    WN0849  1        Palletize
     C                     MOVEL*BLANK    WN0850  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0851  1        Slip Sheet
     C                     MOVEL*BLANK    WN0852  1        Age Code
     C                     Z-ADD*ZERO     WN0853  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0854  1        Load Type
     C                     Z-ADD*ZERO     WN0855  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0856  1        Load Plan Order
     C                     MOVEL*BLANK    WN0857  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0858  70       Resell Referenc
     C                     MOVEL*BLANK    WN0859 30        Special Comment
     C                     MOVEL*BLANK    WN0860 30        Special Comment
     C                     MOVEL*BLANK    WN0861  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0862  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0863  2        Manager Level C
     C                     MOVEL*BLANK    WN0864  3        VP Level Code
     C                     Z-ADD*ZERO     WN0865  70       Attach to Order
     C                     MOVEL*BLANK    WN0866  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0867  70       Invoice Number
     C                     MOVEL*BLANK    WN0868  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0869  70       Invoice Date
     C                     MOVEL*BLANK    WN0870  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0871  1        Modified Flag
     C                     Z-ADD*ZERO     WN0872 112       A/R order Value
     C                     MOVEL*BLANK    WN0873  1        Billing Activit
     C                     MOVEL*BLANK    WN0874  1        Block Order Fla
     C                     MOVEL*BLANK    WN0875  1        Order Certifica
     C                     Z-ADD*ZERO     WN0876 112       Invoice Order V
     C                     MOVEL*BLANK    WN0877  1        Process Sts for
     C                     MOVEL*BLANK    WN0878  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0879  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0880  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0881  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0882  1        Email Cust On O
     C                     MOVEL*BLANK    WN0883  1        Order Emailed
     C                     MOVEL*BLANK    WN0884  1        Export Docs Go
     C                     MOVEL*BLANK    WN0885  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0886  1        Broker Order St
     C                     MOVEL*BLANK    WN0887  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0888  2        Order Requires
     C                     MOVEL*BLANK    WN0889  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0890  2        Export USDA App
     C                     MOVEL*BLANK    WN0891  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0892  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0893  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0894  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0895  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0896  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0897  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0898  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0899  60       Time of Origina
     C                     Z-ADD*ZERO     WN0900  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0901  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0902  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0903 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0904 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0905 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0906 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0907 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0908  70       Claim Number
     C                     MOVEL*BLANK    WN0909  1        EDI Status 1
     C                     MOVEL*BLANK    WN0910  1        EDI Status 2
     C                     MOVEL*BLANK    WN0911  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0912  60       Job Time
     C                     MOVEL*BLANK    WN0913 10        User Id
     C                     MOVEL*BLANK    WN0914 10        Job Name
     C                     Z-ADD*ZERO     WN0915  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YLRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWHAIC3    WIAIC3           Company Number
     C                     Z-ADDWHC4NB    WIC4NB           Order Number
      *
     C           KLCHTI    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIC4NB           Order Number
     C           KLCHTI    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL012.
     C                     MOVEL'LBL012'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YLRDCS
      * Move non-key fields to @BECPFJ
     C                     MOVEL#1BZNA    WIBZNA    P      Carrier Code
     C                     Z-ADDWHRMNB    WIRMNB           Load ID
     C                     Z-ADDWHR1NB    WIR1NB           Rated Freight
     C                     MOVELWHJPCD    WIJPCD    P      Event Code
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YLRDCS
     C           YLRDC     ANDNE'N'
     C                     MOVE 'Y'       YLRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WIAATM           Job Time
     C                     MOVEL##USR     WIAYNA           User Id
     C                     MOVEL##PGM     WIA0NA           Job Name
     C                     Z-ADD##JDT     WIAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPCRC
     C                     Z-ADDWIAIC3    PCAIC3           Company Number
     C                     Z-ADDWIC4NB    PCC4NB           Order Number
     C                     MOVELWIJNCD    PCJNCD    P      Order Type - Sa
     C                     Z-ADDWIANC7    PCANC7           A/R Customer Nu
     C                     Z-ADDWIBKC7    PCBKC7           Ship To Custome
     C                     MOVELWIBRTX    PCBRTX    P      Ship To Name
     C                     MOVELWIHMNA    PCHMNA    P      Ship To Address
     C                     MOVELWIHONA    PCHONA    P      Ship To Address
     C                     MOVELWIHPNA    PCHPNA    P      Ship To Address
     C                     MOVELWIHNNA    PCHNNA    P      Ship To City
     C                     MOVELWIDBCD    PCDBCD    P      Ship To State C
     C                     MOVELWICKTX    PCCKTX    P      Ship To Zip/Pos
     C                     Z-ADDWIB0C7    PCB0C7           Bill to Custome
     C                     MOVELWIAETX    PCAETX    P      Bill to Name
     C                     MOVELWIB1NA    PCB1NA    P      Bill to Address
     C                     MOVELWIB3NA    PCB3NA    P      Bill to Address
     C                     MOVELWIB4NA    PCB4NA    P      Bill to Address
     C                     MOVELWIB2NA    PCB2NA    P      Bill to City
     C                     MOVELWIBHCD    PCBHCD    P      Bill to State C
     C                     MOVELWIC8TX    PCC8TX    P      Bill to Zip/Pos
     C                     MOVELWIBCNA    PCBCNA    P      Customer Purcha
     C                     Z-ADDWIA0DT    PCA0DT           Order Date
     C                     Z-ADDWIA5DT    PCA5DT           Requested Ship
     C                     Z-ADDWIGNDT    PCGNDT           Actual Shipped
     C                     Z-ADDWIACDT    PCACDT           Cancel Date
     C                     MOVELWIAQCD    PCAQCD    P      Terms Code
     C                     MOVELWIB6NA    PCB6NA    P      Special Instruc
     C                     MOVELWIBYNA    PCBYNA    P      Special Instruc
     C                     MOVELWIBZNA    PCBZNA    P      Carrier Code
     C                     MOVELWIGTST    PCGTST    P      Comment Print A
     C                     MOVELWIGVST    PCGVST    P      Comment Print I
     C                     MOVELWIGUST    PCGUST    P      Comment Print P
     C                     MOVELWIQFST    PCQFST    P      Comment Print S
     C                     MOVELWICQCD    PCCQCD    P      Reason Code
     C                     MOVELWIGJST    PCGJST    P      Order in Use
     C                     MOVELWIGWST    PCGWST    P      Header Status
     C                     MOVELWIGXST    PCGXST    P      Header Status L
     C                     MOVELWIGYST    PCGYST    P      Order Type Prin
     C                     Z-ADDWIAODT    PCAODT           Scheduled Ship
     C                     MOVELWIAIVN    PCAIVN    P      User Original E
     C                     Z-ADDWICXDT    PCCXDT           Date of Origina
     C                     Z-ADDWIJZVA    PCJZVA           Order Value Tot
     C                     Z-ADDWIA1WG    PCA1WG           Order Weight To
     C                     MOVELWIXIST    PCXIST    P      Credit Hold
     C                     MOVELWIXJST    PCXJST    P      Production Hold
     C                     MOVELWIXKST    PCXKST    P      New Customer Ho
     C                     Z-ADDWIEIDT    PCEIDT           Requested Deliv
     C                     Z-ADDWIAFTM    PCAFTM           Requested Deliv
     C                     MOVELWIE8CD    PCE8CD    P      Accounts Receiv
     C                     MOVELWIE9CD    PCE9CD    P      Accounts Receiv
     C                     Z-ADDWIRMNB    PCRMNB           Load ID
     C                     Z-ADDWITBNB    PCTBNB           Absorbed Freigh
     C                     Z-ADDWIR1NB    PCR1NB           Rated Freight
     C                     MOVELWIPJST    PCPJST    P      LTL Flag
     C                     MOVELWIU0ST    PCU0ST    P      Price Audit
     C                     MOVELWIU1ST    PCU1ST    P      Price Status
     C                     MOVELWIQ2CD    PCQ2CD    P      Shipping Method
     C                     MOVELWIU2ST    PCU2ST    P      Export Status
     C                     MOVELWIVEST    PCVEST    P      Palletize
     C                     MOVELWIVFST    PCVFST    P      Shrink Wrap
     C                     MOVELWIVGST    PCVGST    P      Slip Sheet
     C                     MOVELWIRPCD    PCRPCD    P      Age Code
     C                     Z-ADDWIRNNB    PCRNNB           Reefer Temperat
     C                     MOVELWIVDST    PCVDST    P      Load Type
     C                     Z-ADDWIATIN    PCATIN           Attach to Invoi
     C                     MOVELWIU4ST    PCU4ST    P      Load Plan Order
     C                     MOVELWIU5ST    PCU5ST    P      Print Pick Slip
     C                     Z-ADDWIRSRN    PCRSRN           Resell Referenc
     C                     MOVELWIMHNA    PCMHNA    P      Special Comment
     C                     MOVELWIMINA    PCMINA    P      Special Comment
     C                     MOVELWIWBST    PCWBST    P      Affect Auto Acc
     C                     MOVELWIR4CD    PCR4CD    P      Sales Route Cod
     C                     MOVELWIBFCD    PCBFCD    P      Manager Level C
     C                     MOVELWIQ4CD    PCQ4CD    P      VP Level Code
     C                     Z-ADDWIT3NB    PCT3NB           Attach to Order
     C                     MOVELWISICD    PCSICD    P      Reason for Pric
     C                     Z-ADDWICONB    PCCONB           Invoice Number
     C                     MOVELWICEST    PCCEST    P      Invoice Suffix
     C                     Z-ADDWIAWDT    PCAWDT           Invoice Date
     C                     MOVELWIJPCD    PCJPCD    P      Event Code
     C                     MOVELWIXUST    PCXUST    P      Trans Contol AS
     C                     MOVELWIZ1ST    PCZ1ST    P      Modified Flag
     C                     Z-ADDWIVRVA    PCVRVA           A/R order Value
     C                     MOVELWIOBST    PCOBST    P      Billing Activit
     C                     MOVELWIBCST    PCBCST    P      Block Order Fla
     C                     MOVELWIBDST    PCBDST    P      Order Certifica
     C                     Z-ADDWIB7VL    PCB7VL           Invoice Order V
     C                     MOVELWIGASX    PCGASX    P      Process Sts for
     C                     MOVELWIGBSX    PCGBSX    P      Order Conf Fax
     C                     MOVELWIGCSX    PCGCSX    P      Manifest Fax St
     C                     MOVELWIGDSX    PCGDSX    P      Invoice Fax Sts
     C                     MOVELWIFNSX    PCFNSX    P      Transfer in Sto
     C                     MOVELWIFOSX    PCFOSX    P      Email Cust On O
     C                     MOVELWIFPSX    PCFPSX    P      Order Emailed
     C                     MOVELWIFQSX    PCFQSX    P      Export Docs Go
     C                     MOVELWIFRSX    PCFRSX    P      Shipping Temp C
     C                     MOVELWIFSSX    PCFSSX    P      Broker Order St
     C                     MOVELWIFTSX    PCFTSX    P      Air Freight Ord
     C                     MOVELWIFUSX    PCFUSX    P      Order Requires
     C                     MOVELWIFVSX    PCFVSX    P      OH Load Plan Re
     C                     MOVELWIFWSX    PCFWSX    P      Export USDA App
     C                     MOVELWIFXSX    PCFXSX    P      HPB Ship to War
     C                     MOVELWIFYSX    PCFYSX    P      OH TF Exempt Co
     C                     Z-ADDWINODT    PCNODT           OH Appt Confirm
     C                     Z-ADDWINPDT    PCNPDT           JPN Invoice Iss
     C                     Z-ADDWINQDT    PCNQDT           Load Actual Shi
     C                     Z-ADDWINRDT    PCNRDT           Load BOL Comple
     C                     Z-ADDWINSDT    PCNSDT           Load Truck Depa
     C                     Z-ADDWIBPTM    PCBPTM           Maximum Gross W
     C                     Z-ADDWIBQTM    PCBQTM           Time of Origina
     C                     Z-ADDWIBRTM    PCBRTM           OH Appt Confirm
     C                     Z-ADDWIBSTM    PCBSTM           Load BOL Comple
     C                     Z-ADDWIBTTM    PCBTTM           Load Truck Depa
     C                     Z-ADDWIH0NX    PCH0NX           Act Frt Referen
     C                     Z-ADDWIH1NX    PCH1NX           Act Non-Ref Frt
     C                     Z-ADDWIH2NX    PCH2NX           OH Fuel Surchar
     C                     Z-ADDWIH3NX    PCH3NX           OH Total Non-Re
     C                     Z-ADDWIH4NX    PCH4NX           OH Total Ref Fr
     C                     Z-ADDWIC0C7    PCC0C7           Claim Number
     C                     MOVELWIUVST    PCUVST    P      EDI Status 1
     C                     MOVELWIUWST    PCUWST    P      EDI Status 2
     C                     MOVELWIUXST    PCUXST    P      EDI Status 3
     C                     Z-ADDWIAATM    PCAATM           Job Time
     C                     MOVELWIAYNA    PCAYNA    P      User Id
     C                     MOVELWIA0NA    PCA0NA    P      Job Name
     C                     Z-ADDWIAXDT    PCAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YLRDCS
     C           YLRDC     ANDNE'N'
     C                     MOVE 'Y'       YLRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YLRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * RTV SSI Fax'd Flag     RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           WJRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WJRMNB           Load ID
      * Establish starting position
     C           KRSTJ     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWJRUSX    WURUSX           Fax Sent to SSI
     C                     ENDIF
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTK     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0916    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSTK     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    P1I6ST           Allow Multi-Com
     C                     MOVELDRMPNA    P1MPNA           Default Printer
     C                     MOVELDRBCCD    P1BCCD           Salesperson Cod
     C                     Z-ADDDRAIC3    YL0037           Company Number
     C                     MOVELDRBUVN    WN0917           User Code Model
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - User Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0129    DTAJVN           User Profile Na
     C                     MOVELWL0130    DTDNCD           Application Cod
      * Establish starting position
     C           KRSTL     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0131           Company Number
     C                     MOVELDTAJCD    WL0132           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQTM01           Application Cod
      * Define keylist
     C           KRSTM     KLIST
     C                     KFLD           WQTM01           Application Cod
      * Setup key
     C                     MOVELP1DNCD    WQTM01           Application Cod
      * Establish starting position
     C           KRSTM     SETLL@DNRESF                    *
     C           KRSTM     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR TNRVGN
     C                     END                             *FI
     C           KRSTM     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQTN01           Application Cod
      * Define keylist
     C           KRSTN     KLIST
     C                     KFLD           WQTN01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQTN01           Application Cod
      * Establish starting position
     C           KRSTN     SETLL@DNRESF                    *
     C           KRSTN     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TNEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSTN     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Update CTL fields from PAR
      *================================================================
      * CTL = PAR By name
     C                     Z-ADDP3AODT    #2AODT           Scheduled Ship
     C                     Z-ADDP4HODT    #CHODT           Scheduled Ship
     C                     MOVELP3BZNA    #2BZNA           Carrier Code
     C                     MOVELP2J1T1    #CJ1T1           OHE Booking Num
     C                     MOVELP2J0T1    #CJ0T1           OHE Vessel/Airl
     C                     MOVELP2GENY    #CGENY           OHE Voyage/Flig
     C                     MOVELP7BOCD    #CBOCD           Type Code
     C                     MOVELP2XACD    #CXACD           Shipping Line
     C                     MOVELP2HCAA    #CHCAA           OHE Discharge P
     C                     MOVELP2HBAA    #CHBAA           OHE City
     C                     MOVELP2B4TX    #CB4TX           OHE Load Haul T
     C                     MOVELP6WPST    #CWPST           Warehouse Type
     C                     Z-ADDP2AIC3    #CBNC3           Company
     C                     Z-ADDP2RMNB    #CLOID           Load ID USR
     C                     Z-ADDP4HODT    #CHODT           Scheduled Ship
     C                     MOVELP3BZNA    #2BZNA           Carrier Code
     C                     MOVELP2OANA    #CAWAA           Delivery Termin
      * Format "Include Status" text
      * CASE: PAR.Include Sts is All Items
     C           P5SNSX    IFEQ 'A'                        *IF
     C                     MOVEL@CN,001   #CNLTX           USR 15 Text
     C                     ELSE
      * CASE: PAR.Include Sts is Booked Only
     C           P5SNSX    IFEQ 'B'                        *IF
     C                     MOVEL@CN,002   #CNLTX           USR 15 Text
     C                     ELSE
      * CASE: PAR.Include Sts is Unbooked Only
     C           P5SNSX    IFEQ 'U'                        *IF
     C                     MOVEL@CN,003   #CNLTX           USR 15 Text
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Format "Include Warehouse Type" text
      * CASE: PAR.Warehouse Type is Fresh
     C           P6WPST    IFEQ 'FR'                       *IF
     C                     MOVEL@CN,001   #CNLTX           USR 15 Text
     C                     ELSE
      * CASE: PAR.Include Sts is Booked Only
     C           P5SNSX    IFEQ 'B'                        *IF
     C                     MOVEL@CN,002   #CNLTX           USR 15 Text
     C                     ELSE
      * CASE: PAR.Include Sts is Unbooked Only
     C           P5SNSX    IFEQ 'U'                        *IF
     C                     MOVEL@CN,003   #CNLTX           USR 15 Text
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * ***** Changes and comments
      *================================================================
      * ** 05/14/2012 LJB E002105
      * ** Restrict to Carrier/Trailer, okay if multiple carriers have
      * ** the same trailer id
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD13        ZHSTRW  40
     C                     Z-ADD23        ZHNDRW  40
     C                     Z-ADD1         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
      *
     C           YPMRRN    IFGT *ZERO
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
     C                     END
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1AJCD           Warehouse Code
     C                     MOVEL*BLANK    P1DNCD           Application Cod
     C                     MOVEL*BLANK    P1BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P1I6ST           Allow Multi-Com
     C                     MOVEL*BLANK    P1I8ST           Allow Multi War
     C                     MOVEL*BLANK    P1MPNA           Default Printer
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Blank for 3          USR
     C                     MOVEL*BLANK    WUUAT1  3
      * Define work field Ship To Customer
     C                     Z-ADD*ZERO     WUBKC7  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WAA0DT           Order Date
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WAACDT           Cancel Date
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WAJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WAA1WG           Order Weight To
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WATBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WAATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WARSRN           Resell Referenc
     C                     Z-ADD*ZERO     WAT3NB           Attach to Order
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WAAWDT           Invoice Date
     C                     Z-ADD*ZERO     WAVRVA           A/R order Value
     C                     Z-ADD*ZERO     WAB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WANODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WANPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WANQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WANRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WANSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WABPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WABQTM           Time of Origina
     C                     Z-ADD*ZERO     WABRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WABSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WABTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WAH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WAH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WAH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WAH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WAH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBKKDT           On Yard Date
     C                     Z-ADD*ZERO     WBAVTM           On Yard Time
     C                     Z-ADD*ZERO     WBLCDT           Date Unused 1
     C                     Z-ADD*ZERO     WBLDDT           Date Unused 2
     C                     Z-ADD*ZERO     WBLEDT           Date Unused 3
     C                     Z-ADD*ZERO     WBLFDT           Date Unused 4
     C                     Z-ADD*ZERO     WBLGDT           Date Unused 5
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field OHE Container Number
     C                     MOVEL*BLANK    WUJ2T1 12
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WCRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WCFLAM           Flat Amount
     C                     Z-ADD*ZERO     WCRRNB           Total Stops
     C                     Z-ADD*ZERO     WCSBNB           BOL Time
     C                     Z-ADD*ZERO     WCSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCSDNB           Number Pallets
     C                     Z-ADD*ZERO     WCPAOU           Number Pallets
     C                     Z-ADD*ZERO     WCDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WCSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WCHADT           Actual Arrival
     C                     Z-ADD*ZERO     WCAART           Actual Arrival
     C                     Z-ADD*ZERO     WCDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WCDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WCAQDT           Actual Departur
     C                     Z-ADD*ZERO     WCS6NB           Departure Time
     C                     Z-ADD*ZERO     WCT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WCPRTM           Product Tempera
     C                     Z-ADD*ZERO     WCNPSV           Number Spacers
     C                     Z-ADD*ZERO     WCTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WCGRWE           Gross Weight
     C                     Z-ADD*ZERO     WCF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WCJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WCTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WCJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WCSPTM           Spotted Time
     C                     Z-ADD*ZERO     WCJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WCLFTM           Load Finished T
     C                     Z-ADD*ZERO     WCJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WCBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WCJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WCBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WCKIDT           Truck Departure
     C                     Z-ADD*ZERO     WCASTM           Truck Departure
     C                     Z-ADD*ZERO     WCKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WCAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WCVOAG           Voyage
     C                     Z-ADD*ZERO     WCKBDT           Sail Date
     C                     Z-ADD*ZERO     WCEFDT           Arrival Date
     C                     Z-ADD*ZERO     WCKCDT           Date In
     C                     Z-ADD*ZERO     WCTMIN           Time In
     C                     Z-ADD*ZERO     WCKDDT           Date Out
     C                     Z-ADD*ZERO     WCVMNB           Time Out
     C                     Z-ADD*ZERO     WCOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WCKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WCATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WCBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WCEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WCKKDT           On Yard Date
     C                     Z-ADD*ZERO     WCAVTM           On Yard Time
     C                     Z-ADD*ZERO     WCKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WCAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WCLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WCK0DT           Product Complet
     C                     Z-ADD*ZERO     WCAYTM           Product Complet
     C                     Z-ADD*ZERO     WCKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WCICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WCIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WCK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WCAZTM           Load Door 1
     C                     Z-ADD*ZERO     WCK2DT           Override Total
     C                     Z-ADD*ZERO     WCA0TM           Load Door 2
     C                     Z-ADD*ZERO     WCZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WCPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WCCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WCPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WCCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WCP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WCCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WCP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WCCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WCP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WCCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WCP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WCCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WDQWDT           OHE Sail/Flight
     C                     Z-ADD*ZERO     WDQXDT           OHE Port Cut Da
     C                     Z-ADD*ZERO     WDQYDT           OHE Arrival Dat
     C                     Z-ADD*ZERO     WDGINY           OHE Unused Numb
     C                     Z-ADD*ZERO     WDGFNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WDGGNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WDGHNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WDHEVL           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WDHFVL           OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WDHGVL           Transload Termi
     C                     Z-ADD*ZERO     WDQZDT           OHE Est Arrv at
     C                     Z-ADD*ZERO     WDQ0DT           OHE Backhaul ET
     C                     Z-ADD*ZERO     WDQ1DT           OHE Port/Pier P
     C                     Z-ADD*ZERO     WDQ2DT           OHE Actual Ship
     C                     Z-ADD*ZERO     WDITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WDQJNY           OHE Backhaul Re
     C                     Z-ADD*ZERO     WDQKNY           LD Stop/Drop
     C                     Z-ADD*ZERO     WDQLNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WDP8NY           OHE Pier Pass F
     C                     Z-ADD*ZERO     WDP9NY           OHE Port Check
     C                     Z-ADD*ZERO     WDQANY           OHE Port Cut Ti
     C                     Z-ADD*ZERO     WDQCNY           OHE Backhaul Tr
     C                     Z-ADD*ZERO     WDQDNY           OHE Load Sched
     C                     Z-ADD*ZERO     WDQENY           Original Appoin
     C                     Z-ADD*ZERO     WDQFNY           Original Appoin
     C                     Z-ADD*ZERO     WDQGNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WDQHNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WDQINY           OHE Unused Nume
     C                     Z-ADD*ZERO     WDQMNY           OHE Orig ABS Fr
     C                     Z-ADD*ZERO     WDW5DT           OHE Unused Date
     C                     Z-ADD*ZERO     WDW6DT           OHE Unused Date
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field Total Load Miles
     C                     Z-ADD*ZERO     WUTLMI  70
      * Define work field Override Total Load Miles
     C                     Z-ADD*ZERO     WUK2DT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WERMNB           Load ID
     C                     Z-ADD*ZERO     WERUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WERVNB           Stop/Drop
     C                     Z-ADD*ZERO     WERWNB           Miles to next s
     C                     Z-ADD*ZERO     WERXNB           Freight Charge
     C                     Z-ADD*ZERO     WESQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WET0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WET1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WER1NB           Rated Freight
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEC4NB           Order Number
     C                     Z-ADD*ZERO     WEKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WESXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WEKFDT           Appointment Con
     C                     Z-ADD*ZERO     WEACTM           Appointment Con
     C                     Z-ADD*ZERO     WEEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WEAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WEKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WEATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WEHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WEAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WEKKDT           On Yard Date
     C                     Z-ADD*ZERO     WEAVTM           On Yard Time
     C                     Z-ADD*ZERO     WEZ4NB           MPC Number
     C                     Z-ADD*ZERO     WEN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WEN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WEN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WEB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WEB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WEB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFC4NB           Order Number
     C                     Z-ADD*ZERO     WFDPNB           Order Sequence
     C                     Z-ADD*ZERO     WFUENB           Order Secondary
     C                     Z-ADD*ZERO     WFHGCD           Item Code
     C                     Z-ADD*ZERO     WFBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WFCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WFMAVA           Billing Detail
     C                     Z-ADD*ZERO     WFKDVA           Billing Detail
     C                     Z-ADD*ZERO     WFL8VA           Billing Detail
     C                     Z-ADD*ZERO     WFL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WFAYVA           Extended Amount
     C                     Z-ADD*ZERO     WFEXDT           Market Pricing
     C                     Z-ADD*ZERO     WFBZPR           Price Overage O
     C                     Z-ADD*ZERO     WFL6NB           Contract Number
     C                     Z-ADD*ZERO     WFGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WFR1NB           Rated Freight
     C                     Z-ADD*ZERO     WFAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WFD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WFCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WFAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WFCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WFATWG           Weight Shipped
     C                     Z-ADD*ZERO     WFAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WFAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WFAKPR           Unit Price
     C                     Z-ADD*ZERO     WFALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WFAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WFAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WFA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WFA5DT           Requested Ship
     C                     Z-ADD*ZERO     WFAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WFGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WFRGNB           Item Structure
     C                     Z-ADD*ZERO     WFRHNB           Item Structure
     C                     Z-ADD*ZERO     WFRINB           Item Structure
     C                     Z-ADD*ZERO     WFCXDT           Date of Origina
     C                     Z-ADD*ZERO     WFDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WFB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WFA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WFNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WFNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WFNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WFNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WFNXDT           OD Unused Date
     C                     Z-ADD*ZERO     WFBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WFBVTM           Price Code
     C                     Z-ADD*ZERO     WFBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WFBXTM           Substitution Li
     C                     Z-ADD*ZERO     WFBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WFH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WFH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WFH7NX           OD Item Target
     C                     Z-ADD*ZERO     WFH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WFH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WFDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WFDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WFDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WFDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WFDZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WFGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WFGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WFGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WFPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WFRINY           Item Age Days
     C                     Z-ADD*ZERO     WFTIDT           Production Ovr
     C                     Z-ADD*ZERO     WFTJDT           Production Ovr
     C                     Z-ADD*ZERO     WFTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WFTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WFTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Define work field Status - Y or N
     C                     MOVEL*BLANK    WUB8ST  1
      * Define work field Job Name CDE
     C                     MOVEL*BLANK    WUB2VN 10
      * Define work field OHE Carrier SCAC Code
     C                     MOVEL*BLANK    WUC2TX  4
      * Define work field SSI Download Flag
     C                     MOVEL*BLANK    WUUNUS  1
      * Define work field Fax Sent to SSI Carrier
     C                     MOVEL*BLANK    WURUSX  1
      * Define work field SSI Add, Chg, Delete flag
     C                     MOVEL*BLANK    WUAHST  2
      * Define work field Blank for 12          USR
     C                     MOVEL*BLANK    WUS3TX 12
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     MOVEL*BLANK    WL0001  3
     C                     MOVEL*BLANK    WL0002  2
      * Define local variables for subroutine SCRVGN.
     C                     MOVEL*BLANK    WL0003  3
     C                     MOVEL*BLANK    WL0004 30
     C                     MOVEL*BLANK    WL0005  1
      * Define local variables for subroutine SERVGN.
     C                     Z-ADD*ZERO     WL0006  70
     C                     MOVEL*BLANK    WL0007  2
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0008  70
     C                     Z-ADD*ZERO     WL0009  70
     C                     MOVEL*BLANK    WL0010 30
     C                     MOVEL*BLANK    WL0011 15
     C                     MOVEL*BLANK    WL0012 15
     C                     MOVEL*BLANK    WL0013 12
      * Define local variables for subroutine SJRVGN.
     C                     MOVEL*BLANK    WL0014  3
     C                     MOVEL*BLANK    WL0015 20
     C                     Z-ADD*ZERO     WL0016  30
     C                     MOVEL*BLANK    WL0017  1
     C                     MOVEL*BLANK    WL0018  1
     C                     MOVEL*BLANK    WL0019  1
     C                     MOVEL*BLANK    WL0020  1
     C                     Z-ADD*ZERO     WL0021  70
     C                     Z-ADD*ZERO     WL0022  60
     C                     MOVEL*BLANK    WL0023  1
     C                     MOVEL*BLANK    WL0024  1
     C                     MOVEL*BLANK    WL0025  3
     C                     MOVEL*BLANK    WL0026 30
     C                     MOVEL*BLANK    WL0027  1
      * Define local variables for subroutine SOCHRC.
     C                     Z-ADD*ZERO     WL0028  30
     C                     Z-ADD*ZERO     WL0029  70
     C                     Z-ADD*ZERO     WL0030  70
     C                     Z-ADD*ZERO     WL0031  50
     C                     MOVEL*BLANK    WL0032  3
     C                     MOVEL*BLANK    WL0033 20
     C                     MOVEL*BLANK    WL0034 25
     C                     MOVEL*BLANK    WL0035 30
     C                     MOVEL*BLANK    WL0036 15
     C                     MOVEL*BLANK    WL0037 15
     C                     MOVEL*BLANK    WL0038 20
     C                     Z-ADD*ZERO     WL0039  70
     C                     Z-ADD*ZERO     WL0040  70
     C                     Z-ADD*ZERO     WL0041  70
     C                     MOVEL*BLANK    WL0042  3
     C                     MOVEL*BLANK    WL0043  1
     C                     MOVEL*BLANK    WL0044 12
     C                     MOVEL*BLANK    WL0045 35
     C                     MOVEL*BLANK    WL0046 75
     C                     Z-ADD*ZERO     WL0047 110
     C                     Z-ADD*ZERO     WL0048 110
     C                     Z-ADD*ZERO     WL0049 110
     C                     Z-ADD*ZERO     WL0050 110
     C                     Z-ADD*ZERO     WL0051 112
     C                     Z-ADD*ZERO     WL0052 112
     C                     Z-ADD*ZERO     WL0053 112
     C                     Z-ADD*ZERO     WL0054  70
     C                     Z-ADD*ZERO     WL0055  70
     C                     Z-ADD*ZERO     WL0056  70
     C                     Z-ADD*ZERO     WL0057  70
     C                     MOVEL*BLANK    WL0058  4
     C                     MOVEL*BLANK    WL0059  4
     C                     MOVEL*BLANK    WL0060  4
     C                     MOVEL*BLANK    WL0061  2
     C                     MOVEL*BLANK    WL0062  2
     C                     MOVEL*BLANK    WL0063  2
     C                     MOVEL*BLANK    WL0064  3
     C                     MOVEL*BLANK    WL0065  3
     C                     MOVEL*BLANK    WL0066  3
     C                     MOVEL*BLANK    WL0067  5
     C                     MOVEL*BLANK    WL0068  5
     C                     Z-ADD*ZERO     WL0069  50
     C                     MOVEL*BLANK    WL0070 38
     C                     MOVEL*BLANK    WL0071  6
     C                     MOVEL*BLANK    WL0072  6
     C                     MOVEL*BLANK    WL0073  6
     C                     MOVEL*BLANK    WL0074  6
     C                     MOVEL*BLANK    WL0075  6
     C                     MOVEL*BLANK    WL0076  1
     C                     MOVEL*BLANK    WL0077  1
     C                     MOVEL*BLANK    WL0078 10
     C                     MOVEL*BLANK    WL0079 10
     C                     MOVEL*BLANK    WL0080 10
     C                     MOVEL*BLANK    WL0081 15
     C                     MOVEL*BLANK    WL0082 15
     C                     MOVEL*BLANK    WL0083 15
     C                     MOVEL*BLANK    WL0084 30
     C                     MOVEL*BLANK    WL0085 30
     C                     MOVEL*BLANK    WL0086 30
     C                     MOVEL*BLANK    WL0087 50
     C                     MOVEL*BLANK    WL0088 50
     C                     Z-ADD*ZERO     WL0089  30
     C                     Z-ADD*ZERO     WL0090  30
     C                     Z-ADD*ZERO     WL0091  30
     C                     Z-ADD*ZERO     WL0092  52
     C                     Z-ADD*ZERO     WL0093  52
     C                     Z-ADD*ZERO     WL0094  50
     C                     Z-ADD*ZERO     WL0095  60
     C                     Z-ADD*ZERO     WL0096  60
     C                     Z-ADD*ZERO     WL0097  60
     C                     Z-ADD*ZERO     WL0098  60
     C                     Z-ADD*ZERO     WL0099  90
     C                     Z-ADD*ZERO     WL0100  90
     C                     Z-ADD*ZERO     WL0101  90
     C                     Z-ADD*ZERO     WL0102  96
     C                     MOVEL*BLANK    WL0103 15
     C                     MOVEL*BLANK    WL0104  1
     C                     MOVEL*BLANK    WL0105  1
     C                     MOVEL*BLANK    WL0106  2
     C                     MOVEL*BLANK    WL0107  2
     C                     MOVEL*BLANK    WL0108  5
     C                     MOVEL*BLANK    WL0109  5
     C                     MOVEL*BLANK    WL0110 15
     C                     MOVEL*BLANK    WL0111 15
     C                     MOVEL*BLANK    WL0112 30
     C                     Z-ADD*ZERO     WL0113  70
     C                     Z-ADD*ZERO     WL0114  70
     C                     MOVEL*BLANK    WL0115  1
     C                     MOVEL*BLANK    WL0116  1
     C                     MOVEL*BLANK    WL0117  1
     C                     MOVEL*BLANK    WL0118  1
     C                     Z-ADD*ZERO     WL0119  60
     C                     MOVEL*BLANK    WL0120 10
     C                     MOVEL*BLANK    WL0121 10
     C                     Z-ADD*ZERO     WL0122  70
      * Define local variables for subroutine SWRVGN.
     C                     MOVEL*BLANK    WL0123  3
     C                     MOVEL*BLANK    WL0124  1
      * Define local variables for subroutine SYRVGN.
     C                     MOVEL*BLANK    WL0125  3
     C                     MOVEL*BLANK    WL0126 20
     C                     MOVEL*BLANK    WL0127  1
     C                     MOVEL*BLANK    WL0128  1
      * Define local variables for subroutine TLRVGN.
     C                     MOVEL*BLANK    WL0129 10
     C                     MOVEL*BLANK    WL0130  6
     C                     Z-ADD*ZERO     WL0131  30
     C                     MOVEL*BLANK    WL0132  3
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0001  1
      * Define local work field Order Number
     C                     Z-ADD*ZERO     YL0001  70
      * Define local work field Warehouse Type
     C                     MOVEL*BLANK    YL0002  2
      * Define local work field Record Selected       USR
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Type Code
     C                     MOVEL*BLANK    YL0004  2
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0005  1
      * Define null work field Company Number
     C                     Z-ADD*ZERO     YN0002  30
      * Define local work field USR Load Type
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field Trailer Type
     C                     MOVEL*BLANK    YL0007  1
      * Define local work field Seaboard Owned Status
     C                     MOVEL*BLANK    YL0008  1
      * Define local work field On Yard Status
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field On Yard Date
     C                     Z-ADD*ZERO     YL0010  70
      * Define local work field On Yard Time
     C                     Z-ADD*ZERO     YL0011  60
      * Define local work field Assigned Status
     C                     MOVEL*BLANK    YL0012  1
      * Define local work field Available Status
     C                     MOVEL*BLANK    YL0013  1
      * Define local work field Not Available Reason Code
     C                     MOVEL*BLANK    YL0014  3
      * Define local work field Comment Line
     C                     MOVEL*BLANK    YL0015 30
      * Define local work field Load Type
     C                     MOVEL*BLANK    YL0016  1
      * Define local work field Status Unused 1
     C                     MOVEL*BLANK    YL0017  1
      * Define local work field Status Unused 2
     C                     MOVEL*BLANK    YL0018  1
      * Define local work field Status Unused 3
     C                     MOVEL*BLANK    YL0019  1
      * Define local work field Status Unused 4
     C                     MOVEL*BLANK    YL0020  1
      * Define local work field Status Unused 5
     C                     MOVEL*BLANK    YL0021  1
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0022  30
      * Define local work field Record Status
     C                     MOVEL*BLANK    YL0023  1
      * Define local work field Load ID USR
     C                     Z-ADD*ZERO     YL0024  70
      * Define local work field Load Id 2
     C                     Z-ADD*ZERO     YL0025  70
      * Define local work field Load Id 3
     C                     Z-ADD*ZERO     YL0026  70
      * Define local work field Load Status
     C                     MOVEL*BLANK    YL0027  1
      * Define local work field OHE Booking Number
     C                     MOVEL*BLANK    YL0028 15
      * Define local work field OHE Container Number
     C                     MOVEL*BLANK    YL0029 12
      * Define local work field Load Confirmation Fax Sts
     C                     MOVEL*BLANK    YL0030  1
      * Define local work field Load Confirmed Contact
     C                     MOVEL*BLANK    YL0031 25
      * Define local work field Load Confirmation Time
     C                     Z-ADD*ZERO     YL0032  70
      * Define local work field Load Confirmed Sts
     C                     MOVEL*BLANK    YL0033  1
      * Define local work field Deadline Departure Date
     C                     Z-ADD*ZERO     YL0034  70
      * Define local work field Deadline Departure Time
     C                     Z-ADD*ZERO     YL0035  60
      * Define local work field Requested Delivery Date
     C                     Z-ADD*ZERO     YL0036  70
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0037  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0038  3
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
      *
     C                     Z-ADD11        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
      * Set to *CHANGE mode
     C                     MOVEL'CHG'     W0PMD   3
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
     C                     MOVEL*BLANK    P1DNCD           Application Cod
     C                     MOVEL'OMS'     P1DNCD           Application Cod
      *
     C                     MOVEL*BLANK    WN0916 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0916           User Profile Na
      *
     C                     MOVEL*BLANK    WN0917 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR TKRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,006                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0916    ZA0012           User Profile Na
     C                     MOVELP1DNCD    ZA0013           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0917    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0916    WL0129    P      User Profile Na
     C                     MOVELP1DNCD    WL0130    P      Application Cod
     C                     EXSR TLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0131    WUAIC3           Company Number
     C                     MOVELWL0132    YL0038    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0917    WL0129    P      User Profile Na
     C                     MOVELP1DNCD    WL0130    P      Application Cod
     C                     EXSR TLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0131    WUAIC3           Company Number
     C                     MOVELWL0132    YL0038    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0038    P1AJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0916    ZA0014           User Profile Na
     C                     MOVELP1DNCD    ZA0015           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0037    IFNE 0                          *IF
     C                     Z-ADDYL0037    WUAIC3           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0038    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           P1AJCD    PARM *BLANK    WQ0051  3        Warehouse Code
     C                     PARM YL0037    WQ0052  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR TMRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Include All
00002 Booked Only
00003 Unbooked Only
00004 Frozen
00005 Chilled
00006 Y2U0005
00007 TRLRASN
00008 TRLRAVL
