// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PNO7XFR
// ?Date: 14.08.2025 Time: 03:45:59
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?FP1309 Rules
DO;

//?User requested to use the Schedule Ship Date and the
//?Request Delivery Date on the calculation of the From/to
//?Production date
//?Number of days could be multiple years so #OF DAYS is 4 poisition
//?Calculation on the From production
//?Requested  Delivery Date - Delivery Ageing Days
//?Calculation on the To production
//?Schedule Ship Date - Chill Days (or Frozen Days)
//?Summary:
//?If Chilling Time is zeros, use Scheduled Ship Date as the
//?Prod Age Date To field.
//?If Chilling Time is not zeros, subtract the chilling time from
//?the Scheduled Ship Date to get the Prod Age Date To field
//?Either way, subtract Item Age Days from Requested Delivery Date
//?to get the Prod Age Date From field.
ENDDO;

// PAR.Production AgeDte Fr = CON.*ZERO
PAR.Production_AgeDte_Fr = *ZERO;

// PAR.Production AgeDte To = CON.*ZERO
PAR.Production_AgeDte_To = *ZERO;

CASE;

// IF PAR.Production Ovr AgeDte Fr is Entered
IF PAR.Production_Ovr_AgeDte_Fr <> *ZERO;

// PAR.Production AgeDte Fr = PAR.Production Ovr AgeDte Fr
PAR.Production_AgeDte_Fr = PAR.Production_Ovr_AgeDte_Fr;

// PAR.Production AgeDte To = PAR.Production Ovr AgeDte To
PAR.Production_AgeDte_To = PAR.Production_Ovr_AgeDte_To;

// IF PAR.Item Age Days is Entered
IF PAR.Item_Age_Days <> *ZERO;

// OR PAR.Production Ovr AgeDte Fr is not entered
OR PAR.Production_Ovr_AgeDte_Fr = *ZERO;

// AND PAR.Item Age Days is Not Entered
AND PAR.Item_Age_Days = *ZERO;

//?Calculate Production Date From and production date to
CASE;

// IF PAR.Chilling Time USR is EQ Zero
IF PAR.Chilling_Time_USR = *ZERO;

// PAR.Production AgeDte To = PAR.Scheduled Ship Date
PAR.Production_AgeDte_To = PAR.Scheduled_Ship_Date;

// LCL.Item Age Days = PAR.Item Age Days * CON.-1 *
LCL.Item_Age_Days = PAR.Item_Age_Days * -1;

// PAR.Production AgeDte Fr = PAR.Requested Delivery Date + LCL.Item Age Days *DAYS
PAR.Production_AgeDte_Fr = DATEINCR(PAR.Requested_Delivery_Date LCL.Item_Age_Days 'DY'             +
1111111 'NONE' 'N' 1);

//?Calculate Production Date From and production date to
// IF *OTHERWISE
IF *OTHERWISE;

// LCL.Fresh Chilling Time = PAR.Chilling Time USR * CON.-1 *
LCL.Fresh_Chilling_Time = PAR.Chilling_Time_USR * -1;

// PAR.Production AgeDte To = PAR.Scheduled Ship Date + LCL.Fresh Chilling Time *DAYS
PAR.Production_AgeDte_To = DATEINCR(PAR.Scheduled_Ship_Date LCL.Fresh_Chilling_Time 'DY'           +
1111111 'NONE' 'N' 1);

// LCL.Item Age Days = PAR.Item Age Days * CON.-1 *
LCL.Item_Age_Days = PAR.Item_Age_Days * -1;

// PAR.Production AgeDte Fr = PAR.Requested Delivery Date + LCL.Item Age Days *DAYS
PAR.Production_AgeDte_Fr = DATEINCR(PAR.Requested_Delivery_Date LCL.Item_Age_Days 'DY'             +
1111111 'NONE' 'N' 1);

ENDIF;

ENDIF;

