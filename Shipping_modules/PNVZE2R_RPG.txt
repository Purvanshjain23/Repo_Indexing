     H/TITLE EDT Export Order Instr E2 Edit record(2 screens)
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Maintain DBF file records, one at a time
     H* - Existing records may be updated or deleted
     H* - New records may be added
     H* - Key changes are not allowed
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Edit record(2 screens)
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 05/15/23  Time  : 08:39:47
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPNVZE2R#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: EDT Export Order Instr E2 Edit record(2 screens)
      *
     FPMAMREL1IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RTV : Order Header Extension    Retrieval index
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FOPBFCPLOIF  E           K        DISK
      * RSQ : Order Header TRG          Ord-D/Co
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FOPBGWKLXIF  E           K        DISK
      * RSQ : Order Detail              Co/Order/Whs
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FOMFLCPL5IF  E           K        DISK
      * RSQ : Load Detail               Co/Load/Order
      *
     FOMFFREL0IF  E           K        DISK
      * RTV : Carrier Info              Retrieval index
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FPDLCREL0IF  E           K        DISK
      * RTV : Shipping Line/Port        Retrieval index
      *
     FCAABREL1IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       V
      *
     FPUCRREL2IF  E           K        DISK
      * RSQ : Country Port of Unlading  Country/POU
      *
     FPDLYREL1IF  E           K        DISK
      * RTV : Trailer                   Retrieval index
      *
     FOMFJCPMPIF  E           K        DISK
      * RSQ : Load Header               Container/Load
      *
     FOPBFCPL6IF  E           K        DISK
      * RSQ : Order Header TRG          Load Exports
      *
     FPMAMREL6IF  E           K        DISK
      * RSQ : Order Header Extension    Co#/Ord#
      *
     FPNGNREL1IF  E           K        DISK
      * RTV : EDI Interchange           Retrieval index
      *
     FPUC1REL1IF  E           K        DISK
      * RTV : Shipping Line/Port Extsn  Retrieval index
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FPMAMREL0UF  E           K        DISK                      A
      * UPD : Order Header Extension    Update index
      *
     FOMFJCPL1UF  E           K        DISK
      * UPD : Load Header               Update index
      *
     FPDLYREL0UF  E           K        DISK                      A
      * UPD : Trailer                   Update index
      *
     E                    J3          3  1
     E                    K3          3  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    J7          7  1
     E                    K7          7  1
      * RIGHT JUSTIFY INPUT FIELD
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    #L3         3  1
     E                    #L7         7  1
     E                    UCT        40  1               CENTER TABLE
      * KEY Screen: Field position and name array
     E                    W0BEG   2 002  5 0A
     E                    W0END   2 002  5 0A
     E                    W0NAM   2 002 10
      * DETAIL Screen: Field position and name array
     E                    W1BEG   7 053  5 0A
     E                    W1END   7 053  5 0A
     E                    W1NAM   7 053 10
      * DETAIL 2 Screen: Field position and name array
     E                    W2BEG   7 023  5 0A
     E                    W2END   7 023  5 0A
     E                    W2NAM   7 023 10
      * Long constants
     E                    @CN#    1  17  6   @CN    25
      * Screen one error indicator store
     E                    @I1       100  1
      * Screen two error indicator store
     E                    @I2       100  1
     I@BFCPY2
      * Order Header TRG          Ord-D/Co
      * Renamed input format fields
     I              BEAIC3                          WAAIC3
     I              BEC4NB                          WAC4NB
     I              BEJNCD                          WAJNCD
     I              BEANC7                          WAANC7
     I              BEBKC7                          WABKC7
     I              BEBRTX                          WABRTX
     I              BEHMNA                          WAHMNA
     I              BEHONA                          WAHONA
     I              BEHPNA                          WAHPNA
     I              BEHNNA                          WAHNNA
     I              BEDBCD                          WADBCD
     I              BECKTX                          WACKTX
     I              BEB0C7                          WAB0C7
     I              BEAETX                          WAAETX
     I              BEB1NA                          WAB1NA
     I              BEB3NA                          WAB3NA
     I              BEB4NA                          WAB4NA
     I              BEB2NA                          WAB2NA
     I              BEBHCD                          WABHCD
     I              BEC8TX                          WAC8TX
     I              BEBCNA                          WABCNA
     I              BEA0DT                          WAA0DT
     I              BEA5DT                          WAA5DT
     I              BEGNDT                          WAGNDT
     I              BEACDT                          WAACDT
     I              BEAQCD                          WAAQCD
     I              BEB6NA                          WAB6NA
     I              BEBYNA                          WABYNA
     I              BEBZNA                          WABZNA
     I              BEGTST                          WAGTST
     I              BEGVST                          WAGVST
     I              BEGUST                          WAGUST
     I              BEQFST                          WAQFST
     I              BECQCD                          WACQCD
     I              BEGJST                          WAGJST
     I              BEGWST                          WAGWST
     I              BEGXST                          WAGXST
     I              BEGYST                          WAGYST
     I              BEAODT                          WAAODT
     I              BEAIVN                          WAAIVN
     I              BECXDT                          WACXDT
     I              BEJZVA                          WAJZVA
     I              BEA1WG                          WAA1WG
     I              BEXIST                          WAXIST
     I              BEXJST                          WAXJST
     I              BEXKST                          WAXKST
     I              BEEIDT                          WAEIDT
     I              BEAFTM                          WAAFTM
     I              BEE8CD                          WAE8CD
     I              BEE9CD                          WAE9CD
     I              BERMNB                          WARMNB
     I              BETBNB                          WATBNB
     I              BER1NB                          WAR1NB
     I              BEPJST                          WAPJST
     I              BEU0ST                          WAU0ST
     I              BEU1ST                          WAU1ST
     I              BEQ2CD                          WAQ2CD
     I              BEU2ST                          WAU2ST
     I              BEVEST                          WAVEST
     I              BEVFST                          WAVFST
     I              BEVGST                          WAVGST
     I              BERPCD                          WARPCD
     I              BERNNB                          WARNNB
     I              BEVDST                          WAVDST
     I              BEATIN                          WAATIN
     I              BEU4ST                          WAU4ST
     I              BEU5ST                          WAU5ST
     I              BERSRN                          WARSRN
     I              BEMHNA                          WAMHNA
     I              BEMINA                          WAMINA
     I              BEWBST                          WAWBST
     I              BER4CD                          WAR4CD
     I              BEBFCD                          WABFCD
     I              BEQ4CD                          WAQ4CD
     I              BET3NB                          WAT3NB
     I              BESICD                          WASICD
     I              BECONB                          WACONB
     I              BECEST                          WACEST
     I              BEAWDT                          WAAWDT
     I              BEJPCD                          WAJPCD
     I              BEXUST                          WAXUST
     I              BEZ1ST                          WAZ1ST
     I              BEVRVA                          WAVRVA
     I              BEOBST                          WAOBST
     I              BEBCST                          WABCST
     I              BEBDST                          WABDST
     I              BEB7VL                          WAB7VL
     I              BEGASX                          WAGASX
     I              BEGBSX                          WAGBSX
     I              BEGCSX                          WAGCSX
     I              BEGDSX                          WAGDSX
     I              BEFNSX                          WAFNSX
     I              BEFOSX                          WAFOSX
     I              BEFPSX                          WAFPSX
     I              BEFQSX                          WAFQSX
     I              BEFRSX                          WAFRSX
     I              BEFSSX                          WAFSSX
     I              BEFTSX                          WAFTSX
     I              BEFUSX                          WAFUSX
     I              BEFVSX                          WAFVSX
     I              BEFWSX                          WAFWSX
     I              BEFXSX                          WAFXSX
     I              BEFYSX                          WAFYSX
     I              BENODT                          WANODT
     I              BENPDT                          WANPDT
     I              BENQDT                          WANQDT
     I              BENRDT                          WANRDT
     I              BENSDT                          WANSDT
     I              BEBPTM                          WABPTM
     I              BEBQTM                          WABQTM
     I              BEBRTM                          WABRTM
     I              BEBSTM                          WABSTM
     I              BEBTTM                          WABTTM
     I              BEH0NX                          WAH0NX
     I              BEH1NX                          WAH1NX
     I              BEH2NX                          WAH2NX
     I              BEH3NX                          WAH3NX
     I              BEH4NX                          WAH4NX
     I              BEC0C7                          WAC0C7
     I              BEUVST                          WAUVST
     I              BEUWST                          WAUWST
     I              BEUXST                          WAUXST
     I              BEAATM                          WAAATM
     I              BEAYNA                          WAAYNA
     I              BEA0NA                          WAA0NA
     I              BEAXDT                          WAAXDT
      *
     I@BGWKDA
      * Order Detail              Co/Order/Whs
      * Renamed input format fields
     I              OMAIC3                          WBAIC3
     I              OMC4NB                          WBC4NB
     I              OMDPNB                          WBDPNB
     I              OMUENB                          WBUENB
     I              OMHGCD                          WBHGCD
     I              OMAJCD                          WBAJCD
     I              OMBKC7                          WBBKC7
     I              OMCFC7                          WBCFC7
     I              OMGMST                          WBGMST
     I              OMGNST                          WBGNST
     I              OMMAVA                          WBMAVA
     I              OMKDVA                          WBKDVA
     I              OML8VA                          WBL8VA
     I              OML9VA                          WBL9VA
     I              OMGTST                          WBGTST
     I              OMGVST                          WBGVST
     I              OMGUST                          WBGUST
     I              OMQFST                          WBQFST
     I              OMAYVA                          WBAYVA
     I              OMEXDT                          WBEXDT
     I              OMLQCD                          WBLQCD
     I              OMRDCD                          WBRDCD
     I              OMQ7CD                          WBQ7CD
     I              OMBZPR                          WBBZPR
     I              OML6NB                          WBL6NB
     I              OMU1ST                          WBU1ST
     I              OMGIDT                          WBGIDT
     I              OMCRCD                          WBCRCD
     I              OMAGCD                          WBAGCD
     I              OMRZST                          WBRZST
     I              OMR0ST                          WBR0ST
     I              OMR1ST                          WBR1ST
     I              OMG7NA                          WBG7NA
     I              OMG8NA                          WBG8NA
     I              OMRPCD                          WBRPCD
     I              OMVEST                          WBVEST
     I              OMVGST                          WBVGST
     I              OMAVST                          WBAVST
     I              OMU0ST                          WBU0ST
     I              OMRFCD                          WBRFCD
     I              OMFZST                          WBFZST
     I              OMR1NB                          WBR1NB
     I              OMAVQT                          WBAVQT
     I              OMD0WG                          WBD0WG
     I              OMCCQT                          WBCCQT
     I              OMAUWG                          WBAUWG
     I              OMCBQT                          WBCBQT
     I              OMATWG                          WBATWG
     I              OMAQCS                          WBAQCS
     I              OMAGCS                          WBAGCS
     I              OMAKPR                          WBAKPR
     I              OMALPR                          WBALPR
     I              OMAUPR                          WBAUPR
     I              OMAVWG                          WBAVWG
     I              OMA4WG                          WBA4WG
     I              OMA5DT                          WBA5DT
     I              OMAODT                          WBAODT
     I              OMGNDT                          WBGNDT
     I              OMAMST                          WBAMST
     I              OMANST                          WBANST
     I              OMVAST                          WBVAST
     I              OMRGNB                          WBRGNB
     I              OMRHNB                          WBRHNB
     I              OMRINB                          WBRINB
     I              OMRBCD                          WBRBCD
     I              OMHICD                          WBHICD
     I              OMRNCD                          WBRNCD
     I              OMROCD                          WBROCD
     I              OMCXDT                          WBCXDT
     I              OMAJVN                          WBAJVN
     I              OMKXCD                          WBKXCD
     I              OMJPCD                          WBJPCD
     I              OMCQCD                          WBCQCD
     I              OMR4CD                          WBR4CD
     I              OMZ1ST                          WBZ1ST
     I              OMZ3ST                          WBZ3ST
     I              OMZ4ST                          WBZ4ST
     I              OMDUPR                          WBDUPR
     I              OMB6VL                          WBB6VL
     I              OMA1AA                          WBA1AA
     I              OMFZSX                          WBFZSX
     I              OMF0SX                          WBF0SX
     I              OMF1SX                          WBF1SX
     I              OMF2SX                          WBF2SX
     I              OMF3SX                          WBF3SX
     I              OMF4SX                          WBF4SX
     I              OMF5SX                          WBF5SX
     I              OMF6SX                          WBF6SX
     I              OMF7SX                          WBF7SX
     I              OMNTDT                          WBNTDT
     I              OMNUDT                          WBNUDT
     I              OMNVDT                          WBNVDT
     I              OMNWDT                          WBNWDT
     I              OMNXDT                          WBNXDT
     I              OMBUTM                          WBBUTM
     I              OMBVTM                          WBBVTM
     I              OMBWTM                          WBBWTM
     I              OMBXTM                          WBBXTM
     I              OMBYTM                          WBBYTM
     I              OMH5NX                          WBH5NX
     I              OMH6NX                          WBH6NX
     I              OMH7NX                          WBH7NX
     I              OMH8NX                          WBH8NX
     I              OMH9NX                          WBH9NX
     I              OMDVPR                          WBDVPR
     I              OMDWPR                          WBDWPR
     I              OMDXPR                          WBDXPR
     I              OMDYPR                          WBDYPR
     I              OMDZPR                          WBDZPR
     I              OMGSPR                          WBGSPR
     I              OMGTPR                          WBGTPR
     I              OMGUPR                          WBGUPR
     I              OMHOST                          WBHOST
     I              OMHPST                          WBHPST
     I              OMIOST                          WBIOST
     I              OMPEWG                          WBPEWG
     I              OMRINY                          WBRINY
     I              OMTIDT                          WBTIDT
     I              OMTJDT                          WBTJDT
     I              OMH2ST                          WBH2ST
     I              OMH0ST                          WBH0ST
     I              OMH1ST                          WBH1ST
     I              OMTKDT                          WBTKDT
     I              OMTLDT                          WBTLDT
     I              OMTMDT                          WBTMDT
     I              OMUVST                          WBUVST
     I              OMUWST                          WBUWST
     I              OMUXST                          WBUXST
     I              OMAATM                          WBAATM
     I              OMAYNA                          WBAYNA
     I              OMA0NA                          WBA0NA
     I              OMAXDT                          WBAXDT
      *
     I@ABREAK
      * Company Name and Address  Retrieval index       V
      * Renamed input format fields
     I              ABAIC3                          WCAIC3
     I              ABADTX                          WCADTX
     I              ABACNA                          WCACNA
     I              ABADNA                          WCADNA
     I              ABAENA                          WCAENA
     I              ABAJNA                          WCAJNA
     I              ABBTTX                          WCBTTX
     I              ABBVTX                          WCBVTX
     I              ABBWTX                          WCBWTX
     I              ABA2NA                          WCA2NA
     I              ABABTX                          WCABTX
     I              ABBGCD                          WCBGCD
     I              ABKXCD                          WCKXCD
     I              ABUVST                          WCUVST
     I              ABUWST                          WCUWST
     I              ABUXST                          WCUXST
     I              ABVSST                          WCVSST
     I              ABAATM                          WCAATM
     I              ABAYNA                          WCAYNA
     I              ABA0NA                          WCA0NA
     I              ABAXDT                          WCAXDT
      *
     I@FJCPBO
      * Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WDRMNB
     I              FJAIC3                          WDAIC3
     I              FJAODT                          WDAODT
     I              FJPJST                          WDPJST
     I              FJPKST                          WDPKST
     I              FJRNNB                          WDRNNB
     I              FJDMTX                          WDDMTX
     I              FJDNTX                          WDDNTX
     I              FJDOTX                          WDDOTX
     I              FJWTTX                          WDWTTX
     I              FJWUTX                          WDWUTX
     I              FJRPNB                          WDRPNB
     I              FJFLAM                          WDFLAM
     I              FJXQST                          WDXQST
     I              FJRRNB                          WDRRNB
     I              FJDXTX                          WDDXTX
     I              FJDYTX                          WDDYTX
     I              FJSBNB                          WDSBNB
     I              FJBZNA                          WDBZNA
     I              FJRONB                          WDRONB
     I              FJSQNB                          WDSQNB
     I              FJR1NB                          WDR1NB
     I              FJVCST                          WDVCST
     I              FJVDST                          WDVDST
     I              FJSDNB                          WDSDNB
     I              FJPAOU                          WDPAOU
     I              FJDGWG                          WDDGWG
     I              FJSXNB                          WDSXNB
     I              FJHADT                          WDHADT
     I              FJAART                          WDAART
     I              FJDHWG                          WDDHWG
     I              FJDIWG                          WDDIWG
     I              FJAQDT                          WDAQDT
     I              FJS6NB                          WDS6NB
     I              FJT4NB                          WDT4NB
     I              FJPRTM                          WDPRTM
     I              FJNPSV                          WDNPSV
     I              FJJ8TX                          WDJ8TX
     I              FJTLMI                          WDTLMI
     I              FJJ9TX                          WDJ9TX
     I              FJQ2CD                          WDQ2CD
     I              FJVPCD                          WDVPCD
     I              FJDBCD                          WDDBCD
     I              FJGRWE                          WDGRWE
     I              FJXCCD                          WDXCCD
     I              FJU2ST                          WDU2ST
     I              FJF9DT                          WDF9DT
     I              FJONTM                          WDONTM
     I              FJJ4DT                          WDJ4DT
     I              FJTRTM                          WDTRTM
     I              FJJ5DT                          WDJ5DT
     I              FJSPTM                          WDSPTM
     I              FJJ6DT                          WDJ6DT
     I              FJLFTM                          WDLFTM
     I              FJJ7DT                          WDJ7DT
     I              FJBOTM                          WDBOTM
     I              FJJ8DT                          WDJ8DT
     I              FJBLTM                          WDBLTM
     I              FJKIDT                          WDKIDT
     I              FJASTM                          WDASTM
     I              FJKADT                          WDKADT
     I              FJAJCM                          WDAJCM
     I              FJXACD                          WDXACD
     I              FJOANA                          WDOANA
     I              FJK4TX                          WDK4TX
     I              FJVOAG                          WDVOAG
     I              FJKBDT                          WDKBDT
     I              FJNBBO                          WDNBBO
     I              FJW4CD                          WDW4CD
     I              FJEFDT                          WDEFDT
     I              FJCNTN                          WDCNTN
     I              FJKCDT                          WDKCDT
     I              FJTMIN                          WDTMIN
     I              FJKDDT                          WDKDDT
     I              FJVMNB                          WDVMNB
     I              FJOCFR                          WDOCFR
     I              FJKJDT                          WDKJDT
     I              FJATTM                          WDATTM
     I              FJOTRS                          WDOTRS
     I              FJRNST                          WDRNST
     I              FJBRBK                          WDBRBK
     I              FJEIDT                          WDEIDT
     I              FJRMST                          WDRMST
     I              FJAJCD                          WDAJCD
     I              FJKKDT                          WDKKDT
     I              FJAVTM                          WDAVTM
     I              FJKZDT                          WDKZDT
     I              FJAXTM                          WDAXTM
     I              FJLHOS                          WDLHOS
     I              FJLHOR                          WDLHOR
     I              FJWNTX                          WDWNTX
     I              FJOITX                          WDOITX
     I              FJOJTX                          WDOJTX
     I              FJLLDT                          WDLLDT
     I              FJLSHG                          WDLSHG
     I              FJYPST                          WDYPST
     I              FJK0DT                          WDK0DT
     I              FJAYTM                          WDAYTM
     I              FJKNNX                          WDKNNX
     I              FJICWG                          WDICWG
     I              FJIDWG                          WDIDWG
     I              FJH9SX                          WDH9SX
     I              FJWOTX                          WDWOTX
     I              FJK1DT                          WDK1DT
     I              FJAZTM                          WDAZTM
     I              FJK2DT                          WDK2DT
     I              FJA0TM                          WDA0TM
     I              FJROST                          WDROST
     I              FJRPST                          WDRPST
     I              FJRQST                          WDRQST
     I              FJRRST                          WDRRST
     I              FJZBVA                          WDZBVA
     I              FJWPTX                          WDWPTX
     I              FJWQTX                          WDWQTX
     I              FJWRTX                          WDWRTX
     I              FJWSTX                          WDWSTX
     I              FJRVSX                          WDRVSX
     I              FJRUSX                          WDRUSX
     I              FJRWSX                          WDRWSX
     I              FJRXSX                          WDRXSX
     I              FJRYSX                          WDRYSX
     I              FJRZSX                          WDRZSX
     I              FJR0SX                          WDR0SX
     I              FJR1SX                          WDR1SX
     I              FJR2SX                          WDR2SX
     I              FJR3SX                          WDR3SX
     I              FJR4SX                          WDR4SX
     I              FJPYDT                          WDPYDT
     I              FJCKTM                          WDCKTM
     I              FJPZDT                          WDPZDT
     I              FJCLTM                          WDCLTM
     I              FJP0DT                          WDP0DT
     I              FJCMTM                          WDCMTM
     I              FJP1DT                          WDP1DT
     I              FJCNTM                          WDCNTM
     I              FJP2DT                          WDP2DT
     I              FJCOTM                          WDCOTM
     I              FJP3DT                          WDP3DT
     I              FJCQTM                          WDCQTM
     I              FJUVST                          WDUVST
     I              FJUWST                          WDUWST
     I              FJUXST                          WDUXST
     I              FJAATM                          WDAATM
     I              FJAYNA                          WDAYNA
     I              FJA0NA                          WDA0NA
     I              FJAXDT                          WDAXDT
      *
     I@FJCPNL
      * Load Header               Container/Load
      * Renamed input format fields
     I              FJRMNB                          WERMNB
     I              FJAIC3                          WEAIC3
     I              FJAODT                          WEAODT
     I              FJPJST                          WEPJST
     I              FJPKST                          WEPKST
     I              FJRNNB                          WERNNB
     I              FJDMTX                          WEDMTX
     I              FJDNTX                          WEDNTX
     I              FJDOTX                          WEDOTX
     I              FJWTTX                          WEWTTX
     I              FJWUTX                          WEWUTX
     I              FJRPNB                          WERPNB
     I              FJFLAM                          WEFLAM
     I              FJXQST                          WEXQST
     I              FJRRNB                          WERRNB
     I              FJDXTX                          WEDXTX
     I              FJDYTX                          WEDYTX
     I              FJSBNB                          WESBNB
     I              FJBZNA                          WEBZNA
     I              FJRONB                          WERONB
     I              FJSQNB                          WESQNB
     I              FJR1NB                          WER1NB
     I              FJVCST                          WEVCST
     I              FJVDST                          WEVDST
     I              FJSDNB                          WESDNB
     I              FJPAOU                          WEPAOU
     I              FJDGWG                          WEDGWG
     I              FJSXNB                          WESXNB
     I              FJHADT                          WEHADT
     I              FJAART                          WEAART
     I              FJDHWG                          WEDHWG
     I              FJDIWG                          WEDIWG
     I              FJAQDT                          WEAQDT
     I              FJS6NB                          WES6NB
     I              FJT4NB                          WET4NB
     I              FJPRTM                          WEPRTM
     I              FJNPSV                          WENPSV
     I              FJJ8TX                          WEJ8TX
     I              FJTLMI                          WETLMI
     I              FJJ9TX                          WEJ9TX
     I              FJQ2CD                          WEQ2CD
     I              FJVPCD                          WEVPCD
     I              FJDBCD                          WEDBCD
     I              FJGRWE                          WEGRWE
     I              FJXCCD                          WEXCCD
     I              FJU2ST                          WEU2ST
     I              FJF9DT                          WEF9DT
     I              FJONTM                          WEONTM
     I              FJJ4DT                          WEJ4DT
     I              FJTRTM                          WETRTM
     I              FJJ5DT                          WEJ5DT
     I              FJSPTM                          WESPTM
     I              FJJ6DT                          WEJ6DT
     I              FJLFTM                          WELFTM
     I              FJJ7DT                          WEJ7DT
     I              FJBOTM                          WEBOTM
     I              FJJ8DT                          WEJ8DT
     I              FJBLTM                          WEBLTM
     I              FJKIDT                          WEKIDT
     I              FJASTM                          WEASTM
     I              FJKADT                          WEKADT
     I              FJAJCM                          WEAJCM
     I              FJXACD                          WEXACD
     I              FJOANA                          WEOANA
     I              FJK4TX                          WEK4TX
     I              FJVOAG                          WEVOAG
     I              FJKBDT                          WEKBDT
     I              FJNBBO                          WENBBO
     I              FJW4CD                          WEW4CD
     I              FJEFDT                          WEEFDT
     I              FJCNTN                          WECNTN
     I              FJKCDT                          WEKCDT
     I              FJTMIN                          WETMIN
     I              FJKDDT                          WEKDDT
     I              FJVMNB                          WEVMNB
     I              FJOCFR                          WEOCFR
     I              FJKJDT                          WEKJDT
     I              FJATTM                          WEATTM
     I              FJOTRS                          WEOTRS
     I              FJRNST                          WERNST
     I              FJBRBK                          WEBRBK
     I              FJEIDT                          WEEIDT
     I              FJRMST                          WERMST
     I              FJAJCD                          WEAJCD
     I              FJKKDT                          WEKKDT
     I              FJAVTM                          WEAVTM
     I              FJKZDT                          WEKZDT
     I              FJAXTM                          WEAXTM
     I              FJLHOS                          WELHOS
     I              FJLHOR                          WELHOR
     I              FJWNTX                          WEWNTX
     I              FJOITX                          WEOITX
     I              FJOJTX                          WEOJTX
     I              FJLLDT                          WELLDT
     I              FJLSHG                          WELSHG
     I              FJYPST                          WEYPST
     I              FJK0DT                          WEK0DT
     I              FJAYTM                          WEAYTM
     I              FJKNNX                          WEKNNX
     I              FJICWG                          WEICWG
     I              FJIDWG                          WEIDWG
     I              FJH9SX                          WEH9SX
     I              FJWOTX                          WEWOTX
     I              FJK1DT                          WEK1DT
     I              FJAZTM                          WEAZTM
     I              FJK2DT                          WEK2DT
     I              FJA0TM                          WEA0TM
     I              FJROST                          WEROST
     I              FJRPST                          WERPST
     I              FJRQST                          WERQST
     I              FJRRST                          WERRST
     I              FJZBVA                          WEZBVA
     I              FJWPTX                          WEWPTX
     I              FJWQTX                          WEWQTX
     I              FJWRTX                          WEWRTX
     I              FJWSTX                          WEWSTX
     I              FJRVSX                          WERVSX
     I              FJRUSX                          WERUSX
     I              FJRWSX                          WERWSX
     I              FJRXSX                          WERXSX
     I              FJRYSX                          WERYSX
     I              FJRZSX                          WERZSX
     I              FJR0SX                          WER0SX
     I              FJR1SX                          WER1SX
     I              FJR2SX                          WER2SX
     I              FJR3SX                          WER3SX
     I              FJR4SX                          WER4SX
     I              FJPYDT                          WEPYDT
     I              FJCKTM                          WECKTM
     I              FJPZDT                          WEPZDT
     I              FJCLTM                          WECLTM
     I              FJP0DT                          WEP0DT
     I              FJCMTM                          WECMTM
     I              FJP1DT                          WEP1DT
     I              FJCNTM                          WECNTM
     I              FJP2DT                          WEP2DT
     I              FJCOTM                          WECOTM
     I              FJP3DT                          WEP3DT
     I              FJCQTM                          WECQTM
     I              FJUVST                          WEUVST
     I              FJUWST                          WEUWST
     I              FJUXST                          WEUXST
     I              FJAATM                          WEAATM
     I              FJAYNA                          WEAYNA
     I              FJA0NA                          WEA0NA
     I              FJAXDT                          WEAXDT
      *
     I@BFCPMC
      * Order Header TRG          Load Exports
      * Renamed input format fields
     I              BEAIC3                          WFAIC3
     I              BEC4NB                          WFC4NB
     I              BEJNCD                          WFJNCD
     I              BEANC7                          WFANC7
     I              BEBKC7                          WFBKC7
     I              BEBRTX                          WFBRTX
     I              BEHMNA                          WFHMNA
     I              BEHONA                          WFHONA
     I              BEHPNA                          WFHPNA
     I              BEHNNA                          WFHNNA
     I              BEDBCD                          WFDBCD
     I              BECKTX                          WFCKTX
     I              BEB0C7                          WFB0C7
     I              BEAETX                          WFAETX
     I              BEB1NA                          WFB1NA
     I              BEB3NA                          WFB3NA
     I              BEB4NA                          WFB4NA
     I              BEB2NA                          WFB2NA
     I              BEBHCD                          WFBHCD
     I              BEC8TX                          WFC8TX
     I              BEBCNA                          WFBCNA
     I              BEA0DT                          WFA0DT
     I              BEA5DT                          WFA5DT
     I              BEGNDT                          WFGNDT
     I              BEACDT                          WFACDT
     I              BEAQCD                          WFAQCD
     I              BEB6NA                          WFB6NA
     I              BEBYNA                          WFBYNA
     I              BEBZNA                          WFBZNA
     I              BEGTST                          WFGTST
     I              BEGVST                          WFGVST
     I              BEGUST                          WFGUST
     I              BEQFST                          WFQFST
     I              BECQCD                          WFCQCD
     I              BEGJST                          WFGJST
     I              BEGWST                          WFGWST
     I              BEGXST                          WFGXST
     I              BEGYST                          WFGYST
     I              BEAODT                          WFAODT
     I              BEAIVN                          WFAIVN
     I              BECXDT                          WFCXDT
     I              BEJZVA                          WFJZVA
     I              BEA1WG                          WFA1WG
     I              BEXIST                          WFXIST
     I              BEXJST                          WFXJST
     I              BEXKST                          WFXKST
     I              BEEIDT                          WFEIDT
     I              BEAFTM                          WFAFTM
     I              BEE8CD                          WFE8CD
     I              BEE9CD                          WFE9CD
     I              BERMNB                          WFRMNB
     I              BETBNB                          WFTBNB
     I              BER1NB                          WFR1NB
     I              BEPJST                          WFPJST
     I              BEU0ST                          WFU0ST
     I              BEU1ST                          WFU1ST
     I              BEQ2CD                          WFQ2CD
     I              BEU2ST                          WFU2ST
     I              BEVEST                          WFVEST
     I              BEVFST                          WFVFST
     I              BEVGST                          WFVGST
     I              BERPCD                          WFRPCD
     I              BERNNB                          WFRNNB
     I              BEVDST                          WFVDST
     I              BEATIN                          WFATIN
     I              BEU4ST                          WFU4ST
     I              BEU5ST                          WFU5ST
     I              BERSRN                          WFRSRN
     I              BEMHNA                          WFMHNA
     I              BEMINA                          WFMINA
     I              BEWBST                          WFWBST
     I              BER4CD                          WFR4CD
     I              BEBFCD                          WFBFCD
     I              BEQ4CD                          WFQ4CD
     I              BET3NB                          WFT3NB
     I              BESICD                          WFSICD
     I              BECONB                          WFCONB
     I              BECEST                          WFCEST
     I              BEAWDT                          WFAWDT
     I              BEJPCD                          WFJPCD
     I              BEXUST                          WFXUST
     I              BEZ1ST                          WFZ1ST
     I              BEVRVA                          WFVRVA
     I              BEOBST                          WFOBST
     I              BEBCST                          WFBCST
     I              BEBDST                          WFBDST
     I              BEB7VL                          WFB7VL
     I              BEGASX                          WFGASX
     I              BEGBSX                          WFGBSX
     I              BEGCSX                          WFGCSX
     I              BEGDSX                          WFGDSX
     I              BEFNSX                          WFFNSX
     I              BEFOSX                          WFFOSX
     I              BEFPSX                          WFFPSX
     I              BEFQSX                          WFFQSX
     I              BEFRSX                          WFFRSX
     I              BEFSSX                          WFFSSX
     I              BEFTSX                          WFFTSX
     I              BEFUSX                          WFFUSX
     I              BEFVSX                          WFFVSX
     I              BEFWSX                          WFFWSX
     I              BEFXSX                          WFFXSX
     I              BEFYSX                          WFFYSX
     I              BENODT                          WFNODT
     I              BENPDT                          WFNPDT
     I              BENQDT                          WFNQDT
     I              BENRDT                          WFNRDT
     I              BENSDT                          WFNSDT
     I              BEBPTM                          WFBPTM
     I              BEBQTM                          WFBQTM
     I              BEBRTM                          WFBRTM
     I              BEBSTM                          WFBSTM
     I              BEBTTM                          WFBTTM
     I              BEH0NX                          WFH0NX
     I              BEH1NX                          WFH1NX
     I              BEH2NX                          WFH2NX
     I              BEH3NX                          WFH3NX
     I              BEH4NX                          WFH4NX
     I              BEC0C7                          WFC0C7
     I              BEUVST                          WFUVST
     I              BEUWST                          WFUWST
     I              BEUXST                          WFUXST
     I              BEAATM                          WFAATM
     I              BEAYNA                          WFAYNA
     I              BEA0NA                          WFA0NA
     I              BEAXDT                          WFAXDT
      *
     I@AMREIX
      * Order Header Extension    Co#/Ord#
      * Renamed input format fields
     I              AMAIC3                          WGAIC3
     I              AMC4NB                          WGC4NB
     I              AMRMNB                          WGRMNB
     I              AMRUNB                          WGRUNB
     I              AMXACD                          WGXACD
     I              AMOANA                          WGOANA
     I              AMHBAA                          WGHBAA
     I              AMJ0T1                          WGJ0T1
     I              AMGENY                          WGGENY
     I              AMJ1T1                          WGJ1T1
     I              AMHCAA                          WGHCAA
     I              AMQWDT                          WGQWDT
     I              AMQXDT                          WGQXDT
     I              AMQYDT                          WGQYDT
     I              AMHDAA                          WGHDAA
     I              AMCCTX                          WGCCTX
     I              AMJ2T1                          WGJ2T1
     I              AMRLNA                          WGRLNA
     I              AMRMNA                          WGRMNA
     I              AMGINY                          WGGINY
     I              AMGFNY                          WGGFNY
     I              AMGGNY                          WGGGNY
     I              AMGHNY                          WGGHNY
     I              AMHEVL                          WGHEVL
     I              AMHFVL                          WGHFVL
     I              AMHGVL                          WGHGVL
     I              AMQZDT                          WGQZDT
     I              AMQ0DT                          WGQ0DT
     I              AMQ1DT                          WGQ1DT
     I              AMQ2DT                          WGQ2DT
     I              AMC2TX                          WGC2TX
     I              AMC3TX                          WGC3TX
     I              AMC6TX                          WGC6TX
     I              AMCHTX                          WGCHTX
     I              AMCITX                          WGCITX
     I              AMCLTX                          WGCLTX
     I              AMB4TX                          WGB4TX
     I              AMCUTX                          WGCUTX
     I              AMCVTX                          WGCVTX
     I              AMB9TX                          WGB9TX
     I              AMJWSC                          WGJWSC
     I              AMITNY                          WGITNY
     I              AMLMT1                          WGLMT1
     I              AMLWAA                          WGLWAA
     I              AMFVST                          WGFVST
     I              AMF0ST                          WGF0ST
     I              AMF2ST                          WGF2ST
     I              AMF3ST                          WGF3ST
     I              AMJUSC                          WGJUSC
     I              AMJVSC                          WGJVSC
     I              AMV3T1                          WGV3T1
     I              AMV4T1                          WGV4T1
     I              AMV5T1                          WGV5T1
     I              AMV6T1                          WGV6T1
     I              AMV7T1                          WGV7T1
     I              AMV8T1                          WGV8T1
     I              AMV9T1                          WGV9T1
     I              AMWAT1                          WGWAT1
     I              AMWBT1                          WGWBT1
     I              AMWCT1                          WGWCT1
     I              AMWDT1                          WGWDT1
     I              AMQJNY                          WGQJNY
     I              AMQKNY                          WGQKNY
     I              AMQLNY                          WGQLNY
     I              AMP8NY                          WGP8NY
     I              AMP9NY                          WGP9NY
     I              AMQANY                          WGQANY
     I              AMQCNY                          WGQCNY
     I              AMQDNY                          WGQDNY
     I              AMQENY                          WGQENY
     I              AMQFNY                          WGQFNY
     I              AMQGNY                          WGQGNY
     I              AMQHNY                          WGQHNY
     I              AMQINY                          WGQINY
     I              AMQMNY                          WGQMNY
     I              AMMYU1                          WGMYU1
     I              AMJXSC                          WGJXSC
     I              AMJYSC                          WGJYSC
     I              AMJZSC                          WGJZSC
     I              AMJ0SC                          WGJ0SC
     I              AMMZU1                          WGMZU1
     I              AMM0U1                          WGM0U1
     I              AMM1U1                          WGM1U1
     I              AMM2U1                          WGM2U1
     I              AMM3U1                          WGM3U1
     I              AMW5DT                          WGW5DT
     I              AMW6DT                          WGW6DT
     I              AMUVST                          WGUVST
     I              AMUWST                          WGUWST
     I              AMUXST                          WGUXST
     I              AMVSST                          WGVSST
     I              AMAATM                          WGAATM
     I              AMAYNA                          WGAYNA
     I              AMA0NA                          WGA0NA
     I              AMAXDT                          WGAXDT
      *
     I@LYRER2
      * Trailer                   Update index
      * Renamed input format fields
     I              LYBZNA                          WHBZNA
     I              LYDXTX                          WHDXTX
     I              LYAIC3                          WHAIC3
     I              LYVDST                          WHVDST
     I              LYX3ST                          WHX3ST
     I              LYXGST                          WHXGST
     I              LYSTOY                          WHSTOY
     I              LYKKDT                          WHKKDT
     I              LYAVTM                          WHAVTM
     I              LYSTAS                          WHSTAS
     I              LYXRST                          WHXRST
     I              LYX7CD                          WHX7CD
     I              LYGXTX                          WHGXTX
     I              LYXTST                          WHXTST
     I              LYXVST                          WHXVST
     I              LYSTU3                          WHSTU3
     I              LYSTU4                          WHSTU4
     I              LYSTU5                          WHSTU5
     I              LYLCDT                          WHLCDT
     I              LYLDDT                          WHLDDT
     I              LYLEDT                          WHLEDT
     I              LYLFDT                          WHLFDT
     I              LYLGDT                          WHLGDT
     I              LYUVST                          WHUVST
     I              LYUWST                          WHUWST
     I              LYUXST                          WHUXST
     I              LYVSST                          WHVSST
     I              LYAATM                          WHAATM
     I              LYAYNA                          WHAYNA
     I              LYA0NA                          WHA0NA
     I              LYAXDT                          WHAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     I@1DBRC    E DSPMAMREL0
      * UPD : Order Header Extension    Update index
      * Current/previous master file format fields for change control
      *
     I#1DBRC      DS                            894
      * Stored master file format fields
     I                                        1   1 #1DB1
      *
     I@@I1        DS
      * Screen one error indicator store
     I                                        1 100 @I1
     I                                       31  54 INSCR1
     I@@I2        DS
      * Screen two error indicator store
     I                                        1 100 @I2
     I                                       31  41 INSCR2
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
     IYARDCS      DS                            894
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQOMFJ1    E DSOMFJCPL1
      * UPD : Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WDRMNB
     I              FJAIC3                          WDAIC3
     I              FJAODT                          WDAODT
     I              FJPJST                          WDPJST
     I              FJPKST                          WDPKST
     I              FJRNNB                          WDRNNB
     I              FJDMTX                          WDDMTX
     I              FJDNTX                          WDDNTX
     I              FJDOTX                          WDDOTX
     I              FJWTTX                          WDWTTX
     I              FJWUTX                          WDWUTX
     I              FJRPNB                          WDRPNB
     I              FJFLAM                          WDFLAM
     I              FJXQST                          WDXQST
     I              FJRRNB                          WDRRNB
     I              FJDXTX                          WDDXTX
     I              FJDYTX                          WDDYTX
     I              FJSBNB                          WDSBNB
     I              FJBZNA                          WDBZNA
     I              FJRONB                          WDRONB
     I              FJSQNB                          WDSQNB
     I              FJR1NB                          WDR1NB
     I              FJVCST                          WDVCST
     I              FJVDST                          WDVDST
     I              FJSDNB                          WDSDNB
     I              FJPAOU                          WDPAOU
     I              FJDGWG                          WDDGWG
     I              FJSXNB                          WDSXNB
     I              FJHADT                          WDHADT
     I              FJAART                          WDAART
     I              FJDHWG                          WDDHWG
     I              FJDIWG                          WDDIWG
     I              FJAQDT                          WDAQDT
     I              FJS6NB                          WDS6NB
     I              FJT4NB                          WDT4NB
     I              FJPRTM                          WDPRTM
     I              FJNPSV                          WDNPSV
     I              FJJ8TX                          WDJ8TX
     I              FJTLMI                          WDTLMI
     I              FJJ9TX                          WDJ9TX
     I              FJQ2CD                          WDQ2CD
     I              FJVPCD                          WDVPCD
     I              FJDBCD                          WDDBCD
     I              FJGRWE                          WDGRWE
     I              FJXCCD                          WDXCCD
     I              FJU2ST                          WDU2ST
     I              FJF9DT                          WDF9DT
     I              FJONTM                          WDONTM
     I              FJJ4DT                          WDJ4DT
     I              FJTRTM                          WDTRTM
     I              FJJ5DT                          WDJ5DT
     I              FJSPTM                          WDSPTM
     I              FJJ6DT                          WDJ6DT
     I              FJLFTM                          WDLFTM
     I              FJJ7DT                          WDJ7DT
     I              FJBOTM                          WDBOTM
     I              FJJ8DT                          WDJ8DT
     I              FJBLTM                          WDBLTM
     I              FJKIDT                          WDKIDT
     I              FJASTM                          WDASTM
     I              FJKADT                          WDKADT
     I              FJAJCM                          WDAJCM
     I              FJXACD                          WDXACD
     I              FJOANA                          WDOANA
     I              FJK4TX                          WDK4TX
     I              FJVOAG                          WDVOAG
     I              FJKBDT                          WDKBDT
     I              FJNBBO                          WDNBBO
     I              FJW4CD                          WDW4CD
     I              FJEFDT                          WDEFDT
     I              FJCNTN                          WDCNTN
     I              FJKCDT                          WDKCDT
     I              FJTMIN                          WDTMIN
     I              FJKDDT                          WDKDDT
     I              FJVMNB                          WDVMNB
     I              FJOCFR                          WDOCFR
     I              FJKJDT                          WDKJDT
     I              FJATTM                          WDATTM
     I              FJOTRS                          WDOTRS
     I              FJRNST                          WDRNST
     I              FJBRBK                          WDBRBK
     I              FJEIDT                          WDEIDT
     I              FJRMST                          WDRMST
     I              FJAJCD                          WDAJCD
     I              FJKKDT                          WDKKDT
     I              FJAVTM                          WDAVTM
     I              FJKZDT                          WDKZDT
     I              FJAXTM                          WDAXTM
     I              FJLHOS                          WDLHOS
     I              FJLHOR                          WDLHOR
     I              FJWNTX                          WDWNTX
     I              FJOITX                          WDOITX
     I              FJOJTX                          WDOJTX
     I              FJLLDT                          WDLLDT
     I              FJLSHG                          WDLSHG
     I              FJYPST                          WDYPST
     I              FJK0DT                          WDK0DT
     I              FJAYTM                          WDAYTM
     I              FJKNNX                          WDKNNX
     I              FJICWG                          WDICWG
     I              FJIDWG                          WDIDWG
     I              FJH9SX                          WDH9SX
     I              FJWOTX                          WDWOTX
     I              FJK1DT                          WDK1DT
     I              FJAZTM                          WDAZTM
     I              FJK2DT                          WDK2DT
     I              FJA0TM                          WDA0TM
     I              FJROST                          WDROST
     I              FJRPST                          WDRPST
     I              FJRQST                          WDRQST
     I              FJRRST                          WDRRST
     I              FJZBVA                          WDZBVA
     I              FJWPTX                          WDWPTX
     I              FJWQTX                          WDWQTX
     I              FJWRTX                          WDWRTX
     I              FJWSTX                          WDWSTX
     I              FJRVSX                          WDRVSX
     I              FJRUSX                          WDRUSX
     I              FJRWSX                          WDRWSX
     I              FJRXSX                          WDRXSX
     I              FJRYSX                          WDRYSX
     I              FJRZSX                          WDRZSX
     I              FJR0SX                          WDR0SX
     I              FJR1SX                          WDR1SX
     I              FJR2SX                          WDR2SX
     I              FJR3SX                          WDR3SX
     I              FJR4SX                          WDR4SX
     I              FJPYDT                          WDPYDT
     I              FJCKTM                          WDCKTM
     I              FJPZDT                          WDPZDT
     I              FJCLTM                          WDCLTM
     I              FJP0DT                          WDP0DT
     I              FJCMTM                          WDCMTM
     I              FJP1DT                          WDP1DT
     I              FJCNTM                          WDCNTM
     I              FJP2DT                          WDP2DT
     I              FJCOTM                          WDCOTM
     I              FJP3DT                          WDP3DT
     I              FJCQTM                          WDCQTM
     I              FJUVST                          WDUVST
     I              FJUWST                          WDUWST
     I              FJUXST                          WDUXST
     I              FJAATM                          WDAATM
     I              FJAYNA                          WDAYNA
     I              FJA0NA                          WDA0NA
     I              FJAXDT                          WDAXDT
      *
     IYBRDCS      DS                            793
     IYCRDCS      DS                            793
      * Outward parameters
     IPARC        DS                             82
      * RCD : Load Order Change Log     Retrieval index
      * N :  Sequence Number
     I                                    P   9  100PADXNB
      * I :  Load ID
     I                                    P  11  140PARMNB
      * I :  Stop_Drop
     I                                    P  15  170PARVNB
      * I :  Load Change Type
     I                                       18  23 PARVST
      * I :  Department Control Code
     I                                       24  26 PAUJST
      * I :  Change Log Prior Value
     I                                       27  38 PAMNTX
      * I :  Change Log New Value
     I                                       39  50 PAMOTX
      * I :  User Id
     I                                       51  60 PAAYNA
      * I :  Job Name
     I                                       61  70 PAA0NA
      * I :  Carrier Code
     I                                       71  73 PABZNA
      * N :  Carrier Broker Carrier Co
     I                                       74  76 PAXMCD
      * I :  Company Number
     I                                    P  77  780PAAIC3
      * I :  Order Number
     I                                    P  79  820PAC4NB
      *
     IQPDLY1    E DSPDLYREL0
      * UPD : Trailer                   Update index
      * Renamed input format fields
     I              LYBZNA                          WHBZNA
     I              LYDXTX                          WHDXTX
     I              LYAIC3                          WHAIC3
     I              LYVDST                          WHVDST
     I              LYX3ST                          WHX3ST
     I              LYXGST                          WHXGST
     I              LYSTOY                          WHSTOY
     I              LYKKDT                          WHKKDT
     I              LYAVTM                          WHAVTM
     I              LYSTAS                          WHSTAS
     I              LYXRST                          WHXRST
     I              LYX7CD                          WHX7CD
     I              LYGXTX                          WHGXTX
     I              LYXTST                          WHXTST
     I              LYXVST                          WHXVST
     I              LYSTU3                          WHSTU3
     I              LYSTU4                          WHSTU4
     I              LYSTU5                          WHSTU5
     I              LYLCDT                          WHLCDT
     I              LYLDDT                          WHLDDT
     I              LYLEDT                          WHLEDT
     I              LYLFDT                          WHLFDT
     I              LYLGDT                          WHLGDT
     I              LYUVST                          WHUVST
     I              LYUWST                          WHUWST
     I              LYUXST                          WHUXST
     I              LYVSST                          WHVSST
     I              LYAATM                          WHAATM
     I              LYAYNA                          WHAYNA
     I              LYA0NA                          WHA0NA
     I              LYAXDT                          WHAXDT
      *
     IYDRDCS      DS                            129
     IYERDCS      DS                            894
     IYFRDCS      DS                            129
      * Outward parameters
     IPBRC        DS                             11
      * KEY : Load Detail               Load/Stop/Order
      * I :  Load ID
     I                                    P   1   40PBRMNB
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Header Extension
      * I : RST Company Number
     I                                    P   1   20P1AIC3
      * I : RST Order Number
     I                                    P   3   60P1C4NB
      * B :  Load ID
     I                                    P   7  100P1RMNB
      * N :  OHE Voyage_Flight
     I                                       11  25 P1GENY
      * N :  OHE Booking Number
     I                                       26  40 P1J1T1
      * N :  OHE Carrier SCAC Code
     I                                       41  44 P1C2TX
      * N :  LD Stop_Drop
     I                                    P  45  460P1QKNY
     IP2PARM      DS
      * B :  USR Exit Program
     I                                        1   1 P2STYN
     IP3PARM      DS
      * FLD: *Arrays
      * N :  Shipping Line
     I                                        1   3 P3XACD
      * N :  Port Delv Terminal
     I                                        4  23 P3OANA
      * N :  Vessel Name
     I                                       24  53 P3K4TX
      * N :  Voyage
     I                                    P  54  560P3VOAG
      * N :  Sail Date
     I                                    P  57  600P3KBDT
      * N :  Discharge Port
     I                                       61  80 P3W4CD
      * N :  Container Number
     I                                       81  92 P3CNTN
      * N :  OHE Port Cut Date
     I                                    P  93  960P3QXDT
      * N :  OHE Load Haul Type
     I                                       97  99 P3B4TX
      * N :  OHE Arrival Date
     I                                    P 100 1030P3QYDT
      * N :  OHE Est Arrv at Dest Date
     I                                    P 104 1070P3QZDT
      * N :  OHE PowerPro Load#_Outbnd
     I                                    P 108 1120P3QGNY
      * N :  OHE Pier Pass Fee Amount
     I                                    P 113 1152P3P8NY
      * N :  OHE Port Check Fee Amount
     I                                    P 116 1182P3P9NY
      * N :  OHE Transload Container#
     I                                      119 133 P3V8T1
      * N :  OHE Transload Seal Nbr
     I                                      134 143 P3V3T1
      * N :  OHE Abs Rate Override Rsn
     I                                      144 153 P3V4T1
      * N :  OHE PowerPro Load#_Bckhl
     I                                    P 154 1580P3QHNY
      * N :  Transloader Carrier Code
     I                                      159 161 P3DYTX
      * N :  OHE Pier Pass Invoice
     I                                      162 191 P3V9T1
      * N :  OHE Carrier Nm
     I                                      192 221 P3WAT1
      * N :  OHE Port_Pier Paid Date
     I                                    P 222 2250P3Q1DT
      * N :  OHE Port Cut Time
     I                                    P 226 2280P3QANY
      * N :  Shipping Line 1 USR
     I                                      229 231 P3QXAA
     IP4PARM      DS
      * FLD: Truck Driver
      * N :  TD Last Name
     I                                        1  20 P4TQNA
      * N :  TD First Name
     I                                       21  32 P4TPNA
      * N :  TD Truck Number
     I                                    P  33  340P4S7NY
      * N :  TD Phone Number
     I                                       35  59 P4XPT1
      * N :  TD Email Address
     I                                       60 109 P4XQT1
      * N :  TD Notes
     I                                      110 159 P4XRT1
      * N :  Record Status
     I                                      160 160 P4VSST
      * N :  Job Time
     I                                    P 161 1640P4AATM
      * N :  User Id
     I                                      165 174 P4AYNA
      * N :  Job Name
     I                                      175 184 P4A0NA
      * N :  Job Date
     I                                    P 185 1880P4AXDT
     IP5PARM      DS
      * FLD: Order Header TRG
      * N :  Requested Delivery Date
     I                                    P   1   40P5EIDT
      * N :  Requested Delivery Time
     I                                    P   5   70P5AFTM
     IP6PARM      DS
      * FLD: *Arrays
      * N :  Status Flag 7  Y/N
     I                                        1   1 P6AKTX
      * N :  Status Flag 10 Y/N
     I                                        2   2 P6DGTX
      * N :  Status - Y or N
     I                                        3   3 P6B8ST
      * N :  Trailer Id
     I                                        4  23 P6DXTX
      * N :  Trailer Id            USR
     I                                       24  43 P6MUTX
      * N :  Container Number usr 1
     I                                       44  55 P6BDU1
      * N :  USR Carrier Code
     I                                       56  58 P6R6CD
      * N :  USR Company Number
     I                                    P  59  600P6FKNB
      * N :  USR Order Number
     I                                    P  61  640P6MPNB
     IP7PARM      DS
      * I :  Orders have Same Booking#
     I                                        1   1 P7NTSC
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Shipping Line not found'
      * Carrier Code
     I                                        1   3 ZA0001
      * Message data for 'Company Number  7.0 Not F'
      * Company Number CDE
     I                                    P   1   20ZA0002
      * Message data for 'Carrier doesn't exists'
      * Carrier Code
     I                                        1   3 ZA0003
      * Message data for 'CD3 Non numeric data'
      * Message data for 'CD7 Non numeric data'
      * Message data for 'Port Cut Dt/Tm enter both'
      * OHE Port Cut Date
     I                                    P   1   40ZA0004
      * USR Time 4.0
     I                                    P   5   70ZA0005
      * Message data for 'Trailer Co#<>Ld Str Co#'
      * Trailer ID USR
     I                                        1  12 ZA0006
      * Message data for 'Shipping Line not found'
      * Carrier Code
     I                                        1   3 ZA0007
      * Message data for 'Generic Message 80 ERR 2'
      * Generic Message 80 USR
     I                                        1  80 ZA0008
      * USR Status (Y/N)
     I                                       81  81 ZA0009
      * Message data for 'Generic Message 80 ERR 2'
      * Generic Message 80 USR
     I                                        1  80 ZA0010
      * USR Status (Y/N)
     I                                       81  81 ZA0011
      * Message data for 'Shipping Line not found'
      * Carrier Code
     I                                        1   3 ZA0012
      * Message data for 'Company Number  7.0 Not F'
      * Company Number CDE
     I                                    P   1   20ZA0013
      * Message data for 'Carrier doesn't exists'
      * Carrier Code
     I                                        1   3 ZA0014
      * Message data for 'Shipping Line not found'
      * Carrier Code
     I                                        1   3 ZA0015
      * Message data for 'Company Number  7.0 Not F'
      * Company Number CDE
     I                                    P   1   20ZA0016
      * Message data for 'Carrier doesn't exists'
      * Carrier Code
     I                                        1   3 ZA0017
      * Message data for 'Trailer is already assgnd'
      * Trailer ID USR
     I                                        1  12 ZA0018
      * USR Load Assigned
     I                                    P  13  160ZA0019
      * Message data for 'Load type must match load'
      * Load Type
     I                                        1   1 ZA0020
      * USR Load Type
     I                                        2   2 ZA0021
      * Trailer ID USR
     I                                        3  14 ZA0022
      * Message data for 'Trailer is not Available.'
      * Trailer ID USR
     I                                        1  12 ZA0023
      * Message data for 'Trailer is Sbd owned.'
      * Trailer ID USR
     I                                        1  12 ZA0024
      * Message data for 'Trailer is not On Yard.'
      * Trailer ID USR
     I                                        1  12 ZA0025
      * Message data for 'Trailer Co#<>Ld Str Co#'
      * Trailer ID USR
     I                                        1  12 ZA0026
      * Message data for 'Generic Message 80'
      * Generic Message 80 USR
     I                                        1  80 ZA0027
      * Message data for 'Generic Message 80'
      * Generic Message 80 USR
     I                                        1  80 ZA0028
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0029
      * Application Code
     I                                       11  16 ZA0030
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0031
      * Application Code
     I                                       11  16 ZA0032
      * Message data for 'RTV WW Exp Ord Instr cmd1'
      * Message data for 'RTV WW Exp Ord Instr cmd2'
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P1RMNB    PARM P1RMNB    WP0003  70       Load ID
     C           P2STYN    PARM P2STYN    WP0004  1        USR Exit Progra
     C           P7NTSC    PARM           WP0005  1        Orders have Sam
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Check passed parameters
     C                     EXSR FACKPM
      * Perform once if all passed, else repeat
     C           W0RPT     DOUEQ'N'
      * Display and process key screen
     C                     EXSR BADSKY
     C                     END
      * Terminate program
     C                     EXSR ZXEXPG
      *****************************************************************
      /EJECT
     CSR         BADSKY    BEGSR
      *================================================================
      * Display and process key screen
      *================================================================
      * Bypass first display of key screen is possible
     C                     MOVEL'Y'       W0BYP   1
      * Initialize key screen
     C                     EXSR MDIZ#K
      * Signal start of transaction
     C                     MOVEL'Y'       W0TRN   1
     C           W0TRN     DOWEQ'Y'
     C           W0TRN     OREQ 'K'
      * Ensure transaction continues (if reset)
     C                     MOVEL'Y'       W0TRN   1
      * Set control to display first screen
     C                     Z-ADD1         W0SCR   30
      * Conduct screen conversation
     C           W0TRN     DOWEQ'Y'
      * Convert internal to external form
     C  N09                EXSR MNCV#K
      * Is bypass key screen still viable?
     C           W0BYP     IFEQ 'Y'
     C           #1AIC3    IFEQ *ZERO                      Company Number
     C           #1C4NB    OREQ *ZERO                      Order Number
      * One or more key fields is blank
     C           *IN30     OREQ '1'
      * HOME: Reset screen fields
     C                     MOVEL'N'       W0BYP
     C                     END
     C                     END
      * Bypass key screen
     C           W0BYP     IFEQ 'N'
      * Display key screen
     C                     EXSR BBEXFM
     C                     END
      * Cancel key screen bypass
     C                     MOVEL'N'       W0BYP
      * Process response to key screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * Switch between *ADD/*CHANGE modes
     C   09                CAS            BCCHMD
      * HOME: Reset screen fields
     C   30                CAS            BDHMKY
      * Process key screen input
     C                     CAS            BEPRKY
     C                     END
     C           W0TRN     DOWEQ'R'
     C                     MOVEL'Y'       W0TRN
     C                     EXSR BEPRKY
     C                     END
      *
     C                     END
     C                     END
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBEXFM    BEGSR
      *================================================================
      * Display key screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSAK
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
     C                     MOVEL'K'       W0GRP   1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDKEY
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         BCCHMD    BEGSR
      *================================================================
      * Switch between *ADD/*CHANGE modes
      *================================================================
     C           W0PMD     IFEQ 'ADD'
     C                     MOVEL'CHG'     W0PMD   3
     C                     ELSE
     C                     MOVEL'ADD'     W0PMD
     C                     END
      *================================================================
     CSR         BCEXIT    ENDSR
      /EJECT
     CSR         BDHMKY    BEGSR
      *================================================================
      * Process HOME key
      *================================================================
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         BDEXIT    ENDSR
      /EJECT
     CSR         BEPRKY    BEGSR
      *================================================================
      * Process key screen input
      *================================================================
      * Initialise detail screen
     C                     EXSR MAIZ#1
      * Validate key fields
     C                     EXSR BFVLKY
     C           *IN99     CABEQ'1'       BEEXIT
     C           YPMTFD    CABNE*BLANKS   BEEXIT
      * Check for existing record
     C           KRTV      KLIST
     C                     KFLD           AMAIC3           Company Number
     C                     KFLD           AMC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    AMAIC3
     C                     Z-ADD#1C4NB    AMC4NB
     C           KRTV      CHAIN@AMREJF              9091  *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     SETON                     993132*
     C                     GOTO BEEXIT
     C                     END                             FI 91
      *
      * If record does not exist, flip to add mode
     C           *IN90     IFEQ '1'
     C                     MOVEL'ADD'     W0PMD
      * USER: Initialize detail screen (new record)
      * RTV LOAD ID
      * CASE: PAR.Load ID is Blank
     C           P1RMNB    IFEQ *ZERO                      *IF
      * RTV LdId/OrdDt/ShpDt  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0001           Company Number
     C                     Z-ADDP1C4NB    WL0002           Order Number
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0001    P      Order Type_Sale
     C                     Z-ADDWL0004    YL0002           Ship To Custome
     C                     MOVELWL0005    YL0003    P      Ship To Name
     C                     MOVELWL0006    YL0004    P      Ship To City
     C                     MOVELWL0007    YL0005    P      Ship To State C
     C                     Z-ADDWL0008    YL0006           Order Date
     C                     Z-ADDWL0009    YL0007           Actual Shipped
     C                     MOVELWL0010    YN0001    P      Carrier Code
     C                     MOVELWL0011    YL0008    P      Order in Use
     C                     MOVELWL0012    YL0009    P      Header Status
     C                     MOVELWL0013    YL0010    P      Credit Hold
     C                     MOVELWL0014    YL0011    P      Production Hold
     C                     Z-ADDWL0015    #DEIDT           Requested Deliv
     C                     Z-ADDWL0016    #DAFTM           Requested Deliv
     C                     Z-ADDWL0017    P1RMNB           Load ID
     C                     MOVELWL0018    YL0012    P      Export Status
     C                     MOVELWL0019    YL0013    P      Billing Activit
     C                     MOVELWL0020    YL0014    P      Block Order Fla
     C                     END                             *FI
      * Save load id from Order Header
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.Load ID NE PAR.Load ID
      *   |- c2    : PAR.Load ID is NE Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1RMNB    IFNE P1RMNB                     *IF
     C           P1RMNB    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDP1RMNB    #1RMNB           Load ID
     C                     END                             *FI
      * 07/22/19 DN R15161-Set Voyage to Null.
      * RTV Load All Fields    RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1RMNB    WL0021           Load ID
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    YL0015           Company Number
     C                     Z-ADDWL0023    #DAODT           Scheduled Ship
     C                     MOVELWL0024    YL0016    P      LTL Flag
     C                     MOVELWL0025    YL0017    P      Load Status
     C                     Z-ADDWL0026    YL0018           Reefer Temperat
     C                     MOVELWL0027    #DDMTX    P      Seal 1
     C                     MOVELWL0028    #DDNTX    P      Seal 2
     C                     MOVELWL0029    #DDOTX    P      Seal 3
     C                     MOVELWL0030    YL0019    P      Seal 4
     C                     MOVELWL0031    YL0020    P      Seal 2 Unused
     C                     Z-ADDWL0032    YL0021           Total Load Orde
     C                     Z-ADDWL0033    YL0022           Flat Amount
     C                     MOVELWL0034    YL0023    P      Allocate Pounds
     C                     Z-ADDWL0035    YL0024           Total Stops
     C                     MOVELWL0036    #DDXTX    P      Trailer Id
     C                     MOVELWL0037    #DDYTX    P      Transloader Car
     C                     Z-ADDWL0038    YL0025           BOL Time
     C                     MOVELWL0039    #DBZNA    P      Carrier Code
     C                     MOVELWL0040    YL0026    P      Truck Size
     C                     Z-ADDWL0041    YL0027           Ld Hdr_Ld Dtl U
     C                     Z-ADDWL0042    YL0028           Rated Freight
     C                     MOVELWL0043    #1CCTX    P      Ship Status
     C                     MOVELWL0044    YL0029    P      Load Type
     C                     Z-ADDWL0045    YL0030           Number Pallets
     C                     Z-ADDWL0046    YL0031           Number Pallets
     C                     Z-ADDWL0047    YL0032           Load Carrier Pa
     C                     Z-ADDWL0048    YL0033           Estimated Arriv
     C                     Z-ADDWL0049    YL0034           Actual Arrival
     C                     Z-ADDWL0050    YL0035           Actual Arrival
     C                     Z-ADDWL0051    YL0036           Trailer IN Weig
     C                     Z-ADDWL0052    YL0037           Trailer OUT Wei
     C                     Z-ADDWL0053    YL0038           Actual Departur
     C                     Z-ADDWL0054    YL0039           Departure Time
     C                     Z-ADDWL0055    YL0040           Schedule Sequen
     C                     Z-ADDWL0056    YL0041           Product Tempera
     C                     Z-ADDWL0057    YL0042           Number Spacers
     C                     MOVELWL0058    YL0043    P      Car_Veh. Initia
     C                     Z-ADDWL0059    YL0044           Total Load Mile
     C                     MOVELWL0060    YL0045    P      Recorder ID
     C                     MOVELWL0061    #DQ2CD    P      Shipping Method
     C                     MOVELWL0062    YL0046    P      Ship From Wareh
     C                     MOVELWL0063    YL0005    P      Ship To State C
     C                     Z-ADDWL0064    YL0047           Gross Weight
     C                     MOVELWL0065    YL0048    P      Carrier Broker
     C                     MOVELWL0066    YL0012    P      Export Status
     C                     Z-ADDWL0067    #DF9DT           Actual Ship Dat
     C                     MOVELWL0068    YL0049    P      On Time (Y_N)
     C                     Z-ADDWL0069    YL0050           Truck Ready Dat
     C                     Z-ADDWL0070    YL0051           Truck Ready Tim
     C                     Z-ADDWL0071    YL0052           Spotted Date
     C                     Z-ADDWL0072    YL0053           Spotted Time
     C                     Z-ADDWL0073    YL0054           Load Finished D
     C                     Z-ADDWL0074    YL0055           Load Finished T
     C                     Z-ADDWL0075    YL0056           BOL Complete Da
     C                     Z-ADDWL0076    YL0057           BOL Complete Ti
     C                     Z-ADDWL0077    YL0058           BOL Received Da
     C                     Z-ADDWL0078    YL0059           BOL Received Ti
     C                     Z-ADDWL0079    YL0060           Truck Departure
     C                     Z-ADDWL0080    YL0061           Truck Departure
     C                     Z-ADDWL0081    YL0062           Adjusted Depart
     C                     Z-ADDWL0082    YL0063           Adjusted Depart
     C                     MOVELWL0083    YL0064    P      Shipping Line
     C                     MOVELWL0084    YL0065    P      Port Delv Termi
     C                     MOVELWL0085    YL0066    P      Vessel Name
     C                     Z-ADDWL0086    YN0002           Voyage
     C                     Z-ADDWL0087    YL0067           Sail Date
     C                     MOVELWL0088    YL0068    P      Booking Number
     C                     MOVELWL0089    YL0069    P      Discharge Port
     C                     Z-ADDWL0090    YL0070           Arrival Date
     C                     MOVELWL0091    YL0071    P      Container Numbe
     C                     Z-ADDWL0092    YL0072           Date In
     C                     Z-ADDWL0093    YL0073           Time In
     C                     Z-ADDWL0094    YL0074           Date Out
     C                     Z-ADDWL0095    YL0075           Time Out
     C                     Z-ADDWL0096    YL0076           Load Total Frei
     C                     Z-ADDWL0097    YL0077           Scheduled Deliv
     C                     Z-ADDWL0098    YL0078           Scheduled Deliv
     C                     MOVELWL0099    YL0079    P      LH Unused Sts
     C                     MOVELWL0100    YL0080    P      LH Carrier Paym
     C                     Z-ADDWL0101    YL0081           Bring Back Mile
     C                     Z-ADDWL0102    YL0082           Requested Deliv
     C                     MOVELWL0103    YL0083    P      Load Acceptance
     C                     MOVELWL0104    YL0084    P      Warehouse Code
     C                     Z-ADDWL0105    YL0085           On Yard Date
     C                     Z-ADDWL0106    YL0086           On Yard Time
     C                     Z-ADDWL0107    #DHDDT           Deadline Depart
     C                     Z-ADDWL0108    YL0087           Deadline Depart
     C                     MOVELWL0109    YL0088    P      Load Held Over
     C                     MOVELWL0110    YL0089    P      Load Held Over
     C                     MOVELWL0111    YL0090    P      Load Held Over
     C                     MOVELWL0112    YL0091    P      Ocean BOL Numbe
     C                     MOVELWL0113    YL0092    P      Express Mail Nu
     C                     Z-ADDWL0114    YL0093           Express Mail Da
     C                     MOVELWL0115    YL0094    P      Load Shag Flag
     C                     MOVELWL0116    YL0095    P      Load Wash Flag
     C                     Z-ADDWL0117    YL0096           Product Complet
     C                     Z-ADDWL0118    YL0097           Product Complet
     C                     Z-ADDWL0119    YL0098           Pallets Loaded
     C                     Z-ADDWL0120    YL0099           Avg Pallet Tare
     C                     Z-ADDWL0121    YL0100           Tot Pallet Tare
     C                     MOVELWL0122    YL0101    P      Load Confirmed
     C                     MOVELWL0123    YL0102    P      Load Confirmed
     C                     Z-ADDWL0124    YL0103           Load Confirmati
     C                     Z-ADDWL0125    YL0104           Load Door 1
     C                     Z-ADDWL0126    YL0105           Override Total
     C                     Z-ADDWL0127    YL0106           Load Door 2
     C                     MOVELWL0128    YL0107    P      Partial Load
     C                     MOVELWL0129    YL0108    P      Load Confirmati
     C                     MOVELWL0130    YL0109    P      Export Load USD
     C                     MOVELWL0131    YL0110    P      Late Delivery E
     C                     Z-ADDWL0132    YL0111           Load Actual Fre
     C                     MOVELWL0133    YL0112    P      Hide on WW Load
     C                     MOVELWL0134    YL0113    P      Late Billing Em
     C                     MOVELWL0135    YL0114    P      Shipping Temp C
     C                     MOVELWL0136    YL0115    P      LH Held Over Rs
     C                     MOVELWL0137    YL0116    P      Multi Company L
     C                     MOVELWL0138    YL0117    P      Fax Sent to SSI
     C                     MOVELWL0139    YL0118    P      Schedule Pos Lo
     C                     MOVELWL0140    YL0119    P      LH Power Only L
     C                     MOVELWL0141    YL0120    P      MG Created Load
     C                     MOVELWL0142    YL0121    P      LH Unused Sts 5
     C                     MOVELWL0143    YL0122    P      Load U_M
     C                     MOVELWL0144    YL0123    P      TPM Shipment St
     C                     MOVELWL0145    YL0124    P      LH Unused Sts 8
     C                     MOVELWL0146    YL0125    P      LH On-Time Reas
     C                     MOVELWL0147    YL0126    P      LH Held Over Re
     C                     Z-ADDWL0148    YL0127           LH Carrier Paid
     C                     Z-ADDWL0149    YL0128           LH Carrier Paid
     C                     Z-ADDWL0150    YL0129           LH Last Combo P
     C                     Z-ADDWL0151    YL0130           LH Last Combo P
     C                     Z-ADDWL0152    YL0131           LPT Load Plan S
     C                     Z-ADDWL0153    YL0132           LPT Load Plan S
     C                     Z-ADDWL0154    YL0133           TPM Planned Shi
     C                     Z-ADDWL0155    YL0134           LH Unused Time
     C                     Z-ADDWL0156    YL0135           LH Unused Date
     C                     Z-ADDWL0157    YL0136           LH Unused Time
     C                     Z-ADDWL0158    YL0137           LH Unused Date
     C                     Z-ADDWL0159    YL0138           LH Unused Time
     C                     MOVELWL0160    YL0139    P      EDI Status 1
     C                     MOVELWL0161    YL0140    P      EDI Status 2
     C                     MOVELWL0162    YL0141    P      EDI Status 3
      * DTL.Deadline Depart Time 4,0 = LCL.Deadline Departure Time *HHMM
     C                     Z-ADDYL0087    XTTIM
     C           XTTIM     DIV  100       #DYBNB
      * RTV All Hdr flds b/ord RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1C4NB    WL0164           Order Number
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0163    P6FKNB           Company Number
     C                     MOVELWL0165    YL0001    P      Order Type_Sale
     C                     Z-ADDWL0166    YL0142           AR Customer Num
     C                     Z-ADDWL0167    YL0002           Ship To Custome
     C                     MOVELWL0168    #DBRTX    P      Ship To Name
     C                     MOVELWL0169    YL0143    P      Ship To Address
     C                     MOVELWL0170    YL0144    P      Ship To Address
     C                     MOVELWL0171    YL0145    P      Ship To Address
     C                     MOVELWL0172    #DAJNA    P      Ship To City
     C                     MOVELWL0173    #DEINA    P      Ship To State C
     C                     MOVELWL0174    YL0146    P      Ship To Zip_Pos
     C                     Z-ADDWL0175    YL0147           Bill to Custome
     C                     MOVELWL0176    YL0148    P      Bill to Name
     C                     MOVELWL0177    YL0149    P      Bill to Address
     C                     MOVELWL0178    YL0150    P      Bill to Address
     C                     MOVELWL0179    YL0151    P      Bill to Address
     C                     MOVELWL0180    YL0152    P      Bill to City
     C                     MOVELWL0181    YL0153    P      Bill to State C
     C                     MOVELWL0182    YL0154    P      Bill to Zip_Pos
     C                     MOVELWL0183    YL0155    P      Customer Purcha
     C                     Z-ADDWL0184    YL0006           Order Date
     C                     Z-ADDWL0185    YL0156           Requested Ship
     C                     Z-ADDWL0186    YL0007           Actual Shipped
     C                     Z-ADDWL0187    YL0157           Cancel Date
     C                     MOVELWL0188    YL0158    P      Terms Code
     C                     MOVELWL0189    YL0159    P      Special Instruc
     C                     MOVELWL0190    YL0160    P      Special Instruc
     C                     MOVELWL0191    YL0161    P      Carrier Code
     C                     MOVELWL0192    YL0162    P      Comment Print A
     C                     MOVELWL0193    YL0163    P      Comment Print I
     C                     MOVELWL0194    YL0164    P      Comment Print P
     C                     MOVELWL0195    YL0165    P      Comment Print S
     C                     MOVELWL0196    YL0166    P      Reason Code
     C                     MOVELWL0197    YL0008    P      Order in Use
     C                     MOVELWL0198    YL0009    P      Header Status
     C                     MOVELWL0199    YL0167    P      Header Status L
     C                     MOVELWL0200    YL0168    P      Order Type Prin
     C                     Z-ADDWL0201    YL0169           Scheduled Ship
     C                     MOVELWL0202    YL0170    P      User Original E
     C                     Z-ADDWL0203    YL0171           Date of Origina
     C                     Z-ADDWL0204    YL0172           Order Value Tot
     C                     Z-ADDWL0205    YL0173           Order Weight To
     C                     MOVELWL0206    YL0010    P      Credit Hold
     C                     MOVELWL0207    YL0011    P      Production Hold
     C                     MOVELWL0208    YL0174    P      New Customer Ho
     C                     Z-ADDWL0209    #DEIDT           Requested Deliv
     C                     Z-ADDWL0210    #DHMNX           Requested Deliv
     C                     MOVELWL0211    YL0175    P      Accounts Receiv
     C                     MOVELWL0212    YL0176    P      Accounts Receiv
     C                     Z-ADDWL0213    YL0177           Load ID
     C                     Z-ADDWL0214    YL0178           Absorbed Freigh
     C                     Z-ADDWL0215    YL0028           Rated Freight
     C                     MOVELWL0216    YL0016    P      LTL Flag
     C                     MOVELWL0217    YL0179    P      Price Audit
     C                     MOVELWL0218    YL0180    P      Price Status
     C                     MOVELWL0219    YL0181    P      Shipping Method
     C                     MOVELWL0220    YL0012    P      Export Status
     C                     MOVELWL0221    YL0182    P      Palletize
     C                     MOVELWL0222    YL0183    P      Shrink Wrap
     C                     MOVELWL0223    YL0184    P      Slip Sheet
     C                     MOVELWL0224    YL0185    P      Age Code
     C                     Z-ADDWL0225    YL0018           Reefer Temperat
     C                     MOVELWL0226    YL0029    P      Load Type
     C                     Z-ADDWL0227    YL0186           Attach to Invoi
     C                     MOVELWL0228    YL0187    P      Load Plan Order
     C                     MOVELWL0229    YL0188    P      Print Pick Slip
     C                     Z-ADDWL0230    YL0189           Resell Referenc
     C                     MOVELWL0231    YL0190    P      Special Comment
     C                     MOVELWL0232    YL0191    P      Special Comment
     C                     MOVELWL0233    YL0192    P      Affect Auto Acc
     C                     MOVELWL0234    YL0193    P      Sales Route Cod
     C                     MOVELWL0235    YL0194    P      Manager Level C
     C                     MOVELWL0236    YL0195    P      VP Level Code
     C                     Z-ADDWL0237    YL0196           Attach to Order
     C                     MOVELWL0238    YL0197    P      Reason for Pric
     C                     Z-ADDWL0239    YL0198           Invoice Number
     C                     MOVELWL0240    YL0199    P      Invoice Suffix
     C                     Z-ADDWL0241    YL0200           Invoice Date
     C                     MOVELWL0242    YL0201    P      Event Code
     C                     MOVELWL0243    YL0202    P      Trans Contol AS
     C                     MOVELWL0244    YL0203    P      Modified Flag
     C                     Z-ADDWL0245    YL0204           A/R order Value
     C                     MOVELWL0246    YL0013    P      Billing Activit
     C                     MOVELWL0247    YL0014    P      Block Order Fla
     C                     MOVELWL0248    YL0205    P      Order Certifica
     C                     MOVELWL0249    YL0139    P      EDI Status 1
     C                     MOVELWL0250    YL0140    P      EDI Status 2
     C                     MOVELWL0251    YL0141    P      EDI Status 3
      * * Retrieve country code for Port Cut Date restricts   E003351
      * RTV Country Code only  RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP6FKNB    WL0252           Company Number
     C                     Z-ADDP1C4NB    WL0253           Order Number
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0254    YL0206    P      Country Code
      * * Put Warehouse Type on the screen                    E002989
      * Rtv Warehouse wo/Quit RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP6FKNB    WL0255           Company Number
     C                     Z-ADDP1C4NB    WL0256           Order Number
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0257    YL0084    P      Warehouse Code
      * RTV Type/Std Chil/Chil RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0084    WL0258    P      Warehouse Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0259    #DWPST    P      Warehouse Type
     C                     MOVELWL0260    YN0003    P      Warehouse Std C
     C                     Z-ADDWL0261    YN0004           Warehouse Chill
     C                     MOVEL#DBZNA    P6R6CD           USR Carrier Cod
     C                     Z-ADD#1QGNY    #1QGNY           OHE PowerPro Lo
     C                     Z-ADDP6FKNB    #1AIC3           Company Number
      * RTV Order Info by Load RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1RMNB    WL0262           Load ID
     C                     Z-ADDP1C4NB    WL0273           Order Number
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0263    #1RUNB           Stop_Drop Seque
     C                     Z-ADDWL0264    YL0207           Stop_Drop
     C                     MOVELWL0265    YL0208    P      Comments for Pi
     C                     Z-ADDWL0266    YL0209           Miles to next s
     C                     Z-ADDWL0267    YL0210           Freight Charge
     C                     Z-ADDWL0268    YL0027           Ld Hdr_Ld Dtl U
     C                     Z-ADDWL0269    YL0211           Freight Misc. C
     C                     Z-ADDWL0270    YL0212           Freight Stop Ch
     C                     Z-ADDWL0271    YL0028           Rated Freight
     C                     Z-ADDWL0272    YL0015           Company Number
     C                     MOVELWL0274    #1CCTX    P      Ship Status
     C                     Z-ADDWL0275    YL0213           Estimated Arriv
     C                     Z-ADDWL0276    YL0033           Estimated Arriv
     C                     Z-ADDWL0277    YL0214           Appointment Con
     C                     Z-ADDWL0278    YL0215           Appointment Con
     C                     MOVELWL0279    YL0216    P      Confirmation Ma
     C                     MOVELWL0280    YL0217    P      Confirmation Nu
     C                     Z-ADDWL0281    YL0218           Actual Delivery
     C                     Z-ADDWL0282    YL0219           Actual Delivery
     C                     Z-ADDWL0283    YL0077           Scheduled Deliv
     C                     Z-ADDWL0284    YL0078           Scheduled Deliv
     C                     Z-ADDWL0285    YN0005           Deadline Depart
     C                     Z-ADDWL0286    YN0006           Deadline Depart
     C                     Z-ADDWL0287    YL0085           On Yard Date
     C                     Z-ADDWL0288    YL0086           On Yard Time
     C                     Z-ADDWL0289    YL0220           MPC Number
     C                     MOVELWL0290    YL0221    P      Load Dtl On Tim
     C                     MOVELWL0291    YL0222    P      On Time Addl Rs
     C                     MOVELWL0292    YL0223    P      Seal Nbr 1
     C                     MOVELWL0293    YL0224    P      Seal Nbr 2
     C                     MOVELWL0294    YL0225    P      Seal Nbr 3
     C                     MOVELWL0295    YL0226    P      Seal Nbr 4
     C                     MOVELWL0296    YL0227    P      Seal Nbr 5
     C                     Z-ADDWL0297    YL0228           LD Carrier Appt
     C                     Z-ADDWL0298    YL0229           LD Unused Date
     C                     Z-ADDWL0299    YL0230           LD Unused Date
     C                     Z-ADDWL0300    YL0231           LD Carrier Appt
     C                     Z-ADDWL0301    YL0232           LD Unused Time
     C                     Z-ADDWL0302    YL0233           LD Unused Time
     C                     MOVELWL0303    YL0234    P      Miles Error Sts
     C                     MOVELWL0304    YL0235    P      LD Unused Sts 2
     C                     MOVELWL0305    YL0236    P      HPB Transload S
     C                     MOVELWL0306    YL0237    P      LD Cst Svc Trac
     C                     MOVELWL0307    YL0238    P      Carrier Ref PRO
     C                     MOVELWL0308    YL0239    P      Cust Assigned A
     C                     MOVELWL0309    YL0139    P      EDI Status 1
     C                     MOVELWL0310    YL0140    P      EDI Status 2
     C                     MOVELWL0311    YL0141    P      EDI Status 3
     C                     MOVELYL0071    #1J2T1           OHE Container N
      * Convert Trailer ID to all caps                        E004079
      * CASE: DTL.OHE Container Number is Entered
     C           #1J2T1    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    YL0240           Case Sensitive
     C                     MOVEL#1J2T1    YL0240           Case Sensitive
      * CVT to Upper Alpha 3   XF - /UT User Source  * 
     C                     CALL 'PBSBXFR'              90  CVT to Upper Al
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0240    WQ0001 30        Case Sensitive
     C           YL0241    PARM *BLANK    WQ0002 30        Case Upper Fiel
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBSBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0241    #1J2T1           OHE Container N
     C                     END                             *FI
     C                     MOVEL#1J2T1    WUJ2T1           OHE Container N
     C                     MOVEL*BLANK    #1CVTX           OHE Bookings Co
     C                     MOVEL'N'       #1CVTX           OHE Bookings Co
     C                     MOVEL'ADD'     W0PMD            *Program mode
      * * First Time Calcs
      * CASE: PAR.Status - Y or N is yes
     C           P6B8ST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       P6B8ST           Status - Y or N
     C                     Z-ADD*ZERO     WUQANY           OHE Port Cut Ti
     C                     Z-ADD*ZERO     WUQXDT           OHE Port Cut Da
     C                     MOVEL*BLANK    P6BDU1           Container Numbe
     C                     END                             *FI
     C                     ELSE
      * If record does exist, flip to change mode
     C                     MOVEL'CHG'     W0PMD
      * Load screen fields from DBF
     C                     EXSR MBFL#1
      * CALC: Detail screen function fields
     C                     MOVEL*BLANK    #DW1TX           Carrier Name DR
      * Carrier Name DRV
      * RTV Carrier Name       RT - Carrier              TRG  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DBZNA    WL0312    P      Carrier Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0313    #DW1TX    P      Name
     C                     MOVELWL0314    YN0007    P      Record Status
     C                     MOVEL*BLANK    #DSQTX           Company Name DR
      * Company Name DRV
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SIRVGN
     C                     MOVEL#1XACD    #1XACD           Shipping Line
      * RTV SHIP LINE NAME for 2nd screen (Backhaul)
      * CASE: 2ND.Shipping Line is entered
     C           #1XACD    IFNE *BLANK                     *IF
      * RTV Carrier Name       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1XACD    WL0312    P      Carrier Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0313    #DGVTX    P      Name
     C                     MOVELWL0314    YL0242    P      Record Status
      * ** Error if Shipping Line does not exist
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
     C                     MOVEL#1XACD    ZA0001           Shipping Line
      * Send message 'Shipping Line not found'
     C                     MOVEL'USR2431' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * ** Retrieve company name for Backhaul To company
      * CASE: 2ND.OHE Backhaul Return to Co is not equal to zero
     C           #1QJNY    IFNE *ZERO                      *IF
      * RTV Company Name & Add RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1QJNY    WL0315           Company Number
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0316    #DAGTX    P      Name
     C                     MOVELWL0317    YN0008    P      Address Line 1
     C                     MOVELWL0318    YN0009    P      Address Line 2
     C                     MOVELWL0319    YN0010    P      Address Line 3
     C                     MOVELWL0320    YN0011    P      City
     C                     MOVELWL0321    YN0012    P      Zip Postal Code
     C                     MOVELWL0322    YN0013    P      State Code
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
     C                     Z-ADD#1QJNY    ZA0002           OHE Backhaul Re
      * Send message 'Company Number  7.0 Not F'
     C                     MOVEL'USR2008' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,31           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * ** Retrieve carrier name for Backhaul carrier
      * CASE: 2ND.OHE Backhaul Carrier Code NE WRK.Blank for 3          U
     C           #1CUTX    IFNE WUUAT1                     *IF
      * RTV Carrier Name       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1CUTX    WL0312    P      Carrier Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0313    #DA7TX    P      Name
     C                     MOVELWL0314    YN0014    P      Record Status
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
     C                     MOVEL#1CUTX    ZA0003           OHE Backhaul Ca
      * Send message 'Carrier doesn't exists'
     C                     MOVEL'USR1252' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,32           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * USER: Initialize detail screen (existing record)
      * * Add Letter of Credit to the screen                  E002768
      * ** Put DB1 fields on the screen
     C                     EXSR UASUBR                     ** Put DB1 fiel
      * ** Set par load id
      * CASE: PAR.Load ID is Blank
     C           P1RMNB    IFEQ *ZERO                      *IF
      * RTV LdId/OrdDt/ShpDt  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0001           Company Number
     C                     Z-ADDP1C4NB    WL0002           Order Number
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0001    P      Order Type_Sale
     C                     Z-ADDWL0004    YL0002           Ship To Custome
     C                     MOVELWL0005    YL0003    P      Ship To Name
     C                     MOVELWL0006    YL0004    P      Ship To City
     C                     MOVELWL0007    YL0005    P      Ship To State C
     C                     Z-ADDWL0008    YL0006           Order Date
     C                     Z-ADDWL0009    YL0007           Actual Shipped
     C                     MOVELWL0010    YN0001    P      Carrier Code
     C                     MOVELWL0011    YL0008    P      Order in Use
     C                     MOVELWL0012    YL0009    P      Header Status
     C                     MOVELWL0013    YL0010    P      Credit Hold
     C                     MOVELWL0014    YL0011    P      Production Hold
     C                     Z-ADDWL0015    #DEIDT           Requested Deliv
     C                     Z-ADDWL0016    #DHMNX           Requested Deliv
     C                     Z-ADDWL0017    P1RMNB           Load ID
     C                     MOVELWL0018    YL0012    P      Export Status
     C                     MOVELWL0019    YL0013    P      Billing Activit
     C                     MOVELWL0020    YL0014    P      Block Order Fla
     C                     END                             *FI
     C                     MOVEL'CHG'     W0PMD            *Program mode
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           WUSDTE    PARM *ZERO     WQ0003 155       Current System
     C           WUZHNB    PARM *ZERO     WQ0004 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * RTV Load All Fields    RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1RMNB    WL0021           Load ID
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    YN0015           Company Number
     C                     Z-ADDWL0023    #DAODT           Scheduled Ship
     C                     MOVELWL0024    YL0016    P      LTL Flag
     C                     MOVELWL0025    YL0017    P      Load Status
     C                     Z-ADDWL0026    YL0018           Reefer Temperat
     C                     MOVELWL0027    #DDMTX    P      Seal 1
     C                     MOVELWL0028    #DDNTX    P      Seal 2
     C                     MOVELWL0029    #DDOTX    P      Seal 3
     C                     MOVELWL0030    YN0016    P      Seal 4
     C                     MOVELWL0031    YN0017    P      Seal 2 Unused
     C                     Z-ADDWL0032    YL0021           Total Load Orde
     C                     Z-ADDWL0033    YL0022           Flat Amount
     C                     MOVELWL0034    YL0023    P      Allocate Pounds
     C                     Z-ADDWL0035    YL0024           Total Stops
     C                     MOVELWL0036    #DDXTX    P      Trailer Id
     C                     MOVELWL0037    #DDYTX    P      Transloader Car
     C                     Z-ADDWL0038    YL0025           BOL Time
     C                     MOVELWL0039    #DBZNA    P      Carrier Code
     C                     MOVELWL0040    YL0026    P      Truck Size
     C                     Z-ADDWL0041    YL0027           Ld Hdr_Ld Dtl U
     C                     Z-ADDWL0042    YL0028           Rated Freight
     C                     MOVELWL0043    #1CCTX    P      Ship Status
     C                     MOVELWL0044    YL0029    P      Load Type
     C                     Z-ADDWL0045    YL0030           Number Pallets
     C                     Z-ADDWL0046    YL0031           Number Pallets
     C                     Z-ADDWL0047    YL0032           Load Carrier Pa
     C                     Z-ADDWL0048    YL0033           Estimated Arriv
     C                     Z-ADDWL0049    YL0034           Actual Arrival
     C                     Z-ADDWL0050    YL0035           Actual Arrival
     C                     Z-ADDWL0051    YL0036           Trailer IN Weig
     C                     Z-ADDWL0052    YL0037           Trailer OUT Wei
     C                     Z-ADDWL0053    YL0038           Actual Departur
     C                     Z-ADDWL0054    YL0039           Departure Time
     C                     Z-ADDWL0055    YL0040           Schedule Sequen
     C                     Z-ADDWL0056    YL0041           Product Tempera
     C                     Z-ADDWL0057    YL0042           Number Spacers
     C                     MOVELWL0058    YL0043    P      Car_Veh. Initia
     C                     Z-ADDWL0059    YL0044           Total Load Mile
     C                     MOVELWL0060    YL0045    P      Recorder ID
     C                     MOVELWL0061    #DQ2CD    P      Shipping Method
     C                     MOVELWL0062    YL0046    P      Ship From Wareh
     C                     MOVELWL0063    YL0005    P      Ship To State C
     C                     Z-ADDWL0064    YL0047           Gross Weight
     C                     MOVELWL0065    YL0048    P      Carrier Broker
     C                     MOVELWL0066    YL0012    P      Export Status
     C                     Z-ADDWL0067    YL0243           Actual Ship Dat
     C                     MOVELWL0068    YL0049    P      On Time (Y_N)
     C                     Z-ADDWL0069    YL0050           Truck Ready Dat
     C                     Z-ADDWL0070    YL0051           Truck Ready Tim
     C                     Z-ADDWL0071    YL0052           Spotted Date
     C                     Z-ADDWL0072    YL0053           Spotted Time
     C                     Z-ADDWL0073    YL0054           Load Finished D
     C                     Z-ADDWL0074    YL0055           Load Finished T
     C                     Z-ADDWL0075    YL0056           BOL Complete Da
     C                     Z-ADDWL0076    YL0057           BOL Complete Ti
     C                     Z-ADDWL0077    YL0058           BOL Received Da
     C                     Z-ADDWL0078    YL0059           BOL Received Ti
     C                     Z-ADDWL0079    YL0060           Truck Departure
     C                     Z-ADDWL0080    YL0061           Truck Departure
     C                     Z-ADDWL0081    YL0062           Adjusted Depart
     C                     Z-ADDWL0082    YL0063           Adjusted Depart
     C                     MOVELWL0083    YN0018    P      Shipping Line
     C                     MOVELWL0084    YN0019    P      Port Delv Termi
     C                     MOVELWL0085    YN0020    P      Vessel Name
     C                     Z-ADDWL0086    YN0002           Voyage
     C                     Z-ADDWL0087    YN0021           Sail Date
     C                     MOVELWL0088    YN0022    P      Booking Number
     C                     MOVELWL0089    YN0023    P      Discharge Port
     C                     Z-ADDWL0090    YL0070           Arrival Date
     C                     MOVELWL0091    YL0071    P      Container Numbe
     C                     Z-ADDWL0092    YL0072           Date In
     C                     Z-ADDWL0093    YL0073           Time In
     C                     Z-ADDWL0094    YL0074           Date Out
     C                     Z-ADDWL0095    YL0075           Time Out
     C                     Z-ADDWL0096    YL0076           Load Total Frei
     C                     Z-ADDWL0097    YL0077           Scheduled Deliv
     C                     Z-ADDWL0098    YL0078           Scheduled Deliv
     C                     MOVELWL0099    YL0079    P      LH Unused Sts
     C                     MOVELWL0100    YL0080    P      LH Carrier Paym
     C                     Z-ADDWL0101    YL0081           Bring Back Mile
     C                     Z-ADDWL0102    #DEIDT           Requested Deliv
     C                     MOVELWL0103    YL0083    P      Load Acceptance
     C                     MOVELWL0104    YL0084    P      Warehouse Code
     C                     Z-ADDWL0105    YL0085           On Yard Date
     C                     Z-ADDWL0106    YL0086           On Yard Time
     C                     Z-ADDWL0107    #DHDDT           Deadline Depart
     C                     Z-ADDWL0108    YL0087           Deadline Depart
     C                     MOVELWL0109    YL0088    P      Load Held Over
     C                     MOVELWL0110    YL0089    P      Load Held Over
     C                     MOVELWL0111    YL0090    P      Load Held Over
     C                     MOVELWL0112    YN0024    P      Ocean BOL Numbe
     C                     MOVELWL0113    YL0092    P      Express Mail Nu
     C                     Z-ADDWL0114    YL0093           Express Mail Da
     C                     MOVELWL0115    YL0094    P      Load Shag Flag
     C                     MOVELWL0116    YL0095    P      Load Wash Flag
     C                     Z-ADDWL0117    YL0096           Product Complet
     C                     Z-ADDWL0118    YL0097           Product Complet
     C                     Z-ADDWL0119    YL0098           Pallets Loaded
     C                     Z-ADDWL0120    YL0099           Avg Pallet Tare
     C                     Z-ADDWL0121    YL0100           Tot Pallet Tare
     C                     MOVELWL0122    YL0101    P      Load Confirmed
     C                     MOVELWL0123    YL0102    P      Load Confirmed
     C                     Z-ADDWL0124    YL0103           Load Confirmati
     C                     Z-ADDWL0125    YL0104           Load Door 1
     C                     Z-ADDWL0126    YL0105           Override Total
     C                     Z-ADDWL0127    YL0106           Load Door 2
     C                     MOVELWL0128    YL0107    P      Partial Load
     C                     MOVELWL0129    YL0108    P      Load Confirmati
     C                     MOVELWL0130    YL0109    P      Export Load USD
     C                     MOVELWL0131    YL0110    P      Late Delivery E
     C                     Z-ADDWL0132    YL0111           Load Actual Fre
     C                     MOVELWL0133    YL0112    P      Hide on WW Load
     C                     MOVELWL0134    YL0113    P      Late Billing Em
     C                     MOVELWL0135    YL0114    P      Shipping Temp C
     C                     MOVELWL0136    YL0115    P      LH Held Over Rs
     C                     MOVELWL0137    YL0116    P      Multi Company L
     C                     MOVELWL0138    YL0117    P      Fax Sent to SSI
     C                     MOVELWL0139    YL0118    P      Schedule Pos Lo
     C                     MOVELWL0140    YL0119    P      LH Power Only L
     C                     MOVELWL0141    YL0120    P      MG Created Load
     C                     MOVELWL0142    YL0121    P      LH Unused Sts 5
     C                     MOVELWL0143    YL0122    P      Load U_M
     C                     MOVELWL0144    YL0123    P      TPM Shipment St
     C                     MOVELWL0145    YL0124    P      LH Unused Sts 8
     C                     MOVELWL0146    YL0125    P      LH On-Time Reas
     C                     MOVELWL0147    YL0126    P      LH Held Over Re
     C                     Z-ADDWL0148    YL0127           LH Carrier Paid
     C                     Z-ADDWL0149    YL0128           LH Carrier Paid
     C                     Z-ADDWL0150    YL0129           LH Last Combo P
     C                     Z-ADDWL0151    YL0130           LH Last Combo P
     C                     Z-ADDWL0152    YL0131           LPT Load Plan S
     C                     Z-ADDWL0153    YL0132           LPT Load Plan S
     C                     Z-ADDWL0154    YL0133           TPM Planned Shi
     C                     Z-ADDWL0155    YL0134           LH Unused Time
     C                     Z-ADDWL0156    YL0135           LH Unused Date
     C                     Z-ADDWL0157    YL0136           LH Unused Time
     C                     Z-ADDWL0158    YL0137           LH Unused Date
     C                     Z-ADDWL0159    YL0138           LH Unused Time
     C                     MOVELWL0160    YL0139    P      EDI Status 1
     C                     MOVELWL0161    YL0140    P      EDI Status 2
     C                     MOVELWL0162    YL0141    P      EDI Status 3
      * DTL.Deadline Depart Time 4,0 = LCL.Deadline Departure Time *HHMM
     C                     Z-ADDYL0087    XTTIM
     C           XTTIM     DIV  100       #DYBNB
      * RTV All Hdr flds b/ord RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1C4NB    WL0164           Order Number
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0163    YN0015           Company Number
     C                     MOVELWL0165    YN0025    P      Order Type_Sale
     C                     Z-ADDWL0166    YN0026           AR Customer Num
     C                     Z-ADDWL0167    YL0002           Ship To Custome
     C                     MOVELWL0168    #DBRTX    P      Ship To Name
     C                     MOVELWL0169    YL0143    P      Ship To Address
     C                     MOVELWL0170    YL0144    P      Ship To Address
     C                     MOVELWL0171    YL0145    P      Ship To Address
     C                     MOVELWL0172    #DAJNA    P      Ship To City
     C                     MOVELWL0173    #DEINA    P      Ship To State C
     C                     MOVELWL0174    YL0146    P      Ship To Zip_Pos
     C                     Z-ADDWL0175    YN0027           Bill to Custome
     C                     MOVELWL0176    YN0028    P      Bill to Name
     C                     MOVELWL0177    YN0029    P      Bill to Address
     C                     MOVELWL0178    YN0030    P      Bill to Address
     C                     MOVELWL0179    YN0031    P      Bill to Address
     C                     MOVELWL0180    YN0032    P      Bill to City
     C                     MOVELWL0181    YN0033    P      Bill to State C
     C                     MOVELWL0182    YN0034    P      Bill to Zip_Pos
     C                     MOVELWL0183    YN0035    P      Customer Purcha
     C                     Z-ADDWL0184    YN0036           Order Date
     C                     Z-ADDWL0185    YN0037           Requested Ship
     C                     Z-ADDWL0186    #DF9DT           Actual Shipped
     C                     Z-ADDWL0187    YN0038           Cancel Date
     C                     MOVELWL0188    YN0039    P      Terms Code
     C                     MOVELWL0189    YL0159    P      Special Instruc
     C                     MOVELWL0190    YL0160    P      Special Instruc
     C                     MOVELWL0191    YL0161    P      Carrier Code
     C                     MOVELWL0192    YN0040    P      Comment Print A
     C                     MOVELWL0193    YN0041    P      Comment Print I
     C                     MOVELWL0194    YN0042    P      Comment Print P
     C                     MOVELWL0195    YN0043    P      Comment Print S
     C                     MOVELWL0196    YN0044    P      Reason Code
     C                     MOVELWL0197    YN0045    P      Order in Use
     C                     MOVELWL0198    YN0046    P      Header Status
     C                     MOVELWL0199    YN0047    P      Header Status L
     C                     MOVELWL0200    YN0048    P      Order Type Prin
     C                     Z-ADDWL0201    YL0169           Scheduled Ship
     C                     MOVELWL0202    YN0049    P      User Original E
     C                     Z-ADDWL0203    YN0050           Date of Origina
     C                     Z-ADDWL0204    YN0051           Order Value Tot
     C                     Z-ADDWL0205    YN0052           Order Weight To
     C                     MOVELWL0206    YN0053    P      Credit Hold
     C                     MOVELWL0207    YN0054    P      Production Hold
     C                     MOVELWL0208    YN0055    P      New Customer Ho
     C                     Z-ADDWL0209    P5EIDT           Requested Deliv
     C                     Z-ADDWL0210    P5AFTM           Requested Deliv
     C                     MOVELWL0211    YN0056    P      Accounts Receiv
     C                     MOVELWL0212    YN0057    P      Accounts Receiv
     C                     Z-ADDWL0213    YN0058           Load ID
     C                     Z-ADDWL0214    YN0059           Absorbed Freigh
     C                     Z-ADDWL0215    YN0060           Rated Freight
     C                     MOVELWL0216    YN0061    P      LTL Flag
     C                     MOVELWL0217    YN0062    P      Price Audit
     C                     MOVELWL0218    YN0063    P      Price Status
     C                     MOVELWL0219    #DQ2CD    P      Shipping Method
     C                     MOVELWL0220    YL0012    P      Export Status
     C                     MOVELWL0221    YN0064    P      Palletize
     C                     MOVELWL0222    YN0065    P      Shrink Wrap
     C                     MOVELWL0223    YN0066    P      Slip Sheet
     C                     MOVELWL0224    YN0067    P      Age Code
     C                     Z-ADDWL0225    YN0068           Reefer Temperat
     C                     MOVELWL0226    YN0069    P      Load Type
     C                     Z-ADDWL0227    YN0070           Attach to Invoi
     C                     MOVELWL0228    YN0071    P      Load Plan Order
     C                     MOVELWL0229    YN0072    P      Print Pick Slip
     C                     Z-ADDWL0230    YN0073           Resell Referenc
     C                     MOVELWL0231    YL0190    P      Special Comment
     C                     MOVELWL0232    YL0191    P      Special Comment
     C                     MOVELWL0233    YN0074    P      Affect Auto Acc
     C                     MOVELWL0234    YN0075    P      Sales Route Cod
     C                     MOVELWL0235    YN0076    P      Manager Level C
     C                     MOVELWL0236    YN0077    P      VP Level Code
     C                     Z-ADDWL0237    YN0078           Attach to Order
     C                     MOVELWL0238    YN0079    P      Reason for Pric
     C                     Z-ADDWL0239    YN0080           Invoice Number
     C                     MOVELWL0240    YN0081    P      Invoice Suffix
     C                     Z-ADDWL0241    YN0082           Invoice Date
     C                     MOVELWL0242    YN0083    P      Event Code
     C                     MOVELWL0243    YN0084    P      Trans Contol AS
     C                     MOVELWL0244    YN0085    P      Modified Flag
     C                     Z-ADDWL0245    YN0086           A/R order Value
     C                     MOVELWL0246    YN0087    P      Billing Activit
     C                     MOVELWL0247    YN0088    P      Block Order Fla
     C                     MOVELWL0248    YN0089    P      Order Certifica
     C                     MOVELWL0249    YN0090    P      EDI Status 1
     C                     MOVELWL0250    YN0091    P      EDI Status 2
     C                     MOVELWL0251    YN0092    P      EDI Status 3
      * * Put Warehouse Type on the screen                    E002989
      * Rtv Warehouse wo/Quit RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP6FKNB    WL0255           Company Number
     C                     Z-ADDP1C4NB    WL0256           Order Number
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0257    YL0084    P      Warehouse Code
      * RTV Type/Std Chil/Chil RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0084    WL0258    P      Warehouse Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0259    #DWPST    P      Warehouse Type
     C                     MOVELWL0260    YN0003    P      Warehouse Std C
     C                     Z-ADDWL0261    YN0004           Warehouse Chill
      * * Retrieve country code for Port Cut Date restricts      E003351
      * RTV Country Code only  RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP6FKNB    WL0252           Company Number
     C                     Z-ADDP1C4NB    WL0253           Order Number
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0254    YL0206    P      Country Code
      * ** Default Requested Delivery Date if zeros           E003143
      * CASE: DTL.Requested Delivery Date is not entered
     C           #DEIDT    IFEQ *ZERO                      *IF
     C                     Z-ADDP5EIDT    #DEIDT           Requested Deliv
     C                     END                             *FI
      * ** Default Requested Delivery Time if zeros           E003143
      * CASE: DTL.Requested Delivery Time is Zero
     C           #DAFTM    IFEQ *ZERO                      *IF
     C                     Z-ADDP5AFTM    #DHMNX           USR From Time 4
     C                     END                             *FI
     C                     Z-ADDP1C4NB    #1C4NB           Order Number
     C                     MOVEL#DBZNA    P6R6CD           USR Carrier Cod
     C                     Z-ADD#1AIC3    P6FKNB           USR Company Num
      * RTV Order Info by Load RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1RMNB    WL0262           Load ID
     C                     Z-ADDP1C4NB    WL0273           Order Number
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0263    #1RUNB           Stop_Drop Seque
     C                     Z-ADDWL0264    YN0093           Stop_Drop
     C                     MOVELWL0265    YN0094    P      Comments for Pi
     C                     Z-ADDWL0266    YN0095           Miles to next s
     C                     Z-ADDWL0267    YN0096           Freight Charge
     C                     Z-ADDWL0268    YN0097           Ld Hdr_Ld Dtl U
     C                     Z-ADDWL0269    YN0098           Freight Misc. C
     C                     Z-ADDWL0270    YN0099           Freight Stop Ch
     C                     Z-ADDWL0271    YN0060           Rated Freight
     C                     Z-ADDWL0272    YN0015           Company Number
     C                     MOVELWL0274    #1CCTX    P      Ship Status
     C                     Z-ADDWL0275    YN0100           Estimated Arriv
     C                     Z-ADDWL0276    YN0101           Estimated Arriv
     C                     Z-ADDWL0277    YN0102           Appointment Con
     C                     Z-ADDWL0278    YN0103           Appointment Con
     C                     MOVELWL0279    YN0104    P      Confirmation Ma
     C                     MOVELWL0280    YN0105    P      Confirmation Nu
     C                     Z-ADDWL0281    YN0106           Actual Delivery
     C                     Z-ADDWL0282    YN0107           Actual Delivery
     C                     Z-ADDWL0283    YN0108           Scheduled Deliv
     C                     Z-ADDWL0284    YN0109           Scheduled Deliv
     C                     Z-ADDWL0285    YN0005           Deadline Depart
     C                     Z-ADDWL0286    YN0006           Deadline Depart
     C                     Z-ADDWL0287    YN0110           On Yard Date
     C                     Z-ADDWL0288    YN0111           On Yard Time
     C                     Z-ADDWL0289    YN0112           MPC Number
     C                     MOVELWL0290    YN0113    P      Load Dtl On Tim
     C                     MOVELWL0291    YN0114    P      On Time Addl Rs
     C                     MOVELWL0292    YN0115    P      Seal Nbr 1
     C                     MOVELWL0293    YN0116    P      Seal Nbr 2
     C                     MOVELWL0294    YN0117    P      Seal Nbr 3
     C                     MOVELWL0295    YN0118    P      Seal Nbr 4
     C                     MOVELWL0296    YN0119    P      Seal Nbr 5
     C                     Z-ADDWL0297    YN0120           LD Carrier Appt
     C                     Z-ADDWL0298    YN0121           LD Unused Date
     C                     Z-ADDWL0299    YN0122           LD Unused Date
     C                     Z-ADDWL0300    YN0123           LD Carrier Appt
     C                     Z-ADDWL0301    YN0124           LD Unused Time
     C                     Z-ADDWL0302    YN0125           LD Unused Time
     C                     MOVELWL0303    YN0126    P      Miles Error Sts
     C                     MOVELWL0304    YN0127    P      LD Unused Sts 2
     C                     MOVELWL0305    YN0128    P      HPB Transload S
     C                     MOVELWL0306    YN0129    P      LD Cst Svc Trac
     C                     MOVELWL0307    YN0130    P      Carrier Ref PRO
     C                     MOVELWL0308    YN0131    P      Cust Assigned A
     C                     MOVELWL0309    YN0090    P      EDI Status 1
     C                     MOVELWL0310    YN0091    P      EDI Status 2
     C                     MOVELWL0311    YN0092    P      EDI Status 3
      * Convert Container to all caps                         E004079
      * CASE: DTL.OHE Container Number is Entered
     C           #1J2T1    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    YL0240           Case Sensitive
     C                     MOVEL#1J2T1    YL0240           Case Sensitive
      * CVT to Upper Alpha 3   XF - /UT User Source  * 
     C                     CALL 'PBSBXFR'              90  CVT to Upper Al
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0240    WQ0005 30        Case Sensitive
     C           YL0241    PARM *BLANK    WQ0006 30        Case Upper Fiel
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBSBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0241    #1J2T1           OHE Container N
     C                     END                             *FI
     C                     MOVEL#1J2T1    WUJ2T1           OHE Container N
      * ** First Time Calcs: Update any blank fields
     C                     EXSR UBSUBR                     ** First Time C
      * CASE: LCL.MG Created Load is Not MG Created Load
     C           YL0120    IFEQ *BLANK                     *IF
      * ** Retrieve Shipping Line name from carrier file
      * CASE: DTL.Shipping Line is entered
     C           #1XACD    IFNE *BLANK                     *IF
      * RTV Carrier Name       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1XACD    WL0312    P      Carrier Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0313    #DGVTX    P      Name
     C                     MOVELWL0314    YL0242    P      Record Status
     C                     END                             *FI
      * ** Retrieve Port City from Shipping Line/Port file
      * CASE: DTL.Port Delv Terminal is Entered
     C           #1OANA    IFNE *BLANK                     *IF
      * RTV Shp Line/Port All  RT - Shipping Line/Port  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1XACD    WL0323    P      Shipping Line
     C                     MOVEL#1OANA    WL0324    P      Port Delv Termi
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0325    #1HBAA    P      Port City
     C                     MOVELWL0326    YL0246    P      Port Address Li
     C                     MOVELWL0327    YL0247    P      Port Address Li
     C                     MOVELWL0328    #DXBCD    P      Sail Port State
     C                     MOVELWL0329    YL0248    P      Port Zip/Postal
     C                     Z-ADDWL0330    YL0249           Port Phone Numb
     C                     MOVELWL0331    YL0250    P      Port Fax Number
      * dont validate upon entry  C3913 RMC 2/11/15
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    #DW1TX           Carrier Name DR
      * Carrier Name DRV
      * RTV Carrier Name       RT - Carrier              TRG  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DBZNA    WL0312    P      Carrier Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0313    #DW1TX    P      Name
     C                     MOVELWL0314    YN0007    P      Record Status
     C                     END
      *..................................................
     C   99                GOTO BEEXIT
      *
     C           YPMTFD    IFEQ *BLANK
      * No error: Display and process details
     C                     EXSR CADSDA
     C                     END
      *
      *================================================================
     CSR         BEEXIT    ENDSR
      /EJECT
     CSR         BFVLKY    BEGSR
      *================================================================
      * Validate key fields
      *================================================================
      * Validate Company Number and convert to internal.
      * CD3 Ext/Int
     C                     MOVELV1AIC3    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC3  3
     C                     MOVEA*BLANKS   K3
     C                     Z-ADD3         C       30
     C                     Z-ADD3         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUDMCD    J3
     C                     MOVE *BLANKS   W0RTN
     C                     DO   3
     C           J3,C      IFNE ' '
     C                     MOVEAJ3,C      K3,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK3        JUSTC3
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC3    TESTC   1
     C           TESTC     IFGT '?'
     C           TESTC     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC3     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC3    WUDMCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,002                    *IF
      * Setup message data for message
      * Send message 'CD3 Non numeric data'
     C                     MOVEL'USR0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #1AIC3           CD3 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUDMCD    #1AIC3           CD3 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     9931  *
     C                     END
      * Validate Order Number and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV1C4NB    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,002                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #1C4NB           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #1C4NB           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     9932  *
     C                     END
     C           W0PMD     IFNE 'ADD'
     C           YPMTFD    ORNE *BLANK
      * Select existing record
     C                     EXSR VACKRL
     C                     END
      * Check relations
      * Check restriction within
     C                     EXSR VBCKRL
      * Company Number required
     C           #1AIC3    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Order Number required
     C           #1C4NB    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9932  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         BFEXIT    ENDSR
      /EJECT
     CSR         CADSDA    BEGSR
      *================================================================
      * Display and process detail screen
      *================================================================
      * Conduct detail screen conversation
      * - repeat until screen control flag is reset:
     C           W0TRN     DOWEQ'Y'
      * Convert internal to external form
     C                     EXSR MOCV#D
      * Display detail screen
     C                     EXSR CBEXFM
      * Process response to detail screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * Redisplay previous screen
     C   12                CAS            CCDSPV
      * HOME: Reset screen fields
     C   30                CAS            CCDSPV
      * Process detail screen input
     C                     CAS            CFPRSC
     C                     END
     C           W0TRN     IFEQ 'R'
     C           W0PMD     IFEQ 'ADD'
     C                     EXSR MAIZ#1
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         CBEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
     C           W0HLP     DOUEQ'N'
     C           W0ROL     ANDEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Update screen time
     C                     TIME           ##TME
     C           W0SCR     IFEQ 1
      * Set error
     C                     MOVEAINSCR1    *IN,31
     C                     MOVEL'1'       W0GRP   1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y1SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT2
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
     C                     ELSE
     C           W0SCR     IFEQ 2
      * Set error
     C                     MOVEAINSCR2    *IN,31
     C                     MOVEL'2'       W0GRP   1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y2SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT3
     C                     EXFMT#RCDDTL2
      * Test cursor
     C                     EXSR Y8TST
     C                     END
     C                     END
      * Reset roll flag
     C                     MOVEL'N'       W0ROL   1
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Show next page of details
     C   27                EXSR CDNXSC
      * Show previous page of details
     C   28                EXSR CEPVSC
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CBEXIT    ENDSR
      /EJECT
     CSR         CCDSPV    BEGSR
      *================================================================
      * Redisplay previous screen
      *================================================================
     C   30                MOVEL'R'       W0TRN
     C   12                MOVEL'K'       W0TRN
      * Initialise error memories
     C                     MOVE *ZERO     INSCR1
     C                     MOVE *ZERO     INSCR2
      *================================================================
     CSR         CCEXIT    ENDSR
      /EJECT
     CSR         CDNXSC    BEGSR
      *================================================================
      * Display next screen
      *================================================================
      * Set roll flag
     C                     MOVEL'Y'       W0ROL   1
     C                     Z-ADD2         W0SCR
      *================================================================
     CSR         CDEXIT    ENDSR
      /EJECT
     CSR         CEPVSC    BEGSR
      *================================================================
      * Display previous screen
      *================================================================
      * Set roll flag
     C                     MOVEL'Y'       W0ROL   1
     C                     Z-ADD1         W0SCR
      *================================================================
     CSR         CEEXIT    ENDSR
      /EJECT
     CSR         CFPRSC    BEGSR
      *================================================================
      * Validate record
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate details
     C                     MOVE *ZEROS    INSCR1
     C                     MOVE *ZEROS    INSCR2
     C                     EXSR DCVLDL
      * Display first screen in error
     C           INSCR1    IFNE *ZERO
     C                     Z-ADD1         W0SCR
     C                     ELSE
     C           INSCR2    IFNE *ZERO
     C                     Z-ADD2         W0SCR
     C                     END
     C                     END
      * QUIT if error:
     C           *IN99     CABEQ'1'       CFEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       CFEXIT
      * Prompt for confirmation
     C                     EXSR EAPMCF
      * Quit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO CFEXIT
     C                     END
      * No error: update record
     C                     EXSR EBPR##
      *================================================================
     CSR         CFEXIT    ENDSR
      /EJECT
     CSR         DCVLDL    BEGSR
      *================================================================
      * Validate details
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
     C           YPMTFD    IFEQ *BLANKS
      * Initialise derived fields
     C                     EXSR MFIZ#2
     C                     END
      * Validate OHE Port Cut Date
      * External date
     C                     Z-ADDV1QXDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C                     Z-ADDXDINDT    #1QXDT
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,38
     C                     SETON                     99    *
     C                     END
      * Validate OHE Sail_Flight Date
      * External date
     C                     Z-ADDV1QWDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C                     Z-ADDXDINDT    #1QWDT
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,41
     C                     SETON                     99    *
     C                     END
      * Validate OHE Arrival Date
      * External date
     C                     Z-ADDV1QYDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C                     Z-ADDXDINDT    #1QYDT
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,42
     C                     SETON                     99    *
     C                     END
      * Validate OHE Est Arrv at Dest Date
      * External date
     C                     Z-ADDV1QZDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C                     Z-ADDXDINDT    #1QZDT
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,43
     C                     SETON                     99    *
     C                     END
      * Validate OHE Port_Pier Paid Date
      * External date
     C                     Z-ADDV1Q1DT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C                     Z-ADDXDINDT    #1Q1DT
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,52
     C                     SETON                     99    *
     C                     END
      * Validate OHE Backhaul ETA RtrnDate
      * External date
     C                     Z-ADDV1Q0DT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C                     Z-ADDXDINDT    #1Q0DT
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I2,36
     C                     SETON                     99    *
     C                     END
      * Validate OHE Backhaul Status
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1CITX'  IFEQ YPMTFD
     C           W0SCR     ANDEQ2
      * OHE Backhaul Status
     C                     MOVEL#1CITX    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZKCITX
     C                     SELEC
     C           W0INVL    WHEQ 'F'                        F
     C                     Z-ADD1         ZKCITX
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD2         ZKCITX
     C           W0INVL    WHEQ 'B'                        B
     C                     Z-ADD3         ZKCITX
     C           W0INVL    WHEQ 'D'                        D
     C                     Z-ADD4         ZKCITX
     C                     ENDSL
     C                     EXFMTZICITX
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZKCITX    WHEQ 1
     C                     MOVEL'F'       W0INVL           F
     C           ZKCITX    WHEQ 2
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C           ZKCITX    WHEQ 3
     C                     MOVEL'B'       W0INVL           B
     C           ZKCITX    WHEQ 4
     C                     MOVEL'D'       W0INVL           D
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1CITX
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I2,38
     C                     SETON                     99    *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate detail screen fields
     C                     MOVEL'N'       P6AKTX           Status Flag 7
      * Port Cut Date and Time must both be entered or both be zeros   E0
      * CASE:
      *  - (c1 AND c2) OR (c3 AND c4)
      *   |- c1    : DTL.OHE Port Cut Date is Entered
      *   |- c2    : DTL.USR Time 4.0 is Zero
      *   |- c3    : DTL.OHE Port Cut Date is not entered
      *   |- c4    : DTL.USR Time 4.0 is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1QXDT    IFNE *ZERO                      *IF
     C           #DT4TM    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           #1QXDT    IFEQ *ZERO                      *IF
     C           #DT4TM    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Convert OHE Port Cut Date to display format
      * Convert date
     C           1000000   ADD  #1QXDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0004
     C                     Z-ADD#DT4TM    ZA0005           USR Time 4.0
      * Send message 'Port Cut Dt/Tm enter both'
     C                     MOVEL'USR4722' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,38           *
     C                     MOVEL'1'       @I1,39           *
      *
     C                     END                             *FI
      * Prompt and F-Keys
      * CASE: DTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * F4 ON SELECTED FIELDS
      * CASE: PGM.*Cursor field <IS> DTL.Shipping Line
     C           W0SCR     IFEQ 1                          *
     C           W0CFL     ANDEQ'#1XACD'                   *IF
      * * Pass back state, as well                            E002989
      * SEL Shipping Line/PortsSR - Shipping Line/Port  * 
     C                     CALL 'PDUMSRR'              90  SEL Shipping Li
     C                     PARM *BLANK    W0RTN   7
     C           #1XACD    PARM #1XACD    WQ0011  3        Shipping Line
     C           #1OANA    PARM #1OANA    WQ0012 20        Port Delv Termi
     C           #1HBAA    PARM *BLANK    WQ0013 25        Port City
     C           #DXBCD    PARM *BLANK    WQ0014  2        Sail Port State
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDUMSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,31           *
     C                     MOVEL'1'       @I1,32           *
     C                     END
      * RTV SHIP LINE NAME
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * RTV Carrier Name       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1XACD    WL0312    P      Carrier Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0313    #DGVTX    P      Name
     C                     MOVELWL0314    YL0242    P      Record Status
     C                     END                             *FI
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: PGM.*Cursor field <IS> DTL.OHE Discharge Port/Airprt
     C           W0SCR     IFEQ 1                          *
     C           W0CFL     ANDEQ'#1HCAA'                   *IF
      * 11/21/22 DN DO4595-Added Prompt on Discharge Port.
      * Sel Port of Unlading  SR - Country Port of Unlading  * 
     C                     CALL 'PUXOSRR'              90  Sel Port of Unl
     C                     PARM *BLANK    W0RTN   7
     C           #1HCAA    PARM #1HCAA    WQ0015 20        Port of Unladin
     C                     PARM YL0206    WQ0016  6        Country Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUXOSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,33           *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: PGM.*Cursor field <IS> 2ND.OHE Backhaul Truck Number
     C           W0SCR     IFEQ 2                          *
     C           W0CFL     ANDEQ'#1QKNY'                   *IF
      * SEL by TD Last/First  SL - Truck Driver  * 
     C                     CALL 'PNWLSRR'              90  SEL by TD Last/
     C                     PARM *BLANK    W0RTN   7
     C           YL0252    PARM YL0252    WQ0017 20        TD Last Name
     C           YL0253    PARM YL0253    WQ0018 12        TD First Name
     C           #1QKNY    PARM #1QKNY    WQ0019  30       TD Truck Number
     C           YL0254    PARM YL0254    WQ0020 50        TD Notes
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNWLSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: PGM.*Cursor field <IS> DTL.Transloader Carrier Code
     C           W0SCR     IFEQ 1                          *
     C           W0CFL     ANDEQ'#DDYTX'                   *IF
      * SEL Active Carrier     SR - Carrier  * 
     C                     CALL 'OMY6SRR'              90  SEL Active Carr
     C                     PARM *BLANK    W0RTN   7
     C           #DDYTX    PARM #DDYTX    WQ0021  3        Carrier Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMY6SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,44           *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: PGM.*Cursor field <IS> 2ND.OHE Backhaul Carrier Code
     C           W0SCR     IFEQ 2                          *
     C           W0CFL     ANDEQ'#1CUTX'                   *IF
      * SEL Active Carrier     SR - Carrier  * 
     C                     CALL 'OMY6SRR'              90  SEL Active Carr
     C                     PARM *BLANK    W0RTN   7
     C           #1CUTX    PARM #1CUTX    WQ0022  3        Carrier Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMY6SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,32           *
     C                     END
      * RTV BH CARRIER NAME
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * RTV Carrier Name       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1CUTX    WL0312    P      Carrier Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0313    #DA7TX    P      Name
     C                     MOVELWL0314    YL0242    P      Record Status
     C                     END                             *FI
     C                     ELSE
      * CASE: PGM.*Cursor field <IS> 2ND.OHE Backhaul Return to Co
     C           W0SCR     IFEQ 2                          *
     C           W0CFL     ANDEQ'#1QJNY'                   *IF
      * SEL Company by Number  SR - Company Name and Address  * 
     C                     CALL 'CAAJSRR'              90  SEL Company by
     C                     PARM *BLANK    W0RTN   7
     C           #1QJNY    PARM #1QJNY    WQ0023  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAAJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,31           *
     C                     END
      * RTV Company Name Only  RT - Company Name and Address  * 
     C                     EXSR SLRVGN
     C                     ELSE
      * CASE: PGM.*Cursor field <IS> DTL.OHE Container Number
     C           W0SCR     IFEQ 1                          *
     C           W0CFL     ANDEQ'#1J2T1'                   *IF
      * Error if shipping line is not entered                 E004079
      * CASE: DTL.Shipping Line is not entered
     C           #1XACD    IFEQ *BLANK                     *IF
      * Send message 'Shipping Line required'
     C                     MOVEL'USR2432' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * save original if container is being changed
      * CASE: DTL.OHE Container Number is Entered
     C           #1J2T1    IFNE *BLANK                     *IF
     C                     MOVEL#1J2T1    WUJ2T1           OHE Container N
     C                     END                             *FI
     C                     Z-ADD#1AIC3    YL0015           Company Number
      * Sel Trailer           SR - Trailer  * 
     C                     CALL 'PBRFSRR'              90  Sel Trailer
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1XACD    WQ0024  3        Carrier Code
     C           #1J2T1    PARM *BLANK    WQ0025 20        Trailer Id
     C           YL0015    PARM YL0015    WQ0026  30       Company Number
     C           WUSTOY    PARM *BLANK    WQ0027  1        On Yard Status
     C           WUKKDT    PARM *ZERO     WQ0028  70       On Yard Date
     C           WUAVTM    PARM *ZERO     WQ0029  60       On Yard Time
     C           WUXRST    PARM *BLANK    WQ0030  1        Available Statu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBRFSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,31           *
     C                     MOVEL'1'       @I1,40           *
     C                     END
      * trailer company numbers don't match
      * CASE: DTL.Company Number NE LCL.Company Number
     C           #1AIC3    IFNE YL0015                     *IF
      * Setup message data for message
     C                     MOVEL#1J2T1    ZA0006           OHE Container N
      * Send message 'Trailer Co#<>Ld Str Co#'
     C                     MOVEL'USR3902' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: DTL.*CMD key is *Copy Booking Info
     C           *IN08     IFEQ '1'                        *IF
      * PMT Assign Bkg Info    PV - Order Header Extension  * 
     C                     CALL 'PBLQPVR'              90  PMT Assign Bkg
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0031  30       Company Number
     C                     PARM #1C4NB    WQ0032  70       Order Number
     C                     PARM #1RMNB    WQ0033  70       Load ID
     C                     PARM #1RUNB    WQ0034  50       Stop_Drop Seque
     C                     PARM #1XACD    WQ0035  3        Shipping Line
     C                     PARM #1OANA    WQ0036 20        Port Delv Termi
     C                     PARM #1HBAA    WQ0037 25        OHE City
     C                     PARM #1J0T1    WQ0038 30        OHE Vessel_Airl
     C                     PARM #1GENY    WQ0039 15        OHE Voyage_Flig
     C                     PARM #1J1T1    WQ0040 15        OHE Booking Num
     C                     PARM #1HCAA    WQ0041 20        OHE Discharge P
     C                     PARM #1QWDT    WQ0042  70       OHE Sail_Flight
     C                     PARM #1QYDT    WQ0043  70       OHE Arrival Dat
     C                     PARM #1CCTX    WQ0044  1        OHE Ship Status
     C                     PARM #1B4TX    WQ0045  3        OHE Load Haul T
     C                     PARM #DWPST    WQ0046  2        Warehouse Type
     C                     PARM #DBZNA    WQ0047  3        Carrier Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBLQPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,31           *
     C                     MOVEL'1'       @I1,32           *
     C                     MOVEL'1'       @I1,34           *
     C                     MOVEL'1'       @I1,35           *
     C                     MOVEL'1'       @I1,36           *
     C                     MOVEL'1'       @I1,33           *
     C                     MOVEL'1'       @I1,41           *
     C                     MOVEL'1'       @I1,42           *
     C                     END
     C                     ELSE
      * CASE: DTL.*CMD key is CF10
     C           *IN10     IFEQ '1'                        *IF
      * ** Copy from an existing OHE Order, receive into par context
      * 07/22/19 DN R15161-Replaced PAR.Voyage with PAR.OHE Voyage/Flight
      *    Replaced PAR.Booking Number with PAR.OHE Booking Number.
      * 10/17/19 DN R15161-Blank Out the OHE Booking Number.
      * SEL Copy OHE Record    SR - Order Header Extension  * 
     C                     CALL 'PMMLSRR'              90  SEL Copy OHE Re
     C                     PARM *BLANK    W0RTN   7
     C           P3XACD    PARM *BLANK    WQ0048  3        Shipping Line
     C           P3OANA    PARM *BLANK    WQ0049 20        Port Delv Termi
     C           P3K4TX    PARM *BLANK    WQ0050 30        Vessel Name
     C           P3KBDT    PARM *ZERO     WQ0051  70       Sail Date
     C           P3W4CD    PARM *BLANK    WQ0052 20        Discharge Port
     C           P3CNTN    PARM *BLANK    WQ0053 12        Container Numbe
     C           P3QXDT    PARM *ZERO     WQ0054  70       OHE Port Cut Da
     C           P3B4TX    PARM *BLANK    WQ0055  3        OHE Load Haul T
     C           P3QYDT    PARM *ZERO     WQ0056  70       OHE Arrival Dat
     C           P3QZDT    PARM *ZERO     WQ0057  70       OHE Est Arrv at
     C           P3QGNY    PARM *ZERO     WQ0058  90       OHE PowerPro Lo
     C           P3P8NY    PARM *ZERO     WQ0059  52       OHE Pier Pass F
     C           P3P9NY    PARM *ZERO     WQ0060  52       OHE Port Check
     C           P3V8T1    PARM *BLANK    WQ0061 15        OHE Transload C
     C           P3V3T1    PARM *BLANK    WQ0062 10        OHE Transload S
     C           P3V4T1    PARM *BLANK    WQ0063 10        OHE Abs Rate Ov
     C           P3QHNY    PARM *ZERO     WQ0064  90       OHE PowerPro Lo
     C           P3DYTX    PARM *BLANK    WQ0065  3        Transloader Car
     C           P3V9T1    PARM *BLANK    WQ0066 30        OHE Pier Pass I
     C                     PARM *BLANK    WQ0067 30        OHE Carrier Nm
     C           P3Q1DT    PARM *ZERO     WQ0068  70       OHE Port_Pier P
     C           P1J1T1    PARM *BLANK    WQ0069 15        OHE Booking Num
     C           P1GENY    PARM *BLANK    WQ0070 15        OHE Voyage_Flig
     C           WUZZST    PARM *BLANK    WQ0071  1        Record Selected
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMLSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * ** Only update fields if a record was selected.
      * CASE: WRK.Record Selected       USR is yes
     C           WUZZST    IFEQ 'Y'                        *IF
      * DTL = PAR By name
     C                     Z-ADDP1C4NB    #1C4NB           Order Number
     C                     Z-ADDP1RMNB    #1RMNB           Load ID
     C                     Z-ADDP5EIDT    #DEIDT           Requested Deliv
     C                     Z-ADDP5AFTM    #DAFTM           Requested Deliv
     C                     Z-ADDP1AIC3    #1AIC3           Company Number
     C                     MOVELP4VSST    #1VSST           Record Status
     C                     MOVELP3XACD    #1XACD           Shipping Line
     C                     MOVELP3OANA    #1OANA           Port Delv Termi
     C                     MOVELP1GENY    #1GENY           OHE Voyage_Flig
     C                     MOVELP3B4TX    #1B4TX           OHE Load Haul T
     C                     MOVELP1J1T1    #1J1T1           OHE Booking Num
     C                     MOVELP1C2TX    #1C2TX           OHE Carrier SCA
     C                     Z-ADDP3QXDT    #1QXDT           OHE Port Cut Da
     C                     MOVELP6DXTX    #DDXTX           Trailer Id
     C                     Z-ADDP3QYDT    #1QYDT           OHE Arrival Dat
     C                     Z-ADDP3QZDT    #1QZDT           OHE Est Arrv at
     C                     MOVELP3DYTX    #DDYTX           Transloader Car
     C                     Z-ADDP3P8NY    #1P8NY           OHE Pier Pass F
     C                     Z-ADDP3QGNY    #1QGNY           OHE PowerPro Lo
     C                     MOVELP3V8T1    #1V8T1           OHE Transload C
     C                     MOVELP3V9T1    #1V9T1           OHE Pier Pass I
     C                     Z-ADDP3QHNY    #1QHNY           OHE PowerPro Lo
     C                     MOVELP3V3T1    #1V3T1           OHE Transload S
     C                     Z-ADDP3P9NY    #1P9NY           OHE Port Check
     C                     MOVELP3V4T1    #1V4T1           OHE Abs Rate Ov
     C                     MOVELP3WAT1    #1WAT1           OHE Carrier Nm
     C                     Z-ADDP3QANY    #1QANY           OHE Port Cut Ti
     C                     Z-ADDP3Q1DT    #1Q1DT           OHE Port_Pier P
     C                     Z-ADDP1QKNY    #1QKNY           LD Stop_Drop
     C                     Z-ADDP4AATM    #1AATM           Job Time
     C                     MOVELP4AYNA    #1AYNA           User Id
     C                     MOVELP4A0NA    #1A0NA           Job Name
     C                     Z-ADDP4AXDT    #1AXDT           Job Date
     C                     MOVELP3K4TX    #1J0T1           OHE Vessel_Airl
      * 07/22/19 DN R15161-Commented Out Voyage.
      * 10/17/19 DN R15161-Clear OHE Booking Number.
     C                     MOVEL*BLANK    #1J1T1           OHE Booking Num
     C                     Z-ADDP3KBDT    #1QWDT           OHE Sail_Flight
     C                     MOVELP3W4CD    #1HCAA           OHE Discharge P
      * ** Error if shipping line or port are wrong.
      * ** Retrieve the Shipping Line name from the Carrier file
      * CASE: DTL.Shipping Line is entered
     C           #1XACD    IFNE *BLANK                     *IF
      * RTV Carrier Name       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1XACD    WL0312    P      Carrier Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0313    #DGVTX    P      Name
     C                     MOVELWL0314    YL0242    P      Record Status
      * ** Send error message if invalid shipping line entered  FT683 LJB
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
     C                     MOVEL#1XACD    ZA0007           Shipping Line
      * Send message 'Shipping Line not found'
     C                     MOVEL'USR2431' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,31           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * ** Retrieve the Port City and address
      * CASE: DTL.Port Delv Terminal is Entered
     C           #1OANA    IFNE *BLANK                     *IF
      * * Include Sail Port State                             E002989
      * RTV Shp Line/Port All  RT - Shipping Line/Port  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1XACD    WL0323    P      Shipping Line
     C                     MOVEL#1OANA    WL0324    P      Port Delv Termi
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0325    #1HBAA    P      Port City
     C                     MOVELWL0326    YL0246    P      Port Address Li
     C                     MOVELWL0327    YL0247    P      Port Address Li
     C                     MOVELWL0328    #DXBCD    P      Sail Port State
     C                     MOVELWL0329    YL0248    P      Port Zip/Postal
     C                     Z-ADDWL0330    YL0249           Port Phone Numb
     C                     MOVELWL0331    YL0250    P      Port Fax Number
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Send message 'Shipping Line/Port     NF'
     C                     MOVEL'USR2419' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: DTL.*CMD key is CF11
     C           *IN11     IFEQ '1'                        *IF
      * ** F11=Clear - clear the screen fields, update record.  C002567
      * ** Don't delete the entire record. Clear Ship Line name as well
      * ** Clear Sail Port State, as well                     E002989
      * CHG Clr Exp Instr flds IF
      * ** Clear fields on the screen         C002567
     C                     EXSR UCSUBR                     ** Clear fields
      * CHG Clr Exp Instr flds CH - Order Header Extension  * 
     C                     EXSR SMCHRC
     C                     MOVEL*BLANK    #DGVTX           USR Carrier Nam
     C                     Z-ADD*ZERO     #DT4TM           USR Time 4.0
     C                     MOVEL*BLANK    #DDYTX           Transloader Car
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: DTL.*CMD key is CF20
     C           *IN20     IFEQ '1'                        *IF
      * ** Traffic Comments
      * EDT PD Traffic Comment EF - Traffic Comments  * 
     C                     CALL 'PDCZEFR'              90  EDT PD Traffic
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0072  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCZEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: DTL.*CMD key is CF13
     C           *IN13     IFEQ '1'                        *IF
      * ** Display/Edit MPC
      * Edt MPC/Dsp Orders     EF - Load Detail  * 
     C                     CALL 'PDSQEFR'              90  Edt MPC/Dsp Ord
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0073  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDSQEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: DTL.*CMD key is CF14
     C           *IN14     IFEQ '1'                        *IF
      * ** Maintain Truck Driver file
      * EDT Truck File        EF - Truck Driver  * 
     C                     CALL 'PNVQEFR'              90  EDT Truck File
     C                     PARM *BLANK    W0RTN   7
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNVQEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: DTL.*CMD key is CF15
     C           *IN15     IFEQ '1'                        *IF
      * PMT Backhaul Download  PV - Order Header Extension  * 
     C                     CALL 'PNXCPVR'              90  PMT Backhaul Do
     C                     PARM *BLANK    W0RTN   7
     C                     PARM '2'       WQ0074  1        Report Type USR
     C           YL0255    PARM *BLANK    WQ0075  7        Return Code Usr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNXCPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Backhaul status
      * CASE: 2ND.OHE Backhaul Status is Backhaul Status Entered
     C           #1CITX    IFEQ 'B'                        *IF
     C           #1CITX    OREQ 'D'
     C           #1CITX    OREQ 'F'
      * 2ND.Description 21a 4 Usr = Condition name of 2ND.OHE Backhaul St
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1822121   Y2LSNO  70       List number
     C                     PARM #1CITX    W0INVL 25        OHE Backhaul St
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DG3T1    PARM           W0CNNM 25        Description 21a
      *
     C                     END                             *FI
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           WUSDTE    PARM *ZERO     WQ0076 155       Current System
     C           WUZHNB    PARM *ZERO     WQ0077 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * * Convert DDTime to 6.0 for testing                   E003143
     C           #DYBNB    MULT 100       YL0087           Deadline Depart
      * 11/21/22 DN DO4595-Validate Discharge Port.
      * CASE: DTL.OHE Discharge Port/Airprt is Not Blank
     C           #1HCAA    IFNE *BLANK                     *IF
      * Rtv Port of Unlading  RT - Country Port of Unlading  * 
     C                     EXSR SPRVGN
      * Check Return Code.
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Not Active, Throw Error Msg.
      * CASE:
      *  - NOTc1
      *   |- c1    : LCL.Record Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0242    IFEQ 'A'                        *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL@CN,003   ZA0008           Generic Message
     C                     MOVEL#1HCAA    ZA0009           OHE Discharge P
      * Send message 'Generic Message 80 ERR 2'
     C                     MOVEL'USR5085' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,33           *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL@CN,004   ZA0010           Generic Message
     C                     MOVEL#1HCAA    ZA0011           OHE Discharge P
      * Send message 'Generic Message 80 ERR 2'
     C                     MOVEL'USR5085' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,33           *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * Check relations
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     99    *
     C                     SETON                     99    *
     C                     END
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,31
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,32
     C                     SETON                     99    *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Detail screen function fields
     C                     MOVEL*BLANK    #DW1TX           Carrier Name DR
      * Carrier Name DRV
      * RTV Carrier Name       RT - Carrier              TRG  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DBZNA    WL0312    P      Carrier Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0313    #DW1TX    P      Name
     C                     MOVELWL0314    YN0007    P      Record Status
     C                     MOVEL*BLANK    #DSQTX           Company Name DR
      * Company Name DRV
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SQRVGN
     C                     MOVEL#1XACD    #1XACD           Shipping Line
      * RTV SHIP LINE NAME for 2nd screen (Backhaul)
      * CASE: 2ND.Shipping Line is entered
     C           #1XACD    IFNE *BLANK                     *IF
      * RTV Carrier Name       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1XACD    WL0312    P      Carrier Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0313    #DGVTX    P      Name
     C                     MOVELWL0314    YL0242    P      Record Status
      * ** Error if Shipping Line does not exist
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
     C                     MOVEL#1XACD    ZA0012           Shipping Line
      * Send message 'Shipping Line not found'
     C                     MOVEL'USR2431' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * ** Retrieve company name for Backhaul To company
      * CASE: 2ND.OHE Backhaul Return to Co is not equal to zero
     C           #1QJNY    IFNE *ZERO                      *IF
      * RTV Company Name & Add RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1QJNY    WL0315           Company Number
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0316    #DAGTX    P      Name
     C                     MOVELWL0317    YN0008    P      Address Line 1
     C                     MOVELWL0318    YN0009    P      Address Line 2
     C                     MOVELWL0319    YN0010    P      Address Line 3
     C                     MOVELWL0320    YN0011    P      City
     C                     MOVELWL0321    YN0012    P      Zip Postal Code
     C                     MOVELWL0322    YN0013    P      State Code
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
     C                     Z-ADD#1QJNY    ZA0013           OHE Backhaul Re
      * Send message 'Company Number  7.0 Not F'
     C                     MOVEL'USR2008' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,31           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * ** Retrieve carrier name for Backhaul carrier
      * CASE: 2ND.OHE Backhaul Carrier Code NE WRK.Blank for 3          U
     C           #1CUTX    IFNE WUUAT1                     *IF
      * RTV Carrier Name       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1CUTX    WL0312    P      Carrier Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0313    #DA7TX    P      Name
     C                     MOVELWL0314    YN0014    P      Record Status
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
     C                     MOVEL#1CUTX    ZA0014           OHE Backhaul Ca
      * Send message 'Carrier doesn't exists'
     C                     MOVEL'USR1252' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,32           *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate detail screen relations
      * Verify ship line or terminal have not been changed      E001634
      * ** Retrieve Shipping Line name from carrier file
      * CASE: DTL.Shipping Line is entered
     C           #1XACD    IFNE *BLANK                     *IF
      * RTV Carrier Name       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1XACD    WL0312    P      Carrier Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0313    #DGVTX    P      Name
     C                     MOVELWL0314    YL0242    P      Record Status
      * ** Error if Shipping Line does not exist
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
     C                     MOVEL#1XACD    ZA0015           Shipping Line
      * Send message 'Shipping Line not found'
     C                     MOVEL'USR2431' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,31           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * ** Retrieve Port City from Shipping Line/Port file
      * CASE: DTL.Port Delv Terminal is Entered
     C           #1OANA    IFNE *BLANK                     *IF
      * RTV Shp Line/Port All  RT - Shipping Line/Port  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1XACD    WL0323    P      Shipping Line
     C                     MOVEL#1OANA    WL0324    P      Port Delv Termi
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0325    #1HBAA    P      Port City
     C                     MOVELWL0326    YL0246    P      Port Address Li
     C                     MOVELWL0327    YL0247    P      Port Address Li
     C                     MOVELWL0328    #DXBCD    P      Sail Port State
     C                     MOVELWL0329    YL0248    P      Port Zip/Postal
     C                     Z-ADDWL0330    YL0249           Port Phone Numb
     C                     MOVELWL0331    YL0250    P      Port Fax Number
      * ** Error if Port Deliv Term does not exist
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Send message 'Shipping Line/Port     NF'
     C                     MOVEL'USR2419' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * ** Retrieve company name for Backhaul To company
      * CASE: 2ND.OHE Backhaul Return to Co is not equal to zero
     C           #1QJNY    IFNE *ZERO                      *IF
      * RTV Company Name & Add RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1QJNY    WL0315           Company Number
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0316    #DAGTX    P      Name
     C                     MOVELWL0317    YN0008    P      Address Line 1
     C                     MOVELWL0318    YN0009    P      Address Line 2
     C                     MOVELWL0319    YN0010    P      Address Line 3
     C                     MOVELWL0320    YN0011    P      City
     C                     MOVELWL0321    YN0012    P      Zip Postal Code
     C                     MOVELWL0322    YN0013    P      State Code
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
     C                     Z-ADD#1QJNY    ZA0016           OHE Backhaul Re
      * Send message 'Company Number  7.0 Not F'
     C                     MOVEL'USR2008' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,31           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * ** Retrieve carrier name for Backhaul carrier
      * CASE: 2ND.OHE Backhaul Carrier Code NE WRK.Blank for 3          U
     C           #1CUTX    IFNE WUUAT1                     *IF
      * RTV Carrier Name       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1CUTX    WL0312    P      Carrier Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0313    #DA7TX    P      Name
     C                     MOVELWL0314    YN0014    P      Record Status
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
     C                     MOVEL#1CUTX    ZA0017           OHE Backhaul Ca
      * Send message 'Carrier doesn't exists'
     C                     MOVEL'USR1252' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,32           *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL#DBZNA    P6R6CD           USR Carrier Cod
     C                     Z-ADD#1AIC3    P6FKNB           USR Company Num
      * Shipping Line required to enter a container           E001627
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.Shipping Line is not entered
      *   |- c2    : DTL.OHE Container Number is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1XACD    IFEQ *BLANK                     *IF
     C           #1J2T1    IFNE *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Send message 'Shipping Line required'
     C                     MOVEL'USR2432' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * * Change to validate container for Shipping Line      E004079
      * Convert Container  to all caps                        E004079
      * CASE: DTL.OHE Container Number is Entered
     C           #1J2T1    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    YL0240           Case Sensitive
     C                     MOVEL#1J2T1    YL0240           Case Sensitive
      * CVT to Upper Alpha 3   XF - /UT User Source  * 
     C                     CALL 'PBSBXFR'              90  CVT to Upper Al
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0240    WQ0078 30        Case Sensitive
     C           YL0241    PARM *BLANK    WQ0079 30        Case Upper Fiel
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBSBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0241    #1J2T1           OHE Container N
     C                     END                             *FI
      * If not shipped, Validate Shipping line-Container
      * CASE: DTL.OHE Ship Status is Unshipped
     C           #1CCTX    IFEQ 'O'                        *IF
     C           #1CCTX    OREQ 'R'
      * Validate Container                     E001790
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.OHE Container Number is Entered
      *   |- c2    : DTL.Shipping Line is entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1J2T1    IFNE *BLANK                     *IF
     C           #1XACD    IFNE *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 07/22/19 DN R15161-Set Voyage to Null.
      * RTV Load All Fields    RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0021           Load ID
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    YL0015           Company Number
     C                     Z-ADDWL0023    YL0169           Scheduled Ship
     C                     MOVELWL0024    YL0016    P      LTL Flag
     C                     MOVELWL0025    YL0017    P      Load Status
     C                     Z-ADDWL0026    YL0018           Reefer Temperat
     C                     MOVELWL0027    YL0257    P      Seal 1
     C                     MOVELWL0028    YL0258    P      Seal 2
     C                     MOVELWL0029    YL0259    P      Seal 3
     C                     MOVELWL0030    YL0019    P      Seal 4
     C                     MOVELWL0031    YL0020    P      Seal 2 Unused
     C                     Z-ADDWL0032    YL0021           Total Load Orde
     C                     Z-ADDWL0033    YL0022           Flat Amount
     C                     MOVELWL0034    YL0023    P      Allocate Pounds
     C                     Z-ADDWL0035    YL0024           Total Stops
     C                     MOVELWL0036    YL0260    P      Trailer Id
     C                     MOVELWL0037    YL0261    P      Transloader Car
     C                     Z-ADDWL0038    YL0025           BOL Time
     C                     MOVELWL0039    YL0161    P      Carrier Code
     C                     MOVELWL0040    YL0026    P      Truck Size
     C                     Z-ADDWL0041    YL0027           Ld Hdr_Ld Dtl U
     C                     Z-ADDWL0042    YL0028           Rated Freight
     C                     MOVELWL0043    YL0262    P      Ship Status
     C                     MOVELWL0044    YL0029    P      Load Type
     C                     Z-ADDWL0045    YL0030           Number Pallets
     C                     Z-ADDWL0046    YL0031           Number Pallets
     C                     Z-ADDWL0047    YL0032           Load Carrier Pa
     C                     Z-ADDWL0048    YL0033           Estimated Arriv
     C                     Z-ADDWL0049    YL0034           Actual Arrival
     C                     Z-ADDWL0050    YL0035           Actual Arrival
     C                     Z-ADDWL0051    YL0036           Trailer IN Weig
     C                     Z-ADDWL0052    YL0037           Trailer OUT Wei
     C                     Z-ADDWL0053    YL0038           Actual Departur
     C                     Z-ADDWL0054    YL0039           Departure Time
     C                     Z-ADDWL0055    YL0040           Schedule Sequen
     C                     Z-ADDWL0056    YL0041           Product Tempera
     C                     Z-ADDWL0057    YL0042           Number Spacers
     C                     MOVELWL0058    YL0043    P      Car_Veh. Initia
     C                     Z-ADDWL0059    YL0044           Total Load Mile
     C                     MOVELWL0060    YL0045    P      Recorder ID
     C                     MOVELWL0061    YL0181    P      Shipping Method
     C                     MOVELWL0062    YL0046    P      Ship From Wareh
     C                     MOVELWL0063    YL0005    P      Ship To State C
     C                     Z-ADDWL0064    YL0047           Gross Weight
     C                     MOVELWL0065    YL0048    P      Carrier Broker
     C                     MOVELWL0066    YL0012    P      Export Status
     C                     Z-ADDWL0067    YL0243           Actual Ship Dat
     C                     MOVELWL0068    YL0049    P      On Time (Y_N)
     C                     Z-ADDWL0069    YL0050           Truck Ready Dat
     C                     Z-ADDWL0070    YL0051           Truck Ready Tim
     C                     Z-ADDWL0071    YL0052           Spotted Date
     C                     Z-ADDWL0072    YL0053           Spotted Time
     C                     Z-ADDWL0073    YL0054           Load Finished D
     C                     Z-ADDWL0074    YL0055           Load Finished T
     C                     Z-ADDWL0075    YL0056           BOL Complete Da
     C                     Z-ADDWL0076    YL0057           BOL Complete Ti
     C                     Z-ADDWL0077    YL0058           BOL Received Da
     C                     Z-ADDWL0078    YL0059           BOL Received Ti
     C                     Z-ADDWL0079    YL0060           Truck Departure
     C                     Z-ADDWL0080    YL0061           Truck Departure
     C                     Z-ADDWL0081    YL0062           Adjusted Depart
     C                     Z-ADDWL0082    YL0063           Adjusted Depart
     C                     MOVELWL0083    YL0064    P      Shipping Line
     C                     MOVELWL0084    YL0065    P      Port Delv Termi
     C                     MOVELWL0085    YL0066    P      Vessel Name
     C                     Z-ADDWL0086    YN0002           Voyage
     C                     Z-ADDWL0087    YL0067           Sail Date
     C                     MOVELWL0088    YL0068    P      Booking Number
     C                     MOVELWL0089    YL0069    P      Discharge Port
     C                     Z-ADDWL0090    YL0070           Arrival Date
     C                     MOVELWL0091    YL0071    P      Container Numbe
     C                     Z-ADDWL0092    YL0072           Date In
     C                     Z-ADDWL0093    YL0073           Time In
     C                     Z-ADDWL0094    YL0074           Date Out
     C                     Z-ADDWL0095    YL0075           Time Out
     C                     Z-ADDWL0096    YL0076           Load Total Frei
     C                     Z-ADDWL0097    YL0077           Scheduled Deliv
     C                     Z-ADDWL0098    YL0078           Scheduled Deliv
     C                     MOVELWL0099    YL0079    P      LH Unused Sts
     C                     MOVELWL0100    YL0080    P      LH Carrier Paym
     C                     Z-ADDWL0101    YL0081           Bring Back Mile
     C                     Z-ADDWL0102    YL0082           Requested Deliv
     C                     MOVELWL0103    YL0083    P      Load Acceptance
     C                     MOVELWL0104    YL0084    P      Warehouse Code
     C                     Z-ADDWL0105    YL0085           On Yard Date
     C                     Z-ADDWL0106    YL0086           On Yard Time
     C                     Z-ADDWL0107    YL0263           Deadline Depart
     C                     Z-ADDWL0108    YL0087           Deadline Depart
     C                     MOVELWL0109    YL0088    P      Load Held Over
     C                     MOVELWL0110    YL0089    P      Load Held Over
     C                     MOVELWL0111    YL0090    P      Load Held Over
     C                     MOVELWL0112    YL0091    P      Ocean BOL Numbe
     C                     MOVELWL0113    YL0092    P      Express Mail Nu
     C                     Z-ADDWL0114    YL0093           Express Mail Da
     C                     MOVELWL0115    YL0094    P      Load Shag Flag
     C                     MOVELWL0116    YL0095    P      Load Wash Flag
     C                     Z-ADDWL0117    YL0096           Product Complet
     C                     Z-ADDWL0118    YL0097           Product Complet
     C                     Z-ADDWL0119    YL0098           Pallets Loaded
     C                     Z-ADDWL0120    YL0099           Avg Pallet Tare
     C                     Z-ADDWL0121    YL0100           Tot Pallet Tare
     C                     MOVELWL0122    YL0101    P      Load Confirmed
     C                     MOVELWL0123    YL0102    P      Load Confirmed
     C                     Z-ADDWL0124    YL0103           Load Confirmati
     C                     Z-ADDWL0125    YL0104           Load Door 1
     C                     Z-ADDWL0126    YL0105           Override Total
     C                     Z-ADDWL0127    YL0106           Load Door 2
     C                     MOVELWL0128    YL0107    P      Partial Load
     C                     MOVELWL0129    YL0108    P      Load Confirmati
     C                     MOVELWL0130    YL0109    P      Export Load USD
     C                     MOVELWL0131    YL0110    P      Late Delivery E
     C                     Z-ADDWL0132    YL0111           Load Actual Fre
     C                     MOVELWL0133    YL0112    P      Hide on WW Load
     C                     MOVELWL0134    YL0113    P      Late Billing Em
     C                     MOVELWL0135    YL0114    P      Shipping Temp C
     C                     MOVELWL0136    YL0115    P      LH Held Over Rs
     C                     MOVELWL0137    YL0116    P      Multi Company L
     C                     MOVELWL0138    YL0117    P      Fax Sent to SSI
     C                     MOVELWL0139    YL0118    P      Schedule Pos Lo
     C                     MOVELWL0140    YL0119    P      LH Power Only L
     C                     MOVELWL0141    YL0120    P      MG Created Load
     C                     MOVELWL0142    YL0121    P      LH Unused Sts 5
     C                     MOVELWL0143    YL0122    P      Load U_M
     C                     MOVELWL0144    YL0123    P      TPM Shipment St
     C                     MOVELWL0145    YL0124    P      LH Unused Sts 8
     C                     MOVELWL0146    YL0125    P      LH On-Time Reas
     C                     MOVELWL0147    YL0126    P      LH Held Over Re
     C                     Z-ADDWL0148    YL0127           LH Carrier Paid
     C                     Z-ADDWL0149    YL0128           LH Carrier Paid
     C                     Z-ADDWL0150    YL0129           LH Last Combo P
     C                     Z-ADDWL0151    YL0130           LH Last Combo P
     C                     Z-ADDWL0152    YL0131           LPT Load Plan S
     C                     Z-ADDWL0153    YL0132           LPT Load Plan S
     C                     Z-ADDWL0154    YL0133           TPM Planned Shi
     C                     Z-ADDWL0155    YL0134           LH Unused Time
     C                     Z-ADDWL0156    YL0135           LH Unused Date
     C                     Z-ADDWL0157    YL0136           LH Unused Time
     C                     Z-ADDWL0158    YL0137           LH Unused Date
     C                     Z-ADDWL0159    YL0138           LH Unused Time
     C                     MOVELWL0160    YL0139    P      EDI Status 1
     C                     MOVELWL0161    YL0140    P      EDI Status 2
     C                     MOVELWL0162    YL0141    P      EDI Status 3
      * Rtv Trailer            RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1XACD    WL0345    P      Carrier Code
     C                     MOVEL#1J2T1    WL0346    P      Trailer Id
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0347    YN0015           Company Number
     C                     MOVELWL0348    YL0264    P      Load Type
     C                     MOVELWL0349    YL0265    P      Trailer Type
     C                     MOVELWL0350    YL0266    P      Seaboard Owned
     C                     MOVELWL0351    YL0267    P      On Yard Status
     C                     Z-ADDWL0352    YL0085           On Yard Date
     C                     Z-ADDWL0353    YL0086           On Yard Time
     C                     MOVELWL0354    YL0268    P      Assigned Status
     C                     MOVELWL0355    YL0269    P      Available Statu
     C                     MOVELWL0356    YL0270    P      Not Available R
     C                     MOVELWL0357    YL0271    P      Comment Line
     C                     MOVELWL0358    YL0242    P      Record Status
      * * Don't create trailer here, done in the CHGOBJ
     C                     Z-ADD*ZERO     YL0272           Load ID USR
     C                     Z-ADD#1RMNB    YL0273           Load Id 2
      * VAL Container assgnmt  IF
      * VAL Container assgnmt RT - Load Header  * 
     C                     EXSR SSRVGN
      * load, carrier, trailer tests
      * CASE: LCL.Load Status is Shipped or Invoiced
     C           YL0017    IFEQ 'I'                        *IF
     C           YL0017    OREQ 'S'
      * ** OKAY if Load HDR is Shipped or Invoiced            E002021
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Return code is Trailer already assigned
      *   |- c2    : LCL.Load Id 3 NE DTL.Load ID
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ @CN,005                    *IF
     C           YL0274    IFNE #1RMNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ** Container exists in Order Header Extension file
      * Setup message data for message
     C                     MOVEL#1J2T1    ZA0018           OHE Container N
     C                     Z-ADDYL0274    ZA0019           Load Id 3
      * Send message 'Trailer is already assgnd'
     C                     MOVEL'USR2618' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,40           *
      *
     C                     MOVEL'N'       YL0275           Status Flag 10
     C                     ELSE
      * CASE: PGM.*Return code is Trailer Available to assn
     C           W0RTN     IFEQ @CN,006                    *IF
      * * Don't update here, Okay if available or
      * ** Trailer exists but w/diff carrier/shipping line
     C                     ELSE
      * CASE: LCL.USR Load Type NE LCL.Load Type
     C           YL0264    IFNE YL0029                     *IF
      * * Error message moved up above Info messages
      * Setup message data for message
     C                     MOVELYL0029    ZA0020           Load Type
     C                     MOVELYL0264    ZA0021           USR Load Type
     C                     MOVEL#1J2T1    ZA0022           OHE Container N
      * Send message 'Load type must match load'
     C                     MOVEL'USR2613' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,40           *
      *
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Available Status is Not Yes
      *   |- c2    : PAR.Load ID NE DTL.Load ID
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0269    IFEQ *BLANK                     *IF
     C           YL0269    OREQ 'N'
     C           P1RMNB    IFNE #1RMNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#1J2T1    ZA0023           OHE Container N
      * Send message 'Trailer is not Available.'
     C                     MOVEL'USR2616' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: LCL.Seaboard Owned Status is yes
     C           YL0266    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1J2T1    ZA0024           OHE Container N
      * Send message 'Trailer is Sbd owned.'
     C                     MOVEL'USR2617' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: LCL.On Yard Date is not entered
     C           YL0085    IFEQ *ZERO                      *IF
      * Setup message data for message
     C                     MOVEL#1J2T1    ZA0025           OHE Container N
      * Send message 'Trailer is not On Yard.'
     C                     MOVEL'USR2619' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: LCL.Company Number NE DTL.Company Number
     C           YL0015    IFNE #1AIC3                     *IF
      * * Info error moved to bottom of list of tests
      * Setup message data for message
     C                     MOVEL#1J2T1    ZA0026           OHE Container N
      * Send message 'Trailer Co#<>Ld Str Co#'
     C                     MOVEL'USR3902' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * * If Container is entered, replace the Trailer ID     E004079
      * CASE: DTL.OHE Container Number is Entered
     C           #1J2T1    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    #DDXTX           Trailer Id
     C                     MOVEL#1J2T1    #DDXTX           Trailer Id
     C                     END                             *FI
      * * If Container is cleared/chgd, chg Trailer ID     S00
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.OHE Container Number is Not Entered
      *   |- c2    : WRK.OHE Container Number is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1J2T1    IFEQ *BLANK                     *IF
     C           WUJ2T1    IFNE *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL*BLANK    #DDXTX           Trailer Id
     C                     MOVEL#1J2T1    #DDXTX           Trailer Id
     C                     END                             *FI
      * DO4595 DN 11/29/22-Send Info Msg If EDI Interchange Not Active.
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0276           EDI Interchange
     C                     MOVEL*BLANK    YL0277           Generic Message
      * Validate if All Orders for Load NOW have the Same Booking #.
      * CASE: *OTHERWISE
     C                     MOVELP7NTSC    YL0278           Orders have Sam
      * Override 'Orders have Same Booking#'?
      * CASE: LCL.Orders have Same Booking# is No
     C           YL0278    IFEQ 'N'                        *IF
      * This means there were multiple Orders with different Booking #.
      * Validating prior to updating of OHE.
      * Val Ord Same Booking# RT - Order Header TRG  * 
     C                     EXSR STRVGN
      * Same Booking# Then Override 'Orders have Same Booking#=Y'.
      * CASE: LCL.Same Booking# USR is Yes
     C           YL0279    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0278           Orders have Sam
     C                     END                             *FI
     C                     END                             *FI
      * Proceed If Order(s) Have Same Booking #.
      * CASE: LCL.Orders have Same Booking# is Not No
     C           YL0278    IFEQ *BLANK                     *IF
     C           YL0278    OREQ 'Y'
      * RTV Record Status     RT - EDI Interchange  * 
     C                     EXSR SVRVGN
      * CASE: LCL.Record Status is Active
     C           YL0242    IFEQ 'A'                        *IF
     C                     MOVEL'Y'       YL0276           EDI Interchange
      * Send Warning Message If CBP SCAC is Not Entered. EDI 601 Required
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.Shipping Line is entered
      *   |- c2    : DTL.Port Delv Terminal is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1XACD    IFNE *BLANK                     *IF
     C           #1OANA    IFNE *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv CBP Info f/EDI 601 RT - Shipping Line/Port Extsn  * 
     C                     EXSR SWRVGN
      * Send Warning Message.
      * CASE: LCL.CBP Std Carrier Alpha Cde is Not Entered
     C           YL0285    IFEQ *BLANK                     *IF
     C                     Z-ADD1         ZQ      50
     C           @CN,007   CAT  @CN,008:ZQYL0277    P      Generic Message
     C                     Z-ADD0         ZQ      50
     C           YL0277    CAT  @CN,009:ZQYL0277    P      Generic Message
      * Setup message data for message
     C                     MOVELYL0277    ZA0027           Generic Message
      * Send message 'Generic Message 80'
     C                     MOVEL'USR4976' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           @CN,010   CAT  @CN,011:ZQYL0277    P      Generic Message
     C                     Z-ADD1         ZQ      50
     C           YL0277    CAT  @CN,012:ZQYL0277    P      Generic Message
      * Setup message data for message
     C                     MOVELYL0277    ZA0028           Generic Message
      * Send message 'Generic Message 80'
     C                     MOVEL'USR4976' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         EAPMCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert internal to external form
     C                     EXSR MOCV#D
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Update screen time
     C                     TIME           ##TME
      * Refresh screen
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C           W0SCR     IFEQ 1
     C                     WRITE#CMDTXT2
     C                     WRITE#RCDDTL1
     C                     ELSE
     C           W0SCR     IFEQ 2
     C                     WRITE#CMDTXT3
     C                     WRITE#RCDDTL2
     C                     END
     C                     END
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO EAEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPR##    BEGSR
      *================================================================
      * Process record:
      *================================================================
      * Process add request
     C           W0PMD     CASEQ'ADD'     ECADRQ
      * Process update request
     C           W0PMD     CASNE'ADD'     EECHRQ
     C                     END
     C           W0RTN     IFEQ *BLANK
      * USER: Process command keys
      * Update the container in the trailer file if newly assigned
      * Load Order Change Log record
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : DTL.OHE Container Number NE WRK.Blank for 12
      *   |- c2    : DTL.OHE Container Number NE WRK.OHE Container Number
      *   |- c3    : WRK.OHE Container Number EQ WRK.Blank for 12
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1J2T1    IFNE WUS3TX                     *IF
     C           #1J2T1    IFNE WUJ2T1                     *IF
     C           WUJ2T1    IFEQ WUS3TX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPARC
     C                     Z-ADD#1RMNB    PARMNB           Load ID
     C                     Z-ADD*ZERO     PARVNB           Stop_Drop
     C                     MOVEL'ASNTRL'  PARVST    P      Load Change Typ
     C                     MOVEL'TRF'     PAUJST    P      Department Cont
     C                     MOVELWUJ2T1    PAMNTX    P      Change Log Prio
     C                     MOVEL#1J2T1    PAMOTX    P      Change Log New
     C                     MOVEL##USR     PAAYNA    P      User Id
     C                     MOVEL##PGM     PAA0NA    P      Job Name
     C                     MOVEL#1XACD    PABZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PAAIC3           Company Number
     C                     Z-ADD#1C4NB    PAC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,40           *
     C                     MOVEL'1'       @I1,31           *
     C                     END
     C                     END                             *FI
      * F3 = Exit without faxing
      * CASE: DTL.*CMD key is *Exit
     C           *IN03     IFEQ '1'                        *IF
     C                     MOVEL'Y2U9999' W0RTN            *Return code
     C                     END                             *FI
     C           W0PMD     IFEQ 'ADD'
      * Exit after successful add
     C                     MOVEL'N'       W0RPT
     C                     END
      * Restart program for next record
     C                     MOVEL'N'       W0TRN
     C                     END
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         ECADRQ    BEGSR
      *================================================================
      * Process add request
      *================================================================
      * USER: Create DBF record
      * CRT OHE for Exp Instr2 CR - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0359           Company Number
     C                     Z-ADD#1C4NB    WL0360           Order Number
     C                     Z-ADD#1RMNB    WL0361           Load ID
     C                     Z-ADD#1RUNB    WL0362           Stop_Drop Seque
     C                     MOVEL#1XACD    WL0363    P      Shipping Line
     C                     MOVEL#1OANA    WL0364    P      Port Delv Termi
     C                     MOVEL#1HBAA    WL0365    P      OHE City
     C                     MOVEL#1J0T1    WL0366    P      OHE Vessel_Airl
     C                     MOVEL#1GENY    WL0367    P      OHE Voyage_Flig
     C                     MOVEL#1J1T1    WL0368    P      OHE Booking Num
     C                     MOVEL#1HCAA    WL0369    P      OHE Discharge P
     C                     Z-ADD#1QWDT    WL0370           OHE Sail_Flight
     C                     Z-ADD#1QXDT    WL0371           OHE Port Cut Da
     C                     Z-ADD#1QYDT    WL0372           OHE Arrival Dat
     C                     MOVEL#1HDAA    WL0373    P      OHE Late Delive
     C                     MOVEL#1CCTX    WL0374    P      OHE Ship Status
     C                     MOVEL#1J2T1    WL0375    P      OHE Container N
     C                     MOVEL#1RLNA    WL0376    P      OHE Comment 1
     C                     MOVEL#1RMNA    WL0377    P      OHE Comment 2
     C                     Z-ADD#1GINY    WL0378           OHE Unused Numb
     C                     Z-ADD#1GFNY    WL0379           OHE Unused Numb
     C                     Z-ADD#1GGNY    WL0380           OHE Unused Numb
     C                     Z-ADD#1GHNY    WL0381           OHE Unused Numb
     C                     Z-ADD#1HEVL    WL0382           OHE HPB RIN Equ
     C                     Z-ADD#1HFVL    WL0383           OHE HPB RIN Pri
     C                     Z-ADD#1HGVL    WL0384           Transload Termi
     C                     Z-ADD#1QZDT    WL0385           OHE Est Arrv at
     C                     Z-ADD#1Q0DT    WL0386           OHE Backhaul ET
     C                     Z-ADD#1Q1DT    WL0387           OHE Port_Pier P
     C                     Z-ADD#DF9DT    WL0388           OHE Actual Ship
     C                     MOVEL#1C2TX    WL0389    P      OHE Carrier SCA
     C                     MOVEL#1C3TX    WL0390    P      OHE Spot Buy
     C                     MOVEL#1C6TX    WL0391    P      OHE PO ACK Flag
     C                     MOVEL#1CHTX    WL0392    P      OHE Override Ty
     C                     MOVEL#1CITX    WL0393    P      OHE Backhaul St
     C                     MOVEL#1CLTX    WL0394    P      OHE Backhaul ET
     C                     MOVEL#1B4TX    WL0395    P      OHE Load Haul T
     C                     MOVEL#1CUTX    WL0396    P      OHE Backhaul Ca
     C                     MOVEL#1CVTX    WL0397    P      OHE Bookings Co
     C                     MOVEL#1B9TX    WL0398    P      OHE EDI Error R
     C                     MOVEL#1JWSC    WL0399    P      OHE EDI Error R
     C                     Z-ADD#1ITNY    WL0400           HPB COA Batch N
     C                     MOVEL#1LMT1    WL0401    P      Delivery P.O. N
     C                     MOVEL#1LWAA    WL0402    P      OHE Intended fo
     C                     MOVEL#1FVST    WL0403    P      OHE EDI 943 Act
     C                     MOVEL#1F0ST    WL0404    P      OHE EDI 944 Act
     C                     MOVEL#1F2ST    WL0405    P      OHE EDI 940 Act
     C                     MOVEL#1F3ST    WL0406    P      OHE EDI 945 Act
     C                     MOVEL#1JUSC    WL0407    P      OHE EDI 856 Act
     C                     MOVEL#1JVSC    WL0408    P      OHE EDI 824 Act
     C                     MOVEL#1V3T1    WL0409    P      OHE Transload S
     C                     MOVEL#1V4T1    WL0410    P      OHE Abs Rate Ov
     C                     MOVEL#1V5T1    WL0411    P      OHE Appt Confir
     C                     MOVEL#1V6T1    WL0412    P      OHE Backhaul Co
     C                     MOVEL#1V7T1    WL0413    P      OHE Backhaul Ch
     C                     MOVEL#1V8T1    WL0414    P      OHE Transload C
     C                     MOVEL#1V9T1    WL0415    P      OHE Pier Pass I
     C                     MOVEL*BLANK    WL0416           OHE Carrier Nm
     C                     MOVEL#1WBT1    WL0417    P      OHE Appt Confir
     C                     MOVEL#1WCT1    WL0418    P      OHE Backhaul Co
     C                     MOVEL#DAKU1    WL0419    P      Letter of Credi
     C                     Z-ADD#1QJNY    WL0420           OHE Backhaul Re
     C                     Z-ADD#1QKNY    WL0421           LD Stop_Drop
     C                     Z-ADD#1QLNY    WL0422           OHE Unused Numb
     C                     Z-ADD#1P8NY    WL0423           OHE Pier Pass F
     C                     Z-ADD#1P9NY    WL0424           OHE Port Check
     C                     Z-ADD#DT4TM    WL0425           OHE Port Cut Ti
     C                     Z-ADD#1QCNY    WL0426           OHE Backhaul Tr
     C                     Z-ADD#1QDNY    WL0427           OHE Load Sched
     C                     Z-ADD#1QENY    WL0428           Original Appoin
     C                     Z-ADD#1QFNY    WL0429           Original Appoin
     C                     Z-ADD#1QGNY    WL0430           OHE PowerPro Lo
     C                     Z-ADD#1QHNY    WL0431           OHE PowerPro Lo
     C                     Z-ADD#1QINY    WL0432           OHE Unused Nume
     C                     Z-ADD#1QMNY    WL0433           OHE Orig ABS Fr
     C                     MOVEL#1MYU1    WL0434    P      OHE Genset Numb
     C                     MOVEL#1JXSC    WL0435    P      OHE Email BOL_S
     C                     MOVEL#1JYSC    WL0436    P      OHE EDI Order A
     C                     MOVEL#1JZSC    WL0437    P      OHE EDI 601 Act
     C                     MOVEL#1J0SC    WL0438    P      OHE Unused Stat
     C                     MOVEL#1MZU1    WL0439    P      OHE Unused Text
     C                     MOVEL#1M0U1    WL0440    P      OHE Unused Text
     C                     MOVEL#1M1U1    WL0441    P      OHE Customer Ve
     C                     MOVEL#1M2U1    WL0442    P      OHE EDI 824 AES
     C                     MOVEL#1M3U1    WL0443    P      OHE Unused Text
     C                     Z-ADD#1W5DT    WL0444           OHE Unused Date
     C                     Z-ADD#1W6DT    WL0445           OHE Unused Date
     C                     MOVEL#1UVST    WL0446    P      EDI Status 1
     C                     MOVEL#1UWST    WL0447    P      EDI Status 2
     C                     MOVEL#1UXST    WL0448    P      EDI Status 3
     C                     MOVEL#1VSST    WL0449    P      Record Status
     C                     Z-ADD#1AATM    WL0450           Job Time
     C                     MOVEL#1AYNA    WL0451    P      User Id
     C                     MOVEL#1A0NA    WL0452    P      Job Name
     C                     Z-ADD#1AXDT    WL0453           Job Date
     C                     MOVEL#DDXTX    WL0454    P      Trailer Id
     C                     MOVEL#DDYTX    WL0455    P      Transloader Car
     C                     MOVELYL0278    WL0456    P      Orders have Sam
     C                     MOVELYL0276    WL0457    P      EDI Interchange
     C                     MOVELYL0206    WL0458    P      Country Code
     C                     Z-ADDYL0284    WL0459           CBP Export Port
     C                     MOVELYL0285    WL0460    P      CBP Std Carrier
     C                     Z-ADDYL0256    WL0461           CBP Foreign Por
     C                     MOVEL#DWPST    WL0462    P      Warehouse Type
     C                     EXSR SXCRRC
     C           W0RTN     IFEQ *BLANK
      * Send message '*Record added'
     C                     MOVEL'Y2U0011' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
      *================================================================
     CSR         ECEXIT    ENDSR
      /EJECT
     CSR         EECHRQ    BEGSR
      *================================================================
      * Process update request
      *================================================================
      * USER: Change DBF record
      * CHG OHE for Exp Instr2 CH - Order Header Extension  * 
     C                     EXSR TACHRC
     C           W0RTN     IFNE *BLANK
      * Data update error
      * Reset screen fields if changed record
     C           W0RTN     CASEQ'Y2U0007' MBFL#1
     C                     END
     C                     ELSE
     C           YERDC     IFEQ 'Y'
      * Send message '*Record changed'
     C                     MOVEL'Y2U0012' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *================================================================
     CSR         EEEXIT    ENDSR
      /EJECT
     CSR         FACKPM    BEGSR
      *================================================================
      * Check passed parameters
      *================================================================
      * Is full key present?
     C           P1AIC3    IFEQ *ZERO                      Company Number
     C           P1C4NB    OREQ *ZERO                      Order Number
      * Not every key field passed - loop program
     C                     MOVEL'Y'       W0RPT   1
     C                     ELSE
      * Full key passed, so single shot program
     C                     MOVEL'N'       W0RPT
     C                     END
      *================================================================
     CSR         FAEXIT    ENDSR
      /EJECT
     CSR         GADSAK    BEGSR
      *================================================================
      * Set key screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSAD    BEGSR
      *================================================================
      * Set detail screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      * Protect key fields on detail screen
     C                     SETON                     88    *
     C           W0SCR     IFNE 1
     C                     MOVEL'0'       *IN79
     C                     END
     C           W0SCR     IFNE 2
     C                     END
     C           W0SCR     IFEQ 1
     C                     MOVEL'0'       *IN79
     C           P6AKTX    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     ELSE
     C           W0SCR     IFEQ 2
     C                     END
     C                     END
     C           W0RPT     IFEQ 'N'
      * Disable key screen - not applicable
     C                     SETOF                     87    *
     C                     ELSE
      * Enable key screen
     C                     SETON                     87    *
     C                     END
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise record - except for key fields and "neither" paramete
      *================================================================
     C                     Z-ADD*ZERO     #DAFTM           Requested Deliv
     C                     MOVEL*BLANK    #1VSST           Record Status
     C                     MOVEL*BLANK    #1B4TX           OHE Load Haul T
     C                     MOVEL*BLANK    #1CVTX           OHE Bookings Co
     C                     MOVEL*BLANK    #1HDAA           OHE Late Delive
     C                     Z-ADD*ZERO     #1GINY           OHE Unused Numb
     C                     Z-ADD*ZERO     #1GFNY           OHE Unused Numb
     C                     Z-ADD*ZERO     #1GGNY           OHE Unused Numb
     C                     Z-ADD*ZERO     #1GHNY           OHE Unused Numb
     C                     Z-ADD*ZERO     #1HEVL           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     #1HFVL           OHE HPB RIN Pri
     C                     Z-ADD*ZERO     #1Q0DT           OHE Backhaul ET
     C                     Z-ADD*ZERO     #1Q2DT           OHE Actual Ship
     C                     MOVEL*BLANK    #1C2TX           OHE Carrier SCA
     C                     MOVEL*BLANK    #1C3TX           OHE Spot Buy
     C                     MOVEL*BLANK    #1C6TX           OHE PO ACK Flag
     C                     MOVEL*BLANK    #1CHTX           OHE Override Ty
     C                     MOVEL*BLANK    #1CITX           OHE Backhaul St
     C                     MOVEL*BLANK    #1CLTX           OHE Backhaul ET
     C                     MOVEL*BLANK    #1CUTX           OHE Backhaul Ca
     C                     MOVEL*BLANK    #1B9TX           OHE EDI Error R
     C                     MOVEL*BLANK    #1JWSC           OHE EDI Error R
     C                     Z-ADD*ZERO     #1ITNY           HPB COA Batch N
     C                     MOVEL*BLANK    #1LMT1           Delivery P.O. N
     C                     MOVEL*BLANK    #1LWAA           OHE Intended fo
     C                     MOVEL*BLANK    #1FVST           OHE EDI 943 Act
     C                     MOVEL*BLANK    #1F0ST           OHE EDI 944 Act
     C                     MOVEL*BLANK    #1F2ST           OHE EDI 940 Act
     C                     MOVEL*BLANK    #1F3ST           OHE EDI 945 Act
     C                     MOVEL*BLANK    #1JUSC           OHE EDI 856 Act
     C                     MOVEL*BLANK    #1JVSC           OHE EDI 824 Act
     C                     MOVEL*BLANK    #1V4T1           OHE Abs Rate Ov
     C                     MOVEL*BLANK    #1WAT1           OHE Carrier Nm
     C                     Z-ADD*ZERO     #1QANY           OHE Port Cut Ti
     C                     MOVEL*BLANK    #1V5T1           OHE Appt Confir
     C                     MOVEL*BLANK    #1V6T1           OHE Backhaul Co
     C                     MOVEL*BLANK    #1V7T1           OHE Backhaul Ch
     C                     MOVEL*BLANK    #1WBT1           OHE Appt Confir
     C                     MOVEL*BLANK    #1WCT1           OHE Backhaul Co
     C                     MOVEL*BLANK    #1WDT1           Letter of Credi
     C                     Z-ADD*ZERO     #1QJNY           OHE Backhaul Re
     C                     Z-ADD*ZERO     #1QKNY           LD Stop_Drop
     C                     Z-ADD*ZERO     #1QLNY           OHE Unused Numb
     C                     Z-ADD*ZERO     #1QCNY           OHE Backhaul Tr
     C                     Z-ADD*ZERO     #1QDNY           OHE Load Sched
     C                     Z-ADD*ZERO     #1QENY           Original Appoin
     C                     Z-ADD*ZERO     #1QFNY           Original Appoin
     C                     Z-ADD*ZERO     #1QINY           OHE Unused Nume
     C                     Z-ADD*ZERO     #1QMNY           OHE Orig ABS Fr
     C                     MOVEL*BLANK    #1MYU1           OHE Genset Numb
     C                     MOVEL*BLANK    #1JXSC           OHE Email BOL_S
     C                     MOVEL*BLANK    #1JYSC           OHE EDI Order A
     C                     MOVEL*BLANK    #1JZSC           OHE EDI 601 Act
     C                     MOVEL*BLANK    #1J0SC           OHE Unused Stat
     C                     MOVEL*BLANK    #1MZU1           OHE Unused Text
     C                     MOVEL*BLANK    #1M0U1           OHE Unused Text
     C                     MOVEL*BLANK    #1M1U1           OHE Customer Ve
     C                     MOVEL*BLANK    #1M3U1           OHE Unused Text
     C                     Z-ADD*ZERO     #1W5DT           OHE Unused Date
     C                     Z-ADD*ZERO     #1W6DT           OHE Unused Date
     C                     MOVEL*BLANK    #1UVST           EDI Status 1
     C                     MOVEL*BLANK    #1UWST           EDI Status 2
     C                     MOVEL*BLANK    #1UXST           EDI Status 3
     C                     Z-ADD*ZERO     #1AATM           Job Time
     C                     MOVEL*BLANK    #1AYNA           User Id
     C                     MOVEL*BLANK    #1A0NA           Job Name
     C                     Z-ADD*ZERO     #1AXDT           Job Date
     C                     Z-ADD*ZERO     #1RMNB           Load ID
     C                     Z-ADD*ZERO     #1RUNB           Stop_Drop Seque
     C                     Z-ADD*ZERO     #DEIDT           Requested Deliv
      * Clear external version also
     C                     Z-ADD*ZERO     VDEIDT
     C                     Z-ADD*ZERO     #DHMNX           USR From Time 4
     C                     MOVEL*BLANK    #DBZNA           Carrier Code
     C                     MOVEL*BLANK    #DW1TX           Carrier Name DR
     C                     MOVEL*BLANK    #DWPST           Warehouse Type
     C                     Z-ADD*ZERO     #DAODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     VDAODT
     C                     MOVEL*BLANK    #DBRTX           Ship To Name
     C                     MOVEL*BLANK    #DAJNA           City
     C                     MOVEL*BLANK    #DEINA           State
     C                     Z-ADD*ZERO     #DF9DT           Actual Ship Dat
      * Clear external version also
     C                     Z-ADD*ZERO     VDF9DT
     C                     MOVEL*BLANK    #DSQTX           Company Name DR
     C                     MOVEL*BLANK    #DQ2CD           Shipping Method
     C                     Z-ADD*ZERO     #DHDDT           Deadline Depart
      * Clear external version also
     C                     Z-ADD*ZERO     VDHDDT
     C                     Z-ADD*ZERO     #DYBNB           Deadline Depart
     C                     MOVEL*BLANK    #1CCTX           OHE Ship Status
     C                     MOVEL*BLANK    #DEFT1           Note: Text Usr
     C                     MOVEL*BLANK    #1XACD           Shipping Line
     C                     MOVEL*BLANK    #DGVTX           USR Carrier Nam
     C                     MOVEL*BLANK    #1OANA           Port Delv Termi
     C                     MOVEL*BLANK    #1HCAA           OHE Discharge P
     C                     MOVEL*BLANK    #1HBAA           OHE City
     C                     MOVEL*BLANK    #DXBCD           Sail Port State
     C                     MOVEL*BLANK    #1J0T1           OHE Vessel_Airl
     C                     MOVEL*BLANK    #1GENY           OHE Voyage_Flig
     C                     MOVEL*BLANK    #1J1T1           OHE Booking Num
     C                     MOVEL*BLANK    #DAKU1           String 30
     C                     MOVEL*BLANK    #1M2U1           OHE EDI 824 AES
     C                     Z-ADD*ZERO     #1QXDT           OHE Port Cut Da
      * Clear external version also
     C                     Z-ADD*ZERO     V1QXDT
     C                     Z-ADD*ZERO     #DT4TM           USR Time 4.0
     C                     MOVEL*BLANK    #1J2T1           OHE Container N
     C                     MOVEL*BLANK    #DDXTX           Trailer Id
     C                     Z-ADD*ZERO     #1QWDT           OHE Sail_Flight
      * Clear external version also
     C                     Z-ADD*ZERO     V1QWDT
     C                     MOVEL*BLANK    #DDMTX           Seal 1
     C                     Z-ADD*ZERO     #1QYDT           OHE Arrival Dat
      * Clear external version also
     C                     Z-ADD*ZERO     V1QYDT
     C                     MOVEL*BLANK    #DDNTX           Seal 2
     C                     Z-ADD*ZERO     #1QZDT           OHE Est Arrv at
      * Clear external version also
     C                     Z-ADD*ZERO     V1QZDT
     C                     MOVEL*BLANK    #DDOTX           Seal 3
     C                     MOVEL*BLANK    #DDYTX           Transloader Car
     C                     Z-ADD*ZERO     #1P8NY           OHE Pier Pass F
     C                     Z-ADD*ZERO     #1QGNY           OHE PowerPro Lo
     C                     MOVEL*BLANK    #1V8T1           OHE Transload C
     C                     MOVEL*BLANK    #1V9T1           OHE Pier Pass I
     C                     Z-ADD*ZERO     #1QHNY           OHE PowerPro Lo
     C                     MOVEL*BLANK    #1V3T1           OHE Transload S
     C                     Z-ADD*ZERO     #1P9NY           OHE Port Check
     C                     Z-ADD*ZERO     #1HGVL           Transload Termi
     C                     Z-ADD*ZERO     #1Q1DT           OHE Port_Pier P
      * Clear external version also
     C                     Z-ADD*ZERO     V1Q1DT
     C                     MOVEL*BLANK    #1RLNA           OHE Comment 1
     C                     MOVEL*BLANK    #1RMNA           OHE Comment 2
     C                     MOVEL*BLANK    #DAGTX           USR Company Nam
     C                     MOVEL*BLANK    #DA7TX           USR Name
     C                     MOVEL*BLANK    #DGVTX           USR Carrier Nam
     C                     MOVEL*BLANK    #DG3T1           Description 21a
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @AMREJF fields to screen
      *================================================================
     C                     MOVELAMVSST    #1VSST           Record Status
     C                     MOVELAMB4TX    #1B4TX           OHE Load Haul T
     C                     MOVELAMCVTX    #1CVTX           OHE Bookings Co
     C                     MOVELAMHDAA    #1HDAA           OHE Late Delive
     C                     Z-ADDAMGINY    #1GINY           OHE Unused Numb
     C                     Z-ADDAMGFNY    #1GFNY           OHE Unused Numb
     C                     Z-ADDAMGGNY    #1GGNY           OHE Unused Numb
     C                     Z-ADDAMGHNY    #1GHNY           OHE Unused Numb
     C                     Z-ADDAMHEVL    #1HEVL           OHE HPB RIN Equ
     C                     Z-ADDAMHFVL    #1HFVL           OHE HPB RIN Pri
     C                     Z-ADDAMQ0DT    #1Q0DT           OHE Backhaul ET
     C                     Z-ADDAMQ2DT    #1Q2DT           OHE Actual Ship
     C                     MOVELAMC2TX    #1C2TX           OHE Carrier SCA
     C                     MOVELAMC3TX    #1C3TX           OHE Spot Buy
     C                     MOVELAMC6TX    #1C6TX           OHE PO ACK Flag
     C                     MOVELAMCHTX    #1CHTX           OHE Override Ty
     C                     MOVELAMCITX    #1CITX           OHE Backhaul St
     C                     MOVELAMCLTX    #1CLTX           OHE Backhaul ET
     C                     MOVELAMCUTX    #1CUTX           OHE Backhaul Ca
     C                     MOVELAMB9TX    #1B9TX           OHE EDI Error R
     C                     MOVELAMJWSC    #1JWSC           OHE EDI Error R
     C                     Z-ADDAMITNY    #1ITNY           HPB COA Batch N
     C                     MOVELAMLMT1    #1LMT1           Delivery P.O. N
     C                     MOVELAMLWAA    #1LWAA           OHE Intended fo
     C                     MOVELAMFVST    #1FVST           OHE EDI 943 Act
     C                     MOVELAMF0ST    #1F0ST           OHE EDI 944 Act
     C                     MOVELAMF2ST    #1F2ST           OHE EDI 940 Act
     C                     MOVELAMF3ST    #1F3ST           OHE EDI 945 Act
     C                     MOVELAMJUSC    #1JUSC           OHE EDI 856 Act
     C                     MOVELAMJVSC    #1JVSC           OHE EDI 824 Act
     C                     MOVELAMV4T1    #1V4T1           OHE Abs Rate Ov
     C                     MOVELAMWAT1    #1WAT1           OHE Carrier Nm
     C                     Z-ADDAMQANY    #1QANY           OHE Port Cut Ti
     C                     MOVELAMV5T1    #1V5T1           OHE Appt Confir
     C                     MOVELAMV6T1    #1V6T1           OHE Backhaul Co
     C                     MOVELAMV7T1    #1V7T1           OHE Backhaul Ch
     C                     MOVELAMWBT1    #1WBT1           OHE Appt Confir
     C                     MOVELAMWCT1    #1WCT1           OHE Backhaul Co
     C                     MOVELAMWDT1    #1WDT1           Letter of Credi
     C                     Z-ADDAMQJNY    #1QJNY           OHE Backhaul Re
     C                     Z-ADDAMQKNY    #1QKNY           LD Stop_Drop
     C                     Z-ADDAMQLNY    #1QLNY           OHE Unused Numb
     C                     Z-ADDAMQCNY    #1QCNY           OHE Backhaul Tr
     C                     Z-ADDAMQDNY    #1QDNY           OHE Load Sched
     C                     Z-ADDAMQENY    #1QENY           Original Appoin
     C                     Z-ADDAMQFNY    #1QFNY           Original Appoin
     C                     Z-ADDAMQINY    #1QINY           OHE Unused Nume
     C                     Z-ADDAMQMNY    #1QMNY           OHE Orig ABS Fr
     C                     MOVELAMMYU1    #1MYU1           OHE Genset Numb
     C                     MOVELAMJXSC    #1JXSC           OHE Email BOL_S
     C                     MOVELAMJYSC    #1JYSC           OHE EDI Order A
     C                     MOVELAMJZSC    #1JZSC           OHE EDI 601 Act
     C                     MOVELAMJ0SC    #1J0SC           OHE Unused Stat
     C                     MOVELAMMZU1    #1MZU1           OHE Unused Text
     C                     MOVELAMM0U1    #1M0U1           OHE Unused Text
     C                     MOVELAMM1U1    #1M1U1           OHE Customer Ve
     C                     MOVELAMM3U1    #1M3U1           OHE Unused Text
     C                     Z-ADDAMW5DT    #1W5DT           OHE Unused Date
     C                     Z-ADDAMW6DT    #1W6DT           OHE Unused Date
     C                     MOVELAMUVST    #1UVST           EDI Status 1
     C                     MOVELAMUWST    #1UWST           EDI Status 2
     C                     MOVELAMUXST    #1UXST           EDI Status 3
     C                     Z-ADDAMAATM    #1AATM           Job Time
     C                     MOVELAMAYNA    #1AYNA           User Id
     C                     MOVELAMA0NA    #1A0NA           Job Name
     C                     Z-ADDAMAXDT    #1AXDT           Job Date
     C                     Z-ADDAMC4NB    #1C4NB           Order Number
     C                     Z-ADDAMRMNB    #1RMNB           Load ID
     C                     Z-ADDAMRUNB    #1RUNB           Stop_Drop Seque
     C                     Z-ADDAMAIC3    #1AIC3           Company Number
     C                     MOVELAMCCTX    #1CCTX           OHE Ship Status
     C                     MOVELAMXACD    #1XACD           Shipping Line
     C                     MOVELAMOANA    #1OANA           Port Delv Termi
     C                     MOVELAMHCAA    #1HCAA           OHE Discharge P
     C                     MOVELAMHBAA    #1HBAA           OHE City
     C                     MOVELAMJ0T1    #1J0T1           OHE Vessel_Airl
     C                     MOVELAMGENY    #1GENY           OHE Voyage_Flig
     C                     MOVELAMJ1T1    #1J1T1           OHE Booking Num
     C                     MOVELAMM2U1    #1M2U1           OHE EDI 824 AES
     C                     Z-ADDAMQXDT    #1QXDT           OHE Port Cut Da
     C                     MOVELAMJ2T1    #1J2T1           OHE Container N
     C                     Z-ADDAMQWDT    #1QWDT           OHE Sail_Flight
     C                     Z-ADDAMQYDT    #1QYDT           OHE Arrival Dat
     C                     Z-ADDAMQZDT    #1QZDT           OHE Est Arrv at
     C                     Z-ADDAMP8NY    #1P8NY           OHE Pier Pass F
     C                     Z-ADDAMQGNY    #1QGNY           OHE PowerPro Lo
     C                     MOVELAMV8T1    #1V8T1           OHE Transload C
     C                     MOVELAMV9T1    #1V9T1           OHE Pier Pass I
     C                     Z-ADDAMQHNY    #1QHNY           OHE PowerPro Lo
     C                     MOVELAMV3T1    #1V3T1           OHE Transload S
     C                     Z-ADDAMP9NY    #1P9NY           OHE Port Check
     C                     Z-ADDAMHGVL    #1HGVL           Transload Termi
     C                     Z-ADDAMQ1DT    #1Q1DT           OHE Port_Pier P
     C                     MOVELAMRLNA    #1RLNA           OHE Comment 1
     C                     MOVELAMRMNA    #1RMNA           OHE Comment 2
      * Hold existing record image
     C                     MOVEL@1DBRC    #1DBRC
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MDIZ#K    BEGSR
      *================================================================
      * Initialize key screen
      *================================================================
     C                     Z-ADDP1AIC3    #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     Z-ADDP1C4NB    #1C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V1C4NB
      * Check reference to Order Header TRG
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     993132*
     C                     END
      * USER: Initialize key screen
      * ** Program mode
      * CASE: PGM.*Program mode is *CHANGE
     C           W0PMD     IFEQ 'CHG'                      *IF
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL'ADD'     W0PMD            *Program mode
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ @CN,014                    *IF
     C                     MOVEL'CHG'     W0PMD            *Program mode
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         MDEXIT    ENDSR
      /EJECT
     CSR         MFIZ#2    BEGSR
      *================================================================
      * Initialise derived fields
      *================================================================
     C                     MOVEL*BLANK    #DW1TX           Carrier Name DR
     C                     MOVEL*BLANK    #DSQTX           Company Name DR
      *================================================================
     CSR         MFEXIT    ENDSR
      /EJECT
     CSR         MNCV#K    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C4NB           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#D    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  #DEIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDEIDT
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #DAODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDAODT
      * Convert Actual Ship Date to display format
      * Convert date
     C           1000000   ADD  #DF9DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDF9DT
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Deadline Depart DT    HDR to display format
      * Convert date
     C           1000000   ADD  #DHDDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDHDDT
      * Convert OHE Port Cut Date to display format
      * Convert date
     C           1000000   ADD  #1QXDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1QXDT
      * Convert OHE Sail_Flight Date to display format
      * Convert date
     C           1000000   ADD  #1QWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1QWDT
      * Convert OHE Arrival Date to display format
      * Convert date
     C           1000000   ADD  #1QYDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1QYDT
      * Convert OHE Est Arrv at Dest Date to display format
      * Convert date
     C           1000000   ADD  #1QZDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1QZDT
      * Convert OHE Port_Pier Paid Date to display format
      * Convert date
     C           1000000   ADD  #1Q1DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1Q1DT
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert OHE Backhaul ETA RtrnDate to display format
      * Convert date
     C           1000000   ADD  #1Q0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1Q0DT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV LdId/OrdDt/ShpDt  RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0001    BEAIC3           Company Number
     C                     Z-ADDWL0002    BEC4NB           Order Number
      * Establish starting position
     C           KRSSA     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0003           Order Type_Sale
     C                     Z-ADD*ZERO     WL0004           Ship To Custome
     C                     MOVEL*BLANK    WL0005           Ship To Name
     C                     MOVEL*BLANK    WL0006           Ship To City
     C                     MOVEL*BLANK    WL0007           Ship To State C
     C                     Z-ADD*ZERO     WL0008           Order Date
     C                     Z-ADD*ZERO     WL0009           Actual Shipped
     C                     MOVEL*BLANK    WL0010           Carrier Code
     C                     MOVEL*BLANK    WL0011           Order in Use
     C                     MOVEL*BLANK    WL0012           Header Status
     C                     MOVEL*BLANK    WL0013           Credit Hold
     C                     MOVEL*BLANK    WL0014           Production Hold
     C                     Z-ADD*ZERO     WL0015           Requested Deliv
     C                     Z-ADD*ZERO     WL0016           Requested Deliv
     C                     Z-ADD*ZERO     WL0017           Load ID
     C                     MOVEL*BLANK    WL0018           Export Status
     C                     MOVEL*BLANK    WL0019           Billing Activit
     C                     MOVEL*BLANK    WL0020           Block Order Fla
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBEJNCD    WL0003           Order Type_Sale
     C                     Z-ADDBEBKC7    WL0004           Ship To Custome
     C                     MOVELBEBRTX    WL0005           Ship To Name
     C                     MOVELBEHNNA    WL0006           Ship To City
     C                     MOVELBEDBCD    WL0007           Ship To State C
     C                     Z-ADDBEA0DT    WL0008           Order Date
     C                     Z-ADDBEGNDT    WL0009           Actual Shipped
     C                     MOVELBEBZNA    WL0010           Carrier Code
     C                     MOVELBEGJST    WL0011           Order in Use
     C                     MOVELBEGWST    WL0012           Header Status
     C                     MOVELBEXIST    WL0013           Credit Hold
     C                     MOVELBEXJST    WL0014           Production Hold
     C                     Z-ADDBEEIDT    WL0015           Requested Deliv
     C                     Z-ADDBEAFTM    WL0016           Requested Deliv
     C                     Z-ADDBERMNB    WL0017           Load ID
     C                     MOVELBEU2ST    WL0018           Export Status
     C                     MOVELBEOBST    WL0019           Billing Activit
     C                     MOVELBEBCST    WL0020           Block Order Fla
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Load All Fields    RT - Load Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  1        Status - Y or N
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDWL0021    FJRMNB           Load ID
      * Establish starting position
     C           KRSSB     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFJAIC3    WL0022           Company Number
     C                     Z-ADDFJAODT    WL0023           Scheduled Ship
     C                     MOVELFJPJST    WL0024           LTL Flag
     C                     MOVELFJPKST    WL0025           Load Status
     C                     Z-ADDFJRNNB    WL0026           Reefer Temperat
     C                     MOVELFJDMTX    WL0027           Seal 1
     C                     MOVELFJDNTX    WL0028           Seal 2
     C                     MOVELFJDOTX    WL0029           Seal 3
     C                     MOVELFJWTTX    WL0030           Seal 4
     C                     MOVELFJWUTX    WL0031           Seal 2 Unused
     C                     Z-ADDFJRPNB    WL0032           Total Load Orde
     C                     Z-ADDFJFLAM    WL0033           Flat Amount
     C                     MOVELFJXQST    WL0034           Allocate Pounds
     C                     Z-ADDFJRRNB    WL0035           Total Stops
     C                     MOVELFJDXTX    WL0036           Trailer Id
     C                     MOVELFJDYTX    WL0037           Transloader Car
     C                     Z-ADDFJSBNB    WL0038           BOL Time
     C                     MOVELFJBZNA    WL0039           Carrier Code
     C                     MOVELFJRONB    WL0040           Truck Size
     C                     Z-ADDFJSQNB    WL0041           Ld Hdr_Ld Dtl U
     C                     Z-ADDFJR1NB    WL0042           Rated Freight
     C                     MOVELFJVCST    WL0043           Ship Status
     C                     MOVELFJVDST    WL0044           Load Type
     C                     Z-ADDFJSDNB    WL0045           Number Pallets
     C                     Z-ADDFJPAOU    WL0046           Number Pallets
     C                     Z-ADDFJDGWG    WL0047           Load Carrier Pa
     C                     Z-ADDFJSXNB    WL0048           Estimated Arriv
     C                     Z-ADDFJHADT    WL0049           Actual Arrival
     C                     Z-ADDFJAART    WL0050           Actual Arrival
     C                     Z-ADDFJDHWG    WL0051           Trailer IN Weig
     C                     Z-ADDFJDIWG    WL0052           Trailer OUT Wei
     C                     Z-ADDFJAQDT    WL0053           Actual Departur
     C                     Z-ADDFJS6NB    WL0054           Departure Time
     C                     Z-ADDFJT4NB    WL0055           Schedule Sequen
     C                     Z-ADDFJPRTM    WL0056           Product Tempera
     C                     Z-ADDFJNPSV    WL0057           Number Spacers
     C                     MOVELFJJ8TX    WL0058           Car_Veh. Initia
     C                     Z-ADDFJTLMI    WL0059           Total Load Mile
     C                     MOVELFJJ9TX    WL0060           Recorder ID
     C                     MOVELFJQ2CD    WL0061           Shipping Method
     C                     MOVELFJVPCD    WL0062           Ship From Wareh
     C                     MOVELFJDBCD    WL0063           Ship To State C
     C                     Z-ADDFJGRWE    WL0064           Gross Weight
     C                     MOVELFJXCCD    WL0065           Carrier Broker
     C                     MOVELFJU2ST    WL0066           Export Status
     C                     Z-ADDFJF9DT    WL0067           Actual Ship Dat
     C                     MOVELFJONTM    WL0068           On Time (Y_N)
     C                     Z-ADDFJJ4DT    WL0069           Truck Ready Dat
     C                     Z-ADDFJTRTM    WL0070           Truck Ready Tim
     C                     Z-ADDFJJ5DT    WL0071           Spotted Date
     C                     Z-ADDFJSPTM    WL0072           Spotted Time
     C                     Z-ADDFJJ6DT    WL0073           Load Finished D
     C                     Z-ADDFJLFTM    WL0074           Load Finished T
     C                     Z-ADDFJJ7DT    WL0075           BOL Complete Da
     C                     Z-ADDFJBOTM    WL0076           BOL Complete Ti
     C                     Z-ADDFJJ8DT    WL0077           BOL Received Da
     C                     Z-ADDFJBLTM    WL0078           BOL Received Ti
     C                     Z-ADDFJKIDT    WL0079           Truck Departure
     C                     Z-ADDFJASTM    WL0080           Truck Departure
     C                     Z-ADDFJKADT    WL0081           Adjusted Depart
     C                     Z-ADDFJAJCM    WL0082           Adjusted Depart
     C                     MOVELFJXACD    WL0083           Shipping Line
     C                     MOVELFJOANA    WL0084           Port Delv Termi
     C                     MOVELFJK4TX    WL0085           Vessel Name
     C                     Z-ADDFJVOAG    WL0086           Voyage
     C                     Z-ADDFJKBDT    WL0087           Sail Date
     C                     MOVELFJNBBO    WL0088           Booking Number
     C                     MOVELFJW4CD    WL0089           Discharge Port
     C                     Z-ADDFJEFDT    WL0090           Arrival Date
     C                     MOVELFJCNTN    WL0091           Container Numbe
     C                     Z-ADDFJKCDT    WL0092           Date In
     C                     Z-ADDFJTMIN    WL0093           Time In
     C                     Z-ADDFJKDDT    WL0094           Date Out
     C                     Z-ADDFJVMNB    WL0095           Time Out
     C                     Z-ADDFJOCFR    WL0096           Load Total Frei
     C                     Z-ADDFJKJDT    WL0097           Scheduled Deliv
     C                     Z-ADDFJATTM    WL0098           Scheduled Deliv
     C                     MOVELFJOTRS    WL0099           LH Unused Sts
     C                     MOVELFJRNST    WL0100           LH Carrier Paym
     C                     Z-ADDFJBRBK    WL0101           Bring Back Mile
     C                     Z-ADDFJEIDT    WL0102           Requested Deliv
     C                     MOVELFJRMST    WL0103           Load Acceptance
     C                     MOVELFJAJCD    WL0104           Warehouse Code
     C                     Z-ADDFJKKDT    WL0105           On Yard Date
     C                     Z-ADDFJAVTM    WL0106           On Yard Time
     C                     Z-ADDFJKZDT    WL0107           Deadline Depart
     C                     Z-ADDFJAXTM    WL0108           Deadline Depart
     C                     MOVELFJLHOS    WL0109           Load Held Over
     C                     MOVELFJLHOR    WL0110           Load Held Over
     C                     MOVELFJWNTX    WL0111           Load Held Over
     C                     MOVELFJOITX    WL0112           Ocean BOL Numbe
     C                     MOVELFJOJTX    WL0113           Express Mail Nu
     C                     Z-ADDFJLLDT    WL0114           Express Mail Da
     C                     MOVELFJLSHG    WL0115           Load Shag Flag
     C                     MOVELFJYPST    WL0116           Load Wash Flag
     C                     Z-ADDFJK0DT    WL0117           Product Complet
     C                     Z-ADDFJAYTM    WL0118           Product Complet
     C                     Z-ADDFJKNNX    WL0119           Pallets Loaded
     C                     Z-ADDFJICWG    WL0120           Avg Pallet Tare
     C                     Z-ADDFJIDWG    WL0121           Tot Pallet Tare
     C                     MOVELFJH9SX    WL0122           Load Confirmed
     C                     MOVELFJWOTX    WL0123           Load Confirmed
     C                     Z-ADDFJK1DT    WL0124           Load Confirmati
     C                     Z-ADDFJAZTM    WL0125           Load Door 1
     C                     Z-ADDFJK2DT    WL0126           Override Total
     C                     Z-ADDFJA0TM    WL0127           Load Door 2
     C                     MOVELFJROST    WL0128           Partial Load
     C                     MOVELFJRPST    WL0129           Load Confirmati
     C                     MOVELFJRQST    WL0130           Export Load USD
     C                     MOVELFJRRST    WL0131           Late Delivery E
     C                     Z-ADDFJZBVA    WL0132           Load Actual Fre
     C                     MOVELFJWPTX    WL0133           Hide on WW Load
     C                     MOVELFJWQTX    WL0134           Late Billing Em
     C                     MOVELFJWRTX    WL0135           Shipping Temp C
     C                     MOVELFJWSTX    WL0136           LH Held Over Rs
     C                     MOVELFJRVSX    WL0137           Multi Company L
     C                     MOVELFJRUSX    WL0138           Fax Sent to SSI
     C                     MOVELFJRWSX    WL0139           Schedule Pos Lo
     C                     MOVELFJRXSX    WL0140           LH Power Only L
     C                     MOVELFJRYSX    WL0141           MG Created Load
     C                     MOVELFJRZSX    WL0142           LH Unused Sts 5
     C                     MOVELFJR0SX    WL0143           Load U_M
     C                     MOVELFJR1SX    WL0144           TPM Shipment St
     C                     MOVELFJR2SX    WL0145           LH Unused Sts 8
     C                     MOVELFJR3SX    WL0146           LH On-Time Reas
     C                     MOVELFJR4SX    WL0147           LH Held Over Re
     C                     Z-ADDFJPYDT    WL0148           LH Carrier Paid
     C                     Z-ADDFJCKTM    WL0149           LH Carrier Paid
     C                     Z-ADDFJPZDT    WL0150           LH Last Combo P
     C                     Z-ADDFJCLTM    WL0151           LH Last Combo P
     C                     Z-ADDFJP0DT    WL0152           LPT Load Plan S
     C                     Z-ADDFJCMTM    WL0153           LPT Load Plan S
     C                     Z-ADDFJP1DT    WL0154           TPM Planned Shi
     C                     Z-ADDFJCNTM    WL0155           LH Unused Time
     C                     Z-ADDFJP2DT    WL0156           LH Unused Date
     C                     Z-ADDFJCOTM    WL0157           LH Unused Time
     C                     Z-ADDFJP3DT    WL0158           LH Unused Date
     C                     Z-ADDFJCQTM    WL0159           LH Unused Time
     C                     MOVELFJUVST    WL0160           EDI Status 1
     C                     MOVELFJUWST    WL0161           EDI Status 2
     C                     MOVELFJUXST    WL0162           EDI Status 3
     C                     GOTO SBEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV All Hdr flds b/ord RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAC4NB    WQSC01           Order Number
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Order Number
      * Setup key
     C                     Z-ADDWL0164    WQSC01           Order Number
      * Establish starting position
     C           KRSSC     SETLL@BFCPY2                    *
     C           KRSSC     READE@BFCPY2                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWAAIC3    WL0163           Company Number
     C                     MOVELWAJNCD    WL0165           Order Type_Sale
     C                     Z-ADDWAANC7    WL0166           AR Customer Num
     C                     Z-ADDWABKC7    WL0167           Ship To Custome
     C                     MOVELWABRTX    WL0168           Ship To Name
     C                     MOVELWAHMNA    WL0169           Ship To Address
     C                     MOVELWAHONA    WL0170           Ship To Address
     C                     MOVELWAHPNA    WL0171           Ship To Address
     C                     MOVELWAHNNA    WL0172           Ship To City
     C                     MOVELWADBCD    WL0173           Ship To State C
     C                     MOVELWACKTX    WL0174           Ship To Zip_Pos
     C                     Z-ADDWAB0C7    WL0175           Bill to Custome
     C                     MOVELWAAETX    WL0176           Bill to Name
     C                     MOVELWAB1NA    WL0177           Bill to Address
     C                     MOVELWAB3NA    WL0178           Bill to Address
     C                     MOVELWAB4NA    WL0179           Bill to Address
     C                     MOVELWAB2NA    WL0180           Bill to City
     C                     MOVELWABHCD    WL0181           Bill to State C
     C                     MOVELWAC8TX    WL0182           Bill to Zip_Pos
     C                     MOVELWABCNA    WL0183           Customer Purcha
     C                     Z-ADDWAA0DT    WL0184           Order Date
     C                     Z-ADDWAA5DT    WL0185           Requested Ship
     C                     Z-ADDWAGNDT    WL0186           Actual Shipped
     C                     Z-ADDWAACDT    WL0187           Cancel Date
     C                     MOVELWAAQCD    WL0188           Terms Code
     C                     MOVELWAB6NA    WL0189           Special Instruc
     C                     MOVELWABYNA    WL0190           Special Instruc
     C                     MOVELWABZNA    WL0191           Carrier Code
     C                     MOVELWAGTST    WL0192           Comment Print A
     C                     MOVELWAGVST    WL0193           Comment Print I
     C                     MOVELWAGUST    WL0194           Comment Print P
     C                     MOVELWAQFST    WL0195           Comment Print S
     C                     MOVELWACQCD    WL0196           Reason Code
     C                     MOVELWAGJST    WL0197           Order in Use
     C                     MOVELWAGWST    WL0198           Header Status
     C                     MOVELWAGXST    WL0199           Header Status L
     C                     MOVELWAGYST    WL0200           Order Type Prin
     C                     Z-ADDWAAODT    WL0201           Scheduled Ship
     C                     MOVELWAAIVN    WL0202           User Original E
     C                     Z-ADDWACXDT    WL0203           Date of Origina
     C                     Z-ADDWAJZVA    WL0204           Order Value Tot
     C                     Z-ADDWAA1WG    WL0205           Order Weight To
     C                     MOVELWAXIST    WL0206           Credit Hold
     C                     MOVELWAXJST    WL0207           Production Hold
     C                     MOVELWAXKST    WL0208           New Customer Ho
     C                     Z-ADDWAEIDT    WL0209           Requested Deliv
     C                     Z-ADDWAAFTM    WL0210           Requested Deliv
     C                     MOVELWAE8CD    WL0211           Accounts Receiv
     C                     MOVELWAE9CD    WL0212           Accounts Receiv
     C                     Z-ADDWARMNB    WL0213           Load ID
     C                     Z-ADDWATBNB    WL0214           Absorbed Freigh
     C                     Z-ADDWAR1NB    WL0215           Rated Freight
     C                     MOVELWAPJST    WL0216           LTL Flag
     C                     MOVELWAU0ST    WL0217           Price Audit
     C                     MOVELWAU1ST    WL0218           Price Status
     C                     MOVELWAQ2CD    WL0219           Shipping Method
     C                     MOVELWAU2ST    WL0220           Export Status
     C                     MOVELWAVEST    WL0221           Palletize
     C                     MOVELWAVFST    WL0222           Shrink Wrap
     C                     MOVELWAVGST    WL0223           Slip Sheet
     C                     MOVELWARPCD    WL0224           Age Code
     C                     Z-ADDWARNNB    WL0225           Reefer Temperat
     C                     MOVELWAVDST    WL0226           Load Type
     C                     Z-ADDWAATIN    WL0227           Attach to Invoi
     C                     MOVELWAU4ST    WL0228           Load Plan Order
     C                     MOVELWAU5ST    WL0229           Print Pick Slip
     C                     Z-ADDWARSRN    WL0230           Resell Referenc
     C                     MOVELWAMHNA    WL0231           Special Comment
     C                     MOVELWAMINA    WL0232           Special Comment
     C                     MOVELWAWBST    WL0233           Affect Auto Acc
     C                     MOVELWAR4CD    WL0234           Sales Route Cod
     C                     MOVELWABFCD    WL0235           Manager Level C
     C                     MOVELWAQ4CD    WL0236           VP Level Code
     C                     Z-ADDWAT3NB    WL0237           Attach to Order
     C                     MOVELWASICD    WL0238           Reason for Pric
     C                     Z-ADDWACONB    WL0239           Invoice Number
     C                     MOVELWACEST    WL0240           Invoice Suffix
     C                     Z-ADDWAAWDT    WL0241           Invoice Date
     C                     MOVELWAJPCD    WL0242           Event Code
     C                     MOVELWAXUST    WL0243           Trans Contol AS
     C                     MOVELWAZ1ST    WL0244           Modified Flag
     C                     Z-ADDWAVRVA    WL0245           A/R order Value
     C                     MOVELWAOBST    WL0246           Billing Activit
     C                     MOVELWABCST    WL0247           Block Order Fla
     C                     MOVELWABDST    WL0248           Order Certifica
     C                     MOVELWAUVST    WL0249           EDI Status 1
     C                     MOVELWAUWST    WL0250           EDI Status 2
     C                     MOVELWAUXST    WL0251           EDI Status 3
     C           KRSSC     READE@BFCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Country Code only  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSD01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSD02           Order Number
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Order Number
      * Setup key
     C                     Z-ADDWL0252    WQSD01           Company Number
     C                     Z-ADDWL0253    WQSD02           Order Number
      * Establish starting position
     C           KRSSD     SETLL@BGWKAE                    *
     C           KRSSD     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0254           Country Code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           OMGMST    IFEQ 'L'                        *IF
     C           OMGMST    OREQ 'A'
     C           OMGMST    OREQ 'C'
     C           OMGMST    OREQ 'R'
     C           OMGMST    OREQ 'E'
     C           OMGMST    OREQ 'H'
     C           OMGMST    OREQ 'I'
      * PAR = DB1 By name
     C                     MOVELOMKXCD    WL0254           Country Code
     C                     GOTO SDEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSD     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Warehouse wo/Quit RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSE01           Company Number
     C           *LIKE     DEFN WBC4NB    WQSE02           Order Number
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           Order Number
      * Setup key
     C                     Z-ADDWL0255    WQSE01           Company Number
     C                     Z-ADDWL0256    WQSE02           Order Number
      * Establish starting position
     C           KRSSE     SETLL@BGWKDA                    *
     C           KRSSE     READE@BGWKDA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0257           Warehouse Code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Cancelled
     C           WBGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWBAJCD    WL0257           Warehouse Code
     C                     END                             *FI
     C           KRSSE     READE@BGWKDA                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Type/Std Chil/Chil RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0258    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSF     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0259           Warehouse Type
     C                     MOVEL*BLANK    WL0260           Warehouse Std C
     C                     Z-ADD*ZERO     WL0261           Warehouse Chill
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADWPST    WL0259           Warehouse Type
     C                     MOVELADT1ST    WL0260           Warehouse Std C
     C                     Z-ADDADDBNB    WL0261           Warehouse Chill
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Order Info by Load RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQSG02           Load ID
     C           *LIKE     DEFN FLC4NB    WQSG03           Order Number
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG02           Load ID
     C                     KFLD           WQSG03           Order Number
      * Setup key
     C                     Z-ADDWL0262    WQSG02           Load ID
     C                     Z-ADDWL0273    WQSG03           Order Number
      * Establish starting position
     C           KRSSG     SETLL@FLCPKF                    *
     C           KRSSG     READE@FLCPKF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0263           Stop_Drop Seque
     C                     Z-ADD*ZERO     WL0264           Stop_Drop
     C                     MOVEL*BLANK    WL0265           Comments for Pi
     C                     Z-ADD*ZERO     WL0266           Miles to next s
     C                     Z-ADD*ZERO     WL0267           Freight Charge
     C                     Z-ADD*ZERO     WL0268           Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WL0269           Freight Misc. C
     C                     Z-ADD*ZERO     WL0270           Freight Stop Ch
     C                     Z-ADD*ZERO     WL0271           Rated Freight
     C                     Z-ADD*ZERO     WL0272           Company Number
     C                     MOVEL*BLANK    WL0274           Ship Status
     C                     Z-ADD*ZERO     WL0275           Estimated Arriv
     C                     Z-ADD*ZERO     WL0276           Estimated Arriv
     C                     Z-ADD*ZERO     WL0277           Appointment Con
     C                     Z-ADD*ZERO     WL0278           Appointment Con
     C                     MOVEL*BLANK    WL0279           Confirmation Ma
     C                     MOVEL*BLANK    WL0280           Confirmation Nu
     C                     Z-ADD*ZERO     WL0281           Actual Delivery
     C                     Z-ADD*ZERO     WL0282           Actual Delivery
     C                     Z-ADD*ZERO     WL0283           Scheduled Deliv
     C                     Z-ADD*ZERO     WL0284           Scheduled Deliv
     C                     Z-ADD*ZERO     WL0285           Deadline Depart
     C                     Z-ADD*ZERO     WL0286           Deadline Depart
     C                     Z-ADD*ZERO     WL0287           On Yard Date
     C                     Z-ADD*ZERO     WL0288           On Yard Time
     C                     Z-ADD*ZERO     WL0289           MPC Number
     C                     MOVEL*BLANK    WL0290           Load Dtl On Tim
     C                     MOVEL*BLANK    WL0291           On Time Addl Rs
     C                     MOVEL*BLANK    WL0292           Seal Nbr 1
     C                     MOVEL*BLANK    WL0293           Seal Nbr 2
     C                     MOVEL*BLANK    WL0294           Seal Nbr 3
     C                     MOVEL*BLANK    WL0295           Seal Nbr 4
     C                     MOVEL*BLANK    WL0296           Seal Nbr 5
     C                     Z-ADD*ZERO     WL0297           LD Carrier Appt
     C                     Z-ADD*ZERO     WL0298           LD Unused Date
     C                     Z-ADD*ZERO     WL0299           LD Unused Date
     C                     Z-ADD*ZERO     WL0300           LD Carrier Appt
     C                     Z-ADD*ZERO     WL0301           LD Unused Time
     C                     Z-ADD*ZERO     WL0302           LD Unused Time
     C                     MOVEL*BLANK    WL0303           Miles Error Sts
     C                     MOVEL*BLANK    WL0304           LD Unused Sts 2
     C                     MOVEL*BLANK    WL0305           HPB Transload S
     C                     MOVEL*BLANK    WL0306           LD Cst Svc Trac
     C                     MOVEL*BLANK    WL0307           Carrier Ref PRO
     C                     MOVEL*BLANK    WL0308           Cust Assigned A
     C                     MOVEL*BLANK    WL0309           EDI Status 1
     C                     MOVEL*BLANK    WL0310           EDI Status 2
     C                     MOVEL*BLANK    WL0311           EDI Status 3
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFLRUNB    WL0263           Stop_Drop Seque
     C                     Z-ADDFLRVNB    WL0264           Stop_Drop
     C                     MOVELFLDQTX    WL0265           Comments for Pi
     C                     Z-ADDFLRWNB    WL0266           Miles to next s
     C                     Z-ADDFLRXNB    WL0267           Freight Charge
     C                     Z-ADDFLSQNB    WL0268           Ld Hdr_Ld Dtl U
     C                     Z-ADDFLT0NB    WL0269           Freight Misc. C
     C                     Z-ADDFLT1NB    WL0270           Freight Stop Ch
     C                     Z-ADDFLR1NB    WL0271           Rated Freight
     C                     Z-ADDFLAIC3    WL0272           Company Number
     C                     MOVELFLVCST    WL0274           Ship Status
     C                     Z-ADDFLKEDT    WL0275           Estimated Arriv
     C                     Z-ADDFLSXNB    WL0276           Estimated Arriv
     C                     Z-ADDFLKFDT    WL0277           Appointment Con
     C                     Z-ADDFLACTM    WL0278           Appointment Con
     C                     MOVELFLK5TX    WL0279           Confirmation Ma
     C                     MOVELFLW5CD    WL0280           Confirmation Nu
     C                     Z-ADDFLEJDT    WL0281           Actual Delivery
     C                     Z-ADDFLAGTM    WL0282           Actual Delivery
     C                     Z-ADDFLKJDT    WL0283           Scheduled Deliv
     C                     Z-ADDFLATTM    WL0284           Scheduled Deliv
     C                     Z-ADDFLHDDT    WL0285           Deadline Depart
     C                     Z-ADDFLAUTM    WL0286           Deadline Depart
     C                     Z-ADDFLKKDT    WL0287           On Yard Date
     C                     Z-ADDFLAVTM    WL0288           On Yard Time
     C                     Z-ADDFLZ4NB    WL0289           MPC Number
     C                     MOVELFLY7ST    WL0290           Load Dtl On Tim
     C                     MOVELFLY2ST    WL0291           On Time Addl Rs
     C                     MOVELFLWHTX    WL0292           Seal Nbr 1
     C                     MOVELFLWITX    WL0293           Seal Nbr 2
     C                     MOVELFLWJTX    WL0294           Seal Nbr 3
     C                     MOVELFLWKTX    WL0295           Seal Nbr 4
     C                     MOVELFLWLTX    WL0296           Seal Nbr 5
     C                     Z-ADDFLN7DT    WL0297           LD Carrier Appt
     C                     Z-ADDFLN8DT    WL0298           LD Unused Date
     C                     Z-ADDFLN9DT    WL0299           LD Unused Date
     C                     Z-ADDFLB3TM    WL0300           LD Carrier Appt
     C                     Z-ADDFLB4TM    WL0301           LD Unused Time
     C                     Z-ADDFLB5TM    WL0302           LD Unused Time
     C                     MOVELFLIASX    WL0303           Miles Error Sts
     C                     MOVELFLIBSX    WL0304           LD Unused Sts 2
     C                     MOVELFLICSX    WL0305           HPB Transload S
     C                     MOVELFLWVTX    WL0306           LD Cst Svc Trac
     C                     MOVELFLWWTX    WL0307           Carrier Ref PRO
     C                     MOVELFLWXTX    WL0308           Cust Assigned A
     C                     MOVELFLUVST    WL0309           EDI Status 1
     C                     MOVELFLUWST    WL0310           EDI Status 2
     C                     MOVELFLUXST    WL0311           EDI Status 3
     C           KRSSG     READE@FLCPKF                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Carrier Name       RT - Carrier              TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           FFBZNA           Carrier Code
      * Setup key
     C                     MOVELWL0312    FFBZNA           Carrier Code
      * Establish starting position
     C           KRSSH     CHAIN@FFREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0313           Name
     C                     MOVEL*BLANK    WL0314           Record Status
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFFADTX    WL0313           Name
     C                     MOVELFFVSST    WL0314           Record Status
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADD#1AIC3    ABAIC3           Company Number
      * Establish starting position
     C           KRSSI     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DSQTX           Name
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    #DSQTX           Name
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Company Name & Add RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0315    ABAIC3           Company Number
      * Establish starting position
     C           KRSSJ     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    WL0316           Name
     C                     MOVELABACNA    WL0317           Address Line 1
     C                     MOVELABADNA    WL0318           Address Line 2
     C                     MOVELABAENA    WL0319           Address Line 3
     C                     MOVELABAJNA    WL0320           City
     C                     MOVELABBTTX    WL0321           Zip Postal Code
     C                     MOVELABBGCD    WL0322           State Code
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Shp Line/Port All  RT - Shipping Line/Port  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           LCXACD           Shipping Line
     C                     KFLD           LCOANA           Port Delv Termi
      * Setup key
     C                     MOVELWL0323    LCXACD           Shipping Line
     C                     MOVELWL0324    LCOANA           Port Delv Termi
      * Establish starting position
     C           KRSSK     CHAIN@LCREL2              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2419' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0325           Port City
     C                     MOVEL*BLANK    WL0326           Port Address Li
     C                     MOVEL*BLANK    WL0327           Port Address Li
     C                     MOVEL*BLANK    WL0328           Sail Port State
     C                     MOVEL*BLANK    WL0329           Port Zip/Postal
     C                     Z-ADD*ZERO     WL0330           Port Phone Numb
     C                     MOVEL*BLANK    WL0331           Port Fax Number
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELLCOKTX    WL0325           Port City
     C                     MOVELLCLBTX    WL0326           Port Address Li
     C                     MOVELLCLATX    WL0327           Port Address Li
     C                     MOVELLCXBCD    WL0328           Sail Port State
     C                     MOVELLCLCTX    WL0329           Port Zip/Postal
     C                     Z-ADDLCSPPN    WL0330           Port Phone Numb
     C                     MOVELLCLDTX    WL0331           Port Fax Number
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Company Name Only  RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WCAIC3           Company Number
      * Setup key
     C                     Z-ADD#1QJNY    WCAIC3           Company Number
      * Establish starting position
     C           KRSSL     CHAIN@ABREAK              90    *
      * Data record not found
     C   90                MOVEL'USR0003' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCADTX    #DAGTX           Name
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCHRC    BEGSR
      *================================================================
      * CHG Clr Exp Instr flds CH - Order Header Extension  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0002  50       Stop_Drop Seque
     C                     MOVEL*BLANK    WN0003  3        OHE Late Delive
     C                     MOVEL*BLANK    WN0004  1        OHE Ship Status
     C                     Z-ADD*ZERO     WN0005 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0006 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0007 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0008 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0009 112       OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WN0010 112       OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WN0011  70       OHE Backhaul ET
     C                     MOVEL*BLANK    WN0012  4        OHE Carrier SCA
     C                     MOVEL*BLANK    WN0013  4        OHE Spot Buy
     C                     MOVEL*BLANK    WN0014  4        OHE PO ACK Flag
     C                     MOVEL*BLANK    WN0015  2        OHE Override Ty
     C                     MOVEL*BLANK    WN0016  2        OHE Backhaul St
     C                     MOVEL*BLANK    WN0017  2        OHE Backhaul ET
     C                     MOVEL*BLANK    WN0018  3        OHE Backhaul Ca
     C                     MOVEL*BLANK    WN0019  5        OHE EDI Error R
     C                     MOVEL*BLANK    WN0020  5        OHE EDI Error R
     C                     Z-ADD*ZERO     WN0021  50       HPB COA Batch N
     C                     MOVEL*BLANK    WN0022 38        Delivery P.O. N
     C                     MOVEL*BLANK    WN0023  6        OHE Intended fo
     C                     MOVEL*BLANK    WN0024  6        OHE EDI 943 Act
     C                     MOVEL*BLANK    WN0025  6        OHE EDI 944 Act
     C                     MOVEL*BLANK    WN0026  6        OHE EDI 940 Act
     C                     MOVEL*BLANK    WN0027  6        OHE EDI 945 Act
     C                     MOVEL*BLANK    WN0028  1        OHE EDI 856 Act
     C                     MOVEL*BLANK    WN0029  1        OHE EDI 824 Act
     C                     MOVEL*BLANK    WN0030 10        OHE Appt Confir
     C                     MOVEL*BLANK    WN0031 15        OHE Backhaul Co
     C                     MOVEL*BLANK    WN0032 15        OHE Backhaul Ch
     C                     MOVEL*BLANK    WN0033 30        OHE Appt Confir
     C                     MOVEL*BLANK    WN0034 50        OHE Backhaul Co
     C                     MOVEL*BLANK    WN0035 50        Letter of Credi
     C                     Z-ADD*ZERO     WN0036  30       OHE Backhaul Re
     C                     Z-ADD*ZERO     WN0037  30       LD Stop_Drop
     C                     Z-ADD*ZERO     WN0038  30       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0039  60       OHE Backhaul Tr
     C                     Z-ADD*ZERO     WN0040  60       OHE Load Sched
     C                     Z-ADD*ZERO     WN0041  60       Original Appoin
     C                     Z-ADD*ZERO     WN0042  60       Original Appoin
     C                     Z-ADD*ZERO     WN0043  90       OHE Unused Nume
     C                     Z-ADD*ZERO     WN0044  96       OHE Orig ABS Fr
     C                     MOVEL*BLANK    WN0045 15        OHE Genset Numb
     C                     MOVEL*BLANK    WN0046  1        OHE Email BOL_S
     C                     MOVEL*BLANK    WN0047  1        OHE EDI Order A
     C                     MOVEL*BLANK    WN0048  2        OHE EDI 601 Act
     C                     MOVEL*BLANK    WN0049  2        OHE Unused Stat
     C                     MOVEL*BLANK    WN0050  5        OHE Unused Text
     C                     MOVEL*BLANK    WN0051  5        OHE Unused Text
     C                     MOVEL*BLANK    WN0052 15        OHE Customer Ve
     C                     MOVEL*BLANK    WN0053 15        OHE EDI 824 AES
     C                     MOVEL*BLANK    WN0054 30        OHE Unused Text
     C                     Z-ADD*ZERO     WN0055  70       OHE Unused Date
     C                     Z-ADD*ZERO     WN0056  70       OHE Unused Date
     C                     MOVEL*BLANK    WN0057  1        EDI Status 1
     C                     MOVEL*BLANK    WN0058  1        EDI Status 2
     C                     MOVEL*BLANK    WN0059  1        EDI Status 3
     C                     MOVEL*BLANK    WN0060  1        Record Status
     C                     Z-ADD*ZERO     WN0061  60       Job Time
     C                     MOVEL*BLANK    WN0062 10        User Id
     C                     MOVEL*BLANK    WN0063 10        Job Name
     C                     Z-ADD*ZERO     WN0064  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @AMREJE
     C                     Z-ADD#1AIC3    AMAIC3           Company Number
     C                     Z-ADD#1C4NB    AMC4NB           Order Number
      *
     C           KLCHSM    KLIST
     C                     KFLD           AMAIC3           Company Number
     C                     KFLD           AMC4NB           Order Number
     C           KLCHSM    CHAIN@AMREJE              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PMAMREL0'MDACP
     C                     MOVEL'@AMREJE' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE @1DBRC    YARDCS
      * USER: Processing after Data read
      * CHG Container for ExprtCH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDAMRMNB    WL0332           Load ID
     C                     MOVEL#1J2T1    WL0333    P      Trailer Id
     C                     MOVEL#1J2T1    WL0334    P      Container Numbe
     C                     Z-ADDAMAATM    WL0335           Job Time
     C                     MOVELAMAYNA    WL0336    P      User Id
     C                     MOVELAMA0NA    WL0337    P      Job Name
     C                     Z-ADDAMAXDT    WL0338           Job Date
     C                     EXSR SNCHRC
      * CHG Transloader for ExpCH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDAMRMNB    WL0339           Load ID
     C                     MOVELWUDYTX    WL0340    P      Transloader Car
     C                     Z-ADDAMAATM    WL0341           Job Time
     C                     MOVELAMAYNA    WL0342    P      User Id
     C                     MOVELAMA0NA    WL0343    P      Job Name
     C                     Z-ADDAMAXDT    WL0344           Job Date
     C                     EXSR SOCHRC
      * Move non-key fields to @AMREJE
     C                     Z-ADD#1RMNB    AMRMNB           Load ID
     C                     MOVEL#1XACD    AMXACD    P      Shipping Line
     C                     MOVEL#1OANA    AMOANA    P      Port Delv Termi
     C                     MOVEL#1HBAA    AMHBAA    P      OHE City
     C                     MOVEL#1J0T1    AMJ0T1    P      OHE Vessel_Airl
     C                     MOVEL#1GENY    AMGENY    P      OHE Voyage_Flig
     C                     MOVEL#1J1T1    AMJ1T1    P      OHE Booking Num
     C                     MOVEL#1HCAA    AMHCAA    P      OHE Discharge P
     C                     Z-ADD#1QWDT    AMQWDT           OHE Sail_Flight
     C                     Z-ADD#1QXDT    AMQXDT           OHE Port Cut Da
     C                     Z-ADD#1QYDT    AMQYDT           OHE Arrival Dat
     C                     MOVEL#1J2T1    AMJ2T1    P      OHE Container N
     C                     MOVEL#1RLNA    AMRLNA    P      OHE Comment 1
     C                     MOVEL#1RMNA    AMRMNA    P      OHE Comment 2
     C                     Z-ADD#1HGVL    AMHGVL           Transload Termi
     C                     Z-ADD#1QZDT    AMQZDT           OHE Est Arrv at
     C                     Z-ADD#1Q1DT    AMQ1DT           OHE Port_Pier P
     C                     Z-ADD#1Q2DT    AMQ2DT           OHE Actual Ship
     C                     MOVEL#1B4TX    AMB4TX    P      OHE Load Haul T
     C                     MOVEL#1CVTX    AMCVTX    P      OHE Bookings Co
     C                     MOVEL#1V3T1    AMV3T1    P      OHE Transload S
     C                     MOVEL#1V4T1    AMV4T1    P      OHE Abs Rate Ov
     C                     MOVEL#1V8T1    AMV8T1    P      OHE Transload C
     C                     MOVEL#1V9T1    AMV9T1    P      OHE Pier Pass I
     C                     MOVEL#1WAT1    AMWAT1    P      OHE Carrier Nm
     C                     Z-ADD#1P8NY    AMP8NY           OHE Pier Pass F
     C                     Z-ADD#1P9NY    AMP9NY           OHE Port Check
     C                     Z-ADD#1QANY    AMQANY           OHE Port Cut Ti
     C                     Z-ADD#1QGNY    AMQGNY           OHE PowerPro Lo
     C                     Z-ADD#1QHNY    AMQHNY           OHE PowerPro Lo
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     AMAATM           Job Time
     C                     Z-ADD##JDT     AMAXDT           Job Date
     C                     MOVEL##PGM     AMA0NA           Job Name
     C                     MOVEL##USR     AMAYNA           User Id
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@AMREJE                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPMAMREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNCHRC    BEGSR
      *================================================================
      * CHG Container for ExprtCH - Load Header  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0065  30       Company Number
     C                     Z-ADD*ZERO     WN0066  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0067  1        LTL Flag
     C                     MOVEL*BLANK    WN0068  1        Load Status
     C                     Z-ADD*ZERO     WN0069  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0070 15        Seal 1
     C                     MOVEL*BLANK    WN0071 15        Seal 2
     C                     MOVEL*BLANK    WN0072 15        Seal 3
     C                     MOVEL*BLANK    WN0073 15        Seal 4
     C                     MOVEL*BLANK    WN0074 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0075  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0076 112       Flat Amount
     C                     MOVEL*BLANK    WN0077  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0078  50       Total Stops
     C                     MOVEL*BLANK    WN0079  3        Transloader Car
     C                     Z-ADD*ZERO     WN0080  40       BOL Time
     C                     MOVEL*BLANK    WN0081  3        Carrier Code
     C                     MOVEL*BLANK    WN0082  7        Truck Size
     C                     Z-ADD*ZERO     WN0083  70       Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WN0084 112       Rated Freight
     C                     MOVEL*BLANK    WN0085  1        Ship Status
     C                     MOVEL*BLANK    WN0086  1        Load Type
     C                     Z-ADD*ZERO     WN0087  50       Number Pallets
     C                     Z-ADD*ZERO     WN0088  50       Number Pallets
     C                     Z-ADD*ZERO     WN0089 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0090  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0091  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0092  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0093 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0094 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0095  70       Actual Departur
     C                     Z-ADD*ZERO     WN0096  40       Departure Time
     C                     Z-ADD*ZERO     WN0097  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0098  52       Product Tempera
     C                     Z-ADD*ZERO     WN0099  50       Number Spacers
     C                     MOVEL*BLANK    WN0100 12        Car_Veh. Initia
     C                     Z-ADD*ZERO     WN0101  70       Total Load Mile
     C                     MOVEL*BLANK    WN0102 12        Recorder ID
     C                     MOVEL*BLANK    WN0103  2        Shipping Method
     C                     MOVEL*BLANK    WN0104  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0105  2        Ship To State C
     C                     Z-ADD*ZERO     WN0106  70       Gross Weight
     C                     MOVEL*BLANK    WN0107  3        Carrier Broker
     C                     MOVEL*BLANK    WN0108  1        Export Status
     C                     Z-ADD*ZERO     WN0109  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0110  1        On Time (Y_N)
     C                     Z-ADD*ZERO     WN0111  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0112  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0113  70       Spotted Date
     C                     Z-ADD*ZERO     WN0114  60       Spotted Time
     C                     Z-ADD*ZERO     WN0115  70       Load Finished D
     C                     Z-ADD*ZERO     WN0116  60       Load Finished T
     C                     Z-ADD*ZERO     WN0117  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0118  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0119  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0120  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0121  70       Truck Departure
     C                     Z-ADD*ZERO     WN0122  60       Truck Departure
     C                     Z-ADD*ZERO     WN0123  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0124  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0125  3        Shipping Line
     C                     MOVEL*BLANK    WN0126 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0127 30        Vessel Name
     C                     Z-ADD*ZERO     WN0128  50       Voyage
     C                     Z-ADD*ZERO     WN0129  70       Sail Date
     C                     MOVEL*BLANK    WN0130 12        Booking Number
     C                     MOVEL*BLANK    WN0131 20        Discharge Port
     C                     Z-ADD*ZERO     WN0132  70       Arrival Date
     C                     Z-ADD*ZERO     WN0133  70       Date In
     C                     Z-ADD*ZERO     WN0134  60       Time In
     C                     Z-ADD*ZERO     WN0135  70       Date Out
     C                     Z-ADD*ZERO     WN0136  60       Time Out
     C                     Z-ADD*ZERO     WN0137 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0138  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0139  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0140  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0141  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0142  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0143  70       Requested Deliv
     C                     MOVEL*BLANK    WN0144  1        Load Acceptance
     C                     MOVEL*BLANK    WN0145  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0146  70       On Yard Date
     C                     Z-ADD*ZERO     WN0147  60       On Yard Time
     C                     Z-ADD*ZERO     WN0148  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0149  60       Deadline Depart
     C                     MOVEL*BLANK    WN0150  1        Load Held Over
     C                     MOVEL*BLANK    WN0151  1        Load Held Over
     C                     MOVEL*BLANK    WN0152 15        Load Held Over
     C                     MOVEL*BLANK    WN0153 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0154 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0155  70       Express Mail Da
     C                     MOVEL*BLANK    WN0156  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0157  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0158  70       Product Complet
     C                     Z-ADD*ZERO     WN0159  60       Product Complet
     C                     Z-ADD*ZERO     WN0160  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0161  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0162  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0163  1        Load Confirmed
     C                     MOVEL*BLANK    WN0164 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0165  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0166  60       Load Door 1
     C                     Z-ADD*ZERO     WN0167  70       Override Total
     C                     Z-ADD*ZERO     WN0168  60       Load Door 2
     C                     MOVEL*BLANK    WN0169  1        Partial Load
     C                     MOVEL*BLANK    WN0170  1        Load Confirmati
     C                     MOVEL*BLANK    WN0171  1        Export Load USD
     C                     MOVEL*BLANK    WN0172  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0173 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0174 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0175 15        Late Billing Em
     C                     MOVEL*BLANK    WN0176 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0177 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0178  1        Multi Company L
     C                     MOVEL*BLANK    WN0179  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0180  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0181  1        LH Power Only L
     C                     MOVEL*BLANK    WN0182  1        MG Created Load
     C                     MOVEL*BLANK    WN0183  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0184  2        Load U_M
     C                     MOVEL*BLANK    WN0185  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0186  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0187  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0188  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0189  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0190  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0191  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0192  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0193  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0194  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0195  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0196  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0197  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0198  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0199  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0200  60       LH Unused Time
     C                     MOVEL*BLANK    WN0201  1        EDI Status 1
     C                     MOVEL*BLANK    WN0202  1        EDI Status 2
     C                     MOVEL*BLANK    WN0203  1        EDI Status 3
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWL0332    WDRMNB           Load ID
      *
     C           KLCHSN    KLIST
     C                     KFLD           WDRMNB           Load ID
     C           KLCHSN    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YBRDCS
      * Move non-key fields to @FJCPBO
     C                     MOVELWL0333    WDDXTX    P      Trailer Id
     C                     MOVELWL0334    WDCNTN    P      Container Numbe
     C                     Z-ADDWL0335    WDAATM           Job Time
     C                     MOVELWL0336    WDAYNA    P      User Id
     C                     MOVELWL0337    WDA0NA    P      Job Name
     C                     Z-ADDWL0338    WDAXDT           Job Date
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##JOB     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCHRC    BEGSR
      *================================================================
      * CHG Transloader for ExpCH - Load Header  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0204  30       Company Number
     C                     Z-ADD*ZERO     WN0205  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0206  1        LTL Flag
     C                     MOVEL*BLANK    WN0207  1        Load Status
     C                     Z-ADD*ZERO     WN0208  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0209 15        Seal 1
     C                     MOVEL*BLANK    WN0210 15        Seal 2
     C                     MOVEL*BLANK    WN0211 15        Seal 3
     C                     MOVEL*BLANK    WN0212 15        Seal 4
     C                     MOVEL*BLANK    WN0213 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0214  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0215 112       Flat Amount
     C                     MOVEL*BLANK    WN0216  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0217  50       Total Stops
     C                     MOVEL*BLANK    WN0218 20        Trailer Id
     C                     Z-ADD*ZERO     WN0219  40       BOL Time
     C                     MOVEL*BLANK    WN0220  3        Carrier Code
     C                     MOVEL*BLANK    WN0221  7        Truck Size
     C                     Z-ADD*ZERO     WN0222  70       Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WN0223 112       Rated Freight
     C                     MOVEL*BLANK    WN0224  1        Ship Status
     C                     MOVEL*BLANK    WN0225  1        Load Type
     C                     Z-ADD*ZERO     WN0226  50       Number Pallets
     C                     Z-ADD*ZERO     WN0227  50       Number Pallets
     C                     Z-ADD*ZERO     WN0228 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0229  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0230  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0231  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0232 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0233 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0234  70       Actual Departur
     C                     Z-ADD*ZERO     WN0235  40       Departure Time
     C                     Z-ADD*ZERO     WN0236  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0237  52       Product Tempera
     C                     Z-ADD*ZERO     WN0238  50       Number Spacers
     C                     MOVEL*BLANK    WN0239 12        Car_Veh. Initia
     C                     Z-ADD*ZERO     WN0240  70       Total Load Mile
     C                     MOVEL*BLANK    WN0241 12        Recorder ID
     C                     MOVEL*BLANK    WN0242  2        Shipping Method
     C                     MOVEL*BLANK    WN0243  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0244  2        Ship To State C
     C                     Z-ADD*ZERO     WN0245  70       Gross Weight
     C                     MOVEL*BLANK    WN0246  3        Carrier Broker
     C                     MOVEL*BLANK    WN0247  1        Export Status
     C                     Z-ADD*ZERO     WN0248  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0249  1        On Time (Y_N)
     C                     Z-ADD*ZERO     WN0250  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0251  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0252  70       Spotted Date
     C                     Z-ADD*ZERO     WN0253  60       Spotted Time
     C                     Z-ADD*ZERO     WN0254  70       Load Finished D
     C                     Z-ADD*ZERO     WN0255  60       Load Finished T
     C                     Z-ADD*ZERO     WN0256  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0257  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0258  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0259  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0260  70       Truck Departure
     C                     Z-ADD*ZERO     WN0261  60       Truck Departure
     C                     Z-ADD*ZERO     WN0262  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0263  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0264  3        Shipping Line
     C                     MOVEL*BLANK    WN0265 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0266 30        Vessel Name
     C                     Z-ADD*ZERO     WN0267  50       Voyage
     C                     Z-ADD*ZERO     WN0268  70       Sail Date
     C                     MOVEL*BLANK    WN0269 12        Booking Number
     C                     MOVEL*BLANK    WN0270 20        Discharge Port
     C                     Z-ADD*ZERO     WN0271  70       Arrival Date
     C                     MOVEL*BLANK    WN0272 12        Container Numbe
     C                     Z-ADD*ZERO     WN0273  70       Date In
     C                     Z-ADD*ZERO     WN0274  60       Time In
     C                     Z-ADD*ZERO     WN0275  70       Date Out
     C                     Z-ADD*ZERO     WN0276  60       Time Out
     C                     Z-ADD*ZERO     WN0277 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0278  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0279  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0280  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0281  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0282  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0283  70       Requested Deliv
     C                     MOVEL*BLANK    WN0284  1        Load Acceptance
     C                     MOVEL*BLANK    WN0285  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0286  70       On Yard Date
     C                     Z-ADD*ZERO     WN0287  60       On Yard Time
     C                     Z-ADD*ZERO     WN0288  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0289  60       Deadline Depart
     C                     MOVEL*BLANK    WN0290  1        Load Held Over
     C                     MOVEL*BLANK    WN0291  1        Load Held Over
     C                     MOVEL*BLANK    WN0292 15        Load Held Over
     C                     MOVEL*BLANK    WN0293 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0294 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0295  70       Express Mail Da
     C                     MOVEL*BLANK    WN0296  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0297  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0298  70       Product Complet
     C                     Z-ADD*ZERO     WN0299  60       Product Complet
     C                     Z-ADD*ZERO     WN0300  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0301  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0302  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0303  1        Load Confirmed
     C                     MOVEL*BLANK    WN0304 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0305  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0306  60       Load Door 1
     C                     Z-ADD*ZERO     WN0307  70       Override Total
     C                     Z-ADD*ZERO     WN0308  60       Load Door 2
     C                     MOVEL*BLANK    WN0309  1        Partial Load
     C                     MOVEL*BLANK    WN0310  1        Load Confirmati
     C                     MOVEL*BLANK    WN0311  1        Export Load USD
     C                     MOVEL*BLANK    WN0312  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0313 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0314 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0315 15        Late Billing Em
     C                     MOVEL*BLANK    WN0316 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0317 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0318  1        Multi Company L
     C                     MOVEL*BLANK    WN0319  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0320  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0321  1        LH Power Only L
     C                     MOVEL*BLANK    WN0322  1        MG Created Load
     C                     MOVEL*BLANK    WN0323  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0324  2        Load U_M
     C                     MOVEL*BLANK    WN0325  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0326  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0327  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0328  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0329  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0330  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0331  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0332  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0333  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0334  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0335  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0336  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0337  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0338  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0339  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0340  60       LH Unused Time
     C                     MOVEL*BLANK    WN0341  1        EDI Status 1
     C                     MOVEL*BLANK    WN0342  1        EDI Status 2
     C                     MOVEL*BLANK    WN0343  1        EDI Status 3
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWL0339    WDRMNB           Load ID
      *
     C           KLCHSO    KLIST
     C                     KFLD           WDRMNB           Load ID
     C           KLCHSO    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C           W0RTN     IFNE *BLANK                     IF
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     ENDIF
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YCRDCS
      * Move non-key fields to @FJCPBO
     C                     MOVELWL0340    WDDYTX    P      Transloader Car
     C                     Z-ADDWL0341    WDAATM           Job Time
     C                     MOVELWL0342    WDAYNA    P      User Id
     C                     MOVELWL0343    WDA0NA    P      Job Name
     C                     Z-ADDWL0344    WDAXDT           Job Date
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##JOB     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Port of Unlading  RT - Country Port of Unlading  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0256           CBP Foreign Por
     C                     MOVEL*BLANK    YL0242           Record Status
      * Declare restrictor key work fields
     C           *LIKE     DEFN CRKXCD    WQSP01           Country Code
     C           *LIKE     DEFN CRBVAB    WQSP02           Port of Unladin
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           Country Code
     C                     KFLD           WQSP02           Port of Unladin
      * Setup key
     C                     MOVELYL0206    WQSP01           Country Code
     C                     MOVEL#1HCAA    WQSP02           Port of Unladin
      * Establish starting position
     C           KRSSP     SETLL@CRRELE                    *
     C           KRSSP     READE@CRRELE                  90*
      * Data record not found
     C   90                MOVEL'USR5273' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDCRHFNZ    YL0256           CBP Foreign Por
     C                     MOVELCRVSST    YL0242           Record Status
     C           KRSSP     READE@CRRELE                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADD#1AIC3    ABAIC3           Company Number
      * Establish starting position
     C           KRSSQ     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DSQTX           Name
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    #DSQTX           Name
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv Trailer            RT - Trailer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           LYBZNA           Carrier Code
     C                     KFLD           LYDXTX           Trailer Id
      * Setup key
     C                     MOVELWL0345    LYBZNA           Carrier Code
     C                     MOVELWL0346    LYDXTX           Trailer Id
      * Establish starting position
     C           KRSSR     CHAIN@LYRER3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2598' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0347           Company Number
     C                     MOVEL*BLANK    WL0348           Load Type
     C                     MOVEL*BLANK    WL0349           Trailer Type
     C                     MOVEL*BLANK    WL0350           Seaboard Owned
     C                     MOVEL*BLANK    WL0351           On Yard Status
     C                     Z-ADD*ZERO     WL0352           On Yard Date
     C                     Z-ADD*ZERO     WL0353           On Yard Time
     C                     MOVEL*BLANK    WL0354           Assigned Status
     C                     MOVEL*BLANK    WL0355           Available Statu
     C                     MOVEL*BLANK    WL0356           Not Available R
     C                     MOVEL*BLANK    WL0357           Comment Line
     C                     MOVEL*BLANK    WL0358           Record Status
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDLYAIC3    WL0347           Company Number
     C                     MOVELLYVDST    WL0348           Load Type
     C                     MOVELLYX3ST    WL0349           Trailer Type
     C                     MOVELLYXGST    WL0350           Seaboard Owned
     C                     MOVELLYSTOY    WL0351           On Yard Status
     C                     Z-ADDLYKKDT    WL0352           On Yard Date
     C                     Z-ADDLYAVTM    WL0353           On Yard Time
     C                     MOVELLYSTAS    WL0354           Assigned Status
     C                     MOVELLYXRST    WL0355           Available Statu
     C                     MOVELLYX7CD    WL0356           Not Available R
     C                     MOVELLYGXTX    WL0357           Comment Line
     C                     MOVELLYVSST    WL0358           Record Status
     C                     GOTO SREXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * VAL Container assgnmt RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WECNTN    WQSS01           Container Numbe
      * Define keylist
     C           KPSSS     KLIST
     C                     KFLD           WQSS01           Container Numbe
     C                     KFLD           WERMNB           Load ID
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           Container Numbe
      * Setup key
     C                     MOVEL#1J2T1    WQSS01           Container Numbe
     C                     Z-ADD*ZERO     WERMNB           Load ID
      * Establish starting position
     C           KPSSS     SETLL@FJCPNL                    *
     C           KRSSS     READE@FJCPNL                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'TRLRAVL' W0RTN            *Return code
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Load ID NE PAR.Load ID
     C           WERMNB    IFNE *ZERO                      *IF
      * CASE: DB1.Load Status is Prior to Shipped
     C           WEPKST    IFEQ 'C'                        *IF
     C           WEPKST    OREQ 'E'
     C           WEPKST    OREQ 'L'
     C           WEPKST    OREQ 'U'
     C                     MOVEL'TRLRASN' W0RTN            *Return code
      * PAR.USR Load ID = DB1.Load ID
     C                     Z-ADDWERMNB    YL0274           USR Load ID
     C                     GOTO SSEXIT                     *QUIT
     C                     ELSE
      * CASE: DB1.Load Status is Shipped or Invoiced
     C           WEPKST    IFEQ 'I'                        *IF
     C           WEPKST    OREQ 'S'
     C                     MOVEL'TRLRAVL' W0RTN            *Return code
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSS     READE@FJCPNL                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Val Ord Same Booking# RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       YL0279           Same Booking# U
     C                     Z-ADD*ZERO     YL0280           Same Booking# C
     C                     Z-ADD*ZERO     YL0281           Not Same Bookin
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFRMNB    WQST02           Load ID
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQST02           Load ID
      * Establish starting position
     C           KRSST     SETLL@BFCPMC                    *
     C           KRSST     READE@BFCPMC                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Booking#/Type Code2RT - Order Header Extension  * 
     C                     EXSR SURVGN
      * CASE: LCL.OHE Override Type Code is ES
     C           YL0283    IFEQ 'ES'                       *IF
      * CASE: PAR.OHE Booking Number EQ LCL.OHE Booking Number
     C           #1J1T1    IFEQ YL0282                     *IF
     C                     ADD  1         YL0280           Same Booking# C
     C                     MOVEL'Y'       YL0279           Same Booking# U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         YL0281           Not Same Bookin
     C                     MOVEL'N'       YL0279           Same Booking# U
     C                     END                             *FI
     C                     END                             *FI
     C           KRSST     READE@BFCPMC                  90*
     C                     ENDDO
      * USER: Exit processing
      * If Only 1 Not Same Booking # Then Mark as Same Booking #.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Not Same Booking# Count U is 1
      *   |- c2    : LCL.Same Booking# Count U is GE 1
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0281    IFEQ 1                          *IF
     C           YL0280    IFGE 1                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0279           Same Booking# U
     C                     END                             *FI
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * RTV Booking#/Type Code2RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0282           OHE Booking Num
     C                     MOVEL*BLANK    YL0283           OHE Override Ty
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAIC3    WQSU01           Company Number
     C           *LIKE     DEFN WGC4NB    WQSU02           Order Number
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WQSU01           Company Number
     C                     KFLD           WQSU02           Order Number
      * Setup key
     C                     Z-ADDWFAIC3    WQSU01           Company Number
     C                     Z-ADDWFC4NB    WQSU02           Order Number
      * Establish starting position
     C           KRSSU     SETLL@AMREIX                    *
     C           KRSSU     READE@AMREIX                  90*
      * Data record not found
     C   90                MOVEL'USR3697' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGJ1T1    YL0282           OHE Booking Num
     C                     MOVELWGCHTX    YL0283           OHE Override Ty
     C           KRSSU     READE@AMREIX                  90*
     C                     ENDDO
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * RTV Record Status     RT - EDI Interchange  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0242           Record Status
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           GNM4AA           Interchange Cod
      * Setup key
     C                     MOVEL'SHPEXP'  GNM4AA           Interchange Cod
      * Establish starting position
     C           KRSSV     CHAIN@GNREHW              90    *
      * Data record not found
     C   90                MOVEL'USR4367' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELGNVSST    YL0242           Record Status
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Rtv CBP Info f/EDI 601 RT - Shipping Line/Port Extsn  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0284           CBP Export Port
     C                     MOVEL*BLANK    YL0285           CBP Std Carrier
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           C1XACD           Shipping Line
     C                     KFLD           C1OANA           Port Delv Termi
      * Setup key
     C                     MOVEL#1XACD    C1XACD           Shipping Line
     C                     MOVEL#1OANA    C1OANA           Port Delv Termi
      * Establish starting position
     C           KRSSW     CHAIN@C1REL2              90    *
      * Data record not found
     C   90                MOVEL'USR5297' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDC1B1AB    YL0284           CBP Export Port
     C                     MOVELC1BYAB    YL0285           CBP Std Carrier
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXCRRC    BEGSR
      *================================================================
      * CRT OHE for Exp Instr2 CR - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AMREJE
     C                     Z-ADDWL0359    AMAIC3           Company Number
     C                     Z-ADDWL0360    AMC4NB           Order Number
     C                     Z-ADDWL0361    AMRMNB           Load ID
     C                     Z-ADDWL0362    AMRUNB           Stop_Drop Seque
     C                     MOVELWL0363    AMXACD           Shipping Line
     C                     MOVELWL0364    AMOANA           Port Delv Termi
     C                     MOVELWL0365    AMHBAA           OHE City
     C                     MOVELWL0366    AMJ0T1           OHE Vessel_Airl
     C                     MOVELWL0367    AMGENY           OHE Voyage_Flig
     C                     MOVELWL0368    AMJ1T1           OHE Booking Num
     C                     MOVELWL0369    AMHCAA           OHE Discharge P
     C                     Z-ADDWL0370    AMQWDT           OHE Sail_Flight
     C                     Z-ADDWL0371    AMQXDT           OHE Port Cut Da
     C                     Z-ADDWL0372    AMQYDT           OHE Arrival Dat
     C                     MOVELWL0373    AMHDAA           OHE Late Delive
     C                     MOVELWL0374    AMCCTX           OHE Ship Status
     C                     MOVELWL0375    AMJ2T1           OHE Container N
     C                     MOVELWL0376    AMRLNA           OHE Comment 1
     C                     MOVELWL0377    AMRMNA           OHE Comment 2
     C                     Z-ADDWL0378    AMGINY           OHE Unused Numb
     C                     Z-ADDWL0379    AMGFNY           OHE Unused Numb
     C                     Z-ADDWL0380    AMGGNY           OHE Unused Numb
     C                     Z-ADDWL0381    AMGHNY           OHE Unused Numb
     C                     Z-ADDWL0382    AMHEVL           OHE HPB RIN Equ
     C                     Z-ADDWL0383    AMHFVL           OHE HPB RIN Pri
     C                     Z-ADDWL0384    AMHGVL           Transload Termi
     C                     Z-ADDWL0385    AMQZDT           OHE Est Arrv at
     C                     Z-ADDWL0386    AMQ0DT           OHE Backhaul ET
     C                     Z-ADDWL0387    AMQ1DT           OHE Port_Pier P
     C                     Z-ADDWL0388    AMQ2DT           OHE Actual Ship
     C                     MOVELWL0389    AMC2TX           OHE Carrier SCA
     C                     MOVELWL0390    AMC3TX           OHE Spot Buy
     C                     MOVELWL0391    AMC6TX           OHE PO ACK Flag
     C                     MOVELWL0392    AMCHTX           OHE Override Ty
     C                     MOVELWL0393    AMCITX           OHE Backhaul St
     C                     MOVELWL0394    AMCLTX           OHE Backhaul ET
     C                     MOVELWL0395    AMB4TX           OHE Load Haul T
     C                     MOVELWL0396    AMCUTX           OHE Backhaul Ca
     C                     MOVELWL0397    AMCVTX           OHE Bookings Co
     C                     MOVELWL0398    AMB9TX           OHE EDI Error R
     C                     MOVELWL0399    AMJWSC           OHE EDI Error R
     C                     Z-ADDWL0400    AMITNY           HPB COA Batch N
     C                     MOVELWL0401    AMLMT1           Delivery P.O. N
     C                     MOVELWL0402    AMLWAA           OHE Intended fo
     C                     MOVELWL0403    AMFVST           OHE EDI 943 Act
     C                     MOVELWL0404    AMF0ST           OHE EDI 944 Act
     C                     MOVELWL0405    AMF2ST           OHE EDI 940 Act
     C                     MOVELWL0406    AMF3ST           OHE EDI 945 Act
     C                     MOVELWL0407    AMJUSC           OHE EDI 856 Act
     C                     MOVELWL0408    AMJVSC           OHE EDI 824 Act
     C                     MOVELWL0409    AMV3T1           OHE Transload S
     C                     MOVELWL0410    AMV4T1           OHE Abs Rate Ov
     C                     MOVELWL0411    AMV5T1           OHE Appt Confir
     C                     MOVELWL0412    AMV6T1           OHE Backhaul Co
     C                     MOVELWL0413    AMV7T1           OHE Backhaul Ch
     C                     MOVELWL0414    AMV8T1           OHE Transload C
     C                     MOVELWL0415    AMV9T1           OHE Pier Pass I
     C                     MOVELWL0416    AMWAT1           OHE Carrier Nm
     C                     MOVELWL0417    AMWBT1           OHE Appt Confir
     C                     MOVELWL0418    AMWCT1           OHE Backhaul Co
     C                     MOVELWL0419    AMWDT1           Letter of Credi
     C                     Z-ADDWL0420    AMQJNY           OHE Backhaul Re
     C                     Z-ADDWL0421    AMQKNY           LD Stop_Drop
     C                     Z-ADDWL0422    AMQLNY           OHE Unused Numb
     C                     Z-ADDWL0423    AMP8NY           OHE Pier Pass F
     C                     Z-ADDWL0424    AMP9NY           OHE Port Check
     C                     Z-ADDWL0425    AMQANY           OHE Port Cut Ti
     C                     Z-ADDWL0426    AMQCNY           OHE Backhaul Tr
     C                     Z-ADDWL0427    AMQDNY           OHE Load Sched
     C                     Z-ADDWL0428    AMQENY           Original Appoin
     C                     Z-ADDWL0429    AMQFNY           Original Appoin
     C                     Z-ADDWL0430    AMQGNY           OHE PowerPro Lo
     C                     Z-ADDWL0431    AMQHNY           OHE PowerPro Lo
     C                     Z-ADDWL0432    AMQINY           OHE Unused Nume
     C                     Z-ADDWL0433    AMQMNY           OHE Orig ABS Fr
     C                     MOVELWL0434    AMMYU1           OHE Genset Numb
     C                     MOVELWL0435    AMJXSC           OHE Email BOL_S
     C                     MOVELWL0436    AMJYSC           OHE EDI Order A
     C                     MOVELWL0437    AMJZSC           OHE EDI 601 Act
     C                     MOVELWL0438    AMJ0SC           OHE Unused Stat
     C                     MOVELWL0439    AMMZU1           OHE Unused Text
     C                     MOVELWL0440    AMM0U1           OHE Unused Text
     C                     MOVELWL0441    AMM1U1           OHE Customer Ve
     C                     MOVELWL0442    AMM2U1           OHE EDI 824 AES
     C                     MOVELWL0443    AMM3U1           OHE Unused Text
     C                     Z-ADDWL0444    AMW5DT           OHE Unused Date
     C                     Z-ADDWL0445    AMW6DT           OHE Unused Date
     C                     MOVELWL0446    AMUVST           EDI Status 1
     C                     MOVELWL0447    AMUWST           EDI Status 2
     C                     MOVELWL0448    AMUXST           EDI Status 3
     C                     MOVELWL0449    AMVSST           Record Status
     C                     Z-ADDWL0450    AMAATM           Job Time
     C                     MOVELWL0451    AMAYNA           User Id
     C                     MOVELWL0452    AMA0NA           Job Name
     C                     Z-ADDWL0453    AMAXDT           Job Date
      *
      * USER: Processing before Data update
     C                     Z-ADD##JTM     AMAATM           Job Time
     C                     Z-ADD##JDT     AMAXDT           Job Date
     C                     MOVEL##PGM     AMA0NA           Job Name
     C                     MOVEL##USR     AMAYNA           User Id
     C           KLCRSX    KLIST
     C                     KFLD           AMAIC3           Company Number
     C                     KFLD           AMC4NB           Order Number
      * Check for duplicate primary key
     C           KLCRSX    SETLL@AMREJE                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3698' W0RTN   7
      * Send message 'Order Header Extension EX'
     C                     MOVEL'USR3698' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C                     WRITE@AMREJE                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * ** 05/19/16   RMC E4119  remove live with tpm check
      * CHG Transloader for ExpCH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDAMRMNB    WL0339           Load ID
     C                     MOVELWL0455    WL0340    P      Transloader Car
     C                     Z-ADDAMAATM    WL0341           Job Time
     C                     MOVELAMAYNA    WL0342    P      User Id
     C                     MOVELAMA0NA    WL0343    P      Job Name
     C                     Z-ADDAMAXDT    WL0344           Job Date
     C                     EXSR SOCHRC
      * ** Update Trailer ID with par.trailer id instead of container  E0
      * CHG Container for ExprtCH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDAMRMNB    WL0332           Load ID
     C                     MOVELWL0454    WL0333    P      Trailer Id
     C                     MOVELWL0375    WL0334    P      Container Numbe
     C                     Z-ADDAMAATM    WL0335           Job Time
     C                     MOVELAMAYNA    WL0336    P      User Id
     C                     MOVELAMA0NA    WL0337    P      Job Name
     C                     Z-ADDAMAXDT    WL0338           Job Date
     C                     EXSR SNCHRC
      * RTV Load All Fields    RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDAMRMNB    WL0021           Load ID
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0022    YL0286           Company Number
     C                     Z-ADDWL0023    YN0133           Scheduled Ship
     C                     MOVELWL0024    YN0134    P      LTL Flag
     C                     MOVELWL0025    YN0135    P      Load Status
     C                     Z-ADDWL0026    YN0136           Reefer Temperat
     C                     MOVELWL0027    YN0137    P      Seal 1
     C                     MOVELWL0028    YN0138    P      Seal 2
     C                     MOVELWL0029    YN0139    P      Seal 3
     C                     MOVELWL0030    YN0140    P      Seal 4
     C                     MOVELWL0031    YN0141    P      Seal 2 Unused
     C                     Z-ADDWL0032    YN0142           Total Load Orde
     C                     Z-ADDWL0033    YN0143           Flat Amount
     C                     MOVELWL0034    YN0144    P      Allocate Pounds
     C                     Z-ADDWL0035    YN0145           Total Stops
     C                     MOVELWL0036    YN0146    P      Trailer Id
     C                     MOVELWL0037    YN0147    P      Transloader Car
     C                     Z-ADDWL0038    YN0148           BOL Time
     C                     MOVELWL0039    YL0287    P      Carrier Code
     C                     MOVELWL0040    YN0149    P      Truck Size
     C                     Z-ADDWL0041    YN0150           Ld Hdr_Ld Dtl U
     C                     Z-ADDWL0042    YN0151           Rated Freight
     C                     MOVELWL0043    YN0152    P      Ship Status
     C                     MOVELWL0044    YL0288    P      Load Type
     C                     Z-ADDWL0045    YN0153           Number Pallets
     C                     Z-ADDWL0046    YN0154           Number Pallets
     C                     Z-ADDWL0047    YN0155           Load Carrier Pa
     C                     Z-ADDWL0048    YN0156           Estimated Arriv
     C                     Z-ADDWL0049    YN0157           Actual Arrival
     C                     Z-ADDWL0050    YN0158           Actual Arrival
     C                     Z-ADDWL0051    YN0159           Trailer IN Weig
     C                     Z-ADDWL0052    YN0160           Trailer OUT Wei
     C                     Z-ADDWL0053    YN0161           Actual Departur
     C                     Z-ADDWL0054    YN0162           Departure Time
     C                     Z-ADDWL0055    YN0163           Schedule Sequen
     C                     Z-ADDWL0056    YN0164           Product Tempera
     C                     Z-ADDWL0057    YN0165           Number Spacers
     C                     MOVELWL0058    YN0166    P      Car_Veh. Initia
     C                     Z-ADDWL0059    YN0167           Total Load Mile
     C                     MOVELWL0060    YN0168    P      Recorder ID
     C                     MOVELWL0061    YN0169    P      Shipping Method
     C                     MOVELWL0062    YN0170    P      Ship From Wareh
     C                     MOVELWL0063    YN0171    P      Ship To State C
     C                     Z-ADDWL0064    YN0172           Gross Weight
     C                     MOVELWL0065    YN0173    P      Carrier Broker
     C                     MOVELWL0066    YN0174    P      Export Status
     C                     Z-ADDWL0067    YN0175           Actual Ship Dat
     C                     MOVELWL0068    YN0176    P      On Time (Y_N)
     C                     Z-ADDWL0069    YN0177           Truck Ready Dat
     C                     Z-ADDWL0070    YN0178           Truck Ready Tim
     C                     Z-ADDWL0071    YN0179           Spotted Date
     C                     Z-ADDWL0072    YN0180           Spotted Time
     C                     Z-ADDWL0073    YN0181           Load Finished D
     C                     Z-ADDWL0074    YN0182           Load Finished T
     C                     Z-ADDWL0075    YN0183           BOL Complete Da
     C                     Z-ADDWL0076    YN0184           BOL Complete Ti
     C                     Z-ADDWL0077    YN0185           BOL Received Da
     C                     Z-ADDWL0078    YN0186           BOL Received Ti
     C                     Z-ADDWL0079    YN0187           Truck Departure
     C                     Z-ADDWL0080    YN0188           Truck Departure
     C                     Z-ADDWL0081    YN0189           Adjusted Depart
     C                     Z-ADDWL0082    YN0190           Adjusted Depart
     C                     MOVELWL0083    YL0289    P      Shipping Line
     C                     MOVELWL0084    YN0191    P      Port Delv Termi
     C                     MOVELWL0085    YN0192    P      Vessel Name
     C                     Z-ADDWL0086    YN0193           Voyage
     C                     Z-ADDWL0087    YN0194           Sail Date
     C                     MOVELWL0088    YN0195    P      Booking Number
     C                     MOVELWL0089    YN0196    P      Discharge Port
     C                     Z-ADDWL0090    YN0197           Arrival Date
     C                     MOVELWL0091    YN0198    P      Container Numbe
     C                     Z-ADDWL0092    YN0199           Date In
     C                     Z-ADDWL0093    YN0200           Time In
     C                     Z-ADDWL0094    YN0201           Date Out
     C                     Z-ADDWL0095    YN0202           Time Out
     C                     Z-ADDWL0096    YN0203           Load Total Frei
     C                     Z-ADDWL0097    YN0204           Scheduled Deliv
     C                     Z-ADDWL0098    YN0205           Scheduled Deliv
     C                     MOVELWL0099    YN0206    P      LH Unused Sts
     C                     MOVELWL0100    YN0207    P      LH Carrier Paym
     C                     Z-ADDWL0101    YN0208           Bring Back Mile
     C                     Z-ADDWL0102    YN0209           Requested Deliv
     C                     MOVELWL0103    YN0210    P      Load Acceptance
     C                     MOVELWL0104    YN0211    P      Warehouse Code
     C                     Z-ADDWL0105    YN0212           On Yard Date
     C                     Z-ADDWL0106    YN0213           On Yard Time
     C                     Z-ADDWL0107    YN0214           Deadline Depart
     C                     Z-ADDWL0108    YN0215           Deadline Depart
     C                     MOVELWL0109    YN0216    P      Load Held Over
     C                     MOVELWL0110    YN0217    P      Load Held Over
     C                     MOVELWL0111    YN0218    P      Load Held Over
     C                     MOVELWL0112    YN0219    P      Ocean BOL Numbe
     C                     MOVELWL0113    YN0220    P      Express Mail Nu
     C                     Z-ADDWL0114    YN0221           Express Mail Da
     C                     MOVELWL0115    YN0222    P      Load Shag Flag
     C                     MOVELWL0116    YN0223    P      Load Wash Flag
     C                     Z-ADDWL0117    YN0224           Product Complet
     C                     Z-ADDWL0118    YN0225           Product Complet
     C                     Z-ADDWL0119    YN0226           Pallets Loaded
     C                     Z-ADDWL0120    YN0227           Avg Pallet Tare
     C                     Z-ADDWL0121    YN0228           Tot Pallet Tare
     C                     MOVELWL0122    YN0229    P      Load Confirmed
     C                     MOVELWL0123    YN0230    P      Load Confirmed
     C                     Z-ADDWL0124    YN0231           Load Confirmati
     C                     Z-ADDWL0125    YN0232           Load Door 1
     C                     Z-ADDWL0126    YN0233           Override Total
     C                     Z-ADDWL0127    YN0234           Load Door 2
     C                     MOVELWL0128    YN0235    P      Partial Load
     C                     MOVELWL0129    YN0236    P      Load Confirmati
     C                     MOVELWL0130    YN0237    P      Export Load USD
     C                     MOVELWL0131    YN0238    P      Late Delivery E
     C                     Z-ADDWL0132    YN0239           Load Actual Fre
     C                     MOVELWL0133    YN0240    P      Hide on WW Load
     C                     MOVELWL0134    YN0241    P      Late Billing Em
     C                     MOVELWL0135    YN0242    P      Shipping Temp C
     C                     MOVELWL0136    YN0243    P      LH Held Over Rs
     C                     MOVELWL0137    YN0244    P      Multi Company L
     C                     MOVELWL0138    YN0245    P      Fax Sent to SSI
     C                     MOVELWL0139    YN0246    P      Schedule Pos Lo
     C                     MOVELWL0140    YN0247    P      LH Power Only L
     C                     MOVELWL0141    YN0248    P      MG Created Load
     C                     MOVELWL0142    YN0249    P      LH Unused Sts 5
     C                     MOVELWL0143    YN0250    P      Load U_M
     C                     MOVELWL0144    YN0251    P      TPM Shipment St
     C                     MOVELWL0145    YN0252    P      LH Unused Sts 8
     C                     MOVELWL0146    YN0253    P      LH On-Time Reas
     C                     MOVELWL0147    YN0254    P      LH Held Over Re
     C                     Z-ADDWL0148    YN0255           LH Carrier Paid
     C                     Z-ADDWL0149    YN0256           LH Carrier Paid
     C                     Z-ADDWL0150    YN0257           LH Last Combo P
     C                     Z-ADDWL0151    YN0258           LH Last Combo P
     C                     Z-ADDWL0152    YN0259           LPT Load Plan S
     C                     Z-ADDWL0153    YN0260           LPT Load Plan S
     C                     Z-ADDWL0154    YN0261           TPM Planned Shi
     C                     Z-ADDWL0155    YN0262           LH Unused Time
     C                     Z-ADDWL0156    YN0263           LH Unused Date
     C                     Z-ADDWL0157    YN0264           LH Unused Time
     C                     Z-ADDWL0158    YN0265           LH Unused Date
     C                     Z-ADDWL0159    YN0266           LH Unused Time
     C                     MOVELWL0160    YN0267    P      EDI Status 1
     C                     MOVELWL0161    YN0268    P      EDI Status 2
     C                     MOVELWL0162    YN0269    P      EDI Status 3
      * Rtv Trailer            RT - Trailer  * by shipline
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0289    WL0345    P      Carrier Code
     C                     MOVELWL0375    WL0346    P      Trailer Id
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0347    YL0286           Company Number
     C                     MOVELWL0348    YL0288    P      Load Type
     C                     MOVELWL0349    YL0290    P      Trailer Type
     C                     MOVELWL0350    YL0291    P      Seaboard Owned
     C                     MOVELWL0351    YL0292    P      On Yard Status
     C                     Z-ADDWL0352    YL0293           On Yard Date
     C                     Z-ADDWL0353    YL0294           On Yard Time
     C                     MOVELWL0354    YL0295    P      Assigned Status
     C                     MOVELWL0355    YL0296    P      Available Statu
     C                     MOVELWL0356    YL0297    P      Not Available R
     C                     MOVELWL0357    YL0298    P      Comment Line
     C                     MOVELWL0358    YL0299    P      Record Status
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * CHG Asgn, Avail, On Yd CH - Trailer  * 
     C                     EXSR SYCHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Crt PD Trailer         CR - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0289    WL0463    P      Carrier Code
     C                     MOVELWL0375    WL0464    P      Trailer Id
     C                     Z-ADDYL0286    WL0465           Company Number
     C                     MOVELYL0288    WL0466    P      Load Type
     C                     MOVELYL0290    WL0467    P      Trailer Type
     C                     MOVELYL0291    WL0468    P      Seaboard Owned
     C                     MOVEL'N'       WL0469    P      On Yard Status
     C                     Z-ADD*ZERO     WL0470           On Yard Date
     C                     Z-ADD*ZERO     WL0471           On Yard Time
     C                     MOVEL'Y'       WL0472    P      Assigned Status
     C                     MOVEL'N'       WL0473    P      Available Statu
     C                     MOVEL*BLANK    WL0474           Not Available R
     C                     MOVEL*BLANK    WL0475           Comment Line
     C                     MOVELYL0300    WL0476    P      Status Unused 1
     C                     MOVELYL0301    WL0477    P      Status Unused 2
     C                     MOVELYL0302    WL0478    P      Status Unused 3
     C                     MOVELYL0303    WL0479    P      Status Unused 4
     C                     MOVELYL0304    WL0480    P      Status Unused 5
     C                     Z-ADD*ZERO     WL0481           Date Unused 1
     C                     Z-ADD*ZERO     WL0482           Date Unused 2
     C                     Z-ADD*ZERO     WL0483           Date Unused 3
     C                     Z-ADD*ZERO     WL0484           Date Unused 4
     C                     Z-ADD*ZERO     WL0485           Date Unused 5
     C                     MOVELAMUVST    WL0486    P      EDI Status 1
     C                     MOVELAMUWST    WL0487    P      EDI Status 2
     C                     MOVELAMUXST    WL0488    P      EDI Status 3
     C                     MOVELAMVSST    WL0489    P      Record Status
     C                     Z-ADDAMAATM    WL0490           Job Time
     C                     MOVELAMAYNA    WL0491    P      User Id
     C                     MOVELAMA0NA    WL0492    P      Job Name
     C                     Z-ADDAMAXDT    WL0493           Job Date
     C                     EXSR SZCRRC
     C                     END                             *FI
      * DO4595 DN 11/29/22-Create EDI 601 Data Sets.
      * CASE:
      *  - c1 AND c2 AND c3 AND c4 AND c5 AND c6 AND c7 AND c8 AND c9
      *  -  AND c10 AND c11 AND NOTc12
      *   |- c1    : PAR.Orders have Same Booking# is Not No
      *   |- c2    : PAR.EDI Interchange Active U is Yes
      *   |- c3    : DB1.OHE City is Entered
      *   |- c4    : DB1.OHE Discharge Port/Airprt is Not Blank
      *   |- c5    : DB1.OHE Sail/Flight Date is not equal zero
      *   |- c6    : DB1.Shipping Line is entered
      *   |- c7    : DB1.OHE Vessel/Airline is Not Blank
      *   |- c8    : DB1.OHE Booking Number is Entered
      *   |- c9    : DB1.OHE Override Type Code is ES
      *   |- c10   : DB1.Port Delv Terminal is Entered
      *   |- c11   : PAR.CBP Std Carrier Alpha Cde is Entered
      *   |- c12   : DB1.OHE EDI 824 AES ITN # is All 9s
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0456    IFEQ *BLANK                     *IF
     C           WL0456    OREQ 'Y'
     C           WL0457    IFEQ 'Y'                        *IF
     C           AMHBAA    IFNE *BLANK                     *IF
     C           AMHCAA    IFNE *BLANK                     *IF
     C           AMQWDT    IFNE 0                          *IF
     C           AMXACD    IFNE *BLANK                     *IF
     C           AMJ0T1    IFNE *BLANK                     *IF
     C           AMJ1T1    IFNE *BLANK                     *IF
     C           AMCHTX    IFEQ 'ES'                       *IF
     C           AMOANA    IFNE *BLANK                     *IF
     C           WL0460    IFNE *BLANK                     *IF
     C           AMM2U1    IFEQ @CN,013                    *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ITN # would only be populated once EDI 824 is received.
      * Crt EDI 601 Exp Shp InfXF - EDI Export Shpmnt Inf HDR  * 
     C                     CALL 'PUXSXFR'              90  Crt EDI 601 Exp
     C                     PARM *BLANK    W0RTN   7
     C                     PARM AMC4NB    WQ0080  70       Order Number
     C                     PARM AMRMNB    WQ0081  70       Load ID
     C                     PARM AMXACD    WQ0082  3        Shipping Line
     C                     PARM AMOANA    WQ0083 20        Port Delv Termi
     C                     PARM AMJ0T1    WQ0084 30        OHE Vessel_Airl
     C                     PARM AMQWDT    WQ0085  70       OHE Sail_Flight
     C                     PARM AMM2U1    WQ0086 15        OHE EDI 824 AES
     C                     PARM WL0458    WQ0087  6        Country Code
     C                     PARM WL0459    WQ0088  50       CBP Export Port
     C                     PARM WL0460    WQ0089  4        CBP Std Carrier
     C                     PARM WL0461    WQ0090  50       CBP Foreign Por
     C                     PARM 'A'       WQ0091  1        Add/Change/Dele
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUXSXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYCHRC    BEGSR
      *================================================================
      * CHG Asgn, Avail, On Yd CH - Trailer  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0344  1        Load Type
     C                     MOVEL*BLANK    WN0345  1        Trailer Type
     C                     MOVEL*BLANK    WN0346  1        Seaboard Owned
     C                     MOVEL*BLANK    WN0347  3        Not Available R
     C                     MOVEL*BLANK    WN0348 30        Comment Line
     C                     MOVEL*BLANK    WN0349  1        Status Unused 1
     C                     MOVEL*BLANK    WN0350  1        Status Unused 2
     C                     MOVEL*BLANK    WN0351  1        Status Unused 3
     C                     MOVEL*BLANK    WN0352  1        Status Unused 4
     C                     MOVEL*BLANK    WN0353  1        Status Unused 5
     C                     Z-ADD*ZERO     WN0354  70       Date Unused 1
     C                     Z-ADD*ZERO     WN0355  70       Date Unused 2
     C                     Z-ADD*ZERO     WN0356  70       Date Unused 3
     C                     Z-ADD*ZERO     WN0357  70       Date Unused 4
     C                     Z-ADD*ZERO     WN0358  70       Date Unused 5
     C                     MOVEL*BLANK    WN0359  1        EDI Status 1
     C                     MOVEL*BLANK    WN0360  1        EDI Status 2
     C                     MOVEL*BLANK    WN0361  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0362  60       Job Time
     C                     MOVEL*BLANK    WN0363 10        User Id
     C                     MOVEL*BLANK    WN0364 10        Job Name
     C                     Z-ADD*ZERO     WN0365  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @LYRER2
     C                     MOVELYL0289    WHBZNA    P      Carrier Code
     C                     MOVELWL0375    WHDXTX    P      Trailer Id
      *
     C           KLCHSY    KLIST
     C                     KFLD           WHBZNA           Carrier Code
     C                     KFLD           WHDXTX           Trailer Id
     C           KLCHSY    CHAIN@LYRER2              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDLYREL0'MDACP
     C                     MOVEL'@LYRER2' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SYEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDLY1    YDRDCS
      * Move non-key fields to @LYRER2
     C                     Z-ADDYL0286    WHAIC3           Company Number
     C                     MOVELYL0292    WHSTOY    P      On Yard Status
     C                     Z-ADDYL0293    WHKKDT           On Yard Date
     C                     Z-ADDYL0294    WHAVTM           On Yard Time
     C                     MOVEL'Y'       WHSTAS    P      Assigned Status
     C                     MOVEL'N'       WHXRST    P      Available Statu
     C                     MOVELYL0299    WHVSST    P      Record Status
      *
      * Set PGM.*Record Data Changed flag
     C           QPDLY1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##PGM     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDLY1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@LYRER2                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDLYREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZCRRC    BEGSR
      *================================================================
      * Crt PD Trailer         CR - Trailer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @LYRER2
     C                     MOVELWL0463    WHBZNA           Carrier Code
     C                     MOVELWL0464    WHDXTX           Trailer Id
     C                     Z-ADDWL0465    WHAIC3           Company Number
     C                     MOVELWL0466    WHVDST           Load Type
     C                     MOVELWL0467    WHX3ST           Trailer Type
     C                     MOVELWL0468    WHXGST           Seaboard Owned
     C                     MOVELWL0469    WHSTOY           On Yard Status
     C                     Z-ADDWL0470    WHKKDT           On Yard Date
     C                     Z-ADDWL0471    WHAVTM           On Yard Time
     C                     MOVELWL0472    WHSTAS           Assigned Status
     C                     MOVELWL0473    WHXRST           Available Statu
     C                     MOVELWL0474    WHX7CD           Not Available R
     C                     MOVELWL0475    WHGXTX           Comment Line
     C                     MOVELWL0476    WHXTST           Status Unused 1
     C                     MOVELWL0477    WHXVST           Status Unused 2
     C                     MOVELWL0478    WHSTU3           Status Unused 3
     C                     MOVELWL0479    WHSTU4           Status Unused 4
     C                     MOVELWL0480    WHSTU5           Status Unused 5
     C                     Z-ADDWL0481    WHLCDT           Date Unused 1
     C                     Z-ADDWL0482    WHLDDT           Date Unused 2
     C                     Z-ADDWL0483    WHLEDT           Date Unused 3
     C                     Z-ADDWL0484    WHLFDT           Date Unused 4
     C                     Z-ADDWL0485    WHLGDT           Date Unused 5
     C                     MOVELWL0486    WHUVST           EDI Status 1
     C                     MOVELWL0487    WHUWST           EDI Status 2
     C                     MOVELWL0488    WHUXST           EDI Status 3
     C                     MOVELWL0489    WHVSST           Record Status
     C                     Z-ADDWL0490    WHAATM           Job Time
     C                     MOVELWL0491    WHAYNA           User Id
     C                     MOVELWL0492    WHA0NA           Job Name
     C                     Z-ADDWL0493    WHAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WHVSST           Record Status
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##PGM     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
     C           KLCRSZ    KLIST
     C                     KFLD           WHBZNA           Carrier Code
     C                     KFLD           WHDXTX           Trailer Id
      * Check for duplicate primary key
     C           KLCRSZ    SETLL@LYRER2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2599' W0RTN   7
      * Send message 'Trailer                EX'
     C                     MOVEL'USR2599' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C                     WRITE@LYRER2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TACHRC    BEGSR
      *================================================================
      * CHG OHE for Exp Instr2 CH - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
      * DO4595 DN 12/09/22-Initialize.
     C                     MOVEL'N'       YL0305           Create EDI 601
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @AMREJE
     C                     Z-ADD#1AIC3    AMAIC3           Company Number
     C                     Z-ADD#1C4NB    AMC4NB           Order Number
      *
     C           KLCHTA    KLIST
     C                     KFLD           AMAIC3           Company Number
     C                     KFLD           AMC4NB           Order Number
     C           KLCHTA    CHAIN@AMREJE              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * USER: Processing if Data record not found
      * CRT OHE for Exp Instr2 CR - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0359           Company Number
     C                     Z-ADD#1C4NB    WL0360           Order Number
     C                     Z-ADD#1RMNB    WL0361           Load ID
     C                     Z-ADD#1RUNB    WL0362           Stop_Drop Seque
     C                     MOVEL#1XACD    WL0363    P      Shipping Line
     C                     MOVEL#1OANA    WL0364    P      Port Delv Termi
     C                     MOVEL#1HBAA    WL0365    P      OHE City
     C                     MOVEL#1J0T1    WL0366    P      OHE Vessel_Airl
     C                     MOVEL#1GENY    WL0367    P      OHE Voyage_Flig
     C                     MOVEL#1J1T1    WL0368    P      OHE Booking Num
     C                     MOVEL#1HCAA    WL0369    P      OHE Discharge P
     C                     Z-ADD#1QWDT    WL0370           OHE Sail_Flight
     C                     Z-ADD#1QXDT    WL0371           OHE Port Cut Da
     C                     Z-ADD#1QYDT    WL0372           OHE Arrival Dat
     C                     MOVEL#1HDAA    WL0373    P      OHE Late Delive
     C                     MOVEL#1CCTX    WL0374    P      OHE Ship Status
     C                     MOVEL#1J2T1    WL0375    P      OHE Container N
     C                     MOVEL#1RLNA    WL0376    P      OHE Comment 1
     C                     MOVEL#1RMNA    WL0377    P      OHE Comment 2
     C                     Z-ADD#1GINY    WL0378           OHE Unused Numb
     C                     Z-ADD#1GFNY    WL0379           OHE Unused Numb
     C                     Z-ADD#1GGNY    WL0380           OHE Unused Numb
     C                     Z-ADD#1GHNY    WL0381           OHE Unused Numb
     C                     Z-ADD#1HEVL    WL0382           OHE HPB RIN Equ
     C                     Z-ADD#1HFVL    WL0383           OHE HPB RIN Pri
     C                     Z-ADD#1HGVL    WL0384           Transload Termi
     C                     Z-ADD#1QZDT    WL0385           OHE Est Arrv at
     C                     Z-ADD#1Q0DT    WL0386           OHE Backhaul ET
     C                     Z-ADD#1Q1DT    WL0387           OHE Port_Pier P
     C                     Z-ADD#DF9DT    WL0388           OHE Actual Ship
     C                     MOVEL#1C2TX    WL0389    P      OHE Carrier SCA
     C                     MOVEL#1C3TX    WL0390    P      OHE Spot Buy
     C                     MOVEL#1C6TX    WL0391    P      OHE PO ACK Flag
     C                     MOVEL#1CHTX    WL0392    P      OHE Override Ty
     C                     MOVEL#1CITX    WL0393    P      OHE Backhaul St
     C                     MOVEL#1CLTX    WL0394    P      OHE Backhaul ET
     C                     MOVEL#1B4TX    WL0395    P      OHE Load Haul T
     C                     MOVEL#1CUTX    WL0396    P      OHE Backhaul Ca
     C                     MOVEL#1CVTX    WL0397    P      OHE Bookings Co
     C                     MOVEL#1B9TX    WL0398    P      OHE EDI Error R
     C                     MOVEL#1JWSC    WL0399    P      OHE EDI Error R
     C                     Z-ADD#1ITNY    WL0400           HPB COA Batch N
     C                     MOVEL#1LMT1    WL0401    P      Delivery P.O. N
     C                     MOVEL#1LWAA    WL0402    P      OHE Intended fo
     C                     MOVEL#1FVST    WL0403    P      OHE EDI 943 Act
     C                     MOVEL#1F0ST    WL0404    P      OHE EDI 944 Act
     C                     MOVEL#1F2ST    WL0405    P      OHE EDI 940 Act
     C                     MOVEL#1F3ST    WL0406    P      OHE EDI 945 Act
     C                     MOVEL#1JUSC    WL0407    P      OHE EDI 856 Act
     C                     MOVEL#1JVSC    WL0408    P      OHE EDI 824 Act
     C                     MOVEL#1V3T1    WL0409    P      OHE Transload S
     C                     MOVEL#1V4T1    WL0410    P      OHE Abs Rate Ov
     C                     MOVEL#1V5T1    WL0411    P      OHE Appt Confir
     C                     MOVEL#1V6T1    WL0412    P      OHE Backhaul Co
     C                     MOVEL#1V7T1    WL0413    P      OHE Backhaul Ch
     C                     MOVEL#1V8T1    WL0414    P      OHE Transload C
     C                     MOVEL#1V9T1    WL0415    P      OHE Pier Pass I
     C                     MOVEL#1WAT1    WL0416    P      OHE Carrier Nm
     C                     MOVEL#1WBT1    WL0417    P      OHE Appt Confir
     C                     MOVEL#1WCT1    WL0418    P      OHE Backhaul Co
     C                     MOVEL#DAKU1    WL0419    P      Letter of Credi
     C                     Z-ADD#1QJNY    WL0420           OHE Backhaul Re
     C                     Z-ADD#1QKNY    WL0421           LD Stop_Drop
     C                     Z-ADD#1QLNY    WL0422           OHE Unused Numb
     C                     Z-ADD#1P8NY    WL0423           OHE Pier Pass F
     C                     Z-ADD#1P9NY    WL0424           OHE Port Check
     C                     Z-ADD#DT4TM    WL0425           OHE Port Cut Ti
     C                     Z-ADD#1QCNY    WL0426           OHE Backhaul Tr
     C                     Z-ADD#1QDNY    WL0427           OHE Load Sched
     C                     Z-ADD#1QENY    WL0428           Original Appoin
     C                     Z-ADD#1QFNY    WL0429           Original Appoin
     C                     Z-ADD#1QGNY    WL0430           OHE PowerPro Lo
     C                     Z-ADD#1QHNY    WL0431           OHE PowerPro Lo
     C                     Z-ADD#1QINY    WL0432           OHE Unused Nume
     C                     Z-ADD#1QMNY    WL0433           OHE Orig ABS Fr
     C                     MOVEL#1MYU1    WL0434    P      OHE Genset Numb
     C                     MOVEL#1JXSC    WL0435    P      OHE Email BOL_S
     C                     MOVEL#1JYSC    WL0436    P      OHE EDI Order A
     C                     MOVEL#1JZSC    WL0437    P      OHE EDI 601 Act
     C                     MOVEL#1J0SC    WL0438    P      OHE Unused Stat
     C                     MOVEL#1MZU1    WL0439    P      OHE Unused Text
     C                     MOVEL#1M0U1    WL0440    P      OHE Unused Text
     C                     MOVEL#1M1U1    WL0441    P      OHE Customer Ve
     C                     MOVEL#1M2U1    WL0442    P      OHE EDI 824 AES
     C                     MOVEL#1M3U1    WL0443    P      OHE Unused Text
     C                     Z-ADD#1W5DT    WL0444           OHE Unused Date
     C                     Z-ADD#1W6DT    WL0445           OHE Unused Date
     C                     MOVEL#1UVST    WL0446    P      EDI Status 1
     C                     MOVEL#1UWST    WL0447    P      EDI Status 2
     C                     MOVEL#1UXST    WL0448    P      EDI Status 3
     C                     MOVEL#1VSST    WL0449    P      Record Status
     C                     Z-ADD#1AATM    WL0450           Job Time
     C                     MOVEL#1AYNA    WL0451    P      User Id
     C                     MOVEL#1A0NA    WL0452    P      Job Name
     C                     Z-ADD#1AXDT    WL0453           Job Date
     C                     MOVEL#DDXTX    WL0454    P      Trailer Id
     C                     MOVEL#DDYTX    WL0455    P      Transloader Car
     C                     MOVELYL0278    WL0456    P      Orders have Sam
     C                     MOVELYL0276    WL0457    P      EDI Interchange
     C                     MOVELYL0206    WL0458    P      Country Code
     C                     Z-ADDYL0284    WL0459           CBP Export Port
     C                     MOVELYL0285    WL0460    P      CBP Std Carrier
     C                     Z-ADDYL0256    WL0461           CBP Foreign Por
     C                     MOVEL#DWPST    WL0462    P      Warehouse Type
     C                     EXSR SXCRRC
     C           W0RTN     IFNE *BLANK                     IF
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PMAMREL0'MDACP
     C                     MOVEL'@AMREJE' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     ENDIF
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TAEXIT
     C                     ENDIF
      *
      * Check for changed record
     C           #1DBRC    IFNE @1DBRC                     IF
     C                     MOVEL'Y2U0007' W0RTN   7
      * Send message '*Update not accepted'
     C                     MOVEL'Y2U0007' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
      * Release record lock
     C                     UNLCKPMAMREL0               91  *
     C                     GOTO TAEXIT
     C                     ENDIF                           FI #1DBRC
      * Store record data for null update check
     C                     MOVE @1DBRC    YERDCS
      * USER: Processing after Data read
      * DO4595 DN 12/07/22-When Required Data Changes, Set Create EDI 601
      * CASE:
      *  - c1 AND c2 AND c9 AND c10 AND c12 AND NOTc13 AND (c3 OR c4 OR
      *  -  c5 OR c6 OR c7 OR c8 OR c11)
      *   |- c1    : PAR.Orders have Same Booking# is Not No
      *   |- c2    : PAR.EDI Interchange Active U is Yes
      *   |- c9    : PAR.OHE Override Type Code is ES
      *   |- c10   : PAR.Port Delv Terminal is Entered
      *   |- c12   : PAR.CBP Std Carrier Alpha Cde is Entered
      *   |- c13   : PAR.OHE EDI 824 AES ITN # is All 9s
      *   |- c3    : PAR.OHE City NE DB1.OHE City
      *   |- c4    : PAR.OHE Discharge Port/Airprt NE DB1.OHE Discharge P
      *   |- c5    : PAR.OHE Sail/Flight Date NE DB1.OHE Sail/Flight Date
      *   |- c6    : PAR.Shipping Line NE DB1.Shipping Line
      *   |- c7    : PAR.OHE Vessel/Airline NE DB1.OHE Vessel/Airline
      *   |- c8    : PAR.OHE Booking Number NE DB1.OHE Booking Number
      *   |- c11   : PAR.Port Delv Terminal NE DB1.Port Delv Terminal
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0278    IFEQ *BLANK                     *IF
     C           YL0278    OREQ 'Y'
     C           YL0276    IFEQ 'Y'                        *IF
     C           #1CHTX    IFEQ 'ES'                       *IF
     C           #1OANA    IFNE *BLANK                     *IF
     C           YL0285    IFNE *BLANK                     *IF
     C           #1M2U1    IFEQ @CN,013                    *IF
     C                     ELSE
     C                     MOVEL'0'       Y0CX02  1
     C           #1HBAA    IFNE AMHBAA                     *IF
     C           #1HCAA    ORNE AMHCAA                     *OR
     C           #1QWDT    ORNE AMQWDT                     *OR
     C           #1XACD    ORNE AMXACD                     *OR
     C           #1J0T1    ORNE AMJ0T1                     *OR
     C           #1J1T1    ORNE AMJ1T1                     *OR
     C           #1OANA    ORNE AMOANA                     *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0305           Create EDI 601
     C                     END                             *FI
      * Move non-key fields to @AMREJE
     C                     Z-ADD#1RMNB    AMRMNB           Load ID
     C                     Z-ADD#1RUNB    AMRUNB           Stop_Drop Seque
     C                     MOVEL#1XACD    AMXACD    P      Shipping Line
     C                     MOVEL#1OANA    AMOANA    P      Port Delv Termi
     C                     MOVEL#1HBAA    AMHBAA    P      OHE City
     C                     MOVEL#1J0T1    AMJ0T1    P      OHE Vessel_Airl
     C                     MOVEL#1GENY    AMGENY    P      OHE Voyage_Flig
     C                     MOVEL#1J1T1    AMJ1T1    P      OHE Booking Num
     C                     MOVEL#1HCAA    AMHCAA    P      OHE Discharge P
     C                     Z-ADD#1QWDT    AMQWDT           OHE Sail_Flight
     C                     Z-ADD#1QXDT    AMQXDT           OHE Port Cut Da
     C                     Z-ADD#1QYDT    AMQYDT           OHE Arrival Dat
     C                     MOVEL#1HDAA    AMHDAA    P      OHE Late Delive
     C                     MOVEL#1CCTX    AMCCTX    P      OHE Ship Status
     C                     MOVEL#1J2T1    AMJ2T1    P      OHE Container N
     C                     MOVEL#1RLNA    AMRLNA    P      OHE Comment 1
     C                     MOVEL#1RMNA    AMRMNA    P      OHE Comment 2
     C                     Z-ADD#1GINY    AMGINY           OHE Unused Numb
     C                     Z-ADD#1GFNY    AMGFNY           OHE Unused Numb
     C                     Z-ADD#1GGNY    AMGGNY           OHE Unused Numb
     C                     Z-ADD#1GHNY    AMGHNY           OHE Unused Numb
     C                     Z-ADD#1HEVL    AMHEVL           OHE HPB RIN Equ
     C                     Z-ADD#1HFVL    AMHFVL           OHE HPB RIN Pri
     C                     Z-ADD#1HGVL    AMHGVL           Transload Termi
     C                     Z-ADD#1QZDT    AMQZDT           OHE Est Arrv at
     C                     Z-ADD#1Q0DT    AMQ0DT           OHE Backhaul ET
     C                     Z-ADD#1Q1DT    AMQ1DT           OHE Port_Pier P
     C                     Z-ADD#DF9DT    AMQ2DT           OHE Actual Ship
     C                     MOVEL#1C2TX    AMC2TX    P      OHE Carrier SCA
     C                     MOVEL#1C3TX    AMC3TX    P      OHE Spot Buy
     C                     MOVEL#1C6TX    AMC6TX    P      OHE PO ACK Flag
     C                     MOVEL#1CHTX    AMCHTX    P      OHE Override Ty
     C                     MOVEL#1CITX    AMCITX    P      OHE Backhaul St
     C                     MOVEL#1CLTX    AMCLTX    P      OHE Backhaul ET
     C                     MOVEL#1B4TX    AMB4TX    P      OHE Load Haul T
     C                     MOVEL#1CUTX    AMCUTX    P      OHE Backhaul Ca
     C                     MOVEL#1CVTX    AMCVTX    P      OHE Bookings Co
     C                     MOVEL#1B9TX    AMB9TX    P      OHE EDI Error R
     C                     MOVEL#1JWSC    AMJWSC    P      OHE EDI Error R
     C                     Z-ADD#1ITNY    AMITNY           HPB COA Batch N
     C                     MOVEL#1LMT1    AMLMT1    P      Delivery P.O. N
     C                     MOVEL#1LWAA    AMLWAA    P      OHE Intended fo
     C                     MOVEL#1FVST    AMFVST    P      OHE EDI 943 Act
     C                     MOVEL#1F0ST    AMF0ST    P      OHE EDI 944 Act
     C                     MOVEL#1F2ST    AMF2ST    P      OHE EDI 940 Act
     C                     MOVEL#1F3ST    AMF3ST    P      OHE EDI 945 Act
     C                     MOVEL#1JUSC    AMJUSC    P      OHE EDI 856 Act
     C                     MOVEL#1JVSC    AMJVSC    P      OHE EDI 824 Act
     C                     MOVEL#1V3T1    AMV3T1    P      OHE Transload S
     C                     MOVEL#1V4T1    AMV4T1    P      OHE Abs Rate Ov
     C                     MOVEL#1V5T1    AMV5T1    P      OHE Appt Confir
     C                     MOVEL#1V6T1    AMV6T1    P      OHE Backhaul Co
     C                     MOVEL#1V7T1    AMV7T1    P      OHE Backhaul Ch
     C                     MOVEL#1V8T1    AMV8T1    P      OHE Transload C
     C                     MOVEL#1V9T1    AMV9T1    P      OHE Pier Pass I
     C                     MOVEL#1WAT1    AMWAT1    P      OHE Carrier Nm
     C                     MOVEL#1WBT1    AMWBT1    P      OHE Appt Confir
     C                     MOVEL#1WCT1    AMWCT1    P      OHE Backhaul Co
     C                     MOVEL#DAKU1    AMWDT1    P      Letter of Credi
     C                     Z-ADD#1QJNY    AMQJNY           OHE Backhaul Re
     C                     Z-ADD#1QKNY    AMQKNY           LD Stop_Drop
     C                     Z-ADD#1QLNY    AMQLNY           OHE Unused Numb
     C                     Z-ADD#1P8NY    AMP8NY           OHE Pier Pass F
     C                     Z-ADD#1P9NY    AMP9NY           OHE Port Check
     C                     Z-ADD#DT4TM    AMQANY           OHE Port Cut Ti
     C                     Z-ADD#1QCNY    AMQCNY           OHE Backhaul Tr
     C                     Z-ADD#1QDNY    AMQDNY           OHE Load Sched
     C                     Z-ADD#1QENY    AMQENY           Original Appoin
     C                     Z-ADD#1QFNY    AMQFNY           Original Appoin
     C                     Z-ADD#1QGNY    AMQGNY           OHE PowerPro Lo
     C                     Z-ADD#1QHNY    AMQHNY           OHE PowerPro Lo
     C                     Z-ADD#1QINY    AMQINY           OHE Unused Nume
     C                     Z-ADD#1QMNY    AMQMNY           OHE Orig ABS Fr
     C                     MOVEL#1MYU1    AMMYU1    P      OHE Genset Numb
     C                     MOVEL#1JXSC    AMJXSC    P      OHE Email BOL_S
     C                     MOVEL#1JYSC    AMJYSC    P      OHE EDI Order A
     C                     MOVEL#1JZSC    AMJZSC    P      OHE EDI 601 Act
     C                     MOVEL#1J0SC    AMJ0SC    P      OHE Unused Stat
     C                     MOVEL#1MZU1    AMMZU1    P      OHE Unused Text
     C                     MOVEL#1M0U1    AMM0U1    P      OHE Unused Text
     C                     MOVEL#1M1U1    AMM1U1    P      OHE Customer Ve
     C                     MOVEL#1M2U1    AMM2U1    P      OHE EDI 824 AES
     C                     MOVEL#1M3U1    AMM3U1    P      OHE Unused Text
     C                     Z-ADD#1W5DT    AMW5DT           OHE Unused Date
     C                     Z-ADD#1W6DT    AMW6DT           OHE Unused Date
     C                     MOVEL#1UVST    AMUVST    P      EDI Status 1
     C                     MOVEL#1UWST    AMUWST    P      EDI Status 2
     C                     MOVEL#1UXST    AMUXST    P      EDI Status 3
     C                     MOVEL#1VSST    AMVSST    P      Record Status
     C                     Z-ADD#1AATM    AMAATM           Job Time
     C                     MOVEL#1AYNA    AMAYNA    P      User Id
     C                     MOVEL#1A0NA    AMA0NA    P      Job Name
     C                     Z-ADD#1AXDT    AMAXDT           Job Date
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     AMAATM           Job Time
     C                     Z-ADD##JDT     AMAXDT           Job Date
     C                     MOVEL##PGM     AMA0NA           Job Name
     C                     MOVEL##USR     AMAYNA           User Id
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@AMREJE                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPMAMREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * Update saved record image
     C                     MOVEL@1DBRC    #1DBRC
      * DBF change successful
      * USER: Processing after Data update
      * ** 05/19/16   RMC E4119  remove live with tpm check
      * CHG Transloader for ExpCH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0339           Load ID
     C                     MOVEL#DDYTX    WL0340    P      Transloader Car
     C                     Z-ADDAMAATM    WL0341           Job Time
     C                     MOVELAMAYNA    WL0342    P      User Id
     C                     MOVELAMA0NA    WL0343    P      Job Name
     C                     Z-ADDAMAXDT    WL0344           Job Date
     C                     EXSR SOCHRC
      * should not happen from here but don't make an error
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     END                             *FI
      * ** Update trailer w/par.trailer id not container   E004008
      * CHG Container for ExprtCH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0332           Load ID
     C                     MOVEL#DDXTX    WL0333    P      Trailer Id
     C                     MOVEL#1J2T1    WL0334    P      Container Numbe
     C                     Z-ADDAMAATM    WL0335           Job Time
     C                     MOVELAMAYNA    WL0336    P      User Id
     C                     MOVELAMA0NA    WL0337    P      Job Name
     C                     Z-ADDAMAXDT    WL0338           Job Date
     C                     EXSR SNCHRC
      * should not happen from here but don't make an error
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     END                             *FI
      * Only update/add container if Container & ShipLine are entered  E0
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Shipping Line is entered
      *   |- c2    : PAR.OHE Container Number is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1XACD    IFNE *BLANK                     *IF
     C           #1J2T1    IFNE *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * * Update Trailer file for newly assigned Container    E004079
      * Rtv Trailer            RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1XACD    WL0345    P      Carrier Code
     C                     MOVEL#1J2T1    WL0346    P      Trailer Id
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0347    YL0306           Company Number
     C                     MOVELWL0348    YL0307    P      Load Type
     C                     MOVELWL0349    YL0308    P      Trailer Type
     C                     MOVELWL0350    YL0309    P      Seaboard Owned
     C                     MOVELWL0351    YL0310    P      On Yard Status
     C                     Z-ADDWL0352    YL0311           On Yard Date
     C                     Z-ADDWL0353    YL0312           On Yard Time
     C                     MOVELWL0354    YL0313    P      Assigned Status
     C                     MOVELWL0355    YL0314    P      Available Statu
     C                     MOVELWL0356    YL0315    P      Not Available R
     C                     MOVELWL0357    YL0316    P      Comment Line
     C                     MOVELWL0358    YL0317    P      Record Status
      * update/add container as assigned
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * RTV/Upd Chgd Trlr/CntnrRT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1XACD    WL0494    P      Carrier Code
     C                     MOVEL#1J2T1    WL0495    P      Trailer Id
     C                     Z-ADDYL0306    WL0496           Company Number
     C                     MOVELYL0307    WL0497    P      Load Type
     C                     MOVELYL0308    WL0498    P      Trailer Type
     C                     MOVELYL0309    WL0499    P      Seaboard Owned
     C                     MOVELYL0310    WL0500    P      On Yard Status
     C                     Z-ADDYL0311    WL0501           On Yard Date
     C                     Z-ADDYL0312    WL0502           On Yard Time
     C                     MOVEL'Y'       WL0503    P      Assigned Status
     C                     MOVEL'N'       WL0504    P      Available Statu
     C                     MOVEL*BLANK    WL0505           Not Available R
     C                     MOVEL*BLANK    WL0506           Comment Line
     C                     MOVELAMVSST    WL0507    P      Record Status
     C                     Z-ADDAMAATM    WL0508           Job Time
     C                     MOVELAMAYNA    WL0509    P      User Id
     C                     MOVELAMA0NA    WL0510    P      Job Name
     C                     Z-ADDAMAXDT    WL0511           Job Date
     C                     EXSR TBRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Load Type is Regular
     C           YL0029    IFEQ 'R'                        *IF
      * Crt PD Trailer         CR - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1XACD    WL0463    P      Carrier Code
     C                     MOVEL#1J2T1    WL0464    P      Trailer Id
     C                     Z-ADD#1AIC3    WL0465           Company Number
     C                     MOVELYL0029    WL0466    P      Load Type
     C                     MOVEL'R'       WL0467    P      Trailer Type
     C                     MOVEL'N'       WL0468    P      Seaboard Owned
     C                     MOVEL'N'       WL0469    P      On Yard Status
     C                     Z-ADD##JDT     WL0470           On Yard Date
     C                     Z-ADD##JTM     WL0471           On Yard Time
     C                     MOVEL'Y'       WL0472    P      Assigned Status
     C                     MOVEL'N'       WL0473    P      Available Statu
     C                     MOVEL*BLANK    WL0474           Not Available R
     C                     MOVEL*BLANK    WL0475           Comment Line
     C                     MOVELYL0318    WL0476    P      Status Unused 1
     C                     MOVELYL0319    WL0477    P      Status Unused 2
     C                     MOVELYL0320    WL0478    P      Status Unused 3
     C                     MOVELYL0321    WL0479    P      Status Unused 4
     C                     MOVELYL0322    WL0480    P      Status Unused 5
     C                     Z-ADD*ZERO     WL0481           Date Unused 1
     C                     Z-ADD*ZERO     WL0482           Date Unused 2
     C                     Z-ADD*ZERO     WL0483           Date Unused 3
     C                     Z-ADD*ZERO     WL0484           Date Unused 4
     C                     Z-ADD*ZERO     WL0485           Date Unused 5
     C                     MOVELYL0323    WL0486    P      EDI Status 1
     C                     MOVELYL0324    WL0487    P      EDI Status 2
     C                     MOVELYL0325    WL0488    P      EDI Status 3
     C                     MOVEL'A'       WL0489    P      Record Status
     C                     Z-ADDYL0326    WL0490           Job Time
     C                     MOVELYL0327    WL0491    P      User Id
     C                     MOVELYL0328    WL0492    P      Job Name
     C                     Z-ADDYL0329    WL0493           Job Date
     C                     EXSR SZCRRC
     C                     ELSE
      * CASE: PAR.Load Type is Bulk
     C           YL0029    IFEQ 'B'                        *IF
      * Crt PD Trailer         CR - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1XACD    WL0463    P      Carrier Code
     C                     MOVEL#1J2T1    WL0464    P      Trailer Id
     C                     Z-ADD#1AIC3    WL0465           Company Number
     C                     MOVELYL0029    WL0466    P      Load Type
     C                     MOVEL'T'       WL0467    P      Trailer Type
     C                     MOVEL'N'       WL0468    P      Seaboard Owned
     C                     MOVEL'N'       WL0469    P      On Yard Status
     C                     Z-ADD##JDT     WL0470           On Yard Date
     C                     Z-ADD##JTM     WL0471           On Yard Time
     C                     MOVEL'Y'       WL0472    P      Assigned Status
     C                     MOVEL'N'       WL0473    P      Available Statu
     C                     MOVEL*BLANK    WL0474           Not Available R
     C                     MOVEL*BLANK    WL0475           Comment Line
     C                     MOVELYL0318    WL0476    P      Status Unused 1
     C                     MOVELYL0319    WL0477    P      Status Unused 2
     C                     MOVELYL0320    WL0478    P      Status Unused 3
     C                     MOVELYL0321    WL0479    P      Status Unused 4
     C                     MOVELYL0322    WL0480    P      Status Unused 5
     C                     Z-ADD*ZERO     WL0481           Date Unused 1
     C                     Z-ADD*ZERO     WL0482           Date Unused 2
     C                     Z-ADD*ZERO     WL0483           Date Unused 3
     C                     Z-ADD*ZERO     WL0484           Date Unused 4
     C                     Z-ADD*ZERO     WL0485           Date Unused 5
     C                     MOVELYL0323    WL0486    P      EDI Status 1
     C                     MOVELYL0324    WL0487    P      EDI Status 2
     C                     MOVELYL0325    WL0488    P      EDI Status 3
     C                     MOVEL'A'       WL0489    P      Record Status
     C                     Z-ADDYL0326    WL0490           Job Time
     C                     MOVELYL0327    WL0491    P      User Id
     C                     MOVELYL0328    WL0492    P      Job Name
     C                     Z-ADDYL0329    WL0493           Job Date
     C                     EXSR SZCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Use old shipline if entered, else use par             E004079
      * CASE: PAR.Shipping Line 10 USR is Entered
     C           P3QXAA    IFNE *BLANK                     *IF
     C                     MOVELP3QXAA    YL0330           Shipping Line
     C                     ELSE
      * CASE: PAR.Shipping Line is entered
     C           #1XACD    IFNE *BLANK                     *IF
     C                     MOVEL#1XACD    YL0330           Shipping Line
     C                     END                             *FI
     C                     END                             *FI
      * Only update/add original container if container# & carrier entere
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Container Number is Entered
      *   |- c2    : LCL.Shipping Line is entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6BDU1    IFNE *BLANK                     *IF
     C           YL0330    IFNE *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * * Update Trailer file for original Container          E004079
      * Rtv Trailer            RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0330    WL0345    P      Carrier Code
     C                     MOVELP6BDU1    WL0346    P      Trailer Id
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0347    YL0306           Company Number
     C                     MOVELWL0348    YL0307    P      Load Type
     C                     MOVELWL0349    YL0308    P      Trailer Type
     C                     MOVELWL0350    YL0309    P      Seaboard Owned
     C                     MOVELWL0351    YL0310    P      On Yard Status
     C                     Z-ADDWL0352    YL0311           On Yard Date
     C                     Z-ADDWL0353    YL0312           On Yard Time
     C                     MOVELWL0354    YL0313    P      Assigned Status
     C                     MOVELWL0355    YL0314    P      Available Statu
     C                     MOVELWL0356    YL0315    P      Not Available R
     C                     MOVELWL0357    YL0316    P      Comment Line
     C                     MOVELWL0358    YL0317    P      Record Status
      * Update/add original container as available            E004079
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * RTV/Upd Chgd Trlr/CntnrRT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0330    WL0494    P      Carrier Code
     C                     MOVELP6BDU1    WL0495    P      Trailer Id
     C                     Z-ADDYL0306    WL0496           Company Number
     C                     MOVELYL0307    WL0497    P      Load Type
     C                     MOVELYL0308    WL0498    P      Trailer Type
     C                     MOVELYL0309    WL0499    P      Seaboard Owned
     C                     MOVELYL0310    WL0500    P      On Yard Status
     C                     Z-ADDYL0311    WL0501           On Yard Date
     C                     Z-ADDYL0312    WL0502           On Yard Time
     C                     MOVEL'N'       WL0503    P      Assigned Status
     C                     MOVEL'Y'       WL0504    P      Available Statu
     C                     MOVEL*BLANK    WL0505           Not Available R
     C                     MOVEL*BLANK    WL0506           Comment Line
     C                     MOVELAMVSST    WL0507    P      Record Status
     C                     Z-ADDAMAATM    WL0508           Job Time
     C                     MOVELAMAYNA    WL0509    P      User Id
     C                     MOVELAMA0NA    WL0510    P      Job Name
     C                     Z-ADDAMAXDT    WL0511           Job Date
     C                     EXSR TBRVGN
     C                     END                             *FI
     C                     END                             *FI
      * DO4595 DN 12/09/22-Create EDI 601 Data Set for Changed Data.
      * CASE: LCL.Create EDI 601 USR is Yes
     C           YL0305    IFEQ 'Y'                        *IF
      * Crt EDI 601 Exp Shp InfXF - EDI Export Shpmnt Inf HDR  * 
     C                     CALL 'PUXSXFR'              90  Crt EDI 601 Exp
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1C4NB    WQ0092  70       Order Number
     C                     PARM #1RMNB    WQ0093  70       Load ID
     C                     PARM #1XACD    WQ0094  3        Shipping Line
     C                     PARM #1OANA    WQ0095 20        Port Delv Termi
     C                     PARM #1J0T1    WQ0096 30        OHE Vessel_Airl
     C                     PARM #1QWDT    WQ0097  70       OHE Sail_Flight
     C                     PARM #1M2U1    WQ0098 15        OHE EDI 824 AES
     C                     PARM YL0206    WQ0099  6        Country Code
     C                     PARM YL0284    WQ0100  50       CBP Export Port
     C                     PARM YL0285    WQ0101  4        CBP Std Carrier
     C                     PARM YL0256    WQ0102  50       CBP Foreign Por
     C                     PARM 'C'       WQ0103  1        Add/Change/Dele
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUXSXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,31           *
     C                     MOVEL'1'       @I1,32           *
     C                     MOVEL'1'       @I1,34           *
     C                     MOVEL'1'       @I1,41           *
     C                     END
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * RTV/Upd Chgd Trlr/CntnrRT - Trailer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           LYBZNA           Carrier Code
     C                     KFLD           LYDXTX           Trailer Id
      * Setup key
     C                     MOVELWL0494    LYBZNA           Carrier Code
     C                     MOVELWL0495    LYDXTX           Trailer Id
      * Establish starting position
     C           KRSTB     CHAIN@LYRER3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2598' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg PD Trailer         CH - Trailer  * 
     C                     EXSR TCCHRC
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCCHRC    BEGSR
      *================================================================
      * Chg PD Trailer         CH - Trailer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @LYRER2
     C                     MOVELWL0494    WHBZNA    P      Carrier Code
     C                     MOVELWL0495    WHDXTX    P      Trailer Id
      *
     C           KLCHTC    KLIST
     C                     KFLD           WHBZNA           Carrier Code
     C                     KFLD           WHDXTX           Trailer Id
     C           KLCHTC    CHAIN@LYRER2              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDLYREL0'MDACP
     C                     MOVEL'@LYRER2' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDLY1    YFRDCS
      * Move non-key fields to @LYRER2
     C                     Z-ADDWL0496    WHAIC3           Company Number
     C                     MOVELLYVDST    WHVDST    P      Load Type
     C                     MOVELLYX3ST    WHX3ST    P      Trailer Type
     C                     MOVELLYXGST    WHXGST    P      Seaboard Owned
     C                     MOVELWL0500    WHSTOY    P      On Yard Status
     C                     Z-ADDWL0501    WHKKDT           On Yard Date
     C                     Z-ADDWL0502    WHAVTM           On Yard Time
     C                     MOVELWL0503    WHSTAS    P      Assigned Status
     C                     MOVELWL0504    WHXRST    P      Available Statu
     C                     MOVELLYX7CD    WHX7CD    P      Not Available R
     C                     MOVELLYGXTX    WHGXTX    P      Comment Line
     C                     MOVELLYXTST    WHXTST    P      Status Unused 1
     C                     MOVELLYXVST    WHXVST    P      Status Unused 2
     C                     MOVELLYSTU3    WHSTU3    P      Status Unused 3
     C                     MOVELLYSTU4    WHSTU4    P      Status Unused 4
     C                     MOVELLYSTU5    WHSTU5    P      Status Unused 5
     C                     Z-ADDLYLCDT    WHLCDT           Date Unused 1
     C                     Z-ADDLYLDDT    WHLDDT           Date Unused 2
     C                     Z-ADDLYLEDT    WHLEDT           Date Unused 3
     C                     Z-ADDLYLFDT    WHLFDT           Date Unused 4
     C                     Z-ADDLYLGDT    WHLGDT           Date Unused 5
     C                     MOVELLYUVST    WHUVST    P      EDI Status 1
     C                     MOVELLYUWST    WHUWST    P      EDI Status 2
     C                     MOVELLYUXST    WHUXST    P      EDI Status 3
     C                     MOVELLYVSST    WHVSST    P      Record Status
     C                     Z-ADDLYAATM    WHAATM           Job Time
     C                     MOVELLYAYNA    WHAYNA    P      User Id
     C                     MOVELLYA0NA    WHA0NA    P      Job Name
     C                     Z-ADDLYAXDT    WHAXDT           Job Date
      *
      * Set PGM.*Record Data Changed flag
     C           QPDLY1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##PGM     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDLY1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@LYRER2                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDLYREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0366    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSTD     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    YL0332           Allow Multi-Com
     C                     MOVELDRMPNA    YL0333           Default Printer
     C                     MOVELDRBCCD    YL0331           Salesperson Cod
     C                     Z-ADDDRAIC3    YL0334           Company Number
     C                     MOVELDRBUVN    WN0367           User Code Model
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - User Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0512    DTAJVN           User Profile Na
     C                     MOVELWL0513    DTDNCD           Application Cod
      * Establish starting position
     C           KRSTE     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0514           Company Number
     C                     MOVELDTAJCD    WL0515           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQTF01           Application Cod
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           WQTF01           Application Cod
      * Setup key
     C                     MOVEL'PDTNE1'  WQTF01           Application Cod
      * Establish starting position
     C           KRSTF     SETLL@DNRESF                    *
     C           KRSTF     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR TGRVGN
     C                     END                             *FI
     C           KRSTF     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQTG01           Application Cod
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           WQTG01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQTG01           Application Cod
      * Establish starting position
     C           KRSTG     SETLL@DNRESF                    *
     C           KRSTG     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSTG     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ** Put DB1 fields on the screen
      *================================================================
      * DTL = DB1 By name
     C                     Z-ADDAMC4NB    #1C4NB           Order Number
     C                     Z-ADDAMRMNB    #1RMNB           Load ID
     C                     Z-ADDAMRUNB    #1RUNB           Stop_Drop Seque
     C                     Z-ADDAMAIC3    #1AIC3           Company Number
     C                     MOVELAMCCTX    #1CCTX           OHE Ship Status
     C                     MOVELAMVSST    #1VSST           Record Status
     C                     MOVELAMXACD    #1XACD           Shipping Line
     C                     MOVELAMOANA    #1OANA           Port Delv Termi
     C                     MOVELAMHCAA    #1HCAA           OHE Discharge P
     C                     MOVELAMHBAA    #1HBAA           OHE City
     C                     MOVELAMJ0T1    #1J0T1           OHE Vessel_Airl
     C                     MOVELAMGENY    #1GENY           OHE Voyage_Flig
     C                     MOVELAMB4TX    #1B4TX           OHE Load Haul T
     C                     MOVELAMJ1T1    #1J1T1           OHE Booking Num
     C                     MOVELAMCVTX    #1CVTX           OHE Bookings Co
     C                     MOVELAMHDAA    #1HDAA           OHE Late Delive
     C                     MOVELAMM2U1    #1M2U1           OHE EDI 824 AES
     C                     Z-ADDAMGINY    #1GINY           OHE Unused Numb
     C                     Z-ADDAMGFNY    #1GFNY           OHE Unused Numb
     C                     Z-ADDAMGGNY    #1GGNY           OHE Unused Numb
     C                     Z-ADDAMGHNY    #1GHNY           OHE Unused Numb
     C                     Z-ADDAMHEVL    #1HEVL           OHE HPB RIN Equ
     C                     Z-ADDAMHFVL    #1HFVL           OHE HPB RIN Pri
     C                     Z-ADDAMQ0DT    #1Q0DT           OHE Backhaul ET
     C                     Z-ADDAMQ2DT    #1Q2DT           OHE Actual Ship
     C                     MOVELAMC2TX    #1C2TX           OHE Carrier SCA
     C                     MOVELAMC3TX    #1C3TX           OHE Spot Buy
     C                     MOVELAMC6TX    #1C6TX           OHE PO ACK Flag
     C                     MOVELAMCHTX    #1CHTX           OHE Override Ty
     C                     MOVELAMCITX    #1CITX           OHE Backhaul St
     C                     MOVELAMCLTX    #1CLTX           OHE Backhaul ET
     C                     Z-ADDAMQXDT    #1QXDT           OHE Port Cut Da
     C                     MOVELAMJ2T1    #1J2T1           OHE Container N
     C                     Z-ADDAMQWDT    #1QWDT           OHE Sail_Flight
     C                     Z-ADDAMQYDT    #1QYDT           OHE Arrival Dat
     C                     Z-ADDAMQZDT    #1QZDT           OHE Est Arrv at
     C                     Z-ADDAMP8NY    #1P8NY           OHE Pier Pass F
     C                     Z-ADDAMQGNY    #1QGNY           OHE PowerPro Lo
     C                     MOVELAMV8T1    #1V8T1           OHE Transload C
     C                     MOVELAMV9T1    #1V9T1           OHE Pier Pass I
     C                     Z-ADDAMQHNY    #1QHNY           OHE PowerPro Lo
     C                     MOVELAMCUTX    #1CUTX           OHE Backhaul Ca
     C                     MOVELAMB9TX    #1B9TX           OHE EDI Error R
     C                     MOVELAMJWSC    #1JWSC           OHE EDI Error R
     C                     Z-ADDAMITNY    #1ITNY           HPB COA Batch N
     C                     MOVELAMLMT1    #1LMT1           Delivery P.O. N
     C                     MOVELAMLWAA    #1LWAA           OHE Intended fo
     C                     MOVELAMFVST    #1FVST           OHE EDI 943 Act
     C                     MOVELAMF0ST    #1F0ST           OHE EDI 944 Act
     C                     MOVELAMF2ST    #1F2ST           OHE EDI 940 Act
     C                     MOVELAMF3ST    #1F3ST           OHE EDI 945 Act
     C                     MOVELAMJUSC    #1JUSC           OHE EDI 856 Act
     C                     MOVELAMJVSC    #1JVSC           OHE EDI 824 Act
     C                     MOVELAMV3T1    #1V3T1           OHE Transload S
     C                     Z-ADDAMP9NY    #1P9NY           OHE Port Check
     C                     MOVELAMV4T1    #1V4T1           OHE Abs Rate Ov
     C                     MOVELAMWAT1    #1WAT1           OHE Carrier Nm
     C                     Z-ADDAMQANY    #1QANY           OHE Port Cut Ti
     C                     Z-ADDAMHGVL    #1HGVL           Transload Termi
     C                     Z-ADDAMQ1DT    #1Q1DT           OHE Port_Pier P
     C                     MOVELAMV5T1    #1V5T1           OHE Appt Confir
     C                     MOVELAMV6T1    #1V6T1           OHE Backhaul Co
     C                     MOVELAMV7T1    #1V7T1           OHE Backhaul Ch
     C                     MOVELAMRLNA    #1RLNA           OHE Comment 1
     C                     MOVELAMRMNA    #1RMNA           OHE Comment 2
     C                     MOVELAMWBT1    #1WBT1           OHE Appt Confir
     C                     MOVELAMWCT1    #1WCT1           OHE Backhaul Co
     C                     MOVELAMWDT1    #1WDT1           Letter of Credi
     C                     Z-ADDAMQJNY    #1QJNY           OHE Backhaul Re
     C                     Z-ADDAMQKNY    #1QKNY           LD Stop_Drop
     C                     Z-ADDAMQLNY    #1QLNY           OHE Unused Numb
     C                     Z-ADDAMQCNY    #1QCNY           OHE Backhaul Tr
     C                     Z-ADDAMQDNY    #1QDNY           OHE Load Sched
     C                     Z-ADDAMQENY    #1QENY           Original Appoin
     C                     Z-ADDAMQFNY    #1QFNY           Original Appoin
     C                     Z-ADDAMQINY    #1QINY           OHE Unused Nume
     C                     Z-ADDAMQMNY    #1QMNY           OHE Orig ABS Fr
     C                     MOVELAMMYU1    #1MYU1           OHE Genset Numb
     C                     MOVELAMJXSC    #1JXSC           OHE Email BOL_S
     C                     MOVELAMJYSC    #1JYSC           OHE EDI Order A
     C                     MOVELAMJZSC    #1JZSC           OHE EDI 601 Act
     C                     MOVELAMJ0SC    #1J0SC           OHE Unused Stat
     C                     MOVELAMMZU1    #1MZU1           OHE Unused Text
     C                     MOVELAMM0U1    #1M0U1           OHE Unused Text
     C                     MOVELAMM1U1    #1M1U1           OHE Customer Ve
     C                     MOVELAMM3U1    #1M3U1           OHE Unused Text
     C                     Z-ADDAMW5DT    #1W5DT           OHE Unused Date
     C                     Z-ADDAMW6DT    #1W6DT           OHE Unused Date
     C                     MOVELAMUVST    #1UVST           EDI Status 1
     C                     MOVELAMUWST    #1UWST           EDI Status 2
     C                     MOVELAMUXST    #1UXST           EDI Status 3
     C                     Z-ADDAMAATM    #1AATM           Job Time
     C                     MOVELAMAYNA    #1AYNA           User Id
     C                     MOVELAMA0NA    #1A0NA           Job Name
     C                     Z-ADDAMAXDT    #1AXDT           Job Date
     C                     MOVELAMXACD    #1XACD           Shipping Line
     C                     MOVELAMOANA    #1OANA           Port Delv Termi
     C                     MOVELAMHCAA    #1HCAA           OHE Discharge P
     C                     MOVELAMJ2T1    #1J2T1           OHE Container N
     C                     Z-ADDAMQ2DT    #DF9DT           Actual Ship Dat
     C                     Z-ADDAMQANY    #DT4TM           USR Time 4.0
      * * Add Letter of Credit to the screen                  E002768
      * *   Shorten to 30 characters
     C                     MOVELAMWDT1    #DAKU1           String 30
      * * Save container to test later if it has changed    E004079
      * CASE: DB1.OHE Container Number is Entered
     C           AMJ2T1    IFNE *BLANK                     *IF
     C                     MOVELAMJ2T1    P6BDU1           Container Numbe
     C                     MOVELAMXACD    P3QXAA           Shipping Line 1
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    P6BDU1           Container Numbe
     C                     MOVELAMXACD    P3QXAA           Shipping Line 1
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * ** First Time Calcs: Update any blank fields
      *================================================================
      * CASE: WRK.First Time Flag is Yes
     C           WUTAST    IFEQ 'Y'                        *IF
      * ** Actual Ship Date
      * CASE: DTL.Actual Ship Date is not entered
     C           #DF9DT    IFEQ *ZERO                      *IF
      * ** IF Order Hdr ASD is blanks, use Load Hdr ASD
     C                     Z-ADDYL0243    #DF9DT           Actual Ship Dat
     C                     END                             *FI
      * ** Carrier Code
      * CASE: DTL.Carrier Code is not entered
     C           #DBZNA    IFEQ *BLANK                     *IF
     C                     MOVELYL0161    #DBZNA           Carrier Code
     C                     END                             *FI
      * ** Scheduled Ship Date
      * CASE: DTL.Scheduled Ship Date is not entered
     C           #DAODT    IFEQ *ZERO                      *IF
     C                     Z-ADDYL0169    #DAODT           Scheduled Ship
     C                     END                             *FI
      * ** Requested Delivery Date & time
      * CASE: DTL.Requested Delivery Date is not entered
     C           #DEIDT    IFEQ *ZERO                      *IF
     C                     Z-ADDYL0082    #DEIDT           Requested Deliv
     C                     Z-ADDYL0244    #DHMNX           USR From Time 4
     C                     END                             *FI
      * ** Shipping method
      * CASE: DTL.Shipping Method EQ WRK.Blank for 3          USR
     C           #DQ2CD    IFEQ WUUAT1                     *IF
     C                     MOVELYL0181    #DQ2CD           Shipping Method
     C                     END                             *FI
      * ** Stop/Drop Sequence number
      * CASE: DTL.Stop/Drop Sequence Number is Not Entered
     C           #1RUNB    IFEQ *ZERO                      *IF
     C                     Z-ADDYL0245    #1RUNB           Stop_Drop Seque
     C                     END                             *FI
      * ** Container
      * CASE: DTL.OHE Container Number is Not Entered
     C           #1J2T1    IFEQ *BLANK                     *IF
     C                     MOVELYL0071    #1J2T1           OHE Container N
     C                     END                             *FI
      * * SAVE Port Cut Date and Time                         E003143
     C                     Z-ADDAMQANY    WUQANY           OHE Port Cut Ti
     C                     Z-ADDAMQXDT    WUQXDT           OHE Port Cut Da
     C                     MOVEL'N'       WUTAST           First Time Flag
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * ** Clear fields on the screen         C002567
      *================================================================
      * PAR = CON By name
     C                     MOVEL*BLANK    #1XACD           Shipping Line
     C                     MOVEL*BLANK    #1OANA           Port Delv Termi
     C                     MOVEL*BLANK    #1HBAA           OHE City
     C                     MOVEL*BLANK    #1J0T1           OHE Vessel_Airl
     C                     MOVEL*BLANK    #1GENY           OHE Voyage_Flig
     C                     MOVEL*BLANK    #1J1T1           OHE Booking Num
     C                     MOVEL*BLANK    #1HCAA           OHE Discharge P
     C                     Z-ADD*ZERO     #1QWDT           OHE Sail_Flight
     C                     Z-ADD*ZERO     #1QXDT           OHE Port Cut Da
     C                     Z-ADD*ZERO     #1QYDT           OHE Arrival Dat
     C                     MOVEL*BLANK    #1CCTX           OHE Ship Status
     C                     MOVEL*BLANK    #1J2T1           OHE Container N
     C                     MOVEL*BLANK    #1RLNA           OHE Comment 1
     C                     MOVEL*BLANK    #1RMNA           OHE Comment 2
     C                     Z-ADD*ZERO     #1HGVL           Transload Termi
     C                     Z-ADD*ZERO     #1QZDT           OHE Est Arrv at
     C                     Z-ADD*ZERO     #1Q1DT           OHE Port_Pier P
     C                     Z-ADD*ZERO     #1Q2DT           OHE Actual Ship
     C                     MOVEL*BLANK    #1B4TX           OHE Load Haul T
     C                     MOVEL*BLANK    #1CVTX           OHE Bookings Co
     C                     MOVEL*BLANK    #1V3T1           OHE Transload S
     C                     MOVEL*BLANK    #1V4T1           OHE Abs Rate Ov
     C                     MOVEL*BLANK    #1V8T1           OHE Transload C
     C                     MOVEL*BLANK    #1V9T1           OHE Pier Pass I
     C                     MOVEL*BLANK    #1WAT1           OHE Carrier Nm
     C                     Z-ADD*ZERO     #1P8NY           OHE Pier Pass F
     C                     Z-ADD*ZERO     #1P9NY           OHE Port Check
     C                     Z-ADD*ZERO     #1QANY           OHE Port Cut Ti
     C                     Z-ADD*ZERO     #1QGNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     #1QHNY           OHE PowerPro Lo
     C                     MOVEL*BLANK    #DXBCD           Sail Port State
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Select existing record
      *================================================================
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C                     MOVELV1C4NB    WK1X02  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     C           WK1X02    OREQ '?'                        Order Number
     C           YPMTFD    OREQ '#1C4NB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1J1T1' defaulted for 'OHE Booking Number'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(LCL) YL0251' defaulted for 'Record Selected       USR'.
     C                     CALL 'PBA9SRR'              90  SEL Booking Num
     C                     PARM *BLANK    W0RTN   7
     C           #1J1T1    PARM #1J1T1    WQ0007 15        OHE Booking Num
     C           YL0251    PARM *BLANK    WQ0008  1        Record Selected
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBA9SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,36           *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1C4NB    IFNE *ZERO                      Order Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C                     MOVELV1C4NB    WK1X02  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     C           WK1X02    OREQ '?'                        Order Number
     C           YPMTFD    OREQ '#1C4NB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1AIC3' defaulted for 'Company Number'.
      * Field '(KEY) #1C4NB' defaulted for 'Order Number'.
     C                     CALL 'PDPCSRR'              90  SEL Order
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0009  30       Company Number
     C           #1C4NB    PARM #1C4NB    WQ0010  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPCSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     993132*
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1C4NB    IFNE *ZERO                      Order Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VB999
     C                     END
     C                     END
      *................................................................
      *
     C           KLVBBE    KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    BEAIC3
     C                     Z-ADD#1C4NB    BEC4NB
     C           KLVBBE    CHAIN@BECPFK              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
     C           VB999     TAG
      * Restrictor relation not satisfied
      * Send message 'Order Header TRG       NF'
     C                     MOVEL'USR0176' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'USR0176' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Order Header TRG
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C                     MOVELV1C4NB    WK1X02  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     C           WK1X02    OREQ '?'                        Order Number
     C           YPMTFD    OREQ '#1C4NB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1AIC3' defaulted for 'Company Number'.
      * Field '(KEY) #1C4NB' defaulted for 'Order Number'.
     C                     CALL 'PDPCSRR'              90  SEL Order
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0104  30       Company Number
     C           #1C4NB    PARM #1C4NB    WQ0105  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPCSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     993132*
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1C4NB    IFNE *ZERO                      Order Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AIC3    IFEQ *ZERO                      Company Number
     C           #1C4NB    ANDEQ*ZERO                      Order Number
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCBE    KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    BEAIC3
     C                     Z-ADD#1C4NB    BEC4NB
     C           KLVCBE    CHAIN@BECPFK              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Order Header TRG       NF'
     C                     MOVEL'USR0176' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0176' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y1SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y1EXIT    ENDSR
      /EJECT
     CSR         Y2SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y2EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C           @#DFMT    IFEQ '#RCDKEY'
      * KEY Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C                     ENDIF
     C           @#DFMT    IFEQ '#RCDDTL1'
      * DETAIL Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW1END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW1BEG,F
     C                     MOVELW1NAM,F   W0CFL
     C                     ENDIF
     C                     ENDIF
     C           @#DFMT    IFEQ '#RCDDTL2'
      * DETAIL 2 Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW2END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW2BEG,F
     C                     MOVELW2NAM,F   W0CFL
     C                     ENDIF
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           ZHCSRW    IFEQ 004
     C           ZHCSCL    ANDGE018
     C           ZHCSCL    ANDLE020
     C           @#DFMT    ANDEQ'#RCDKEY'
     C                     MOVEL'#1AIC3'  YPMTFD           Company Number
     C                     END
      *
     C           ZHCSRW    IFEQ 005
     C           ZHCSCL    ANDGE018
     C           ZHCSCL    ANDLE024
     C           @#DFMT    ANDEQ'#RCDKEY'
     C                     MOVEL'#1C4NB'  YPMTFD           Order Number
     C                     END
      *
     C           ZHCSRW    IFEQ 016
     C           ZHCSCL    ANDGE043
     C           ZHCSCL    ANDLE044
     C           @#DFMT    ANDEQ'#RCDDTL2'
     C                     MOVEL'#1CITX'  YPMTFD           OHE Backhaul St
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM 1         YYLGCT  50       # of grps
     C                     PARM W0GRP     YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel and exit from key screen
      *================================================================
      * USER: Exit program processing
      * ** Re-Calculate the total load miles using the updated sail port
      * ** city. Update the load header.
      * ** Total Load Miles will be zeros if any leg of the journey
      * ** is missing a Miles Between Cities record.
      * ** Include Override Total Load Miles. If entered, they will
      * ** take precedence
      * CLC Total Load Miles   XF - Load Detail  * 
     C                     CLEARPBRC
     C                     Z-ADDP1RMNB    PBRMNB           Load ID
      *
     C                     CALL 'PDW3XFR'              90  CLC Total Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Load Detai
     C           WUTLMI    PARM WUTLMI    WQ0106  70       Total Load Mile
     C           WUK2DT    PARM WUK2DT    WQ0107  70       Override Total
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CHG Total Load Miles   XF - Load Header  * 
     C                     CALL 'PMFSXFR'              90  CHG Total Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1RMNB    WQ0108  70       Load ID
     C                     PARM WUTLMI    WQ0109  70       Total Load Mile
     C                     PARM WUK2DT    WQ0110  70       Override Total
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMFSXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * ** Fax load confirmation to Ship Line &/or Transloader, if entere
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ @CN,015                    *IF
     C                     MOVEL'Y'       P2STYN           USR Exit Progra
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Can only fax confirmation if Carrier is assigned to the load
      * CASE: PAR.USR Carrier Code is entered
     C           P6R6CD    IFNE *BLANK                     *IF
      * ** wrk.status-Y or N is to control faxing to PowerPro in the
      * ** case of a carrier change. Carrier cannot be changed here so
      * ** there is no PowerPro processing
     C                     MOVEL'Y'       WUB8ST           Status - Y or N
     C                     MOVEL##JOB     WUB2VN           Job Name CDE
      * PMT Fax Load Confirmtn PV - Load Header  * 
     C                     CALL 'POICPVR'              90  PMT Fax Load Co
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1RMNB    WQ0111  70       Load ID
     C                     PARM P6FKNB    WQ0112  30       Company Number
     C                     PARM P3DYTX    WQ0113  3        Transloader Car
     C                     PARM P6R6CD    WQ0114  3        Carrier Code
     C                     PARM P3XACD    WQ0115  3        Shipping Line
     C                     PARM P1C2TX    WQ0116  4        OHE Carrier SCA
     C           WUB8ST    PARM WUB8ST    WQ0117  1        Status - Y or N
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POICPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1GENY           OHE Voyage_Flig
     C                     MOVEL*BLANK    P1J1T1           OHE Booking Num
     C                     MOVEL*BLANK    P1C2TX           OHE Carrier SCA
     C                     Z-ADD*ZERO     P1QKNY           LD Stop_Drop
     C                     MOVEL*BLANK    P3XACD           Shipping Line
     C                     MOVEL*BLANK    P3OANA           Port Delv Termi
     C                     MOVEL*BLANK    P3K4TX           Vessel Name
     C                     Z-ADD*ZERO     P3VOAG           Voyage
     C                     Z-ADD*ZERO     P3KBDT           Sail Date
     C                     MOVEL*BLANK    P3W4CD           Discharge Port
     C                     MOVEL*BLANK    P3CNTN           Container Numbe
     C                     Z-ADD*ZERO     P3QXDT           OHE Port Cut Da
     C                     MOVEL*BLANK    P3B4TX           OHE Load Haul T
     C                     Z-ADD*ZERO     P3QYDT           OHE Arrival Dat
     C                     Z-ADD*ZERO     P3QZDT           OHE Est Arrv at
     C                     Z-ADD*ZERO     P3QGNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     P3P8NY           OHE Pier Pass F
     C                     Z-ADD*ZERO     P3P9NY           OHE Port Check
     C                     MOVEL*BLANK    P3V8T1           OHE Transload C
     C                     MOVEL*BLANK    P3V3T1           OHE Transload S
     C                     MOVEL*BLANK    P3V4T1           OHE Abs Rate Ov
     C                     Z-ADD*ZERO     P3QHNY           OHE PowerPro Lo
     C                     MOVEL*BLANK    P3DYTX           Transloader Car
     C                     MOVEL*BLANK    P3V9T1           OHE Pier Pass I
     C                     MOVEL*BLANK    P3WAT1           OHE Carrier Nm
     C                     Z-ADD*ZERO     P3Q1DT           OHE Port_Pier P
     C                     Z-ADD*ZERO     P3QANY           OHE Port Cut Ti
     C                     MOVEL*BLANK    P3QXAA           Shipping Line 1
     C                     MOVEL*BLANK    P4TQNA           TD Last Name
     C                     MOVEL*BLANK    P4TPNA           TD First Name
     C                     Z-ADD*ZERO     P4S7NY           TD Truck Number
     C                     MOVEL*BLANK    P4XPT1           TD Phone Number
     C                     MOVEL*BLANK    P4XQT1           TD Email Addres
     C                     MOVEL*BLANK    P4XRT1           TD Notes
     C                     MOVEL*BLANK    P4VSST           Record Status
     C                     Z-ADD*ZERO     P4AATM           Job Time
     C                     MOVEL*BLANK    P4AYNA           User Id
     C                     MOVEL*BLANK    P4A0NA           Job Name
     C                     Z-ADD*ZERO     P4AXDT           Job Date
     C                     Z-ADD*ZERO     P5EIDT           Requested Deliv
     C                     Z-ADD*ZERO     P5AFTM           Requested Deliv
     C                     MOVEL*BLANK    P6AKTX           Status Flag 7
     C                     MOVEL*BLANK    P6DGTX           Status Flag 10
     C                     MOVEL*BLANK    P6B8ST           Status - Y or N
     C                     MOVEL*BLANK    P6DXTX           Trailer Id
     C                     MOVEL*BLANK    P6MUTX           Trailer Id
     C                     MOVEL*BLANK    P6BDU1           Container Numbe
     C                     MOVEL*BLANK    P6R6CD           USR Carrier Cod
     C                     Z-ADD*ZERO     P6FKNB           USR Company Num
     C                     Z-ADD*ZERO     P6MPNB           USR Order Numbe
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAANC7           AR Customer Num
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WAA0DT           Order Date
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WAACDT           Cancel Date
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WAJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WAA1WG           Order Weight To
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WATBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WAATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WARSRN           Resell Referenc
     C                     Z-ADD*ZERO     WAT3NB           Attach to Order
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WAAWDT           Invoice Date
     C                     Z-ADD*ZERO     WAVRVA           A/R order Value
     C                     Z-ADD*ZERO     WAB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WANODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WANPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WANQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WANRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WANSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WABPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WABQTM           Time of Origina
     C                     Z-ADD*ZERO     WABRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WABSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WABTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WAH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WAH1NX           Act Non_Ref Frt
     C                     Z-ADD*ZERO     WAH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WAH3NX           OH Total Non_Re
     C                     Z-ADD*ZERO     WAH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBDPNB           Order Sequence
     C                     Z-ADD*ZERO     WBUENB           Order Secondary
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WBMAVA           Billing Detail
     C                     Z-ADD*ZERO     WBKDVA           Billing Detail
     C                     Z-ADD*ZERO     WBL8VA           Billing Detail
     C                     Z-ADD*ZERO     WBL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WBAYVA           Extended Amount
     C                     Z-ADD*ZERO     WBEXDT           Market Pricing
     C                     Z-ADD*ZERO     WBBZPR           Price Overage O
     C                     Z-ADD*ZERO     WBL6NB           Contract Number
     C                     Z-ADD*ZERO     WBGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WBD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WBCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WBAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WBCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WBATWG           Weight Shipped
     C                     Z-ADD*ZERO     WBAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WBAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WBAKPR           Unit Price
     C                     Z-ADD*ZERO     WBALPR           Unit Price_Cred
     C                     Z-ADD*ZERO     WBAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WBAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WBA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WBB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WBA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WBNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WBNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WBNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WBNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WBNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WBBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WBBVTM           Price Code
     C                     Z-ADD*ZERO     WBBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WBBXTM           Substitution Li
     C                     Z-ADD*ZERO     WBBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WBH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WBH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WBH7NX           OD Item Target
     C                     Z-ADD*ZERO     WBH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WBH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WBDVPR           Order Gate_Fina
     C                     Z-ADD*ZERO     WBDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WBDXPR           OD Gate_Final P
     C                     Z-ADD*ZERO     WBDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WBDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WBGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WBGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WBGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WBPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WBRINY           Item Age Days
     C                     Z-ADD*ZERO     WBTIDT           Production Ovr
     C                     Z-ADD*ZERO     WBTJDT           Production Ovr
     C                     Z-ADD*ZERO     WBTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WBTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WBTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field OHE Container Number
     C                     MOVEL*BLANK    WUJ2T1 12
      * Define work field OHE Port Cut Time
     C                     Z-ADD*ZERO     WUQANY  50
      * Define work field OHE Port Cut Date
     C                     Z-ADD*ZERO     WUQXDT  70
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Blank for 3          USR
     C                     MOVEL*BLANK    WUUAT1  3
      * Define work field Current System Date
     C                     Z-ADD*ZERO     WUSDTE 155
      * Define work field Current System Time
     C                     Z-ADD*ZERO     WUZHNB 155
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field On Yard Status
     C                     MOVEL*BLANK    WUSTOY  1
      * Define work field On Yard Date
     C                     Z-ADD*ZERO     WUKKDT  70
      * Define work field On Yard Time
     C                     Z-ADD*ZERO     WUAVTM  60
      * Define work field Available Status
     C                     MOVEL*BLANK    WUXRST  1
      * Define work field Record Selected       USR
     C                     MOVEL*BLANK    WUZZST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WDRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WDFLAM           Flat Amount
     C                     Z-ADD*ZERO     WDRRNB           Total Stops
     C                     Z-ADD*ZERO     WDSBNB           BOL Time
     C                     Z-ADD*ZERO     WDSQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDSDNB           Number Pallets
     C                     Z-ADD*ZERO     WDPAOU           Number Pallets
     C                     Z-ADD*ZERO     WDDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WDSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WDHADT           Actual Arrival
     C                     Z-ADD*ZERO     WDAART           Actual Arrival
     C                     Z-ADD*ZERO     WDDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WDDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WDAQDT           Actual Departur
     C                     Z-ADD*ZERO     WDS6NB           Departure Time
     C                     Z-ADD*ZERO     WDT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WDPRTM           Product Tempera
     C                     Z-ADD*ZERO     WDNPSV           Number Spacers
     C                     Z-ADD*ZERO     WDTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WDGRWE           Gross Weight
     C                     Z-ADD*ZERO     WDF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WDJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WDTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WDJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WDSPTM           Spotted Time
     C                     Z-ADD*ZERO     WDJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WDLFTM           Load Finished T
     C                     Z-ADD*ZERO     WDJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WDBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WDJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WDBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WDKIDT           Truck Departure
     C                     Z-ADD*ZERO     WDASTM           Truck Departure
     C                     Z-ADD*ZERO     WDKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WDAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WDVOAG           Voyage
     C                     Z-ADD*ZERO     WDKBDT           Sail Date
     C                     Z-ADD*ZERO     WDEFDT           Arrival Date
     C                     Z-ADD*ZERO     WDKCDT           Date In
     C                     Z-ADD*ZERO     WDTMIN           Time In
     C                     Z-ADD*ZERO     WDKDDT           Date Out
     C                     Z-ADD*ZERO     WDVMNB           Time Out
     C                     Z-ADD*ZERO     WDOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WDKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WDATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WDBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WDEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WDKKDT           On Yard Date
     C                     Z-ADD*ZERO     WDAVTM           On Yard Time
     C                     Z-ADD*ZERO     WDKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WDAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WDLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WDK0DT           Product Complet
     C                     Z-ADD*ZERO     WDAYTM           Product Complet
     C                     Z-ADD*ZERO     WDKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WDICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WDIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WDK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WDAZTM           Load Door 1
     C                     Z-ADD*ZERO     WDK2DT           Override Total
     C                     Z-ADD*ZERO     WDA0TM           Load Door 2
     C                     Z-ADD*ZERO     WDZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WDPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WDCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WDPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WDCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WDP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WDCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WDP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WDCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WDP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WDCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WDP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WDCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field Transloader Carrier Code
     C                     MOVEL*BLANK    WUDYTX  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGC4NB           Order Number
     C                     Z-ADD*ZERO     WGRMNB           Load ID
     C                     Z-ADD*ZERO     WGRUNB           Stop_Drop Seque
     C                     Z-ADD*ZERO     WGQWDT           OHE Sail_Flight
     C                     Z-ADD*ZERO     WGQXDT           OHE Port Cut Da
     C                     Z-ADD*ZERO     WGQYDT           OHE Arrival Dat
     C                     Z-ADD*ZERO     WGGINY           OHE Unused Numb
     C                     Z-ADD*ZERO     WGGFNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WGGGNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WGGHNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WGHEVL           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WGHFVL           OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WGHGVL           Transload Termi
     C                     Z-ADD*ZERO     WGQZDT           OHE Est Arrv at
     C                     Z-ADD*ZERO     WGQ0DT           OHE Backhaul ET
     C                     Z-ADD*ZERO     WGQ1DT           OHE Port_Pier P
     C                     Z-ADD*ZERO     WGQ2DT           OHE Actual Ship
     C                     Z-ADD*ZERO     WGITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WGQJNY           OHE Backhaul Re
     C                     Z-ADD*ZERO     WGQKNY           LD Stop_Drop
     C                     Z-ADD*ZERO     WGQLNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WGP8NY           OHE Pier Pass F
     C                     Z-ADD*ZERO     WGP9NY           OHE Port Check
     C                     Z-ADD*ZERO     WGQANY           OHE Port Cut Ti
     C                     Z-ADD*ZERO     WGQCNY           OHE Backhaul Tr
     C                     Z-ADD*ZERO     WGQDNY           OHE Load Sched
     C                     Z-ADD*ZERO     WGQENY           Original Appoin
     C                     Z-ADD*ZERO     WGQFNY           Original Appoin
     C                     Z-ADD*ZERO     WGQGNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WGQHNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WGQINY           OHE Unused Nume
     C                     Z-ADD*ZERO     WGQMNY           OHE Orig ABS Fr
     C                     Z-ADD*ZERO     WGW5DT           OHE Unused Date
     C                     Z-ADD*ZERO     WGW6DT           OHE Unused Date
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Define work field Blank for 12          USR
     C                     MOVEL*BLANK    WUS3TX 12
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHKKDT           On Yard Date
     C                     Z-ADD*ZERO     WHAVTM           On Yard Time
     C                     Z-ADD*ZERO     WHLCDT           Date Unused 1
     C                     Z-ADD*ZERO     WHLDDT           Date Unused 2
     C                     Z-ADD*ZERO     WHLEDT           Date Unused 3
     C                     Z-ADD*ZERO     WHLFDT           Date Unused 4
     C                     Z-ADD*ZERO     WHLGDT           Date Unused 5
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Define work field Total Load Miles
     C                     Z-ADD*ZERO     WUTLMI  70
      * Define work field Override Total Load Miles
     C                     Z-ADD*ZERO     WUK2DT  70
      * Define work field Status - Y or N
     C                     MOVEL*BLANK    WUB8ST  1
      * Define work field Job Name CDE
     C                     MOVEL*BLANK    WUB2VN 10
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Define work field Note: Text Usr - 50
     C                     MOVEL*BLANK    WUEFT1 50
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SARVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003  2
     C                     Z-ADD*ZERO     WL0004  70
     C                     MOVEL*BLANK    WL0005 30
     C                     MOVEL*BLANK    WL0006 20
     C                     MOVEL*BLANK    WL0007  2
     C                     Z-ADD*ZERO     WL0008  70
     C                     Z-ADD*ZERO     WL0009  70
     C                     MOVEL*BLANK    WL0010  3
     C                     MOVEL*BLANK    WL0011  1
     C                     MOVEL*BLANK    WL0012  1
     C                     MOVEL*BLANK    WL0013  1
     C                     MOVEL*BLANK    WL0014  1
     C                     Z-ADD*ZERO     WL0015  70
     C                     Z-ADD*ZERO     WL0016  40
     C                     Z-ADD*ZERO     WL0017  70
     C                     MOVEL*BLANK    WL0018  1
     C                     MOVEL*BLANK    WL0019  1
     C                     MOVEL*BLANK    WL0020  1
      * Define local variables for subroutine SBRVGN.
     C                     Z-ADD*ZERO     WL0021  70
     C                     Z-ADD*ZERO     WL0022  30
     C                     Z-ADD*ZERO     WL0023  70
     C                     MOVEL*BLANK    WL0024  1
     C                     MOVEL*BLANK    WL0025  1
     C                     Z-ADD*ZERO     WL0026  52
     C                     MOVEL*BLANK    WL0027 15
     C                     MOVEL*BLANK    WL0028 15
     C                     MOVEL*BLANK    WL0029 15
     C                     MOVEL*BLANK    WL0030 15
     C                     MOVEL*BLANK    WL0031 15
     C                     Z-ADD*ZERO     WL0032  70
     C                     Z-ADD*ZERO     WL0033 112
     C                     MOVEL*BLANK    WL0034  1
     C                     Z-ADD*ZERO     WL0035  50
     C                     MOVEL*BLANK    WL0036 20
     C                     MOVEL*BLANK    WL0037  3
     C                     Z-ADD*ZERO     WL0038  40
     C                     MOVEL*BLANK    WL0039  3
     C                     MOVEL*BLANK    WL0040  7
     C                     Z-ADD*ZERO     WL0041  70
     C                     Z-ADD*ZERO     WL0042 112
     C                     MOVEL*BLANK    WL0043  1
     C                     MOVEL*BLANK    WL0044  1
     C                     Z-ADD*ZERO     WL0045  50
     C                     Z-ADD*ZERO     WL0046  50
     C                     Z-ADD*ZERO     WL0047 112
     C                     Z-ADD*ZERO     WL0048  60
     C                     Z-ADD*ZERO     WL0049  70
     C                     Z-ADD*ZERO     WL0050  40
     C                     Z-ADD*ZERO     WL0051 112
     C                     Z-ADD*ZERO     WL0052 112
     C                     Z-ADD*ZERO     WL0053  70
     C                     Z-ADD*ZERO     WL0054  40
     C                     Z-ADD*ZERO     WL0055  50
     C                     Z-ADD*ZERO     WL0056  52
     C                     Z-ADD*ZERO     WL0057  50
     C                     MOVEL*BLANK    WL0058 12
     C                     Z-ADD*ZERO     WL0059  70
     C                     MOVEL*BLANK    WL0060 12
     C                     MOVEL*BLANK    WL0061  2
     C                     MOVEL*BLANK    WL0062  3
     C                     MOVEL*BLANK    WL0063  2
     C                     Z-ADD*ZERO     WL0064  70
     C                     MOVEL*BLANK    WL0065  3
     C                     MOVEL*BLANK    WL0066  1
     C                     Z-ADD*ZERO     WL0067  70
     C                     MOVEL*BLANK    WL0068  1
     C                     Z-ADD*ZERO     WL0069  70
     C                     Z-ADD*ZERO     WL0070  60
     C                     Z-ADD*ZERO     WL0071  70
     C                     Z-ADD*ZERO     WL0072  60
     C                     Z-ADD*ZERO     WL0073  70
     C                     Z-ADD*ZERO     WL0074  60
     C                     Z-ADD*ZERO     WL0075  70
     C                     Z-ADD*ZERO     WL0076  60
     C                     Z-ADD*ZERO     WL0077  70
     C                     Z-ADD*ZERO     WL0078  60
     C                     Z-ADD*ZERO     WL0079  70
     C                     Z-ADD*ZERO     WL0080  60
     C                     Z-ADD*ZERO     WL0081  70
     C                     Z-ADD*ZERO     WL0082  60
     C                     MOVEL*BLANK    WL0083  3
     C                     MOVEL*BLANK    WL0084 20
     C                     MOVEL*BLANK    WL0085 30
     C                     Z-ADD*ZERO     WL0086  50
     C                     Z-ADD*ZERO     WL0087  70
     C                     MOVEL*BLANK    WL0088 12
     C                     MOVEL*BLANK    WL0089 20
     C                     Z-ADD*ZERO     WL0090  70
     C                     MOVEL*BLANK    WL0091 12
     C                     Z-ADD*ZERO     WL0092  70
     C                     Z-ADD*ZERO     WL0093  60
     C                     Z-ADD*ZERO     WL0094  70
     C                     Z-ADD*ZERO     WL0095  60
     C                     Z-ADD*ZERO     WL0096 112
     C                     Z-ADD*ZERO     WL0097  70
     C                     Z-ADD*ZERO     WL0098  60
     C                     MOVEL*BLANK    WL0099  1
     C                     MOVEL*BLANK    WL0100  1
     C                     Z-ADD*ZERO     WL0101  70
     C                     Z-ADD*ZERO     WL0102  70
     C                     MOVEL*BLANK    WL0103  1
     C                     MOVEL*BLANK    WL0104  3
     C                     Z-ADD*ZERO     WL0105  70
     C                     Z-ADD*ZERO     WL0106  60
     C                     Z-ADD*ZERO     WL0107  70
     C                     Z-ADD*ZERO     WL0108  60
     C                     MOVEL*BLANK    WL0109  1
     C                     MOVEL*BLANK    WL0110  1
     C                     MOVEL*BLANK    WL0111 15
     C                     MOVEL*BLANK    WL0112 25
     C                     MOVEL*BLANK    WL0113 20
     C                     Z-ADD*ZERO     WL0114  70
     C                     MOVEL*BLANK    WL0115  1
     C                     MOVEL*BLANK    WL0116  1
     C                     Z-ADD*ZERO     WL0117  70
     C                     Z-ADD*ZERO     WL0118  60
     C                     Z-ADD*ZERO     WL0119  50
     C                     Z-ADD*ZERO     WL0120  92
     C                     Z-ADD*ZERO     WL0121  92
     C                     MOVEL*BLANK    WL0122  1
     C                     MOVEL*BLANK    WL0123 25
     C                     Z-ADD*ZERO     WL0124  70
     C                     Z-ADD*ZERO     WL0125  60
     C                     Z-ADD*ZERO     WL0126  70
     C                     Z-ADD*ZERO     WL0127  60
     C                     MOVEL*BLANK    WL0128  1
     C                     MOVEL*BLANK    WL0129  1
     C                     MOVEL*BLANK    WL0130  1
     C                     MOVEL*BLANK    WL0131  1
     C                     Z-ADD*ZERO     WL0132 112
     C                     MOVEL*BLANK    WL0133 15
     C                     MOVEL*BLANK    WL0134 15
     C                     MOVEL*BLANK    WL0135 25
     C                     MOVEL*BLANK    WL0136 25
     C                     MOVEL*BLANK    WL0137  1
     C                     MOVEL*BLANK    WL0138  1
     C                     MOVEL*BLANK    WL0139  1
     C                     MOVEL*BLANK    WL0140  1
     C                     MOVEL*BLANK    WL0141  1
     C                     MOVEL*BLANK    WL0142  1
     C                     MOVEL*BLANK    WL0143  2
     C                     MOVEL*BLANK    WL0144  2
     C                     MOVEL*BLANK    WL0145  2
     C                     MOVEL*BLANK    WL0146  3
     C                     MOVEL*BLANK    WL0147  3
     C                     Z-ADD*ZERO     WL0148  70
     C                     Z-ADD*ZERO     WL0149  60
     C                     Z-ADD*ZERO     WL0150  70
     C                     Z-ADD*ZERO     WL0151  60
     C                     Z-ADD*ZERO     WL0152  70
     C                     Z-ADD*ZERO     WL0153  60
     C                     Z-ADD*ZERO     WL0154  70
     C                     Z-ADD*ZERO     WL0155  60
     C                     Z-ADD*ZERO     WL0156  70
     C                     Z-ADD*ZERO     WL0157  60
     C                     Z-ADD*ZERO     WL0158  70
     C                     Z-ADD*ZERO     WL0159  60
     C                     MOVEL*BLANK    WL0160  1
     C                     MOVEL*BLANK    WL0161  1
     C                     MOVEL*BLANK    WL0162  1
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0163  30
     C                     Z-ADD*ZERO     WL0164  70
     C                     MOVEL*BLANK    WL0165  2
     C                     Z-ADD*ZERO     WL0166  70
     C                     Z-ADD*ZERO     WL0167  70
     C                     MOVEL*BLANK    WL0168 30
     C                     MOVEL*BLANK    WL0169 30
     C                     MOVEL*BLANK    WL0170 30
     C                     MOVEL*BLANK    WL0171 30
     C                     MOVEL*BLANK    WL0172 20
     C                     MOVEL*BLANK    WL0173  2
     C                     MOVEL*BLANK    WL0174 11
     C                     Z-ADD*ZERO     WL0175  70
     C                     MOVEL*BLANK    WL0176 30
     C                     MOVEL*BLANK    WL0177 30
     C                     MOVEL*BLANK    WL0178 30
     C                     MOVEL*BLANK    WL0179 30
     C                     MOVEL*BLANK    WL0180 20
     C                     MOVEL*BLANK    WL0181  2
     C                     MOVEL*BLANK    WL0182 11
     C                     MOVEL*BLANK    WL0183 15
     C                     Z-ADD*ZERO     WL0184  70
     C                     Z-ADD*ZERO     WL0185  70
     C                     Z-ADD*ZERO     WL0186  70
     C                     Z-ADD*ZERO     WL0187  70
     C                     MOVEL*BLANK    WL0188  2
     C                     MOVEL*BLANK    WL0189 40
     C                     MOVEL*BLANK    WL0190 40
     C                     MOVEL*BLANK    WL0191  3
     C                     MOVEL*BLANK    WL0192  1
     C                     MOVEL*BLANK    WL0193  1
     C                     MOVEL*BLANK    WL0194  1
     C                     MOVEL*BLANK    WL0195  1
     C                     MOVEL*BLANK    WL0196  3
     C                     MOVEL*BLANK    WL0197  1
     C                     MOVEL*BLANK    WL0198  1
     C                     MOVEL*BLANK    WL0199  1
     C                     MOVEL*BLANK    WL0200  1
     C                     Z-ADD*ZERO     WL0201  70
     C                     MOVEL*BLANK    WL0202 10
     C                     Z-ADD*ZERO     WL0203  70
     C                     Z-ADD*ZERO     WL0204 112
     C                     Z-ADD*ZERO     WL0205 112
     C                     MOVEL*BLANK    WL0206  1
     C                     MOVEL*BLANK    WL0207  1
     C                     MOVEL*BLANK    WL0208  1
     C                     Z-ADD*ZERO     WL0209  70
     C                     Z-ADD*ZERO     WL0210  40
     C                     MOVEL*BLANK    WL0211  4
     C                     MOVEL*BLANK    WL0212 12
     C                     Z-ADD*ZERO     WL0213  70
     C                     Z-ADD*ZERO     WL0214  52
     C                     Z-ADD*ZERO     WL0215 112
     C                     MOVEL*BLANK    WL0216  1
     C                     MOVEL*BLANK    WL0217  1
     C                     MOVEL*BLANK    WL0218  1
     C                     MOVEL*BLANK    WL0219  2
     C                     MOVEL*BLANK    WL0220  1
     C                     MOVEL*BLANK    WL0221  1
     C                     MOVEL*BLANK    WL0222  1
     C                     MOVEL*BLANK    WL0223  1
     C                     MOVEL*BLANK    WL0224  1
     C                     Z-ADD*ZERO     WL0225  52
     C                     MOVEL*BLANK    WL0226  1
     C                     Z-ADD*ZERO     WL0227  70
     C                     MOVEL*BLANK    WL0228  1
     C                     MOVEL*BLANK    WL0229  1
     C                     Z-ADD*ZERO     WL0230  70
     C                     MOVEL*BLANK    WL0231 30
     C                     MOVEL*BLANK    WL0232 30
     C                     MOVEL*BLANK    WL0233  1
     C                     MOVEL*BLANK    WL0234  3
     C                     MOVEL*BLANK    WL0235  2
     C                     MOVEL*BLANK    WL0236  3
     C                     Z-ADD*ZERO     WL0237  70
     C                     MOVEL*BLANK    WL0238  3
     C                     Z-ADD*ZERO     WL0239  70
     C                     MOVEL*BLANK    WL0240  2
     C                     Z-ADD*ZERO     WL0241  70
     C                     MOVEL*BLANK    WL0242  2
     C                     MOVEL*BLANK    WL0243  1
     C                     MOVEL*BLANK    WL0244  1
     C                     Z-ADD*ZERO     WL0245 112
     C                     MOVEL*BLANK    WL0246  1
     C                     MOVEL*BLANK    WL0247  1
     C                     MOVEL*BLANK    WL0248  1
     C                     MOVEL*BLANK    WL0249  1
     C                     MOVEL*BLANK    WL0250  1
     C                     MOVEL*BLANK    WL0251  1
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0252  30
     C                     Z-ADD*ZERO     WL0253  70
     C                     MOVEL*BLANK    WL0254  6
      * Define local variables for subroutine SERVGN.
     C                     Z-ADD*ZERO     WL0255  30
     C                     Z-ADD*ZERO     WL0256  70
     C                     MOVEL*BLANK    WL0257  3
      * Define local variables for subroutine SFRVGN.
     C                     MOVEL*BLANK    WL0258  3
     C                     MOVEL*BLANK    WL0259  2
     C                     MOVEL*BLANK    WL0260  1
     C                     Z-ADD*ZERO     WL0261  52
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0262  70
     C                     Z-ADD*ZERO     WL0263  50
     C                     Z-ADD*ZERO     WL0264  50
     C                     MOVEL*BLANK    WL0265 30
     C                     Z-ADD*ZERO     WL0266  50
     C                     Z-ADD*ZERO     WL0267  72
     C                     Z-ADD*ZERO     WL0268  70
     C                     Z-ADD*ZERO     WL0269 112
     C                     Z-ADD*ZERO     WL0270  72
     C                     Z-ADD*ZERO     WL0271 112
     C                     Z-ADD*ZERO     WL0272  30
     C                     Z-ADD*ZERO     WL0273  70
     C                     MOVEL*BLANK    WL0274  1
     C                     Z-ADD*ZERO     WL0275  70
     C                     Z-ADD*ZERO     WL0276  60
     C                     Z-ADD*ZERO     WL0277  70
     C                     Z-ADD*ZERO     WL0278  60
     C                     MOVEL*BLANK    WL0279 30
     C                     MOVEL*BLANK    WL0280 10
     C                     Z-ADD*ZERO     WL0281  70
     C                     Z-ADD*ZERO     WL0282  60
     C                     Z-ADD*ZERO     WL0283  70
     C                     Z-ADD*ZERO     WL0284  60
     C                     Z-ADD*ZERO     WL0285  70
     C                     Z-ADD*ZERO     WL0286  60
     C                     Z-ADD*ZERO     WL0287  70
     C                     Z-ADD*ZERO     WL0288  60
     C                     Z-ADD*ZERO     WL0289  70
     C                     MOVEL*BLANK    WL0290  1
     C                     MOVEL*BLANK    WL0291  1
     C                     MOVEL*BLANK    WL0292 15
     C                     MOVEL*BLANK    WL0293 15
     C                     MOVEL*BLANK    WL0294 15
     C                     MOVEL*BLANK    WL0295 15
     C                     MOVEL*BLANK    WL0296 15
     C                     Z-ADD*ZERO     WL0297  70
     C                     Z-ADD*ZERO     WL0298  70
     C                     Z-ADD*ZERO     WL0299  70
     C                     Z-ADD*ZERO     WL0300  60
     C                     Z-ADD*ZERO     WL0301  60
     C                     Z-ADD*ZERO     WL0302  60
     C                     MOVEL*BLANK    WL0303  1
     C                     MOVEL*BLANK    WL0304  1
     C                     MOVEL*BLANK    WL0305  2
     C                     MOVEL*BLANK    WL0306 15
     C                     MOVEL*BLANK    WL0307 25
     C                     MOVEL*BLANK    WL0308 25
     C                     MOVEL*BLANK    WL0309  1
     C                     MOVEL*BLANK    WL0310  1
     C                     MOVEL*BLANK    WL0311  1
      * Define local variables for subroutine SHRVGN.
     C                     MOVEL*BLANK    WL0312  3
     C                     MOVEL*BLANK    WL0313 30
     C                     MOVEL*BLANK    WL0314  1
      * Define local variables for subroutine SJRVGN.
     C                     Z-ADD*ZERO     WL0315  30
     C                     MOVEL*BLANK    WL0316 30
     C                     MOVEL*BLANK    WL0317 30
     C                     MOVEL*BLANK    WL0318 30
     C                     MOVEL*BLANK    WL0319 30
     C                     MOVEL*BLANK    WL0320 20
     C                     MOVEL*BLANK    WL0321 11
     C                     MOVEL*BLANK    WL0322  2
      * Define local variables for subroutine SKRVGN.
     C                     MOVEL*BLANK    WL0323  3
     C                     MOVEL*BLANK    WL0324 20
     C                     MOVEL*BLANK    WL0325 25
     C                     MOVEL*BLANK    WL0326 25
     C                     MOVEL*BLANK    WL0327 25
     C                     MOVEL*BLANK    WL0328  2
     C                     MOVEL*BLANK    WL0329 11
     C                     Z-ADD*ZERO     WL0330 110
     C                     MOVEL*BLANK    WL0331 25
      * Define local variables for subroutine SNCHRC.
     C                     Z-ADD*ZERO     WL0332  70
     C                     MOVEL*BLANK    WL0333 20
     C                     MOVEL*BLANK    WL0334 12
     C                     Z-ADD*ZERO     WL0335  60
     C                     MOVEL*BLANK    WL0336 10
     C                     MOVEL*BLANK    WL0337 10
     C                     Z-ADD*ZERO     WL0338  70
      * Define local variables for subroutine SOCHRC.
     C                     Z-ADD*ZERO     WL0339  70
     C                     MOVEL*BLANK    WL0340  3
     C                     Z-ADD*ZERO     WL0341  60
     C                     MOVEL*BLANK    WL0342 10
     C                     MOVEL*BLANK    WL0343 10
     C                     Z-ADD*ZERO     WL0344  70
      * Define local variables for subroutine SRRVGN.
     C                     MOVEL*BLANK    WL0345  3
     C                     MOVEL*BLANK    WL0346 20
     C                     Z-ADD*ZERO     WL0347  30
     C                     MOVEL*BLANK    WL0348  1
     C                     MOVEL*BLANK    WL0349  1
     C                     MOVEL*BLANK    WL0350  1
     C                     MOVEL*BLANK    WL0351  1
     C                     Z-ADD*ZERO     WL0352  70
     C                     Z-ADD*ZERO     WL0353  60
     C                     MOVEL*BLANK    WL0354  1
     C                     MOVEL*BLANK    WL0355  1
     C                     MOVEL*BLANK    WL0356  3
     C                     MOVEL*BLANK    WL0357 30
     C                     MOVEL*BLANK    WL0358  1
      * Define local variables for subroutine SXCRRC.
     C                     Z-ADD*ZERO     WL0359  30
     C                     Z-ADD*ZERO     WL0360  70
     C                     Z-ADD*ZERO     WL0361  70
     C                     Z-ADD*ZERO     WL0362  50
     C                     MOVEL*BLANK    WL0363  3
     C                     MOVEL*BLANK    WL0364 20
     C                     MOVEL*BLANK    WL0365 25
     C                     MOVEL*BLANK    WL0366 30
     C                     MOVEL*BLANK    WL0367 15
     C                     MOVEL*BLANK    WL0368 15
     C                     MOVEL*BLANK    WL0369 20
     C                     Z-ADD*ZERO     WL0370  70
     C                     Z-ADD*ZERO     WL0371  70
     C                     Z-ADD*ZERO     WL0372  70
     C                     MOVEL*BLANK    WL0373  3
     C                     MOVEL*BLANK    WL0374  1
     C                     MOVEL*BLANK    WL0375 12
     C                     MOVEL*BLANK    WL0376 35
     C                     MOVEL*BLANK    WL0377 75
     C                     Z-ADD*ZERO     WL0378 110
     C                     Z-ADD*ZERO     WL0379 110
     C                     Z-ADD*ZERO     WL0380 110
     C                     Z-ADD*ZERO     WL0381 110
     C                     Z-ADD*ZERO     WL0382 112
     C                     Z-ADD*ZERO     WL0383 112
     C                     Z-ADD*ZERO     WL0384 112
     C                     Z-ADD*ZERO     WL0385  70
     C                     Z-ADD*ZERO     WL0386  70
     C                     Z-ADD*ZERO     WL0387  70
     C                     Z-ADD*ZERO     WL0388  70
     C                     MOVEL*BLANK    WL0389  4
     C                     MOVEL*BLANK    WL0390  4
     C                     MOVEL*BLANK    WL0391  4
     C                     MOVEL*BLANK    WL0392  2
     C                     MOVEL*BLANK    WL0393  2
     C                     MOVEL*BLANK    WL0394  2
     C                     MOVEL*BLANK    WL0395  3
     C                     MOVEL*BLANK    WL0396  3
     C                     MOVEL*BLANK    WL0397  3
     C                     MOVEL*BLANK    WL0398  5
     C                     MOVEL*BLANK    WL0399  5
     C                     Z-ADD*ZERO     WL0400  50
     C                     MOVEL*BLANK    WL0401 38
     C                     MOVEL*BLANK    WL0402  6
     C                     MOVEL*BLANK    WL0403  6
     C                     MOVEL*BLANK    WL0404  6
     C                     MOVEL*BLANK    WL0405  6
     C                     MOVEL*BLANK    WL0406  6
     C                     MOVEL*BLANK    WL0407  1
     C                     MOVEL*BLANK    WL0408  1
     C                     MOVEL*BLANK    WL0409 10
     C                     MOVEL*BLANK    WL0410 10
     C                     MOVEL*BLANK    WL0411 10
     C                     MOVEL*BLANK    WL0412 15
     C                     MOVEL*BLANK    WL0413 15
     C                     MOVEL*BLANK    WL0414 15
     C                     MOVEL*BLANK    WL0415 30
     C                     MOVEL*BLANK    WL0416 30
     C                     MOVEL*BLANK    WL0417 30
     C                     MOVEL*BLANK    WL0418 50
     C                     MOVEL*BLANK    WL0419 50
     C                     Z-ADD*ZERO     WL0420  30
     C                     Z-ADD*ZERO     WL0421  30
     C                     Z-ADD*ZERO     WL0422  30
     C                     Z-ADD*ZERO     WL0423  52
     C                     Z-ADD*ZERO     WL0424  52
     C                     Z-ADD*ZERO     WL0425  50
     C                     Z-ADD*ZERO     WL0426  60
     C                     Z-ADD*ZERO     WL0427  60
     C                     Z-ADD*ZERO     WL0428  60
     C                     Z-ADD*ZERO     WL0429  60
     C                     Z-ADD*ZERO     WL0430  90
     C                     Z-ADD*ZERO     WL0431  90
     C                     Z-ADD*ZERO     WL0432  90
     C                     Z-ADD*ZERO     WL0433  96
     C                     MOVEL*BLANK    WL0434 15
     C                     MOVEL*BLANK    WL0435  1
     C                     MOVEL*BLANK    WL0436  1
     C                     MOVEL*BLANK    WL0437  2
     C                     MOVEL*BLANK    WL0438  2
     C                     MOVEL*BLANK    WL0439  5
     C                     MOVEL*BLANK    WL0440  5
     C                     MOVEL*BLANK    WL0441 15
     C                     MOVEL*BLANK    WL0442 15
     C                     MOVEL*BLANK    WL0443 30
     C                     Z-ADD*ZERO     WL0444  70
     C                     Z-ADD*ZERO     WL0445  70
     C                     MOVEL*BLANK    WL0446  1
     C                     MOVEL*BLANK    WL0447  1
     C                     MOVEL*BLANK    WL0448  1
     C                     MOVEL*BLANK    WL0449  1
     C                     Z-ADD*ZERO     WL0450  60
     C                     MOVEL*BLANK    WL0451 10
     C                     MOVEL*BLANK    WL0452 10
     C                     Z-ADD*ZERO     WL0453  70
     C                     MOVEL*BLANK    WL0454 20
     C                     MOVEL*BLANK    WL0455  3
     C                     MOVEL*BLANK    WL0456  1
     C                     MOVEL*BLANK    WL0457  1
     C                     MOVEL*BLANK    WL0458  6
     C                     Z-ADD*ZERO     WL0459  50
     C                     MOVEL*BLANK    WL0460  4
     C                     Z-ADD*ZERO     WL0461  50
     C                     MOVEL*BLANK    WL0462  2
      * Define local variables for subroutine SZCRRC.
     C                     MOVEL*BLANK    WL0463  3
     C                     MOVEL*BLANK    WL0464 20
     C                     Z-ADD*ZERO     WL0465  30
     C                     MOVEL*BLANK    WL0466  1
     C                     MOVEL*BLANK    WL0467  1
     C                     MOVEL*BLANK    WL0468  1
     C                     MOVEL*BLANK    WL0469  1
     C                     Z-ADD*ZERO     WL0470  70
     C                     Z-ADD*ZERO     WL0471  60
     C                     MOVEL*BLANK    WL0472  1
     C                     MOVEL*BLANK    WL0473  1
     C                     MOVEL*BLANK    WL0474  3
     C                     MOVEL*BLANK    WL0475 30
     C                     MOVEL*BLANK    WL0476  1
     C                     MOVEL*BLANK    WL0477  1
     C                     MOVEL*BLANK    WL0478  1
     C                     MOVEL*BLANK    WL0479  1
     C                     MOVEL*BLANK    WL0480  1
     C                     Z-ADD*ZERO     WL0481  70
     C                     Z-ADD*ZERO     WL0482  70
     C                     Z-ADD*ZERO     WL0483  70
     C                     Z-ADD*ZERO     WL0484  70
     C                     Z-ADD*ZERO     WL0485  70
     C                     MOVEL*BLANK    WL0486  1
     C                     MOVEL*BLANK    WL0487  1
     C                     MOVEL*BLANK    WL0488  1
     C                     MOVEL*BLANK    WL0489  1
     C                     Z-ADD*ZERO     WL0490  60
     C                     MOVEL*BLANK    WL0491 10
     C                     MOVEL*BLANK    WL0492 10
     C                     Z-ADD*ZERO     WL0493  70
      * Define local variables for subroutine TBRVGN.
     C                     MOVEL*BLANK    WL0494  3
     C                     MOVEL*BLANK    WL0495 20
     C                     Z-ADD*ZERO     WL0496  30
     C                     MOVEL*BLANK    WL0497  1
     C                     MOVEL*BLANK    WL0498  1
     C                     MOVEL*BLANK    WL0499  1
     C                     MOVEL*BLANK    WL0500  1
     C                     Z-ADD*ZERO     WL0501  70
     C                     Z-ADD*ZERO     WL0502  60
     C                     MOVEL*BLANK    WL0503  1
     C                     MOVEL*BLANK    WL0504  1
     C                     MOVEL*BLANK    WL0505  3
     C                     MOVEL*BLANK    WL0506 30
     C                     MOVEL*BLANK    WL0507  1
     C                     Z-ADD*ZERO     WL0508  60
     C                     MOVEL*BLANK    WL0509 10
     C                     MOVEL*BLANK    WL0510 10
     C                     Z-ADD*ZERO     WL0511  70
      * Define local variables for subroutine TERVGN.
     C                     MOVEL*BLANK    WL0512 10
     C                     MOVEL*BLANK    WL0513  6
     C                     Z-ADD*ZERO     WL0514  30
     C                     MOVEL*BLANK    WL0515  3
      * Define local work field Order Type_Sales
     C                     MOVEL*BLANK    YL0001  2
      * Define local work field Ship To Customer
     C                     Z-ADD*ZERO     YL0002  70
      * Define local work field Ship To Name
     C                     MOVEL*BLANK    YL0003 30
      * Define local work field Ship To City
     C                     MOVEL*BLANK    YL0004 20
      * Define local work field Ship To State Code
     C                     MOVEL*BLANK    YL0005  2
      * Define local work field Order Date
     C                     Z-ADD*ZERO     YL0006  70
      * Define local work field Actual Shipped Date
     C                     Z-ADD*ZERO     YL0007  70
      * Define null work field Carrier Code
     C                     MOVEL*BLANK    YN0001  3
      * Define local work field Order in Use
     C                     MOVEL*BLANK    YL0008  1
      * Define local work field Header Status
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field Credit Hold
     C                     MOVEL*BLANK    YL0010  1
      * Define local work field Production Hold
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field Export Status
     C                     MOVEL*BLANK    YL0012  1
      * Define local work field Billing Activity Type
     C                     MOVEL*BLANK    YL0013  1
      * Define local work field Block Order Flag
     C                     MOVEL*BLANK    YL0014  1
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0015  30
      * Define local work field LTL Flag
     C                     MOVEL*BLANK    YL0016  1
      * Define local work field Load Status
     C                     MOVEL*BLANK    YL0017  1
      * Define local work field Reefer Temperature
     C                     Z-ADD*ZERO     YL0018  52
      * Define local work field Seal 4
     C                     MOVEL*BLANK    YL0019 15
      * Define local work field Seal 2 Unused
     C                     MOVEL*BLANK    YL0020 15
      * Define local work field Total Load Order Weight
     C                     Z-ADD*ZERO     YL0021  70
      * Define local work field Flat Amount
     C                     Z-ADD*ZERO     YL0022 112
      * Define local work field Allocate Pounds_Miles
     C                     MOVEL*BLANK    YL0023  1
      * Define local work field Total Stops
     C                     Z-ADD*ZERO     YL0024  50
      * Define local work field BOL Time
     C                     Z-ADD*ZERO     YL0025  40
      * Define local work field Truck Size
     C                     MOVEL*BLANK    YL0026  7
      * Define local work field Ld Hdr_Ld Dtl Unused
     C                     Z-ADD*ZERO     YL0027  70
      * Define local work field Rated Freight
     C                     Z-ADD*ZERO     YL0028 112
      * Define local work field Load Type
     C                     MOVEL*BLANK    YL0029  1
      * Define local work field Number Pallets Received
     C                     Z-ADD*ZERO     YL0030  50
      * Define local work field Number Pallets Loaded
     C                     Z-ADD*ZERO     YL0031  50
      * Define local work field Load Carrier Pay Amt
     C                     Z-ADD*ZERO     YL0032 112
      * Define local work field Estimated Arrival Time
     C                     Z-ADD*ZERO     YL0033  60
      * Define local work field Actual Arrival Date
     C                     Z-ADD*ZERO     YL0034  70
      * Define local work field Actual Arrival Time
     C                     Z-ADD*ZERO     YL0035  40
      * Define local work field Trailer IN Weight
     C                     Z-ADD*ZERO     YL0036 112
      * Define local work field Trailer OUT Weight
     C                     Z-ADD*ZERO     YL0037 112
      * Define local work field Actual Departure Date
     C                     Z-ADD*ZERO     YL0038  70
      * Define local work field Departure Time
     C                     Z-ADD*ZERO     YL0039  40
      * Define local work field Schedule Sequence Number
     C                     Z-ADD*ZERO     YL0040  50
      * Define local work field Product Temperature
     C                     Z-ADD*ZERO     YL0041  52
      * Define local work field Number Spacers Loaded
     C                     Z-ADD*ZERO     YL0042  50
      * Define local work field Car_Veh. Initials
     C                     MOVEL*BLANK    YL0043 12
      * Define local work field Total Load Miles
     C                     Z-ADD*ZERO     YL0044  70
      * Define local work field Recorder ID
     C                     MOVEL*BLANK    YL0045 12
      * Define local work field Ship From Warehouse
     C                     MOVEL*BLANK    YL0046  3
      * Define local work field Gross Weight
     C                     Z-ADD*ZERO     YL0047  70
      * Define local work field Carrier Broker
     C                     MOVEL*BLANK    YL0048  3
      * Define local work field On Time (Y_N)
     C                     MOVEL*BLANK    YL0049  1
      * Define local work field Truck Ready Date
     C                     Z-ADD*ZERO     YL0050  70
      * Define local work field Truck Ready Time
     C                     Z-ADD*ZERO     YL0051  60
      * Define local work field Spotted Date
     C                     Z-ADD*ZERO     YL0052  70
      * Define local work field Spotted Time
     C                     Z-ADD*ZERO     YL0053  60
      * Define local work field Load Finished Date
     C                     Z-ADD*ZERO     YL0054  70
      * Define local work field Load Finished Time
     C                     Z-ADD*ZERO     YL0055  60
      * Define local work field BOL Complete Date
     C                     Z-ADD*ZERO     YL0056  70
      * Define local work field BOL Complete Time
     C                     Z-ADD*ZERO     YL0057  60
      * Define local work field BOL Received Date
     C                     Z-ADD*ZERO     YL0058  70
      * Define local work field BOL Received Time
     C                     Z-ADD*ZERO     YL0059  60
      * Define local work field Truck Departure Date
     C                     Z-ADD*ZERO     YL0060  70
      * Define local work field Truck Departure Time
     C                     Z-ADD*ZERO     YL0061  60
      * Define local work field Adjusted Departure Date
     C                     Z-ADD*ZERO     YL0062  70
      * Define local work field Adjusted Departure Time
     C                     Z-ADD*ZERO     YL0063  60
      * Define local work field Shipping Line
     C                     MOVEL*BLANK    YL0064  3
      * Define local work field Port Delv Terminal
     C                     MOVEL*BLANK    YL0065 20
      * Define local work field Vessel Name
     C                     MOVEL*BLANK    YL0066 30
      * Define null work field Voyage
     C                     Z-ADD*ZERO     YN0002  50
      * Define local work field Sail Date
     C                     Z-ADD*ZERO     YL0067  70
      * Define local work field Booking Number
     C                     MOVEL*BLANK    YL0068 12
      * Define local work field Discharge Port
     C                     MOVEL*BLANK    YL0069 20
      * Define local work field Arrival Date
     C                     Z-ADD*ZERO     YL0070  70
      * Define local work field Container Number
     C                     MOVEL*BLANK    YL0071 12
      * Define local work field Date In
     C                     Z-ADD*ZERO     YL0072  70
      * Define local work field Time In
     C                     Z-ADD*ZERO     YL0073  60
      * Define local work field Date Out
     C                     Z-ADD*ZERO     YL0074  70
      * Define local work field Time Out
     C                     Z-ADD*ZERO     YL0075  60
      * Define local work field Load Total Freight
     C                     Z-ADD*ZERO     YL0076 112
      * Define local work field Scheduled Delivery Date
     C                     Z-ADD*ZERO     YL0077  70
      * Define local work field Scheduled Delivery Time
     C                     Z-ADD*ZERO     YL0078  60
      * Define local work field LH Unused Sts
     C                     MOVEL*BLANK    YL0079  1
      * Define local work field LH Carrier Payment Sts
     C                     MOVEL*BLANK    YL0080  1
      * Define local work field Bring Back Miles
     C                     Z-ADD*ZERO     YL0081  70
      * Define local work field Requested Delivery Date
     C                     Z-ADD*ZERO     YL0082  70
      * Define local work field Load Acceptance Flag
     C                     MOVEL*BLANK    YL0083  1
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0084  3
      * Define local work field On Yard Date
     C                     Z-ADD*ZERO     YL0085  70
      * Define local work field On Yard Time
     C                     Z-ADD*ZERO     YL0086  60
      * Define local work field Deadline Departure Time
     C                     Z-ADD*ZERO     YL0087  60
      * Define local work field Load Held Over
     C                     MOVEL*BLANK    YL0088  1
      * Define local work field Load Held Over Reason
     C                     MOVEL*BLANK    YL0089  1
      * Define local work field Load Held Over Rsn Cmt
     C                     MOVEL*BLANK    YL0090 15
      * Define local work field Ocean BOL Number
     C                     MOVEL*BLANK    YL0091 25
      * Define local work field Express Mail Number
     C                     MOVEL*BLANK    YL0092 20
      * Define local work field Express Mail Date
     C                     Z-ADD*ZERO     YL0093  70
      * Define local work field Load Shag Flag
     C                     MOVEL*BLANK    YL0094  1
      * Define local work field Load Wash Flag
     C                     MOVEL*BLANK    YL0095  1
      * Define local work field Product Complete Date
     C                     Z-ADD*ZERO     YL0096  70
      * Define local work field Product Complete Time
     C                     Z-ADD*ZERO     YL0097  60
      * Define local work field Pallets Loaded
     C                     Z-ADD*ZERO     YL0098  50
      * Define local work field Avg Pallet Tare
     C                     Z-ADD*ZERO     YL0099  92
      * Define local work field Tot Pallet Tare
     C                     Z-ADD*ZERO     YL0100  92
      * Define local work field Load Confirmed Sts
     C                     MOVEL*BLANK    YL0101  1
      * Define local work field Load Confirmed Contact
     C                     MOVEL*BLANK    YL0102 25
      * Define local work field Load Confirmation Time
     C                     Z-ADD*ZERO     YL0103  70
      * Define local work field Load Door 1
     C                     Z-ADD*ZERO     YL0104  60
      * Define local work field Override Total Load Miles
     C                     Z-ADD*ZERO     YL0105  70
      * Define local work field Load Door 2
     C                     Z-ADD*ZERO     YL0106  60
      * Define local work field Partial Load
     C                     MOVEL*BLANK    YL0107  1
      * Define local work field Load Confirmation Fax Sts
     C                     MOVEL*BLANK    YL0108  1
      * Define local work field Export Load USDA OK
     C                     MOVEL*BLANK    YL0109  1
      * Define local work field Late Delivery Email Flag
     C                     MOVEL*BLANK    YL0110  1
      * Define local work field Load Actual Freight
     C                     Z-ADD*ZERO     YL0111 112
      * Define local work field Hide on WW Load Sts
     C                     MOVEL*BLANK    YL0112 15
      * Define local work field Late Billing Email Flag
     C                     MOVEL*BLANK    YL0113 15
      * Define local work field Shipping Temp C_F txt
     C                     MOVEL*BLANK    YL0114 25
      * Define local work field LH Held Over Rsn Cmt
     C                     MOVEL*BLANK    YL0115 25
      * Define local work field Multi Company Load
     C                     MOVEL*BLANK    YL0116  1
      * Define local work field Fax Sent to SSI Carrier
     C                     MOVEL*BLANK    YL0117  1
      * Define local work field Schedule Pos Load Grade
     C                     MOVEL*BLANK    YL0118  1
      * Define local work field LH Power Only Load
     C                     MOVEL*BLANK    YL0119  1
      * Define local work field MG Created Load
     C                     MOVEL*BLANK    YL0120  1
      * Define local work field LH Unused Sts 5
     C                     MOVEL*BLANK    YL0121  1
      * Define local work field Load U_M
     C                     MOVEL*BLANK    YL0122  2
      * Define local work field TPM Shipment Status
     C                     MOVEL*BLANK    YL0123  2
      * Define local work field LH Unused Sts 8
     C                     MOVEL*BLANK    YL0124  2
      * Define local work field LH On-Time Reason Code
     C                     MOVEL*BLANK    YL0125  3
      * Define local work field LH Held Over Reason
     C                     MOVEL*BLANK    YL0126  3
      * Define local work field LH Carrier Paid Dte
     C                     Z-ADD*ZERO     YL0127  70
      * Define local work field LH Carrier Paid Time
     C                     Z-ADD*ZERO     YL0128  60
      * Define local work field LH Last Combo Prod Date
     C                     Z-ADD*ZERO     YL0129  70
      * Define local work field LH Last Combo Prod Time
     C                     Z-ADD*ZERO     YL0130  60
      * Define local work field LPT Load Plan Start Dt
     C                     Z-ADD*ZERO     YL0131  70
      * Define local work field LPT Load Plan Start Tm
     C                     Z-ADD*ZERO     YL0132  60
      * Define local work field TPM Planned Ship Date
     C                     Z-ADD*ZERO     YL0133  70
      * Define local work field LH Unused Time 4
     C                     Z-ADD*ZERO     YL0134  60
      * Define local work field LH Unused Date 5
     C                     Z-ADD*ZERO     YL0135  70
      * Define local work field LH Unused Time 5
     C                     Z-ADD*ZERO     YL0136  60
      * Define local work field LH Unused Date 6
     C                     Z-ADD*ZERO     YL0137  70
      * Define local work field LH Unused Time 6
     C                     Z-ADD*ZERO     YL0138  60
      * Define local work field EDI Status 1
     C                     MOVEL*BLANK    YL0139  1
      * Define local work field EDI Status 2
     C                     MOVEL*BLANK    YL0140  1
      * Define local work field EDI Status 3
     C                     MOVEL*BLANK    YL0141  1
      * Define local work field AR Customer Number
     C                     Z-ADD*ZERO     YL0142  70
      * Define local work field Ship To Address Line 1
     C                     MOVEL*BLANK    YL0143 30
      * Define local work field Ship To Address Line 2
     C                     MOVEL*BLANK    YL0144 30
      * Define local work field Ship To Address Line 3
     C                     MOVEL*BLANK    YL0145 30
      * Define local work field Ship To Zip_Postal Code
     C                     MOVEL*BLANK    YL0146 11
      * Define local work field Bill to Customer
     C                     Z-ADD*ZERO     YL0147  70
      * Define local work field Bill to Name
     C                     MOVEL*BLANK    YL0148 30
      * Define local work field Bill to Address Line 1
     C                     MOVEL*BLANK    YL0149 30
      * Define local work field Bill to Address Line 2
     C                     MOVEL*BLANK    YL0150 30
      * Define local work field Bill to Address Line 3
     C                     MOVEL*BLANK    YL0151 30
      * Define local work field Bill to City
     C                     MOVEL*BLANK    YL0152 20
      * Define local work field Bill to State Code
     C                     MOVEL*BLANK    YL0153  2
      * Define local work field Bill to Zip_Postal Code
     C                     MOVEL*BLANK    YL0154 11
      * Define local work field Customer Purchase Order #
     C                     MOVEL*BLANK    YL0155 15
      * Define local work field Requested Ship Date
     C                     Z-ADD*ZERO     YL0156  70
      * Define local work field Cancel Date
     C                     Z-ADD*ZERO     YL0157  70
      * Define local work field Terms Code
     C                     MOVEL*BLANK    YL0158  2
      * Define local work field Special Instructions
     C                     MOVEL*BLANK    YL0159 40
      * Define local work field Special Instructions 2
     C                     MOVEL*BLANK    YL0160 40
      * Define local work field Carrier Code
     C                     MOVEL*BLANK    YL0161  3
      * Define local work field Comment Print Acknowledge
     C                     MOVEL*BLANK    YL0162  1
      * Define local work field Comment Print Inv_Cr.Memo
     C                     MOVEL*BLANK    YL0163  1
      * Define local work field Comment Print Pick Slip
     C                     MOVEL*BLANK    YL0164  1
      * Define local work field Comment Print Ship Doc
     C                     MOVEL*BLANK    YL0165  1
      * Define local work field Reason Code
     C                     MOVEL*BLANK    YL0166  3
      * Define local work field Header Status Last
     C                     MOVEL*BLANK    YL0167  1
      * Define local work field Order Type Print Status
     C                     MOVEL*BLANK    YL0168  1
      * Define local work field Scheduled Ship Date
     C                     Z-ADD*ZERO     YL0169  70
      * Define local work field User Original Entry
     C                     MOVEL*BLANK    YL0170 10
      * Define local work field Date of Original Entry
     C                     Z-ADD*ZERO     YL0171  70
      * Define local work field Order Value Total
     C                     Z-ADD*ZERO     YL0172 112
      * Define local work field Order Weight Total
     C                     Z-ADD*ZERO     YL0173 112
      * Define local work field New Customer Hold
     C                     MOVEL*BLANK    YL0174  1
      * Define local work field Accounts Receiv. Ent 1
     C                     MOVEL*BLANK    YL0175  4
      * Define local work field Accounts Receiv. Ent 2
     C                     MOVEL*BLANK    YL0176 12
      * Define local work field Load ID
     C                     Z-ADD*ZERO     YL0177  70
      * Define local work field Absorbed Freight Rate CWT
     C                     Z-ADD*ZERO     YL0178  52
      * Define local work field Price Audit
     C                     MOVEL*BLANK    YL0179  1
      * Define local work field Price Status
     C                     MOVEL*BLANK    YL0180  1
      * Define local work field Shipping Method
     C                     MOVEL*BLANK    YL0181  2
      * Define local work field Palletize
     C                     MOVEL*BLANK    YL0182  1
      * Define local work field Shrink Wrap
     C                     MOVEL*BLANK    YL0183  1
      * Define local work field Slip Sheet
     C                     MOVEL*BLANK    YL0184  1
      * Define local work field Age Code
     C                     MOVEL*BLANK    YL0185  1
      * Define local work field Attach to Invoice Number
     C                     Z-ADD*ZERO     YL0186  70
      * Define local work field Load Plan Order
     C                     MOVEL*BLANK    YL0187  1
      * Define local work field Print Pick Slip
     C                     MOVEL*BLANK    YL0188  1
      * Define local work field Resell Reference Number
     C                     Z-ADD*ZERO     YL0189  70
      * Define local work field Special Comment 1
     C                     MOVEL*BLANK    YL0190 30
      * Define local work field Special Comment 2
     C                     MOVEL*BLANK    YL0191 30
      * Define local work field Affect Auto Accruals
     C                     MOVEL*BLANK    YL0192  1
      * Define local work field Sales Route Code
     C                     MOVEL*BLANK    YL0193  3
      * Define local work field Manager Level Code
     C                     MOVEL*BLANK    YL0194  2
      * Define local work field VP Level Code
     C                     MOVEL*BLANK    YL0195  3
      * Define local work field Attach to Order Number
     C                     Z-ADD*ZERO     YL0196  70
      * Define local work field Reason for Price Audit
     C                     MOVEL*BLANK    YL0197  3
      * Define local work field Invoice Number
     C                     Z-ADD*ZERO     YL0198  70
      * Define local work field Invoice Suffix
     C                     MOVEL*BLANK    YL0199  2
      * Define local work field Invoice Date
     C                     Z-ADD*ZERO     YL0200  70
      * Define local work field Event Code
     C                     MOVEL*BLANK    YL0201  2
      * Define local work field Trans Contol AS400_Plant
     C                     MOVEL*BLANK    YL0202  1
      * Define local work field Modified Flag
     C                     MOVEL*BLANK    YL0203  1
      * Define local work field A/R order Value Total
     C                     Z-ADD*ZERO     YL0204 112
      * Define local work field Order Certification Flag
     C                     MOVEL*BLANK    YL0205  1
      * Define local work field Country Code
     C                     MOVEL*BLANK    YL0206  6
      * Define null work field Warehouse Std Chill Time
     C                     MOVEL*BLANK    YN0003  1
      * Define null work field Warehouse Chill Time
     C                     Z-ADD*ZERO     YN0004  52
      * Define local work field Stop_Drop
     C                     Z-ADD*ZERO     YL0207  50
      * Define local work field Comments for Pickup
     C                     MOVEL*BLANK    YL0208 30
      * Define local work field Miles to next stop
     C                     Z-ADD*ZERO     YL0209  50
      * Define local work field Freight Charge
     C                     Z-ADD*ZERO     YL0210  72
      * Define local work field Freight Misc. Charge
     C                     Z-ADD*ZERO     YL0211 112
      * Define local work field Freight Stop Charge
     C                     Z-ADD*ZERO     YL0212  72
      * Define local work field Estimated Arrival Date
     C                     Z-ADD*ZERO     YL0213  70
      * Define local work field Appointment Confirm Date
     C                     Z-ADD*ZERO     YL0214  70
      * Define local work field Appointment Confirm Time
     C                     Z-ADD*ZERO     YL0215  60
      * Define local work field Confirmation Made With
     C                     MOVEL*BLANK    YL0216 30
      * Define local work field Confirmation Number
     C                     MOVEL*BLANK    YL0217 10
      * Define local work field Actual Delivery Date
     C                     Z-ADD*ZERO     YL0218  70
      * Define local work field Actual Delivery time
     C                     Z-ADD*ZERO     YL0219  60
      * Define null work field Deadline Depart DT    HDR
     C                     Z-ADD*ZERO     YN0005  70
      * Define null work field Deadline Depart Time  HDR
     C                     Z-ADD*ZERO     YN0006  60
      * Define local work field MPC Number
     C                     Z-ADD*ZERO     YL0220  70
      * Define local work field Load Dtl On Time Flag
     C                     MOVEL*BLANK    YL0221  1
      * Define local work field On Time Addl Rsn Unused
     C                     MOVEL*BLANK    YL0222  1
      * Define local work field Seal Nbr 1
     C                     MOVEL*BLANK    YL0223 15
      * Define local work field Seal Nbr 2
     C                     MOVEL*BLANK    YL0224 15
      * Define local work field Seal Nbr 3
     C                     MOVEL*BLANK    YL0225 15
      * Define local work field Seal Nbr 4
     C                     MOVEL*BLANK    YL0226 15
      * Define local work field Seal Nbr 5
     C                     MOVEL*BLANK    YL0227 15
      * Define local work field LD Carrier Appt Date
     C                     Z-ADD*ZERO     YL0228  70
      * Define local work field LD Unused Date 2
     C                     Z-ADD*ZERO     YL0229  70
      * Define local work field LD Unused Date 3
     C                     Z-ADD*ZERO     YL0230  70
      * Define local work field LD Carrier Appt Time
     C                     Z-ADD*ZERO     YL0231  60
      * Define local work field LD Unused Time 2
     C                     Z-ADD*ZERO     YL0232  60
      * Define local work field LD Unused Time 3
     C                     Z-ADD*ZERO     YL0233  60
      * Define local work field Miles Error Sts
     C                     MOVEL*BLANK    YL0234  1
      * Define local work field LD Unused Sts 2
     C                     MOVEL*BLANK    YL0235  1
      * Define local work field HPB Transload Station
     C                     MOVEL*BLANK    YL0236  2
      * Define local work field LD Cst Svc Tracer Cmmnt
     C                     MOVEL*BLANK    YL0237 15
      * Define local work field Carrier Ref PRO_Inv
     C                     MOVEL*BLANK    YL0238 25
      * Define local work field Cust Assigned Appt #
     C                     MOVEL*BLANK    YL0239 25
      * Define local work field Case Sensitive Field
     C                     MOVEL*BLANK    YL0240 30
      * Define local work field Case Upper Field
     C                     MOVEL*BLANK    YL0241 30
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0007  1
      * Define local work field Record Status
     C                     MOVEL*BLANK    YL0242  1
      * Define null work field Address Line 1
     C                     MOVEL*BLANK    YN0008 30
      * Define null work field Address Line 2
     C                     MOVEL*BLANK    YN0009 30
      * Define null work field Address Line 3
     C                     MOVEL*BLANK    YN0010 30
      * Define null work field City
     C                     MOVEL*BLANK    YN0011 20
      * Define null work field Zip Postal Code
     C                     MOVEL*BLANK    YN0012 11
      * Define null work field State Code
     C                     MOVEL*BLANK    YN0013  2
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0014  1
      * Define null work field Company Number
     C                     Z-ADD*ZERO     YN0015  30
      * Define null work field Seal 4
     C                     MOVEL*BLANK    YN0016 15
      * Define null work field Seal 2 Unused
     C                     MOVEL*BLANK    YN0017 15
      * Define local work field Actual Ship Date
     C                     Z-ADD*ZERO     YL0243  70
      * Define null work field Shipping Line
     C                     MOVEL*BLANK    YN0018  3
      * Define null work field Port Delv Terminal
     C                     MOVEL*BLANK    YN0019 20
      * Define null work field Vessel Name
     C                     MOVEL*BLANK    YN0020 30
      * Define null work field Sail Date
     C                     Z-ADD*ZERO     YN0021  70
      * Define null work field Booking Number
     C                     MOVEL*BLANK    YN0022 12
      * Define null work field Discharge Port
     C                     MOVEL*BLANK    YN0023 20
      * Define null work field Ocean BOL Number
     C                     MOVEL*BLANK    YN0024 25
      * Define null work field Order Type_Sales
     C                     MOVEL*BLANK    YN0025  2
      * Define null work field AR Customer Number
     C                     Z-ADD*ZERO     YN0026  70
      * Define null work field Bill to Customer
     C                     Z-ADD*ZERO     YN0027  70
      * Define null work field Bill to Name
     C                     MOVEL*BLANK    YN0028 30
      * Define null work field Bill to Address Line 1
     C                     MOVEL*BLANK    YN0029 30
      * Define null work field Bill to Address Line 2
     C                     MOVEL*BLANK    YN0030 30
      * Define null work field Bill to Address Line 3
     C                     MOVEL*BLANK    YN0031 30
      * Define null work field Bill to City
     C                     MOVEL*BLANK    YN0032 20
      * Define null work field Bill to State Code
     C                     MOVEL*BLANK    YN0033  2
      * Define null work field Bill to Zip_Postal Code
     C                     MOVEL*BLANK    YN0034 11
      * Define null work field Customer Purchase Order #
     C                     MOVEL*BLANK    YN0035 15
      * Define null work field Order Date
     C                     Z-ADD*ZERO     YN0036  70
      * Define null work field Requested Ship Date
     C                     Z-ADD*ZERO     YN0037  70
      * Define null work field Cancel Date
     C                     Z-ADD*ZERO     YN0038  70
      * Define null work field Terms Code
     C                     MOVEL*BLANK    YN0039  2
      * Define null work field Comment Print Acknowledge
     C                     MOVEL*BLANK    YN0040  1
      * Define null work field Comment Print Inv_Cr.Memo
     C                     MOVEL*BLANK    YN0041  1
      * Define null work field Comment Print Pick Slip
     C                     MOVEL*BLANK    YN0042  1
      * Define null work field Comment Print Ship Doc
     C                     MOVEL*BLANK    YN0043  1
      * Define null work field Reason Code
     C                     MOVEL*BLANK    YN0044  3
      * Define null work field Order in Use
     C                     MOVEL*BLANK    YN0045  1
      * Define null work field Header Status
     C                     MOVEL*BLANK    YN0046  1
      * Define null work field Header Status Last
     C                     MOVEL*BLANK    YN0047  1
      * Define null work field Order Type Print Status
     C                     MOVEL*BLANK    YN0048  1
      * Define null work field User Original Entry
     C                     MOVEL*BLANK    YN0049 10
      * Define null work field Date of Original Entry
     C                     Z-ADD*ZERO     YN0050  70
      * Define null work field Order Value Total
     C                     Z-ADD*ZERO     YN0051 112
      * Define null work field Order Weight Total
     C                     Z-ADD*ZERO     YN0052 112
      * Define null work field Credit Hold
     C                     MOVEL*BLANK    YN0053  1
      * Define null work field Production Hold
     C                     MOVEL*BLANK    YN0054  1
      * Define null work field New Customer Hold
     C                     MOVEL*BLANK    YN0055  1
      * Define null work field Accounts Receiv. Ent 1
     C                     MOVEL*BLANK    YN0056  4
      * Define null work field Accounts Receiv. Ent 2
     C                     MOVEL*BLANK    YN0057 12
      * Define null work field Load ID
     C                     Z-ADD*ZERO     YN0058  70
      * Define null work field Absorbed Freight Rate CWT
     C                     Z-ADD*ZERO     YN0059  52
      * Define null work field Rated Freight
     C                     Z-ADD*ZERO     YN0060 112
      * Define null work field LTL Flag
     C                     MOVEL*BLANK    YN0061  1
      * Define null work field Price Audit
     C                     MOVEL*BLANK    YN0062  1
      * Define null work field Price Status
     C                     MOVEL*BLANK    YN0063  1
      * Define null work field Palletize
     C                     MOVEL*BLANK    YN0064  1
      * Define null work field Shrink Wrap
     C                     MOVEL*BLANK    YN0065  1
      * Define null work field Slip Sheet
     C                     MOVEL*BLANK    YN0066  1
      * Define null work field Age Code
     C                     MOVEL*BLANK    YN0067  1
      * Define null work field Reefer Temperature
     C                     Z-ADD*ZERO     YN0068  52
      * Define null work field Load Type
     C                     MOVEL*BLANK    YN0069  1
      * Define null work field Attach to Invoice Number
     C                     Z-ADD*ZERO     YN0070  70
      * Define null work field Load Plan Order
     C                     MOVEL*BLANK    YN0071  1
      * Define null work field Print Pick Slip
     C                     MOVEL*BLANK    YN0072  1
      * Define null work field Resell Reference Number
     C                     Z-ADD*ZERO     YN0073  70
      * Define null work field Affect Auto Accruals
     C                     MOVEL*BLANK    YN0074  1
      * Define null work field Sales Route Code
     C                     MOVEL*BLANK    YN0075  3
      * Define null work field Manager Level Code
     C                     MOVEL*BLANK    YN0076  2
      * Define null work field VP Level Code
     C                     MOVEL*BLANK    YN0077  3
      * Define null work field Attach to Order Number
     C                     Z-ADD*ZERO     YN0078  70
      * Define null work field Reason for Price Audit
     C                     MOVEL*BLANK    YN0079  3
      * Define null work field Invoice Number
     C                     Z-ADD*ZERO     YN0080  70
      * Define null work field Invoice Suffix
     C                     MOVEL*BLANK    YN0081  2
      * Define null work field Invoice Date
     C                     Z-ADD*ZERO     YN0082  70
      * Define null work field Event Code
     C                     MOVEL*BLANK    YN0083  2
      * Define null work field Trans Contol AS400_Plant
     C                     MOVEL*BLANK    YN0084  1
      * Define null work field Modified Flag
     C                     MOVEL*BLANK    YN0085  1
      * Define null work field A/R order Value Total
     C                     Z-ADD*ZERO     YN0086 112
      * Define null work field Billing Activity Type
     C                     MOVEL*BLANK    YN0087  1
      * Define null work field Block Order Flag
     C                     MOVEL*BLANK    YN0088  1
      * Define null work field Order Certification Flag
     C                     MOVEL*BLANK    YN0089  1
      * Define null work field EDI Status 1
     C                     MOVEL*BLANK    YN0090  1
      * Define null work field EDI Status 2
     C                     MOVEL*BLANK    YN0091  1
      * Define null work field EDI Status 3
     C                     MOVEL*BLANK    YN0092  1
      * Define null work field Stop_Drop
     C                     Z-ADD*ZERO     YN0093  50
      * Define null work field Comments for Pickup
     C                     MOVEL*BLANK    YN0094 30
      * Define null work field Miles to next stop
     C                     Z-ADD*ZERO     YN0095  50
      * Define null work field Freight Charge
     C                     Z-ADD*ZERO     YN0096  72
      * Define null work field Ld Hdr_Ld Dtl Unused
     C                     Z-ADD*ZERO     YN0097  70
      * Define null work field Freight Misc. Charge
     C                     Z-ADD*ZERO     YN0098 112
      * Define null work field Freight Stop Charge
     C                     Z-ADD*ZERO     YN0099  72
      * Define null work field Estimated Arrival Date
     C                     Z-ADD*ZERO     YN0100  70
      * Define null work field Estimated Arrival Time
     C                     Z-ADD*ZERO     YN0101  60
      * Define null work field Appointment Confirm Date
     C                     Z-ADD*ZERO     YN0102  70
      * Define null work field Appointment Confirm Time
     C                     Z-ADD*ZERO     YN0103  60
      * Define null work field Confirmation Made With
     C                     MOVEL*BLANK    YN0104 30
      * Define null work field Confirmation Number
     C                     MOVEL*BLANK    YN0105 10
      * Define null work field Actual Delivery Date
     C                     Z-ADD*ZERO     YN0106  70
      * Define null work field Actual Delivery time
     C                     Z-ADD*ZERO     YN0107  60
      * Define null work field Scheduled Delivery Date
     C                     Z-ADD*ZERO     YN0108  70
      * Define null work field Scheduled Delivery Time
     C                     Z-ADD*ZERO     YN0109  60
      * Define null work field On Yard Date
     C                     Z-ADD*ZERO     YN0110  70
      * Define null work field On Yard Time
     C                     Z-ADD*ZERO     YN0111  60
      * Define null work field MPC Number
     C                     Z-ADD*ZERO     YN0112  70
      * Define null work field Load Dtl On Time Flag
     C                     MOVEL*BLANK    YN0113  1
      * Define null work field On Time Addl Rsn Unused
     C                     MOVEL*BLANK    YN0114  1
      * Define null work field Seal Nbr 1
     C                     MOVEL*BLANK    YN0115 15
      * Define null work field Seal Nbr 2
     C                     MOVEL*BLANK    YN0116 15
      * Define null work field Seal Nbr 3
     C                     MOVEL*BLANK    YN0117 15
      * Define null work field Seal Nbr 4
     C                     MOVEL*BLANK    YN0118 15
      * Define null work field Seal Nbr 5
     C                     MOVEL*BLANK    YN0119 15
      * Define null work field LD Carrier Appt Date
     C                     Z-ADD*ZERO     YN0120  70
      * Define null work field LD Unused Date 2
     C                     Z-ADD*ZERO     YN0121  70
      * Define null work field LD Unused Date 3
     C                     Z-ADD*ZERO     YN0122  70
      * Define null work field LD Carrier Appt Time
     C                     Z-ADD*ZERO     YN0123  60
      * Define null work field LD Unused Time 2
     C                     Z-ADD*ZERO     YN0124  60
      * Define null work field LD Unused Time 3
     C                     Z-ADD*ZERO     YN0125  60
      * Define null work field Miles Error Sts
     C                     MOVEL*BLANK    YN0126  1
      * Define null work field LD Unused Sts 2
     C                     MOVEL*BLANK    YN0127  1
      * Define null work field HPB Transload Station
     C                     MOVEL*BLANK    YN0128  2
      * Define null work field LD Cst Svc Tracer Cmmnt
     C                     MOVEL*BLANK    YN0129 15
      * Define null work field Carrier Ref PRO_Inv
     C                     MOVEL*BLANK    YN0130 25
      * Define null work field Cust Assigned Appt #
     C                     MOVEL*BLANK    YN0131 25
      * Define local work field Requested Delivery Time
     C                     Z-ADD*ZERO     YL0244  40
      * Define local work field Stop_Drop Sequence Number
     C                     Z-ADD*ZERO     YL0245  50
      * Define local work field Port Address Line 1
     C                     MOVEL*BLANK    YL0246 25
      * Define local work field Port Address Line 2
     C                     MOVEL*BLANK    YL0247 25
      * Define local work field Port Zip/Postal Code
     C                     MOVEL*BLANK    YL0248 11
      * Define local work field Port Phone Number
     C                     Z-ADD*ZERO     YL0249 110
      * Define local work field Port Fax Number
     C                     MOVEL*BLANK    YL0250 25
      * Define local work field Record Selected       USR
     C                     MOVEL*BLANK    YL0251  1
      * Define local work field Last Name
     C                     MOVEL*BLANK    YL0252 20
      * Define local work field First Name
     C                     MOVEL*BLANK    YL0253 12
      * Define local work field TD Notes
     C                     MOVEL*BLANK    YL0254 50
      * Define null work field OHE Carrier Nm
     C                     MOVEL*BLANK    YN0132 30
      * Define local work field Return Code Usr
     C                     MOVEL*BLANK    YL0255  7
      * Define local work field CBP Foreign Port Code
     C                     Z-ADD*ZERO     YL0256  50
      * Define local work field Seal 1
     C                     MOVEL*BLANK    YL0257 15
      * Define local work field Seal 2
     C                     MOVEL*BLANK    YL0258 15
      * Define local work field Seal 3
     C                     MOVEL*BLANK    YL0259 15
      * Define local work field Trailer Id
     C                     MOVEL*BLANK    YL0260 20
      * Define local work field Transloader Carrier Code
     C                     MOVEL*BLANK    YL0261  3
      * Define local work field Ship Status
     C                     MOVEL*BLANK    YL0262  1
      * Define local work field Deadline Departure Date
     C                     Z-ADD*ZERO     YL0263  70
      * Define local work field USR Load Type
     C                     MOVEL*BLANK    YL0264  1
      * Define local work field Trailer Type
     C                     MOVEL*BLANK    YL0265  1
      * Define local work field Seaboard Owned Status
     C                     MOVEL*BLANK    YL0266  1
      * Define local work field On Yard Status
     C                     MOVEL*BLANK    YL0267  1
      * Define local work field Assigned Status
     C                     MOVEL*BLANK    YL0268  1
      * Define local work field Available Status
     C                     MOVEL*BLANK    YL0269  1
      * Define local work field Not Available Reason Code
     C                     MOVEL*BLANK    YL0270  3
      * Define local work field Comment Line
     C                     MOVEL*BLANK    YL0271 30
      * Define local work field Load ID USR
     C                     Z-ADD*ZERO     YL0272  70
      * Define local work field Load Id 2
     C                     Z-ADD*ZERO     YL0273  70
      * Define local work field Load Id 3
     C                     Z-ADD*ZERO     YL0274  70
      * Define local work field Status Flag 10 Y/N
     C                     MOVEL*BLANK    YL0275  1
      * Define local work field EDI Interchange Active U
     C                     MOVEL*BLANK    YL0276  1
      * Define local work field Generic Message 80 USR
     C                     MOVEL*BLANK    YL0277 80
      * Define local work field Orders have Same Booking#
     C                     MOVEL*BLANK    YL0278  1
      * Define local work field Same Booking# USR
     C                     MOVEL*BLANK    YL0279  1
      * Define local work field Same Booking# Count U
     C                     Z-ADD*ZERO     YL0280  30
      * Define local work field Not Same Booking# Count U
     C                     Z-ADD*ZERO     YL0281  30
      * Define local work field OHE Booking Number
     C                     MOVEL*BLANK    YL0282 15
      * Define local work field OHE Override Type Code
     C                     MOVEL*BLANK    YL0283  2
      * Define local work field CBP Export Port Code
     C                     Z-ADD*ZERO     YL0284  50
      * Define local work field CBP Std Carrier Alpha Cde
     C                     MOVEL*BLANK    YL0285  4
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0286  30
      * Define null work field Scheduled Ship Date
     C                     Z-ADD*ZERO     YN0133  70
      * Define null work field LTL Flag
     C                     MOVEL*BLANK    YN0134  1
      * Define null work field Load Status
     C                     MOVEL*BLANK    YN0135  1
      * Define null work field Reefer Temperature
     C                     Z-ADD*ZERO     YN0136  52
      * Define null work field Seal 1
     C                     MOVEL*BLANK    YN0137 15
      * Define null work field Seal 2
     C                     MOVEL*BLANK    YN0138 15
      * Define null work field Seal 3
     C                     MOVEL*BLANK    YN0139 15
      * Define null work field Seal 4
     C                     MOVEL*BLANK    YN0140 15
      * Define null work field Seal 2 Unused
     C                     MOVEL*BLANK    YN0141 15
      * Define null work field Total Load Order Weight
     C                     Z-ADD*ZERO     YN0142  70
      * Define null work field Flat Amount
     C                     Z-ADD*ZERO     YN0143 112
      * Define null work field Allocate Pounds_Miles
     C                     MOVEL*BLANK    YN0144  1
      * Define null work field Total Stops
     C                     Z-ADD*ZERO     YN0145  50
      * Define null work field Trailer Id
     C                     MOVEL*BLANK    YN0146 20
      * Define null work field Transloader Carrier Code
     C                     MOVEL*BLANK    YN0147  3
      * Define null work field BOL Time
     C                     Z-ADD*ZERO     YN0148  40
      * Define local work field Carrier Code
     C                     MOVEL*BLANK    YL0287  3
      * Define null work field Truck Size
     C                     MOVEL*BLANK    YN0149  7
      * Define null work field Ld Hdr_Ld Dtl Unused
     C                     Z-ADD*ZERO     YN0150  70
      * Define null work field Rated Freight
     C                     Z-ADD*ZERO     YN0151 112
      * Define null work field Ship Status
     C                     MOVEL*BLANK    YN0152  1
      * Define local work field Load Type
     C                     MOVEL*BLANK    YL0288  1
      * Define null work field Number Pallets Received
     C                     Z-ADD*ZERO     YN0153  50
      * Define null work field Number Pallets Loaded
     C                     Z-ADD*ZERO     YN0154  50
      * Define null work field Load Carrier Pay Amt
     C                     Z-ADD*ZERO     YN0155 112
      * Define null work field Estimated Arrival Time
     C                     Z-ADD*ZERO     YN0156  60
      * Define null work field Actual Arrival Date
     C                     Z-ADD*ZERO     YN0157  70
      * Define null work field Actual Arrival Time
     C                     Z-ADD*ZERO     YN0158  40
      * Define null work field Trailer IN Weight
     C                     Z-ADD*ZERO     YN0159 112
      * Define null work field Trailer OUT Weight
     C                     Z-ADD*ZERO     YN0160 112
      * Define null work field Actual Departure Date
     C                     Z-ADD*ZERO     YN0161  70
      * Define null work field Departure Time
     C                     Z-ADD*ZERO     YN0162  40
      * Define null work field Schedule Sequence Number
     C                     Z-ADD*ZERO     YN0163  50
      * Define null work field Product Temperature
     C                     Z-ADD*ZERO     YN0164  52
      * Define null work field Number Spacers Loaded
     C                     Z-ADD*ZERO     YN0165  50
      * Define null work field Car_Veh. Initials
     C                     MOVEL*BLANK    YN0166 12
      * Define null work field Total Load Miles
     C                     Z-ADD*ZERO     YN0167  70
      * Define null work field Recorder ID
     C                     MOVEL*BLANK    YN0168 12
      * Define null work field Shipping Method
     C                     MOVEL*BLANK    YN0169  2
      * Define null work field Ship From Warehouse
     C                     MOVEL*BLANK    YN0170  3
      * Define null work field Ship To State Code
     C                     MOVEL*BLANK    YN0171  2
      * Define null work field Gross Weight
     C                     Z-ADD*ZERO     YN0172  70
      * Define null work field Carrier Broker
     C                     MOVEL*BLANK    YN0173  3
      * Define null work field Export Status
     C                     MOVEL*BLANK    YN0174  1
      * Define null work field Actual Ship Date
     C                     Z-ADD*ZERO     YN0175  70
      * Define null work field On Time (Y_N)
     C                     MOVEL*BLANK    YN0176  1
      * Define null work field Truck Ready Date
     C                     Z-ADD*ZERO     YN0177  70
      * Define null work field Truck Ready Time
     C                     Z-ADD*ZERO     YN0178  60
      * Define null work field Spotted Date
     C                     Z-ADD*ZERO     YN0179  70
      * Define null work field Spotted Time
     C                     Z-ADD*ZERO     YN0180  60
      * Define null work field Load Finished Date
     C                     Z-ADD*ZERO     YN0181  70
      * Define null work field Load Finished Time
     C                     Z-ADD*ZERO     YN0182  60
      * Define null work field BOL Complete Date
     C                     Z-ADD*ZERO     YN0183  70
      * Define null work field BOL Complete Time
     C                     Z-ADD*ZERO     YN0184  60
      * Define null work field BOL Received Date
     C                     Z-ADD*ZERO     YN0185  70
      * Define null work field BOL Received Time
     C                     Z-ADD*ZERO     YN0186  60
      * Define null work field Truck Departure Date
     C                     Z-ADD*ZERO     YN0187  70
      * Define null work field Truck Departure Time
     C                     Z-ADD*ZERO     YN0188  60
      * Define null work field Adjusted Departure Date
     C                     Z-ADD*ZERO     YN0189  70
      * Define null work field Adjusted Departure Time
     C                     Z-ADD*ZERO     YN0190  60
      * Define local work field Shipping Line
     C                     MOVEL*BLANK    YL0289  3
      * Define null work field Port Delv Terminal
     C                     MOVEL*BLANK    YN0191 20
      * Define null work field Vessel Name
     C                     MOVEL*BLANK    YN0192 30
      * Define null work field Voyage
     C                     Z-ADD*ZERO     YN0193  50
      * Define null work field Sail Date
     C                     Z-ADD*ZERO     YN0194  70
      * Define null work field Booking Number
     C                     MOVEL*BLANK    YN0195 12
      * Define null work field Discharge Port
     C                     MOVEL*BLANK    YN0196 20
      * Define null work field Arrival Date
     C                     Z-ADD*ZERO     YN0197  70
      * Define null work field Container Number
     C                     MOVEL*BLANK    YN0198 12
      * Define null work field Date In
     C                     Z-ADD*ZERO     YN0199  70
      * Define null work field Time In
     C                     Z-ADD*ZERO     YN0200  60
      * Define null work field Date Out
     C                     Z-ADD*ZERO     YN0201  70
      * Define null work field Time Out
     C                     Z-ADD*ZERO     YN0202  60
      * Define null work field Load Total Freight
     C                     Z-ADD*ZERO     YN0203 112
      * Define null work field Scheduled Delivery Date
     C                     Z-ADD*ZERO     YN0204  70
      * Define null work field Scheduled Delivery Time
     C                     Z-ADD*ZERO     YN0205  60
      * Define null work field LH Unused Sts
     C                     MOVEL*BLANK    YN0206  1
      * Define null work field LH Carrier Payment Sts
     C                     MOVEL*BLANK    YN0207  1
      * Define null work field Bring Back Miles
     C                     Z-ADD*ZERO     YN0208  70
      * Define null work field Requested Delivery Date
     C                     Z-ADD*ZERO     YN0209  70
      * Define null work field Load Acceptance Flag
     C                     MOVEL*BLANK    YN0210  1
      * Define null work field Warehouse Code
     C                     MOVEL*BLANK    YN0211  3
      * Define null work field On Yard Date
     C                     Z-ADD*ZERO     YN0212  70
      * Define null work field On Yard Time
     C                     Z-ADD*ZERO     YN0213  60
      * Define null work field Deadline Departure Date
     C                     Z-ADD*ZERO     YN0214  70
      * Define null work field Deadline Departure Time
     C                     Z-ADD*ZERO     YN0215  60
      * Define null work field Load Held Over
     C                     MOVEL*BLANK    YN0216  1
      * Define null work field Load Held Over Reason
     C                     MOVEL*BLANK    YN0217  1
      * Define null work field Load Held Over Rsn Cmt
     C                     MOVEL*BLANK    YN0218 15
      * Define null work field Ocean BOL Number
     C                     MOVEL*BLANK    YN0219 25
      * Define null work field Express Mail Number
     C                     MOVEL*BLANK    YN0220 20
      * Define null work field Express Mail Date
     C                     Z-ADD*ZERO     YN0221  70
      * Define null work field Load Shag Flag
     C                     MOVEL*BLANK    YN0222  1
      * Define null work field Load Wash Flag
     C                     MOVEL*BLANK    YN0223  1
      * Define null work field Product Complete Date
     C                     Z-ADD*ZERO     YN0224  70
      * Define null work field Product Complete Time
     C                     Z-ADD*ZERO     YN0225  60
      * Define null work field Pallets Loaded
     C                     Z-ADD*ZERO     YN0226  50
      * Define null work field Avg Pallet Tare
     C                     Z-ADD*ZERO     YN0227  92
      * Define null work field Tot Pallet Tare
     C                     Z-ADD*ZERO     YN0228  92
      * Define null work field Load Confirmed Sts
     C                     MOVEL*BLANK    YN0229  1
      * Define null work field Load Confirmed Contact
     C                     MOVEL*BLANK    YN0230 25
      * Define null work field Load Confirmation Time
     C                     Z-ADD*ZERO     YN0231  70
      * Define null work field Load Door 1
     C                     Z-ADD*ZERO     YN0232  60
      * Define null work field Override Total Load Miles
     C                     Z-ADD*ZERO     YN0233  70
      * Define null work field Load Door 2
     C                     Z-ADD*ZERO     YN0234  60
      * Define null work field Partial Load
     C                     MOVEL*BLANK    YN0235  1
      * Define null work field Load Confirmation Fax Sts
     C                     MOVEL*BLANK    YN0236  1
      * Define null work field Export Load USDA OK
     C                     MOVEL*BLANK    YN0237  1
      * Define null work field Late Delivery Email Flag
     C                     MOVEL*BLANK    YN0238  1
      * Define null work field Load Actual Freight
     C                     Z-ADD*ZERO     YN0239 112
      * Define null work field Hide on WW Load Sts
     C                     MOVEL*BLANK    YN0240 15
      * Define null work field Late Billing Email Flag
     C                     MOVEL*BLANK    YN0241 15
      * Define null work field Shipping Temp C_F txt
     C                     MOVEL*BLANK    YN0242 25
      * Define null work field LH Held Over Rsn Cmt
     C                     MOVEL*BLANK    YN0243 25
      * Define null work field Multi Company Load
     C                     MOVEL*BLANK    YN0244  1
      * Define null work field Fax Sent to SSI Carrier
     C                     MOVEL*BLANK    YN0245  1
      * Define null work field Schedule Pos Load Grade
     C                     MOVEL*BLANK    YN0246  1
      * Define null work field LH Power Only Load
     C                     MOVEL*BLANK    YN0247  1
      * Define null work field MG Created Load
     C                     MOVEL*BLANK    YN0248  1
      * Define null work field LH Unused Sts 5
     C                     MOVEL*BLANK    YN0249  1
      * Define null work field Load U_M
     C                     MOVEL*BLANK    YN0250  2
      * Define null work field TPM Shipment Status
     C                     MOVEL*BLANK    YN0251  2
      * Define null work field LH Unused Sts 8
     C                     MOVEL*BLANK    YN0252  2
      * Define null work field LH On-Time Reason Code
     C                     MOVEL*BLANK    YN0253  3
      * Define null work field LH Held Over Reason
     C                     MOVEL*BLANK    YN0254  3
      * Define null work field LH Carrier Paid Dte
     C                     Z-ADD*ZERO     YN0255  70
      * Define null work field LH Carrier Paid Time
     C                     Z-ADD*ZERO     YN0256  60
      * Define null work field LH Last Combo Prod Date
     C                     Z-ADD*ZERO     YN0257  70
      * Define null work field LH Last Combo Prod Time
     C                     Z-ADD*ZERO     YN0258  60
      * Define null work field LPT Load Plan Start Dt
     C                     Z-ADD*ZERO     YN0259  70
      * Define null work field LPT Load Plan Start Tm
     C                     Z-ADD*ZERO     YN0260  60
      * Define null work field TPM Planned Ship Date
     C                     Z-ADD*ZERO     YN0261  70
      * Define null work field LH Unused Time 4
     C                     Z-ADD*ZERO     YN0262  60
      * Define null work field LH Unused Date 5
     C                     Z-ADD*ZERO     YN0263  70
      * Define null work field LH Unused Time 5
     C                     Z-ADD*ZERO     YN0264  60
      * Define null work field LH Unused Date 6
     C                     Z-ADD*ZERO     YN0265  70
      * Define null work field LH Unused Time 6
     C                     Z-ADD*ZERO     YN0266  60
      * Define null work field EDI Status 1
     C                     MOVEL*BLANK    YN0267  1
      * Define null work field EDI Status 2
     C                     MOVEL*BLANK    YN0268  1
      * Define null work field EDI Status 3
     C                     MOVEL*BLANK    YN0269  1
      * Define local work field Trailer Type
     C                     MOVEL*BLANK    YL0290  1
      * Define local work field Seaboard Owned Status
     C                     MOVEL*BLANK    YL0291  1
      * Define local work field On Yard Status
     C                     MOVEL*BLANK    YL0292  1
      * Define local work field On Yard Date
     C                     Z-ADD*ZERO     YL0293  70
      * Define local work field On Yard Time
     C                     Z-ADD*ZERO     YL0294  60
      * Define local work field Assigned Status
     C                     MOVEL*BLANK    YL0295  1
      * Define local work field Available Status
     C                     MOVEL*BLANK    YL0296  1
      * Define local work field Not Available Reason Code
     C                     MOVEL*BLANK    YL0297  3
      * Define local work field Comment Line
     C                     MOVEL*BLANK    YL0298 30
      * Define local work field Record Status
     C                     MOVEL*BLANK    YL0299  1
      * Define local work field Status Unused 1
     C                     MOVEL*BLANK    YL0300  1
      * Define local work field Status Unused 2
     C                     MOVEL*BLANK    YL0301  1
      * Define local work field Status Unused 3
     C                     MOVEL*BLANK    YL0302  1
      * Define local work field Status Unused 4
     C                     MOVEL*BLANK    YL0303  1
      * Define local work field Status Unused 5
     C                     MOVEL*BLANK    YL0304  1
      * Define local work field Create EDI 601 USR
     C                     MOVEL*BLANK    YL0305  1
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0306  30
      * Define local work field Load Type
     C                     MOVEL*BLANK    YL0307  1
      * Define local work field Trailer Type
     C                     MOVEL*BLANK    YL0308  1
      * Define local work field Seaboard Owned Status
     C                     MOVEL*BLANK    YL0309  1
      * Define local work field On Yard Status
     C                     MOVEL*BLANK    YL0310  1
      * Define local work field On Yard Date
     C                     Z-ADD*ZERO     YL0311  70
      * Define local work field On Yard Time
     C                     Z-ADD*ZERO     YL0312  60
      * Define local work field Assigned Status
     C                     MOVEL*BLANK    YL0313  1
      * Define local work field Available Status
     C                     MOVEL*BLANK    YL0314  1
      * Define local work field Not Available Reason Code
     C                     MOVEL*BLANK    YL0315  3
      * Define local work field Comment Line
     C                     MOVEL*BLANK    YL0316 30
      * Define local work field Record Status
     C                     MOVEL*BLANK    YL0317  1
      * Define local work field Status Unused 1
     C                     MOVEL*BLANK    YL0318  1
      * Define local work field Status Unused 2
     C                     MOVEL*BLANK    YL0319  1
      * Define local work field Status Unused 3
     C                     MOVEL*BLANK    YL0320  1
      * Define local work field Status Unused 4
     C                     MOVEL*BLANK    YL0321  1
      * Define local work field Status Unused 5
     C                     MOVEL*BLANK    YL0322  1
      * Define local work field EDI Status 1
     C                     MOVEL*BLANK    YL0323  1
      * Define local work field EDI Status 2
     C                     MOVEL*BLANK    YL0324  1
      * Define local work field EDI Status 3
     C                     MOVEL*BLANK    YL0325  1
      * Define local work field Job Time
     C                     Z-ADD*ZERO     YL0326  60
      * Define local work field User Id
     C                     MOVEL*BLANK    YL0327 10
      * Define local work field Job Name
     C                     MOVEL*BLANK    YL0328 10
      * Define local work field Job Date
     C                     Z-ADD*ZERO     YL0329  70
      * Define local work field Shipping Line
     C                     MOVEL*BLANK    YL0330  3
      * Define local work field Salesperson Code
     C                     MOVEL*BLANK    YL0331  3
      * Define local work field Allow Multi-Company
     C                     MOVEL*BLANK    YL0332  1
      * Define local work field Default Printer
     C                     MOVEL*BLANK    YL0333 10
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0334  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0335  3
      * Define local work field CMDKEY Line 1 130 Char
     C                     MOVEL*BLANK    YL0336130
      * Define local work field CMDKEY Line 2 130 Char
     C                     MOVEL*BLANK    YL0337130
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
      * Initialise error memories
     C                     MOVE *ZERO     @@I1
     C                     MOVE *ZERO     @@I2
      * Select initial mode
     C           @1NROP    IFEQ *ZERO
      * Add mode
     C                     MOVEL'ADD'     W0PMD   3
     C                     ELSE
      * Change mode
     C                     MOVEL'CHG'     W0PMD
     C                     END
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      *
     C                     MOVEL*BLANK    WN0366 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0366           User Profile Na
      *
     C                     MOVEL*BLANK    WN0367 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR TDRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0366    ZA0029           User Profile Na
     C                     MOVEL'PDTNE1'  ZA0030           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0367    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0366    WL0512    P      User Profile Na
     C                     MOVEL'PDTNE1'  WL0513    P      Application Cod
     C                     EXSR TERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0514    YL0015           Company Number
     C                     MOVELWL0515    YL0335    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0367    WL0512    P      User Profile Na
     C                     MOVEL'PDTNE1'  WL0513    P      Application Cod
     C                     EXSR TERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0514    YL0015           Company Number
     C                     MOVELWL0515    YL0335    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0335    YL0084           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0366    ZA0031           User Profile Na
     C                     MOVEL'PDTNE1'  ZA0032           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0334    IFNE 0                          *IF
     C                     Z-ADDYL0334    YL0015           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0335    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           YL0084    PARM *BLANK    WQ0118  3        Warehouse Code
     C                     PARM YL0334    WQ0119  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR TFRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
      * KEY = PAR By name
     C                     Z-ADDP1AIC3    #1AIC3           Company Number
     C                     Z-ADDP1C4NB    #1C4NB           Order Number
     C                     Z-ADDP1AIC3    P6FKNB           USR Company Num
     C                     Z-ADDP1C4NB    P6MPNB           USR Order Numbe
     C                     MOVEL'Y'       WUTAST           First Time Flag
     C                     MOVEL'N'       P2STYN           USR Exit Progra
      * Setup message data for message
      * Retrieve message RTV WW Exp Ord Instr cmd1
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR4668' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0336    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Setup message data for message
      * Retrieve message RTV WW Exp Ord Instr cmd2
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR4669' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0337    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Screen 132 Wide 2 CMDLN - *Standard header/footer  * 
     C                     MOVELYL0336    ##VIT1
     C                     MOVELYL0337    ##VJT1
     C                     MOVEL'N'       YL0275           Status Flag 10
     C                     MOVEL'N'       P6AKTX           Status Flag 7
     C                     Z-ADD1         ZQ      50
     C           @CN,016   CAT  @CN,017:ZQWUEFT1    P      Note: Text Usr
     C                     MOVEL'Y'       P6B8ST           Status - Y or N
     C                     MOVEL'N'       P6DGTX           Status Flag 10
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** KEY Screen: Field position and name array
0104201298
** W0END
0104401304
** W0NAM
V1AIC3    V1C4NB
** W1BEG
01039010630110801142011510129501302
01364013980155801599016200165401814
01819018760191001919021320213402330
02337024140258602663026900284202875
03098031370318203610036190364403673
03866038990412204155043780441104890
04929049870514605185052430540205441
05658056970590905945
** W1END
01045010690111201149011550129701331
01365014050158701618016210166101816
01848018770191701923021320217902332
02366024330260502687026910287102889
03112031660319603617036230365503692
03873039130412904169043850442504892
04934049950516005214052510541105446
05669057040594306019
** W1NAM
V1C4NB    #1RMNB    #1RUNB    VDEIDT    #DHMNX    #DBZNA    #DW1TX
#DWPST    VDAODT    #DBRTX    #DAJNA    #DEINA    VDF9DT    V1AIC3
#DSQTX    #DQ2CD    VDHDDT    #DYBNB    #1CCTX    #DEFT1    #1XACD
#DGVTX    #1OANA    #1HCAA    #1HBAA    #DXBCD    #1J0T1    #1GENY
#1J1T1    #DAKU1    #1M2U1    V1QXDT    #DT4TM    #1J2T1    #DDXTX
V1QWDT    #DDMTX    V1QYDT    #DDNTX    V1QZDT    #DDOTX    #DDYTX
#1P8NY    #1QGNY    #1V8T1    #1V9T1    #1QHNY    #1V3T1    #1P9NY
#1HGVL    V1Q1DT    #1RLNA    #1RMNA
** W2BEG
01060011170131601373015720162902347
02354026030261002859028660311503371
03627038830389204139041520439504875
0567305929
** W2END
01066011280132201387015740163102349
02383026050263902861028950312903385
03641038900389304140041720440004924
0568105937
** W2NAM
#1RMNB    #1J2T1    V1C4NB    #1J1T1    V1AIC3    #1B4TX    #1QJNY
#DAGTX    #1CUTX    #DA7TX    #1XACD    #DGVTX    #1V6T1    #1V7T1
#1MYU1    V1Q0DT    #1CLTX    #1CITX    #DG3T1    #1QCNY    #1WCT1
#1QGNY    #1QHNY
** @CN
00001 Y2U0005
00002 USR0752
00003 Discharge Port not active
00004 Discharge Port not found.
00005 TRLRASN
00006 TRLRAVL
00007 CBP SCAC not entered, EDI
00008 601 not created. WW Shipp
00009 ing Line Ports to assign.
00010 EDI Interchange SHPEXP is
00011 not active. EDI 601 data
00012 sets will not be created.
00013 999999999999999
00014 Y2U0003
00015 Y2U9999
00016 WARNING: INVLD DDD/T-MUST
00017 LEAVE BEFORE NOW
