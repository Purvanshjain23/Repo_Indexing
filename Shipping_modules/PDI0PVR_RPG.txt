     H/TITLE EDT Trailer            PV Prompt & validate record
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Prompts fields, allowing user changes
     H* - Validates fields
     H* - If valid, performs an action
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Prompt & validate record
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISLBUSE
     H* Date          : 08/07/15  Time  : 10:26:04
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPDI0PVR#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: EDT Trailer            PV Prompt & validate record
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FPDLYREL1IF  E           K        DISK
      * RTV : Trailer                   Retrieval index
      *
     FOMFFREL0IF  E           K        DISK
      * RTV : Carrier                   Retrieval index
      *
     FOMFJCPLKIF  E           K        DISK
      * RSQ : Load Header               Carrier/Trailer
      *
     FOMFJCPMOIF  E           K        DISK
      * RSQ : Load Header               Trailer/Carrier/Load
      *
     FOMFFREL3IF  E           K        DISK
      * RTV : Carrier                   Active records
      *
     FPDJYREL2IF  E           K        DISK
      * RTV : Company Defaults Internal Active Records
      *
     FOMFJCPMRIF  E           K        DISK
      * RSQ : Load Header               Carrier/Container#
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FPDLYREL0UF  E           K        DISK                      A
      * UPD : Trailer                   Update index
      *
     FOMFJCPL1UF  E           K        DISK
      * UPD : Load Header               Update index
      *
     E                    J3          3  1
     E                    K3          3  1
      * RIGHT JUSTIFY INPUT FIELD
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * DETAIL Screen: Field position and name array
     E                    W0BEG   7 020  5 0A
     E                    W0END   7 020  5 0A
     E                    W0NAM   7 020 10
      * Long constants
     E                    @CN#    1  02  6   @CN    25
     I@ABREG3
      * Company Name and Address  Retrieval index       NV
      * Renamed input format fields
     I              ABAIC3                          WAAIC3
     I              ABADTX                          WAADTX
     I              ABACNA                          WAACNA
     I              ABADNA                          WAADNA
     I              ABAENA                          WAAENA
     I              ABAJNA                          WAAJNA
     I              ABBTTX                          WABTTX
     I              ABBVTX                          WABVTX
     I              ABBWTX                          WABWTX
     I              ABA2NA                          WAA2NA
     I              ABABTX                          WAABTX
     I              ABBGCD                          WABGCD
     I              ABKXCD                          WAKXCD
     I              ABUVST                          WAUVST
     I              ABUWST                          WAUWST
     I              ABUXST                          WAUXST
     I              ABVSST                          WAVSST
     I              ABAATM                          WAAATM
     I              ABAYNA                          WAAYNA
     I              ABA0NA                          WAA0NA
     I              ABAXDT                          WAAXDT
      *
     I@FFREBF
      * Carrier                   Retrieval index
      * Renamed input format fields
     I              FFBZNA                          WBBZNA
     I              FFADTX                          WBADTX
     I              FFACNA                          WBACNA
     I              FFADNA                          WBADNA
     I              FFAENA                          WBAENA
     I              FFAJNA                          WBAJNA
     I              FFBTTX                          WBBTTX
     I              FFEZNB                          WBEZNB
     I              FFBGCD                          WBBGCD
     I              FFEEDT                          WBEEDT
     I              FFDUTX                          WBDUTX
     I              FFNRVA                          WBNRVA
     I              FFNSVA                          WBNSVA
     I              FFNTVA                          WBNTVA
     I              FFNUVA                          WBNUVA
     I              FFP1ST                          WBP1ST
     I              FFDVTX                          WBDVTX
     I              FFDWTX                          WBDWTX
     I              FFLVCD                          WBLVCD
     I              FFS8NB                          WBS8NB
     I              FFS9NB                          WBS9NB
     I              FFNMVA                          WBNMVA
     I              FFNOVA                          WBNOVA
     I              FFNPVA                          WBNPVA
     I              FFNQVA                          WBNQVA
     I              FFMFCD                          WBMFCD
     I              FFQXNB                          WBQXNB
     I              FFQ1NB                          WBQ1NB
     I              FFMRNG                          WBMRNG
     I              FFMRNE                          WBMRNE
     I              FFRFNB                          WBRFNB
     I              FFMREG                          WBMREG
     I              FFBQPR                          WBBQPR
     I              FFBRPR                          WBBRPR
     I              FFBSPR                          WBBSPR
     I              FFBTPR                          WBBTPR
     I              FFBUPR                          WBBUPR
     I              FFBVPR                          WBBVPR
     I              FFDJWG                          WBDJWG
     I              FFDKWG                          WBDKWG
     I              FFDLWG                          WBDLWG
     I              FFDMWG                          WBDMWG
     I              FFDNWG                          WBDNWG
     I              FFDOWG                          WBDOWG
     I              FFB2PR                          WBB2PR
     I              FFB3PR                          WBB3PR
     I              FFB4PR                          WBB4PR
     I              FFB5PR                          WBB5PR
     I              FFB6PR                          WBB6PR
     I              FFB7PR                          WBB7PR
     I              FFAAC7                          WBAAC7
     I              FFCOFI                          WBCOFI
     I              FFK6TX                          WBK6TX
     I              FFOCNA                          WBOCNA
     I              FFODNA                          WBODNA
     I              FFW7CD                          WBW7CD
     I              FFK7TX                          WBK7TX
     I              FFTENO                          WBTENO
     I              FFK8TX                          WBK8TX
     I              FFAOFC                          WBAOFC
     I              FFAOLI                          WBAOLI
     I              FFKHDT                          WBKHDT
     I              FFUNUS                          WBUNUS
     I              FFUNU2                          WBUNU2
     I              FFUNU3                          WBUNU3
     I              FFUVST                          WBUVST
     I              FFUWST                          WBUWST
     I              FFUXST                          WBUXST
     I              FFVSST                          WBVSST
     I              FFAATM                          WBAATM
     I              FFAYNA                          WBAYNA
     I              FFA0NA                          WBA0NA
     I              FFAXDT                          WBAXDT
      *
     I@LYRER2
      * Trailer                   Update index
      * Renamed input format fields
     I              LYBZNA                          WCBZNA
     I              LYDXTX                          WCDXTX
     I              LYAIC3                          WCAIC3
     I              LYVDST                          WCVDST
     I              LYX3ST                          WCX3ST
     I              LYXGST                          WCXGST
     I              LYSTOY                          WCSTOY
     I              LYKKDT                          WCKKDT
     I              LYAVTM                          WCAVTM
     I              LYSTAS                          WCSTAS
     I              LYXRST                          WCXRST
     I              LYX7CD                          WCX7CD
     I              LYGXTX                          WCGXTX
     I              LYXTST                          WCXTST
     I              LYXVST                          WCXVST
     I              LYSTU3                          WCSTU3
     I              LYSTU4                          WCSTU4
     I              LYSTU5                          WCSTU5
     I              LYLCDT                          WCLCDT
     I              LYLDDT                          WCLDDT
     I              LYLEDT                          WCLEDT
     I              LYLFDT                          WCLFDT
     I              LYLGDT                          WCLGDT
     I              LYUVST                          WCUVST
     I              LYUWST                          WCUWST
     I              LYUXST                          WCUXST
     I              LYVSST                          WCVSST
     I              LYAATM                          WCAATM
     I              LYAYNA                          WCAYNA
     I              LYA0NA                          WCA0NA
     I              LYAXDT                          WCAXDT
      *
     I@FJCPR4
      * Load Header               Carrier/Trailer
      * Renamed input format fields
     I              FJRMNB                          WDRMNB
     I              FJAIC3                          WDAIC3
     I              FJAODT                          WDAODT
     I              FJPJST                          WDPJST
     I              FJPKST                          WDPKST
     I              FJRNNB                          WDRNNB
     I              FJDMTX                          WDDMTX
     I              FJDNTX                          WDDNTX
     I              FJDOTX                          WDDOTX
     I              FJWTTX                          WDWTTX
     I              FJWUTX                          WDWUTX
     I              FJRPNB                          WDRPNB
     I              FJFLAM                          WDFLAM
     I              FJXQST                          WDXQST
     I              FJRRNB                          WDRRNB
     I              FJDXTX                          WDDXTX
     I              FJDYTX                          WDDYTX
     I              FJSBNB                          WDSBNB
     I              FJBZNA                          WDBZNA
     I              FJRONB                          WDRONB
     I              FJSQNB                          WDSQNB
     I              FJR1NB                          WDR1NB
     I              FJVCST                          WDVCST
     I              FJVDST                          WDVDST
     I              FJSDNB                          WDSDNB
     I              FJPAOU                          WDPAOU
     I              FJDGWG                          WDDGWG
     I              FJSXNB                          WDSXNB
     I              FJHADT                          WDHADT
     I              FJAART                          WDAART
     I              FJDHWG                          WDDHWG
     I              FJDIWG                          WDDIWG
     I              FJAQDT                          WDAQDT
     I              FJS6NB                          WDS6NB
     I              FJT4NB                          WDT4NB
     I              FJPRTM                          WDPRTM
     I              FJNPSV                          WDNPSV
     I              FJJ8TX                          WDJ8TX
     I              FJTLMI                          WDTLMI
     I              FJJ9TX                          WDJ9TX
     I              FJQ2CD                          WDQ2CD
     I              FJVPCD                          WDVPCD
     I              FJDBCD                          WDDBCD
     I              FJGRWE                          WDGRWE
     I              FJXCCD                          WDXCCD
     I              FJU2ST                          WDU2ST
     I              FJF9DT                          WDF9DT
     I              FJONTM                          WDONTM
     I              FJJ4DT                          WDJ4DT
     I              FJTRTM                          WDTRTM
     I              FJJ5DT                          WDJ5DT
     I              FJSPTM                          WDSPTM
     I              FJJ6DT                          WDJ6DT
     I              FJLFTM                          WDLFTM
     I              FJJ7DT                          WDJ7DT
     I              FJBOTM                          WDBOTM
     I              FJJ8DT                          WDJ8DT
     I              FJBLTM                          WDBLTM
     I              FJKIDT                          WDKIDT
     I              FJASTM                          WDASTM
     I              FJKADT                          WDKADT
     I              FJAJCM                          WDAJCM
     I              FJXACD                          WDXACD
     I              FJOANA                          WDOANA
     I              FJK4TX                          WDK4TX
     I              FJVOAG                          WDVOAG
     I              FJKBDT                          WDKBDT
     I              FJNBBO                          WDNBBO
     I              FJW4CD                          WDW4CD
     I              FJEFDT                          WDEFDT
     I              FJCNTN                          WDCNTN
     I              FJKCDT                          WDKCDT
     I              FJTMIN                          WDTMIN
     I              FJKDDT                          WDKDDT
     I              FJVMNB                          WDVMNB
     I              FJOCFR                          WDOCFR
     I              FJKJDT                          WDKJDT
     I              FJATTM                          WDATTM
     I              FJOTRS                          WDOTRS
     I              FJRNST                          WDRNST
     I              FJBRBK                          WDBRBK
     I              FJEIDT                          WDEIDT
     I              FJRMST                          WDRMST
     I              FJAJCD                          WDAJCD
     I              FJKKDT                          WDKKDT
     I              FJAVTM                          WDAVTM
     I              FJKZDT                          WDKZDT
     I              FJAXTM                          WDAXTM
     I              FJLHOS                          WDLHOS
     I              FJLHOR                          WDLHOR
     I              FJWNTX                          WDWNTX
     I              FJOITX                          WDOITX
     I              FJOJTX                          WDOJTX
     I              FJLLDT                          WDLLDT
     I              FJLSHG                          WDLSHG
     I              FJYPST                          WDYPST
     I              FJK0DT                          WDK0DT
     I              FJAYTM                          WDAYTM
     I              FJKNNX                          WDKNNX
     I              FJICWG                          WDICWG
     I              FJIDWG                          WDIDWG
     I              FJH9SX                          WDH9SX
     I              FJWOTX                          WDWOTX
     I              FJK1DT                          WDK1DT
     I              FJAZTM                          WDAZTM
     I              FJK2DT                          WDK2DT
     I              FJA0TM                          WDA0TM
     I              FJROST                          WDROST
     I              FJRPST                          WDRPST
     I              FJRQST                          WDRQST
     I              FJRRST                          WDRRST
     I              FJZBVA                          WDZBVA
     I              FJWPTX                          WDWPTX
     I              FJWQTX                          WDWQTX
     I              FJWRTX                          WDWRTX
     I              FJWSTX                          WDWSTX
     I              FJRVSX                          WDRVSX
     I              FJRUSX                          WDRUSX
     I              FJRWSX                          WDRWSX
     I              FJRXSX                          WDRXSX
     I              FJRYSX                          WDRYSX
     I              FJRZSX                          WDRZSX
     I              FJR0SX                          WDR0SX
     I              FJR1SX                          WDR1SX
     I              FJR2SX                          WDR2SX
     I              FJR3SX                          WDR3SX
     I              FJR4SX                          WDR4SX
     I              FJPYDT                          WDPYDT
     I              FJCKTM                          WDCKTM
     I              FJPZDT                          WDPZDT
     I              FJCLTM                          WDCLTM
     I              FJP0DT                          WDP0DT
     I              FJCMTM                          WDCMTM
     I              FJP1DT                          WDP1DT
     I              FJCNTM                          WDCNTM
     I              FJP2DT                          WDP2DT
     I              FJCOTM                          WDCOTM
     I              FJP3DT                          WDP3DT
     I              FJCQTM                          WDCQTM
     I              FJUVST                          WDUVST
     I              FJUWST                          WDUWST
     I              FJUXST                          WDUXST
     I              FJAATM                          WDAATM
     I              FJAYNA                          WDAYNA
     I              FJA0NA                          WDA0NA
     I              FJAXDT                          WDAXDT
      *
     I@FJCPBO
      * Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WERMNB
     I              FJAIC3                          WEAIC3
     I              FJAODT                          WEAODT
     I              FJPJST                          WEPJST
     I              FJPKST                          WEPKST
     I              FJRNNB                          WERNNB
     I              FJDMTX                          WEDMTX
     I              FJDNTX                          WEDNTX
     I              FJDOTX                          WEDOTX
     I              FJWTTX                          WEWTTX
     I              FJWUTX                          WEWUTX
     I              FJRPNB                          WERPNB
     I              FJFLAM                          WEFLAM
     I              FJXQST                          WEXQST
     I              FJRRNB                          WERRNB
     I              FJDXTX                          WEDXTX
     I              FJDYTX                          WEDYTX
     I              FJSBNB                          WESBNB
     I              FJBZNA                          WEBZNA
     I              FJRONB                          WERONB
     I              FJSQNB                          WESQNB
     I              FJR1NB                          WER1NB
     I              FJVCST                          WEVCST
     I              FJVDST                          WEVDST
     I              FJSDNB                          WESDNB
     I              FJPAOU                          WEPAOU
     I              FJDGWG                          WEDGWG
     I              FJSXNB                          WESXNB
     I              FJHADT                          WEHADT
     I              FJAART                          WEAART
     I              FJDHWG                          WEDHWG
     I              FJDIWG                          WEDIWG
     I              FJAQDT                          WEAQDT
     I              FJS6NB                          WES6NB
     I              FJT4NB                          WET4NB
     I              FJPRTM                          WEPRTM
     I              FJNPSV                          WENPSV
     I              FJJ8TX                          WEJ8TX
     I              FJTLMI                          WETLMI
     I              FJJ9TX                          WEJ9TX
     I              FJQ2CD                          WEQ2CD
     I              FJVPCD                          WEVPCD
     I              FJDBCD                          WEDBCD
     I              FJGRWE                          WEGRWE
     I              FJXCCD                          WEXCCD
     I              FJU2ST                          WEU2ST
     I              FJF9DT                          WEF9DT
     I              FJONTM                          WEONTM
     I              FJJ4DT                          WEJ4DT
     I              FJTRTM                          WETRTM
     I              FJJ5DT                          WEJ5DT
     I              FJSPTM                          WESPTM
     I              FJJ6DT                          WEJ6DT
     I              FJLFTM                          WELFTM
     I              FJJ7DT                          WEJ7DT
     I              FJBOTM                          WEBOTM
     I              FJJ8DT                          WEJ8DT
     I              FJBLTM                          WEBLTM
     I              FJKIDT                          WEKIDT
     I              FJASTM                          WEASTM
     I              FJKADT                          WEKADT
     I              FJAJCM                          WEAJCM
     I              FJXACD                          WEXACD
     I              FJOANA                          WEOANA
     I              FJK4TX                          WEK4TX
     I              FJVOAG                          WEVOAG
     I              FJKBDT                          WEKBDT
     I              FJNBBO                          WENBBO
     I              FJW4CD                          WEW4CD
     I              FJEFDT                          WEEFDT
     I              FJCNTN                          WECNTN
     I              FJKCDT                          WEKCDT
     I              FJTMIN                          WETMIN
     I              FJKDDT                          WEKDDT
     I              FJVMNB                          WEVMNB
     I              FJOCFR                          WEOCFR
     I              FJKJDT                          WEKJDT
     I              FJATTM                          WEATTM
     I              FJOTRS                          WEOTRS
     I              FJRNST                          WERNST
     I              FJBRBK                          WEBRBK
     I              FJEIDT                          WEEIDT
     I              FJRMST                          WERMST
     I              FJAJCD                          WEAJCD
     I              FJKKDT                          WEKKDT
     I              FJAVTM                          WEAVTM
     I              FJKZDT                          WEKZDT
     I              FJAXTM                          WEAXTM
     I              FJLHOS                          WELHOS
     I              FJLHOR                          WELHOR
     I              FJWNTX                          WEWNTX
     I              FJOITX                          WEOITX
     I              FJOJTX                          WEOJTX
     I              FJLLDT                          WELLDT
     I              FJLSHG                          WELSHG
     I              FJYPST                          WEYPST
     I              FJK0DT                          WEK0DT
     I              FJAYTM                          WEAYTM
     I              FJKNNX                          WEKNNX
     I              FJICWG                          WEICWG
     I              FJIDWG                          WEIDWG
     I              FJH9SX                          WEH9SX
     I              FJWOTX                          WEWOTX
     I              FJK1DT                          WEK1DT
     I              FJAZTM                          WEAZTM
     I              FJK2DT                          WEK2DT
     I              FJA0TM                          WEA0TM
     I              FJROST                          WEROST
     I              FJRPST                          WERPST
     I              FJRQST                          WERQST
     I              FJRRST                          WERRST
     I              FJZBVA                          WEZBVA
     I              FJWPTX                          WEWPTX
     I              FJWQTX                          WEWQTX
     I              FJWRTX                          WEWRTX
     I              FJWSTX                          WEWSTX
     I              FJRVSX                          WERVSX
     I              FJRUSX                          WERUSX
     I              FJRWSX                          WERWSX
     I              FJRXSX                          WERXSX
     I              FJRYSX                          WERYSX
     I              FJRZSX                          WERZSX
     I              FJR0SX                          WER0SX
     I              FJR1SX                          WER1SX
     I              FJR2SX                          WER2SX
     I              FJR3SX                          WER3SX
     I              FJR4SX                          WER4SX
     I              FJPYDT                          WEPYDT
     I              FJCKTM                          WECKTM
     I              FJPZDT                          WEPZDT
     I              FJCLTM                          WECLTM
     I              FJP0DT                          WEP0DT
     I              FJCMTM                          WECMTM
     I              FJP1DT                          WEP1DT
     I              FJCNTM                          WECNTM
     I              FJP2DT                          WEP2DT
     I              FJCOTM                          WECOTM
     I              FJP3DT                          WEP3DT
     I              FJCQTM                          WECQTM
     I              FJUVST                          WEUVST
     I              FJUWST                          WEUWST
     I              FJUXST                          WEUXST
     I              FJAATM                          WEAATM
     I              FJAYNA                          WEAYNA
     I              FJA0NA                          WEA0NA
     I              FJAXDT                          WEAXDT
      *
     I@FJCPMJ
      * Load Header               Trailer/Carrier/Load
      * Renamed input format fields
     I              FJRMNB                          WFRMNB
     I              FJAIC3                          WFAIC3
     I              FJAODT                          WFAODT
     I              FJPJST                          WFPJST
     I              FJPKST                          WFPKST
     I              FJRNNB                          WFRNNB
     I              FJDMTX                          WFDMTX
     I              FJDNTX                          WFDNTX
     I              FJDOTX                          WFDOTX
     I              FJWTTX                          WFWTTX
     I              FJWUTX                          WFWUTX
     I              FJRPNB                          WFRPNB
     I              FJFLAM                          WFFLAM
     I              FJXQST                          WFXQST
     I              FJRRNB                          WFRRNB
     I              FJDXTX                          WFDXTX
     I              FJDYTX                          WFDYTX
     I              FJSBNB                          WFSBNB
     I              FJBZNA                          WFBZNA
     I              FJRONB                          WFRONB
     I              FJSQNB                          WFSQNB
     I              FJR1NB                          WFR1NB
     I              FJVCST                          WFVCST
     I              FJVDST                          WFVDST
     I              FJSDNB                          WFSDNB
     I              FJPAOU                          WFPAOU
     I              FJDGWG                          WFDGWG
     I              FJSXNB                          WFSXNB
     I              FJHADT                          WFHADT
     I              FJAART                          WFAART
     I              FJDHWG                          WFDHWG
     I              FJDIWG                          WFDIWG
     I              FJAQDT                          WFAQDT
     I              FJS6NB                          WFS6NB
     I              FJT4NB                          WFT4NB
     I              FJPRTM                          WFPRTM
     I              FJNPSV                          WFNPSV
     I              FJJ8TX                          WFJ8TX
     I              FJTLMI                          WFTLMI
     I              FJJ9TX                          WFJ9TX
     I              FJQ2CD                          WFQ2CD
     I              FJVPCD                          WFVPCD
     I              FJDBCD                          WFDBCD
     I              FJGRWE                          WFGRWE
     I              FJXCCD                          WFXCCD
     I              FJU2ST                          WFU2ST
     I              FJF9DT                          WFF9DT
     I              FJONTM                          WFONTM
     I              FJJ4DT                          WFJ4DT
     I              FJTRTM                          WFTRTM
     I              FJJ5DT                          WFJ5DT
     I              FJSPTM                          WFSPTM
     I              FJJ6DT                          WFJ6DT
     I              FJLFTM                          WFLFTM
     I              FJJ7DT                          WFJ7DT
     I              FJBOTM                          WFBOTM
     I              FJJ8DT                          WFJ8DT
     I              FJBLTM                          WFBLTM
     I              FJKIDT                          WFKIDT
     I              FJASTM                          WFASTM
     I              FJKADT                          WFKADT
     I              FJAJCM                          WFAJCM
     I              FJXACD                          WFXACD
     I              FJOANA                          WFOANA
     I              FJK4TX                          WFK4TX
     I              FJVOAG                          WFVOAG
     I              FJKBDT                          WFKBDT
     I              FJNBBO                          WFNBBO
     I              FJW4CD                          WFW4CD
     I              FJEFDT                          WFEFDT
     I              FJCNTN                          WFCNTN
     I              FJKCDT                          WFKCDT
     I              FJTMIN                          WFTMIN
     I              FJKDDT                          WFKDDT
     I              FJVMNB                          WFVMNB
     I              FJOCFR                          WFOCFR
     I              FJKJDT                          WFKJDT
     I              FJATTM                          WFATTM
     I              FJOTRS                          WFOTRS
     I              FJRNST                          WFRNST
     I              FJBRBK                          WFBRBK
     I              FJEIDT                          WFEIDT
     I              FJRMST                          WFRMST
     I              FJAJCD                          WFAJCD
     I              FJKKDT                          WFKKDT
     I              FJAVTM                          WFAVTM
     I              FJKZDT                          WFKZDT
     I              FJAXTM                          WFAXTM
     I              FJLHOS                          WFLHOS
     I              FJLHOR                          WFLHOR
     I              FJWNTX                          WFWNTX
     I              FJOITX                          WFOITX
     I              FJOJTX                          WFOJTX
     I              FJLLDT                          WFLLDT
     I              FJLSHG                          WFLSHG
     I              FJYPST                          WFYPST
     I              FJK0DT                          WFK0DT
     I              FJAYTM                          WFAYTM
     I              FJKNNX                          WFKNNX
     I              FJICWG                          WFICWG
     I              FJIDWG                          WFIDWG
     I              FJH9SX                          WFH9SX
     I              FJWOTX                          WFWOTX
     I              FJK1DT                          WFK1DT
     I              FJAZTM                          WFAZTM
     I              FJK2DT                          WFK2DT
     I              FJA0TM                          WFA0TM
     I              FJROST                          WFROST
     I              FJRPST                          WFRPST
     I              FJRQST                          WFRQST
     I              FJRRST                          WFRRST
     I              FJZBVA                          WFZBVA
     I              FJWPTX                          WFWPTX
     I              FJWQTX                          WFWQTX
     I              FJWRTX                          WFWRTX
     I              FJWSTX                          WFWSTX
     I              FJRVSX                          WFRVSX
     I              FJRUSX                          WFRUSX
     I              FJRWSX                          WFRWSX
     I              FJRXSX                          WFRXSX
     I              FJRYSX                          WFRYSX
     I              FJRZSX                          WFRZSX
     I              FJR0SX                          WFR0SX
     I              FJR1SX                          WFR1SX
     I              FJR2SX                          WFR2SX
     I              FJR3SX                          WFR3SX
     I              FJR4SX                          WFR4SX
     I              FJPYDT                          WFPYDT
     I              FJCKTM                          WFCKTM
     I              FJPZDT                          WFPZDT
     I              FJCLTM                          WFCLTM
     I              FJP0DT                          WFP0DT
     I              FJCMTM                          WFCMTM
     I              FJP1DT                          WFP1DT
     I              FJCNTM                          WFCNTM
     I              FJP2DT                          WFP2DT
     I              FJCOTM                          WFCOTM
     I              FJP3DT                          WFP3DT
     I              FJCQTM                          WFCQTM
     I              FJUVST                          WFUVST
     I              FJUWST                          WFUWST
     I              FJUXST                          WFUXST
     I              FJAATM                          WFAATM
     I              FJAYNA                          WFAYNA
     I              FJA0NA                          WFA0NA
     I              FJAXDT                          WFAXDT
      *
     I@FFREUG
      * Carrier                   Active records
      * Renamed input format fields
     I              FFBZNA                          WGBZNA
     I              FFADTX                          WGADTX
     I              FFACNA                          WGACNA
     I              FFADNA                          WGADNA
     I              FFAENA                          WGAENA
     I              FFAJNA                          WGAJNA
     I              FFBTTX                          WGBTTX
     I              FFEZNB                          WGEZNB
     I              FFBGCD                          WGBGCD
     I              FFEEDT                          WGEEDT
     I              FFDUTX                          WGDUTX
     I              FFNRVA                          WGNRVA
     I              FFNSVA                          WGNSVA
     I              FFNTVA                          WGNTVA
     I              FFNUVA                          WGNUVA
     I              FFP1ST                          WGP1ST
     I              FFDVTX                          WGDVTX
     I              FFDWTX                          WGDWTX
     I              FFLVCD                          WGLVCD
     I              FFS8NB                          WGS8NB
     I              FFS9NB                          WGS9NB
     I              FFNMVA                          WGNMVA
     I              FFNOVA                          WGNOVA
     I              FFNPVA                          WGNPVA
     I              FFNQVA                          WGNQVA
     I              FFMFCD                          WGMFCD
     I              FFQXNB                          WGQXNB
     I              FFQ1NB                          WGQ1NB
     I              FFMRNG                          WGMRNG
     I              FFMRNE                          WGMRNE
     I              FFRFNB                          WGRFNB
     I              FFMREG                          WGMREG
     I              FFBQPR                          WGBQPR
     I              FFBRPR                          WGBRPR
     I              FFBSPR                          WGBSPR
     I              FFBTPR                          WGBTPR
     I              FFBUPR                          WGBUPR
     I              FFBVPR                          WGBVPR
     I              FFDJWG                          WGDJWG
     I              FFDKWG                          WGDKWG
     I              FFDLWG                          WGDLWG
     I              FFDMWG                          WGDMWG
     I              FFDNWG                          WGDNWG
     I              FFDOWG                          WGDOWG
     I              FFB2PR                          WGB2PR
     I              FFB3PR                          WGB3PR
     I              FFB4PR                          WGB4PR
     I              FFB5PR                          WGB5PR
     I              FFB6PR                          WGB6PR
     I              FFB7PR                          WGB7PR
     I              FFAAC7                          WGAAC7
     I              FFCOFI                          WGCOFI
     I              FFK6TX                          WGK6TX
     I              FFOCNA                          WGOCNA
     I              FFODNA                          WGODNA
     I              FFW7CD                          WGW7CD
     I              FFK7TX                          WGK7TX
     I              FFTENO                          WGTENO
     I              FFK8TX                          WGK8TX
     I              FFAOFC                          WGAOFC
     I              FFAOLI                          WGAOLI
     I              FFKHDT                          WGKHDT
     I              FFUNUS                          WGUNUS
     I              FFUNU2                          WGUNU2
     I              FFUNU3                          WGUNU3
     I              FFUVST                          WGUVST
     I              FFUWST                          WGUWST
     I              FFUXST                          WGUXST
     I              FFVSST                          WGVSST
     I              FFAATM                          WGAATM
     I              FFAYNA                          WGAYNA
     I              FFA0NA                          WGA0NA
     I              FFAXDT                          WGAXDT
      *
     I@JYRECE
      * Company Defaults Internal Active Records
      * Renamed input format fields
     I              JYAIC3                          WHAIC3
     I              JYZ9ST                          WHZ9ST
     I              JYCSST                          WHCSST
     I              JYZ8ST                          WHZ8ST
     I              JYCXST                          WHCXST
     I              JYSWST                          WHSWST
     I              JYXXTM                          WHXXTM
     I              JYUECD                          WHUECD
     I              JYHSST                          WHHSST
     I              JYAMEO                          WHAMEO
     I              JYSSDF                          WHSSDF
     I              JYPDFT                          WHPDFT
     I              JYYISX                          WHYISX
     I              JYYJSX                          WHYJSX
     I              JYYKSX                          WHYKSX
     I              JYYLSX                          WHYLSX
     I              JYYMSX                          WHYMSX
     I              JYYNSX                          WHYNSX
     I              JYUVST                          WHUVST
     I              JYUWST                          WHUWST
     I              JYUXST                          WHUXST
     I              JYVSST                          WHVSST
     I              JYAATM                          WHAATM
     I              JYAYNA                          WHAYNA
     I              JYA0NA                          WHA0NA
     I              JYAXDT                          WHAXDT
      *
     I@FJCPR6
      * Load Header               Carrier/Container#
      * Renamed input format fields
     I              FJRMNB                          WIRMNB
     I              FJAIC3                          WIAIC3
     I              FJAODT                          WIAODT
     I              FJPJST                          WIPJST
     I              FJPKST                          WIPKST
     I              FJRNNB                          WIRNNB
     I              FJDMTX                          WIDMTX
     I              FJDNTX                          WIDNTX
     I              FJDOTX                          WIDOTX
     I              FJWTTX                          WIWTTX
     I              FJWUTX                          WIWUTX
     I              FJRPNB                          WIRPNB
     I              FJFLAM                          WIFLAM
     I              FJXQST                          WIXQST
     I              FJRRNB                          WIRRNB
     I              FJDXTX                          WIDXTX
     I              FJDYTX                          WIDYTX
     I              FJSBNB                          WISBNB
     I              FJBZNA                          WIBZNA
     I              FJRONB                          WIRONB
     I              FJSQNB                          WISQNB
     I              FJR1NB                          WIR1NB
     I              FJVCST                          WIVCST
     I              FJVDST                          WIVDST
     I              FJSDNB                          WISDNB
     I              FJPAOU                          WIPAOU
     I              FJDGWG                          WIDGWG
     I              FJSXNB                          WISXNB
     I              FJHADT                          WIHADT
     I              FJAART                          WIAART
     I              FJDHWG                          WIDHWG
     I              FJDIWG                          WIDIWG
     I              FJAQDT                          WIAQDT
     I              FJS6NB                          WIS6NB
     I              FJT4NB                          WIT4NB
     I              FJPRTM                          WIPRTM
     I              FJNPSV                          WINPSV
     I              FJJ8TX                          WIJ8TX
     I              FJTLMI                          WITLMI
     I              FJJ9TX                          WIJ9TX
     I              FJQ2CD                          WIQ2CD
     I              FJVPCD                          WIVPCD
     I              FJDBCD                          WIDBCD
     I              FJGRWE                          WIGRWE
     I              FJXCCD                          WIXCCD
     I              FJU2ST                          WIU2ST
     I              FJF9DT                          WIF9DT
     I              FJONTM                          WIONTM
     I              FJJ4DT                          WIJ4DT
     I              FJTRTM                          WITRTM
     I              FJJ5DT                          WIJ5DT
     I              FJSPTM                          WISPTM
     I              FJJ6DT                          WIJ6DT
     I              FJLFTM                          WILFTM
     I              FJJ7DT                          WIJ7DT
     I              FJBOTM                          WIBOTM
     I              FJJ8DT                          WIJ8DT
     I              FJBLTM                          WIBLTM
     I              FJKIDT                          WIKIDT
     I              FJASTM                          WIASTM
     I              FJKADT                          WIKADT
     I              FJAJCM                          WIAJCM
     I              FJXACD                          WIXACD
     I              FJOANA                          WIOANA
     I              FJK4TX                          WIK4TX
     I              FJVOAG                          WIVOAG
     I              FJKBDT                          WIKBDT
     I              FJNBBO                          WINBBO
     I              FJW4CD                          WIW4CD
     I              FJEFDT                          WIEFDT
     I              FJCNTN                          WICNTN
     I              FJKCDT                          WIKCDT
     I              FJTMIN                          WITMIN
     I              FJKDDT                          WIKDDT
     I              FJVMNB                          WIVMNB
     I              FJOCFR                          WIOCFR
     I              FJKJDT                          WIKJDT
     I              FJATTM                          WIATTM
     I              FJOTRS                          WIOTRS
     I              FJRNST                          WIRNST
     I              FJBRBK                          WIBRBK
     I              FJEIDT                          WIEIDT
     I              FJRMST                          WIRMST
     I              FJAJCD                          WIAJCD
     I              FJKKDT                          WIKKDT
     I              FJAVTM                          WIAVTM
     I              FJKZDT                          WIKZDT
     I              FJAXTM                          WIAXTM
     I              FJLHOS                          WILHOS
     I              FJLHOR                          WILHOR
     I              FJWNTX                          WIWNTX
     I              FJOITX                          WIOITX
     I              FJOJTX                          WIOJTX
     I              FJLLDT                          WILLDT
     I              FJLSHG                          WILSHG
     I              FJYPST                          WIYPST
     I              FJK0DT                          WIK0DT
     I              FJAYTM                          WIAYTM
     I              FJKNNX                          WIKNNX
     I              FJICWG                          WIICWG
     I              FJIDWG                          WIIDWG
     I              FJH9SX                          WIH9SX
     I              FJWOTX                          WIWOTX
     I              FJK1DT                          WIK1DT
     I              FJAZTM                          WIAZTM
     I              FJK2DT                          WIK2DT
     I              FJA0TM                          WIA0TM
     I              FJROST                          WIROST
     I              FJRPST                          WIRPST
     I              FJRQST                          WIRQST
     I              FJRRST                          WIRRST
     I              FJZBVA                          WIZBVA
     I              FJWPTX                          WIWPTX
     I              FJWQTX                          WIWQTX
     I              FJWRTX                          WIWRTX
     I              FJWSTX                          WIWSTX
     I              FJRVSX                          WIRVSX
     I              FJRUSX                          WIRUSX
     I              FJRWSX                          WIRWSX
     I              FJRXSX                          WIRXSX
     I              FJRYSX                          WIRYSX
     I              FJRZSX                          WIRZSX
     I              FJR0SX                          WIR0SX
     I              FJR1SX                          WIR1SX
     I              FJR2SX                          WIR2SX
     I              FJR3SX                          WIR3SX
     I              FJR4SX                          WIR4SX
     I              FJPYDT                          WIPYDT
     I              FJCKTM                          WICKTM
     I              FJPZDT                          WIPZDT
     I              FJCLTM                          WICLTM
     I              FJP0DT                          WIP0DT
     I              FJCMTM                          WICMTM
     I              FJP1DT                          WIP1DT
     I              FJCNTM                          WICNTM
     I              FJP2DT                          WIP2DT
     I              FJCOTM                          WICOTM
     I              FJP3DT                          WIP3DT
     I              FJCQTM                          WICQTM
     I              FJUVST                          WIUVST
     I              FJUWST                          WIUWST
     I              FJUXST                          WIUXST
     I              FJAATM                          WIAATM
     I              FJAYNA                          WIAYNA
     I              FJA0NA                          WIA0NA
     I              FJAXDT                          WIAXDT
      *
     I@DRRETH
      * User Profile Control      Retrieval index       NV
      * Renamed input format fields
     I              DRAJVN                          WJAJVN
     I              DRAUNA                          WJAUNA
     I              DRB8NA                          WJB8NA
     I              DRAHVN                          WJAHVN
     I              DRI6ST                          WJI6ST
     I              DRI7ST                          WJI7ST
     I              DRXMST                          WJXMST
     I              DRXNST                          WJXNST
     I              DRI8ST                          WJI8ST
     I              DRNLNB                          WJNLNB
     I              DRMPNA                          WJMPNA
     I              DRBCCD                          WJBCCD
     I              DRAIC3                          WJAIC3
     I              DRDQCD                          WJDQCD
     I              DRDRCD                          WJDRCD
     I              DRAJCD                          WJAJCD
     I              DRBUVN                          WJBUVN
     I              DRUVST                          WJUVST
     I              DRUWST                          WJUWST
     I              DRUXST                          WJUXST
     I              DRAATM                          WJAATM
     I              DRAYNA                          WJAYNA
     I              DRA0NA                          WJA0NA
     I              DRAXDT                          WJAXDT
      *
     I@DTRETE
      * User Application Profile  Retrieval index       NV
      * Renamed input format fields
     I              DTAJVN                          WKAJVN
     I              DTDNCD                          WKDNCD
     I              DTAIC3                          WKAIC3
     I              DTDQCD                          WKDQCD
     I              DTDRCD                          WKDRCD
     I              DTAJCD                          WKAJCD
     I              DTJFST                          WKJFST
     I              DTUVST                          WKUVST
     I              DTUWST                          WKUWST
     I              DTUXST                          WKUXST
     I              DTAATM                          WKAATM
     I              DTAYNA                          WKAYNA
     I              DTA0NA                          WKA0NA
     I              DTAXDT                          WKAXDT
      *
     I@DNRESF
      * Application               RSQ Application Code
      * Renamed input format fields
     I              DNDNCD                          WLDNCD
     I              DNAUNA                          WLAUNA
     I              DNVKST                          WLVKST
     I              DNRSCD                          WLRSCD
     I              DNUVST                          WLUVST
     I              DNUWST                          WLUWST
     I              DNUXST                          WLUXST
     I              DNAATM                          WLAATM
     I              DNAYNA                          WLAYNA
     I              DNA0NA                          WLA0NA
     I              DNAXDT                          WLAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IQPDLY1    E DSPDLYREL0
      * UPD : Trailer                   Update index
      * Renamed input format fields
     I              LYBZNA                          WCBZNA
     I              LYDXTX                          WCDXTX
     I              LYAIC3                          WCAIC3
     I              LYVDST                          WCVDST
     I              LYX3ST                          WCX3ST
     I              LYXGST                          WCXGST
     I              LYSTOY                          WCSTOY
     I              LYKKDT                          WCKKDT
     I              LYAVTM                          WCAVTM
     I              LYSTAS                          WCSTAS
     I              LYXRST                          WCXRST
     I              LYX7CD                          WCX7CD
     I              LYGXTX                          WCGXTX
     I              LYXTST                          WCXTST
     I              LYXVST                          WCXVST
     I              LYSTU3                          WCSTU3
     I              LYSTU4                          WCSTU4
     I              LYSTU5                          WCSTU5
     I              LYLCDT                          WCLCDT
     I              LYLDDT                          WCLDDT
     I              LYLEDT                          WCLEDT
     I              LYLFDT                          WCLFDT
     I              LYLGDT                          WCLGDT
     I              LYUVST                          WCUVST
     I              LYUWST                          WCUWST
     I              LYUXST                          WCUXST
     I              LYVSST                          WCVSST
     I              LYAATM                          WCAATM
     I              LYAYNA                          WCAYNA
     I              LYA0NA                          WCA0NA
     I              LYAXDT                          WCAXDT
      *
     IYARDCS      DS                            129
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQOMFJ1    E DSOMFJCPL1
      * UPD : Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WERMNB
     I              FJAIC3                          WEAIC3
     I              FJAODT                          WEAODT
     I              FJPJST                          WEPJST
     I              FJPKST                          WEPKST
     I              FJRNNB                          WERNNB
     I              FJDMTX                          WEDMTX
     I              FJDNTX                          WEDNTX
     I              FJDOTX                          WEDOTX
     I              FJWTTX                          WEWTTX
     I              FJWUTX                          WEWUTX
     I              FJRPNB                          WERPNB
     I              FJFLAM                          WEFLAM
     I              FJXQST                          WEXQST
     I              FJRRNB                          WERRNB
     I              FJDXTX                          WEDXTX
     I              FJDYTX                          WEDYTX
     I              FJSBNB                          WESBNB
     I              FJBZNA                          WEBZNA
     I              FJRONB                          WERONB
     I              FJSQNB                          WESQNB
     I              FJR1NB                          WER1NB
     I              FJVCST                          WEVCST
     I              FJVDST                          WEVDST
     I              FJSDNB                          WESDNB
     I              FJPAOU                          WEPAOU
     I              FJDGWG                          WEDGWG
     I              FJSXNB                          WESXNB
     I              FJHADT                          WEHADT
     I              FJAART                          WEAART
     I              FJDHWG                          WEDHWG
     I              FJDIWG                          WEDIWG
     I              FJAQDT                          WEAQDT
     I              FJS6NB                          WES6NB
     I              FJT4NB                          WET4NB
     I              FJPRTM                          WEPRTM
     I              FJNPSV                          WENPSV
     I              FJJ8TX                          WEJ8TX
     I              FJTLMI                          WETLMI
     I              FJJ9TX                          WEJ9TX
     I              FJQ2CD                          WEQ2CD
     I              FJVPCD                          WEVPCD
     I              FJDBCD                          WEDBCD
     I              FJGRWE                          WEGRWE
     I              FJXCCD                          WEXCCD
     I              FJU2ST                          WEU2ST
     I              FJF9DT                          WEF9DT
     I              FJONTM                          WEONTM
     I              FJJ4DT                          WEJ4DT
     I              FJTRTM                          WETRTM
     I              FJJ5DT                          WEJ5DT
     I              FJSPTM                          WESPTM
     I              FJJ6DT                          WEJ6DT
     I              FJLFTM                          WELFTM
     I              FJJ7DT                          WEJ7DT
     I              FJBOTM                          WEBOTM
     I              FJJ8DT                          WEJ8DT
     I              FJBLTM                          WEBLTM
     I              FJKIDT                          WEKIDT
     I              FJASTM                          WEASTM
     I              FJKADT                          WEKADT
     I              FJAJCM                          WEAJCM
     I              FJXACD                          WEXACD
     I              FJOANA                          WEOANA
     I              FJK4TX                          WEK4TX
     I              FJVOAG                          WEVOAG
     I              FJKBDT                          WEKBDT
     I              FJNBBO                          WENBBO
     I              FJW4CD                          WEW4CD
     I              FJEFDT                          WEEFDT
     I              FJCNTN                          WECNTN
     I              FJKCDT                          WEKCDT
     I              FJTMIN                          WETMIN
     I              FJKDDT                          WEKDDT
     I              FJVMNB                          WEVMNB
     I              FJOCFR                          WEOCFR
     I              FJKJDT                          WEKJDT
     I              FJATTM                          WEATTM
     I              FJOTRS                          WEOTRS
     I              FJRNST                          WERNST
     I              FJBRBK                          WEBRBK
     I              FJEIDT                          WEEIDT
     I              FJRMST                          WERMST
     I              FJAJCD                          WEAJCD
     I              FJKKDT                          WEKKDT
     I              FJAVTM                          WEAVTM
     I              FJKZDT                          WEKZDT
     I              FJAXTM                          WEAXTM
     I              FJLHOS                          WELHOS
     I              FJLHOR                          WELHOR
     I              FJWNTX                          WEWNTX
     I              FJOITX                          WEOITX
     I              FJOJTX                          WEOJTX
     I              FJLLDT                          WELLDT
     I              FJLSHG                          WELSHG
     I              FJYPST                          WEYPST
     I              FJK0DT                          WEK0DT
     I              FJAYTM                          WEAYTM
     I              FJKNNX                          WEKNNX
     I              FJICWG                          WEICWG
     I              FJIDWG                          WEIDWG
     I              FJH9SX                          WEH9SX
     I              FJWOTX                          WEWOTX
     I              FJK1DT                          WEK1DT
     I              FJAZTM                          WEAZTM
     I              FJK2DT                          WEK2DT
     I              FJA0TM                          WEA0TM
     I              FJROST                          WEROST
     I              FJRPST                          WERPST
     I              FJRQST                          WERQST
     I              FJRRST                          WERRST
     I              FJZBVA                          WEZBVA
     I              FJWPTX                          WEWPTX
     I              FJWQTX                          WEWQTX
     I              FJWRTX                          WEWRTX
     I              FJWSTX                          WEWSTX
     I              FJRVSX                          WERVSX
     I              FJRUSX                          WERUSX
     I              FJRWSX                          WERWSX
     I              FJRXSX                          WERXSX
     I              FJRYSX                          WERYSX
     I              FJRZSX                          WERZSX
     I              FJR0SX                          WER0SX
     I              FJR1SX                          WER1SX
     I              FJR2SX                          WER2SX
     I              FJR3SX                          WER3SX
     I              FJR4SX                          WER4SX
     I              FJPYDT                          WEPYDT
     I              FJCKTM                          WECKTM
     I              FJPZDT                          WEPZDT
     I              FJCLTM                          WECLTM
     I              FJP0DT                          WEP0DT
     I              FJCMTM                          WECMTM
     I              FJP1DT                          WEP1DT
     I              FJCNTM                          WECNTM
     I              FJP2DT                          WEP2DT
     I              FJCOTM                          WECOTM
     I              FJP3DT                          WEP3DT
     I              FJCQTM                          WECQTM
     I              FJUVST                          WEUVST
     I              FJUWST                          WEUWST
     I              FJUXST                          WEUXST
     I              FJAATM                          WEAATM
     I              FJAYNA                          WEAYNA
     I              FJA0NA                          WEA0NA
     I              FJAXDT                          WEAXDT
      *
     IYBRDCS      DS                            793
      * Outward parameters
     IPARC        DS                             82
      * RCD : Load Order Change Log     Retrieval index
      * N :  Sequence Number
     I                                    P   9  100PADXNB
      * I :  Load ID
     I                                    P  11  140PARMNB
      * I :  Stop/Drop
     I                                    P  15  170PARVNB
      * I :  Load Change Type
     I                                       18  23 PARVST
      * I :  Department Control Code
     I                                       24  26 PAUJST
      * I :  Change Log Prior Value
     I                                       27  38 PAMNTX
      * I :  Change Log New Value
     I                                       39  50 PAMOTX
      * I :  User Id
     I                                       51  60 PAAYNA
      * I :  Job Name
     I                                       61  70 PAA0NA
      * I :  Carrier Code
     I                                       71  73 PABZNA
      * N :  Carrier Broker Carrier Co
     I                                       74  76 PAXMCD
      * I :  Company Number
     I                                    P  77  780PAAIC3
      * I :  Order Number
     I                                    P  79  820PAC4NB
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
      /EJECT
      * Parameter declarations
     IP1PARM      DS                             23
      * KEY: Trailer                   Retrieval index
      * I :  Carrier Code
     I                                        1   3 P1BZNA
      * I :  Trailer Id
     I                                        4  23 P1DXTX
     IP2PARM      DS
      * FLD: Load Header
      * N :  Load ID
     I                                    P   1   40P2RMNB
      * N :  Company Number
     I                                    P   5   60P2AIC3
      * N :  Load Status
     I                                        7   7 P2PKST
      * N :  BOL Complete Date
     I                                    P   8  110P2J7DT
      * N :  BOL Complete Time
     I                                    P  12  150P2BOTM
      * N :  Truck Departure Date
     I                                    P  16  190P2KIDT
      * N :  Truck Departure Time
     I                                    P  20  230P2ASTM
      * N :  On Yard Date
     I                                    P  24  270P2KKDT
      * N :  On Yard Time
     I                                    P  28  310P2AVTM
      * N :  Deadline Departure Date
     I                                    P  32  350P2KZDT
      * N :  Deadline Departure Time
     I                                    P  36  390P2AXTM
     IP3PARM      DS
      * N :  USR Load Type
     I                                        1   1 P3WNST
     IP4PARM      DS
      * N :  USR On Yard Date
     I                                    P   1   40P4LKDT
     IP5PARM      DS
      * N :  USR Time
     I                                    P   1   40P5WENB
     IP6PARM      DS
      * N :  USR Carrier Code
     I                                        1   3 P6R6CD
     IP7PARM      DS
      * N :  Trailer Id            USR
     I                                        1  20 P7MUTX
     IP8PARM      DS
      * N :  Trailer ID USR
     I                                        1  12 P8S2TX
     IP9PARM      DS
      * FLD: *Arrays
      * N : MAP Allow Multi-Company
     I                                        1   1 P9I6ST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Trailer                NF'
      * Trailer ID USR
     I                                        1  12 ZA0001
      * Message data for 'CD3 Non numeric data'
      * Message data for 'Value Required'
      * @Allocation Type
     I                                        1   1 ZA0002
      * Message data for 'Carrier                NF'
      * Carrier Code
     I                                        1   3 ZA0003
      * Message data for 'Value Required (alpha)'
      * Text 1 USR
     I                                        1  25 ZA0004
      * Message data for 'Company not found'
      * Company Number
     I                                        1   3 ZA0005
      * Message data for 'Load type must match load'
      * Load Type
     I                                        1   1 ZA0006
      * USR Load Type
     I                                        2   2 ZA0007
      * Trailer ID USR
     I                                        3  14 ZA0008
      * Message data for 'Seaboard Owned Sts eq yes'
      * Seaboard Owned Status
     I                                        1   1 ZA0009
      * Load ID
     I                                    P   2   50ZA0010
      * Message data for 'On Yard Date and Time mus'
      * On Yard Date
     I                                    P   1   40ZA0011
      * On Yard Time
     I                                    P   5   80ZA0012
      * Message data for 'Assigned sts cant be no'
      * Assigned Status
     I                                        1   1 ZA0013
      * Load ID
     I                                    P   2   50ZA0014
      * Message data for 'Assigned sts cant be yes'
      * Assigned Status
     I                                        1   1 ZA0015
      * Message data for 'Record Status cannot be'
      * Record Status
     I                                        1   1 ZA0016
      * Message data for 'Trailer                NF'
      * Trailer ID USR
     I                                        1  12 ZA0017
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0018
      * Application Code
     I                                       11  16 ZA0019
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0020
      * Application Code
     I                                       11  16 ZA0021
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C                     PARM           P1PARM           KEY: Trailer
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Conduct screen conversation
     C                     DO   *HIVAL
      * Start new transaction
     C                     MOVEL'Y'       W0TRN   1
      * Process current transaction
     C           W0TRN     DOWEQ'Y'
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            MALDSC
      * Process screen input
     C                     CAS            DAPRSC
     C                     END
      *
     C                     END
      *
     C                     END
      *****************************************************************
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPRSC    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process command keys
      * CASE: DTL.*CMD key is CF04
     C           *IN04     IFEQ '1'                        *IF
      * CASE: PGM.*Cursor field <IS> DTL.Company Number
     C           W0CFL     IFEQ 'V1AIC3'                   *IF
      * ** Do not allow prompt & select if multi-company is No
      * CASE: PAR.Allow Multi-Company is no
     C           P9I6ST    IFEQ 'N'                        *IF
      * Send message 'Prompt Not Allowed'
     C                     MOVEL'USR2410' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * SEL Company - plants   SR - Company Name and Address  * 
     C                     CALL 'PPF2SRR'              90  SEL Company - p
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0001  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPF2SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9933  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: DTL.*CMD key is *Refresh
     C           *IN05     IFEQ '1'                        *IF
      * Add mode initialize
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Carrier Code EQ WRK.BLANK
      *   |- c2    : PAR.Trailer Id EQ WRK.BLANK
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1BZNA    IFEQ WUGSTX                     *IF
     C           P1DXTX    IFEQ WUGSTX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: DTL.Company Number is Equal to zero
     C           #1AIC3    IFEQ *ZERO                      *IF
     C                     Z-ADDP2AIC3    #1AIC3           Company Number
     C                     END                             *FI
     C                     MOVEL*BLANK    #DSQTX           Company Name DR
      * Company Name DRV
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0001           Company Number
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #DSQTX    P      Name
     C                     MOVELP1BZNA    #1BZNA           Carrier Code
     C                     MOVEL#1DXTX    #DS2TX           Trailer ID USR
     C                     MOVELP1DXTX    #1DXTX           Trailer Id
     C                     MOVELP1BZNA    #DR6CD           USR Carrier Cod
     C                     MOVEL'R'       #1VDST           Load Type
     C                     MOVEL'R'       #1X3ST           Trailer Type
     C                     MOVEL'N'       #1XGST           Seaboard Owned
     C                     MOVEL'N'       #1STAS           Assigned Status
     C                     MOVEL'Y'       #1XRST           Available Statu
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           WUSDTE    PARM *ZERO     WQ0002 155       Current System
     C           WUZHNB    PARM *ZERO     WQ0003 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * DTL.On Yard Date = WRK.Current System Date
     C                     Z-ADDWUSDTE    #1KKDT           On Yard Date
      * DTL.On Yard Time = WRK.Current System Time
     C                     Z-ADDWUZHNB    #1AVTM           On Yard Time
     C           #1AVTM    DIV  100       #DOYTM           USR On Yard Tim
     C                     MOVEL*BLANK    #1GXTX           Comment Line
     C                     MOVEL'Y'       #1STOY           On Yard Status
     C                     MOVEL'A'       #1VSST           Record Status
      * DTL.Load Type Desc = Condition name of DTL.Load Type
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1250409   Y2LSNO  70       List number
     C                     PARM #1VDST    W0INVL 25        Load Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DNONA    PARM           W0CNNM 25        Load Type Desc
      *
      * DTL.Condition Desc. 1  USR = Condition name of DTL.Trailer Type
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1496438   Y2LSNO  70       List number
     C                     PARM #1X3ST    W0INVL 25        Trailer Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHLTX    PARM           W0CNNM 25        Condition Desc.
      *
      * DTL.Status Description = Condition name of DTL.Seaboard Owned Sta
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100273   Y2LSNO  70       List number
     C                     PARM #1XGST    W0INVL 25        Seaboard Owned
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHKNA    PARM           W0CNNM 25        Status Descript
      *
      * DTL.Status Description 2 = Condition name of DTL.Assigned Status
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100273   Y2LSNO  70       List number
     C                     PARM #1STAS    W0INVL 25        Assigned Status
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DNINA    PARM           W0CNNM 25        Status Descript
      *
      * DTL.Status Description 3  USR = Condition name of DTL.Available S
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100273   Y2LSNO  70       List number
     C                     PARM #1XRST    W0INVL 25        Available Statu
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DNMTX    PARM           W0CNNM 25        Status Descript
      *
      * DTL.Condition Desc. 4  USR = Condition name of DTL.Record Status
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1255478   Y2LSNO  70       List number
     C                     PARM #1VSST    W0INVL 25        Record Status
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHOTX    PARM           W0CNNM 25        Condition Desc.
      *
     C                     END                             *FI
      * Change mode initialize
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Carrier Code NE WRK.BLANK
      *   |- c2    : PAR.Trailer Id NE WRK.BLANK
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1BZNA    IFNE WUGSTX                     *IF
     C           P1DXTX    IFNE WUGSTX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL#1BZNA    #DR6CD           USR Carrier Cod
     C                     MOVELP1DXTX    #1DXTX           Trailer Id
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Rtv Trailer            RT - PD Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP1BZNA    WL0003    P      Carrier Code
     C                     MOVELP1DXTX    WL0004    P      Trailer Id
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    #1AIC3           Company Number
     C                     MOVELWL0006    #1VDST    P      Load Type
     C                     MOVELWL0007    #1X3ST    P      Trailer Type
     C                     MOVELWL0008    #1XGST    P      Seaboard Owned
     C                     MOVELWL0009    #1STOY    P      On Yard Status
     C                     Z-ADDWL0010    #1KKDT           On Yard Date
     C                     Z-ADDWL0011    #1AVTM           On Yard Time
     C                     MOVELWL0012    #1STAS    P      Assigned Status
     C                     MOVELWL0013    #1XRST    P      Available Statu
     C                     MOVELWL0014    #1X7CD    P      Not Available R
     C                     MOVELWL0015    #1GXTX    P      Comment Line
     C                     MOVELWL0016    #1VSST    P      Record Status
     C                     MOVEL#1DXTX    #DS2TX           Trailer ID USR
      * error and quit if record not found
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DS2TX    ZA0001           Trailer ID USR
      * Send message 'Trailer                NF'
     C                     MOVEL'USR2598' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * RTV Carrier Name       RT - OM Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1BZNA    WL0017    P      Carrier Code
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0018    #DADTX    P      Name
     C                     MOVELWL0019    WUVSST    P      Record Status
      * DTL.Condition Desc. 1  USR = Condition name of DTL.Trailer Type
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1496438   Y2LSNO  70       List number
     C                     PARM #1X3ST    W0INVL 25        Trailer Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHLTX    PARM           W0CNNM 25        Condition Desc.
      *
      * DTL.Load Type Desc = Condition name of DTL.Load Type
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1250409   Y2LSNO  70       List number
     C                     PARM #1VDST    W0INVL 25        Load Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DNONA    PARM           W0CNNM 25        Load Type Desc
      *
      * DTL.Status Description = Condition name of DTL.Seaboard Owned Sta
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100273   Y2LSNO  70       List number
     C                     PARM #1XGST    W0INVL 25        Seaboard Owned
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHKNA    PARM           W0CNNM 25        Status Descript
      *
      * DTL.Status Description 2 = Condition name of DTL.Assigned Status
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100273   Y2LSNO  70       List number
     C                     PARM #1STAS    W0INVL 25        Assigned Status
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DNINA    PARM           W0CNNM 25        Status Descript
      *
      * DTL.Status Description 3  USR = Condition name of DTL.Available S
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100273   Y2LSNO  70       List number
     C                     PARM #1XRST    W0INVL 25        Available Statu
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DNMTX    PARM           W0CNNM 25        Status Descript
      *
      * DTL.Condition Desc. 4  USR = Condition name of DTL.Record Status
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1255478   Y2LSNO  70       List number
     C                     PARM #1VSST    W0INVL 25        Record Status
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHOTX    PARM           W0CNNM 25        Condition Desc.
      *
     C           #1AVTM    DIV  100       #DOYTM           USR On Yard Tim
      * Save to check for change later.
     C                     Z-ADD#1KKDT    P4LKDT           USR On Yard Dat
     C                     Z-ADD#1AVTM    P5WENB           USR Time
     C                     END                             *FI
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * Validate screen input
     C                     EXSR DBVLSC
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPMCF
      * Quit if not confirmed
     C           *IN99     CABEQ'1'       DAEXIT
      * USER: User defined action
      * * If trailer is assigned but not on yard, update status'    E0029
      * CASE: WRK.Status Flag 10 Y/N is Yes
     C           WUDGTX    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       #1STAS           Assigned Status
     C                     MOVEL'N'       #1XRST           Available Statu
     C                     END                             *FI
     C           #DOYTM    MULT 100       #1AVTM           On Yard Time
      * CRT or Chg Trailer     CR - Trailer  * 
     C                     EXSR SDCRRC
      * * Trailer was assigned to load before it was on the yard    E0029
      * CASE: WRK.Status Flag 10 Y/N is Yes
     C           WUDGTX    IFEQ 'Y'                        *IF
      * Rtv/Chg Ld on yd dt/tm RT - Load Header  * 
     C                     EXSR SHRVGN
     C                     END                             *FI
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
      * Request new transaction
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBVLSC    BEGSR
      *================================================================
      * Validate screen input
      *================================================================
      * Validate Company Number and convert to internal.
      * CD3 Ext/Int
     C                     MOVELV1AIC3    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC3  3
     C                     MOVEA*BLANKS   K3
     C                     Z-ADD3         C       30
     C                     Z-ADD3         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUDMCD    J3
     C                     MOVE *BLANKS   W0RTN
     C                     DO   3
     C           J3,C      IFNE ' '
     C                     MOVEAJ3,C      K3,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK3        JUSTC3
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC3    TESTC   1
     C           TESTC     IFGT '?'
     C           TESTC     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC3     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC3    WUDMCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Send message 'CD3 Non numeric data'
     C                     MOVEL'USR0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD0         #1AIC3           CD3 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUDMCD    #1AIC3           CD3 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Load Type
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1VDST'  IFEQ YPMTFD
      * Load Type
     C                     MOVEL#1VDST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHVDST
     C                     SELEC
     C           W0INVL    WHEQ 'B'                        B
     C                     Z-ADD1         ZHVDST
     C           W0INVL    WHEQ 'R'                        R
     C                     Z-ADD2         ZHVDST
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD3         ZHVDST
     C                     ENDSL
     C                     EXFMTZGVDST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHVDST    WHEQ 1
     C                     MOVEL'B'       W0INVL           B
     C           ZHVDST    WHEQ 2
     C                     MOVEL'R'       W0INVL           R
     C           ZHVDST    WHEQ 3
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1VDST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Trailer Type
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1X3ST'  IFEQ YPMTFD
      * Trailer Type
     C                     MOVEL#1X3ST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHX3ST
     C                     SELEC
     C           W0INVL    WHEQ 'H'                        H
     C                     Z-ADD1         ZHX3ST
     C           W0INVL    WHEQ 'T'                        T
     C                     Z-ADD2         ZHX3ST
     C           W0INVL    WHEQ 'V'                        V
     C                     Z-ADD3         ZHX3ST
     C           W0INVL    WHEQ 'R'                        R
     C                     Z-ADD4         ZHX3ST
     C                     ENDSL
     C                     EXFMTZGX3ST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHX3ST    WHEQ 1
     C                     MOVEL'H'       W0INVL           H
     C           ZHX3ST    WHEQ 2
     C                     MOVEL'T'       W0INVL           T
     C           ZHX3ST    WHEQ 3
     C                     MOVEL'V'       W0INVL           V
     C           ZHX3ST    WHEQ 4
     C                     MOVEL'R'       W0INVL           R
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1X3ST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Seaboard Owned Status
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1XGST'  IFEQ YPMTFD
      * Seaboard Owned Status
     C                     MOVEL#1XGST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHXGST
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHXGST
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZHXGST
     C                     ENDSL
     C                     EXFMTZGXGST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHXGST    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHXGST    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1XGST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate On Yard Date
      * External date
     C                     Z-ADDV1KKDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9937  *
     C                     END
     C                     Z-ADDXDINDT    #1KKDT
      * Validate Assigned Status
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1STAS'  IFEQ YPMTFD
      * Assigned Status
     C                     MOVEL#1STAS    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHSTAS
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHSTAS
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZHSTAS
     C                     ENDSL
     C                     EXFMTZGSTAS
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHSTAS    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHSTAS    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1STAS
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Available Status
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1XRST'  IFEQ YPMTFD
      * Available Status
     C                     MOVEL#1XRST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHXRST
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHXRST
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZHXRST
     C                     ENDSL
     C                     EXFMTZGXRST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHXRST    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHXRST    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1XRST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Record Status
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1VSST'  IFEQ YPMTFD
      * Record Status
     C                     MOVEL#1VSST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHVSST
     C                     SELEC
     C           W0INVL    WHEQ 'A'                        A
     C                     Z-ADD1         ZHVSST
     C           W0INVL    WHEQ 'I'                        I
     C                     Z-ADD2         ZHVSST
     C           W0INVL    WHEQ 'D'                        D
     C                     Z-ADD3         ZHVSST
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD4         ZHVSST
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD5         ZHVSST
     C           W0INVL    WHEQ 'E'                        E
     C                     Z-ADD6         ZHVSST
     C                     ENDSL
     C                     EXFMTZGVSST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHVSST    WHEQ 1
     C                     MOVEL'A'       W0INVL           A
     C           ZHVSST    WHEQ 2
     C                     MOVEL'I'       W0INVL           I
     C           ZHVSST    WHEQ 3
     C                     MOVEL'D'       W0INVL           D
     C           ZHVSST    WHEQ 4
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C           ZHVSST    WHEQ 5
     C                     MOVEL'N'       W0INVL           N
     C           ZHVSST    WHEQ 6
     C                     MOVEL'E'       W0INVL           E
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1VSST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate fields
     C                     MOVEL#DR6CD    #1BZNA           Carrier Code
      * Check if carrier or trailer has been changed (only avail when F6
      * CASE: carrier or trailer has changed
      *  - c1 OR c2
      *   |- c1    : DTL.USR Carrier Code NE PAR.USR Carrier Code
      *   |- c2    : DTL.Trailer ID USR NE PAR.Trailer ID USR
      *   '-
     C           #DR6CD    IFNE P6R6CD                     *IF
     C           #DS2TX    ORNE P8S2TX                     *OR
      * VAL Carr/Trlr Exists   RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1BZNA    WL0132    P      Carrier Code
     C                     MOVEL#DS2TX    WL0133    P      Trailer Id
     C                     EXSR SIRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Rtv Trailer            RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1BZNA    WL0003    P      Carrier Code
     C                     MOVEL#DS2TX    WL0004    P      Trailer Id
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    #1AIC3           Company Number
     C                     MOVELWL0006    #1VDST    P      Load Type
     C                     MOVELWL0007    #1X3ST    P      Trailer Type
     C                     MOVELWL0008    #1XGST    P      Seaboard Owned
     C                     MOVELWL0009    #1STOY    P      On Yard Status
     C                     Z-ADDWL0010    #1KKDT           On Yard Date
     C                     Z-ADDWL0011    #1AVTM           On Yard Time
     C                     MOVELWL0012    #1STAS    P      Assigned Status
     C                     MOVELWL0013    #1XRST    P      Available Statu
     C                     MOVELWL0014    #1X7CD    P      Not Available R
     C                     MOVELWL0015    #1GXTX    P      Comment Line
     C                     MOVELWL0016    #1VSST    P      Record Status
     C           #1AVTM    DIV  100       #DOYTM           USR On Yard Tim
     C                     MOVEL#DR6CD    P6R6CD           USR Carrier Cod
     C                     MOVEL#DS2TX    P8S2TX           Trailer ID USR
     C                     MOVEL'Y'       W0DCF            *Defer confirm
      * Send message 'PD Trailer Exists'
     C                     MOVEL'USR2666' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
      * Sel carrier
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.USR Carrier Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DR6CD'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Active Carrier     SR - OM Carrier  * 
     C                     CALL 'OMY6SRR'              90  SEL Active Carr
     C                     PARM *BLANK    W0RTN   7
     C           #DR6CD    PARM #DR6CD    WQ0004  3        Carrier Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMY6SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DBEXIT                     *QUIT
     C                     END                             *FI
      * Validate carrier code
      * CASE: DTL.USR Carrier Code EQ WRK.BLANK
     C           #DR6CD    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVEL#DR6CD    ZA0002           USR Carrier Cod
      * Send message 'Value Required'
     C                     MOVEL'USR1852' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Val Carrier Active     RT - Carrier  * 
     C                     EXSR SJRVGN
      * Error if not found
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DR6CD    ZA0003           USR Carrier Cod
      * Send message 'Carrier                NF'
     C                     MOVEL'USR1180' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * validate trailer id
      * CASE: DTL.Trailer ID USR EQ WRK.Blank for 12          USR
     C           #DS2TX    IFEQ WUS3TX                     *IF
      * Setup message data for message
     C                     MOVEL#DS2TX    ZA0004           Trailer ID USR
      * Send message 'Value Required (alpha)'
     C                     MOVEL'USR2808' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     END                             *FI
      * validate company number
     C                     EXSR UASUBR                     validate compan
      * Get any open loads for trailer
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.USR Carrier Code NE WRK.BLANK
      *   |- c2    : DTL.Trailer ID USR NE WRK.Blank for 12          USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DR6CD    IFNE WUGSTX                     *IF
     C           #DS2TX    IFNE WUS3TX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Load for DrpTrlrEx RT - Load Header  * 
     C                     EXSR SLRVGN
      * CASE: WRK.USR Active Load is no
     C           WUZJST    IFEQ 'N'                        *IF
      * RTV Load for DrpTrlrRp RT - Load Header  * 
     C                     EXSR SMRVGN
     C                     END                             *FI
      * * Flag if this trailer is already assigned to a load   E002966
      * CASE: WRK.USR Active Load is yes
     C           WUZJST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUDGTX           Status Flag 10
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUDGTX           Status Flag 10
     C                     END                             *FI
     C                     END                             *FI
      * Validate Load type
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.USR Load Type is Bulk & Regular
      *   |- c2    : DTL.Load Type NE PAR.USR Load Type
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3WNST    IFEQ 'B'                        *IF
     C           P3WNST    OREQ 'R'
     C           #1VDST    IFNE P3WNST                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVELP3WNST    ZA0006           USR Load Type
     C                     MOVEL#1VDST    ZA0007           Load Type
     C                     MOVEL#DS2TX    ZA0008           Trailer ID USR
      * Send message 'Load type must match load'
     C                     MOVEL'USR2613' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993432*
      *
     C                     END                             *FI
      * Validate Seaboard Owned Status
      * CASE: DTL.Seaboard Owned Status is yes
     C           #1XGST    IFEQ 'Y'                        *IF
      * CASE: PAR.Load ID is NE Blank
     C           P2RMNB    IFNE *ZERO                      *IF
      * Setup message data for message
     C                     MOVEL#1XGST    ZA0009           Seaboard Owned
     C                     Z-ADDP2RMNB    ZA0010           Load ID
      * Send message 'Seaboard Owned Sts eq yes'
     C                     MOVEL'USR2604' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate On Yard Date and Time
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DTL.On Yard Date is GT Zero
      *   |- c2    : DTL.USR On Yard Time NE WRK.ZERO
      *   '-
     C           #1KKDT    IFGT *ZERO                      *IF
     C           #DOYTM    ORNE WUW0NB                     *OR
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DTL.On Yard Date is not entered
      *   |- c2    : DTL.USR On Yard Time is Zero
      *   '-
     C           #1KKDT    IFEQ *ZERO                      *IF
     C           #DOYTM    OREQ *ZERO                      *OR
      * Setup message data for message
      * Convert On Yard Date to display format
      * Convert date
     C           1000000   ADD  #1KKDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0011
     C                     Z-ADD#DOYTM    ZA0012           USR On Yard Tim
      * Send message 'On Yard Date and Time mus'
     C                     MOVEL'USR2602' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993738*
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       #1STOY           On Yard Status
     C                     MOVEL'Y'       #1XRST           Available Statu
      * RMC Chg to user's dft company if ON YD chged, & multi-comp is no
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.USR On Yard Date NE DTL.On Yard Date
      *   |- c2    : PAR.USR Time NE DTL.USR On Yard Time
      *   '-
     C           P4LKDT    IFNE #1KKDT                     *IF
     C           P5WENB    ORNE #DOYTM                     *OR
      * RMC Chg to user's dft company if multi-comp is no    10/2/06
      * CASE: PAR.Allow Multi-Company is no
     C           P9I6ST    IFEQ 'N'                        *IF
     C                     Z-ADDP2AIC3    #1AIC3           Company Number
     C                     MOVEL*BLANK    #DSQTX           Company Name DR
      * Company Name DRV
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0001           Company Number
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #DSQTX    P      Name
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * * Allow trailer to be added when it is in transit     E002966
     C                     MOVEL'N'       #1STOY           On Yard Status
     C                     MOVEL'N'       #1XRST           Available Statu
     C                     END                             *FI
      * Validate Assigned Status
      * CASE: DTL.Assigned Status is no
     C           #1STAS    IFEQ 'N'                        *IF
      * CASE: WRK.USR Active Load is yes
     C           WUZJST    IFEQ 'Y'                        *IF
      * Active load
      * Setup message data for message
     C                     MOVEL#1STAS    ZA0013           Assigned Status
     C                     Z-ADDP2RMNB    ZA0014           Load ID
      * Send message 'Assigned sts cant be no'
     C                     MOVEL'USR2603' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.USR Active Load is no
     C           WUZJST    IFEQ 'N'                        *IF
      * Setup message data for message
     C                     MOVEL#1STAS    ZA0015           Assigned Status
      * Send message 'Assigned sts cant be yes'
     C                     MOVEL'USR2606' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate Record Status
      * CASE: DTL.Record Status is Inactive
     C           #1VSST    IFEQ 'I'                        *IF
      * CASE: DTL.Assigned Status is yes
     C           #1STAS    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1VSST    ZA0016           Record Status
      * Send message 'Record Status cannot be'
     C                     MOVEL'USR2605' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9942  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * Bypass ref file checks if error already detected
     C   99                GOTO DBEXIT
      * Select existing record
     C                     EXSR VACKRL
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Screen function fields
      * DTL.Load Type Desc = Condition name of DTL.Load Type
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1250409   Y2LSNO  70       List number
     C                     PARM #1VDST    W0INVL 25        Load Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DNONA    PARM           W0CNNM 25        Load Type Desc
      *
      * DTL.Condition Desc. 1  USR = Condition name of DTL.Trailer Type
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1496438   Y2LSNO  70       List number
     C                     PARM #1X3ST    W0INVL 25        Trailer Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHLTX    PARM           W0CNNM 25        Condition Desc.
      *
      * DTL.Status Description = Condition name of DTL.Seaboard Owned Sta
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100273   Y2LSNO  70       List number
     C                     PARM #1XGST    W0INVL 25        Seaboard Owned
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHKNA    PARM           W0CNNM 25        Status Descript
      *
      * DTL.Status Description 2 = Condition name of DTL.Assigned Status
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100273   Y2LSNO  70       List number
     C                     PARM #1STAS    W0INVL 25        Assigned Status
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DNINA    PARM           W0CNNM 25        Status Descript
      *
      * DTL.Status Description 3  USR = Condition name of DTL.Available S
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100273   Y2LSNO  70       List number
     C                     PARM #1XRST    W0INVL 25        Available Statu
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DNMTX    PARM           W0CNNM 25        Status Descript
      *
      * DTL.Condition Desc. 4  USR = Condition name of DTL.Record Status
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1255478   Y2LSNO  70       List number
     C                     PARM #1VSST    W0INVL 25        Record Status
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHOTX    PARM           W0CNNM 25        Condition Desc.
      *
     C           #DOYTM    MULT 100       #1AVTM           On Yard Time
     C                     END
      * USR Carrier Code required
     C           #DR6CD    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Trailer ID USR required
     C           #DS2TX    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9932  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Company Number required
     C           #1AIC3    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9933  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Load Type required
     C           #1VDST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9934  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Trailer Type required
     C           #1X3ST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9935  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Seaboard Owned Status required
     C           #1XGST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9936  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Assigned Status required
     C           #1STAS    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9939  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Available Status required
     C           #1XRST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9940  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Record Status required
     C           #1VSST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9942  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DHPMCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Update screen time
     C                     TIME           ##TME
      * Refresh screen
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#RCDDTL1
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for screen
      *================================================================
     C                     MOVEL'0'       *IN79
     C           P1BZNA    IFNE *BLANK                     *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           #1BZNA    IFNE *BLANK                     *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           P1DXTX    IFNE *BLANK                     *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C           P9I6ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         MALDSC    BEGSR
      *================================================================
      * Load screen from passed parameters
      *================================================================
     C                     MOVELP9I6ST    #PI6ST           Allow Multi-Com
     C                     MOVEL*BLANK    #1BZNA           Carrier Code
     C                     MOVEL*BLANK    #1DXTX           Trailer Id
     C                     MOVEL*BLANK    #1STOY           On Yard Status
     C                     Z-ADD*ZERO     #1AVTM           On Yard Time
     C                     MOVEL*BLANK    #1X7CD           Not Available R
     C                     MOVEL*BLANK    #1XTST           Status Unused 1
     C                     MOVEL*BLANK    #1XVST           Status Unused 2
     C                     MOVEL*BLANK    #1STU3           Status Unused 3
     C                     MOVEL*BLANK    #1STU4           Status Unused 4
     C                     MOVEL*BLANK    #1STU5           Status Unused 5
     C                     Z-ADD*ZERO     #1LCDT           Date Unused 1
     C                     Z-ADD*ZERO     #1LDDT           Date Unused 2
     C                     Z-ADD*ZERO     #1LEDT           Date Unused 3
     C                     Z-ADD*ZERO     #1LFDT           Date Unused 4
     C                     Z-ADD*ZERO     #1LGDT           Date Unused 5
     C                     MOVEL*BLANK    #1UVST           EDI Status 1
     C                     MOVEL*BLANK    #1UWST           EDI Status 2
     C                     MOVEL*BLANK    #1UXST           EDI Status 3
     C                     Z-ADD*ZERO     #1AATM           Job Time
     C                     MOVEL*BLANK    #1AYNA           User Id
     C                     MOVEL*BLANK    #1A0NA           Job Name
     C                     Z-ADD*ZERO     #1AXDT           Job Date
     C                     MOVEL*BLANK    #DR6CD           USR Carrier Cod
     C                     MOVEL*BLANK    #DADTX           Name
     C                     MOVEL*BLANK    #DS2TX           Trailer ID USR
     C                     Z-ADD*ZERO     #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     MOVEL*BLANK    #DSQTX           Company Name DR
     C                     MOVEL*BLANK    #1VDST           Load Type
     C                     MOVEL*BLANK    #DNONA           Load Type Desc
     C                     MOVEL*BLANK    #1X3ST           Trailer Type
     C                     MOVEL*BLANK    #DHLTX           Condition Desc.
     C                     MOVEL*BLANK    #1XGST           Seaboard Owned
     C                     MOVEL*BLANK    #DHKNA           Status Descript
     C                     Z-ADD*ZERO     #1KKDT           On Yard Date
      * Clear external version also
     C                     Z-ADD*ZERO     V1KKDT
     C                     Z-ADD*ZERO     #DOYTM           USR On Yard Tim
     C                     MOVEL*BLANK    #1STAS           Assigned Status
     C                     MOVEL*BLANK    #DNINA           Status Descript
     C                     MOVEL*BLANK    #1XRST           Available Statu
     C                     MOVEL*BLANK    #DNMTX           Status Descript
     C                     MOVEL*BLANK    #1GXTX           Comment Line
     C                     MOVEL*BLANK    #1VSST           Record Status
     C                     MOVEL*BLANK    #DHOTX           Condition Desc.
      * CALC: Screen function fields
      * DTL.Load Type Desc = Condition name of DTL.Load Type
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1250409   Y2LSNO  70       List number
     C                     PARM #1VDST    W0INVL 25        Load Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DNONA    PARM           W0CNNM 25        Load Type Desc
      *
      * DTL.Condition Desc. 1  USR = Condition name of DTL.Trailer Type
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1496438   Y2LSNO  70       List number
     C                     PARM #1X3ST    W0INVL 25        Trailer Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHLTX    PARM           W0CNNM 25        Condition Desc.
      *
      * DTL.Status Description = Condition name of DTL.Seaboard Owned Sta
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100273   Y2LSNO  70       List number
     C                     PARM #1XGST    W0INVL 25        Seaboard Owned
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHKNA    PARM           W0CNNM 25        Status Descript
      *
      * DTL.Status Description 2 = Condition name of DTL.Assigned Status
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100273   Y2LSNO  70       List number
     C                     PARM #1STAS    W0INVL 25        Assigned Status
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DNINA    PARM           W0CNNM 25        Status Descript
      *
      * DTL.Status Description 3  USR = Condition name of DTL.Available S
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100273   Y2LSNO  70       List number
     C                     PARM #1XRST    W0INVL 25        Available Statu
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DNMTX    PARM           W0CNNM 25        Status Descript
      *
      * DTL.Condition Desc. 4  USR = Condition name of DTL.Record Status
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1255478   Y2LSNO  70       List number
     C                     PARM #1VSST    W0INVL 25        Record Status
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHOTX    PARM           W0CNNM 25        Condition Desc.
      *
     C           #DOYTM    MULT 100       #1AVTM           On Yard Time
      * USER: Load screen
      * * Determine pgm mode-*add if not in trailer, but on load or not o
      * CASE: PAR.Trailer Id is Entered
     C           P1DXTX    IFNE *BLANK                     *IF
     C                     MOVELP1DXTX    #DS2TX           Trailer ID USR
      * Convert lower case trailer id to upper case           E004079
      * CASE: DTL.Trailer Id is Entered
     C           #1DXTX    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    YL0006           Case Sensitive
     C                     MOVELP1DXTX    YL0006           Case Sensitive
      * CVT to Upper Alpha 3   XF - /UT User Source  * 
     C                     CALL 'PBSBXFR'              90  CVT to Upper Al
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0006    WQ0012 30        Case Sensitive
     C           YL0007    PARM *BLANK    WQ0013 30        Case Upper Fiel
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBSBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0007    #DS2TX           Trailer ID USR
     C                     END                             *FI
     C                     MOVELP1BZNA    #DR6CD           USR Carrier Cod
      * VAL Carr/Trlr Exists   RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DR6CD    WL0132    P      Carrier Code
     C                     MOVEL#DS2TX    WL0133    P      Trailer Id
     C                     EXSR SIRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * * Change mode - trailer already in the trailer file
      * Change mode initialize
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Carrier Code NE WRK.BLANK
      *   |- c2    : PAR.Trailer Id NE WRK.BLANK
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1BZNA    IFNE WUGSTX                     *IF
     C           P1DXTX    IFNE WUGSTX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVELP1BZNA    #1BZNA           Carrier Code
     C                     MOVELP1DXTX    #1DXTX           Trailer Id
     C                     MOVEL#1BZNA    #DR6CD           USR Carrier Cod
      * Convert lower case trailer id to upper case           E004079
      * CASE: DTL.Trailer Id is Entered
     C           #1DXTX    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    YL0006           Case Sensitive
     C                     MOVEL#1DXTX    YL0006           Case Sensitive
      * CVT to Upper Alpha 3   XF - /UT User Source  * 
     C                     CALL 'PBSBXFR'              90  CVT to Upper Al
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0006    WQ0014 30        Case Sensitive
     C           YL0007    PARM *BLANK    WQ0015 30        Case Upper Fiel
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBSBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0007    #1DXTX           Trailer Id
     C                     END                             *FI
      * Rtv Trailer            RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1BZNA    WL0003    P      Carrier Code
     C                     MOVEL#1DXTX    WL0004    P      Trailer Id
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    #1AIC3           Company Number
     C                     MOVELWL0006    #1VDST    P      Load Type
     C                     MOVELWL0007    #1X3ST    P      Trailer Type
     C                     MOVELWL0008    #1XGST    P      Seaboard Owned
     C                     MOVELWL0009    #1STOY    P      On Yard Status
     C                     Z-ADDWL0010    #1KKDT           On Yard Date
     C                     Z-ADDWL0011    #1AVTM           On Yard Time
     C                     MOVELWL0012    #1STAS    P      Assigned Status
     C                     MOVELWL0013    #1XRST    P      Available Statu
     C                     MOVELWL0014    #1X7CD    P      Not Available R
     C                     MOVELWL0015    #1GXTX    P      Comment Line
     C                     MOVELWL0016    #1VSST    P      Record Status
     C                     MOVEL#1DXTX    #DS2TX           Trailer ID USR
      * error and quit if record not found
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DS2TX    ZA0017           Trailer ID USR
      * Send message 'Trailer                NF'
     C                     MOVEL'USR2598' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     GOTO MAEXIT                     *QUIT
     C                     END                             *FI
      * RTV Carrier Name       RT - OM Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1BZNA    WL0017    P      Carrier Code
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0018    #DADTX    P      Name
     C                     MOVELWL0019    WUVSST    P      Record Status
      * DTL.Condition Desc. 1  USR = Condition name of DTL.Trailer Type
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1496438   Y2LSNO  70       List number
     C                     PARM #1X3ST    W0INVL 25        Trailer Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHLTX    PARM           W0CNNM 25        Condition Desc.
      *
      * DTL.Load Type Desc = Condition name of DTL.Load Type
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1250409   Y2LSNO  70       List number
     C                     PARM #1VDST    W0INVL 25        Load Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DNONA    PARM           W0CNNM 25        Load Type Desc
      *
      * DTL.Status Description = Condition name of DTL.Seaboard Owned Sta
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100273   Y2LSNO  70       List number
     C                     PARM #1XGST    W0INVL 25        Seaboard Owned
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHKNA    PARM           W0CNNM 25        Status Descript
      *
      * DTL.Status Description 2 = Condition name of DTL.Assigned Status
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100273   Y2LSNO  70       List number
     C                     PARM #1STAS    W0INVL 25        Assigned Status
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DNINA    PARM           W0CNNM 25        Status Descript
      *
      * DTL.Status Description 3  USR = Condition name of DTL.Available S
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100273   Y2LSNO  70       List number
     C                     PARM #1XRST    W0INVL 25        Available Statu
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DNMTX    PARM           W0CNNM 25        Status Descript
      *
      * DTL.Condition Desc. 4  USR = Condition name of DTL.Record Status
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1255478   Y2LSNO  70       List number
     C                     PARM #1VSST    W0INVL 25        Record Status
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHOTX    PARM           W0CNNM 25        Condition Desc.
      *
     C           #1AVTM    DIV  100       #DOYTM           USR On Yard Tim
      * Save to check for change later.
     C                     Z-ADD#1KKDT    P4LKDT           USR On Yard Dat
     C                     Z-ADD#1AVTM    P5WENB           USR Time
     C                     MOVEL*BLANK    #DSQTX           Company Name DR
      * Company Name DRV
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0001           Company Number
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #DSQTX    P      Name
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * * Add mode - trailer is not yet in the trailer file
      * * but was assigned to a load                          E002966
      * CASE: DTL.Company Number is Equal to zero
     C           #1AIC3    IFEQ *ZERO                      *IF
     C                     Z-ADDP2AIC3    #1AIC3           Company Number
     C                     END                             *FI
     C                     MOVEL*BLANK    #DSQTX           Company Name DR
      * Company Name DRV
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0001           Company Number
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #DSQTX    P      Name
     C                     MOVELP1BZNA    #1BZNA           Carrier Code
     C                     MOVELP1DXTX    #1DXTX           Trailer Id
      * Convert lower case trailer id to upper case           E004079
      * CASE: DTL.Trailer Id is Entered
     C           #1DXTX    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    YL0006           Case Sensitive
     C                     MOVEL#1DXTX    YL0006           Case Sensitive
      * CVT to Upper Alpha 3   XF - /UT User Source  * 
     C                     CALL 'PBSBXFR'              90  CVT to Upper Al
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0006    WQ0016 30        Case Sensitive
     C           YL0007    PARM *BLANK    WQ0017 30        Case Upper Fiel
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBSBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0007    #1DXTX           Trailer Id
     C                     END                             *FI
     C                     MOVEL#1DXTX    #DS2TX           Trailer ID USR
     C                     MOVELP1BZNA    #DR6CD           USR Carrier Cod
     C                     MOVEL'R'       #1VDST           Load Type
     C                     MOVEL'R'       #1X3ST           Trailer Type
     C                     MOVEL'N'       #1XGST           Seaboard Owned
     C                     MOVEL'Y'       #1STAS           Assigned Status
     C                     MOVEL'N'       #1XRST           Available Statu
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           WUSDTE    PARM *ZERO     WQ0018 155       Current System
     C           WUZHNB    PARM *ZERO     WQ0019 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * DTL.On Yard Date = WRK.Current System Date
     C                     Z-ADDWUSDTE    #1KKDT           On Yard Date
      * DTL.On Yard Time = WRK.Current System Time
     C                     Z-ADDWUZHNB    #1AVTM           On Yard Time
     C           #1AVTM    DIV  100       #DOYTM           USR On Yard Tim
     C                     MOVEL'Y'       #1STOY           On Yard Status
     C                     MOVEL*BLANK    #1GXTX           Comment Line
     C                     MOVEL'A'       #1VSST           Record Status
      * DTL.Load Type Desc = Condition name of DTL.Load Type
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1250409   Y2LSNO  70       List number
     C                     PARM #1VDST    W0INVL 25        Load Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DNONA    PARM           W0CNNM 25        Load Type Desc
      *
      * DTL.Condition Desc. 1  USR = Condition name of DTL.Trailer Type
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1496438   Y2LSNO  70       List number
     C                     PARM #1X3ST    W0INVL 25        Trailer Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHLTX    PARM           W0CNNM 25        Condition Desc.
      *
      * DTL.Status Description = Condition name of DTL.Seaboard Owned Sta
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100273   Y2LSNO  70       List number
     C                     PARM #1XGST    W0INVL 25        Seaboard Owned
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHKNA    PARM           W0CNNM 25        Status Descript
      *
      * DTL.Status Description 2 = Condition name of DTL.Assigned Status
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100273   Y2LSNO  70       List number
     C                     PARM #1STAS    W0INVL 25        Assigned Status
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DNINA    PARM           W0CNNM 25        Status Descript
      *
      * DTL.Status Description 3  USR = Condition name of DTL.Available S
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100273   Y2LSNO  70       List number
     C                     PARM #1XRST    W0INVL 25        Available Statu
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DNMTX    PARM           W0CNNM 25        Status Descript
      *
      * DTL.Condition Desc. 4  USR = Condition name of DTL.Record Status
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1255478   Y2LSNO  70       List number
     C                     PARM #1VSST    W0INVL 25        Record Status
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHOTX    PARM           W0CNNM 25        Condition Desc.
      *
     C                     Z-ADD#1KKDT    P4LKDT           USR On Yard Dat
     C                     Z-ADD#1AVTM    P5WENB           USR Time
     C                     MOVEL'Y'       WUDGTX           Status Flag 10
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * * Add mode - trailer not yet in trailer file & not assigned to lo
      * Add mode initialize
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Carrier Code EQ WRK.BLANK
      *   |- c2    : PAR.Trailer Id EQ WRK.BLANK
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1BZNA    IFEQ WUGSTX                     *IF
     C           P1DXTX    IFEQ WUGSTX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: DTL.Company Number is Equal to zero
     C           #1AIC3    IFEQ *ZERO                      *IF
     C                     Z-ADDP2AIC3    #1AIC3           Company Number
     C                     END                             *FI
     C                     MOVEL*BLANK    #DSQTX           Company Name DR
      * Company Name DRV
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0001           Company Number
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #DSQTX    P      Name
     C                     MOVELP1BZNA    #1BZNA           Carrier Code
     C                     MOVELP1DXTX    #1DXTX           Trailer Id
      * Convert lower case trailer id to upper case           E004079
      * CASE: DTL.Trailer Id is Entered
     C           #1DXTX    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    YL0006           Case Sensitive
     C                     MOVEL#1DXTX    YL0006           Case Sensitive
      * CVT to Upper Alpha 3   XF - /UT User Source  * 
     C                     CALL 'PBSBXFR'              90  CVT to Upper Al
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0006    WQ0020 30        Case Sensitive
     C           YL0007    PARM *BLANK    WQ0021 30        Case Upper Fiel
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBSBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0007    #1DXTX           Trailer Id
     C                     END                             *FI
     C                     MOVEL#1DXTX    #DS2TX           Trailer ID USR
     C                     MOVELP1BZNA    #DR6CD           USR Carrier Cod
     C                     MOVEL'R'       #1VDST           Load Type
     C                     MOVEL'R'       #1X3ST           Trailer Type
     C                     MOVEL'N'       #1XGST           Seaboard Owned
     C                     MOVEL'N'       #1STAS           Assigned Status
     C                     MOVEL'Y'       #1XRST           Available Statu
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           WUSDTE    PARM *ZERO     WQ0022 155       Current System
     C           WUZHNB    PARM *ZERO     WQ0023 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * DTL.On Yard Date = WRK.Current System Date
     C                     Z-ADDWUSDTE    #1KKDT           On Yard Date
      * DTL.On Yard Time = WRK.Current System Time
     C                     Z-ADDWUZHNB    #1AVTM           On Yard Time
     C           #1AVTM    DIV  100       #DOYTM           USR On Yard Tim
     C                     MOVEL'Y'       #1STOY           On Yard Status
     C                     MOVEL*BLANK    #1GXTX           Comment Line
     C                     MOVEL'A'       #1VSST           Record Status
      * DTL.Load Type Desc = Condition name of DTL.Load Type
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1250409   Y2LSNO  70       List number
     C                     PARM #1VDST    W0INVL 25        Load Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DNONA    PARM           W0CNNM 25        Load Type Desc
      *
      * DTL.Condition Desc. 1  USR = Condition name of DTL.Trailer Type
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1496438   Y2LSNO  70       List number
     C                     PARM #1X3ST    W0INVL 25        Trailer Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHLTX    PARM           W0CNNM 25        Condition Desc.
      *
      * DTL.Status Description = Condition name of DTL.Seaboard Owned Sta
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100273   Y2LSNO  70       List number
     C                     PARM #1XGST    W0INVL 25        Seaboard Owned
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHKNA    PARM           W0CNNM 25        Status Descript
      *
      * DTL.Status Description 2 = Condition name of DTL.Assigned Status
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100273   Y2LSNO  70       List number
     C                     PARM #1STAS    W0INVL 25        Assigned Status
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DNINA    PARM           W0CNNM 25        Status Descript
      *
      * DTL.Status Description 3  USR = Condition name of DTL.Available S
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100273   Y2LSNO  70       List number
     C                     PARM #1XRST    W0INVL 25        Available Statu
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DNMTX    PARM           W0CNNM 25        Status Descript
      *
      * DTL.Condition Desc. 4  USR = Condition name of DTL.Record Status
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1255478   Y2LSNO  70       List number
     C                     PARM #1VSST    W0INVL 25        Record Status
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHOTX    PARM           W0CNNM 25        Condition Desc.
      *
     C                     Z-ADD#1KKDT    P4LKDT           USR On Yard Dat
     C                     Z-ADD#1AVTM    P5WENB           USR Time
     C                     MOVEL'N'       WUDGTX           Status Flag 10
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert On Yard Date to display format
      * Convert date
     C           1000000   ADD  #1KKDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1KKDT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0001    WAAIC3           Company Number
      * Establish starting position
     C           KRSSA     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           Name
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAADTX    WL0002           Name
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Trailer            RT - PD Trailer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           LYBZNA           Carrier Code
     C                     KFLD           LYDXTX           Trailer Id
      * Setup key
     C                     MOVELWL0003    LYBZNA           Carrier Code
     C                     MOVELWL0004    LYDXTX           Trailer Id
      * Establish starting position
     C           KRSSB     CHAIN@LYRER3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2598' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0005           Company Number
     C                     MOVEL*BLANK    WL0006           Load Type
     C                     MOVEL*BLANK    WL0007           Trailer Type
     C                     MOVEL*BLANK    WL0008           Seaboard Owned
     C                     MOVEL*BLANK    WL0009           On Yard Status
     C                     Z-ADD*ZERO     WL0010           On Yard Date
     C                     Z-ADD*ZERO     WL0011           On Yard Time
     C                     MOVEL*BLANK    WL0012           Assigned Status
     C                     MOVEL*BLANK    WL0013           Available Statu
     C                     MOVEL*BLANK    WL0014           Not Available R
     C                     MOVEL*BLANK    WL0015           Comment Line
     C                     MOVEL*BLANK    WL0016           Record Status
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDLYAIC3    WL0005           Company Number
     C                     MOVELLYVDST    WL0006           Load Type
     C                     MOVELLYX3ST    WL0007           Trailer Type
     C                     MOVELLYXGST    WL0008           Seaboard Owned
     C                     MOVELLYSTOY    WL0009           On Yard Status
     C                     Z-ADDLYKKDT    WL0010           On Yard Date
     C                     Z-ADDLYAVTM    WL0011           On Yard Time
     C                     MOVELLYSTAS    WL0012           Assigned Status
     C                     MOVELLYXRST    WL0013           Available Statu
     C                     MOVELLYX7CD    WL0014           Not Available R
     C                     MOVELLYGXTX    WL0015           Comment Line
     C                     MOVELLYVSST    WL0016           Record Status
     C                     GOTO SBEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Carrier Name       RT - OM Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WBBZNA           Carrier Code
      * Setup key
     C                     MOVELWL0017    WBBZNA           Carrier Code
      * Establish starting position
     C           KRSSC     CHAIN@FFREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0018           Name
     C                     MOVEL*BLANK    WL0019           Record Status
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBADTX    WL0018           Name
     C                     MOVELWBVSST    WL0019           Record Status
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCRRC    BEGSR
      *================================================================
      * CRT or Chg Trailer     CR - Trailer  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  1        Status Unused 1
     C                     MOVEL*BLANK    WN0002  1        Status Unused 2
     C                     MOVEL*BLANK    WN0003  1        Status Unused 3
     C                     MOVEL*BLANK    WN0004  1        Status Unused 4
     C                     MOVEL*BLANK    WN0005  1        Status Unused 5
     C                     Z-ADD*ZERO     WN0006  70       Date Unused 1
     C                     Z-ADD*ZERO     WN0007  70       Date Unused 2
     C                     Z-ADD*ZERO     WN0008  70       Date Unused 3
     C                     Z-ADD*ZERO     WN0009  70       Date Unused 4
     C                     Z-ADD*ZERO     WN0010  70       Date Unused 5
     C                     MOVEL*BLANK    WN0011  1        EDI Status 1
     C                     MOVEL*BLANK    WN0012  1        EDI Status 2
     C                     MOVEL*BLANK    WN0013  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0014  60       Job Time
     C                     MOVEL*BLANK    WN0015 10        User Id
     C                     MOVEL*BLANK    WN0016 10        Job Name
     C                     Z-ADD*ZERO     WN0017  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @LYRER2
     C                     MOVEL#1BZNA    WCBZNA           Carrier Code
     C                     MOVEL#DS2TX    WCDXTX           Trailer Id
     C                     Z-ADD#1AIC3    WCAIC3           Company Number
     C                     MOVEL#1VDST    WCVDST           Load Type
     C                     MOVEL#1X3ST    WCX3ST           Trailer Type
     C                     MOVEL#1XGST    WCXGST           Seaboard Owned
     C                     MOVEL#1STOY    WCSTOY           On Yard Status
     C                     Z-ADD#1KKDT    WCKKDT           On Yard Date
     C                     Z-ADD#1AVTM    WCAVTM           On Yard Time
     C                     MOVEL#1STAS    WCSTAS           Assigned Status
     C                     MOVEL#1XRST    WCXRST           Available Statu
     C                     MOVEL#1X7CD    WCX7CD           Not Available R
     C                     MOVEL#1GXTX    WCGXTX           Comment Line
     C                     MOVEL#1VSST    WCVSST           Record Status
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WCAATM           Job Time
     C                     MOVEL##USR     WCAYNA           User Id
     C                     MOVEL##PGM     WCA0NA           Job Name
     C                     Z-ADD##JDT     WCAXDT           Job Date
     C           KLCRSD    KLIST
     C                     KFLD           WCBZNA           Carrier Code
     C                     KFLD           WCDXTX           Trailer Id
      * Check for duplicate primary key
     C           KLCRSD    SETLL@LYRER2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2599' W0RTN   7
      * USER: Processing if Data record already exists
      * Chg Trailer,Load Hdr   IF
      * Chg PD Trailer         CH - Trailer  * 
     C                     EXSR SECHRC
      * Change Load Headers not yet departed if the on yard dt/tm changed
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.USR On Yard Date NE PAR.On Yard Date
      *   |- c2    : PAR.On Yard Time NE PAR.USR Time
      *   '-
     C           P4LKDT    IFNE #1KKDT                     *IF
     C           #1AVTM    ORNE P5WENB                     *OR
      * Rtv/Chg On Yard Dt,Tm  RT - Load Header  * 
     C                     EXSR SFRVGN
     C                     END                             *FI
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C                     WRITE@LYRER2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECHRC    BEGSR
      *================================================================
      * Chg PD Trailer         CH - Trailer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @LYRER2
     C                     MOVEL#1BZNA    WCBZNA    P      Carrier Code
     C                     MOVEL#DS2TX    WCDXTX    P      Trailer Id
      *
     C           KLCHSE    KLIST
     C                     KFLD           WCBZNA           Carrier Code
     C                     KFLD           WCDXTX           Trailer Id
     C           KLCHSE    CHAIN@LYRER2              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDLYREL0'MDACP
     C                     MOVEL'@LYRER2' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDLY1    YARDCS
      * Move non-key fields to @LYRER2
     C                     Z-ADD#1AIC3    WCAIC3           Company Number
     C                     MOVEL#1VDST    WCVDST    P      Load Type
     C                     MOVEL#1X3ST    WCX3ST    P      Trailer Type
     C                     MOVEL#1XGST    WCXGST    P      Seaboard Owned
     C                     MOVEL#1STOY    WCSTOY    P      On Yard Status
     C                     Z-ADD#1KKDT    WCKKDT           On Yard Date
     C                     Z-ADD#1AVTM    WCAVTM           On Yard Time
     C                     MOVEL#1STAS    WCSTAS    P      Assigned Status
     C                     MOVEL#1XRST    WCXRST    P      Available Statu
     C                     MOVEL#1X7CD    WCX7CD    P      Not Available R
     C                     MOVEL#1GXTX    WCGXTX    P      Comment Line
     C                     MOVELWN0001    WCXTST    P      Status Unused 1
     C                     MOVELWN0002    WCXVST    P      Status Unused 2
     C                     MOVELWN0003    WCSTU3    P      Status Unused 3
     C                     MOVELWN0004    WCSTU4    P      Status Unused 4
     C                     MOVELWN0005    WCSTU5    P      Status Unused 5
     C                     Z-ADDWN0006    WCLCDT           Date Unused 1
     C                     Z-ADDWN0007    WCLDDT           Date Unused 2
     C                     Z-ADDWN0008    WCLEDT           Date Unused 3
     C                     Z-ADDWN0009    WCLFDT           Date Unused 4
     C                     Z-ADDWN0010    WCLGDT           Date Unused 5
     C                     MOVELWN0011    WCUVST    P      EDI Status 1
     C                     MOVELWN0012    WCUWST    P      EDI Status 2
     C                     MOVELWN0013    WCUXST    P      EDI Status 3
     C                     MOVEL#1VSST    WCVSST    P      Record Status
     C                     Z-ADD##JTM     WCAATM           Job Time
     C                     MOVEL##USR     WCAYNA    P      User Id
     C                     MOVEL##PGM     WCA0NA    P      Job Name
     C                     Z-ADD##JDT     WCAXDT           Job Date
      *
      * Set PGM.*Record Data Changed flag
     C           QPDLY1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WCAATM           Job Time
     C                     MOVEL##USR     WCAYNA           User Id
     C                     MOVEL##JOB     WCA0NA           Job Name
     C                     Z-ADD##JDT     WCAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDLY1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@LYRER2                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDLYREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv/Chg On Yard Dt,Tm  RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDBZNA    WQSF01           Carrier Code
     C           *LIKE     DEFN WDDXTX    WQSF02           Trailer Id
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Carrier Code
     C                     KFLD           WQSF02           Trailer Id
      * Setup key
     C                     MOVEL#1BZNA    WQSF01           Carrier Code
     C                     MOVEL#DS2TX    WQSF02           Trailer Id
      * Establish starting position
     C           KRSSF     SETLL@FJCPR4                    *
     C           KRSSF     READE@FJCPR4                  90*
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * If truck not yet departed, update On Yard DT,Tm on Load Header
      * CASE: DB1.Truck Departure Date is not entered
     C           WDKIDT    IFEQ 0                          *IF
      * Chg On Yard Dt,Tm      CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDRMNB    WL0020           Load ID
     C                     Z-ADDWDAIC3    WL0021           Company Number
     C                     Z-ADDWDAODT    WL0022           Scheduled Ship
     C                     MOVELWDPJST    WL0023    P      LTL Flag
     C                     MOVELWDPKST    WL0024    P      Load Status
     C                     Z-ADDWDRNNB    WL0025           Reefer Temperat
     C                     MOVELWDDMTX    WL0026    P      Seal 1
     C                     MOVELWDDNTX    WL0027    P      Seal 2
     C                     MOVELWDDOTX    WL0028    P      Seal 3
     C                     Z-ADDWDRPNB    WL0029           Total Load Orde
     C                     Z-ADDWDFLAM    WL0030           Flat Amount
     C                     MOVELWDXQST    WL0031    P      Allocate Pounds
     C                     Z-ADDWDRRNB    WL0032           Total Stops
     C                     MOVELWDDXTX    WL0033    P      Trailer Id
     C                     MOVELWDDYTX    WL0034    P      Transloader Car
     C                     Z-ADDWDSBNB    WL0035           BOL Time
     C                     MOVELWDBZNA    WL0036    P      Carrier Code
     C                     MOVELWDRONB    WL0037    P      Truck Size
     C                     Z-ADDWDSQNB    WL0038           Ld Hdr/Ld Dtl U
     C                     Z-ADDWDR1NB    WL0039           Rated Freight
     C                     MOVELWDVCST    WL0040    P      Ship Status
     C                     MOVELWDVDST    WL0041    P      Load Type
     C                     Z-ADDWDSDNB    WL0042           Number Pallets
     C                     Z-ADDWDPAOU    WL0043           Number Pallets
     C                     Z-ADDWDDGWG    WL0044           Load Carrier Pa
     C                     Z-ADDWDSXNB    WL0045           Estimated Arriv
     C                     Z-ADDWDHADT    WL0046           Actual Arrival
     C                     Z-ADDWDAART    WL0047           Actual Arrival
     C                     Z-ADDWDDHWG    WL0048           Trailer IN Weig
     C                     Z-ADDWDDIWG    WL0049           Trailer OUT Wei
     C                     Z-ADDWDAQDT    WL0050           Actual Departur
     C                     Z-ADDWDS6NB    WL0051           Departure Time
     C                     Z-ADDWDT4NB    WL0052           Schedule Sequen
     C                     Z-ADDWDPRTM    WL0053           Product Tempera
     C                     Z-ADDWDNPSV    WL0054           Number Pallets
     C                     MOVELWDJ8TX    WL0055    P      Car/Veh. Initia
     C                     Z-ADDWDTLMI    WL0056           Total Load Mile
     C                     MOVELWDJ9TX    WL0057    P      Recorder ID
     C                     MOVELWDQ2CD    WL0058    P      Shipping Method
     C                     MOVELWDVPCD    WL0059    P      Ship From Wareh
     C                     MOVELWDDBCD    WL0060    P      Ship To State C
     C                     Z-ADDWDGRWE    WL0061           Gross Weight
     C                     MOVELWDXCCD    WL0062    P      Carrier Broker
     C                     MOVELWDU2ST    WL0063    P      Export Status
     C                     Z-ADDWDF9DT    WL0064           Actual Ship Dat
     C                     MOVELWDONTM    WL0065    P      On Time - (Y/N)
     C                     Z-ADDWDJ4DT    WL0066           Truck Ready Dat
     C                     Z-ADDWDTRTM    WL0067           Truck Ready Tim
     C                     Z-ADDWDJ5DT    WL0068           Spotted Date
     C                     Z-ADDWDSPTM    WL0069           Spotted Time
     C                     Z-ADDWDJ6DT    WL0070           Load Finished D
     C                     Z-ADDWDLFTM    WL0071           Load Finished T
     C                     Z-ADDWDJ7DT    WL0072           BOL Complete Da
     C                     Z-ADDWDBOTM    WL0073           BOL Complete Ti
     C                     Z-ADDWDJ8DT    WL0074           BOL Received Da
     C                     Z-ADDWDBLTM    WL0075           BOL Received Ti
     C                     Z-ADDWDKIDT    WL0076           Truck Departure
     C                     Z-ADDWDASTM    WL0077           Truck Departure
     C                     Z-ADDWDKADT    WL0078           Adjusted Depart
     C                     Z-ADDWDAJCM    WL0079           Adjusted Depart
     C                     MOVELWDXACD    WL0080    P      Shipping Line
     C                     MOVELWDOANA    WL0081    P      Port Delv Termi
     C                     MOVELWDK4TX    WL0082    P      Vessel Name
     C                     Z-ADDWDVOAG    WL0083           Voyage
     C                     Z-ADDWDKBDT    WL0084           Sail Date
     C                     MOVELWDNBBO    WL0085    P      Booking Number
     C                     MOVELWDW4CD    WL0086    P      Discharge Port
     C                     Z-ADDWDEFDT    WL0087           Arrival Date
     C                     MOVELWDCNTN    WL0088    P      Container Numbe
     C                     Z-ADDWDKCDT    WL0089           Date In
     C                     Z-ADDWDTMIN    WL0090           Time In
     C                     Z-ADDWDKDDT    WL0091           Date Out
     C                     Z-ADDWDVMNB    WL0092           Time Out
     C                     Z-ADDWDOCFR    WL0093           Load Total Frei
     C                     Z-ADDWDKJDT    WL0094           Scheduled Deliv
     C                     Z-ADDWDATTM    WL0095           Scheduled Deliv
     C                     MOVELWDOTRS    WL0096    P      LH Unused Sts
     C                     MOVELWDRNST    WL0097    P      LH Carrier Paym
     C                     Z-ADDWDBRBK    WL0098           Bring Back Mile
     C                     Z-ADDWDEIDT    WL0099           Requested Deliv
     C                     MOVELWDRMST    WL0100    P      Load Acceptance
     C                     MOVELWDAJCD    WL0101    P      Warehouse Code
     C                     Z-ADD#1KKDT    WL0102           On Yard Date
     C                     Z-ADD#1AVTM    WL0103           On Yard Time
     C                     Z-ADDWDKZDT    WL0104           Deadline Depart
     C                     Z-ADDWDAXTM    WL0105           Deadline Depart
     C                     MOVELWDLHOS    WL0106    P      Load Held Over
     C                     MOVELWDLHOR    WL0107    P      Load Held Over
     C                     MOVELWDOITX    WL0108    P      Ocean BOL Numbe
     C                     MOVELWDOJTX    WL0109    P      Express Mail Nu
     C                     Z-ADDWDLLDT    WL0110           Express Mail Da
     C                     MOVELWDLSHG    WL0111    P      Load Shag Flag
     C                     MOVELWDYPST    WL0112    P      Load Wash Flag
     C                     Z-ADDWDK0DT    WL0113           Product Complet
     C                     Z-ADDWDAYTM    WL0114           Product Complet
     C                     Z-ADDWDK1DT    WL0115           Load Confirmati
     C                     Z-ADDWDAZTM    WL0116           Load Door 1
     C                     Z-ADDWDK2DT    WL0117           Override Total
     C                     Z-ADDWDA0TM    WL0118           Load Door 2
     C                     MOVELWDROST    WL0119    P      Partial Load
     C                     MOVELWDRPST    WL0120    P      Load Confirmati
     C                     MOVELWDRQST    WL0121    P      Export Load USD
     C                     MOVELWDRRST    WL0122    P      Late Delivery E
     C                     Z-ADDWDZBVA    WL0123           Load Actual Fre
     C                     MOVELWDR3SX    WL0124    P      LH On-Time Reas
     C                     MOVELWDUVST    WL0125    P      EDI Status 1
     C                     MOVELWDUWST    WL0126    P      EDI Status 2
     C                     MOVELWDUXST    WL0127    P      EDI Status 3
     C                     Z-ADDWDAATM    WL0128           Job Time
     C                     MOVELWDAYNA    WL0129    P      User Id
     C                     MOVELWDA0NA    WL0130    P      Job Name
     C                     Z-ADDWDAXDT    WL0131           Job Date
     C                     EXSR SGCHRC
     C                     END                             *FI
     C           KRSSF     READE@FJCPR4                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCHRC    BEGSR
      *================================================================
      * Chg On Yard Dt,Tm      CH - Load Header  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     MOVEL*BLANK    WN0018 15        Seal 1 Unused
     C                     MOVEL*BLANK    WN0019 15        Seal 2 Unused
     C                     MOVEL*BLANK    WN0020 15        Load Held Over
     C                     Z-ADD*ZERO     WN0021  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0022  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0023  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0024  1        Load Confirmed
     C                     MOVEL*BLANK    WN0025 25        Load Confirmed
     C                     MOVEL*BLANK    WN0026 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0027 15        Late Billing Em
     C                     MOVEL*BLANK    WN0028 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0029 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0030  1        Multi Company L
     C                     MOVEL*BLANK    WN0031  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0032  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0033  1        LH Power Only L
     C                     MOVEL*BLANK    WN0034  1        LH Unused Sts 4
     C                     MOVEL*BLANK    WN0035  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0036  2        Load U/M
     C                     MOVEL*BLANK    WN0037  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0038  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0039  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0040  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0041  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0042  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0043  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0044  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0045  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0046  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0047  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0048  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0049  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0050  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0051  60       LH Unused Time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWL0020    WERMNB           Load ID
      *
     C           KLCHSG    KLIST
     C                     KFLD           WERMNB           Load ID
     C           KLCHSG    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YBRDCS
      * USER: Processing after Data read
      * Save copy of fields written to Load Order Change Log
      * CASE: *OTHERWISE
     C                     MOVELWEBZNA    YL0001           Carrier Code
     C                     Z-ADDWEKJDT    YL0002           Scheduled Deliv
      * Move non-key fields to @FJCPBO
     C                     Z-ADDWL0021    WEAIC3           Company Number
     C                     Z-ADDWL0022    WEAODT           Scheduled Ship
     C                     MOVELWL0023    WEPJST    P      LTL Flag
     C                     MOVELWL0024    WEPKST    P      Load Status
     C                     Z-ADDWL0025    WERNNB           Reefer Temperat
     C                     MOVELWL0026    WEDMTX    P      Seal 1
     C                     MOVELWL0027    WEDNTX    P      Seal 2
     C                     MOVELWL0028    WEDOTX    P      Seal 3
     C                     Z-ADDWL0029    WERPNB           Total Load Orde
     C                     Z-ADDWL0030    WEFLAM           Flat Amount
     C                     MOVELWL0031    WEXQST    P      Allocate Pounds
     C                     Z-ADDWL0032    WERRNB           Total Stops
     C                     MOVELWL0033    WEDXTX    P      Trailer Id
     C                     MOVELWL0034    WEDYTX    P      Transloader Car
     C                     Z-ADDWL0035    WESBNB           BOL Time
     C                     MOVELWL0036    WEBZNA    P      Carrier Code
     C                     MOVELWL0037    WERONB    P      Truck Size
     C                     Z-ADDWL0038    WESQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADDWL0039    WER1NB           Rated Freight
     C                     MOVELWL0040    WEVCST    P      Ship Status
     C                     MOVELWL0041    WEVDST    P      Load Type
     C                     Z-ADDWL0042    WESDNB           Number Pallets
     C                     Z-ADDWL0043    WEPAOU           Number Pallets
     C                     Z-ADDWL0044    WEDGWG           Load Carrier Pa
     C                     Z-ADDWL0045    WESXNB           Estimated Arriv
     C                     Z-ADDWL0046    WEHADT           Actual Arrival
     C                     Z-ADDWL0047    WEAART           Actual Arrival
     C                     Z-ADDWL0048    WEDHWG           Trailer IN Weig
     C                     Z-ADDWL0049    WEDIWG           Trailer OUT Wei
     C                     Z-ADDWL0050    WEAQDT           Actual Departur
     C                     Z-ADDWL0051    WES6NB           Departure Time
     C                     Z-ADDWL0052    WET4NB           Schedule Sequen
     C                     Z-ADDWL0053    WEPRTM           Product Tempera
     C                     Z-ADDWL0054    WENPSV           Number Pallets
     C                     MOVELWL0055    WEJ8TX    P      Car/Veh. Initia
     C                     Z-ADDWL0056    WETLMI           Total Load Mile
     C                     MOVELWL0057    WEJ9TX    P      Recorder ID
     C                     MOVELWL0058    WEQ2CD    P      Shipping Method
     C                     MOVELWL0059    WEVPCD    P      Ship From Wareh
     C                     MOVELWL0060    WEDBCD    P      Ship To State C
     C                     Z-ADDWL0061    WEGRWE           Gross Weight
     C                     MOVELWL0062    WEXCCD    P      Carrier Broker
     C                     MOVELWL0063    WEU2ST    P      Export Status
     C                     Z-ADDWL0064    WEF9DT           Actual Ship Dat
     C                     MOVELWL0065    WEONTM    P      On Time - (Y/N)
     C                     Z-ADDWL0066    WEJ4DT           Truck Ready Dat
     C                     Z-ADDWL0067    WETRTM           Truck Ready Tim
     C                     Z-ADDWL0068    WEJ5DT           Spotted Date
     C                     Z-ADDWL0069    WESPTM           Spotted Time
     C                     Z-ADDWL0070    WEJ6DT           Load Finished D
     C                     Z-ADDWL0071    WELFTM           Load Finished T
     C                     Z-ADDWL0072    WEJ7DT           BOL Complete Da
     C                     Z-ADDWL0073    WEBOTM           BOL Complete Ti
     C                     Z-ADDWL0074    WEJ8DT           BOL Received Da
     C                     Z-ADDWL0075    WEBLTM           BOL Received Ti
     C                     Z-ADDWL0076    WEKIDT           Truck Departure
     C                     Z-ADDWL0077    WEASTM           Truck Departure
     C                     Z-ADDWL0078    WEKADT           Adjusted Depart
     C                     Z-ADDWL0079    WEAJCM           Adjusted Depart
     C                     MOVELWL0080    WEXACD    P      Shipping Line
     C                     MOVELWL0081    WEOANA    P      Port Delv Termi
     C                     MOVELWL0082    WEK4TX    P      Vessel Name
     C                     Z-ADDWL0083    WEVOAG           Voyage
     C                     Z-ADDWL0084    WEKBDT           Sail Date
     C                     MOVELWL0085    WENBBO    P      Booking Number
     C                     MOVELWL0086    WEW4CD    P      Discharge Port
     C                     Z-ADDWL0087    WEEFDT           Arrival Date
     C                     MOVELWL0088    WECNTN    P      Container Numbe
     C                     Z-ADDWL0089    WEKCDT           Date In
     C                     Z-ADDWL0090    WETMIN           Time In
     C                     Z-ADDWL0091    WEKDDT           Date Out
     C                     Z-ADDWL0092    WEVMNB           Time Out
     C                     Z-ADDWL0093    WEOCFR           Load Total Frei
     C                     Z-ADDWL0094    WEKJDT           Scheduled Deliv
     C                     Z-ADDWL0095    WEATTM           Scheduled Deliv
     C                     MOVELWL0096    WEOTRS    P      LH Unused Sts
     C                     MOVELWL0097    WERNST    P      LH Carrier Paym
     C                     Z-ADDWL0098    WEBRBK           Bring Back Mile
     C                     Z-ADDWL0099    WEEIDT           Requested Deliv
     C                     MOVELWL0100    WERMST    P      Load Acceptance
     C                     MOVELWL0101    WEAJCD    P      Warehouse Code
     C                     Z-ADDWL0102    WEKKDT           On Yard Date
     C                     Z-ADDWL0103    WEAVTM           On Yard Time
     C                     Z-ADDWL0104    WEKZDT           Deadline Depart
     C                     Z-ADDWL0105    WEAXTM           Deadline Depart
     C                     MOVELWL0106    WELHOS    P      Load Held Over
     C                     MOVELWL0107    WELHOR    P      Load Held Over
     C                     MOVELWL0108    WEOITX    P      Ocean BOL Numbe
     C                     MOVELWL0109    WEOJTX    P      Express Mail Nu
     C                     Z-ADDWL0110    WELLDT           Express Mail Da
     C                     MOVELWL0111    WELSHG    P      Load Shag Flag
     C                     MOVELWL0112    WEYPST    P      Load Wash Flag
     C                     Z-ADDWL0113    WEK0DT           Product Complet
     C                     Z-ADDWL0114    WEAYTM           Product Complet
     C                     Z-ADDWL0115    WEK1DT           Load Confirmati
     C                     Z-ADDWL0116    WEAZTM           Load Door 1
     C                     Z-ADDWL0117    WEK2DT           Override Total
     C                     Z-ADDWL0118    WEA0TM           Load Door 2
     C                     MOVELWL0119    WEROST    P      Partial Load
     C                     MOVELWL0120    WERPST    P      Load Confirmati
     C                     MOVELWL0121    WERQST    P      Export Load USD
     C                     MOVELWL0122    WERRST    P      Late Delivery E
     C                     Z-ADDWL0123    WEZBVA           Load Actual Fre
     C                     MOVELWL0124    WER3SX    P      LH On-Time Reas
     C                     MOVELWL0125    WEUVST    P      EDI Status 1
     C                     MOVELWL0126    WEUWST    P      EDI Status 2
     C                     MOVELWL0127    WEUXST    P      EDI Status 3
     C                     Z-ADDWL0128    WEAATM           Job Time
     C                     MOVELWL0129    WEAYNA    P      User Id
     C                     MOVELWL0130    WEA0NA    P      Job Name
     C                     Z-ADDWL0131    WEAXDT           Job Date
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##JOB     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
      * Check fields for Load Order Header Change Log
      * CASE: *OTHERWISE
      * Carrier Code
      * CASE: PAR.Carrier Code NE LCL.Carrier Code
     C           WL0036    IFNE YL0001                     *IF
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPARC
     C                     Z-ADDWERMNB    PARMNB           Load ID
     C                     Z-ADD0         PARVNB           Stop/Drop
     C                     MOVEL'CARCHG'  PARVST    P      Load Change Typ
     C                     MOVEL'TRF'     PAUJST    P      Department Cont
     C                     MOVELYL0001    PAMNTX    P      Change Log Prio
     C                     MOVELWL0036    PAMOTX    P      Change Log New
     C                     MOVEL##USR     PAAYNA    P      User Id
     C                     MOVEL##PGM     PAA0NA    P      Job Name
     C                     MOVELWEBZNA    PABZNA    P      Carrier Code
     C                     Z-ADDWEAIC3    PAAIC3           Company Number
     C                     Z-ADD0         PAC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Scheduled Delivery Date
      * CASE: PAR.Scheduled Delivery Date NE LCL.Scheduled Delivery Date
     C           WL0094    IFNE YL0002                     *IF
      * Convert dates to character
     C                     MOVEL*BLANK    YL0003           Date From Alpha
     C                     MOVELYL0002    YL0003           Date From Alpha
     C                     MOVEL*BLANK    YL0004           Date To Alpha
     C                     MOVELWL0094    YL0004           Date To Alpha
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPARC
     C                     Z-ADDWERMNB    PARMNB           Load ID
     C                     Z-ADD0         PARVNB           Stop/Drop
     C                     MOVEL'SCHDLV'  PARVST    P      Load Change Typ
     C                     MOVEL'TRF'     PAUJST    P      Department Cont
     C                     MOVELYL0003    PAMNTX    P      Change Log Prio
     C                     MOVELYL0004    PAMOTX    P      Change Log New
     C                     MOVELWEAYNA    PAAYNA    P      User Id
     C                     MOVELWEA0NA    PAA0NA    P      Job Name
     C                     MOVELWEBZNA    PABZNA    P      Carrier Code
     C                     Z-ADDWEAIC3    PAAIC3           Company Number
     C                     Z-ADD0         PAC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv/Chg Ld on yd dt/tm RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFDXTX    WQSH01           Trailer Id
     C           *LIKE     DEFN WFBZNA    WQSH02           Carrier Code
     C           *LIKE     DEFN WFRMNB    WQSH03           Load ID
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Trailer Id
     C                     KFLD           WQSH02           Carrier Code
     C                     KFLD           WQSH03           Load ID
      * Setup key
     C                     MOVEL#DS2TX    WQSH01           Trailer Id
     C                     MOVEL#DR6CD    WQSH02           Carrier Code
     C                     Z-ADDP2RMNB    WQSH03           Load ID
      * Establish starting position
     C           KRSSH     SETLL@FJCPMJ                    *
     C           KRSSH     READE@FJCPMJ                  90*
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * If truck not yet departed, update On Yard DT,Tm on Load Header
      * CASE: DB1.Truck Departure Date is not entered
     C           WFKIDT    IFEQ 0                          *IF
      * Chg On Yard Dt,Tm      CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWFRMNB    WL0020           Load ID
     C                     Z-ADDWFAIC3    WL0021           Company Number
     C                     Z-ADDWFAODT    WL0022           Scheduled Ship
     C                     MOVELWFPJST    WL0023    P      LTL Flag
     C                     MOVELWFPKST    WL0024    P      Load Status
     C                     Z-ADDWFRNNB    WL0025           Reefer Temperat
     C                     MOVELWFDMTX    WL0026    P      Seal 1
     C                     MOVELWFDNTX    WL0027    P      Seal 2
     C                     MOVELWFDOTX    WL0028    P      Seal 3
     C                     Z-ADDWFRPNB    WL0029           Total Load Orde
     C                     Z-ADDWFFLAM    WL0030           Flat Amount
     C                     MOVELWFXQST    WL0031    P      Allocate Pounds
     C                     Z-ADDWFRRNB    WL0032           Total Stops
     C                     MOVELWFDXTX    WL0033    P      Trailer Id
     C                     MOVELWFDYTX    WL0034    P      Transloader Car
     C                     Z-ADDWFSBNB    WL0035           BOL Time
     C                     MOVELWFBZNA    WL0036    P      Carrier Code
     C                     MOVELWFRONB    WL0037    P      Truck Size
     C                     Z-ADDWFSQNB    WL0038           Ld Hdr/Ld Dtl U
     C                     Z-ADDWFR1NB    WL0039           Rated Freight
     C                     MOVELWFVCST    WL0040    P      Ship Status
     C                     MOVELWFVDST    WL0041    P      Load Type
     C                     Z-ADDWFSDNB    WL0042           Number Pallets
     C                     Z-ADDWFPAOU    WL0043           Number Pallets
     C                     Z-ADDWFDGWG    WL0044           Load Carrier Pa
     C                     Z-ADDWFSXNB    WL0045           Estimated Arriv
     C                     Z-ADDWFHADT    WL0046           Actual Arrival
     C                     Z-ADDWFAART    WL0047           Actual Arrival
     C                     Z-ADDWFDHWG    WL0048           Trailer IN Weig
     C                     Z-ADDWFDIWG    WL0049           Trailer OUT Wei
     C                     Z-ADDWFAQDT    WL0050           Actual Departur
     C                     Z-ADDWFS6NB    WL0051           Departure Time
     C                     Z-ADDWFT4NB    WL0052           Schedule Sequen
     C                     Z-ADDWFPRTM    WL0053           Product Tempera
     C                     Z-ADDWFNPSV    WL0054           Number Pallets
     C                     MOVELWFJ8TX    WL0055    P      Car/Veh. Initia
     C                     Z-ADDWFTLMI    WL0056           Total Load Mile
     C                     MOVELWFJ9TX    WL0057    P      Recorder ID
     C                     MOVELWFQ2CD    WL0058    P      Shipping Method
     C                     MOVELWFVPCD    WL0059    P      Ship From Wareh
     C                     MOVELWFDBCD    WL0060    P      Ship To State C
     C                     Z-ADDWFGRWE    WL0061           Gross Weight
     C                     MOVELWFXCCD    WL0062    P      Carrier Broker
     C                     MOVELWFU2ST    WL0063    P      Export Status
     C                     Z-ADDWFF9DT    WL0064           Actual Ship Dat
     C                     MOVELWFONTM    WL0065    P      On Time - (Y/N)
     C                     Z-ADDWFJ4DT    WL0066           Truck Ready Dat
     C                     Z-ADDWFTRTM    WL0067           Truck Ready Tim
     C                     Z-ADDWFJ5DT    WL0068           Spotted Date
     C                     Z-ADDWFSPTM    WL0069           Spotted Time
     C                     Z-ADDWFJ6DT    WL0070           Load Finished D
     C                     Z-ADDWFLFTM    WL0071           Load Finished T
     C                     Z-ADDWFJ7DT    WL0072           BOL Complete Da
     C                     Z-ADDWFBOTM    WL0073           BOL Complete Ti
     C                     Z-ADDWFJ8DT    WL0074           BOL Received Da
     C                     Z-ADDWFBLTM    WL0075           BOL Received Ti
     C                     Z-ADDWFKIDT    WL0076           Truck Departure
     C                     Z-ADDWFASTM    WL0077           Truck Departure
     C                     Z-ADDWFKADT    WL0078           Adjusted Depart
     C                     Z-ADDWFAJCM    WL0079           Adjusted Depart
     C                     MOVELWFXACD    WL0080    P      Shipping Line
     C                     MOVELWFOANA    WL0081    P      Port Delv Termi
     C                     MOVELWFK4TX    WL0082    P      Vessel Name
     C                     Z-ADDWFVOAG    WL0083           Voyage
     C                     Z-ADDWFKBDT    WL0084           Sail Date
     C                     MOVELWFNBBO    WL0085    P      Booking Number
     C                     MOVELWFW4CD    WL0086    P      Discharge Port
     C                     Z-ADDWFEFDT    WL0087           Arrival Date
     C                     MOVELWFCNTN    WL0088    P      Container Numbe
     C                     Z-ADDWFKCDT    WL0089           Date In
     C                     Z-ADDWFTMIN    WL0090           Time In
     C                     Z-ADDWFKDDT    WL0091           Date Out
     C                     Z-ADDWFVMNB    WL0092           Time Out
     C                     Z-ADDWFOCFR    WL0093           Load Total Frei
     C                     Z-ADDWFKJDT    WL0094           Scheduled Deliv
     C                     Z-ADDWFATTM    WL0095           Scheduled Deliv
     C                     MOVELWFOTRS    WL0096    P      LH Unused Sts
     C                     MOVELWFRNST    WL0097    P      LH Carrier Paym
     C                     Z-ADDWFBRBK    WL0098           Bring Back Mile
     C                     Z-ADDWFEIDT    WL0099           Requested Deliv
     C                     MOVELWFRMST    WL0100    P      Load Acceptance
     C                     MOVELWFAJCD    WL0101    P      Warehouse Code
     C                     Z-ADD#1KKDT    WL0102           On Yard Date
     C                     Z-ADD#1AVTM    WL0103           On Yard Time
     C                     Z-ADDWFKZDT    WL0104           Deadline Depart
     C                     Z-ADDWFAXTM    WL0105           Deadline Depart
     C                     MOVELWFLHOS    WL0106    P      Load Held Over
     C                     MOVELWFLHOR    WL0107    P      Load Held Over
     C                     MOVELWFOITX    WL0108    P      Ocean BOL Numbe
     C                     MOVELWFOJTX    WL0109    P      Express Mail Nu
     C                     Z-ADDWFLLDT    WL0110           Express Mail Da
     C                     MOVELWFLSHG    WL0111    P      Load Shag Flag
     C                     MOVELWFYPST    WL0112    P      Load Wash Flag
     C                     Z-ADDWFK0DT    WL0113           Product Complet
     C                     Z-ADDWFAYTM    WL0114           Product Complet
     C                     Z-ADDWFK1DT    WL0115           Load Confirmati
     C                     Z-ADDWFAZTM    WL0116           Load Door 1
     C                     Z-ADDWFK2DT    WL0117           Override Total
     C                     Z-ADDWFA0TM    WL0118           Load Door 2
     C                     MOVELWFROST    WL0119    P      Partial Load
     C                     MOVELWFRPST    WL0120    P      Load Confirmati
     C                     MOVELWFRQST    WL0121    P      Export Load USD
     C                     MOVELWFRRST    WL0122    P      Late Delivery E
     C                     Z-ADDWFZBVA    WL0123           Load Actual Fre
     C                     MOVELWFR3SX    WL0124    P      LH On-Time Reas
     C                     MOVELWFUVST    WL0125    P      EDI Status 1
     C                     MOVELWFUWST    WL0126    P      EDI Status 2
     C                     MOVELWFUXST    WL0127    P      EDI Status 3
     C                     Z-ADDWFAATM    WL0128           Job Time
     C                     MOVELWFAYNA    WL0129    P      User Id
     C                     MOVELWFA0NA    WL0130    P      Job Name
     C                     Z-ADDWFAXDT    WL0131           Job Date
     C                     EXSR SGCHRC
     C                     END                             *FI
     C           KRSSH     READE@FJCPMJ                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * VAL Carr/Trlr Exists   RT - Trailer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           LYBZNA           Carrier Code
     C                     KFLD           LYDXTX           Trailer Id
      * Setup key
     C                     MOVELWL0132    LYBZNA           Carrier Code
     C                     MOVELWL0133    LYDXTX           Trailer Id
      * Establish starting position
     C           KRSSI     CHAIN@LYRER3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2598' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Val Carrier Active     RT - Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WGBZNA           Carrier Code
      * Setup key
     C                     MOVEL#DR6CD    WGBZNA           Carrier Code
      * Establish starting position
     C           KRSSJ     CHAIN@FFREUG              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Plant Co Status   RT - Company Defaults Internal  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WHAIC3           Company Number
      * Setup key
     C                     Z-ADD#1AIC3    WHAIC3           Company Number
      * Establish starting position
     C           KRSSK     CHAIN@JYRECE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2025' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0005           Plant Company S
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHYISX    YL0005           Plant Company S
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Load for DrpTrlrEx RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WUZJST           USR Active Load
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIBZNA    WQSL01           Carrier Code
     C           *LIKE     DEFN WICNTN    WQSL02           Container Numbe
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Carrier Code
     C                     KFLD           WQSL02           Container Numbe
      * Setup key
     C                     MOVEL#DR6CD    WQSL01           Carrier Code
     C                     MOVEL#DS2TX    WQSL02           Container Numbe
      * Establish starting position
     C           KRSSL     SETLL@FJCPR6                    *
     C           KRSSL     READE@FJCPR6                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     P2RMNB           Load ID
     C                     MOVEL*BLANK    P2PKST           Load Status
     C                     MOVEL*BLANK    P3WNST           Load Type
     C                     Z-ADD*ZERO     P2J7DT           BOL Complete Da
     C                     Z-ADD*ZERO     P2BOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     P2KIDT           Truck Departure
     C                     Z-ADD*ZERO     P2ASTM           Truck Departure
     C                     Z-ADD*ZERO     P2KKDT           On Yard Date
     C                     Z-ADD*ZERO     P2AVTM           On Yard Time
     C                     Z-ADD*ZERO     P2KZDT           Deadline Depart
     C                     Z-ADD*ZERO     P2AXTM           Deadline Depart
     C                     MOVEL*BLANK    WUZJST           USR Active Load
     C                     MOVEL'N'       WUZJST           USR Active Load
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Truck Departure Date is not entered
     C           WIKIDT    IFEQ 0                          *IF
      * Active load
      * PAR = DB1 By name
     C                     Z-ADDWIRMNB    P2RMNB           Load ID
     C                     MOVELWIPKST    P2PKST           Load Status
     C                     MOVELWIVDST    P3WNST           Load Type
     C                     Z-ADDWIJ7DT    P2J7DT           BOL Complete Da
     C                     Z-ADDWIBOTM    P2BOTM           BOL Complete Ti
     C                     Z-ADDWIKIDT    P2KIDT           Truck Departure
     C                     Z-ADDWIASTM    P2ASTM           Truck Departure
     C                     Z-ADDWIKKDT    P2KKDT           On Yard Date
     C                     Z-ADDWIAVTM    P2AVTM           On Yard Time
     C                     Z-ADDWIKZDT    P2KZDT           Deadline Depart
     C                     Z-ADDWIAXTM    P2AXTM           Deadline Depart
     C                     MOVEL'Y'       WUZJST           USR Active Load
     C                     GOTO SLEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSL     READE@FJCPR6                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Load for DrpTrlrRp RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WUZJST           USR Active Load
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDBZNA    WQSM01           Carrier Code
     C           *LIKE     DEFN WDDXTX    WQSM02           Trailer Id
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Carrier Code
     C                     KFLD           WQSM02           Trailer Id
      * Setup key
     C                     MOVEL#DR6CD    WQSM01           Carrier Code
     C                     MOVEL#DS2TX    WQSM02           Trailer Id
      * Establish starting position
     C           KRSSM     SETLL@FJCPR4                    *
     C           KRSSM     READE@FJCPR4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     P2RMNB           Load ID
     C                     MOVEL*BLANK    P2PKST           Load Status
     C                     MOVEL*BLANK    P3WNST           Load Type
     C                     Z-ADD*ZERO     P2J7DT           BOL Complete Da
     C                     Z-ADD*ZERO     P2BOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     P2KIDT           Truck Departure
     C                     Z-ADD*ZERO     P2ASTM           Truck Departure
     C                     Z-ADD*ZERO     P2KZDT           Deadline Depart
     C                     Z-ADD*ZERO     P2AXTM           Deadline Depart
     C                     MOVEL*BLANK    WUZJST           USR Active Load
     C                     MOVEL'N'       WUZJST           USR Active Load
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Truck Departure Date is not entered
     C           WDKIDT    IFEQ 0                          *IF
      * Active load
      * PAR = DB1 By name
     C                     Z-ADDWDRMNB    P2RMNB           Load ID
     C                     MOVELWDPKST    P2PKST           Load Status
     C                     MOVELWDVDST    P3WNST           Load Type
     C                     Z-ADDWDJ7DT    P2J7DT           BOL Complete Da
     C                     Z-ADDWDBOTM    P2BOTM           BOL Complete Ti
     C                     Z-ADDWDKIDT    P2KIDT           Truck Departure
     C                     Z-ADDWDASTM    P2ASTM           Truck Departure
     C                     Z-ADDWDKZDT    P2KZDT           Deadline Depart
     C                     Z-ADDWDAXTM    P2AXTM           Deadline Depart
     C                     MOVEL'Y'       WUZJST           USR Active Load
     C                     GOTO SMEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * NOT Active load
     C                     END                             *FI
     C           KRSSM     READE@FJCPR4                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WJAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0052    WJAJVN           User Profile Na
      * Establish starting position
     C           KRSSN     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWJI6ST    P9I6ST           Allow Multi-Com
     C                     MOVELWJMPNA    WUMPNA           Default Printer
     C                     MOVELWJBCCD    WUBCCD           Salesperson Cod
     C                     Z-ADDWJAIC3    YL0008           Company Number
     C                     MOVELWJBUVN    WN0053           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WKAJVN           User Profile Na
     C                     KFLD           WKDNCD           Application Cod
      * Setup key
     C                     MOVELWL0134    WKAJVN           User Profile Na
     C                     MOVELWL0135    WKDNCD           Application Cod
      * Establish starting position
     C           KRSSO     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWKAIC3    WL0136           Company Number
     C                     MOVELWKAJCD    WL0137           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLDNCD    WQSP01           Application Cod
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSP01           Application Cod
     C                     MOVEL'OMS'     WQSP01           Application Cod
      * Establish starting position
     C           KRSSP     SETLL@DNRESF                    *
     C           KRSSP     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           WLRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELWLAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SQRVGN
     C                     END                             *FI
     C           KRSSP     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLDNCD    WQSQ01           Application Cod
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           Application Cod
      * Setup key
     C                     MOVELWLRSCD    WQSQ01           Application Cod
      * Establish starting position
     C           KRSSQ     SETLL@DNRESF                    *
     C           KRSSQ     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWLAUNA    WUAUNA           Description
     C           KRSSQ     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * validate company number
      *================================================================
      * Rtv Plant Co Status   RT - Company Defaults Internal  * 
     C                     EXSR SKRVGN
      * 05/10/07 JRB Removed hard coded companies.
      * CASE: LCL.Plant Company Sts is Plant Company
     C           YL0005    IFEQ 'P'                        *IF
     C                     MOVEL*BLANK    #DSQTX           Company Name DR
      * Company Name DRV
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0001           Company Number
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #DSQTX    P      Name
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0005           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0005           CD3 Ext Numeric
     C                     END                             *FI
      * Send message 'Company not found'
     C                     MOVEL'USR2831' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     MOVEL*BLANK    #DSQTX           Company Name DR
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Documentation/change log
      *================================================================
      * This program was created to work like an edit record, without a
      * key screen.  It will be used by dispatchers, which is a very fast
      * paced environment, so they need fewer key strokes.
      * E004079 LJB 07/13/2015  Exports will be assigned Containers that
      *  are owned by Ship Line. Rtv sts by Carrier which will be the Shi
      *  Line and Trailer which will be the Container#
      * E002966 LJB 02/18/2014  When adding a trailer, if it is already
      *  assigned to a load, change Assigned = Y, Available = N, and
      *  allow the trailer to be added (not an error)
      * LJB 12/22/2011  Recompile only for chgobj function change
      * RMC 10/2/06 when on yard is entered, if user is multi-comp=N,
      *  chg company to user's dft company.
      * RMC 10/13/06 when on yard is changed, if user is multi-comp=N,
      *  chg company to user's dft company.
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Select existing record
      *================================================================
      * Name search required?
     C                     MOVEL#1BZNA    WK1X01  1
     C                     MOVEL#1DXTX    WK1X02  1
     C           WK1X01    IFEQ '?'                        Carrier Code
     C           YPMTFD    OREQ '#1BZNA'
     C           WK1X02    OREQ '?'                        Trailer Id
     C           YPMTFD    OREQ '#1DXTX'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1BZNA' defaulted for 'Carrier Code'.
      * Field '(DTL) #1DXTX' defaulted for 'Trailer Id'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1VDST' defaulted for 'Load Type'.
      * Field '(DTL) #1STOY' defaulted for 'On Yard Status'.
      * Field '(DTL) #1STAS' defaulted for 'Assigned Status'.
      * Field '(DTL) #1XRST' defaulted for 'Available Status'.
     C                     CALL 'PDGLSRR'              90  Sel PD Trailer
     C                     PARM *BLANK    W0RTN   7
     C           #1BZNA    PARM #1BZNA    WQ0005  3        Carrier Code
     C           #1DXTX    PARM #1DXTX    WQ0006 20        Trailer Id
     C           #1AIC3    PARM #1AIC3    WQ0007  30       Company Number
     C                     PARM #1VDST    WQ0008  1        Load Type
     C                     PARM #1STOY    WQ0009  1        On Yard Status
     C                     PARM #1STAS    WQ0010  1        Assigned Status
     C                     PARM #1XRST    WQ0011  1        Available Statu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGLSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     993334*
     C                     SETON                     3940  *
     C                     END
      *
     C           #1BZNA    IFNE *BLANK                     Carrier Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1DXTX    IFNE *BLANK                     Trailer Id
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           ZHCSRW    IFEQ 008
     C           ZHCSCL    ANDEQ032
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1VDST'  YPMTFD           Load Type
     C                     END
      *
     C           ZHCSRW    IFEQ 009
     C           ZHCSCL    ANDEQ032
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1X3ST'  YPMTFD           Trailer Type
     C                     END
      *
     C           ZHCSRW    IFEQ 011
     C           ZHCSCL    ANDEQ032
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1XGST'  YPMTFD           Seaboard Owned
     C                     END
      *
     C           ZHCSRW    IFEQ 016
     C           ZHCSCL    ANDEQ032
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1STAS'  YPMTFD           Assigned Status
     C                     END
      *
     C           ZHCSRW    IFEQ 018
     C           ZHCSCL    ANDEQ032
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1XRST'  YPMTFD           Available Statu
     C                     END
      *
     C           ZHCSRW    IFEQ 021
     C           ZHCSCL    ANDEQ032
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1VSST'  YPMTFD           Record Status
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P2RMNB           Load ID
     C                     Z-ADD*ZERO     P2AIC3           Company Number
     C                     MOVEL*BLANK    P2PKST           Load Status
     C                     Z-ADD*ZERO     P2J7DT           BOL Complete Da
     C                     Z-ADD*ZERO     P2BOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     P2KIDT           Truck Departure
     C                     Z-ADD*ZERO     P2ASTM           Truck Departure
     C                     Z-ADD*ZERO     P2KKDT           On Yard Date
     C                     Z-ADD*ZERO     P2AVTM           On Yard Time
     C                     Z-ADD*ZERO     P2KZDT           Deadline Depart
     C                     Z-ADD*ZERO     P2AXTM           Deadline Depart
     C                     MOVEL*BLANK    P3WNST           USR Load Type
     C                     Z-ADD*ZERO     P4LKDT           USR On Yard Dat
     C                     Z-ADD*ZERO     P5WENB           USR Time
     C                     MOVEL*BLANK    P6R6CD           USR Carrier Cod
     C                     MOVEL*BLANK    P7MUTX           Trailer Id
     C                     MOVEL*BLANK    P8S2TX           Trailer ID USR
     C                     MOVEL*BLANK    P9I6ST           Allow Multi-Com
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Current System Date
     C                     Z-ADD*ZERO     WUSDTE 155
      * Define work field Current System Time
     C                     Z-ADD*ZERO     WUZHNB 155
      * Define work field Record Status
     C                     MOVEL*BLANK    WUVSST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBEZNB           Telephone Numbe
     C                     Z-ADD*ZERO     WBEEDT           Carrier Last Us
     C                     Z-ADD*ZERO     WBNRVA           Pallet Balance
     C                     Z-ADD*ZERO     WBNSVA           Long hook balan
     C                     Z-ADD*ZERO     WBNTVA           Short hook bala
     C                     Z-ADD*ZERO     WBNUVA           Tub Balance
     C                     Z-ADD*ZERO     WBS8NB           Home Phone
     C                     Z-ADD*ZERO     WBS9NB           Other Phone
     C                     Z-ADD*ZERO     WBNMVA           Flat Rate
     C                     Z-ADD*ZERO     WBNOVA           Rate Per Pound
     C                     Z-ADD*ZERO     WBNPVA           Unused Rate Per
     C                     Z-ADD*ZERO     WBNQVA           Miscellaneous C
     C                     Z-ADD*ZERO     WBQXNB           Unused Mile Ran
     C                     Z-ADD*ZERO     WBQ1NB           Unused Mile Ran
     C                     Z-ADD*ZERO     WBMRNG           Unused Mile Ran
     C                     Z-ADD*ZERO     WBMRNE           Unused Mile Ran
     C                     Z-ADD*ZERO     WBRFNB           Unused Mile Ran
     C                     Z-ADD*ZERO     WBMREG           Unused Mile Ran
     C                     Z-ADD*ZERO     WBBQPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WBBRPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WBBSPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WBBTPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WBBUPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WBBVPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WBDJWG           Unused Weight R
     C                     Z-ADD*ZERO     WBDKWG           Unused Weight R
     C                     Z-ADD*ZERO     WBDLWG           Unused Weight R
     C                     Z-ADD*ZERO     WBDMWG           Unused Weight R
     C                     Z-ADD*ZERO     WBDNWG           Unused Weight R
     C                     Z-ADD*ZERO     WBDOWG           Unused Weight R
     C                     Z-ADD*ZERO     WBB2PR           Unused Weight R
     C                     Z-ADD*ZERO     WBB3PR           Unused Weight R
     C                     Z-ADD*ZERO     WBB4PR           Unused Weight R
     C                     Z-ADD*ZERO     WBB5PR           Unused Weight R
     C                     Z-ADD*ZERO     WBB6PR           Unused Weight R
     C                     Z-ADD*ZERO     WBB7PR           Unused Weight R
     C                     Z-ADD*ZERO     WBAAC7           Contact Number
     C                     Z-ADD*ZERO     WBTENO           Carrier Unused
     C                     Z-ADD*ZERO     WBAOFC           Amount of Cargo
     C                     Z-ADD*ZERO     WBAOLI           Amount of Liabi
     C                     Z-ADD*ZERO     WBKHDT           Date of Expirat
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field Status Flag 10 Y/N
     C                     MOVEL*BLANK    WUDGTX  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCKKDT           On Yard Date
     C                     Z-ADD*ZERO     WCAVTM           On Yard Time
     C                     Z-ADD*ZERO     WCLCDT           Date Unused 1
     C                     Z-ADD*ZERO     WCLDDT           Date Unused 2
     C                     Z-ADD*ZERO     WCLEDT           Date Unused 3
     C                     Z-ADD*ZERO     WCLFDT           Date Unused 4
     C                     Z-ADD*ZERO     WCLGDT           Date Unused 5
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WDRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WDFLAM           Flat Amount
     C                     Z-ADD*ZERO     WDRRNB           Total Stops
     C                     Z-ADD*ZERO     WDSBNB           BOL Time
     C                     Z-ADD*ZERO     WDSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDSDNB           Number Pallets
     C                     Z-ADD*ZERO     WDPAOU           Number Pallets
     C                     Z-ADD*ZERO     WDDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WDSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WDHADT           Actual Arrival
     C                     Z-ADD*ZERO     WDAART           Actual Arrival
     C                     Z-ADD*ZERO     WDDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WDDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WDAQDT           Actual Departur
     C                     Z-ADD*ZERO     WDS6NB           Departure Time
     C                     Z-ADD*ZERO     WDT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WDPRTM           Product Tempera
     C                     Z-ADD*ZERO     WDNPSV           Number Pallets
     C                     Z-ADD*ZERO     WDTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WDGRWE           Gross Weight
     C                     Z-ADD*ZERO     WDF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WDJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WDTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WDJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WDSPTM           Spotted Time
     C                     Z-ADD*ZERO     WDJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WDLFTM           Load Finished T
     C                     Z-ADD*ZERO     WDJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WDBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WDJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WDBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WDKIDT           Truck Departure
     C                     Z-ADD*ZERO     WDASTM           Truck Departure
     C                     Z-ADD*ZERO     WDKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WDAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WDVOAG           Voyage
     C                     Z-ADD*ZERO     WDKBDT           Sail Date
     C                     Z-ADD*ZERO     WDEFDT           Arrival Date
     C                     Z-ADD*ZERO     WDKCDT           Date In
     C                     Z-ADD*ZERO     WDTMIN           Time In
     C                     Z-ADD*ZERO     WDKDDT           Date Out
     C                     Z-ADD*ZERO     WDVMNB           Time Out
     C                     Z-ADD*ZERO     WDOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WDKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WDATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WDBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WDEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WDKKDT           On Yard Date
     C                     Z-ADD*ZERO     WDAVTM           On Yard Time
     C                     Z-ADD*ZERO     WDKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WDAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WDLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WDK0DT           Product Complet
     C                     Z-ADD*ZERO     WDAYTM           Product Complet
     C                     Z-ADD*ZERO     WDKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WDICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WDIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WDK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WDAZTM           Load Door 1
     C                     Z-ADD*ZERO     WDK2DT           Override Total
     C                     Z-ADD*ZERO     WDA0TM           Load Door 2
     C                     Z-ADD*ZERO     WDZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WDPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WDCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WDPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WDCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WDP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WDCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WDP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WDCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WDP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WDCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WDP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WDCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field Blank for 12          USR
     C                     MOVEL*BLANK    WUS3TX 12
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHXXTM           Departure Time
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Define work field USR Active Load
     C                     MOVEL*BLANK    WUZJST  1
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field Warehouse Code
     C                     MOVEL*BLANK    WUAJCD  3
      * Define work field Salesperson Code
     C                     MOVEL*BLANK    WUBCCD  3
      * Define work field Default Printer
     C                     MOVEL*BLANK    WUMPNA 10
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJNLNB           Entity Number
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SARVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     MOVEL*BLANK    WL0002 30
      * Define local variables for subroutine SBRVGN.
     C                     MOVEL*BLANK    WL0003  3
     C                     MOVEL*BLANK    WL0004 20
     C                     Z-ADD*ZERO     WL0005  30
     C                     MOVEL*BLANK    WL0006  1
     C                     MOVEL*BLANK    WL0007  1
     C                     MOVEL*BLANK    WL0008  1
     C                     MOVEL*BLANK    WL0009  1
     C                     Z-ADD*ZERO     WL0010  70
     C                     Z-ADD*ZERO     WL0011  60
     C                     MOVEL*BLANK    WL0012  1
     C                     MOVEL*BLANK    WL0013  1
     C                     MOVEL*BLANK    WL0014  3
     C                     MOVEL*BLANK    WL0015 30
     C                     MOVEL*BLANK    WL0016  1
      * Define local variables for subroutine SCRVGN.
     C                     MOVEL*BLANK    WL0017  3
     C                     MOVEL*BLANK    WL0018 30
     C                     MOVEL*BLANK    WL0019  1
      * Define local variables for subroutine SGCHRC.
     C                     Z-ADD*ZERO     WL0020  70
     C                     Z-ADD*ZERO     WL0021  30
     C                     Z-ADD*ZERO     WL0022  70
     C                     MOVEL*BLANK    WL0023  1
     C                     MOVEL*BLANK    WL0024  1
     C                     Z-ADD*ZERO     WL0025  52
     C                     MOVEL*BLANK    WL0026 15
     C                     MOVEL*BLANK    WL0027 15
     C                     MOVEL*BLANK    WL0028 15
     C                     Z-ADD*ZERO     WL0029  70
     C                     Z-ADD*ZERO     WL0030 112
     C                     MOVEL*BLANK    WL0031  1
     C                     Z-ADD*ZERO     WL0032  50
     C                     MOVEL*BLANK    WL0033 20
     C                     MOVEL*BLANK    WL0034  3
     C                     Z-ADD*ZERO     WL0035  40
     C                     MOVEL*BLANK    WL0036  3
     C                     MOVEL*BLANK    WL0037  7
     C                     Z-ADD*ZERO     WL0038  70
     C                     Z-ADD*ZERO     WL0039 112
     C                     MOVEL*BLANK    WL0040  1
     C                     MOVEL*BLANK    WL0041  1
     C                     Z-ADD*ZERO     WL0042  50
     C                     Z-ADD*ZERO     WL0043  50
     C                     Z-ADD*ZERO     WL0044 112
     C                     Z-ADD*ZERO     WL0045  60
     C                     Z-ADD*ZERO     WL0046  70
     C                     Z-ADD*ZERO     WL0047  40
     C                     Z-ADD*ZERO     WL0048 112
     C                     Z-ADD*ZERO     WL0049 112
     C                     Z-ADD*ZERO     WL0050  70
     C                     Z-ADD*ZERO     WL0051  40
     C                     Z-ADD*ZERO     WL0052  50
     C                     Z-ADD*ZERO     WL0053  52
     C                     Z-ADD*ZERO     WL0054  50
     C                     MOVEL*BLANK    WL0055 12
     C                     Z-ADD*ZERO     WL0056  70
     C                     MOVEL*BLANK    WL0057 12
     C                     MOVEL*BLANK    WL0058  2
     C                     MOVEL*BLANK    WL0059  3
     C                     MOVEL*BLANK    WL0060  2
     C                     Z-ADD*ZERO     WL0061  70
     C                     MOVEL*BLANK    WL0062  3
     C                     MOVEL*BLANK    WL0063  1
     C                     Z-ADD*ZERO     WL0064  70
     C                     MOVEL*BLANK    WL0065  1
     C                     Z-ADD*ZERO     WL0066  70
     C                     Z-ADD*ZERO     WL0067  60
     C                     Z-ADD*ZERO     WL0068  70
     C                     Z-ADD*ZERO     WL0069  60
     C                     Z-ADD*ZERO     WL0070  70
     C                     Z-ADD*ZERO     WL0071  60
     C                     Z-ADD*ZERO     WL0072  70
     C                     Z-ADD*ZERO     WL0073  60
     C                     Z-ADD*ZERO     WL0074  70
     C                     Z-ADD*ZERO     WL0075  60
     C                     Z-ADD*ZERO     WL0076  70
     C                     Z-ADD*ZERO     WL0077  60
     C                     Z-ADD*ZERO     WL0078  70
     C                     Z-ADD*ZERO     WL0079  60
     C                     MOVEL*BLANK    WL0080  3
     C                     MOVEL*BLANK    WL0081 20
     C                     MOVEL*BLANK    WL0082 30
     C                     Z-ADD*ZERO     WL0083  50
     C                     Z-ADD*ZERO     WL0084  70
     C                     MOVEL*BLANK    WL0085 12
     C                     MOVEL*BLANK    WL0086 20
     C                     Z-ADD*ZERO     WL0087  70
     C                     MOVEL*BLANK    WL0088 12
     C                     Z-ADD*ZERO     WL0089  70
     C                     Z-ADD*ZERO     WL0090  60
     C                     Z-ADD*ZERO     WL0091  70
     C                     Z-ADD*ZERO     WL0092  60
     C                     Z-ADD*ZERO     WL0093 112
     C                     Z-ADD*ZERO     WL0094  70
     C                     Z-ADD*ZERO     WL0095  60
     C                     MOVEL*BLANK    WL0096  1
     C                     MOVEL*BLANK    WL0097  1
     C                     Z-ADD*ZERO     WL0098  70
     C                     Z-ADD*ZERO     WL0099  70
     C                     MOVEL*BLANK    WL0100  1
     C                     MOVEL*BLANK    WL0101  3
     C                     Z-ADD*ZERO     WL0102  70
     C                     Z-ADD*ZERO     WL0103  60
     C                     Z-ADD*ZERO     WL0104  70
     C                     Z-ADD*ZERO     WL0105  60
     C                     MOVEL*BLANK    WL0106  1
     C                     MOVEL*BLANK    WL0107  1
     C                     MOVEL*BLANK    WL0108 25
     C                     MOVEL*BLANK    WL0109 20
     C                     Z-ADD*ZERO     WL0110  70
     C                     MOVEL*BLANK    WL0111  1
     C                     MOVEL*BLANK    WL0112  1
     C                     Z-ADD*ZERO     WL0113  70
     C                     Z-ADD*ZERO     WL0114  60
     C                     Z-ADD*ZERO     WL0115  70
     C                     Z-ADD*ZERO     WL0116  60
     C                     Z-ADD*ZERO     WL0117  70
     C                     Z-ADD*ZERO     WL0118  60
     C                     MOVEL*BLANK    WL0119  1
     C                     MOVEL*BLANK    WL0120  1
     C                     MOVEL*BLANK    WL0121  1
     C                     MOVEL*BLANK    WL0122  1
     C                     Z-ADD*ZERO     WL0123 112
     C                     MOVEL*BLANK    WL0124  3
     C                     MOVEL*BLANK    WL0125  1
     C                     MOVEL*BLANK    WL0126  1
     C                     MOVEL*BLANK    WL0127  1
     C                     Z-ADD*ZERO     WL0128  60
     C                     MOVEL*BLANK    WL0129 10
     C                     MOVEL*BLANK    WL0130 10
     C                     Z-ADD*ZERO     WL0131  70
      * Define local variables for subroutine SIRVGN.
     C                     MOVEL*BLANK    WL0132  3
     C                     MOVEL*BLANK    WL0133 20
      * Define local variables for subroutine SORVGN.
     C                     MOVEL*BLANK    WL0134 10
     C                     MOVEL*BLANK    WL0135  6
     C                     Z-ADD*ZERO     WL0136  30
     C                     MOVEL*BLANK    WL0137  3
      * Define local work field Carrier Code
     C                     MOVEL*BLANK    YL0001  3
      * Define local work field Scheduled Delivery Date
     C                     Z-ADD*ZERO     YL0002  70
      * Define local work field Date From Alpha       USR
     C                     MOVEL*BLANK    YL0003  7
      * Define local work field Date To Alpha         USR
     C                     MOVEL*BLANK    YL0004  7
      * Define local work field Plant Company Sts
     C                     MOVEL*BLANK    YL0005  1
      * Define null work field Company Number
     C                     Z-ADD*ZERO     YN0001  30
      * Define local work field Case Sensitive Field
     C                     MOVEL*BLANK    YL0006 30
      * Define local work field Case Upper Field
     C                     MOVEL*BLANK    YL0007 30
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0008  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0009  3
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * Documentation/change log
     C                     EXSR UBSUBR                     Documentation/c
     C                     MOVELP1BZNA    P6R6CD           USR Carrier Cod
     C                     MOVELP1DXTX    P8S2TX           Trailer ID USR
      *
     C                     MOVEL*BLANK    WN0052 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0052           User Profile Na
      *
     C                     MOVEL*BLANK    WN0053 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR SNRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,002                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0052    ZA0018           User Profile Na
     C                     MOVEL'OMS'     ZA0019           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0053    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0052    WL0134    P      User Profile Na
     C                     MOVEL'OMS'     WL0135    P      Application Cod
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0136    P2AIC3           Company Number
     C                     MOVELWL0137    YL0009    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0053    WL0134    P      User Profile Na
     C                     MOVEL'OMS'     WL0135    P      Application Cod
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0136    P2AIC3           Company Number
     C                     MOVELWL0137    YL0009    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0009    WUAJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0052    ZA0020           User Profile Na
     C                     MOVEL'OMS'     ZA0021           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0008    IFNE 0                          *IF
     C                     Z-ADDYL0008    P2AIC3           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0009    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           WUAJCD    PARM *BLANK    WQ0024  3        Warehouse Code
     C                     PARM YL0008    WQ0025  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SPRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
      * Load screen
     C                     EXSR MALDSC
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** W0BEG
01056010630131201568015750208002085
02336023410284802853033600361604128
041330464004645048960540805413
** W0END
01058010920132301570016040208002091
02336023650284802864033670362004128
041440464004654049250540805437
** W0NAM
#DR6CD    #DADTX    #DS2TX    V1AIC3    #DSQTX    #1VDST    #DNONA
#1X3ST    #DHLTX    #1XGST    #DHKNA    V1KKDT    #DOYTM    #1STAS
#DNINA    #1XRST    #DNMTX    #1GXTX    #1VSST    #DHOTX
** @CN
00001 USR0752
00002 Y2U0005
