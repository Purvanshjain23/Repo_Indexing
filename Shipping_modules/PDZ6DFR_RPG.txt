     H/TITLE DSP Load Acceptance    DF Display file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Displays the records from DBF as a subfile
     H* - Loads the SFL from the DBF a page at a time
     H* - The DBF record at which the SFL display starts may be
     H*   controlled by positioning fields on the SFL header
     H* - Any key fields on the SFL header will be used as
     H*   positioning values
     H* - Any non-key fields on the SFL header will be used as
     H*   selection values: a maximum of W0SLM records will be
     H*   read from the DBF before giving up
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Display file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 08/06/19  Time  : 15:21:59
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDZ6DFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: DSP Load Acceptance    DF Display file
      *
     FPDLHCPL2IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RSQ : Load Order Change Log     Ld ID,Stop,Order,D/T/
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FOMFLCPL1IF  E           K        DISK
      * RTV : Load Detail               Retrieval index
      *
     FOMFLCPL5IF  E           K        DISK
      * RSQ : Load Detail               Co/Load/Order
      *
     FPDLHCPL3IF  E           K        DISK
      * RSQ : Load Order Change Log     Ld ID,Typ,Dte/Time/Se
      *
     FOMFFREL0IF  E           K        DISK
      * RTV : Carrier                   Retrieval index
      *
     FPDLHCPLHIF  E           K        DISK
      * RSQ : Load Order Change Log     Load/Order/Type
      *
     FOPBFCPLOIF  E           K        DISK
      * RSQ : Order Header TRG          Ord-D/Co
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FOPBFCPL8IF  E           K        DISK
      * RSQ : Order Header TRG          Load #/All orders
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FPMAMREL1IF  E           K        DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FPDLHCPL9IF  E           K        DISK
      * RSQ : Load Order Change Log     Load ID/Seg Num-1
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FOMFJCPL1UF  E           K        DISK
      * UPD : Load Header               Update index
      *
     FOMFLCPL0UF  E           K        DISK
      * UPD : Load Detail               Update index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     FPDLHCPL0IF  E           K        DISK                      A
      * UPD : Load Order Change Log     Update index
      *
     E                    #L7         7  1
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * Long constants
     E                    @CN#    1  21  6   @CN    25
     I@FLCPKF
      * Load Detail               Co/Load/Order
      * Renamed input format fields
     I              FLRMNB                          WARMNB
     I              FLRUNB                          WARUNB
     I              FLRVNB                          WARVNB
     I              FLDQTX                          WADQTX
     I              FLRWNB                          WARWNB
     I              FLRXNB                          WARXNB
     I              FLSQNB                          WASQNB
     I              FLT0NB                          WAT0NB
     I              FLT1NB                          WAT1NB
     I              FLR1NB                          WAR1NB
     I              FLAIC3                          WAAIC3
     I              FLC4NB                          WAC4NB
     I              FLVCST                          WAVCST
     I              FLKEDT                          WAKEDT
     I              FLSXNB                          WASXNB
     I              FLKFDT                          WAKFDT
     I              FLACTM                          WAACTM
     I              FLK5TX                          WAK5TX
     I              FLW5CD                          WAW5CD
     I              FLEJDT                          WAEJDT
     I              FLAGTM                          WAAGTM
     I              FLKJDT                          WAKJDT
     I              FLATTM                          WAATTM
     I              FLHDDT                          WAHDDT
     I              FLAUTM                          WAAUTM
     I              FLKKDT                          WAKKDT
     I              FLAVTM                          WAAVTM
     I              FLZ4NB                          WAZ4NB
     I              FLY7ST                          WAY7ST
     I              FLY2ST                          WAY2ST
     I              FLWHTX                          WAWHTX
     I              FLWITX                          WAWITX
     I              FLWJTX                          WAWJTX
     I              FLWKTX                          WAWKTX
     I              FLWLTX                          WAWLTX
     I              FLN7DT                          WAN7DT
     I              FLN8DT                          WAN8DT
     I              FLN9DT                          WAN9DT
     I              FLB3TM                          WAB3TM
     I              FLB4TM                          WAB4TM
     I              FLB5TM                          WAB5TM
     I              FLIASX                          WAIASX
     I              FLIBSX                          WAIBSX
     I              FLICSX                          WAICSX
     I              FLWVTX                          WAWVTX
     I              FLWWTX                          WAWWTX
     I              FLWXTX                          WAWXTX
     I              FLUVST                          WAUVST
     I              FLUWST                          WAUWST
     I              FLUXST                          WAUXST
     I              FLAATM                          WAAATM
     I              FLAYNA                          WAAYNA
     I              FLA0NA                          WAA0NA
     I              FLAXDT                          WAAXDT
      *
     I@LHCPO4
      * Load Order Change Log     Ld ID,Typ,Dte/Time/Se
      * Renamed input format fields
     I              LHK4DT                          WBK4DT
     I              LHA1TM                          WBA1TM
     I              LHDXNB                          WBDXNB
     I              LHRMNB                          WBRMNB
     I              LHRVNB                          WBRVNB
     I              LHRVST                          WBRVST
     I              LHUJST                          WBUJST
     I              LHMNTX                          WBMNTX
     I              LHMOTX                          WBMOTX
     I              LHAYNA                          WBAYNA
     I              LHA0NA                          WBA0NA
     I              LHBZNA                          WBBZNA
     I              LHXMCD                          WBXMCD
     I              LHAIC3                          WBAIC3
     I              LHC4NB                          WBC4NB
      *
     I@LHCPHB
      * Load Order Change Log     Load/Order/Type
      * Renamed input format fields
     I              LHK4DT                          WCK4DT
     I              LHA1TM                          WCA1TM
     I              LHDXNB                          WCDXNB
     I              LHRMNB                          WCRMNB
     I              LHRVNB                          WCRVNB
     I              LHRVST                          WCRVST
     I              LHUJST                          WCUJST
     I              LHMNTX                          WCMNTX
     I              LHMOTX                          WCMOTX
     I              LHAYNA                          WCAYNA
     I              LHA0NA                          WCA0NA
     I              LHBZNA                          WCBZNA
     I              LHXMCD                          WCXMCD
     I              LHAIC3                          WCAIC3
     I              LHC4NB                          WCC4NB
      *
     I@BFCPD9
      * Order Header TRG          Load #/All orders
      * Renamed input format fields
     I              BEAIC3                          WDAIC3
     I              BEC4NB                          WDC4NB
     I              BEJNCD                          WDJNCD
     I              BEANC7                          WDANC7
     I              BEBKC7                          WDBKC7
     I              BEBRTX                          WDBRTX
     I              BEHMNA                          WDHMNA
     I              BEHONA                          WDHONA
     I              BEHPNA                          WDHPNA
     I              BEHNNA                          WDHNNA
     I              BEDBCD                          WDDBCD
     I              BECKTX                          WDCKTX
     I              BEB0C7                          WDB0C7
     I              BEAETX                          WDAETX
     I              BEB1NA                          WDB1NA
     I              BEB3NA                          WDB3NA
     I              BEB4NA                          WDB4NA
     I              BEB2NA                          WDB2NA
     I              BEBHCD                          WDBHCD
     I              BEC8TX                          WDC8TX
     I              BEBCNA                          WDBCNA
     I              BEA0DT                          WDA0DT
     I              BEA5DT                          WDA5DT
     I              BEGNDT                          WDGNDT
     I              BEACDT                          WDACDT
     I              BEAQCD                          WDAQCD
     I              BEB6NA                          WDB6NA
     I              BEBYNA                          WDBYNA
     I              BEBZNA                          WDBZNA
     I              BEGTST                          WDGTST
     I              BEGVST                          WDGVST
     I              BEGUST                          WDGUST
     I              BEQFST                          WDQFST
     I              BECQCD                          WDCQCD
     I              BEGJST                          WDGJST
     I              BEGWST                          WDGWST
     I              BEGXST                          WDGXST
     I              BEGYST                          WDGYST
     I              BEAODT                          WDAODT
     I              BEAIVN                          WDAIVN
     I              BECXDT                          WDCXDT
     I              BEJZVA                          WDJZVA
     I              BEA1WG                          WDA1WG
     I              BEXIST                          WDXIST
     I              BEXJST                          WDXJST
     I              BEXKST                          WDXKST
     I              BEEIDT                          WDEIDT
     I              BEAFTM                          WDAFTM
     I              BEE8CD                          WDE8CD
     I              BEE9CD                          WDE9CD
     I              BERMNB                          WDRMNB
     I              BETBNB                          WDTBNB
     I              BER1NB                          WDR1NB
     I              BEPJST                          WDPJST
     I              BEU0ST                          WDU0ST
     I              BEU1ST                          WDU1ST
     I              BEQ2CD                          WDQ2CD
     I              BEU2ST                          WDU2ST
     I              BEVEST                          WDVEST
     I              BEVFST                          WDVFST
     I              BEVGST                          WDVGST
     I              BERPCD                          WDRPCD
     I              BERNNB                          WDRNNB
     I              BEVDST                          WDVDST
     I              BEATIN                          WDATIN
     I              BEU4ST                          WDU4ST
     I              BEU5ST                          WDU5ST
     I              BERSRN                          WDRSRN
     I              BEMHNA                          WDMHNA
     I              BEMINA                          WDMINA
     I              BEWBST                          WDWBST
     I              BER4CD                          WDR4CD
     I              BEBFCD                          WDBFCD
     I              BEQ4CD                          WDQ4CD
     I              BET3NB                          WDT3NB
     I              BESICD                          WDSICD
     I              BECONB                          WDCONB
     I              BECEST                          WDCEST
     I              BEAWDT                          WDAWDT
     I              BEJPCD                          WDJPCD
     I              BEXUST                          WDXUST
     I              BEZ1ST                          WDZ1ST
     I              BEVRVA                          WDVRVA
     I              BEOBST                          WDOBST
     I              BEBCST                          WDBCST
     I              BEBDST                          WDBDST
     I              BEB7VL                          WDB7VL
     I              BEGASX                          WDGASX
     I              BEGBSX                          WDGBSX
     I              BEGCSX                          WDGCSX
     I              BEGDSX                          WDGDSX
     I              BEFNSX                          WDFNSX
     I              BEFOSX                          WDFOSX
     I              BEFPSX                          WDFPSX
     I              BEFQSX                          WDFQSX
     I              BEFRSX                          WDFRSX
     I              BEFSSX                          WDFSSX
     I              BEFTSX                          WDFTSX
     I              BEFUSX                          WDFUSX
     I              BEFVSX                          WDFVSX
     I              BEFWSX                          WDFWSX
     I              BEFXSX                          WDFXSX
     I              BEFYSX                          WDFYSX
     I              BENODT                          WDNODT
     I              BENPDT                          WDNPDT
     I              BENQDT                          WDNQDT
     I              BENRDT                          WDNRDT
     I              BENSDT                          WDNSDT
     I              BEBPTM                          WDBPTM
     I              BEBQTM                          WDBQTM
     I              BEBRTM                          WDBRTM
     I              BEBSTM                          WDBSTM
     I              BEBTTM                          WDBTTM
     I              BEH0NX                          WDH0NX
     I              BEH1NX                          WDH1NX
     I              BEH2NX                          WDH2NX
     I              BEH3NX                          WDH3NX
     I              BEH4NX                          WDH4NX
     I              BEC0C7                          WDC0C7
     I              BEUVST                          WDUVST
     I              BEUWST                          WDUWST
     I              BEUXST                          WDUXST
     I              BEAATM                          WDAATM
     I              BEAYNA                          WDAYNA
     I              BEA0NA                          WDA0NA
     I              BEAXDT                          WDAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WEAIC3
     I              BEC4NB                          WEC4NB
     I              BEJNCD                          WEJNCD
     I              BEANC7                          WEANC7
     I              BEBKC7                          WEBKC7
     I              BEBRTX                          WEBRTX
     I              BEHMNA                          WEHMNA
     I              BEHONA                          WEHONA
     I              BEHPNA                          WEHPNA
     I              BEHNNA                          WEHNNA
     I              BEDBCD                          WEDBCD
     I              BECKTX                          WECKTX
     I              BEB0C7                          WEB0C7
     I              BEAETX                          WEAETX
     I              BEB1NA                          WEB1NA
     I              BEB3NA                          WEB3NA
     I              BEB4NA                          WEB4NA
     I              BEB2NA                          WEB2NA
     I              BEBHCD                          WEBHCD
     I              BEC8TX                          WEC8TX
     I              BEBCNA                          WEBCNA
     I              BEA0DT                          WEA0DT
     I              BEA5DT                          WEA5DT
     I              BEGNDT                          WEGNDT
     I              BEACDT                          WEACDT
     I              BEAQCD                          WEAQCD
     I              BEB6NA                          WEB6NA
     I              BEBYNA                          WEBYNA
     I              BEBZNA                          WEBZNA
     I              BEGTST                          WEGTST
     I              BEGVST                          WEGVST
     I              BEGUST                          WEGUST
     I              BEQFST                          WEQFST
     I              BECQCD                          WECQCD
     I              BEGJST                          WEGJST
     I              BEGWST                          WEGWST
     I              BEGXST                          WEGXST
     I              BEGYST                          WEGYST
     I              BEAODT                          WEAODT
     I              BEAIVN                          WEAIVN
     I              BECXDT                          WECXDT
     I              BEJZVA                          WEJZVA
     I              BEA1WG                          WEA1WG
     I              BEXIST                          WEXIST
     I              BEXJST                          WEXJST
     I              BEXKST                          WEXKST
     I              BEEIDT                          WEEIDT
     I              BEAFTM                          WEAFTM
     I              BEE8CD                          WEE8CD
     I              BEE9CD                          WEE9CD
     I              BERMNB                          WERMNB
     I              BETBNB                          WETBNB
     I              BER1NB                          WER1NB
     I              BEPJST                          WEPJST
     I              BEU0ST                          WEU0ST
     I              BEU1ST                          WEU1ST
     I              BEQ2CD                          WEQ2CD
     I              BEU2ST                          WEU2ST
     I              BEVEST                          WEVEST
     I              BEVFST                          WEVFST
     I              BEVGST                          WEVGST
     I              BERPCD                          WERPCD
     I              BERNNB                          WERNNB
     I              BEVDST                          WEVDST
     I              BEATIN                          WEATIN
     I              BEU4ST                          WEU4ST
     I              BEU5ST                          WEU5ST
     I              BERSRN                          WERSRN
     I              BEMHNA                          WEMHNA
     I              BEMINA                          WEMINA
     I              BEWBST                          WEWBST
     I              BER4CD                          WER4CD
     I              BEBFCD                          WEBFCD
     I              BEQ4CD                          WEQ4CD
     I              BET3NB                          WET3NB
     I              BESICD                          WESICD
     I              BECONB                          WECONB
     I              BECEST                          WECEST
     I              BEAWDT                          WEAWDT
     I              BEJPCD                          WEJPCD
     I              BEXUST                          WEXUST
     I              BEZ1ST                          WEZ1ST
     I              BEVRVA                          WEVRVA
     I              BEOBST                          WEOBST
     I              BEBCST                          WEBCST
     I              BEBDST                          WEBDST
     I              BEB7VL                          WEB7VL
     I              BEGASX                          WEGASX
     I              BEGBSX                          WEGBSX
     I              BEGCSX                          WEGCSX
     I              BEGDSX                          WEGDSX
     I              BEFNSX                          WEFNSX
     I              BEFOSX                          WEFOSX
     I              BEFPSX                          WEFPSX
     I              BEFQSX                          WEFQSX
     I              BEFRSX                          WEFRSX
     I              BEFSSX                          WEFSSX
     I              BEFTSX                          WEFTSX
     I              BEFUSX                          WEFUSX
     I              BEFVSX                          WEFVSX
     I              BEFWSX                          WEFWSX
     I              BEFXSX                          WEFXSX
     I              BEFYSX                          WEFYSX
     I              BENODT                          WENODT
     I              BENPDT                          WENPDT
     I              BENQDT                          WENQDT
     I              BENRDT                          WENRDT
     I              BENSDT                          WENSDT
     I              BEBPTM                          WEBPTM
     I              BEBQTM                          WEBQTM
     I              BEBRTM                          WEBRTM
     I              BEBSTM                          WEBSTM
     I              BEBTTM                          WEBTTM
     I              BEH0NX                          WEH0NX
     I              BEH1NX                          WEH1NX
     I              BEH2NX                          WEH2NX
     I              BEH3NX                          WEH3NX
     I              BEH4NX                          WEH4NX
     I              BEC0C7                          WEC0C7
     I              BEUVST                          WEUVST
     I              BEUWST                          WEUWST
     I              BEUXST                          WEUXST
     I              BEAATM                          WEAATM
     I              BEAYNA                          WEAYNA
     I              BEA0NA                          WEA0NA
     I              BEAXDT                          WEAXDT
      *
     I@FJCPBO
      * Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WFRMNB
     I              FJAIC3                          WFAIC3
     I              FJAODT                          WFAODT
     I              FJPJST                          WFPJST
     I              FJPKST                          WFPKST
     I              FJRNNB                          WFRNNB
     I              FJDMTX                          WFDMTX
     I              FJDNTX                          WFDNTX
     I              FJDOTX                          WFDOTX
     I              FJWTTX                          WFWTTX
     I              FJWUTX                          WFWUTX
     I              FJRPNB                          WFRPNB
     I              FJFLAM                          WFFLAM
     I              FJXQST                          WFXQST
     I              FJRRNB                          WFRRNB
     I              FJDXTX                          WFDXTX
     I              FJDYTX                          WFDYTX
     I              FJSBNB                          WFSBNB
     I              FJBZNA                          WFBZNA
     I              FJRONB                          WFRONB
     I              FJSQNB                          WFSQNB
     I              FJR1NB                          WFR1NB
     I              FJVCST                          WFVCST
     I              FJVDST                          WFVDST
     I              FJSDNB                          WFSDNB
     I              FJPAOU                          WFPAOU
     I              FJDGWG                          WFDGWG
     I              FJSXNB                          WFSXNB
     I              FJHADT                          WFHADT
     I              FJAART                          WFAART
     I              FJDHWG                          WFDHWG
     I              FJDIWG                          WFDIWG
     I              FJAQDT                          WFAQDT
     I              FJS6NB                          WFS6NB
     I              FJT4NB                          WFT4NB
     I              FJPRTM                          WFPRTM
     I              FJNPSV                          WFNPSV
     I              FJJ8TX                          WFJ8TX
     I              FJTLMI                          WFTLMI
     I              FJJ9TX                          WFJ9TX
     I              FJQ2CD                          WFQ2CD
     I              FJVPCD                          WFVPCD
     I              FJDBCD                          WFDBCD
     I              FJGRWE                          WFGRWE
     I              FJXCCD                          WFXCCD
     I              FJU2ST                          WFU2ST
     I              FJF9DT                          WFF9DT
     I              FJONTM                          WFONTM
     I              FJJ4DT                          WFJ4DT
     I              FJTRTM                          WFTRTM
     I              FJJ5DT                          WFJ5DT
     I              FJSPTM                          WFSPTM
     I              FJJ6DT                          WFJ6DT
     I              FJLFTM                          WFLFTM
     I              FJJ7DT                          WFJ7DT
     I              FJBOTM                          WFBOTM
     I              FJJ8DT                          WFJ8DT
     I              FJBLTM                          WFBLTM
     I              FJKIDT                          WFKIDT
     I              FJASTM                          WFASTM
     I              FJKADT                          WFKADT
     I              FJAJCM                          WFAJCM
     I              FJXACD                          WFXACD
     I              FJOANA                          WFOANA
     I              FJK4TX                          WFK4TX
     I              FJVOAG                          WFVOAG
     I              FJKBDT                          WFKBDT
     I              FJNBBO                          WFNBBO
     I              FJW4CD                          WFW4CD
     I              FJEFDT                          WFEFDT
     I              FJCNTN                          WFCNTN
     I              FJKCDT                          WFKCDT
     I              FJTMIN                          WFTMIN
     I              FJKDDT                          WFKDDT
     I              FJVMNB                          WFVMNB
     I              FJOCFR                          WFOCFR
     I              FJKJDT                          WFKJDT
     I              FJATTM                          WFATTM
     I              FJOTRS                          WFOTRS
     I              FJRNST                          WFRNST
     I              FJBRBK                          WFBRBK
     I              FJEIDT                          WFEIDT
     I              FJRMST                          WFRMST
     I              FJAJCD                          WFAJCD
     I              FJKKDT                          WFKKDT
     I              FJAVTM                          WFAVTM
     I              FJKZDT                          WFKZDT
     I              FJAXTM                          WFAXTM
     I              FJLHOS                          WFLHOS
     I              FJLHOR                          WFLHOR
     I              FJWNTX                          WFWNTX
     I              FJOITX                          WFOITX
     I              FJOJTX                          WFOJTX
     I              FJLLDT                          WFLLDT
     I              FJLSHG                          WFLSHG
     I              FJYPST                          WFYPST
     I              FJK0DT                          WFK0DT
     I              FJAYTM                          WFAYTM
     I              FJKNNX                          WFKNNX
     I              FJICWG                          WFICWG
     I              FJIDWG                          WFIDWG
     I              FJH9SX                          WFH9SX
     I              FJWOTX                          WFWOTX
     I              FJK1DT                          WFK1DT
     I              FJAZTM                          WFAZTM
     I              FJK2DT                          WFK2DT
     I              FJA0TM                          WFA0TM
     I              FJROST                          WFROST
     I              FJRPST                          WFRPST
     I              FJRQST                          WFRQST
     I              FJRRST                          WFRRST
     I              FJZBVA                          WFZBVA
     I              FJWPTX                          WFWPTX
     I              FJWQTX                          WFWQTX
     I              FJWRTX                          WFWRTX
     I              FJWSTX                          WFWSTX
     I              FJRVSX                          WFRVSX
     I              FJRUSX                          WFRUSX
     I              FJRWSX                          WFRWSX
     I              FJRXSX                          WFRXSX
     I              FJRYSX                          WFRYSX
     I              FJRZSX                          WFRZSX
     I              FJR0SX                          WFR0SX
     I              FJR1SX                          WFR1SX
     I              FJR2SX                          WFR2SX
     I              FJR3SX                          WFR3SX
     I              FJR4SX                          WFR4SX
     I              FJPYDT                          WFPYDT
     I              FJCKTM                          WFCKTM
     I              FJPZDT                          WFPZDT
     I              FJCLTM                          WFCLTM
     I              FJP0DT                          WFP0DT
     I              FJCMTM                          WFCMTM
     I              FJP1DT                          WFP1DT
     I              FJCNTM                          WFCNTM
     I              FJP2DT                          WFP2DT
     I              FJCOTM                          WFCOTM
     I              FJP3DT                          WFP3DT
     I              FJCQTM                          WFCQTM
     I              FJUVST                          WFUVST
     I              FJUWST                          WFUWST
     I              FJUXST                          WFUXST
     I              FJAATM                          WFAATM
     I              FJAYNA                          WFAYNA
     I              FJA0NA                          WFA0NA
     I              FJAXDT                          WFAXDT
      *
     I@FLCPBM
      * Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WGRMNB
     I              FLRUNB                          WGRUNB
     I              FLRVNB                          WGRVNB
     I              FLDQTX                          WGDQTX
     I              FLRWNB                          WGRWNB
     I              FLRXNB                          WGRXNB
     I              FLSQNB                          WGSQNB
     I              FLT0NB                          WGT0NB
     I              FLT1NB                          WGT1NB
     I              FLR1NB                          WGR1NB
     I              FLAIC3                          WGAIC3
     I              FLC4NB                          WGC4NB
     I              FLVCST                          WGVCST
     I              FLKEDT                          WGKEDT
     I              FLSXNB                          WGSXNB
     I              FLKFDT                          WGKFDT
     I              FLACTM                          WGACTM
     I              FLK5TX                          WGK5TX
     I              FLW5CD                          WGW5CD
     I              FLEJDT                          WGEJDT
     I              FLAGTM                          WGAGTM
     I              FLKJDT                          WGKJDT
     I              FLATTM                          WGATTM
     I              FLHDDT                          WGHDDT
     I              FLAUTM                          WGAUTM
     I              FLKKDT                          WGKKDT
     I              FLAVTM                          WGAVTM
     I              FLZ4NB                          WGZ4NB
     I              FLY7ST                          WGY7ST
     I              FLY2ST                          WGY2ST
     I              FLWHTX                          WGWHTX
     I              FLWITX                          WGWITX
     I              FLWJTX                          WGWJTX
     I              FLWKTX                          WGWKTX
     I              FLWLTX                          WGWLTX
     I              FLN7DT                          WGN7DT
     I              FLN8DT                          WGN8DT
     I              FLN9DT                          WGN9DT
     I              FLB3TM                          WGB3TM
     I              FLB4TM                          WGB4TM
     I              FLB5TM                          WGB5TM
     I              FLIASX                          WGIASX
     I              FLIBSX                          WGIBSX
     I              FLICSX                          WGICSX
     I              FLWVTX                          WGWVTX
     I              FLWWTX                          WGWWTX
     I              FLWXTX                          WGWXTX
     I              FLUVST                          WGUVST
     I              FLUWST                          WGUWST
     I              FLUXST                          WGUXST
     I              FLAATM                          WGAATM
     I              FLAYNA                          WGAYNA
     I              FLA0NA                          WGA0NA
     I              FLAXDT                          WGAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WHAIC3
     I              OMC4NB                          WHC4NB
     I              OMDPNB                          WHDPNB
     I              OMUENB                          WHUENB
     I              OMHGCD                          WHHGCD
     I              OMAJCD                          WHAJCD
     I              OMBKC7                          WHBKC7
     I              OMCFC7                          WHCFC7
     I              OMGMST                          WHGMST
     I              OMGNST                          WHGNST
     I              OMMAVA                          WHMAVA
     I              OMKDVA                          WHKDVA
     I              OML8VA                          WHL8VA
     I              OML9VA                          WHL9VA
     I              OMGTST                          WHGTST
     I              OMGVST                          WHGVST
     I              OMGUST                          WHGUST
     I              OMQFST                          WHQFST
     I              OMAYVA                          WHAYVA
     I              OMEXDT                          WHEXDT
     I              OMLQCD                          WHLQCD
     I              OMRDCD                          WHRDCD
     I              OMQ7CD                          WHQ7CD
     I              OMBZPR                          WHBZPR
     I              OML6NB                          WHL6NB
     I              OMU1ST                          WHU1ST
     I              OMGIDT                          WHGIDT
     I              OMCRCD                          WHCRCD
     I              OMAGCD                          WHAGCD
     I              OMRZST                          WHRZST
     I              OMR0ST                          WHR0ST
     I              OMR1ST                          WHR1ST
     I              OMG7NA                          WHG7NA
     I              OMG8NA                          WHG8NA
     I              OMRPCD                          WHRPCD
     I              OMVEST                          WHVEST
     I              OMVGST                          WHVGST
     I              OMAVST                          WHAVST
     I              OMU0ST                          WHU0ST
     I              OMRFCD                          WHRFCD
     I              OMFZST                          WHFZST
     I              OMR1NB                          WHR1NB
     I              OMAVQT                          WHAVQT
     I              OMD0WG                          WHD0WG
     I              OMCCQT                          WHCCQT
     I              OMAUWG                          WHAUWG
     I              OMCBQT                          WHCBQT
     I              OMATWG                          WHATWG
     I              OMAQCS                          WHAQCS
     I              OMAGCS                          WHAGCS
     I              OMAKPR                          WHAKPR
     I              OMALPR                          WHALPR
     I              OMAUPR                          WHAUPR
     I              OMAVWG                          WHAVWG
     I              OMA4WG                          WHA4WG
     I              OMA5DT                          WHA5DT
     I              OMAODT                          WHAODT
     I              OMGNDT                          WHGNDT
     I              OMAMST                          WHAMST
     I              OMANST                          WHANST
     I              OMVAST                          WHVAST
     I              OMRGNB                          WHRGNB
     I              OMRHNB                          WHRHNB
     I              OMRINB                          WHRINB
     I              OMRBCD                          WHRBCD
     I              OMHICD                          WHHICD
     I              OMRNCD                          WHRNCD
     I              OMROCD                          WHROCD
     I              OMCXDT                          WHCXDT
     I              OMAJVN                          WHAJVN
     I              OMKXCD                          WHKXCD
     I              OMJPCD                          WHJPCD
     I              OMCQCD                          WHCQCD
     I              OMR4CD                          WHR4CD
     I              OMZ1ST                          WHZ1ST
     I              OMZ3ST                          WHZ3ST
     I              OMZ4ST                          WHZ4ST
     I              OMDUPR                          WHDUPR
     I              OMB6VL                          WHB6VL
     I              OMA1AA                          WHA1AA
     I              OMFZSX                          WHFZSX
     I              OMF0SX                          WHF0SX
     I              OMF1SX                          WHF1SX
     I              OMF2SX                          WHF2SX
     I              OMF3SX                          WHF3SX
     I              OMF4SX                          WHF4SX
     I              OMF5SX                          WHF5SX
     I              OMF6SX                          WHF6SX
     I              OMF7SX                          WHF7SX
     I              OMNTDT                          WHNTDT
     I              OMNUDT                          WHNUDT
     I              OMNVDT                          WHNVDT
     I              OMNWDT                          WHNWDT
     I              OMNXDT                          WHNXDT
     I              OMBUTM                          WHBUTM
     I              OMBVTM                          WHBVTM
     I              OMBWTM                          WHBWTM
     I              OMBXTM                          WHBXTM
     I              OMBYTM                          WHBYTM
     I              OMH5NX                          WHH5NX
     I              OMH6NX                          WHH6NX
     I              OMH7NX                          WHH7NX
     I              OMH8NX                          WHH8NX
     I              OMH9NX                          WHH9NX
     I              OMDVPR                          WHDVPR
     I              OMDWPR                          WHDWPR
     I              OMDXPR                          WHDXPR
     I              OMDYPR                          WHDYPR
     I              OMDZPR                          WHDZPR
     I              OMGSPR                          WHGSPR
     I              OMGTPR                          WHGTPR
     I              OMGUPR                          WHGUPR
     I              OMHOST                          WHHOST
     I              OMHPST                          WHHPST
     I              OMIOST                          WHIOST
     I              OMPEWG                          WHPEWG
     I              OMRINY                          WHRINY
     I              OMTIDT                          WHTIDT
     I              OMTJDT                          WHTJDT
     I              OMH2ST                          WHH2ST
     I              OMH0ST                          WHH0ST
     I              OMH1ST                          WHH1ST
     I              OMTKDT                          WHTKDT
     I              OMTLDT                          WHTLDT
     I              OMTMDT                          WHTMDT
     I              OMUVST                          WHUVST
     I              OMUWST                          WHUWST
     I              OMUXST                          WHUXST
     I              OMAATM                          WHAATM
     I              OMAYNA                          WHAYNA
     I              OMA0NA                          WHA0NA
     I              OMAXDT                          WHAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WIAIC3
     I              OMC4NB                          WIC4NB
     I              OMDPNB                          WIDPNB
     I              OMUENB                          WIUENB
     I              OMHGCD                          WIHGCD
     I              OMAJCD                          WIAJCD
     I              OMBKC7                          WIBKC7
     I              OMCFC7                          WICFC7
     I              OMGMST                          WIGMST
     I              OMGNST                          WIGNST
     I              OMMAVA                          WIMAVA
     I              OMKDVA                          WIKDVA
     I              OML8VA                          WIL8VA
     I              OML9VA                          WIL9VA
     I              OMGTST                          WIGTST
     I              OMGVST                          WIGVST
     I              OMGUST                          WIGUST
     I              OMQFST                          WIQFST
     I              OMAYVA                          WIAYVA
     I              OMEXDT                          WIEXDT
     I              OMLQCD                          WILQCD
     I              OMRDCD                          WIRDCD
     I              OMQ7CD                          WIQ7CD
     I              OMBZPR                          WIBZPR
     I              OML6NB                          WIL6NB
     I              OMU1ST                          WIU1ST
     I              OMGIDT                          WIGIDT
     I              OMCRCD                          WICRCD
     I              OMAGCD                          WIAGCD
     I              OMRZST                          WIRZST
     I              OMR0ST                          WIR0ST
     I              OMR1ST                          WIR1ST
     I              OMG7NA                          WIG7NA
     I              OMG8NA                          WIG8NA
     I              OMRPCD                          WIRPCD
     I              OMVEST                          WIVEST
     I              OMVGST                          WIVGST
     I              OMAVST                          WIAVST
     I              OMU0ST                          WIU0ST
     I              OMRFCD                          WIRFCD
     I              OMFZST                          WIFZST
     I              OMR1NB                          WIR1NB
     I              OMAVQT                          WIAVQT
     I              OMD0WG                          WID0WG
     I              OMCCQT                          WICCQT
     I              OMAUWG                          WIAUWG
     I              OMCBQT                          WICBQT
     I              OMATWG                          WIATWG
     I              OMAQCS                          WIAQCS
     I              OMAGCS                          WIAGCS
     I              OMAKPR                          WIAKPR
     I              OMALPR                          WIALPR
     I              OMAUPR                          WIAUPR
     I              OMAVWG                          WIAVWG
     I              OMA4WG                          WIA4WG
     I              OMA5DT                          WIA5DT
     I              OMAODT                          WIAODT
     I              OMGNDT                          WIGNDT
     I              OMAMST                          WIAMST
     I              OMANST                          WIANST
     I              OMVAST                          WIVAST
     I              OMRGNB                          WIRGNB
     I              OMRHNB                          WIRHNB
     I              OMRINB                          WIRINB
     I              OMRBCD                          WIRBCD
     I              OMHICD                          WIHICD
     I              OMRNCD                          WIRNCD
     I              OMROCD                          WIROCD
     I              OMCXDT                          WICXDT
     I              OMAJVN                          WIAJVN
     I              OMKXCD                          WIKXCD
     I              OMJPCD                          WIJPCD
     I              OMCQCD                          WICQCD
     I              OMR4CD                          WIR4CD
     I              OMZ1ST                          WIZ1ST
     I              OMZ3ST                          WIZ3ST
     I              OMZ4ST                          WIZ4ST
     I              OMDUPR                          WIDUPR
     I              OMB6VL                          WIB6VL
     I              OMA1AA                          WIA1AA
     I              OMFZSX                          WIFZSX
     I              OMF0SX                          WIF0SX
     I              OMF1SX                          WIF1SX
     I              OMF2SX                          WIF2SX
     I              OMF3SX                          WIF3SX
     I              OMF4SX                          WIF4SX
     I              OMF5SX                          WIF5SX
     I              OMF6SX                          WIF6SX
     I              OMF7SX                          WIF7SX
     I              OMNTDT                          WINTDT
     I              OMNUDT                          WINUDT
     I              OMNVDT                          WINVDT
     I              OMNWDT                          WINWDT
     I              OMNXDT                          WINXDT
     I              OMBUTM                          WIBUTM
     I              OMBVTM                          WIBVTM
     I              OMBWTM                          WIBWTM
     I              OMBXTM                          WIBXTM
     I              OMBYTM                          WIBYTM
     I              OMH5NX                          WIH5NX
     I              OMH6NX                          WIH6NX
     I              OMH7NX                          WIH7NX
     I              OMH8NX                          WIH8NX
     I              OMH9NX                          WIH9NX
     I              OMDVPR                          WIDVPR
     I              OMDWPR                          WIDWPR
     I              OMDXPR                          WIDXPR
     I              OMDYPR                          WIDYPR
     I              OMDZPR                          WIDZPR
     I              OMGSPR                          WIGSPR
     I              OMGTPR                          WIGTPR
     I              OMGUPR                          WIGUPR
     I              OMHOST                          WIHOST
     I              OMHPST                          WIHPST
     I              OMIOST                          WIIOST
     I              OMPEWG                          WIPEWG
     I              OMRINY                          WIRINY
     I              OMTIDT                          WITIDT
     I              OMTJDT                          WITJDT
     I              OMH2ST                          WIH2ST
     I              OMH0ST                          WIH0ST
     I              OMH1ST                          WIH1ST
     I              OMTKDT                          WITKDT
     I              OMTLDT                          WITLDT
     I              OMTMDT                          WITMDT
     I              OMUVST                          WIUVST
     I              OMUWST                          WIUWST
     I              OMUXST                          WIUXST
     I              OMAATM                          WIAATM
     I              OMAYNA                          WIAYNA
     I              OMA0NA                          WIA0NA
     I              OMAXDT                          WIAXDT
      *
     I@LHCPN6
      * Load Order Change Log     Update index
      * Renamed input format fields
     I              LHK4DT                          WJK4DT
     I              LHA1TM                          WJA1TM
     I              LHDXNB                          WJDXNB
     I              LHRMNB                          WJRMNB
     I              LHRVNB                          WJRVNB
     I              LHRVST                          WJRVST
     I              LHUJST                          WJUJST
     I              LHMNTX                          WJMNTX
     I              LHMOTX                          WJMOTX
     I              LHAYNA                          WJAYNA
     I              LHA0NA                          WJA0NA
     I              LHBZNA                          WJBZNA
     I              LHXMCD                          WJXMCD
     I              LHAIC3                          WJAIC3
     I              LHC4NB                          WJC4NB
      *
     I@LHCPQR
      * Load Order Change Log     Load ID/Seg Num-1
      * Renamed input format fields
     I              LHK4DT                          WKK4DT
     I              LHA1TM                          WKA1TM
     I              LHDXNB                          WKDXNB
     I              LHRMNB                          WKRMNB
     I              LHRVNB                          WKRVNB
     I              LHRVST                          WKRVST
     I              LHUJST                          WKUJST
     I              LHMNTX                          WKMNTX
     I              LHMOTX                          WKMOTX
     I              LHAYNA                          WKAYNA
     I              LHA0NA                          WKA0NA
     I              LHBZNA                          WKBZNA
     I              LHXMCD                          WKXMCD
     I              LHAIC3                          WKAIC3
     I              LHC4NB                          WKC4NB
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     IQOMFJ1    E DSOMFJCPL1
      * UPD : Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WFRMNB
     I              FJAIC3                          WFAIC3
     I              FJAODT                          WFAODT
     I              FJPJST                          WFPJST
     I              FJPKST                          WFPKST
     I              FJRNNB                          WFRNNB
     I              FJDMTX                          WFDMTX
     I              FJDNTX                          WFDNTX
     I              FJDOTX                          WFDOTX
     I              FJWTTX                          WFWTTX
     I              FJWUTX                          WFWUTX
     I              FJRPNB                          WFRPNB
     I              FJFLAM                          WFFLAM
     I              FJXQST                          WFXQST
     I              FJRRNB                          WFRRNB
     I              FJDXTX                          WFDXTX
     I              FJDYTX                          WFDYTX
     I              FJSBNB                          WFSBNB
     I              FJBZNA                          WFBZNA
     I              FJRONB                          WFRONB
     I              FJSQNB                          WFSQNB
     I              FJR1NB                          WFR1NB
     I              FJVCST                          WFVCST
     I              FJVDST                          WFVDST
     I              FJSDNB                          WFSDNB
     I              FJPAOU                          WFPAOU
     I              FJDGWG                          WFDGWG
     I              FJSXNB                          WFSXNB
     I              FJHADT                          WFHADT
     I              FJAART                          WFAART
     I              FJDHWG                          WFDHWG
     I              FJDIWG                          WFDIWG
     I              FJAQDT                          WFAQDT
     I              FJS6NB                          WFS6NB
     I              FJT4NB                          WFT4NB
     I              FJPRTM                          WFPRTM
     I              FJNPSV                          WFNPSV
     I              FJJ8TX                          WFJ8TX
     I              FJTLMI                          WFTLMI
     I              FJJ9TX                          WFJ9TX
     I              FJQ2CD                          WFQ2CD
     I              FJVPCD                          WFVPCD
     I              FJDBCD                          WFDBCD
     I              FJGRWE                          WFGRWE
     I              FJXCCD                          WFXCCD
     I              FJU2ST                          WFU2ST
     I              FJF9DT                          WFF9DT
     I              FJONTM                          WFONTM
     I              FJJ4DT                          WFJ4DT
     I              FJTRTM                          WFTRTM
     I              FJJ5DT                          WFJ5DT
     I              FJSPTM                          WFSPTM
     I              FJJ6DT                          WFJ6DT
     I              FJLFTM                          WFLFTM
     I              FJJ7DT                          WFJ7DT
     I              FJBOTM                          WFBOTM
     I              FJJ8DT                          WFJ8DT
     I              FJBLTM                          WFBLTM
     I              FJKIDT                          WFKIDT
     I              FJASTM                          WFASTM
     I              FJKADT                          WFKADT
     I              FJAJCM                          WFAJCM
     I              FJXACD                          WFXACD
     I              FJOANA                          WFOANA
     I              FJK4TX                          WFK4TX
     I              FJVOAG                          WFVOAG
     I              FJKBDT                          WFKBDT
     I              FJNBBO                          WFNBBO
     I              FJW4CD                          WFW4CD
     I              FJEFDT                          WFEFDT
     I              FJCNTN                          WFCNTN
     I              FJKCDT                          WFKCDT
     I              FJTMIN                          WFTMIN
     I              FJKDDT                          WFKDDT
     I              FJVMNB                          WFVMNB
     I              FJOCFR                          WFOCFR
     I              FJKJDT                          WFKJDT
     I              FJATTM                          WFATTM
     I              FJOTRS                          WFOTRS
     I              FJRNST                          WFRNST
     I              FJBRBK                          WFBRBK
     I              FJEIDT                          WFEIDT
     I              FJRMST                          WFRMST
     I              FJAJCD                          WFAJCD
     I              FJKKDT                          WFKKDT
     I              FJAVTM                          WFAVTM
     I              FJKZDT                          WFKZDT
     I              FJAXTM                          WFAXTM
     I              FJLHOS                          WFLHOS
     I              FJLHOR                          WFLHOR
     I              FJWNTX                          WFWNTX
     I              FJOITX                          WFOITX
     I              FJOJTX                          WFOJTX
     I              FJLLDT                          WFLLDT
     I              FJLSHG                          WFLSHG
     I              FJYPST                          WFYPST
     I              FJK0DT                          WFK0DT
     I              FJAYTM                          WFAYTM
     I              FJKNNX                          WFKNNX
     I              FJICWG                          WFICWG
     I              FJIDWG                          WFIDWG
     I              FJH9SX                          WFH9SX
     I              FJWOTX                          WFWOTX
     I              FJK1DT                          WFK1DT
     I              FJAZTM                          WFAZTM
     I              FJK2DT                          WFK2DT
     I              FJA0TM                          WFA0TM
     I              FJROST                          WFROST
     I              FJRPST                          WFRPST
     I              FJRQST                          WFRQST
     I              FJRRST                          WFRRST
     I              FJZBVA                          WFZBVA
     I              FJWPTX                          WFWPTX
     I              FJWQTX                          WFWQTX
     I              FJWRTX                          WFWRTX
     I              FJWSTX                          WFWSTX
     I              FJRVSX                          WFRVSX
     I              FJRUSX                          WFRUSX
     I              FJRWSX                          WFRWSX
     I              FJRXSX                          WFRXSX
     I              FJRYSX                          WFRYSX
     I              FJRZSX                          WFRZSX
     I              FJR0SX                          WFR0SX
     I              FJR1SX                          WFR1SX
     I              FJR2SX                          WFR2SX
     I              FJR3SX                          WFR3SX
     I              FJR4SX                          WFR4SX
     I              FJPYDT                          WFPYDT
     I              FJCKTM                          WFCKTM
     I              FJPZDT                          WFPZDT
     I              FJCLTM                          WFCLTM
     I              FJP0DT                          WFP0DT
     I              FJCMTM                          WFCMTM
     I              FJP1DT                          WFP1DT
     I              FJCNTM                          WFCNTM
     I              FJP2DT                          WFP2DT
     I              FJCOTM                          WFCOTM
     I              FJP3DT                          WFP3DT
     I              FJCQTM                          WFCQTM
     I              FJUVST                          WFUVST
     I              FJUWST                          WFUWST
     I              FJUXST                          WFUXST
     I              FJAATM                          WFAATM
     I              FJAYNA                          WFAYNA
     I              FJA0NA                          WFA0NA
     I              FJAXDT                          WFAXDT
      *
     IYARDCS      DS                            793
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQOMFL1    E DSOMFLCPL0
      * UPD : Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WGRMNB
     I              FLRUNB                          WGRUNB
     I              FLRVNB                          WGRVNB
     I              FLDQTX                          WGDQTX
     I              FLRWNB                          WGRWNB
     I              FLRXNB                          WGRXNB
     I              FLSQNB                          WGSQNB
     I              FLT0NB                          WGT0NB
     I              FLT1NB                          WGT1NB
     I              FLR1NB                          WGR1NB
     I              FLAIC3                          WGAIC3
     I              FLC4NB                          WGC4NB
     I              FLVCST                          WGVCST
     I              FLKEDT                          WGKEDT
     I              FLSXNB                          WGSXNB
     I              FLKFDT                          WGKFDT
     I              FLACTM                          WGACTM
     I              FLK5TX                          WGK5TX
     I              FLW5CD                          WGW5CD
     I              FLEJDT                          WGEJDT
     I              FLAGTM                          WGAGTM
     I              FLKJDT                          WGKJDT
     I              FLATTM                          WGATTM
     I              FLHDDT                          WGHDDT
     I              FLAUTM                          WGAUTM
     I              FLKKDT                          WGKKDT
     I              FLAVTM                          WGAVTM
     I              FLZ4NB                          WGZ4NB
     I              FLY7ST                          WGY7ST
     I              FLY2ST                          WGY2ST
     I              FLWHTX                          WGWHTX
     I              FLWITX                          WGWITX
     I              FLWJTX                          WGWJTX
     I              FLWKTX                          WGWKTX
     I              FLWLTX                          WGWLTX
     I              FLN7DT                          WGN7DT
     I              FLN8DT                          WGN8DT
     I              FLN9DT                          WGN9DT
     I              FLB3TM                          WGB3TM
     I              FLB4TM                          WGB4TM
     I              FLB5TM                          WGB5TM
     I              FLIASX                          WGIASX
     I              FLIBSX                          WGIBSX
     I              FLICSX                          WGICSX
     I              FLWVTX                          WGWVTX
     I              FLWWTX                          WGWWTX
     I              FLWXTX                          WGWXTX
     I              FLUVST                          WGUVST
     I              FLUWST                          WGUWST
     I              FLUXST                          WGUXST
     I              FLAATM                          WGAATM
     I              FLAYNA                          WGAYNA
     I              FLA0NA                          WGA0NA
     I              FLAXDT                          WGAXDT
      *
     IYBRDCS      DS                            367
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WIAIC3
     I              OMC4NB                          WIC4NB
     I              OMDPNB                          WIDPNB
     I              OMUENB                          WIUENB
     I              OMHGCD                          WIHGCD
     I              OMAJCD                          WIAJCD
     I              OMBKC7                          WIBKC7
     I              OMCFC7                          WICFC7
     I              OMGMST                          WIGMST
     I              OMGNST                          WIGNST
     I              OMMAVA                          WIMAVA
     I              OMKDVA                          WIKDVA
     I              OML8VA                          WIL8VA
     I              OML9VA                          WIL9VA
     I              OMGTST                          WIGTST
     I              OMGVST                          WIGVST
     I              OMGUST                          WIGUST
     I              OMQFST                          WIQFST
     I              OMAYVA                          WIAYVA
     I              OMEXDT                          WIEXDT
     I              OMLQCD                          WILQCD
     I              OMRDCD                          WIRDCD
     I              OMQ7CD                          WIQ7CD
     I              OMBZPR                          WIBZPR
     I              OML6NB                          WIL6NB
     I              OMU1ST                          WIU1ST
     I              OMGIDT                          WIGIDT
     I              OMCRCD                          WICRCD
     I              OMAGCD                          WIAGCD
     I              OMRZST                          WIRZST
     I              OMR0ST                          WIR0ST
     I              OMR1ST                          WIR1ST
     I              OMG7NA                          WIG7NA
     I              OMG8NA                          WIG8NA
     I              OMRPCD                          WIRPCD
     I              OMVEST                          WIVEST
     I              OMVGST                          WIVGST
     I              OMAVST                          WIAVST
     I              OMU0ST                          WIU0ST
     I              OMRFCD                          WIRFCD
     I              OMFZST                          WIFZST
     I              OMR1NB                          WIR1NB
     I              OMAVQT                          WIAVQT
     I              OMD0WG                          WID0WG
     I              OMCCQT                          WICCQT
     I              OMAUWG                          WIAUWG
     I              OMCBQT                          WICBQT
     I              OMATWG                          WIATWG
     I              OMAQCS                          WIAQCS
     I              OMAGCS                          WIAGCS
     I              OMAKPR                          WIAKPR
     I              OMALPR                          WIALPR
     I              OMAUPR                          WIAUPR
     I              OMAVWG                          WIAVWG
     I              OMA4WG                          WIA4WG
     I              OMA5DT                          WIA5DT
     I              OMAODT                          WIAODT
     I              OMGNDT                          WIGNDT
     I              OMAMST                          WIAMST
     I              OMANST                          WIANST
     I              OMVAST                          WIVAST
     I              OMRGNB                          WIRGNB
     I              OMRHNB                          WIRHNB
     I              OMRINB                          WIRINB
     I              OMRBCD                          WIRBCD
     I              OMHICD                          WIHICD
     I              OMRNCD                          WIRNCD
     I              OMROCD                          WIROCD
     I              OMCXDT                          WICXDT
     I              OMAJVN                          WIAJVN
     I              OMKXCD                          WIKXCD
     I              OMJPCD                          WIJPCD
     I              OMCQCD                          WICQCD
     I              OMR4CD                          WIR4CD
     I              OMZ1ST                          WIZ1ST
     I              OMZ3ST                          WIZ3ST
     I              OMZ4ST                          WIZ4ST
     I              OMDUPR                          WIDUPR
     I              OMB6VL                          WIB6VL
     I              OMA1AA                          WIA1AA
     I              OMFZSX                          WIFZSX
     I              OMF0SX                          WIF0SX
     I              OMF1SX                          WIF1SX
     I              OMF2SX                          WIF2SX
     I              OMF3SX                          WIF3SX
     I              OMF4SX                          WIF4SX
     I              OMF5SX                          WIF5SX
     I              OMF6SX                          WIF6SX
     I              OMF7SX                          WIF7SX
     I              OMNTDT                          WINTDT
     I              OMNUDT                          WINUDT
     I              OMNVDT                          WINVDT
     I              OMNWDT                          WINWDT
     I              OMNXDT                          WINXDT
     I              OMBUTM                          WIBUTM
     I              OMBVTM                          WIBVTM
     I              OMBWTM                          WIBWTM
     I              OMBXTM                          WIBXTM
     I              OMBYTM                          WIBYTM
     I              OMH5NX                          WIH5NX
     I              OMH6NX                          WIH6NX
     I              OMH7NX                          WIH7NX
     I              OMH8NX                          WIH8NX
     I              OMH9NX                          WIH9NX
     I              OMDVPR                          WIDVPR
     I              OMDWPR                          WIDWPR
     I              OMDXPR                          WIDXPR
     I              OMDYPR                          WIDYPR
     I              OMDZPR                          WIDZPR
     I              OMGSPR                          WIGSPR
     I              OMGTPR                          WIGTPR
     I              OMGUPR                          WIGUPR
     I              OMHOST                          WIHOST
     I              OMHPST                          WIHPST
     I              OMIOST                          WIIOST
     I              OMPEWG                          WIPEWG
     I              OMRINY                          WIRINY
     I              OMTIDT                          WITIDT
     I              OMTJDT                          WITJDT
     I              OMH2ST                          WIH2ST
     I              OMH0ST                          WIH0ST
     I              OMH1ST                          WIH1ST
     I              OMTKDT                          WITKDT
     I              OMTLDT                          WITLDT
     I              OMTMDT                          WITMDT
     I              OMUVST                          WIUVST
     I              OMUWST                          WIUWST
     I              OMUXST                          WIUXST
     I              OMAATM                          WIAATM
     I              OMAYNA                          WIAYNA
     I              OMA0NA                          WIA0NA
     I              OMAXDT                          WIAXDT
      *
     IYCRDCS      DS                            525
      * Outward parameters
     IPARC        DS                             82
      * RCD : Load Order Change Log     Retrieval index
      * N :  Sequence Number
     I                                    P   9  100PADXNB
      * I :  Load ID
     I                                    P  11  140PARMNB
      * I :  Stop/Drop
     I                                    P  15  170PARVNB
      * I :  Load Change Type
     I                                       18  23 PARVST
      * I :  Department Control Code
     I                                       24  26 PAUJST
      * I :  Change Log Prior Value
     I                                       27  38 PAMNTX
      * I :  Change Log New Value
     I                                       39  50 PAMOTX
      * I :  User Id
     I                                       51  60 PAAYNA
      * I :  Job Name
     I                                       61  70 PAA0NA
      * I :  Carrier Code
     I                                       71  73 PABZNA
      * N :  Carrier Broker Carrier Co
     I                                       74  76 PAXMCD
      * I :  Company Number
     I                                    P  77  780PAAIC3
      * I :  Order Number
     I                                    P  79  820PAC4NB
      *
     IYDRDCS      DS                            793
     IQPDLH1    E DSPDLHCPL0
      * UPD : Load Order Change Log     Update index
      * Renamed input format fields
     I              LHK4DT                          WJK4DT
     I              LHA1TM                          WJA1TM
     I              LHDXNB                          WJDXNB
     I              LHRMNB                          WJRMNB
     I              LHRVNB                          WJRVNB
     I              LHRVST                          WJRVST
     I              LHUJST                          WJUJST
     I              LHMNTX                          WJMNTX
     I              LHMOTX                          WJMOTX
     I              LHAYNA                          WJAYNA
     I              LHA0NA                          WJA0NA
     I              LHBZNA                          WJBZNA
     I              LHXMCD                          WJXMCD
     I              LHAIC3                          WJAIC3
     I              LHC4NB                          WJC4NB
      *
     IYERDCS      DS                            793
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Load Order Change Log
      * I : MAP Created Date
     I                                    P   1   40P1K4DT
      * I : MAP Created Time
     I                                    P   5   80P1A1TM
      * I : MAP Sequence Number
     I                                    P   9  100P1DXNB
      * I : RST Load ID
     I                                    P  11  140P1RMNB
      * B : RST Stop/Drop
     I                                    P  15  170P1RVNB
      * B : RST Order Number
     I                                    P  18  210P1C4NB
     IP2PARM      DS
      * FLD: *Arrays
      * N :  Warehouse Code
     I                                        1   3 P2AJCD
      * N :  Application Code
     I                                        4   9 P2DNCD
      * N :  Salesperson Code
     I                                       10  12 P2BCCD
      * N :  System Date Format
     I                                       13  15 P2B8NA
      * N :  User Profile Name
     I                                       16  25 P2AJVN
      * N :  Allow Multi-Company
     I                                       26  26 P2I6ST
      * N :  Default Printer
     I                                       27  36 P2MPNA
     IP3PARM      DS
      * FLD: *Arrays
      * N :  USR Order Number
     I                                    P   1   40P3MPNB
      * N :  Load Acceptance Flag
     I                                        5   5 P3RMST
      * N :  USR Load Exists
     I                                        6   6 P3UTST
      * N :  @Calc 5,0
     I                                        7  110P3CLC5
      * N : MAP @Calc 3,0
     I                                       12  140P3CLC3
      * N :  Calc 5
     I                                       15  190P3TSNB
      * N :  USR Stop/Drop
     I                                    P  20  220P3
      * N :  USR View Option
     I                                       23  23 P3UMST
     IP4PARM      DS
      * FLD: Company Defaults Internal
      * N :  Plant Company Sts
     I                                        1   1 P4YISX
      * N :  Company Organization
     I                                        2   2 P4YJSX
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Freight Rate is 0 for cst'
      * Ship To Customer
     I                                        1   7 ZA0001
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0002
      * Application Code
     I                                       11  16 ZA0003
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0004
      * Application Code
     I                                       11  16 ZA0005
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1K4DT    PARM           WP0001  70       Created Date
     C           P1A1TM    PARM           WP0002  60       Created Time
     C           P1DXNB    PARM           WP0003  30       Sequence Number
     C           P1RMNB    PARM           WP0004  70       Load ID
     C           P1RVNB    PARM P1RVNB    WP0005  50       Stop/Drop
     C           P1C4NB    PARM P1C4NB    WP0006  70       Order Number
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise & load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END                             OD W0RSF
     C                     END                             OD *HIVAL
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise and load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
      * USER: Initialize subfile control
      * For existing loads
      * CASE: PAR.USR Load Exists is Load Exists
     C           P3UTST    IFEQ 'Y'                        *IF
      * RTV Load Header All,Co RT - Load Header  * 
     C                     EXSR SARVGN
      * RTV GrsWgt w/PltTr Ld RT - Load Detail  * 
     C                     EXSR SBRVGN
      * RTV Carr Appt Dt/Tm   RT - Load Detail  * 
     C                     EXSR SDRVGN
     C           YL0005    DIV  100       #CLSNX           Appointment Tim
     C                     Z-ADDWUA7WG    #CGRWE           Gross Weight
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     #CGRWE           Gross Weight
     C                     MOVEL'DELOAD'  WURVST           Load Change Typ
      * RTV Carrier Code       RT - Load Order Change Log  * 
     C                     EXSR SERVGN
     C                     END                             *FI
      * RTV Carrier Name       RT - OM Carrier  * 
     C                     EXSR SFRVGN
      * ** Retrieve co# for the deleted load/order
     C                     MOVEL'DELOAD'  WURVST           Load Change Typ
      * RTV Co#-Dltd/trnsfd OrdRT - Load Order Change Log  * 
     C                     EXSR SGRVGN
      * ** Get co# from Order Header file
      * CASE: WRK.Company is Equal to zero
     C           WUBNC3    IFEQ *ZERO                      *IF
      * RTV All Hdr flds b/ord RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2C4NB    WL0006           Order Number
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    #2AIC3           Company Number
     C                     MOVELWL0007    WUG0TX    P      Order Type - Sa
     C                     Z-ADDWL0008    WUNFNN           A/R Customer Nu
     C                     Z-ADDWL0009    WUNFNN           Ship To Custome
     C                     MOVELWL0010    #CBRTX    P      Ship To Name
     C                     MOVELWL0011    WUG0TX    P      Ship To Address
     C                     MOVELWL0012    WUG0TX    P      Ship To Address
     C                     MOVELWL0013    WUG0TX    P      Ship To Address
     C                     MOVELWL0014    #CHNNA    P      Ship To City
     C                     MOVELWL0015    #CDBCD    P      Ship To State C
     C                     MOVELWL0016    WUG0TX    P      Ship To Zip/Pos
     C                     Z-ADDWL0017    WUNFNN           Bill to Custome
     C                     MOVELWL0018    WUG0TX    P      Bill to Name
     C                     MOVELWL0019    WUG0TX    P      Bill to Address
     C                     MOVELWL0020    WUG0TX    P      Bill to Address
     C                     MOVELWL0021    WUG0TX    P      Bill to Address
     C                     MOVELWL0022    WUG0TX    P      Bill to City
     C                     MOVELWL0023    WUG0TX    P      Bill to State C
     C                     MOVELWL0024    WUG0TX    P      Bill to Zip/Pos
     C                     MOVELWL0025    WUG0TX    P      Customer Purcha
     C                     Z-ADDWL0026    WUNFNN           Order Date
     C                     Z-ADDWL0027    WUNFNN           Requested Ship
     C                     Z-ADDWL0028    WUNFNN           Actual Shipped
     C                     Z-ADDWL0029    WUNFNN           Cancel Date
     C                     MOVELWL0030    WUG0TX    P      Terms Code
     C                     MOVELWL0031    WUG0TX    P      Special Instruc
     C                     MOVELWL0032    WUG0TX    P      Special Instruc
     C                     MOVELWL0033    WUG0TX    P      Carrier Code
     C                     MOVELWL0034    WUG0TX    P      Comment Print A
     C                     MOVELWL0035    WUG0TX    P      Comment Print I
     C                     MOVELWL0036    WUG0TX    P      Comment Print P
     C                     MOVELWL0037    WUG0TX    P      Comment Print S
     C                     MOVELWL0038    WUG0TX    P      Reason Code
     C                     MOVELWL0039    WUG0TX    P      Order in Use
     C                     MOVELWL0040    #CGWST    P      Header Status
     C                     MOVELWL0041    WUG0TX    P      Header Status L
     C                     MOVELWL0042    WUG0TX    P      Order Type Prin
     C                     Z-ADDWL0043    YL0006           Scheduled Ship
     C                     MOVELWL0044    WUG0TX    P      User Original E
     C                     Z-ADDWL0045    WUNFNN           Date of Origina
     C                     Z-ADDWL0046    WUNFNN           Order Value Tot
     C                     Z-ADDWL0047    WUNFNN           Order Weight To
     C                     MOVELWL0048    #CXIST    P      Credit Hold
     C                     MOVELWL0049    #CXJST    P      Production Hold
     C                     MOVELWL0050    WUG0TX    P      New Customer Ho
     C                     Z-ADDWL0051    #CEIDT           Requested Deliv
     C                     Z-ADDWL0052    #CAFTM           Requested Deliv
     C                     MOVELWL0053    WUG0TX    P      Accounts Receiv
     C                     MOVELWL0054    WUG0TX    P      Accounts Receiv
     C                     Z-ADDWL0055    WUUCNB           Load ID
     C                     Z-ADDWL0056    WUNFNN           Absorbed Freigh
     C                     Z-ADDWL0057    WUNFNN           Rated Freight
     C                     MOVELWL0058    WUG0TX    P      LTL Flag
     C                     MOVELWL0059    WUG0TX    P      Price Audit
     C                     MOVELWL0060    WUG0TX    P      Price Status
     C                     MOVELWL0061    YL0007    P      Shipping Method
     C                     MOVELWL0062    WUG0TX    P      Export Status
     C                     MOVELWL0063    WUG0TX    P      Palletize
     C                     MOVELWL0064    WUG0TX    P      Shrink Wrap
     C                     MOVELWL0065    WUG0TX    P      Slip Sheet
     C                     MOVELWL0066    WUG0TX    P      Age Code
     C                     Z-ADDWL0067    WUNFNN           Reefer Temperat
     C                     MOVELWL0068    WUG0TX    P      Load Type
     C                     Z-ADDWL0069    WUNFNN           Attach to Invoi
     C                     MOVELWL0070    WUG0TX    P      Load Plan Order
     C                     MOVELWL0071    WUG0TX    P      Print Pick Slip
     C                     Z-ADDWL0072    WUNFNN           Resell Referenc
     C                     MOVELWL0073    WUG0TX    P      Special Comment
     C                     MOVELWL0074    WUG0TX    P      Special Comment
     C                     MOVELWL0075    WUG0TX    P      Affect Auto Acc
     C                     MOVELWL0076    WUG0TX    P      Sales Route Cod
     C                     MOVELWL0077    WUG0TX    P      Manager Level C
     C                     MOVELWL0078    WUG0TX    P      VP Level Code
     C                     Z-ADDWL0079    WUNFNN           Attach to Order
     C                     MOVELWL0080    WUG0TX    P      Reason for Pric
     C                     Z-ADDWL0081    WUNFNN           Invoice Number
     C                     MOVELWL0082    WUG0TX    P      Invoice Suffix
     C                     Z-ADDWL0083    WUNFNN           Invoice Date
     C                     MOVELWL0084    WUG0TX    P      Event Code
     C                     MOVELWL0085    WUG0TX    P      Trans Contol AS
     C                     MOVELWL0086    WUG0TX    P      Modified Flag
     C                     Z-ADDWL0087    WUNFNN           A/R order Value
     C                     MOVELWL0088    WUG0TX    P      Billing Activit
     C                     MOVELWL0089    WUG0TX    P      Block Order Fla
     C                     MOVELWL0090    WUG0TX    P      Order Certifica
     C                     MOVELWL0091    WUG0TX    P      EDI Status 1
     C                     MOVELWL0092    WUG0TX    P      EDI Status 2
     C                     MOVELWL0093    WUG0TX    P      EDI Status 3
      * VAL Load Exist        RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0094           Load ID
     C                     EXSR SIRVGN
      * ** Only use order info if order has not been reassigned   C000395
      * ** Only use order SSD if Load SSD is zeros            C000395
      * CASE:
      *  - c1 AND (c2 ORc3) OR c4
      *   |- c1    : CTL.Scheduled Ship Date is not entered
      *   |- c2    : CTL.Load ID EQ WRK.USR Load ID
      *   |- c3    : CTL.Load ID is Blank
      *   |- c4    : PGM.*Return code is *Record does not exist
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CAODT    IFEQ *ZERO                      *IF
     C                     MOVEL'0'       Y0CX02  1
     C           #2RMNB    IFEQ WUUCNB                     *IF
     C           #2RMNB    OREQ *ZERO                      *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDYL0006    #CAODT           Scheduled Ship
     C                     END                             *FI
      * ** Only use order shipping method if load is blanks   C000395
      * CASE:
      *  - c1 AND (c2 OR c3) OR c4
      *   |- c1    : CTL.Shipping Method EQ LCL.Blank for 3          USR
      *   |- c2    : CTL.Load ID EQ WRK.USR Load ID
      *   |- c3    : CTL.Load ID is Blank
      *   |- c4    : PGM.*Return code is *Record does not exist
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CQ2CD    IFEQ YL0008                     *IF
     C                     MOVEL'0'       Y0CX02  1
     C           #2RMNB    IFEQ WUUCNB                     *IF
     C           #2RMNB    OREQ *ZERO                      *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVELYL0007    #CQ2CD           Shipping Method
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Put retrieved company number into the ctl co# field
     C                     Z-ADDWUBNC3    #2AIC3           Company Number
      * RTV All Hdr flds b/ord RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2C4NB    WL0006           Order Number
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    YN0009           Company Number
     C                     MOVELWL0007    WUG0TX    P      Order Type - Sa
     C                     Z-ADDWL0008    WUNFNN           A/R Customer Nu
     C                     Z-ADDWL0009    WUNFNN           Ship To Custome
     C                     MOVELWL0010    #CBRTX    P      Ship To Name
     C                     MOVELWL0011    WUG0TX    P      Ship To Address
     C                     MOVELWL0012    WUG0TX    P      Ship To Address
     C                     MOVELWL0013    WUG0TX    P      Ship To Address
     C                     MOVELWL0014    #CHNNA    P      Ship To City
     C                     MOVELWL0015    #CDBCD    P      Ship To State C
     C                     MOVELWL0016    WUG0TX    P      Ship To Zip/Pos
     C                     Z-ADDWL0017    WUNFNN           Bill to Custome
     C                     MOVELWL0018    WUG0TX    P      Bill to Name
     C                     MOVELWL0019    WUG0TX    P      Bill to Address
     C                     MOVELWL0020    WUG0TX    P      Bill to Address
     C                     MOVELWL0021    WUG0TX    P      Bill to Address
     C                     MOVELWL0022    WUG0TX    P      Bill to City
     C                     MOVELWL0023    WUG0TX    P      Bill to State C
     C                     MOVELWL0024    WUG0TX    P      Bill to Zip/Pos
     C                     MOVELWL0025    WUG0TX    P      Customer Purcha
     C                     Z-ADDWL0026    WUNFNN           Order Date
     C                     Z-ADDWL0027    WUNFNN           Requested Ship
     C                     Z-ADDWL0028    WUNFNN           Actual Shipped
     C                     Z-ADDWL0029    WUNFNN           Cancel Date
     C                     MOVELWL0030    WUG0TX    P      Terms Code
     C                     MOVELWL0031    WUG0TX    P      Special Instruc
     C                     MOVELWL0032    WUG0TX    P      Special Instruc
     C                     MOVELWL0033    WUG0TX    P      Carrier Code
     C                     MOVELWL0034    WUG0TX    P      Comment Print A
     C                     MOVELWL0035    WUG0TX    P      Comment Print I
     C                     MOVELWL0036    WUG0TX    P      Comment Print P
     C                     MOVELWL0037    WUG0TX    P      Comment Print S
     C                     MOVELWL0038    WUG0TX    P      Reason Code
     C                     MOVELWL0039    WUG0TX    P      Order in Use
     C                     MOVELWL0040    #CGWST    P      Header Status
     C                     MOVELWL0041    WUG0TX    P      Header Status L
     C                     MOVELWL0042    WUG0TX    P      Order Type Prin
     C                     Z-ADDWL0043    YL0006           Scheduled Ship
     C                     MOVELWL0044    WUG0TX    P      User Original E
     C                     Z-ADDWL0045    WUNFNN           Date of Origina
     C                     Z-ADDWL0046    WUNFNN           Order Value Tot
     C                     Z-ADDWL0047    WUNFNN           Order Weight To
     C                     MOVELWL0048    #CXIST    P      Credit Hold
     C                     MOVELWL0049    #CXJST    P      Production Hold
     C                     MOVELWL0050    WUG0TX    P      New Customer Ho
     C                     Z-ADDWL0051    #CEIDT           Requested Deliv
     C                     Z-ADDWL0052    #CAFTM           Requested Deliv
     C                     MOVELWL0053    WUG0TX    P      Accounts Receiv
     C                     MOVELWL0054    WUG0TX    P      Accounts Receiv
     C                     Z-ADDWL0055    WUUCNB           Load ID
     C                     Z-ADDWL0056    WUNFNN           Absorbed Freigh
     C                     Z-ADDWL0057    WUNFNN           Rated Freight
     C                     MOVELWL0058    WUG0TX    P      LTL Flag
     C                     MOVELWL0059    WUG0TX    P      Price Audit
     C                     MOVELWL0060    WUG0TX    P      Price Status
     C                     MOVELWL0061    YL0007    P      Shipping Method
     C                     MOVELWL0062    WUG0TX    P      Export Status
     C                     MOVELWL0063    WUG0TX    P      Palletize
     C                     MOVELWL0064    WUG0TX    P      Shrink Wrap
     C                     MOVELWL0065    WUG0TX    P      Slip Sheet
     C                     MOVELWL0066    WUG0TX    P      Age Code
     C                     Z-ADDWL0067    WUNFNN           Reefer Temperat
     C                     MOVELWL0068    WUG0TX    P      Load Type
     C                     Z-ADDWL0069    WUNFNN           Attach to Invoi
     C                     MOVELWL0070    WUG0TX    P      Load Plan Order
     C                     MOVELWL0071    WUG0TX    P      Print Pick Slip
     C                     Z-ADDWL0072    WUNFNN           Resell Referenc
     C                     MOVELWL0073    WUG0TX    P      Special Comment
     C                     MOVELWL0074    WUG0TX    P      Special Comment
     C                     MOVELWL0075    WUG0TX    P      Affect Auto Acc
     C                     MOVELWL0076    WUG0TX    P      Sales Route Cod
     C                     MOVELWL0077    WUG0TX    P      Manager Level C
     C                     MOVELWL0078    WUG0TX    P      VP Level Code
     C                     Z-ADDWL0079    WUNFNN           Attach to Order
     C                     MOVELWL0080    WUG0TX    P      Reason for Pric
     C                     Z-ADDWL0081    WUNFNN           Invoice Number
     C                     MOVELWL0082    WUG0TX    P      Invoice Suffix
     C                     Z-ADDWL0083    WUNFNN           Invoice Date
     C                     MOVELWL0084    WUG0TX    P      Event Code
     C                     MOVELWL0085    WUG0TX    P      Trans Contol AS
     C                     MOVELWL0086    WUG0TX    P      Modified Flag
     C                     Z-ADDWL0087    WUNFNN           A/R order Value
     C                     MOVELWL0088    WUG0TX    P      Billing Activit
     C                     MOVELWL0089    WUG0TX    P      Block Order Fla
     C                     MOVELWL0090    WUG0TX    P      Order Certifica
     C                     MOVELWL0091    WUG0TX    P      EDI Status 1
     C                     MOVELWL0092    WUG0TX    P      EDI Status 2
     C                     MOVELWL0093    WUG0TX    P      EDI Status 3
      * VAL Load Exist        RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0094           Load ID
     C                     EXSR SIRVGN
      * ** Only use order info if order has not been reassigned   C000395
      * ** Only use order SSD if Load SSD is zeros            C000395
      * CASE:
      *  - c1 AND (c2 OR c3) OR c4
      *   |- c1    : CTL.Scheduled Ship Date is not entered
      *   |- c2    : CTL.Load ID EQ WRK.USR Load ID
      *   |- c3    : CTL.Load ID is Blank
      *   |- c4    : PGM.*Return code is *Record does not exist
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CAODT    IFEQ *ZERO                      *IF
     C                     MOVEL'0'       Y0CX02  1
     C           #2RMNB    IFEQ WUUCNB                     *IF
     C           #2RMNB    OREQ *ZERO                      *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDYL0006    #CAODT           Scheduled Ship
     C                     END                             *FI
      * ** Only use order shipping method if load is blanks   C000395
      * CASE:
      *  - c1 AND (c2 OR c3) OR c4
      *   |- c1    : CTL.Shipping Method EQ LCL.Blank for 3          USR
      *   |- c2    : CTL.Load ID EQ WRK.USR Load ID
      *   |- c3    : CTL.Load ID is Blank
      *   |- c4    : PGM.*Return code is *Record does not exist
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CQ2CD    IFEQ YL0008                     *IF
     C                     MOVEL'0'       Y0CX02  1
     C           #2RMNB    IFEQ WUUCNB                     *IF
     C           #2RMNB    OREQ *ZERO                      *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVELYL0007    #CQ2CD           Shipping Method
     C                     END                             *FI
     C                     END                             *FI
      * Load Order information (if needed) (Warehouse)
      * CASE: CTL.Order Number NE WRK.ZERO
     C           #2C4NB    IFNE WUW0NB                     *IF
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
     C                     EXSR SJRVGN
     C                     END                             *FI
      * Set up create date/time positioners
      * CASE: PAR.USR View Option is View New
     C           P3UMST    IFEQ 'N'                        *IF
     C                     Z-ADDP1K4DT    #2K4DT           Created Date
     C                     Z-ADDP1A1TM    #2A1TM           Created Time
     C                     Z-ADDP1DXNB    #2DXNB           Sequence Number
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     #2K4DT           Created Date
     C                     Z-ADD*ZERO     #2A1TM           Created Time
     C                     Z-ADD*ZERO     #2DXNB           Sequence Number
     C                     END                             *FI
      * CTL.Condition Name 10 USR = Condition name of PAR.USR View Option
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1476173   Y2LSNO  70       List number
     C                     PARM P3UMST    W0INVL 25        USR View Option
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #CIXTX    PARM           W0CNNM 25        Condition Name
      *
      * Position DBF file
     C           KPOS      KLIST
     C                     KFLD           LHRMNB           Load ID
     C                     KFLD           LHRVNB           Stop/Drop
     C                     KFLD           LHC4NB           Order Number
     C                     KFLD           LHK4DT           Created Date
     C                     KFLD           LHA1TM           Created Time
     C                     KFLD           LHDXNB           Sequence Number
      * Setup key
     C                     Z-ADD#2RMNB    LHRMNB
     C                     Z-ADD#2RVNB    LHRVNB
     C                     Z-ADD#2C4NB    LHC4NB
     C                     Z-ADD#2K4DT    LHK4DT
     C                     Z-ADD#2A1TM    LHA1TM
     C                     Z-ADD#2DXNB    LHDXNB
     C           KPOS      SETLL@LHCPOT
     C           KRST      KLIST
     C                     KFLD           LHRMNB           Load ID
     C                     KFLD           LHRVNB           Stop/Drop
     C                     KFLD           LHC4NB           Order Number
      * Setup key
     C                     Z-ADD#2RMNB    LHRMNB
     C                     Z-ADD#2RVNB    LHRVNB
     C                     Z-ADD#2C4NB    LHC4NB
     C           KRST      READE@LHCPOT                8782*82=EOF
      * Save previous selector values
     C           *LIKE     DEFN #2RVST    WZRVST
     C                     MOVEL#2RVST    WZRVST           Load Change Typ
     C           *LIKE     DEFN #2K4DT    WZK4DT
     C                     MOVEL#2K4DT    WZK4DT           Created Date
     C           *LIKE     DEFN #2A1TM    WZA1TM
     C                     MOVEL#2A1TM    WZA1TM           Created Time
     C           *LIKE     DEFN #2DXNB    WZDXNB
     C                     MOVEL#2DXNB    WZDXNB           Sequence Number
     C           *LIKE     DEFN #2RMNB    WZRMNB
     C                     MOVEL#2RMNB    WZRMNB           Load ID
     C           *LIKE     DEFN #2RVNB    WZRVNB
     C                     MOVEL#2RVNB    WZRVNB           Stop/Drop
     C           *LIKE     DEFN #2C4NB    WZC4NB
     C                     MOVEL#2C4NB    WZC4NB           Order Number
     C           *LIKE     DEFN #2AIC3    WZAIC3
     C                     MOVEL#2AIC3    WZAIC3           Company Number
      * Load subfile page
     C                     Z-ADD0         ##RROK  50
     C                     EXSR BBLDSF
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@LHCPOT                  90*
     C  N82                READ @LHCPOT                  90*
     C                     END
      *
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
      * Reset count of DBF records read
     C                     Z-ADD0         ##RRRD  90
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next SFL page until SFL page full, or
      * Scan limit reached
     C           *IN82     DOWEQ'0'                        DO
     C           ##RROK    ANDLT##SFLN
     C           ##RRRD    ANDLTW0SLM
      * Check selection fields - if fail, read next record
     C           #2AIC3    IFNE *ZERO                      Company Number
     C           LHAIC3    CABNE#2AIC3    BB020            Company Number
     C                     END
      * Load SFL fields
     C                     EXSR MBFL#1
     C                     MOVEL'Y'       W0RSL   1
      * Allow for possible *Set Cursor processing
     C                     ADD  1         ##RR
      * USER: Initialize subfile record from DBF record
      * Match Order Number
      * CASE: DB1.Order Number NE CTL.Order Number
     C           LHC4NB    IFNE #2C4NB                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Only department control code of TRF (Traffic) is displayed
      * CASE: DB1.Department Control Code is Traffic Dept
     C           LHUJST    IFEQ 'TRF'                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Record selected processing-Condition Name of Change Type
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * RCD.Condition Desc. 1  USR = Condition name of DB1.Load Change Ty
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1463079   Y2LSNO  70       List number
     C                     PARM LHRVST    W0INVL 25        Load Change Typ
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #RHLTX    PARM           W0CNNM 25        Condition Desc.
      *
     C                     END                             *FI
      * 3.06.02  If Date Change Type, reverse the values
      * CASE: DB1.Load Change Type is Date changes
     C           LHRVST    IFEQ @CN,002                    *IF
     C           LHRVST    OREQ @CN,003
     C           LHRVST    OREQ @CN,004
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00012
     C           ZQ        ORGT 00012
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTLHMNTX:ZQ WUEZTX    P  90  USR Work Field
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00012
     C           ZQ        ORGT 00012
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTLHMNTX:ZQ WUT5TX    P  90  Month (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00012
     C           ZQ        ORGT 00012
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTLHMNTX:ZQ WUT6TX    P  90  Day   (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WUT5TX    CAT  WUT6TX:ZQ WUZ7TX    P      Text USR 4
     C                     Z-ADD*ZERO     ZQ      50
     C           WUZ7TX    CAT  WUEZTX:ZQ #1MNTX    P      Change Log Prio
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00012
     C           ZQ        ORGT 00012
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTLHMOTX:ZQ WUEZTX    P  90  USR Work Field
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00012
     C           ZQ        ORGT 00012
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTLHMOTX:ZQ WUT5TX    P  90  Month (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00012
     C           ZQ        ORGT 00012
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTLHMOTX:ZQ WUT6TX    P  90  Day   (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WUT5TX    CAT  WUT6TX:ZQ WUZ7TX    P      Text USR 4
     C                     Z-ADD*ZERO     ZQ      50
     C           WUZ7TX    CAT  WUEZTX:ZQ #1MOTX    P      Change Log New
     C                     END                             *FI
     C                     SUB  1         ##RR
      * DBF record not selected
     C           W0RSL     CABNE'Y'       BB020
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Output to subfile
     C                     ADD  1         ##RR
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * Increment scan check count
     C                     ADD  1         ##RRRD
     C           KRST      READE@LHCPOT                  82*82=EOF
     C                     END                             OD 1 - ##SFPG
      *................................................................
     C           BB900     TAG
      *................................................................
      * If no DBF records found, display error message
     C           ##RR      IFEQ *ZERO
     C           *IN82     ANDEQ'1'
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI ##RR = *ZERO
      *
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      * If scan limit reached, display error message
     C           ##RRRD    IFGE W0SLM
      * Send message '*Scan limit reached'
     C                     MOVEL'Y2U0017' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     ELSE
     C                     Z-ADD0         ##RROK
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     SETOF                       8392*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
     C           YPMTFD    IFNE *BLANKS
     C           YPMRRN    ANDEQ*ZERO
     C                     GOTO DAEXIT
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process subfile control (Pre-confirm)
      * F13=Next Order
      * CASE: CTL.*CMD key is *Next Order
     C           *IN13     IFEQ '1'                        *IF
     C                     Z-ADD#2C4NB    P1C4NB           Order Number
     C                     Z-ADD#2RVNB    P1RVNB           Stop/Drop
      * RTV Next/Prev Order    XF - Load Order Change Log  * 
     C                     CALL 'PDAPXFR'              90  RTV Next/Prev O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2K4DT    WQ0008  70       Created Date
     C                     PARM #2A1TM    WQ0009  60       Created Time
     C                     PARM #2DXNB    WQ0010  30       Sequence Number
     C                     PARM #2RMNB    WQ0011  70       Load ID
     C           #2RVNB    PARM #2RVNB    WQ0012  50       Stop/Drop
     C                     PARM #2AIC3    WQ0013  30       Company Number
     C           #2C4NB    PARM #2C4NB    WQ0014  70       Order Number
     C                     PARM 'N'       WQ0015  1        USR Next/Previo
     C           WURTN     PARM *BLANK    WQ0016  7        *Return code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDAPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.*Return code is *Record does not exist
     C           WURTN     IFEQ @CN,001                    *IF
      * Send message 'No more orders available'
     C                     MOVEL'USR2522' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * F14=Previous Order
      * CASE: CTL.*CMD key is *Prev Order
     C           *IN14     IFEQ '1'                        *IF
      * CASE: Starting stop/order
      *  - c1 AND c2
      *   |- c1    : CTL.Order Number EQ PAR.USR Order Number
      *   |- c2    : CTL.Stop/Drop EQ PAR.USR Stop/Drop
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #2C4NB    IFEQ P3MPNB                     *IF
     C           #2RVNB    IFEQ P3                         *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Send message 'No more orders available'
     C                     MOVEL'USR2522' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#2C4NB    P1C4NB           Order Number
     C                     Z-ADD#2RVNB    P1RVNB           Stop/Drop
      * RTV Next/Prev Order    XF - Load Order Change Log  * 
     C                     CALL 'PDAPXFR'              90  RTV Next/Prev O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2K4DT    WQ0017  70       Created Date
     C                     PARM #2A1TM    WQ0018  60       Created Time
     C                     PARM #2DXNB    WQ0019  30       Sequence Number
     C                     PARM #2RMNB    WQ0020  70       Load ID
     C           #2RVNB    PARM #2RVNB    WQ0021  50       Stop/Drop
     C                     PARM #2AIC3    WQ0022  30       Company Number
     C           #2C4NB    PARM #2C4NB    WQ0023  70       Order Number
     C                     PARM 'P'       WQ0024  1        USR Next/Previo
     C           WURTN     PARM *BLANK    WQ0025  7        *Return code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDAPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL*BLANK    WURTN            *Return code
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * F15=Accept Load
      * CASE: CTL.*CMD key is *Accept Load
     C           *IN15     IFEQ '1'                        *IF
      * VAL Load Exist        RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0094           Load ID
     C                     EXSR SIRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Validate Abs Frt Rate before Accepting Load    5/16/01
      * RTV Chk Abs Frt Rt /Ld RT - Order Header TRG  * 
     C                     EXSR SLRVGN
      * RTV Export Status      RT - Order Header TRG  * 
     C                     EXSR SMRVGN
      * CLC Deadline Date/Time XF - Load Detail  * 
     C                     CALL 'PMP9XFR'              90  CLC Deadline Da
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2RMNB    WQ0026  70       Load ID
     C           WUKZDT    PARM WUKZDT    WQ0027  70       Deadline Depart
     C           WUAXTM    PARM *ZERO     WQ0028  60       Deadline Depart
     C           YL0011    PARM *ZERO     WQ0029  70       Requested Deliv
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMP9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * ** Check flag = Yes if Abs Frt is zeros
      * Rtv Plant Co/Org      XF - Company Defaults Internal  * 
     C                     CALL 'PMOVXFR'              90  Rtv Plant Co/Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0030  30       Company Number
     C           P4YISX    PARM *BLANK    WQ0031  1        Plant Company S
     C           P4YJSX    PARM *BLANK    WQ0032  1        Company Organiz
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMOVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PAR.Company Organization is High Plains Biodiesel
     C           P4YJSX    IFEQ 'H'                        *IF
     C                     MOVEL'N'       YL0009           USR Check Y/N S
     C                     END                             *FI
      * If not Buyers Truck, error if Abs Frt is zeros-else Fax to Carrie
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.USR Check Y/N Status is yes
      *   |- c2    : CTL.Shipping Method is Prepaid
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0009    IFEQ 'Y'                        *IF
     C           #CQ2CD    IFEQ 'PR'                       *IF
     C           #CQ2CD    OREQ 'PT'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           YL0010    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVELYL0010    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0001           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0001           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Freight Rate is 0 for cst'
     C                     MOVEL'USR3051' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Only process prepaid loads, not collect (skip Dailys,HPB,Expor
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.Shipping Method is Prepaid
      *   |- c2    : PAR.Company Organization is Seaboard
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CQ2CD    IFEQ 'PR'                       *IF
     C           #CQ2CD    OREQ 'PT'
     C           P4YJSX    IFEQ 'S'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ** Don't accept if zero miles, (skip if export)      FP1251(E0005
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : WRK.Deadline Departure Date is not entered
      *   |- c2    : WRK.Export Status is Not Yes
      *   |- c3    : CTL.Header Status is Not cancelled
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUKZDT    IFEQ *ZERO                      *IF
     C           WUU2ST    IFEQ *BLANK                     *IF
     C           WUU2ST    OREQ 'N'
     C           #CGWST    IFEQ 'L'                        *IF
     C           #CGWST    OREQ 'A'
     C           #CGWST    OREQ 'C'
     C           #CGWST    OREQ 'R'
     C           #CGWST    OREQ 'E'
     C           #CGWST    OREQ 'H'
     C           #CGWST    OREQ 'I'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Send message 'Mileage Between Cities NF'
     C                     MOVEL'USR2457' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CHG Load Accept Flag   CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0095           Load ID
     C                     MOVEL'A'       WL0096    P      Load Acceptance
     C                     Z-ADDWUKZDT    WL0097           Deadline Depart
     C                     Z-ADDWUAXTM    WL0098           Deadline Depart
     C                     EXSR SNCHRC
      * CHG Deadline Date/Time RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0099           Load ID
     C                     Z-ADD*ZERO     WL0100           Stop/Drop Seque
     C                     Z-ADDWUKZDT    WL0101           Deadline Depart
     C                     Z-ADDWUAXTM    WL0102           Deadline Depart
     C                     EXSR SORVGN
     C                     MOVEL'ACCEPT'  WURVST           Load Change Typ
     C                     MOVEL'A'       WURMST           Load Acceptance
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPARC
     C                     Z-ADD#2RMNB    PARMNB           Load ID
     C                     Z-ADD*ZERO     PARVNB           Stop/Drop
     C                     MOVELWURVST    PARVST    P      Load Change Typ
     C                     MOVEL'TRF'     PAUJST    P      Department Cont
     C                     MOVELP3RMST    PAMNTX    P      Change Log Prio
     C                     MOVELWURMST    PAMOTX    P      Change Log New
     C                     MOVEL##USR     PAAYNA    P      User Id
     C                     MOVEL##JOB     PAA0NA    P      Job Name
     C                     MOVEL#CR6CD    PABZNA    P      Carrier Code
     C                     Z-ADD#2AIC3    PAAIC3           Company Number
     C                     Z-ADD*ZERO     PAC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WUB8ST           Status - Y or N
      * RTV Export Fields New  RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0103           Load ID
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0104    YL0012    P      Transloader Car
     C                     MOVELWL0105    YL0013    P      Carrier Code
     C                     MOVELWL0106    YN0010    P      Export Status
     C                     MOVELWL0107    YN0011    P      Shipping Line
     C                     MOVELWL0108    YN0012    P      Port Delv Termi
     C                     MOVELWL0109    YN0013    P      Vessel Name
     C                     Z-ADDWL0110    YN0014           Voyage
     C                     Z-ADDWL0111    YN0015           Sail Date
     C                     MOVELWL0112    YN0016    P      Booking Number
     C                     MOVELWL0113    YN0017    P      Discharge Port
     C                     Z-ADDWL0114    YN0018           Arrival Date
     C                     MOVELWL0115    YN0019    P      Container Numbe
     C                     Z-ADDWL0116    YN0020           Date In
     C                     Z-ADDWL0117    YN0021           Time In
     C                     Z-ADDWL0118    YN0022           Date Out
     C                     Z-ADDWL0119    YN0023           Time Out
      * RTV OHE fields-*ALL    RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0120           Company Number
     C                     Z-ADD#2C4NB    WL0121           Order Number
     C                     Z-ADD#2RMNB    WL0122           Load ID
     C                     Z-ADD*ZERO     WL0123           Stop/Drop Seque
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0124    YL0014    P      Shipping Line
     C                     MOVELWL0125    YN0012    P      Port Delv Termi
     C                     MOVELWL0126    YN0024    P      OHE City
     C                     MOVELWL0127    YN0025    P      OHE Vessel/Airl
     C                     MOVELWL0128    YN0026    P      OHE Voyage/Flig
     C                     MOVELWL0129    YN0027    P      OHE Booking Num
     C                     MOVELWL0130    YN0028    P      OHE Discharge P
     C                     Z-ADDWL0131    YN0029           OHE Sail/Flight
     C                     Z-ADDWL0132    YN0030           OHE Port Cut Da
     C                     Z-ADDWL0133    YN0031           OHE Arrival Dat
     C                     MOVELWL0134    YN0032    P      OHE Late Delive
     C                     MOVELWL0135    YN0033    P      OHE Ship Status
     C                     MOVELWL0136    YN0034    P      OHE Container N
     C                     MOVELWL0137    YN0035    P      OHE Comment 1
     C                     MOVELWL0138    YN0036    P      OHE Comment 2
     C                     Z-ADDWL0139    YN0037           OHE Unused Numb
     C                     Z-ADDWL0140    YN0038           OHE Unused Numb
     C                     Z-ADDWL0141    YN0039           OHE Unused Numb
     C                     Z-ADDWL0142    YN0040           OHE Unused Numb
     C                     Z-ADDWL0143    YN0041           OHE HPB RIN Equ
     C                     Z-ADDWL0144    YN0042           OHE HPB RIN Pri
     C                     Z-ADDWL0145    YN0043           Transload Termi
     C                     Z-ADDWL0146    YN0044           OHE Est Arrv at
     C                     Z-ADDWL0147    YN0045           OHE Backhaul ET
     C                     Z-ADDWL0148    YN0046           OHE Port/Pier P
     C                     Z-ADDWL0149    YN0047           OHE Actual Ship
     C                     MOVELWL0150    YL0015    P      OHE Carrier SCA
     C                     MOVELWL0151    YN0048    P      OHE Spot Buy
     C                     MOVELWL0152    YN0049    P      OHE PO ACK Flag
     C                     MOVELWL0153    YN0050    P      OHE Override Ty
     C                     MOVELWL0154    YN0051    P      OHE Backhaul St
     C                     MOVELWL0155    YN0052    P      OHE Backhaul ET
     C                     MOVELWL0156    YN0053    P      OHE Load Haul T
     C                     MOVELWL0157    YN0054    P      OHE Backhaul Ca
     C                     MOVELWL0158    YN0055    P      OHE Bookings Co
     C                     MOVELWL0159    YN0056    P      OHE EDI Error R
     C                     Z-ADDWL0160    YN0057           HPB COA Batch N
     C                     MOVELWL0161    YN0058    P      Delivery P.O. N
     C                     MOVELWL0162    YN0059    P      OHE Intended fo
     C                     MOVELWL0163    YN0060    P      OHE EDI 943 Act
     C                     MOVELWL0164    YN0061    P      OHE EDI 944 Act
     C                     MOVELWL0165    YN0062    P      OHE EDI 940 Act
     C                     MOVELWL0166    YN0063    P      OHE EDI 945 Act
     C                     MOVELWL0167    YN0064    P      OHE Transload S
     C                     MOVELWL0168    YN0065    P      OHE Abs Rate Ov
     C                     MOVELWL0169    YN0066    P      OHE Appt Confir
     C                     MOVELWL0170    YN0067    P      OHE Backhaul Co
     C                     MOVELWL0171    YN0068    P      OHE Backhaul Ch
     C                     MOVELWL0172    YN0069    P      OHE Transload C
     C                     MOVELWL0173    YN0070    P      OHE Pier Pass I
     C                     MOVELWL0174    YN0071    P      OHE Carrier Nm
     C                     MOVELWL0175    YN0072    P      OHE Appt Confir
     C                     MOVELWL0176    YN0073    P      OHE Backhaul Co
     C                     MOVELWL0177    YN0074    P      Letter of Credi
     C                     Z-ADDWL0178    YN0075           OHE Backhaul Re
     C                     Z-ADDWL0179    YN0076           LD Stop/Drop
     C                     Z-ADDWL0180    YN0077           OHE Unused Numb
     C                     Z-ADDWL0181    YN0078           OHE Pier Pass F
     C                     Z-ADDWL0182    YN0079           OHE Port Check
     C                     Z-ADDWL0183    YN0080           OHE Port Cut Ti
     C                     Z-ADDWL0184    YN0081           OHE Backhaul Tr
     C                     Z-ADDWL0185    YN0082           OHE Load Sched
     C                     Z-ADDWL0186    YN0083           Original Appoin
     C                     Z-ADDWL0187    YN0084           Original Appoin
     C                     Z-ADDWL0188    YN0085           OHE PowerPro Lo
     C                     Z-ADDWL0189    YN0086           OHE PowerPro Lo
     C                     Z-ADDWL0190    YN0087           OHE Unused Nume
     C                     Z-ADDWL0191    YN0088           OHE Orig ABS Fr
     C                     MOVELWL0192    YN0089    P      EDI Status 1
     C                     MOVELWL0193    YN0090    P      EDI Status 2
     C                     MOVELWL0194    YN0091    P      EDI Status 3
     C                     MOVELWL0195    YN0092    P      Record Status
     C                     Z-ADDWL0196    YN0093           Job Time
     C                     MOVELWL0197    YN0094    P      User Id
     C                     MOVELWL0198    YN0095    P      Job Name
     C                     Z-ADDWL0199    YN0096           Job Date
      * PMT Fax Load Confirmtn PV - Load Header  * 
     C                     CALL 'POICPVR'              90  PMT Fax Load Co
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2RMNB    WQ0033  70       Load ID
     C                     PARM #2AIC3    WQ0034  30       Company Number
     C                     PARM YL0012    WQ0035  3        Transloader Car
     C                     PARM #CR6CD    WQ0036  3        Carrier Code
     C                     PARM YL0014    WQ0037  3        Shipping Line
     C                     PARM YL0015    WQ0038  4        OHE Carrier SCA
     C           WUB8ST    PARM WUB8ST    WQ0039  1        Status - Y or N
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POICPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * ** Flag if this is an SSI PowerPro acceptance event
      * CASE: WRK.Load Change Type is SSI Reporting Changes
     C           WURVST    IFEQ @CN,005                    *IF
     C           WURVST    OREQ @CN,006
     C           WURVST    OREQ @CN,007
     C           WURVST    OREQ @CN,008
     C           WURVST    OREQ @CN,009
     C           WURVST    OREQ @CN,010
     C           WURVST    OREQ @CN,011
     C                     MOVEL'Y'       WUD4ST           USR Flag 1
     C                     END                             *FI
      * ** Send to PowerPro if "Download to SSI" is "Yes"
      * CASE: WRK.FAX DTL Status 1 is Yes
     C           WUTCSX    IFEQ 'Y'                        *IF
      * RTV SSI Carrier flag   RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#CR6CD    WL0200    P      Carrier Code
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0201    WUUNUS    P      SSI Download Fl
      * ** if this is an SSI Carrier, download info to PowerPro
      * CASE: WRK.SSI Download Flag is Yes, Download to SSI
     C           WUUNUS    IFEQ 'Y'                        *IF
      * ** Only send selected Load Change Types
      * CASE: WRK.USR Flag 1 is Yes
     C           WUD4ST    IFEQ 'Y'                        *IF
      * RTV SSI Fax'd Flag     RT - Load Header  * 
     C                     EXSR SVRVGN
      * ** Determine if Add or Change
      * CASE:
      *  - c1 OR c2
      *   |- c1    : WRK.Fax Sent to SSI Carrier is No, not Fax'd to Carr
      *   |- c2    : WRK.Fax Sent to SSI Carrier is Blanks
      *   '-
     C           WURUSX    IFEQ 'N'                        *IF
     C           WURUSX    OREQ *BLANK                     *OR
     C                     MOVEL'00'      WUAHST           SSI Add, Chg, D
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'04'      WUAHST           SSI Add, Chg, D
     C                     END                             *FI
      * BLD SSI Download       XF - SSI Control  * 
     C                     CALL 'PNPNXFR'              90  BLD SSI Downloa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2RMNB    WQ0040  70       Load ID
     C                     PARM #CR6CD    WQ0041  3        Carrier Code
     C                     PARM WUAHST    WQ0042  2        SSI Add, Chg, D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNPNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CHG Fax'd to SSI flag  CH - Load Header  * 
     C                     EXSR SWCHRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Accept if ctl.shipping method is Collect
      * CHG Load Accept Flag   CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0095           Load ID
     C                     MOVEL'A'       WL0096    P      Load Acceptance
     C                     Z-ADDWUKZDT    WL0097           Deadline Depart
     C                     Z-ADDWUAXTM    WL0098           Deadline Depart
     C                     EXSR SNCHRC
      * CHG Deadline Date/Time RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0099           Load ID
     C                     Z-ADD*ZERO     WL0100           Stop/Drop Seque
     C                     Z-ADDWUKZDT    WL0101           Deadline Depart
     C                     Z-ADDWUAXTM    WL0102           Deadline Depart
     C                     EXSR SORVGN
     C                     MOVEL'A'       WURMST           Load Acceptance
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPARC
     C                     Z-ADD#2RMNB    PARMNB           Load ID
     C                     Z-ADD*ZERO     PARVNB           Stop/Drop
     C                     MOVEL'ACCEPT'  PARVST    P      Load Change Typ
     C                     MOVEL'TRF'     PAUJST    P      Department Cont
     C                     MOVELP3RMST    PAMNTX    P      Change Log Prio
     C                     MOVELWURMST    PAMOTX    P      Change Log New
     C                     MOVEL##USR     PAAYNA    P      User Id
     C                     MOVEL##JOB     PAA0NA    P      Job Name
     C                     MOVEL#CR6CD    PABZNA    P      Carrier Code
     C                     Z-ADD#2AIC3    PAAIC3           Company Number
     C                     Z-ADD*ZERO     PAC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       WUB8ST           Status - Y or N
      * RTV Export Fields New  RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0103           Load ID
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0104    YL0012    P      Transloader Car
     C                     MOVELWL0105    YL0013    P      Carrier Code
     C                     MOVELWL0106    YN0010    P      Export Status
     C                     MOVELWL0107    YN0011    P      Shipping Line
     C                     MOVELWL0108    YN0012    P      Port Delv Termi
     C                     MOVELWL0109    YN0013    P      Vessel Name
     C                     Z-ADDWL0110    YN0014           Voyage
     C                     Z-ADDWL0111    YN0015           Sail Date
     C                     MOVELWL0112    YN0016    P      Booking Number
     C                     MOVELWL0113    YN0017    P      Discharge Port
     C                     Z-ADDWL0114    YN0018           Arrival Date
     C                     MOVELWL0115    YN0019    P      Container Numbe
     C                     Z-ADDWL0116    YN0020           Date In
     C                     Z-ADDWL0117    YN0021           Time In
     C                     Z-ADDWL0118    YN0022           Date Out
     C                     Z-ADDWL0119    YN0023           Time Out
      * RTV OHE fields-*ALL    RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0120           Company Number
     C                     Z-ADD#2C4NB    WL0121           Order Number
     C                     Z-ADD#2RMNB    WL0122           Load ID
     C                     Z-ADD*ZERO     WL0123           Stop/Drop Seque
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0124    YL0014    P      Shipping Line
     C                     MOVELWL0125    YN0012    P      Port Delv Termi
     C                     MOVELWL0126    YN0024    P      OHE City
     C                     MOVELWL0127    YN0025    P      OHE Vessel/Airl
     C                     MOVELWL0128    YN0026    P      OHE Voyage/Flig
     C                     MOVELWL0129    YN0027    P      OHE Booking Num
     C                     MOVELWL0130    YN0028    P      OHE Discharge P
     C                     Z-ADDWL0131    YN0029           OHE Sail/Flight
     C                     Z-ADDWL0132    YN0030           OHE Port Cut Da
     C                     Z-ADDWL0133    YN0031           OHE Arrival Dat
     C                     MOVELWL0134    YN0032    P      OHE Late Delive
     C                     MOVELWL0135    YN0033    P      OHE Ship Status
     C                     MOVELWL0136    YN0034    P      OHE Container N
     C                     MOVELWL0137    YN0035    P      OHE Comment 1
     C                     MOVELWL0138    YN0036    P      OHE Comment 2
     C                     Z-ADDWL0139    YN0037           OHE Unused Numb
     C                     Z-ADDWL0140    YN0038           OHE Unused Numb
     C                     Z-ADDWL0141    YN0039           OHE Unused Numb
     C                     Z-ADDWL0142    YN0040           OHE Unused Numb
     C                     Z-ADDWL0143    YN0041           OHE HPB RIN Equ
     C                     Z-ADDWL0144    YN0042           OHE HPB RIN Pri
     C                     Z-ADDWL0145    YN0043           Transload Termi
     C                     Z-ADDWL0146    YN0044           OHE Est Arrv at
     C                     Z-ADDWL0147    YN0045           OHE Backhaul ET
     C                     Z-ADDWL0148    YN0046           OHE Port/Pier P
     C                     Z-ADDWL0149    YN0047           OHE Actual Ship
     C                     MOVELWL0150    YL0015    P      OHE Carrier SCA
     C                     MOVELWL0151    YN0048    P      OHE Spot Buy
     C                     MOVELWL0152    YN0049    P      OHE PO ACK Flag
     C                     MOVELWL0153    YN0050    P      OHE Override Ty
     C                     MOVELWL0154    YN0051    P      OHE Backhaul St
     C                     MOVELWL0155    YN0052    P      OHE Backhaul ET
     C                     MOVELWL0156    YN0053    P      OHE Load Haul T
     C                     MOVELWL0157    YN0054    P      OHE Backhaul Ca
     C                     MOVELWL0158    YN0055    P      OHE Bookings Co
     C                     MOVELWL0159    YN0056    P      OHE EDI Error R
     C                     Z-ADDWL0160    YN0057           HPB COA Batch N
     C                     MOVELWL0161    YN0058    P      Delivery P.O. N
     C                     MOVELWL0162    YN0059    P      OHE Intended fo
     C                     MOVELWL0163    YN0060    P      OHE EDI 943 Act
     C                     MOVELWL0164    YN0061    P      OHE EDI 944 Act
     C                     MOVELWL0165    YN0062    P      OHE EDI 940 Act
     C                     MOVELWL0166    YN0063    P      OHE EDI 945 Act
     C                     MOVELWL0167    YN0064    P      OHE Transload S
     C                     MOVELWL0168    YN0065    P      OHE Abs Rate Ov
     C                     MOVELWL0169    YN0066    P      OHE Appt Confir
     C                     MOVELWL0170    YN0067    P      OHE Backhaul Co
     C                     MOVELWL0171    YN0068    P      OHE Backhaul Ch
     C                     MOVELWL0172    YN0069    P      OHE Transload C
     C                     MOVELWL0173    YN0070    P      OHE Pier Pass I
     C                     MOVELWL0174    YN0071    P      OHE Carrier Nm
     C                     MOVELWL0175    YN0072    P      OHE Appt Confir
     C                     MOVELWL0176    YN0073    P      OHE Backhaul Co
     C                     MOVELWL0177    YN0074    P      Letter of Credi
     C                     Z-ADDWL0178    YN0075           OHE Backhaul Re
     C                     Z-ADDWL0179    YN0076           LD Stop/Drop
     C                     Z-ADDWL0180    YN0077           OHE Unused Numb
     C                     Z-ADDWL0181    YN0078           OHE Pier Pass F
     C                     Z-ADDWL0182    YN0079           OHE Port Check
     C                     Z-ADDWL0183    YN0080           OHE Port Cut Ti
     C                     Z-ADDWL0184    YN0081           OHE Backhaul Tr
     C                     Z-ADDWL0185    YN0082           OHE Load Sched
     C                     Z-ADDWL0186    YN0083           Original Appoin
     C                     Z-ADDWL0187    YN0084           Original Appoin
     C                     Z-ADDWL0188    YN0085           OHE PowerPro Lo
     C                     Z-ADDWL0189    YN0086           OHE PowerPro Lo
     C                     Z-ADDWL0190    YN0087           OHE Unused Nume
     C                     Z-ADDWL0191    YN0088           OHE Orig ABS Fr
     C                     MOVELWL0192    YN0089    P      EDI Status 1
     C                     MOVELWL0193    YN0090    P      EDI Status 2
     C                     MOVELWL0194    YN0091    P      EDI Status 3
     C                     MOVELWL0195    YN0092    P      Record Status
     C                     Z-ADDWL0196    YN0093           Job Time
     C                     MOVELWL0197    YN0094    P      User Id
     C                     MOVELWL0198    YN0095    P      Job Name
     C                     Z-ADDWL0199    YN0096           Job Date
      * PMT Fax Load Confirmtn PV - Load Header  * 
     C                     CALL 'POICPVR'              90  PMT Fax Load Co
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2RMNB    WQ0043  70       Load ID
     C                     PARM #2AIC3    WQ0044  30       Company Number
     C                     PARM YL0012    WQ0045  3        Transloader Car
     C                     PARM #CR6CD    WQ0046  3        Carrier Code
     C                     PARM YL0014    WQ0047  3        Shipping Line
     C                     PARM YL0015    WQ0048  4        OHE Carrier SCA
     C           WUB8ST    PARM WUB8ST    WQ0049  1        Status - Y or N
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POICPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Load was deleted; change log type so only see this once.
      * Change log type to DELODA-Deleted Load Accepted
     C                     MOVEL'DELOAD'  WURVST           Load Change Typ
      * CHG Deload Log Entry   RT - Load Order Change Log  * 
     C                     EXSR SXRVGN
     C                     MOVEL##JOB     YL0025           Job Name CDE
      * PMT Fax Load Confirmtn PV - Load Header  * 
     C                     CALL 'POICPVR'              90  PMT Fax Load Co
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2RMNB    WQ0050  70       Load ID
     C                     PARM #2AIC3    WQ0051  30       Company Number
     C                     PARM YL0012    WQ0052  3        Transloader Car
     C                     PARM #CR6CD    WQ0053  3        Carrier Code
     C                     PARM YL0014    WQ0054  3        Shipping Line
     C                     PARM YL0015    WQ0055  4        OHE Carrier SCA
     C           WUB8ST    PARM WUB8ST    WQ0056  1        Status - Y or N
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POICPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * ** Flag if this is an SSI PowerPro acceptance event
      * CASE: WRK.Load Change Type is SSI Reporting Changes
     C           WURVST    IFEQ @CN,005                    *IF
     C           WURVST    OREQ @CN,006
     C           WURVST    OREQ @CN,007
     C           WURVST    OREQ @CN,008
     C           WURVST    OREQ @CN,009
     C           WURVST    OREQ @CN,010
     C           WURVST    OREQ @CN,011
     C                     MOVEL'Y'       WUD4ST           USR Flag 1
     C                     END                             *FI
      * ** Send "Deleted" record if "Download to SSI" is "Yes"
      * CASE: WRK.FAX DTL Status 1 is Yes
     C           WUTCSX    IFEQ 'Y'                        *IF
      * ** Download to SSI PowerPro if the is an SSI event
      * CASE: WRK.USR Flag 1 is Yes
     C           WUD4ST    IFEQ 'Y'                        *IF
      * ** If "Fax to Carrier" is "Y", see if "Download to SSI" is "Yes"
      * RTV SSI Carrier flag   RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#CR6CD    WL0200    P      Carrier Code
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0201    WUUNUS    P      SSI Download Fl
      * ** If a records was already downloaded to PowerPro, send a "Delet
      * ** record. If not sent to PowerPro, skip sending another record.
      * ** Check "Fax'd to Carrier" flag
      * CASE: WRK.SSI Download Flag is Yes, Download to SSI
     C           WUUNUS    IFEQ 'Y'                        *IF
     C                     MOVEL'01'      WUAHST           SSI Add, Chg, D
      * BLD SSI Download       XF - SSI Control  * 
     C                     CALL 'PNPNXFR'              90  BLD SSI Downloa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2RMNB    WQ0057  70       Load ID
     C                     PARM #CR6CD    WQ0058  3        Carrier Code
     C                     PARM WUAHST    WQ0059  2        SSI Add, Chg, D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNPNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     END                             *FI
      * F18=View Order Details
      * CASE: CTL.*CMD key is *Order Details
     C           *IN18     IFEQ '1'                        *IF
      * Only allowed if viewing an order
      * CASE: CTL.Order Number NE WRK.ZERO
     C           #2C4NB    IFNE WUW0NB                     *IF
     C                     MOVEL*BLANK    WUDNCD           Application Cod
     C                     MOVEL'OMS'     WUDNCD           Application Cod
      * DSP Ord Inquiry Detail DF - PD Order Detail  * 
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) P2DNCD' defaulted for 'Application Code'.
     C                     CALL 'PDPZDFR'              90  DSP Ord Inquiry
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0060  30       Company Number
     C                     PARM #2C4NB    WQ0061  70       Order Number
     C           WUDPNB    PARM *ZERO     WQ0062  30       Order Sequence
     C           WUUENB    PARM *ZERO     WQ0063  30       Order Secondary
     C           P2DNCD    PARM P2DNCD    WQ0064  6        Application Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPZDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Function not available'
     C                     MOVEL'USR1942' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * F20=View Load Entries
      * CASE: CTL.*CMD key is CF20
     C           *IN20     IFEQ '1'                        *IF
     C                     Z-ADD*ZERO     #2C4NB           Order Number
     C                     Z-ADD*ZERO     #2RVNB           Stop/Drop
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * F19=Toggle View
      * CASE: CTL.*CMD key is *View All/New
     C           *IN19     IFEQ '1'                        *IF
      * reset option
      * CASE: PAR.USR View Option is View New
     C           P3UMST    IFEQ 'N'                        *IF
     C                     MOVEL'A'       P3UMST           USR View Option
     C                     Z-ADD*ZERO     #2K4DT           Created Date
     C                     Z-ADD*ZERO     #2A1TM           Created Time
     C                     Z-ADD*ZERO     #2DXNB           Sequence Number
     C                     Z-ADD*ZERO     #2RVNB           Stop/Drop
     C                     Z-ADDP3MPNB    #2C4NB           Order Number
     C                     Z-ADDP3        #2RVNB           Stop/Drop
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       P3UMST           USR View Option
     C                     Z-ADDP3MPNB    #2C4NB           Order Number
     C                     Z-ADDP3        #2RVNB           Stop/Drop
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * F16=Next Load (exit)
      * CASE: CTL.*CMD key is *Next Load
     C           *IN16     IFEQ '1'                        *IF
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * Reload subfile requested
     C           W0RSF     CABEQ'Y'       DAEXIT
     C                     END
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * If error, quit processing
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         GBDSA2    BEGSR
      *================================================================
      * Set display attributes for Subfile control
      *================================================================
     C                     MOVEL'0'       *IN79
     C           P3UTST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @LHCPOT fields to subfile
      *================================================================
     C                     Z-ADDLHRMNB    #1RMNB           Load ID
     C                     Z-ADDLHRVNB    #1RVNB           Stop/Drop
     C                     Z-ADDLHC4NB    #1C4NB           Order Number
     C                     Z-ADDLHDXNB    #1DXNB           Sequence Number
     C                     MOVELLHRVST    #1RVST           Load Change Typ
     C                     MOVELLHUJST    #1UJST           Department Cont
     C                     MOVELLHA0NA    #1A0NA           Job Name
     C                     MOVELLHBZNA    #1BZNA           Carrier Code
     C                     MOVELLHXMCD    #1XMCD           Carrier Broker
     C                     Z-ADDLHAIC3    #1AIC3           Company Number
     C                     Z-ADDLHK4DT    #1K4DT           Created Date
      * Clear external version also
     C                     Z-ADD*ZERO     V1K4DT
     C                     Z-ADDLHA1TM    #1A1TM           Created Time
     C                     MOVELLHAYNA    #1AYNA           User Id
     C                     MOVELLHMNTX    #1MNTX           Change Log Prio
     C                     MOVELLHMOTX    #1MOTX           Change Log New
     C                     MOVEL*BLANK    #RHLTX           Condition Desc.
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     Z-ADDP3CLC3    #PCLC3           @Calc 3,0
     C                     MOVEL*BLANK    #2RVST           Load Change Typ
     C                     Z-ADDP1K4DT    #2K4DT           Created Date
     C                     Z-ADDP1A1TM    #2A1TM           Created Time
     C                     Z-ADDP1DXNB    #2DXNB           Sequence Number
     C                     Z-ADDP1RMNB    #2RMNB           Load ID
     C                     Z-ADD*ZERO     #CB0C3           Load Start Comp
      * Clear external version also
     C                     MOVEL*BLANK    VCB0C3
     C                     MOVEL*BLANK    #CPKST           Load Status
     C                     Z-ADD*ZERO     #CAODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     VCAODT
     C                     MOVEL*BLANK    #CR6CD           USR Carrier Cod
     C                     MOVEL*BLANK    #COGNA           USR Carrier Nam
     C                     MOVEL*BLANK    #CQ2CD           Shipping Method
     C                     Z-ADD*ZERO     #CGRWE           Gross Weight
     C                     Z-ADDP1RVNB    #2RVNB           Stop/Drop
     C                     Z-ADDP1C4NB    #2C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V2C4NB
     C                     Z-ADD*ZERO     #2AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V2AIC3
     C                     MOVEL*BLANK    #CAJCD           Warehouse Code
     C                     MOVEL*BLANK    #CBRTX           Ship To Name
     C                     Z-ADD*ZERO     #CEIDT           Requested Deliv
      * Clear external version also
     C                     Z-ADD*ZERO     VCEIDT
     C                     Z-ADD*ZERO     #CKFDT           Appointment Con
      * Clear external version also
     C                     Z-ADD*ZERO     VCKFDT
     C                     MOVEL*BLANK    #CGWST           Header Status
     C                     MOVEL*BLANK    #CXIST           Credit Hold
     C                     MOVEL*BLANK    #CXJST           Production Hold
     C                     Z-ADD*ZERO     #CRRNB           Total Stops
     C                     MOVEL*BLANK    #CHNNA           Ship To City
     C                     MOVEL*BLANK    #CDBCD           Ship To State C
     C                     Z-ADD*ZERO     #CAFTM           Requested Deliv
     C                     Z-ADD*ZERO     #CLSNX           Appointment Tim
     C                     MOVEL*BLANK    #CIXTX           Condition Name
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert Created Date to display format
      * Convert date
     C           1000000   ADD  #1K4DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1K4DT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert Load Start Company USR to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #CB0C3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#CB0C3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VCB0C3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VCB0C3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #CAODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCAODT
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V2AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  #CEIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCEIDT
      * Convert Appointment Confirm Date to display format
      * Convert date
     C           1000000   ADD  #CKFDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCKFDT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Load Header All,Co RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSA     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFJAIC3    #CB0C3           Company Number
     C                     Z-ADDFJAODT    #CAODT           Scheduled Ship
     C                     MOVELFJPJST    WUG0TX           LTL Flag
     C                     MOVELFJPKST    #CPKST           Load Status
     C                     Z-ADDFJRNNB    WUNFNN           Reefer Temperat
     C                     MOVELFJDMTX    WUG0TX           Seal 1
     C                     MOVELFJDNTX    WUG0TX           Seal 2
     C                     MOVELFJDOTX    WUG0TX           Seal 3
     C                     Z-ADDFJRPNB    WUNFNN           Total Load Orde
     C                     Z-ADDFJFLAM    WUNFNN           Flat Amount
     C                     MOVELFJXQST    WUG0TX           Allocate Pounds
     C                     Z-ADDFJRRNB    #CRRNB           Total Stops
     C                     MOVELFJDXTX    WUG0TX           Trailer Id
     C                     MOVELFJDYTX    WUG0TX           Transloader Car
     C                     Z-ADDFJSBNB    WUNFNN           BOL Time
     C                     MOVELFJBZNA    #CR6CD           Carrier Code
     C                     MOVELFJRONB    WUG0TX           Truck Size
     C                     Z-ADDFJSQNB    WUNFNN           Ld Hdr/Ld Dtl U
     C                     Z-ADDFJR1NB    WUNFNN           Rated Freight
     C                     MOVELFJVCST    WUG0TX           Ship Status
     C                     MOVELFJVDST    WUG0TX           Load Type
     C                     Z-ADDFJSDNB    WUNFNN           Number Pallets
     C                     Z-ADDFJPAOU    WUNFNN           Number Pallets
     C                     Z-ADDFJDGWG    WUNFNN           Load Carrier Pa
     C                     Z-ADDFJSXNB    WUNFNN           Estimated Arriv
     C                     Z-ADDFJHADT    WUNFNN           Actual Arrival
     C                     Z-ADDFJAART    WUNFNN           Actual Arrival
     C                     Z-ADDFJDHWG    WUNFNN           Trailer IN Weig
     C                     Z-ADDFJDIWG    WUNFNN           Trailer OUT Wei
     C                     Z-ADDFJAQDT    WUNFNN           Actual Departur
     C                     Z-ADDFJS6NB    WUNFNN           Departure Time
     C                     Z-ADDFJT4NB    WUNFNN           Schedule Sequen
     C                     Z-ADDFJPRTM    WUNFNN           Product Tempera
     C                     Z-ADDFJNPSV    WUNFNN           Number Spacers
     C                     MOVELFJJ8TX    WUG0TX           Car/Veh. Initia
     C                     Z-ADDFJTLMI    WUNFNN           Total Load Mile
     C                     MOVELFJJ9TX    WUG0TX           Recorder ID
     C                     MOVELFJQ2CD    #CQ2CD           Shipping Method
     C                     MOVELFJVPCD    WUG0TX           Ship From Wareh
     C                     MOVELFJDBCD    #CDBCD           Ship To State C
     C                     Z-ADDFJGRWE    #CGRWE           Gross Weight
     C                     MOVELFJXCCD    WUG0TX           Carrier Broker
     C                     MOVELFJU2ST    WUG0TX           Export Status
     C                     Z-ADDFJF9DT    WUNFNN           Actual Ship Dat
     C                     MOVELFJONTM    WUG0TX           On Time - (Y/N)
     C                     Z-ADDFJJ4DT    WUNFNN           Truck Ready Dat
     C                     Z-ADDFJTRTM    WUNFNN           Truck Ready Tim
     C                     Z-ADDFJJ5DT    WUNFNN           Spotted Date
     C                     Z-ADDFJSPTM    WUNFNN           Spotted Time
     C                     Z-ADDFJJ6DT    WUNFNN           Load Finished D
     C                     Z-ADDFJLFTM    WUNFNN           Load Finished T
     C                     Z-ADDFJJ7DT    WUNFNN           BOL Complete Da
     C                     Z-ADDFJBOTM    WUNFNN           BOL Complete Ti
     C                     Z-ADDFJJ8DT    WUNFNN           BOL Received Da
     C                     Z-ADDFJBLTM    WUNFNN           BOL Received Ti
     C                     Z-ADDFJKIDT    WUNFNN           Truck Departure
     C                     Z-ADDFJASTM    WUNFNN           Truck Departure
     C                     Z-ADDFJKADT    WUNFNN           Adjusted Depart
     C                     Z-ADDFJAJCM    WUNFNN           Adjusted Depart
     C                     MOVELFJXACD    WUG0TX           Shipping Line
     C                     MOVELFJOANA    WUG0TX           Port Delv Termi
     C                     MOVELFJK4TX    WUG0TX           Vessel Name
     C                     Z-ADDFJVOAG    WUNFNN           Voyage
     C                     Z-ADDFJKBDT    WUNFNN           Sail Date
     C                     MOVELFJNBBO    WUG0TX           Booking Number
     C                     MOVELFJW4CD    WUG0TX           Discharge Port
     C                     Z-ADDFJEFDT    WUNFNN           Arrival Date
     C                     MOVELFJCNTN    WUG0TX           Container Numbe
     C                     Z-ADDFJKCDT    WUNFNN           Date In
     C                     Z-ADDFJTMIN    WUNFNN           Time In
     C                     Z-ADDFJKDDT    WUNFNN           Date Out
     C                     Z-ADDFJVMNB    WUNFNN           Time Out
     C                     Z-ADDFJOCFR    WUNFNN           Load Total Frei
     C                     Z-ADDFJKJDT    WUNFNN           Scheduled Deliv
     C                     Z-ADDFJATTM    WUNFNN           Scheduled Deliv
     C                     MOVELFJOTRS    WUG0TX           LH Unused Sts
     C                     MOVELFJRMST    P3RMST           Load Acceptance
     C                     Z-ADDFJKKDT    WUNFNN           On Yard Date
     C                     Z-ADDFJAVTM    WUNFNN           On Yard Time
     C                     Z-ADDFJKZDT    WUNFNN           Deadline Depart
     C                     Z-ADDFJAXTM    WUNFNN           Deadline Depart
     C                     GOTO SAEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV GrsWgt w/PltTr Ld RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         WUA7WG           USR Weight Accu
      * CASE: PAR.Load Status is Shipped or Invoiced
     C           #CPKST    IFEQ 'I'                        *IF
     C           #CPKST    OREQ 'S'
      * RTV Pallet/Tare        RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0001           Load ID
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0002    YL0001           Pallets Loaded
     C                     Z-ADDWL0003    YL0002           Avg Pallet Tare
     C                     Z-ADDWL0004    YL0003           Tot Pallet Tare
     C                     END                             *FI
      * ***** Change log and comments
     C                     EXSR UASUBR                     ***** Change lo
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQSB01           Load ID
      * Define keylist
     C           KPSSB     KLIST
     C                     KFLD           WQSB01           Load ID
     C                     KFLD           FLRUNB           Stop/Drop Seque
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    WQSB01           Load ID
     C                     Z-ADD*ZERO     FLRUNB           Stop/Drop Seque
      * Establish starting position
     C           KPSSB     SETLL@FLCPBW                    *
     C           KRSSB     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * 01/18/10 PKD E000261 SEND in LCL.Avg Pallet Tare
      * RTV Gross Wgt/Qty     XF - Order Detail  * 
     C                     CALL 'PQPQXFR'              90  RTV Gross Wgt/Q
     C                     PARM *BLANK    W0RTN   7
     C                     PARM FLAIC3    WQ0001  30       Company Number
     C                     PARM FLC4NB    WQ0002  70       Order Number
     C                     PARM 0         WQ0003  30       Order Sequence
     C                     PARM 0         WQ0004  30       Order Secondary
     C           WUA7WG    PARM WUA7WG    WQ0005 112       USR Weight Accu
     C           YL0004    PARM YL0004    WQ0006 112       Order Quantity
     C                     PARM YL0002    WQ0007  92       Avg Pallet Tare
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PQPQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C           KRSSB     READE@FLCPBW                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: PAR.Load Status is Shipped or Invoiced
     C           #CPKST    IFEQ 'I'                        *IF
     C           #CPKST    OREQ 'S'
      * RTV Pallet/Tare        RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLRMNB    WL0001           Load ID
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0002    YL0001           Pallets Loaded
     C                     Z-ADDWL0003    YL0002           Avg Pallet Tare
     C                     Z-ADDWL0004    YL0003           Tot Pallet Tare
     C                     ADD  YL0003    WUA7WG           USR Weight Accu
     C                     END                             *FI
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Pallet/Tare        RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDWL0001    FJRMNB           Load ID
      * Establish starting position
     C           KRSSC     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFJKNNX    WL0002           Pallets Loaded
     C                     Z-ADDFJICWG    WL0003           Avg Pallet Tare
     C                     Z-ADDFJIDWG    WL0004           Tot Pallet Tare
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Carr Appt Dt/Tm   RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WARMNB    WQSD02           Load ID
     C           *LIKE     DEFN WAC4NB    WQSD03           Order Number
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD02           Load ID
     C                     KFLD           WQSD03           Order Number
      * Setup key
     C                     Z-ADD#2RMNB    WQSD02           Load ID
     C                     Z-ADD#2C4NB    WQSD03           Order Number
      * Establish starting position
     C           KRSSD     SETLL@FLCPKF                    *
     C           KRSSD     READE@FLCPKF                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWAN7DT    #CKFDT           Appointment Con
     C                     Z-ADDWAB3TM    YL0005           Appointment Con
     C                     GOTO SDEXIT                     *QUIT
     C           KRSSD     READE@FLCPKF                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Carrier Code       RT - Load Order Change Log  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBRMNB    WQSE02           Load ID
     C           *LIKE     DEFN WBRVST    WQSE03           Load Change Typ
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE02           Load ID
     C                     KFLD           WQSE03           Load Change Typ
      * Setup key
     C                     Z-ADD#2RMNB    WQSE02           Load ID
     C                     MOVELWURVST    WQSE03           Load Change Typ
      * Establish starting position
     C           KRSSE     SETLL@LHCPO4                    *
     C           KRSSE     READE@LHCPO4                  90*
      * Data record not found
     C   90                MOVEL'USR2471' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBBZNA    #CR6CD           Carrier Code
     C           KRSSE     READE@LHCPO4                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Carrier Name       RT - OM Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           FFBZNA           Carrier Code
      * Setup key
     C                     MOVEL#CR6CD    FFBZNA           Carrier Code
      * Establish starting position
     C           KRSSF     CHAIN@FFREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #COGNA           Name
     C                     MOVEL*BLANK    WUG0TX           Record Status
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFFADTX    #COGNA           Name
     C                     MOVELFFVSST    WUG0TX           Record Status
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Co#-Dltd/trnsfd OrdRT - Load Order Change Log  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCRMNB    WQSG01           Load ID
     C           *LIKE     DEFN WCC4NB    WQSG02           Order Number
     C           *LIKE     DEFN WCRVST    WQSG03           Load Change Typ
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Load ID
     C                     KFLD           WQSG02           Order Number
     C                     KFLD           WQSG03           Load Change Typ
      * Setup key
     C                     Z-ADDP1RMNB    WQSG01           Load ID
     C                     Z-ADDP1C4NB    WQSG02           Order Number
     C                     MOVEL'DELOAD'  WQSG03           Load Change Typ
      * Establish starting position
     C           KRSSG     SETLL@LHCPHB                    *
     C           KRSSG     READE@LHCPHB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2471' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUBNC3           Company Number
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     Z-ADDWCAIC3    WUBNC3           Company Number
     C                     GOTO SGEXIT                     *QUIT
     C           KRSSG     READE@LHCPHB                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV All Hdr flds b/ord RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BEC4NB    WQSH01           Order Number
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Order Number
      * Setup key
     C                     Z-ADDWL0006    WQSH01           Order Number
      * Establish starting position
     C           KRSSH     SETLL@BFCPY2                    *
     C           KRSSH     READE@BFCPY2                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBEAIC3    WL0005           Company Number
     C                     MOVELBEJNCD    WL0007           Order Type - Sa
     C                     Z-ADDBEANC7    WL0008           A/R Customer Nu
     C                     Z-ADDBEBKC7    WL0009           Ship To Custome
     C                     MOVELBEBRTX    WL0010           Ship To Name
     C                     MOVELBEHMNA    WL0011           Ship To Address
     C                     MOVELBEHONA    WL0012           Ship To Address
     C                     MOVELBEHPNA    WL0013           Ship To Address
     C                     MOVELBEHNNA    WL0014           Ship To City
     C                     MOVELBEDBCD    WL0015           Ship To State C
     C                     MOVELBECKTX    WL0016           Ship To Zip/Pos
     C                     Z-ADDBEB0C7    WL0017           Bill to Custome
     C                     MOVELBEAETX    WL0018           Bill to Name
     C                     MOVELBEB1NA    WL0019           Bill to Address
     C                     MOVELBEB3NA    WL0020           Bill to Address
     C                     MOVELBEB4NA    WL0021           Bill to Address
     C                     MOVELBEB2NA    WL0022           Bill to City
     C                     MOVELBEBHCD    WL0023           Bill to State C
     C                     MOVELBEC8TX    WL0024           Bill to Zip/Pos
     C                     MOVELBEBCNA    WL0025           Customer Purcha
     C                     Z-ADDBEA0DT    WL0026           Order Date
     C                     Z-ADDBEA5DT    WL0027           Requested Ship
     C                     Z-ADDBEGNDT    WL0028           Actual Shipped
     C                     Z-ADDBEACDT    WL0029           Cancel Date
     C                     MOVELBEAQCD    WL0030           Terms Code
     C                     MOVELBEB6NA    WL0031           Special Instruc
     C                     MOVELBEBYNA    WL0032           Special Instruc
     C                     MOVELBEBZNA    WL0033           Carrier Code
     C                     MOVELBEGTST    WL0034           Comment Print A
     C                     MOVELBEGVST    WL0035           Comment Print I
     C                     MOVELBEGUST    WL0036           Comment Print P
     C                     MOVELBEQFST    WL0037           Comment Print S
     C                     MOVELBECQCD    WL0038           Reason Code
     C                     MOVELBEGJST    WL0039           Order in Use
     C                     MOVELBEGWST    WL0040           Header Status
     C                     MOVELBEGXST    WL0041           Header Status L
     C                     MOVELBEGYST    WL0042           Order Type Prin
     C                     Z-ADDBEAODT    WL0043           Scheduled Ship
     C                     MOVELBEAIVN    WL0044           User Original E
     C                     Z-ADDBECXDT    WL0045           Date of Origina
     C                     Z-ADDBEJZVA    WL0046           Order Value Tot
     C                     Z-ADDBEA1WG    WL0047           Order Weight To
     C                     MOVELBEXIST    WL0048           Credit Hold
     C                     MOVELBEXJST    WL0049           Production Hold
     C                     MOVELBEXKST    WL0050           New Customer Ho
     C                     Z-ADDBEEIDT    WL0051           Requested Deliv
     C                     Z-ADDBEAFTM    WL0052           Requested Deliv
     C                     MOVELBEE8CD    WL0053           Accounts Receiv
     C                     MOVELBEE9CD    WL0054           Accounts Receiv
     C                     Z-ADDBERMNB    WL0055           Load ID
     C                     Z-ADDBETBNB    WL0056           Absorbed Freigh
     C                     Z-ADDBER1NB    WL0057           Rated Freight
     C                     MOVELBEPJST    WL0058           LTL Flag
     C                     MOVELBEU0ST    WL0059           Price Audit
     C                     MOVELBEU1ST    WL0060           Price Status
     C                     MOVELBEQ2CD    WL0061           Shipping Method
     C                     MOVELBEU2ST    WL0062           Export Status
     C                     MOVELBEVEST    WL0063           Palletize
     C                     MOVELBEVFST    WL0064           Shrink Wrap
     C                     MOVELBEVGST    WL0065           Slip Sheet
     C                     MOVELBERPCD    WL0066           Age Code
     C                     Z-ADDBERNNB    WL0067           Reefer Temperat
     C                     MOVELBEVDST    WL0068           Load Type
     C                     Z-ADDBEATIN    WL0069           Attach to Invoi
     C                     MOVELBEU4ST    WL0070           Load Plan Order
     C                     MOVELBEU5ST    WL0071           Print Pick Slip
     C                     Z-ADDBERSRN    WL0072           Resell Referenc
     C                     MOVELBEMHNA    WL0073           Special Comment
     C                     MOVELBEMINA    WL0074           Special Comment
     C                     MOVELBEWBST    WL0075           Affect Auto Acc
     C                     MOVELBER4CD    WL0076           Sales Route Cod
     C                     MOVELBEBFCD    WL0077           Manager Level C
     C                     MOVELBEQ4CD    WL0078           VP Level Code
     C                     Z-ADDBET3NB    WL0079           Attach to Order
     C                     MOVELBESICD    WL0080           Reason for Pric
     C                     Z-ADDBECONB    WL0081           Invoice Number
     C                     MOVELBECEST    WL0082           Invoice Suffix
     C                     Z-ADDBEAWDT    WL0083           Invoice Date
     C                     MOVELBEJPCD    WL0084           Event Code
     C                     MOVELBEXUST    WL0085           Trans Contol AS
     C                     MOVELBEZ1ST    WL0086           Modified Flag
     C                     Z-ADDBEVRVA    WL0087           A/R order Value
     C                     MOVELBEOBST    WL0088           Billing Activit
     C                     MOVELBEBCST    WL0089           Block Order Fla
     C                     MOVELBEBDST    WL0090           Order Certifica
     C                     MOVELBEUVST    WL0091           EDI Status 1
     C                     MOVELBEUWST    WL0092           EDI Status 2
     C                     MOVELBEUXST    WL0093           EDI Status 3
     C           KRSSH     READE@BFCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * VAL Load Exist        RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDWL0094    FJRMNB           Load ID
      * Establish starting position
     C           KRSSI     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SIEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSJ01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSJ02           Order Number
      * Define keylist
     C           KPSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Order Number
      * Setup key
     C                     Z-ADD#2AIC3    WQSJ01           Company Number
     C                     Z-ADD#2C4NB    WQSJ02           Order Number
     C                     Z-ADD*ZERO     OMDPNB           Order Sequence
     C                     Z-ADD*ZERO     OMUENB           Order Secondary
      * Establish starting position
     C           KPSSJ     SETLL@BGWKAE                    *
     C           KRSSJ     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #CAJCD           Warehouse Code
     C                     MOVEL*BLANK    WUG0TX           Trans Contol AS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Warehouse Control  RT - Warehouse  * 
     C                     EXSR SKRVGN
      * PAR = DB1 By name
     C                     MOVELOMAJCD    #CAJCD           Warehouse Code
     C                     GOTO SJEXIT                     *QUIT
     C           KRSSJ     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Warehouse Control  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELOMAJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSK     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUG0TX           Trans Contol AS
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADXUST    WUG0TX           Trans Contol AS
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Chk Abs Frt Rt /Ld RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
     C                     MOVEL*BLANK    YL0009           USR Check Y/N S
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDRMNB    WQSL02           Load ID
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL02           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    WQSL02           Load ID
      * Establish starting position
     C           KRSSL     SETLL@BFCPD9                    *
     C           KRSSL     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Absorbed Freight Rate is EQ Zeros
     C           WDTBNB    IFEQ 0                          *IF
     C                     MOVEL'Y'       YL0009           USR Check Y/N S
     C                     Z-ADDWDBKC7    YL0010           Ship To Custome
     C                     GOTO SLEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSL     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Export Status      RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    WUU2ST           Export Status
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
      * Setup key
     C                     Z-ADD#2AIC3    WEAIC3           Company Number
     C                     Z-ADD#2C4NB    WEC4NB           Order Number
      * Establish starting position
     C           KRSSM     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEU2ST    WUU2ST           Export Status
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNCHRC    BEGSR
      *================================================================
      * CHG Load Accept Flag   CH - Load Header  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  30       Company Number
     C                     Z-ADD*ZERO     WN0002  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0003  1        LTL Flag
     C                     MOVEL*BLANK    WN0004  1        Load Status
     C                     Z-ADD*ZERO     WN0005  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0006 15        Seal 1
     C                     MOVEL*BLANK    WN0007 15        Seal 2
     C                     MOVEL*BLANK    WN0008 15        Seal 3
     C                     MOVEL*BLANK    WN0009 15        Seal 4
     C                     MOVEL*BLANK    WN0010 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0011  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0012 112       Flat Amount
     C                     MOVEL*BLANK    WN0013  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0014  50       Total Stops
     C                     MOVEL*BLANK    WN0015 20        Trailer Id
     C                     MOVEL*BLANK    WN0016  3        Transloader Car
     C                     Z-ADD*ZERO     WN0017  40       BOL Time
     C                     MOVEL*BLANK    WN0018  3        Carrier Code
     C                     MOVEL*BLANK    WN0019  7        Truck Size
     C                     Z-ADD*ZERO     WN0020  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0021 112       Rated Freight
     C                     MOVEL*BLANK    WN0022  1        Ship Status
     C                     MOVEL*BLANK    WN0023  1        Load Type
     C                     Z-ADD*ZERO     WN0024  50       Number Pallets
     C                     Z-ADD*ZERO     WN0025  50       Number Pallets
     C                     Z-ADD*ZERO     WN0026 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0027  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0028  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0029  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0030 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0031 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0032  70       Actual Departur
     C                     Z-ADD*ZERO     WN0033  40       Departure Time
     C                     Z-ADD*ZERO     WN0034  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0035  52       Product Tempera
     C                     Z-ADD*ZERO     WN0036  50       Number Spacers
     C                     MOVEL*BLANK    WN0037 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0038  70       Total Load Mile
     C                     MOVEL*BLANK    WN0039 12        Recorder ID
     C                     MOVEL*BLANK    WN0040  2        Shipping Method
     C                     MOVEL*BLANK    WN0041  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0042  2        Ship To State C
     C                     Z-ADD*ZERO     WN0043  70       Gross Weight
     C                     MOVEL*BLANK    WN0044  3        Carrier Broker
     C                     MOVEL*BLANK    WN0045  1        Export Status
     C                     Z-ADD*ZERO     WN0046  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0047  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0048  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0049  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0050  70       Spotted Date
     C                     Z-ADD*ZERO     WN0051  60       Spotted Time
     C                     Z-ADD*ZERO     WN0052  70       Load Finished D
     C                     Z-ADD*ZERO     WN0053  60       Load Finished T
     C                     Z-ADD*ZERO     WN0054  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0055  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0056  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0057  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0058  70       Truck Departure
     C                     Z-ADD*ZERO     WN0059  60       Truck Departure
     C                     Z-ADD*ZERO     WN0060  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0061  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0062  3        Shipping Line
     C                     MOVEL*BLANK    WN0063 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0064 30        Vessel Name
     C                     Z-ADD*ZERO     WN0065  50       Voyage
     C                     Z-ADD*ZERO     WN0066  70       Sail Date
     C                     MOVEL*BLANK    WN0067 12        Booking Number
     C                     MOVEL*BLANK    WN0068 20        Discharge Port
     C                     Z-ADD*ZERO     WN0069  70       Arrival Date
     C                     MOVEL*BLANK    WN0070 12        Container Numbe
     C                     Z-ADD*ZERO     WN0071  70       Date In
     C                     Z-ADD*ZERO     WN0072  60       Time In
     C                     Z-ADD*ZERO     WN0073  70       Date Out
     C                     Z-ADD*ZERO     WN0074  60       Time Out
     C                     Z-ADD*ZERO     WN0075 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0076  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0077  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0078  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0079  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0080  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0081  70       Requested Deliv
     C                     MOVEL*BLANK    WN0082  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0083  70       On Yard Date
     C                     Z-ADD*ZERO     WN0084  60       On Yard Time
     C                     MOVEL*BLANK    WN0085  1        Load Held Over
     C                     MOVEL*BLANK    WN0086  1        Load Held Over
     C                     MOVEL*BLANK    WN0087 15        Load Held Over
     C                     MOVEL*BLANK    WN0088 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0089 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0090  70       Express Mail Da
     C                     MOVEL*BLANK    WN0091  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0092  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0093  70       Product Complet
     C                     Z-ADD*ZERO     WN0094  60       Product Complet
     C                     Z-ADD*ZERO     WN0095  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0096  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0097  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0098  1        Load Confirmed
     C                     MOVEL*BLANK    WN0099 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0100  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0101  60       Load Door 1
     C                     Z-ADD*ZERO     WN0102  70       Override Total
     C                     Z-ADD*ZERO     WN0103  60       Load Door 2
     C                     MOVEL*BLANK    WN0104  1        Partial Load
     C                     MOVEL*BLANK    WN0105  1        Load Confirmati
     C                     MOVEL*BLANK    WN0106  1        Export Load USD
     C                     MOVEL*BLANK    WN0107  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0108 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0109 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0110 15        Late Billing Em
     C                     MOVEL*BLANK    WN0111 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0112 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0113  1        Multi Company L
     C                     MOVEL*BLANK    WN0114  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0115  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0116  1        LH Power Only L
     C                     MOVEL*BLANK    WN0117  1        MG Created Load
     C                     MOVEL*BLANK    WN0118  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0119  2        Load U/M
     C                     MOVEL*BLANK    WN0120  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0121  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0122  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0123  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0124  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0125  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0126  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0127  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0128  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0129  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0130  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0131  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0132  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0133  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0134  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0135  60       LH Unused Time
     C                     MOVEL*BLANK    WN0136  1        EDI Status 1
     C                     MOVEL*BLANK    WN0137  1        EDI Status 2
     C                     MOVEL*BLANK    WN0138  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0139  60       Job Time
     C                     MOVEL*BLANK    WN0140 10        User Id
     C                     MOVEL*BLANK    WN0141 10        Job Name
     C                     Z-ADD*ZERO     WN0142  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWL0095    WFRMNB           Load ID
      *
     C           KLCHSN    KLIST
     C                     KFLD           WFRMNB           Load ID
     C           KLCHSN    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YARDCS
      * Move non-key fields to @FJCPBO
     C                     MOVELWL0096    WFRMST    P      Load Acceptance
     C                     Z-ADDWL0097    WFKZDT           Deadline Depart
     C                     Z-ADDWL0098    WFAXTM           Deadline Depart
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##PGM     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * CHG Deadline Date/Time RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQSO01           Load ID
      * Define keylist
     C           KPSSO     KLIST
     C                     KFLD           WQSO01           Load ID
     C                     KFLD           FLRUNB           Stop/Drop Seque
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Load ID
      * Setup key
     C                     Z-ADDWL0099    WQSO01           Load ID
     C                     Z-ADDWL0100    FLRUNB           Stop/Drop Seque
      * Establish starting position
     C           KPSSO     SETLL@FLCPBW                    *
     C           KRSSO     READE@FLCPBW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SOEXIT                     *QUIT
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Deadline Date/Time CH - Load Detail  * 
     C                     EXSR SPCHRC
     C           KRSSO     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCHRC    BEGSR
      *================================================================
      * CHG Deadline Date/Time CH - Load Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0143  50       Stop/Drop
     C                     MOVEL*BLANK    WN0144 30        Comments for Pi
     C                     Z-ADD*ZERO     WN0145  50       Miles to next s
     C                     Z-ADD*ZERO     WN0146  72       Freight Charge
     C                     Z-ADD*ZERO     WN0147  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0148 112       Freight Misc. C
     C                     Z-ADD*ZERO     WN0149  72       Freight Stop Ch
     C                     Z-ADD*ZERO     WN0150 112       Rated Freight
     C                     Z-ADD*ZERO     WN0151  30       Company Number
     C                     Z-ADD*ZERO     WN0152  70       Order Number
     C                     MOVEL*BLANK    WN0153  1        Ship Status
     C                     Z-ADD*ZERO     WN0154  70       Estimated Arriv
     C                     Z-ADD*ZERO     WN0155  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0156  70       Appointment Con
     C                     Z-ADD*ZERO     WN0157  60       Appointment Con
     C                     MOVEL*BLANK    WN0158 30        Confirmation Ma
     C                     MOVEL*BLANK    WN0159 10        Confirmation Nu
     C                     Z-ADD*ZERO     WN0160  70       Actual Delivery
     C                     Z-ADD*ZERO     WN0161  60       Actual Delivery
     C                     Z-ADD*ZERO     WN0162  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0163  60       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0164  70       On Yard Date
     C                     Z-ADD*ZERO     WN0165  60       On Yard Time
     C                     Z-ADD*ZERO     WN0166  70       MPC Number
     C                     MOVEL*BLANK    WN0167  1        Load Dtl On Tim
     C                     MOVEL*BLANK    WN0168  1        On Time Add'l R
     C                     MOVEL*BLANK    WN0169 15        Seal Nbr 1
     C                     MOVEL*BLANK    WN0170 15        Seal Nbr 2
     C                     MOVEL*BLANK    WN0171 15        Seal Nbr 3
     C                     MOVEL*BLANK    WN0172 15        Seal Nbr 4
     C                     MOVEL*BLANK    WN0173 15        Seal Nbr 5
     C                     Z-ADD*ZERO     WN0174  70       LD Carrier Appt
     C                     Z-ADD*ZERO     WN0175  70       LD Unused Date
     C                     Z-ADD*ZERO     WN0176  70       LD Unused Date
     C                     Z-ADD*ZERO     WN0177  60       LD Carrier Appt
     C                     Z-ADD*ZERO     WN0178  60       LD Unused Time
     C                     Z-ADD*ZERO     WN0179  60       LD Unused Time
     C                     MOVEL*BLANK    WN0180  1        Miles Error Sts
     C                     MOVEL*BLANK    WN0181  1        LD Unused Sts 2
     C                     MOVEL*BLANK    WN0182  2        HPB Transload S
     C                     MOVEL*BLANK    WN0183 15        LD Cst Svc Trac
     C                     MOVEL*BLANK    WN0184 25        LD Unused Txt 2
     C                     MOVEL*BLANK    WN0185 25        LD Unused Txt 3
     C                     MOVEL*BLANK    WN0186  1        EDI Status 1
     C                     MOVEL*BLANK    WN0187  1        EDI Status 2
     C                     MOVEL*BLANK    WN0188  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0189  60       Job Time
     C                     MOVEL*BLANK    WN0190 10        User Id
     C                     MOVEL*BLANK    WN0191 10        Job Name
     C                     Z-ADD*ZERO     WN0192  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @FLCPBM
     C                     Z-ADDWL0099    WGRMNB           Load ID
     C                     Z-ADDFLRUNB    WGRUNB           Stop/Drop Seque
      *
     C           KLCHSP    KLIST
     C                     KFLD           WGRMNB           Load ID
     C                     KFLD           WGRUNB           Stop/Drop Seque
     C           KLCHSP    CHAIN@FLCPBM              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFLCPL0'MDACP
     C                     MOVEL'@FLCPBM' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFL1    YBRDCS
      * Move non-key fields to @FLCPBM
     C                     Z-ADDWL0101    WGHDDT           Deadline Depart
     C                     Z-ADDWL0102    WGAUTM           Deadline Depart
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##JOB     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@FLCPBM                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFLCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
      * Upd Deadline Dte/Tme  RT - Order Detail  * 
     C                     EXSR SQRVGN
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Upd Deadline Dte/Tme  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAIC3    WQSQ01           Company Number
     C           *LIKE     DEFN WHC4NB    WQSQ02           Order Number
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           Company Number
     C                     KFLD           WQSQ02           Order Number
      * Setup key
     C                     Z-ADDWGAIC3    WQSQ01           Company Number
     C                     Z-ADDWGC4NB    WQSQ02           Order Number
      * Establish starting position
     C           KRSSQ     SETLL@BGWKL1                    *
     C           KRSSQ     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Deadline Dte/Tme  CH - Order Detail  * 
     C                     EXSR SRCHRC
     C           KRSSQ     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRCHRC    BEGSR
      *================================================================
      * Chg Deadline Dte/Tme  CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0193  70       Item Code
     C                     MOVEL*BLANK    WN0194  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0195  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0196  70       Order Group Cod
     C                     MOVEL*BLANK    WN0197  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0198  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0199 112       Billing Detail
     C                     Z-ADD*ZERO     WN0200 112       Billing Detail
     C                     Z-ADD*ZERO     WN0201 112       Billing Detail
     C                     Z-ADD*ZERO     WN0202 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0203  1        Comment Print A
     C                     MOVEL*BLANK    WN0204  1        Comment Print I
     C                     MOVEL*BLANK    WN0205  1        Comment Print P
     C                     MOVEL*BLANK    WN0206  1        Comment Print S
     C                     Z-ADD*ZERO     WN0207 112       Extended Amount
     C                     Z-ADD*ZERO     WN0208  70       Market Pricing
     C                     MOVEL*BLANK    WN0209  3        Commodity Marke
     C                     MOVEL*BLANK    WN0210  3        Date Method Cod
     C                     MOVEL*BLANK    WN0211  3        Price Method Co
     C                     Z-ADD*ZERO     WN0212 114       Price Overage O
     C                     Z-ADD*ZERO     WN0213  70       Contract Number
     C                     MOVEL*BLANK    WN0214  1        Price Status
     C                     Z-ADD*ZERO     WN0215  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0216  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0217  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0218  1        Work Confirm St
     C                     MOVEL*BLANK    WN0219  1        Work Over/Short
     C                     MOVEL*BLANK    WN0220  1        OD Production P
     C                     MOVEL*BLANK    WN0221 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0222 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0223  1        Age Code
     C                     MOVEL*BLANK    WN0224  1        Palletize
     C                     MOVEL*BLANK    WN0225  1        Slip Sheet
     C                     MOVEL*BLANK    WN0226  1        Catch Weight St
     C                     MOVEL*BLANK    WN0227  1        Price Audit
     C                     MOVEL*BLANK    WN0228  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0229  1        Production Date
     C                     Z-ADD*ZERO     WN0230 112       Rated Freight
     C                     Z-ADD*ZERO     WN0231 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0232 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0233 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0234 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0235 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0236 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0237 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0238 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0239 114       Unit Price
     C                     Z-ADD*ZERO     WN0240 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0241 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0242 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0243 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0244  70       Requested Ship
     C                     Z-ADD*ZERO     WN0245  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0246  70       Actual Shipped
     C                     MOVEL*BLANK    WN0247  1        Affect Inventor
     C                     MOVEL*BLANK    WN0248  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0249  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0250  30       Item Structure
     C                     Z-ADD*ZERO     WN0251  30       Item Structure
     C                     Z-ADD*ZERO     WN0252  30       Item Structure
     C                     MOVEL*BLANK    WN0253  2        Item Level
     C                     MOVEL*BLANK    WN0254  2        Quality Level
     C                     MOVEL*BLANK    WN0255  2        Pricing Product
     C                     MOVEL*BLANK    WN0256  2        Season Product
     C                     Z-ADD*ZERO     WN0257  70       Date of Origina
     C                     MOVEL*BLANK    WN0258 10        User Profile Na
     C                     MOVEL*BLANK    WN0259  6        Country Code
     C                     MOVEL*BLANK    WN0260  2        Event Code
     C                     MOVEL*BLANK    WN0261  3        Reason Code
     C                     MOVEL*BLANK    WN0262  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0263  1        Modified Flag
     C                     MOVEL*BLANK    WN0264  1        Substituted Fla
     C                     MOVEL*BLANK    WN0265  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0266 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0267 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0268  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0269  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0270  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0271  1        Affect Commissi
     C                     MOVEL*BLANK    WN0272  1        Affect Pricing
     C                     MOVEL*BLANK    WN0273  1        Released by Use
     C                     MOVEL*BLANK    WN0274  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0275  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0276  3        Production Ware
     C                     MOVEL*BLANK    WN0277  3        OD Price Type
     C                     Z-ADD*ZERO     WN0278  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0279  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0280  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0281  70       OD Unused Date
     C                     Z-ADD*ZERO     WN0282  60       Price Code
     C                     Z-ADD*ZERO     WN0283  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0284  60       Substitution Li
     C                     Z-ADD*ZERO     WN0285  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0286 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0287 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0288 112       OD Item Target
     C                     Z-ADD*ZERO     WN0289 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0290 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0291 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0292 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0293 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0294 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0295 114       OD Unused Prc 5
     C                     Z-ADD*ZERO     WN0296 114       OD Unused Prc 6
     C                     Z-ADD*ZERO     WN0297 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0298 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0299  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0300  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0301  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0302 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0303  40       Item Age Days
     C                     Z-ADD*ZERO     WN0304  70       Production Ovr
     C                     Z-ADD*ZERO     WN0305  70       Production Ovr
     C                     MOVEL*BLANK    WN0306  1        OD UnUsed Statu
     C                     MOVEL*BLANK    WN0307  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0308  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0309  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0310  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0311  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0312  1        EDI Status 1
     C                     MOVEL*BLANK    WN0313  1        EDI Status 2
     C                     MOVEL*BLANK    WN0314  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0315  60       Job Time
     C                     MOVEL*BLANK    WN0316 10        User Id
     C                     MOVEL*BLANK    WN0317 10        Job Name
     C                     Z-ADD*ZERO     WN0318  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWHAIC3    WIAIC3           Company Number
     C                     Z-ADDWHC4NB    WIC4NB           Order Number
     C                     Z-ADDWHDPNB    WIDPNB           Order Sequence
     C                     Z-ADDWHUENB    WIUENB           Order Secondary
      *
     C           KLCHSR    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIC4NB           Order Number
     C                     KFLD           WIDPNB           Order Sequence
     C                     KFLD           WIUENB           Order Secondary
     C           KLCHSR    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YCRDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDWGHDDT    WINVDT           Deadline Depart
     C                     Z-ADDWGAUTM    WIBUTM           Deadline Depart
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WIAATM           Job Time
     C                     MOVEL##USR     WIAYNA           User Id
     C                     MOVEL##JOB     WIA0NA           Job Name
     C                     Z-ADD##JDT     WIAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * RTV Export Fields New  RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDWL0103    FJRMNB           Load ID
      * Establish starting position
     C           KRSSS     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0104           Transloader Car
     C                     MOVEL*BLANK    WL0105           Carrier Code
     C                     MOVEL*BLANK    WL0106           Export Status
     C                     MOVEL*BLANK    WL0107           Shipping Line
     C                     MOVEL*BLANK    WL0108           Port Delv Termi
     C                     MOVEL*BLANK    WL0109           Vessel Name
     C                     Z-ADD*ZERO     WL0110           Voyage
     C                     Z-ADD*ZERO     WL0111           Sail Date
     C                     MOVEL*BLANK    WL0112           Booking Number
     C                     MOVEL*BLANK    WL0113           Discharge Port
     C                     Z-ADD*ZERO     WL0114           Arrival Date
     C                     MOVEL*BLANK    WL0115           Container Numbe
     C                     Z-ADD*ZERO     WL0116           Date In
     C                     Z-ADD*ZERO     WL0117           Time In
     C                     Z-ADD*ZERO     WL0118           Date Out
     C                     Z-ADD*ZERO     WL0119           Time Out
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELFJDYTX    WL0104           Transloader Car
     C                     MOVELFJBZNA    WL0105           Carrier Code
     C                     MOVELFJU2ST    WL0106           Export Status
     C                     MOVELFJXACD    WL0107           Shipping Line
     C                     MOVELFJOANA    WL0108           Port Delv Termi
     C                     MOVELFJK4TX    WL0109           Vessel Name
     C                     Z-ADDFJVOAG    WL0110           Voyage
     C                     Z-ADDFJKBDT    WL0111           Sail Date
     C                     MOVELFJNBBO    WL0112           Booking Number
     C                     MOVELFJW4CD    WL0113           Discharge Port
     C                     Z-ADDFJEFDT    WL0114           Arrival Date
     C                     MOVELFJCNTN    WL0115           Container Numbe
     C                     Z-ADDFJKCDT    WL0116           Date In
     C                     Z-ADDFJTMIN    WL0117           Time In
     C                     Z-ADDFJKDDT    WL0118           Date Out
     C                     Z-ADDFJVMNB    WL0119           Time Out
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * RTV OHE fields-*ALL    RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * LJB 1/14/09 FP1303 New Delivery P.O.Number field added
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           AMAIC3           Company Number
     C                     KFLD           AMC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0120    AMAIC3           Company Number
     C                     Z-ADDWL0121    AMC4NB           Order Number
      * Establish starting position
     C           KRSST     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0124           Shipping Line
     C                     MOVEL*BLANK    WL0125           Port Delv Termi
     C                     MOVEL*BLANK    WL0126           OHE City
     C                     MOVEL*BLANK    WL0127           OHE Vessel/Airl
     C                     MOVEL*BLANK    WL0128           OHE Voyage/Flig
     C                     MOVEL*BLANK    WL0129           OHE Booking Num
     C                     MOVEL*BLANK    WL0130           OHE Discharge P
     C                     Z-ADD*ZERO     WL0131           OHE Sail/Flight
     C                     Z-ADD*ZERO     WL0132           OHE Port Cut Da
     C                     Z-ADD*ZERO     WL0133           OHE Arrival Dat
     C                     MOVEL*BLANK    WL0134           OHE Late Delive
     C                     MOVEL*BLANK    WL0135           OHE Ship Status
     C                     MOVEL*BLANK    WL0136           OHE Container N
     C                     MOVEL*BLANK    WL0137           OHE Comment 1
     C                     MOVEL*BLANK    WL0138           OHE Comment 2
     C                     Z-ADD*ZERO     WL0139           OHE Unused Numb
     C                     Z-ADD*ZERO     WL0140           OHE Unused Numb
     C                     Z-ADD*ZERO     WL0141           OHE Unused Numb
     C                     Z-ADD*ZERO     WL0142           OHE Unused Numb
     C                     Z-ADD*ZERO     WL0143           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WL0144           OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WL0145           Transload Termi
     C                     Z-ADD*ZERO     WL0146           OHE Est Arrv at
     C                     Z-ADD*ZERO     WL0147           OHE Backhaul ET
     C                     Z-ADD*ZERO     WL0148           OHE Port/Pier P
     C                     Z-ADD*ZERO     WL0149           OHE Actual Ship
     C                     MOVEL*BLANK    WL0150           OHE Carrier SCA
     C                     MOVEL*BLANK    WL0151           OHE Spot Buy
     C                     MOVEL*BLANK    WL0152           OHE PO ACK Flag
     C                     MOVEL*BLANK    WL0153           OHE Override Ty
     C                     MOVEL*BLANK    WL0154           OHE Backhaul St
     C                     MOVEL*BLANK    WL0155           OHE Backhaul ET
     C                     MOVEL*BLANK    WL0156           OHE Load Haul T
     C                     MOVEL*BLANK    WL0157           OHE Backhaul Ca
     C                     MOVEL*BLANK    WL0158           OHE Bookings Co
     C                     MOVEL*BLANK    WL0159           OHE EDI Error R
     C                     Z-ADD*ZERO     WL0160           HPB COA Batch N
     C                     MOVEL*BLANK    WL0161           Delivery P.O. N
     C                     MOVEL*BLANK    WL0162           OHE Intended fo
     C                     MOVEL*BLANK    WL0163           OHE EDI 943 Act
     C                     MOVEL*BLANK    WL0164           OHE EDI 944 Act
     C                     MOVEL*BLANK    WL0165           OHE EDI 940 Act
     C                     MOVEL*BLANK    WL0166           OHE EDI 945 Act
     C                     MOVEL*BLANK    WL0167           OHE Transload S
     C                     MOVEL*BLANK    WL0168           OHE Abs Rate Ov
     C                     MOVEL*BLANK    WL0169           OHE Appt Confir
     C                     MOVEL*BLANK    WL0170           OHE Backhaul Co
     C                     MOVEL*BLANK    WL0171           OHE Backhaul Ch
     C                     MOVEL*BLANK    WL0172           OHE Transload C
     C                     MOVEL*BLANK    WL0173           OHE Pier Pass I
     C                     MOVEL*BLANK    WL0174           OHE Carrier Nm
     C                     MOVEL*BLANK    WL0175           OHE Appt Confir
     C                     MOVEL*BLANK    WL0176           OHE Backhaul Co
     C                     MOVEL*BLANK    WL0177           Letter of Credi
     C                     Z-ADD*ZERO     WL0178           OHE Backhaul Re
     C                     Z-ADD*ZERO     WL0179           LD Stop/Drop
     C                     Z-ADD*ZERO     WL0180           OHE Unused Numb
     C                     Z-ADD*ZERO     WL0181           OHE Pier Pass F
     C                     Z-ADD*ZERO     WL0182           OHE Port Check
     C                     Z-ADD*ZERO     WL0183           OHE Port Cut Ti
     C                     Z-ADD*ZERO     WL0184           OHE Backhaul Tr
     C                     Z-ADD*ZERO     WL0185           OHE Load Sched
     C                     Z-ADD*ZERO     WL0186           Original Appoin
     C                     Z-ADD*ZERO     WL0187           Original Appoin
     C                     Z-ADD*ZERO     WL0188           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WL0189           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WL0190           OHE Unused Nume
     C                     Z-ADD*ZERO     WL0191           OHE Orig ABS Fr
     C                     MOVEL*BLANK    WL0192           EDI Status 1
     C                     MOVEL*BLANK    WL0193           EDI Status 2
     C                     MOVEL*BLANK    WL0194           EDI Status 3
     C                     MOVEL*BLANK    WL0195           Record Status
     C                     Z-ADD*ZERO     WL0196           Job Time
     C                     MOVEL*BLANK    WL0197           User Id
     C                     MOVEL*BLANK    WL0198           Job Name
     C                     Z-ADD*ZERO     WL0199           Job Date
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAMXACD    WL0124           Shipping Line
     C                     MOVELAMOANA    WL0125           Port Delv Termi
     C                     MOVELAMHBAA    WL0126           OHE City
     C                     MOVELAMJ0T1    WL0127           OHE Vessel/Airl
     C                     MOVELAMGENY    WL0128           OHE Voyage/Flig
     C                     MOVELAMJ1T1    WL0129           OHE Booking Num
     C                     MOVELAMHCAA    WL0130           OHE Discharge P
     C                     Z-ADDAMQWDT    WL0131           OHE Sail/Flight
     C                     Z-ADDAMQXDT    WL0132           OHE Port Cut Da
     C                     Z-ADDAMQYDT    WL0133           OHE Arrival Dat
     C                     MOVELAMHDAA    WL0134           OHE Late Delive
     C                     MOVELAMCCTX    WL0135           OHE Ship Status
     C                     MOVELAMJ2T1    WL0136           OHE Container N
     C                     MOVELAMRLNA    WL0137           OHE Comment 1
     C                     MOVELAMRMNA    WL0138           OHE Comment 2
     C                     Z-ADDAMGINY    WL0139           OHE Unused Numb
     C                     Z-ADDAMGFNY    WL0140           OHE Unused Numb
     C                     Z-ADDAMGGNY    WL0141           OHE Unused Numb
     C                     Z-ADDAMGHNY    WL0142           OHE Unused Numb
     C                     Z-ADDAMHEVL    WL0143           OHE HPB RIN Equ
     C                     Z-ADDAMHFVL    WL0144           OHE HPB RIN Pri
     C                     Z-ADDAMHGVL    WL0145           Transload Termi
     C                     Z-ADDAMQZDT    WL0146           OHE Est Arrv at
     C                     Z-ADDAMQ0DT    WL0147           OHE Backhaul ET
     C                     Z-ADDAMQ1DT    WL0148           OHE Port/Pier P
     C                     Z-ADDAMQ2DT    WL0149           OHE Actual Ship
     C                     MOVELAMC2TX    WL0150           OHE Carrier SCA
     C                     MOVELAMC3TX    WL0151           OHE Spot Buy
     C                     MOVELAMC6TX    WL0152           OHE PO ACK Flag
     C                     MOVELAMCHTX    WL0153           OHE Override Ty
     C                     MOVELAMCITX    WL0154           OHE Backhaul St
     C                     MOVELAMCLTX    WL0155           OHE Backhaul ET
     C                     MOVELAMB4TX    WL0156           OHE Load Haul T
     C                     MOVELAMCUTX    WL0157           OHE Backhaul Ca
     C                     MOVELAMCVTX    WL0158           OHE Bookings Co
     C                     MOVELAMB9TX    WL0159           OHE EDI Error R
     C                     Z-ADDAMITNY    WL0160           HPB COA Batch N
     C                     MOVELAMLMT1    WL0161           Delivery P.O. N
     C                     MOVELAMLWAA    WL0162           OHE Intended fo
     C                     MOVELAMFVST    WL0163           OHE EDI 943 Act
     C                     MOVELAMF0ST    WL0164           OHE EDI 944 Act
     C                     MOVELAMF2ST    WL0165           OHE EDI 940 Act
     C                     MOVELAMF3ST    WL0166           OHE EDI 945 Act
     C                     MOVELAMV3T1    WL0167           OHE Transload S
     C                     MOVELAMV4T1    WL0168           OHE Abs Rate Ov
     C                     MOVELAMV5T1    WL0169           OHE Appt Confir
     C                     MOVELAMV6T1    WL0170           OHE Backhaul Co
     C                     MOVELAMV7T1    WL0171           OHE Backhaul Ch
     C                     MOVELAMV8T1    WL0172           OHE Transload C
     C                     MOVELAMV9T1    WL0173           OHE Pier Pass I
     C                     MOVELAMWAT1    WL0174           OHE Carrier Nm
     C                     MOVELAMWBT1    WL0175           OHE Appt Confir
     C                     MOVELAMWCT1    WL0176           OHE Backhaul Co
     C                     MOVELAMWDT1    WL0177           Letter of Credi
     C                     Z-ADDAMQJNY    WL0178           OHE Backhaul Re
     C                     Z-ADDAMQKNY    WL0179           LD Stop/Drop
     C                     Z-ADDAMQLNY    WL0180           OHE Unused Numb
     C                     Z-ADDAMP8NY    WL0181           OHE Pier Pass F
     C                     Z-ADDAMP9NY    WL0182           OHE Port Check
     C                     Z-ADDAMQANY    WL0183           OHE Port Cut Ti
     C                     Z-ADDAMQCNY    WL0184           OHE Backhaul Tr
     C                     Z-ADDAMQDNY    WL0185           OHE Load Sched
     C                     Z-ADDAMQENY    WL0186           Original Appoin
     C                     Z-ADDAMQFNY    WL0187           Original Appoin
     C                     Z-ADDAMQGNY    WL0188           OHE PowerPro Lo
     C                     Z-ADDAMQHNY    WL0189           OHE PowerPro Lo
     C                     Z-ADDAMQINY    WL0190           OHE Unused Nume
     C                     Z-ADDAMQMNY    WL0191           OHE Orig ABS Fr
     C                     MOVELAMUVST    WL0192           EDI Status 1
     C                     MOVELAMUWST    WL0193           EDI Status 2
     C                     MOVELAMUXST    WL0194           EDI Status 3
     C                     MOVELAMVSST    WL0195           Record Status
     C                     Z-ADDAMAATM    WL0196           Job Time
     C                     MOVELAMAYNA    WL0197           User Id
     C                     MOVELAMA0NA    WL0198           Job Name
     C                     Z-ADDAMAXDT    WL0199           Job Date
     C                     GOTO STEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * RTV SSI Carrier flag   RT - Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           FFBZNA           Carrier Code
      * Setup key
     C                     MOVELWL0200    FFBZNA           Carrier Code
      * Establish starting position
     C           KRSSU     CHAIN@FFREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0201           SSI Download Fl
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFFUNUS    WL0201           SSI Download Fl
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * RTV SSI Fax'd Flag     RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSV     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFJRUSX    WURUSX           Fax Sent to SSI
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWCHRC    BEGSR
      *================================================================
      * CHG Fax'd to SSI flag  CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0319  30       Company Number
     C                     Z-ADD*ZERO     WN0320  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0321  1        LTL Flag
     C                     MOVEL*BLANK    WN0322  1        Load Status
     C                     Z-ADD*ZERO     WN0323  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0324 15        Seal 1
     C                     MOVEL*BLANK    WN0325 15        Seal 2
     C                     MOVEL*BLANK    WN0326 15        Seal 3
     C                     MOVEL*BLANK    WN0327 15        Seal 4
     C                     MOVEL*BLANK    WN0328 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0329  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0330 112       Flat Amount
     C                     MOVEL*BLANK    WN0331  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0332  50       Total Stops
     C                     MOVEL*BLANK    WN0333 20        Trailer Id
     C                     MOVEL*BLANK    WN0334  3        Transloader Car
     C                     Z-ADD*ZERO     WN0335  40       BOL Time
     C                     MOVEL*BLANK    WN0336  3        Carrier Code
     C                     MOVEL*BLANK    WN0337  7        Truck Size
     C                     Z-ADD*ZERO     WN0338  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0339 112       Rated Freight
     C                     MOVEL*BLANK    WN0340  1        Ship Status
     C                     MOVEL*BLANK    WN0341  1        Load Type
     C                     Z-ADD*ZERO     WN0342  50       Number Pallets
     C                     Z-ADD*ZERO     WN0343  50       Number Pallets
     C                     Z-ADD*ZERO     WN0344 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0345  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0346  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0347  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0348 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0349 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0350  70       Actual Departur
     C                     Z-ADD*ZERO     WN0351  40       Departure Time
     C                     Z-ADD*ZERO     WN0352  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0353  52       Product Tempera
     C                     Z-ADD*ZERO     WN0354  50       Number Spacers
     C                     MOVEL*BLANK    WN0355 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0356  70       Total Load Mile
     C                     MOVEL*BLANK    WN0357 12        Recorder ID
     C                     MOVEL*BLANK    WN0358  2        Shipping Method
     C                     MOVEL*BLANK    WN0359  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0360  2        Ship To State C
     C                     Z-ADD*ZERO     WN0361  70       Gross Weight
     C                     MOVEL*BLANK    WN0362  3        Carrier Broker
     C                     MOVEL*BLANK    WN0363  1        Export Status
     C                     Z-ADD*ZERO     WN0364  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0365  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0366  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0367  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0368  70       Spotted Date
     C                     Z-ADD*ZERO     WN0369  60       Spotted Time
     C                     Z-ADD*ZERO     WN0370  70       Load Finished D
     C                     Z-ADD*ZERO     WN0371  60       Load Finished T
     C                     Z-ADD*ZERO     WN0372  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0373  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0374  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0375  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0376  70       Truck Departure
     C                     Z-ADD*ZERO     WN0377  60       Truck Departure
     C                     Z-ADD*ZERO     WN0378  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0379  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0380  3        Shipping Line
     C                     MOVEL*BLANK    WN0381 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0382 30        Vessel Name
     C                     Z-ADD*ZERO     WN0383  50       Voyage
     C                     Z-ADD*ZERO     WN0384  70       Sail Date
     C                     MOVEL*BLANK    WN0385 12        Booking Number
     C                     MOVEL*BLANK    WN0386 20        Discharge Port
     C                     Z-ADD*ZERO     WN0387  70       Arrival Date
     C                     MOVEL*BLANK    WN0388 12        Container Numbe
     C                     Z-ADD*ZERO     WN0389  70       Date In
     C                     Z-ADD*ZERO     WN0390  60       Time In
     C                     Z-ADD*ZERO     WN0391  70       Date Out
     C                     Z-ADD*ZERO     WN0392  60       Time Out
     C                     Z-ADD*ZERO     WN0393 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0394  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0395  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0396  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0397  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0398  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0399  70       Requested Deliv
     C                     MOVEL*BLANK    WN0400  1        Load Acceptance
     C                     MOVEL*BLANK    WN0401  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0402  70       On Yard Date
     C                     Z-ADD*ZERO     WN0403  60       On Yard Time
     C                     Z-ADD*ZERO     WN0404  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0405  60       Deadline Depart
     C                     MOVEL*BLANK    WN0406  1        Load Held Over
     C                     MOVEL*BLANK    WN0407  1        Load Held Over
     C                     MOVEL*BLANK    WN0408 15        Load Held Over
     C                     MOVEL*BLANK    WN0409 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0410 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0411  70       Express Mail Da
     C                     MOVEL*BLANK    WN0412  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0413  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0414  70       Product Complet
     C                     Z-ADD*ZERO     WN0415  60       Product Complet
     C                     Z-ADD*ZERO     WN0416  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0417  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0418  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0419  1        Load Confirmed
     C                     MOVEL*BLANK    WN0420 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0421  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0422  60       Load Door 1
     C                     Z-ADD*ZERO     WN0423  70       Override Total
     C                     Z-ADD*ZERO     WN0424  60       Load Door 2
     C                     MOVEL*BLANK    WN0425  1        Partial Load
     C                     MOVEL*BLANK    WN0426  1        Load Confirmati
     C                     MOVEL*BLANK    WN0427  1        Export Load USD
     C                     MOVEL*BLANK    WN0428  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0429 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0430 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0431 15        Late Billing Em
     C                     MOVEL*BLANK    WN0432 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0433 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0434  1        Multi Company L
     C                     MOVEL*BLANK    WN0435  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0436  1        LH Power Only L
     C                     MOVEL*BLANK    WN0437  1        MG Created Load
     C                     MOVEL*BLANK    WN0438  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0439  2        Load U/M
     C                     MOVEL*BLANK    WN0440  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0441  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0442  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0443  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0444  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0445  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0446  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0447  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0448  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0449  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0450  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0451  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0452  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0453  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0454  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0455  60       LH Unused Time
     C                     MOVEL*BLANK    WN0456  1        EDI Status 1
     C                     MOVEL*BLANK    WN0457  1        EDI Status 2
     C                     MOVEL*BLANK    WN0458  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0459  60       Job Time
     C                     MOVEL*BLANK    WN0460 10        User Id
     C                     MOVEL*BLANK    WN0461 10        Job Name
     C                     Z-ADD*ZERO     WN0462  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADD#2RMNB    WFRMNB           Load ID
      *
     C           KLCHSW    KLIST
     C                     KFLD           WFRMNB           Load ID
     C           KLCHSW    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SWEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YDRDCS
      * Move non-key fields to @FJCPBO
     C                     MOVEL'Y'       WFRUSX    P      Fax Sent to SSI
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##PGM     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * CHG Deload Log Entry   RT - Load Order Change Log  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0463  50       Sequence
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * E3796 JJH 3/5/15 - Removed "Requested Ship Date" from "Un-Confirm
      *  Load List" of "Load Change Type" field.
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBRMNB    WQSX02           Load ID
     C           *LIKE     DEFN WBRVST    WQSX03           Load Change Typ
      * Define keylist
     C           KPSSX     KLIST
     C                     KFLD           WQSX02           Load ID
     C                     KFLD           WQSX03           Load Change Typ
     C                     KFLD           WBK4DT           Created Date
     C                     KFLD           WBA1TM           Created Time
     C                     KFLD           WBDXNB           Sequence Number
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WQSX02           Load ID
     C                     KFLD           WQSX03           Load Change Typ
      * Setup key
     C                     Z-ADD#2RMNB    WQSX02           Load ID
     C                     MOVELWURVST    WQSX03           Load Change Typ
     C                     Z-ADD*ZERO     WBK4DT           Created Date
     C                     Z-ADD*ZERO     WBA1TM           Created Time
     C                     Z-ADD*ZERO     WBDXNB           Sequence Number
      * Establish starting position
     C           KPSSX     SETLL@LHCPO4                    *
     C           KRSSX     READE@LHCPO4                  90*
      * Data record not found
     C   90                MOVEL'USR2471' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WBDXNB    ADD  1         WN0463           Sequence
      * CRT Load/Order Chg Log CR - Load/Order Change Log  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD##JDT     WL0202           Created Date
     C                     Z-ADD##JTM     WL0203           Created Time
     C                     Z-ADDWN0463    WL0204           Sequence Number
     C                     Z-ADDWBRMNB    WL0205           Load ID
     C                     Z-ADDWBRVNB    WL0206           Stop/Drop
     C                     MOVEL'DELODA'  WL0207    P      Load Change Typ
     C                     MOVELWBUJST    WL0208    P      Department Cont
     C                     MOVELWBMOTX    WL0209    P      Change Log Prio
     C                     MOVEL@CN,012   WL0210    P      Change Log New
     C                     MOVEL##USR     WL0211    P      User Id
     C                     MOVEL##PGM     WL0212    P      Job Name
     C                     MOVELWBBZNA    WL0213    P      Carrier Code
     C                     MOVELWBXMCD    WL0214    P      Carrier Broker
     C                     Z-ADDWBAIC3    WL0215           Company Number
     C                     Z-ADDWBC4NB    WL0216           Order Number
     C                     EXSR SYCRRC
      * added new rtv to pull in the Confirm information
      * removed the RTV Load Status
      * RTV Load Status&ConfirmRT - Load Header  * 
     C                     EXSR SZRVGN
      * If this is a confirmed load,unconfirm load if needed
     C                     EXSR UBSUBR                     If this is a co
      * History
     C                     EXSR UCSUBR                     History
     C           KRSSX     READE@LHCPO4                  90*
     C                     ENDDO
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYCRRC    BEGSR
      *================================================================
      * CRT Load/Order Chg Log CR - Load/Order Change Log  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @LHCPN6
     C                     Z-ADDWL0202    WJK4DT           Created Date
     C                     Z-ADDWL0203    WJA1TM           Created Time
     C                     Z-ADDWL0204    WJDXNB           Sequence Number
     C                     Z-ADDWL0205    WJRMNB           Load ID
     C                     Z-ADDWL0206    WJRVNB           Stop/Drop
     C                     MOVELWL0207    WJRVST           Load Change Typ
     C                     MOVELWL0208    WJUJST           Department Cont
     C                     MOVELWL0209    WJMNTX           Change Log Prio
     C                     MOVELWL0210    WJMOTX           Change Log New
     C                     MOVELWL0211    WJAYNA           User Id
     C                     MOVELWL0212    WJA0NA           Job Name
     C                     MOVELWL0213    WJBZNA           Carrier Code
     C                     MOVELWL0214    WJXMCD           Carrier Broker
     C                     Z-ADDWL0215    WJAIC3           Company Number
     C                     Z-ADDWL0216    WJC4NB           Order Number
      *
     C           KLCRSY    KLIST
     C                     KFLD           WJK4DT           Created Date
     C                     KFLD           WJA1TM           Created Time
     C                     KFLD           WJDXNB           Sequence Number
      * Check for duplicate primary key
     C           KLCRSY    SETLL@LHCPN6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2472' W0RTN   7
      * USER: Processing if Data record already exists
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C                     WRITE@LHCPN6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * RTV Load Status&ConfirmRT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSZ     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0016           Load Status
     C                     MOVEL*BLANK    YL0017           Transloader Car
     C                     MOVEL*BLANK    YL0018           Load Confirmed
     C                     MOVEL*BLANK    YL0019           Load Confirmed
     C                     Z-ADD*ZERO     YL0020           Load Confirmati
     C                     MOVEL*BLANK    YL0021           Load Confirmati
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELFJPKST    YL0016           Load Status
     C                     MOVELFJDYTX    YL0017           Transloader Car
     C                     MOVELFJH9SX    YL0018           Load Confirmed
     C                     MOVELFJWOTX    YL0019           Load Confirmed
     C                     Z-ADDFJK1DT    YL0020           Load Confirmati
     C                     MOVELFJRPST    YL0021           Load Confirmati
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * RTV Carrier Broker     RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSTA     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFJXCCD    YL0022           Carrier Broker
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * RTV Next Key           RT - Load Order Change Log  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         YL0023           Sequence Number
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKRMNB    WQTB02           Load ID
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WQTB02           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    WQTB02           Load ID
      * Establish starting position
     C           KRSTB     SETLL@LHCPQR                    *
     C           KRSTB     READE@LHCPQR                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2471' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         YL0023           Sequence Number
     C                     GOTO TBEXIT                     *QUIT
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Sequence Number is EQ 999
     C           WKDXNB    IFEQ 999                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C           WKDXNB    ADD  1         YL0023           Sequence Number
     C                     GOTO TBEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTB     READE@LHCPQR                  90*
     C                     ENDDO
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCCHRC    BEGSR
      *================================================================
      * CHG Load Confirm to N  CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0464  30       Company Number
     C                     Z-ADD*ZERO     WN0465  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0466  1        LTL Flag
     C                     MOVEL*BLANK    WN0467  1        Load Status
     C                     Z-ADD*ZERO     WN0468  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0469 15        Seal 1
     C                     MOVEL*BLANK    WN0470 15        Seal 2
     C                     MOVEL*BLANK    WN0471 15        Seal 3
     C                     MOVEL*BLANK    WN0472 15        Seal 4
     C                     MOVEL*BLANK    WN0473 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0474  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0475 112       Flat Amount
     C                     MOVEL*BLANK    WN0476  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0477  50       Total Stops
     C                     MOVEL*BLANK    WN0478 20        Trailer Id
     C                     MOVEL*BLANK    WN0479  3        Transloader Car
     C                     Z-ADD*ZERO     WN0480  40       BOL Time
     C                     MOVEL*BLANK    WN0481  3        Carrier Code
     C                     MOVEL*BLANK    WN0482  7        Truck Size
     C                     Z-ADD*ZERO     WN0483  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0484 112       Rated Freight
     C                     MOVEL*BLANK    WN0485  1        Ship Status
     C                     MOVEL*BLANK    WN0486  1        Load Type
     C                     Z-ADD*ZERO     WN0487  50       Number Pallets
     C                     Z-ADD*ZERO     WN0488  50       Number Pallets
     C                     Z-ADD*ZERO     WN0489 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0490  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0491  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0492  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0493 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0494 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0495  70       Actual Departur
     C                     Z-ADD*ZERO     WN0496  40       Departure Time
     C                     Z-ADD*ZERO     WN0497  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0498  52       Product Tempera
     C                     Z-ADD*ZERO     WN0499  50       Number Spacers
     C                     MOVEL*BLANK    WN0500 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0501  70       Total Load Mile
     C                     MOVEL*BLANK    WN0502 12        Recorder ID
     C                     MOVEL*BLANK    WN0503  2        Shipping Method
     C                     MOVEL*BLANK    WN0504  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0505  2        Ship To State C
     C                     Z-ADD*ZERO     WN0506  70       Gross Weight
     C                     MOVEL*BLANK    WN0507  3        Carrier Broker
     C                     MOVEL*BLANK    WN0508  1        Export Status
     C                     Z-ADD*ZERO     WN0509  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0510  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0511  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0512  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0513  70       Spotted Date
     C                     Z-ADD*ZERO     WN0514  60       Spotted Time
     C                     Z-ADD*ZERO     WN0515  70       Load Finished D
     C                     Z-ADD*ZERO     WN0516  60       Load Finished T
     C                     Z-ADD*ZERO     WN0517  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0518  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0519  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0520  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0521  70       Truck Departure
     C                     Z-ADD*ZERO     WN0522  60       Truck Departure
     C                     Z-ADD*ZERO     WN0523  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0524  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0525  3        Shipping Line
     C                     MOVEL*BLANK    WN0526 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0527 30        Vessel Name
     C                     Z-ADD*ZERO     WN0528  50       Voyage
     C                     Z-ADD*ZERO     WN0529  70       Sail Date
     C                     MOVEL*BLANK    WN0530 12        Booking Number
     C                     MOVEL*BLANK    WN0531 20        Discharge Port
     C                     Z-ADD*ZERO     WN0532  70       Arrival Date
     C                     MOVEL*BLANK    WN0533 12        Container Numbe
     C                     Z-ADD*ZERO     WN0534  70       Date In
     C                     Z-ADD*ZERO     WN0535  60       Time In
     C                     Z-ADD*ZERO     WN0536  70       Date Out
     C                     Z-ADD*ZERO     WN0537  60       Time Out
     C                     Z-ADD*ZERO     WN0538 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0539  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0540  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0541  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0542  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0543  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0544  70       Requested Deliv
     C                     MOVEL*BLANK    WN0545  1        Load Acceptance
     C                     MOVEL*BLANK    WN0546  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0547  70       On Yard Date
     C                     Z-ADD*ZERO     WN0548  60       On Yard Time
     C                     Z-ADD*ZERO     WN0549  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0550  60       Deadline Depart
     C                     MOVEL*BLANK    WN0551  1        Load Held Over
     C                     MOVEL*BLANK    WN0552  1        Load Held Over
     C                     MOVEL*BLANK    WN0553 15        Load Held Over
     C                     MOVEL*BLANK    WN0554 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0555 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0556  70       Express Mail Da
     C                     MOVEL*BLANK    WN0557  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0558  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0559  70       Product Complet
     C                     Z-ADD*ZERO     WN0560  60       Product Complet
     C                     Z-ADD*ZERO     WN0561  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0562  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0563  92       Tot Pallet Tare
     C                     Z-ADD*ZERO     WN0564  60       Load Door 1
     C                     Z-ADD*ZERO     WN0565  70       Override Total
     C                     Z-ADD*ZERO     WN0566  60       Load Door 2
     C                     MOVEL*BLANK    WN0567  1        Partial Load
     C                     MOVEL*BLANK    WN0568  1        Load Confirmati
     C                     MOVEL*BLANK    WN0569  1        Export Load USD
     C                     MOVEL*BLANK    WN0570  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0571 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0572 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0573 15        Late Billing Em
     C                     MOVEL*BLANK    WN0574 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0575 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0576  1        Multi Company L
     C                     MOVEL*BLANK    WN0577  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0578  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0579  1        LH Power Only L
     C                     MOVEL*BLANK    WN0580  1        MG Created Load
     C                     MOVEL*BLANK    WN0581  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0582  2        Load U/M
     C                     MOVEL*BLANK    WN0583  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0584  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0585  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0586  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0587  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0588  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0589  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0590  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0591  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0592  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0593  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0594  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0595  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0596  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0597  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0598  60       LH Unused Time
     C                     MOVEL*BLANK    WN0599  1        EDI Status 1
     C                     MOVEL*BLANK    WN0600  1        EDI Status 2
     C                     MOVEL*BLANK    WN0601  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0602  60       Job Time
     C                     MOVEL*BLANK    WN0603 10        User Id
     C                     MOVEL*BLANK    WN0604 10        Job Name
     C                     Z-ADD*ZERO     WN0605  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADD#2RMNB    WFRMNB           Load ID
      *
     C           KLCHTC    KLIST
     C                     KFLD           WFRMNB           Load ID
     C           KLCHTC    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YERDCS
      * Move non-key fields to @FJCPBO
     C                     MOVELYL0018    WFH9SX    P      Load Confirmed
     C                     MOVELYL0019    WFWOTX    P      Load Confirmed
     C                     Z-ADDYL0020    WFK1DT           Load Confirmati
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##JOB     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0606    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSTD     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    P2I6ST           Allow Multi-Com
     C                     MOVELDRMPNA    P2MPNA           Default Printer
     C                     MOVELDRBCCD    P2BCCD           Salesperson Cod
     C                     Z-ADDDRAIC3    YL0026           Company Number
     C                     MOVELDRBUVN    WN0607           User Code Model
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - User Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0217    DTAJVN           User Profile Na
     C                     MOVELWL0218    DTDNCD           Application Cod
      * Establish starting position
     C           KRSTE     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0219           Company Number
     C                     MOVELDTAJCD    WL0220           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQTF01           Application Cod
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           WQTF01           Application Cod
      * Setup key
     C                     MOVEL'PDZ6DF'  WQTF01           Application Cod
      * Establish starting position
     C           KRSTF     SETLL@DNRESF                    *
     C           KRSTF     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR TGRVGN
     C                     END                             *FI
     C           KRSTF     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQTG01           Application Cod
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           WQTG01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQTG01           Application Cod
      * Establish starting position
     C           KRSTG     SETLL@DNRESF                    *
     C           KRSTG     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSTG     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * RTV Load Acceptance Sw RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSTH     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    P3RMST           Load Acceptance
     C                     MOVEL*BLANK    YL0028           MG Created Load
     C                     GOTO THEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFJRMST    P3RMST           Load Acceptance
     C                     MOVELFJRYSX    YL0028           MG Created Load
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** Change log and comments
      *================================================================
      * ** 01/18/2010 PKD E000261 Pass the Average Pallet Tare
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * If this is a confirmed load,unconfirm load if needed
      *================================================================
      * If confirmed load but the action states to make this a
      * unconfirmed load, then
      * Write out the action of Unconfirm and then update the load
      * with n = load confirmed status, and load confirmed contact
      * of blanks and load confirmation time = zero
      * UnConfirm Routine
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Load Confirmed Sts is yes
      *   |- c2    : PAR.Load Change Type is Un-Confirm Load List
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0018    IFEQ 'Y'                        *IF
     C           WURVST    IFEQ @CN,006                    *IF
     C           WURVST    OREQ @CN,008
     C           WURVST    OREQ @CN,013
     C           WURVST    OREQ @CN,014
     C           WURVST    OREQ @CN,011
     C           WURVST    OREQ @CN,009
     C           WURVST    OREQ @CN,015
     C           WURVST    OREQ @CN,010
     C           WURVST    OREQ @CN,016
     C           WURVST    OREQ @CN,002
     C           WURVST    OREQ @CN,017
     C           WURVST    OREQ @CN,007
     C           WURVST    OREQ @CN,004
     C           WURVST    OREQ @CN,018
     C           WURVST    OREQ @CN,019
     C           WURVST    OREQ @CN,020
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVELYL0018    WUH9SX           Load Confirmed
     C                     MOVEL'N'       YL0018           Load Confirmed
      * RTV Carrier Broker     RT - Load Header  * 
     C                     EXSR TARVGN
      * *****************************************************************
      * *Comments:
      * *  The following Retrieve Next Key was added for OMS296.  It was
      * *  needed when the users wanted to be able to see the orders adde
      * *  and deleted from the Load Change Log.  John Tremper, 10/10/97
      * *****************************************************************
      * RTV Next Key           RT - Load Order Change Log  * 
     C                     EXSR TBRVGN
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * Loop thru to do create
      * DO WHILE: PGM.*Return code is *Record already exists
     C           W0RTN     DOWEQ@CN,021                    *DOW
      * WRITE OUT THE UNCONFIRM RECORD
     C                     MOVEL'UNCNFM'  WURVST           Load Change Typ
     C                     MOVEL*BLANK    WUMNTX           Change Log Prio
     C                     MOVELWUH9SX    WUMNTX           Change Log Prio
     C                     MOVEL*BLANK    WUMOTX           Change Log New
     C                     MOVELYL0018    WUMOTX           Change Log New
      * CRT Load/Order Chg Log CR - Load Order Change Log  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD##JDT     WL0202           Created Date
     C                     Z-ADD##JTM     WL0203           Created Time
     C                     Z-ADDYL0023    WL0204           Sequence Number
     C                     Z-ADD#2RMNB    WL0205           Load ID
     C                     Z-ADDWBRVNB    WL0206           Stop/Drop
     C                     MOVELWURVST    WL0207    P      Load Change Typ
     C                     MOVELWBUJST    WL0208    P      Department Cont
     C                     MOVELWUMNTX    WL0209    P      Change Log Prio
     C                     MOVELWUMOTX    WL0210    P      Change Log New
     C                     MOVEL##USR     WL0211    P      User Id
     C                     MOVEL##PGM     WL0212    P      Job Name
     C                     MOVELYL0024    WL0213    P      Carrier Code
     C                     MOVELYL0022    WL0214    P      Carrier Broker
     C                     Z-ADDWBAIC3    WL0215           Company Number
     C                     Z-ADDWBC4NB    WL0216           Order Number
     C                     EXSR SYCRRC
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ @CN,021                    *IF
     C                     ADD  1         YL0023           Sequence Number
     C                     END                             *FI
     C                     END                             *ITR
      * Change the Load Header back to a Unconfirmed Load
      * Now the producer to carrier will need to confirm the load
      * again
     C                     MOVEL*BLANK    YL0019           Load Confirmed
     C                     Z-ADD0         YL0020           Load Confirmati
      * CHG Load Confirm to N  CH - Load Header  * 
     C                     EXSR TCCHRC
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * History
      *================================================================
      * 10/03/2007 FP1061 If action is on the Un-Confirm list
      *            then perform the Un-Confirm on the Load Header
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Documentation/Change Log
      *================================================================
      * This program shows the change log entries for a load, stop and or
      * It is run interactively from an external function.  One Load, Sto
      * per iteration.  It is executed once for deleted loads and again f
      * existing, Unaccepted loads.
      * - DBF Change on Order Header Extsn (PMAMREP) File. Changed:
      *   OHE Voyage/Flight from 5.0 to 15A.
      *   OHE Booking Number from 12A to 15A.
      *   Added: OHE Genset Number 15A.
      * - Recompiled only.
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD13        ZHSTRW  40
     C                     Z-ADD20        ZHNDRW  40
     C                     Z-ADD1         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
      * USER: Exit program processing
      * CASE: CTL.*CMD key is *Exit
     C           *IN03     IFEQ '1'                        *IF
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2AJCD           Warehouse Code
     C                     MOVEL*BLANK    P2DNCD           Application Cod
     C                     MOVEL*BLANK    P2BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P2B8NA           System Date For
     C                     MOVEL*BLANK    P2AJVN           User Profile Na
     C                     MOVEL*BLANK    P2I6ST           Allow Multi-Com
     C                     MOVEL*BLANK    P2MPNA           Default Printer
     C                     Z-ADD*ZERO     P3MPNB           USR Order Numbe
     C                     MOVEL*BLANK    P3RMST           Load Acceptance
     C                     MOVEL*BLANK    P3UTST           USR Load Exists
     C                     Z-ADD*ZERO     P3CLC5           @Calc 5,0
     C                     Z-ADD*ZERO     P3CLC3           @Calc 3,0
     C                     Z-ADD*ZERO     P3TSNB           Calc 5
     C                     Z-ADD*ZERO     P3               USR Stop/Drop
     C                     MOVEL*BLANK    P3UMST           USR View Option
     C                     MOVEL*BLANK    P4YISX           Plant Company S
     C                     MOVEL*BLANK    P4YJSX           Company Organiz
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Define work field USR Weight Confirmed
     C                     Z-ADD*ZERO     WUA7WG 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WARUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WARVNB           Stop/Drop
     C                     Z-ADD*ZERO     WARWNB           Miles to next s
     C                     Z-ADD*ZERO     WARXNB           Freight Charge
     C                     Z-ADD*ZERO     WASQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WAT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WAT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WASXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WAKFDT           Appointment Con
     C                     Z-ADD*ZERO     WAACTM           Appointment Con
     C                     Z-ADD*ZERO     WAEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WAAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WAKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WAATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WAHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WAAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WAKKDT           On Yard Date
     C                     Z-ADD*ZERO     WAAVTM           On Yard Time
     C                     Z-ADD*ZERO     WAZ4NB           MPC Number
     C                     Z-ADD*ZERO     WAN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WAN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WAN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WAB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WAB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WAB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Load Change Type
     C                     MOVEL*BLANK    WURVST  6
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBK4DT           Created Date
     C                     Z-ADD*ZERO     WBA1TM           Created Time
     C                     Z-ADD*ZERO     WBDXNB           Sequence Number
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBRVNB           Stop/Drop
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
      * Define work field Company
     C                     Z-ADD*ZERO     WUBNC3  30
      * Define work field USR Load ID
     C                     Z-ADD*ZERO     WUUCNB  70
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field USR Work Field 3A
     C                     MOVEL*BLANK    WUEZTX  3
      * Define work field Month (Char) USR
     C                     MOVEL*BLANK    WUT5TX  2
      * Define work field Day   (Char) USR
     C                     MOVEL*BLANK    WUT6TX  2
      * Define work field Text USR 4
     C                     MOVEL*BLANK    WUZ7TX  4
      * Define work field *Return code
     C                     MOVEL*BLANK    WURTN   7
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WDA0DT           Order Date
     C                     Z-ADD*ZERO     WDA5DT           Requested Ship
     C                     Z-ADD*ZERO     WDGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WDACDT           Cancel Date
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDCXDT           Date of Origina
     C                     Z-ADD*ZERO     WDJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WDA1WG           Order Weight To
     C                     Z-ADD*ZERO     WDEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WDAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WDATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WDRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WDT3NB           Attach to Order
     C                     Z-ADD*ZERO     WDCONB           Invoice Number
     C                     Z-ADD*ZERO     WDAWDT           Invoice Date
     C                     Z-ADD*ZERO     WDVRVA           A/R order Value
     C                     Z-ADD*ZERO     WDB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WDNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WDNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WDNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WDNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WDNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WDBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WDBQTM           Time of Origina
     C                     Z-ADD*ZERO     WDBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WDBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WDBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WDH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WDH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WDH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WDH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WDH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WDC0C7           Claim Number
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field Export Status
     C                     MOVEL*BLANK    WUU2ST  1
      * Define work field Deadline Departure Date
     C                     Z-ADD*ZERO     WUKZDT  70
      * Define work field Deadline Departure Time
     C                     Z-ADD*ZERO     WUAXTM  60
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFRMNB           Load ID
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WFRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WFRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WFFLAM           Flat Amount
     C                     Z-ADD*ZERO     WFRRNB           Total Stops
     C                     Z-ADD*ZERO     WFSBNB           BOL Time
     C                     Z-ADD*ZERO     WFSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WFR1NB           Rated Freight
     C                     Z-ADD*ZERO     WFSDNB           Number Pallets
     C                     Z-ADD*ZERO     WFPAOU           Number Pallets
     C                     Z-ADD*ZERO     WFDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WFSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WFHADT           Actual Arrival
     C                     Z-ADD*ZERO     WFAART           Actual Arrival
     C                     Z-ADD*ZERO     WFDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WFDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WFAQDT           Actual Departur
     C                     Z-ADD*ZERO     WFS6NB           Departure Time
     C                     Z-ADD*ZERO     WFT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WFPRTM           Product Tempera
     C                     Z-ADD*ZERO     WFNPSV           Number Spacers
     C                     Z-ADD*ZERO     WFTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WFGRWE           Gross Weight
     C                     Z-ADD*ZERO     WFF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WFJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WFTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WFJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WFSPTM           Spotted Time
     C                     Z-ADD*ZERO     WFJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WFLFTM           Load Finished T
     C                     Z-ADD*ZERO     WFJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WFBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WFJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WFBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WFKIDT           Truck Departure
     C                     Z-ADD*ZERO     WFASTM           Truck Departure
     C                     Z-ADD*ZERO     WFKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WFAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WFVOAG           Voyage
     C                     Z-ADD*ZERO     WFKBDT           Sail Date
     C                     Z-ADD*ZERO     WFEFDT           Arrival Date
     C                     Z-ADD*ZERO     WFKCDT           Date In
     C                     Z-ADD*ZERO     WFTMIN           Time In
     C                     Z-ADD*ZERO     WFKDDT           Date Out
     C                     Z-ADD*ZERO     WFVMNB           Time Out
     C                     Z-ADD*ZERO     WFOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WFKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WFATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WFBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WFEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WFKKDT           On Yard Date
     C                     Z-ADD*ZERO     WFAVTM           On Yard Time
     C                     Z-ADD*ZERO     WFKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WFAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WFLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WFK0DT           Product Complet
     C                     Z-ADD*ZERO     WFAYTM           Product Complet
     C                     Z-ADD*ZERO     WFKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WFICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WFIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WFK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WFAZTM           Load Door 1
     C                     Z-ADD*ZERO     WFK2DT           Override Total
     C                     Z-ADD*ZERO     WFA0TM           Load Door 2
     C                     Z-ADD*ZERO     WFZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WFPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WFCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WFPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WFCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WFP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WFCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WFP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WFCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WFP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WFCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WFP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WFCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHC4NB           Order Number
     C                     Z-ADD*ZERO     WHDPNB           Order Sequence
     C                     Z-ADD*ZERO     WHUENB           Order Secondary
     C                     Z-ADD*ZERO     WHHGCD           Item Code
     C                     Z-ADD*ZERO     WHBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WHCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WHMAVA           Billing Detail
     C                     Z-ADD*ZERO     WHKDVA           Billing Detail
     C                     Z-ADD*ZERO     WHL8VA           Billing Detail
     C                     Z-ADD*ZERO     WHL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WHAYVA           Extended Amount
     C                     Z-ADD*ZERO     WHEXDT           Market Pricing
     C                     Z-ADD*ZERO     WHBZPR           Price Overage O
     C                     Z-ADD*ZERO     WHL6NB           Contract Number
     C                     Z-ADD*ZERO     WHGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WHR1NB           Rated Freight
     C                     Z-ADD*ZERO     WHAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WHD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WHCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WHAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WHCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WHATWG           Weight Shipped
     C                     Z-ADD*ZERO     WHAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WHAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WHAKPR           Unit Price
     C                     Z-ADD*ZERO     WHALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WHAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WHAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WHA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WHA5DT           Requested Ship
     C                     Z-ADD*ZERO     WHAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WHGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WHRGNB           Item Structure
     C                     Z-ADD*ZERO     WHRHNB           Item Structure
     C                     Z-ADD*ZERO     WHRINB           Item Structure
     C                     Z-ADD*ZERO     WHCXDT           Date of Origina
     C                     Z-ADD*ZERO     WHDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WHB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WHA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WHNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WHNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WHNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WHNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WHNXDT           OD Unused Date
     C                     Z-ADD*ZERO     WHBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WHBVTM           Price Code
     C                     Z-ADD*ZERO     WHBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WHBXTM           Substitution Li
     C                     Z-ADD*ZERO     WHBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WHH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WHH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WHH7NX           OD Item Target
     C                     Z-ADD*ZERO     WHH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WHH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WHDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WHDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WHDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WHDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WHDZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WHGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WHGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WHGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WHPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WHRINY           Item Age Days
     C                     Z-ADD*ZERO     WHTIDT           Production Ovr
     C                     Z-ADD*ZERO     WHTJDT           Production Ovr
     C                     Z-ADD*ZERO     WHTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WHTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WHTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Define work field Load Acceptance Flag
     C                     MOVEL*BLANK    WURMST  1
      * Define work field Status - Y or N
     C                     MOVEL*BLANK    WUB8ST  1
      * Define work field USR Flag 1
     C                     MOVEL*BLANK    WUD4ST  1
      * Define work field FAX DTL Status 1
     C                     MOVEL*BLANK    WUTCSX  1
      * Define work field SSI Download Flag
     C                     MOVEL*BLANK    WUUNUS  1
      * Define work field Fax Sent to SSI Carrier
     C                     MOVEL*BLANK    WURUSX  1
      * Define work field SSI Add, Chg, Delete flag
     C                     MOVEL*BLANK    WUAHST  2
      * Define work field Load Confirmed Sts
     C                     MOVEL*BLANK    WUH9SX  1
      * Define work field Change Log Prior Value
     C                     MOVEL*BLANK    WUMNTX 12
      * Define work field Change Log New Value
     C                     MOVEL*BLANK    WUMOTX 12
      * Define work field Application Code
     C                     MOVEL*BLANK    WUDNCD  6
      * Define work field Order Sequence Number
     C                     Z-ADD*ZERO     WUDPNB  30
      * Define work field Order Secondary Line Seq
     C                     Z-ADD*ZERO     WUUENB  30
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0001  70
     C                     Z-ADD*ZERO     WL0002  50
     C                     Z-ADD*ZERO     WL0003  92
     C                     Z-ADD*ZERO     WL0004  92
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0005  30
     C                     Z-ADD*ZERO     WL0006  70
     C                     MOVEL*BLANK    WL0007  2
     C                     Z-ADD*ZERO     WL0008  70
     C                     Z-ADD*ZERO     WL0009  70
     C                     MOVEL*BLANK    WL0010 30
     C                     MOVEL*BLANK    WL0011 30
     C                     MOVEL*BLANK    WL0012 30
     C                     MOVEL*BLANK    WL0013 30
     C                     MOVEL*BLANK    WL0014 20
     C                     MOVEL*BLANK    WL0015  2
     C                     MOVEL*BLANK    WL0016 11
     C                     Z-ADD*ZERO     WL0017  70
     C                     MOVEL*BLANK    WL0018 30
     C                     MOVEL*BLANK    WL0019 30
     C                     MOVEL*BLANK    WL0020 30
     C                     MOVEL*BLANK    WL0021 30
     C                     MOVEL*BLANK    WL0022 20
     C                     MOVEL*BLANK    WL0023  2
     C                     MOVEL*BLANK    WL0024 11
     C                     MOVEL*BLANK    WL0025 15
     C                     Z-ADD*ZERO     WL0026  70
     C                     Z-ADD*ZERO     WL0027  70
     C                     Z-ADD*ZERO     WL0028  70
     C                     Z-ADD*ZERO     WL0029  70
     C                     MOVEL*BLANK    WL0030  2
     C                     MOVEL*BLANK    WL0031 40
     C                     MOVEL*BLANK    WL0032 40
     C                     MOVEL*BLANK    WL0033  3
     C                     MOVEL*BLANK    WL0034  1
     C                     MOVEL*BLANK    WL0035  1
     C                     MOVEL*BLANK    WL0036  1
     C                     MOVEL*BLANK    WL0037  1
     C                     MOVEL*BLANK    WL0038  3
     C                     MOVEL*BLANK    WL0039  1
     C                     MOVEL*BLANK    WL0040  1
     C                     MOVEL*BLANK    WL0041  1
     C                     MOVEL*BLANK    WL0042  1
     C                     Z-ADD*ZERO     WL0043  70
     C                     MOVEL*BLANK    WL0044 10
     C                     Z-ADD*ZERO     WL0045  70
     C                     Z-ADD*ZERO     WL0046 112
     C                     Z-ADD*ZERO     WL0047 112
     C                     MOVEL*BLANK    WL0048  1
     C                     MOVEL*BLANK    WL0049  1
     C                     MOVEL*BLANK    WL0050  1
     C                     Z-ADD*ZERO     WL0051  70
     C                     Z-ADD*ZERO     WL0052  40
     C                     MOVEL*BLANK    WL0053  4
     C                     MOVEL*BLANK    WL0054 12
     C                     Z-ADD*ZERO     WL0055  70
     C                     Z-ADD*ZERO     WL0056  52
     C                     Z-ADD*ZERO     WL0057 112
     C                     MOVEL*BLANK    WL0058  1
     C                     MOVEL*BLANK    WL0059  1
     C                     MOVEL*BLANK    WL0060  1
     C                     MOVEL*BLANK    WL0061  2
     C                     MOVEL*BLANK    WL0062  1
     C                     MOVEL*BLANK    WL0063  1
     C                     MOVEL*BLANK    WL0064  1
     C                     MOVEL*BLANK    WL0065  1
     C                     MOVEL*BLANK    WL0066  1
     C                     Z-ADD*ZERO     WL0067  52
     C                     MOVEL*BLANK    WL0068  1
     C                     Z-ADD*ZERO     WL0069  70
     C                     MOVEL*BLANK    WL0070  1
     C                     MOVEL*BLANK    WL0071  1
     C                     Z-ADD*ZERO     WL0072  70
     C                     MOVEL*BLANK    WL0073 30
     C                     MOVEL*BLANK    WL0074 30
     C                     MOVEL*BLANK    WL0075  1
     C                     MOVEL*BLANK    WL0076  3
     C                     MOVEL*BLANK    WL0077  2
     C                     MOVEL*BLANK    WL0078  3
     C                     Z-ADD*ZERO     WL0079  70
     C                     MOVEL*BLANK    WL0080  3
     C                     Z-ADD*ZERO     WL0081  70
     C                     MOVEL*BLANK    WL0082  2
     C                     Z-ADD*ZERO     WL0083  70
     C                     MOVEL*BLANK    WL0084  2
     C                     MOVEL*BLANK    WL0085  1
     C                     MOVEL*BLANK    WL0086  1
     C                     Z-ADD*ZERO     WL0087 112
     C                     MOVEL*BLANK    WL0088  1
     C                     MOVEL*BLANK    WL0089  1
     C                     MOVEL*BLANK    WL0090  1
     C                     MOVEL*BLANK    WL0091  1
     C                     MOVEL*BLANK    WL0092  1
     C                     MOVEL*BLANK    WL0093  1
      * Define local variables for subroutine SIRVGN.
     C                     Z-ADD*ZERO     WL0094  70
      * Define local variables for subroutine SNCHRC.
     C                     Z-ADD*ZERO     WL0095  70
     C                     MOVEL*BLANK    WL0096  1
     C                     Z-ADD*ZERO     WL0097  70
     C                     Z-ADD*ZERO     WL0098  60
      * Define local variables for subroutine SORVGN.
     C                     Z-ADD*ZERO     WL0099  70
     C                     Z-ADD*ZERO     WL0100  50
     C                     Z-ADD*ZERO     WL0101  70
     C                     Z-ADD*ZERO     WL0102  60
      * Define local variables for subroutine SSRVGN.
     C                     Z-ADD*ZERO     WL0103  70
     C                     MOVEL*BLANK    WL0104  3
     C                     MOVEL*BLANK    WL0105  3
     C                     MOVEL*BLANK    WL0106  1
     C                     MOVEL*BLANK    WL0107  3
     C                     MOVEL*BLANK    WL0108 20
     C                     MOVEL*BLANK    WL0109 30
     C                     Z-ADD*ZERO     WL0110  50
     C                     Z-ADD*ZERO     WL0111  70
     C                     MOVEL*BLANK    WL0112 12
     C                     MOVEL*BLANK    WL0113 20
     C                     Z-ADD*ZERO     WL0114  70
     C                     MOVEL*BLANK    WL0115 12
     C                     Z-ADD*ZERO     WL0116  70
     C                     Z-ADD*ZERO     WL0117  60
     C                     Z-ADD*ZERO     WL0118  70
     C                     Z-ADD*ZERO     WL0119  60
      * Define local variables for subroutine STRVGN.
     C                     Z-ADD*ZERO     WL0120  30
     C                     Z-ADD*ZERO     WL0121  70
     C                     Z-ADD*ZERO     WL0122  70
     C                     Z-ADD*ZERO     WL0123  50
     C                     MOVEL*BLANK    WL0124  3
     C                     MOVEL*BLANK    WL0125 20
     C                     MOVEL*BLANK    WL0126 25
     C                     MOVEL*BLANK    WL0127 30
     C                     MOVEL*BLANK    WL0128 15
     C                     MOVEL*BLANK    WL0129 15
     C                     MOVEL*BLANK    WL0130 20
     C                     Z-ADD*ZERO     WL0131  70
     C                     Z-ADD*ZERO     WL0132  70
     C                     Z-ADD*ZERO     WL0133  70
     C                     MOVEL*BLANK    WL0134  3
     C                     MOVEL*BLANK    WL0135  1
     C                     MOVEL*BLANK    WL0136 12
     C                     MOVEL*BLANK    WL0137 35
     C                     MOVEL*BLANK    WL0138 75
     C                     Z-ADD*ZERO     WL0139 110
     C                     Z-ADD*ZERO     WL0140 110
     C                     Z-ADD*ZERO     WL0141 110
     C                     Z-ADD*ZERO     WL0142 110
     C                     Z-ADD*ZERO     WL0143 112
     C                     Z-ADD*ZERO     WL0144 112
     C                     Z-ADD*ZERO     WL0145 112
     C                     Z-ADD*ZERO     WL0146  70
     C                     Z-ADD*ZERO     WL0147  70
     C                     Z-ADD*ZERO     WL0148  70
     C                     Z-ADD*ZERO     WL0149  70
     C                     MOVEL*BLANK    WL0150  4
     C                     MOVEL*BLANK    WL0151  4
     C                     MOVEL*BLANK    WL0152  4
     C                     MOVEL*BLANK    WL0153  2
     C                     MOVEL*BLANK    WL0154  2
     C                     MOVEL*BLANK    WL0155  2
     C                     MOVEL*BLANK    WL0156  3
     C                     MOVEL*BLANK    WL0157  3
     C                     MOVEL*BLANK    WL0158  3
     C                     MOVEL*BLANK    WL0159  5
     C                     Z-ADD*ZERO     WL0160  50
     C                     MOVEL*BLANK    WL0161 38
     C                     MOVEL*BLANK    WL0162  6
     C                     MOVEL*BLANK    WL0163  6
     C                     MOVEL*BLANK    WL0164  6
     C                     MOVEL*BLANK    WL0165  6
     C                     MOVEL*BLANK    WL0166  6
     C                     MOVEL*BLANK    WL0167 10
     C                     MOVEL*BLANK    WL0168 10
     C                     MOVEL*BLANK    WL0169 10
     C                     MOVEL*BLANK    WL0170 15
     C                     MOVEL*BLANK    WL0171 15
     C                     MOVEL*BLANK    WL0172 15
     C                     MOVEL*BLANK    WL0173 30
     C                     MOVEL*BLANK    WL0174 30
     C                     MOVEL*BLANK    WL0175 30
     C                     MOVEL*BLANK    WL0176 50
     C                     MOVEL*BLANK    WL0177 50
     C                     Z-ADD*ZERO     WL0178  30
     C                     Z-ADD*ZERO     WL0179  30
     C                     Z-ADD*ZERO     WL0180  30
     C                     Z-ADD*ZERO     WL0181  52
     C                     Z-ADD*ZERO     WL0182  52
     C                     Z-ADD*ZERO     WL0183  50
     C                     Z-ADD*ZERO     WL0184  60
     C                     Z-ADD*ZERO     WL0185  60
     C                     Z-ADD*ZERO     WL0186  60
     C                     Z-ADD*ZERO     WL0187  60
     C                     Z-ADD*ZERO     WL0188  90
     C                     Z-ADD*ZERO     WL0189  90
     C                     Z-ADD*ZERO     WL0190  90
     C                     Z-ADD*ZERO     WL0191  96
     C                     MOVEL*BLANK    WL0192  1
     C                     MOVEL*BLANK    WL0193  1
     C                     MOVEL*BLANK    WL0194  1
     C                     MOVEL*BLANK    WL0195  1
     C                     Z-ADD*ZERO     WL0196  60
     C                     MOVEL*BLANK    WL0197 10
     C                     MOVEL*BLANK    WL0198 10
     C                     Z-ADD*ZERO     WL0199  70
      * Define local variables for subroutine SURVGN.
     C                     MOVEL*BLANK    WL0200  3
     C                     MOVEL*BLANK    WL0201  1
      * Define local variables for subroutine SYCRRC.
     C                     Z-ADD*ZERO     WL0202  70
     C                     Z-ADD*ZERO     WL0203  60
     C                     Z-ADD*ZERO     WL0204  30
     C                     Z-ADD*ZERO     WL0205  70
     C                     Z-ADD*ZERO     WL0206  50
     C                     MOVEL*BLANK    WL0207  6
     C                     MOVEL*BLANK    WL0208  3
     C                     MOVEL*BLANK    WL0209 12
     C                     MOVEL*BLANK    WL0210 12
     C                     MOVEL*BLANK    WL0211 10
     C                     MOVEL*BLANK    WL0212 10
     C                     MOVEL*BLANK    WL0213  3
     C                     MOVEL*BLANK    WL0214  3
     C                     Z-ADD*ZERO     WL0215  30
     C                     Z-ADD*ZERO     WL0216  70
      * Define local variables for subroutine TERVGN.
     C                     MOVEL*BLANK    WL0217 10
     C                     MOVEL*BLANK    WL0218  6
     C                     Z-ADD*ZERO     WL0219  30
     C                     MOVEL*BLANK    WL0220  3
      * Define null work field Requested Delivery Date
     C                     Z-ADD*ZERO     YN0001  70
      * Define null work field Warehouse Code
     C                     MOVEL*BLANK    YN0002  3
      * Define null work field Override Total Load Miles
     C                     Z-ADD*ZERO     YN0003  70
      * Define null work field Load Actual Freight
     C                     Z-ADD*ZERO     YN0004 112
      * Define null work field LH Held Over Rsn Cmt
     C                     MOVEL*BLANK    YN0005 25
      * Define null work field Load U/M
     C                     MOVEL*BLANK    YN0006  2
      * Define null work field LH On-Time Reason Code
     C                     MOVEL*BLANK    YN0007  3
      * Define null work field LH Held Over Reason
     C                     MOVEL*BLANK    YN0008  3
      * Define local work field Pallets Loaded
     C                     Z-ADD*ZERO     YL0001  50
      * Define local work field Avg Pallet Tare
     C                     Z-ADD*ZERO     YL0002  92
      * Define local work field Tot Pallet Tare
     C                     Z-ADD*ZERO     YL0003  92
      * Define local work field Order Quantity
     C                     Z-ADD*ZERO     YL0004 112
      * Define local work field Appointment Confirm Time
     C                     Z-ADD*ZERO     YL0005  60
      * Define local work field Scheduled Ship Date
     C                     Z-ADD*ZERO     YL0006  70
      * Define local work field Shipping Method
     C                     MOVEL*BLANK    YL0007  2
      * Define local work field Blank for 3          USR
     C                     MOVEL*BLANK    YL0008  3
      * Define null work field Company Number
     C                     Z-ADD*ZERO     YN0009  30
      * Define local work field USR Check Y/N Status
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field Ship To Customer
     C                     Z-ADD*ZERO     YL0010  70
      * Define local work field Requested Delivery Date
     C                     Z-ADD*ZERO     YL0011  70
      * Define local work field Transloader Carrier Code
     C                     MOVEL*BLANK    YL0012  3
      * Define local work field Carrier Code
     C                     MOVEL*BLANK    YL0013  3
      * Define null work field Export Status
     C                     MOVEL*BLANK    YN0010  1
      * Define null work field Shipping Line
     C                     MOVEL*BLANK    YN0011  3
      * Define null work field Port Delv Terminal
     C                     MOVEL*BLANK    YN0012 20
      * Define null work field Vessel Name
     C                     MOVEL*BLANK    YN0013 30
      * Define null work field Voyage
     C                     Z-ADD*ZERO     YN0014  50
      * Define null work field Sail Date
     C                     Z-ADD*ZERO     YN0015  70
      * Define null work field Booking Number
     C                     MOVEL*BLANK    YN0016 12
      * Define null work field Discharge Port
     C                     MOVEL*BLANK    YN0017 20
      * Define null work field Arrival Date
     C                     Z-ADD*ZERO     YN0018  70
      * Define null work field Container Number
     C                     MOVEL*BLANK    YN0019 12
      * Define null work field Date In
     C                     Z-ADD*ZERO     YN0020  70
      * Define null work field Time In
     C                     Z-ADD*ZERO     YN0021  60
      * Define null work field Date Out
     C                     Z-ADD*ZERO     YN0022  70
      * Define null work field Time Out
     C                     Z-ADD*ZERO     YN0023  60
      * Define local work field Shipping Line
     C                     MOVEL*BLANK    YL0014  3
      * Define null work field OHE City
     C                     MOVEL*BLANK    YN0024 25
      * Define null work field OHE Vessel/Airline
     C                     MOVEL*BLANK    YN0025 30
      * Define null work field OHE Voyage/Flight
     C                     MOVEL*BLANK    YN0026 15
      * Define null work field OHE Booking Number
     C                     MOVEL*BLANK    YN0027 15
      * Define null work field OHE Discharge Port/Airprt
     C                     MOVEL*BLANK    YN0028 20
      * Define null work field OHE Sail/Flight Date
     C                     Z-ADD*ZERO     YN0029  70
      * Define null work field OHE Port Cut Date
     C                     Z-ADD*ZERO     YN0030  70
      * Define null work field OHE Arrival Date
     C                     Z-ADD*ZERO     YN0031  70
      * Define null work field OHE Late Delivery Code
     C                     MOVEL*BLANK    YN0032  3
      * Define null work field OHE Ship Status
     C                     MOVEL*BLANK    YN0033  1
      * Define null work field OHE Container Number
     C                     MOVEL*BLANK    YN0034 12
      * Define null work field OHE Comment 1
     C                     MOVEL*BLANK    YN0035 35
      * Define null work field OHE Comment 2
     C                     MOVEL*BLANK    YN0036 75
      * Define null work field OHE Unused Number 1-11.0
     C                     Z-ADD*ZERO     YN0037 110
      * Define null work field OHE Unused Number 2-11.0
     C                     Z-ADD*ZERO     YN0038 110
      * Define null work field OHE Unused Number 3-11.0
     C                     Z-ADD*ZERO     YN0039 110
      * Define null work field OHE Unused Number 4-11.0
     C                     Z-ADD*ZERO     YN0040 110
      * Define null work field OHE HPB RIN Equiv Value
     C                     Z-ADD*ZERO     YN0041 112
      * Define null work field OHE HPB RIN Price
     C                     Z-ADD*ZERO     YN0042 112
      * Define null work field Transload Terminal Fees
     C                     Z-ADD*ZERO     YN0043 112
      * Define null work field OHE Est Arrv at Dest Date
     C                     Z-ADD*ZERO     YN0044  70
      * Define null work field OHE Backhaul ETA RtrnDate
     C                     Z-ADD*ZERO     YN0045  70
      * Define null work field OHE Port/Pier Paid Date
     C                     Z-ADD*ZERO     YN0046  70
      * Define null work field OHE Actual Ship Date
     C                     Z-ADD*ZERO     YN0047  70
      * Define local work field OHE Carrier SCAC Code
     C                     MOVEL*BLANK    YL0015  4
      * Define null work field OHE Spot Buy
     C                     MOVEL*BLANK    YN0048  4
      * Define null work field OHE PO ACK Flag
     C                     MOVEL*BLANK    YN0049  4
      * Define null work field OHE Override Type Code
     C                     MOVEL*BLANK    YN0050  2
      * Define null work field OHE Backhaul Status
     C                     MOVEL*BLANK    YN0051  2
      * Define null work field OHE Backhaul ETA AM/PM
     C                     MOVEL*BLANK    YN0052  2
      * Define null work field OHE Load Haul Type
     C                     MOVEL*BLANK    YN0053  3
      * Define null work field OHE Backhaul Carrier Code
     C                     MOVEL*BLANK    YN0054  3
      * Define null work field OHE Bookings Confirmed
     C                     MOVEL*BLANK    YN0055  3
      * Define null work field OHE EDI Error Reasons
     C                     MOVEL*BLANK    YN0056  5
      * Define null work field HPB COA Batch Number
     C                     Z-ADD*ZERO     YN0057  50
      * Define null work field Delivery P.O. Number
     C                     MOVEL*BLANK    YN0058 38
      * Define null work field OHE Intended for ExportCC
     C                     MOVEL*BLANK    YN0059  6
      * Define null work field OHE EDI 943 Action
     C                     MOVEL*BLANK    YN0060  6
      * Define null work field OHE EDI 944 Action
     C                     MOVEL*BLANK    YN0061  6
      * Define null work field OHE EDI 940 Action
     C                     MOVEL*BLANK    YN0062  6
      * Define null work field OHE EDI 945 Action
     C                     MOVEL*BLANK    YN0063  6
      * Define null work field OHE Transload Seal Nbr
     C                     MOVEL*BLANK    YN0064 10
      * Define null work field OHE Abs Rate Override Rsn
     C                     MOVEL*BLANK    YN0065 10
      * Define null work field OHE Appt Confirmation #
     C                     MOVEL*BLANK    YN0066 10
      * Define null work field OHE Backhaul Container#
     C                     MOVEL*BLANK    YN0067 15
      * Define null work field OHE Backhaul Chassis #
     C                     MOVEL*BLANK    YN0068 15
      * Define null work field OHE Transload Container#
     C                     MOVEL*BLANK    YN0069 15
      * Define null work field OHE Pier Pass Invoice
     C                     MOVEL*BLANK    YN0070 30
      * Define null work field OHE Carrier Nm
     C                     MOVEL*BLANK    YN0071 30
      * Define null work field OHE Appt Confirmation Nm
     C                     MOVEL*BLANK    YN0072 30
      * Define null work field OHE Backhaul Comment
     C                     MOVEL*BLANK    YN0073 50
      * Define null work field Letter of Credit Number
     C                     MOVEL*BLANK    YN0074 50
      * Define null work field OHE Backhaul Return to Co
     C                     Z-ADD*ZERO     YN0075  30
      * Define null work field LD Stop/Drop
     C                     Z-ADD*ZERO     YN0076  30
      * Define null work field OHE Unused Number 3.0
     C                     Z-ADD*ZERO     YN0077  30
      * Define null work field OHE Pier Pass Fee Amount
     C                     Z-ADD*ZERO     YN0078  52
      * Define null work field OHE Port Check Fee Amount
     C                     Z-ADD*ZERO     YN0079  52
      * Define null work field OHE Port Cut Time
     C                     Z-ADD*ZERO     YN0080  50
      * Define null work field OHE Backhaul Truck Number
     C                     Z-ADD*ZERO     YN0081  60
      * Define null work field OHE Load Sched Seq Num
     C                     Z-ADD*ZERO     YN0082  60
      * Define null work field Original Appointment Date
     C                     Z-ADD*ZERO     YN0083  60
      * Define null work field Original Appointment Time
     C                     Z-ADD*ZERO     YN0084  60
      * Define null work field OHE PowerPro Load#-Outbnd
     C                     Z-ADD*ZERO     YN0085  90
      * Define null work field OHE PowerPro Load#-Bckhl
     C                     Z-ADD*ZERO     YN0086  90
      * Define null work field OHE Unused Numeric 9,0 3
     C                     Z-ADD*ZERO     YN0087  90
      * Define null work field OHE Orig ABS Freight Rate
     C                     Z-ADD*ZERO     YN0088  96
      * Define null work field EDI Status 1
     C                     MOVEL*BLANK    YN0089  1
      * Define null work field EDI Status 2
     C                     MOVEL*BLANK    YN0090  1
      * Define null work field EDI Status 3
     C                     MOVEL*BLANK    YN0091  1
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0092  1
      * Define null work field Job Time
     C                     Z-ADD*ZERO     YN0093  60
      * Define null work field User Id
     C                     MOVEL*BLANK    YN0094 10
      * Define null work field Job Name
     C                     MOVEL*BLANK    YN0095 10
      * Define null work field Job Date
     C                     Z-ADD*ZERO     YN0096  70
      * Define local work field Load Status
     C                     MOVEL*BLANK    YL0016  1
      * Define local work field Transloader Carrier Code
     C                     MOVEL*BLANK    YL0017  3
      * Define local work field Load Confirmed Sts
     C                     MOVEL*BLANK    YL0018  1
      * Define local work field Load Confirmed Contact
     C                     MOVEL*BLANK    YL0019 25
      * Define local work field Load Confirmation Time
     C                     Z-ADD*ZERO     YL0020  70
      * Define local work field Load Confirmation Fax Sts
     C                     MOVEL*BLANK    YL0021  1
      * Define local work field Carrier Broker Carrier Co
     C                     MOVEL*BLANK    YL0022  3
      * Define local work field Sequence Number
     C                     Z-ADD*ZERO     YL0023  30
      * Define local work field Carrier Code
     C                     MOVEL*BLANK    YL0024  3
      * Define local work field Job Name CDE
     C                     MOVEL*BLANK    YL0025 10
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0026  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0027  3
      * Define local work field MG Created Load
     C                     MOVEL*BLANK    YL0028  1
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     Z-ADD08        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * Documentation/Change Log
     C                     EXSR UDSUBR                     Documentation/C
      *
     C                     MOVEL*BLANK    WN0606 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0606           User Profile Na
      *
     C                     MOVEL*BLANK    WN0607 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR TDRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0606    ZA0002           User Profile Na
     C                     MOVEL'PDZ6DF'  ZA0003           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0607    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0606    WL0217    P      User Profile Na
     C                     MOVEL'PDZ6DF'  WL0218    P      Application Cod
     C                     EXSR TERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0219    WUAIC3           Company Number
     C                     MOVELWL0220    YL0027    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0607    WL0217    P      User Profile Na
     C                     MOVEL'PDZ6DF'  WL0218    P      Application Cod
     C                     EXSR TERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0219    WUAIC3           Company Number
     C                     MOVELWL0220    YL0027    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0027    P2AJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0606    ZA0004           User Profile Na
     C                     MOVEL'PDZ6DF'  ZA0005           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0026    IFNE 0                          *IF
     C                     Z-ADDYL0026    WUAIC3           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0027    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           P2AJCD    PARM *BLANK    WQ0065  3        Warehouse Code
     C                     PARM YL0026    WQ0066  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR TFRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
     C                     MOVEL'N'       P3UMST           USR View Option
     C                     Z-ADDP1C4NB    P3MPNB           USR Order Numbe
     C                     Z-ADDP1RVNB    P3               USR Stop/Drop
      * VAL Load Exist        RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1RMNB    WL0094           Load ID
     C                     EXSR SIRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL'N'       P3UTST           USR Load Exists
     C                     MOVEL'A'       P3UMST           USR View Option
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       P3UTST           USR Load Exists
     C                     END                             *FI
      * RTV Load Acceptance Sw RT - Load Header  * 
     C                     EXSR THRVGN
      * CASE: PAR.Load Acceptance Flag is Load Accepted
     C           P3RMST    IFEQ 'A'                        *IF
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     Z-ADDP1C4NB    #2C4NB           Order Number
     C                     Z-ADDP1RVNB    #2RVNB           Stop/Drop
     C                     Z-ADD1         P3TSNB           Calc 5
     C                     MOVEL'N'       WUD4ST           USR Flag 1
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Y2U0005
00002 RQSDLV
00003 RQSSHP
00004 SCHSHP
00005 ACCEPT
00006 ADDSTP
00007 CANORD
00008 CARCHG
00009 DELODA
00010 LDDLTD
00011 DELOAD
00012 Delete Accpt
00013 CHGSTP
00014 CHGWHS
00015 DELORD
00016 CHGLCO
00017 ADDORD
00018 SHPCST
00019 SHPMTH
00020 PO#CHG
00021 Y2U0003
