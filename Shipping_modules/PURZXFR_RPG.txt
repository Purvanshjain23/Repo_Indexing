     H/TITLE Exc Remove order f/Ld XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 02/01/23  Time  : 08:21:14
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOMFLCPL1IF  E           K        DISK
      * RTV : Load Detail               Retrieval index
      *
     FPDLHCPLJIF  E           K        DISK
      * RSQ : Load Order Change Log     Create Date(D)/Time/Seq
      *
     FPDLHCPL9IF  E           K        DISK
      * RSQ : Load Order Change Log     Load ID/Seg Num-1
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FPMAMREL0UF  E           K        DISK
      * UPD : Order Header Extension    Update index
      *
     FOMFLCPL0UF  E           K        DISK
      * UPD : Load Detail               Update index
      *
     FPDLHCPL0IF  E           K        DISK                      A
      * UPD : Load Order Change Log     Update index
      *
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WAAIC3
     I              BEC4NB                          WAC4NB
     I              BEJNCD                          WAJNCD
     I              BEANC7                          WAANC7
     I              BEBKC7                          WABKC7
     I              BEBRTX                          WABRTX
     I              BEHMNA                          WAHMNA
     I              BEHONA                          WAHONA
     I              BEHPNA                          WAHPNA
     I              BEHNNA                          WAHNNA
     I              BEDBCD                          WADBCD
     I              BECKTX                          WACKTX
     I              BEB0C7                          WAB0C7
     I              BEAETX                          WAAETX
     I              BEB1NA                          WAB1NA
     I              BEB3NA                          WAB3NA
     I              BEB4NA                          WAB4NA
     I              BEB2NA                          WAB2NA
     I              BEBHCD                          WABHCD
     I              BEC8TX                          WAC8TX
     I              BEBCNA                          WABCNA
     I              BEA0DT                          WAA0DT
     I              BEA5DT                          WAA5DT
     I              BEGNDT                          WAGNDT
     I              BEACDT                          WAACDT
     I              BEAQCD                          WAAQCD
     I              BEB6NA                          WAB6NA
     I              BEBYNA                          WABYNA
     I              BEBZNA                          WABZNA
     I              BEGTST                          WAGTST
     I              BEGVST                          WAGVST
     I              BEGUST                          WAGUST
     I              BEQFST                          WAQFST
     I              BECQCD                          WACQCD
     I              BEGJST                          WAGJST
     I              BEGWST                          WAGWST
     I              BEGXST                          WAGXST
     I              BEGYST                          WAGYST
     I              BEAODT                          WAAODT
     I              BEAIVN                          WAAIVN
     I              BECXDT                          WACXDT
     I              BEJZVA                          WAJZVA
     I              BEA1WG                          WAA1WG
     I              BEXIST                          WAXIST
     I              BEXJST                          WAXJST
     I              BEXKST                          WAXKST
     I              BEEIDT                          WAEIDT
     I              BEAFTM                          WAAFTM
     I              BEE8CD                          WAE8CD
     I              BEE9CD                          WAE9CD
     I              BERMNB                          WARMNB
     I              BETBNB                          WATBNB
     I              BER1NB                          WAR1NB
     I              BEPJST                          WAPJST
     I              BEU0ST                          WAU0ST
     I              BEU1ST                          WAU1ST
     I              BEQ2CD                          WAQ2CD
     I              BEU2ST                          WAU2ST
     I              BEVEST                          WAVEST
     I              BEVFST                          WAVFST
     I              BEVGST                          WAVGST
     I              BERPCD                          WARPCD
     I              BERNNB                          WARNNB
     I              BEVDST                          WAVDST
     I              BEATIN                          WAATIN
     I              BEU4ST                          WAU4ST
     I              BEU5ST                          WAU5ST
     I              BERSRN                          WARSRN
     I              BEMHNA                          WAMHNA
     I              BEMINA                          WAMINA
     I              BEWBST                          WAWBST
     I              BER4CD                          WAR4CD
     I              BEBFCD                          WABFCD
     I              BEQ4CD                          WAQ4CD
     I              BET3NB                          WAT3NB
     I              BESICD                          WASICD
     I              BECONB                          WACONB
     I              BECEST                          WACEST
     I              BEAWDT                          WAAWDT
     I              BEJPCD                          WAJPCD
     I              BEXUST                          WAXUST
     I              BEZ1ST                          WAZ1ST
     I              BEVRVA                          WAVRVA
     I              BEOBST                          WAOBST
     I              BEBCST                          WABCST
     I              BEBDST                          WABDST
     I              BEB7VL                          WAB7VL
     I              BEGASX                          WAGASX
     I              BEGBSX                          WAGBSX
     I              BEGCSX                          WAGCSX
     I              BEGDSX                          WAGDSX
     I              BEFNSX                          WAFNSX
     I              BEFOSX                          WAFOSX
     I              BEFPSX                          WAFPSX
     I              BEFQSX                          WAFQSX
     I              BEFRSX                          WAFRSX
     I              BEFSSX                          WAFSSX
     I              BEFTSX                          WAFTSX
     I              BEFUSX                          WAFUSX
     I              BEFVSX                          WAFVSX
     I              BEFWSX                          WAFWSX
     I              BEFXSX                          WAFXSX
     I              BEFYSX                          WAFYSX
     I              BENODT                          WANODT
     I              BENPDT                          WANPDT
     I              BENQDT                          WANQDT
     I              BENRDT                          WANRDT
     I              BENSDT                          WANSDT
     I              BEBPTM                          WABPTM
     I              BEBQTM                          WABQTM
     I              BEBRTM                          WABRTM
     I              BEBSTM                          WABSTM
     I              BEBTTM                          WABTTM
     I              BEH0NX                          WAH0NX
     I              BEH1NX                          WAH1NX
     I              BEH2NX                          WAH2NX
     I              BEH3NX                          WAH3NX
     I              BEH4NX                          WAH4NX
     I              BEC0C7                          WAC0C7
     I              BEUVST                          WAUVST
     I              BEUWST                          WAUWST
     I              BEUXST                          WAUXST
     I              BEAATM                          WAAATM
     I              BEAYNA                          WAAYNA
     I              BEA0NA                          WAA0NA
     I              BEAXDT                          WAAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     I@AMREJE
      * Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                          WCAIC3
     I              AMC4NB                          WCC4NB
     I              AMRMNB                          WCRMNB
     I              AMRUNB                          WCRUNB
     I              AMXACD                          WCXACD
     I              AMOANA                          WCOANA
     I              AMHBAA                          WCHBAA
     I              AMJ0T1                          WCJ0T1
     I              AMGENY                          WCGENY
     I              AMJ1T1                          WCJ1T1
     I              AMHCAA                          WCHCAA
     I              AMQWDT                          WCQWDT
     I              AMQXDT                          WCQXDT
     I              AMQYDT                          WCQYDT
     I              AMHDAA                          WCHDAA
     I              AMCCTX                          WCCCTX
     I              AMJ2T1                          WCJ2T1
     I              AMRLNA                          WCRLNA
     I              AMRMNA                          WCRMNA
     I              AMGINY                          WCGINY
     I              AMGFNY                          WCGFNY
     I              AMGGNY                          WCGGNY
     I              AMGHNY                          WCGHNY
     I              AMHEVL                          WCHEVL
     I              AMHFVL                          WCHFVL
     I              AMHGVL                          WCHGVL
     I              AMQZDT                          WCQZDT
     I              AMQ0DT                          WCQ0DT
     I              AMQ1DT                          WCQ1DT
     I              AMQ2DT                          WCQ2DT
     I              AMC2TX                          WCC2TX
     I              AMC3TX                          WCC3TX
     I              AMC6TX                          WCC6TX
     I              AMCHTX                          WCCHTX
     I              AMCITX                          WCCITX
     I              AMCLTX                          WCCLTX
     I              AMB4TX                          WCB4TX
     I              AMCUTX                          WCCUTX
     I              AMCVTX                          WCCVTX
     I              AMB9TX                          WCB9TX
     I              AMJWSC                          WCJWSC
     I              AMITNY                          WCITNY
     I              AMLMT1                          WCLMT1
     I              AMLWAA                          WCLWAA
     I              AMFVST                          WCFVST
     I              AMF0ST                          WCF0ST
     I              AMF2ST                          WCF2ST
     I              AMF3ST                          WCF3ST
     I              AMJUSC                          WCJUSC
     I              AMJVSC                          WCJVSC
     I              AMV3T1                          WCV3T1
     I              AMV4T1                          WCV4T1
     I              AMV5T1                          WCV5T1
     I              AMV6T1                          WCV6T1
     I              AMV7T1                          WCV7T1
     I              AMV8T1                          WCV8T1
     I              AMV9T1                          WCV9T1
     I              AMWAT1                          WCWAT1
     I              AMWBT1                          WCWBT1
     I              AMWCT1                          WCWCT1
     I              AMWDT1                          WCWDT1
     I              AMQJNY                          WCQJNY
     I              AMQKNY                          WCQKNY
     I              AMQLNY                          WCQLNY
     I              AMP8NY                          WCP8NY
     I              AMP9NY                          WCP9NY
     I              AMQANY                          WCQANY
     I              AMQCNY                          WCQCNY
     I              AMQDNY                          WCQDNY
     I              AMQENY                          WCQENY
     I              AMQFNY                          WCQFNY
     I              AMQGNY                          WCQGNY
     I              AMQHNY                          WCQHNY
     I              AMQINY                          WCQINY
     I              AMQMNY                          WCQMNY
     I              AMMYU1                          WCMYU1
     I              AMJXSC                          WCJXSC
     I              AMJYSC                          WCJYSC
     I              AMJZSC                          WCJZSC
     I              AMJ0SC                          WCJ0SC
     I              AMMZU1                          WCMZU1
     I              AMM0U1                          WCM0U1
     I              AMM1U1                          WCM1U1
     I              AMM2U1                          WCM2U1
     I              AMM3U1                          WCM3U1
     I              AMW5DT                          WCW5DT
     I              AMW6DT                          WCW6DT
     I              AMUVST                          WCUVST
     I              AMUWST                          WCUWST
     I              AMUXST                          WCUXST
     I              AMVSST                          WCVSST
     I              AMAATM                          WCAATM
     I              AMAYNA                          WCAYNA
     I              AMA0NA                          WCA0NA
     I              AMAXDT                          WCAXDT
      *
     I@FLCPBW
      * Load Detail               Retrieval index
      * Renamed input format fields
     I              FLRMNB                          WDRMNB
     I              FLRUNB                          WDRUNB
     I              FLRVNB                          WDRVNB
     I              FLDQTX                          WDDQTX
     I              FLRWNB                          WDRWNB
     I              FLRXNB                          WDRXNB
     I              FLSQNB                          WDSQNB
     I              FLT0NB                          WDT0NB
     I              FLT1NB                          WDT1NB
     I              FLR1NB                          WDR1NB
     I              FLAIC3                          WDAIC3
     I              FLC4NB                          WDC4NB
     I              FLVCST                          WDVCST
     I              FLKEDT                          WDKEDT
     I              FLSXNB                          WDSXNB
     I              FLKFDT                          WDKFDT
     I              FLACTM                          WDACTM
     I              FLK5TX                          WDK5TX
     I              FLW5CD                          WDW5CD
     I              FLEJDT                          WDEJDT
     I              FLAGTM                          WDAGTM
     I              FLKJDT                          WDKJDT
     I              FLATTM                          WDATTM
     I              FLHDDT                          WDHDDT
     I              FLAUTM                          WDAUTM
     I              FLKKDT                          WDKKDT
     I              FLAVTM                          WDAVTM
     I              FLZ4NB                          WDZ4NB
     I              FLY7ST                          WDY7ST
     I              FLY2ST                          WDY2ST
     I              FLWHTX                          WDWHTX
     I              FLWITX                          WDWITX
     I              FLWJTX                          WDWJTX
     I              FLWKTX                          WDWKTX
     I              FLWLTX                          WDWLTX
     I              FLN7DT                          WDN7DT
     I              FLN8DT                          WDN8DT
     I              FLN9DT                          WDN9DT
     I              FLB3TM                          WDB3TM
     I              FLB4TM                          WDB4TM
     I              FLB5TM                          WDB5TM
     I              FLIASX                          WDIASX
     I              FLIBSX                          WDIBSX
     I              FLICSX                          WDICSX
     I              FLWVTX                          WDWVTX
     I              FLWWTX                          WDWWTX
     I              FLWXTX                          WDWXTX
     I              FLUVST                          WDUVST
     I              FLUWST                          WDUWST
     I              FLUXST                          WDUXST
     I              FLAATM                          WDAATM
     I              FLAYNA                          WDAYNA
     I              FLA0NA                          WDA0NA
     I              FLAXDT                          WDAXDT
      *
     I@FLCPBM
      * Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WERMNB
     I              FLRUNB                          WERUNB
     I              FLRVNB                          WERVNB
     I              FLDQTX                          WEDQTX
     I              FLRWNB                          WERWNB
     I              FLRXNB                          WERXNB
     I              FLSQNB                          WESQNB
     I              FLT0NB                          WET0NB
     I              FLT1NB                          WET1NB
     I              FLR1NB                          WER1NB
     I              FLAIC3                          WEAIC3
     I              FLC4NB                          WEC4NB
     I              FLVCST                          WEVCST
     I              FLKEDT                          WEKEDT
     I              FLSXNB                          WESXNB
     I              FLKFDT                          WEKFDT
     I              FLACTM                          WEACTM
     I              FLK5TX                          WEK5TX
     I              FLW5CD                          WEW5CD
     I              FLEJDT                          WEEJDT
     I              FLAGTM                          WEAGTM
     I              FLKJDT                          WEKJDT
     I              FLATTM                          WEATTM
     I              FLHDDT                          WEHDDT
     I              FLAUTM                          WEAUTM
     I              FLKKDT                          WEKKDT
     I              FLAVTM                          WEAVTM
     I              FLZ4NB                          WEZ4NB
     I              FLY7ST                          WEY7ST
     I              FLY2ST                          WEY2ST
     I              FLWHTX                          WEWHTX
     I              FLWITX                          WEWITX
     I              FLWJTX                          WEWJTX
     I              FLWKTX                          WEWKTX
     I              FLWLTX                          WEWLTX
     I              FLN7DT                          WEN7DT
     I              FLN8DT                          WEN8DT
     I              FLN9DT                          WEN9DT
     I              FLB3TM                          WEB3TM
     I              FLB4TM                          WEB4TM
     I              FLB5TM                          WEB5TM
     I              FLIASX                          WEIASX
     I              FLIBSX                          WEIBSX
     I              FLICSX                          WEICSX
     I              FLWVTX                          WEWVTX
     I              FLWWTX                          WEWWTX
     I              FLWXTX                          WEWXTX
     I              FLUVST                          WEUVST
     I              FLUWST                          WEUWST
     I              FLUXST                          WEUXST
     I              FLAATM                          WEAATM
     I              FLAYNA                          WEAYNA
     I              FLA0NA                          WEA0NA
     I              FLAXDT                          WEAXDT
      *
     I@LHCPBN
      * Load Order Change Log     Create Date(D)/Time/Seq
      * Renamed input format fields
     I              LHK4DT                          WFK4DT
     I              LHA1TM                          WFA1TM
     I              LHDXNB                          WFDXNB
     I              LHRMNB                          WFRMNB
     I              LHRVNB                          WFRVNB
     I              LHRVST                          WFRVST
     I              LHUJST                          WFUJST
     I              LHMNTX                          WFMNTX
     I              LHMOTX                          WFMOTX
     I              LHAYNA                          WFAYNA
     I              LHA0NA                          WFA0NA
     I              LHBZNA                          WFBZNA
     I              LHXMCD                          WFXMCD
     I              LHAIC3                          WFAIC3
     I              LHC4NB                          WFC4NB
      *
     I@LHCPQR
      * Load Order Change Log     Load ID/Seg Num-1
      * Renamed input format fields
     I              LHK4DT                          WGK4DT
     I              LHA1TM                          WGA1TM
     I              LHDXNB                          WGDXNB
     I              LHRMNB                          WGRMNB
     I              LHRVNB                          WGRVNB
     I              LHRVST                          WGRVST
     I              LHUJST                          WGUJST
     I              LHMNTX                          WGMNTX
     I              LHMOTX                          WGMOTX
     I              LHAYNA                          WGAYNA
     I              LHA0NA                          WGA0NA
     I              LHBZNA                          WGBZNA
     I              LHXMCD                          WGXMCD
     I              LHAIC3                          WGAIC3
     I              LHC4NB                          WGC4NB
      *
     I@LHCPN6
      * Load Order Change Log     Update index
      * Renamed input format fields
     I              LHK4DT                          WHK4DT
     I              LHA1TM                          WHA1TM
     I              LHDXNB                          WHDXNB
     I              LHRMNB                          WHRMNB
     I              LHRVNB                          WHRVNB
     I              LHRVST                          WHRVST
     I              LHUJST                          WHUJST
     I              LHMNTX                          WHMNTX
     I              LHMOTX                          WHMOTX
     I              LHAYNA                          WHAYNA
     I              LHA0NA                          WHA0NA
     I              LHBZNA                          WHBZNA
     I              LHXMCD                          WHXMCD
     I              LHAIC3                          WHAIC3
     I              LHC4NB                          WHC4NB
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     IYARDCS      DS                            779
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      * Outward parameters
     IPARC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Order Number
     I                                    P   3   60PAC4NB
      * I :  Order Type - Sales
     I                                        7   8 PAJNCD
      * I :  A/R Customer Number
     I                                    P   9  120PAANC7
      * I :  Ship To Customer
     I                                    P  13  160PABKC7
      * I :  Ship To Name
     I                                       17  46 PABRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PAHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PAHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PAHPNA
      * I :  Ship To City
     I                                      137 156 PAHNNA
      * I :  Ship To State Code
     I                                      157 158 PADBCD
      * I :  Ship To Zip/Postal Code
     I                                      159 169 PACKTX
      * I :  Bill to Customer
     I                                    P 170 1730PAB0C7
      * I :  Bill to Name
     I                                      174 203 PAAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PAB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PAB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PAB4NA
      * I :  Bill to City
     I                                      294 313 PAB2NA
      * I :  Bill to State Code
     I                                      314 315 PABHCD
      * I :  Bill to Zip/Postal Code
     I                                      316 326 PAC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PABCNA
      * I :  Order Date
     I                                    P 342 3450PAA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PAA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PAGNDT
      * I :  Cancel Date
     I                                    P 354 3570PAACDT
      * I :  Terms Code
     I                                      358 359 PAAQCD
      * I :  Special Instructions
     I                                      360 399 PAB6NA
      * I :  Special Instructions 2
     I                                      400 439 PABYNA
      * I :  Carrier Code
     I                                      440 442 PABZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PAGTST
      * I :  Comment Print Inv/Cr.Memo
     I                                      444 444 PAGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PAGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PAQFST
      * I :  Reason Code
     I                                      447 449 PACQCD
      * I :  Order in Use
     I                                      450 450 PAGJST
      * I :  Header Status
     I                                      451 451 PAGWST
      * I :  Header Status Last
     I                                      452 452 PAGXST
      * I :  Order Type Print Status
     I                                      453 453 PAGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PAAODT
      * I :  User Original Entry
     I                                      458 467 PAAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PACXDT
      * I :  Order Value Total
     I                                    P 472 4772PAJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PAA1WG
      * I :  Credit Hold
     I                                      484 484 PAXIST
      * I :  Production Hold
     I                                      485 485 PAXJST
      * I :  New Customer Hold
     I                                      486 486 PAXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PAEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PAAFTM
      * I :  Accounts Receiv. Ent 1
     I                                      494 497 PAE8CD
      * I :  Accounts Receiv. Ent 2
     I                                      498 509 PAE9CD
      * I :  Load ID
     I                                    P 510 5130PARMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PATBNB
      * I :  Rated Freight
     I                                    P 517 5222PAR1NB
      * I :  LTL Flag
     I                                      523 523 PAPJST
      * I :  Price Audit
     I                                      524 524 PAU0ST
      * I :  Price Status
     I                                      525 525 PAU1ST
      * I :  Shipping Method
     I                                      526 527 PAQ2CD
      * I :  Export Status
     I                                      528 528 PAU2ST
      * I :  Palletize
     I                                      529 529 PAVEST
      * I :  Shrink Wrap
     I                                      530 530 PAVFST
      * I :  Slip Sheet
     I                                      531 531 PAVGST
      * I :  Age Code
     I                                      532 532 PARPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PARNNB
      * I :  Load Type
     I                                      536 536 PAVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PAATIN
      * I :  Load Plan Order
     I                                      541 541 PAU4ST
      * I :  Print Pick Slip
     I                                      542 542 PAU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PARSRN
      * I :  Special Comment 1
     I                                      547 576 PAMHNA
      * I :  Special Comment 2
     I                                      577 606 PAMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PAWBST
      * I :  Sales Route Code
     I                                      608 610 PAR4CD
      * I :  Manager Level Code
     I                                      611 612 PABFCD
      * I :  VP Level Code
     I                                      613 615 PAQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PAT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PASICD
      * I :  Invoice Number
     I                                    P 623 6260PACONB
      * I :  Invoice Suffix
     I                                      627 628 PACEST
      * I :  Invoice Date
     I                                    P 629 6320PAAWDT
      * I :  Event Code
     I                                      633 634 PAJPCD
      * I :  Trans Contol AS400_Plant
     I                                      635 635 PAXUST
      * I :  Modified Flag
     I                                      636 636 PAZ1ST
      * I :  A/R order Value Total
     I                                    P 637 6422PAVRVA
      * I :  Billing Activity Type
     I                                      643 643 PAOBST
      * I :  Block Order Flag
     I                                      644 644 PABCST
      * I :  Order Certification Flag
     I                                      645 645 PABDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PAB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PAGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PAGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PAGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PAGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PAFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PAFOSX
      * I :  Order Emailed
     I                                      658 658 PAFPSX
      * I :  Export Docs Go w/Driver
     I                                      659 659 PAFQSX
      * I :  Shipping Temp Code C/F
     I                                      660 660 PAFRSX
      * I :  Broker Order Status
     I                                      661 661 PAFSSX
      * I :  Air Freight Order
     I                                      662 662 PAFTSX
      * I :  Order Requires Review
     I                                      663 664 PAFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PAFVSX
      * I :  Export USDA Approved
     I                                      667 668 PAFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PAFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PAFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PANODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PANPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PANQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PANRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PANSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PABPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PABQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PABRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PABSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PABTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PAH0NX
      * I :  Act Non-Ref Frt Amount
     I                                    P 721 7262PAH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PAH2NX
      * I :  OH Total Non-Ref Frt Amt
     I                                    P 733 7382PAH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PAH4NX
      * I :  Claim Number
     I                                    P 745 7480PAC0C7
      * I :  EDI Status 1
     I                                      749 749 PAUVST
      * I :  EDI Status 2
     I                                      750 750 PAUWST
      * I :  EDI Status 3
     I                                      751 751 PAUXST
      * I :  Job Time
     I                                    P 752 7550PAAATM
      * I :  User Id
     I                                      756 765 PAAYNA
      * I :  Job Name
     I                                      766 775 PAA0NA
      * I :  Job Date
     I                                    P 776 7790PAAXDT
      *
     IQPMAM1    E DSPMAMREL0
      * UPD : Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                          WCAIC3
     I              AMC4NB                          WCC4NB
     I              AMRMNB                          WCRMNB
     I              AMRUNB                          WCRUNB
     I              AMXACD                          WCXACD
     I              AMOANA                          WCOANA
     I              AMHBAA                          WCHBAA
     I              AMJ0T1                          WCJ0T1
     I              AMGENY                          WCGENY
     I              AMJ1T1                          WCJ1T1
     I              AMHCAA                          WCHCAA
     I              AMQWDT                          WCQWDT
     I              AMQXDT                          WCQXDT
     I              AMQYDT                          WCQYDT
     I              AMHDAA                          WCHDAA
     I              AMCCTX                          WCCCTX
     I              AMJ2T1                          WCJ2T1
     I              AMRLNA                          WCRLNA
     I              AMRMNA                          WCRMNA
     I              AMGINY                          WCGINY
     I              AMGFNY                          WCGFNY
     I              AMGGNY                          WCGGNY
     I              AMGHNY                          WCGHNY
     I              AMHEVL                          WCHEVL
     I              AMHFVL                          WCHFVL
     I              AMHGVL                          WCHGVL
     I              AMQZDT                          WCQZDT
     I              AMQ0DT                          WCQ0DT
     I              AMQ1DT                          WCQ1DT
     I              AMQ2DT                          WCQ2DT
     I              AMC2TX                          WCC2TX
     I              AMC3TX                          WCC3TX
     I              AMC6TX                          WCC6TX
     I              AMCHTX                          WCCHTX
     I              AMCITX                          WCCITX
     I              AMCLTX                          WCCLTX
     I              AMB4TX                          WCB4TX
     I              AMCUTX                          WCCUTX
     I              AMCVTX                          WCCVTX
     I              AMB9TX                          WCB9TX
     I              AMJWSC                          WCJWSC
     I              AMITNY                          WCITNY
     I              AMLMT1                          WCLMT1
     I              AMLWAA                          WCLWAA
     I              AMFVST                          WCFVST
     I              AMF0ST                          WCF0ST
     I              AMF2ST                          WCF2ST
     I              AMF3ST                          WCF3ST
     I              AMJUSC                          WCJUSC
     I              AMJVSC                          WCJVSC
     I              AMV3T1                          WCV3T1
     I              AMV4T1                          WCV4T1
     I              AMV5T1                          WCV5T1
     I              AMV6T1                          WCV6T1
     I              AMV7T1                          WCV7T1
     I              AMV8T1                          WCV8T1
     I              AMV9T1                          WCV9T1
     I              AMWAT1                          WCWAT1
     I              AMWBT1                          WCWBT1
     I              AMWCT1                          WCWCT1
     I              AMWDT1                          WCWDT1
     I              AMQJNY                          WCQJNY
     I              AMQKNY                          WCQKNY
     I              AMQLNY                          WCQLNY
     I              AMP8NY                          WCP8NY
     I              AMP9NY                          WCP9NY
     I              AMQANY                          WCQANY
     I              AMQCNY                          WCQCNY
     I              AMQDNY                          WCQDNY
     I              AMQENY                          WCQENY
     I              AMQFNY                          WCQFNY
     I              AMQGNY                          WCQGNY
     I              AMQHNY                          WCQHNY
     I              AMQINY                          WCQINY
     I              AMQMNY                          WCQMNY
     I              AMMYU1                          WCMYU1
     I              AMJXSC                          WCJXSC
     I              AMJYSC                          WCJYSC
     I              AMJZSC                          WCJZSC
     I              AMJ0SC                          WCJ0SC
     I              AMMZU1                          WCMZU1
     I              AMM0U1                          WCM0U1
     I              AMM1U1                          WCM1U1
     I              AMM2U1                          WCM2U1
     I              AMM3U1                          WCM3U1
     I              AMW5DT                          WCW5DT
     I              AMW6DT                          WCW6DT
     I              AMUVST                          WCUVST
     I              AMUWST                          WCUWST
     I              AMUXST                          WCUXST
     I              AMVSST                          WCVSST
     I              AMAATM                          WCAATM
     I              AMAYNA                          WCAYNA
     I              AMA0NA                          WCA0NA
     I              AMAXDT                          WCAXDT
      *
     IYBRDCS      DS                            894
     IQOMFL1    E DSOMFLCPL0
      * UPD : Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WERMNB
     I              FLRUNB                          WERUNB
     I              FLRVNB                          WERVNB
     I              FLDQTX                          WEDQTX
     I              FLRWNB                          WERWNB
     I              FLRXNB                          WERXNB
     I              FLSQNB                          WESQNB
     I              FLT0NB                          WET0NB
     I              FLT1NB                          WET1NB
     I              FLR1NB                          WER1NB
     I              FLAIC3                          WEAIC3
     I              FLC4NB                          WEC4NB
     I              FLVCST                          WEVCST
     I              FLKEDT                          WEKEDT
     I              FLSXNB                          WESXNB
     I              FLKFDT                          WEKFDT
     I              FLACTM                          WEACTM
     I              FLK5TX                          WEK5TX
     I              FLW5CD                          WEW5CD
     I              FLEJDT                          WEEJDT
     I              FLAGTM                          WEAGTM
     I              FLKJDT                          WEKJDT
     I              FLATTM                          WEATTM
     I              FLHDDT                          WEHDDT
     I              FLAUTM                          WEAUTM
     I              FLKKDT                          WEKKDT
     I              FLAVTM                          WEAVTM
     I              FLZ4NB                          WEZ4NB
     I              FLY7ST                          WEY7ST
     I              FLY2ST                          WEY2ST
     I              FLWHTX                          WEWHTX
     I              FLWITX                          WEWITX
     I              FLWJTX                          WEWJTX
     I              FLWKTX                          WEWKTX
     I              FLWLTX                          WEWLTX
     I              FLN7DT                          WEN7DT
     I              FLN8DT                          WEN8DT
     I              FLN9DT                          WEN9DT
     I              FLB3TM                          WEB3TM
     I              FLB4TM                          WEB4TM
     I              FLB5TM                          WEB5TM
     I              FLIASX                          WEIASX
     I              FLIBSX                          WEIBSX
     I              FLICSX                          WEICSX
     I              FLWVTX                          WEWVTX
     I              FLWWTX                          WEWWTX
     I              FLWXTX                          WEWXTX
     I              FLUVST                          WEUVST
     I              FLUWST                          WEUWST
     I              FLUXST                          WEUXST
     I              FLAATM                          WEAATM
     I              FLAYNA                          WEAYNA
     I              FLA0NA                          WEA0NA
     I              FLAXDT                          WEAXDT
      *
     IQPDLH1    E DSPDLHCPL0
      * UPD : Load Order Change Log     Update index
      * Renamed input format fields
     I              LHK4DT                          WHK4DT
     I              LHA1TM                          WHA1TM
     I              LHDXNB                          WHDXNB
     I              LHRMNB                          WHRMNB
     I              LHRVNB                          WHRVNB
     I              LHRVST                          WHRVST
     I              LHUJST                          WHUJST
     I              LHMNTX                          WHMNTX
     I              LHMOTX                          WHMOTX
     I              LHAYNA                          WHAYNA
     I              LHA0NA                          WHA0NA
     I              LHBZNA                          WHBZNA
     I              LHXMCD                          WHXMCD
     I              LHAIC3                          WHAIC3
     I              LHC4NB                          WHC4NB
      *
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Header TRG
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Order Number
     I                                    P   3   60P1C4NB
      * I :  Load ID
     I                                    P   7  100P1RMNB
     IP2PARM      DS
      * B :  Status - Y or N
     I                                        1   1 P2B8ST
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P1RMNB    PARM           WP0003  70       Load ID
     C           P2B8ST    PARM P2B8ST    WP0004  1        Status - Y or N
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Exc Remove order f/Ld XF
      * W98652 DN  01/31/22-Moved Validations to PDVLDFR; Opt 15=Remove O
      * -Commented Out & Moved Logic Below to Update.
      * RTV Chg Ld to 0       RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0001           Company Number
     C                     Z-ADDP1C4NB    WL0002           Order Number
     C                     MOVEL*BLANK    WL0003           Carrier Code
     C                     Z-ADD0         WL0004           Load ID
     C                     EXSR SARVGN
      * CHG OHE Load ID        CH - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0005           Company Number
     C                     Z-ADDP1C4NB    WL0006           Order Number
     C                     Z-ADD0         WL0007           Load ID
     C                     EXSR SCCHRC
      * DLT Order from load   RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1RMNB    WL0008           Load ID
     C                     Z-ADDP1C4NB    WL0009           Order Number
     C                     EXSR SDRVGN
      * Create Log for Load Removal.
     C                     MOVEL*BLANK    YL0001           Load Alpha
     C                     MOVELP1RMNB    YL0001           Load Alpha
      * CRT Load/Order Chg Log IF
      * CASE: PAR.Load ID is Blank
     C           P1RMNB    IFEQ 0                          *IF
      * RTV Next Key f/crt dt RT - Load Order Change Log  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD##JDT     WL0010           Created Date
     C                     Z-ADD##JTM     WL0011           Created Time
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0012    YL0002           Sequence Number
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Next Key           RT - Load Order Change Log  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1RMNB    WL0013           Load ID
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0014    YL0002           Sequence Number
     C                     END                             *FI
      * Use system date/time to minimize dup record creation
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           YL0003    PARM *ZERO     WQ0001 155       Current System
     C           YL0004    PARM *ZERO     WQ0002 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * CRT Load/Order Chg Log CR - Load Order Change Log  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0003    WL0015           Created Date
     C                     Z-ADDYL0004    WL0016           Created Time
     C                     Z-ADDYL0002    WL0017           Sequence Number
     C                     Z-ADDP1RMNB    WL0018           Load ID
     C                     Z-ADD*ZERO     WL0019           Stop/Drop
     C                     MOVEL'DELORD'  WL0020    P      Load Change Typ
     C                     MOVEL'SHP'     WL0021    P      Department Cont
     C                     MOVELYL0001    WL0022    P      Change Log Prio
     C                     MOVEL*BLANK    WL0023           Change Log New
     C                     MOVEL##USR     WL0024    P      User Id
     C                     MOVEL##PGM     WL0025    P      Job Name
     C                     MOVEL*BLANK    WL0026           Carrier Code
     C                     MOVEL*BLANK    WL0027           Carrier Broker
     C                     Z-ADDP1AIC3    WL0028           Company Number
     C                     Z-ADDP1C4NB    WL0029           Order Number
     C                     EXSR SHCRRC
      * Add seconds until it can be added successfully
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ @CN,001                    *IF
      * LCL.Created Time = LCL.Current System Time
     C                     Z-ADDYL0004    YL0005           Created Time
      * DO WHILE: PGM.*Return code is *Record already exists
     C           W0RTN     DOWEQ@CN,001                    *DOW
      * LCL.Created Time = LCL.Created Time + CON.1 *SECONDS
     C                     Z-ADDYL0005    XTTIM
     C                     Z-ADD*ZERO     XASC    80
     C                     EXSR XTAD1
     C                     ADD  1         XASC    80
     C                     EXSR XTCT1
     C                     Z-ADDXTTIM     YL0005
      * CRT Load/Order Chg Log CR - Load Order Change Log  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0003    WL0015           Created Date
     C                     Z-ADDYL0005    WL0016           Created Time
     C                     Z-ADDYL0002    WL0017           Sequence Number
     C                     Z-ADDP1RMNB    WL0018           Load ID
     C                     Z-ADD*ZERO     WL0019           Stop/Drop
     C                     MOVEL'DELORD'  WL0020    P      Load Change Typ
     C                     MOVEL'SHP'     WL0021    P      Department Cont
     C                     MOVELYL0001    WL0022    P      Change Log Prio
     C                     MOVEL*BLANK    WL0023           Change Log New
     C                     MOVEL##USR     WL0024    P      User Id
     C                     MOVEL##PGM     WL0025    P      Job Name
     C                     MOVEL*BLANK    WL0026           Carrier Code
     C                     MOVEL*BLANK    WL0027           Carrier Broker
     C                     Z-ADDP1AIC3    WL0028           Company Number
     C                     Z-ADDP1C4NB    WL0029           Order Number
     C                     EXSR SHCRRC
     C                     END                             *ITR
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Chg Ld to 0       RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0001    WAAIC3           Company Number
     C                     Z-ADDWL0002    WAC4NB           Order Number
      * Establish starting position
     C           KRSSA     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CHG Load ID            CH - Order Header TRG  * 
     C                     EXSR SBCHRC
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCHRC    BEGSR
      *================================================================
      * CHG Load ID            CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0002  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0003  70       Ship To Custome
     C                     MOVEL*BLANK    WN0004 30        Ship To Name
     C                     MOVEL*BLANK    WN0005 30        Ship To Address
     C                     MOVEL*BLANK    WN0006 30        Ship To Address
     C                     MOVEL*BLANK    WN0007 30        Ship To Address
     C                     MOVEL*BLANK    WN0008 20        Ship To City
     C                     MOVEL*BLANK    WN0009  2        Ship To State C
     C                     MOVEL*BLANK    WN0010 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0011  70       Bill to Custome
     C                     MOVEL*BLANK    WN0012 30        Bill to Name
     C                     MOVEL*BLANK    WN0013 30        Bill to Address
     C                     MOVEL*BLANK    WN0014 30        Bill to Address
     C                     MOVEL*BLANK    WN0015 30        Bill to Address
     C                     MOVEL*BLANK    WN0016 20        Bill to City
     C                     MOVEL*BLANK    WN0017  2        Bill to State C
     C                     MOVEL*BLANK    WN0018 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0019 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0020  70       Order Date
     C                     Z-ADD*ZERO     WN0021  70       Requested Ship
     C                     Z-ADD*ZERO     WN0022  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0023  70       Cancel Date
     C                     MOVEL*BLANK    WN0024  2        Terms Code
     C                     MOVEL*BLANK    WN0025 40        Special Instruc
     C                     MOVEL*BLANK    WN0026 40        Special Instruc
     C                     MOVEL*BLANK    WN0027  3        Carrier Code
     C                     MOVEL*BLANK    WN0028  1        Comment Print A
     C                     MOVEL*BLANK    WN0029  1        Comment Print I
     C                     MOVEL*BLANK    WN0030  1        Comment Print P
     C                     MOVEL*BLANK    WN0031  1        Comment Print S
     C                     MOVEL*BLANK    WN0032  3        Reason Code
     C                     MOVEL*BLANK    WN0033  1        Order in Use
     C                     MOVEL*BLANK    WN0034  1        Header Status
     C                     MOVEL*BLANK    WN0035  1        Header Status L
     C                     MOVEL*BLANK    WN0036  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0037  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0038 10        User Original E
     C                     Z-ADD*ZERO     WN0039  70       Date of Origina
     C                     Z-ADD*ZERO     WN0040 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0041 112       Order Weight To
     C                     MOVEL*BLANK    WN0042  1        Credit Hold
     C                     MOVEL*BLANK    WN0043  1        Production Hold
     C                     MOVEL*BLANK    WN0044  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0045  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0046  40       Requested Deliv
     C                     MOVEL*BLANK    WN0047  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0048 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0049  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0050 112       Rated Freight
     C                     MOVEL*BLANK    WN0051  1        LTL Flag
     C                     MOVEL*BLANK    WN0052  1        Price Audit
     C                     MOVEL*BLANK    WN0053  1        Price Status
     C                     MOVEL*BLANK    WN0054  2        Shipping Method
     C                     MOVEL*BLANK    WN0055  1        Export Status
     C                     MOVEL*BLANK    WN0056  1        Palletize
     C                     MOVEL*BLANK    WN0057  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0058  1        Slip Sheet
     C                     MOVEL*BLANK    WN0059  1        Age Code
     C                     Z-ADD*ZERO     WN0060  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0061  1        Load Type
     C                     Z-ADD*ZERO     WN0062  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0063  1        Load Plan Order
     C                     MOVEL*BLANK    WN0064  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0065  70       Resell Referenc
     C                     MOVEL*BLANK    WN0066 30        Special Comment
     C                     MOVEL*BLANK    WN0067 30        Special Comment
     C                     MOVEL*BLANK    WN0068  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0069  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0070  2        Manager Level C
     C                     MOVEL*BLANK    WN0071  3        VP Level Code
     C                     Z-ADD*ZERO     WN0072  70       Attach to Order
     C                     MOVEL*BLANK    WN0073  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0074  70       Invoice Number
     C                     MOVEL*BLANK    WN0075  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0076  70       Invoice Date
     C                     MOVEL*BLANK    WN0077  2        Event Code
     C                     MOVEL*BLANK    WN0078  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0079  1        Modified Flag
     C                     Z-ADD*ZERO     WN0080 112       A/R order Value
     C                     MOVEL*BLANK    WN0081  1        Billing Activit
     C                     MOVEL*BLANK    WN0082  1        Block Order Fla
     C                     MOVEL*BLANK    WN0083  1        Order Certifica
     C                     Z-ADD*ZERO     WN0084 112       Invoice Order V
     C                     MOVEL*BLANK    WN0085  1        Process Sts for
     C                     MOVEL*BLANK    WN0086  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0087  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0088  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0089  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0090  1        Email Cust On O
     C                     MOVEL*BLANK    WN0091  1        Order Emailed
     C                     MOVEL*BLANK    WN0092  1        Export Docs Go
     C                     MOVEL*BLANK    WN0093  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0094  1        Broker Order St
     C                     MOVEL*BLANK    WN0095  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0096  2        Order Requires
     C                     MOVEL*BLANK    WN0097  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0098  2        Export USDA App
     C                     MOVEL*BLANK    WN0099  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0100  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0101  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0102  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0103  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0104  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0105  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0106  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0107  60       Time of Origina
     C                     Z-ADD*ZERO     WN0108  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0109  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0110  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0111 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0112 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0113 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0114 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0115 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0116  70       Claim Number
     C                     MOVEL*BLANK    WN0117  1        EDI Status 1
     C                     MOVEL*BLANK    WN0118  1        EDI Status 2
     C                     MOVEL*BLANK    WN0119  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0120  60       Job Time
     C                     MOVEL*BLANK    WN0121 10        User Id
     C                     MOVEL*BLANK    WN0122 10        Job Name
     C                     Z-ADD*ZERO     WN0123  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWAAIC3    WBAIC3           Company Number
     C                     Z-ADDWAC4NB    WBC4NB           Order Number
      *
     C           KLCHSB    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
     C           KLCHSB    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YARDCS
      * Move non-key fields to @BECPFJ
     C                     Z-ADDWL0004    WBRMNB           Load ID
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WBAATM           Job Time
     C                     MOVEL##USR     WBAYNA           User Id
     C                     MOVEL##PGM     WBA0NA           Job Name
     C                     Z-ADD##JDT     WBAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPARC
     C                     Z-ADDWBAIC3    PAAIC3           Company Number
     C                     Z-ADDWBC4NB    PAC4NB           Order Number
     C                     MOVELWBJNCD    PAJNCD    P      Order Type - Sa
     C                     Z-ADDWBANC7    PAANC7           A/R Customer Nu
     C                     Z-ADDWBBKC7    PABKC7           Ship To Custome
     C                     MOVELWBBRTX    PABRTX    P      Ship To Name
     C                     MOVELWBHMNA    PAHMNA    P      Ship To Address
     C                     MOVELWBHONA    PAHONA    P      Ship To Address
     C                     MOVELWBHPNA    PAHPNA    P      Ship To Address
     C                     MOVELWBHNNA    PAHNNA    P      Ship To City
     C                     MOVELWBDBCD    PADBCD    P      Ship To State C
     C                     MOVELWBCKTX    PACKTX    P      Ship To Zip/Pos
     C                     Z-ADDWBB0C7    PAB0C7           Bill to Custome
     C                     MOVELWBAETX    PAAETX    P      Bill to Name
     C                     MOVELWBB1NA    PAB1NA    P      Bill to Address
     C                     MOVELWBB3NA    PAB3NA    P      Bill to Address
     C                     MOVELWBB4NA    PAB4NA    P      Bill to Address
     C                     MOVELWBB2NA    PAB2NA    P      Bill to City
     C                     MOVELWBBHCD    PABHCD    P      Bill to State C
     C                     MOVELWBC8TX    PAC8TX    P      Bill to Zip/Pos
     C                     MOVELWBBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDWBA0DT    PAA0DT           Order Date
     C                     Z-ADDWBA5DT    PAA5DT           Requested Ship
     C                     Z-ADDWBGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDWBACDT    PAACDT           Cancel Date
     C                     MOVELWBAQCD    PAAQCD    P      Terms Code
     C                     MOVELWBB6NA    PAB6NA    P      Special Instruc
     C                     MOVELWBBYNA    PABYNA    P      Special Instruc
     C                     MOVELWBBZNA    PABZNA    P      Carrier Code
     C                     MOVELWBGTST    PAGTST    P      Comment Print A
     C                     MOVELWBGVST    PAGVST    P      Comment Print I
     C                     MOVELWBGUST    PAGUST    P      Comment Print P
     C                     MOVELWBQFST    PAQFST    P      Comment Print S
     C                     MOVELWBCQCD    PACQCD    P      Reason Code
     C                     MOVELWBGJST    PAGJST    P      Order in Use
     C                     MOVELWBGWST    PAGWST    P      Header Status
     C                     MOVELWBGXST    PAGXST    P      Header Status L
     C                     MOVELWBGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDWBAODT    PAAODT           Scheduled Ship
     C                     MOVELWBAIVN    PAAIVN    P      User Original E
     C                     Z-ADDWBCXDT    PACXDT           Date of Origina
     C                     Z-ADDWBJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDWBA1WG    PAA1WG           Order Weight To
     C                     MOVELWBXIST    PAXIST    P      Credit Hold
     C                     MOVELWBXJST    PAXJST    P      Production Hold
     C                     MOVELWBXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDWBEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDWBAFTM    PAAFTM           Requested Deliv
     C                     MOVELWBE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELWBE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDWBRMNB    PARMNB           Load ID
     C                     Z-ADDWBTBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDWBR1NB    PAR1NB           Rated Freight
     C                     MOVELWBPJST    PAPJST    P      LTL Flag
     C                     MOVELWBU0ST    PAU0ST    P      Price Audit
     C                     MOVELWBU1ST    PAU1ST    P      Price Status
     C                     MOVELWBQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELWBU2ST    PAU2ST    P      Export Status
     C                     MOVELWBVEST    PAVEST    P      Palletize
     C                     MOVELWBVFST    PAVFST    P      Shrink Wrap
     C                     MOVELWBVGST    PAVGST    P      Slip Sheet
     C                     MOVELWBRPCD    PARPCD    P      Age Code
     C                     Z-ADDWBRNNB    PARNNB           Reefer Temperat
     C                     MOVELWBVDST    PAVDST    P      Load Type
     C                     Z-ADDWBATIN    PAATIN           Attach to Invoi
     C                     MOVELWBU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELWBU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDWBRSRN    PARSRN           Resell Referenc
     C                     MOVELWBMHNA    PAMHNA    P      Special Comment
     C                     MOVELWBMINA    PAMINA    P      Special Comment
     C                     MOVELWBWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELWBR4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELWBBFCD    PABFCD    P      Manager Level C
     C                     MOVELWBQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDWBT3NB    PAT3NB           Attach to Order
     C                     MOVELWBSICD    PASICD    P      Reason for Pric
     C                     Z-ADDWBCONB    PACONB           Invoice Number
     C                     MOVELWBCEST    PACEST    P      Invoice Suffix
     C                     Z-ADDWBAWDT    PAAWDT           Invoice Date
     C                     MOVELWBJPCD    PAJPCD    P      Event Code
     C                     MOVELWBXUST    PAXUST    P      Trans Contol AS
     C                     MOVELWBZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDWBVRVA    PAVRVA           A/R order Value
     C                     MOVELWBOBST    PAOBST    P      Billing Activit
     C                     MOVELWBBCST    PABCST    P      Block Order Fla
     C                     MOVELWBBDST    PABDST    P      Order Certifica
     C                     Z-ADDWBB7VL    PAB7VL           Invoice Order V
     C                     MOVELWBGASX    PAGASX    P      Process Sts for
     C                     MOVELWBGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELWBGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELWBGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELWBFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELWBFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELWBFPSX    PAFPSX    P      Order Emailed
     C                     MOVELWBFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELWBFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELWBFSSX    PAFSSX    P      Broker Order St
     C                     MOVELWBFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELWBFUSX    PAFUSX    P      Order Requires
     C                     MOVELWBFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELWBFWSX    PAFWSX    P      Export USDA App
     C                     MOVELWBFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELWBFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDWBNODT    PANODT           OH Appt Confirm
     C                     Z-ADDWBNPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDWBNQDT    PANQDT           Load Actual Shi
     C                     Z-ADDWBNRDT    PANRDT           Load BOL Comple
     C                     Z-ADDWBNSDT    PANSDT           Load Truck Depa
     C                     Z-ADDWBBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDWBBQTM    PABQTM           Time of Origina
     C                     Z-ADDWBBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDWBBSTM    PABSTM           Load BOL Comple
     C                     Z-ADDWBBTTM    PABTTM           Load Truck Depa
     C                     Z-ADDWBH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDWBH1NX    PAH1NX           Act Non-Ref Frt
     C                     Z-ADDWBH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDWBH3NX    PAH3NX           OH Total Non-Re
     C                     Z-ADDWBH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDWBC0C7    PAC0C7           Claim Number
     C                     MOVELWBUVST    PAUVST    P      EDI Status 1
     C                     MOVELWBUWST    PAUWST    P      EDI Status 2
     C                     MOVELWBUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDWBAATM    PAAATM           Job Time
     C                     MOVELWBAYNA    PAAYNA    P      User Id
     C                     MOVELWBA0NA    PAA0NA    P      Job Name
     C                     Z-ADDWBAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCHRC    BEGSR
      *================================================================
      * CHG OHE Load ID        CH - Order Header Extension  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0124  50       Stop/Drop Seque
     C                     MOVEL*BLANK    WN0125  3        Shipping Line
     C                     MOVEL*BLANK    WN0126 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0127 25        OHE City
     C                     MOVEL*BLANK    WN0128 30        OHE Vessel/Airl
     C                     MOVEL*BLANK    WN0129 15        OHE Voyage/Flig
     C                     MOVEL*BLANK    WN0130 15        OHE Booking Num
     C                     MOVEL*BLANK    WN0131 20        OHE Discharge P
     C                     Z-ADD*ZERO     WN0132  70       OHE Sail/Flight
     C                     Z-ADD*ZERO     WN0133  70       OHE Port Cut Da
     C                     Z-ADD*ZERO     WN0134  70       OHE Arrival Dat
     C                     MOVEL*BLANK    WN0135  3        OHE Late Delive
     C                     MOVEL*BLANK    WN0136  1        OHE Ship Status
     C                     MOVEL*BLANK    WN0137 12        OHE Container N
     C                     MOVEL*BLANK    WN0138 35        OHE Comment 1
     C                     MOVEL*BLANK    WN0139 75        OHE Comment 2
     C                     Z-ADD*ZERO     WN0140 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0141 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0142 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0143 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0144 112       OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WN0145 112       OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WN0146 112       Transload Termi
     C                     Z-ADD*ZERO     WN0147  70       OHE Est Arrv at
     C                     Z-ADD*ZERO     WN0148  70       OHE Backhaul ET
     C                     Z-ADD*ZERO     WN0149  70       OHE Port/Pier P
     C                     Z-ADD*ZERO     WN0150  70       OHE Actual Ship
     C                     MOVEL*BLANK    WN0151  4        OHE Carrier SCA
     C                     MOVEL*BLANK    WN0152  4        OHE Spot Buy
     C                     MOVEL*BLANK    WN0153  4        OHE PO ACK Flag
     C                     MOVEL*BLANK    WN0154  2        OHE Override Ty
     C                     MOVEL*BLANK    WN0155  2        OHE Backhaul St
     C                     MOVEL*BLANK    WN0156  2        OHE Backhaul ET
     C                     MOVEL*BLANK    WN0157  3        OHE Load Haul T
     C                     MOVEL*BLANK    WN0158  3        OHE Backhaul Ca
     C                     MOVEL*BLANK    WN0159  3        OHE Bookings Co
     C                     MOVEL*BLANK    WN0160  5        OHE EDI Error R
     C                     MOVEL*BLANK    WN0161  5        OHE EDI Error R
     C                     Z-ADD*ZERO     WN0162  50       HPB COA Batch N
     C                     MOVEL*BLANK    WN0163 38        Delivery P.O. N
     C                     MOVEL*BLANK    WN0164  6        OHE Intended fo
     C                     MOVEL*BLANK    WN0165  6        OHE EDI 943 Act
     C                     MOVEL*BLANK    WN0166  6        OHE EDI 944 Act
     C                     MOVEL*BLANK    WN0167  6        OHE EDI 940 Act
     C                     MOVEL*BLANK    WN0168  6        OHE EDI 945 Act
     C                     MOVEL*BLANK    WN0169  1        OHE EDI 856 Act
     C                     MOVEL*BLANK    WN0170  1        OHE EDI 824 Act
     C                     MOVEL*BLANK    WN0171 10        OHE Transload S
     C                     MOVEL*BLANK    WN0172 10        OHE Abs Rate Ov
     C                     MOVEL*BLANK    WN0173 10        OHE Appt Confir
     C                     MOVEL*BLANK    WN0174 15        OHE Backhaul Co
     C                     MOVEL*BLANK    WN0175 15        OHE Backhaul Ch
     C                     MOVEL*BLANK    WN0176 15        OHE Transload C
     C                     MOVEL*BLANK    WN0177 30        OHE Pier Pass I
     C                     MOVEL*BLANK    WN0178 30        OHE Carrier Nm
     C                     MOVEL*BLANK    WN0179 30        OHE Appt Confir
     C                     MOVEL*BLANK    WN0180 50        OHE Backhaul Co
     C                     MOVEL*BLANK    WN0181 50        Letter of Credi
     C                     Z-ADD*ZERO     WN0182  30       OHE Backhaul Re
     C                     Z-ADD*ZERO     WN0183  30       LD Stop/Drop
     C                     Z-ADD*ZERO     WN0184  30       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0185  52       OHE Pier Pass F
     C                     Z-ADD*ZERO     WN0186  52       OHE Port Check
     C                     Z-ADD*ZERO     WN0187  50       OHE Port Cut Ti
     C                     Z-ADD*ZERO     WN0188  60       OHE Backhaul Tr
     C                     Z-ADD*ZERO     WN0189  60       OHE Load Sched
     C                     Z-ADD*ZERO     WN0190  60       Original Appoin
     C                     Z-ADD*ZERO     WN0191  60       Original Appoin
     C                     Z-ADD*ZERO     WN0192  90       OHE PowerPro Lo
     C                     Z-ADD*ZERO     WN0193  90       OHE PowerPro Lo
     C                     Z-ADD*ZERO     WN0194  90       OHE Unused Nume
     C                     Z-ADD*ZERO     WN0195  96       OHE Orig ABS Fr
     C                     MOVEL*BLANK    WN0196 15        OHE Genset Numb
     C                     MOVEL*BLANK    WN0197  1        OHE Email BOL/S
     C                     MOVEL*BLANK    WN0198  1        OHE EDI Order A
     C                     MOVEL*BLANK    WN0199  2        OHE EDI 601 Act
     C                     MOVEL*BLANK    WN0200  2        OHE Unused Stat
     C                     MOVEL*BLANK    WN0201  5        OHE Unused Text
     C                     MOVEL*BLANK    WN0202  5        OHE Unused Text
     C                     MOVEL*BLANK    WN0203 15        OHE Customer Ve
     C                     MOVEL*BLANK    WN0204 15        OHE EDI 824 AES
     C                     MOVEL*BLANK    WN0205 30        OHE Unused Text
     C                     Z-ADD*ZERO     WN0206  70       OHE Unused Date
     C                     Z-ADD*ZERO     WN0207  70       OHE Unused Date
     C                     MOVEL*BLANK    WN0208  1        EDI Status 1
     C                     MOVEL*BLANK    WN0209  1        EDI Status 2
     C                     MOVEL*BLANK    WN0210  1        EDI Status 3
     C                     MOVEL*BLANK    WN0211  1        Record Status
     C                     Z-ADD*ZERO     WN0212  60       Job Time
     C                     MOVEL*BLANK    WN0213 10        User Id
     C                     MOVEL*BLANK    WN0214 10        Job Name
     C                     Z-ADD*ZERO     WN0215  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @AMREJE
     C                     Z-ADDWL0005    WCAIC3           Company Number
     C                     Z-ADDWL0006    WCC4NB           Order Number
      *
     C           KLCHSC    KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
     C           KLCHSC    CHAIN@AMREJE              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PMAMREL0'MDACP
     C                     MOVEL'@AMREJE' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPMAM1    YBRDCS
      * Move non-key fields to @AMREJE
     C                     Z-ADDWL0007    WCRMNB           Load ID
      *
      * Set PGM.*Record Data Changed flag
     C           QPMAM1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WCAATM           Job Time
     C                     Z-ADD##JDT     WCAXDT           Job Date
     C                     MOVEL##PGM     WCA0NA           Job Name
     C                     MOVEL##USR     WCAYNA           User Id
      * Set PGM.*Record Data Changed flag
     C           QPMAM1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@AMREJE                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPMAMREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * DLT Order from load   RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDRMNB    WQSD01           Load ID
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Load ID
      * Setup key
     C                     Z-ADDWL0008    WQSD01           Load ID
      * Establish starting position
     C           KRSSD     SETLL@FLCPBW                    *
     C           KRSSD     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Order Number EQ DB1.Order Number
     C           WL0009    IFEQ WDC4NB                     *IF
      * DLT Load Detail        DL - Load Detail  * 
     C                     EXSR SEDLRC
     C                     GOTO SDEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSD     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SEDLRC    BEGSR
      *================================================================
      * DLT Load Detail        DL - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @FLCPBM
     C                     Z-ADDWDRMNB    WERMNB           Load ID
     C                     Z-ADDWDRUNB    WERUNB           Stop/Drop Seque
      *
     C           KLDLSE    KLIST
     C                     KFLD           WERMNB           Load ID
     C                     KFLD           WERUNB           Stop/Drop Seque
     C           KLDLSE    CHAIN@FLCPBM              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFLCPL0'MDACP
     C                     MOVEL'@FLCPBM' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@FLCPBM                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Next Key f/crt dt RT - Load Order Change Log  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         WL0012           Sequence Number
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFK4DT    WQSF01           Created Date
     C           *LIKE     DEFN WFA1TM    WQSF02           Created Time
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Created Date
     C                     KFLD           WQSF02           Created Time
      * Setup key
     C                     Z-ADDWL0010    WQSF01           Created Date
     C                     Z-ADDWL0011    WQSF02           Created Time
      * Establish starting position
     C           KRSSF     SETLL@LHCPBN                    *
     C           KRSSF     READE@LHCPBN                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2471' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WL0012           Sequence Number
     C                     GOTO SFEXIT                     *QUIT
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Sequence Number is EQ 999
     C           WFDXNB    IFEQ 999                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C           WFDXNB    ADD  1         WL0012           Sequence Number
     C                     GOTO SFEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSF     READE@LHCPBN                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Next Key           RT - Load Order Change Log  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         WL0014           Sequence Number
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGRMNB    WQSG02           Load ID
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG02           Load ID
      * Setup key
     C                     Z-ADDWL0013    WQSG02           Load ID
      * Establish starting position
     C           KRSSG     SETLL@LHCPQR                    *
     C           KRSSG     READE@LHCPQR                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2471' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WL0014           Sequence Number
     C                     GOTO SGEXIT                     *QUIT
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Sequence Number is EQ 999
     C           WGDXNB    IFEQ 999                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C           WGDXNB    ADD  1         WL0014           Sequence Number
     C                     GOTO SGEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSG     READE@LHCPQR                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCRRC    BEGSR
      *================================================================
      * CRT Load/Order Chg Log CR - Load Order Change Log  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @LHCPN6
     C                     Z-ADDWL0015    WHK4DT           Created Date
     C                     Z-ADDWL0016    WHA1TM           Created Time
     C                     Z-ADDWL0017    WHDXNB           Sequence Number
     C                     Z-ADDWL0018    WHRMNB           Load ID
     C                     Z-ADDWL0019    WHRVNB           Stop/Drop
     C                     MOVELWL0020    WHRVST           Load Change Typ
     C                     MOVELWL0021    WHUJST           Department Cont
     C                     MOVELWL0022    WHMNTX           Change Log Prio
     C                     MOVELWL0023    WHMOTX           Change Log New
     C                     MOVELWL0024    WHAYNA           User Id
     C                     MOVELWL0025    WHA0NA           Job Name
     C                     MOVELWL0026    WHBZNA           Carrier Code
     C                     MOVELWL0027    WHXMCD           Carrier Broker
     C                     Z-ADDWL0028    WHAIC3           Company Number
     C                     Z-ADDWL0029    WHC4NB           Order Number
      *
     C           KLCRSH    KLIST
     C                     KFLD           WHK4DT           Created Date
     C                     KFLD           WHA1TM           Created Time
     C                     KFLD           WHDXNB           Sequence Number
      * Check for duplicate primary key
     C           KLCRSH    SETLL@LHCPN6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2472' W0RTN   7
      * USER: Processing if Data record already exists
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C                     WRITE@LHCPN6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         XTAD1     BEGSR
      *================================================================
      * Add TME to absolute time (seconds)
      *================================================================
     C           XTHH      MULT 3600      XDWK1   80
     C                     ADD  XDWK1     XASC
     C           XTNN      MULT 60        XDWK1
     C                     ADD  XDWK1     XASC
     C                     ADD  XTSS      XASC
      *================================================================
     CSR         XTAD1E    ENDSR
      /EJECT
     CSR         XTCT1     BEGSR
      *================================================================
      * Convert absolute time (seconds) to TME
      *================================================================
     C                     EXSR XTFCT
     C           XASC      DIV  60        XASC
     C                     MVR            XTSS
     C           XASC      DIV  60        XASC
     C                     MVR            XTNN
     C                     Z-ADDXASC      XTHH
      *================================================================
     CSR         XTCT1E    ENDSR
      /EJECT
     CSR         XTFCT     BEGSR
      *================================================================
      * Factorize absolute date (seconds) by 24 hours
      *================================================================
     C           XASC      IFGE 86400
     C                     DIV  86400     XASC    80
     C                     MVR            XASC
     C                     ELSE
     C           XASC      IFLE *ZERO
     C                     DIV  86400     XASC
     C                     MVR            XASC
     C           XASC      IFNE *ZERO
     C                     ADD  86400     XASC
     C                     END
     C                     END
     C                     END
      *================================================================
     CSR         XTFCTE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WAA0DT           Order Date
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WAACDT           Cancel Date
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WAJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WAA1WG           Order Weight To
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WATBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WAATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WARSRN           Resell Referenc
     C                     Z-ADD*ZERO     WAT3NB           Attach to Order
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WAAWDT           Invoice Date
     C                     Z-ADD*ZERO     WAVRVA           A/R order Value
     C                     Z-ADD*ZERO     WAB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WANODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WANPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WANQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WANRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WANSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WABPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WABQTM           Time of Origina
     C                     Z-ADD*ZERO     WABRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WABSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WABTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WAH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WAH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WAH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WAH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WAH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WCQWDT           OHE Sail/Flight
     C                     Z-ADD*ZERO     WCQXDT           OHE Port Cut Da
     C                     Z-ADD*ZERO     WCQYDT           OHE Arrival Dat
     C                     Z-ADD*ZERO     WCGINY           OHE Unused Numb
     C                     Z-ADD*ZERO     WCGFNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WCGGNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WCGHNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WCHEVL           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WCHFVL           OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WCHGVL           Transload Termi
     C                     Z-ADD*ZERO     WCQZDT           OHE Est Arrv at
     C                     Z-ADD*ZERO     WCQ0DT           OHE Backhaul ET
     C                     Z-ADD*ZERO     WCQ1DT           OHE Port/Pier P
     C                     Z-ADD*ZERO     WCQ2DT           OHE Actual Ship
     C                     Z-ADD*ZERO     WCITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WCQJNY           OHE Backhaul Re
     C                     Z-ADD*ZERO     WCQKNY           LD Stop/Drop
     C                     Z-ADD*ZERO     WCQLNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WCP8NY           OHE Pier Pass F
     C                     Z-ADD*ZERO     WCP9NY           OHE Port Check
     C                     Z-ADD*ZERO     WCQANY           OHE Port Cut Ti
     C                     Z-ADD*ZERO     WCQCNY           OHE Backhaul Tr
     C                     Z-ADD*ZERO     WCQDNY           OHE Load Sched
     C                     Z-ADD*ZERO     WCQENY           Original Appoin
     C                     Z-ADD*ZERO     WCQFNY           Original Appoin
     C                     Z-ADD*ZERO     WCQGNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WCQHNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WCQINY           OHE Unused Nume
     C                     Z-ADD*ZERO     WCQMNY           OHE Orig ABS Fr
     C                     Z-ADD*ZERO     WCW5DT           OHE Unused Date
     C                     Z-ADD*ZERO     WCW6DT           OHE Unused Date
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WDRVNB           Stop/Drop
     C                     Z-ADD*ZERO     WDRWNB           Miles to next s
     C                     Z-ADD*ZERO     WDRXNB           Freight Charge
     C                     Z-ADD*ZERO     WDSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WDT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WDT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WDSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WDKFDT           Appointment Con
     C                     Z-ADD*ZERO     WDACTM           Appointment Con
     C                     Z-ADD*ZERO     WDEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WDAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WDKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WDATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WDHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WDAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WDKKDT           On Yard Date
     C                     Z-ADD*ZERO     WDAVTM           On Yard Time
     C                     Z-ADD*ZERO     WDZ4NB           MPC Number
     C                     Z-ADD*ZERO     WDN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WDN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WDN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WDB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WDB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WDB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFK4DT           Created Date
     C                     Z-ADD*ZERO     WFA1TM           Created Time
     C                     Z-ADD*ZERO     WFDXNB           Sequence Number
     C                     Z-ADD*ZERO     WFRMNB           Load ID
     C                     Z-ADD*ZERO     WFRVNB           Stop/Drop
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFC4NB           Order Number
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SARVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003  3
     C                     Z-ADD*ZERO     WL0004  70
      * Define local variables for subroutine SCCHRC.
     C                     Z-ADD*ZERO     WL0005  30
     C                     Z-ADD*ZERO     WL0006  70
     C                     Z-ADD*ZERO     WL0007  70
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0008  70
     C                     Z-ADD*ZERO     WL0009  70
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0010  70
     C                     Z-ADD*ZERO     WL0011  60
     C                     Z-ADD*ZERO     WL0012  30
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0013  70
     C                     Z-ADD*ZERO     WL0014  30
      * Define local variables for subroutine SHCRRC.
     C                     Z-ADD*ZERO     WL0015  70
     C                     Z-ADD*ZERO     WL0016  60
     C                     Z-ADD*ZERO     WL0017  30
     C                     Z-ADD*ZERO     WL0018  70
     C                     Z-ADD*ZERO     WL0019  50
     C                     MOVEL*BLANK    WL0020  6
     C                     MOVEL*BLANK    WL0021  3
     C                     MOVEL*BLANK    WL0022 12
     C                     MOVEL*BLANK    WL0023 12
     C                     MOVEL*BLANK    WL0024 10
     C                     MOVEL*BLANK    WL0025 10
     C                     MOVEL*BLANK    WL0026  3
     C                     MOVEL*BLANK    WL0027  3
     C                     Z-ADD*ZERO     WL0028  30
     C                     Z-ADD*ZERO     WL0029  70
      * Define local work field Load Alpha
     C                     MOVEL*BLANK    YL0001  7
      * Define local work field Sequence Number
     C                     Z-ADD*ZERO     YL0002  30
      * Define local work field Current System Date
     C                     Z-ADD*ZERO     YL0003 155
      * Define local work field Current System Time
     C                     Z-ADD*ZERO     YL0004 155
      * Define local work field Created Time
     C                     Z-ADD*ZERO     YL0005  60
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Y2U0003
